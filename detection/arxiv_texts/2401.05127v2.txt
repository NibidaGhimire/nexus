Complete vectorial optical mode converter using multi-layer metasurface
Go Soma,1,âˆ—Kento Komatsu,1Yoshiaki Nakano,1and Takuo Tanemura1,â€ 
1School of Engineering, The University of Tokyo, 7-3-1 Bunkyo-ku, Tokyo 113-8656, Japan
A vectorial optical mode converter that can transform an orthogonal set of multiple input vector
beams into another orthogonal set of vector beams is attractive for a wide range of applications in
optics and photonics. While multi-plane light conversion (MPLC) and metasurface (MS) technolo-
gies have been explored to individually address multiple spatial mode conversion and polarization
mode manipulation, there has been no universal methodology to simultaneously convert a set of
multiple vectorial modes, having non-uniform spatial distributions in both their complex amplitude
and polarization, to another set of multiple vectorial modes. In this paper, we demonstrate versatile
devices based on the MPLC concept incorporating multi-layer locally birefringent MSs and present a
general design formalism for complete vectorial mode conversion in arbitrary cases. The effectiveness
of our proposed method is confirmed experimentally by demonstrating a 6-mode (3 spatial modes
Ã—2 polarization modes) multiplexer, fabricated on a compact chip with a âˆ¼0.65 mm2lateral size
in a folded MS configuration. Additionally, we verify its applicability to more advanced functional
devices through numerical demonstration of a mode-division-multiplexed dual-polarization coherent
receiver and spatial-mode-multiplexed vectorial holography. The versatility of our protocol makes
it suitable for designing a myriad of multi-input-multi-output devices, providing a powerful tool for
realizing universal optical mode converters for a wide range of applications.
Every linear optical component can be considered as a mode converter that transforms a specific set of input orthog-
onal modes into another set of output orthogonal modes [1]. The optical modes generally provide the fundamental
basis for describing complex optical systems in an explicit and economical manner [2]. To enjoy the maximum degrees
of freedom (DoFs) of light in a given optical system, therefore, full usage of optical modes, including the spatial and
polarization modes in addition to the wavelength, is essential. In space-division multiplexed (SDM) optical communi-
cation, for example, a large number of dual-polarization spatial modes are multiplexed in an optical fiber to increase
the transmission capacity [3â€“8]. The use of multiple vectorial optical modes with non-uniform spatial profiles in both
their complex amplitude and polarization, such as cylindrical vector beams (CVBs) [9], has also been explored to boost
the information density of free-space optical (FSO) communication [10â€“13] and holographic imaging [14â€“18] systems.
It is, therefore, of paramount interest in optics and photonics to develop a universal converter that can transform
an arbitrary set of orthogonal vectorial modes with generally non-uniform polarization profiles into another set of
orthogonal vectorial modes. In particular, an ideally lossless device that achieves unitary multi-input-multi-output
(MIMO) vectorial mode conversion is attractive for diverse applications.
To this end, multi-plane light conversion (MPLC) is a promising approach that has been successful in achieving uni-
versal spatial mode conversion for scalar optical fields [19â€“21]. Through a succession of transverse phase manipulation
and free-space propagation, an arbitrary orthogonal set of spatial modes can be converted into another set of spatial
modes in a unitary manner [19]. Using a spatial light modulator (SLM) and a multi-reflecting mirror, highly scalable
mode (de)multiplexers for hundreds of optical modes have been demonstrated [22, 23]. Such MPLC concept has also
been demonstrated on integrated photonic platforms, where various types of multi-input optical mode mixers were
employed to replace free-space propagation [24â€“28]. Owing to the inherent scalability and excellent performances,
MPLC devices have widely been used for various applications, including optical communication [6, 20, 21, 28â€“33],
quantum optics [34], and optical computing [26, 35].
Despite these advantages, however, conventional MPLC schemes have been limited to the conversion of scalar optical
fields. While a polarization-diversity scheme can be employed to apply independent spatial mode conversion to two
polarization states [36, 37], such an approach cannot transform non-uniform spatial distributions of polarization in
an arbitrary manner, which is insufficient to achieve complete conversion of multiple vector beams in general cases.
On the other hand, all-dielectric metasurfaces (MSs) have been studied actively over the past decade as efficient
flat optical devices that can manipulate the polarization properties of incident beams [38â€“40]. They are composed
of two-dimensional (2D) arrays of sub-wavelength scatterers called meta-atoms, each of which generally has asym-
metric geometries and functions as an ultra-small birefringent material. Through judicious design of meta-atoms,
therefore, a variety of polarization-dependent properties can be obtained, such as polarization beam splitting and
polarization-dependent holographic imaging [18, 41â€“46]. Whereas these previous demonstrations using mono-layer or
bi-layer MS devices employed an input beam with a single spatial mode, simultaneous conversion of multiple vectorial
âˆ—go.soma@tlab.t.u-tokyo.ac.jp
â€ tanemura@ee.t.u-tokyo.ac.jparXiv:2401.05127v2  [physics.optics]  3 Sep 20242
modes with arbitrary spatial and polarization profiles requires beam propagation through cascaded layers of MSs.
However, versatile multi-layered MS devices to achieve universal and simultaneous MIMO vectorial mode conversions
for arbitrary cases have not been demonstrated to our knowledge.
In this paper, we present a fully vectorial mode converter using a multi-layer MS and provide a general design
formalism to realize desired MIMO vectorial mode conversions for arbitrary cases. We combine the concepts of
MPLC and MS by replacing the scalar phase masks in conventional MPLC devices with locally birefringent MSs. As
a result, the conventional MPLC theory is extended to include multiple stages of Jones matrices. We then derive an
explicit inverse design protocol based on the adjoint method to optimize all the meta-atoms in each MS layer so that
a target mode conversion is obtained. The presented concept is validated experimentally by demonstrating a 6-mode
(3 spatial modes Ã—2 polarization modes) multiplexer using a 4-layer MS, fabricated on a compact âˆ¼0.65 mm2chip
with a folded MS configuration. Furthermore, the applicability of our scheme to more advanced functional devices
is verified numerically by demonstrating a mode-division-multiplexed (MDM) dual-polarization coherent receiver and
spatial-mode-multiplexed vectorial holography with excellent performances. Owing to the versatility of the presented
formalism, a variety of vectorial mode converters can be realized to utilize the full DoFs of optical beams for diverse
applications.
MULTI-INPUT VECTORIAL MODE CONVERTER USING A MULTI-LAYER METASURFACE
Figure 1a shows the schematic of the vectorial mode converter using Llayers of MSs. By repeating multiple
stages of lightwave conversion through the birefringent MS and propagation through the free space, we can achieve
simultaneous conversions of Morthogonal input vectorial modes to Mdesired output vectorial modes, including
their polarization profiles. In practice, this device can be implemented by a single compact chip with the folded MS
configuration [47â€“49] as shown in Fig. 1b.
The input vectorial field of the m-th mode ( m= 1,2, . . . , M ) can be written in a Jones-vector form as
ain
m(r) =/parenleftbiggain
m,X(r)
ain
m,Y(r)/parenrightbigg
, (1)
where r= (x, y)tdenotes the in-plane position and ain
m,X/Y(r) represents the X/Y -polarized components of the field.
(Note that we employ uppercase XandYto represent the polarization and lowercase xandyto represent the in-plane
position in this paper to avoid confusion.) Here, we assume that the in-plane variation of the field is gradual compared
with the wavelength so that the zcomponent of the electromagnetic field can be ignored. For convenience, we use
the Dirac notation to represent the input field as
/vextendsingle/vextendsingleain
m/angbracketrightbig
=/summationdisplay
n,pain
m,p(rn)|n, pâŸ©. (2)
Note that the in-plane position ris discretized into Npoints, rn= (xn, yn)t(n= 1,2, . . . , N ), and |n, pâŸ©(n=
1,2, . . . , N ;p=X, Y) represents the orthonormal basis in terms of position and polarization. For convenience, rn
are matched to the center positions of periodically placed meta-atoms. Following successive free-space propagation
and light conversion by the MSs, the resulting vectorial field at the input of the l-th MS can be expressed as
/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightï£¬ig
=/summationdisplay
n,pa(l)
m,p(rn)|n, pâŸ©=Ë†F(lâˆ’1)Ë†J(lâˆ’1)Â·Â·Â·Ë†F(1)Ë†J(1)Ë†F(0)/vextendsingle/vextendsingleain
m/angbracketrightbig
, (3)
where a(l)
m,p(rn)â‰¡ âŸ¨n, p|a(l)
mâŸ©denotes the p-polarized field at rnfor the m-th input mode. The operator Ë†F(l)describes
free-space propagation from the output of the l-th MS to the input of the ( l+ 1)-th MS and is written as
Ë†F(l)=/summationdisplay
n,nâ€²,pf(l)
nnâ€²|n, pâŸ©âŸ¨nâ€², p|. (4)
Here, f(l)
nnâ€²â‰¡ âŸ¨n, p|Ë†F(l)|nâ€², pâŸ©physically represents the coupling coefficient from rnâ€²at the l-th plane to rnat the
(l+ 1)-th plane, which can be described by the Rayleighâ€“Sommerfeld point-spread function (impulse response). Since
XandYpolarization components of light independently follow the Helmholtz equations as they propagate through
a uniform medium, they do not couple during free-space propagation. We thus have âŸ¨n, p|Ë†F(l)|nâ€², pâ€²âŸ©= 0 ( pÌ¸=pâ€²).
Finally, the operator Ë†J(l)in Eq. (3) represents the propagation through the l-th MS and can be written as
Ë†J(l)=/summationdisplay
n,p,pâ€²j(l)
ppâ€²(rn)|n, pâŸ©âŸ¨n, pâ€²|, (5)3
MS-2MS-ğ¿Forward
Backward (Adjoint)MS-1ğ½#!
ğ‰=ğ‘ğ›¾ğ‘’"#00ğ‘’"$ğ‘(âˆ’ğ›¾)ğ‘¥ğ‘§ğ‘¦
ğ›¾ğ·#ğ·$
a
InputOutput
1ğ‘%(!)3
ğ¹5(6ğ‘%)*71ğ‘%(+)31ğ‘%(,)3ğ¹5!ğ¹5,|ğ‘%-./âŸ©
|ğ‘%/01âŸ©1ğ‘%,31ğ‘%(+)31ğ‘%(!)3ğ½#+ğ½#,ğš%)*(ğ«)ğš%-./(ğ«)ğš%/01(ğ«)
ğ‘š=1ğ‘š=2ğ‘š=3
ğ‘š=1ğ‘š=2ğ‘š=3Input vectorial mode setOutput vectorial mode set
Metasurface (MS)
bTransparent substrate
In
MS-1MS-2
MS-3MS-ğ¿MS-(ğ¿â€“1)Out
Reflective MSs
Jones matrix
Fig. 1. Universal vectorial mode conversion using a multi-layer MS. a , Schematic of the vectorial mode converter
using an L-layer metasurface (MS). The input vectorial mode set/braceleftbig/vextendsingle/vextendsingleain
m/angbracketrightbig
|m= 1,2, ..., M/bracerightbig
is transformed into another mode
set/braceleftbig/vextendsingle/vextendsingleaout
m/angbracketrightbig
|m= 1,2, ..., M/bracerightbig
by repeated free-space propagation Ë†F(l)and lightwave conversion by MSs Ë†J(l). The Jones
matrices of MSs are optimized using the forward and adjoint (backward) fields. The bottom inset shows schematics of the
birefringent meta-atom. Arbitrary phase shifts Î±andÎ²can be obtained by properly designing meta-atom dimensions, DÎ±
andDÎ².b, Schematic of a single-chip mode converter with a folded MS configuration using reflective MSs.
where j(l)
ppâ€²(rn)â‰¡ âŸ¨n, p|Ë†J(l)|n, pâ€²âŸ©denotes the conversion of the Jones vector induced by the meta-atom at rn. Since
each meta-atom can only locally transform the Jones vector at its position, j(l)
ppâ€²(rn)â‰¡ âŸ¨n, p|Ë†J(l)|nâ€², pâ€²âŸ©(nÌ¸=nâ€²) For
convenience, we define the Jones matrix induced by each meta-atom at rnon the l-th MS as
J(l)(rn) =/parenleftï£¬igg
j(l)
XX(rn)j(l)
XY(rn)
j(l)
Y X(rn)j(l)
Y Y(rn)/parenrightï£¬igg
. (6)
Assuming an ideally lossless and non-chiral dielectric structure as shown in the bottom inset of Fig. 1a, each meta-atom
functions as an ultra-small birefringent waveplate. Thus, J(l)(rn) can be written explicitly as [50]
J(l)(rn) =R/parenleftbig
Î³(l)(rn)/parenrightbig/parenleftï£¬igg
eiÎ±(l)(rn)0
0 eiÎ²(l)(rn)/parenrightï£¬igg
R/parenleftbig
âˆ’Î³(l)(rn)/parenrightbig
, (7)4
where R(Î³) is a rotation matrix defined as
R(Î³)â‰¡/parenleftbigg
cosÎ³âˆ’sinÎ³
sinÎ³cosÎ³/parenrightbigg
. (8)
In Eq. (7), Î±(l)(rn) and Î²(l)(rn) represent the phase shifts for the eigenmode waves polarized along the slow and
fast axes of the meta-atom, respectively, and Î³(l)(rn) is the angle of orientation. Arbitrary phase shifts Î±andÎ²can
be obtained by judiciously selecting the dimensions of the meta-atom ( DÎ±, DÎ²) along the two axes as shown in the
bottom inset of Fig. 1a [46, 51]. Therefore, each meta-atom can be described using three design parameters: Î±,Î²,
andÎ³.
ADJOINT OPTIMIZATION OF METASURFACE
We now consider an efficient algorithm to optimize the parameters of each meta-atom so that an objective function
Eis maximized. Here, Eis defined by the averaged inner product between the output vectorial field |aout
mâŸ©and the
target field |atar
mâŸ©for all Mmodes as
E â‰¡1
M/summationdisplay
m/vextendsingle/vextendsingle/angbracketleftbig
atar
m/vextendsingle/vextendsingleaout
m/angbracketrightbig/vextendsingle/vextendsingle2=1
M/summationdisplay
m/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
n,p/parenleftbig
atar
m,p(rn)/parenrightbigâˆ—aout
m,p(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
, (9)
where
/vextendsingle/vextendsingleaout
m/angbracketrightbig
=/summationdisplay
n,paout
m,p(rn)|n, pâŸ©=Ë†F(L)Ë†J(L)/vextendsingle/vextendsingle/vextendsinglea(L)
m/angbracketrightï£¬ig
, (10)
/vextendsingle/vextendsingleatar
m/angbracketrightbig
=/summationdisplay
n,patar
m,p(rn)|n, pâŸ©. (11)
Note that aout/tar
m,p (rn)â‰¡ âŸ¨n, p|aout/tar
mâŸ©represents the output/target p-polarized component of the m-th mode.
To maximize E, we employ the adjoint method [49, 52]; the design parameters of each meta-atom are updated
iteratively as
Î¸(l)(rn)â†Î¸(l)(rn) +F/bracketleftbiggâˆ‚E
âˆ‚Î¸(l)(rn)/bracketrightbigg
, (12)
where Î¸(l)(rn)âˆˆ/braceleftbig
Î±(l)(rn), Î²(l)(rn), Î³(l)(rn)/bracerightbig
(n= 1,2, . . . , N ) represents the parameters of the meta-atom at rnin
thel-th MS and Fis an optimization function of the first-order gradient, which is defined appropriately to achieve
rapid convergence.
After some mathematical procedures (See Supplementary Note 1 for the complete derivation), we can derive
âˆ‚E
âˆ‚Î¸(l)(rn)=2
M/summationdisplay
mRe/bracketleftï£¬igg
/angbracketleftbig
aout
m/vextendsingle/vextendsingleatar
m/angbracketrightbig/angbracketleftï£¬igg
b(l)
m/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightï£¬igg/bracketrightï£¬igg
. (13)
Here,âŸ¨b(l)
m|is the adjoint vectorial field and defined as
/vextendsingle/vextendsingle/vextendsingleb(l)
m/angbracketrightï£¬ig
â‰¡/summationdisplay
nb(l)
m,p(rn)|n, pâŸ© â‰¡Ë†F(l)â€ Â·Â·Â·Ë†J(L)â€ Ë†F(L)â€ /vextendsingle/vextendsingleatar
m/angbracketrightbig
, (14)
which represents the vectorial field on the output of the l-th MS when the target field |atar
mâŸ©is propagated backward
as shown in Fig. 1a.
Using Eq. (7),âˆ‚J(l)
âˆ‚Î¸(l)in Eq. (13) can be expressed explicitly (see Supplementary Note 1 for the actual expressions).
Hence,âˆ‚E
âˆ‚Î¸(l)for all MS parameters Î¸(l)can be obtained at once from Eq. (13) by computing |a(l)
mâŸ©and|b(l)
mâŸ©(m=
1,2, . . . , M ) through the forward and backward propagation. In each iteration of optimization, we first calculate |a(l)
mâŸ©
for each mode by the forward propagation given by Eq. (3) and derive Eusing Eq. (9). Similarly, |b(l)
mâŸ©are obtained
by Eq. (14). Then,âˆ‚E
âˆ‚Î¸(l)(rn)are calculated using Eq. (13). Finally, we update the parameters through Eq. (12). These
procedures are repeated until the objective function converges (see Supplementary Fig. 1).5
SiO2sub.13.5Â°
Mirror123456Xpol.
MS-1MS-2MS-3MS-4300 Î¼mzxzâ€™xâ€™
yyâ€™xâ€™zâ€™yâ€™aInput planeOutput plane
ğ›¼ğ›½ğ›¾b
MS-1MS-2MS-3MS-4pitch: 40 Î¼m
ğ‘š=3ğ‘š=4ğ‘š=5ğ‘š=6ğ‘š=2ğ‘š=1LP01LP11aLP11bğ‘š
Phaseâ€“ğœ‹ğœ‹Amplitude
123456123456Coupling (dB)
Input mode (ğ‘š)Target mode (ğ‘š)cd
Xpol.Ypol.123456Input mode (ğ‘š)
Xpol.Ypol.1
0625 Î¼m
Phase ğ›¼,ğ›½Rotation angle ğ›¾âˆ’ğœ‹âˆ’ğœ‹2ğœ‹2ğœ‹15-Î¼m field diameter
10.4-Î¼m field diameterReflective MSLP01ğ‘š=1~6X& Y pol.19.7Â°
400 Î¼m
â€“50â€“40â€“30â€“20â€“100
100Î¼m20 Î¼m
Fig. 2. Schematic and design of a spatial/polarization mode multiplexer. a , Device configuration. Through
multiple reflections at four reflective MS sections, six X-polarized input beams are converted to polarization-multiplexed LP
modes at the output. b, Spatial distributions of MS parameters Î±(l)(r),Î²(l)(r), and Î³(l)(r) (l= 1,2,3,4) after optimization.
c, Output complex field profiles for each input mode. d, Calculated coupling efficiency matrix C.
EXPERIMENTAL RESULTS
To validate the generalized formalism and the optimization method presented in the previous section, we first
consider a simple example of a 6-mode (3 spatial modes Ã—2 polarization modes) multiplexer. Figure 2a shows the
schematic of the device. It is composed of a row of four reflective MS sections integrated on one side of a 625- Âµm-thick
fused silica (SiO 2) substrate and a total-reflection mirror layer with input/output apertures on the other side. Figure
3a shows the reflective meta-atom employed in this work, which consists of a Si nanopost with a height of 0.57 Âµm,
capped with a polyimide layer and a gold mirror layer. The lateral dimension of each MS section is chosen to be
300ÂµmÃ—360Âµm, which is sufficiently larger than forward-propagated beams at the first MS layer and backward-
propagated beams at the last MS layer for all modes. The incident light transmitted through the input aperture is
reflected back and forth between the MS and mirror layers and exits through the output aperture. We aim to design
each MS section so that six X-polarized Gaussian beams ( m= 1, ...,6) arranged on an equally spaced 2 Ã—3 array at
the input plane are converted into polarization-multiplexed spatial modes at the output plane. As the output spatial
modes, we assume LP modes inside a few-mode fiber (FMF) with a mode field diameter (MFD) of 15 Âµm, supporting
three spatial modes (LP 01, LP 11a, and LP 11b) at 1550-nm wavelength. As shown in the left and right insets of Fig. 2a,
X-polarized input beams at m= 1, 3, and 5 (2, 4, and 6) are converted to X-polarized ( Y-polarized) LP 11b, LP 01,
and LP 11amodes, respectively, centered at the same position. Owing to the folded MS configuration, simultaneous
MIMO vectorial mode conversion can be achieved using a single compact chip.
Figures 2b and 2c respectively show the MS parameters of the optimized design and the simulated vectorial field dis-
tributions at the output plane for each input mode (see Methods and Supplementary Fig. 2 for the design procedure).
We can confirm that each input mode is transformed to the desired spatial and polarization mode. For quantitative
evaluation, we employ the coupling efficiency matrix C, whose components are defined as Cmmâ€²=|âŸ¨atar
m|aout
mâ€²âŸ©|2. The
calculated Cfor the optimized MS design is shown in Fig. 2d. The insertion loss and crosstalk are suppressed below
0.95 dB and âˆ’30 dB for all six modes.
Figure 3b shows the microscope images of the fabricated device (see Methods and Supplementary Fig. 3 for the
details of the fabrication process). Scanning electron microscope (SEM) images of the MS before capping the polyimide
layer are shown in Fig. 3c. The lateral dimension of the entire device is 1.8 mm Ã—0.36 mm âˆ¼0.65 mm2.
The fabricated device was characterized at 1550-nm wavelength using the setup shown in Fig. 3d (see Methods6
eIntensity (a.u.)01XY
135246Input mode (ğ‘š)
AuPolyimideSi elliptical nanopostSiO2
1 Î¼mab
MS
-
1
MS
-
2
MS
-
3
MS
-
4MS side
Ag/Au mirror
InputInput/output side
Output
MS
PCLaser@1550 nm10x Obj.Pol.Tube lensNIR cameradMSSMF
Obj.0.57 Î¼m0.6 Î¼m0.6 Î¼mcOutput polarization
ğœƒ~19.7âˆ˜Xpol.100 Î¼m
100 Î¼m10 Î¼m
2Î¼m
20 Î¼m
Fig. 3. Experimental demonstration of a spatial/polarization mode multiplexer. a , Schematic of the reflective
meta-atom, composed of a Si elliptical nanoposts on a SiO 2substrate with polyimide and Au mirror layers. b, Microscope
images of the fabricated folded MS device at the MS side before Au mirror deposition (top) and at the input/output side
(bottom). c, Scanning electron microscope (SEM) images of the fabricated MS before depositing the polyimide layer. d,
Measurement setup. PC: polarization controller. Obj.: objective lens. Pol.: polarizer. The left inset shows a photograph of
the mode multiplexer chip with the input single-mode fiber (SMF) and the objective lens. e, Measured intensity profiles at
the output plane in XandYpolarization.
for the details). Figure 3e shows the X- and Y-polarized intensity profiles, which were observed for each input fiber
position. We can confirm that each input mode was converted to the corresponding LP and polarization mode as
designed. The total transmission loss from the input SMF to the output light was measured to be 4.0 dB for all
six inputs. The coupling efficiency matrix was calculated using the complex field profiles measured by the off-axis
holography (detailed explanation is given in Supplementary Note 2 and Supplementary Fig. 4). The total coupling
loss to the designed LP modes was in the range of 13.8 to 17.7 dB. This relatively large modal mismatch may result
from various reasons. First, fabrication errors of MS, such as variations in Si nanopost geometries and the polyimide
layer thickness, should have caused undesired scattering and non-perfect conversion of optical modes. In addition,
various issues in the experiment, such as the deviation of the incident beam from the ideal Gaussian beam assumed in
the design, possible misalignment particularly in the incident angle, and undesired reflection at the input facet, should
have increased the error from the ideal case. There is, therefore, a large room for improvement through optimizing
the device fabrication and measurement system.7
APPLICATIONS TO FUNCTIONAL MULTI-MODAL DEVICES
To further investigate the efficacy of our scheme for more advanced applications, we design and numerically demon-
strate fully vectorial MIMO devices for two other use cases: (i) MDM dual-polarization coherent receiver and (ii)
spatial-mode-multiplexed vectorial holography.
MDM dual-polarization coherent receiver
MDM technology using a multi-mode fiber (MMF) is promising for future optical communication systems to break
the limit of transmission capacity through an SMF [3, 4]. In a polarization-multiplexed coherent MDM system, the
receiver requires complex optical components to demultiplex all space/polarization modes and interfere each of them
with the LO light through an optical hybrid before the detection by balanced photodiodes (PDs). While we have
recently demonstrated the use of a mono-layer MS to achieve simultaneous detection of spatially separated multiple
coherent signals from a multi-core fiber [53], the same approach cannot be applied to demodulate MDM signals from
an MMF that overlap heavily in space. Conventionally, therefore, MDM coherent receivers were implemented using
three separate devices: a spatial mode demultiplexer, a polarization-beam splitter (PBS), and an optical hybrid for
each mode [5â€“8]. Recently, Wen et al. have proposed a scalar MPLC-based device that combines a spatial mode
demultiplexer and 90â—¦optical hybrids for a single polarization [30, 31]. However, a single device that can receive
dual-polarization MDM coherent signals has never been demonstrated to our knowledge.
Here, we demonstrate a novel optical receiver frontend using our proposed vectorial mode converter that achieves
all of the above functionalities, namely, a spatial mode demultiplexer, a PBS, and optical hybrids for all spa-
tial/polarization modes, in one device. Figure 4a shows the configuration of the proposed MDM dual-polarization
coherent receiver. We assume six layers of MSs ( L= 6) with 400- Âµm-square area and a negligible thickness, each
separated by 1 mm. In practice, the entire device can be implemented in a folded MS structure, offering a cost-effective
solution to realize compact MDM coherent receivers.
Similar to the case considered in the previous section, we assume an FMF with an MFD of 15 Âµm that supports
dual-polarization signals in the three spatial modes (LP 01, LP 11a, and LP 11b) at 1550-nm wavelength. As the LO
light, we assume X-polarized LP 01mode from an SMF, having an MFD of 10 Âµm. These fibers are placed at the input
plane, with a separation of 127 Âµm. For convenience, we define m= 1, ...,6 to represent the six space/polarization
modes of the signals and m= 7 to represent the LO mode as shown in Fig. 4b.
Through adjoint optimization of meta-atoms, all lightwaves are converted to Xpolarization and focused on 24
distinct points at the output plane, as shown in Fig. 4c. Here, each signal mode ( m= 1, ...,6) is focused on four
vertically aligned points along its corresponding column. The optical phases at these four points are shifted by Ï€/2.
In contrast, the LO beam ( m= 7) is split into 24 points with equal optical power and phases. As they interfere,
therefore, we obtain the functionality of a 90â—¦optical hybrid for each signal mode so that six coherent signals can be
demodulated simultaneously by placing PDs at these 24 positions.
Figure 4d shows the obtained objective function Eas a function of iteration, which shows good convergence after
around 200 iterations. Figures 4e and 4f show the MS parameters of the optimized design and the vectorial field
distributions at the output for each input mode, respectively (the evolution of vectorial field at each MS plane is
provided in Supplementary Fig. 5). We can see that all modes are focused onto the well-defined positions with desired
phases.
For quantitative evaluation, Table I summarises the performances of our designed MDM coherent receiver. Rigorous
definitions and derivations of all metrics are given in the Methods section. We can see that the insertion loss is less
than 0.9 dB for all modes with a low MDL of 0.1 dB. The crosstalk to other undesired PDs is suppressed below
âˆ’25 dB, showing excellent spatial/polarization mode demultiplexing functions. Furthermore, the phase error and
power imbalance within the four spots of each mode, which characterize the performance of the optical hybrid, are
suppressed below 1.4â—¦and 0.6 dB, respectively. In addition, our device is confirmed to exhibit fairly robust operation
across the entire C-band (1530-1565 nm) without significant degradation in performance. Furthermore, increasing the
number of layers generally leads to enhanced performance, owing to the larger degrees of freedom. (The wavelength
dependence and effect of increasing the number of MS layers are examined in detail in Supplementary Notes 3 and 4,
respectively.)
Spatial-mode-multiplexed vectorial holography
MS-based holography has been actively studied as a unique method to generate different images depending on the
input and output polarization states [14, 15, 18, 44, 45, 50, 51, 54, 55]. By tuning the birefringence of each meta-atom,8
SignalLOMS-1MS-61 mmğ¿=6400 Î¼m400 Î¼mğ‘¥ğ‘¦ğ‘§a
MS-2
SignalLOğ‘š=1ğ‘š=2ğ‘š=3ğ‘š=4ğ‘š=6ğ‘š=5ğ‘š=7bLP01LP11aLP11bLP01SignalLOğ‘š=2345610ğœ‹ğœ‹/23ğœ‹/2
Pol.0ğ‘š=7Phase
100 Î¼mcPol.
10 Î¼mLOğ›¼ğ›½ğ›¾MS-1MS-2MS-3MS-4MS-5MS-6f
âˆ’ğœ‹âˆ’ğœ‹2ğœ‹2ğœ‹Phase ğ›¼,ğ›½Rotation angle ğ›¾e
Phaseâ€“ğœ‹ğœ‹Amplitude1
0
d
0100200Iteration01Objective function â„°
Mode ğ‘šPolarizationXY1234567100 Î¼m100 Î¼mInputOutput
Fig. 4. MDM dual-polarization coherent receiver. a , Configuration of the device with six MS layers that realizes an
optical hybrid for a mode-division-multiplexed (MDM) dual-polarization coherent receiver. We assume that each MS consists
of meta-atoms arranged on a square lattice with a lattice constant of 1 Âµm (i.e., N= 4002). Thus, the entire device contains
2,880,000 (= 6 Ã—4002Ã—3) parameters. b, Input mode profiles (LP 01, LP 11a, and LP 11bfor signals and LP 01for the local
oscillator (LO)). c, Target field profiles at the output plane for the signals and LO. The phase of each spot is set to achieve
the functionality of a 90â—¦optical hybrid for each mode. The separation between adjacent spots and the beam diameter of each
focused spot are set to 30 Âµm and 10 Âµm, respectively. d, Objective function Eduring the optimization process. e, Profiles of
the optimized MS parameters Î±(l)(r),Î²(l)(r), and Î³(l)(r) (l= 1,2, . . . , 6).f, Vectorial field distributions obtained at the
output plane, aout
m,X/Y (r) (m= 1,2, . . . , 7), for all input modes. For clarity, the optical phase offset in each field is adjusted.
we can independently control the optical phase (and amplitude) distributions of X- and Y-polarization components
and thereby synthesize separate images for respective polarizations at a desired plane. While the prior demonstrations
mostly presumed an input beam with a single spatial mode, multiple spatial beams, such as Fourier modes [56â€“58]
and optical angular momentum (OAM) modes [59â€“62], could also be used to produce spatially multiplexed images.
Such spatial-mode-multiplexed holography, however, has been restricted to specific input modes that possess some9
Table I. Performance of our MDM dual-polarization coherent receiver using the optimized MS parameters
LP mode LP 01 LP11a LP11b LP01(LO)
Polarization X Y X Y X Y X
m 1 2 3 4 5 6 7
Insertion loss (dB) 0.81 0.82 0.80 0.83 0.87 0.90 0.78
Crosstalk (dB) âˆ’25.4 âˆ’26.0 âˆ’30.1 âˆ’29.4 âˆ’26.4 âˆ’28.0 â€”â€”
Phase error (deg) âˆ’0.29 âˆ’0.26 âˆ’0.28 0.53 0.027 âˆ’0.27 1.35
Power imbalance (dB) 0.36 0.25 0.19 0.20 0.075 0.066 0.53
Phase ğ›¼,ğ›½Rotation angle ğ›¾âˆ’ğœ‹âˆ’ğœ‹2ğœ‹2ğœ‹
Intensity (a.u.)011234Mode ğ‘šğ›¼ğ›½ğ›¾ğ‘ƒ!ğ‘ƒâ€²!ğ‘ƒ"ğ‘ƒâ€™"ğ‘ƒ#ğ‘ƒâ€²#ğ‘ƒâ€²$ğ‘ƒ$
MS-4
MS-3
MS-1MS-21 mmğ¿=4
400 Î¼m400 Î¼mğ‘¥ğ‘¦ğ‘§aVectorial images
2ğœ‹
4ğœ‹CVBğ‘=+1
ğ‘=+2ğ‘š=1ğ‘š=2
ğ‘š=3ğ‘š=4ğ‘†!ğ‘†"ğ‘†#ğ‘ƒ!
ğ‘ƒâ€²!ğ‘ƒ"ğ‘ƒâ€²"ğ‘ƒ#
ğ‘ƒâ€²#ğ‘ƒâ€²$ğ‘ƒ$b
ğ’=Â±13,Â±13,Â±13%cd
ğ‘=+1ğ‘=+2MS-1MS-2MS-3MS-4100 Î¼m
100 Î¼m
Fig. 5. Spatial-mode-multiplexed vectorial holography. a , Configuration of the spatial-mode-multiplexed vectorial
holography with a four-layer MS. The left inset shows the input cylindrical vector beam (CVB) profiles with topological
orders qof +1 (top; m= 1,2) and +2 (bottom; m= 3,4). Arrows indicate the polarization orientation within the beam that
rotates by 2 Ï€qalong the azimuth. b, Analyzed polarization states PmandPâ€²
m(m= 1,2,3,4) in the Stokes space, which
composes a regular hexahedron. c, Profiles of the optimized MS parameters Î±(l)(r),Î²(l)(r), and Î³(l)(r) (l= 1,2,3,4) on
1-Âµm-spacing grids. d, Vectorial holographic images obtained at the output plane for two polarization states, |aout
m,Pm(r)|2and
|aout
m,Pâ€²m(r)|2(m= 1,2,3,4).
sort of spatial symmetry to enable simultaneous conversion using a mono-layer MS. Universal conversion of multiple
beams, including their polarization profiles, for an arbitrary case of input vectorial modes would require transmission
through multiple layers of MSs. Here, we design our multi-layer MS device to demonstrate such an ultimate case of
spatial-mode-multiplexed vectorial holography with high efficiency for the first time.
Figure 5a shows the configuration of the entire system, where the output image varies depending on the input
vectorial mode and the analyzed polarization state. In this work, we select two CVB modes [9] with the topological
orders ( q) of +1 and +2 as the input spatial modes. Each CVB mode at 1550-nm wavelength is polarization-10
multiplexed so that we have four input modes ( m= 1,2,3,4) in total, as shown in the left inset of Fig. 5a. The input
beam diameter is set to 100 Âµm for all modes. After propagating through four layers of MSs ( L= 4), two different
holographic images per each CVB mode are created depending on the analyzed polarization states, PmandPâ€²
m. Here,
PmandPâ€²
mrepresent the orthogonal polarization states that are analyzed for the m-th mode. We should note that
the orthogonal polarization pair for each mode ( Pm,Pâ€²
m) can be freely selected, which is not possible with mono-layer
MSs in principle [63]. To demonstrate the versatility of our scheme, therefore, we set all four of them to be different
elliptical polarization states; the Stokes parameters S= (S1, S2, S3)tofPmandPâ€²
m(m= 1,2,3,4) are selected to
constitute a regular hexahedron as shown in Fig. 5b.
Them-th target vectorial field at the output plane is then expressed as
atar
m(r) =atar
m,Pm(r)ePm+atar
m,Pâ€²m(r)ePâ€²m, (15)
where ePmandePâ€²mdenote the unit Jones vectors of PmandPâ€²
m, respectively. |atar
m,Pm(r)|2and|atar
m,Pâ€²m(r)|2represent
them-th target holographic images for two orthogonal analyzing polarization states. Since we have the freedom to
choose arbitrary phase profiles of the images, the phase distributions of atar
m(r) are sequentially updated to match
those of the output vectorial fields aout
m(r) after each forward calculation. More specifically, atar
m(r) is replaced to
atar
m(r)eiÏ•(r)in every iteration, where Ï•(r)â‰¡arg[{atar
m(r)}â€ aout
m(r)] is the phase difference between the output and
target fields. This operation corresponds to the Gerchbergâ€“Saxton (GS) algorithm [64] and automatically ensures
orthogonality between different target modes. Other parameters and optimization methods are the same as in the
previous section.
Figures 5c and 5d show the optimized MS parameters and simulated vectorial holographic images |aout
m,Pm|2and
|aout
m,Pâ€²m|2for each input mode ( m= 1,2,3,4). We should note that our method does not require a mode-selective
aperture array at the output plane, unlike previously demonstrated OAM-multiplexed holography [59â€“61]. We can
confirm that eight independent holographic images, including the fine texts and complex ginkgo mark of the University
of Tokyo, are successfully generated. The holography efficiency, defined as |âŸ¨atar
m|aout
mâŸ©|2, is as high as 93.5%, 93.4%,
88.8%, and 86.8% for m= 1, 2, 3, and 4, respectively.
DISCUSSION AND CONCLUSION
We have proposed and demonstrated a universal vectorial mode converter based on the MPLC concept with a
multi-layer MS. The Jones matrix formalism was incorporated inside the conventional MPLC theory to enable local
control of the polarization profiles of multiple beams in addition to their wavefronts. We then constructed a versatile
inverse design algorithm based on the adjoint method to realize desired MIMO conversions of fully vectorial modes
for arbitrary cases. The presented method was verified experimentally by demonstrating a 6-mode (LP 01, LP 11a, and
LP11bmodes in XandYpolarization states) multiplexer using a 4-layer MS. We designed and fabricated a compact
device based on the folded MS configuration, and confirmed fully vectorial mode conversion of six X-polarized input
beams to desired LP and polarization modes at the output plane. Furthermore, the applicability of our scheme to more
advanced MIMO devices was numerically demonstrated for two other use cases. First, a novel optical receiver frontend
for MDM dual-polarization coherent signals was demonstrated; with the optimized MSs, we achieved simultaneous
balanced homodyne detection of six coherent signals with excellent performances, such as 0.9-dB insertion loss, 0.1-
dB MDL, and 25-dB crosstalk suppression for all modes. Second, we successfully demonstrated unique spatial-mode
multiplexed vectorial holography using four CVB input beams and two arbitrary analyzing polarization states to
generate eight independent images with more than 86% efficiencies.
We should stress that such devices, capable of converting a set of multiple vectorial modes to another set of vectorial
modes with arbitrary polarization profiles, are theoretically not possible with a mono-layer MS. This work, therefore,
provides the first explicit and general formalism to realize universal MIMO vectorial mode converters. Moreover, we
expect that independent wavelength-mode manipulation could also be incorporated into our device by using dispersive
meta-atoms [47, 48, 62, 65, 66]. Owing to the versatility of the presented method, it can be applied to a variety of
cases, paving the way toward the utilization of full DoFs of optical beams for diverse applications, including optical
communication, imaging, and computing.
[1] D. A. B. Miller, All linear optical devices are mode converters, Opt. Express 20, 23985 (2012).
[2] D. A. B. Miller, Waves, modes, communications, and optics: a tutorial, Adv. Opt. Photon. 11, 679 (2019).
[3] T. Mizuno, H. Takara, A. Sano, and Y. Miyamoto, Dense space-division multiplexed transmission systems using multi-core
and multi-mode fiber, J. Lightwave Technol. 34, 582 (2016).11
[4] P. J. Winzer and D. T. Neilson, From scaling disparities to integrated parallelism: A decathlon for a decade, J. Lightwave
Technol. 35, 1099 (2017).
[5] D. Soma, Y. Wakayama, S. Beppu, S. Sumita, T. Tsuritani, T. Hayashi, T. Nagashima, M. Suzuki, M. Yoshida, K. Kasai,
M. Nakazawa, H. Takahashi, K. Igarashi, I. Morita, and M. Suzuki, 10.16-Peta-b/s dense SDM/WDM transmission over
6-mode 19-core fiber across the C+L band, J. Lightwave Technol. 36, 1362 (2018).
[6] G. Rademacher, B. J. Puttnam, R. S. LuÂ´ Ä±s, T. A. Eriksson, N. K. Fontaine, M. Mazur, H. Chen, R. Ryf, D. T. Neilson,
P. Sillard, F. Achten, Y. Awaji, and H. Furukawa, Peta-bit-per-second optical communications system using a standard
cladding diameter 15-mode fiber, Nat. Commun. 12, 4238 (2021).
[7] P. Sillard, K. Benyahya, D. Soma, G. Labroille, P. Jian, K. Igarashi, R. Ryf, N. K. Fontaine, G. Rademacher, and
K. Shibahara, Few-mode fiber technology, deployments, and systems, Proc. IEEE 110, 1804 (2022).
[8] M. van den Hout, G. D. Sciullo, R. S. LuÂ´ Ä±s, B. J. Puttnam, N. K. Fontaine, R. Ryf, H. Chen, M. Mazur, D. T. Neilson,
P. Sillard, F. Achten, A. Mefleh, J. Sakaguchi, C. Antonelli, C. Okonkwo, H. Furukawa, and G. Rademacher, Transmission
of 273.6 Tb/s over 1001 km of 15-mode multi-mode fiber using C-band only 16-QAM signals, J. Lightwave Technol. 42,
1136 (2024).
[9] Q. Zhan, Cylindrical vector beams: from mathematical concepts to applications, Adv. Opt. Photon. 1, 1 (2009).
[10] G. Milione, M. P. J. Lavery, H. Huang, Y. Ren, G. Xie, T. A. Nguyen, E. Karimi, L. Marrucci, D. A. Nolan, R. R. Alfano,
and A. E. Willner, 4 Ã—20 Gbit/s mode division multiplexing over free space using vector modes and a q-plate mode
(de)multiplexer, Opt. Lett. 40, 1980 (2015).
[11] Z. Zhu, M. Janasik, A. Fyffe, D. Hay, Y. Zhou, B. Kantor, T. Winder, R. W. Boyd, G. Leuchs, and Z. Shi, Compensation-
free high-dimensional free-space optical communication using turbulence-resilient vector beams, Nat. Commun. 12, 1666
(2021).
[12] Y. He, P. Wang, C. Wang, J. Liu, H. Ye, X. Zhou, Y. Li, S. Chen, X. Zhang, and D. Fan, All-optical signal processing in
structured light multiplexing with dielectric meta-optics, ACS Photonics 7, 135 (2020).
[13] S. Chen, Z. Xie, H. Ye, X. Wang, Z. Guo, Y. He, Y. Li, X. Yuan, and D. Fan, Cylindrical vector beam multi-
plexer/demultiplexer using off-axis polarization control, Light Sci. Appl. 10, 222 (2021).
[14] Q. Song, X. Liu, C.-W. Qiu, and P. Genevet, Vectorial metasurface holography, Applied Physics Reviews 9, 011311 (2022).
[15] B. Xiong, Y. Liu, Y. Xu, L. Deng, C.-W. Chen, J.-N. Wang, R. Peng, Y. Lai, Y. Liu, and M. Wang, Breaking the limitation
of polarization multiplexing in optical metasurfaces with engineered noise, Science 379, 294 (2023).
[16] A. H. Dorrah, N. A. Rubin, A. Zaidi, M. Tamagnone, and F. Capasso, Metasurface optics for on-demand polarization
transformations along the optical path, Nat. Photonics 15, 287 (2021).
[17] H. Ren, W. Shao, Y. Li, F. Salim, and M. Gu, Three-dimensional vectorial holography based on machine learning inverse
design, Sci. Adv. 6, eaaz4261 (2020).
[18] Y. Bao, F. Nan, J. Yan, X. Yang, C.-W. Qiu, and B. Li, Observation of full-parameter Jones matrix in bilayer metasurface,
Nat. Commun. 13, 7550 (2022).
[19] J.-F. Morizur, L. Nicholls, P. Jian, S. Armstrong, N. Treps, B. Hage, M. Hsu, W. Bowen, J. Janousek, and H.-A. Bachor,
Programmable unitary spatial mode manipulation, J. Opt. Soc. Am. A 27, 2524 (2010).
[20] G. Labroille, B. Denolle, P. Jian, P. Genevaux, N. Treps, and J.-F. Morizur, Efficient and mode selective spatial mode
multiplexer based on multi-plane light conversion, Opt. Express 22, 15599 (2014).
[21] Y. Zhang and N. K. Fontaine, Multi-plane light conversion: a practical tutorial, arXiv[physics.optics] 2304.11323 (2023).
[22] N. K. Fontaine, R. Ryf, H. Chen, D. T. Neilson, K. Kim, and J. Carpenter, Laguerre-Gaussian mode sorter, Nat. Commun.
10, 1865 (2019).
[23] N. K. Fontaine, H. Chen, M. Mazur, L. Dallachiesa, K. W. Kim, R. Ryf, D. Neilson, and J. Carpenter, Hermite-Gaussian
mode multiplexer supporting 1035 modes, in Optical Fiber Communication Conference (OFC) 2021 , p. M3D.4.
[24] R. Tang, T. Tanemura, and Y. Nakano, Integrated reconfigurable unitary optical mode converter using MMI couplers,
IEEE Photonics Technology Letters 29, 971 (2017).
[25] R. Tang, T. Tanemura, S. Ghosh, K. Suzuki, K. Tanizawa, K. Ikeda, H. Kawashima, and Y. Nakano, Reconfigurable
all-optical on-chip MIMO three-mode demultiplexing based on multi-plane light conversion, Opt. Lett. 43, 1798 (2018).
[26] R. Tang, R. Tanomura, T. Tanemura, and Y. Nakano, Ten-port unitary optical processor on a silicon photonic chip, ACS
Photonics 8, 2074 (2021).
[27] R. Tanomura, R. Tang, T. Umezaki, G. Soma, T. Tanemura, and Y. Nakano, Scalable and robust photonic integrated
unitary converter based on multiplane light conversion, Phys. Rev. Appl. 17, 024071 (2022).
[28] R. Tanomura, R. Tang, G. Soma, S. Ishimura, T. Tanemura, and Y. Nakano, All-optical MIMO demultiplexing using
silicon-photonic dual-polarization optical unitary processor, J. Lightwave Technol. 41, 3791 (2023).
[29] Y. Zhang, N. K. Fontaine, H. Chen, R. Ryf, D. T. Neilson, J. Carpenter, and G. Li, An ultra-broadband polarization-
insensitive optical hybrid using multiplane light conversion, J. Lightwave Technol. 38, 6286 (2020).
[30] H. Wen, H. Liu, Y. Zhang, P. Zhang, and G. Li, Mode demultiplexing hybrids for mode-division multiplexing coherent
receivers, Photon. Res. 7, 917 (2019).
[31] H. Wen, H. Liu, Y. Zhang, R. Sampson, S. Fan, and G. Li, Scalable Hermite-Gaussian mode-demultiplexing hybrids, Opt.
Lett. 45, 2219 (2020).
[32] K. LenglÂ´ e, X. Insou, P. Jian, N. BarrÂ´ e, B. Denolle, L. Bramerie, and G. Labroille, 4 Ã—10 Gbit/s bidirectional transmission
over 2 km of conventional graded-index OM1 multimode fiber using mode group division multiplexing, Opt. Express 24,
28594 (2016).
[33] J. Fang, J. Bu, J. Li, C. Lin, A. Kong, X. Yin, H. Luo, X. Song, Z. Xie, T. Lei, and X. Yuan, Performance optimization
of multi-plane light conversion (MPLC) mode multiplexer by error tolerance analysis, Opt. Express 29, 37852 (2021).12
[34] F. Brandt, M. HiekkamÂ¨ aki, F. Bouchard, M. Huber, and R. Fickler, High-dimensional quantum gates using full-field spatial
modes of photons, Optica 7, 98 (2020).
[35] X. Lin, Y. Rivenson, N. T. Yardimci, M. Veli, Y. Luo, M. Jarrahi, and A. Ozcan, All-optical machine learning using
diffractive deep neural networks, Science 361, 1004 (2018).
[36] M. Mounaix, N. K. Fontaine, D. T. Neilson, R. Ryf, H. Chen, J. C. Alvarado-Zacarias, and J. Carpenter, Time reversed
optical waves by arbitrary vector spatiotemporal field generation, Nat. Commun. 11, 5813 (2020).
[37] Y. Li, Z. Chen, D. M. Benton, M. Patel, M. P. J. Lavery, and A. D. Ellis, Single-wavelength polarization- and mode-division
multiplexing free-space optical communication at 689 Gbit/s in strong turbulent channels, Opt. Lett. 48, 3575 (2023).
[38] N. Yu and F. Capasso, Flat optics with designer metasurfaces, Nat. Mater. 13, 139 (2014).
[39] M. Khorasaninejad and F. Capasso, Metalenses: Versatile multifunctional photonic components, Science 358, eaam8100
(2017).
[40] A. Arbabi and A. Faraon, Advances in optical metalenses, Nat. Photonics 17, 16 (2022).
[41] N. A. Rubin, G. Dâ€™Aversa, P. Chevalier, Z. Shi, W. T. Chen, and F. Capasso, Matrix Fourier optics enables a compact
full-Stokes polarization camera, Science 365, eaax1839 (2019).
[42] E. Arbabi, S. M. Kamali, A. Arbabi, and A. Faraon, Full-Stokes imaging polarimetry using dielectric metasurfaces, ACS
Photonics 5, 3132 (2018).
[43] Q. Fan, M. Liu, C. Zhang, W. Zhu, Y. Wang, P. Lin, F. Yan, L. Chen, H. J. Lezec, Y. Lu, A. Agrawal, and T. Xu,
Independent amplitude control of arbitrary orthogonal states of polarization via dielectric metasurfaces, Phys. Rev. Lett.
125, 267402 (2020).
[44] Y. Bao, L. Wen, Q. Chen, C.-W. Qiu, and B. Li, Toward the capacity limit of 2D planar Jones matrix with a single-layer
metasurface, Sci. Adv. 7, eabh0365 (2021).
[45] H. Zheng, M. He, Y. Zhou, I. I. Kravchenko, J. D. Caldwell, and J. G. Valentine, Compound meta-optics for complete and
loss-less field control, ACS Nano 16, 15100 (2022).
[46] G. Soma, Y. Nomoto, T. Umezawa, Y. Yoshida, Y. Nakano, and T. Tanemura, Compact and scalable polarimetric self-
coherent receiver using a dielectric metasurface, Optica 10, 604 (2023).
[47] M. Faraji-Dana, E. Arbabi, A. Arbabi, S. M. Kamali, H. Kwon, and A. Faraon, Compact folded metasurface spectrometer,
Nat. Commun. 9, 4196 (2018).
[48] M. Faraji-Dana, E. Arbabi, H. Kwon, S. M. Kamali, A. Arbabi, J. G. Bartholomew, and A. Faraon, Hyperspectral imager
with folded metasurface optics, ACS Photonics 6, 2161 (2019).
[49] J. Oh, K. Li, J. Yang, W. T. Chen, M.-J. Li, P. Dainese, and F. Capasso, Adjoint-optimized metasurfaces for compact
mode-division multiplexing, ACS Photonics 9, 929 (2022).
[50] J. P. Balthasar Mueller, N. A. Rubin, R. C. Devlin, B. Groever, and F. Capasso, Metasurface polarization optics: inde-
pendent phase control of arbitrary orthogonal states of polarization, Phys. Rev. Lett. 118, 113901 (2017).
[51] A. Arbabi, Y. Horie, M. Bagheri, and A. Faraon, Dielectric metasurfaces for complete control of phase and polarization
with subwavelength spatial resolution and high transmission, Nat. Nanotechnol. 10, 937 (2015).
[52] S. Molesky, Z. Lin, A. Y. Piggott, W. Jin, J. VuckoviÂ´ c, and A. W. Rodriguez, Inverse design in nanophotonics, Nat.
Photonics 12, 659 (2018).
[53] K. Komatsu, G. Soma, S. Ishimura, H. Takahashi, T. Tsuritani, M. Suzuki, Y. Nakano, and T. Tanemura, Scalable
multi-core dual-polarization coherent receiver using a metasurface optical hybrid, J. Lightwave Technol. 42, 4013 (2024).
[54] Y. Bao, J. Ni, and C.-W. Qiu, A minimalist single-layer metasurface for arbitrary and full control of vector vortex beams,
Adv. Mater. 32, e1905659 (2020).
[55] D. Wen, F. Yue, G. Li, G. Zheng, K. Chan, S. Chen, M. Chen, K. F. Li, P. W. H. Wong, K. W. Cheah, E. Y. B. Pun,
S. Zhang, and X. Chen, Helicity multiplexed broadband metasurface holograms, Nat. Commun. 6, 8241 (2015).
[56] S. M. Kamali, E. Arbabi, A. Arbabi, Y. Horie, M. Faraji-Dana, and A. Faraon, Angle-multiplexed metasurfaces: Encoding
independent wavefronts in a single metasurface under different illumination angles, Phys. Rev. X 7, 041056 (2017).
[57] J. Jang, G.-Y. Lee, J. Sung, and B. Lee, Independent multichannel wavefront modulation for angle multiplexed meta-
holograms, Adv. Opt. Mater. 9, 2100678 (2021).
[58] L. Deng, R. Jin, Y. Xu, and Y. Liu, Structured light generation using angle-multiplexed metasurfaces, Adv. Opt. Mater.
11, 2300299 (2023).
[59] L. Jin, Y.-W. Huang, Z. Jin, R. C. Devlin, Z. Dong, S. Mei, M. Jiang, W. T. Chen, Z. Wei, H. Liu, J. Teng, A. Danner,
X. Li, S. Xiao, S. Zhang, C. Yu, J. K. W. Yang, F. Capasso, and C.-W. Qiu, Dielectric multi-momentum meta-transformer
in the visible, Nat. Commun. 10, 4789 (2019).
[60] H. Ren, G. Briere, X. Fang, P. Ni, R. Sawant, S. HÂ´ eron, S. Chenot, S. VÂ´ ezian, B. Damilano, V. BrÂ¨ andli, S. A. Maier, and
P. Genevet, Metasurface orbital angular momentum holography, Nat. Commun. 10, 2986 (2019).
[61] H. Ren, X. Fang, J. Jang, J. BÂ¨ urger, J. Rho, and S. A. Maier, Complex-amplitude metasurface-based orbital angular
momentum holography in momentum space, Nat. Nanotechnol. 15, 948 (2020).
[62] H. Zhou, B. Sain, Y. Wang, C. Schlickriede, R. Zhao, X. Zhang, Q. Wei, X. Li, L. Huang, and T. Zentgraf, Polarization-
encrypted orbital angular momentum multiplexed metasurface holography, ACS Nano 14, 5553 (2020).
[63] C. Menzel, C. Rockstuhl, and F. Lederer, Advanced Jones calculus for the classification of periodic metamaterials, Phys.
Rev. A 82, 053811 (2010).
[64] R. W. Gerchber and W. O. Saxton, A practical algorithm for determination of phase from image and diffraction plane
pictures, Optik 35, 237 (1972).
[65] M. Miyata, N. Nemoto, K. Shikama, F. Kobayashi, and T. Hashimoto, Full-color-sorting metalenses for high-sensitivity
image sensors, Optica 8, 1596 (2021).13
[66] W. T. Chen, A. Y. Zhu, and F. Capasso, Flat optics with dispersion-engineered metasurfaces, Nature Reviews Materials
5, 604 (2020).
[67] K. Matsushima, Shifted angular spectrum method for off-axis numerical propagation, Opt. Express 18, 18453 (2010).
[68] V. Liu and S. Fan, S4: A free electromagnetic solver for layered periodic structures, Comput. Phys. Commun. 183, 2233
(2012).14
METHODS
Metasurface design for mode multiplexer
To design the MS for mode multiplexing shown in Fig. 2a, we first numerically derived the spatial distributions of
design parameters ( Î±,Î², and Î³) required at four MS sections. The discretization spacing of the position rnin the
simulation was set to 1.2 Âµm (i.e., N= 250 Ã—300), which corresponded to twice the actual meta-atom spacing to be
fabricated (0.6 Âµm) to save the optimization cost. Thus, the entire device contained 900,000 (= 4 Ã—250Ã—300Ã—3)
parameters. From the thickness of the SiO 2substrate (625 Âµm) and the size of each MS section (300 Âµm), we set the
incident angle to be tanâˆ’1{300Âµm/(2Ã—625Âµm} âˆ¼13.5â—¦. For calculating the wave propagation at an oblique angle,
we employed the shifted angular spectrum method (ASM) [67]. After iterative optimization (see Supplementary Fig. 1
for the detailed flow), we obtained Fig. 2b.
We then derived the actual dimensions ( DÎ±, DÎ², Î³â€²) of each meta-atom as shown in Fig. 3a to achieve the optimal
parameters given in Fig. 2b. Note that due to the oblique incidence to the MS, Î³defined in Eq. (7) is not exactly the
same as the geometrical in-plane rotation angle Î³â€²of meta-atoms. We, therefore, distinguish them using the prime
symbol. The meta-atoms were placed on a square lattice with a lattice constant of 0.6 Âµm, which was less than the
wavelength to avoid higher-order diffraction. Therefore, new Jones matrix profiles J(l)(râ€²
n) on the square grid with
0.6Âµm spacing ( râ€²
n) were obtained by interpolating the optimal Jones matrices J(l)(rn) on the 1.2- Âµm-spacing grid
(rn) given in Fig. 2b. Since J(l)(râ€²
n) is not unitary in general, we approximated it with the unitary matrix U(l)(râ€²
n),
which was obtained through polar decomposition of J(l)(râ€²
n). The Jones matrix J(DÎ±, DÎ², Î³â€²) of the reflected light
from a periodic array of meta-atoms was simulated using the rigorous coupled-wave analysis (RCWA) [68] for s- and
p-polarization input at 1550-nm wavelength. The refractive indices of SiO 2, Si, polyimide, and Au were set to 1.444,
3.48, 1.574, and 0.38+ i10.75, respectively. Simulated Jones matrices in some parameters ( DÎ±, DÎ², Î³â€²) are shown in
Supplementary Fig. 2. Using these results, we derived geometrical parameters ( DÎ±, DÎ², Î³â€²) of the meta-atom at râ€²
nto
minimize/vextenddouble/vextenddoubleU(l)(râ€²
n)âˆ’J(DÎ±, DÎ², Î³â€²)/vextenddouble/vextenddouble2.
Device fabrication
The fabrication flow is shown in Supplementary Fig. 3. The folded MS device was fabricated on a silicon-on-quartz
(SOQ) substrate with a Si thickness of 0.57 Âµm. Positive EB resist (ZEP520A-7) was spin-coated, as well as the
anti-charging conductive polymer (ESPACER 300Z). The MS pattern was written on the resist using an EB writer
(ADVANTEST F7000S), the anti-charging layer was removed in de-ionized (DI) water, and the pattern was developed
in a resist developer (ZED-N50). Then, the pattern was transferred to the Si layer using RIE with SF 6and C 4F8gas,
known as the Bosch process, followed by O 2ashing process. After the polyimide (Toray LT-S5181C) was spin-coated
on the Si pattern, the device was annealed under a nitrogen atmosphere at 220â—¦C for 1 hour for a cure. In preliminary
experiments, we have confirmed the polyimide layer was embedded well, and the thickness of the polyimide layer on
Si was around 1 Âµm. Subsequently, a 200-nm-thick gold layer was deposited on the sample using a radio-frequency
(RF) sputtering process. Then, the sample was flipped and cleaned by O 2plasma ashing. The aperture patterns for
input and output were written on the spin-coated photoresist using a laser writer with the back-side alignment to
the MS patterns and then developed. Finally, mirror patterns were formed by a liftoff process after the deposition of
silver and gold layers (200 and 50 nm) using an EB evaporator.
Measurement
The laser light at 1550 nm was incident to the device from a fiber facet at an angle of 19.7â—¦after the input
polarization was set to Xpolarization by a polarization controller (PC). The input mode ( m) was controlled by
moving the SMF using a 6-axis fiber stage to the corresponding position. The emitted beam at the output plane
was magnified at ten times by using a 4-f system with an objective lens (Mitsutoyo: M Plan Apo NIR) and a tube
lens (Thorlabs: TTL200-S8) and imaged by an InGaAs camera (Artray: ARTCAM-991SWIR). To image the output
intensity profiles for XandYpolarization, we inserted a polarizer.15
Performance metrics for MDM dual-polarization coherent receiver
Coupling coefficients
We define the coupling coefficient to an output spot at the u-th row ( u= 1,2,3, and 4, corresponding to relative
phase shifts of 0, Ï€,Ï€/2, and 3 Ï€/2) and the v-th column ( v= 1,2, . . . , 6) with X-polarization as
cu,v,mâ‰¡/angbracketleftbig
gu,v/vextendsingle/vextendsingleaout
m/angbracketrightbig
=/summationdisplay
ngâˆ—
u,v(rn)aout
m,X(rn). (16)
where |gu,vâŸ©=/summationtext
ngu,v(rn)|n, XâŸ©is a normalized X-polarized Gaussian field centered at the ( u, v)-th spot and
aout
m,X(rn) =âŸ¨n, X|aout
mâŸ©is the X-polarized output field at rnfor the m-th input mode.
Insertion loss
The total insertion loss (IL) for the m-th mode signal is derived from the sum of the coupling efficiencies to the
four corresponding spots. We thus define IL as
ILmâ‰¡1/4/summationdisplay
u=1|cu,v=m,m|2. (17)
For the LO ( m= 7), IL is defined as
ILLOâ‰¡1/4/summationdisplay
u=16/summationdisplay
v=1|cu,v,m =7|2. (18)
Phase error
The phase error for the m-th mode signal is defined as the deviation from the ideal case of a 90â—¦optical hybrid,
which has Ï€/2 phase difference between the in-phase and quadrature components [31]. We thus have
|âˆ†Ï•m| â‰¡ |âˆ (c4,m,mâˆ’c3,m,m)âˆ’âˆ (c2,m,mâˆ’c1,m,m)âˆ’Ï€/2|. (19)
For the LO beam, the phase error in the output spots for the m-th mode is written as
|âˆ†Ï•LO,m| â‰¡ |âˆ (c4,m,m +c3,m,m)âˆ’âˆ (c2,m,m +c1,m,m)|. (20)
Then, we define the phase error for the LO as
|âˆ†Ï•LO| â‰¡ max
mâˆˆ{1,2,...,6}|âˆ†Ï•LO,m|. (21)
Power imbalance
The power imbalance for the m-th mode signal is defined as the ratio between the maximum and minimum values
of the coupling efficiencies at the four spots in the corresponding column:
Î¾mâ‰¡max
u|cu,v=m,m|2
min
u|cu,v=m,m|2. (22)
For the LO, the imbalance in the output spots for the m-th mode is written as
Î¾LO,mâ‰¡max
u|cu,v=m,m =7|2
min
u|cu,v=m,m =7|2. (23)
Then, we define the imbalance for the LO as
Î¾LOâ‰¡ max
mâˆˆ{1,2,...,6}Î¾LO,m. (24)16
Crosstalk
The crosstalk for the m-th mode signal is defined as the sum of the coupling efficiencies at 20 undesired spots other
than the four target spots,
Ï‡mâ‰¡4/summationdisplay
u=1/summationdisplay
vÌ¸=m|cu,v,m|2. (25)
DATA AVAILABILITY
All the simulation codes and data presented in the paper are available upon a reasonable request.
ACKNOWLEDGEMENTS
This work was obtained in part from the commissioned research (No. JPJ012368C08801) by National Institute
of Information and Communications Technology (NICT), Japan, and was partially supported by Japan Society of
Promotion of Science (JSPS) KAKENHI, Grant Number 24KJ0557, and World-leading Innovative Graduate Study
Program - Quantum Science and Technology Program (WINGS-QSTEP). The SOQ wafer was provided by Shin-Etsu
Chemical Co., Ltd. The device was fabricated in part at Takeda Cleanroom with help of Nanofabrication Platform
Center of School of Engineering, the University of Tokyo, Japan, supported by â€Advanced Research Infrastructure
for Materials and Nanotechnology in Japanâ€ of the Ministry of Education, Culture, Sports, Science and Technology
(MEXT) Grant Number JPMXP1224UT1115. G.S. thanks Ryota Tanomura for the fruitful discussion.
AUTHOR CONTRIBUTIONS
G.S. conceived the idea and performed the simulation, MS design, device fabrication, measurement, and data
analysis. K.K. assisted G.S. with the MS fabrication. Y.N. contributed to the overall discussion and provided
experiment facilities. T.T. led the project and provided high-level supervision. G.S. and T.T. wrote the manuscript.
COMPETING INTERESTS
The authors declare no competing interests.Supplementary Materials for
Complete vectorial optical mode converter using multi-layer metasurface
Go Soma,1,âˆ—Kento Komatsu,1Yoshiaki Nakano,1and Takuo Tanemura1,â€ 
1School of Engineering, The University of Tokyo, Bunkyo-ku, Tokyo 113-8656, Japan
Supplementary Note 1. DERIVATION OF EQUATION (13) ANDâˆ‚J(l)
âˆ‚Î¸(l)
Here, we derive Eq. (13) in the main text. From the objective function Edefined in Eq. (9), its derivativeâˆ‚E
âˆ‚Î¸(l)(rn)
is expressed as
âˆ‚E
âˆ‚Î¸(l)(rn)=1
M/summationdisplay
m2 Re/bracketleftbigg/angbracketleftbig
aout
m/vextendsingle/vextendsingleatar
m/angbracketrightbig/angbracketleftbigg
atar
m/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingleaout
m/angbracketrightbigg/bracketrightbigg
, (S1)
where Re[ z] describes the real part of the complex number z. We should note thatâˆ‚
âˆ‚Î¸(l)(rn)is effective only on Ë†J(l)
and not on other operators or |atar
mâŸ©, which are independent on the meta-atom structures. As a result, we obtain
/angbracketleftbigg
atar
m/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingleaout
m/angbracketrightbigg
=/angbracketleftbigg
atar
m/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚
âˆ‚Î¸(l)(rn)Ë†F(L)Ë†J(L)Â·Â·Â·Ë†F(l)Ë†J(l)/vextendsingle/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightbigg
=/parenleftï£¬ig
Ë†F(l)â€ Â·Â·Â·Ë†J(L)â€ Ë†F(L)â€ /vextendsingle/vextendsingleatar
m/angbracketrightbig/parenrightï£¬igâ€ âˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightï£¬ig
=/angbracketleftï£¬igg
b(l)
m/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightï£¬igg(S2)
Here,â€ is the Hermitian conjugate, so that Ë†F(l)â€ physically describes the backward propagation in the free space from
(l+ 1)-th plane to l-th plane. âŸ¨b(l)
m|is the adjoint vectorial field defined in Eq. (14), which represents the vectorial
field on the output of the l-th MS when the target field |atar
mâŸ©is propagated backward.
From the definition of the meta-atom operator Ë†J(l)in Eq. (5),âˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)in Eq. (S2) is written as
âˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)=/summationdisplay
p,pâ€²âˆ‚j(l)
ppâ€²(rn)
âˆ‚Î¸(l)(rn)|n, pâŸ©âŸ¨n, pâ€²|. (S3)
Finally, by inserting Eqs. (S2) and (S3) to Eq. (S1) and using Eq. (6), we obtain
âˆ‚E
âˆ‚Î¸(l)(rn)=2
M/summationdisplay
mRe/bracketleftï£¬igg
/angbracketleftbig
aout
m/vextendsingle/vextendsingleatar
m/angbracketrightbig/angbracketleftï£¬igg
b(l)
m/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleâˆ‚Ë†J(l)
âˆ‚Î¸(l)(rn)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea(l)
m/angbracketrightï£¬igg/bracketrightï£¬igg
=2
M/summationdisplay
mRe/bracketleftbigg/angbracketleftbig
aout
m/vextendsingle/vextendsingleatar
m/angbracketrightbig
{b(l)
m(rn)}â€ âˆ‚J(l)(rn)
âˆ‚Î¸(l)(rn)a(l)
m(rn)/bracketrightbigg
.(S4)
Here, we define a(l)
m(rn) and b(l)
m(rn) as
a(l)
m(rn)â‰¡/parenleftï£¬igg
a(l)
m,X(rn)
a(l)
m,Y(rn)/parenrightï£¬igg
,b(l)
m(rn)â‰¡/parenleftï£¬igg
b(l)
m,X(rn)
b(l)
m,Y(rn)/parenrightï£¬igg
. (S5)
âˆ—go.soma@tlab.t.u-tokyo.ac.jp
â€ tanemura@ee.t.u-tokyo.ac.jparXiv:2401.05127v2  [physics.optics]  3 Sep 20242
From the Jones matrix of a birefringent meta-atom described in Eq. (8),âˆ‚J(l)
âˆ‚Î¸(l)can be expressed explicitly as
âˆ‚J(l)(rn)
âˆ‚Î±(l)(rn)=ieiÎ±(l)(rn)/parenleftbigg
cos2Î³(l)(rn)1
2sin 2Î³(l)(rn)
1
2sin 2Î³(l)(rn) sin2Î³(l)(rn)/parenrightbigg
, (S6)
âˆ‚J(l)(rn)
âˆ‚Î²(l)(rn)=ieiÎ²(l)(rn)/parenleftbigg
sin2Î³(l)(rn)1
2sin 2Î³(l)(rn)
1
2sin 2Î³(l)(rn) cos2Î³(l)(rn)/parenrightbigg
, (S7)
âˆ‚J(l)(rn)
âˆ‚Î³(l)(rn)=/parenleftï£¬ig
eiÎ±(l)(rn)âˆ’eiÎ²(l)(rn)/parenrightï£¬ig/parenleftbigg
âˆ’sin 2Î³(l)(rn) cos 2 Î³(l)(rn)
cos 2Î³(l)(rn) sin 2 Î³(l)(rn)/parenrightbigg
. (S8)
Supplementary Note 2. MEASUREMENT OF COMPLEX FIELD PROFILES AND COUPLING
MATRIX USING OFF-AXIS HOLOGRAPHY
To characterize the complex field profile of the output beam from the mode multiplexer, we employed the off-axis
holography method. The measurement setup is shown in Supplementary Fig. 4(a). A continuous wave (CW) from
a tunable laser source (TLS) at 1550 nm was split to the signal and reference paths through the 50/50 coupler.
The signal light was incident to the device after the input polarization was set to Xpolarization by a polarization
controller (PC). The position and angle of input SMF were controlled by a 6-axis fiber stage. The signal at the output
plane was magnified at ten times using a 4-f system with an objective lens (Mitsutoyo: M Plan Apo NIR) and a tube
lens (Thorlabs: TTL200-S8). Then, it was combined with the reference beam at a tilted angle by a beam splitter to
generate interference fringes at an InGaAs camera (Artray: ARTCAM-991SWIR). The polarization of the reference
light was switched to XorYby using a PC to select each polarization component.
From the captured fringe patterns, we retrieved the complex field profiles aout,meas
m,p (r) as shown in Supplementary
Fig. 4(b). Using these results, we calculated the coupling matrix Câ€², where Câ€²
mmâ€²=|âŸ¨atar
m|aout,meas
mâ€²âŸ©|2. Supplementary
Fig. 4(c) shows the calculated coupling matrix.
Supplementary Note 3. WAVELENGTH DEPENDENCE
We investigate the wavelength dependence of the MDM polarization-diversity coherent receiver designed in the
main text. Supplementary Fig. 6 shows the simulated performances as a function of wavelength. Here, we ignore the
wavelength dependence of each meta-atom, which is a valid assumption for the wavelength range (1530-1570 nm) of
our interest. Insertion loss, phase error, power imbalance, and crosstalk are suppressed below 3.5 dB, 11â—¦, 2.1 dB,
and â€“19 dB at all wavelengths from 1530 to 1570 nm. These wavelength dependencies are expected to be improved
further by employing the optimization at multiple wavelengths simultaneously.
Supplementary Note 4. DEPENDENCE OF THE NUMBER OF METASURFACE LAYERS
We investigate the dependence of the number of metasurface layers on the performance of the MDM polarization-
diversity coherent receiver. Supplementary Fig. 7 shows the simulated performances as a function of the number of
metasurface layers. We can confirm that the performance generally improves by increasing the metasurface layers L.
In practice, however, optical insertion loss and sensitivity to fabrication errors increase as we increase the number of
layers. There is, therefore, an optimal number of layers to maximize performance under actual conditions.3
Initialization:ğ¿,ğ‘€,ğ‘,â„±,ğ’“!;(ğ‘"#$*,|ğ‘"%&'âŸ©	(ğ‘š=1,2,â€¦,ğ‘€);ğ¹6(ğ‘™=0,1,â€¦,ğ¿;ğ›¼(()ğ«!,ğ›½(()ğ«!,ğ›¾(()ğ«!	ğ‘›=1,2,â€¦,ğ‘;ğ‘™=1,2,â€¦,ğ¿;â€¢Forward propagation: Derive >ğ‘"(()?[Eq. (3)];â€¢Calculate objective function â„°[Eq. (9)];â€¢Backward propagation: Derive >ğ‘"(()?[Eq. (14)];â€¢Calculate gradients ğœ•â„°ğœ•ğœƒ(()(ğ’“!)â„[Eq. (13)];â€¢Update parameters ğœƒ(()(ğ’“!)[Eq. (12)];â„°is converged?EndNoYes
Supplementary Fig. 1. Optimization flow of deriving the metasurface parameters. Initially, the MS parameters of
Î±(l)(rn),Î²(l)(rn) and Î³(l)(rn) are uniformly set to 0, Ï€/2, and Ï€/4, respectively, to prevent zero gradients in this
work. In each iteration of optimization, we first calculate |a(l)
mâŸ©for each mode by computing the forward propagation
given by Eq. (3) and derive Eusing Eq. (9). Similarly, back-propagated fields |b(l)
mâŸ©are obtained by computing
Eq. (14). Here, we use the angular spectrum method (ASM) [1, 2] in the calculation of the free-space propagation.
Then,âˆ‚E
âˆ‚Î¸(l)(rn)are calculated using Eq. (13). Finally, we update the parameters through Eq. (12). In this work, we
use the adaptive moment estimation (ADAM) algorithm [3] as an optimizer for efficient updating of parameters.
These procedures are repeated until the objective function converges4
00.600.600.600.600.600.6ğ½!!ğ½!"ğ½""
ğ·#(Î¼m)ğ·#(Î¼m)ğ›¾â€²=0
ğ›¾â€²=ğœ‹/6
ğ›¾â€²=ğœ‹/4ğ£$%ğ£&'(=ğ‰ğ£)*13.5Â°0.57 Î¼mAuPolyimideSiO21 Î¼m
ğ›¾â€²ğ·!ğ·"
1
0Amplitude
Phaseâ€“ğœ‹ğœ‹(a)
(b)0.6 Î¼m0.6 Î¼m
Supplementary Fig. 2. (a) Schematic of a periodic reflective meta-atom array used to design the mode
multiplexer. (b) Calculated Jones matrices of reflected light at 1550-nm wavelength as a function of DÎ±,DÎ², and Î³â€².5
c-SiSiO2ZEP520A-7SOQ substrateEB lithographyZPNresistBosch processPolyimide coating & Au sputtering
FlipPhotolithographyAg/Au depositionLift offAg/AuPolyimide/Au
Supplementary Fig. 3. Schematic of the process flow used to fabricate the mode multiplexer chip.
Xpol.Ypol.Input mode ğ‘š123456(b)
MS
PCPCLaser@1550 nmReferenceSignalObj.Pol.TubelensBSCLNIR camera(a)
(c)
Norm. coupling (linear)
01
Input mode (ğ‘š)Target mode (ğ‘š)123456123456
VOAVOA
50 Î¼m
Supplementary Fig. 4. (a) Measurement setup based on the off-axis holography. PC: polarization controller.
Obj.: objective lens. Pol.: polarizer. VOA: variable optical attenuator. CL: collimation lens. BS: beam splitter. (b)
Reconstructed complex field profiles of the output beams for different input modes. (c) Calculated coupling matrix.6
1-xMode (ğ‘š) â€“Polarization (ğ‘)1-y2-y3-y2-x3-x4-x4-y5-x5-y6-x6-y7-x7-yLayer number (ğ‘™)1Input23456Output
100 Î¼m
Supplementary Fig. 5. Simulated field profiles a(l)
m,p(r) (l= in,1,2, . . . , 6,out; m= 1,2, . . . , 7;p=X, Y ) of the
MDM dual-polarization coherent receiver.7
1.531.541.551.561.57Wavelength (Î¼m)â€“32â€“30â€“28â€“26â€“24â€“22â€“20â€“18Crosstalk (dB)1.531.541.551.561.5700.511.522.5
Wavelength (Î¼m)Power imbalance (dB)1.531.541.551.561.57-10-5051015
Wavelength (Î¼m)Phase error (deg)(a)(b)
(c)(d)
Signal (m=1~6)LO (m=7)LP01â€“x (m=1)LP01â€“y (m=2)LP11aâ€“x (m=3)LP11aâ€“y (m=4)LP11bâ€“x (m=5)LP11bâ€“y (m=6)â‰ˆ1.531.541.551.561.570.511.522.533.5
Wavelength (Î¼m)Insertion loss (dB)
Supplementary Fig. 6. Simulated wavelength dependence of the MDM dual-polarization coherent receiver: (a)
Insertion losses, (b) phase errors, (c) power imbalances, and (d) crosstalk.8
234567Number of Layer ğ¿â€“30â€“25â€“20â€“15â€“10Crosstalk (dB)234567051015
Number of Layer ğ¿Phase error (deg)
2345670123456
Number of Layer ğ¿Power mbalance (dB)
LOSignal (mean)(a)(b)
(c)(d)23456701234
Number of Layer ğ¿Insertion loss (dB)
Supplementary Fig. 7. Performance of the MDM dual-polarization coherent receiver as a function of the number
of metasurface layers L: (a) efficiency, (b) phase error, (c) power imbalance, and (d) crosstalk. Averaged values of
six modes are plotted for the signal.9
[1] K. Matsushima and T. Shimobaba, Band-limited angular spectrum method for numerical simulation of free-space propaga-
tion in far and near fields, Opt. Express 17, 19662 (2009).
[2] K. Matsushima, Shifted angular spectrum method for off-axis numerical propagation, Opt. Express 18, 18453 (2010).
[3] D. P. Kingma and J. Ba, Adam: A method for stochastic optimization, arXiv[cs.LG] 1412.6980 (2014).