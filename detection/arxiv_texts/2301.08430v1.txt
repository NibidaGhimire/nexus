arXiv:2301.08430v1  [math.DG]  20 Jan 2023Heat kernel on Ricci shrinkers (II)
Yu Li and Bing Wang
January 23, 2023
Abstract
This paper is the sequel to our study of heat kernels on Ricci s hrinkers in [28]. In this paper,
we improve many estimates in [28] and extend the recent progr ess of Bamler [2]. In particular,
we drop the compactness and curvature boundedness assumpti ons and show that the theory of
F-convergence holds naturally on any Ricci ﬂows induced by Ri cci shrinkers.
Contents
1 Introduction 1
2 Preliminaries 6
3 Variance, H-center and Nash entropy 9
4 Heat kernel estimates 26
5 Parabolic neighborhoods and ǫ-regularity theorem 39
6 Metric ﬂows and F-convergence 46
Appendix 59
A Integral estimates for the conjugate heat kernel 59
1 Introduction
A Ricci shrinker ( Mn,g,f) is a complete Riemannian manifold ( Mn,g) coupled with a smooth
function fsatisfying
Rc+Hess f=1
2g, (1.1)
1where the potential function fis normalized so that
R+|∇f|2=f. (1.2)
The study of shrinkers is an essential component of analyzin g the singularity formation of so-
lutions to the Ricci ﬂow. For a Ricci ﬂow with type-I curvatur e bound, it is proved by Enders-
M¨ uller-Topping [19] that any proper blow-up sequence conv erges smoothly to a nontrivial Ricci
shrinker. For general compact Ricci ﬂows, it is proved by Bam ler [4] that the ﬁnite-time singulari-
ties are modeled on Ricci shrinkers containing a singular se t by using the theory of F-convergence
developed in [2, 3, 4].
In dimension 2 or 3, all Ricci shrinkers are completely class iﬁed (cf. [21][31][33][8], etc). We
know thatR2,S2,R3,S3,S2×Rand their quotients form the complete list. In particular, a ll low-
dimensional Ricci shrinkers have bounded and nonnegative s ectional curvature.
In higher dimensions, the complete classiﬁcation of Ricci s hrinkers seems out of reach. Subject
to an additional curvature positivity assumption, some par tial classiﬁcations are also known (cf.
[31][29][26][25][32]). In general, it is still unclear if t here exists any Ricci shrinker with unbounded
sectional curvature.
On the one hand, Ricci shrinkers can be regarded as critical m etrics which generalize the classi-
cal positive Einstein manifolds. On the other hand, for any R icci shrinker, there exists an associated
self-similar solution to the Ricci ﬂow (cf. Section 2). As a s pecial class of Ricci ﬂows, Ricci
shrinkers have many known important properties of compact R icci ﬂows. In [28], many funda-
mental analytic tools, including the maximum principle, op timal log-Sobolev constant estimate, the
no-local-collapsing theorems, etc., are established for R icci ﬂows associated with Ricci shrinkers.
Many heat kernel estimates include the di ﬀerential Harnack inequality and the pseudolocality theo-
rem are also known in [28].
In this paper, we continue to focus on Ricci ﬂows associated w ith Ricci shrinkers without any
curvature assumption. Based on the techniques and results i n [28] and [2], we further obtain results,
including a Gaussian bound on the heat kernel, no-local-col lapsing and non-expanding estimates,
anǫ-regularity theorem, etc. All those results are stronger th an their counterparts in [28]. It is
important to notice that we have no assumption of curvature a t all. If we assume bounded curvature
on non-compact manifold, then many results are already know n (cf. [5] [10]).
The pointed Nash entropy (cf. Deﬁnition 3.18) plays an impor tant role in [2], which ﬁrst appears
in [34, Section 5] and is systematically studied in [23]. In [ 28], we use Perelmam’s entropy µ(see
(2.1)) to characterize the optimal log-Sobolev constant an d the local non-collapsing. The pointed
Nash entropy, which is always bounded below by µ, has the advantage of being local in the space-
time of Ricci ﬂows. In [23], it is proved that the Nash entropy is Lipschitz. Moreover, the oscillation
of the Nash entropy in the spacetime is established in [2]. We generalize the Nash entropy and its
fundamental estimates to the Ricci ﬂows associated with Ric ci shrinkers; see Theorem 3.23 and
Corollary 4.19.
Theorem 1.1. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. Then for an y
s<t<1, the Nash entopyN∗
s(x,t) :=N(x,t)(t−s)is smooth and satisﬁes the following estimates
on M×(s,1).
|∇N∗
s|≤/radicalbiggn
2(t−s)and−n
2(t−s)≤/squareN∗
s≤0. (1.3)
2The proof of (1.3) is based on an integral estimate of the heat kernel (cf. Theorem 3.16), which
was initially obtained in [2] for compact Ricci ﬂows. A key ap plication of Theorem 1.1 is to estimate
the local oscillation of the Nash entropy (cf. Corollary 3.2 5). Using the Nash entropy properties
and the heat kernel estimates, we obtain the improved no-loc al-collapsing and non-expanding result
(cf. Theorem 4.2 and Theorem 4.7).
Theorem 1.2 (No-local-collapsing and non-expanding ).Let(Mn,g(t))t<1be the Ricci ﬂow asso-
ciated with a Ricci shrinker. For any x ∈M and t<1,
|Bt(x,r)|t≤C(n) exp/parenleftig
Nx,t(r2)/parenrightig
rn
and if R≤r−2on B t(x,r), then
|Bt(x,r)|t≥c(n) exp/parenleftig
Nx,t(r2)/parenrightig
rn.
Note thatNx,t(r2)≤0 (cf. Corollary 3.22), it is clear that Theorem 1.2 provides a uniform
volume ratio upper bound, independent of base point and radi us. This clearly improves the known
volume upper bounds (cf. [9], [22], [24]). On the other hand, asµ≤N x,t(r2), the non-collapsing
estimate in Theorem 1.2 also improves the one in [28].
An important concept introduced in [2] is the H-center (cf. Deﬁnition 3.11). Roughly speaking,
anH-center is a point around which the conjugate heat kernel is c oncentrated (cf. Proposition 3.13).
In addition, for any two conjugate heat kernels, the W1-Wasserstein distance between them can be
roughly measured by the distance between two H-centers. We prove the existence of an Hn-center,
where Hn=(n−1)π2/2+4, for any conjugate heat kernel, by generalizing the monoto nicity of
the variance obtained in [2] to our setting (cf. Proposition 3.10, Proposition 3.12). By using these
concepts and related techniques, we have the following heat kernel estimates (cf. Theorem 4.9,
Theorem 4.15, Theorem 4.16).
Theorem 1.3 (Heat kernel estimates ).Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci
shrinker satisfying µ≥−A. Then the following properties hold.
(i) There exists a constant C =C(n,A,δ)>1such that
C−1
(t−s)n
2exp/parenleftigg
−d2
s(x,y)
C−1(t−s)/parenrightigg
≤H(x,t,y,s)≤C
(t−s)n
2exp/parenleftigg
−d2
s(x,y)
C(t−s)/parenrightigg
(1.4)
for any−δ−1≤s<t≤1−δand d t(p,x)≤δ−1.
(ii) For any ǫ >0, there exists a constant C =C(n,ǫ)>0such that
H(x,t,y,s)≤Cexp/parenleftbig−N (x,t)(t−s)/parenrightbig
(t−s)n
2exp/parenleftigg
−d2
s(z,y)
(4+ǫ)(t−s)/parenrightigg
, (1.5)
for any s<t<1and any H n-center (z,s)of(x,t).
Here, the point pis a minimum point of f, regarded as the Ricci shrinker’s base point. The
Gaussian estimate (1.5) is previously proved in [2] for comp act Ricci ﬂows, with 4 +ǫreplaced
3by 8+ǫ. Our proof uses an iteration argument by showing that if (1.5 ) fails, one can ﬁnd a new
spacetime point ( x′,t′) with an Hn-center ( z′,s) such that H(x′,t′,y,s) has a worse bound than (1.5).
Eventually, we will arrive at a contradiction if t′is suﬃciently close to s. The proof in our case is
more involved since we do not have a global heat kernel bound a s (1.5) when tis close to s, which
is always available for compact Ricci ﬂows. Therefore, in th e iteration process, we must carefully
choose the sequence of spacetime points, so they all fall int o a compact set. Then the contradiction
comes from the local heat kernel estimate (cf. Corollary 4.1 2) since locally the scalar curvature is
bounded.
Once we have the estimate (1.5), the upper bound in (1.4) foll ows since the distance between
(x,s) and ( z,s) can be well-controlled. Moreover, the lower bound in (1.4) is already contained in
[28] in a diﬀerent guise. We also obtain the gradient estimate of the heat kernel; see Theorem 4.6.
By the monotonicity of the W1-Wasserstein distance between two conjugate heat kernels ( cf.
Proposition 3.7), it is natural to consider new P∗-parabolic neighborhoods in the spacetime of the
Ricci ﬂow, as pointed out in [2] (cf. Deﬁnition 5.1, (5.1), (5 .2)). Comparing the P∗-parabolic neigh-
borhoods with the conventional ones, we have the following r esult (cf. Proposition 5.7, Proposition
5.9, Proposition 5.10, Proposition 5.13).
Theorem 1.4. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker satisfying µ≥−A.
Then the following properties hold.
(i) Givenδ∈(0,1), t0∈(−∞,1), T±≥0and S≥0, there exists a constant C =C(n,A,δ)>1
such that
P∗(p,t0;S,−T−,T+)⊂Q(p,t0;√
2S+C,−T−,T+)⊂P∗(p,t0;√
2S+2C,−T−,T+)
provided that t 0−T−≥−δ−1.
(ii) There exists a constant ρ=ρ(n,A)∈(0,1)satisfying the following property. Given (x0,t0)∈
M×(−∞,1)and r>0, suppose that R≤r−2on P (x0,t0;r,−(ρr)2,(ρr)2). Then
P(x0,t0;ρr)⊂P∗(x0,t0;r,−(ρr)2,(ρr)2)and P∗(x0,t0;ρr)⊂P(x0,t0;r,−(ρr)2,(ρr)2).
The proof of Theorem 1.4 involves the distance distortion es timates globally with respect to
pand locally under the scalar curvature control. Moreover, o ne needs to locate the Hn-center of
(p,t0) or ( x0,t0). Notice that, if t0+T+<1, Theorem 1.4 implies that any P∗(p,t0;S,−T−,T+)
is precompact, i.e., its closure is compact. By using the est imates of the Nash entropy and P∗-
neighborhoods, one has the following ǫ-regularity theorem (cf. Theorem 5.15), which is proved in
[2] for compact Ricci ﬂows. Here, rRmis the spacetime curvature radius, whose deﬁnition can be
found in Deﬁnition 5.14.
Theorem 1.5 (ǫ-regularity theorem ).There exists a small constant ǫ=ǫ(n)>0satisfying the
following property.
Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. Given (x,t)∈M×(−∞,1)
and r>0, suppose thatN(x,t)(r2)≥−ǫ, then r Rm(x,t)≥ǫr.
4Based on the results and techniques generalized (or slightl y improved) from [2], we can gen-
eralize the theory about metric ﬂows and F-convergence in [3] and [4] from compact Ricci ﬂows
to the setting of Ricci ﬂows associated with or induced by Ric ci shrinkers (cf. Deﬁnition 2.2). In
particular, a pointed Ricci ﬂow induced by a Ricci shrinker c an be regarded as a metric ﬂow pair in
the sense of [3, Deﬁnition 5.1]. Therefore, any sequence of p ointed Ricci shrinkers induced by Ricci
shrinkers withµ≥−A, by taking a subsequence, will F-converge to a limit metric ﬂow admitting
concrete structure theorems (cf. Theorem 6.10, Theorem 6.1 2). As an application of the theory of
F-convergence, we have the following two-sided pseudolocal ity theorem. Notice that the forward
pseudolocality theorem is proved in [28, Theorem 24]. Thus, to obtain a two-sided pseudolocality,
it suﬃces to obtain a backward pseudolocality, which is proved in T heorem 6.21.
Theorem 1.6 (Two-sided pseudolocality theorem ).For anyα > 0, there is an ǫ(n,α)>0such
that the following holds.
Let(Mn,g(t))t<1be a Ricci ﬂow associated with a Ricci shrinker. Given (x0,t0)∈M×(−∞,1)
and r>0, if
|Bt0(x0,r)|≥αrn,|Rm|≤(αr)−2on B t0(x0,r),
then
|Rm|≤(ǫr)−2on P (x0,t0; (1−α)r,−(ǫr)2,(ǫr)2).
Another application of the F-converge is the following integral estimate of curvature, which
originates from the estimate of Cheeger-Naber [12]. For mor e details, see Theorem 6.23 and Corol-
lary 6.24.
Theorem 1.7. Let(Mn,g,f,p)be a Ricci shrinker in M(A). Then
/integraldisplay
d(p,·)≤r|Rm|2−ǫdV≤/integraldisplay
d(p,·)≤rr−4+2ǫ
RmdV≤Crn+2ǫ−2,
/integraldisplay
d(p,·)≥1|Rm|2−ǫ
dn+2ǫ−2(p,·)dV≤/integraldisplay
d(p,·)≥1r−4+2ǫ
Rm
dn+2ǫ−2(p,·)dV≤C
for anyǫ >0and r≥1, where r Rm(·)=rRm(·,0)and C=C(n,A,ǫ).
This paper is organized as follows. Section 2 discusses some properties of Ricci ﬂows associated
with Ricci shrinkers, including the existence of cuto ﬀfunctions and maximum principles. In Section
3, we prove some estimates and properties regarding the vari ance, H-centers and the Nash entropy.
Section 4 focuses on various estimates of the heat kernel. In Section 5, we prove the theorems about
the parabolic neighborhoods and the ǫ-regularity theorem. In the last section, we generalize the
theory ofF-convergence in our setting and prove some applications in R icci shrinkers.
Acknowledgements :
Yu Li is supported by YSBR-001, NSFC-12201597 and research f unds from USTC (University
of Science and Technology of China) and CAS (Chinese Academy of Sciences). Bing Wang is
supported by YSBR-001, NSFC-11971452, NSFC-12026251 and a research fund from USTC.
52 Preliminaries
For any Ricci shrinker ( Mn,g,f), the scalar curvature R≥0 from [14, Corollary 2 .5] and R>0
unless ( Mn,g) is isometric to the Gaussian soliton ( Rn,gE), by the strong maximum principle.
With the normalization (1.2), the entropy is deﬁned as
µ=µ(g)≔log/integraldisplaye−f
(4π)n/2dV. (2.1)
Notice that eµis uniformly comparable to the volume of the unit ball B(p,1) (cf. [24, Lemma
2.5]). It was proved in [28, Theorem 1] that µis the optimal log-Sobolev constant for all scales.
Following [27], we have the following deﬁnition.
Deﬁnition 2.1. LetM(A)be the family of Ricci shrinkers (Mn,g,f)satisfying
µ(g)≥−A. (2.2)
Recall that any Ricci shrinker ( Mn,g,f) can be considered a self-similar solution to the Ricci
ﬂow. Letψt:M→Mbe a family of diﬀeomorphisms generated by1
1−t∇fandψ0=id. In other
words, we have
∂
∂tψt(x)=1
1−t∇f/parenleftig
ψt(x)/parenrightig
. (2.3)
It is well known that the rescaled pull-back metric g(t)≔(1−t)(ψt)∗gsatisﬁes the Ricci ﬂow
equation for any−∞<t<1,
∂tg=−2Rcg(t)and g(0)=g. (2.4)
Sometimes we encounter Ricci ﬂow obtained from the above Ric ci ﬂow through time-shifting and
rescaling. We emphasize whether there exist extra time-shi fting and rescaling by the following
deﬁnition.
Deﬁnition 2.2. For any Ricci shrinker, the Ricci ﬂow deﬁned in (2.4) is called the associated Ricci
ﬂow. Any Ricci ﬂow obtained from the associated Ricci ﬂow via tim e-shifting and rescaling is called
theRicci ﬂow induced by a Ricci shrinker .
Clearly, a Ricci ﬂow associated to a Ricci shrinker must be a R icci ﬂow induced by a Ricci
shrinker, but the reverse is generally not true. In this arti cle, if not mentioned explicitly, the associ-
ated Ricci ﬂow is the default one.
Next, we recall the function F(x,t) :=¯τf(x,t), where ¯τ:=1−tand f(x,t) :=(ψt)∗f, satisﬁes
the following identities (see [28, Section 2] for proofs):
∂tf=|∇f|2, (2.5)
∂tF=−¯τR, (2.6)
¯τR+∆F=n
2, (2.7)
¯τ2R+|∇F|2=F, (2.8)
/squareF=−n
2. (2.9)
6Here, we deﬁne/square:=∂t−∆tand have dropped the subscript g(t) ortif there is no confusion. Based
on these identities, we have the following estimates of F.
Lemma 2.3 (Lemma 1 of [28]) .There exists a point p ∈M where F attains its inﬁmum and F
satisﬁes the quadratic growth estimate
1
4(dt(x,p)−5n¯τ−4)2
+≤F(x,t)≤1
4/parenleftig
dt(x,p)+√
2n¯τ/parenrightig2(2.10)
for all x∈M and t<1, where a+:=max{0,a}.
Thanks to (2.10), F(x,t) grows like d2
t(x,p)/4 and hence one can obtain a family of cuto ﬀfunc-
tions by composing Fwith a cutoﬀfunction onR. More precisely, we ﬁx a function η∈C∞([0,∞))
such that 0≤η≤1,η=1 on [0,1] andη=0 on [2,∞). Furthermore,−C≤η′/η1
2≤0 and|η′′|≤C
for a universal constant C>0. For each r≥1, we deﬁne
φr≔η/parenleftbiggF
r/parenrightbigg
. (2.11)
Thenφris a smooth function on M×(−∞,1). The following estimates of φrare proved in [28,
Lemma 3]:
(φr)−1|∇φr|2≤Cr−1, (2.12)
|φr
t|≤C¯τ−1, (2.13)
|∆φr|≤C(¯τ−1+r−1), (2.14)
|/squareφr|≤Cr−1, (2.15)
where the constant Cdepends only on the dimension n.
For later applications, we recall the following volume esti mate proved in [28, Lemma 2].
Lemma 2.4. There exists a constant C =C(n)>0such that for any Ricci shrinker (Mn,g,f)with
p∈M a minimum point of f ,
|Bt(p,r)|t≤Crn.
Next, we recall the following version of the maximum princip le on Ricci shrinkers, which is
proved in [28, Theorem 6] and will be frequently used.
Theorem 2.5 (Maximum principle on Ricci shrinkers I) .Let(M,g(t))t<1be the Ricci ﬂow associated
with a Ricci shrinker. Given any closed interval [a,b]⊂(−∞,1)and a function u which satisﬁes
/squareu≤0on M×[a,b], suppose that
/integraldisplayb
a/integraldisplay
Mu2
+(x,t)e−2f(x,t)dVt(x)dt<∞. (2.16)
If u(·,a)≤c, then u (·,b)≤c.
We also need the following version of the maximum principle, which is proved in [18, Theorem
12.14] for Ricci ﬂows with bounded curvature. Notice that if X≡0, Theorem 2.6 follows from
Theorem 2.5.
7Theorem 2.6 (Maximum principle on Ricci shrinkers II) .Let(M,g(t))t<1be the Ricci ﬂow asso-
ciated with a Ricci shrinker. Given any closed interval [a,b]⊂(−∞,1)and a function u which
satisﬁes
Lu:=/squareu−/a\}b∇acke⊔le{⊔∇ u,X(t)/a\}b∇acke⊔∇i}h⊔≤0
on M×[a,b], suppose that X (t)is a bounded vector ﬁeld on M ×[a,b]and
u(x,t)≤Kek f(x,t)(2.17)
on M×[a,b]for some constants K >0and k<1. If u (·,a)≤c, then u (·,b)≤c.
Proof. We ﬁrst construct a barrier function
φ(x,t) :=KeB(t−a)+(1−ǫ)f(x,t),
where 1−ǫ >kandBis a constant determined later.
Claim: There exists a constant B>0 such that
Lφ≥φ. (2.18)
Proof of Claim : By direct computations, we have
Lφ=φ/parenleftig
B+(1−ǫ)ft−(1−ǫ)2|∇f|2−(1−ǫ)∆f−(1−ǫ)/a\}b∇acke⊔le{⊔∇f,X/a\}b∇acke⊔∇i}h⊔/parenrightig
=φ/parenleftigg
B+ǫ(1−ǫ)|∇f|2−n(1−ǫ)
2¯τ+(1−ǫ)R−(1−ǫ)/a\}b∇acke⊔le{⊔∇f,X/a\}b∇acke⊔∇i}h⊔/parenrightigg
≥φ/parenleftigg
B+ǫ(1−ǫ)|∇f|2−C1|∇f|−n(1−ǫ)
2(1−b)/parenrightigg
,
where we have used (2.6), (2.7) and the assumption that |X|≤C1. Therefore, (2.18) holds if we
choose
B=C2
1
4ǫ(1−ǫ)+n(1−ǫ)
2(1−b)+1.
Now, we assume c=0 by considering u−cinstead of u. To complete the proof, we only need
to verify that for any δ >0,u≤δφonM×[a,b]. Otherwise, then there exists ( x′,t′)∈M×[a,b]
such that (u−δφ)(x′,t′)>0. Due to the estimate (2.17) and our deﬁnition of φ, we know that
(u−δφ)(x,t)−→−∞ asdt(x,p)−→+∞uniformly in t, i.e., u−δφ < 0 for dt(x,p) large enough
independent of t. Moreover, (u−δφ)(x,a)<0 for all x∈M. Consequently, there exists ( x′′,t′′)∈
M×(a,t′) such that (u−δφ)(x,t)≤0 for all ( x,t)∈M×[a,t′′] and (u−δφ)(x′′,t′′)=0. At
(x′′,t′′), we compute
0≤L(u−δφ)≤−δφ< 0,
which is a contradiction. In sum, our proof is complete. /square
83 Variance, H-center and Nash entropy
Let ( Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. It is prove d in [28, Theorem
7] that there exists a positive heat kernel function H(x,t,y,s) for x,y∈Mands<t<1. More
precisely,
/squareH(·,·,y,s)=0,lim
tցsH(·,t,y,s)=δy
and
/square∗H(x,t,·,·)=0,lim
sրtH(x,t,·,s)=δx,
where/square:=∂t−∆and/square∗:=−∂t−∆+R. Furthermore, the heat kernel Hsatisﬁes the semigroup
property
H(x,t,y,s)=/integraldisplay
MH(x,t,z,ρ)H(z,ρ,y,s)dVρ(z),∀x,y∈M, ρ∈(s,t)⊂(−∞,1), (3.1)
and the following integral relationships
/integraldisplay
MH(x,t,y,s)dVt(x)≤1, (3.2)
/integraldisplay
MH(x,t,y,s)dVs(y)=1. (3.3)
For any ( x,t)∈M×(−∞,1), we deﬁne the conjugate heat kernel measure vx,t;sbydvx,t;s(y)=
K(x,t,y,s)dVs(y). It follows immediately from (3.3) that vx,t;sis a probability measure on M. In
particular, vx,t;t=δx.
With the help of the heat kernel, one can solve the (conjugate ) heat solution from the given initial
condition. More precisely, it follows from [28, Lemma 5, Lem ma 6] that
Theorem 3.1. Suppose [a,b]⊂(−∞,1)and u ais a bounded function on the time slice (M,g(a)).
Then
u(x,t)≔/integraldisplay
MH(x,t,y,a)ua(y)dVa(y),∀t∈[a,b] (3.4)
is the unique bounded heat solution with the initial value u a. Similarly, suppose w bis an integrable
function on the time slice (M,g(b)). Then
w(y,s)≔/integraldisplay
MH(x,b,y,s)wb(x)dVb(x) (3.5)
is the unique conjugate heat solution with initial value w bsuch that
sup
s∈[a,b]/integraldisplay
|w|dVs<∞. (3.6)
Next, we recall the following gradient estimate, which slig htly strengthens [28, Corollary 1].
9Lemma 3.2. Let u be a bounded heat solution on M ×[a,b]such that supM|∇u(·,a)|<∞. Then
(i)We have
sup
M|∇u(·,b)|≤sup
M|∇u(·,a)|. (3.7)
(ii)Assume w is a nonnegative conjugate heat solution on M ×[a,b]such that
sup
t∈[a,b]/integraldisplay
Mw dV t<∞, (3.8)
then we have
2/integraldisplayb
a/integraldisplay
M|Hess u|2w dV tdt=/integraldisplay
M|∇u|2w dV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea
b<∞. (3.9)
Proof. (i) From/squareu=0 and direct computation, we have
/square|∇u|2=−2|Hess u|2≤0. (3.10)
Therefore, (3.7) follows from Theorem 2.5 provided that
/integraldisplayb
a/integraldisplay
M|∇u|2e−2fdVtdt<∞. (3.11)
Now, we ﬁx r≫1 and multiply both sides of /squareu=0 by u(φr)2e−2f. By integrating on M×[a,b],
we obtain
1
2/integraldisplay
Mu2(φr)2e−2fdV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleb
a
−/integraldisplayb
a/integraldisplay
Mu2φrφr
te−2fdVtdt+/integraldisplayb
a/integraldisplay
Mu2(φr)2fte−2fdVtdt+1
2/integraldisplayb
a/integraldisplay
Mu2(φr)2Re−2fdVtdt
=/integraldisplayb
a/integraldisplay
M/braceleftig
−|∇(uφr)|2+|∇φr|2u2+/a\}b∇acke⊔le{⊔∇u2,∇f/a\}b∇acke⊔∇i}h⊔(φr)2/bracerightig
e−2fdVtdt
=/integraldisplayb
a/integraldisplay
M/braceleftig
−|∇(uφr)|2+|∇φr|2u2+(2|∇f|2−∆f)u2(φr)2−2u2φr/a\}b∇acke⊔le{⊔∇φr,∇f/a\}b∇acke⊔∇i}h⊔/bracerightig
e−2fdVtdt.
Since R≥0 and ft=|∇f|2by (2.5), we have
/integraldisplayb
a/integraldisplay
M|∇(uφr)|2e−2fdVtdt+1
2/integraldisplay
Mu2(φr)2e−2fdV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleb
a
≤/integraldisplayb
a/integraldisplay
M/braceleftig
|∇φr|2u2+(|∇f|2−∆f)u2(φr)2+u2φr(φr
t−2/a\}b∇acke⊔le{⊔∇φr,∇f/a\}b∇acke⊔∇i}h⊔)/bracerightig
e−2fdVtdt
=/integraldisplayb
a/integraldisplay
M/braceleftigg
|∇φr|2u2+1
1−t/parenleftbigg
f−n
2/parenrightbigg
u2(φr)2+u2φr(φr
t−2/a\}b∇acke⊔le{⊔∇φr,∇f/a\}b∇acke⊔∇i}h⊔)/bracerightigg
e−2fdVtdt,
where we have used the identity ∆f−|∇f|2=¯τ(f−n/2) from (2.7) and (2.8).
10Since uis bounded on M×[a,b] and|∇f|2≤f/(1−b), it follows from (2.12), (2.13), Lemma
2.3 and Lemma 2.4 that by letting r→+∞,
/integraldisplayb
a/integraldisplay
M|∇u|2e−2fdVtdt≤1
2/integraldisplay
Mu2e−2fdV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea
b+/integraldisplayb
a/integraldisplay
M1
1−t/parenleftbigg
f−n
2/parenrightbigg
u2e−2fdVtdt<∞
and hence (3.11) holds.
(ii) Fix r≫1 andǫ≪1. We calculate
∂t/integraldisplay
M|∇u|2φrw dV=/integraldisplay
M/braceleftig
/square(|∇u|2φr)w−(|∇u|2φr)/square∗w/bracerightig
dV
=/integraldisplay
M/braceleftig
|∇u|2/squareφr+φr/square|∇u|2−2/a\}b∇acke⊔le{⊔∇|∇ u|2,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightig
w dV
≤/integraldisplay
M/braceleftig
|∇u|2/squareφr−2|Hess u|2φr+4|Hess u||∇u||∇φr|/bracerightig
w dV
≤/integraldisplay
M/braceleftig
|∇u|2|/squareφr|−(2−ǫ2)|Hess u|2φr+4ǫ−2|∇u|2|∇φr|2(φr)−1/bracerightig
w dV.(3.12)
Since|∇u|is uniformly bounded by (3.7), it follows from (3.12), (2.12 ) and (2.15) that
2/integraldisplayb
a/integraldisplay
M|Hess u|2w dV tdt≤/integraldisplay
M|∇u|2w dV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsinglea
b
if we let r→+∞andǫ→0. The other inequality can be proved similarly and hence (3. 9) holds./square
Next, we prove
Proposition 3.3. For any [a,b]⊂(−∞,1), suppose u and w are two smooth functions on M ×[a,b]
satisfying/squareu=/square∗w=0. Then, the identity
/integraldisplay
Muw dV a=/integraldisplay
Muw dV b (3.13)
holds under one of the following additional assumptions:
(i) sup
t∈[a,b]/integraldisplay
M|wu|dVt+/integraldisplayb
a/integraldisplay
M|w||∇u|dVtdt<∞.
(ii) sup
t∈[a,b]/integraldisplay
M|wu|dVt+/integraldisplayb
a/integraldisplay
M|u||∇w|dVtdt<∞.
Proof. (i) We take r≫1 and calculate
∂t/integraldisplay
MwuφrdV=/integraldisplay
M/braceleftbigw/square(uφr)−(uφr)/square∗w/bracerightbigdV
=/integraldisplay
Mw/braceleftbigu/squareφr+φr/squareu−2/a\}b∇acke⊔le{⊔∇u,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightbigdV
=/integraldisplay
Mw/braceleftbigu/squareφr−2/a\}b∇acke⊔le{⊔∇u,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightbigdV.
11By using (2.12) and (2.15), we conclude
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
MwuφrdV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleb
a/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤C(r−1+r−1
2)/integraldisplayb
a/integraldisplay
M|w|(|u|+|∇u|)dVtdt.
By taking r→∞ , we arrive at (3.13).
(ii) Similarly, we have
∂t/integraldisplay
MuwφrdV=/integraldisplay
M/braceleftbig(/squareu)wφr−u/square∗(wφr)/bracerightbigdV
=/integraldisplay
Mu/braceleftbig−(/square∗w)φr+w(∆φr+φr
t)+2/a\}b∇acke⊔le{⊔∇w,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightbigdV
=/integraldisplay
Mu/braceleftbigw(∆φr+φr
t)+2/a\}b∇acke⊔le{⊔∇w,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightbigdV.
Therefore, by (2.12), (2.13) and (2.14), we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
MwuφrdV/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleb
a/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤C(r−1+r−1
2+(1−a)−1)/iintegdisplay
Kr|u|(|w|+|∇w|)dVtdt,
where Kr:={r≤F(x,r)≤2r,a≤t≤b}. Consequently, by our assumption, (3.13) holds if
r→∞ . /square
Remark 3.4. Suppose/squareu=/square∗w=0.
(i)Ifsup
M|∇u(·,a)|+sup
M×[a,b]|u|+sup
t∈[a,b]/integraldisplay
M|w|dVt<∞, then assumption (i) holds by (3.7) . If
sup
M×[a,b]|u|+sup
t∈[a,b]/integraldisplay
M|w|dVt<∞and u is positive, then |∇u|≤C/√t−a by [28, Lemma 18] .
Therefore, (3.13) also holds by taking the limit for t ցa.
(ii)Ifsup
M×[a,b]|u|+sup
t∈[a,b]/integraldisplay
M|w|dVt<∞and w (·,b)is a nonnegative function with compact support,
then assumption (ii) holds. Indeed, it follows from [28, Lemma 9] that/integraldisplayb
a/integraldisplay
M|∇w|2
wdVtdt<
∞and hence
/integraldisplayb
a/integraldisplay
M|u||∇w|dVtdt≤C( sup
M×[a,b]|u|)/parenleftigg/integraldisplayb
a/integraldisplay
M|∇w|2
wdVtdt/parenrightigg1
2/parenleftigg/integraldisplayb
a/integraldisplay
Mw dV tdt/parenrightigg1
2
<∞.
For later applications, we prove the following estimate of t he heat kernel.
Lemma 3.5. For any y∈M and s<t<1, we set u (x,t) :=H(x,t,y,s)and ¯w(x,t) :=(4π¯τ)−n
2e−f(x,t).
Then
/integraldisplay
Mu(x,t) ¯w(x,t)dVt(x)=¯w(y,s). (3.14)
12Proof. It is clear from the deﬁnition of ¯ wthat/square∗¯w=0; see [28, Equation (28)]. Moreover, for any
[a,b]⊂(s,t], the assumption (ii) of Proposition 3.3 holds since
/integraldisplayb
a/integraldisplay
Mu|∇¯w|dVtdt≤/integraldisplayb
a/integraldisplay
Mu¯w(1+|∇f|)dVtdt
≤(4π(1−b))−n
2/integraldisplayb
a/integraldisplay
Mu(1+(1−b)−1
2f1
2)e−fdVtdt
≤C/integraldisplayb
a/integraldisplay
u dV tdt≤C(b−a)
where we have used (2.8) and (3.2) and the constant Cdepends only on nandb.
By choosing b=tand letting aցs, the proof of Proposition 3.3 yields
/integraldisplay
Mu¯wφrdVt−¯w(y,s)φr(y,s)=o(r)
where o(r)→0 asr→∞ . Therefore, we immediately obtain (3.14) by letting r→∞ ./square
Next, we recall the deﬁnition of W1-Wasserstein distance.
Deﬁnition 3.6. Let(X,d)be a complete metric space and µ1,µ2two probability measures on X.
Then the W 1-Wasserstein distance between µ1andµ2is deﬁned by
dW1(µ1,µ2) :=sup
f/parenleftigg/integraldisplay
f dµ1−/integraldisplay
f dµ2/parenrightigg
where the supremum is taken for all bounded 1-Lipschitz functions f . We also use dt
W1to denote the
W1-distance with respect to g (t).
We prove the following monotonicity of the Wasserstein dist ance as [2, Lemma 2.7].
Proposition 3.7. Let(Mn,g(t))t<1be a Ricci ﬂow associated with a Ricci shrinker. For [a,b]⊂
(−∞,1), let w 1,w2∈C∞(M×[a,b])be two nonnegative conjugate heat solutions such that/integraltext
MwidVt=
1for any t∈[a,b]and i=1,2. We deﬁne the probability measures with d µi,t=wi(·,t)dVt, i=1,2.
Then
dt
W1(µ1,t,µ2,t)
is increasing for t∈[a,b]. In particular, if t 1≤t2<1, then for any x 1,x2∈M and t≤t1,
dt
W1(vx1,t1;t,vx2,t2;t)
is increasing and
dt
W1(vx1,t1;t,vx2,t2;t)≤dt1(x1,x2).
13Proof. Lett1≤t2,t1,t2∈[a,b] and consider a bounded function u1∈C∞(M) with supM|∇u1(·,t1)|≤
1. Suppose uis the unique bounded heat solution on M×[t1,t2] starting from u1. Then it follows
from Lemma 3.2 (i) that
sup
M|∇u(·,t)|≤1
for any t∈[t1,t2]. Clearly, we have
/integraldisplay
Mu dµ1,t1−/integraldisplay
Mu dµ2,t1=/integraldisplay
Mu(x,t1)w1(x,t1)dVt1(x)−/integraldisplay
Mu(x,t1)w2(x,t1)dVt1(x)
=/integraldisplay
Mu(x,t2)w1(x,t2)dVt2(x)−/integraldisplay
Mu(x,t2)w2(x,t2)dVt2(x)
=/integraldisplay
Mu dµ1,t2−/integraldisplay
Mu dµ2,t2≤dt2
W1(µ1,t2,µ2,t2).
Here, we have used [28, Proposition 1] for the second equalit y. By taking the supremum over all
such u1, one obtains
dt1
W1(µ1,t1,µ2,t1)≤dt2
W1(µ1,t2,µ2,t2).
/square
Next, we recall the following deﬁnition from [2, Deﬁnition 3 .1].
Deﬁnition 3.8 (Variance) .The variance between two probability measures µ1,µ2on a Riemannian
manifold (M,g)is deﬁned as
Var(µ1,µ2) :=/integraldisplay
M/integraldisplay
Md2(x1,x2)dµ1(x1)dµ2(x2).
In the caseµ1=µ2=µ, we write
Var(µ)=Var(µ,µ)=/integraldisplay
M/integraldisplay
Md2(x1,x2)dµ(x1)dµ(x2).
We also deﬁne Var tas the variance with respect to the metric g (t).
For some basic properties of the variance, we refer the reade rs to [2, Lemma 3.2]. Next, we
prove the following results which originate from [2, Coroll ary 3.7, Corollary 3.8]. Before that, we
ﬁrst prove the following maximum principle on the product ma nifold (cf. [1] [7] for related survey).
Theorem 3.9 (Maximum principle on the product) .Let(Mn,g(t))t<1be a Ricci ﬂow associated with
a Ricci shrinker. Given any closed interval [a,b]⊂(−∞,1)and a function u on M ×M×[a,b]such
that
(∂t−∆x−∆y)u(x,y,t)≤0. (3.15)
Suppose that
/integraldisplayb
a/integraldisplay
M×Mu2
+(x,y,t)e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt<∞. (3.16)
If u(·,a)≤c, then u (·,b)≤c.
14Proof. The proof follows almost verbatim from [28, Theorem 6], exce pt that we multiply (3.15) by
u+(x,y,t)(φr(x)φr(y))2e−2f(x,t)−2f(y,t)and do the integration. Since no other new ingredient is need ed,
we omit the details here. /square
Proposition 3.10. Under the same assumptions as in Proposition 3.7, if we furth er assume w 1(·,b)
and w 2(·,b)have compact supports, then
Var t(µ1,t,µ2,t)+Hnt
is increasing for t∈[a,b], where H n:=(n−1)π2/2+4. Moreover, for any x 1,x2∈M,
Var t(vx1,b;t,vx2,b;t)+Hnt
is increasing for t≤b. In particular,
Var t(vx1,b;t,vx2,b;t)≤d2
b(x1,x2)+Hn(b−t)and Var t(vx,b;t)≤Hn(b−t).
Proof. For any [ c,d]⊂[a,b], we set u∈C0(M×M×[c,b])∩C∞(M×M×(c,b]) be the solution
to the following heat equation
(∂t−∆x−∆y)u=−Hn,u(·,c)=d2
c.
Indeed, by the existence of the heat kernel, one may deﬁne
u(x,y,t) :=/integraldisplay
M/integraldisplay
MH(x,t,z,c)H(y,t,w,c)d2
c(z,w)dVc(z)dVc(w)−Hn(t−c). (3.17)
We ﬁrst show (3.17) is well-deﬁned. In fact, it is clear that
/integraldisplay
M/integraldisplay
MH(x,t,z,c)H(y,t,w,c)d2
c(z,w)dVc(z)dVc(w)
≤2/parenleftigg/integraldisplay
MH(x,t,z,c)d2
c(z,p)dVc(z)+/integraldisplay
MH(y,t,w,c)d2
c(w,p)dVc(w)/parenrightigg
(3.18)
and the convergence of the last two integrals follows from [2 8, Corollary 5].
On the other hand, it follow from [2, Theorem 3.5] that
(∂t−∆x−∆y)d2
t(x,y)≥−Hn. (3.19)
Combining (3.17) and (3.19), we claim that u(x,y,t)≤d2
t(x,y) for any t∈[c,b]. Indeed, this
follows from the maximum principle Theorem 3.9 as long as the condition (3.16) is satisﬁed. First,
notice that
/integraldisplayb
c/integraldisplay
M×Md4
t(x,y)e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt
≤8/integraldisplayb
c/integraldisplay
M×M/parenleftig
d4
t(x,p)+d4
t(y,p)/parenrightig
e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt. (3.20)
15From Lemma 2.3 and Lemma 2.4, it is clear that (3.20) is bounde d. In addition, it follows from
(3.18) that
/integraldisplayb
c/integraldisplay
M×M(u(x,y,t)+Hn(t−c))2e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt
≤8/integraldisplayb
c/integraldisplay
M×M/parenleftigg/integraldisplay
MH(x,t,z,c)d2
c(z,p)dVc(z)/parenrightigg2
e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt
+8/integraldisplayb
c/integraldisplay
M×M/parenleftigg/integraldisplay
MH(y,t,w,c)d2
c(w,p)dVc(w)/parenrightigg2
e−2f(x,t)−2f(y,t)dVt(x)dVt(y)dt
≤8/integraldisplayb
c/integraldisplay
M×M/integraldisplay
MH(x,t,z,c)d4
c(z,p)e−2f(x,t)−2f(y,t)dVc(z)dVt(x)dVt(y)dt
+8/integraldisplayb
c/integraldisplay
M×M/integraldisplay
MH(y,t,w,c)d4
c(w,p)e−2f(x,t)−2f(y,t)dVc(w)dVt(x)dVt(y)dt, (3.21)
where we have used Cauchy-Schwarz inequality for the last in equality. From Lemma 3.5, we obtain
/integraldisplayb
c/integraldisplay
M×M/integraldisplay
MH(x,t,z,c)d4
c(z,p)e−2f(x,t)−2f(y,t)dVc(z)dVt(x)dVt(y)dt
≤/integraldisplayb
c/integraldisplay
M/integraldisplay
M/integraldisplay
MH(x,t,z,c)d4
c(z,p)e−f(x,t)−2f(y,t)dVt(x)dVc(z)dVt(y)dt
≤/integraldisplayb
c/integraldisplay
M/integraldisplay
M/parenleftigg1−t
1−c/parenrightiggn
2
d4
c(z,p)e−f(z,c)−2f(y,t)dVc(z)dVt(y)dt
≤/integraldisplayb
c/integraldisplay
M/integraldisplay
Md4
c(z,p)e−f(z,c)−2f(y,t)dVc(z)dVt(y)dt<∞
by Lemma 2.3 and Lemma 2.4. Similarly, the second term in (3.2 1) is also bounded. Therefore, we
have proved that u(x,y,t)≤d2
t(x,y) for any t∈[c,b].
By our assumption, w1(·,b) and w2(·,b) have compact supports, then it follows [28, Lemma 8,
Lemma 9] that
wi(x,t)≤C¯w(x,t) (3.22)
for any c≤t≤band
/integraldisplayb
c/integraldisplay
M|∇wi|2
widVtdt≤C (3.23)
for some constant C>0.
Next, we set w1=w1(x,t),w2=w2(y,t),φr
x=φr(x) andφr
y=φr(y), then we compute
∂t/integraldisplay
M/integraldisplay
Muw1w2φr
xφr
ydVt(x)dVt(y)
=/integraldisplay
M/integraldisplay
M(∂t−∆x−∆y)(uφr
xφr
y)w1w2dVt(x)dVt(y)
=/integraldisplay
M/integraldisplay
M/parenleftig
−Hnφr
xφr
y−u(∆xφr
xφr
y+∆ yφr
yφr
x)/parenrightig
w1w2dVt(x)dVt(y)
+2/integraldisplay
M/integraldisplay
M(∆xφr
x+/a\}b∇acke⊔le{⊔∇φr
x,∇w1/a\}b∇acke⊔∇i}h⊔)uφr
yw2+(∆yφr
y+/a\}b∇acke⊔le{⊔∇φr
y,∇w2/a\}b∇acke⊔∇i}h⊔)uφr
yw1dVt(x)dVt(y). (3.24)
16From (3.23), we have
/parenleftigg/integraldisplayb
c/integraldisplay
M/integraldisplay
M|∇φr
x||∇w1||u|φr
yw2dVt(x)dVt(y)dt/parenrightigg2
≤/parenleftigg/integraldisplayb
c/integraldisplay
M/integraldisplay
M|∇φr
x|2u2(φr
y)2w1w2dVt(x)dVt(y)dt/parenrightigg/parenleftigg/integraldisplayb
c/integraldisplay
M|∇w1|2
w1dVtdt/parenrightigg
≤C/integraldisplayb
c/integraldisplay
M/integraldisplay
M|∇φr
x|2u2w1w2dVt(x)dVt(y)dt. (3.25)
Similarly, we have
/parenleftigg/integraldisplayb
c/integraldisplay
M/integraldisplay
M|∇φr
y||∇w2||u|φr
xw1dVt(x)dVt(y)dt/parenrightigg2
≤C/integraldisplayb
c/integraldisplay
M/integraldisplay
M|∇φr
y|2u2w1w2dVt(x)dVt(y)dt. (3.26)
Combining (3.22), (3.24), (3.25), (3.26) and the fact that −Hn(t−c)≤u≤d2
t(x,y), we conclude
by letting r→∞ that
/integraldisplay
M/integraldisplay
Muw1w2dVd(x)dVd(y)−/integraldisplay
M/integraldisplay
Muw1w2dVc(x)dVc(y)=−Hn(d−c). (3.27)
Since u≤d2
t(x,y), it follows from (3.27) and the deﬁnition of the variance th at
Var d(µ1,d,µ2,d)+Hnd≥Var c(µ1,c,µ2,c)+Hnc.
Now, we assume wi=H(xi,b,·,·) for i=1,2. Then it follows from [28, Lemma 23] that
/integraldisplayb−ǫ
a/integraldisplay
M|∇wi|2
widVtdt≤Clogǫ−1. (3.28)
Therefore, one can use the same arguments as above, thanks to (3.28) and [28, Corollary 5], to
conclude that (3.27) still holds if [ c,d]⊂[a,b−ǫ]. Sinceǫis arbitrary, we immediately show that
Var t(vx1,b;t,vx2,b;t)+Hnt
is increasing for any t≤b. /square
Next, we recall the deﬁnition of H-center, where the conjugate heat kernel measure is concen-
trated.
Deﬁnition 3.11 (H-center) .Given a constant H >0, a point (z,t)∈M×(−∞,1)is called an
H-center of (x0,t0)∈M×(−∞,1)if t≤t0and
Var t(δz,vx0,t0;t)≤H(t0−t).
In particular, we have
dt
W1(δz,vx0,t0;t)≤/radicalbig
H(t0−t). (3.29)
17From Proposition 3.10, the following result is immediate; s ee [2, Proposition 3.12].
Proposition 3.12. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. Given
(x0,t0)∈M×(−∞,1)and t≤t0there is at least one point z ∈M such that (z,t)is an H n-center of
(x0,t0)and for any two such points z 1,z2∈M we have d t(z1,z2)≤2√Hn(t0−t).
The following result ensures that the conjugate heat kernel measure is concentrated around an
H-center; see [2, Proposition 3.13].
Proposition 3.13. If(z,t)is an H-center of (x0,t0), then for any L >0,
vx0,t0;t/parenleftig
Bt(z,/radicalbig
LH(t0−t))/parenrightig
≥1−1
L. (3.30)
Combining the above Proposition with [28, Theorem 14], we ob tain the following integral bound
for the conjugate heat kernel; see also [2, Theorem 3.14].
Proposition 3.14. If(z,t)is an H n-center of (x0,t0), then for all r≥0andǫ >0we have
vx0,t0;t/parenleftbigM\Bt(z,r)/parenrightbig≤C(n,ǫ) exp/parenleftbigg
−r2
(4+ǫ)(t0−t)/parenrightbigg
.
Proof. We apply [28, Theorem 14] for A=M\Bt(z,r),B=Bt(z,√2Hn(t0−t)) andσ=ǫ/8 to
obtain
vx0,t0;t/parenleftbigM\Bt(z,r)/parenrightbig≤v−8
ǫ
x0,t0;t/parenleftbigBt(z,/radicalbig
2Hn(t0−t))/parenrightbigexp/parenleftbigg
−/parenleftbigr−√2Hn(t0−t)/parenrightbig2
+
(4+ǫ/2)(t0−t)/parenrightbigg
≤C(n,ǫ) exp/parenleftbigg
−r2
(4+ǫ)(t0−t)/parenrightbigg
,
where we have used (3.30) for L=2 and H=Hn. /square
In order to obtain the estimates on the Nash entropy, we ﬁrst g eneralize the improved gradient
estimate [2, Theorem 4.1] to our setting. We deﬁne the follow ing antiderivative of the 1-dimensional
heat kernel:
Φ(x)=/integraldisplayx
−∞(4π)−1/2e−t2/4dt. (3.31)
Notice thatΦt(x) :=Φ(t−1/2x) is a solution to the 1-dimensional heat equation with initi al condition
χ[0,∞).
Theorem 3.15. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. Given [a,b]⊂
(−∞,1)and a solution u∈C∞(M×[a,b])to the heat equation /squareu=0and a constant T≥0, suppose
that u only takes values in (0,1)and|∇(Φ−1
T(u(·,a)))|≤1if T>0. Then|∇(Φ−1
T+t−a(u(·,t)))|≤1for
all t∈[a,b].
Proof. We may assume that utakes values in ( ǫ,1−ǫ). Indeed, we can consider (1 −2ǫ)u+ǫinstead
and letǫց0. With the extra assumption, it follows from [28, Lemma 18] t hat
|∇u|≤C1√t−a(3.32)
18onM×(a,b]. It is clear from the deﬁnition of Φtthat supM|∇(Φ−1
T(u(·,a+ǫ)))|→ 0 ifTց0.
Therefore, we only need to prove the case for T>0 and then let Tց0 andǫց0.
Now, we set u(x,t)=Φ T+t−a◦h(x,t). It follows from the deﬁnition of Φtthat
|h|≤C2 (3.33)
onM×[a,b]. Moreover, since |∇h(·,a)|≤1, it follows from (3.33) and Lemma 3.2(i) that
|∇h|≤C3 (3.34)
onM×[a,b]. By direct computation, see [2, Theorem 4.1] for details, w e have
/square|∇h|2=−2|Hess h|2−1
T+t−a/a\}b∇acke⊔le{⊔∇h2,∇|∇h|2/a\}b∇acke⊔∇i}h⊔+1
2(T+t−a)(1−|∇h|2)|∇h|2. (3.35)
Therefore, if we set v=(|∇h|2−1)+, then it follows from (3.35) that
/squarev+1
T+t−a/a\}b∇acke⊔le{⊔∇h2,∇v/a\}b∇acke⊔∇i}h⊔≤0.
Since|∇h2|andvare uniformly bounded on M×[a,b] by (3.33) and (3.34), it follows from Theorem
2.6 that v≤0 on M×[a,b]. In other words,|∇h|≤1 on M×[a,b]. Thus the proof is complete. /square
With the help of Theorem 3.15, one can follow verbatim as [2, P roposition 4.2] and [30, Propo-
sition 3.4] to obtain the following estimate.
Theorem 3.16. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker and [s,t]⊂
(−∞,1). Then for any x∈M,1≤p<∞and measurable subset X ⊂M, we have
(t−s)p
2/integraldisplay
X/parenleftigg|∇xH(x,t,·,s)|
H(x,t,·,s)/parenrightiggp
dv≤C(n,p)v(X)/parenleftigg
−log/parenleftiggv(X)
2/parenrightigg/parenrightiggp
2
,
where dv=H(x,t,·,s)dVsis the conjugate heat kernel measure. Moreover, for any x ∈M and
w∈TxM with|w|t=1, there holds that
(t−s)/integraldisplay
M/parenleftigg∂wH(x,t,·,s)
H(x,t,·,s)/parenrightigg2
dv≤1
2. (3.36)
In particular, we have
(t−s)/integraldisplay
M/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle∇xH(x,t,·,s)
H(x,t,·,s)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
dv≤n
2. (3.37)
Another application of Theorem 3.15 is the following Lp-Poincar´ e inequality; see [2, Theorem
11.1].
Theorem 3.17 (Lp-Poincar´ e inequality) .Let(Mn,g(t))t<1be a Ricci ﬂow associated with a Ricci
shrinker. Then for p ≥1and any [s,t]⊂(−∞,1)we have
/integraldisplay
Mupdvs≤C(p)(t−s)p
2/integraldisplay
M|∇u|pdvs,
for any u∈W1,p(M,dvs)with/integraltext
Mu dv s=0. Here, dv s(y)=H(x,t,y,s)dVs(y). One may choose
C(1)=√πand C (2)=2.
19Proof. The proof for p/nequal2 follows verbatim from [2, Theorem 11.1]. Only the last stat ement
forp=2 needs to be proved. It follows from [28, Theorem 13] that the probability measure dvs
satisﬁes the log-Sobolev inequality with the constant1
2(t−s). It is a standard fact that the log-Sobolev
condition implies the Poincar´ e inequality; see [35, Theor em 22.17]. /square
Next, we recall the deﬁnitions of the Nash entropy and W-entropy based at ( x0,t0).
Deﬁnition 3.18. Given a Ricci ﬂow (Mn,g(t))t<1associated with a Ricci shrinker and a point
(x0,t0)∈M×(−∞,1), let
dv=dvx0,t0;t(x)=(4πτ)−n
2e−b(x,t)dVt=H(x0,t0,x,t)dVt
whereτ=t0−t. Then Perelman’s W-entropy and the Nash entropy based at (x0,t0)are respectively
deﬁned as
W(x0,t0)(τ)=/integraldisplay
M/parenleftig
τ(2∆b−|∇b|2+R)+b−n/parenrightig
dv, (3.38)
N(x0,t0)(τ)=/integraldisplay
Mb dv−n
2. (3.39)
Now, we prove some basic properties of NandW.
Proposition 3.19. The following properties hold with Deﬁnition 3.18.
(a)W(x0,t0)(0)=0and for any τ0>0,
W(x0,t0)(τ0)=−2/integraldisplayτ0
0τ/integraldisplay
M/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+Hess b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
dvdτ. (3.40)
In particular,W(x0,t0)(τ)is nonpositive and decreasing.
(b)N(x0,t0)(0)=0and for any τ0>0,
N(x0,t0)(τ0)=1
τ0/integraldisplayτ0
0W(x0,t0)(τ)dτ≥W (x0,t0)(τ0). (3.41)
(c)For any 0<τ 1≤τ2,
N(x0,t0)(τ1)−n
2log/parenleftiggτ2
τ1/parenrightigg
≤N (x0,t0)(τ2)≤N (x0,t0)(τ1). (3.42)
Proof. Given ( x0,t0) andτ, we ﬁrst prove that N(x0,t0)(τ) andW(x0,t0)(τ) are well-deﬁned. In the
following, all constants Ci>1 depend on ( x0,t0),τand the given Ricci shrinker.
It follows from [28, Theorem 19] that for any r≥1,
/integraldisplay
dt(x0,x)≥r√τdvt(x)≤C1e−r2
8. (3.43)
20Therefore, there exists C2>1 such that
/integraldisplay
dt(p,x)≥rdvt(x)≤C2e−r2
C2 (3.44)
ifr≥C2. In addition, it follows from [28, Theorem 15, Formula (203) ] that
µ≤b(x,t)≤−3µ+d2
t0(x0,x)
3τ+4τ
3(1−t0)2F(x,t0). (3.45)
From (3.45) and Lemma 2.3, there exists C3>1 such that
−C3≤b(x,t)≤C3(1+F(x,t0)). (3.46)
Since Fis decreasing with respect to tby (2.6), it follows from (3.46) and Lemma 2.3 that
b(x,t)≤C3(1+F(x,t))≤C4(1+d2
t(p,x)).
for some C4≥C3. Consequently, we obtain
|b(x,t)|≤C4(1+d2
t(p,x)). (3.47)
Combining (3.44) and (3.47), we can estimate
/integraldisplay
M|b(x,t)|dvt(x)≤C4+C4/integraldisplay
Md2
t(p,x)dvt(x)
=C4+C4/integraldisplay
dt(p,x)≤C2d2
t(p,x)dvt(x)+C4∞/summationdisplay
k=1/integraldisplay
2k−1C2≤dt(p,x)≤2kC2d2
t(p,x)dvt(x)
≤C4+C4C2
2+C4∞/summationdisplay
k=1(2kC2)2C2e−22k−2C2<∞. (3.48)
Therefore, it follows from the deﬁnition (3.39) that N(x0,t0)(τ) is ﬁnite. Now, the fact that W(x0,t0)(τ)
is well-deﬁned follows from Perelman’s di ﬀerential Harnack inequality [28, Theorem 21].
(a): The identity (3.40) follows from [28, Remark 6]. Notice that the integral in (3.40) is always
ﬁnite by [28, Lemma 30]. In particular, W(x0,t0)(0)=limτց0W(x0,t0)(τ)=0.
(b): We ﬁx r≫1 and compute
∂τ/parenleftigg
τ/integraldisplay
Mbφrdv/parenrightigg
−n
2
=/integraldisplay
Mbφrdv−τ/integraldisplay
M/square(bφr)dv−n
2
=/integraldisplay
M/parenleftbigg
τ(2∆b−|∇b|2+R)φr+bφr+τb/squareφr−2τ/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔−n
2(1+φr)/parenrightbigg
dv, (3.49)
where we have used the fact that /squareb=−2∆b+|∇b|2−R+n
2τ. Forτ0>0, we integrate (3.49) from
0 toτ0and obtain
τ0/parenleftigg/integraldisplay
Mbφrdv−n
2/parenrightigg
=/integraldisplayτ0
0/integraldisplay
M/parenleftbigg
τ(2∆b−|∇b|2+R)φr+bφr+τb/squareφr−2τ/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔−n
2(1+φr)/parenrightbigg
dvdτ, (3.50)
21where we have used (3.43) and (3.47). On the one hand, it follo ws from (2.15), (3.43) and (3.47)
that
lim
r→∞/integraldisplayτ0
0/integraldisplay
Mτ|b||/squareφr|dvdτ=0. (3.51)
On the other hand, we estimate
/integraldisplayτ0
0/integraldisplay
Mτ|∇b||∇φr|dvdτ≤Cr−1
2τ2
0/parenleftigg/integraldisplayτ0
0/integraldisplay
Mτ2|∇b|2dvdτ/parenrightigg2
. (3.52)
Since the last integral is ﬁnite by [28, Lemma 25], it follows from (3.52) that
lim
r→∞/integraldisplayτ0
0/integraldisplay
Mτ|∇b||∇φr|dvdτ=0. (3.53)
Combining (3.50), (3.51) and (3.53), if we let r→∞ , then
τ0/parenleftigg/integraldisplay
Mb dv−n
2/parenrightigg
=/integraldisplayτ0
0/integraldisplay
M/parenleftig
τ(2∆b−|∇b|2+R)+b−n/parenrightig
dvdτ,
which is exactly (3.41). Notice that the last inequality in ( 3.41) follows from the fact that W(x0,t0)(τ)
is decreasing. Moreover, it follows from (3.41) and W(x0,t0)(0)=0 thatN(x0,t0)(0)=0.
(c): The inequality (3.42) follows exactly the same as [2, Pr oposition 5.2 (5.7)] and we omit the
proof. /square
Corollary 3.20. Under the same assumptions, we have
/integraldisplay
M(|∇b|2+R)dv≤n
2τ. (3.54)
/integraldisplay
M/parenleftbigg
b−N (x0,t0)(τ)−n
2/parenrightbigg2
dv≤n. (3.55)
Proof. From the fact thatN(x0,t0)(τ)≥W (x0,t0)(τ), we conclude that
lim
r→∞/integraldisplay
M(2∆b−|∇b|2)φr+R dv≤n
2τ, (3.56)
where we have used the di ﬀerential Harnack inequality [28, Theorem 21]. From integra tion by
parts, we have
/integraldisplay
M(2∆b−|∇b|2)φrdv=/integraldisplay
M|∇b|2φr−2/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔dv. (3.57)
In addition, we can estimate
2/integraldisplay
M|∇b||∇φr|dv≤/integraldisplay
M|∇b||∇φr|dv≤/integraldisplay
Mǫ|∇b|2φr+ǫ−1|∇φr|2
φrdv (3.58)
Therefore, it follows from (2.12), (3.56), (3.57) and (3.58 ) that
/integraldisplay
M(1−ǫ)|∇b|2+R dv≤n
2τ.
22By lettingǫց0, we obtain (3.54).
Now, it follows from the Poincar´ e inequality Theorem 3.17 a nd (3.54) that
/integraldisplay
M/parenleftbigg
b−N (x0,t0)(τ)−n
2/parenrightbigg2
dv≤2τ/integraldisplay
|∇b|2dv≤n
and (3.55) is proved. /square
Remark 3.21. From the proof of (3.54) ,Wcan be rewritten as
W(x0,t0)(τ)=/integraldisplay
M/parenleftig
τ(|∇b|2+R)+b−n/parenrightig
dv,
which agrees with the original deﬁnition of Perelman [34, Formula (3.1)] .
Corollary 3.22. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker (Mn,g,f)∈
M(A), then
0≥N (x0,t0)(τ)≥W (x0,t0)(τ)≥µ≥−A (3.59)
for any (x0,t0)∈M×(−∞,1)andτ >0. In particular, given a Ricci shrinker, the Nash entropy is
always uniformly bounded.
Proof. For ﬁxed ( x0,t0) andτ>0, it follows from [28, Theorem 20] that bincreases quadratically.
Therefore, it is easy to see the function u, deﬁned by u2=(4πτ)−n
2e−b, belongs to W1,2
∗(M) deﬁned
in [28, (92)]. From [28, Theorem 1], we immediately conclude that
W(x0,t0)(τ)≥µ(g(t0−τ),τ)≥µ≥−A.
/square
Following [2], we use the notation
N∗
s(x,t) :=N(x,t)(t−s).
Similar to [2, Theorem 5.9], we have
Theorem 3.23. Let(Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker. Then for an y
s<t<1, the following properties hold.
(i)N∗
sis a Lipschitz function with Lipschitz constant/radicalbiggn
2(t−s).
(ii)In the distribution sense, we have
−n
2(t−s)≤/squareN∗
s≤0. (3.60)
23Proof. Without loss of generality, we assume s=0 and consider t∈(0,1). We ﬁrst deﬁne the
following modiﬁed Nash entropy:
Nr=Nr(x,t) :=/integraldisplay
bφrdv−n
2, (3.61)
where, as before, b=b(x,t)(y,0)=−n
2log(4πt)−logH(x,t,y,0) and dv=H(x,t,y,0)dV0(y).
Claim :Nrconverges toN∗
0inC0
loconM×(0,1), as r→∞ .
Proof of Claim : Given a spacetime compact set K⊂M×(0,1), all constants Ci>1 below
depends only Kand the Ricci shrinker.
Similar to (3.44), there exists C1>1 such that
/integraldisplay
d0(p,y)≥rdv(y)≤C1e−r2
C1 (3.62)
for any r≥C1. From the same argument leading to (3.47), we have
|b(x,t)(y,0)|≤C2(1+d2
0(p,y)). (3.63)
Combining (3.62), (3.63) and the fact that supp( φr)∩M×{0}⊂{C3r≤d2
0(p,·)≤C4r}, it is easy
to show as (3.48) that
lim
r→∞/integraldisplay
M|b(x,t)(y,0)|(1−φr(y))dv(y)=0 (3.64)
uniformly for ( x,t)∈K. From (3.64), the Claim is proved.
Next, for any vector w∈TxMwith|w|t=1 we compute
∂wNr(x,t)=/integraldisplay
M/braceleftbig(∂wb)Hφr+b(∂wH)φr/bracerightbigdV0
=/integraldisplay
M/braceleftbig−(∂wH)φr+b(∂wH)φr/bracerightbigdV0=:I+II, (3.65)
where H=H(x,t,y,0). Notice that
/integraldisplay
MHφrdV0=/integraldisplay
MH(x,t,y,0)φr(y)dV0(y)
is the heat solution starting from φr. Therefore, it follows from (3.7) and (2.12) that
|I|≤/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle∇x/integraldisplay
MH(x,t,y,0)φr(y)dV0(y)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤Cr−1
2. (3.66)
Next, we estimate
II=/integraldisplay
Mb∂wH
Hφrdv=/integraldisplay
M/parenleftbigg
b−N∗
0−n
2/parenrightbigg∂wH
Hφrdv−/parenleftbigg
N∗
0+n
2/parenrightbigg
I.
24Therefore, we have
|II|≤/parenleftigg/integraldisplay
M/parenleftbigg
b−N∗
0−n
2/parenrightbigg2
dv/parenrightigg1
2/integraldisplay
M/parenleftigg∂wH
H/parenrightigg2
dv1
2
+Cr−1
2≤/radicalbiggn
2t+Cr−1
2, (3.67)
where we have used (3.36), (3.55) and (3.66). Combining (3.6 5), (3.66) and (3.67), we obtain
/vextendsingle/vextendsingle/vextendsingle∇xNr(x,t)/vextendsingle/vextendsingle/vextendsingle≤/radicalbigg
n
2t+Cr−1
2. (3.68)
SinceNrconverges toN∗
0locally uniformly by the Claim, we immediately conclude fro m (3.68)
thatN∗
0is/radicalig
n
2t-Lipschitz.
Next, by direct computation, we have
/squareNr(x,t)=/integraldisplay
M/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle∇xH
H/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
φrdv−n
2t/integraldisplay
Mφrdv. (3.69)
Combining (3.37), (3.69) and the Claim, it follows immediat ely that
−n
2t≤/squareN∗
0≤0
in the distribution sense. /square
Remark 3.24. Later, we will show that the conclusions in Theorem 3.23 hold in the classical sense
once we know the decay of the conjugate heat kernel; see Corol lary 4.19.
As an application of Theorem 3.23, we prove the following osc illation of the Nash entropy.
Corollary 3.25. For any x 1,x2∈M and s<t∗≤t1,t2<1, we have
N∗
s(x1,t1)−N∗
s(x2,t2)≤/radicalbiggn
2(t∗−s)dt∗
W1/parenleftbigvx1,t1;t∗,vx2,t2;t∗/parenrightbig+n
2log/parenleftbiggt2−s
t∗−s/parenrightbigg
. (3.70)
In particular, if s <t∗=t2≤t1<1, then
N∗
s(x1,t1)−N∗
s(x2,t2)≤/radicalbiggn
2(t2−s)dt2
W1/parenleftbigvx1,t1;t2,δx2/parenrightbig. (3.71)
If we further assume (x2,t2)is an H n-center of (x1,t1), then
N∗
s(x1,t1)−N∗
s(x2,t2)≤/radicaligg
nHn(t1−t2)
2(t2−s). (3.72)
Proof. The proof follows verbatim from [2, Corollary 5.11]. The onl y diﬀerence is that we consider
Nras deﬁned in (3.61) instead and let r→∞ . /square
254 Heat kernel estimates
Throughout this section, we assume ( Mn,g(t))t<1is the Ricci ﬂow associated with a Ricci shrinker
inM(A). First, we recall the following no-local-collapsing theo rem proved in [28, Theorem 22].
Theorem 4.1. For any x∈M and t<1, if R≤r−2on B t(x,r), then
|Bt(x,r)|t≥ceµrn(4.1)
for some constant c =c(n)>0.
One can improve (4.1) by using the Nash entropy. Based on the L ipschitz property of the Nash
entropy, we can follow the same proof of [2, Theorem 6.1] to ob tain the following result. Notice
that by (3.59), (4.2) is stronger than (4.1)
Theorem 4.2. For any x∈M and t<1, if R≤r−2on B t(x,r), then
|Bt(x,r)|t≥cexp/parenleftig
Nx,t(r2)/parenrightig
rn(4.2)
for some constant c =c(n)>0.
By using (3.55), we also have the following volume estimate a round an Hn-center by following
the same proof of [2, Theorem 6.2].
Theorem 4.3. For any x∈M and t<1, if(z,t−r2)is an H n-center of (x,t), then
|Bt−r2(z,r)|t−r2≥cexp/parenleftig
Nx,t(r2)/parenrightig
rn(4.3)
for some constant c =c(n)>0and any r≥0.
Next, we recall the following upper bound estimate of the hea t kernel proved in [28, Theorem
15], which has already been used in the last section.
Theorem 4.4. For any x,y∈M and s<t<1, we have
H(x,t,y,s)≤e−µ
(4π(t−s))n
2. (4.4)
Instead of using the entropy µ, one can include the Nash entropy and obtain the following re sult;
see [2, Theorem 7.1].
Theorem 4.5. For any x,y∈M and s<t<1, we have
H(x,t,y,s)≤C(n)
(t−s)n
2exp/parenleftbig−N x,t(t−s)/parenrightbig. (4.5)
Proof. The proof follows almost the same as [2, Theorem 7.1]. The mai n idea is to improve the
bound Zof the estimate
H(x,t,y,s)≤Z
(t−s)n
2exp/parenleftbig−N x,t(t−s)/parenrightbig.
Notice that such Zalways exists by (4.4) and (3.59), which may depend on the Ric ci shrinker.
Thanks to (3.70) and (4.3), we can follow the same argument as in [2, Theorem 7.1] to improve Z
to be Z/2, ifZ≥¯Z(n). /square
26With the help of Theorem 3.16, Corollary 3.25 and Theorem 4.5 , we obtain the following gradi-
ent estimate of the heat kernel as [2, Theorem 7.5], which imp roves [28, Lemma 18].
Theorem 4.6. For any x,y∈M and s<t<1, then
|∇xH|(x,t,y,s)
H(x,t,y,s)≤/radicalbigg
C
t−s/radicaligg
log/parenleftiggCexp/parenleftbig−N x,t(t−s)/parenrightbig
(t−s)n
2H(x,t,y,s)/parenrightigg
(4.6)
for some constant C =C(n)>0.
With the gradient estimate (4.6), one obtains the following non-expanding estimate as [2, Theo-
rem 8.1]. Notice that (4.7) generalizes the global volume es timate Lemma 2.4.
Theorem 4.7. For any x∈M, t<1and r≥0, we have
|Bt(x,r)|t≤C(n) exp/parenleftig
Nx,t(r2)/parenrightig
rn≤C(n)rn. (4.7)
Before we prove more reﬁned heat kernel estimates, we ﬁrst pr ove a series of lemmas.
Lemma 4.8 (Distance comparison) .For anyδ∈(0,1), there exists a constant L 1=L1(n,δ)>1
such that
dt(x,p)≤ds(x,p)+L1≤L1√
1−t(dt(x,p)+1)+L2
1 (4.8)
for any x∈M and−δ−1≤s≤t<1.
Proof. From (2.6) and (2.8), we have
−F
1−t≤∂tF=−(1−t)R≤0.
Therefore, for any x∈M,
1−t
1−sF(x,s)≤F(x,t)≤F(x,s). (4.9)
Consequently, (4.8) follows from the combination of Lemma 2 .3 and (4.9). /square
As an application of the distance comparison, we have the fol lowing lower bound of the heat
kernel.
Theorem 4.9. For any K>1,δ∈(0,1)and A>0, there exists a constant C =C(n,K,δ,A)>1
satisfying the following property.
Suppose−δ−1≤s<t≤1−δand d t(x,p)≤K, then
H(x,t,y,s)≥C−1
(t−s)n
2exp/parenleftigg
−d2
s(x,y)
C−1(t−s)/parenrightigg
. (4.10)
27Proof. In the proof, all constants Ci>1 depend on n,K,δandA.
It follows from [28, Formula (203)] that
H(x,t,y,s)≥C−1
1
(t−s)n
2exp/parenleftigg
−d2
t(x,y)
3(t−s)−4(t−s)
3(1−t)2F(y,t)/parenrightigg
. (4.11)
From (4.8), we have
d2
t(x,y)≤2(d2
t(x,p)+d2
t(p,y))≤C2(d2
s(x,p)+d2
s(p,y)+1)≤C3(d2
s(x,y)+1), (4.12)
where we have used ds(x,p)≤C(dt(x,p)+1)≤C(K+1) by (4.8).
In addition, since Fis decreasing with respect to t,
F(y,t)≤F(y,s)≤C4(d2
s(p,y)+1)≤C5(d2
s(x,y)+1), (4.13)
by Lemma 2.3. Combining (4.11), (4.12) and (4.13), it is easy to see (4.10) holds for some C./square
Lemma 4.10. For any K>1,δ∈(0,1)and A>0, there exist constants L 2=L2(n,K,δ,A)>1and
L3=L3(n,δ,A)>1satisfying the following property.
Suppose−δ−1≤s<t≤1−δand d t(p,x)≤K, then for any H n-center (z,s)of(x,t), we have
ds(x,z)≤L2√
t−s (4.14)
and
ds(z,p)≤dt(x,p)+L3√
t−s. (4.15)
Proof. Since dt(p,x)≤K, it follows from [28, Theorem 19] that
vx,t;s/parenleftig
M\Bs(x,r√
t−s)/parenrightig
≤C2exp/parenleftigg
−r2
5/parenrightigg
(4.16)
for any r≥1 and C2=C2(n,K,δ,A)>0. On the other hand, by Proposition 3.14, we have
vx,t;s/parenleftig
M\Bs(z,r√
t−s)/parenrightig
≤C(n) exp/parenleftigg
−r2
5/parenrightigg
(4.17)
for any r≥0. Combining (4.16) and (4.17), (4.14) follows immediately .
If we assume ( z′,s) to be an Hn-center of ( p,t), then (4.14) indicates that
ds(z′,p)≤C3(n,δ,A)√
t−s. (4.18)
Then it follows from Proposition 3.7 and (3.29) that
ds(z,p)≤ds(z,z′)+ds(z′,p)
≤ds
W1(δz,δz′)+C3√
t−s
≤ds
W1(vx,t;s,vp,t;s)+ds
W1(δz,vx,t;s)+ds
W1(δz′,vp,t;s)+C3√
t−s
≤dt(x,p)+2/radicalbig
Hn(t−s)+C3√
t−s.
Therefore, (4.15) holds for L3=C3+2√Hn. /square
28Next, we prove the following rough heat kernel estimate.
Proposition 4.11. For any K>1,δ∈(0,1)and A>0, there exists a constant L 4=L4(n,K,δ,A)>
1satisfying the following property.
Suppose−δ−1≤s<t≤1−δand d s(x,p)+ds(y,p)≤K, then
H(x,t,y,s)≤L4
(t−s)n
2exp/parenleftigg
−d2
s(x,y)
L4(t−s)/parenrightigg
. (4.19)
Proof. Without loss of generality, we assume s=0. In the proof, all constants Cidepend on n,K,δ
andA.
Given 0<t≤1−δandx,y∈Mwith d0(x,p)+d0(y,p)≤K, we set d:=d0(x,y). It follows
from Lemma 4.8 that
dl(x,p)+dl(y,p)≤C1 (4.20)
for any l∈[0,t]. Therefore, it follows from the local distance distortion estimate [28, Theorem 18]
that there exists C2>1 such that if d≥C2√t,
C−1
2d≤dl(x,y)≤C2d (4.21)
for any l∈[0,t]. Notice that if d≤C2√t, (4.19) follows immediately from (4.4). Consequently, we
may assume d≥C2√tand hence (4.21) holds.
For any l∈[0,t/2], we apply [28, Theorem 14] for sets Bl(x,√t),Bl(y,√t) and parameter σ=1
to obtain
vx,t;l/parenleftig
Bl(x,√
t)/parenrightig
vx,t;l/parenleftig
Bl(y,√
t)/parenrightig
≤exp/parenleftigg
−(dl(x,y)−2√t)2
+
16t/parenrightigg
≤C3exp/parenleftigg
−d2
C3t/parenrightigg
(4.22)
for some C3>1, where we have used (4.21). In addition, for any l∈[0,t/2] and dl(x,z)≤√t, it
follows from [28, Theorem 18] that dt(x,z)≤C4√t. Therefore, it follows from [28, Theorem 17]
that
H(x,t,z,l)≥C−1
5t−n
2
and hence
vx,t;l/parenleftig
Bl(x,√
t)/parenrightig
≥C−1
5t−n
2|Bl(x,√
t)|≥C−1
6, (4.23)
where we have used the fact that Ris bounded on Bl(x,√t) and the no-local-collapsing Theorem
4.1.
Combining (4.22) and (4.23), we obtain for any l∈[0,t/2] that
/integraldisplay
Bl(y,√t)H(x,t,z,l)dVl(z)≤C7exp/parenleftigg
−d2
C3t/parenrightigg
. (4.24)
29In light of (4.4), for any l∈[0,t/2], the above inequality implies that
/integraldisplay
Bl(y,√t)H2(x,t,z,l)dVl(z)≤C8
tn
2exp/parenleftigg
−d2
C3t/parenrightigg
. (4.25)
Integrating lfrom 0 to t/2, we have
/integraldisplay t
2
0/integraldisplay
Bl(y,√t)H2(x,t,z,l)dVl(z)ds≤C9
tn
2−1exp/parenleftigg
−d2
C3t/parenrightigg
. (4.26)
Consequently, the desired heat kernel estimate (4.19) foll ows from (4.26) and a parabolic mean
value inequality [6, Lemma 4.2]. Here, [6, Lemma 4.2] can be a pplied in our setting since the key
ingredient is the existence of a nice local cuto ﬀfunction, which is constructed in [6, Theorem 1.3]
(see also Proposition 5.12). Once the existence of the local cutoﬀfunction is guaranteed, one can
follow verbatim the proof of [6, Lemma 4.2] to obtain the mean value inequality. /square
We immediately obtain the following result by combining Lem ma 4.10 and Proposition 4.11.
Corollary 4.12. For any K>1,δ∈(0,1)and A>0, there exists a constant L 5=L5(n,K,δ,A)>1
satisfying the following property.
Suppose−δ−1≤s<t≤1−δand d t(x,p)+ds(y,p)≤K, then for any H n-center (z,s)of(x,t),
we have
H(x,t,y,s)≤L5
(t−s)n
2exp/parenleftigg
−d2
s(z,y)
L5(t−s)/parenrightigg
. (4.27)
Proof. From Lemma 2.3 and (4.8), we have ds(x,p)+ds(y,p)≤Cfor some C=C(n,K,δ)>0.
Then (4.27) follows from (4.14) and (4.19). /square
Next, we prove the following technical result.
Lemma 4.13. There exists a positive constant ¯Q=¯Q(n)>0satisfying the following property.
Suppose x,y∈M, T∈(0,1)and there exists an H n-center (z,0)of(x,T)such that
H(x,T,y,0)≥Qexp/parenleftig
−N∗
0(x,T)/parenrightig
Tn
2exp−d2
0(z,y)
QT (4.28)
for some Q≥¯Q. Then for any H n-center (z′,T1)of(x,T), there exist a point x 1∈M and an
Hn-center (z1,0)of(x1,T1)such that
dT1(x1,z′)≤10√Qd0(z,y) (4.29)
and
H(x1,T1,y,0)≥Q1exp/parenleftig
−N∗
0(x1,T1)/parenrightig
Tn
2
1exp−d2
0(z1,y)
Q1T1, (4.30)
where T 1=T/8and Q 1=2Q.
30/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/0/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1/1PSfrag replacements(x,T)
(y,0) (z,0)(z′,T1)(x1,T1)
(z1,0)t=T
t=T1
t=0B
Figure 1: Find a new point with improved lower bound
Proof. In the proof, all constants Ci>1 depend only on n. We set
d:=d0(z,y),a:=H(x,T,y,0),vt:=vx,T;t,and V:=/braceleftbigg
w∈M|H(w,T1,y,0)≥a
2/bracerightbigg
.
Notice that by (4.28) and (4.5), we have
C1exp/parenleftig
−N∗
0(x,T)/parenrightig
Tn
2≥a≥/radicalbig
Q·/radicalbig
Qexp/parenleftig
−N∗
0(x,T)/parenrightig
Tn
2exp/parenleftigg
−d2
QT/parenrightigg
.
Thus if ¯Qis suﬃciently large, we have Q>¯Q>C2
1and derive from the above inequality that
d2
T≥QlogQ
2. (4.31)
It follows from the semigroup property (3.1) that
a=/integraldisplay
MH(w,T1,y,0)dvT1(w)
=/integraldisplay
M\VH(w,T1,y,0)dvT1(w)+/integraldisplay
VH(w,T1,y,0)dvT1(w)
≤a
2vT1(M\V)+/integraldisplay
VH(w,T1,y,0)dvT1(w)
≤a
2+C1T−n
2
1/integraldisplay
Vexp/parenleftig
−N∗
0(w,T1)/parenrightig
dvT1(w), (4.32)
where we have used (4.5) for the last inequality. Moreover, i t follows from (3.72) and the Lipschitz
property ofN∗
0that
−N∗
0(z′,T1)≤−N∗
0(x,T)+C2/radicalbigg
T−T1
T1≤−N∗
0(x,T)+C3 (4.33)
31and
−N∗
0(w,T1)≤−N∗
0(z′,T1)+/radicalbiggn
2T1dT1(w,z′)≤−N∗
0(x,T)+C4T−1
2dT1(w,z′)+C4. (4.34)
Now, we deﬁne B:=BT1(z′,10Q−1
2d). Then it follows from (4.34)that
/integraldisplay
Vexp/parenleftig
−N∗
0(w,T1)/parenrightig
dvT1(w)
≤eC4exp/parenleftig
−N∗
0(x,T)/parenrightig/integraldisplay
VeC4T−1
2dT1(w,z′)dvT1(w)
≤eC4exp/parenleftig
−N∗
0(x,T)/parenrightig/parenleftigg
e10C4T−1
2Q−1
2dvT1(V∩B)+/integraldisplay
M\BeC4T−1
2dT1(w,z′)dvT1(w)/parenrightigg
. (4.35)
For a small constant β>0 to be determined later, it follows from Proposition 3.14 th at
/integraldisplay
M\BeC4T−1
2dT1(w,z′)dvT1(w)
=∞/summationdisplay
k=1/integraldisplay
2k−1(10Q−1
2d)≤dT1(w,z′)≤2k(10Q−1
2d)eC4T−1
2dT1(w,z′)dvT1(w)
≤∞/summationdisplay
k=1eC42kT−1
210Q−1
2d/integraldisplay
dT1(w,z′)≥2k−1(10Q−1
2d)dvT1(w)
≤C5∞/summationdisplay
k=1expC42kT−1
210Q−1
2d−(2k−110Q−1
2d)2
5(T−T1)
≤C5∞/summationdisplay
k=1exp−(2k−110Q−1
2d)2
5T+C6≤C7exp/parenleftigg
−20d2
QT/parenrightigg
, (4.36)
where we have used the fact that exp/parenleftig
−20d2
QT/parenrightig
≤Q−10≪1 by (4.31).
Combining (4.28), (4.32), (4.35) and (4.36), we have
QT−n
2exp/parenleftigg
−d2
QT/parenrightigg
≤C8T−n
2
1/parenleftigg
e10C4T−1
2Q−1
2dvT1(V∩B)+exp/parenleftigg
−20d2
QT/parenrightigg/parenrightigg
. (4.37)
Since Qis large, by (4.31) we have
Qexp/parenleftigg19d2
QT/parenrightigg
≥Q21
2≥2C88n
2.
Then it is not hard to see from (4.37) that vT1(V∩B)>0. Thus there exists a point x1∈V∩B
which satisﬁes (4.29). Then we take an Hn-center ( z1,0) of ( x1,T1). The point selecting process is
illustrated in Figure 1.
32It follows from Proposition 3.7 and (3.29) that
d0(z,z1)=d0
W1(δz,δz1)
≤d0
W1(vx,T;0,vx1,T1;0)+d0
W1(δz,vx,T;0)+d0
W1(δz1,vx1,T1;0)
≤dT1
W1(vx,T;T1,δx1)+/radicalbig
HnT+/radicalbig
HnT1
≤dT1
W1(vx,T;T1,δz′)+dT1(z′,x1)+/radicalbig
HnT+/radicalbig
HnT1
≤/radicalbig
Hn(T−T1)+/radicalbig
HnT+/radicalbig
HnT1+10Q−1
2d
≤3/radicalbig
HnT+10Q−1
2d. (4.38)
Therefore, we conclude
d0(z1,y)≥d−d0(z,z1)≥(1−10Q−1
2)d−3/radicalbig
HnT (4.39)
and hence
d2
0(z1,y)≥(1−10Q−1
2)2
2d2−9HnT. (4.40)
Since x1∈V, from the deﬁnition of Vand (4.28) we have
H(x1,T1,y,0)≥a
2≥Qexp/parenleftig
−N∗
0(x,T)/parenrightig
2Tn
2exp/parenleftigg
−d2
QT/parenrightigg
, (4.41)
which enables us to claim
Qexp/parenleftig
−N∗
0(x,T)/parenrightig
2Tn
2exp/parenleftigg
−d2
QT/parenrightigg
≥Q1exp/parenleftig
−N∗
0(x1,T1)/parenrightig
Tn
2
1exp−d2
0(z1,y)
Q1T1. (4.42)
Indeed, it follows from (4.34) that
−N∗
0(x1,T1)≤−N∗
0(x,T)+C9(1+d(QT)−1
2). (4.43)
On the other hand, by (4.40) we have
expd2
0(z1,y)
Q1T1−d2
QT−C9/radicaligg
d2
QT−C9
≥exp/parenleftigg1
QT/parenleftbigg
2(1−10Q−1
2)2−0.9/parenrightbigg
d2−36Hn
Q−C10/parenrightigg
≥exp/parenleftiggd2
QT−36Hn
Q−C10/parenrightigg
≥/radicalbig
Qexp/parenleftigg
−36Hn
Q−C10/parenrightigg
≥4·8n
2, (4.44)
where we have used (4.31) for the last inequality. As ¯Qis suﬃciently large, it is clear that (4.42)
follows from the combination of (4.43) and (4.44). Conseque ntly, we obtain (4.30). /square
33Proposition 4.14. For any x,y∈M and t∈(0,1),
H(x,t,y,0)≤¯Qexp/parenleftig
−N∗
0(x,t)/parenrightig
tn
2exp−d2
0(z,y)
¯Qt (4.45)
where (z,0)is any H n-center of (x,t)and ¯Q is the same constant in Proposition 4.13.
Proof. Suppose otherwise, there exist x,y∈M,T∈(0,1) and an Hn-center ( z,0) of ( x,T) such that
H(x,T,y,0)≥¯Qexp/parenleftig
−N∗
0(x,T)/parenrightig
Tn
2exp−d2
0(z,y)
¯QT. (4.46)
Now, we deﬁne Qk=2k¯QandTk:=8−kTfork∈N. If we set x0=xandz0=z, then we claim
there are sequences xk,z′
kandzksatisfying
(a) ( z′
k,Tk) is an Hn-center of ( xk−1,Tk−1).
(b) ( zk,0) is an Hn-center of ( xk,Tk).
(c)dTk(xk,z′
k)≤10Q−1
2
k−1d0(zk−1,y).
(d)d0(zk,zk−1)≤3√HnTk−1+10Q−1
2
k−1d0(zk−1,y).
(e) We have the heat kernel estimate
H(xk,Tk,y,0)≥Qkexp/parenleftig
−N∗
0(xk,Tk)/parenrightig
Tn
2
kexp−d2
0(zk,y)
QkTk. (4.47)
The existence of xk,z′
kandzksatisfying (a)-(e) is obtained by Lemma 4.13 and an inductiv e
argument. Notice that (d) is guaranteed by (4.38).
Claim :bk:=dTk(xk,p) is uniformly bounded.
Proof of the Claim : We set dk:=d0(zk,y) for k∈N. It follows from (d) that
dk≤dk−1+d0(zk,zk−1)≤/parenleftbigg
1+10Q−1
2
k−1/parenrightbigg
dk−1+3/radicalbig
HnTk−1. (4.48)
Therefore, it is easy to derive from (4.48) and the deﬁnition s ofQkandTkthat
dk≤K1<∞ (4.49)
for some constant K1depending on d0(z,y),T,¯Qandn. From (c) and (4.49), we have
dTk(xk,z′
k)≤10Q−1
2
k−1dk−1≤10K1Q−1
2
k−1. (4.50)
Moreover, since ( z′
k,Tk) is an Hn-center of ( xk−1,Tk−1), it follows from (4.15) that
dTk(z′
k,p)≤dTk−1(xk−1,p)+L3/radicalbig
Tk−1−Tk≤bk−1+L3T1
2
k−1, (4.51)
34where L3=L3(n,δ,A)>0 for some ﬁxed constant δ∈(0,1) with T≤1−δ. Combining (4.50) and
(4.51), we obtain
bk≤bk−1+10K1Q−1
2
k−1+L3T1
2
k−1. (4.52)
From (4.52), it is clear that bkis uniformly bounded, and the Claim is proved.
Thanks to the Claim, we can apply Corollary 4.12 to obtain an u pper bound of heat kernel, which
contradicts the lower bound (4.47) when kis suﬃciently large. /square
Now, we state the main theorem of this section regarding the h eat kernel upper bound, which
generalizes and slightly improves [2, Theorem 7.2].
Theorem 4.15. (Mn,g(t))t<1is the Ricci ﬂow associated with a Ricci shrinker. For any ǫ >0, there
exists a constant C =C(n,ǫ)>0such that
H(x,t,y,s)≤Cexp/parenleftbig−N (x,t)(t−s)/parenrightbig
(t−s)n
2exp/parenleftigg
−d2
s(z,y)
(4+ǫ)(t−s)/parenrightigg
, (4.53)
for any s<t<1and any H n-center (z,s)of(x,t).
Proof. Without loss of generality, we assume s=0. The proof is a modiﬁcation of the proof of
Lemma 4.13 and all constants Ci>1 depend on nandǫ.
Suppose otherwise, there exist x,y∈M,T∈(0,1),ǫ >0 and an Hn-center ( z,0) of ( x,T) such
that
H(x,T,y,0)≥Qexp/parenleftig
−N∗
0(x,T)/parenrightig
Tn
2exp−d2
0(z,y)
(4+ǫ)T, (4.54)
where Qis a large constant determined later. We also set θ∈(0,1) as a small parameter and θ3
1=θ.
Deﬁne
d:=d0(z,y),a:=H(x,T,y,0),vt:=vx,T;t,Tθ:=θT,
V:=/braceleftbigg
w∈M|H(w,Tθ,y,0)≥a
2/bracerightbigg
.
From (4.54) and (4.5), we have
exp/parenleftiggd2
T/parenrightigg
≥/braceleftig
C−1
1Q/bracerightig4+ǫ. (4.55)
Now, we assume ( z′,Tθ) is an Hn-center of ( x,T) and set B:=BTθ(z′,(1−θ1)d). Similar to (4.34),
we have
−N∗
0(w,Tθ)≤−N∗
0(x,T)+C2θ−1
2T−1
2dTθ(w,z′)+C2θ−1
2. (4.56)
35By the same argument as (4.36), we apply Proposition 3.14 for ǫ/4 to obtain if θ<¯θ(ǫ),
/integraldisplay
M\BeC2θ−1
2T−1
2dTθ(w,z′)dvTθ(w)
≤C3∞/summationdisplay
k=1exp/parenleftigg
C22kθ−1
2T−1
2(1−θ1)d−(2k−1(1−θ1)d)2
(4+ǫ/4)(1−θ)T/parenrightigg
≤C3∞/summationdisplay
k=1exp/parenleftigg
−(2k−1(1−θ1)d)2
(4+ǫ/3)(1−θ)T+C4θ−1/parenrightigg
≤C5exp/parenleftigg
−((1−θ1)d)2
(4+ǫ/3)(1−θ)T+C4θ−1/parenrightigg
. (4.57)
Similar to (4.37), we obtain
QT−n
2exp/parenleftigg
−d2
(4+ǫ)T/parenrightigg
≤C6T−n
2
θ/parenleftigg
eC2θ−1
2T−1
2(1−θ1)dvTθ(V∩B)+eC6θ−1exp/parenleftigg
−((1−θ1)d)2
(4+ǫ/3)(1−θ)T/parenrightigg/parenrightigg
.
(4.58)
We claim that vTθ(V∩B)>0. Indeed, it follows from (4.55) that
Qexp/parenleftigg/parenleftigg(1−θ1)2
(4+ǫ/3)(1−θ)−1
(4+ǫ)/parenrightiggd2
T/parenrightigg
≥Qexp/parenleftiggc(ǫ)d2
T/parenrightigg
≥Q1+c(ǫ)C−c(ǫ)
1≥2C6θ−n
2eC6θ−1,
where c(ǫ)>0 depends only on ǫ >0 and we choose θ <¯θ(ǫ) and Qsuﬃciently large. Therefore,
the claim follows from (4.58).
We choose a point x1∈V∩Band an Hn-center ( z1,0) of ( x1,Tθ). Similar to (4.38), we have
d0(z,z1)≤3/radicalbig
HnT+(1−θ1)d (4.59)
and hence
d0(z1,y)≥θ1d−3/radicalbig
HnT. (4.60)
Moreover, as (4.43), we have by (4.56),
−N∗
0(x1,Tθ)≤−N∗
0(x,T)+C2θ−1
2(T−1
2d+1). (4.61)
Now, by virtue of Proposition 4.14 and the deﬁnition of V, we have
¯Qexp−d2
0(z1,y)
¯QTθ≥H(x1,Tθ,y,0)·Tn
2·exp/parenleftig
N∗
0(x1,Tθ)/parenrightig
≥1
2Qexp/parenleftigg
−d2
(4+ǫ)T/parenrightigg
. (4.62)
Since d2
0(z1,y)≥θ2
1d2/2−9HnTfrom (4.60), it follows from (4.61) and (4.62) that
Qexp/parenleftigg/parenleftigg1
2θ1¯Q−1
(4+ǫ)−1/parenrightiggd2
T−C7θ−1/parenrightigg
≤Qexp/parenleftigg/parenleftigg1
2θ1¯Q−1
(4+ǫ)/parenrightiggd2
T−C2θ−1
2T−1
2d/parenrightigg
≤2¯Qθ−n
2exp/parenleftigg9Hn
¯Qθ/parenrightigg
, (4.63)
provided that θ≤¯θ(ǫ,¯Q). However, (4.63) is impossible by (4.55) if Qis suﬃciently large.
In sum, we obtain a contradiction and (4.53) holds. /square
36Combining Lemma 4.10 and Theorem 4.15, we have the following estimate, which improves
[28, Theorem 20].
Theorem 4.16. For any K>1,δ∈(0,1)and A>0, there exists a constant C =C(n,K,δ,A)>1
satisfying the following property.
Suppose−δ−1≤s<t≤1−δand d t(x,p)≤K, then
H(x,t,y,s)≤C
(t−s)n
2exp/parenleftigg
−d2
s(x,y)
C(t−s)/parenrightigg
. (4.64)
Remark 4.17. Given (x0,t0)∈M×(−∞,1), if we set H (x0,t0,y,s)=(4π(t0−s))−n
2e−b(y,s), then it
follows from Theorem 4.9 and Theorem 4.16 that b (y,s)increases quadratically.
Combining (4.64) and the standard regularity theory of the p arabolic equation (cf. [20]), we have
the following derivative estimate of higher orders.
Corollary 4.18. Given (x0,t0)∈M×(−∞,1)and s 0<t0, there exists a small parabolic neighbor-
hood P=Bt0(x0,r)×[t0−r2,t0+r2]such that for any m 1,m2∈N
|∂m1
t∇m2xH(x,t,y,s0)|≤1
r2m1+m2·Q
(t0−s0)n
2·exp−d2
s0(x0,y)
Q(t0−s0) (4.65)
for some constant Q >1and any (x,t)∈P and y∈M.
Note that when ( y,s0) is ﬁxed, H(x,t,y,s0) is a heat solution. The scale rin the above Corollary
is small constant much less than the curvature radius at ( x0,t0). Then inequality (4.65) can be
obtained by dominated convergence theorem. It indicates th at one can take diﬀerentiation under
the integral sign if the integrand involves the heat kernel i n many cases. As an application, we can
follow the same proof as in Theorem 3.23 to estimate |∇N∗
s|and/squareN∗
swithout using φr. Therefore,
one obtains
Corollary 4.19. The Nash entropyN∗
s(x,t)is smooth on M×(s,1)satisfying
|∇N∗
s|≤/radicalbiggn
2(t−s)and−n
2(t−s)≤/squareN∗
s≤0
in the classical sense.
We end this section by proving the following hypercontracti vity; see [2, Theorem 12.1].
Theorem 4.20. Suppose that (x0,t0)∈M×(−∞,1)and0<τ 1<τ 2. Let u∈C2(M×[t0−τ2,t0−τ1])
be a nonnegative function satisfying /squareu≤0and having at most polynomial spatial growth in the
sense that
|u(x,t)|≤m(dm
t(p,x)+1) (4.66)
for some m∈N. If1<q0≤p0<∞with
τ2
τ1≥p0−1
q0−1,
then for dv t:=dvx0,t0;t,/parenleftigg/integraldisplay
Mup0dvt0−τ1/parenrightigg1/p0
≤/parenleftigg/integraldisplay
Muq0dvt0−τ2/parenrightigg1/q0
. (4.67)
37Proof. Without loss of generality, we assume t0=0. We set p=p(t)=1+τ2(q0−1)|t|−1fort<0.
Notice that p(−τ2)=q0andp(−τ1)≥p0by our assumption.
When t<0, direct calculation shows that
∂t/integraldisplay
Mupφrdvt−/integraldisplay
Mup/squareφrdvt
=/integraldisplay
M/parenleftig
˙puplogu+pup−1/squareu−p(p−1)|∇u|2up−2/parenrightig
φr−2/a\}b∇acke⊔le{⊔∇up,∇φr/a\}b∇acke⊔∇i}h⊔dvt
≤˙p
p/integraldisplay
Mφruplogupdvt−p−1
p/integraldisplay
M|∇up|2
upφrdvt−2/integraldisplay
M/a\}b∇acke⊔le{⊔∇up,∇φr/a\}b∇acke⊔∇i}h⊔dvt. (4.68)
Moreover, we have for any ǫ≪1,
2/integraldisplay
M|∇up||∇φr|dvt≤ǫ/integraldisplay
M|∇up|2
upφrdvt+ǫ−1/integraldisplay
Mup|∇φr|2dvt. (4.69)
Combining (4.68) and (4.69), we have
∂t/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg1
p
=1
p/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg1
p−1/parenleftigg
∂t/integraldisplay
Mupφrdvt−˙p
p/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg
log/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg/parenrightigg
≤1
p/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg1
p−1/parenleftigg˙p
p/integraldisplay
Mφruplogupdvt−˙p
p/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg
log/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg/parenrightigg
+1
p/parenleftigg/integraldisplay
Mupφrdvt/parenrightigg1
p−1/parenleftigg/parenleftigg
ǫ−p−1
p/parenrightigg/integraldisplay
M|∇up|2
upφrdvt+ǫ−1/integraldisplay
Mup/braceleftig
|∇φr|2+/squareφr/bracerightig
dvt/parenrightigg
.(4.70)
We integrate (4.70) from −τ2to−τ1, letr→∞ and then let ǫ→0. By Theorem 4.4, (4.66), (2.12)
and (2.15), we obtain
/parenleftigg/integraldisplay
Mupdvt/parenrightigg1
p/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle−τ1
−τ2
≤/integraldisplay−τ1
−τ21
p/parenleftigg/integraldisplay
Mupdvt/parenrightigg1
p−1/parenleftigg˙p
p/integraldisplay
Muplogupdvt−˙p
p/parenleftigg/integraldisplay
Mupdvt/parenrightigg
log/parenleftigg/integraldisplay
Mupdvt/parenrightigg/parenrightigg
dt
+/integraldisplay−τ1
−τ21
p/parenleftigg/integraldisplay
Mupdvt/parenrightigg1
p−1/parenleftigg
−p−1
p/integraldisplay
M|∇up|2
updvt/parenrightigg
dt. (4.71)
Note that the log-Sobolev inequality [28, Theorem 13] impli es that
˙p
p/integraldisplay
Muplogupdvt−˙p
p/parenleftigg/integraldisplay
Mupdvt/parenrightigg
log/parenleftigg/integraldisplay
Mupdvt/parenrightigg
≤˙p
p|t|/integraldisplay
M|∇up|2
updvt=p−1
p/integraldisplay
M|∇up|2
updvt.
Therefore, it follows from (4.71) that
/parenleftigg/integraldisplay
Mup0dv−τ1/parenrightigg1
p0≤/parenleftigg/integraldisplay
Mup(−τ1)dv−τ1/parenrightigg 1
p(−τ1)
≤/parenleftigg/integraldisplay
Muq0dv−τ2/parenrightigg1
q0
and the proof is complete. /square
38Remark 4.21. If u∈C2(M×[t0−τ2,t0−τ1])and satisﬁes/squareu=0and(4.66) , then
/parenleftigg/integraldisplay
M|u|p0dvt0−τ1/parenrightigg1/p0
≤/parenleftigg/integraldisplay
M|u|q0dvt0−τ2/parenrightigg1/q0
.
Indeed, one can apply (4.67) to√
u2+ǫsince/square√
u2+ǫ≤0, and letǫ→0.
5 Parabolic neighborhoods and ǫ-regularity theorem
In this section, we assume ( Mn,g(t))t<1is the Ricci ﬂow associated with a Ricci shrinker in M(A).
Given ( x0,t0)∈M×(−∞,1), we ﬁrst recall the conventional parabolic neighborhood s are deﬁned
by
P(x0,t0;S,−T−,T+) :=Bt0(x0,S)×/parenleftbig[t0−T−,t0+T+]∩(−∞,1)/parenrightbig(5.1)
Q(x0,t0;S,−T−,T+) :=/braceleftbigdt(x,x0)≤S,t∈[t0−T−,t0+T+]∩(−∞,1)/bracerightbig(5.2)
for any S,T±≥0. Based on the monotonicity of W1-distance in Proposition 3.7, we follow [2] to
deﬁne the following new parabolic neighborhoods.
Deﬁnition 5.1 (P∗-parabolic neighborhoods) .Suppose that (x0,t0)∈M×(−∞,1)and S,T±≥0.
The P∗-parabolic neighborhood P∗(x0,t0;S,−T−,T+)⊂M×(−∞,1)is deﬁned as the set of points
(x,t)∈M×(−∞,1)with t∈[t0−T−,t0+T+]and
dt0−T−
W1(vx0,t0;t0−T−,vx,t;t0−T−)<S.
For any r>0, we also deﬁne
P∗(x0,t0;r) :=P∗(x0,t0;r,−r2,r2)
P∗+(x0,t0;r) :=P∗(x0,t0;r,0,r2)
P∗−(x0,t0;r) :=P∗(x0,t0;r,−r2,0).
Similar deﬁnitions are also made for P±.
Some basic properties of P∗-parabolic neighborhoods can be found in [2, Proposition 9. 4, Corol-
lary 9.6]. We state the following containment result from [2 , Proposition 9.4 (d)].
Lemma 5.2. If A 1,A2,T±
1,T±
2≥0and(x1,t1)∈P∗(x2,t2;A2,−T−
2,T+
2), then
P∗(x1,t1;A1,−T−
1,T+
1)⊂P∗(x2,t2;A1+A2,−(T−
1+T−
2),T+
1+T+
2).
We immediately have the following result from the distance c omparison Lemma 4.8.
Lemma 5.3. Givenδ∈(0,1), t0∈(−∞,1), T±≥0and S≥0, there exists a constant C =
C(n,A,δ)>1such that
P(p,t0;S,−T−,T+)⊂Q(p,t0;C(S+1),−T−,T+)
Q(p,t0;S,−T−,T+)⊂P(p,t0;C(S+1),−T−,T+)
provided that−δ−1≤t0−T−≤t0+T+≤1−δ.
39In order to investigate the relation between P∗-parabolic neighborhoods and conventional ones,
we ﬁrst prove
Proposition 5.4. Given (x0,t0)∈M×(−∞,1)and r>0, suppose R (x0,t)≤r−2for any t∈
[t0−r2,t0]. Then
dt0−r2
W1(vx0,t0;t0−r2,δx0)≤C(n,A)r. (5.3)
Proof. It follows from [28, Theorem 16] that
H(x0,t0,x0,t0−r2)≥1
(4πr2)n
2exp/parenleftig
−l(x0,t0)(x0,t0−r2)/parenrightig
, (5.4)
From the deﬁnition of l(x0,t0)(x0,t0−r2) we have
l(x0,t0)(x0,t0−r2)≤1
2r/integraldisplayt0
t0−r2√t0−s R(x0,s)ds≤1
3. (5.5)
Combining (4.53) for ǫ=1, (5.4) and (5.5), it is clear that
d2
t0−r2(x0,z)≤C1r2
for some constant C1=C1(n,A), where ( z,t0−r2) is an Hn-center of ( x0,t0). Therefore,
dt0−r2
W1(vx0,t0;t0−r2,δx0)≤dt0−r2
W1(vx0,t0;t0−r2,δz)+dt0−r2(x0,z)≤C2r,
where we have used (3.29) and C2:=√Hn+√C1. /square
Remark 5.5. From the proof, we conclude that (5.3) also holds for a constant C =C(n,A,α)if we
assume
R(x0,t)≤α
r2(t0−t)
for someα>0and any t∈[t0−r2,t0].
Corollary 5.6. For any s 0<t0<1, we have
ds0
W1(vp,t0;s0,δp)≤C(n,A)√t0−s0. (5.6)
Proof. From the self-similarity of the ﬂow, we know that
R(p,t)=R(p,0)
1−t≤n
2(1−t)≤n
2(t0−t)
for any t<t0. Therefore, the conclusion follows from Proposition 5.4 an d Remark 5.5. /square
Proposition 5.7. Givenδ∈(0,1), t0∈(−∞,1), T±≥0and S≥0, there exists a constant
C=C(n,A,δ)>1such that
Q(p,t0;S,−T−,T+)⊂P∗(p,t0;S+C,−T−,T+)
provided that t 0−T−≥−δ−1.
40Proof. For any ( x,t)∈Q(p,t0;S,−T−,T+), we have
dt0−T−
W1(vp,t0;t0−T−,vx,t;t0−T−)
≤dt0−T−
W1(vp,t;t0−T−,vx,t;t0−T−)+dt0−T−
W1(vp,t0;t0−T−,vp,t;t0−T−)
≤dt(x,p)+dt0−T−
W1(vp,t0;t0−T−,vp,t;t0−T−)≤S+dt0−T−
W1(vp,t0;t0−T−,vp,t;t0−T−), (5.7)
where we have used Proposition 3.10. In addition, it follows from Corollary 5.6 that
dt0−T−
W1(vp,t0;t0−T−,vp,t;t0−T−)≤dt0−T−
W1(vp,t0;t0−T−,δp)+dt0−T−
W1(vp,t;t0−T−,δp)≤C(n,A,δ). (5.8)
Therefore, the conclusion follows from (5.7) and (5.8). /square
Next, we recall the following version of the local distance d istortion estimate, which can be
proved almost exactly as [28, Theorem 18]; see also [16, Sect ion 4.3], [17, Theorem 3.1] and [6,
Theorem 1.1].
Lemma 5.8. Given (x0,t0)∈M×(−∞,1)and r>0, suppose R≤r−2on P−(x0,t0;r) (resp.
P(x0,t0;r)). Then
ρ1dt(x,x0)≤dt0(x,x0)≤ρ−1
1dt(x,x0)
if d t0(x,x0)≤ρ1r and t∈[t0−(ρ1r)2,t0) (resp. t∈[t0−(ρ1r)2,t0+(ρ1r)2]∩(−∞,1)), where
ρ1=ρ1(n,A)∈(0,1). In particular,
P−(x0,t0;ρ2
1r)⊂Q−(x0,t0;ρ1r)⊂P−(x0,t0;r) (5.9)
/parenleftig
resp. P (x0,t0;ρ2
1r)⊂Q(x0,t0;ρ1r)⊂P(x0,t0;r)/parenrightig
. (5.10)
Thanks to Proposition 5.4 and Lemma 5.8, we have the followin g result.
Proposition 5.9. There exists a constant ρ2=ρ2(n,A)∈(0,1)satisfying the following prop-
erty. Given (x0,t0)∈M×(−∞,1)and r>0, suppose that R≤r−2on P (x0,t0;r,−(ρ2r)2) (resp.
P(x0,t0;r,−(ρ2r)2,(ρ2r)2)). Then
P−(x0,t0;ρ2r)⊂P∗(x0,t0;r,−(ρ2r)2,0) (5.11)
/parenleftig
resp. P (x0,t0;ρ2r)⊂P∗(x0,t0;r,−(ρ2r)2,(ρ2r)2)/parenrightig
. (5.12)
Proof. In the proof, all constants Ci>1 depend on nandAandρ1is from Lemma 5.8. We only
prove (5.11), and the proof of (5.12) is similar. Moreover, w e set 0<τ≪1 to be determined later.
For any ( y,s)∈P−(x0,t0;τr), it follows from Lemma 5.8 that
dt(y,x0)≤C1τr (5.13)
41for any t∈[t0−(τr)2,s]. In particular, R(y,t)≤r−2for any t∈[t0−(τr)2,s]. Therefore, it follows
from Proposition 5.4 that
dt0−(τr)2
W1(vy,s;t0−(τr)2,δy)≤C2τr. (5.14)
It follows from (5.13) and (5.14) that
dt0−(τr)2
W1(vy,s;t0−(τr)2,vx0,t0;t0−(τr)2)
≤dt0−(τr)2
W1(vx0,t0;t0−(τr)2,δx0)+dt0−(τr)2
W1(vy,s;t0−(τr)2,δy)+dt0−(τr)2(y,x0)≤C3τr<r,
ifτis suﬃciently small. From this, it is immediate that (5.11) holds f or smallρ2./square
Now, we prove
Proposition 5.10. Givenδ∈(0,1), t0∈(−∞,1), T±≥0and S≥0, there exists a constant
C=C(n,A,δ)>1such that
P∗(p,t0;S,−T−,T+)⊂Q(p,t0;√
2S+C,−T−,T+) (5.15)
provided that t 0−T−≥−δ−1. In particular, it implies that P∗(p,t0;S,−T−,T+)is precompact in
M×(−∞,1)if t0+T+<1.
Proof. In the proof, all constants Ci>1 depend on n,Aandδ. It follows from (5.6) that
dt0−T−
W1(δp,vp,t0;t0−T−)≤C1. (5.16)
For any ( x1,t1)∈P∗(p,t0;S,−T−,T+), we assume ( z,t0−T−) to be an Hn-center of ( x1,t1). By
(5.16) and the deﬁnition of P∗neighborhood, we have
dt0−T−(p,z)≤dt0−T−
W1(δp,vp,t0;t0−T−)+dt0−T−
W1(vp,t0;t0−T−,δz)
≤dt0−T−
W1(δz,vx1,t1;t0−T−)+dt0−T−
W1(vp,t0;t0−T−,vx1,t1;t0−T−)+C1
≤S+C2. (5.17)
Setvt=vx1,t1;tand compute
∂t/integraldisplay
Mφrdvt=/integraldisplay
M/squareφrdvt.
By (2.15), we have
φr(x1,t1)≥/integraldisplay
Mφrdvt0−T−−C(n)r−1(t1−t0+T−)≥/integraldisplay
F≤r1dvt0−T−−C3r−1.
Note thatφr=1 ifF≤randris large. In light of (5.17) and Lemma 2.3, the set {F≤r}contains a
large geodesic ball centered at z. Thus by Proposition 3.13, the above inequality implies tha t
φr(x1,t1)≥/integraldisplay
F≤r1dvt0−T−−C3r−1≥1
2(5.18)
42if 2√r=S+C4. Sinceφris supported on F≤2r, we conclude from (5.18) that
F(x1,t1)≤2r=(S+C4)2
2.
From Lemma 2.3 and Lemma 4.8, we immediate conclude that
dt1(p,x1)≤√
2S+C5.
Now, the last conclusion follows from (5.15) and Lemma 5.3. /square
Corollary 5.11. Given (x0,t0)∈M×(−∞,1)and S,T±≥0, P∗(x0,t0;S,−T−,T+)is precompact
in M×(−∞,1)if t0+T+<1.
Proof. It is clear that ( x0,t0)∈P∗(p,t0;S′,−1,0) for some large S′>0. Therefore, it follows from
Lemma 5.2
P∗(x0,t0;S,−T−,T+)⊂P∗(p,t0;S+S′,−(1+T−),T+).
Therefore, the conclusion follows from Proposition 5.10. /square
Next, we recall the following existence of the local cuto ﬀfunction from [6, Theorem 1.3].
Proposition 5.12. Given (x0,t0)∈M×(−∞,1)and r>0, there exists a constant ρ3=ρ3(n,A)∈
(0,1)satisfying the following property.
Suppose R≤r−2on P (x0,t0;r,0,−τ)with 0< τ≤(ρ3r)2. Then there exists a function ϕ∈
C∞(M×[t0−τ,t0])with the following properties:
(a) 0≤ϕ<1on M×[t0−τ,t0].
(b)ϕ>ρ 3on P (x0,t0;ρ3r,0,−τ).
(c)ϕ=0outside P (x0,t0;r,0,−τ).
(d)|∇ϕ|≤r−1and|∂tϕ|+|∆ϕ|≤r−2.
(e)/squareϕ≤0on M×[t0−τ,t0].
Proof. We sketch the proof for readers’ convenience. In [6, Theorem 1.3],ϕis constructed as the
smoothing of ψ2, where
ψ(x,t) :=c1max{K(x,t)−c,0}
for some constants c,c1>0 on U×[t0−τ,t0] for some open set U⊂Bt0(x0,r), whereψ=0 on
∂U×[t0−τ,t0] and can be extended to be 0 outside U×[t0−τ,t0]. Here, K(x,t)=H(x,t,y,s) for
some appropriate ( y,s) such that K(x0,t0)≥(4π(t0−s))−n
2e−n/2andt0−sis suﬃciently small.
The estimates of (a)-(d) follow from [28, Lemma 20]. From the deﬁnitions of ψandϕ, it is clear
that (e) also holds. /square
43Next, we prove
Proposition 5.13. There exists a constant ρ4=ρ4(n,A)∈(0,1)satisfying the following property.
Given (x0,t0)∈M×(−∞,1)and r>0, suppose that R≤r−2on P (x0,t0;r,−(ρ4r)2,0) (resp.
P(x0,t0;r,−(ρ4r)2,(ρ4r)2)). Then
P∗−(x0,t0;ρ4r)⊂P(x0,t0;r,−(ρ4r)2,0) (5.19)
/parenleftig
resp. P∗(x0,t0;ρ4r)⊂P(x0,t0;r,−(ρ4r)2,(ρ4r)2)/parenrightig
. (5.20)
Proof. In the proof, all positive constants Ci>1 depend only on nandA. Moreover, we set
0<τ≪1 to be determined later.
For any ( y,s)∈P∗−(x0,t0;τr), we assume ( z,t0−(τr)2) to be its Hn-center. From Proposition
5.4, we have
dt0−(τr)2(z,x0)
≤dt0−(τr)2
W1(δx0,vx0,s;t0−(τr)2)+dt0−(τr)2
W1(vy,s;t0−(τr)2,vx0,s;t0−(τr)2)+dt0−(τr)2
W1(δz,vy,s;t0−(τr)2)
≤C1τr. (5.21)
We assume τ < ρ 3and consider the cuto ﬀfunctionϕconstructed in Proposition 5.12. If we set
vt=vy,s;t, then by direct computation,
∂t/integraldisplay
Mϕdvt=/integraldisplay
M/squareϕdvt≥−r−2,
where we have used Proposition 5.12(d). By integration, we h ave
ϕ(y,s)≥/integraldisplay
Mϕdvt0−(τr)2−τ. (5.22)
Notice that ϕ > ρ 3onP(x0,t0;ρ3r,0,(τr)2). Combining this fact with (5.21) and Proposition 3.13,
we conclude that if τis suﬃciently small,
ϕ(y,s)≥/integraldisplay
Mϕdvt0−(τr)2−τ≥ρ3
2>0.
On the other hand, since ϕ=0 outside P(x0,t0;r,−(τr)2), we conclude that
dt0(x0,y)≤r
and hence (5.19) holds. /square
Next, we recall the deﬁnition of the curvature radius.
44Deﬁnition 5.14 (Curvature radius) .For any (x,t)∈M×(−∞,1), the curvature radii at (x,t)are
deﬁned as
rRm(x,t) :=sup/braceleftig
r>0||Rm|≤r−2on P (x,t;r)/bracerightig
,
r−
Rm(x,t) :=sup/braceleftig
r>0||Rm|≤r−2on P−(x,t;r)/bracerightig
,
rs
Rm(x,t) :=sup/braceleftig
r>0||Rm|≤r−2on B t(x,r)/bracerightig
.
It is clear from the deﬁnition that rRm(x,t)≤r−
Rm(x,t)≤rs
Rm(x,t). In addition, it follows from
Theorem 4.1 and the pseudolocality theorem [28, Theorem 24] on Ricci shrinkers that there exists
a constant C=C(n,A)>1 such that
r−
Rm(x,t)≤CrRm(x,t). (5.23)
We are in a position to obtain the following ǫ-regularity theorem; see [2, Theorem 10.2].
Theorem 5.15 (ǫ-regularity) .There exists a small constant ǫ=ǫ(n)>0satisfying the following
property. Given (x,t)∈M×(−∞,1)and r>0, suppose thatN(x,t)(r2)≥−ǫ, then r Rm(x,t)≥ǫr.
Proof. We only sketch the proof as the details can be found in [2, Theo rem 10.2]. The key
step is a point-picking argument in the spacetime with respe ct to the curvature radius rRm. More
precisely, one needs to show that for any A>0 with 10 ArRm(x,t)≤1/2, there exists a point
(x′,t′)∈P∗−(x′,t′; 10ArRm(x,t)) such that rRm(x′,t′)≤rRm(x,t) and rRm≥rRm(x′,t′)/10 on
P∗−(x′,t′;ArRm(x′,t′)). Otherwise, one can iteratively pick a sequence of spacet ime points ( xi,ti) in
a compact set of M×(−∞,1) satisfying rRm(xi,ti)→0. In light of Lemma 5.2, all ( xi,ti) fall into a
given P∗−-parabolic neighborhood, which is precompact by Corollary 5.11. Note that the curvature
radius of ( xi,ti) shrinks by a deﬁnite portion in each step, the bounded geome try of a compact set
implies that the process must terminate in ﬁnite steps, say ( xk,tk)=(x′,t′). Such choice of ( x′,t′)
guarantees that it has almost maximal curvature radius in sp acetime neighborhood. Notice that
similar point-picking arguments can be found in [34, Theore m 10.1] and [16, Proposition 3.43].
If theǫ-regularity theorem fails, we could obtain a sequence of poi nted Ricci ﬂows such that
rRm=1 at the base points after the point-picking and appropriate rescalings. Since nearby points
have curvature radii uniformly bounded from below, the sequ ence converges smoothly to a limit
Ricci ﬂow which is the Euclidean spacetime by the assumption of the Nash entropy. Therefore,
rRm=1 must be violated and we obtain a contradiction. /square
Using theǫ-regularity theorem, one immediately has the following gap property, following the
same proof of [28, Theorem 3].
Corollary 5.16. Suppose (Mn,g,f,p)is a non-ﬂat Ricci shrinker. Then
N(p,0)(ǫ−2)<−ǫ,
whereǫis the same constant in Theorem 5.15.
45Proof. SupposeN(p,0)(ǫ−2)≥−ǫand ( M,g) is a non-ﬂat Ricci shrinker, it follows from Theorem
5.15 that rRm(p,0)≥1. In particular, it implies that |Rm(p,t)| ≤1 for any t∈[0,1). By the
self-similarity of the ﬂow, we have |Rm|(p,0)=|Rm|(p,t)(1−t) and hence|Rm|(p,0)=0, which
contradicts the fact that R>0 for non-ﬂat Ricci shrinkers. /square
We conclude this section by stating the following two result s, whose proofs are more or less
standard. See [2, Theorem 10.3, Theorem 10.4].
Theorem 5.17. For anyǫ > 0there is aδ=δ(ǫ)>0such that the following holds. Given
(x,t)∈M×(−∞,1)and r>0, ifNx,t(r2)≥−δ, then
|Rm|≤ǫr−2on P (x,t;ǫ−1r,−(1−ǫ)r2,ǫ−1r2).
Moreover, we have N∗
t−r2≥−ǫon P (x,t;ǫ−1r,−(1−ǫ)r2).
Theorem 5.18. For anyǫ >0and Y<∞there is aδ=δ(ǫ,Y)>0such that the following holds.
Given (x,t)∈M×(−∞,1)and r>0, suppose that|Rm|≤r−2on P−(x,t;r)andNx,t(r2)≥−Y.
ThenNx,t(δr2)≥−ǫ.
6 Metric ﬂows and F-convergence
In previous sections, we have generalized (or slightly impr oved) the theorems and tools in [2].
Notice that these results also hold for Ricci ﬂows induced by Ricci shrinkers (cf. Deﬁnition 2.2)
since most of them are scaling-invariant. In a few cases, one needs to modify the assumptions
correspondingly. For instance, the conditions in Theorem 4 .9 and Theorem 4.16 need to be changed
to−δ−1λ≤t<s≤(1−δ)λanddt(x,p)≤Kλ1/2, if the Ricci ﬂow associated with a Ricci shrinker
is parabolically rescaled by λ>0.
Based on these results and techniques, one can generalize th e theory ofF-convergence in [3] and
[4] from compact Ricci ﬂows to the setting of Ricci ﬂows induc ed by Ricci shrinkers.
Notice that the results in [3] and [4] are already generalize d by Bamler to Ricci ﬂows with
complete time-slices and bounded curvature on compact time -intervals (cf. [5]). In [5, Appendix
A], some issues in the non-compact case are addressed and can be resolved similarly in the setting
of Ricci shrinkers by the results and techniques developed i n previous sections. For instance, by
Theorem 4.9 and Theorem 4.16, it is known that the conjugate h eat kernel decays exponentially
and the function binduced by the conjugate heat kernel increases quadratical ly (cf. Remark 4.17).
Therefore, the weak splitting maps (cf. [4, Deﬁnition 5.6]) constructed in [4, Section 10] have at
most quadratic spatial growth. Moreover, it follows from [4 , Proposition 12.1, Remark 12.3] that
one can construct a bounded strong splitting map with bounde d gradient from a given weak splitting
map.
At various places in [4], one also needs to consider integral/integraltext
uφrinstead of/integraltext
u, and take the
limit for r→∞ after all the estimates (e.g., u=/square|ωl|in [4, Lemma 17.37]). This technique has
already appeared multiple times in previous sections. As a s howcase, we generalize the integral
estimates in [4, Section 6] to Ricci ﬂows associated with Ric ci shrinkers in Appendix A. These
estimates are frequently used in [4] and are of independent i nterest.
Now, we recall the following deﬁnition of the metric ﬂow from [3, Deﬁnition 3.2].
46Deﬁnition 6.1 (Metric ﬂow) .Let I⊂Rbe a subset. A metric ﬂow over I is a tuple of the form
(X,t,(dt)t∈I,(vx;s)x∈X,s∈I,s≤t(x))
with the following properties:
(1)Xis a set consisting of points.
(2)t:X→ I is a map called time-function. Its level sets Xt:=t−1(t)are called time-slices and
the preimagesXI′:=t−1(I′), I′⊂I, are called time-slabs.
(3)(Xt,dt)is a complete and separable metric space for all t ∈I.
(4) v x;sis a probability measure on Xsfor all x∈X, s∈I, s≤t(x). For any x∈X the family
(vx;s)s∈I,s≤t(x)is called the conjugate heat kernel at x.
(5) v x;t(x)=δxfor all x∈X.
(6) For all s ,t∈I, s<t, T≥0and any measurable function u s:Xs→[0,1]with the property
that if T>0, then u s=Φ◦fsfor some T−1/2-Lipschitz function f s:Xs→R(if T=0, then
there is no additional assumption on u s), the following is true. The function
ut:Xt−→R, x/ma√s⊔o−→/integraldisplay
Xsusdvx;s
is either constant or of the form u t=Φ◦ft, where f t:Xt→Ris(t−s+T)−1/2-Lipschitz.
Here,Φis given by (3.31) .
(7) For any t 1,t2,t3∈I, t1≤t2≤t3, x∈X t3we have the reproduction formula
vx;t1=/integraldisplay
Xt2v·;t1dvx;t2,
meaning that for any Borel set S ⊂X t1
vx;t1(S)=/integraldisplay
Xt2vy;t1(S)dvx;t2(y).
Given a metric ﬂow Xover I, we recall the following deﬁnitions from [3, Deﬁnition 3.20 , 3.30].
Deﬁnition 6.2 (Conjugate heat ﬂow) .A family of probability measures (µt∈P(Xt))t∈I′over I′⊂I
is called a conjugate heat ﬂow if for all s ,t∈I′, s≤t we have
µs=/integraldisplay
Xtvx;sdµt(x).
Deﬁnition 6.3 (H-Concentration) .Given a constant H >0, a metric ﬂowXis called H-concentrated
if for any s≤t, s,t∈I, x 1,x2∈X t
Var(vx1;s,vx2;s)≤d2
t(x1,x2)+H(t−s).
47Next, we recall the deﬁnition of the metric ﬂow pair from [3, D eﬁnition 5.1, 5.2]. Roughly
speaking, two metric ﬂow pairs are equivalent if they are the same in the metric measure sense
almost everywhere.
Deﬁnition 6.4 (Metric ﬂow pair) .A pair (X,(µt)t∈I′)is called a metric ﬂow pair over I ⊂Rif:
1. I′⊂I with|I\I′|=0.
2.Xis a metric ﬂow over I′.
3.(µt)t∈I′is a conjugate heat ﬂow on Xwith suppµt=Xtfor all t∈I′.
If J⊂I′, then we say that (X,(µt)t∈I)is fully deﬁned over J. We denote by FJ
Ithe set of equiv-
alence classes of metric ﬂow pairs over I that are fully deﬁne d over J. Here, two metric ﬂow
pairs (Xi,(µi
t)t∈I′,i), i=1,2, that are fully deﬁned over J are equivalent if there exists a n isometry
φ:X1
I′→X2
I′(cf. [3, Deﬁnition 3.13]) such that|I′,1\I′|=|I′,2\I′|=0,(φt)∗µ1
t=µ2
tfor all t∈I′
and J⊂I′.
We will only consider I:=(−∞,0] for simplicity. Then for any pointed Ricci ﬂow ( Mn,g(t),x0)t∈I
induced by a Ricci shrinker, one can deﬁne ( X,(µt)t∈I) as follows.
/parenleftbigX:=M×(I\{0})⊔x0×{0},t:=projI,(dt)t∈I,(vx,t;s)(x,t)∈M×I,s∈I,s≤t,µt:=vx0,0;t/parenrightbig. (6.1)
Then we have
Proposition 6.5. The pair (X,(µt)t∈I)deﬁned in (6.1) is an H n-concentrated metric ﬂow pair that is
fully deﬁned over I.
Proof. The conditions (1)-(5) in the deﬁnition of the metric ﬂow can be easily checked. Condi-
tion (6) follows from (3.15) and (7) from the semigroup prope rty (3.1). The metric ﬂow is Hn-
concentrated by Proposition 3.10. /square
Next, we recall the deﬁnition of a correspondence between me tric ﬂows; see [3, Deﬁnition 5.4].
Deﬁnition 6.6 (Correspondence) .Let(Xi,(µi
t)t∈I′,i)be metric ﬂows over I, indexed by some i ∈I.
A correspondence between these metric ﬂows over I′′is a pair of the form
C:=/parenleftbig(Zt,dZ
t)t∈I′′,(ϕi
t)t∈I′′,i,i∈I/parenrightbig,
where:
1.(Zt,dZ
t)is a metric space for any t ∈I′′.
2. I′′,i⊂I′′∩I′,ifor any i∈I.
3.ϕi
t: (Xi
t,di
t)→(Zt,dZ
t)is an isometric embedding for any i ∈Iand t∈I′′,i.
If J⊂I′′,ifor all i∈I, we say thatCis fully deﬁned over J.
48Given a correspondence, one can deﬁne the F-distance, see [3, Deﬁnition 5.6, 5.8].
Deﬁnition 6.7 (F-distance within correspondence) .We deﬁne theF-distance between two metric
ﬂow pairs withinC(uniform over J),
dC,J
F/parenleftbig(X1,(µ1
t)t∈I′,1),(X2,(µ2
t)t∈I′,2)/parenrightbig,
to be the inﬁmum over all r >0with the property that there is a measurable subset E ⊂I′′with
J⊂I′′\E⊂I′′,1∩I′′,2
and a family of couplings (qt)t∈I′′\Ebetweenµ1
t,µ2
tsuch that:
(1)|E|≤r2.
(2) For all s ,t∈I′′\E, s≤t, we have
/integraldisplay
X1
t×X2
tdZs
W1((ϕ1
s)∗ν1
x1;s,(ϕ2
s)∗ν2
x2;s)dqt(x1,x2)≤r.
Notice that (2) above implies that for any t∈I′′\E,
dGW 1/parenleftbig(X1
t,d1
t,µ1
t),(X2
t,d2
t,µ2
t)/parenrightbig≤dZt
W1((ϕ1
t)∗µ1
t,(ϕ2
t)∗µ2
t)≤r. (6.2)
Here, dGW 1denotes the Gromov- W1-Wasserstein distance, see [3, Deﬁnition 2.11] for the prec ise
deﬁnition.
Deﬁnition 6.8 (F-distance) .TheF-distance between two metric ﬂow pairs (uniform over J),
dJ
F/parenleftbig(X1,(µ1
t)t∈I′,1),(X2,(µ2
t)t∈I′,2)/parenrightbig,
is deﬁned as the inﬁmum of
dC,J
F/parenleftbig(X1,(µ1
t)t∈I′,1),(X2,(µ2
t)t∈I′,2)/parenrightbig,
over all correspondences CbetweenX1,X2over I′′that are fully deﬁned over J.
With all those deﬁnitions, it can be proved (cf. [3, Theorem 5 .13, 5.26]) that (FJ
I,dJ
F) is a com-
plete metric space, with possible inﬁnite distances.
In addition,F-convergence implies F-convergence within a correspondence; see [3, Theorem
6.12]. More precisely,
Theorem 6.9. Let(Xi,(µi
t)t∈I′,i), i∈N∪{∞} , be metric ﬂow pairs over I that are fully deﬁned over
some J⊂I. Suppose that for any compact subinterval I 0⊂I
dJ∩I0
F/parenleftbig(Xi,(µi
t)t∈I0∩I′,i),(X∞,(µ∞
t)t∈I0∩I′,∞)/parenrightbig→0.
Then there is a correspondence Cbetween the metric ﬂows Xi, i∈N∪{∞} , over I such that
(Xi,(µi
t)t∈I′,i)F,C,J−−−−−−−−−→
i→∞(X∞,(µ∞
t)t∈I′,∞)
on compact time intervals, in the sense that
dC,J∩I0
F/parenleftbig(Xi,(µi
t)t∈I0∩I′,i),(X∞,(µ∞
t)t∈I0∩I′,∞)/parenrightbig→0
for any compact subinterval I 0⊂I.
49For a sequence of Ricci ﬂows ( Mn
i,gi(t)),xi)t∈Iinduced by Ricci shrinkers, one can use the F-
compactness theorem for metric ﬂow pairs [3, Corollary 7.5, Theorem 7.6] to obtain the following
result.
Theorem 6.10 (F-compactness) .Let(Mn
i,gi(t),xi)t∈Ibe a sequence of pointed Ricci ﬂows induced
by Ricci shrinkers with the corresponding metric ﬂow pairs (Xi,(µi
t)t∈I)as described in (6.1) .
After passing to a subsequence, there exists an H n-concentrated metric ﬂow pair (X∞,(µ∞
t)t∈I)
for whichX∞is future continuous in the sense of [3, Deﬁnition 4.25] such that the following holds.
There is a correspondence Cbetween the metric ﬂows Xi, i∈N∪{∞} , over I such that on compact
time-intervals
(Xi,(µi
t)t∈I)F,C−−−−−−−→
i→∞(X∞,(µ∞
t)t∈I). (6.3)
Moreover, the convergence (6.3) is uniform over any compact J⊂I that only contains times at
whichX∞is continuous, see [3, Deﬁnition 4.25] . Notice thatX∞is continuous everywhere except
possibly at a countable set of times, by [3, Corollary 4.35] .
We sketch the main ideas and steps of Theorem 6.10 modulo all t echnical details.
1. One needs a characterization of the compactness for a subs et in (M,dGW 1), the isometry
classes of all metric measure space ( X,d,µ), whereµ∈P(X) with supp µ=XanddGW 1
denotes the Gromov- W1-Wasserstein distance (cf. [3, Deﬁnition 2.11]). Let Mr(V,b)⊂Mbe
the subset consisting of ( X,d,µ) satisfying
Var(µ)≤Vr2andµ({x∈X|µ(D(x,ǫr))<b(ǫ)})≤ǫ,∀ǫ∈(0,1]. (6.4)
Here, V,rare two positive constants and b: (0,1]→(0,1] is a function. Moreover, D(x,ǫr)
denotes a closed ball with center xand radiusǫr. It is proved by [3, Theorem 2.27] that
Mr(V,b) is compact.
2. For any metric ﬂow pair ( X,(µt)t∈I) deﬁned in (6.1). It is clear by Hn-concentration that
Var(µt)≤Hn|t|. It can be proved (cf. [3, Proposition 4.1] with τ=ǫ3
8Hn) that for any t<0,
(Xt,dt,µt)∈Mr(V,b), (6.5)
where V=1/8,r=√8Hn|t|,b(ǫ)=Φ(ǫ−2√8Hn)/2 andΦis given by (3.31). The proof
of (6.5) uses Deﬁnition 6.1(6)(7) in an essential way. There fore, for any t≤0, (Xi,di
t,µi
t)
subconverges in GW 1to a limit metric measure space.
3. To compare diﬀerent time-slices of ( X,(µt)t∈I), one considers the function
D(t) :=/integraldisplay
Xt/integraldisplay
Xtdtdµtdµt (6.6)
fort∈I. It is not hard to prove (cf. [3, Lemma 4.7]) that for any s≤t∈I,
−/radicalbig
Hn(t−s)≤D(t)−D(s)≤/radicalbig
Var(µt)−Var(µs)+Hn(t−s)+2/radicalbig
Hn(t−s). (6.7)
It follows immediately from (6.7) that D(t) is continuous on a complement of a countable
subset of I. In addition, it is proved (cf. [3, Theorem 4.31]) that for an yt0≤0,D(t) is
50continuous at t0is equivalent to the statement that ( Xt,dt,µt) is continuous at t0in the GW 1
sense. In this case, one can construct an isometric embeddin g of (Xt,dt) and (Xt0,dt0) into a
metric space ( Zt,dZ
t) with an explicit coupling qtbetweenµtandµt0fortclose to t0. Therefore,
one concludes that the metric ﬂow ( Xt,µt) is continuous on Iexcept at a countable set of times.
4. For the sequence ( Xi,(µi
t)t∈I) in (6.3), we consider the limit
D∞(t) :=lim
t→∞Di(t), (6.8)
which exists for any t∈Iby taking a subsequence. Indeed, by (6.7), we may assume that
D∞(t) exists for t∈I∩QandD∞(t)−D∞(s)≥−√Hn(t−s) for any s,t∈I∩Qwith s≤t,
after taking a subsequence if necessary. Therefore, there e xists a countable set S⊂Isuch
thatD∞is continuous on I\S, by extending the deﬁnition of D∞. Moreover, (6.8) holds for
anyt∈I\S. Now, (6.8) also holds for t∈S, by further taking a subsequence.
TheF-convergence of (Xi,(µi
t)t∈I) can be constructed as follows. We assume D∞(t) is contin-
uous at I\Sfor a countable set S. For a large k>0, we take a compact set I1⊂[−k,0]\S
so that|[−k,0]\I1|is small. Then I1is ﬁnitely covered by compact intervals Iticentered at
ti∈I1such that|Iti|and the oscillation of all DiandD∞on each Itiare suﬃciently small. By
steps 1 and 2 above, one can construct a correspondence C0that is fully deﬁned on the ﬁnite
setI0:={ti}betweenXi, so that
dC0,I0
F/parenleftbig(Xi,(µi
t)t∈I0),(Xj,(µj
t)t∈I0)/parenrightbig<ǫ (6.9)
for anyǫ >0, ifi,jare suﬃciently large. Then by using the small oscillation of DionIti, one
can extend the correspondence C0toC1over I1so that (Xi,(µi
t)t∈I1) forms a Cauchy sequence
over I1in the sense of (6.9) with respect to dC1,I1
F(cf. [3, Lemma 7.24]). By letting k→∞ and
taking a diagonal sequence, we obtain from the completeness of (FI,dF) a limit metric ﬂow
pair (X∞,(µ∞
t)t∈I\S), which has an extended deﬁnition for all t∈Iby the future completion
(cf. [3, Section 4.4]) so that ( X∞,(µ∞
t)t∈I) is right continuous for t∈I. Notice that Deﬁnition
6.1(1)-(7) for (X∞,(µ∞
t)t∈I) are inherited from ( Xi,(µi
t)t∈I). In addition, one can construct a
correspondenceCso that
(Xi,(µi
t)t∈I)F,C−−−−−−−→
i→∞(X∞,(µ∞
t)t∈I)
on compact time intervals and the convergence is uniform ove r the set on which ( X∞,(µ∞
t)t∈I)
is continuous. Moreover, ( X∞
t′,d∞
t′,µ∞
t′)⊂Mr(V,b) as (6.5) and Var( µ∞
t)≤Hn|t|for any t∈I.
Notice thatX∞
0consists of a single point from which µ∞
tis the conjugate heat measure.
Remark 6.11. In[3, Theorem 7.4] , a general compactness for a subset FJ
I(H,V,b,r)⊂FJ
Iis proved
by the same method as described above.
It follows from [3, Theorem 8.2, 8.4] that the limit metric ﬂo w pair (X∞,(µ∞
t)t∈I) obtained in (6.3)
is a length space for any t∈I. In general, further geometric information contained in ( X∞,(µ∞
t)t∈I)
is scarce. However, if ( Mn
i,gi(t)) are induced by Ricci shrinkers in M(A), then, in particular, their
Nash entropies are uniformly bounded by Corollary 3.22. In t his case, one obtains much more
concrete structure theorem regarding the limit metric ﬂow o btained in (6.3); see [4, Theorem 2.3,
2.4, 2.5, 2.6, 2.46] and [3, Theorem 9.31].
51Theorem 6.12. Let(Mn
i,gi(t),xi)t∈Ibe a sequence of pointed Ricci ﬂows induced by Ricci shrinker s
inM(A)and(X∞,(µ∞
t)t∈I)the limit metric ﬂow pair obtained in Theorem 6.10. Then the f ollowing
properties hold.
(1) There exists a decomposition
X∞
0={x∞},X∞
t<0=R⊔S, (6.10)
such thatRis given by an n-dimensional Ricci ﬂow spacetime (R,t,∂∞
t,g∞), in the sense of
[3, Deﬁnition 9.1] anddimM∗(S)≤n−2, where dimM∗denotes the∗-Minkowski dimension
in[3, Deﬁnition 3.42] . Moreover, µ∞
t(St)=0for any t<0.
(2) Every tangent ﬂow (X′,(vx′∞;t)t≤0)at every point x∈X∞is a metric soliton in the sense of
[3, Deﬁnition 3.57] . Moreover,X′is the Gaussian soliton i ﬀx∈R. If x∈S, the singular
set of (X′,(vx′∞;t)t≤0)on each t<0has Minkowski dimension at most n −4. In particular,
if n=3, the metric soliton is a smooth Ricci ﬂow associated with a 3-dimensional Ricci
shrinker. If n=4, each slice of the metric soliton is a smooth Ricci shrinker o rbifold with
isolated singularities.
(3)Rt=R∩X∞
tis open such that the restriction of d tonRtagrees with the length metric of g t.
(4) The convergence (6.3) is smooth on R, in the following sense. There exists an increasing
sequence U 1⊂U2⊂...⊂R of open subsets with/uniontext∞
i=1Ui=R, open subsets V i⊂Mi×I,
time-preserving diﬀeomorphisms φi:Ui→Viand a sequence ǫi→0such that the following
holds:
(a) We have
/ba∇dblφ∗
igi−g∞/ba∇dblC[ǫ−1
i](Ui)≤ǫi,
/ba∇dblφ∗
i∂i
t−∂∞
t/ba∇dblC[ǫ−1
i](Ui)≤ǫi,
/ba∇dblwi◦φi−w∞/ba∇dblC[ǫ−1
i](Ui)≤ǫi,
where giis the spacetime metric induced by g i(t), and wiis the conjugate heat kernel
deﬁned by d µi=widgi, i∈N∪{∞} .
(b) Let y∞∈Rand y i∈Mi×(−∞,0). Then y iconverges to y ∞withinC(cf. [3, Deﬁnition
6.18]) if and only if y i∈Vifor large i and φ−1
i(yi)→y∞inR.
(c) If the convergence (6.3) is uniform at some time t ∈I, then for any compact subset
K⊂R tand for the same subsequence we have
sup
x∈K∩UidZ
t(ϕi
t(φi(x)),ϕ∞
t(x))−→0.
Theorem 6.12 is a ﬂow version of the Cheeger-Colding theory ( cf. [11], [12] and [13]). Its
proof shares similar strategy as its elliptic counterparts . Many concepts also have counterparts. For
example, tangent ﬂow corresponds to tangent space, metric s oliton corresponds to metric cone. We
recall their deﬁnitions. See [3, Deﬁnition 6.55, 3.57].
52Deﬁnition 6.13 (Tangent ﬂow) .LetXbe a metric ﬂow over I and x 0∈X t0a point. We say that a
metric ﬂow pair (X′,(v′
xmax;t)t∈I)is a tangent ﬂow of Xat x 0if there is a sequence of scales λk>0
withλk→∞ such that for any T >0the parabolic rescalings
/parenleftbigX−t0,λk
[−T,0],(v−t0,λk
x0;t)λ−2
kt+t0∈I′,t∈[−T,0]/parenrightbig
F-converge to (X′
[−T,0],(v′
xmax;t)t∈[−T,0]).
Deﬁnition 6.14 (Metric soliton) .A metric ﬂow pair (X,(µt)t∈I)is called a metric soliton if there is
a tuple/parenleftbigX,d,µ,(v′
x;t)x∈X;t≤0/parenrightbig
and a mapφ:X→ X such that the following holds:
1. For any t∈I, the mapφt: (Xt,dt,µt)→(X,√td,µ)is an isometry between metric measure
spaces.
2. For any x∈X t, s∈I with s≤t, we have (φs)∗vx;s=v′
φt(x);log( s/t).
Roughly speaking, a metric soliton is a metric ﬂow pair induc ed by a metric measure space in a
shrinking way. In general, a tangent ﬂow of a metric ﬂow may no t be a metric soliton. In the setting
of Theorem 6.12, every tangent ﬂow of ( X∞,(µ∞
t)t∈I) is also anF-limit of a sequence of Ricci ﬂows
induced by Ricci shrinkers in M(A) (cf. [3, Theorem 6.58]).
Notice that the limit metric ﬂow ( X∞,(µ∞
t)t∈I) in (6.3) always admits a regular-singular decom-
position
X∞
t<0=R⊔S,
so thatRis given by a Ricci ﬂow spacetime (cf. [3, Deﬁnition 9.1]). Th e key point is to control
the size of the singular part in the appropriate sense. To avo id the distance distortion at di ﬀerent
time-slices, one can redeﬁne the Hausdor ﬀand Minkowski dimensions (denoted by H∗andM∗
respectively) by using the P∗-parabolic balls instead of the conventional ones; see [3, D eﬁnition
3.41, 3.42].
One can control the size of Squantitatively. Let ( Mn,g(t))t∈Ibe the Ricci ﬂow induced by a Ricci
shrinker inM(A). We ﬁx a point ( x0,t0)∈M×Iand deﬁneτ=t0−tandH(x0,t0,·,·)=(4πτ)−n
2e−b.
We next recall the following deﬁnitions from [4, Deﬁnition 5 .1, 5.5, 5.6, 5.7], which indicate the
extent to which the local geometry around ( x0,t0) is a Ricci shrinker, Ricci ﬂat space or splitting o ﬀ
anRk.
Deﬁnition 6.15 (Almost self-similarity) .Let(Mn,g(t))t∈Ibe the Ricci ﬂow induced by a Ricci
shrinker. The point (x0,t0)∈M×I is called (ǫ,r)-selfsimilar if the following holds:
/integraldisplayt0−ǫr2
t0−ǫ−1r2/integraldisplay
Mτ/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−1
2τg/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
dvx0,t0;tdt≤ǫ,
/integraldisplay
M/vextendsingle/vextendsingle/vextendsingleτ(2△b−|∇b|2+R)+b−n−N x0,t0(r2)/vextendsingle/vextendsingle/vextendsingledvx0,t0;t≤ǫ,∀t∈[t0−ǫ−1r2,t0−ǫr2].
53Deﬁnition 6.16 (Almost static) .The point (x0,t0)is called (ǫ,r)-static if the following holds:
r2/integraldisplayt0−ǫr2
t0−ǫ−1r2/integraldisplay
M|Rc|2dvx0,t0;tdt≤ǫ,
r2/integraldisplay
MR dv x0,t0;t≤ǫ,∀t∈[t0−ǫ−1r2,t0−ǫr2].
Deﬁnition 6.17 (Weak splitting) .(x0,t0)is called weakly (k,ǫ,r)-split if there exists a vector-valued
function/vectory=(y1,..., yk) :M×[t0−ǫ−1r2,t0−ǫr2]→Rkwith the following properties for all
i,j=1,..., k:
(1) We have
r−1/integraldisplayt0−ǫr2
t0−ǫ−1r2/integraldisplay
M|/squareyi|dvx0,t0;tdt≤ǫ.
(2) We have
r−2/integraldisplayt0−ǫr2
t0−ǫ−1r2/integraldisplay
M|∇yi·∇yj−δi j|dvx0,t0;tdt≤ǫ.
Deﬁnition 6.18 (Strong splitting) .(x0,t0)is called strongly (k,ǫ,r)-split if there exists a vector-
valued function /vectory=(y1,..., yk) :M×[t0−ǫ−1r2,t0−ǫr2]→Rkwith the following properties for
all i,j=1,..., k:
(1) y isolves the heat equation /squareyi=0on M×[t0−ǫ−1r2,t0−ǫr2].
(2) We have
r−2/integraldisplayt0−ǫr2
t0−ǫ−1r2/integraldisplay
M|∇yi·∇yj−δi j|dvx0,t0;tdt≤ǫ.
(3) For all t∈[t0−ǫ−1r2,t0−ǫr2]we have
/integraldisplay
Myidvx0t0;t=0.
It can be proved (cf. [4, Proposition 12.1]) that if ( x0,t0) is weakly ( k,ǫ,r)-split, then it is strongly
(k,δ(ǫ),r)-split. With these deﬁnitions, one can consider the follow ing quantitative stratiﬁcation.
Deﬁnition 6.19. Forǫ >0and0<r1<r2≤∞ the eﬀective strata
/tildewideSǫ,0
r1,r2⊂/tildewideSǫ,1
r1,r2⊂/tildewideSǫ,2
r1,r2⊂...⊂/tildewideSǫ,n+2
r1,r2⊂M×I
are deﬁned as follows: (x′,t′)∈/tildewideSǫ,k
r1,r2if and only for all r′∈(r1,r2)none of the following two
properties hold:
1.(x′,t′)is(ǫ,r′)-selfsimilar and weakly (k+1,ǫ,r′)-split.
542.(x′,t′)is(ǫ,r′)-selfsimilar, (ǫ,r′)-static and weakly (k−1,ǫ,r′)-split.
By a delicate choice of the covering by P∗-parabolic balls, it can be proved, see [4, Proposition
11.2], that for any 0 < σ < ǫ , there are points ( x1,t1),..., (xN,tN)∈/tildewideSǫ,k
σr,ǫr∩P∗(x0,t0;r) with
N≤C(A,ǫ)σ−k−ǫand
/tildewideSǫ,k
σr,ǫr∩P∗(x0,t0;r)⊂N/uniondisplay
i=1P∗(xi,ti;σr). (6.11)
Notice that (6.11) can be regarded as a parabolic version of t he covering in [12] by Cheeger and
Naber.
On the complement of /tildewideSǫ,n−2
σr,ǫr, the following ǫ-regularity theorem is proved (cf. [4, Proposition
17.1]), which can be viewed as a parabolic analogue of Cheege r-Naber’s codimension 4 theorem in
[13]. Roughly speaking, one needs to rule out the tangent ﬂow s which are Ricci-ﬂat, and split o ﬀ
anRn−3.
Proposition 6.20. There exists a constant ǫ=ǫ(n,A)>0such that the following holds. Let
(Mn,g(t))t∈Ibe the Ricci ﬂow induced by a Ricci shrinker in M(A). Suppose that (x0,t0)is strongly
(n−1,ǫ,r)-split or strongly (n−3,ǫ,r)-split and (ǫ,r)-static. Then r Rm(x0,t0)≥ǫr.
There are many implications of Proposition 6.20. Notice tha t one has the following decomposi-
tion:
X∞
t<0=R∗⊔S∗,
whereR∗⊂R is the set of points where the convergence (6.3) is smooth as d eﬁned in [3, Section
9.4]. SinceS⊂S∗, one can obtain the estimate of ∗-Minkowski dimension of Sby that ofS∗from
(6.11) and Proposition 6.20 (cf. [4, Theorem 15.28 (a)]). Mo reover, it can be proved that S∗∩X∞
t
has measure 0 for any t<0 (cf. [4, Theorem 15.28 (b)]). Therefore, Theorem 6.12 (1) i s obtained.
SinceShas measure 0 on each time-slice, one can extend the deﬁnitio n of the Nash entropy
onX∞. Therefore, the Nash entropy at the base point x′of any tangent ﬂow ( X′,(vx′;t)t∈I) of
(X∞,(µ∞
t)t∈I) is a constant. By the relation between the Nash entropy and t he almost self-similarity
(cf. [4, Proposition 7.1]), one concludes that ( X′,(vx′;t)t∈I) is a metric soliton since its regular part
admits an incomplete Ricci shrinker and the tangent ﬂow itse lf is determined by its regular part
due to the high codimension of the singular part (cf. [4, Theo rem 15.60, 15.69]). Moreover, the
singular set on each time-slice of ( X′,(vx′;t)t∈I) has Minkowski dimension ≤n−4 (cf. [4, Theorem
2.16]). Furthermore, the fact that x∈RiﬀX′is the Gaussian soliton follows from the ǫ-regularity
theorem 5.15 and the convergence of the Nash entropies under (6.3) (cf. [4, Theorem 2.11, 2.14]).
Notice that if n=4, each time-slice of ( X′,(vx′;t)t∈I) is a smooth orbifold with isolated singularities
since each tangent ﬂow at any singular point of ( X′,(vx′;t)t∈I) is a ﬂat cone (cf. [4, Theorem 2.46]).
Therefore, we obtain Theorem 6.12 (2).
For Theorem 6.12 (3), the inequality dt≤dgtis clear. The opposite inequality is proved by
showing that any u∈C0(Rt) that is 1-Lipschitz with respect to dgtis also 1-Lipschitz with respect
todt(cf. [4, Theorem 15.28 (c)]). The argument uses the high codi mension ofS, the fact thatX∞
is future continuous at t, and the fact thatR=R∗, which can be proved by using the ǫ-regularity
theorem and the convergence of the Nash entropies (cf. [4, Co rollary 15.47]).
Once we knowR=R∗, the diﬀeomorphisms in Theorem 6.21 (4) can be obtained by patching
all local conventional Ricci ﬂows into a Ricci ﬂow spacetime by a center of mass construction
55(cf. [3, Theorem 9.31]). Notice that similar constructions are well-known for the Cheeger-Gromov
convergence (cf. Remark 7.7 of [24] and references therein) . All assertions Theorem 6.21 (4) are
proved by smooth convergence. Therefore, Theorem 6.12 (4) i s obtained.
As an application of the theory of F-convergence, we have the following backward pseudolocal-
ity theorem; see [4, Theorem 2.47]. Earlier backward pseudo locality can be found in [34, Corollary
11.6(b)] [15, Lemma 4.2] [16, Theorem 4.7] [6, Theorem 1.5].
Theorem 6.21 (Backward pseudolocality theorem) .For any n∈Nandα>0there is anǫ(n,α)>0
such that the following holds.
Let(Mn,g(t))t∈Ibe a Ricci ﬂow induced by a Ricci shrinker. Given (x0,t0)∈M×I and r>0, if
|Bt0(x0,r)|≥αrn,|Rm|≤(αr)−2on B t0(x0,r),
then
|Rm|≤(ǫr)−2on P (x0,t0; (1−α)r,−(ǫr)2,0).
Note that the combination of the above theorem with the forwa rd pseudolocality (cf. Theorem
24 of [28]), we arrive at the two-sided pseudolocality. Thus Theorem 1.6 is proved.
Combining Theorem 6.21 and (5.23), we have
Corollary 6.22 (Comparison of the curvature radii) .There exists a constant C (n,A)>1such that
the following holds.
Let(Mn,g(t))t∈I′be a Ricci ﬂow induced by a Ricci shrinker in M(A). Then for any (x,t)∈M×I′,
rRm(x,t)≤r−
Rm(x,t)≤rs
Rm(x,t)≤CrRm(x,t).
Another application is the following integral estimate usi ng the quantitative stratiﬁcation; see [4,
Theorem 2.28].
Theorem 6.23. Let(Mn,g(t))t<1be a Ricci ﬂow associated with a Ricci shrinker in M(A). Then for
any(x0,t0)∈M×(−∞,1), r>0andǫ >0,
/integraldisplay
[t0−r2,t0+r2]∩(−∞,1)/integraldisplay
P∗(x0,t0;r)∩M×{t}|Rm|2−ǫdVtdt
≤/integraldisplay
[t0−r2,t0+r2]∩(−∞,1)/integraldisplay
P∗(x0,t0;r)∩M×{t}r−4+2ǫ
RmdVtdt≤C(n,A,ǫ)rn−2+2ǫ. (6.12)
As a corollary, we prove
Corollary 6.24. Let(Mn,g,f,p)be a Ricci shrinker in M(A). Then
/integraldisplay
d(p,·)≤r|Rm|2−ǫdV≤/integraldisplay
d(p,·)≤rr−4+2ǫ
RmdV≤Crn+2ǫ−2, (6.13)
/integraldisplay
d(p,·)≥1|Rm|2−ǫ
dn+2ǫ−2(p,·)dV≤/integraldisplay
d(p,·)≥1r−4+2ǫ
Rm
dn+2ǫ−2(p,·)dV≤C (6.14)
for anyǫ >0and r≥1, where r Rm(·)=rRm(·,0)and C=C(n,A,ǫ).
56Proof. We consider the Ricci ﬂow ( M,g(t))t<1associated with the given Ricci shrinker. It follows
from Proposition 5.7 that
Q(p,0; 1,0,1)⊂P∗(p,0;C1,0,1)⊂P∗(p,0;C1)
for some constant C1=C1(n,A)>1. Therefore, it follows from Theorem 6.23 that with ( x0,t0)=
(p,0) and r=C1that
/integraldisplay1
0/integraldisplay
dt(p,·)<1|Rm|2−ǫdVtdt≤C(n,A,ǫ). (6.15)
Since g(t)=(1−t)(ψt)∗gandψtis deﬁned by (2.3), we have dt(x,p)=√
1−td(xt,p) and|Rm|(x,t)=
|Rm|(xt)/(1−t), where xt=ψt(x). Therefore, we have
/integraldisplay
dt(p,x)<1|Rm|2−ǫ(x,t)dVt(x)=(1−t)n
2−2+ǫ/integraldisplay
d(x,p)<1√
1−t|Rm|2−ǫ(x)dV(x). (6.16)
By a change of variable with t=1−r−2, it follows from (6.15) and (6.16) that
/integraldisplay∞
1r1−2ǫ−nm(r)dr≤C(n,A,ǫ), (6.17)
where
m(r) :=/integraldisplay
d(·,p)<r|Rm|2−ǫdV.
We claim that there exists a sequence ri→∞ such that
lim
i→∞m(ri)
rn+2ǫ−2
i=0. (6.18)
Otherwise, there exists a constant δ>0 such that m(r)≥δrn+2ǫ−2for suﬃciently large r. However,
it contradicts (6.17).
We apply the integration by parts to (6.17) from 1 to rito (6.17) and obtain
/integraldisplay
1≤d(p,·)≤ri|Rm|2−ǫ
dn+2ǫ−2(p,·)dV≤C(n,A,ǫ)+m(ri)r2−2ǫ+n
i.
By letting i→∞ , we have from (6.18) that
/integraldisplay
d(p,·)≥1|Rm|2−ǫ
dn+2ǫ−2(p,·)dV≤C(n,A,ǫ). (6.19)
In addition, we have for any r≥1,
r2−2ǫ−n/integraldisplay
1≤d(p,·)≤r|Rm|2−ǫdV≤/integraldisplay
1≤d(p,·)≤r|Rm|2−ǫ
dn+2ǫ−2(p,·)dV≤C(n,A,ǫ).
57Therefore, for any r≥1,
/integraldisplay
d(p,·)≤r|Rm|2−ǫdV≤C(n,A,ǫ)rn+2ǫ−2, (6.20)
since m(1) is bounded by (6.17). In sum, the inequalities involving |Rm|in (6.13) and (6.14) are
proved.
Notice that for any ( x0,t0)∈M×(−∞,1), it follows from the deﬁnition of ψt(2.3) that
ψθ(t)◦ψt0=ψt,
whereθ(t) :=t−t0
1−t0. Therefore, for any t<1,
g(t)=(1−t)(ψt)∗g=(1−t0)(1−θ(t))(ψt0)∗(ψθ(t))∗g=(1−t0)(ψt0)∗g(θ(t)).
Therefore,
rRm(x0,t0)=/radicalbig
1−t0rRm(xt0
0,0).
Now, the conclusion regarding rRmcan be proved similarly. /square
We end this section by proving a gap property for the volume ra tio at inﬁnity.
Corollary 6.25. Let(Mn,g,f,p)be a Ricci shrinker in M(A). Suppose
lim inf
r→∞|B(p,r)|
rn=0. (6.21)
Then
|B(p,r)|≤Crn−2+ǫ(6.22)
for any r≥1and some C=C(n,A,ǫ).
Proof. We claim that rRm(x)<2 for any x. Indeed, if rRm(x)≥2, we have
|Rm|(y,t)<1
for any y∈B(x,1) and t<1. By the same argument as in [28, Corollary 9], we obtain that
ψt(B(x,1))⊂B/parenleftigg
p,c1√
1−t/parenrightigg
\B/parenleftigg
p,c2√
1−t/parenrightigg
(6.23)
forc1>c2>0, if tis suﬃciently close to 1. From the standard distance distortion an d Theorem
4.1, we obtain that
|ψt(B(x,1))|≥c3(1−t)−n
2. (6.24)
However, (6.23) and (6.24) contradict (6.21). Thus the desi red inequality (6.22) follows immedi-
ately from (6.13). /square
58Appendix
A Integral estimates for the conjugate heat kernel
In this appendix, we generalize some integral estimates reg arding the conjugate heat kernel from [4,
Section 6] to Ricci ﬂows associated with Ricci shrinkers. Th ese estimates also hold for Ricci ﬂows
induced by Ricci shrinkers since they are scaling-invarian t.
Throughout this appendix, let ( Mn,g(t))t<1be the Ricci ﬂow associated with a Ricci shrinker
inM(A). We ﬁx a spacetime point ( x0,t0)∈M×(−∞,1) and set dvt=dvx0,t0;tandτ=t0−t.
Moreover, we deﬁne w=w(x,t) and b=b(x,t) byw=H(x0,t0,x,t)=(4π(t0−t))−n
2e−b.
Lemma A.1. There exists a constant C =C(n,A)>1such that for any 0<τ 0<τ 1,
/integraldisplayt0−τ0
t0−τ1/integraldisplay
M/braceleftig
|Rc|2+|∇2b|2/bracerightig
dvtdt≤Cτ−1
0/parenleftigg
1+logτ1
τ0/parenrightigg
. (A.1)
Proof. Without loss of generality, we assume t0=0.
From Corollary 3.20, we have for any τ>0 that
/integraldisplay
M|∇b|2+R dv−τ≤n
2τ. (A.2)
Direct calculation shows that
∂t/integraldisplay
MRwφrdVt=/integraldisplay
M/braceleftbig(/squareR)wφr−R/square∗(wφr)/bracerightbigdVt
=/integraldisplay
M2|Rc|2wφr+R/braceleftbigw(∆φr+φr
t)+2/a\}b∇acke⊔le{⊔∇w,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightbigdVt
=/integraldisplay
M/braceleftig
2|Rc|2φr+R(∆φr+φr
t)−2R/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔/bracerightig
dvt.
Integrating the above equation from −τ1to−τ0, we obtain
/integraldisplay−τ0
−τ1/integraldisplay
M2|Rc|2φrdvtdt
≤/integraldisplay
MRφrdv−τ0+/integraldisplay−τ0
−τ1/integraldisplay
M/braceleftig
R(|∆φr|+|φr
t|)+R2|∇φr|+|∇b|2|∇φr|/bracerightig
dvtdt. (A.3)
From (2.8) and Lemma 2.3, Rincreases at most quadratically. Combining (2.12), (2.13) , (2.14)
and (A.2), it follows that the last integral in (A.3) tends to 0 asr→∞ . Therefore, we obtain
/integraldisplay−τ0
−τ1/integraldisplay
M|Rc|2dvtdt≤1
2/integraldisplay
MR dv−τ0≤n
4τ0. (A.4)
On the other hand, it follows from (3.40) and Corollary 3.22 t hat
/integraldisplay−τ0
−τ12τ/integraldisplay
M/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
dvtdt≤−W (x0,t0)(τ1)≤A. (A.5)
59By virtue of the elementary identity ( x−y)2≥x2/2−y2, it follows from (A.5) that
τ0/integraldisplay−τ0
−τ1/integraldisplay
M|Rc+∇2b|2dvtdt≤/integraldisplay−τ0
−τ1τ/integraldisplay
M|Rc+∇2b|2dvtdt≤A+n
2logτ1
τ0. (A.6)
Combining (A.4) and (A.6), the conclusion follows immediat ely. /square
Lemma A.2. There exists a constant C =C(n,A)>1such that the following estimates hold for
any t<t0and0≤s≤1/4.
/integraldisplay
M/braceleftig
1+|b|+τ(|∆b|+|∇b|2+R)/bracerightig
esbdvt≤C. (A.7)
Proof. We compute
d
ds/integraldisplay
Mesbdvt=/integraldisplay
Mbesbdvt. (A.8)
Here, the diﬀerentiation under the integral sign is allowed by Theorem 4. 16 and Remark 4.17. By
the diﬀerential Harnack inequality [28, Theorem 21], we calculate
/integraldisplay
Mbesbdvt≤/integraldisplay
M(τ(−2∆b+|∇b|2−R)+n)esbdvt
=/integraldisplay
M(τ((2s−1)|∇b|2−R)+n)esbdvt≤n/integraldisplay
Mesbdvt, (A.9)
where the integration by parts in the equality can be justiﬁe d similarly as in Remark 3.21. Combin-
ing (A.8) and (A.9), we obtain
/integraldisplay
Mesbdvt≤ens.
On the other hand, it follows from Theorem 4.4 that b≥−A. Therefore, it follows from (A.9) and
the above inequality that
/integraldisplay
M/braceleftig
|b|+τ(|∇b|2+R)/bracerightig
esbdvt≤C(n,A). (A.10)
Applying the diﬀerential Harnack inequality and the integration by parts ag ain, we obtain
/integraldisplay
M2τ|∆b|esbdvt≤/integraldisplay
M/braceleftig
|u|+τ(|∇b|2+R)+|b|+n/bracerightig
esbdvt
=/integraldisplay
M/braceleftig
−u+τ(|∇b|2+R)+|b|+n/bracerightig
esbdvt
≤/integraldisplay
M/braceleftig
2sτ|∇b|2+2|b|+2n/bracerightig
esbdvt≤C(n,A),
where u=τ(2∆b−|∇b|2+R)+b−n≤0. It is clear that (A.7) follows from the combination of
(A.10) and the above inequality. /square
60Lemma A.3. There exists a constant C =C(n)>1such that the following estimates hold for any
t<t0and0≤s≤1/4.
/integraldisplay
M|∇b|4esbdvt≤C/integraldisplay
M|∇2b|2esbdvt. (A.11)
Proof. In the proof, all constants C>1 depend only on n, which may be diﬀerent line by line.
We compute for s≤1/4 that
/integraldisplay
M|∇b|4φresbdvt
=(4πτ)−n
2/integraldisplay
M|∇b|4φre(s−1)bdVt
=(4πτ)−n
2(s−1)−1/integraldisplay
M|∇b|2/a\}b∇acke⊔le{⊔∇b,∇e(s−1)b/a\}b∇acke⊔∇i}h⊔φrdVt
=(4πτ)−n
2(1−s)−1/integraldisplay
M/parenleftig
2∇2b(∇b,∇b)+|∇b|2∆b/parenrightig
φre(s−1)bdVt+Z
≤C(4πτ)−n
2(1−s)−1/integraldisplay
M|∇2b||∇b|2φre(s−1)bdVt+Z
≤1
4/integraldisplay
M|∇b|4φresbdvt+C/integraldisplay
M|∇2b|2φresbdvt+Z, (A.12)
where the remainder
Z:=(1−s)−1/integraldisplay
M|∇b|2/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔esbdvt≤2/integraldisplay
M|∇b|3|∇φr|esbdvt
≤1
4/integraldisplay
M|∇b|4φresbdvt+4/integraldisplay
M|∇b|2|∇φr|2(φr)−1esbdvt. (A.13)
Applying Lemma A.2 and (2.12), we conclude from (A.12) and (A .13) that
/integraldisplay
M|∇b|4esbφrdvt≤C/integraldisplay
M|∇2b|2esbφrdvt+ǫ(r) (A.14)
whereǫ(r)→0 asr→∞ . Thus we arrive at (A.11) by letting r→∞ in the above inequality. /square
The main result of this section is the following spacetime in tegral estimate.
Proposition A.4. There exists a constant C =C(n,A)>1and ¯s=¯s(n)<1such that the following
estimates hold for any r >0,0<θ< 1/2and s≤¯s.
/integraldisplayt0−θτ0
t0−τ0/integraldisplay
Mτ(|Rc|2+|∇2b|2+|∇b|4)esbdvtdt≤Clogθ−1. (A.15)
Proof. In the proof, all constants Cdepend on n, and C′depend on nandA. Moreover, we use ǫ(r)
to denote a function independent of tsuch thatǫ(r)→0 ifr→∞ . Those terms may be di ﬀerent
line by line. Without loss of generality, we assume t0=0.
61We set u=τ(2∆b−|∇b|2+R)+b−n≤0. Recall that from [34], we have the celebrated identity
/square∗(uw)=−2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
w.
Moreover, we have
/squareb=−2∆b+|∇b|2−R+n
2τ=τ−1(b−u−n/2).
Direct computation shows that
∂t/integraldisplay
MuwesbφrdVt
=/integraldisplay
M/braceleftig
/square(esbφr)uw−esbφr/square∗(uw)/bracerightig
dVt
=/integraldisplay
M/braceleftigg/parenleftig
(/squareesb)φr+esb(/squareφr)−2/a\}b∇acke⊔le{⊔∇φr,∇esb/a\}b∇acke⊔∇i}h⊔/parenrightig
uw+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
wesbφr/bracerightigg
dVt
=/integraldisplay
M/braceleftigg/parenleftig
(s/squareb−s2|∇b|2)esbφr+esb(/squareφr)−2/a\}b∇acke⊔le{⊔∇φr,∇esb/a\}b∇acke⊔∇i}h⊔/parenrightig
u+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
esbφr/bracerightigg
wdV t,
=/integraldisplay
M/braceleftigg/parenleftig
(sτ−1(b−u−n/2)−s2|∇b|2)φr+/squareφr−2s/a\}b∇acke⊔le{⊔∇φr,∇b/a\}b∇acke⊔∇i}h⊔/parenrightig
u+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
φr/bracerightigg
esbdvt.
It follows that
∂t/integraldisplay
MuwesbφrdVt
≥/integraldisplay
M/braceleftigg
(sτ−1(b−u−n/2))uφr+/parenleftbig/squareφr−2s/a\}b∇acke⊔le{⊔∇φr,∇b/a\}b∇acke⊔∇i}h⊔/parenrightbigu+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
φr/bracerightigg
esbdvt
≥/integraldisplay
M/braceleftigg
−Csτ−1(u2+b2+1)φr+/parenleftbig/squareφr−2s/a\}b∇acke⊔le{⊔∇φr,∇b/a\}b∇acke⊔∇i}h⊔/parenrightbigu+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
φr/bracerightigg
esbdvt
≥/integraldisplay
M/braceleftigg
−Cs/parenleftig
τ((∆b)2+|∇b|4+R2)+τ−1(b2+1)/parenrightig
+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2/bracerightigg
φresbdvt+Xt,(A.16)
where
Xt:=/integraldisplay
M/parenleftbig/squareφr−2s/a\}b∇acke⊔le{⊔∇φr,∇b/a\}b∇acke⊔∇i}h⊔/parenrightbiguesbdvt.
Deﬁne X′:=/integraltext−θτ0
−τ0|Xt|dt. Then it follows from Lemma A.2 and inequalities (2.12) to (2 .15) that
for any positive δwe have
|X′|≤/integraldisplay−θτ0
−τ0/integraldisplay
M(|/squareφr|+2s|∇φr||∇b|)|u|esbdvtdt
≤ǫ(r)+/integraldisplay−θτ0
−τ0/integraldisplay
M/parenleftig
δ−1|∇φr|2(φr)−1τ|∇b|2+δτ−1u2φr/parenrightig
esbdvtdt
≤ǫ(r)+δ/integraldisplay−θτ0
−τ0/integraldisplay
Mτ−1u2φresbdvtdt. (A.17)
62It is clear from the deﬁnition of uthatu2≤C/parenleftig
τ2(|∆b|2+|∇b|2+R))+b2+1/parenrightig
. In addition, since
−A≤b≤−τ(2∆b−|∇b|2+R)+n, we have
b2≤C′/parenleftig
τ2(|∆b|2+|∇b|4+R2)+1/parenrightig
. (A.18)
Combining these facts with (A.14), we may choose δin (A.17) suﬃciently small such that
|X′|≤ǫ(r)+1
10/integraldisplay−θτ0
−τ0/integraldisplay
Mτ(|∇2b|2+|Rc|2)φresbdvtdt+logθ−1. (A.19)
Similarly, we compute
∂t/integraldisplay
MτResbwφrdVt
=/integraldisplay
M/braceleftig
/square(τResb)φrw−τResb/square∗(φrw)/bracerightig
dVt
=/integraldisplay
M/braceleftig/parenleftig
/square(τR)esb+τR/squareesb−2τ/a\}b∇acke⊔le{⊔∇R,∇esb/a\}b∇acke⊔∇i}h⊔/parenrightig
φrw+τResb/parenleftbig(∆φr+φr
t)w+2/a\}b∇acke⊔le{⊔∇w,∇φr/a\}b∇acke⊔∇i}h⊔/parenrightbig/bracerightig
dVt
=/integraldisplay
M/braceleftig/parenleftig
/square(τR)esb+τR/squareesb/parenrightig
φrw+2τR/parenleftig
∆esb−/a\}b∇acke⊔le{⊔∇ esb,∇b/a\}b∇acke⊔∇i}h⊔/parenrightig
φrw/bracerightig
dVt+Yt
=/integraldisplay
M/braceleftig
2τ|Rc|2−R+τR/parenleftig
s/squareb+(s2−2s)|∇b|2+2s∆b/parenrightig/bracerightig
φresbdvt+Yt
≥/integraldisplay
M/braceleftig
2τ|Rc|2−R−Cs/parenleftig
τ(R2+|∇b|4+(∆b)2)+R/parenrightig/bracerightig
φresbdvt+Yt, (A.20)
where
Yt:=/integraldisplay
MτResb/parenleftbig(∆φr+φr
t)w+2/a\}b∇acke⊔le{⊔∇w,∇φr/a\}b∇acke⊔∇i}h⊔+2s/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔/parenrightbigdVt
=/integraldisplay
MτR/parenleftbig∆φr+φr
t+(2s−2)/a\}b∇acke⊔le{⊔∇b,∇φr/a\}b∇acke⊔∇i}h⊔/parenrightbigesbdvt.
We deﬁne similarly Y:=/integraltext−θτ0
−τ0|Yt|dt. Then it follows from Lemma A.2 and inequalities (2.12) to
(2.15) that
|Y′|≤ǫ(r)+C/integraldisplay−θτ0
−τ0/integraldisplay
M/parenleftig
δ−1|∇φr|2(φr)−1τ|∇b|2+δτR2φr/parenrightig
esbdvtdt
≤ǫ(r)+C/integraldisplay−θτ0
−τ0/integraldisplay
MδτR2φresbdvtdt
≤ǫ(r)+1
10/integraldisplay−θτ0
−τ0/integraldisplay
Mτ(|∇2b|2+|Rc|2)φresbdvtdt, (A.21)
forδsuﬃciently small.
63Combining (A.16) and (A.20), we obtain
∂t/integraldisplay
M(τR+u)esbφrdvt
≥/integraldisplay
M/braceleftigg
−Cs/parenleftig
τ(|∇b|4+|∇2b|2+R2)+τ−1+R/parenrightig
+2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleRc+∇2b−g
2τ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle2
+2τ|Rc|2−R/bracerightigg
φresbdvt
+Xt+Yt
≥/integraldisplay
M/braceleftig
−Cs/parenleftig
τ(|∇b|4+|∇2b|2+R2)/parenrightig
+τ(|∇2b|2+|Rc|2)/bracerightig
φresbdvt+Xt+Yt−C′τ−1, (A.22)
where we have used Lemma A.2.
Ifsis suﬃciently small, it follows from (A.22) and (A.14) that
∂t/integraldisplay
M(τR+u)esbφrdvt
≥1
2/integraldisplay
Mτ(|∇2b|2+|Rc|2)esbφrdvt+Xt+Yt−C′τ−1+ǫ(r). (A.23)
By integration from −τ0to−θτ0, we obtain from (A.23), Lemma A.2, (A.19) and (A.21) that
/integraldisplay−θτ0
−τ0/integraldisplay
Mτ(|∇2b|2+|Rc|2)esbφrdvtdt≤C′logθ−1+ǫ(r).
Letting r→∞ , we obtain
/integraldisplay−θτ0
−τ0/integraldisplay
Mτ(|∇2b|2+|Rc|2)esbdvtdt≤C′logθ−1. (A.24)
Thus the inequality (A.15) follows from the combination of ( A.24) and Lemma A.3.
/square
References
[1] B. Andrews, Gradient and oscillation estimates and their applications in geometric PDE ,
International Congress of Chinese Mathematicians (ICCM20 12), American Mathematical So-
ciety, USA, pp. 3-19.
[2] R. H. Bamler, Entropy and heat kernel bounds on a Ricci ﬂow background ,
arXiv:2008.07093v3.
[3] R. H. Bamler, Compactness theory of the space of super Ricci ﬂow , arXiv:2008.09298v2.
[4] R. H. Bamler, Structure theory of non-collapsed limits of Ricci ﬂow , arXiv:2009.03243v2.
[5] R. H. Bamler, On the fundamental group of non-collapsed ancient Ricci ﬂow s,
arXiv:2110.02254.
64[6] R. H. Bamler, Q. S. Zhang, Heat kernel and curvature bounds in Ricci ﬂows with bounded
scalar curvature , Adv. Math., 319 (Oct 15, 2017), 396-450.
[7] S. Brendle, Two-point functions and their applications in geometry , Bull. Amer. Math. Soc.,
51 (2014), no. 4, 581-596.
[8] H.-D. Cao, B.-L. Chen, X.-P. Zhu, Recent developments on Hamilton’s Ricci ﬂow , Surveys in
diﬀerential geometry, V ol. XII. Geometric ﬂows, 47-112, Surv. Diﬀer. Geom., 12, Int. Press,
Somerville, MA, 2008.
[9] H.-D. Cao, D. Zhou, On complete gradient shrinking Ricci solitons , J. Diﬀer. Geom., 85
(2010), no. 2, 175-186.
[10] P. Chan, Z. Ma, and Y . Zhang, Ancient Ricci ﬂows with asymptotic solitons , arXiv:
2106.06904v1.
[11] J. Cheeger, and T.H. Colding, On the structure of space with Ricci curvature bounded below
I, J. Diﬀer. Geom. 46 (1997), 406-480.
[12] J. Cheeger, A. Naber, Lower bounds on Ricci curvature and quantitative behavior o f singular
sets, Invent. Math. 191 (2), 321–339.
[13] J. Cheeger, A. Naber, Regularity of Einstein manifolds and the codimension 4 conj ecture , Ann.
Math. 182 (2015), no.3, 1093-1165.
[14] B.-L. Chen, Strong uniqueness of the Ricci ﬂow , J. Diﬀer. Geom., 82 (2009), no. 2, 363-382.
[15] X. Chen, B. Wang, Space of Ricci ﬂows (I) , Comm. Pure. Appl. Math. 65 (2012), no. 10,
1399-1457.
[16] X. Chen, B. Wang, Space of Ricci ﬂows (II)—Part B: Weak compactness of the ﬂows , J. Dif-
ferential Geom. 116 (1): 1-123 (2020).
[17] X. Chen, B. Wang, Remarks of weak-compactness along K¨ ahler Ricci ﬂow , Proceedings of the
Seventh International Congress of Chinese Mathematicians , ALM 44, 203-233.
[18] B. Chow, S.-C. Chu, D. Glickenstein, C. Guenther, J. Ise nberg, T. Ivey, D. Knopf, P. Lu, F. Luo,
L. Ni, The Ricci Flow: Techniques and Applications. Part II. Analy tic Aspects , Mathematical
Surveys and Monographs, vol 135. American Mathematical Soc iety, Providence (2008).
[19] J. Enders, R. M¨ uller, P. Topping, On Type-I singularities in Ricci ﬂow , Comm. Anal. Geom,
19 (2011), no. 5, 905-922.
[20] A. Friedman, Partial diﬀerential equations of parabolic type , Courier Dover Publications,
2008.
[21] R. S. Hamilton, The formation of singularities in the Ricci ﬂow , Surveys in Diﬀerential Geom.,
2 (1995), 7-136, International Press.
[22] R. Haslhofer, R. M¨ uller, A compactness theorem for complete Ricci shrinkers , Geom. Funct.
Anal., 21 (2011), 1091-1116.
65[23] H. J. Hein, A. Naber, New logarithmic Sobolev inequalities and an ǫ-regularity theorem for
the Ricci ﬂow , Comm. Pure Appl. Math. 67 (2014), no. 9, 1543–1561.
[24] H. Li, Y . Li, B. Wang, On the structure of Ricci shrinkers , J. Funct. Anal., 280 (2021), no.9,
108955.
[25] X. Li, L. Ni, K¨ ahler-Ricci shrinkers and ancient solutions with nonneg ative orthogonal bisec-
tional curvature , Jour. Math. Pures Appl, 138 (2020), 28-45.
[26] X. Li, L. Ni, K. Wang, Four-dimensional gradient shrinking solitons with positi ve isotropic
curvature , Int. Math. Res. Not., vol. 2018, no. 3, 949-959.
[27] Y . Li, B. Wang, The rigidity of Ricci shrinkers of dimension four , Trans. Amer. Math. Soc.,
371 (2019), no.10, 6949-6972.
[28] Y . Li, B. Wang, Heat kernel on Ricci shrinkers , Calc. Var. Partial. Di ﬀer. Equ. 59 (2020),
article 194.
[29] O. Munteanu, J. Wang, Positively curved shrinking Ricci solitons are compact , J. Diﬀer.
Geom.,106 (2017), no. 3, 499-505.
[30] Z. Ma, Y . Zhang, Perelman’s entropy on ancient Ricci ﬂows , J. Funct. Anal. 281 (2021), no. 9,
Paper No. 109195.
[31] A. Naber, Noncompact shrinking four solitons with nonnegative curva ture, J. Reine Angew.
Math. 645 (2010), 125-153.
[32] K. Naﬀ,Shrinking Ricci solitons with positive isotropic curvatur e, arXiv:1905.10305.
[33] L. Ni, N. Wallach, On a classiﬁcation of gradient shrinking solitons , Math. Res. Lett. 15
(2008), no. 5, 941-955.
[34] G. Perelman, The entropy formula for the Ricci ﬂow and its geometric appli cations ,
arXiv:math.DG/0211159.
[35] C. Villani, Optimal Transport, Old and New , Grundlehren Math. Wiss., vol. 338, Springer,
2008.
Yu Li, Institute of Geometry and Physics, University of Scie nce and Technology of China, No.
96 Jinzhai Road, Hefei, Anhui Province, 230026, China; yuli 21@ustc.edu.cn.
Bing Wang, Institute of Geometry and Physics, School of Math ematical Sciences, University of
Science and Technology of China, No. 96 Jinzhai Road, Hefei, Anhui Province, 230026, China;
topspin@ustc.edu.cn.
66