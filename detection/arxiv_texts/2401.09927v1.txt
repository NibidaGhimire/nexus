arXiv:2401.09927v1  [math.NT]  18 Jan 2024L-values of elliptic curves twisted by cubic characters
David Kurniadi Angdinata
January 19, 2024
Abstract
Given a rational elliptic curve Eof analytic rank zero, its L-function can be twisted by an eve n
primitive Dirichlet character χof order q, and in many cases its associated central algebraic L-value
L(E,χ) is known to be integral. This paper derives some arithmetic consequences from a congruence
between L(E,1) andL(E,χ) arising from this integrality, with an emphasis on cubic ch aracters χ.
These include q-adic valuations of the denominator of L(E,1), determination of L(E,χ) in terms of
Birch–Swinnerton-Dyer invariants, and asymptotic densit ies ofL(E,χ) modulo qby varying χ.
Contents
1 Introduction 1
2 Background and conventions 4
3 Modular symbols 6
4 Denominators of L-values 9
5 Units of twisted L-values 11
6 Residual densities of twisted L-values 13
7 Twisted L-values of Kisilevsky–Nam 15
A Tables of Galois images 17
Acknowledgements
I would like to thank Vladimir Dokchitser for suggesting the problem an d guidance throughout, and Harry
Spencer for feedback on a prior draft. I would also like to thank Peir an Wu and Jacob Fjeld Grevstad
for assistance on some of the group theory arguments. This work was supported by the Engineering and
Physical Sciences Research Council [EP/S021590/1], the EPSRC Ce ntre for Doctoral Training in Geometry
and Number Theory (The London School of Geometry and Number T heory), University College London.
1 Introduction
The Hasse–Weil L-function L( E,s) of an elliptic curve EoverQcan be twisted by a primitive Dirichlet
characterχto get a twisted L-function L( E,χ,s). The algebraic and analytic properties of these L-functions
arestudiedextensivelyintheliterature,andtheyarethesubject ofmanyproblemsinthearithmeticofelliptic
curves. Classically, the Birch–Swinnerton-Dyer conjecture relat es L(E,s) to certain algebraic invariants of
E, which encode important global arithmetic information of E. WhenEis base changed to a cyclotomic
extensionKofQ, Artin’s formalism for L-functions says that L( E/K,s) decomposes into a product of
twisted L-functions L( E,χ,s) over all Dirichlet characters χthat factor through K, so the behaviour of
L(E/K,s), and hence the arithmetic of E/K, is completely governed by these twisted L-functions.
1Bythe modularity theorem, L( E,χ,s) admits an analytic continuationto all s∈C, so its value at s= 1 is
well-deﬁned. When it does not vanish, L( E,χ,1) can be normalised by periods to get an algebraic twisted L-
valueL(E,χ). Under some mild hypotheses on Eandχ, Wiersema–Wuthrich proved that L(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig
for non-trivial primitive Dirichlet characters χof orderq[WW22, Theorem 2], by expressing L(E,χ) in
terms of Manin’s modular symbols. Parts of their argument can be ad apted to obtain a congruence between
L(E,χ) andL(E,1) modulo the prime/angbracketleftbig
1−ζq/angbracketrightbig
inZ/bracketleftbig
ζq/bracketrightbig
aboveq, and this turns out to have arithmetic
consequences for L(E,χ). This paper derives a few consequences for when q= 3.
As one consequence, this addresses a problem of Dokchitser–Eva ns–Wiersema, in an attempt to obtain
a Birch–Swinnerton-Dyer-type formula for twisted L-values [DEW2 1]. Under standard arithmetic conjec-
tures, they expressed the norm of L(E,χ) in terms of the Birch–Swinnerton-Dyer quotients BSD( E) and
BSD(E/K), whereKis the number ﬁeld that χfactors through, and deduced furthermore that there are
only ﬁnitely many possibilities for the ideal generated by L(E,χ) [DEW21, Theorem 38]. A subsequent
reﬁnement by Burns–Castillo recovers the ideal factorisation of L(E,χ) in terms of the Galois module struc-
ture of the Tate–Shafarevich group [BC21, Remark 7.4], but the p recise value of L(E,χ) is only predicted
up to a unit in Z/bracketleftbig
ζq/bracketrightbig
. In particular, there are pairs of elliptic curves with identical Birch– Swinnerton-Dyer
quotients but with distinct twisted L-values [DEW21, Section 4]. The f ollowing result determines this unit
for cubic characters, and hence explains their examples, under an assumption on the Manin constant c 0(E).
Theorem 1.1 (Corollary 5.2) .LetEbe an elliptic curve over Qof conductor N, and letχbe a cubic
Dirichlet character of odd prime conductor p∤Nsuch that 3∤c0(E)BSD(E)#E/parenleftbig
Fp/parenrightbig
. Assume that Stevens’s
conjecture holds for E, and that the Birch–Swinnerton-Dyer conjecture holds for Eover number ﬁelds. Then
L(E,χ) =u·χ(N)/radicalbig
BSD(E/K)/radicalbig
BSD(E),
for some sign u=±1, chosen such that
u≡ −#E/parenleftbig
Fp/parenrightbig/radicalbig
BSD(E)3
/radicalbig
BSD(E/K)mod 3.
In particular, all of the arithmetically identical pairs of elliptic curves considered by Dokchitser–Evans–
Wiersema have distinct twisted L-values simply because their number of points modulo pare distinct modulo
3. Section 5 proves this result and clariﬁes their examples in more det ail.
As anotherconsequence, this explainssome ofthe patternsin Kisile vsky–Nam,where they made heuristic
predictions on the asymptotic distribution of twisted L-values [KN22 ]. To support these predictions, they
considered six elliptic curves Eof analytic rank zero and ﬁve positive integers q, and numerically computed
the norms of L-values of Etwisted by primitive Dirichlet characters χof conductor pand orderq, for each
of the thirty pairs( E,q) and over millions of positive integers p[KN22, Section 7]. For each pair( E,q),
they added a normalisation factor to L(E,χ) to obtain a real value L+(E,χ), and empirically determined
the greatest common divisor gcdE,qof the norms of L+(E,χ) by varying over all p. Upon dividing these
norms by gcdE,qto get an integer /tildewideL+(E,χ), they observed that these integers have unexpected biases wh en
reduced modulo q. The following result explains these biases modulo 3 for many elliptic cur ves.
Theorem 1.2 (Proposition 7.5) .LetEbe an elliptic curve over Qof conductor Nand discriminant ∆ =
±Nnfor some 3∤nwith no rational 3-isogeny, such that 3∤c0(E)and3∤gcdE,3, and letχbe a cubic
Dirichlet character of odd prime conductor p∤N. Then
/tildewideL+(E,χ)≡

0 mod 3 if#E/parenleftbig
Fp/parenrightbig
≡0 mod 3
2 mod 3 if#E/parenleftbig
Fp/parenrightbig
≡1 mod 3 andpsplits completely in the 3-division ﬁeld of E
1 mod 3 otherwise.
In particular, the elliptic curves given by the Cremona labels 11a1, 15 a1, and 17a1 considered by
Kisilevsky–Nam satisfy these assumptions, and their normalised twis ted L-values modulo 3 are as predicted.
Section 7 deﬁnes their normalisation for L+(E,χ) and proves this result under slightly relaxed assumptions.
2Now these biases can be quantiﬁed asymptotically by considering the ir natural densities when reduced
moduloq. Observe that for any Dirichlet character χof prime order qof the same conductor p, the twisted
L-values L(E,χ) are congruent modulo/angbracketleftbig
1−ζq/angbracketrightbig
simply because χ≡1 mod/angbracketleftbig
1−ζq/angbracketrightbig
, so the natural density
ofL(E,χ) modulo/angbracketleftbig
1−ζq/angbracketrightbig
only depends on pand notχ. More precisely, let X<n
E,qbe the set of equivalence
classes of Dirichlet characters of order qand conductor less than nbut coprime to that of E, where two
Dirichletcharactersin X<n
E,qareequivalentiftheyhavethesameconductor. Thendeﬁne there sidualdensities
δE,qofL(E,χ) to be the natural densities of L(E,χ) modulo/angbracketleftbig
1−ζq/angbracketrightbig
, or in other words
δE,q(λ):= lim
n→∞#/braceleftBig
χ∈X<n
E,q/vextendsingle/vextendsingle/vextendsingleL(E,χ)≡λmod/angbracketleftbig
1−ζq/angbracketrightbig/bracerightBig
#X<n
E,q, λ∈Fq,
if such a limit exists. The following result classiﬁes the possible ordered triples/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
of
residual densities in terms of BSD( E), the torsion subgroup tor( E), and the mod-9 Galois image im ρE,9.
Theorem 1.3 (Theorem6.4) .LetEbe an elliptic curve over Qsuch that 3∤c0(E)andL(E,1)/\e}atio\slash= 0. Assume
that the Birch–Swinnerton-Dyer conjecture holds for E. Then the ordered triple/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
only depends on BSD(E)and onimρE,9, and can only be one of
(1,0,0),/parenleftbig3
8,3
8,1
4/parenrightbig
,/parenleftbig3
8,1
4,3
8/parenrightbig
,/parenleftbig1
2,1
2,0/parenrightbig
,/parenleftbig1
2,0,1
2/parenrightbig
,/parenleftbig1
8,3
4,1
8/parenrightbig
,
/parenleftbig1
8,1
8,3
4/parenrightbig
,/parenleftbig1
4,1
2,1
4/parenrightbig
,/parenleftbig1
4,1
4,1
2/parenrightbig
,/parenleftbig5
9,2
9,2
9/parenrightbig
,/parenleftbig1
3,2
3,0/parenrightbig
,/parenleftbig1
3,0,2
3/parenrightbig
.
In particular, the ordered triple/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
can be precisely determined as follows.
•Iford3/parenleftbig
BSD(E)/parenrightbig
= 0and3∤#tor(E), then/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
is given by Table 1.
•Iford3/parenleftbig
BSD(E)/parenrightbig
=−1, then/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
is given by Table 2.
•Otherwise, δE,3(0) = 1andδE,3(1) =δE,3(2) = 0.
Note that the aforementioned normalisation factors for twisted L -values are not present here, so the
resulting ordered triples of residual densities will be diﬀerent from t hat of Kisilevsky–Nam. Section 6 proves
this result and outlines the general procedure for higher order ch aracters.
This classiﬁcation builds upon the fact that ord 3/parenleftbig
BSD(E)/parenrightbig
≥ −1, which might be interesting as a
standalone result. In a seminal paper quantifying the cancellations between tor( E) and the Tamagawa
product Tam( E), Lorenzini proved that if q|#tor(E) for some prime q >3, thenq|Tam(E) with
ﬁnitely many explicit exceptions [Lor11, Proposition 1.1]. In particular , whenEhas analytic rank zero,
the denominator #tor( E)2of the rational number BSD( E) shares factors with Tam( E) in its numerator, so
ordq/parenleftbig
BSD(E)/parenrightbig
≥ −1 for any prime q >3. On the other hand, he noted that there is an explicit family of
elliptic curveswith #tor( E) = 3 but with nosuch cancellations[Lor11, Lemma2.26], anotherfamily ofwhich
was also given by Barrios–Roy[BR22, Corollary5.1]. Subsequently, Me listas showed that these cancellations
may instead occur between tor( E) and the Tate–Shafarevich group X(E) in the numerator of BSD( E), and
hence ord 3/parenleftbig
BSD(E)/parenrightbig
≥ −1, except possibly for elliptic curves with certain reduction types [M el23, Theorem
1.4]. He then observed that there are again explicit exceptions, and in all these exceptions c 0(E) = 3 [Mel23,
Example 3.8], but did not explain this coincidence. The following result giv es a lower bound for the odd
part of the denominator of Birch–Swinnerton-Dyer quotients for elliptic curves with analytic rank zero.
Theorem 1.4 (Theorem 4.4) .LetEbe an elliptic curve over Qsuch that L(E,1)/\e}atio\slash= 0, and letq∤c0(E)
be an odd prime. Assume that the Birch–Swinnerton-Dyer conj ecture holds for E. Ifq|#tor(E), then
q|Tam(E)#X(E). In particular, ordq/parenleftbig
BSD(E)/parenrightbig
≥ −1.
Section 4 states this result in terms of L(E,1) and proves it in slightly larger generality. Note that
there will be a stronger statement for elliptic curves with no rationa lq-isogeny that is unconditional on the
Birch–Swinnerton-Dyer conjecture, which is useful for computin g residual densities modulo q>3.
After establishing notational conventions in the next section, som e background on Manin’s modular
symbols will be provided, partly to recall known integrality results fo rL(E,χ), but mainly to obtain an
explicit congruence between L(E,1) andL(E,χ) modulo/angbracketleftbig
1−ζq/angbracketrightbig
. The rest of the paper will be devoted to
proving the four results, with an appendix consisting of mod-3 and 3 -adic Galois images for reference.
32 Background and conventions
ThissectionestablishessomerelevantbackgroundonGaloisrepres entationsandL-functionsofellipticcurves,
as well as some notational conventions that might be deemed less st andard in the literature.
For a primitive n-th root of unity ζn, the ring of integers of the cyclotomic ﬁeld Q(ζn) will be denoted
Z[ζn], and denote the associated norm map by Nm n:Q(ζn)→Q. The ring of integers of its maximal totally
real subﬁeld Q(ζn)+will be denoted Z[ζn]+, and denote the associated norm map by Nm+
n:Q(ζn)+→Q.
The isomorphism/parenleftbig
Z/nZ/parenrightbig×∼− →Gal/parenleftbig
Q(ζn)/Q/parenrightbig
will be given by a/ma√sto→(ζn/ma√sto→ζa
n), which identiﬁes Dirichlet
characters of modulus nwith Artin representations that factor through Q(ζn).
Denote the special linear group, the general linear group, and the projective linear group respectively by
SL(n):= SL2/parenleftbig
Z/nZ/parenrightbig
,GL(n):= GL2/parenleftbig
Z/nZ/parenrightbig
,PGL(n):= PGL 2/parenleftbig
Z/nZ/parenrightbig
.
For a matrix Min such a matrix group, its trace will be denoted tr( M) and its determinant will be denoted
det(M). For a prime q, the following table groups the conjugacy classes of SL( q) by trace [Bon11, Table 1.1
and Exercise 1.4], which will be useful for Theorem 4.4 and Proposition 6.1.
Representative Number of classes Order Cardinality Trace/parenleftbigg
1z
0 1/parenrightbigg
,
z∈Fqone for each symbol/parenleftBig
z
q/parenrightBig
,
for a total of 3 classesq|(z
q)|/parenleftBig
q2−1
2/parenrightBig|(z
q)|
2
/parenleftbigg
−1z
0−1/parenrightbigg
,
z∈Fqone for each symbol/parenleftBig
z
q/parenrightBig
,
for a total of 3 classes2q|(z
q)|/parenleftBig
q2−1
2/parenrightBig|(z
q)|
q−2
/parenleftbiggx0
0x−1/parenrightbigg
,
x∈F×
q\{±1}one for each pair/braceleftbig
x,x−1/bracerightbig
,
for a total ofq−3
2classesorder ofxq(q+1)x+x−1
/parenleftBigg
1
2(ξ+ξq)ζ
2(ξ−ξq)
1
2ζ(ξ−ξq)1
2(ξ+ξq)/parenrightBigg
,
ξ∈/parenleftbig
F×
q2/F×
q/parenrightbig
\{±1}one for each pair/braceleftbig
ξ,ξ−1/bracerightbig
,
for a total ofq−1
2classesorder ofξq(q−1)ξ+ξq
Here,ζis a ﬁxed element of F×
q2satisfyingζ+ζq= 0, and/parenleftBig
z
q/parenrightBig
is the Legendre symbol modulo qgiven by
/parenleftbiggz
q/parenrightbigg
:=

1 ifzis a quadratic residue modulo q
0 ifq|z
−1 ifzis a quadratic nonresidue modulo q.
Throughout, an elliptic curve will always refer to an elliptic curve EoverQof conductor N, and any
explicit example of an elliptic curve will be given by its Cremona label [Cre9 2, Table 1]. For a prime q, the
Zq-representation associated to the q-adic Tate module of Eis denoted ρE,q, and itsq-adic Galois image
imρE,qwill be givenbyits Rouse–Sutherland–Zureick-Brownlabel asasubg roupofGL 2/parenleftbig
Zq/parenrightbig
up toconjugacy
[RSZB22, Section 2.4]. For any n∈N, the projection of ρE,qonto GL(qn) is denoted ρE,qn, and its mod- q
Galois image im ρE,qnwill be given by its Sutherland label as a subgroup of GL( qn) up to conjugacy [Sut16,
Section 6.4]. Note that if Fr pis an arithmetic Frobenius at a prime p/\e}atio\slash=q, then
tr/parenleftbig
ρE,q/parenleftbig
Frp/parenrightbig/parenrightbig
= ap(E):= 1+p−#E/parenleftbig
Fp/parenrightbig
.
LetωEdenote a global invariant diﬀerential on a minimal Weierstrass equat ion ofE. Let X 0(N) denote
the modular curve associated to the congruence subgroup Γ 0(N), and let S 2(N) denote the space of weight
twocusp formsandlevel Γ 0(N). Bythe modularity theorem, there isa surjectivemorphism φE:X0(N)։E
of minimal degree and an eigenform fE∈S2(N) with Fourier coeﬃcients a p(E) for each prime p. These
deﬁne two diﬀerentials on X 0(N), namely 2 πifE(z)dzand the pullback φ∗
EωE, which are related by
φ∗
EωE=±c0(E)2πifE(z)dz,
where c 0(E) is a positive integer called the Manin constant [Edi91, Proposition 2].
4WhenEis Γ0(N)-optimal in its isogeny class, it is conjectured that c 0(E) = 1 always, and this was
recently proven for semistable E[ˇC18, Theorem 1.2], but it is certainly possible that c 0(E)/\e}atio\slash= 1 in general.
Nevertheless, every modular parameterisation by X 0(N) factors through a modular parameterisation by the
modular curve X 1(N) associated to the congruence subgroup Γ 1(N) [Ste89, Theorem 1.9], and an analogous
construction using X 1(N) yields the Manin constant c 1(E) with the following conjecture.
Conjecture 2.1 (Stevens) .LetEbe an elliptic curve. Then c1(E) = 1.
The L-function L( E,s) ofEis deﬁned to be the Euler product of L p/parenleftbig
ρ∨
E,q,p−s/parenrightbig−1over all primes p, where
ρ∨
E,qis the dual of the Artin representation associated to ρE,qfor some prime number q/\e}atio\slash=p. Here, for an
Artin representation ρ, the local Euler factors are given by L p(ρ,T):= det/parenleftbig
1−T·Fr−1
p|ρp/parenrightbig
, whereρpis
the subrepresentation of ρﬁxed by the inertia subgroup at p. The modularity theorem says that L( E,s) is
the Hecke L-function of fE, so its order of vanishing at s= 1 is well-deﬁned.
The Birch–Swinnerton-Dyer conjecture predicts this order of va nishing and its leading term in terms of
arithmetic invariants as follows. Let tor( E) and rk(E) denote the torsion subgroup and the rank of the
Mordell–Weil group E(Q) respectively. Let Ω( E) denote the real period given by/integraltext
E(R)ωE, with orientation
chosen such that Ω( E)>0. Let Tam( E) denote the Tamagawa product of local Tamagawa numbers
Tamp(E) at each prime p. Let Reg( E) denote the elliptic regulator deﬁned in terms of the N´ eron–Tate
pairing/a\}bracketle{tP,Q/a\}bracketri}ht=1
2hE(P+Q)−1
2hE(P)−1
2hE(Q), where h Eis the canonical height on E. Finally, let X(E)
denote the Tate–Shafarevich group, which is implicitly assumed to be ﬁnite in this paper.
Conjecture 2.2 (Birch–Swinnerton-Dyer) .LetEbe an elliptic curve. Then the order of vanishing rof
L(E,s)ats= 1is equal to rk(E), and its leading term satisﬁes
lim
s→1L(E,s)
(s−1)r·1
Ω(E)=Tam(E)·#X(E)·Reg(E)
#tor(E)2.
Here, the left hand side is the algebraic L-value of E, which will be denoted L(E), and the right hand
side is the Birch–Swinnerton-Dyer quotient of E, which will be denoted BSD( E). By the combined works
of Gross–Zagier [GZ86, Theorem 7.3] and Kolyvagin [Kol88, Corollary 2 ], it is known that L( E,1)/\e}atio\slash= 0
implies that rk( E) = 0 and X(E) is ﬁnite. In this setting, BSD( E) is clearly rational since Reg( E) = 1, and
Proposition 3.3 shows that L(E) is also rational. If ord q:Q→Z∪{∞}denotes the q-adic valuation for some
primeq, the conjecture that ord q/parenleftbig
L(E)/parenrightbig
= ordq/parenleftbig
BSD(E)/parenrightbig
is called the q-part of the Birch–Swinnerton-Dyer
conjecture. For the base change E/KofEto an extension KofQ, the analogous quantities L(E/K) and
BSD(E/K) can be deﬁned as in the paper by Dokchitser–Evans–Wiersema [DE W21, Section 1.5].
Throughout, a character will alwaysrefer to a non-trivialeven primitive Dirichlet character χof conduc-
torncoprimetoNandorderq>1, which meansthat χ(−1) = 1, andfurthermore qdividesthe Eulertotient
ofn. The L-function L( E,χ,s) ofEtwisted byχis deﬁned to be the Euler product of L p/parenleftbig
ρ∨
E,q⊗χ,p−s/parenrightbig−1
over all primes p, so that in particular L(E,1) =L(E). The modularity theorem says that L( E,χ,s) is the
Hecke L-function of a weight two cusp form of level Γ 0(N) twisted by χ[Shi71, Theorem 3.66], so its order
of vanishing at s= 1 is again well-deﬁned. The analogous algebraic twisted L-value is give n by
L(E,χ):= lim
s→1L(E,χ,s)
(s−1)r·n
τ(χ)Ω(E),
whereris the order of vanishing of L( E,χ,s) ats= 1 andτ(χ) is the Gauss sum of χ.
Remark 2.3. The deﬁnitions of L-values and Birch–Swinnerton-Dyer invariants in this section agree with
those in Wiersema–Wuthrich[WW22, Section 7] and those in Dokchitse r–Evans–Wiersema[DEW21, Section
1.5],exceptforonenotablediﬀerencefortwistedL-functions. In thispaper, theDirichletseriesofL( E,χ,s)is/summationtext∞
n=1χ(n)an(E)n−s, andL(E,χ)isdeﬁnedintermsofL( E,χ,s). Wiersema–Wuthrichgivestwodeﬁnitions
for twisted L-functions, namely an automorphic one that agrees w ith L(E,χ,s), and a motivic one that
coincideswith L( E,χ,s) instead ofL( E,χ,s). However,their algebraictwisted L-valueis deﬁned motivically,
so it coincides with L(E,χ) instead of L(E,χ). Dokchitser–Evans–Wiersemafollows the motivic convention,
so their twisted L-functions and algebraic twisted L-values coincide with L(E,χ,s) andL(E,χ) respectively.
Remark 2.4. Except for generalities on modular symbols in the next section, char acters will have prime
conductor and prime order, but many results can be generalised to prime power orders with a bit more work.
53 Modular symbols
This section recalls some classical facts on modular symbols. Most of the arguments here are well-known
since the time of Manin [Man72], with a few recent integrality results by Wiersema–Wuthrich [WW22], but
they are provided for reference. Nevertheless, the main tool is t he congruence in Corollary 3.7.
LetN∈N, and let S 2(N) denote the space of weight two cusp forms on the congruence su bgroup
Γ0(N):=/braceleftBigg/parenleftbigga b
c d/parenrightbigg
∈PSL2(Z)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleN|c/bracerightBigg
,
which acts on the extended upper half plane Hby fractional linear transformations. A smooth path between
two points in the same Γ 0(N)-orbit projects onto a closed path in the quotient X 0(N) =H/Γ0(N), which
deﬁnes an integral homology class γ∈H1/parenleftbig
X0(N),Z/parenrightbig
. This is independent of the smooth path chosen
because His simply connected, and any integral homology class γ∈H1/parenleftbig
X0(N),Z/parenrightbig
arises in such a way.
On the other hand, any cusp form f∈S2(N) induces a diﬀerential 2 πif(z)dzon X0(N), and integrating
this over the closed path γgives a complex number/integraltext
γ2πif(z)dzcalled a modular symbol . A general
deﬁnition for paths with arbitrary endpoints is given by Manin [Man72 , Section 1.2], but for the purposes
of this paper, it suﬃces to consider the modular symbol associated to the path from 0 to cusps q∈Q∪{∞}.
When the denominator of q∈Qis coprime to N, the image of any smooth path between 0 and qis always
closed [Man72, Proposition 2.2], so it makes sense to write the modular symbol
µf(q):=/integraldisplayq
02πif(z)dz∈C.
The key example for fwill be the normalised cuspidal eigenform fE∈S2(N) associated to an elliptic curve
Eof conductor N. In this case, it turns out that L(E), as well as L(E,χ) for any character χof conductor
coprime to N, can be written as sums of µE(q):=µfE(q) for someq∈Q. Furthermore, the terms in these
sums can be paired up in a way that guarantees integrality, using the following trick.
Lemma 3.1. Letq∈Qwith denominator coprime to N∈N, and letf∈S2(N). Then
µf(q)+µf(1−q) = 2ℜ/parenleftbig
µf(q)/parenrightbig
.
In particular, if Eis an elliptic curve, then µE(q)+µE(1−q)is an integer multiple of c0(E)−1Ω(E).
Proof.This is similar to the proof in Wiersema–Wuthrich [WW22, Lemma 4], but th e argument is repeated
here for reference. Note that µf(1−q)−µf(−q) is the integral of 2 πif(z) along the smooth path between
−qand/parenleftbig1 1
0 1/parenrightbig
·(−q), which is zero [Man72, Proposition 1.4], so µf(1−q) =µf(−q). The change of variables
z/ma√sto→ −zthen transforms µf(−q) intoµf(q), so the ﬁrst statement follows. Now let γbe the image of any
smooth path from 0 to qunder the modular parameterisation φE:X0(N)։Eassociated to E. Then
µE(q) = c0(E)−1/integraltext
γωEby deﬁnition, so the second statement follows from the ﬁrst state ment and the fact
thatγis necessarily an integer multiple of the generator of H 1/parenleftbig
E(C),Z/parenrightbig
that deﬁnes Ω( E).
Remark 3.2. When the denominator of q∈Qis coprime to N, these modular symbols µE(q) coincide
precisely with the modular symbols µ(q) deﬁned in Wiersema–Wuthrich [WW22, Section 2].
For this exact reason, the modular symbols µE(q) can be normalised to be integers. More precisely, for
an elliptic curve Eof conductor Nwith normalised cuspidal eigenform fE∈S2(N), deﬁne
µ+
E(q):=c0(E)
Ω(E)/parenleftbig
µE(q)+µE(1−q)/parenrightbig
∈Z.
The integrality of L(E) is now a formal consequence of the Hecke action on the space of m odular symbols.
6Proposition 3.3. LetEbe an elliptic curve of conductor Ncoprime to n∈N. Then
c0(E)L(E)/parenleftBig
an(E)−σ1(n)+#E(F2)σ+
0(n)/parenrightBig
=/summationdisplay
m|n/floorleftbigg
m−1
2/floorrightbigg
/summationdisplay
a=1µ+
E/parenleftbiga
m/parenrightbig
,
whereσ1(n)is the sum of divisors of nandσ+
0is the number of even divisors of n. In particular, both sides
lie inZ, and ifp∤Nis an odd prime, then
c0(E)L(E)#E/parenleftbig
Fp/parenrightbig
=/floorleftbiggp−1
2/floorrightbigg
/summationdisplay
a=1µ+
E/parenleftBig
a
p/parenrightBig
.
Proof.Integrality and the ﬁnal statement are immediate consequences f rom Lemma 3.1 and the ﬁrst state-
ment. To prove the ﬁrst statement, assume that 2 ∤N. The Hecke action [Man72, Theorem 4.2] says
L(E,1)/parenleftbig
an(E)−σ1(n)/parenrightbig
=/summationdisplay
m|nm−1/summationdisplay
a=1µE/parenleftbiga
m/parenrightbig
,
so in particular L( E,1)#E(F2) =−µE/parenleftbig1
2/parenrightbig
. By dividing by c 0(E)−1Ω(E), the ﬁrst statement reduces to
/summationdisplay
m|nm−1/summationdisplay
a=1µE/parenleftbiga
m/parenrightbig
−µE/parenleftbig1
2/parenrightbig
σ+
0(n) =/summationdisplay
m|n/floorleftbigg
m−1
2/floorrightbigg
/summationdisplay
a=1/parenleftBig
µE/parenleftbiga
m/parenrightbig
+µE/parenleftbig
1−a
m/parenrightbig/parenrightBig
,
which is simply a rearrangement of sums. Now assume that 2 |N, so that 2 ∤nby assumption. Then the
divisorsm|nare all odd, so σ+
0(n) = 0 and this follows again from the Hecke action.
Remark 3.4. The assumption that Nis coprime to nis crucial, and removing this may cause integrality
to fail, such as for the elliptic curve 11a1 where c 0(E) = 1 and L(E) =1
5, but a 11(E) = 1 andσ1(11) = 12.
The same argument can be adapted for the integrality of L(E,χ) using Birch’s formula.
Proposition 3.5. LetEbe an elliptic curve of conductor N, and letχbe a character of order qand
conductorncoprime to N. Then
c0(E)L(E,χ) =/floorleftbigg
n−1
2/floorrightbigg
/summationdisplay
a=1χ(a)µ+
E/parenleftbiga
n/parenrightbig
.
In particular, both sides lie in Z/bracketleftbig
ζq/bracketrightbig
. Furthermore, if c1(E) = 1, thenL(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig
.
Proof.Integrality follows immediately from Lemma 3.1 and the ﬁrst statemen t. To prove the ﬁrst statement,
a modiﬁcation of Birch’s formula [WW22, Lemma 6] yields
L(E,χ,1) =τ(χ)
nn−1/summationdisplay
a=1χ(a)µE/parenleftbiga
n/parenrightbig
,
noting that the automorphic and motivic deﬁnitions of L(E,χ) agree by the assumption that nis coprime
toN[WW22, Lemma 18]. By dividing by n−1c0(E)−1τ(χ)Ω(E), the ﬁrst statement reduces to
n−1/summationdisplay
a=1χ(a)µE/parenleftbiga
n/parenrightbig
=/floorleftbigg
n−1
2/floorrightbigg
/summationdisplay
a=1χ(a)/parenleftBig
µE/parenleftbiga
n/parenrightbig
+µE/parenleftbig
1−a
n/parenrightbig/parenrightBig
.
Nowχ(a) =χ(n−a) sinceχis even, and χ/parenleftbign
2/parenrightbig
= 0 when 2 |n, so this is again a rearrangement of sums.
The ﬁnal statement is an analogous argument with c 1(E) [WW22, Proposition 8].
Remark 3.6. The assumption that nis coprime to Ncan be weakened slightly to n∤Nfor the ﬁrst two
statements [WW22, Proposition 7], and to n∤Nfor the ﬁnal statement [WW22, Proposition 8]. Removing
either of these conditions may cause integrality to fail, such as for t he elliptic curve 50b1 satisfying c 0(E) = 1
and the unique quadratic character of conductor 5, where L(E,χ) =1
3.
7ObservethattherighthandsidesofProposition3.3andProposition 3.5arehighlysimilar. Moreprecisely,
sinceχ(a)≡1 mod/angbracketleftbig
1−ζq/angbracketrightbig
except when gcd( a,n)/\e}atio\slash= 1, the right hand sides are congruent modulo/angbracketleftbig
1−ζq/angbracketrightbig
,
up to a small error term consisting of extraneous modular symbols µ+
E/parenleftbiga
m/parenrightbig
for each proper divisor mofn.
Corollary 3.7. LetEbe an elliptic curve of conductor N, and letχbe a character of order qand conductor
ncoprime to N. Then
c0(E)L(E,χ)≡c0(E)L(E)/parenleftBig
an(E)−σ1(n)+#E(F2)σ+
0(n)/parenrightBig
−ǫE,nmod/angbracketleftbig
1−ζq/angbracketrightbig
,
where
ǫE,n:=/floorleftbigg
n−1
2/floorrightbigg
/summationdisplay
a=1
gcd(a,n)/negationslash=1µ+
E/parenleftbiga
n/parenrightbig
+/summationdisplay
m|n
m/negationslash=n/floorleftbigg
m−1
2/floorrightbigg
/summationdisplay
a=1µ+
E/parenleftbiga
m/parenrightbig
.
In particular, if p∤Nis an odd prime, then ǫE,p= 0and
c0(E)L(E,χ)≡ −c0(E)L(E)#E/parenleftbig
Fp/parenrightbig
mod/angbracketleftbig
1−ζq/angbracketrightbig
,
and if furthermore q∤c0(E), then
L(E,χ)≡ −L(E)#E/parenleftbig
Fp/parenrightbig
mod/angbracketleftbig
1−ζq/angbracketrightbig
,
where the denominators of both sides are inverted modulo/angbracketleftbig
1−ζq/angbracketrightbig
.
Remark 3.8. By stating the congruence at this generality, some interesting par ity results for algebraic
L-values twisted by quadratic characters can also be derived. For instance, if χis a quadratic character of
conductorn=p1p2, wherep1andp2are two distinct primes coprime to N, then
c0(E)L(E,χ)≡c0(E)L(E)/parenleftbig
ap1(E)ap2(E)−n−p1−p2−1/parenrightbig
mod 2.
When 2∤N, something similar occurs for the unique quadratic character χof conductor n= 8, where
c0(E)L(E,χ)≡c0(E)L(E)/parenleftbig
a2(E)+1/parenrightbig/parenleftbig
a2(E)+2/parenrightbig/parenleftbig
a2(E)−3/parenrightbig
mod 2.
In both cases, it can be veriﬁed explicitly that ǫE,n≡0 mod 2, and the remaining terms are obtained from
recurrences for Fourier coeﬃcients of eigenforms. Neither of th ese will be explored further in the paper.
Remark 3.9. Without having c 0(E), both integrality results and the congruence easily fail in trivial wa ys,
butq∤c0(E) is a relatively mild assumption, since c 0(E)/\e}atio\slash= 1 seems to be relatively rare.
Remark 3.10. Algebraic twisted L-values L(E,χ) satisfy Deligne’s period conjecture [BD07, Theorem
2.7], so in particular they are Galois equivariant, in the sense that L(E,σ◦χ) =σ/parenleftbig
L(E,χ)/parenrightbig
for anyσ∈
Gal/parenleftbig
Q/parenleftbig
ζq/parenrightbig
/Q/parenrightbig
. With this property, L(E) can be expressed in terms of the sum of L(E,χ) for all characters
χof a given conductor and order. For instance, when χis a cubic character of conductor n,
1+χ(a)+χ(a) =

3 ifa∈/parenleftbig
Z/nZ/parenrightbig×3
1 ifa∈/parenleftbig
Z/nZ/parenrightbig
\/parenleftbig
Z/nZ/parenrightbig×
0 ifa∈/parenleftbig
Z/nZ/parenrightbig×\/parenleftbig
Z/nZ/parenrightbig×3,
so the identities in Proposition 3.3 and Proposition 3.5 combine to yield
c0(E)L(E,χ)+c0(E)L(E,χ)+c0(E)L(E)/parenleftBig
an(E)−σ1(n)+#E(F2)σ+
0(n)/parenrightBig
= 3/floorleftbigg
n−1
2/floorrightbigg
/summationdisplay
a=1
a∈(Z/nZ)×3µ+
E/parenleftbiga
n/parenrightbig
+ǫE,n.
By Galois equivariance, the ﬁrst two terms combine to 2c 0(E)ℜ/parenleftbig
L(E,χ)/parenrightbig
, so this expresses ℜ/parenleftbig
L(E,χ)/parenrightbig
in
terms of L(E) up to a few error terms consisting of modular symbols. By reducing modulo 3, this recovers
the congruence in Corollary 3.7, but also shows that the congruenc e would not a priori hold modulo 9, unless
the extraneous modular symbols µ+
E/parenleftbiga
n/parenrightbig
for each cubic residue amodulonsum to a multiple of 3.
84 Denominators of L-values
This section proves a few results on the q-adic valuations of denominators of algebraic L-values, where qis
an odd prime, which may be of independent interest. Since c 0(E)L(E)#E/parenleftbig
Fp/parenrightbig
∈Z, theq-adic valuation of
c0(E)L(E)∈Qcan be bounded from below by the q-adic valuation of # E/parenleftbig
Fp/parenrightbig
, which is in turn controlled
by tor(E) in the denominator of BSD( E). Whenq/\e}atio\slash= 3, under the q-part of the Birch–Swinnerton-Dyer
conjecture, such a lower bound follows from Lorenzini’s result that ordq/parenleftbig
#tor(E)/parenrightbig
≤ordq/parenleftbig
Tam(E)/parenrightbig
with
ﬁnitely many exceptions [Lor11, Proposition 1.1], but the case q= 3 requires more work.
Lemma 4.1. LetEbe an elliptic curve without complex multiplication such th atEhas a point of order 3
but3∤Tam(E). ThenimρE,3is a Borel subgroup.
Proof.By the assumption that Ehas a point of order 3, Eis isomorphic either to y2+cy=x3for some
cube-freec∈N, which has complex multiplication by Z[ζ3], or to
E1,±b/a:y2+xy±b
ay=x3,
for some coprime a,b∈N[BR22, Proposition 2.4]. If 3 ∤ordp(a) for some prime p, then 3|Tamp/parenleftbig
E1,±b/a/parenrightbig
[BR22, Theorem 3.5]. This contradicts the assumption that 3 ∤Tam(E), soa=d3for somed∈Ncoprime
tob. The change of variables( x,y)/ma√sto→/parenleftbig
x/d2,y/d3/parenrightbig
yields an isomorphism from E1,±b/ato
Ed,±b:y2+dxy±by=x3,
which has discriminant ∆ = ±b3/parenleftbig
d3−27b/parenrightbig
. Now let p|b, so thatp|∆ and ord p/parenleftbig
d3−27b/parenrightbig
= 0 by
coprimality. By step 2 of Tate’s algorithm, since T2+dTsplits in Fp,Ed,±bhas Kodaira symbol Iordp(∆)
and has split mutiplicative reduction at p, so Tam p/parenleftbig
Ed,±b/parenrightbig
= ordp(∆) = 3ord p(b). This forces b= 1 by the
assumption that 3 ∤Tam(E), so the j-invariant of Ed,±b=Ed,±1is given by
d3/parenleftbig
d3∓24/parenrightbig3
±d3−27= 27/parenleftBig
27
±d3−27+1/parenrightBig/parenleftBig
27
±d3−27+9/parenrightBig3
/parenleftBig
27
±d3−27/parenrightBig3,
which implies that im ρE,3is the Borel subgroup 3B.1.1 [Zyw15, Theorem 1.2].
Assuming the 3-part of the Birch–Swinnerton-Dyer conjecture, a divisibility result for BSD( E) can be
derived from the integrality of c 0(E)L(E)#E/parenleftbig
Fp/parenrightbig
, via a case-by-case analysis on im ρE,3.
Proposition 4.2. LetEbe an elliptic curve of conductor Nsuch that L(E,1)/\e}atio\slash= 0andtor(E)∼=Z/3Z.
Assume that ord3/parenleftbig
L(E)/parenrightbig
≤ord3/parenleftbig
BSD(E)/parenrightbig
. Then3|c0(E)Tam(E)#X(E).
Proof.Assume that 3 ∤c0(E). By Proposition 3.3 and the assumptions, for an odd prime p,
ord3/parenleftbiggTam(E)#X(E)
9#E/parenleftbig
Fp/parenrightbig/parenrightbigg
≥ord3/parenleftBig
L(E)#E/parenleftbig
Fp/parenrightbig/parenrightBig
≥0,
so it suﬃces to ﬁnd an odd prime p∤Nsuch that # E/parenleftbig
Fp/parenrightbig
≡3 mod 9. By Chebotarev’s density theorem,
this reduces to ﬁnding a matrix M E,3∈imρE,9such that 1+det/parenleftbig
ME,3/parenrightbig
−tr/parenleftbig
ME,3/parenrightbig
= 3. By inspecting Table
2, such matrices exist for all im ρE,3except for the two 3-adic Galois images 9.72.0.1 and 9.72.0.5, so these
have to be handled separately. If im ρE,3is 9.72.0.1, then im ρE,3is 3Cs.1.1 and not 3B.1.1, so Lemma 4.1
implies that 3 |Tam(E). Otherwise im ρE,3is 9.72.0.5, then im ρE,9ﬁxes a subspace of the group of 9-torsion
points ofE, soE(Q)∼=Z/9Z, which contradicts the assumption that E(Q)∼=Z/3Z.
Remark 4.3. The conclusion of Proposition 4.2 was already observed by Melistas [Me l23, Example 3.8],
wheretheellipticcurves27a3,27a4,and54a3allhave E(Q)∼=Z/3ZandTam(E)#X(E) = 1butc 0(E) = 3.
By the work of Lorenzini, it is generally expected that the factors in Tam(E) would cancel #tor( E), but in
this case it is necessary to consider # X(E) as well, such as in the elliptic curve 1638j3 where E(Q)∼=Z/3Z
and c0(E)Tam(E) = 1 but # X(E) = 9. Note also that the statement is false for tor( E)∼=Z/3Zbut
rk(E)>0, such as for the elliptic curve 91b1 where c 0(E)Tam(E)#X(E) = 1.
9A lower bound on the q-adic valuation of c 0(E)L(E) then follows under the q-part of the Birch–
Swinnerton-Dyer conjecture, but when Ehas no rational q-isogeny the bound can be made unconditional.
Theorem 4.4. LetEbe an elliptic curve of conductor Nsuch that L(E,1)/\e}atio\slash= 0, and letqbe an odd prime.
1. IfEhas no rational q-isogeny, then ordq/parenleftbig
c0(E)L(E)/parenrightbig
≥0.
2. Assume that ordq/parenleftbig
L(E)/parenrightbig
= ordq/parenleftbig
BSD(E)/parenrightbig
. Thenordq/parenleftbig
c0(E)L(E)/parenrightbig
≥ −1.
Proof.For the ﬁrst statement, by Proposition 3.3, it suﬃces to ﬁnd an odd primep∤Nsuch thatq∤
#E/parenleftbig
Fp/parenrightbig
, so by Chebotarev’s density theorem this reduces to ﬁnding a matr ixM∈imρE,qsuch that
tr(M)/\e}atio\slash= 1 + det(M). Suppose otherwise that tr( M) = 1 + det( M) for allM∈imρE,q, so in particular
tr(M) = 2 for all M∈imρE,q∩SL(q). In this case, by inspecting the order in each conjugacy class of S L(q),
imρE,q∩SL(q) is necessarily a q-group, so in particular q|#imρE,q. Then either im ρE,qis contained in
a Borel subgroup of GL( q) or imρE,qcontains SL( q) [Ser72, Proposition 15]. The former contradicts the
assumption that Ehas no rational q-isogeny, and the latter is impossible by comparing orders.
For the second statement, the assumption on the q-adic valuations reduces the statement to proving that
ordq/parenleftbig
c0(E)BSD(E)/parenrightbig
≥ −1. By Mazur’s torsion theorem, it suﬃces to consider tor( E) being one of
Z/3Z,Z/5Z,Z/6Z,Z/7Z,Z/9Z,Z/10Z,Z/12Z,Z/2Z×Z/6Z,
sinceqis odd. IfE(Q)/\e}atio\slash∼=Z/3Z, then a case-by-case analysis of qyields ord q/parenleftbig
Tam(E)/parenrightbig
≥ordq/parenleftbig
#tor(E)/parenrightbig
except for the elliptic curve 11a3 with q= 5, and the elliptic curves 14a4 and 14a6 with q= 3 [Lor11,
Proposition 1.1], but these exceptions all have ord q/parenleftbig
c0(E)/parenrightbig
= 1 and ord q/parenleftbig
BSD(E)/parenrightbig
=−2. IfE(Q)∼=Z/3Z,
then Proposition 4.2 implies that ord 3/parenleftbig
BSD(E)/parenrightbig
= ord3/parenleftbig
c0(E)Tam(E)#X(E)/parenrightbig
−2≥ −1.
Remark 4.5. The assumption on the q-part of the Birch–Swinnerton-Dyer conjecture in the second st ate-
ment can be slightly weakened, by only requiring that ord q/parenleftbig
L(E)/parenrightbig
≥ordq/parenleftbig
BSD(E)/parenrightbig
for allE, except for
when imρE,3is 9.72.0.1, where the assumption ord q/parenleftbig
L(E)/parenrightbig
≤ordq/parenleftbig
BSD(E)/parenrightbig
is also needed to proceed with
the argument in Proposition 4.2. The second statement might also be provable without appealing to the
q-part of the Birch–Swinnerton-Dyer conjecture when q >3, by ﬁnding a matrix M∈imρE,qsuch that
1+det(M)−tr(M)≡qmodq2along the same lines as the proof of Proposition 4.2. In general, this w ould
need a case-by-case analysis of im ρE,qfor whenEhas no rational q-isogeny, which seems to be unsolved.
Remark 4.6. A lower bound for the 2-adic valuation of c 0(E)L(E) should also be achievable by arguing
along the same lines, using the n= 2 version of Proposition 3.3 and the classiﬁcation of im ρE,2if necessary.
This will not be needed for the rest of the paper and will not be discus sed further.
The following is an easy result on the q-adic valuation of L(E)#E/parenleftbig
Fp/parenrightbig
. The factors arising from the
denominator of the rational number L(E)#E/parenleftbig
Fp/parenrightbig
could a priori cancel the factors appearing in c 0(E), but
the congruence of L-values says that this should not happen unde r Stevens’s conjecture that c 1(E) = 1.
Proposition 4.7. LetEbe an elliptic curve of conductor N, and letp∤Nandqbe odd primes such that
p≡1 modq. Assume that c1(E) = 1. Then
q∤c0(E)L(E)#E/parenleftbig
Fp/parenrightbig
⇐⇒q∤c0(E)andordq/parenleftbig
L(E)#E/parenleftbig
Fp/parenrightbig/parenrightbig
= 0.
Proof.Assume ﬁrst that q∤c0(E)L(E)#E/parenleftbig
Fp/parenrightbig
butq|c0(E). By the assumption that c 1(E) = 1, Propo-
sition 3.5 says that L(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig
for any character χof conductor pand orderq, so c0(E)L(E,χ)≡
0 mod/angbracketleftbig
1−ζq/angbracketrightbig
, which contradicts q∤c0(E)L(E)#E/parenleftbig
Fp/parenrightbig
by Corollary 3.7. Thus q∤c0(E), so that
ordq/parenleftbig
L(E)#E/parenleftbig
Fp/parenrightbig/parenrightbig
= 0 also follows, while the converse is immediate noting that L(E)/\e}atio\slash= 0.
Remark 4.8. Assuming Stevens’s conjecture, Proposition 4.7 yields an immediate p roof that L(E)#E/parenleftbig
Fp/parenrightbig
isintegralat qifordq/parenleftbig
c0(E)/parenrightbig
≤1. ThisconditionseemstoholdforallellipticcurvesintheLMFDB[Col], b ut
a proof remains elusive. On the other hand, assuming the q-part of the Birch–Swinnerton-Dyer conjecture,
there might be a direct proof that L(E)#E/parenleftbig
Fp/parenrightbig
is integral at q, by arguing that 1+det( M)−tr(M) cancels
#tor(E)2for every matrix Mlying in every possible im ρE,q. Again, this will be omitted here.
105 Units of twisted L-values
Under standard arithmetic conjectures, Dokchitser–Evans–Wie rsemacomputed the norm of L(E,χ) in terms
of BSD(E) and BSD( E/K), whereKis the degree qsubﬁeld of Q/parenleftbig
ζp/parenrightbig
cut out by the kernel of χ[DEW21,
Theorem 38]. Some of their results can be summarised in the notation of this paper as follows.
Proposition 5.1. LetEbe an elliptic curve of conductor N, and letχbe a character of odd prime conductor
p∤Nand odd prime order q∤c0(E)BSD(E)#E/parenleftbig
Fp/parenrightbig
. Assume that c1(E) = 1, and that L(E) = BSD(E)
andL(E/K) = BSD(E/K). Furthermore, set ζ:=χ(N)(q−1)/2.
1.L(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig
generates an ideal invariant under complex conjugation, an d has norm
Nmq/parenleftbig
L(E,χ)/parenrightbig
=BSD(E/K)
BSD(E).
2.L(E,χ)·ζ∈Z/bracketleftbig
ζq/bracketrightbig+, and has norm
/vextendsingle/vextendsingle/vextendsingleNm+
q/parenleftbig
L(E,χ)·ζ/parenrightbig/vextendsingle/vextendsingle/vextendsingle=/radicalbig
BSD(E/K)/radicalbig
BSD(E).
In particular, if BSD(E) = BSD(E/K), then there is a unit u∈Z/bracketleftbig
ζq/bracketrightbig+such that L(E,χ) =u·ζ−1.
Proof.By Proposition 4.7, under the arithmetic conjectures, the assump tion thatq∤c0(E)BSD(E)#E/parenleftbig
Fp/parenrightbig
reducestoq∤c0(E)andord q/parenleftbig
L(E)#E/parenleftbig
Fp/parenrightbig/parenrightbig
= 0. InparticularL( E,1)/\e}atio\slash= 0,andmoreoverord q/parenleftbig
L(E,χ)/parenrightbig
= 0
by Corollary 3.7, so L( E,χ,1)/\e}atio\slash= 0 as well. This veriﬁes the assumptions of a result by Dokchitser–Ev ans–
Wiersema [DEW21, Theorem 13(5) to Theorem 13(12)], and is a resta tement of it.
Proposition 5.1.1 predicts that ideal IofZ/bracketleftbig
ζq/bracketrightbig
generated by L(E,χ) factorises into a product of prime
ideals whose norms are factors of BSD( E/K)/BSD(E), and there are only ﬁnitely many of these. The
resulting product ideal Iis necessarily invariant under complex conjugation, which narrows d own the pos-
sibilities further. The exact prime factorisation of I, and hence of L(E,χ), can be determined from the
Gal/parenleftbig
K/Q/parenrightbig
-module structure of X(E/K) [BC21, Remark 7.4], but this will not be discussed here.
Assuming that Ihas been computed as an abstract ideal of Z/bracketleftbig
ζq/bracketrightbig
, any generator of Iis only equal to the
actual value of L(E,χ) up to a unit u∈Z/bracketleftbig
ζq/bracketrightbig
. Proposition 5.1.2 reﬁnes this prediction slightly by adding a
condition on the norm of L(E,χ)·ζ, which determines the actual value of L(E,χ) up to a unit u∈Z/bracketleftbig
ζq/bracketrightbig+.
In the special case of q= 3, this is still ambiguous up to a sign, since the units of Z[ζ3]+=Zare±1.
Corollary 3.7 comes into the picture by pinning down the sign in terms of #E/parenleftbig
Fp/parenrightbig
.
Corollary 5.2. LetEbe an elliptic curve of conductor N, and letχbe a cubic character of odd prime
conductorp∤Nsuch that 3∤c0(E)BSD(E)#E/parenleftbig
Fp/parenrightbig
. Assume that c1(E) = 1, and that L(E) = BSD(E)
andL(E/K) = BSD(E/K). Then
L(E,χ) =u·χ(N)/radicalbig
BSD(E/K)/radicalbig
BSD(E),
for some sign u=±1, chosen such that
u≡ −#E/parenleftbig
Fp/parenrightbig/radicalbig
BSD(E)3
/radicalbig
BSD(E/K)mod 3.
This follows immediately from Corollary 3.7 and Proposition 5.1. Corollary 5.2 clariﬁes much of the
phenomena observed by Dokchitser–Evans–Wiersema [DEW21, Exa mple 45], where they gave many pairs
of examples of arithmetically similar elliptic curves E1andE2withL(E1,χ)/\e}atio\slash=L(E2,χ) for a few cubic
charactersχ, in the sense that L(E1,χ)/\e}atio\slash=L(E2,χ) precisely because # E1/parenleftbig
Fp/parenrightbig
/\e}atio\slash≡#E2/parenleftbig
Fp/parenrightbig
mod 3.
11Example 5.3. LetE1andE2be the elliptic curves 1356d1 and 1356f1 respectively, and let χbe the cubic
character of conductor 7 such that χ(3) =ζ2
3. Then c 0(Ei) = BSD(Ei) = BSD/parenleftbig
Ei/K/parenrightbig
= 1 fori= 1,2, so
Proposition 5.1 implies that L(Ei,χ) =±χ(1356) = ±ζ2
3, but it was a priori unclear why L(E1,χ) =ζ2
3and
L(E2,χ) =−ζ2
3. Corollary 5.2 explains this by requiring that this sign agrees with −#Ei(F7) modulo 3,
and in this case # E1(F7) = 11 and # E2(F7) = 7, which are distinct modulo 3.
Theyprovidedmanyotherexamplessatisfyingc 0(E) = BSD(E) = BSD(E/K) = 1with diﬀerent L(E,χ)
for a few diﬀerent cubic characters χ, and they can all be explained similarly. For reference and compariso n,
the values of L(E,χ) for the above character and of # E(F7) are tabulated as follows.
E1356d1 1356f1 3264r1 3264s1 3540a1 3540b1 4800i1 4800bj1 4800bm1
L(E,χ)ζ2
3−ζ2
3−ζ2
3ζ2
3−ζ2
3ζ2
3−ζ2
3−ζ2
3ζ2
3
#E(F7)11 7 10 8 7 11 7 7 11
Whenq/\e}atio\slash= 3 but BSD( E) = BSD(E/K), Proposition 5.1 says that L(E,χ) is a unit in Z/bracketleftbig
ζq/bracketrightbig
, and
Corollary 3.7 places an explicit congruence on this unit in terms of # E/parenleftbig
Fp/parenrightbig
.
Corollary 5.4. LetEbe an elliptic curve of conductor N, and letχbe a character of odd prime conductor
p∤Nand odd prime order q∤c0(E)BSD(E)#E/parenleftbig
Fp/parenrightbig
such that BSD(E) = BSD(E/K). Assume that
c1(E) = 1, and that L(E) = BSD(E)andL(E/K) = BSD(E/K). Then L(E,χ) =ufor some unit
u∈Z/bracketleftbig
ζq/bracketrightbig
, chosen such that u≡ −#E/parenleftbig
Fp/parenrightbig
BSD(E) mod/angbracketleftbig
1−ζq/angbracketrightbig
.
Again, this follows immediately from Corollary 3.7 and Proposition 5.1. Co rollary 5.4 partially explains
the remaining phenomena observed by Dokchitser–Evans–Wiersem a[DEW21, Example 44], where they gave
manypairsofexamplesofarithmeticallytrivialellipticcurves E1andE2withL(E1,χ)/\e}atio\slash=L(E2,χ)forquintic
charactersχ, in the sense that L(E1,χ)/\e}atio\slash=L(E2,χ) precisely because # E1/parenleftbig
Fp/parenrightbig
/\e}atio\slash≡#E2/parenleftbig
Fp/parenrightbig
mod/a\}bracketle{t1−ζ5/a\}bracketri}ht.
Example 5.5. LetE1andE2be the elliptic curves 307a1 and 307c1 respectively, and let χbe the quintic
character of conductor 11 such that χ(2) =ζ5. Then c 0(Ei) = BSD(Ei) = BSD/parenleftbig
Ei/K/parenrightbig
= 1 fori= 1,2, so
Proposition 5.1 implies that L(Ei,χ) is a unit, but it was a priori unclear why L(E1,χ) = 1 and L(E2,χ) =
ζ5u2, whereu:= 1+ζ4
5. Corollary 5.4 explains this by requiring that L(Ei,χ)≡ −#Ei(F11) mod/a\}bracketle{t1−ζ5/a\}bracketri}ht,
and in this case # E1(F11) = 9 and # E2(F11) = 16, which are distinct modulo 5.
They provided a few other examples satisfyingc 0(E) = BSD(E) = BSD(E/K) = 1 with diﬀerent L(E,χ)
forthis character,andtheycanallbeexplainedsimilarly. Forrefer enceandcomparison,thevaluesof L(E,χ)
for the above character and of # E(F11) are tabulated as follows.
E307a1 307c1 432g1 432h1 714b1 714h1 1187a1 1187b1 1216g1 1216k1
L(E,χ)1ζ5u2u2−ζ5u−11−ζ4
5u3ζ2
5u−1ζ5u−3−ζ3
5u2ζ4
5u−1
#E(F11)9 16 16 8 9 13 17 8 9 7
Whenq/\e}atio\slash= 3 and BSD( E)/\e}atio\slash= BSD(E/K), it is slightly awkward to rephrase Proposition 5.1 in a way that
is applicable by Corollary 3.7, so it is best illustrated with an example [DEW 21, Example 46].
Example 5.6. LetE1andE2be the elliptic curves 291d1 and 139a1 respectively, and let χbe the quintic
character of conductor 31 such that χ(3) =ζ3
5. Then c 0(Ei) = BSD(Ei) = 1, but BSD/parenleftbig
Ei/K/parenrightbig
= 112for
i= 1,2, so Proposition 5.1 implies that L(Ei,χ) generates an ideal of norm 112invariant under complex
conjugation. By considering the primes above 112inZ[ζ5], there are only two such ideals, abstractly
generated by λ1:= 3ζ3
5+ζ2
5+ 3ζ5≡2 mod/a\}bracketle{t1−ζ5/a\}bracketri}htandλ2:=ζ3
5+ 3ζ5+ 3≡2 mod/a\}bracketle{t1−ζ5/a\}bracketri}ht, and in
fact/angbracketleftbig
L(Ei,χ)/angbracketrightbig
=/a\}bracketle{tλi/a\}bracketri}ht. Assuming this, Corollary 3.7 then predicts that L(Ei,χ) =uiλifor some units
ui∈Z[ζ5] such that 2 ui≡ −#Ei(F31) mod/a\}bracketle{t1−ζ5/a\}bracketri}ht, and in this case # E1(F31) = 33≡3 mod 5 and
#E1(F31) = 23≡3 mod 5, so ui≡1 mod/a\}bracketle{t1−ζ5/a\}bracketri}ht. In fact,u1=ζ4
5andu2=ζ5−ζ5+1.
They have a few other examples with this character, and in each cas e the unit can be predicted modulo
/a\}bracketle{t1−ζ5/a\}bracketri}htin the same fashion, but they will be omitted here for brevity.
Remark 5.7. As this example highlights, in general it is possible for L(E1,χ)≡ L(E2,χ) mod/angbracketleftbig
1−ζq/angbracketrightbig
butL(E1,χ)/\e}atio\slash=L(E2,χ), even when c 0(Ei) = BSD(Ei) = 1. There are also examples for when Eihave the
same conductor and discriminant, and furthermore BSD/parenleftbig
Ei/K/parenrightbig
= 1, such as for the elliptic curves 544b1
and 544f1 and the quintic character χof conductor 11 given by χ(2) =ζ5, whereL(E1,χ) =−ζ3
5−ζ5and
L(E2,χ) =−2ζ3
5−3ζ2
5−2ζ5. This is the pair of elliptic curves with the smallest conductor satisfyin g the
aforementioned properties but L(E1,χ)/\e}atio\slash=L(E2,χ), and other examples do seem to be quite rare.
126 Residual densities of twisted L-values
For a ﬁxed elliptic curve Eof conductor N, a natural problem is to determine the asymptotic distribution
ofL(E,χ) asχvaries over characters of some ﬁxed prime order qbut arbitrarily high odd prime conductor
p∤N. However, for each such p, there areq−1 characters χof conductor pand orderq, giving rise to q−1
conjugates of L(E,χ), so a uniform choice of χfor eachphas to be made for any meaningful analysis. One
solution is to observe that the residue class of L(E,χ) modulo/angbracketleftbig
1−ζq/angbracketrightbig
is independent of the choice of χ, so
a simpler problem would be to determine the asymptotic distribution of these residue classes instead. As
in the introduction, let X<n
E,qbe the set of equivalence classes of characters of odd order qand odd prime
conductorp∤Nless thann, where two characters in X<n
E,qare equivalent if they have the same conductor.
Deﬁne the residual densities δE,qofL(E,χ) to be the natural densities of L(E,χ) modulo/angbracketleftbig
1−ζq/angbracketrightbig
, namely
δE,q(λ):= lim
n→∞#/braceleftBig
χ∈X<n
E,q/vextendsingle/vextendsingle/vextendsingleL(E,χ)≡λmod/angbracketleftbig
1−ζq/angbracketrightbig/bracerightBig
#X<n
E,q, λ∈Fq,
if such a limit exists. When q∤c0(E), this can be computed for each λ∈Fqdirectly using Corollary 3.7,
with the only subtlety being the possible cancellations between L(E) and #E/parenleftbig
Fp/parenrightbig
. In the generic scenario
when imρE,qis maximal, there is a clean description in terms of Legendre symbols.
Proposition 6.1. LetEbe an elliptic curve such that L(E,1)/\e}atio\slash= 0, and letq∤c0(E)be an odd prime.
1. Ifordq/parenleftbig
L(E)/parenrightbig
>0, thenδE,q(0) = 1andδE,q(λ) = 0for anyλ∈F×
q.
2. Ifordq/parenleftbig
L(E)/parenrightbig
≤0, then setm:= 1−ordq/parenleftbig
L(E)/parenrightbig
and
GE,qm:=/braceleftbig
M∈imρE,qm/vextendsingle/vextendsingledet(M)≡1 modq/bracerightbig
.
Then for any λ∈Fq,
δE,q(λ) =#/braceleftBig
M∈GE,qm/vextendsingle/vextendsingle/vextendsingle1+det(M)−tr(M)≡ −λL(E)−1modqm/bracerightBig
#GE,qm.
In particular, if ordq/parenleftbig
L(E)/parenrightbig
≤0andρE,qis surjective, then set
λE,q:=/parenleftBigg
λL(E)−1
q/parenrightBigg/parenleftBigg
λL(E)−1+4
q/parenrightBigg
.
Then for any λ∈Fq,
δE,q(λ) =

1
q−1ifλE,q= 1
q
q2−1ifλE,q= 0
1
q+1ifλE,q=−1.
Proof.By Corollary 3.7, δE,q(λ) is just the natural density of −L(E)#E/parenleftbig
Fp/parenrightbig
≡λmodq. If ord q/parenleftbig
L(E)/parenrightbig
>
0, then only λ= 0 gives a non-zero natural density, otherwise this is equivalent to 1+p−ap(E)≡ −λL(E)−1
modqm, noting that L(E)−1is well-deﬁned and non-zero modulo qmby deﬁnition. By Chebotarev’s density
theorem, this occurs with the proportion of matrices M∈GE,qwith det(M) =pand tr(M) = ap(E),
so the second statement follows. If ρE,qis surjective, then Theorem 4.4.1 yields m= 1, soδE,q(λ) is the
proportion of matrices M∈SL(q) such that tr( M)≡2−λL(E)−1modq. The ﬁnal statement then
follows by #SL( q) =(q−1)q(q+1) and by inspecting the trace in each conjugacy class of SL( q), noting
that tr(M) =x+x−1for somex∈Fq\{±1}precisely when x2−4 is a quadratic residue modulo q.
Remark 6.2. Without the assumption q∤c0(E), the same argument can be used to compute the residual
density of c 0(E)L(E,χ) instead, by adding a factor of c 0(E) to every instance of L(E) in the statement and
proof of Proposition 6.1. On the other hand, Proposition 3.5 predict s thatL(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig
under Stevens’s
conjecture, so both sides of the congruence are divisible by qand the statement becomes vacuous.
13Remark 6.3. Under standard arithmetic conjectures, Proposition 5.1 says tha tL(E,χ)·ζ∈Z/bracketleftbig
ζq/bracketrightbig
, so
Nm+
q/parenleftbig
L(E,χ)·ζ/parenrightbig
∈Z. Sincethenormismultiplicativeand ζ≡1 mod/angbracketleftbig
1−ζq/angbracketrightbig
, theasymptoticdistribution
of the residue class of Nm+
q/parenleftbig
L(E,χ)·ζ/parenrightbig
moduloqessentially boils down to computing δE,q.
Assuming the q-part of the Birch–Swinnerton-Dyer conjecture, Theorem 4.4.3 s ays ord q/parenleftbig
BSD(E)/parenrightbig
≥ −1,
so non-trivial δE,qare only visible when ord q/parenleftbig
BSD(E)/parenrightbig
= 0,−1. Once this is determined, computing δE,q
then reduces to identifying im ρE,qor imρE,q2, and then weighing the proportion of matrices with a certain
determinant and trace. To illustrate this in action, the next result d escribes the possible ordered triples/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
of residual densities, which is only made possible thanks to the classiﬁ cation of
3-adic Galois images by Rouse–Sutherland–Zureick-Brown [RSZB22, Corollary 1.3.1 and Corollary 12.3.3].
Theorem 6.4. LetEbe an elliptic curve such that 3∤c0(E)andL(E,1)/\e}atio\slash= 0. Assume that ord3/parenleftbig
L(E)/parenrightbig
=
ord3/parenleftbig
BSD(E)/parenrightbig
. Then precisely one of the following holds.
1. Iford3/parenleftbig
BSD(E)/parenrightbig
>0, thenδE,3(0) = 1andδE,3(1) =δE,3(2) = 0.
2. Iford3/parenleftbig
BSD(E)/parenrightbig
= 0and3|#tor(E), thenδE,3(0) = 1andδE,3(1) =δE,3(2) = 0.
3. Iford3/parenleftbig
BSD(E)/parenrightbig
= 0and3∤#tor(E), then/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
is given in Table 1.
4. Iford3/parenleftbig
BSD(E)/parenrightbig
=−1, then/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
is given in Table 2.
In particular,/parenleftbig
δE,3(0),δE,3(1),δE,3(2)/parenrightbig
only depends on BSD(E)and onimρE,9, and can only be one of
(1,0,0),/parenleftbig3
8,3
8,1
4/parenrightbig
,/parenleftbig3
8,1
4,3
8/parenrightbig
,/parenleftbig1
2,1
2,0/parenrightbig
,/parenleftbig1
2,0,1
2/parenrightbig
,/parenleftbig1
8,3
4,1
8/parenrightbig
,
/parenleftbig1
8,1
8,3
4/parenrightbig
,/parenleftbig1
4,1
2,1
4/parenrightbig
,/parenleftbig1
4,1
4,1
2/parenrightbig
,/parenleftbig5
9,2
9,2
9/parenrightbig
,/parenleftbig1
3,2
3,0/parenrightbig
,/parenleftbig1
3,0,2
3/parenrightbig
.
Proof.The fact that there are only four possibilities is an immediate consequ ence ofTheorem 4.4. By Propo-
sition 6.1, the ﬁrst statement follows immediately under the assumpt ion that ord 3/parenleftbig
L(E)/parenrightbig
= ord3/parenleftbig
BSD(E)/parenrightbig
,
while the second statement follows from 3 |1+det(M)−tr(M) for allM∈imρE,3whenever 3 |#tor(E).
The ﬁnal statement follows from the ﬁrst four, so it remains to pro ve the third and fourth statements.
For the third statement, it suﬃces to consider G E,3= imρE,3∩SL(3), and there are only 5 possibilities
for imρE,3whenρE,3is not surjective, as tabulated in Table 1. If ρE,3is surjective, then δE,3(λ) is already
computed in the ﬁnal statement in Proposition 6.1, while the other 5 c ases are similar but easier computa-
tions. For instance, if im ρE,3is 3B.1.2, then G E,3is conjugate to the subgroup of unipotent upper triangular
matrices in SL(3), so counting the six matrices with each trace yields δE,3(0) = 1 and δE,3(1) =δE,3(2) = 0.
Note that when δE,3(1)/\e}atio\slash=δE,3(2), the residue of BSD( E) modulo 3 would swap δE,3(1) andδE,3(2), such as
in the case of SL(3) ⊆imρE,3whereδE,3(1) =1
4precisely if BSD( E)≡1 mod 3 and δE,3(1) =3
8otherwise.
For the fourth statement, it suﬃces to consider G E,9, and by the classiﬁcation this is the projection
onto GL(9) of 21 diﬀerent possible im ρE,3, as tabulated in Table 2. For instance, if im ρE,3is 3.8.0.1, then
GE,9is the preimage of the subgroup of SL(3) generated by/parenleftbig1 2
0 1/parenrightbig
and/parenleftbig1 2
0 2/parenrightbig
under the canonical projection
GL(9)։GL(3). This preimage in GL(9) consists of 243 matrices, of which 135 have trace 0 and 54 have
trace 1 and 2 each, so δE,3(0) =135
243=5
9andδE,3(1) =δE,3(2) =54
243=2
9. The other 20 cases are similar
but easier computations, noting again the residue of 3BSD( E) modulo 3 when δE,3(1)/\e}atio\slash=δE,3(2), such as in
the case of 27.648.18.1 where δE,3(1) = 0 precisely if 3BSD( E)≡2 mod 3 and δE,3(1) =2
3otherwise.
Remark 6.5. The ﬁrst case happens when 3 ∤#tor(E) but 3|Tam(E)#X(E), such as for the elliptic
curve 50b4 where BSD( E) = 3, and the second case happens when 9 |Tam(E)#X(E), such as for the
elliptic curve 84a1 where BSD( E) =1
2. It might be interesting to formulate more amenable criteria for
these, but it will not be discussed here. Note also that if im ρE,3is 3Cs.1.1, a much easier argument to prove
thatδE,3(0) = 1 and δE,3(1) =δE,3(2) = 0 is to observe that G E,3is trivial, so E/parenleftbig
Fp/parenrightbig
acquires full 3-torsion
for anyp≡1 mod 3, and thus L(E,χ)≡ −BSD(E)#E/parenleftbig
Fp/parenrightbig
≡0 mod 3 always.
Remark 6.6. Assuming the 3-part of the Birch–Swinnerton-Dyer conjecture h olds, Theorem 6.4 then de-
scribes the densities of the sign udetermined in Corollary 5.2, and hence the actual densities of L(E,χ).
147 Twisted L-values of Kisilevsky–Nam
The computation of residual densities was originally motivated by the statistical data in Kisilevsky–Nam
[KN22, Section 7]. They numerically computed millions of algebraic twiste d L-values by ﬁxing the elliptic
curve and varying the character, but considered an alternative n ormalisation given by
L+(E,χ):=

L(E,χ) if χ(N) = 1
L(E,χ)·/parenleftBig
1+χ(N)/parenrightBig
ifχ(N)/\e}atio\slash= 1,
in contrast to the normalisation factor ζin Proposition 5.1. Under the implicit assumption that L(E,χ)∈
Z/bracketleftbig
ζq/bracketrightbig
, they showedthat L+(E,χ)∈Z/bracketleftbig
ζq/bracketrightbig+[KN22, Proposition2.1], sothatNm+
q/parenleftbig
L+(E,χ)/parenrightbig
∈Z. Fixingsix
elliptic curves Eand ﬁve small orders q, they varied the character χovermillions of conductors p, empirically
determined the greatest common divisor gcdE,qof all the integers Nm+
q/parenleftbig
L+(E,χ)/parenrightbig
, and considered
/tildewideL+(E,χ):=Nm+
q/parenleftbig
L+(E,χ)/parenrightbig
gcdE,q.
Remark 7.1. The deﬁnition of /tildewideL+(E,χ) is equivalent to that of Aχdeﬁned by Kisilevsky–Nam when qis
odd and L( E,1)/\e}atio\slash= 0, sinceχ(N) =−1 never occurs and the global root number is always 1 [KN22, Section
2.2]. Their deﬁnition of L(E,χ) has an extra factor of 2, but this is cancelled out after division by g cdE,q.
Remark 7.2. In the interpretation of Proposition 5.1, the integer gcdE,qis predicted to arise from contri-
butions by the greatest common divisors of BSD( E/K)/BSD(E) ranging over various number ﬁelds Kof
degreeqoverQcoming from characters of order q, but this will not be discussed here.
As their normalisation diﬀers from that in Proposition 5.1 [KN22, Remar k 1], the resulting residual
densities are skewed. More precisely, deﬁne X<n
E,qas before, and deﬁne the analogous residual densities δ′
E,q
of/tildewideL+(E,χ) to be the natural densities of /tildewideL+(E,χ) moduloq, or in other words
δE,q(λ):= lim
n→∞#/braceleftBig
χ∈X<n
E,q/vextendsingle/vextendsingle/vextendsingle/tildewideL+(E,χ)≡λmodq/bracerightBig
#X<n
E,q, λ∈Fq,
if such a limit exists. In the simplest case where q= 3 and 3 ∤gcdE,3, there is no norm, and so
/tildewideL+(E,χ)≡/braceleftBigg
L(E,χ)gcdE,3ifχ(N) = 1
2L(E,χ)gcdE,3otherwise,
which becomes amenable to a similar computation to that of Propositio n 6.1 provided χ(N) is known. For
certain elliptic curves, χ(N) depends completely on # E/parenleftbig
Fp/parenrightbig
due to a shared action of Frobenius in GL(3).
Lemma 7.3. LetEbe an elliptic curve of conductor Nwith no rational 3-isogeny such that the splitting
ﬁeldFofX3−Nlies in the splitting ﬁeld Kof the3-division polynomial ψE,3, and letχbe a cubic character
of odd prime conductor p∤N. ThenimρE,3= GL(3) andGal/parenleftbig
K/Q/parenrightbig∼=PGL(3). Furthermore, if pdoes not
split completely in K, then#E/parenleftbig
Fp/parenrightbig
≡2 mod 3 if and only if χ(N) = 1. Otherwise, if psplits completely
inK, then#E/parenleftbig
Fp/parenrightbig
/\e}atio\slash≡2 mod 3 andχ(N) = 1.
Proof.LetLbe the extension of Kobtained by adjoining the Y-coordinates of E[3]. By the assumption
thatEhas no rational 3-isogeny and the classiﬁcation of im ρE,3, ifρE,3were not surjective, then Gal/parenleftbig
L/Q/parenrightbig
is either 3Nn or 3Ns. Neither of this could occur, since by the assump tion thatF⊆K, there are inclusions
Q⊆Q(ζ3)⊆F⊆K⊆L,
so in particular Gal/parenleftbig
L/Q/parenrightbig
surjects onto Gal/parenleftbig
F/Q/parenrightbig∼=S3, which forces Gal/parenleftbig
L/Q/parenrightbig∼=GL(3). On the other
hand, Gal/parenleftbig
K/Q/parenrightbig
permutes the roots of the degree 4 polynomial ψE,3, so it must be the quotient group
PGL(3) ∼=S4. Its subgroup Gal/parenleftbig
K/Q(ζ3)/parenrightbig∼=A4surjects onto Gal/parenleftbig
F/Q(ζ3)/parenrightbig∼=Z/3Z, with kernel the
unique subgroup Gal/parenleftbig
K/F/parenrightbig∼=/parenleftbig
Z/2Z/parenrightbig2of index 4 consisting precisely of all elements of A4of order 1 or 2.
15Now Fr p∈Gal/parenleftbig
K/Q/parenrightbig
acts on the residue ﬁeld of a prime πofFabovepby
Frp(ζ3)≡ζp
3modπ,Frp/parenleftbig3√
N/parenrightbig
≡3√
Npmodπ.
Clearly Fr pﬁxesζ3, so that Fr p∈Gal/parenleftbig
K/Q(ζ3)/parenrightbig
. Claim that, when pdoes not split completely in K, the
condition Fr p∈Gal/parenleftbig
K/F/parenrightbig
is equivalent to # E/parenleftbig
Fp/parenrightbig
≡2 mod 3 and to χ(N) = 1. On one hand, this means
that Fr pﬁxes3√
N, or equivalently that3√
Np−1≡1 modp, which is precisely the condition that χ(N) = 1.
On the other hand, this also means that Fr2
p= 1 in Gal/parenleftbig
K/Q(ζ3)/parenrightbig
, which is equivalent to Fr phaving order
exactly 2 in Gal/parenleftbig
K/Q(ζ3)/parenrightbig
. By the Cayley–Hamilton theorem, these are precisely the trace 0 m atrices in
PGL(3), or equivalently the trace 0 matrices in GL(3), which proves the equivalence with a p(E) = 0. Ifp
splits completely in K, then Fr p= 1 in Gal/parenleftbig
K/Q(ζ3)/parenrightbig
, but these never have trace 0 in PGL(3) or GL(3).
Remark 7.4. The ﬁrst assumption is necessary, evident in the elliptic curve 50b1 w ithF⊆Kbut imρE,3
is 3B, where 7 does not split completely in Kbut #E(F7) = 10≡1 mod 3 and χ(50) =χ(50) = 1. The
second assumption is also necessary, evident in the elliptic curve 21a 1 with no rational 3-isogeny but F/\e}atio\slash⊆K,
where 13 does not split completely in Kbut #E(F13) = 16≡1 mod 3 and χ(21) =χ(21) = 1. For the ﬁnal
statement, checking that psplits completely in Fbut not inKis not suﬃcient to conclude, such as for the
elliptic curve 11a1, where # E(F19) = 20≡2 mod 3 and χ(11) =χ(11) = 1. If pdoes split completely in
K, then both # E/parenleftbig
Fp/parenrightbig
≡0 mod 3 and # E/parenleftbig
Fp/parenrightbig
≡1 mod 3 are possible, such as for the elliptic curve 11a1,
where #E(F337) = 360≡0 mod 3 and # E(F193) = 190≡1 mod 3. Finally, note that this argument only
works for cubic characters, as PGL( q) is almost simple for q>3 and admits few non-trivial surjections.
For elliptic curves satisfying this property, the residual density of /tildewideL+(E,χ) is easy to compute.
Proposition 7.5. LetEbe an elliptic curve of conductor Nwith no rational 3-isogeny such that 3∤c0(E)
and3∤gcdE,3, and the splitting ﬁeld FofX3−Nlies in the splitting ﬁeld Kof the3-division polynomial
ψE,3, and letχbe a cubic character of odd prime conductor p∤N. Then
/tildewideL+(E,χ)≡

0 mod 3 if#E/parenleftbig
Fp/parenrightbig
≡0 mod 3
2 mod 3 if#E/parenleftbig
Fp/parenrightbig
≡1 mod 3 andpsplits completely in K
1 mod 3 otherwise.
In particular,
δ′
E,3(0) =9
24, δ′
E,3(1) =15
24, δ′
E,3(2) =1
24.
Proof.By Corollary 3.7 and the assumptions that 3 ∤c0(E) and 3∤gcdE,3,
/tildewideL+(E,χ)≡/braceleftBigg
2#E/parenleftbig
Fp/parenrightbig
L(E)gcdE,3ifχ(N) = 1
#E/parenleftbig
Fp/parenrightbig
L(E)gcdE,3otherwise.
Clearly/tildewideL+(E,χ)≡0 mod 3 when # E/parenleftbig
Fp/parenrightbig
≡0 mod 3. By Lemma 7.3, χ(N) = 1 occurs either when
#E/parenleftbig
Fp/parenrightbig
≡1 mod 3 but psplits completely in Kor when # E/parenleftbig
Fp/parenrightbig
≡2 mod 3 but pdoes not split
completely in K, the only remaining case being when # E/parenleftbig
Fp/parenrightbig
≡1 mod 3 and χ(N)/\e}atio\slash= 1. The ﬁrst
statement then follows by substituting the residues of # E/parenleftbig
Fp/parenrightbig
modulo 3, and noting that gcdE,3cancels
out the factors in L(E) by deﬁnition. For the ﬁnal statement, the description of the gro ups in Lemma 7.3
implies that # E/parenleftbig
Fp/parenrightbig
≡λmod 3 occurs with the proportion of matrices M∈SL(3) with tr( M) = 2−λ, by
Chebotarev’s density theorem. If psplits completely in K, then Fr p= 1 in PGL(3), so Fr p=±1 in GL(3),
and in particular in SL(3), but the condition # E/parenleftbig
Fp/parenrightbig
≡1 mod 3 forces Fr p=−1, which has trace 1. The
ﬁnal statement then follows by counting matrices in SL(3) with a cer tain trace.
Remark 7.6. Elliptic curves with discriminant ∆ = ±Nnfor some 3 ∤nsatisfy this property, since3√
N
can then be expressed in terms of3√
∆ [Ser72, Section 5.3b]. This completely explains the numerical data
by Kisilevsky–Nam for the elliptic curve 11a1 where gcdE,3= 5 and the elliptic curves 15a1 and 17a1 where
gcdE,3= 4, all of which satisfy the assumptions of Proposition 7.5. The same method cannot explain
the density patterns when 3 |gcdE,3, such as for the remaining three elliptic curves 14a1, 19a1, and 37b 1
considered by Kisilevsky–Nam, since Corollary 3.7 is a priori not valid mo dulo 9, as noted in Remark 3.10.
16A Tables of Galois images
This section tabulates the mod-3 and 3-adic Galois images of elliptic cur vesEwith restricted 3-torsion up
to conjugacy, crucially used in Proposition 4.2 and Theorem 6.4. In bo th tables, the examples of elliptic
curves are chosen so that it has the smallest conductor possible sa tisfying 3 ∤c0(E) and L(E,1)/\e}atio\slash= 0, but in
general there are many elliptic curves with each prescribed mod-3 o r 3-adic Galois image.
Mod-3 Galois images of elliptic curves without 3-torsion
The possible mod-3 Galois images are well-known [Zyw15, Theorem 1.2, P roposition 1.14, and Proposition
1.16], and those of elliptic curves without 3-torsion are tabulated as follows. The subgroup generators are
taken from Sutherland [Sut16, Section 6.4], and are viewed as elemen ts of GL(3). The ﬁnal two columns give
examples of elliptic curveswith the given mod-3 Galois image with b= 1 andb= 2 respectively, where b∈F3
is the residue of BSD( E) modulo 3. The column labelled G E,3lists the elements of G E,3= imρE,3∩SL(3)
as deﬁned in Proposition 6.1, so the residual densities can be read oﬀ directly in the column labelled δE,3as
ordered triples/parenleftbig
δE,3(0),δE,3(−b),δE,3(b)/parenrightbig
, which is used in Theorem 6.4.
Table 1: mod-3 Galois images of elliptic curves without 3-torsion
imρE,3Generators of im ρE,3 GE,3 δE,3b= 1b= 2
GL(3)/parenleftbigg
2 0
0 1/parenrightbigg/parenleftbigg
2 1
2 0/parenrightbigg
SL(3)3
8,3
8,1
411a2 11a1
3B.1.2/parenleftbigg2 0
0 1/parenrightbigg/parenleftbigg1 1
0 1/parenrightbigg/parenleftbigg1 0
0 1/parenrightbigg/parenleftbigg1 1
0 1/parenrightbigg/parenleftbigg1 2
0 1/parenrightbigg
1,0,019a2 14a3
3B/parenleftbigg2 0
0 2/parenrightbigg/parenleftbigg1 0
0 2/parenrightbigg/parenleftbigg1 1
0 1/parenrightbigg/parenleftbigg
1 0
0 1/parenrightbigg/parenleftbigg
1 1
0 1/parenrightbigg/parenleftbigg
1 2
0 1/parenrightbigg
/parenleftbigg2 0
0 2/parenrightbigg/parenleftbigg2 1
0 2/parenrightbigg/parenleftbigg2 2
0 2/parenrightbigg 1
2,1
2,050b3 50b1
3Cs/parenleftbigg
2 0
0 2/parenrightbigg/parenleftbigg
1 0
0 2/parenrightbigg /parenleftbigg
1 0
0 1/parenrightbigg/parenleftbigg
2 0
0 2/parenrightbigg
1
2,1
2,0304e2 304b2
3Nn/parenleftbigg
1 0
0 2/parenrightbigg/parenleftbigg
2 1
2 2/parenrightbigg/parenleftbigg1 0
0 1/parenrightbigg/parenleftbigg1 1
1 2/parenrightbigg/parenleftbigg0 2
1 0/parenrightbigg/parenleftbigg2 1
1 1/parenrightbigg
/parenleftbigg2 0
0 2/parenrightbigg/parenleftbigg2 2
2 1/parenrightbigg/parenleftbigg0 1
2 0/parenrightbigg/parenleftbigg1 2
2 2/parenrightbigg1
8,1
8,3
4704e1 245b1
3Ns/parenleftbigg2 0
0 2/parenrightbigg/parenleftbigg0 2
1 0/parenrightbigg/parenleftbigg1 0
0 2/parenrightbigg/parenleftbigg1 0
0 1/parenrightbigg/parenleftbigg2 0
0 2/parenrightbigg/parenleftbigg0 2
1 0/parenrightbigg/parenleftbigg0 1
2 0/parenrightbigg
1
4,1
4,1
21690d1 338d1
The remaining two mod-3 Galois images 3B.1.1 and 3Cs.1.1 have 3-torsion , so computing the residual
densities require ﬁner information from their mod-9 Galois images.
3-adic Galois images of elliptic curves with 3-torsion
The possible 3-adic Galois images are classiﬁed [RSZB22, Corollary 1.3.1 a nd Corollary 12.3.3], and those
of elliptic curves with 3-torsion are tabulated as follows. The subgro up generators are taken from Rouse–
Sutherland–Zureick-Brown [RSZB22, Software Repository], and a re viewed as elements of GL(3m) if their
corresponding 3-adic Galois images are of the form 3m.i.g.n. The column labelled M E,3gives matrices
ME,3∈imρE,9such that 1 + det/parenleftbig
ME,3/parenrightbig
−tr/parenleftbig
ME,3/parenrightbig
= 3, which is used in Proposition 4.2. The ﬁnal two
columns give examples of elliptic curves with the given 3-adic Galois image withb= 1 andb= 2 respectively,
whereb∈F3is the residue of 3BSD( E) modulo 3. The column labelled #G E,9lists the cardinalities of G E,9
as deﬁned in Proposition 6.1 for reference, but the residual densit ies are calculated separately in the column
labelledδE,3as ordered triples/parenleftbig
δE,3(0),δE,3(−b),δE,3(b)/parenrightbig
, which is used in Theorem 6.4.
17Table 2: 3-adic Galois images of elliptic curves with 3-torsion
imρE,3imρE,3Generators of im ρE,3 ME,3#GE,9δE,3b= 1b= 2
3.8.0.13B.1.1/parenleftbigg
1 2
0 1/parenrightbigg/parenleftbigg
1 2
0 2/parenrightbigg/parenleftbigg
4 0
0 2/parenrightbigg
2435
9,2
9,2
920a2 20a1
3.24.0.13Cs.1.1/parenleftbigg2 0
0 1/parenrightbigg /parenleftbigg2 0
0 4/parenrightbigg
811,0,026a1 14a1
9.24.0.13B.1.1/parenleftbigg
7 5
0 8/parenrightbigg/parenleftbigg
1 8
0 4/parenrightbigg/parenleftbigg
4 0
0 2/parenrightbigg
811,0,0189c3702e3
9.24.0.23B.1.1/parenleftbigg7 3
0 8/parenrightbigg/parenleftbigg7 2
6 2/parenrightbigg/parenleftbigg4 0
0 2/parenrightbigg
811
3,2
3,0
9.72.0.13Cs.1.1/parenleftbigg5 6
3 1/parenrightbigg/parenleftbigg4 6
0 1/parenrightbigg/parenleftbigg5 0
0 1/parenrightbigg
N/A 271,0,054b1
9.72.0.23Cs.1.1/parenleftbigg
8 3
3 4/parenrightbigg/parenleftbigg
8 6
0 4/parenrightbigg/parenleftbigg
1 3
0 1/parenrightbigg/parenleftbigg
8 0
0 4/parenrightbigg
271,0,054a1
9.72.0.33Cs.1.1/parenleftbigg8 3
3 4/parenrightbigg/parenleftbigg5 0
0 7/parenrightbigg/parenleftbigg2 0
0 4/parenrightbigg
271,0,019a17094c1
9.72.0.43Cs.1.1/parenleftbigg
2 3
6 7/parenrightbigg/parenleftbigg
1 6
6 1/parenrightbigg/parenleftbigg
4 3
6 4/parenrightbigg/parenleftbigg
5 0
0 4/parenrightbigg
271,0,0
9.72.0.53B.1.1/parenleftbigg1 2
0 8/parenrightbigg/parenleftbigg1 7
0 4/parenrightbigg
N/A 271,0,054b3
9.72.0.63B.1.1/parenleftbigg1 5
0 8/parenrightbigg/parenleftbigg4 1
0 8/parenrightbigg/parenleftbigg4 0
0 8/parenrightbigg
271,0,0
9.72.0.73B.1.1/parenleftbigg
4 4
0 5/parenrightbigg/parenleftbigg
1 0
0 8/parenrightbigg/parenleftbigg
4 0
0 5/parenrightbigg
271,0,0
9.72.0.83B.1.1/parenleftbigg7 7
6 4/parenrightbigg/parenleftbigg7 7
6 2/parenrightbigg/parenleftbigg1 2
3 1/parenrightbigg
271
3,2
3,0
9.72.0.93B.1.1/parenleftbigg
4 2
3 5/parenrightbigg/parenleftbigg
1 3
0 1/parenrightbigg/parenleftbigg
7 2
3 1/parenrightbigg/parenleftbigg
4 1
0 5/parenrightbigg
271
3,2
3,0
9.72.0.103B.1.1/parenleftbigg1 5
6 5/parenrightbigg/parenleftbigg1 0
0 8/parenrightbigg/parenleftbigg4 0
0 8/parenrightbigg
271
3,2
3,0486c1
27.72.0.13B.1.1/parenleftbigg
7 23
0 5/parenrightbigg/parenleftbigg
1 8
9 16/parenrightbigg/parenleftbigg
4 0
0 2/parenrightbigg
811,0,0
27.648.13.253B.1.1/parenleftbigg16 4
0 16/parenrightbigg/parenleftbigg1 17
0 26/parenrightbigg/parenleftbigg4 0
0 5/parenrightbigg
271,0,0N/A N/A
27.648.18.13B.1.1/parenleftbigg16 15
9 25/parenrightbigg/parenleftbigg10 16
9 17/parenrightbigg/parenleftbigg7 22
6 4/parenrightbigg/parenleftbigg4 1
0 5/parenrightbigg
271
3,2
3,0108a1 36a1
27.1944.55.313Cs.1.1/parenleftbigg
2 18
12 25/parenrightbigg/parenleftbigg
16 18
21 16/parenrightbigg/parenleftbigg
5 0
0 4/parenrightbigg
91,0,0N/A N/A
27.1944.55.373Cs.1.1/parenleftbigg17 6
21 10/parenrightbigg/parenleftbigg2 3
3 25/parenrightbigg/parenleftbigg5 0
3 4/parenrightbigg
91,0,027a1 N/A
27.1944.55.433B.1.1/parenleftbigg
19 10
18 8/parenrightbigg/parenleftbigg
4 11
3 16/parenrightbigg/parenleftbigg
4 4
0 5/parenrightbigg
91
3,2
3,0243b1 N/A
27.1944.55.443B.1.1/parenleftbigg10 23
3 13/parenrightbigg/parenleftbigg13 13
0 14/parenrightbigg/parenleftbigg4 4
0 5/parenrightbigg
91
3,2
3,0N/A N/A
Remark A.1. Note that many of the 3-adic Galois images seemingly do not represen t any elliptic curves
withb/\e}atio\slash= 0, in the sense that a search through the LMFDB [Col] yields no exa mples satisfying 3 ∤c0(E)
and L(E,1)/\e}atio\slash= 0, but current results a priori do not rule out their existence. To rule out examples for a
speciﬁc 3-adic Galois image, one could consider the explicit family of Weie rstrass equations parameterised by
the associated modular curve, and then investigate the divisibility of Tamagawa numbers as in Lemma 4.1.
Such is the case for the last six 3-adic Galois images arising from elliptic c urves with complex multiplication,
where their associated modular curves have eﬀectively computable ﬁnite sets of rational points.
18References
[BC21] David Burns and Daniel Macias Castillo. On reﬁned conjecture s of Birch and Swinnerton-Dyer type
for Hasse–Weil–Artin L-series, 2021.
[BD07] Thanasis Bouganis and Vladimir Dokchitser. Algebraicity of L-values for elliptic curves in a false
Tate curve tower. Mathematical Proceedings of the Cambridge Philosophical S ociety, 142(2):193–204,
2007.
[Bon11] C´ edricBonnaf´ e. Representations of SL2(Fq), volume13of Algebra and Applications . Springer-Verlag
London, Ltd., London, 2011.
[BR22] Alexander Barrios and Manami Roy. Local data of rational e lliptic curves with nontrivial torsion.
Paciﬁc Journal of Mathematics , 318(1):1–42, 2022.
[Col] The LMFDB Collaboration. The L-functions and modular forms da tabase.
[Cre92] John Cremona. Algorithms for modular elliptic curves . Cambridge University Press, Cambridge,
1992.
[DEW21] Vladimir Dokchitser, Robert Evans, and Hanneke Wiersema. On a BSD-type formula for L-values
ofArtintwistsofellipticcurves. Journal f¨ ur die Reine und Angewandte Mathematik. [Crelle’ s Journal] ,
773:199–230, 2021.
[Edi91] Bas Edixhoven. On the Manin constants of modular elliptic curv es. InArithmetic algebraic geometry
(Texel, 1989) , volume 89 of Progr. Math. , pages 25–39. Birkh¨ auser Boston, Boston, MA, 1991.
[GZ86] Benedict Gross and Don Zagier. Heegner points and derivativ es ofL-series.Inventiones Mathemat-
icae, 84(2):225–320, 1986.
[KN22] Hershy Kisilevsky and Jungbae Nam. Small algebraic central v alues of twists of elliptic L-functions,
2022.
[Kol88] Victor Kolyvagin. Finiteness of E(Q) andX(E,Q) for a subclass of Weil curves. Izvestiya Akademii
Nauk SSSR. Seriya Matematicheskaya , 52(3):522–540, 670–671, 1988.
[Lor11] Dino Lorenzini. Torsion and Tamagawa numbers. Universit´ e de Grenoble. Annales de l’Institut
Fourier, 61(5):1995–2037, 2011.
[Man72] Ju. I. Manin. Parabolic points and zeta functions of modular curves.Izvestiya Akademii Nauk
SSSR. Seriya Matematicheskaya , 36:19–66, 1972.
[Mel23] Mentzelos Melistas. A divisibility related to the Birch and Swinner ton-Dyer conjecture. Journal of
Number Theory , 245:150–168, 2023.
[RSZB22] Jeremy Rouse, Andrew Sutherland, and David Zureick-Br own.ℓ-adic images of Galois for elliptic
curves over Q(and an appendix with John Voight). Forum of Mathematics. Sigma , 10:Paper No. e62,
63, 2022.
[Ser72] Jean-Pierre Serre. Propri´ et´ es galoisiennes des points d’ordre ﬁni des courbes elliptiques. Inventiones
Mathematicae , 15(4):259–331, 1972.
[Shi71] Goro Shimura. Introduction to the arithmetic theory of automorphic funct ions, volume No. 1 of Kanˆ o
Memorial Lectures . Iwanami Shoten Publishers, Tokyo; Princeton University Press, Princeton, NJ,
1971. Publications of the Mathematical Society of Japan, No. 11.
[Ste89] Glenn Stevens. Stickelberger elements and modular parame trizations of elliptic curves. Inventiones
Mathematicae , 98(1):75–106, 1989.
[Sut16] Andrew Sutherland. Computing images of Galois representa tions attached to elliptic curves. Forum
of Mathematics. Sigma , 4:Paper No. e4, 79, 2016.
19[ˇC18] Kestutis ˇCesnaviˇ cius. The Manin constant in the semistable case. Compositio Mathematica ,
154(9):1889–1920, 2018.
[WW22] Hanneke Wiersema and Christian Wuthrich. Integrality of twis tedL-values of elliptic curves.
Documenta Mathematica , 27:2041–2066, 2022.
[Zyw15] David Zywina. On the possible images of the mod ell represent ations associated to elliptic curves
over Q, 2015.
20