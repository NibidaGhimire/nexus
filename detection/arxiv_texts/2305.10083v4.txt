arXiv:2305.10083v4  [math.PR]  11 May 2024Characterization of exchangeable measure-valued P´ olya u rn
sequences
Hristo Sariev∗1,2and Mladen Savov†2,1
1Institute of Mathematics and Informatics, Bulgarian Academy of S ciences, 8 Acad. Georgi Bonchev Str.,
Soﬁa 1113, Bulgaria
2Faculty of Mathematics and Informatics, Soﬁa University ”St. Klime nt Ohridski”, 5 James Bourchier
Blvd, Soﬁa 1164, Bulgaria
Abstract
Measure-valued P´ olya urn sequences (MVPS) are a generaliz ation of the observation processes gen-
erated by k-color P´ olya urn models, where the space of colors Xis a complete separable metric space
and the urn composition is a ﬁnite measure on X, in which case reinforcement reduces to a summation
of measures. In this paper, we prove a representation theore m for the reinforcement measures Rof all
exchangeable MVPSs, which leads to a characterization resu lt for their directing random measures ˜P.
In particular, when Xis countable or Ris dominated by the initial distribution ν, then any exchange-
able MVPS is a Dirichlet process mixture model over a family o f probability distributions with disjoint
supports. Furthermore, for all exchangeable MVPSs, the pre dictive distributions converge on a set of
probability one in total variation to ˜P. Importantly, we do not restrict our analysis to balanced MV PSs,
in the terminology of k-color urns, but rather show that the only non-balanced exch angeable MVPSs are
sequences of i.i.d. random variables.
Keywords: Exchangeability, Reinforced processes, P´ olya sequences, Direc ting random measures, Urn mod-
els
MSC2020 Classiﬁcation: 60G09, 60G25, 60G57, 62G99
1 Introduction
The classical two-color P´ olya urn model, which describes the evolut ion of an urn reinforced with one ball of
the observed color, has a fundamental role in the predictive const ruction of prior distributions for Bayesian
inference [ 7]. Suppose we have an urn that initially contains w0,w1>0 balls of colors 0 and 1, respectively.
Let us denote by Xn∈ {0,1}the color of the sampled ball at step n. ThenX1= 1 with probabilityw1
w0+w1
and, for every n= 1,2,...,
P(Xn+1= 1|X1,...,X n) =w1+/summationtextn
i=1Xi
w0+w1+na.s., (1.1)
∗h.sariev@math.bas.bg
†msavov@fmi.uni-soﬁa.bg
1which is the proportion of 1-balls in the urn at time n. It is well-known that the process ( Xn)n≥1is
exchangeable, that is, its law is invariant under ﬁnite permutations o f the indices, and satisﬁes, as n→ ∞,
1
nn/summationdisplay
i=1Xia.s.−→˜p,
where ˜phasaBetadistributionwith parameters( w0,w1), see, e.g., [ 16, p.8]; therefore, byde Finetti represen-
tation theorem for exchangeable sequences [ 1, Theorem 3.1], given ˜ p, theXnare conditionally independent
and identically distributed with probability of ”success” ˜ p. The converse is also true – any exchangeable
sequence of Bernoulli random variables with a Beta prior distribution has the predictive structure ( 1.1).
Therehasbeenmuchinterestingeneralizingthe construction( 1.1) toobtaingreatermodelﬂexibilityand,
at the same time, retain tractability of the process dynamics, see [ 7,13,16] and references therein. Various
extensions of the P´ olya urn scheme consider time-dependent, ra ndomized, or generalized reinforcement
mechanisms where colors other than those observed are added to the urn. More recently, [ 2,10,14] have
proposed an extended class of measure-valued P´ olya urn processes that are very general in nature, yet retain
characteristic features of urn processes and contain, as a spec ial case, most k-color urn models. The idea is
to consider the urn composition as a ﬁnite measure µon the space of colors X, in the sense that, for any
measurable set B⊆X, the quantity µ(B) records the total massof balls in the urn whose colors lie in B.
Reinforcement is then reduced to a summation of measures, so tha t the updated urn composition, given that
a ball with color xhas been observed, becomes µ+Rx, whereRis a (random) transition kernel on X, i.e. a
mapx/mapsto→RxfromXto the space of (random) measures on X. Assuming µ+Rxas the new urn composition,
the next draw proceeds in the same way as before, independent of all previous draws. Thus, a sequence of
ﬁnite measures ( µn)n≥0is ameasure-valued P´ olya urn process (MVPP) if it is a Markov process with the
aforementioned additive structure for a given ﬁnite reinforcemen t kernelR. In this case, Theorem 1 in [ 9]
implies the existence of a companion observation process ( Xn)n≥1such that X1∼µ0
µ0(X)=:µ′
0and, for each
n= 1,2,...,
P(Xn+1∈ · |µ0,X1,µ1,...,X n,µn) =µn(·)
µn(X)=:µ′
n(·) a.s.
In particular, when the reinforcement Ris non-random, the above becomes
P(Xn+1∈ · |X1,...,X n) =µ0(·)+/summationtextn
i=1RXi(·)
µ0(X)+/summationtextn
i=1RXi(X)a.s., (1.2)
which corresponds to the normalized urn composition at time nin the urn analogy. We call such a sequence
(Xn)n≥1ameasure-valued P´ olya urn sequence (MVPS) to distinguish it from the process ( µn)n≥0.
Analysis of MVPPs has been centered around two very distinct case s. In [9,17], the authors study the
so-called ”diagonal” model, where only the observed color is reinforc ed, i.e.Rx=w(x)·δx, withw(x)>0,
forx∈X, andδxis the unit mass at x. It follows under certain conditions that there exists a random
probability measure ˜PonXsuch that, as n→ ∞, (i) the normalized urn composition µ′
nconverges almost
surely (a.s.) in total variation to ˜P; and (ii)˜Pis concentrated on a subset of so-called ”dominant” colors.
On the other hand, [ 2,14,15] consider MVPPs for which there exists an underlying Markov chain w ith
kernelRthat satisﬁes some ”irreducibility”-type conditions (see [ 15, Section 1.2] for more details). Then,
under additional assumptions, they prove that µ′
nconverges a.s. weakly to a (deterministic) probability
measure on X.
In this work, we consider MVPPs that generate an exchangeable ob servation sequence ( Xn)n≥1via (1.2).
Standard results in exchangeability theory then guarantee that t he predictive distributions of ( Xn)n≥1
converge a.s. weakly to a random probability measure ˜PonX, called the directing random measure , whose
2distribution determines the law of the exchangeable process, see, e.g., [1, Section 3]. Therefore, the only
exchangeable ”irreducible” MVPSs are sequences of i.i.d. random var iables. Our goal is to characterize all
Rfor which ( Xn)n≥1is exchangeable, and in the process prove some new facts about ˜Pand hence about the
distribution of ( Xn)n≥1. This will help us assess the limitations of the whole class of exchangea ble MVPSs
when used as models for Bayesian analysis. Important to our under standing are the kernel based Dirichlet
sequences studied by Berti et al. [ 4], which are exchangeable MVPSs whose reinforcement Ris a regular
version of the conditional distribution for µ′
0given some sub- σ-algebra G,
Rx(·) =µ′
0(· | G)(x) for µ′
0-a.e.x, (1.3)
see Section 2for a rigorous deﬁnition. This assumption greatly simpliﬁes the subse quent analysis and allows
[4] to obtain a complete characterization of the directing random mea sure of any kernel based Dirichlet
sequence. In [ 4, p.18], theauthorstentativelyraisethe conjecturethat ( 1.3) holdstrueforeveryexchangeable
MVPS such that Rx(X) = 1, not excluding the possibility of counterexamples. Our main theo rem states
that a normalized version of condition ( 1.3) is indeed true for every member of the class of exchangeable
MVPSs, regardless of whether Rx(X) = 1. That such a representation exists is not obvious, and its proo f
requires the use of techniques that go beyond those typical of th e area and involve intensive use of abstract
measure-valuedobjects. We alsogiveadditional resultsthat do no t makeuse of ( 1.3). In particular, we prove
that when ( Xn)n≥1is not i.i.d., then Rx(X) is constant for almost every x, which implies that a ”diagonal”
MVPS will be exchangeable only if w(x) is constant, see also Example 2.2. In addition, we show that, for
ﬁxedx, the reinforcement Rxis either absolutely continuous or mutually singular with respect to ν. On the
other hand, using a reﬁned version of ( 1.3), we provide a complete description of all possible exchangeable
k-color urn models with positive time-homogeneous reinforcement, w hich to our knowledge has not been
done before.
The rest of the paper is structured as follows. In Section 2, we provide notation, state some general facts
about exchangeable sequences, and formally deﬁne our model. Res ults and examples are given in Section
3, with proofs postponed to Section 4. We state our representation theorem for general Rxin Section 3.1,
while in Section 3.2we study the case when Rxis dominated by µ′
0, which includes k-color urns, and in
Section3.3the case when Rxandµ′
0are mutually singular. A ﬁnal section concludes the paper.
2 The model
2.1 Preliminaries
Let (Ω,H,P) be a probability space, Xa complete separable metric space, and Xthe associated Borel σ-
algebra on X. Standard results imply that Xis countably generated. A transition kernel onXis a function
R:X×X →¯R+that satisﬁes ( i) the map x/mapsto→R(x,B)≡Rx(B) isX-measurable, for all B∈ X; and (ii)
B/mapsto→Rx(B) is a measure on X, for allx∈X. Equivalently, Rcan be represented as a measurable function
fromXto the space of measures on X. In addition, a transition kernel Ris said to be ﬁniteifRx(X)<∞,
for allx∈X,non null ifRx(X)>0, for all x∈X, and is called a probability kernel ifRx(X) = 1, for all
x∈X. Arandom (probability) measure is a transition (probability) kernel ˜P: Ω×X →¯R+from Ω to X.
Letνbe a probability measure on X,Ra transition probability kernel on X, andG ⊆ Xa sub-σ-algebra
onX. ThenRis said to be a regular version of the conditional distribution (r.c.d.) f orνgivenG, which for
emphasis we will denote by
Rx(·) =ν(· | G)(x) for ν-a.e.x,
3if (i)x/mapsto→Rx(B) isG-measurable, for all B∈ X; and (ii)/integraltext
ARx(B)ν(dx) =ν(A∩B), for all A∈ Gand
B∈ X. It follows from the assumptions on ( X,X) that a r.c.d. for νunderGexists and is unique up to a
ν-null set.
LetXbe anX-valued random variable with marginal distribution X∼PX. Depending on the context,
we would work with conditional distributions of the type P(· |X) orP(· |X=x), which are related by
/integraldisplay
{X∈A}P(B|X)(ω)P(dω) =/integraldisplay
AP(B|X=x)PX(dx),
for allA∈ XandB∈ H.
Recall that an X-valued sequence of random variables ( Xn)n≥1is exchangeable if
(X1,...,X n)d= (Xσ(1),...,X σ(n)),
for every n≥2 and all permutations σof{1,...,n}. In that case (see [ 1, Section 3]), there exists a random
probability measure ˜PonX, called the directing random measure of the sequence, such that, given ˜P, the
random variables X1,X2,...are conditionally independent and identically distributed (i.i.d.) with marg inal
distribution ˜P,
Xn|˜Pi.i.d.∼˜P
˜P∼Q
whereQis the (nonparametric) priordistribution of ˜P. Moreover, for every A∈ X,
P(Xn+1∈A|X1,...,X n)a.s.−→˜P(A). (2.1)
Since we take a predictive approach to model building, the following re sult from [ 8], which provides
necessary and suﬃcient conditions for the system of predictive dis tributions of any stochastic process to be
consistent with exchangeability, becomes our starting point of ana lysis.
Theorem 2.1 (Theorem3.1,Proposition3.2in[ 8]).A sequence of random variables (Xn)n≥1is exchangeable
if and only if, for each n= 0,1,2,...and every A,B∈ X,
P/parenleftbig
Xn+1∈A,Xn+2∈B|X1,...,X n/parenrightbig
=P/parenleftbig
Xn+1∈B,Xn+2∈A|X1,...,X n/parenrightbig
a.s.,(2.2)
and
P(Xn+1∈A|X1=x1,...,X n=xn) =P(Xn+1∈A|X1=xσ(1),...,X n=xσ(n)), (2.3)
for all permutations σof{1,...,n}and almost every (x1,...,x n)∈Xnwith respect to the marginal distri-
butionP(X1,...,Xn)of(X1,...,X n)onXn, where the case n= 0should be understood as an unconditional
statement.
2.2 Exchangeable MVPS
We will call any sequence ( Xn)n≥1ofX-valued random variables on (Ω ,H,P) ameasure-valued P´ olya urn
sequence with parameters θ,νandR, denoted MVPS( θ,ν,R), ifX1∼νand, for each n= 1,2,...,
P(Xn+1∈ · |X1,...,X n) =θν(·)+/summationtextn
i=1RXi(·)
θ+/summationtextn
i=1RXi(X)a.s., (2.4)
4whereRis a non null1ﬁnite transition kernel on X, called the replacement/reinforcement kernel of the
process, νis a probability measure on X, known as the base measure , andθ >0 is a positive constant. We
will say that the MVPS is balanced if there is, in addition, some m >0 such that Rx(X) =mforν-a.e.x,
which in the urn analogy means that we add the same total number of balls each time. Moreover, unlike
(1.2), we decompose the initial urn composition into two parameters, θandν, each one having a separate
eﬀect on the process (see, e.g., the construction in ( 2.7)).
Consider an exchangeable MVPS( θ,ν,R) with directing random measure ˜P. It follows from ( 2.1) and
(2.4) that the reinforcement Rdirectly inﬂuences the form of ˜P. On the other hand, by Theorem 2.1,Ritself
must satisfy certain conditions that make it admissible under exchan geability. Note, however, that equation
(2.3) is always true for MVPSs. Hence, information about Rcan only be retrieved from the invariance
property of the two-step-ahead predictive distributions in ( 2.2). In fact, [ 4, Theorem 7] show in their study
of kernel based Dirichlet sequences that, for a balanced MVPS to b e exchangeable, it is suﬃcient that
equation ( 2.2) holds for n= 0,1. Remarkably, when the MVPS is unbalanced, then ( 2.2) forn= 2 is also
needed (see the proof of Theorem 3.2). Using this information, we show that, when normalized, Rmust be
a r.c.d. for νgiven some sub- σ-algebra GofX,
Rx(·)
Rx(X)=ν(· | G)(x) for ν-a.e.x, (2.5)
and in the process we prove that exchangeable MVPSs are necessa rily balanced unless i.i.d. It turns out that
the representation ( 2.5) has major consequences for the shape and distribution of ˜P, including the fact that
the convergence in ( 2.1) is in total variation. We give one important example of an exchangea ble MVPS
next.
Example 2.2 (P´ olya sequence) .Let (Xn)n≥1be an MVPS with reinforcement kernel
Rx=δxforx∈X, (2.6)
i.e., we only reinforce the observed color with one additional ball. This p rocess, also known as a P´ olya
sequence, was ﬁrst studied by Blackwell and MacQueen [ 6] as an extension of the P´ olya urn scheme ( 1.1) to
general Polish spaces X. In [6], the authors prove that ( Xn)n≥1is exchangeable and its directing random
measure ˜Phas aDirichlet process distribution with parameters ( θ,ν), denoted DP( θ,ν). We recall that
˜P∼DP(θ,ν) if, for every ﬁnite partition B1,...,B n∈ XofX, the random vector ( ˜P(B1),...,˜P(Bn)) has
a Dirichlet distribution with parameters ( θν(B1),...,θν(Bn)),
/parenleftbig˜P(B1),...,˜P(Bn)/parenrightbig
∼Dir/parenleftbig
θν(B1),...,θν(Bn)/parenrightbig
.
An equivalent statement (see, e.g., [ 12, p.112]) is that ˜Pis equal in law to
˜P(·)w=∞/summationdisplay
j=1VjδZj(·), (2.7)
whereVj=Wj/producttextj−1
i=1(1−Wi) and (Wj)j≥1are i.i.d. with W1∼Beta(1,θ), and (Zj)j≥1are i.i.d.( ν),
independent of ( Vj)j≥1.
In this case, the reinforcement ( 2.6) has the anticipated structure ( 2.5), since
Rx(·) =ν(· | X)(x) for x∈X.
1From an application point of view, it may be interesting to se e whether exchangeability supports Rx(X) = 0 for all x∈Z
in some Z∈ Xsuch that 0 < ν(Z)<1, and to characterize Rxforx∈Zc. Importantly, by slightly modifying the proof of
Theorem 3.2, we can show in the non-i.i.d. case that Rx(X) is constant for ν-a.e.x∈Zc. See Remark 4.1for more information.
53 Main results
3.1 General case
We begin this section with a simple characterization result for i.i.d. MVPS s.
Proposition 3.1. An MVPS (θ,ν,R)is i.i.d. if and only if, for ν-a.e.x,
Rx(·)
Rx(X)=ν(·). (3.1)
The next theorem states that MVPSs that are exchangeable, but not i.i.d. are necessarily balanced.
This fact is essential since it implies that the predictive distributions ( 2.4) are a linear combination of
reinforcement kernels and leads via ( 2.2) to certain identities for R.
Theorem 3.2. An unbalanced exchangeable MVPS is necessarily i.i.d.
Remark3.3.IfanMVPS( θ,ν,R) is balanced, then Rx(X) =mforν-a.e.xandsome constant m >0. It then
follows from the particular form of the predictive distributions ( 2.4) that we can equivalently reformulate
the process as an MVPS with parameters ( ˜θ,ν,˜R), where ˜θ=θ
mand˜Rx=Rx
mwith˜Rx(X) = 1, for ν-a.e.
x. On the other hand, it is not hard to see that any i.i.d. MVPS( θ,ν,R) with unbalanced Ris also an i.i.d.
MVPS with parameters ( θ,ν,ν). Thus, when we consider i.i.d. MVPSs below, we will implicitly assume
that they are balanced. The above remarks are combined in the nex t corollary.
Corollary 3.4. An exchangeable MVPS (θ,ν,R)is also an exchangeable MVPS (˜θ,ν,˜R)for some probability
kernel˜Rand constant ˜θ.
We now consider the issue of representing Ras in (2.5). For completeness, we ﬁrst state the converse
result, which is found in [ 4].
Theorem 3.5 (Theorem 7 in [ 4]).Any balanced MVPS (θ,ν,R)whose reinforcement kernel Ris, up to
normalization, a r.c.d. for νgiven some sub- σ-algebraGofX, is exchangeable.
Remark 3.6.Although Berti et al. [ 4] focus only on the balanced case, it follows from Theorem 3.2that no
unbalanced MVPS, having replacement kernel as in Theorem 3.5, can be exchangeable unless G={∅,X}, in
which case the observation sequence is i.i.d.
Our main result studies the necessity of such a representation und er exchangeability. In addition, it
states that we may take Gto becountably generated (c.g.) under ν, in the sense that there exists C∈ Gsuch
thatν(C) = 1 and G ∩Cis c.g. In fact (see [ 3, p.649] and [ 5]),Gis c.g. under νif and only if there exists a
regular version µofν(· | G) which is a.e. proper, that is, µsatisﬁes, for some F∈ Gsuch that ν(F) = 1,
µx(A) =δx(A) for all A∈ Gandx∈F.
Theorem 3.7. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R). Then there exists a sub- σ-algebra GofX
such that Ris a r.c.d. for νunderG,
Rx(·)
Rx(X)=ν(· | G)(x)forν-a.e.x. (3.2)
Moreover, we can ﬁnd a sub- σ-algebraGofXsuch that (3.2)holds and Gis c.g. under ν.
6Remark 3.8.If (Xn)n≥1is an MVPS with reinforcement R(·) =ν(· | G) and thus exchangeable by Theorem
3.5, then there exists by Theorem 3.7a sub-σ-algebra G′which is c.g. under νandν(· | G) =ν(· | G′).
A major consequence of Theorems 3.2and3.7is that one can now characterize the directing random
measure ˜Pof any exchangeable MVPS using results developed in [ 4] under the stronger assumptions that
Ris balanced and of the form ( 3.2). In that case, Berti et al. [ 4, Theorem 10] show that the predictive
distributions ( 2.4) converge almost surely in total variation to ˜P. By virtue of Theorems 3.2and3.7, the
following result, which is based on Theorems 9 and 10 in [ 4], is now true for the entire class of exchangeable
MVPS.
Theorem 3.9. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R)with directing random measure ˜P. Then, as
n→ ∞,
sup
A∈X/vextendsingle/vextendsingleP(Xn+1∈A|X1,...,X n)−˜P(A)/vextendsingle/vextendsinglea.s.−→0.
Moreover, ˜Pis equal in law to
˜P(·)w=∞/summationdisplay
j=1VjRZj(·)
RZj(X),
where(Vj)j≥1and(Zj)j≥1are as in (2.7), using as parameters (θ
m,ν), andm >0is some constant such
thatm=Rx(X)forν-a.e.x.
3.2 Absolutely continuous case
In this section, we consider MVPSs such that, for ν-a.e.x, the replacement Rxisabsolutely continuous with
respect to the base measure ν, denoted Rx≪ν. Special cases include k-color urn models and MVPSs with
discreteν. The next theorem states that, under the assumption Rx≪ν, theσ-algebra Gin (3.2) is c.g.
underνw.r.t. a countable partition.
Theorem 3.10. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R). ThenRx≪νforν-a.e.xif and only if
there exists a countable partition D1,D2,...ofXinXsuch that
Rx(·)
Rx(X)=/summationdisplay
kν(· |Dk)· /BDDk(x)forν-a.e.x. (3.3)
Note that the existence of the countable partition in ( 3.3) does not depend on the enumerability of the
color space Xor on the form of the base measure ν. The implications of Theorem 3.10are illustrated in the
next Example 3.11, which describes k-color urn models with positive time-homogeneous reinforcement.
Example 3.11 (k-color urn) .When the space of colors X={x1,...,x k}is ﬁnite, then ν(·) =/summationtextk
i=1piδxi(·),
wherepi≥0 represents the initial fraction of balls with color xiin the urn. Furthermore, it is customary to
stateRin terms of a reinforcement matrix [ aij]1≤i,j≤k, whereaij≥0 denotes the number of balls of color
xjthat will be added to the urn after color xihas been observed.
If the observation process ( Xn)n≥1is exchangeable, then we have from ( 2.4) that
pi=P(X2=xi) =k/summationdisplay
j=1P(X1=xj)P(X2=xi|X1=xj) =k/summationdisplay
j=1pjθpi+aj,i
θ+/summationtextk
l=1aj,l;
thus, ifpi= 0 (i.e., there are initially no xiballs in the urn), then aji= 0 for all j:pj>0, so color xi
never appears in the urn. The same argument can be repeated for any color that is not initially present in
7the urn, so we may assume pi>0 for every i, without loss of generality. In that case, Rx≪νand (Xn)n≥1
satisﬁes the conditions of Theorem 3.10.
Assuming Rx(X) = 1, it follows from the particular form ( 3.3) ofRthat the reinforcement matrix of an
exchangeable urn scheme with a ﬁnite number of colors has a block-d iagonaldesign, i.e. Xcan be partitioned
into subsets of colors D1,...,D l, where a color reinforces and is reinforced only by the colors belong ing to
the same subset. Furthermore, the rows in each block are identica l and equal to the conditional probability
ofνgiven that a color from the same block has been observed. In other words, each Djcan be viewed as
representing diﬀerent nuances of the same color, so that the reinforcement ( i) will be identical for, say, light
or dark red; and ( ii) will be equal to the initial number of balls for each nuance of red, no rmalized by the
total number of red balls.
To illustrate the above points, let X={x1,x2,x3}and suppose that the urn has initial composition
(w1,w2,w3), withw1,w2,w3>0, so that ν(·) =/summationtext3
i=1wi
¯wδxi(·) where ¯ w=/summationtext3
i=1wi. Put ¯wi=/summationtext
j/ne}ationslash=iwj,
i= 1,2,3. Then any MVPS ( Xn)n≥1onXwith initial composition ( w1,w2,w3) is exchangeable if and only
if its associated reinforcement matrix Rhas one of the following forms, up to some multiplicative constants
m,m1,m2,m3>0,
x1x2x3

x1m1w1
¯wm1w2
¯wm1w3
¯w
x2m2w1
¯wm2w2
¯wm2w3
¯w
x3m3w1
¯wm3w2
¯wm3w3
¯w

mw1
¯w3mw2
¯w30
mw1
¯w3mw2
¯w30
0 0 m

mw1
¯w20mw3
¯w2
0m0
mw1
¯w20mw3
¯w2


m0 0
0mw2
¯w1mw3
¯w1
0mw2
¯w1mw3
¯w1

m0 0
0m0
0 0 m
Note that the ﬁrst matrix corresponds to the case of an i.i.d. seque nce of random variables with marginal
distribution ν, and the last one to the three-color P´ olya urn model with a Dirichlet prior distribution with
parameters (w1
m,w2
m,w3
m).
Example 3.12 (Discrete base measure) .The previous example can be extended to MVPSs on more general
spacesXwhen the base measure νis discrete, which is true especially if Xis countable. In this case, ν(·) =/summationtext
x∈X0p(x)δx(·) for some countable subset X0⊆Xand positive weights p(x)>0 such that/summationtext
x∈X0p(x) = 1.
If (Xn)n≥1is one such process, then it satisﬁes, by virtue of ( 2.4),
1 =/summationdisplay
x∈X0p(x) =P(X1∈X0) =P(X1∈X,X2∈X0) =/summationdisplay
x∈X0p(x)θ+Rx(X0)
θ+Rx(X);
thus,Rx(Xc
0) = 0, and so Rx≪νfor every x∈X. Theorem 3.10then implies the existence of a countable
partition on Xsuch thatRx
Rx(X)is a r.c.d for νgiven the σ-algebra generated by said partition.
The form of the replacement kernel in ( 3.3) has further implications on the directing random measure ˜P
of the exchangeable process ( Xn)n≥1. In particular, it follows from ( 2.1) that, for every A∈ X, on a set of
probability one,
˜P(A) = lim
n→∞P(Xn+1∈A|X1,...,X n) = lim
n→∞/summationdisplay
kθν(Dk)+/summationtextn
i=1RXi(X)· /BDDk(Xi)
θ+/summationtextn
i=1RXi(X)ν(A|Dk)
8= lim
n→∞/summationdisplay
kP(Xn+1∈Dk|X1,...,X n)ν(A|Dk) =/summationdisplay
k˜P(Dk)ν(A|Dk);
thus, as measures,
˜P(·)a.s.=/summationdisplay
k˜P(Dk)ν(· |Dk), (3.4)
asXis countably generated. The next theorem is a direct consequence of this fact and the distribution
results in Theorem 3.9(see also Example 15 in [ 4] and Section 4.1.2 in [ 2]).
Theorem 3.13. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R)with directing random measure ˜P. If
Rx≪νforν-a.e.x, then˜Phas the form (3.4)and, asn→ ∞,
sup
A∈X/vextendsingle/vextendsingleP(Xn+1∈A|X1,...Xn)−˜P(A)/vextendsingle/vextendsinglea.s.−→0.
Moreover, for every choice of indices k1,...,k j,
/parenleftbig˜P(Dk1),...,˜P(Dkj),˜P(∩j
i=1Dc
ki)/parenrightbig
∼Dir/parenleftBigθ
mν(Dk1),...,θ
mν(Dkj),θ
mν(∩j
i=1Dc
ki)/parenrightBig
,
using the notation in Example 2.2, wherem >0is such that Rx(X) =mforν-a.e.x.
The directing random measure ( 3.4) implies that the observations X1,X2,...will form clusters on the
level of the sets D1,D2,.... Let˜P∗(·) =/summationtext
k˜P(Dk)δk(·) andν∗(·) =/summationtext
kν(Dk)δk(·). By Theorem 3.13, any
exchangeable MVPS with absolutely continuous reinforcement is a Dir ichlet process mixture model
Xn|ξn,˜P∗ind.∼ν(· |Dξn)
ξn|˜P∗i.i.d.∼˜P∗
˜P∗∼DP/parenleftBigθ
m,ν∗/parenrightBig
using the notation in Example 2.2, where ( ξn)n≥1is a sequence of exchangeable random labels such that
ξn=kif and only if Xn∈Dk. We refer to [ 12, Section 3.4] for more details on Dirichlet process mixtures.
3.3 Singular case
In general, we have the decomposition of the reinforcement
Rx=R⊥
x+Ra
x,
for some ﬁnite measures R⊥
xandRa
xonXsuch that R⊥
xandνare mutually singular, denoted by R⊥
x⊥ν,
andRa
x≪ν. The next theorem shows that, for ﬁxed x, the replacement Rxof any exchangeable MVPS is
either mutually singular or absolutely continuous with respect to ν. In addition, the support of any mutually
singular component, R⊥
x, does not intersect the support of any absolutely continuous one ,Ra
y, implying a
complete separation of the two regimes.
Theorem 3.14. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R). Then there exists a set S ∈ Xsuch that
Rx=R⊥
xandR⊥
x(Sc) = 0,forν-a.e.xinS,
and
Rx=Ra
xandRa
x(S) = 0,forν-a.e.xinSc.
9Remark 3.15.It follows from Theorem 3.14that whenever ( Xn)n≥1isnoti.i.d., then for ν-a.e.x, the
support of Rx, saySx∈ Xsuch that Rx(Sx) = 1, has a ν-measure strictly smaller than one, ν(Sx)<1.
Indeed, this is obvious if we have an S ∈ Xas in Theorem 3.14such that 0 < ν(S)<1. If instead ν(S) = 0,
thenRx≪νforν-a.e.xandRxhas a ”block-diagonal” design by Theorem 3.10with at least two disjoint
blocks. On the other hand, if ν(S) = 1, then Rx⊥νand there exists Sx∈ Xsuch that Rx(Sx) = 1 and
ν(Sx) = 0, for ν-a.e.x.
The following simple example demonstrates one such case.
Example 3.16. Letνbe a diﬀuse probability measure, i.e. ν({x}) = 0, for x∈X. Fixθ= 1. Take S ∈ X
such that 0 < ν(S)<1. Let us deﬁne, for x∈X,
Rx(·) :=/braceleftbiggδx(·), x∈ S;
ν(· | Sc), x∈ Sc.
ThenRx⊥νandRx(Sc) = 0, for x∈ S, andRx≪νandRx(S) = 0, for x∈ Sc.
LetA,B∈ Xandx∈X. It is an easy exercise to check that
/integraldisplay
ARx(B)ν(dx) =/integraldisplay
BRx(A)ν(dx) and/integraldisplay
ARy(B)Rx(dy) =/integraldisplay
BRy(A)Rx(dy).
Therefore, by [ 4, Theorem 7], the balanced MVPS ( Xn)n≥1with parameters ( θ,ν,R) is exchangeable.
Deﬁne
G:=/braceleftbig
A∈ X:ν(A|Sc) = 0 or ν(A|Sc) = 1/bracerightbig
.
ThenGis aσ-algebra.
LetA∈ GandB∈ X. Ifν(A|Sc) = 0, then ν(A∩ Sc) = 0, so ν(A∩ Sc)ν(B|Sc) =ν(A∩B∩ Sc);
else, ifν(A|Sc) = 1, then ν(A∩Sc) =ν(Sc) andν(Ac∩Sc) = 0, from where ν(Ac∩B∩Sc) = 0, and so
ν(A∩Sc)ν(B|Sc) =ν(B∩Sc) =ν(A∩B∩Sc). As a result,
/integraldisplay
ARx(B)ν(dx) =/integraldisplay
A∩Sδx(B)ν(dx)+/integraldisplay
A∩Scν(B|Sc)ν(dx)
=ν(A∩B∩S)+ν(A∩Sc)ν(B|Sc) =ν(A∩B∩S)+ν(A∩B∩Sc) =ν(A∩B).
On the other hand, for all t∈[0,1] andB∈ X, the set {x∈X:Rx(B)≤t}is equal to one of Bc∩ S,
Bc∪Sc,Sor∅, all inG. Therefore, x/mapsto→Rx(B) isG-measurable and
Rx(·) =ν(· | G)(x) for ν-a.e.x.
The decomposition implied in Theorem 3.14can be used to analyze separately the singular and the
absolutely continuous parts of R. Concentrating on R⊥
x, let us assume that Rx⊥νfor allx∈X. By
Theorem 3.2, such an MVPS is necessarily balanced, say Rx(X) = 1 for ν-a.e.x. Moreover, νhas to be
diﬀuse; else, if ν({z})>0 for some z∈X, thenRx({z}) = 0, and using ( 2.4),
ν({z}) =/integraldisplay
Xθν({z})+Rx({z})
θ+Rx(X)ν(dx) =θ
θ+1ν({z}),
absurd. We show in Proposition 3.17below that if Rxis further discrete, then xis an atom of Rxforν-a.e.
x. Examples include the P´ olya sequence from Example 2.2with diﬀuse ν, and Example 2 in [ 4] where the
authors consider an MVPS with Rx=1
2(δx+δ−x). In addition, Proposition 3.17states for discrete Rthat
eitherRx=RyorRx⊥Ry, which is reminiscent of the ”block-diagonal” design in Section 3.2.
Proposition 3.17. Let(Xn)n≥1be an exchangeable MVPS (θ,ν,R). IfRx⊥νandRxis discrete, then
Rx({x})>0forν-a.e.x. Moreover,
forν-a.e.xandy,eitherRx=RyorRx⊥Ry.
104 Proofs
Proof of Proposition 3.1.Let (Xn)n≥1be an i.i.d. MVPS( θ,ν,R). TakeA,B∈ X. From (2.4),
P(X1∈A,X2∈B) =/integraldisplay
AP(X2∈B|X1=x)P(X1∈dx) =/integraldisplay
Aθν(B)+Rx(B)
θ+Rx(X)ν(dx).
On the other hand,
P(X1∈A,X2∈B) =P(X1∈A)P(X2∈B) =ν(A)ν(B) =/integraldisplay
Aν(B)ν(dx).
SinceAis arbitrary, thenθν(B)+Rx(B)
θ+Rx(X)=ν(B) forν-a.e.x, and soRx(B)
Rx(X)=ν(B) forν-a.e.x. AsXis
countably generated, we get, as measures,Rx(dy)
Rx(X)=ν(dy) forν-a.e.x.
Conversely, if Ris of the form ( 3.1), then, for any A∈ X,
P(Xn+1∈A|X1,...,X n) =θν(A)+/summationtextn
i=1RXi(X)ν(A)
θ+/summationtextn
i=1RXi(X)=ν(A) a.s. ,
implying that ( Xn)n≥1is i.i.d. with marginal distribution ν.
Proof of Theorem 3.2.Let (Xn)n≥1be an exchangeable MVPS( θ,ν,R). Deﬁne
f(x) :=Rx(X),forx∈X,andH:=/braceleftbig
(x,y)∈X2:f(x) =f(y)/bracerightbig
,
and letHxbe thex-section of H. It follows from exchangeability and the form of the predictive distr ibutions
(2.4) that, for every A,B∈ X,
/integraldisplay
(x,y)∈A×Bθν(dy)+Rx(dy)
θ+f(x)ν(dx) =P(X1∈A,X2∈B)
=P(X1∈B,X2∈A) =/integraldisplay
(x,y)∈A×Bθν(dx)+Ry(dx)
θ+f(y)ν(dy).(4.1)
We proceed by making some important observations from ( 4.1). LetC∈ Xbe such that ν(C) = 0.
Applying ( 4.1) toC×X, we getν(C) =/integraltext
XRx(C)
θ+f(x)ν(dx), soRx(C)
θ+f(x)= 0 forν-a.e.x, and hence
for anyC∈ X,ifν(C) = 0,thenRx(C) = 0 for ν-a.e.x. (4.2)
On the other hand, ( 4.1) implies the equivalence of the measures
θν(dy)+Rx(dy)
θ+f(x)ν(dx) =θν(dx)+Ry(dx)
θ+f(y)ν(dy);
thus,ν(dx) =/integraltext
y∈Xθν(dx)+Ry(dx)
θ+f(y)ν(dy), and by rearranging the terms,
/integraldisplay
y∈XRy(dx)
θ+f(y)ν(dy) =/integraldisplay
y∈Xf(y)
θ+f(y)ν(dy)ν(dx). (4.3)
Moreover, the following two measures, deﬁned as the indeﬁnite inte grals of ( θ+f(x))(θ+f(y)) with respect
toθν(dy)+Rx(dy)
θ+f(x)ν(dx) andθν(dx)+Ry(dx)
θ+f(y)ν(dy), are equal
(θ+f(y))/parenleftbig
θν(dy)+Rx(dy)/parenrightbig
ν(dx) = (θ+f(x))/parenleftbig
θν(dx)+Ry(dx)/parenrightbig
ν(dy),
11which after simpliﬁcation becomes
θf(y)ν(dx)ν(dy) +/parenleftbig
θ+f(y)/parenrightbig
Rx(dy)ν(dx) =θf(x)ν(dx)ν(dy) +/parenleftbig
θ+f(x)/parenrightbig
Ry(dx)ν(dy).(4.4)
In particular, restricting the above measures to Hwheref(x) =f(y), we obtain/BDH(x,y)Rx(dy)ν(dx) = /BDH(x,y)Ry(dx)ν(dy). (4.5)
We now consider the implications that the invariance of the two-step -ahead predictive distributions has
onR. LetA,B∈ X. SinceX1∼ν, it follows from ( 2.2) in Theorem 2.4that, for ν-a.e.x,
/integraldisplay
(y,z)∈A×Bθν(dz)+Rx(dz)+Ry(dz)
θ+f(x)+f(y)θν(dy)+Rx(dy)
θ+f(x)=P(X2∈A,X3∈B|X1=x)
=P(X2∈B,X3∈A|X1=x) =/integraldisplay
(y,z)∈A×Bθν(dy)+Rx(dy)+Rz(dy)
θ+f(x)+f(z)θν(dz)+Rx(dz)
θ+f(x).
SinceXis countably generated, we may combine the non-null sets and get, forν-a.e.x, the equivalence of
the measures
θν(dz)+Rx(dz)+Ry(dz)
(θ+f(x)+f(y))(θ+f(x))/parenleftbig
θν(dy)+Rx(dy)/parenrightbig
=θν(dy)+Rx(dy)+Rz(dy)
(θ+f(x)+f(z))(θ+f(x))/parenleftbig
θν(dz)+Rx(dz)/parenrightbig
.
Arguing as in ( 4.4), we get for ν-a.e.x
/parenleftbig
θ+f(x)+f(z)/parenrightbig/parenleftbig
θν(dz)+Rx(dz)+Ry(dz)/parenrightbig/parenleftbig
θν(dy)+Rx(dy)/parenrightbig
=/parenleftbig
θ+f(x)+f(y)/parenrightbig/parenleftbig
θν(dy)+Rx(dy)+Rz(dy)/parenrightbig/parenleftbig
θν(dz)+Rx(dz)/parenrightbig
,(4.6)
which after simpliﬁcation2becomes
θ2/braceleftBig
f(z)ν(dy)ν(dz)+Ry(dz)ν(dy)/bracerightBig
+θ/braceleftBig
f(z)Rx(dy)ν(dz)+f(z)Rx(dz)ν(dy)+/parenleftbig
f(x)+f(z)/parenrightbig
Ry(dz)ν(dy)+Ry(dz)Rx(dy)/bracerightBig
+/braceleftBig
f(z)Rx(dy)Rx(dz)+/parenleftbig
f(x)+f(z)/parenrightbig
Ry(dz)Rx(dy)/bracerightBig
=θ2/braceleftBig
f(y)ν(dy)ν(dz)+Rz(dy)ν(dz)/bracerightBig
+θ/braceleftBig
f(y)Rx(dz)ν(dy)+f(y)Rx(dy)ν(dz)+/parenleftbig
f(x)+f(y)/parenrightbig
Rz(dy)ν(dz)+Rz(dy)Rx(dz)/bracerightBig
+/braceleftBig
f(y)Rx(dy)Rx(dz)+/parenleftbig
f(x)+f(y)/parenrightbig
Rz(dy)Rx(dz)/bracerightBig
.
Using (4.4) w.r.t. ( y,z), we may collect θf(z)Ry(dz)ν(dy) and the two terms with θ2on the left-hand side
and cancel them with the sum of θf(y)Rz(dy)ν(dy) and the two terms with θ2on the right-hand side to
obtain
θf(z)Rx(dy)ν(dz)+θf(z)Rx(dz)ν(dy)+θf(x)Ry(dz)ν(dy)
+f(z)Rx(dy)Rx(dz)+/parenleftbig
θ+f(x)+f(z)/parenrightbig
Ry(dz)Rx(dy)
=θf(y)Rx(dz)ν(dy)+θf(y)Rx(dy)ν(dz)+θf(x)Rz(dy)ν(dz)
+f(y)Rx(dy)Rx(dz)+/parenleftbig
θ+f(x)+f(y)/parenrightbig
Rz(dy)Rx(dz);(4.7)
2Note that the measures in ( 4.6), and in the sequel, need not be ﬁnite, so extra care should be taken when cancelling common
terms. The measures are, however, σ-ﬁnite with respect to the product of the sets Fn:={x∈X:n−1≤f(x)≤n},n≥1;
hence, if one works with the measures in ( 4.6) restricted to ( x,y,z)∈Fn×Fn×Fn, all quantities from there on will be ﬁnite.
The general result then follows from monotone convergence, letting /BDFn↑1 asn→ ∞. For exposition reasons, we will omit
this procedure and work as if all quantities were ﬁnite to beg in with.
12thus, restricting the above measures to Hwheref(y) =f(z),/BDH(y,z)θf(x)Ry(dz)ν(dy)+ /BDH(y,z)/parenleftbig
θ+f(x)+f(y)/parenrightbig
Ry(dz)Rx(dy)
= /BDH(y,z)θf(x)Rz(dy)ν(dz)+ /BDH(y,z)/parenleftbig
θ+f(x)+f(y)/parenrightbig
Rz(dy)Rx(dz).
By (4.5), we have /BDH(y,z)Ry(dz)ν(dy) = /BDH(y,z)Rz(dy)ν(dz), and so, for ν-a.e.x,/BDH(y,z)/parenleftbig
θ+f(x)+f(y)/parenrightbig
Ry(dz)Rx(dy) = /BDH(y,z)/parenleftbig
θ+f(x)+f(y)/parenrightbig
Rz(dy)Rx(dz),
which after “dividing” by/parenleftbig
θ+f(x)+f(y)/parenrightbig
, i.e. using again the notion of indeﬁnite integrals, becomes/BDH(y,z)Ry(dz)Rx(dy) = /BDH(y,z)Rz(dy)Rx(dz). (4.8)
Next, considering equation ( 2.2) forn= 2, we get that, as measures,
P(X3∈dz,X4∈du|X1=x,X2=y) =P(X3∈du,X4∈dz|X1=x,X2=y), (4.9)
forP(X1,X2)-a.e. (x,y) inX2. It is an easy observation from ( 4.1) that (ν×ν)≪P(X1,X2); thus, (4.9) holds
true for ( ν×ν)-a.e. (x,y) inX2. Equation ( 4.9) implies the equivalence of the measures
θν(du)+Rx(du)+Ry(du)+Rz(du)
θ+f(x)+f(y)+f(z)θν(dz)+Rx(dz)+Ry(dz)
θ+f(x)+f(y)
=θν(dz)+Rx(dz)+Ry(dz)+Ru(dz)
θ+f(x)+f(y)+f(u)θν(du)+Rx(du)+Ry(du)
θ+f(x)+f(y),
so arguing as in ( 4.6),
/parenleftbig
θ+f(x)+f(y)+f(u)/parenrightbig/parenleftbig
θν(du)+Rx(du)+Ry(du)+Rz(du)/parenrightbig/parenleftbig
θν(dz)+Rx(dz)+Ry(dz)/parenrightbig
=/parenleftbig
θ+f(x)+f(y)+f(z)/parenrightbig/parenleftbig
θν(dz)+Rx(dz)+Ry(dz)+Ru(dz)/parenrightbig/parenleftbig
θν(du)+Rx(du)+Ry(du)/parenrightbig
.
After some simple algebra, we obtain
θ2/braceleftbig
f(u)ν(dz)ν(du)+Rz(du)ν(dz)/bracerightbig
+θ/braceleftbig
f(u)Rx(du)ν(dz)+f(u)Ry(du)ν(dz)+/parenleftbig
f(x)+f(y)+f(u)/parenrightbig
Rz(du)ν(dz)
+f(u)Rx(dz)ν(du)+f(u)Ry(dz)ν(du)+Rz(du)Rx(dz)+Rz(du)Ry(dz)/bracerightbig
+/braceleftbig
f(u)Rx(dz)Rx(du)+f(u)Ry(du)Rx(dz)+/parenleftbig
f(x)+f(y)+f(u)/parenrightbig
Rz(du)Rx(dz)
+f(u)Rx(du)Ry(dz)+f(u)Ry(dz)Ry(du)+/parenleftbig
f(x)+f(y)+f(u)/parenrightbig
Rz(du)Ry(dz)/bracerightbig
=θ2/braceleftbig
f(z)ν(dz)ν(du)+Ru(dz)ν(du)/bracerightbig
+θ/braceleftbig
f(z)Rx(dz)ν(du)+f(z)Ry(dz)ν(du)+/parenleftbig
f(x)+f(y)+f(z)/parenrightbig
Ru(dz)ν(du)
+f(z)Rx(du)ν(dz)+f(z)Ry(du)ν(dz)+Ru(dz)Rx(du)+Ru(dz)Ry(du)/bracerightbig
+/braceleftbig
f(z)Rx(dz)Rx(du)+f(z)Ry(dz)Rx(du)+/parenleftbig
f(x)+f(y)+f(z)/parenrightbig
Ru(dz)Rx(du)
+f(z)Rx(dz)Ry(du)+f(z)Ry(dz)Ry(du)+/parenleftbig
f(x)+f(y)+f(z)/parenrightbig
Ru(dz)Ry(du)/bracerightbig
,
which after further rearrangement becomes
θ/braceleftbig
θf(u)ν(dz)ν(du)+(θ+f(u))Rz(du)ν(dz)/bracerightbig
+/braceleftbig
θf(u)Rx(dz)ν(du)+θf(u)Rx(du)ν(dz)+θf(x)Rz(du)ν(dz)
+/parenleftbig
θ+f(x)+f(u)/parenrightbig
Rz(du)Rx(dz)+f(u)Rx(dz)Rx(du)/bracerightbig
+/braceleftbig
θf(u)Ry(dz)ν(du)+θf(u)Ry(du)ν(dz)+θf(y)Rz(du)ν(dz)
+/parenleftbig
θ+f(y)+f(u)/parenrightbig
Rz(du)Ry(dz)+f(u)Ry(dz)Ry(du)/bracerightbig
+/braceleftbig
f(x)Rz(du)Ry(dz)+f(u)Rx(dz)Ry(du)+f(y)Rz(du)Rx(dz)+f(u)Rx(du)Ry(dz)/bracerightbig
13=θ/braceleftbig
θf(z)ν(dz)ν(du)+(θ+f(z))Ru(dz)ν(du)/bracerightbig
+/braceleftbig
θf(z)Rx(du)ν(dz)+θf(z)Rx(dz)ν(du)+θf(x)Ru(dz)ν(du)
+/parenleftbig
θ+f(x)+f(z)/parenrightbig
Ru(dz)Rx(du)+f(z)Rx(dz)Rx(du)/bracerightbig
+/braceleftbig
θf(z)Ry(du)ν(dz)+θf(z)Ry(dz)ν(du)+θf(y)Ru(dz)ν(du)
+/parenleftbig
θ+f(y)+f(z)/parenrightbig
Ru(dz)Ry(du)+f(z)Ry(dz)Ry(du)/bracerightbig
+/braceleftbig
f(x)Ru(dz)Ry(du)+f(z)Rx(du)Ry(dz)+f(y)Ru(dz)Rx(du)+f(z)Rx(dz)Ry(du)/bracerightbig
.
It follows from ( 4.4) w.r.t. ( z,u), (4.7) w.r.t. ( x,z,u), and (4.7) w.r.t. ( y,z,u) that we may cancel the terms
in the ﬁrst, second and third brackets, respectively, to get, for (ν×ν)-a.e. (x,y) inX2,
f(x)Rz(du)Ry(dz)+f(u)Rx(dz)Ry(du)+f(y)Rz(du)Rx(dz)+f(u)Rx(du)Ry(dz)
=f(x)Ru(dz)Ry(du)+f(z)Rx(du)Ry(dz)+f(y)Ru(dz)Rx(du)+f(z)Rx(dz)Ry(du),
from where3
f(x)Rz(du)Ry(dz)+f(y)Rz(du)Rx(dz)+/parenleftbig
f(u)−f(z)/parenrightbig
Rx(dz)Ry(du)+/parenleftbig
f(u)−f(z)/parenrightbig
Rx(du)Ry(dz)
=f(x)Ry(du)Ru(dz)+f(y)Rx(du)Ru(dz).
(4.10)
Dividing both sides in ( 4.10) by (θ+f(x))(θ+f(y)) and integrating with respect to ν(dx) andν(dy) yields
/integraldisplay
X/integraldisplay
Xf(x)
(θ+f(x))(θ+f(y))Rz(du)Ry(dz)ν(dx)ν(dy)
+/integraldisplay
X/integraldisplay
Xf(y)
(θ+f(x))(θ+f(y))Rz(du)Rx(dz)ν(dx)ν(dy)
+/integraldisplay
X/integraldisplay
Xf(u)−f(z)
(θ+f(x))(θ+f(y))Rx(dz)Ry(du)ν(dx)ν(dy)
+/integraldisplay
X/integraldisplay
Xf(u)−f(z)
(θ+f(x))(θ+f(y))Rx(du)Ry(dz)ν(dx)ν(dy)
=/integraldisplay
X/integraldisplay
Xf(x)
(θ+f(x))(θ+f(y))Ry(du)Ru(dz)ν(dx)ν(dy)
+/integraldisplay
X/integraldisplay
Xf(y)
(θ+f(x))(θ+f(y))Rx(du)Ru(dz)ν(dx)ν(dy).
Now, using the identity in ( 4.3) w.r.t./integraltext
XRx(dz)
θ+f(x)ν(dx),/integraltext
XRx(du)
θ+f(x)ν(dx),/integraltext
XRy(dz)
θ+f(y)ν(dy) and/integraltext
XRy(du)
θ+f(y)ν(dy) on,
respectively, the second and third terms on the left, the forth te rm on the left and the second on the right,
the ﬁrst and forth terms on the left, the third term on the left and the ﬁrst on the right of the equation,
leads to
2/integraldisplay
X/integraldisplay
Xf(x)f(y)
(θ+f(x))(θ+f(y))Rz(du)ν(dx)ν(dy)ν(dz)
+2/integraldisplay
X/integraldisplay
Xf(x)f(y)/parenleftbig
f(u)−f(z)/parenrightbig
(θ+f(x))(θ+f(y))ν(dx)ν(dy)ν(dz)ν(du)
= 2/integraldisplay
X/integraldisplay
Xf(x)f(y)
(θ+f(x))(θ+f(y))Ru(dz)ν(dx)ν(dy)ν(du).
3Again we refer to the footnote on p. 12 on how to deal with signe d measures like those in ( 4.10) in order to avoid
indeterminate forms.
14Observe that the terms involving zanducan be pulled out of the integrals; thus, dividing both sides by
2/integraltext
X/integraltext
Xf(x)f(y)
(θ+f(x))(θ+f(y))ν(dx)ν(dy), we get
Rz(du)ν(dz)+/parenleftbig
f(u)−f(z)/parenrightbig
ν(dz)ν(du) =Ru(dz)ν(du).
On the other hand, we have Ru(dz)ν(du) =θ+f(u)
θ+f(z)Rz(du)ν(dz) +θf(u)−f(z)
θ+f(z)ν(dz)ν(du) from (4.4), so sub-
stituting above,
Rz(du)ν(dz)+/parenleftbig
f(u)−f(z)/parenrightbig
ν(dz)ν(du) =θ+f(u)
θ+f(z)Rz(du)ν(dz)+θf(u)−f(z)
θ+f(z)ν(dz)ν(du),
from where/parenleftbig
f(u)−f(z)/parenrightbig
Rz(du)ν(dz) =/parenleftbig
f(u)−f(z)/parenrightbig
f(z)ν(dz)ν(du).
Therefore, working on Hcwheref(z)/ne}ationslash=f(u), we obtain/BDHc(z,u)Rz(du)ν(dz) = /BDHc(z,u)f(z)ν(dz)ν(du). (4.11)
Going back to ( 4.7), we now focus on the triplets ( x,y,z) inX3for which f(x) =f(y) andf(x)/ne}ationslash=f(z),
so taking the indeﬁnite integral of the terms in ( 4.7) with respect to ν(dx), we get that, after some simple
algebra,/BDH(x,y) /BDHc(x,z)/braceleftBig
θ/parenleftbig
f(z)−f(x)/parenrightbig
Rx(dy)ν(dz)ν(dx) +θ/parenleftbig
f(z)−f(x)/parenrightbig
Rx(dz)ν(dy)ν(dx)
+/parenleftbig
f(z)−f(x)/parenrightbig
Rx(dy)Rx(dz)ν(dx)+θf(x)Ry(dz)ν(dy)ν(dx)
+/parenleftbig
θ+f(x)+f(z)/parenrightbig
Ry(dz)Rx(dy)ν(dx)/bracerightBig
= /BDH(x,y) /BDHc(x,z)/braceleftBig
θf(x)Rz(dy)ν(dz)ν(dx) +/parenleftbig
θ+2f(x)/parenrightbig
Rz(dy)Rx(dz)ν(dx)/bracerightBig
.(4.12)
On the set where f(y) =f(x)/ne}ationslash=f(z), equation ( 4.11) implies ( i)Rx(dz) =f(x)ν(dz) forν-a.e.x; (ii)
Ry(dz) =f(y)ν(dz) =f(x)ν(dz) forν-a.e.y; and (iii)Rz(dy) =f(z)ν(dy) forν-a.e.z. Moreover, by ( 4.2),
(ii) implies for ν-a.e.xthat (iv)Ry(dz) =f(x)ν(dz) forRx-a.e.y. Thus,/BDH(x,y) /BDHc(x,z)Rx(dz)ν(dy)ν(dx) = /BDH(x,y) /BDHc(x,z)f(x)ν(dx)ν(dy)ν(dz) by (i),/BDH(x,y) /BDHc(x,z)Rx(dy)Rx(dz)ν(dx) = /BDH(x,y) /BDHc(x,z)f(x)Rx(dy)ν(dz)ν(dx) by (i),/BDH(x,y) /BDHc(x,z)Ry(dz)ν(dy)ν(dx) = /BDH(x,y) /BDHc(x,z)f(x)ν(dx)ν(dy)ν(dz) by (ii),/BDH(x,y) /BDHc(x,z)Ry(dz)Rx(dy)ν(dx) = /BDH(x,y) /BDHc(x,z)f(x)Rx(dy)ν(dz)ν(dx) by (iv),/BDH(x,y) /BDHc(x,z)Rz(dy)ν(dz)ν(dx) = /BDH(x,y) /BDHc(x,z)f(z)ν(dx)ν(dy)ν(dz) by (iii),
and, by ( i) and (iii),/BDH(x,y) /BDHc(x,z)Rz(dy)Rx(dz)ν(dx) = /BDH(x,y) /BDHc(x,z)f(x)f(z)ν(dx)ν(dy)ν(dz).
Substituting for the above terms in ( 4.12), we obtain/BDH(x,y) /BDHc(x,z)/braceleftBig
θ/parenleftbig
f(z)−f(x)/parenrightbig
Rx(dy)ν(dx)ν(dz)+θf(x)/parenleftbig
f(z)−f(x)/parenrightbig
ν(dx)ν(dy)ν(dz)
+f(x)/parenleftbig
f(z)−f(x)/parenrightbig
Rx(dy)ν(dx)ν(dz) +θf(x)2ν(dx)ν(dy)ν(dz)
+f(x)/parenleftbig
θ+f(x)+f(z)/parenrightbig
Rx(dy)ν(dx)ν(dz)/bracerightBig
15= /BDH(x,y) /BDHc(x,z)/braceleftBig
θf(x)f(z)ν(dx)ν(dy)ν(dz) +f(x)f(z)/parenleftbig
θ+2f(x)/parenrightbig
ν(dx)ν(dy)ν(dz)/bracerightBig
,
which after simpliﬁcation turns into/BDH(x,y) /BDHc(x,z)/braceleftBig
f(z)/parenleftbig
θ+2f(x)/parenrightbig
Rx(dy)ν(dx)ν(dz)/bracerightBig
= /BDH(x,y) /BDHc(x,z)/braceleftBig
f(x)f(z)/parenleftbig
θ+2f(x)/parenrightbig
ν(dx)ν(dy)ν(dz)/bracerightBig
.(4.13)
Dividing by f(z)/parenleftbig
θ+2f(x)/parenrightbig
and integrating zout leaves/BDH(x,y)ν(Hc
x)Rx(dy)ν(dx) = /BDH(x,y)ν(Hc
x)f(x)ν(dx)ν(dy). (4.14)
Let us deﬁne
D∗:={x∈X:ν(Hc
x)>0}.
Suppose that ν(D∗)>0. Take y∈X. Iff(y) =f(x) for some x∈D∗, thenHc
y=Hc
x, andν(Hc
y) =
ν(Hc
x)>0; otherwise, if f(y)/ne}ationslash=f(x) for allx∈D∗, thenD∗⊆Hc
yandν(Hc
y)≥ν(D∗)>0. In either case,
y∈D∗, which implies that ν(D∗) = 1. As a result, we can divide both sides of ( 4.14) byν(Hc
x) to obtain/BDHx(y)Rx(dy)ν(dx) = /BDHx(y)f(x)ν(dx)ν(dy).
Summing this with ( 4.11), we get that, for ν-a.e.x,
Rx(dy) =f(x)ν(dy),
which implies from Proposition 3.1that (Xn)n≥1is i.i.d.
If instead ν(D∗) = 0, then ν(Hc
x) = 0 for ν-a.e.x. It follows for some ﬁxed x′withν(Hx′) = 1 that
f(x) =f(x′) for ν-a.e.x,
implying that the model is balanced. This concludes the proof of the t heorem.
Remark 4.1.The proof of Theorem 3.2largely remains the same even if we assume Rx(X) = 0 for all xin
someZ∈ Xsuch that 0 < ν(Z)<1. The only place of concern is in ”dividing” ( 4.13) byRx(X), so by
restricting ( 4.13) onZcwe get/BDH(x,y)ν(Hc
x∩Zc)Rx(dy)ν(dx) = /BDH(x,y)ν(Hc
x∩Zc)f(x)ν(dx)ν(dy).
Now, letting
D∗:={x∈X:ν(Hc
x∩Zc)>0},
we obtain under ν(D∗∩Zc)>0 that (Xn)n≥0is i.i.d., using the same logic as above. If, on the other hand,
ν(D∗∩Zc) = 0, then ν((D∗)c) =ν(Zc), since ( D∗)c⊆Zc, and so
(ν×ν)/parenleftbig
Hc∩(Zc×Zc)/parenrightbig
=/integraldisplay
Zcν(Hc
x∩Zc)ν(dx) =/integraldisplay
(D∗)cν(Hc
x∩Zc)ν(dx) = 0,
thus showing that Rx(X) =m >0 forν-a.e.xinZcand some m >0, when ( Xn)n≥1is not i.i.d.
16Proof of Theorem 3.7.If (Xn)n≥1is i.i.d., then Proposition 3.1implies (3.2) withG={∅,X}. Suppose that
(Xn)n≥1is exchangeable, but not i.i.d. It follows from Theorem 3.2that the model is balanced, so we may
assume, without loss of generality, that Rx(X) = 1, for x∈X; otherwise, we can normalize θandR(see
Remark 3.3) and proceed from there. In this case, ( 4.5) reduces to
Rx(dy)ν(dx) =Ry(dx)ν(dy), (4.15)
and (4.8) implies, taking the indeﬁnite integral of the terms with respect to ν(dx), that
Ry(dz)Rx(dy)ν(dx) =Rz(dy)Rx(dz)ν(dx). (4.16)
Applying ( 4.15) and (4.16) repeatedly, we obtain that
Ry(dz)Rx(dy)ν(dx) =Rz(dy)Rx(dz)ν(dx) =Rz(dy)Rz(dx)ν(dz)
=Rz(dx)Ry(dz)ν(dy) =Rx(dz)Ry(dx)ν(dy) =Rx(dz)Rx(dy)ν(dx).
AsXis countably generated, there exists C0∈ Xsuch that ν(C0) = 1 and, for all x∈C0,
Ry(dz)Rx(dy) =Rx(dz)Rx(dy). (4.17)
DeﬁneC1:={x∈C0:Rx(C0) = 1}andCn:={x∈Cn−1:Rx(Cn−1) = 1}for every n≥2. As
Rx(X) = 1, we get from ( 4.15) that
1 =/integraldisplay
C0Rx(X)ν(dx) =/integraldisplay
XRx(C0)ν(dx) = 1−/integraldisplay
X(1−Rx(C0))ν(dx) = 1−/integraldisplay
Cc
1(1−Rx(C0))ν(dx).
ButRx(C0)<1 forx∈Cc
1, soν(Cc
1) = 0, otherwise the term on the right-hand side of the equation bec omes
strictly less than 1. Proceeding by induction, we get ν(Cn) = 1 for all n≥1; thus, letting C∗=/intersectiontext∞
n=1Cn,
it holdsν(C∗) = 1 and Rx(Cn) = 1, for all x∈C∗andn≥1. As a result, for every x∈C∗, we have that
Rx(C∗) = 1 and, since C∗⊆C0, from (4.17),
Rx(dz) =Ry(dz) for Rx-a.e.y. (4.18)
Let us deﬁne
G:={A∈ X:Rx(A) =δx(A) for allx∈C∗}.
It is not hard to see that Gis aσ-algebra. Next, ﬁx t∈[0,1] andB∈ X. Denote
Et,B={x∈X:Rx(B)< t}.
Letx∈C∗. Ifx∈Et,B, thenRy(B) =Rx(B)< tforRx-a.e.yby (4.18), soRx(Et,B) = 1. If instead
x∈Ec
t,B, then again Ry(B) =Rx(B)≥tforRx-a.e.yby (4.18), and so Rx(Et,B) = 0. As a result,
Rx(Et,B) =δx(Et,B), which implies that Et,B∈ G; thus,x/mapsto→Rx(B) isG-measurable.
LetA∈ GandB∈ X. It follows from ( 4.15) andν(C∗) = 1 that
/integraldisplay
ARx(B)ν(dx) =/integraldisplay
BRx(A)ν(dx) =/integraldisplay
B∩C∗Rx(A)ν(dx) =/integraldisplay
Bδx(A)ν(dx) =ν(A∩B).
Therefore, Ris a regular version of ν(· | G). Moreover, by construction,
Rx(A) =δx(A) for all A∈ Gandx∈C∗;
thus,Ris a.e. proper and Gis c.g. under ν(see [3, p.649] and [ 5, Theorem 1]).
17Proof of Theorem 3.10.If (Xn)n≥1is i.i.d., then Proposition 3.1implies ( 3.3) with respect to the partition
{X,∅},andviceversa. Supposethat( Xn)n≥0isexchangeable,butnoti.i.d. Assume, w.l.o.g., that Rx(X) = 1
for allx∈X. IfRxis of the form ( 3.3), then it is obvious that Rx≪νforν-a.e.x.
Conversely, suppose that Rx≪νforν-a.e.x. ThenRx(dy)ν(dx)≪ν(dx)ν(dy), so there exists a jointly
measurable function r:X2→R+such that
Rx(dy)ν(dx) =r(x,y)ν(dx)ν(dy),
and, since Xis countably generated, as measures,
Rx(dy) =r(x,y)ν(dy) for ν-a.e.x. (4.19)
Denote by
D:=/braceleftbig
(x,y)∈X2:r(x,y)>0/bracerightbig
,
and, letting Dxbe thex-section of Dforx∈X, deﬁne
G:={x∈X:ν(Dx)>0}.
ThenRx(Dx) =/integraltext
Dxr(x,y)ν(dy) = 1 for ν-a.e.x. Moreover,
1 =/integraldisplay
XRx(Dx)ν(dx) =/integraldisplay
G/integraldisplay
Dxr(x,y)ν(dy)ν(dx) +/integraldisplay
Gc/integraldisplay
Dxr(x,y)ν(dy)ν(dx) =ν(G).
On the other hand, by ( 4.15), (4.16) and (4.17), we have the following identities
r(x,y)ν(dx)ν(dy) =r(y,x)ν(dx)ν(dy), (4.20)
r(x,y)r(y,z)ν(dy)ν(dz)) =r(x,z)r(z,y)ν(dy)ν(dz) for ν-a.e.x, (4.21)
r(x,y)r(y,z)ν(dx)ν(dy)ν(dz)) =r(x,y)r(x,z)ν(dx)ν(dy)ν(dz). (4.22)
In particular, equations ( 4.20) and (4.21) imply that/BDDx(y) /BDDx(z)r(x,y)ν(dx)ν(dy)ν(dz)(a)= /BDDx(y) /BDDx(z) /BDDy(z)r(x,y)ν(dx)ν(dy)ν(dz)
= /BDDx(y) /BDDx(z) /BDDy(z)r(x,y)r(y,z)
r(y,z)ν(dx)ν(dy)ν(dz)
= /BDDx(y) /BDDx(z) /BDDy(z)r(x,y)r(z,y)
r(y,z)ν(dx)ν(dy)ν(dz)
= /BDDx(y) /BDDx(z) /BDDy(z)r(x,z)ν(dx)ν(dy)ν(dz)
(b)= /BDDx(y) /BDDx(z)r(x,z)ν(dx)ν(dy)ν(dz), (4.23)
where (a) and (b) follow from the fact that, for ( ν×ν×ν)-a.e. (x,y,z) inX3, ify∈Dxandz∈Dx,
thenr(x,y)r(x,z)>0, and so r(x,y)r(y,z)>0 by (4.22), which implies that r(y,z)>0 and, as a result,/BDDx(y) /BDDx(z) = /BDDx(y) /BDDx(z) /BDDy(z).
LetA,B∈ X. Sinceν(G) = 1,
/integraldisplay
ARx(B)ν(dx) =/integraldisplay
A/integraldisplay
B
/BDDx(y)·r(x,y)ν(dy)ν(dx)
=/integraldisplay
A
/BDG(x)/parenleftbigg/integraldisplay
B
/BDDx(y)·r(x,y)1
ν(Dx)/parenleftBig/integraldisplay
X
/BDDx(z)ν(dz)/parenrightBig
ν(dy)/parenrightbigg
ν(dx)
18(a)=/integraldisplay
A
/BDG(x)/parenleftbigg/integraldisplay
B1
ν(Dx)
/BDDx(y)/parenleftBig/integraldisplay
X
/BDDx(z)·r(x,z)ν(dz)/parenrightBig
ν(dy)/parenrightbigg
ν(dx)
=/integraldisplay
A
/BDG(x)/parenleftbigg/integraldisplay
B1
ν(Dx)
/BDDx(y)ν(dy)/parenrightbigg
ν(dx)
=/integraldisplay
Aν(B|Dx)ν(dx), (4.24)
where (a) follows from ( 4.23).
Given (4.24), the proof of Theorem 3.10would be complete if we can ﬁnd a countable partition among
the setsDx. As we demonstrate next, this is possible, provided we intersect ea chDxwith some a.s. sets.
First, observe
1 =/integraldisplay
X/integraldisplay
XRy(X)Rx(dy)ν(dx) =/integraldisplay
X/integraldisplay
Dx/parenleftBig/integraldisplay
Dyr(y,z)ν(dz)/parenrightBig
r(x,y)ν(dy)ν(dx)
=/integraldisplay
X/integraldisplay
Dx/parenleftBig/integraldisplay
Dx∩Dyr(y,z)ν(dz)/parenrightBig
r(x,y)ν(dy)ν(dx), (4.25)
where the last equality follows, similarly to ( 4.23), from the fact that /BDDx(y) /BDDy(z) = /BDDx(y) /BDDx(z) /BDDy(z)
for (ν×ν×ν)-a.e. (x,y,z) inX3. Since/integraltext
Dxr(x,y)ν(dy) = 1 for ν-a.e.x, the integrand in ( 4.25) w.r.t.
ν(dx) is smaller or equal to 1, so that
/integraldisplay
Dxr(x,y)/parenleftBig/integraldisplay
Dx∩Dyr(y,z)ν(dz)/parenrightBig
ν(dx) = 1 for ν-a.e.x,
which itself implies that, for ν-a.e.yinDx,
/integraldisplay
Dx∩Dyr(y,z)ν(dz) = 1.
But/integraltext
Dyr(y,z)ν(dz) = 1, thus ν(Dc
x∩Dy) = 0 for ν-a.e.yinDx. On the other hand,
0 =/integraldisplay
X/integraldisplay
Dx/parenleftBig/integraldisplay
Dcyr(y,z)ν(dz)/parenrightBig
r(x,y)ν(dy)ν(dx)
(a)=/integraldisplay
X/integraldisplay
Dx/parenleftBig/integraldisplay
Dc
yr(x,z)ν(dz)/parenrightBig
r(x,y)ν(dy)ν(dx)(b)=/integraldisplay
X/integraldisplay
Dx/parenleftBig/integraldisplay
Dx∩Dc
yr(x,z)ν(dz)/parenrightBig
r(x,y)ν(dy)ν(dx),(4.26)
where (a) comes from ( 4.22), and (b) sincer(x,z) = 0 for z∈Dc
x. Applying the same reasoning as in ( 4.25)
to (4.26), we can show that, for ν-a.e.x, it holds ν(Dx∩Dc
y) = 0 for ν-a.e.yinDx.
It follows from both results that, for some E∈ X:ν(E) = 1 and every x∈E, there exists a further set
Ex∈ Xsuch that ν(Ex) = 1 and, for all y∈Ex∩Dx, it holds
ν(Dc
x∩Dy) = 0 and ν(Dx∩Dc
y) = 0,
implying that
ν(Dx) =ν(Dx∩Dy) =ν(Dy). (4.27)
Recall that G={x∈X:ν(Dx)>0}andν(G) = 1. Let us deﬁne, for x∈E,
¯Dx:=Ex∩DxandX0:=G∩E∩{x∈X:Rx(dy) =r(x,y)ν(dy)}.
19Thenν(¯Dx) =ν(Dx)>0 for all x∈X0, andν(X0) = 1. We will now show that the sets ¯Dxand¯Dy, for
diﬀerent x,y∈X0, are either disjoint or their diﬀerence has ν-measure zero, which will allow us to create
the aforementioned partition on X.
Letx,y∈X0be such that ¯Dx∩¯Dy/ne}ationslash=∅. Pickz∈¯Dx∩¯Dy. Thenz∈Exandz∈Ey, soν(Dx∩Dc
z) = 0
andν(Dc
y∩Dz) = 0 from ( 4.27), which implies that
ν(¯Dx) =ν(Dx) =ν(Dx∩Dy)+ν(Dx∩Dc
y∩Dz)+ν(Dx∩Dc
y∩Dc
z) =ν(Dx∩Dy) =ν(¯Dx∩¯Dy),
and, similarly,
ν(¯Dy) =ν(¯Dx∩¯Dy) =ν(¯Dx). (4.28)
If there exists, in addition, y′∈X0such that ¯Dy∩¯Dy′/ne}ationslash=∅, thenν(¯Dy′) =ν(¯Dy∩¯Dy′) from (4.28) and
ν(¯Dx∩¯Dy′) =ν(¯Dx∩¯Dy∩¯Dy′) =ν(¯Dx∩¯Dy∩¯Dy′)+ν(¯Dc
x∩¯Dy∩¯Dy′) =ν(¯Dy∩¯Dy′) =ν(¯Dy′)>0;
thus,¯Dx∩¯Dy′/ne}ationslash=∅. Therefore, we can partition X0into equivalent classes according to whether ¯Dx∩¯Dy/ne}ationslash=∅
or not, and we can pick one element from each class to create a family of subsets {¯Dx}x∈Y, for some Y⊆X0,
such that ¯Dx∩¯Dy=∅, forx/ne}ationslash=y, andν(¯Dx)>0, for all x∈Y. In fact, Yis at most countable as νis ﬁnite.
Ifx∈X0, thenRx≪ν, and thus Rx(¯Dx) =Rx(Dx) = 1; hence we get from ( 4.28) that, for every
x,y∈X0,
Rx(¯Dy) =Rx(¯Dx∩¯Dy) =Rx(¯Dx) = 1,if¯Dx∩¯Dy/ne}ationslash=∅,
and
Rx(¯Dy) =Rx(¯Dc
x∩¯Dy) = 0,if¯Dx∩¯Dy=∅.
The two equations together imply that/summationtext
x′∈YRx(¯Dx′) = 1 for each x∈X0, so using ( 4.26) and the fact
that{¯Dx′}x′∈Yare disjoint,
ν/parenleftBig/uniondisplay
x′∈Y¯Dx′/parenrightBig
=/summationdisplay
x′∈Yν(¯Dx′) =/summationdisplay
x′∈Y/integraldisplay
XRx(¯Dx′)ν(dx) =/integraldisplay
X0/summationdisplay
x′∈YRx(¯Dx′)ν(dx) =ν(X0) = 1.
LetA,B∈ X. Then
/integraldisplay
ARx(B)ν(dx) =/integraldisplay
A∩(/uniontext
x′∈Y¯Dx′)Rx(B)ν(dx)
=/summationdisplay
x′∈Y/integraldisplay
A∩X0∩¯Dx′Rx(B)ν(dx)
(a)=/summationdisplay
x′∈Y/integraldisplay
A∩X0∩¯Dx′ν(B|Dx)ν(dx)
(b)=/summationdisplay
x′∈Y/integraldisplay
A∩X0∩¯Dx′ν(B|¯Dx′)ν(dx) =/integraldisplay
A/summationdisplay
x′∈Yν(B|¯Dx′)· /BD¯Dx′(x)ν(dx),
where (a) follows from ( 4.24) withAreplaced by A∩X0∩¯Dx′, and (b) from (4.27) sinceν(¯Dc
x∩¯Dx′) = 0 =
ν(¯Dx∩¯Dc
x′) whenever x∈¯Dx′∩X0. Therefore, Rx(B) =/summationtext
x′∈Yν(B|¯Dx′)· /BD¯Dx′(x) forν-a.e.xand, asX
is countably generated, as measures,
Rx(·) =/summationdisplay
x′∈Yν(· |¯Dx′)· /BD¯Dx′(x) for ν-a.e.x.
20Proof of Theorem 3.14.If (Xn)n≥1is i.i.d., then Proposition 3.1implies that Rx=Ra
x, forν-a.e.x. Suppose
that (Xn)n≥0is exchangeable, but not i.i.d. Assume, without loss of generality, tha tRx(X) = 1 for x∈X.
By Lebesgue decomposition (Theorem 1 in [ 11]),
Rx=R⊥
x+Ra
x,
for some ﬁnite transition kernels R⊥andRaonXsuch that R⊥
x⊥νfor some Sx∈ Xwithν(Sx) = 0 =
R⊥
x(Sc
x), andRa
x≪ν, forx∈X. Moreover,
R⊥
x(X) =R⊥
x(Sx) =Rx(Sx) and Ra
x(X) =Ra
x(Sc
x) =Rx(Sc
x). (4.29)
Arguing as in ( 4.19), there exists some measurable function r:X2→R+such that
Ra
x(dy) =r(x,y)ν(dy) for ν-a.e.x. (4.30)
In addition, we have from ( 4.15) that
R⊥
x(dy)ν(dx) +Ra
x(dy)ν(dx) =R⊥
y(dx)ν(dy) +Ra
y(dx)ν(dy), (4.31)
and, from ( 4.16), forν-a.e.x,
R⊥
y(dz)R⊥
x(dy)+Ra
y(dz)R⊥
x(dy)+R⊥
y(dz)Ra
x(dy)+Ra
y(dz)Ra
x(dy)
=R⊥
z(dy)R⊥
x(dz)+Ra
z(dy)R⊥
x(dz)+R⊥
z(dy)Ra
x(dz)+Ra
z(dy)Ra
x(dz).(4.32)
Fix one such x. Sinceν(Sx) = 0, then Ra
y(Sx) = 0 for all y∈X, and integrating ( 4.32) onz∈Sxandy∈X,
we get
/integraldisplay
XR⊥
y(Sx)R⊥
x(dy)+/integraldisplay
XR⊥
y(Sx)Ra
x(dy) =/integraldisplay
SxR⊥
z(X)R⊥
x(dz)+/integraldisplay
SxRa
z(X)R⊥
x(dz) =R⊥
x(X),(4.33)
where we have used in the last equality that R⊥
x(Sc
x) = 0. On the other hand, from ( 4.30),
/integraldisplay
XR⊥
y(Sx)Ra
x(dy) =/integraldisplay
ScxR⊥
y(Sx)Ra
x(dy)
=/integraldisplay
y∈Sc
x/integraldisplay
z∈Sxr(x,y)R⊥
y(dz)ν(dy)
(a)=/integraldisplay
z∈Sx/integraldisplay
y∈Scxr(x,y)R⊥
z(dy)ν(dz)+/integraldisplay
z∈Sx/integraldisplay
y∈Scxr(x,y)Ra
z(dy)ν(dz)
−/integraldisplay
y∈Scx/integraldisplay
z∈Sxr(x,y)Ra
y(dz)ν(dy)
(b)= 0,
where (a) follows from ( 4.31), and for ( b) we have used again that ν(Sx) = 0 and Ra
y(Sx) = 0 for all y∈X.
Plugging this into ( 4.33), we get/integraltext
XR⊥
y(Sx)R⊥
x(dy) =R⊥
x(X) forν-a.e.x, and thus
R⊥
y(Sx) = 1 for R⊥
x-a.e.y. (4.34)
Moreover, 1 = R⊥
y(Sx)≤R⊥
y(X) =Ry(Sy), soRa
y(X) = 0, by ( 4.29), andRa
y(dz)R⊥
x(dy) = 0 for ν-a.e.x,
which implies the splitting of the measures
Ry(dz)Rx(dy)ν(dx) =R⊥
y(dz)R⊥
x(dy)ν(dx) +Ry(dz)Ra
x(dy)ν(dx).
21On the other hand, using the identity in ( 4.18), we obtain
Ry(dz)Rx(dy)ν(dx) =Rx(dz)Rx(dy)ν(dx) =Rx(dz)R⊥
x(dy)ν(dx)+Rx(dz)Ra
x(dy)ν(dx).
Combining the two result, we get, for ν-a.e.x,
R⊥
y(dz)R⊥
x(dy)+Ry(dz)Ra
x(dy) =Rx(dz)R⊥
x(dy)+Rx(dz)Ra
x(dy).
ButR⊥
x(dy)⊥Ra
x(dy) w.r.t.SxandR⊥
x(Sx) = 1, so it must be
R⊥
y(dz)R⊥
x(dy) = /BDSx(y)R⊥
y(dz)R⊥
x(dy) = /BDSx(y)Rx(dz)R⊥
x(dy) =Rx(dz)R⊥
x(dy).
It follows from this result, ( 4.29) and (4.34) that, for ν-a.e.x,
Rx(Sx) =R⊥
x(Sx) =/integraldisplay
SxR⊥
y(Sx)R⊥
x(dy) =/integraldisplay
Sx/integraldisplay
SxR⊥
y(dz)R⊥
x(dy) =/integraldisplay
SxRx(Sx)R⊥
x(dy) =Rx(Sx)Rx(Sx);
thus,Rx(Sx)∈ {0,1}forν-a.e.x.
Let us deﬁne
S:={x∈X:R⊥
x(X) = 1},
which is X-measurable since R⊥
xis a transition kernel. By ( 4.29), we have Rx(Sx) =R⊥
x(X) = 1, for x∈ S.
Therefore, using that Rx(Sx)∈ {0,1}forν-a.e.x, we get for ν-a.e.xthat: ifx∈ S, thenRx=R⊥
x; if
x∈ Sc, thenRx=Ra
x. Moreover, ( 4.29) and (4.34) imply for ν-a.e.xthaty∈ SforR⊥
x-a.e.y; in other
words,R⊥
x(Sc) = 0 for ν-a.e.x. Finally, using ( 4.15) and the fact that Ra
x= 0 forν-a.e.x∈ SandR⊥
x= 0
forν-a.e.x∈ Sc, we get
/integraldisplay
XRa
x(S)ν(dx) =/integraldisplay
SRa
x(S)ν(dx) +/integraldisplay
ScRa
x(S)ν(dx) =/integraldisplay
ScRx(S)ν(dx)
=/integraldisplay
SRx(Sc)ν(dx) =/integraldisplay
SR⊥
x(Sc)ν(dx)+/integraldisplay
ScR⊥
x(Sc)ν(dx) =/integraldisplay
XR⊥
x(Sc)ν(dx) = 0,
and soRa
x(S) = 0 for ν-a.e.x.
Proof of Proposition 3.17.SinceRx⊥ν, then (Xn)n≥1is not i.i.d., and hence not unbalanced by Theorem
3.2, so from Corollary 3.4we may assume that Rx(X) = 1, without loss of generality.
Let us deﬁne, for x∈X,
Dx:=/braceleftbig
y∈X:Rx({y})>0/bracerightbig
andD:={x∈X:x∈Dx}.
ThenRx(·) =/summationtext
y∈Dxpx(y)δy(·) for some px(y)>0 such that/summationtext
y∈Dxpx(y) = 1.
It follows from ( 4.18) and the form of Rxthat there exists C∈ Xsuch that ν(C) = 1 and, for all x∈C,
Rx(dz) =Ry(dz) for y∈Dx;
thus,Dx=Dyfor ally∈Dx, which implies that y∈Dy, i.e.y∈D. Therefore, by ( 4.15),
ν(D) =/integraldisplay
XRx(D)ν(dx) =/integraldisplay
C/parenleftBig/summationdisplay
y∈Dxpx(y)δy(D)/parenrightBig
ν(dx) =/integraldisplay
C/parenleftBig/summationdisplay
y∈Dxpx(y)/parenrightBig
ν(dx) = 1.
For the second part, let x,y∈C∩Dbe such that y /∈Dx. Assume Dx∩Dy/ne}ationslash=∅. Takez∈Dx∩Dy. It
follows from above that Dx=Dz=Dy. Buty∈D, soy∈Dy=Dx, absurd. As a result, for ν-a.e.xand
y, eitherDx=DyorDx∩Dy=∅.
225 Discussion
The results in this paper allow us to state some universal facts abou t exchangeable MVPSs that were
previously unknown: 1) all models are necessarily balanced; 2) the n ormalized reinforcement kernels are a.e.
proper regular conditional distributions; 3) the prior distributions have the stick-breaking construction of
a Dirichlet process. When Xis countable or the reinforcement is dominated by ν, then every MVPS is a
Dirichlet process mixture model overa family of probability distributio ns with disjoint supports derived from
ν. Relaxing parts of this structure while retaining exchangeability wou ld lead to a very diﬀerent sampling
scheme from the one that ( 1.2) entails. On the other hand, the fact that, for ﬁxed x,Rxis either absolutely
continuous or mutually singular with respect to ν, though surprising at ﬁrst, seems very natural under
exchangeability. Therefore, we expect that Rcan be further decomposed along other lines, e.g., R⊥
xmight
be discrete only for some xand diﬀuse for the rest.
Acknowledgments
This study is ﬁnanced by the European Union-NextGenerationEU, t hrough the National Recovery and
Resilience Plan of the Republic of Bulgaria, project No. BG-RRP-2.004 -0008.
We are grateful to an Associate Editor and two anonymous refere es for their valuable comments and
helpful suggestions, and for pointing out inaccuracies in an earlier v ersion of this work.
References
[1] D. J. Aldous. Exchangeability and related topics. ´Ecole d’´Et´ e de Probabilit´ es de Saint-Flour XIII 1983 ,
1117:1–198, 1985.
[2] A. Bandyopadhyay and D. Thacker. A new approach to P´ olya ur n schemes and its inﬁnite color
generalization. Ann. Appl. Probab. , 32(1):46–79, 2022.
[3] P. Berti and P. Rigo. 0–1 laws for regular conditional distribution s.Ann. Probab. , 35(2):649–662, 2007.
[4] P. Berti, E. Dreassi, F. Leisen, L. Pratelli, and P. Rigo. Kernel ba sed Dirichlet sequences. Bernoulli ,
29(2):1321–1342, 2023.
[5] D. Blackwell and L. E. Dubins. On existence and non-existence of proper, regular, conditional distri-
butions. Ann. Probab. , 3(5):741–752, 1975.
[6] D. Blackwell and J. B. MacQueen. Ferguson distributions via P´ oly a urn schemes. Ann. Stat. , 1(2):
353–355, 1973.
[7] S. Fortini and S. Petrone. Predictiveconstruction ofpriorsin B ayesiannonparametrics. Braz. J. Probab.
Stat., 26(4):423–449, 2012.
[8] S. Fortini, L. Ladelli, andE.Regazzini. Exchangeability,predictive distributionsandparametricmodels.
Sankhy¯ a Ser. A , 62(1):86–109, 2000.
[9] S. Fortini, S. Petrone, and H. Sariev. Predictive constructions based on measure-valued P´ olya urn pro-
cesses.Mathematics, special issue “Bayesian Predictive Inference and Related Asymptotics – F estschrift
for Eugenio Regazzini’s 75th Birthday” , 9:2845, 2021.
23[10] S. Janson. Random replacements in P´ olya urns with inﬁnitely man y colours. Electron. Commun.
Probab., 24, 2019. paper no. 23, 11 pp.
[11] K. Lange. Decompositionsof substochastictransitionfunctio ns.Proc. Amer. Math. Soc. , 37(2):575–580,
1973.
[12] A. Lijoi and I. Pr¨ unster. Models beyond the Dirichlet process . InBayesian Nonparametrics , N. L. Hjort,
C. Holmes, P. M¨ uller and S. G. Walker, eds., pages 80–136. Cambridg e University Press, Cambridge,
UK, 2010.
[13] H. Mahmoud. P´ olya Urn Models . CRC Press, Boca Raton, FL, 2008.
[14] C. Mailler and J.-F. Marckert. Measure-valued P´ olya urn proce sses.Electron. J. Probab. , 22, 2017.
paper no. 26, 33 pp.
[15] C. Mailler and D. Villemonais. Stochastic approximation on non-com pact measure spaces and applica-
tion to measure-valued P´ olya processes. Ann. Appl. Probab. , 30(5):2393–2438, 2020.
[16] R. Pemantle. A survey of random processes with reinforcemen t.Probab. Surv. , 4:1–79, 2007.
[17] H. Sariev, S. Fortini, and S. Petrone. Inﬁnite-color randomly r einforced urns with dominant colors.
Bernoulli , 29(1):132–152, 2023.
24