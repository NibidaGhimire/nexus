arXiv:2304.13047v1  [math.PR]  25 Apr 2023BBP PHENOMENA FOR DEFORMED RANDOM BAND MATRICES
BENSON AU
Abstract. We study additive ﬁnite-rank perturbations of random perio dic band matrices under
the assumption that the nontrivial eigenvalues of the pertu rbation do not depend on the dimension.
We establish the eigenvalue/eigenvector BBP transition in this model for band widths bN≫Nε.
Our analysis relies on moment method calculations for gener al vector states.
Contents
1. Introduction 1
2. Background 5
3. Proofs of the main results 8
3.1. The isotropic global law 8
3.2. Proof of Theorem 1.3 19
References 23
1.Introduction
Understanding the spectral statistics of random matrices i s a fundamental problem at the in-
terface of mathematics, physics, and statistics. This conﬂ uence can already be observed in the
classical Wigner ensemble, a mean-ﬁeld model originally pr oposed by Wigner as a tractable proxy
for the Hamiltonian of a large quantum system. In the interve ning years, the deﬁnition of a Wigner
matrix has become increasingly general. For concreteness, we state our working deﬁnition below.
Deﬁnition 1.1 (Wigner matrix) .Let (XN(i,j) : 1≤i≤j≤N∈N) be a family of independent
random variables such that
(i) the oﬀ-diagonal entries ( i<j) are complex-valued, centered, and of variance σ2;
(ii) the diagonal entries ( i=j) are real-valued and of ﬁnite variance;
(iii) we have a strong uniform control on the moments: for any m∈N,
(1) sup
1≤i≤j≤N∈NE[|XN(i,j)|m]<∞.
We call the random Hermitian matrix deﬁned by WN(i,j) =1√
NXN(i,j) anormalized Wigner
matrix of variance σ2and use the notation WNd= Wigner(N,σ2). When the context is clear, we
simply refer to a Wigner matrix. Hereafter, when we refer to a Wigner matrix WN, we implicitly
refer to a sequence of Wigner matrices ( WN)N∈N.
Being Hermitian, we can order the eigenvalues of a Wigner mat rixλ1(WN)≤ ··· ≤λN(WN).
The natural question of the limiting distribution of these e igenvalues was settled by Wigner under
some simplifying assumptions on the distributions of the en tries [Wig55,Wig58] and by Pastur
in the general case with the moment assumption (iii)replaced by the much weaker Lindeberg
Date: April 27, 2023.
Department of Statistics, University of California, Berke ley,bensonau@berkeley.edu .
12 BENSON AU
condition [ Pas72] (see also [ BS10, Theorem 2.9]): if WNd= Wigner(N,σ2), then the empirical
spectral distribution µWN=1
N/summationtext
k∈[N]δλk(WN)converges weakly almost surely to the semicircle
distribution µSC,σ2(dx) =1{|x|≤2σ}
2πσ2√
4σ2−x2dx.
The semicircle law governs the globalbehavior of the eigenvalues; however, the physical inter-
pretation primarily concerns the localeigenvalue statistics of the matrix, in particular their co njec-
tured universality [ Wig67]. Eigenvector statistics, as pioneered by Anderson [ And58], are a related
line of inquiry. In particular, the Anderson tight binding m odel exhibits localized eigenfunctions
[FS83,FMSS85,AM93,Aiz94] and Poisson local eigenvalue statistics [ Min96]. Following a long line
of work, the universality phenomenon for Wigner matrices is now well-understood [ BGK17,EY17]:
some highlights include GOE/GUE universality for the local eigenvalue statistics and complete
delocalization of the eigenvectors. Random band matrices e merge as a natural interpolative model
to study the transition between these two phases [ Bou18].
Deﬁnition 1.2 (Random band matrix) .Let (XN(i,j) : 1≤i≤j≤N∈N) be as in Deﬁnition
1.1. For band widths ( bN:N∈N)⊂N0, we deﬁne
ξN= min{2bN+1,N}.
Similarly, we deﬁne the N-periodic distance
|i−j|N= min{|i−j|,N−|i−j|}.
Aperiodic (0,1)-band matrix of band width bNis a real symmetric matrix BNwith entries
(2) BN(i,j) =1{|i−j|N≤bN}.
We call the random Hermitian matrix deﬁned by
(3) ΞN=1√ξNBN◦XN
anormalized periodic random band matrix of variance σ2and band width bNand use the notation
ΞNd= RBM(N,σ2,bN). Here, ◦denotes the entrywise product. When the context is clear, we
simply refer to a random band matrix. Hereafter, when we refe r to a random band matrix ΞN, we
implicitly refer to a sequence of random band matrices ( ΞN)N∈N.
A long-standing conjecture proposes a dichotomy for random band matrices: delocalization and
Wigner local statistics for large band widths; localizatio n and Poisson local statistics for small
band widths; and a sharp transition around the critical band width ratebN≍√
N[CMI90,FM91].
Recent progress has established delocalization (in fact, q uantum unique ergodicity) for bN≫N3/4
[BYY20] and localization for bN≪N1/4[CPSS,CS].
Wigner matrices also appear in statistics, where deformed v ersions are studied as a prototype of
a spiked model. Here, spectral propertiescan beused todiﬀer entiate thespiked model from thenull
case [BBAP05 ,P´ ec06], a phenomenon known as the BBP transition. To explain this t ransition, we
ﬁrstreview the relevant results in thenull case of a Wigner m atrix. We assumethat the oﬀ-diagonal
entries in (i)are i.i.d. and similarly for the diagonal entries in (ii), but we no longer assume the
existence of moments as in (iii). Recall that
(W1) The extremal eigenvalues are known to converge to the ed ge of the support of the semicircle
distribution iﬀ the oﬀ-diagonal entries have a ﬁnite fourth m omentE[|XN(1,2)|4]<∞
[BY88,BS10]. So, for example, lim N→∞λ1(WN)a.s.=−2σ; however, without a ﬁnite fourth
moment, liminf N→∞λ1(WN)a.s.=−∞.
(W2) The ﬂuctuations of the extremal eigenvalues in the GOE/ GUE were found in [ TW94,TW96]
and shown to be universal in [ Sos99] assuming sub-Gaussianity of the entries. The optimal
rate of decay for universality was found in [ LY14] to be lim s→∞s4P(|XN(1,2)|> s) = 0.DEFORMED RANDOM BAND MATRICES 3
For example, lim N→∞P(N2/3(λN(WN)−2σ)≤sσ) =Fβ(s), whereFβis the CDF of the
Tracy-Widom distribution of parameter β. In particular, we note the N−2/3scale of the
ﬂuctuations.
(W3) As noted before, the ( ℓ2-normalized) eigenvectors ( w(k)
N)k∈[N]ofWNare completely de-
localized. For example, if we assume ﬁnite moments as in (iii), then for any ε,D >0,
P(maxk∈[N]/⌊ard⌊lw(k)
N/⌊ard⌊l∞≥Nε−1/2)≤N−D[BGK17, Theorem 1.2.10].
The spiked Wigner model introduces an additive perturbatio nANto our matrix. We assume
thatANis self-adjoint and of ﬁxed rank rN≡r. We further assume that the nontrivial eigenvalues
ofANdo not depend on N: we denote them by θ1≤ ··· ≤θr. Since the perturbation is ﬁnite-
rank, the empirical spectral distribution of the spiked mod elMN=WN+ANstill converges to
the semicircle distribution. The presence of ANcan however be detected by the extremal spectral
statistics (cf. (W1)-(W3)). Recall that
(S1) Each eigenvalue θsofANsuch that |θs|> σcreates an outlying eigenvalue in MN. In
particular, if L−σ= #({s∈[r] :θs<−σ}) andL+σ= #({s∈[r] :θs>σ}), then
lim
N→∞λk(MN)a.s.=θk+σ2
θk<−2σ,∀k∈[L−σ];
lim
N→∞λL−σ+1(MN)a.s.=−2σ;
lim
N→∞λN+1−k(MN)a.s.=θr+1−k+σ2
θr+1−k>2σ,∀k∈[L+σ];
lim
N→∞λN−L+σ(MN)a.s.= 2σ.
(S2) The ﬂuctuations of the outlying eigenvalues are nonuni versal. We omit the precise statement
of the result in this case and simply note the N−1/2scale of the ﬂuctuations.
(S3) The eigenspace of an outlying eigenvalue in MNhas nontrivial alignment with the eigenspace
of the correspondingeigenvalue in AN. In particular, let m(k)
Nbe a unit eigenvector associated
with the eigenvalue λk(MN). Ifk∈[L−σ], then
lim
N→∞/vextenddouble/vextenddouble/vextenddoublePker(θkIN−AN)(m(k)
N)/vextenddouble/vextenddouble/vextenddouble2
2a.s.= 1−σ2
θ2
k,
wherePker(θkIN−AN)denotes the orthogonal projection onto the eigenspace ker( θkIN−AN);
however, if θk′/\e}a⊔io\slash=θk, then
lim
N→∞/vextenddouble/vextenddouble/vextenddoublePker(θk′IN−AN)(m(k)
N)/vextenddouble/vextenddouble/vextenddouble
2a.s.= 0.
Similarly, if k∈[L+σ], then one replaces all instances of kin the superscripts with N+1−k
and all instances of kin the subscripts with r+1−kin the above.
(S4) On the other hand, if θkdoes not meet the threshold in (S1)for the creation of an outlier, then
the eigenspace of the associated eigenvalue in MNis asymptotically orthogonal to ker( AN)⊥.
In particular, if θk∈[−σ,0), then
lim
N→∞/vextenddouble/vextenddouble/vextenddoublePker(θk′IN−AN)(m(k)
N)/vextenddouble/vextenddouble/vextenddouble
2a.s.= 0,∀k′∈[r].
Similarly, if θr+1−k∈(0,σ], then one replaces m(k)
Nwithm(N+1−k)
Nin the above.
The outlier phenomenon in (S1)was ﬁrst proven for the GUE in [ P´ ec06], extended to Wigner
matrices satisfying a Poincar´ e inequality in [ CDMF09 ], and then relaxed to a fourth moment
Lindeberg-type condition in [ PRS13,RS13] at the cost of convergence in probability. In the com-
plex case, we note that the assumption Re( XN(i,j))⊥ ⊥Im(XN(i,j)) are identically distributed is
present throughout. Theworks [ CDMF09 ,CDMF12 ,PRS13,RS13] address the ﬂuctuations touched4 BENSON AU
on in(S2). Much ﬁner results are known if one assumes uniform subexpon ential decay of the en-
tries, in which case one can leverage the isotropic local sem icircle law [ KY13,KY14], but we will
not discuss this further. The eigenvector alignment in (S3)was ﬁrst proven for general unitar-
ily/orthogonally invariant random matrices in [ BGN11] and extended to Wigner matrices satisfy-
ing a Poincar´ e inequality in [ Cap13]. The nonalignment in (S4)was proven for the same invariant
ensembles in [ BGN11] under the assumption of a rank one perturbation r= 1.
In this paper, we study the spiked RBM model MN=ΞN+AN. Our main result proves that
the eigenvalue/eigenvector BBP transition persists for ba nd widthsbN≫Nε.
Theorem 1.3. LetΞNbe a RBM as in Deﬁnition 1.2. IfbN≫Nεfor someε >0, then the
spiked RBM model MN=ΞN+ANexhibits the eigenvalue/eigenvector BBP transition in (S1),
(S3), and(S4).
We brieﬂy outline the proof of Theorem 1.3. In the case of a rank one perturbation θaNa∗
Nof
a Wigner matrix WN, Noiry computed the limiting spectral measure µθofWN+θaNa∗
Nwith
respect to the vector state τN(·) =/a\}⌊ra⌋ke⊔le{⊔·aN,aN/a\}⌊ra⌋ke⊔ri}h⊔[Noi21, Proposition 2]. In particular,
(4) µθ(dx) =1{|x| ≤2σ}
2π√
4σ2−x2
θ2+σ2−θxdx+1{|θ|>σ}/parenleftbigg
1−σ2
θ2/parenrightbigg
δθ+σ2
θ(dx).
The strong convergence (W1)ofWNand Weyl’s interlacing inequality [ HJ13, Theorem 4.3.1] then
imply(S1)and(S3)in the spiked Wigner model for r= 1 [Noi21, Corollary 3] (in fact, (S4)also
follows from the same calculation). Noiry’s proof of ( 4) uses the local law in [ KY17, Theorem 12.2],
but he mentions that simpler arguments suﬃce in the case of st andard basis vectors (for example,
the resolvent estimates in [ Cap13, Proposition 6.2]).
In contrast to the usual approach to outliers via the resolve nt, our analysis relies on moment
method calculations for general vector states. In particul ar, we prove a seemingly innocuous
isotropic globallaw in Proposition 3.6. In its simplest form, it states that if bN≫Nεfor some
ε>0, then
(5) lim
N→∞Tr/parenleftiggr/productdisplay
s=1x(s−1)
Ny(s)
N∗Ξms
N/parenrightigg
a.s.=r/productdisplay
s=1/bracketleftbigg
lim
N→∞/a\}⌊ra⌋ke⊔le{⊔x(s)
N,y(s)
N/a\}⌊ra⌋ke⊔ri}h⊔lim
N→∞1
NE/bracketleftbig
Tr(Ξms
N)/bracketrightbig/bracketrightbigg
,
wherex(r)
N=x(0)
N. The proof of Theorem 1.3now follows. Indeed, let AN=/summationtextr
s=1θsa(s)
Na(s)
N∗
be the spectral decomposition of the perturbation. The form ula in (5) tells us that the limiting
moments of ΞN+ANwith respect to the vector state τ(s′)
N(·) =/a\}⌊ra⌋ke⊔le{⊔·a(s′)
N,a(s′)
N/a\}⌊ra⌋ke⊔ri}h⊔coincide with the
limiting moments of WN+θs′a(s′)
Na(s′)
N∗with respect to the same vector state for any s′∈[r]. Since
the measure in ( 4) is uniquely determined by its moments (being compactly sup ported), this shows
that the limiting spectral measure of ΞN+ANwith respect to the vector state τ(s′)
Nis again given
byµθs′. To complete the proof, we use the strong convergence of ΞN[BvH, Corollary 2.18] and an
inductive application of Weyl’s interlacing inequality.
Remark 1.4.Naturally, one can ask for the optimal band width rate in Theo rem1.3. The strategy
above proves the eigenvalue/eigenvector BBP transition fo rΞNwhenever we have the isotropic
global law and the strong convergence of ΞN. IfbN≫1, then the convergence in ( 5) still holds in
probability. The limiting factor is then the strong converg ence ofΞN. Here, there is a “tradeoﬀ
between sparsity and integrability of the entries” [ BvH, Remark 7.13]. For example, if one as-
sumes the uniform bound /⌊ard⌊lXN(i,j)/⌊ard⌊lp≤(Cp)αfor some constants C,α∈[0,∞) independent of p,
then/⌊ard⌊lΞN/⌊ard⌊lP→2σfor band widths bN≫[log(N)]6(1+α)[BGP14, Theorem 1.4], whereP→denotes
convergence in probability (see also [ BvH, Corollary 2.18]). In the case of Rademacher entries,
the convergence /⌊ard⌊lΞN/⌊ard⌊lP→2σis known for band widths bN≫log(N) [Sod10, Theorem 1.4]; for
Gaussian entries, the rate bN≫log(N) is in fact optimal [ BvH16, Corollary 4.4]. Thus, one alsoDEFORMED RANDOM BAND MATRICES 5
has(S1),(S3), and(S4)in probability for spiked Gaussian RBMs for the optimal band width rate
bN≫log(N).
Remark 1.5.A key input to our analysis is the calculation of the limiting spectral measure in ( 4).
Given the moment determinacy of µθ, this calculation should in principle be possible purely on
the basis of ( 5). In fact, the relationship between the matrices ( x(s−1)
Ny(s)
N∗)r
s=1andΞNin (5) is
a particular instance of inﬁnitesimal freeness, a concept i ntroduced in [ BS12]. Shlyakhtenko used
the inﬁnitesimal framework to give an interpretation for th e eigenvalue BBP transition in unitarily
invariant ensembles at the level of the1
Ncorrection [ Shl18]. This was further developed by Collins,
Hasebe, and Sakuma in [ CHS18] using their framework of cyclic monotone independence. Th e
recent breakthrough of C´ ebron, Dahlqvist, and Gabriel in [ CDG] uniﬁes these and other notions
(e.g., conditional freeness [ BLS96] and monotone independence [ Mur01]) and provides a rigorous
derivation of the BBP transition from noncommutative proba bilistic methods. In particular, the
calculation of ( 4) in thecase of a rank oneperturbationof theGUE can berealiz ed as themonotone
convolution µθ=δθ⊲µSC,σ2[CDG, Section 1.4]. As we will not use this framework, we do not
discuss this further.
We highlight an interesting feature of Theorem 1.3. The original proofs of (S1),(S3), and(S4)
for unitarily/orthogonally invariant random matrices in [ BGN11] crucially uses the fact that the
eigenvectors of an invariant ensemble are Haar distributed . The authors remark that the proofs
could possibly be adapted to random matrices with Haar-like eigenvectors [ BGN11, Remark 2.15].
On the other hand, Theorem 1.3still holds in the established localized regime bN≪N1/4. For
example, consider a rank one perturbation AN=θaNa∗
Nwithθ <−σ. The alignment in (S3)
amounts to the convergence
lim
N→∞|/a\}⌊ra⌋ke⊔le{⊔aN,m(1)
N/a\}⌊ra⌋ke⊔ri}h⊔|2a.s.= 1−σ2
θ2.
Forσ2
θ2small, this implies that the eigenvector m(1)
Nof the spiked model MN=ΞN+θaNa∗
Ntakes
on the shape of the eigenvector aNof the perturbation: if aNis localized, then so too is m(1)
N; if
aNis delocalized, then so too is m(1)
N.
We do not address the ﬂuctuations of the outlying eigenvalue s in the spiked RBM model in this
article (in particular, the analogue of (S2)). Here, the scaleof the ﬂuctuations depends on the
shape of the perturbing eigenvectors. This will be the subje ct of future work. See [ Au21, Section
2] for heuristics and simulations.
Remark1.6.We have stated ourresults for RBMs, but theisotropic global law holds moregenerally
forkN-sparse Wigner matrices . Here, one replaces the (0 ,1)-band matrix BN(resp., the normal-
ization term√ξN) in the entrywise product ( 3) with the adjacency matrix /tildewideBNof akN-regular
graph on the vertex set [ N] (resp., the normalization term√kN). IfkN≫Nεfor someε>0, then
we again have the strong convergence of this model to the semi circle law [ BvH, Corollary 2.18].
Thus, Theorem 1.3extends to kN-sparse Wigner matrices: the minor modiﬁcations necessary for
the proof are contained in Remarks 3.2and3.4.
Acknowledgments. The author thanks Guillaume C´ ebron for bringing his attent ion to the works
[Noi21,CDG]. The author also thanks Jorge Garza-Vargas and Shirshendu Ganguly for many
helpful conversations.
2.Background
LetMatN(C) denotetheset ofcomplex N×Nmatrices. For aHermitian matrix HN∈MatN(C),
we write HN=/summationtextN
k=1λk(HN)h(k)
Nh(k)
N∗for its spectral decomposition.6 BENSON AU
Deﬁnition 2.1 (Spectral measure with respect to a state ψ).Letψ: MatN(C)→Cbe a state
(i.e., a positive linear functional such that ψ(IN) = 1). We deﬁne the spectral measure of HNwith
respect toψas the unique probability measure µψ
HNsuch that
/integraldisplay
xmµψ
HN(dx) =ψ(Hm
N),∀m∈N.
Example 2.2 (Spectralmeasurewithrespecttoavector state) .Theempiricalspectral distribution
µHN=1
N/summationtextN
k=1δλk(HN)is the spectral measure with respect to the normalized trace µHN=µ1
NTr
HN.
Inthecaseof avector state ψ(·) =/a\}⌊ra⌋ke⊔le{⊔·uN,uN/a\}⌊ra⌋ke⊔ri}h⊔, weusethenotation µuN
HN. Thespectraldecomposition
implies that
µuN
HN=N/summationdisplay
k=1|/a\}⌊ra⌋ke⊔le{⊔uN,h(k)
N/a\}⌊ra⌋ke⊔ri}h⊔|2δλk(HN).
More generally, we will need to compute quantities of the for m
r/productdisplay
s=1/angbracketleftig
ps(HN)x(s)
N,y(s)
N/angbracketrightig
=r/productdisplay
s=1Tr/parenleftig
ps(HN)x(s)
Ny(s)
N∗/parenrightig
,
whereps(/vector z)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔is a noncommutative polynomial evaluated on a family of Herm itian
matrices HN= (H(i)
N)i∈I. We write the inner product as a trace to suggest the usual gra phical
approach to such calculations, with a slight modiﬁcation to distinguish the matrix x(s)
Ny(s)
N∗.
Deﬁnition 2.3 (Graphs of matrices) .Amultidigraph G= (V,E,src,tar) consists of a nonempty
set of vertices V, a set of edges E, and directions src ,tar :E→Vindicating the source and target
of each edge. A test graphT= (G,γ) is a ﬁnite multidigraph Gwith edge labels γ:E→I. For a
partitionπ∈ P(V), we construct the quotient test graph Tπ= (Gπ,γπ) by merging the vertices of
Gso thatVπ=π. The underlying multidigraph Gπ= (Vπ,Eπ,srcπ,tarπ) and the associated edge
labelsγπ:Eπ→Ican then be written as
(i)Vπ=V/∼π={[v]π:v∈V}andEπ=E;
(ii) srcπ(e) = [src(e)]πand tarπ(e) = [tar(e)]π;
(iii)γπ=γ.
For convenience, we simply write Gπ= (Vπ,E). By a slight abuse of notation, we often speak of
a test graph Tand its underlying multidigraph Ginterchangeably. For example, we also use the
notation V(T) and E(T) for the vertex set and the edge set of a test graph respective ly.
We can evaluate a test graph Ton a family of matrices MN= (M(i)
N)i∈Iusing the formula
χ(T,MN) :=/summationdisplay
φ:V→[N]/productdisplay
e∈EM(γ(e))
N(φ(e)),
where (φ(e)) := (φ(tar(e)),φ(src(e)))∈[N]2. Similarly, we deﬁne
χ0(T,MN) :=/summationdisplay
φ:V֒→[N]/productdisplay
e∈EM(γ(e))
N(φ(e)),
whereφ:V ֒→[N] denotes an injective map. The functions χandχ0are related by the M¨ obius
formula
χ(T,MN) =/summationdisplay
π∈P(V)χ0(Tπ,MN).
Example 2.4 (Moments) .For a monomial p(/vector z) =zi(1)···zi(d)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔of degreed,
(6) Tr( p(MN)) =χ(Cp,MN) =/summationdisplay
π∈P(V(Cp))χ0(Cπ
p,MN),DEFORMED RANDOM BAND MATRICES 7
whereCpis the test graph
(7)Cp=
i(d−1)
···i(3)i(2)i(1)
i(d)
Example 2.5 (Random band matrices) .LetWN= (W(i)
N)i∈Ibe a family of independent Wigner
matrices W(i)
Nd= Wigner(N,σ2
i)as inDeﬁnition 1.1. Mixedmoments inthefamily WNaregoverned
byfreeindependenceinthelargedimensionlimit[ Voi91,Dyk93]: ifp(/vector z)isamonomialasinExample
2.4, then
(8) τ(p) := lim
N→∞E/bracketleftbigg1
NTr(p(WN))/bracketrightbigg
=/summationdisplay
π∈NC2(d)/productdisplay
{j,k}∈πσi(j)σi(k)1{i(j) =i(k)},
whereNC2(d) is the set of noncrossing pair partitions of [ d]. We showed that the same convergence
holds for a family ZN= (Ξ(i)
N)i∈Iof independent RBMs Ξ(i)
Nd= RBM(N,σ2
i,b(i)
N) as in Deﬁnition
1.2assumingb(i)
N≫1 for eachi∈I[Au18], generalizing the result for a single RBM #( I) = 1
[BMP91].
We brieﬂy recall the strategy for proving ( 8) based on the graph formalism in Deﬁnition 2.3.
Example 2.4reduces the calculation to understanding the asymptotics o fE[χ0(Cπ
p,ZN)] for each
π∈ P(V(Cp)). It turns out that only a certain class of graphs survive in the limit, so-called double
trees. Before giving the deﬁnition, it will be convenient to introduce some notation that will allow
us to extract the relevant information from a quotient test g raphTπ.
Deﬁnition 2.6 (Graph projections) .LetG= (V,E,src,tar) be a multidigraph. For π∈ P(V), we
deﬁne an equivalence relation on the edges Eaccording to the parallel edges of Gπ:
e∼πe′⇐⇒ {[tar(e)]π,[src(e)]π}={[tar(e′)]π,[src(e′)]π}.
We write [e]π={e′∈E:e′∼πe}and [E]π={[e]π:e∈E}. We separate the projection of loops
[E](1)
π={[e]π∈[E]π: [tar(e)]π= [src(e)]π}from non-loop edges [ E](2)
π={[e]π∈[E]π: [tar(e)]π/\e}a⊔io\slash=
[src(e)]π}. Note that Gπ:= (Vπ,[E](2)
π) is the underlying simple graph of Gπ. Ifπis the partition
of singletons, then Gπ=Gand we omit it from the notation (e.g., [ e] and [E]).
This allows us to formalize the intuitive notion of a double t ree.
Deﬁnition 2.7 (Double tree) .Adouble tree is a multidigraph G= (V,E,src,tar) such that
(i) there are no loops: [ E](1)=∅;
(ii) every edge is of multiplicity two: #([ e]) = 2 for each e∈E;
(iii) the underlying simple graph G= (V,[E]) is a tree.
The parallel edges of a double tree come in pairs, allowing us to write [E] ={{e,e′}:e∈E}. We
say that a test graph T= (G,γ) is acolored double tree ifGis a double tree such that γ(e) =γ(e′)
for every pair of parallel edges {e,e′} ∈[E].
Specializing [ Au18, Lemma 4.3] to quotients of Cp, we obtain
(9) lim
N→∞E/bracketleftbigg1
Nχ0(Cπ
p,ZN)/bracketrightbigg
=

/productdisplay
{e,e′}∈[E(Cp)]πσ2
γ(e)ifCπ
pis a colored double tree;
0 else,8 BENSON AU
from which ( 8) now follows.
Of course, one can apply the same formalism to E[Tr(p(ZN)xNy∗
N)], but it will be convenient to
separate the contribution from xNy∗
N.
Example 2.8 (Weighted moments) .For a monomial p(/vector z) =zi(1)···zi(d)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔of degree
d, we deﬁne the test graph
(10) Tp=
v0v1···vdi(1) i(d) ···
Formally,Tp= (Lp,γp), whereLp= (Vp,Ep,src,tar) andγp:Ep→Isatisfy
(i)Vp={vt−1:t∈[d+1]};
(ii)Ep={et:t∈[d]};
(iii) src(et) =vtand tar(et) =vt−1;
(iv)γp(et) =i(t).
We then have the analogue of ( 6):
Tr(p(MN)xNy∗
N) =/summationdisplay
φ:Vp→[N]xN(φ(vd))yN(φ(v0))/productdisplay
e∈EpM(γp(e))
N(φ(e))
=/summationdisplay
π∈P(Vp)/summationdisplay
φ:Vπp֒→[N]xN(φ([vd]π))yN(φ([v0]π))/productdisplay
e∈EpM(γp(e))
N(φ(e)),
where we recall that Eπ
p=Ep.
Remark 2.9.Roughly speaking, the isotropic global law amounts to the as ymptotic
E[Tr(p(ZN)xNy∗
N)] =/summationdisplay
π∈P(Vp)/summationdisplay
φ:Vπp֒→[N]xN(φ([vd]π))yN(φ([v0]π))/productdisplay
e∈EpΞ(γp(e))
N(φ(e))
=/summationdisplay
π∈P(Vp)
s.t.v0π∼vd/summationdisplay
φ:Vπp֒→[N]xN(φ([vd]π))yN(φ([v0]π))/productdisplay
e∈EpΞ(γp(e))
N(φ(e))+o(1).
To see this, note that the cycle graph in ( 7) and the path graph in ( 10) satisfyCp=Tˆπ
pfor
the partition ˆ πwhose only nonsingleton block is {v0,vd}. By restricting to the class of partitions
π∈ P(Vp) such that v0π∼vd, the set of possible quotients of Tpis then equal to the set of possible
quotients of Cp. The identiﬁcation [ v0]π= [vd]πalso forcesφ([v0]π) =φ([vd]π), which both explains
the inner product and introduces the additional normalizat ion that is seemingly missing compared
to (8).
3.Proofs of the main results
3.1.The isotropic global law. LetZN= (Ξ(i)
N)i∈Ibe a family of independent RBMs Ξ(i)
Nd=
RBM(N,σ2
i,b(i)
N) as in Deﬁnition 1.2. We assume that b(i)
N≫1 for each i∈Ito ensure the
convergence in ( 8), which also holds almost surely [ Au18, Theorem 4.12]:
lim
N→∞1
NTr(p(ZN))a.s.=/summationdisplay
π∈NC2(d)/productdisplay
{j,k}∈πσi(j)σi(k)1{i(j) =i(k)}=:τ(p).
The main technical contribution of this article is an isotro pic version of this convergence. To state
the precise result, we need some additional notation. For p1(/vector z),...,pr(/vector z)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔, we deﬁne
Ip1,...,pr:={i∈I:ziappears inps(/vector z) for somes∈[r]}.
We start by proving convergence in expectation (cf. [ Au21, Lemma 3.4]).DEFORMED RANDOM BAND MATRICES 9
Lemma 3.1 (Isotropic global law, in expectation) .Forp(/vector z)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔andxN,yN∈SN−1,
E[Tr(p(ZN)xNyN∗)] =/a\}⌊ra⌋ke⊔le{⊔xN,yN/a\}⌊ra⌋ke⊔ri}h⊔τ(p)+Op
1
mini∈Ip/radicalig
ξ(i)
N
.
In particular, the constant in the asymptotic does not depend on the unit vectors xN,yN.
Proof.By linearity, we may assume that p(/vector z) =zi(1)···zi(d)is a monomial. To simplify the
notation, we abbreviate the test graph Tp= (Lp,γp) in (10) toT= (L,γ). The trace can then be
expanded using the graph formalism in Example 2.8:
E[Tr(p(ZN)xNy∗
N)] =/summationdisplay
φ:V→[N]xN(φ(vd))yN(φ(v0))E/bracketleftigg/productdisplay
e∈EΞ(γ(e))
N(φ(e))/bracketrightigg
=/summationdisplay
π∈P(V)/summationdisplay
φ:Vπ֒→[N]xN(φ([vd]π))yN(φ([v0]π))E/bracketleftigg/productdisplay
e∈EX(γ(e))
N(φ(e))/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
N
=:/summationdisplay
π∈P(V)/summationdisplay
φ:Vπ֒→[N]ζN(π,φ), (11)
where
(12) E/bracketleftigg/productdisplay
e∈EX(γ(e))
N(φ(e))/bracketrightigg
=Op(1)
uniformly in ( π,φ) by our moment assumption ( 1) and the ﬁniteness of γ(E)⊂I. Sinceφ:Vπ֒→
[N] is injective, the independence of our random variables all ows us to factor the expectation over
parallel edges. In particular, using the notation in Deﬁnit ion2.6,
E/bracketleftigg/productdisplay
e∈EX(γ(e))
N(φ(e))/bracketrightigg
=2/productdisplay
l=1/productdisplay
[e]π∈[E](l)
πE
/productdisplay
e′∈[e]πX(γ(e′))
N(φ(e′))
.
The centeredness of the oﬀ-diagonal random variables tells u s that
(13)/productdisplay
[e]π∈[E](2)
πE
/productdisplay
e′∈[e]πX(γ(e′))
N(φ(e′))
= 0
unless #([e]π)≥2 for every [ e]π∈[E](2)
π. So, we may restrict the outer sum in ( 11) to such
partitions. This leads us to deﬁne
(14) P+(V) :={π∈ P(V) : #([e]π)≥2 for every [ e]π∈[E](2)
π},
which allows us to rewrite ( 11) as
E[Tr(p(ZN)xNy∗
N)] =/summationdisplay
π∈P+(V)/summationdisplay
φ:Vπ֒→[N]ζN(π,φ).
We introduce some additional notation to control the inner s um. Recall that Lπ= (Vπ,[E](2)
π)
is the underlying simple graph of Lπ. Let (Vπ,[F]π) be a spanning tree of Lπ. Fore∈E, we deﬁne
⌊e⌋π:= argmin
e′∈[e]πb(γ(e′))
N= argmin
e′∈[e]πξ(γ(e′))
N.10 BENSON AU
In the event of a tie, we choose the leftmost edge in the path Lfor concreteness. Since the matrices
(B(i)
N)i∈Iare symmetric (0 ,1)-matrices of the form ( 2), we can bound the contribution from the
product
/productdisplay
e∈EB(γ(e))
N(φ(e)) =2/productdisplay
l=1/productdisplay
[e]π∈[E](l)
π/productdisplay
e′∈[e]πB(γ(e′))
N(φ(e′))
=/productdisplay
[e]π∈[E](2)
π/productdisplay
e′∈[e]πB(γ(e′))
N(φ(e′))
=/productdisplay
[e]π∈[E](2)
πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
≤/productdisplay
[e]π∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π)),
where the symmetry eliminates the ambiguity in the directio n of the edge ⌊e⌋πfor the purposes of
B(γ(⌊e⌋π))
N(φ(⌊e⌋π)). Combining this with the bound on the expectation ( 12), we obtain
ζN(π,φ) =Op
|xN(φ([vd]π))||yN(φ([v0]π))|/producttext
[e]π∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
e∈E/radicalig
ξ(γ(e))
N
.
This allows us to further restrict to partitions
P++(V) :={π∈ P(V) :Tπis a colored double tree } ⊂ P+(V)
at the cost of
(15)/summationdisplay
π∈P+(V)/summationdisplay
φ:Vπ֒→[N]ζN(π,φ) =/summationdisplay
π∈P++(V)/summationdisplay
φ:Vπ֒→[N]ζN(π,φ)+O
1
mine∈E/radicalig
ξ(γ(e))
N
.
Before proving this, note that if Tπis a double tree, then [ v0]π= [vd]π. Indeed, every vertex
in a double tree has even degree; however, every vertex v/\e}a⊔io\slash∈ {v0,vd}inThas degree two, while
degT(v0) = degT(vd) = 1. Since degTπ([v]π) =/summationtext
v′∼πvdegT(v′), the result follows.
To prove ( 15), assume that π∈ P+(V)\ P++(V). We consider two cases: [ v0]π/\e}a⊔io\slash= [vd]πand
[v0]π= [vd]π. If [v0]π/\e}a⊔io\slash= [vd]π, then there is a unique (necessarily nonempty) path from [ v0]πto
[vd]πin (Vπ,[F]π). We enumerate the edges [ f1]π,...,[fm]πon this path as well as the vertices
w0,...,wm. We separate the remaining edges [ F′]π= [F]π\{[f1]π,...,[fm]π}to bound
/summationdisplay
φ:Vπ֒→[N]|xN(φ([vd]π))||yN(φ([v0]π))|/producttext
[e]π∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
e∈E/radicalig
ξ(γ(e))
N
≤/summationdisplay
Φ:{wn}m
n=0→[N]|xN(Φ(wm))||yN(Φ(w0))|m/productdisplay
n=1B(γ(⌊fn⌋π))
N(Φ(wn−1),Φ(wn))
·/summationtext
Ψ:Vπ\{wn}m
n=0→[N]/producttext
[e]π∈[F′]πB(γ(⌊e⌋π))
N(Ψ(⌊e⌋π))
/producttext
e∈E/radicalig
ξ(γ(e))
N
=/producttext
[e]π∈[F′]πξ(γ(⌊e⌋π))
N
/producttext
e∈E/radicalig
ξ(γ(e))
N/summationdisplay
Φ:{wn}m
n=0→[N]|xN(Φ(wm))||yN(Φ(w0))|m/productdisplay
n=1B(γ(⌊fn⌋π))
N(Φ(wn−1),Φ(wn)),DEFORMED RANDOM BAND MATRICES 11
where we have again used the fact that the matrices ( B(i)
N)i∈Iare symmetric to ignore the directions
of the edges in writing B(γ(⌊fn⌋π))
N(Φ(⌊fn⌋π)) =B(γ(⌊fn⌋π))
N(Φ(wn−1),Φ(wn)). We recognize the
remaining sum as an inner product
/summationdisplay
Φ:{w0}m
n=1→[N]|xN(Φ(wm))||yN(Φ(w0))|m/productdisplay
n=1B(γ(⌊fn⌋π))
N (Φ(wn−1),Φ(wn)) =/angbracketleftiggm/productdisplay
n=1B(γ(⌊fn⌋π))
N |xN|,|yN|/angbracketrightigg
,
where|xN|,|yN|are the vectors obtained from xN,yNby applying the entrywise absolute value.
In particular, it is still the case that |xN|,|yN| ∈SN−1. Thus,/angbracketleftiggm/productdisplay
n=1B(γ(⌊fn⌋π))
N|xN|,|yN|/angbracketrightigg
≤/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddoublem/productdisplay
n=1B(γ(⌊fn⌋π))
N/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble
2
≤m/productdisplay
n=1/vextenddouble/vextenddouble/vextenddoubleB(γ(⌊fn⌋π))
N/vextenddouble/vextenddouble/vextenddouble
2=m/productdisplay
n=1ξ(γ(⌊fn⌋π))
N,
where the operator norm calculation follows from the observ ation that B(i)
Nis a real symmetric
(0,1)-matrix with every row sum equal to ξ(i)
N(see, for example, [ HJ13, Problem 5.6.P21]).
Putting everything together, we have that
/summationdisplay
φ:Vπ֒→[N]ζN(π,φ) =Op
/producttext
[e]π∈[F′]πξ(γ(⌊e⌋π))
N/producttextm
n=1ξ(γ(⌊fm⌋π))
N
/producttext
e∈E/radicalig
ξ(γ(e))
N

=Op
/producttext
[e]π∈[F]πξ(γ(⌊e⌋π))
N
/producttext
[e]π∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N
.
Sinceπ∈ P+(V)\P++(V), we know that
(16)ξ(γ(⌊e⌋π))
N
/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N≤1,∀[e]π∈[E](2)
π.
Furthermore, by deﬁnition, Tπis not a colored double tree. If Tπis a (miscolored) double tree,
then we are done since the independence and centeredness of t he oﬀ-diagonal entries would again
imply (13). So, we may assume that Tπis not a double tree. This means that either the underlying
simple graph is not a tree, in which case [ F]π/subsetnoteql[E]π, or the underlying simple graph is a tree, but
there is at least one edge [ e]πwith multiplicity #([ e]π)≥3. In either case, we see that
(17)/producttext
[e]π∈[F]πξ(γ(⌊e⌋π))
N
/producttext
[e]π∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N=Op
1
mine∈E/radicalig
ξ(γ(e))
N
.
The remaining case of π∈ P+(V)\P++(V) such that [ v0]π= [vd]πis treated much the same.
Indeed, the Cauchy-Schwarz inequality tells us that
/summationdisplay
φ:Vπ֒→[N]|xN(φ([vd]π))||yN(φ([v0]π))|/producttext
[e]π∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
e∈E/radicalig
ξ(γ(e))
N
≤/producttext
[e]π∈[F]ξ(γ(⌊e⌋π))
N
/producttext
[e]π∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
NN/summationdisplay
i=1|xN(i)||yN(i)|12 BENSON AU
≤/producttext
[e]π∈[F]ξ(γ(⌊e⌋π))
N
/producttext
[e]π∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N.
As before, we can assume that Tπis not a double tree, which again leads to the asymptotic ( 17).
We conclude that
/summationdisplay
π∈P+(V)\P++(V)/summationdisplay
φ:Vπ֒→[N]ζN(π,φ) =Op
1
mine∈E/radicalig
ξ(γ(e))
N
,
which proves ( 15).
To ﬁnish the proof, consider a partition π∈ P++(V). By deﬁnition, Tπis a colored double tree
such that [v0]π= [vd]π. We can think of performing the identiﬁcation v0π∼vdﬁrst and view Tπas
a quotient of the directed cycle Cp=Tˆπin (7), where the only nonsingleton block in ˆ πis{v0,vd}.
It is not hard to see that a quotient of a directed cycle is a dou ble tree only if each of its parallel
edges{e,e′}point in opposite directions (tar( e),src(e)) = (src(e′),tar(e′)) [Au18, Figure 5]. Thus,
the expectation in ζN(π,φ) can be computed entirely in terms of the variances:
/summationdisplay
φ:Vπ֒→[N]ζN(π,φ) =/summationdisplay
φ:Vπ֒→[N]xN(φ([vd]π))yN(φ([v0]π))E/bracketleftigg/productdisplay
e∈EX(γ(e))
N(φ(e))/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
N
=
/productdisplay
[e]∈[E]πσ2
γ(e)
/summationdisplay
Φ:{[v0]π}→[N]xN(Φ([v0]π))yN(Φ([v0]π))
·/parenleftigg/summationtext
Ψ:Vπ\{[v0]π}֒→[N]\{Φ([v0]π)}/producttext
[e]π∈[E]πB(γ(e))
N(Ψ(e))
/producttext
[e]∈[E]πξ(γ(e))
N/parenrightigg
.
As before, we can bound the number of maps Ψ that will produce a nonzero summand (necessarily
equal to 1) by
/summationdisplay
Ψ:Vπ\{[v0]π}֒→[N]\{Φ([v0]π)}/productdisplay
[e]π∈[E]πB(γ(e))
N(Ψ(e))≤/productdisplay
[e]π∈[E]πξ(γ(e))
N.
Since (Vπ,[E]π) is a tree, the only obstruction to equality is the required i njectivity of Ψ. This
gives the straightforward lower bound
/summationdisplay
Ψ:Vπ\{[v0]π}֒→[N]\{Φ([v0]π)}/productdisplay
[e]π∈[E]πB(γ(e))
N(Ψ(e))≥/productdisplay
[e]π∈[E]π(ξ(γ(e))
N−d),
where we recall that d≥#(Vπ)−1 is the degree of the monomial p(/vector z). We conclude that

/productdisplay
[e]∈[E]πσ2
γ(e)
/summationdisplay
Φ:{[v0]π}→[N]xN(Φ([v0]π))yN(Φ([v0]π))
·
/summationtext
Ψ:Vπ\{[v0]π}֒→[N]\{Φ([v0]π)}/producttext
[e]π∈[E]πB(γ(e))
N(Ψ(e))
/producttext
[e]∈[E]πξ(γ(e))
N

=/a\}⌊ra⌋ke⊔le{⊔xN,yN/a\}⌊ra⌋ke⊔ri}h⊔/productdisplay
[e]∈[E]πσ2
γ(e)+Op/parenleftigg
1
mine∈Eξ(γ(e))
N/parenrightigg
.
In view of the usual calculation for the normalized trace ( 9), we are done. /squareDEFORMED RANDOM BAND MATRICES 13
Remark 3.2.In the case of independent ( k(i)
N)i∈I-regular Wigner matrices
(Ξ(i)
N)i∈I=
1/radicalig
k(i)
N/tildewideB(i)
N◦X(i)
N

i∈I,
we simply need to replace all instances of B(i)
N(resp.,ξ(i)
N) with/tildewideB(i)
N(resp.,k(i)
N) in the proof with
one notable exception. In particular, for periodic (0 ,1)-band matrices ( B(i)
N)i∈I, we repeatedly used
the identity
◦e′∈[e]πB(γ(e′))
N=B(γ(⌊e⌋π))
N,
where we recall that ◦denotes the entrywise product. While this no longer holds in general for
(/tildewideB(i)
N)i∈I, it is true that ◦e′∈[e]π/tildewideB(γ(e′))
Nis a symmetric (0 ,1)-matrix with row sums bounded by
k(γ(⌊e⌋π))
N:= mine′∈[e]πk(γ(e′))
N, which is all that is needed to carry forward the same argumen t.
Having computedthe expectation, weproceed toprovingconc entration. For this, weuseabound
on central moments.
Lemma 3.3 (Central moments) .For(ps(/vector z))r
s=1⊂C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔and(x(s)
N)r
s=1,(y(s)
N)r
s=1⊂SN−1,
E/bracketleftiggr/productdisplay
s=1/parenleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig
−E/bracketleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig/bracketrightig/parenrightig/bracketrightigg
=Op1,...,pr/parenleftigg/bracketleftbigg
min
i∈Ip1,...,pr/radicalig
ξ(i)
N/bracketrightbigg−r/parenrightigg
.
As before, the constant in the asymptotic does not depend on t he unit vectors (x(s)
N)r
s=1,(y(s)
N)r
s=1.
Proof.By multilinearity, we may assume that each ps(/vector z) =zis(1)···zis(ds)is a monomial. To
simplify the notation, we abbreviate the test graph Tps= (Lps,γps) in (10) toTs= (Ls,γs). We
also deﬁneT= (G,γ) to be the disjoint union T=⊔r
s=1Tsof the test graphs ( Ts)r
s=1. The analogue
of (11) for central moments can then be written as
E/bracketleftiggr/productdisplay
s=1/parenleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig
−E/bracketleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig/bracketrightig/parenrightig/bracketrightigg
=E
r/productdisplay
s=1
/summationdisplay
φs:Vs→[N]x(s)
N(φs(v(s)
ds))y(s)
N(φs(v(s)
0))/parenleftigg/productdisplay
e∈EsΞ(γs(e))
N(φs(e))−E/bracketleftigg/productdisplay
e∈EsΞ(γs(e))
N(φs(e))/bracketrightigg/parenrightigg


=/summationdisplay
φ:V→[N]/parenleftiggr/productdisplay
s=1x(s)
N(φ(v(s)
ds))y(s)
N(φ(v(s)
0))/parenrightigg
E/bracketleftiggr/productdisplay
s=1/parenleftigg/productdisplay
e∈EsΞ(γ(e))
N(φ(e))−E/bracketleftigg/productdisplay
e∈EsΞ(γ(e))
N(φ(e))/bracketrightigg/parenrightigg/bracketrightigg
=/summationdisplay
π∈P(V)/summationdisplay
φ:Vπ֒→[N]/parenleftiggr/productdisplay
s=1x(s)
N(φ([v(s)
ds]π))y(s)
N(φ([v(s)
0]π))/parenrightigg
·E/bracketleftiggr/productdisplay
s=1/parenleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))−E/bracketleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))/bracketrightigg/parenrightigg/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
N
=:/summationdisplay
π∈P(V)/summationdisplay
φ:Vπ֒→[N]ηN(φ,π).
WerepeattwooftheearlystepsintheproofofLemma 3.1. Inparticular, ourmomentassumption
(1) implies that
E/bracketleftiggr/productdisplay
s=1/parenleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))−E/bracketleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))/bracketrightigg/parenrightigg/bracketrightigg
=Op1,...,pr(1)14 BENSON AU
uniformly in ( π,φ) with
E/bracketleftiggr/productdisplay
s=1/parenleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))−E/bracketleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))/bracketrightigg/parenrightigg/bracketrightigg
= 0
unless #([e]π)≥2 for every e∈[E](2)
π. Since we are considering central moments, we can say even
more. In particular, we say that TsandTs′have anedge overlay in Tπif there exist edges es∈Es
andes′∈Es′such that [es]π= [es′]π. The edge overlays deﬁne a natural equivalence relation ∼E,π
on [r] as follows:
s∼E,πs′⇐⇒ ∃s0,...,sn∈[r] :Tst−1andTsthave an edge overlay in Tπfor everyt∈[n],
wheres0=sandsn=s′. We use the notation [ s]E,π={s′∈[r] :s′∼E,πs} ∈[r]/∼E,πto avoid
confusion with [ v]π∈Vπand [e]π∈[E]π. This allows us to factor
E/bracketleftiggr/productdisplay
s=1/parenleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))−E/bracketleftigg/productdisplay
e∈EsX(γ(e))
N(φ(e))/bracketrightigg/parenrightigg/bracketrightigg
=/productdisplay
[s]E,π∈[r]/∼E,πE
/productdisplay
s′∈[s]E,π
/productdisplay
e∈Es′X(γ(e))
N(φ(e))−E
/productdisplay
e∈Es′X(γ(e))
N(φ(e))


,
which is equal to 0 by the centering unless #([ s]E,π)≥2 for every s∈[r]. In other words, the
expectation vanishes unless every test graph Tshas an edge overlay in Tπwith at least one other
test graphTs′. This leads us to deﬁne
P×(V) :={π∈ P+(V) : #([s]E,π)≥2 for every s∈[r]},
where we recall the deﬁnition of P+(V) in (14). The central moment calculation then reduces to
E/bracketleftiggr/productdisplay
s=1/parenleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig
−E/bracketleftig
Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig/bracketrightig/parenrightig/bracketrightigg
=/summationdisplay
π∈P×(V)/summationdisplay
φ:Vπ֒→[N]ηN(φ,π),
where
ηN(φ,π) =Op1,...,pr
/bracketleftiggr/productdisplay
s=1/vextendsingle/vextendsingle/vextendsinglex(s)
N(φ([v(s)
ds]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s)
N(φ([v(s)
0]π))/vextendsingle/vextendsingle/vextendsingle/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
N
.
The equivalence relation ∼[E]πis not necessarily equal to the equivalence relation on [ r] deﬁned
by the connected components of Tπ= (⊔r
s=1Ts)π. In particular, if
V([s]E,π) :={[v]π∈Vπ:v∈Ts′for somes′∼E,πs},
then it could be that V([s]E,π)∩V([s′]E,π)/\e}a⊔io\slash=∅for [s]E,π/\e}a⊔io\slash= [s′]E,π. Nevertheless, it is true that
/bracketleftiggr/productdisplay
s=1/vextendsingle/vextendsingle/vextendsinglex(s)
N(φ([v(s)
ds]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s)
N(φ([v(s)
0]π))/vextendsingle/vextendsingle/vextendsingle/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
N
=/productdisplay
[s]E,π∈[r]/∼E,π
/productdisplay
s′∈[s]E,π
/vextendsingle/vextendsingle/vextendsinglex(s′)
N(φ([v(s′)
ds′]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s′)
N(φ([v(s′)
0]π))/vextendsingle/vextendsingle/vextendsingle/producttext
e∈Es′B(γ(e))
N(φ(e))
/producttext
e∈Es′/radicalig
ξ(γ(e))
N

,
whence
/summationdisplay
φ:Vπ֒→[N]/bracketleftiggr/productdisplay
s=1/vextendsingle/vextendsingle/vextendsinglex(s)
N(φ([v(s)
ds]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s)
N(φ([v(s)
0]π))/vextendsingle/vextendsingle/vextendsingle/bracketrightigg/producttext
e∈EB(γ(e))
N(φ(e))
/producttext
e∈E/radicalig
ξ(γ(e))
NDEFORMED RANDOM BAND MATRICES 15
≤/productdisplay
[s]E,π∈[r]/∼E,π/summationdisplay
φ:V([s]E,π)→[N]/productdisplay
s′∈[s]E,π
/vextendsingle/vextendsingle/vextendsinglex(s′)
N(φ([v(s′)
ds′]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s′)
N(φ([v(s′)
0]π))/vextendsingle/vextendsingle/vextendsingle/producttext
e∈Es′B(γ(e))
N(φ(e))
/producttext
e∈Es′/radicalig
ξ(γ(e))
N
.
Thus, it suﬃces to prove that
/summationdisplay
φ:V([s]E,π)→[N]/productdisplay
s′∈[s]E,π
/vextendsingle/vextendsingle/vextendsinglex(s′)
N(φ([v(s′)
ds′]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s′)
N(φ([v(s′)
0]π))/vextendsingle/vextendsingle/vextendsingle/producttext
e∈Es′B(γ(e))
N(φ(e))
/producttext
e∈Es′/radicalig
ξ(γ(e))
N

=Op1,...,pr/parenleftigg/bracketleftbigg
min
i∈Ip1,...,pr/radicalig
ξ(i)
N/bracketrightbigg−#([s]E,π)/parenrightigg
.
Without loss of generality, we may then assume that there is o nly one equivalence class [ s]E,π= [r],
which allows usto cut down on notation. Inparticular, wehav e reducedthe problemto establishing
(18)/summationdisplay
φ:Vπ→[N]r/productdisplay
s=1
/vextendsingle/vextendsingle/vextendsinglex(s)
N(φ([v(s)
ds]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s)
N(φ([v(s)
0]π))/vextendsingle/vextendsingle/vextendsingle/producttext
e∈EsB(γ(e))
N(φ(e))
/producttext
e∈Es/radicalig
ξ(γ(e))
N

=Op1,...,pr/parenleftigg/bracketleftbigg
min
i∈Ip1,...,pr/radicalig
ξ(i)
N/bracketrightbigg−r/parenrightigg
.
Intuitively, each test graph Tsis responsible for a factor of/bracketleftbigg
mini∈Ip1,...,pr/radicalig
ξ(i)
N/bracketrightbigg−1
via the unit
vectorsx(s)
N,y(s)
Nor a defect in the underlying simple graph Gπ= (Vπ,[E](2)
π) from an edge overlay.
To formalize this, it will be convenient to introduce some ad ditional notation to gather the relevant
terms. We deﬁne
(w1,...,w 2r) := (v(1)
0,v(1)
d1,...,v(r)
0,v(r)
d1);
(u(1)
N,...,u(2r)
N) := (|x(1)
N|,|y(1)
N|,...,|x(r)
N|,|y(r)
N|)∈(SN−1
≥0)2r,
in which case
r/productdisplay
s=1
/vextendsingle/vextendsingle/vextendsinglex(s)
N(φ([v(s)
ds]π))/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingley(s)
N(φ([v(s)
0]π))/vextendsingle/vextendsingle/vextendsingle/producttext
e∈EsB(γ(e))
N(φ(e))
/producttext
e∈Es/radicalig
ξ(γ(e))
N

=2r/productdisplay
s=1u(s)
N(φ([ws]π))/producttext
[e]∈[E]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
[e]∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N
≤2r/productdisplay
s=1u(s)
N(φ([ws]π))/producttext
[e]∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
[e]∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N
for any spanning tree ( Vπ,[F]π) ofGπ. The unit vectors further reduce the numerator by virtue
of the Cauchy-Schwarz inequality, which implies that for an yS⊂[N],
(19)/summationdisplay
i∈Su(s)
N(i)≤/radicalbig
#(S),
/summationdisplay
i∈Su(s)
N(i)u(s′)
N(i)≤1;16 BENSON AU
however, in general, one cannot do better than
(20)/summationdisplay
i∈S/productdisplay
s∈Su(s)
N(i)≤1
forS⊂[2r] such that #( S)≥2, where we have used the fact that /⌊ard⌊lu(s)
N/⌊ard⌊l∞≤ /⌊ard⌊lu(s)
N/⌊ard⌊l2= 1.
Tokeep track of theunit vectors, we distinguishthe vertice sVout:={w1,...,w 2r} ⊂Vby calling
themouter. We refer to the remaining vertices Vin:=V\Voutasinner. For a partition π∈ P(V),
we separate the blocks according to their inner/outer compo sition:
π(a,b)={B∈π: #(B∩Vout) =a,#(B∩Vin) =b}.
We separate the vertices in a similar manner:
V(a,b)
π=/uniondisplay
B∈π(a,b)B.
By a slight abuse of notation, we also write expressions such asπ(a,≥b)andV(a,≥b)
πfor the obvious
analogues.
Without the unit vectors, we have the equality
/summationdisplay
φ:Vπ→[N]/producttext
[e]∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
[e]∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N=N/producttext
[e]∈[F]πξ(γ(⌊e⌋π))
N
/producttext
[e]∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N,
where #(π) = #([F]π)+1 since ( Vπ,[F]π) is a spanning tree. We know how to remove the factor
ofNin the numerator at the cost of either two blocks in #( π(1,≥0)) or one block in #( π(≥2,≥0))
from the proof of Proposition 3.6. When assigning the remaining values of φ, we can use ( 19) and
(20) to reduce a term ξ(γ(⌊e⌋π))
Nin the numerator to either/radicalig
ξ(γ(⌊e⌋π))
N(if the block B∈Vπbelongs
toπ(1,≥0)) or 1 (if the block B∈Vπbelongs toπ(≥2,≥0)). Sinceπ∈ P+(V), we still have ( 16) to
handle the blocks B∈π(0,≥1). Thus, reintroducing the unit vectors, we arrive at the boun d
/summationdisplay
φ:Vπ→[N]2r/productdisplay
s=1u(s)
N(φ([ws]π))/producttext
[e]∈[F]πB(γ(⌊e⌋π))
N(φ(⌊e⌋π))
/producttext
[e]∈[E]π/producttext
e′∈[e]π/radicalig
ξ(γ(e′))
N
≤/bracketleftbigg
min
i∈Ip1,...,prξ(i)
N/bracketrightbigg/parenleftbigg
[#(π)−1]−/bracketleftbigg
#(π(1,≥0))
2+#(π(≥2,≥0))−1/bracketrightbigg/parenrightbigg
−/summationtextr
s=1ds
2
,
wheredsis the number of edges in the test graph Ts. Thus, ( 18) will follow if we can prove that
forπ∈ P+(V) such that [ s]E,π= [r],
/bracketleftigg
#(π)−#(π(1,≥0))
2−#(π(≥2,≥0))/bracketrightigg
−/summationtextr
s=1ds
2≤ −r
2,
or, equivalently,
(21)#(π(1,≥1))
2+#(π(0,≥1))+r
2≤/summationtextr
s=1ds
2,
where we have used the fact that π∈ P+(V) forcesπ(1,≥0)=π(1,≥1).
We prove ( 21) by induction on the total number of edges D=/summationtextr
s=1dswith the base cases
D= 2,3 (cf. [AGV, Proposition 4.4]). Note that centrality allows us to restr ict tor≥2 since
otherwise the moment bound is trivially true. The case of D= 2 then corresponds to r= 2 and
d1=d2= 1, which has no inner vertices. Thus, π(1,≥1)=π(0,≥1)=∅, and (21) follows.DEFORMED RANDOM BAND MATRICES 17
Ts0v1v0v2e1e2π
{v1,v2}B
/tildewideTs0˜v2
Figure 1. Anexampleofthepinchingoﬀofthetwoedgesadjacentto v0inTs0asnecessitatedby π∈ P+(V).
SinceB={v0} ∈π(0,1), this is the only way the edges adjacent to v0can satisfy the condition #([ e]π)≥2.
IfD= 3, then there are two possibilities. First, it could be that r= 3 andd1=d2=d3= 1.
As before, there are no inner vertices in this case, and so we a re done. If r= 2, then {d1,d2}=
{1,2}. Thus, there is exactly one inner vertex; however, the manda tory edge overlay between T1
andT2means that this lone inner vertex will be merged with at least one outer vertex, whence
#(π(0,≥1)) = 0 and #( π(1,≥1))≤1. Plugging everything in, we again have ( 21).
Now suppose that D≥4. If #(π(0,1))≤#(π(1,≥2)), then we are done. Indeed, in this case,
#(π(1,≥1))
2+#(π(0,≥1)) =#(π(1,1))+#(π(1,≥2))
2+#(π(0,1))+#(π(0,≥2))
≤#(π(1,1))
2+#(π(1,≥2))+#(π(0,1))
2+#(π(0,≥2))
≤#(V(1,1)
π∩Vin)
2+#(V(1,≥2)
π∩Vin)
2+#(V(0,1)
π∩Vin)
2+#(V(0,≥2)
π∩Vin)
2
≤#(Vin)
2
=/summationtextr
s=1(ds−1)
2
=D−r
2.
So, we can assume that #( π(0,1))>#(π(1,≥2)). LetB∈π(0,1)/\e}a⊔io\slash=∅. This means that B={v0}
consists of a single inner vertex, say belonging to the test g raphTs0. Sinceπ∈ P+(V), it must be
that the two vertices v1,v2adjacent to v0inTs0are identiﬁed by π. This corresponds to pinching
oﬀ the two edges e1,e2incident to v0inTs0. The block Bis then necessarily a leaf in Tπwith
exactly two incident edges in Tπ. The remainder of Tπcan therefore be constructed as a quotient
of the disjoint union of ( Ts)s∈[r]\{s0}and a shortened version of Ts0by two edges. See Figure 1for
an illustration. Note that we must have ds0≥3; otherwise, ds0= 2 and an edge overlay between
Ts0and any other Tswould contradict B∈π(0,1).
To apply the induction hypothesis, let /tildewideTs0be the test graph obtained from Ts0by removing v0,
its two incident edges, and merging v1andv2into a vertex ˜ v2. Ifv2is inner (resp., outer), then so
too is ˜v2in/tildewideTs0. The partition πdeﬁnes a natural partition ˜ πof the vertices of the disjoint union
⊔s∈[r]\{s0}Ts⊔/tildewideTs0as follows. For a block B′∈π\{B}, we deﬁne
(22) f(B′) =/braceleftigg
(B′\{v1,v2})∪{˜v2}ifv1,v2∈B′;
B′else.
These new blocks make up the partition
˜π={f(B′) :B′∈π\{B}} ∈ P/parenleftig
(V\{v0,v1,v2})∪{˜v2}/parenrightig
.18 BENSON AU
SinceBwas a leaf in Tπwith exactly two incident edges e1,e2inTπ, the partition ˜ πstill satisﬁes
(23) #([ e]˜π)≥2,∀e∈E\{e1,e2},
meaning ˜π∈ P+/parenleftig
(V\ {v0,v1,v2})∪ {˜v2}/parenrightig
. Furthermore, as noted earlier, neither e1nore2can
participate in an edge overlay between Ts0and some other Tsdue to the fact that B∈π(1,0). So,
any such overlay is preserved in ( ⊔s∈[r]\{s0}Ts⊔/tildewideTs0)˜π, meaning there is still only one equivalence
class [s]E\{e1,e2},˜π= [r]. The induction hypothesis then allows us to conclude that
#(˜π(1,≥1))
2+#(˜π(0,≥1))+r
2≤/summationtext
s∈[r]\s0ds+˜ds0
2=/summationtextr
s=1ds−2
2.
We must now relate ˜ π(1,≥1)and ˜π(0,≥1)toπ(1,≥1)andπ(0,≥1)respectively. By deﬁnition ( 22),f
changes the composition of exactly one block [ v1]π= [v2]π, decreasing the number of inner vertices
in this block by one and leaving all other blocks untouched. I fv2is outer, then [ v2]π∈π(≥1,≥1)
andf([v2]π)∈˜π(≥1,≥0). Ifv2is inner, then [ v2]π∈π(≥0,≥2)andf([v2]π)∈˜π(≥0,≥1). In either case,
the mapfrestricts to a bijection between π(0,≥1)\{B}and ˜π(0,≥1), whence
#(˜π(0,≥1)) = #(π(0,≥1))−1.
Similarly,frestricts to a bijection between π(1,≥0)and ˜π(1,≥0); however, as we have already seen,
condition ( 14) (resp., ( 23)) forcesπ(1,≥0)=π(1,≥1)(resp., ˜π(1,≥0)= ˜π(1,≥1)), whence
#(π(1,≥1)) = #(˜π(1,≥1)).
Putting everything together, we obtain
#(π(1,≥1))
2+#(π(0,≥1))+r
2= #(˜π(1,≥1))+#(˜π(0,≥1))+1+r
2
≤/summationtextr
s=1ds−2
2+1
=/summationtextr
s=1ds
2,
as was to be shown. /square
Remark 3.4.In the case of independent ( k(i)
N)i∈I-regular Wigner matrices, one needs only to carry
forward the same modiﬁcations from Remark 3.2. The upper bound in Lemma 3.3is easily seen to
be sharp and can be achieved by overlaying copies of lines to o btain a forest of double trees.
Corollary 3.5 (Concentration) .Forp(/vector z)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔,r∈N, andxN,yN∈SN−1,
P(|Tr(p(ZN)xNy∗
N)−E[Tr(p(ZN)xNy∗
N)]| ≥ε) =Op,r,ε/parenleftigg/bracketleftbigg
min
i∈Ip/radicalig
ξ(i)
N/bracketrightbigg−r/parenrightigg
.
Proof.Sinceb(i)
N≫1 for eachi∈I, it suﬃces to prove the result for r= 2meven. We deﬁne a
conjugate linear involution ∗:C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔ →C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔by its action on monomials:
(zi(1)···zi(d))∗=zi(d)···zi(1).
Since the matrices ZN= (Ξ(i)
N)i∈Iare Hermitian, this operation commutes with the usual matri x
adjoint:
[p(ZN)]∗=p∗(ZN),
We use this to write the complex conjugate of our weighted tra ce as yet another weighted trace
Tr(p(ZN)xNy∗
N) = Tr([p(ZN)xNy∗
N]∗) = Tr(p∗(ZN)yNx∗
N).DEFORMED RANDOM BAND MATRICES 19
In particular, the squared modulus can be written as a produc t
|Tr(p(ZN)xNy∗
N)−E[Tr(p(ZN)xNy∗
N)]|2
=/parenleftig
Tr(p(ZN)xNy∗
N)−E[Tr(p(ZN)xNy∗
N)]/parenrightig/parenleftig
Tr(p∗(ZN)yNx∗
N)−E[Tr(p∗(ZN)yNx∗
N)]/parenrightig
.
The result then follows from Lemma 3.3and Markov’s inequality. /square
We can now prove the isotropic global law. We recall the notat ionP→for convergence in proba-
bility.
Proposition 3.6 (Isotropic global law) .Let(x(s)
N)r
s=1,(y(s)
N)r
s=1⊂SN−1be such that
lim
N→∞/a\}⌊ra⌋ke⊔le{⊔x(s)
N,y(s)
N/a\}⌊ra⌋ke⊔ri}h⊔=cs.
Ifp1(/vector z),...,pr(/vector z)∈C/a\}⌊ra⌋ke⊔le{⊔zi:i∈I/a\}⌊ra⌋ke⊔ri}h⊔, then
Tr/parenleftiggr/productdisplay
s=1x(s−1)
Ny(s)
N∗ps(ZN)/parenrightigg
P→r/productdisplay
s=1/bracketleftbig
csτZ(ps)/bracketrightbig
,
wherex(r)
N=x(0)
N. Ifmini∈Ip1,...,prξ(i)
N≫Nεfor someε>0, then this convergence can be upgraded
to the almost sure sense:
lim
N→∞Tr/parenleftiggr/productdisplay
s=1x(s−1)
Ny(s)
N∗ps(ZN)/parenrightigg
a.s.=r/productdisplay
s=1/bracketleftbig
csτZ(ps)/bracketrightbig
.
Proof.We start by rewriting the trace in question into a product of t races:
Tr/parenleftiggr/productdisplay
s=1x(s−1)
Ny(s)
N∗ps(ZN)/parenrightigg
=r/productdisplay
s=1/angbracketleftig
ps(ZN)x(s)
N,y(s)
N/angbracketrightig
=r/productdisplay
s=1Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig
.
Thus, it suﬃces to prove the stated convergence for a single t erm Tr/parenleftig
ps(ZN)x(s)
Ny(s)
N∗/parenrightig
. Conver-
gence in probability follows from Lemma 3.1and Corollary 3.5. If mini∈Ip1,...,prξ(i)
N≫Nεfor some
ε>0, then we can choose a suﬃciently large value of rin Corollary 3.5to apply the Borel-Cantelli
lemma and upgrade the convergence to the almost sure sense. /square
3.2.Proof of Theorem 1.3.We elaborate on the outline of the proof given in the introduc tion.
While many of the details are routine, we commit them here for completeness. Recall the notation
MN=ΞN+AN=/summationtextN
k=1λk(MN)m(k)
Nm(k)
N∗for the spectral decomposition of the spiked RBM
model, and likewise for the perturbation AN=/summationtextr
s=1θsa(s)
Na(s)
N∗. We assume that ξN≫Nεfor
someε>0. We start with a straightforward consequence of the isotro pic global law.
Lemma 3.7. Fors′∈[r], the spectral measure µa(s′)
N
MNconverges weakly almost surely to
µθs′(dx) =1{|x| ≤2σ}
2π√
4σ2−x2
θ2
s′+σ2−θs′xdx+1{|θs′|>σ}/parenleftbigg
1−σ2
θ2
s′/parenrightbigg
δθs′+σ2
θs′(dx).
Proof.Since the eigenvectors ( a(s)
N)s∈[r]are orthonormal, Proposition 3.6tells us that
lim
N→∞/angbracketleftig
Mm
Na(s′)
N,a(s′)
N/angbracketrightig
= lim
N→∞Tr/parenleftigg
a(s′)
Na(s′)
N∗/parenleftigg
ΞN+r/summationdisplay
s=1θsa(s)
Na(s)
N∗/parenrightiggm/parenrightigg
a.s.= lim
N→∞Tr/parenleftig
a(s′)
Na(s′)
N∗/parenleftig
WN+θs′a(s′)
Na(s′)
N∗/parenrightigm/parenrightig20 BENSON AU
= lim
N→∞/angbracketleftig/parenleftig
WN+θs′a(s′)
Na(s′)
N∗/parenrightigm
a(s′)
N,a(s′)
N/angbracketrightig
,
whereWNis a Wigner matrix. Thus, the moments of µa(s′)
N
MNand the moments of µa(s′)
N
WN+θs′a(s′)
Na(s′)
N∗
converge to the same deterministic sequence ( m1,m2,...)∈RNalmost surely. Noiry proved that
the spectral measure µa(s′)
N
WN+θs′a(s′)
Na(s′)
N∗converges weakly almost surely to µθs′[Noi21, Proposition
2]: theﬁniteness of thelimiting moments mi<∞furtherimpliesthat themoments of µθs′aregiven
by the same sequence ( m1,m2,...). Being compactly supported, the distribution µθs′is uniquely
determinedbyits moments. Consequently, themoment conver gence ofµa(s′)
N
MNto(m1,m2,...) implies
thatµa(s′)
N
MNconverges weakly almost surely to µθs′. /square
To prove the eigenvalue BBP transition (S1)forMN, we use the classical Weyl interlacing
inequality specialized to a rank one perturbation [ HJ13, Corollary 4.3.9].
Proposition 3.8 (Weyl).LetHN∈MatN(C)be Hermitian and vN∈SN−1. Ifθ>0, then
λk(HN)≤λk(HN+θvNv∗
N)≤λk+1(HN), k= 1,...,N−1;
λN(HN)≤λN(HN+θvNv∗
N).
We can now give the
Proof of Theorem 1.3.First, assume that the ( θs)r
s=1are distinct. We prove the result by induction
onr. The base case of r= 1 corresponds to a rank one perturbation MN=ΞN+θ1a(1)
Na(1)
N∗.
Without loss of generality, we may assume that θ1>0. Applying Lemma 3.7to the explicit form
of the spectral measure in Example 2.2, we obtain the almost sure weak convergence
(24)lim
N→∞µa(1)
N
MN= lim
N→∞N/summationdisplay
k=1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(1)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2
δλk(MN)
a.s.=1{|x| ≤2σ}
2π√
4σ2−x2
θ2
1+σ2−θ1xdx+1{|θ1|>σ}/parenleftbigg
1−σ2
θ2
1/parenrightbigg
δθ1+σ2
θ1(dx).
The strong convergence of ΞNand the interlacing inequality imply that there is at most on e outlier:
lim
N→∞λ1(MN)a.s.=−2σ;
lim
N→∞λN−1(MN)a.s.= 2σ.
In particular, if θ1∈(σ,∞), then the atom located at θ1+σ2
θ1>2σin the limiting spectral measure
(24) must originate from λN(MN), whence
lim
N→∞λN(MN)a.s.=θ1+σ2
θ1;
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(1)
N,m(N)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 1−σ2
θ2
1.
Note that theinterlacing inequality alsoimplies that λN(MN) is anondecreasingfunction of θ1>0.
Ifθ1∈(0,σ], then we can use this monotonicity to deduce that
lim
N→∞λN(MN)a.s.= 2σ.DEFORMED RANDOM BAND MATRICES 21
The lack of an atom at 2 σin the limiting spectral measure ( 24) in this case then implies
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(1)
N,m(N)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 0.
Now assume the result for some r≥1 and consider a rank r+1 perturbation
MN=ΞN+r+1/summationdisplay
s=1θsa(s)
Na(s)
N∗
=/parenleftigg
ΞN+r/summationdisplay
s=1θsa(s)
Na(s)
N∗/parenrightigg
+θr+1a(r+1)
Na(r+1)
N∗
=/tildewiderMN+θr+1a(r+1)
Na(r+1)
N∗.
We recall the assumption θ1<···<θr+1are nonzero and the notation
L−σ= #({s∈[r] :θs<−σ});
L+σ= #({s∈[r] :θs>σ}).
Without loss of generality, we may assume that θr+1>0. By the induction hypothesis, we know
that/tildewiderMN=/summationtextN
k=1λk(/tildewiderMN)/tildewidem(k)
N/tildewidem(k)
N∗satisﬁes
(25)lim
N→∞λk(/tildewiderMN)a.s.=θk+σ2
θk<−2σ,∀k∈[L−σ];
lim
N→∞λL−σ+1(/tildewiderMN)a.s.=−2σ;
lim
N→∞λN+1−k(/tildewiderMN)a.s.=θr+1−k+σ2
θr+1−k>2σ,∀k∈[L+σ];
lim
N→∞λN−L+σ(/tildewiderMN)a.s.= 2σ.
Once again, we use Lemma 3.7to compute the limiting spectral measure
(26)lim
N→∞µa(s)
N
MN= lim
N→∞N/summationdisplay
k=1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2
δλk(MN)
a.s.=1{|x| ≤2σ}
2π√
4σ2−x2
θ2s+σ2−θsxdx+1{|θs|>σ}/parenleftbigg
1−σ2
θ2s/parenrightbigg
δθs+σ2
θs(dx)
for anys∈[r+1]. Since the ( θs)r+1
s=1are distinct and the function x/ma√s⊔o→x+σ2
xis injective for |x| ≥σ,
the interlacing inequality applied to the rank one perturba tionMN=/tildewiderMN+θr+1a(r+1)
Na(r+1)
N∗and
the convergences in ( 25) imply that the weak convergence in ( 26) holds only if
lim
N→∞λk(MN)a.s.=θk+σ2
θk,∀k∈[L−σ];
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.=1{s=k}/parenleftbigg
1−σ2
θ2
k/parenrightbigg
,∀(s,k)∈[r+1]×[L−σ];
lim
N→∞λL−σ+1(MN)a.s.=−2σ;
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 0,∀s∈[r+1] ifθk∈[−σ,0);
lim
N→∞λN(MN)a.s.=

θr+1+σ2
θr+1ifθr+1∈(σ,∞);
2σ ifθr+1∈(0,σ];22 BENSON AU
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(N)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.=

1{s=r+1}/parenleftbigg
1−σ2
θ2
r+1/parenrightbigg
∀s∈[r+1] ifθr+1∈(σ,∞);
0, ∀s∈[r+1] ifθr+1∈(0,σ].
Roughly speaking, we work our way in from the left edge of the s pectrum using the trap λ1(/tildewiderMN)≤
λ1(MN). Having established the right edge of the spectrum using th e lower bound λN(/tildewiderMN)≤
λN(MN), we can repeat the argument above and work our way in from the other direction using
the trapλN−1(MN)≤λN(/tildewiderMN). Thus,
lim
N→∞λN−k(MN)a.s.=θr+1−k+σ2
θr+1−k,∀k∈[L+σ];
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(N−k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.=1{s=r+1−k}/parenleftigg
1−σ2
θ2
r+1−k/parenrightigg
,∀(s,k)∈[r+1]×[L+σ];
lim
N→∞λN−1−L+σ(MN)a.s.= 2σ;
lim
N→∞/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(N−k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 0,∀s∈[r+1] ifθr+1−k∈(0,σ],
which completes the induction step.
To prove the general case, we no longer assume that the nontri vial eigenvalues θ1≤ ··· ≤θr
of the perturbation AN=/summationtextr
s=1θsa(s)
Na(s)
N∗are necessarily simple. So, let Θ 1<···<Θqbe the
distinct values of ( θs)r
s=1andmt= dim(ker(Θ tIN−AN)) the multiplicity of Θ t. A standard
continuity argument using the Hoﬀman-Wielandt inequality [ HJ13, Corollary 6.3.8] proves the
eigenvalue BBP transition (S1)forMNfrom our earlier result in the case of distinct ( θs)r
s=1(see,
for example, [ BGN11, Section 6.2.3]). From there, we can once again use the conve rgence of the
spectral measure ( 26) to deduce that for any ( s,t)∈[r]×[q],
lim
N→∞/summationtextt
i=1mi/summationdisplay
k=/summationtextt−1
i=1mi+1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.=1/braceleftigg
s∈/bracketleftiggt−1/summationdisplay
i=1mi+1,t/summationdisplay
i=1mi/bracketrightigg/bracerightigg/parenleftbigg
1−σ2
Θ2
t/parenrightbigg
if Θt<−σ;
lim
N→∞/summationtextt
i=1mi/summationdisplay
k=/summationtextt−1
i=1mi+1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 0 if Θt∈[−σ,0);
lim
N→∞/summationtextq
i=tmi/summationdisplay
k=/summationtextq
i=t+1mi+1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(N+1−k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.=1/braceleftigg
s∈/bracketleftiggt−1/summationdisplay
i=1mi+1,t/summationdisplay
i=1mi/bracketrightigg/bracerightigg/parenleftbigg
1−σ2
Θ2
t/parenrightbigg
if Θt>σ;
lim
N→∞/summationtextq
i=tmi/summationdisplay
k=/summationtextq
i=t+1mi+1/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
a(s)
N,m(N+1−k)
N/angbracketrightig/vextendsingle/vextendsingle/vextendsingle2a.s.= 0 if Θt∈(0,σ].
Note that this already proves the nonalignment in the eigenv ector BBP transition (S4)and the
second part of (S3); however, we do not have access to the projections of the indi vidual eigenvectors
m(k)
N/m(N+1−k)
Nonto the a(s)
N. Summingthe alignment over s∈[r], we obtain the weaker statement
lim
N→∞/summationtextt
i=1mi/summationdisplay
k=/summationtextt−1
i=1mi+1/vextenddouble/vextenddouble/vextenddoublePker(ΘtIN−AN)(m(k)
N)/vextenddouble/vextenddouble/vextenddouble2
2a.s.=mt/parenleftbigg
1−σ2
Θ2
t/parenrightbigg
if Θt<−σ;DEFORMED RANDOM BAND MATRICES 23
lim
N→∞/summationtextq
i=tmi/summationdisplay
k=/summationtextq
i=t+1mi+1/vextenddouble/vextenddouble/vextenddoublePker(ΘtIN−AN)(m(N+1−k)
N)/vextenddouble/vextenddouble/vextenddouble2
2a.s.=mt/parenleftbigg
1−σ2
Θ2
t/parenrightbigg
if Θt>σ.
Nevertheless, one can repeat the perturbation argument in [ Cap13, Section 5] to once again deduce
the result from the earlier case of distinct ( θs)r
s=1. We conclude that
lim
N→∞/vextenddouble/vextenddouble/vextenddoublePker(ΘtIN−AN)(m(k)
N)/vextenddouble/vextenddouble/vextenddouble2
2a.s.= 1−σ2
Θ2
t,∀k∈/bracketleftiggt−1/summationdisplay
i=1mi+1,t/summationdisplay
i=1mi/bracketrightigg
if Θt<−σ;
lim
N→∞/vextenddouble/vextenddouble/vextenddoublePker(ΘtIN−AN)(m(N+1−k)
N)/vextenddouble/vextenddouble/vextenddouble2
2a.s.= 1−σ2
Θ2
t,∀k∈/bracketleftiggq/summationdisplay
i=t+1mi+1,q/summationdisplay
i=tmi/bracketrightigg
if Θt>σ,
which establishes (S3). /square
References
[AGV] Benson Au and Jorge Garza-Vargas, Spectral asymptotics for contracted tensor ensembles , Preprint.
https://arxiv.org/abs/2110.01652v3 .
[Aiz94] Michael Aizenman, Localization at weak disorder: some elementary bounds , Rev. Math. Phys. 6(1994),
no. 5A, 1163–1182. MR 1301371
[AM93] Michael Aizenman and Stanislav Molchanov, Localization at large disorder and at extreme energies: an
elementary derivation , Comm. Math. Phys. 157(1993), no. 2, 245–278. MR 1244867
[And58] P. W. Anderson, Absence of Diﬀusion in Certain Random Lattices , Phys. Rev. 109(1958), 1492–1505.
[Au18] Benson Au, Traﬃc distributions of random band matrices , Electron. J. Probab. 23(2018), paper no. 77,
48 pp. MR 3858905
[Au21] ,Finite-rank perturbations of random band matrices via inﬁn itesimal free probability , Comm. Pure
Appl. Math. 74(2021), no. 9, 1855–1895. MR 4287689
[BBAP05] Jinho Baik, G´ erard Ben Arous, and Sandrine P´ ech´ e,Phase transition of the largest eigenvalue for nonnull
complex sample covariance matrices , Ann. Probab. 33(2005), no. 5, 1643–1697. MR 2165575
[BGK17] Florent Benaych-Georges and Antti Knowles, Local semicircle law for Wigner matrices , Advanced topics
in random matrices, Panor. Synth` eses, vol. 53, Soc. Math. F rance, Paris, 2017, pp. 1–90. MR 3792624
[BGN11] Florent Benaych-Georges and Raj Rao Nadakuditi, The eigenvalues and eigenvectors of ﬁnite, low rank
perturbations of large random matrices , Adv. Math. 227(2011), no. 1, 494–521. MR 2782201
[BGP14] Florent Benaych-Georges and Sandrine P´ ech´ e, Largest eigenvalues and eigenvectors of band or sparse
random matrices , Electron. Commun. Probab. 19(2014), no. 4, 9. MR 3164751
[BLS96] Marek Bo˙ zejko, Michael Leinert, and Roland Speich er,Convolution and limit theorems for conditionally
free random variables , Paciﬁc J. Math. 175(1996), no. 2, 357–388. MR 1432836
[BMP91] L. V. Bogachev, S. A. Molchanov, and L. A. Pastur, On the density of states of random band matrices ,
Mat. Zametki 50(1991), no. 6, 31–42, 157. MR 1150631
[Bou18] Paul Bourgade, Random band matrices , Proceedings of the International Congress of Mathematici ans—
Rio de Janeiro 2018. Vol. IV. Invited lectures, World Sci. Pu bl., Hackensack, NJ, 2018, pp. 2759–2784.
MR 3966510
[BS10] Zhidong Bai and Jack W. Silverstein, Spectral analysis of large dimensional random matrices , second ed.,
Springer Series in Statistics, Springer, New York, 2010. MR 2567175
[BS12] S. T. Belinschi and D. Shlyakhtenko, Free probability of type B: analytic interpretation and applications ,
Amer. J. Math. 134(2012), no. 1, 193–234. MR 2876144
[BvH] Tatiana Brailovskaya and Ramon van Handel, Universality and sharp matrix concentration inequalities ,
Preprint. https://arxiv.org/abs/2201.05142v1 .
[BvH16] Afonso S. Bandeira and Ramon van Handel, Sharp nonasymptotic bounds on the norm of random matrices
with independent entries , Ann. Probab. 44(2016), no. 4, 2479–2506. MR 3531673
[BY88] Z. D. Bai and Y. Q. Yin, Necessary and suﬃcient conditions for almost sure converge nce of the largest
eigenvalue of a Wigner matrix , Ann. Probab. 16(1988), no. 4, 1729–1741. MR 958213
[BYY20] Paul Bourgade, Horng-Tzer Yau, and Jun Yin, Random band matrices in the delocalized phase I: Quantum
unique ergodicity and universality , Comm. Pure Appl. Math. 73(2020), no. 7, 1526–1596. MR 4156609
[Cap13] M. Capitaine, Additive/multiplicative free subordination property and limiting eigenvectors of spiked ad-
ditive deformations of Wigner matrices and spiked sample co variance matrices , J. Theoret. Probab. 26
(2013), no. 3, 595–648. MR 309054324 BENSON AU
[CDG] Guillaume C´ ebron, Antoine Dahlqvist, and Franck Gab riel,Freeness of type Band conditional freeness
for random matrices , Preprint. https://arxiv.org/abs/2205.01926v1 .
[CDMF09] Mireille Capitaine, Catherine Donati-Martin, an d Delphine F´ eral, The largest eigenvalues of ﬁnite rank
deformation of large Wigner matrices: convergence and nonu niversality of the ﬂuctuations , Ann. Probab.
37(2009), no. 1, 1–47. MR 2489158
[CDMF12] M. Capitaine, C. Donati-Martin, and D. F´ eral, Central limit theorems for eigenvalues of deformations of
Wigner matrices , Ann. Inst. Henri Poincar´ e Probab. Stat. 48(2012), no. 1, 107–133. MR 2919200
[CHS18] Benoit Collins, Takahiro Hasebe, and Noriyoshi Sak uma,Free probability for purely discrete eigenvalues
of random matrices , J. Math. Soc. Japan 70(2018), no. 3, 1111–1150. MR 3830802
[CMI90] Giulio Casati, Luca Molinari, and Felix Izrailev, Scaling properties of band random matrices , Phys. Rev.
Lett.64(1990), no. 16, 1851–1854. MR 1046365
[CPSS] Giorgio Cipolloni, Ron Peled, Jeﬀrey Schenker, and J acob Shapiro, Dynamical localization for random
band matrices up to W≪N1/4, Preprint. https://arxiv.org/abs/2206.05545v2 .
[CS] Nixia Chen and Charles K Smart, Random band matrix localization by scalar ﬂuctuations , Preprint.
https://arxiv.org/abs/2206.06439v1 .
[Dyk93] Ken Dykema, On certain free product factors via an extended matrix model , J. Funct. Anal. 112(1993),
no. 1, 31–60. MR 1207936
[EY17] L´ aszl´ o Erd˝ os andHorng-Tzer Yau, A dynamical approach to random matrix theory , Courant LectureNotes
in Mathematics, vol. 28, Courant Institute of Mathematical Sciences, New York; American Mathematical
Society, Providence, RI, 2017. MR 3699468
[FM91] Yan V. Fyodorov and Alexander D. Mirlin, Scaling properties of localization in random band matrices : a
σ-model approach , Phys. Rev. Lett. 67(1991), no. 18, 2405–2409. MR 1130103
[FMSS85] J. Fr¨ ohlich, F. Martinelli, E. Scoppola, and T. Sp encer,Constructive proof of localization in the Anderson
tight binding model , Comm. Math. Phys. 101(1985), no. 1, 21–46. MR 814541
[FS83] J¨ urg Fr¨ ohlich and Thomas Spencer, Absence of diﬀusion in the Anderson tight binding model for la rge
disorder or low energy , Comm. Math. Phys. 88(1983), no. 2, 151–184. MR 696803
[HJ13] Roger A. Horn and Charles R. Johnson, Matrix analysis , second ed., Cambridge University Press, Cam-
bridge, 2013. MR 2978290
[KY13] Antti Knowles and Jun Yin, The isotropic semicircle law and deformation of Wigner matr ices, Comm.
Pure Appl. Math. 66(2013), no. 11, 1663–1750. MR 3103909
[KY14] ,The outliers of a deformed Wigner matrix , Ann. Probab. 42(2014), no. 5, 1980–2031.
MR 3262497
[KY17] ,Anisotropic local laws for random matrices , Probab. Theory Related Fields 169(2017), no. 1-2,
257–352. MR 3704770
[LY14] Ji Oon Lee and Jun Yin, A necessary and suﬃcient condition for edge universality of Wigner matrices ,
Duke Math. J. 163(2014), no. 1, 117–173. MR 3161313
[Min96] Nariyuki Minami, Local ﬂuctuation of the spectrum of a multidimensional Ande rson tight binding model ,
Comm. Math. Phys. 177(1996), no. 3, 709–725. MR 1385082
[Mur01] Naofumi Muraki, Monotonic independence, monotonic central limit theorem a nd monotonic law of small
numbers, Inﬁn. Dimens. Anal. Quantum Probab. Relat. Top. 4(2001), no. 1, 39–58. MR 1824472
[Noi21] NathanNoiry, Spectral measures of spiked random matrices , J. Theoret. Probab. 34(2021), no.2, 923–952.
MR 4259454
[Pas72] L. A. Pastur, The spectrum of random matrices , Teoret. Mat. Fiz. 10(1972), no. 1, 102–112. MR 475502
[P´ ec06] S. P´ ech´ e, The largest eigenvalue of small rank perturbations of Hermi tian random matrices , Probab.
Theory Related Fields 134(2006), no. 1, 127–173. MR 2221787
[PRS13] Alessandro Pizzo, David Renfrew, and Alexander Sos hnikov, On ﬁnite rank deformations of Wigner
matrices, Ann. Inst. Henri Poincar´ e Probab. Stat. 49(2013), no. 1, 64–94. MR 3060148
[RS13] David Renfrew and Alexander Soshnikov, On ﬁnite rank deformations of Wigner matrices II: Delocaliz ed
perturbations , Random Matrices Theory Appl. 2(2013), no. 1, 1250015, 36. MR 3039820
[Shl18] D. Shlyakhtenko, Free probability of type-B and asymptotics of ﬁnite-rank pe rturbations of random matri-
ces, Indiana Univ. Math. J. 67(2018), no. 2, 971–991. MR 3798863
[Sod10] Sasha Sodin, The spectral edge of some random band matrices , Ann. of Math. (2) 172(2010), no. 3,
2223–2251. MR 2726110
[Sos99] Alexander Soshnikov, Universality at the edge of the spectrum in Wigner random mat rices, Comm. Math.
Phys.207(1999), no. 3, 697–733. MR 1727234
[TW94] Craig A. Tracy and Harold Widom, Level-spacing distributions and the Airy kernel , Comm. Math. Phys.
159(1994), no. 1, 151–174. MR 1257246DEFORMED RANDOM BAND MATRICES 25
[TW96] ,On orthogonal and symplectic matrix ensembles , Comm. Math. Phys. 177(1996), no. 3, 727–754.
MR 1385083
[Voi91] Dan Voiculescu, Limit laws for random matrices and free products , Invent. Math. 104(1991), no. 1,
201–220. MR 1094052
[Wig55] Eugene P. Wigner, Characteristic vectors of bordered matrices with inﬁnite d imensions , Ann. of Math.
(2)62(1955), 548–564. MR 0077805
[Wig58] ,On the distribution of the roots of certain symmetric matric es, Ann. of Math. (2) 67(1958),
325–327. MR 95527
[Wig67] ,Random Matrices in Physics , SIAM Review 9(1967), no. 1, 1–23.
Department of Statistics, University of California, Berke ley, 367 Evans Hall # 3860, Berkeley,
CA 94720-3860, USA
Email address :bensonau@berkeley.edu