arXiv:2301.06036v1  [cs.IT]  15 Jan 20231
Applicable Regions of Spherical and Plane Wave
Models for Extremely Large-Scale Array
Communications
Renwang Li, Shu Sun, Member, IEEE , and Meixia Tao, Fellow, IEEE
Abstract —Extremely large-scale array (XL-array) communi-
cations can signiﬁcantly improve the spectral efﬁciency an d
spatial resolution, and has great potential in next-genera tion
mobile communication networks. A crucial problem in XL-arr ay
communications is to determine the boundary of applicable
regions of the plane wave model (PWM) and spherical wave
model (SWM). In this paper, we propose new PWM/SWM
demarcations for XL-arrays from the viewpoint of channel ga in
and rank. Four sets of results are derived for four different
array setups. First, an equi-power line is derived for a poin t-
to-uniform linear array (ULA) scenario, where an inﬂection
point is found at ±π
6central incident angles. Second, an equi-
power surface is derived for a point-to-uniform planar arra y
(UPA) scenario, and it is proved that cos2(φ)cos2(ϕ) =1
2is a
dividing curve, where φandϕdenote the elevation and azimuth
angles, respectively. Third, an accurate and explicit expr ession
of the equi-rank surface is obtained for a ULA-to-ULA scenar io.
Finally, an approximated expression of the equi-rank surfa ce is
obtained for a ULA-to-UPA scenario. With the obtained close d-
form expressions, the equi-rank surface for any antenna str ucture
and any angle can be well estimated. Furthermore, the effect
of scatterers is also investigated, from which some insight s are
drawn.
Index Terms —Extremely large-scale array (XL-array); near-
/far-ﬁeld; Rayleigh distance; effective rank; spherical/ plane wave.
I. I NTRODUCTION
With the commercialization of the ﬁfth-generation (5G)
communication network, beyond 5G and the sixth-generation
(6G) are now in sight [1]–[4]. 6G is expected to exploit new
spectrum resources, including millimeter wave (mmWave) an d
Terahertz (THz) bands. With much shorter wavelengths of
mmWave and THz bands as compared to the conventional
microwave spectrum, more antennas can be integrated into a
small space. Consequently, the number of antennas continue s
to increase, from a standard of 64 [1] to hundreds or thousand s.
Naturally, extremely large-scale multiple-input multipl e-output
(XL-MIMO) communication has gained great research interes t
in both academia and industry [5]. XL-MIMO is also known
as ultra-massive MIMO (UM-MIMO) [6], extra-large scale
massive MIMO [7], and extremely large aperture massive
MIMO (xMaMIMO) [8]. We use extremely large-scale array
(XL-array) [9] throughout this paper for uniformity. XL-ar ray
communications are expected to signiﬁcantly improve the
transmission rate, spectral efﬁciency, and spatial resolu tion
The authors are with the Department of Electronic Engineeri ng, Shanghai
Jiao Tong University, Shanghai, China (email: {renwanglee, shusun, mx-
tao}@sjtu.edu.cn).compared with existing systems. Therefore, XL-array has gr eat
potential in satellite, unmanned aerial vehicle (UA V), and re-
conﬁgurable intelligent surface (RIS) assisted communica tion
systems [10]–[17].
Generally, the electromagnetic radiation can be divided in to
far-ﬁeld and near-ﬁeld regions [18]. In the far-ﬁeld region , the
angles at which the incident wave reaches each antenna can be
considered the same. Thus, the corresponding channel can be
modeled under the plane wave assumption. The plane wave
model (PWM) only considers the angle and the number of
antennas, and thus is highly convenient for channel modelin g
and performance analysis. In the near-ﬁeld region, the chan nel
is likely to be modeled under the spherical wave assumption,
where the phase and the difference in traveling distance at
different antennas cannot be ignored. The spherical wave
model (SWM) includes the angles, the number of antennas,
as well as the distance between the incident wave and each
antenna, and it is accurate but complicated. Note that the
antenna-channel interactions can be well described by sphe ri-
cal vector wave [19]–[21], which is different from the conce pt
of SWM discussed herein. Due to the large aperture of an XL-
array, the near ﬁeld expands as compared with a conventional
antenna array, thus the PWM may not be applicable any more
in the proximity of the XL-array. Thus, it becomes crucial
to determine the applicable regions of PWM and SWM for
XL-array communications. A classical demarcation between
near and far ﬁelds is the Rayleigh distance deﬁned as2D2
λ
[22]–[24], where Dandλdenote the antenna/array aperture
and signal wavelength, respectively. Speciﬁcally, the cla ssical
Rayleigh distance characterizes the minimum distance wher e
the maximum phase difference across the whole antenna array
is no greater thanπ
8[22], [23]. The Rayleigh distance is based
on the phase difference which may not be the most appropriate
evaluation metric in many practical systems. Hence, a new ty pe
of demarcations between the applicable regimes of PWM and
SWM suitable for XL-arrays is urgently required.
There are some previous efforts devoted towards the ex-
ploration of more accurate boundaries for PWM and SWM
[9], [25]–[35]. The authors in [25] ﬁnd that the channel
capacity for short-range MIMO systems under the PWM
is lower than that under the SWM. A threshold distance
below which the SWM is required for accurate performance
estimation is obtained by using empirical ﬁtting. The autho rs
in [26] propose a technique for realizing high-rank channel
capacity in line-of-sight (LoS) MIMO transmission scenari o
by optimizing antenna placement. Based on the derived ap-2
proximation expression of the largest eigenvalue of the LoS
MIMO channels employing the uniform linear array (ULA)
structure, the authors in [27] investigate the distance whe re
the ratio of the largest eigenvalue given by the SWM and
that given by the PWM reaches a predeﬁned threshold. The
authors in [28] obtain explicit expressions for some channe l
eigenvalues at certain discrete system settings under MIMO
scenario, and propose an effective multiplexing distance w here
the channel can support a certain number of simultaneous
spatial streams at a given signal-to-noise ratio (SNR) in a
pure LoS environment. An analytical SWM for large linear
arrays is proposed in [29], which is proved to be compatible
with conventional PWM. The authors in [30] investigate the
channel capacity under the point-to-point system and multi -
user system. The performances under the SWM and the
PWM are compared, and results show that the systems using
the more realistic and accurate SWM can achieve a higher
channel capacity than that under the PWM. The authors in [31]
and [32] propose a space-alternating generalized expectat ion-
maximization based localization algorithm, where the pola riza-
tion, delay and Doppler effect are considered. A closed-for m
expression of SNR with maximum ratio combining (MRC)
is obtained in [33] by considering the phase and amplitude
variations among different antennas, which is extended in [ 9]
by taking the projected aperture across array elements into
consideration. They deﬁne a uniform-power distance where
the power ratio between the weakest and strongest array
element is no smaller than a certain threshold. The authors
in [34] deﬁne an effective Rayleigh distance according to th e
achievable array gain if the base station (BS) utilizes the f ar-
ﬁeld beamforming vector to serve a user located in the near
ﬁeld. The authors in [35] consider the near-ﬁeld region of a
passive antenna and an antenna array. They obtain an explici t
expression of the distance where at most 3 dB propagation los s
incurs. Recently, the Rayleigh distance originally coined for
the single-hop communication system has also been extended
to two-hop RIS-aided communication systems [35]–[39].
Most of the above efforts focus on the phase change,
although some existing works, e.g., [9], [34], [35], propos e
PWM/SWM demarcations according to signal amplitudes
solely or other different criteria, those are for linear arr ays,
and a more comprehensive and accurate criterion is absent.
Therefore, we aim to explore the region where the SWM
can be approximated by the PWM with high accuracy and
under various circumstances, from the viewpoint of channel
gain and rank which are key evaluation metrics in wireless
communication systems. We consider four scenarios, i.e.,
point-to-ULA, point-to-uniform planar array(UPA), ULA-t o-
ULA, and ULA-to-UPA, by taking into account the variations
of both the signal amplitude and phase across array elements ,
as well as the incident angle. As mmWave or even THz
techniques, along with XL-arrays, may be employed in 6G,
they are likely to be used for short/middle-range high-date -
rate communication. Thus, the considered propagation is Lo S
dominated or with only a limited number of scattered paths.
The main contributions of our work are summarized as
follows:
•For the point-to-ULA scenario, we obtain an equi-powerline where the ratio between the received power under
the SWM and that under the PWM reaches a certain
threshold. In addition, contrary to the intuition that the
equi-power line would evolve smoothly over incident
angles, it is discovered that an inﬂection point exists at
the central incident angles of ±π
6. When the absolute
value of the central incident angle is smaller thanπ
6, the
PWM always overestimates the received power compared
with the SWM. Otherwise, the PWM ﬁrst overestimates,
then underestimates the received power as the distance
increases.
•For the point-to-UPA scenario, an equi-power surface is
obtained. Similarly, it is found that cos2(φ)cos2(ϕ) =
1
2is a dividing curve, where φandϕdenote
the elevation and azimuth angles, respectively. When
cos2(φ)cos2(ϕ)≥1
2, the PWM always overestimates
the received power compared with the SWM. Otherwise,
the PWM ﬁrst overestimates, then underestimates the
received power as the distance increases.
•For the ULA-to-ULA scenario, we obtain an accurate
and explicit expression of the equi-rank surface, where
the effective rank [40] of the channel under the SWM
approximately equals that provided by the PWM. With
the closed-form expression obtained, the equi-rank sur-
face for any antenna structure and any angle can be well
estimated.
•For the ULA-to-UPA scenario, an approximated expres-
sion of the equi-rank surface is obtained when the ULA
is parallel to the UPA. The equi-rank surface for any
antenna structure and any angle can be approximated
using the derived expression.
•Multiple scatterers are also considered. For the point-
to-ULA case, the phases of different paths cannot be
cancelled out as in the single-LoS-path case under MRC,
leading to a much larger threshold distance. The threshold
distance enlarges as the number of scatterers increases
both with and without the existence of an LoS path. For
the ULA-to-ULA case, the obtained threshold distance
approaches the analytical approximation when the power
of scattered paths is small.
The rest of the paper is organized as follows. Section II in-
vestigates the equi-power line of a ULA. Section III discuss es
the equi-power surface of a UPA. Section IV explores the
equi-rank surface of a ULA to a ULA. Section V investigates
the equi-rank surface of a ULA to a UPA and Section VI
concludes this paper.
II. E QUI-POWER LINE OF A ULA
In this section, we consider the equi-power line of an N-
element ULA, as illustrated in Fig. 1. Suppose the midpoint
of the ULA lies at (0,0)in the XY-plane. The coordinate of
then-th antenna is (0,δ(n)d), whereδ(n)=n−N−1
2with
n= 0,1,...,N−1, andddenotes the antenna spacing. The
array aperture is D= (N−1)d≈Ndfor large N. A single-
antenna user is located at (x,y), with polar coordinate of (r,θ)
whererdenotes the distance between the user and the center of
the ULA, and θis termed the central incident angle. Therefore,3
θ r
x-axis y-axis 
BS User
(x,y)
O
Fig. 1: The system layout of a point to a ULA under the
spherical wave model (SWM).
we have /braceleftbigg
x=rcos(θ),
y=rsin(θ).(1)
By considering the LoS path only, the exact channel h∈
CN×1between the ULA and the user under the SWM is given
by [28], [29]
h=/bracketleftbiggλ
4πr1e−j2πr1
λ,λ
4πr2e−j2πr2
λ,...,λ
4πrNe−j2πrN
λ/bracketrightbiggT
,
(2)
whereλdenotes the carrier wavelength, and rnrefers to the
distance between the n-th antenna and the user, satisfying
rn=/radicalig
x2+/parenleftbig
y−δ(n)d/parenrightbig2
=/radicalig
r2−2rdδ(n)sin(θ)+/parenleftbig
δ(n)d/parenrightbig2.(3)
When the user lies in the far-ﬁeld of the ULA, the channel in
Eq. (2) under the PWM can be approximated as
h=λ
4πr/bracketleftig
e−j2πr1
λ,e−j2πr2
λ,...,e−j2πrN
λ/bracketrightigT
, (4)
wherern=r−dδ(n)sin(θ)due to the ﬁrst order Taylor
expansion√1+x≈1+1
2xwhich holds if the array length
is much smaller than r. When the beamformer of the ULA is
adopted as v=hH
/bardblh/bardbl, i.e., MRC, the maximum channel gain
Gfar−ﬁeld can be achieved, which can be expressed as
Gfar−ﬁeld= (vh)2=/bardblh/bardbl2=/parenleftbiggλ
4π/parenrightbigg2N
r2. (5)
However, the far-ﬁeld approximation is inaccurate when the
distanceris small. Thereby, we would like to explore the
boundary for PWM and SWM. With MRC, the maximum
channel gain Gnear−ﬁeld can be achieved, which can be
represented as
Gnear−ﬁeld=/bardblh/bardbl2=/parenleftbiggλ
4π/parenrightbigg2N/summationdisplay
n=11
r2n. (6)We are interested in the ratio of Gnear−ﬁeldtoGfar−ﬁeld, i.e.,
µ(r,θ)/definesGnear−ﬁeld
Gfar−ﬁeld=r2
NN/summationdisplay
n=11
r2n. (7)
The coefﬁcient µ(r,θ)represents the normalized received
power at position (r,θ). For some positions, the consequent
coefﬁcient µ(r,θ)may be the same. It is obvious that when
the distance rgoes to inﬁnity, µ(r,θ)≈1due torn≈r.
We would like to study the boundary distance where the
received power under the SWM is nearly the same as that
under the PWM. The solutions r(θ)ofµ(r,θ) =δ∆represent
the distances with the same normalized received power, wher e
the threshold δ∆is a constant that is close to one as for the
PWM. Thus, we name the solutions r(θ)asequi-power line . In
the following, the closed-form expression of µ(r,θ)is obtained
through Theorem 1, followed by the investigation of the equi -
power line.
Theorem 1: In the point-to-ULA scenario, the normalized
received power µ(r,θ)has a closed-form expression as fol-
lows,
µ(r,θ) =r
Ndcos(θ)/bracketleftbigg
arctan/parenleftbiggNd
2rcos(θ)+tan(θ)/parenrightbigg
+ arctan/parenleftbiggNd
2rcos(θ)−tan(θ)/parenrightbigg/bracketrightbigg
.(8)
Proof: See Appendix VI-A.
It is evident from Eq. (8) that µ(r,θ)depends on the array
lengthNd instead of the individual values of Nandd,
indicating that µ(r,θ)is identical for different ULAs with
the same length. Moreover, µ(r,θ)is independent of the
wavelength.
Proposition 1: In the point-to-ULA scenario, |θ|=π
6is an
inﬂection angle in the equi-power line. When −π
6≤θ≤π
6,
µ(r,θ)is always smaller than one. When −π
2< θ <−π
6or
π
6< θ <π
2,µ(r,θ)will ﬁrst increase, exceed one, reach its
peak, then decrease, and ﬁnally approach one as the distance
rincreases, as shown in Fig. 2. Assume µ(r,θ)reaches its
peak at the distance r1, where the PWM underestimates the
received power the most severely. Deﬁne
r2/definesNd/radicaligg
tan2(θ)+1+2 |tan(θ)|/radicalbig
tan2(θ)+1
4cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig,(9)
where∂2µ(r,θ)
∂r2|r=r2= 0, thenr1is smaller than and close to
r2.
Proof: See Appendix VI-B.
For instance, when θ=π/3,N= 127 , andd= 0.005m, we
haver2= 0.371m. Through simulation, we ﬁnd r1≈0.274
m. It is observed that r1is smaller than and close to r2.
Now, let us take a closer look at the equi-power line. When
θ= 0, the coefﬁcient µ(r,0)can be simpliﬁed as
µ(r,0) =2r
Ndarctan/parenleftbiggNd
2r/parenrightbigg
. (10)
Whenδ∆is set to 0.99, the corresponding equi-power line is
r(0)≈2.86Nd≈2.86D. Fig. 2 illustrates the normalized
received power and the equi-power line r(θ)forθranging
from−π
2toπ
2, whereN= 127 ,λ= 0.01m, andd=λ
2.4
-80 -60 -40 -20 0 20 40 60 80
Incident Angle,  (Degrees)00.511.522.53Distance (m)
00.511.5
Normalized Received Power
Fig. 2: Point-to-ULA scenario: The normalized received pow er
versus the central incident angle in the case of only an LoS
path, where the dotted line denotes the equi-power line, N=
127, andλ= 0.01m.
θ r
x-axis y-axis 
BS User
(x,y)
O
ScattererScatterer
Fig. 3: The system layout of a point to a ULA with multiple
scatterers under the SWM.
The dotted line denotes the equi-power line, where δ∆is set
to 0.99 when µ(r,θ)is always smaller than one, and δ∆is
set to 1.01 otherwise. It can found that the equi-power line
has a pseudo inﬂection point at |θ|>π
6due to the non-ideal
threshold δ∆which is not exactly one. When −π
6≤θ≤π
6,
the received power under the PWM is always a upper bound of
that under the SWM. Whenπ
6<|θ|<π
2, the received power
corresponding to the PWM is ﬁrst a upper bound, then a lower
bound of that under the SWM as the distance increases.
So far, we have been focusing on the single LoS path
between the user and the ULA. Now, let us consider the
scenario with multiple scatterers that generate multipath as
illustrated in Fig. 3. Let hs∈CN×1denote the channel
between the ULA and the user under the SWM, we have
hs
n=λ
4πrne−j2πrn
λ+L/summationdisplay
ℓ=1αℓλ
4πrnℓdℓe−j2π(rnℓ+dℓ)
λ,(11)
wherehs
nis then-th entry of hs,Lis the number of scatterers,
-80 -60 -40 -20 0 20 40 60 80
Incident Angle,  (Degrees)0510152025303540Distance (m)
00.511.5
Normalized Received Power
Fig. 4: Point-to-ULA scenario: The threshold distance vers us
normalized received power versus the central incident angl e
in the case of two scatterers and an LoS path with ζ= 5◦,
|α|= 0.5,N= 127 , andλ= 0.01m, where the dotted line
denotes the equi-power line.
5 10 15 20 25 30 35 40 45 50
 (degrees)00.10.20.30.40.50.60.70.80.91||
102030405060708090
Threshold Distance (m)
Fig. 5: Point-to-ULA scenario: The threshold distance vers us
|α|andζwith two scatterers and an LoS path, where θ= 0◦,
N= 127 , andλ= 0.01m.
αℓdenotes the attenuation and phase shift caused by the ℓ-th
scatterer, rnℓdenotes the distance between the ℓ-th scatterer
and then-th antenna, and dℓdenotes the distance between
the user and the ℓ-th scatterer. The channel in (11) under the
PWM can be approximated by
hs
n=λ
4πrne−j2πrn
λ+L/summationdisplay
ℓ=1αℓλ
4πrnℓdℓe−j2π(rnℓ+dℓ)
λ,(12)
wherernℓis the ﬁrst order Taylor expansion of rnℓ. It is
challenging to analytically calculate the channel gain of E q.
(11) and Eq. (12) under the MRC. Therefore, simulations are
carried out to evaluate the equi-power line.
Without loss of generality, we ﬁrst consider two scatterers
with polar coordinates of (r/2,θ+ζ)and(r/2,θ−ζ), respec-
tively. We assume that the attenuation and phase shifts of th e
two scatterers are the same, i.e., α1=α2. The phase shifts are
assumed to follow the uniform distribution between −πand5
TABLE I: Comparison among different demarcations between a pplicable regions for SWM and PWM for the point-to-ULA
scenario, where θ= 0◦,λ= 0.01m,N= 127 , andD= 0.63m.
Different demarcations Values (m)
Classical Rayleigh distance2D2
λ= 79.38
Critical distance [33] 0.70
Effective Rayleigh distance [34] ǫ2D2
λ= 29.13
The distance in [35]1
102D2
λ= 7.94
Proposed equi-power line (LoS environment without scatter ers)2.86D= 1.80
Proposed equi-power line (LoS environment with 7 scatterer s) 79.87
Proposed equi-power line (NLoS environment with 3 scattere rs) 100.04
0 5 10 15 20 25 30 35 40 45 50
Number of Scatterers101102103Threshold Distance (m)Without LoS Path
With LoS Path
Fig. 6: Point-to-ULA scenario: The threshold distance vers us
the number of scatterers where θ= 0◦,N= 127 , andλ=
0.01m.
π, i.e.,arg{α1}= arg{α2} ∼ U(−π,π). After calculating
the channel gain under SWM and PWM, we can obtain the
coefﬁcient µ(r,θ)and the corresponding equi-power line, as
shown in Fig. 4 and Fig. 5 where λ= 0.01m,d=λ
2, and
N= 127 . The simulations are averaged over 100 independent
realizations of scattering phase shifts. When there is only a
single LoS path between the user and ULA, the normalized
received power is related to the distance, the array apertur e,
and the central incident angle, and is independent of phase.
However, when multiple scatterers are considered, the phas es
of different paths cannot be cancelled out under the MRC
as in the single-LoS-path case. Thus, the phases across the
antennas will inﬂuence the normalized received power, lead ing
to a much larger threshold distance, as shown in Fig. 4 when
compared with Fig. 2. Fig. 5 shows that the threshold distanc e
decreases as |α|decreases since it becomes more akin to the
single-LoS-path case. In addition, when the scatterers dis perse,
that is to say, ζbecomes large, the threshold distance is
likely to decrease in general. The scattered signals streng then
each other in some places and weaken each other in others,
as shown in Fig. 4. When the scatterers are close together,
they strengthen each other more. Thus, the threshold distan ce
beyond which the normalized received power is always smalle r
than 1.01 becomes larger in general.
Then, we consider the circumstance where one or more
scatterers are randomly distributed within a semicircle wi th
radiusrwith respect to the central element of the ULA, where0306090
120
150
180
210
240
27030033000.20.40.60.81
Rayleigh distance
Proposed distance
Fig. 7: Point-to-ULA scenario: The beamforming pattern wit h
the Rayleigh distance and the proposed distance in the case
of only LoS path, where λ= 0.01m, andN= 127 .
|αℓ| ∼ U(0,1)andarg{αℓ} ∼ U(−π,π),∀ℓ. Fig. 6 illustrates
the threshold distance versus the number of scatterers with
each data point averaged over 2000 independent realization s
of the scatterer locations, and scattering attenuation and phase
shifts , where θ= 0◦,N= 127 ,λ= 0.01m, andd=λ
2.
The curve ‘With LoS Path’ indicates the LoS environment
generated according to Eq. (11), while the curve ‘Without Lo S
Path’ corresponds to the non-LoS (NLoS) environment with
only scattered paths. It can be found that the threshold dist ance
increases with the number of scatterers in both LoS and NLoS
environment. For a given number of scatterers, the threshol d
distance in the NLoS environment is larger than that under
the LoS condition when the number of scatterers exceeds two.
The increased threshold distance with the number of scatter ers
may be ascribed to the fact that the scatterers close to the
ULA are likely to be in the near ﬁeld of the ULA where the
SWM is applicable, whose effect needs to be overwritten by
the distant scatterers such that the overall mixed wavefron t
approximates that formed by multiple plane waves. As the
number of scatterers increases, the number of close-in (wit h
respect to the ULA) scatterers also increases, hence the dis tant
scatterers need to be farther away to overcome the effect of
the close-in scatterers, so that the overall far-ﬁeld effec t can
be presented.6
φ   
ϕ   User
(x,y,z)
x-axis 
y-axis z-axis 
BS 
Fig. 8: The system layout of a point to a UPA under the SWM.
Table I compares different demarcations between applicabl e
regions for SWM and PWM when θ= 0◦,λ= 0.01m,
N= 127 ,D= 0.63m, andǫ= 0.367[34]. It can be found
that the proposed equi-power line for a single LoS path is
smaller than most of the other boundaries. In fact, under MRC ,
the received power is affected by the variations of the signa l
amplitude, and is independent of the variations of the signa l
phase. Therefore, the classical Rayleigh distance overest imates
the distance where the received power obtained by the SWM
is nearly equal to that obtained by the PWM. The variations
of the signal amplitude is also considered in [33], which car es
about the power ratio between the weakest and strongest arra y
elements. However, the received power by the whole array is
considered in the proposed equi-power line, which results i n
different demarcations. The proposed equi-power line is cl ose
to the classical Rayleigh distance under the LoS environmen t
with 7 scatterers or the NLoS environment with 3 scatterers.
In addition, Fig. 7 illustrates the beamforming pattern wit h the
Rayleigh distance and the proposed distance in the scenario
of Fig. 1, where N= 127 ,θ= 0◦,λ= 0.01m,d=λ
2, and
ris set to the Rayleigh distance and the proposed distance,
respectively. It can be found that the beamforming pattern w ith
the Rayleigh distance is sharp at 0◦, which shows that it is
indeed in the far ﬁeld. However, the beamforming pattern wit h
the proposed distance has large gains between −6◦and6◦.
III. E QUI-POWER SURFACE OF A UPA
We now consider the equi-power surface of an N=Ny×
NzUPA, as shown in Fig. 8. Assume the UPA lies in the
YZ-plane, and the midpoint of the UPA lies at (0,0,0). The
coordinate of the nynz-th antenna is (0,δ(n)
ydy,δ(n)
zdz), where
δ(n)
y=ny−Ny−1
2withny= 0,1,...,N y−1,δ(n)
z=nz−
Nz−1
2withnz= 0,1,...,N z−1,dydenotes the antenna
spacing along the Y direction, and dzdenotes the antenna
spacing along the Z direction. A single-antenna user is loca ted
at(x,y,z), where its polar coordinate is (r,φ,ϕ). Thus, we
have 

x=rcos(φ)cos(ϕ),
y=rcos(φ)sin(ϕ),
z=rsin(φ).(13)Analogous to the ULA structure in Section II, the ratio
ofGnear−ﬁeld toGfar−ﬁeld under the UPA structure can be
represented as
µ(r,φ,ϕ)/definesGnear−ﬁeld
Gfar−ﬁeld=r2
NNy/summationdisplay
ny=1Nz/summationdisplay
nz=11
r2nynz, (17)
wherernynzdenotes the distance between the nynz-th antenna
and the user, satisfying
r2
nynz= (rcos(φ)cos(ϕ))2+/parenleftig
rsin(φ)−δ(n)
zdz/parenrightig2
+/parenleftig
rcos(φ)sin(ϕ)−δ(n)
ydy/parenrightig2
=r2−2rcos(φ)sin(ϕ)δ(n)
ydy
−2rsin(φ)δ(n)
zdz+(δ(n)
ydy)2+(δ(n)
zdz)2.(18)
Similar to the derivation of the ULA structure in Appendix
VI-A,µ(r,φ,ϕ)can be expressed as Eq. (14), where A=
{(my,mz)|−1
2≤my≤1
2,−1
2≤mz≤1
2}is the integration
area. The coefﬁcient µ(r,φ,ϕ)represents the normalized
received power. The solutions r(φ,ϕ)ofµ(r,φ,ϕ) =δ∆
denote approximately the same normalized received power
at(r,φ,ϕ)between the SWM and PWM, and constitute a
surface. Therefore, we name the solutions r(φ,ϕ)asequi-
power surface . In the following, we will ﬁrst explore the
closed-form expression of µ(r,φ,ϕ), then investigate the equi-
power surface.
It is extremely difﬁcult, if not impossible, to derive the
closed-form expression of µ(r,φ,ϕ)in Eq. (14). Fortunately,
the closed-form expression of µ(r,φ,ϕ)is available when
considering the uniform circular planar array (UCPA) or
uniform elliptical planar array (UEPA) structure, which wi ll
be shown next.
Theorem 2: In the single point to a UEPA scenario, when
φ=ϕ= 0, the normalized received power µ(r,0,0)can be
represented as Eq. (15).
In the single point to a UCPA scenario, assume Nydy=
Nzdz/definesD,µ(r,φ,ϕ)can be expressed as
µ(r,φ,ϕ) =/braceleftigg
πr2
D2ln/parenleftig
D2
πr2+1/parenrightig
, φ=ϕ= 0,
µ0(r,β), φ /ne}ationslash= 0orϕ/ne}ationslash= 0,(19)
whereµ0(r,β)is shown in Eq. (16) and β= cos2(φ)cos2(ϕ).
Proof: See Appendix VI-C.
It can be observed that both Eq. (15) and Eq. (19) are
independent of the wavelength, and are determined by the
array length Ndrather than the individual values of Nandd.
Proposition 2: In the single point to a UCPA sce-
nario,cos2(φ)cos2(ϕ) =1
2is a dividing curve. When
cos2(φ)cos2(ϕ)≥1
2,µ(r,φ,ϕ)is always smaller than one;
whencos2(φ)cos2(ϕ)<1
2,µ(r,φ,ϕ)will ﬁrst increase, and
then decrease to approach one as the distance rincreases.
Assumeµ(r,φ,ϕ)reaches its peak at the distance r1, where
the PWM underestimates the received power the most severely .
Deﬁne
r2/definesD/radicaligg
10+/radicalbig
100−9(4cos2(φ)cos2(ϕ)−2)2
9π(2−4cos2(φ)cos2(ϕ)),(20)7
µ(r,φ,ϕ) =r2
NNy/summationdisplay
ny=1Nz/summationdisplay
nz=11
r2nynz
=r2
NNy/summationdisplay
ny=1Nz/summationdisplay
nz=11
r2−2rcos(φ)sin(ϕ)δ(n)
ydy−2rsin(φ)δ(n)
zdz+(δ(n)
ydy)2+(δ(n)
zdz)2
=r2
NNy−1
2/summationdisplay
ny=−Ny−1
2Nz−1
2/summationdisplay
nz=−Nz−1
21
r2−2rcos(φ)sin(ϕ)nydy−2rsin(φ)nzdz+n2yd2y+n2zd2z
N→∞=/integraldisplay/integraldisplay
Ar2
r2−2rcos(φ)sin(ϕ)Nydymy+N2yd2ymy2−2rsin(φ)Nzdzmz+N2zd2zmz2dmydmz.(14)
µ(r,0,0) =2πr2
NydyNzdzln
Nzdz/radicalig
N2yd2y
πr2+1+Nydy/radicalig
N2
zd2
z
πr2+1
Nydy+Nzdz
. (15)
µ0(r,β) =πr2
2D2

ln
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4+/parenleftig
2D4
π+(4β−2)r2D2/parenrightig
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4−/parenleftbig2D4
π+(4β−2)r2D2/parenrightbig
+ln/bracketleftbigg1−β
β/bracketrightbigg

. (16)
Fig. 9: The dividing curve of a UCPA.
which is close to the point where the second partial derivati ve
ofµ(r,φ,ϕ)overris zero. Then, r1is smaller than and close
tor2.
Proof: See Appendix VI-D.
Fig. 9 illustrates the dividing curve of a UCPA. When the
angles(φ,ϕ)lie within the curve, the normalized received
powerµ(r,φ,ϕ)is always smaller than one. It can be found
that the dividing curve resembles a circle with a radius ofπ
4. In
addition, for instance, when D= 1m, andcos2(φ)cos2(ϕ) =
0.1, we have r2= 0.6442 m. Through simulation, we ﬁnd
r1≈0.5257 m. It is found that r1is smaller than and close
tor2.
Remark 1: It seems impossible to derive a closed-form
expression for uniform square planar array (USPA) and
uniform rectangular planar array (URPA) structures. Nev-
ertheless, based upon extensive simulations, we ﬁnd that
Fig. 10: Point-to-UPA scenario: The normalized received
power of a UCPA where Ny=Nz= 127 , andλ= 0.01
m.
cos2(φ)cos2(ϕ) =1
2is also the dividing curve of µ(r,φ,ϕ)
for the USPA structure. As for the URPA structure, let us focu s
on the region {(φ,ϕ)|0≤φ <π
2,0≤ϕ <π
2}, we have
1)φ0=π
6(30◦), andϕ0= arccos/radicalig
1
2cos2(π/6)(≈35.26◦)
is the dividing curve;
2) When Nydy< Nzdz,cos2(φ)cos2(ϕ) =1
2is the
dividing curve with the following condition: 0≤φ < φ 0
orϕ0< ϕ≤π
4;
3) When Nydy> Nzdz,cos2(φ)cos2(ϕ) =1
2is the
dividing curve with the following condition: φ0< φ≤π
4
or0≤ϕ < ϕ 0.
Considering the UCPA structure, when φ=ϕ= 0
andδ∆= 0.99, the corresponding equi-power distance is
r(0,0)≈3.96D. Fig. 10 illustrates the normalized received
power at different angles, and Fig. 11 describes the equi-8
0.5
90 
1
45 
 90 
Threshold Distance (m)
1.5
45 
Azimuth Angle (Degrees)0  2
Elevation Angle (Degrees)2.5
0  
-45-45
-90-90
Fig. 11: Point-to-UPA scenario: The equi-power surface of a
UCPA where Ny=Nz= 127 , andλ= 0.01m.
θ r
x-axis y-axis 
BS User
(x,y)
O
Us 
(((((x
Fig. 12: The system layout of a ULA to a ULA under the
SWM.
power surface r(φ,ϕ). Both Fig. 10 and Fig. 11 are obtained
under the scenario of Ny=Nz= 127 ,λ= 0.01m, and
dy=dz=λ
2. We set δ∆to 0.99 when µ(r,θ,ϕ)is always
smaller than one, and 1.01 otherwise. The equi-power surfac e
in Fig. 11 looks like an egg fallen into a hat, in which there
is an inﬂection surface as explained in Proposition 2.
IV. E QUI-RANK SURFACE OF A ULA TO A ULA
In this section, we focus on the equi-rank surface of a
ULA to a ULA as shown in Fig. 12, where an N-antenna
BS communicates with an M-antenna user. Suppose the
midpoint of the ULA of the BS lies at (0,0)in the XY-
plane. The coordinate of the n-th antenna is (0,δ(n)db), where
δ(n)=n−N−1
2withn= 0,1,...,N−1, anddbdenotes
the antenna spacing of the ULA at the BS. The coordinate of
the ﬁrst antenna of the user is (x,y)with its polar coordinate
(r,θ). The ULA of the user has an angle φalong with Y-
axis. Thus, the coordinate of the m-th antenna of the user is
(x+δ(m)dusin(φ),y+δ(m)ducos(φ)), whereδ(m)=mwith
m= 0,1,...,M−1, andduis the antenna spacing of theULA at the user. The channel between the BS and the user
under the SWM is denoted as Hs∈CN×M, where the nm-th
entry ofHs, i.e.,hnm, denotes the channel between the n-th
antenna at the BS and the m-th antenna at the user, satisfying
hnm=λ
4πrnme−j2π
λrnm. (21)
Here,rnmdenotes the distance between the n-th antenna at
the BS and the m-th antenna at the user, and it satisﬁes
r2
nm=/parenleftig
rcos(θ)+δ(m)dusin(φ)/parenrightig2
+/parenleftig
rsin(θ)+δ(m)ducos(φ)−δ(n)db/parenrightig2
.(22)
We are interested in the matrix
W=/braceleftigg
HH
sHs, M < N
HsHH
s, M≥N,(23)
since the square of the singular values of Hsis equal to the
eigenvalues of W[27]. In the following, we will study the
rank ofW.
In order to investigate the rank of the channel, we introduce
the effective rank of a non-all-zero matrix A∈CM×Ndeﬁned
as [40]
erank(A) = exp/parenleftigg
−/summationdisplay
iσi
/bardblA/bardbl∗ln/parenleftbiggσi
/bardblA/bardbl∗/parenrightbigg/parenrightigg
, (24)
whereσiis thei-th largest singular value of A, and/bardblA/bardbl∗=/summationtext
iσiis the nuclear norm of A, so thatσi
/bardblA/bardbl∗can be regarded
as the normalized singular value of A[41, Eq. (8)]. As proven
in [40], the effective rank of Ais within [1,min(M,N)], and
the effective rank is the lower bound of the rank of the matrix
A. With a higher value of the effective rank, the orthogonalit y
of the columns/rows of the matrix is higher.
When the channel between the BS and the user is approx-
imated by the PWM, its effective rank is one. However, the
PWM is only valid when the distance is large. The solutions
r(θ,φ)oferank(W)(r,θ,φ) =δ∆denote approximately the
same effective rank against the PWM and constitute a surface .
Hence, we name the threshold r(θ,φ)asequi-rank surface .
Here,δ∆is a constant close to one. Since it is challenging to
obtain the closed-form expression of the singular values of the
matrixW, we investigate the effective rank of the matrix W
through simulations. In this section, the threshold δ∆is set to
1.05.
The investigation is divided into two parts. First, with ﬁxe d
antenna numbers NandM, the angles are sampled to ﬁnd the
relationships between the threshold distance and the angle s.
Then, with ﬁxed angles, the antenna numbers NandMare
sampled to explore the relationships between the threshold
distance and the antenna numbers. There are many interestin g
ﬁndings.
Let us begin with the ﬁrst part, as shown in Fig. 13 and
Fig. 14, where N= 511 ,M= 128 ,λ= 0.01m, and
db=du=λ
2. Fig. 13 illustrates the threshold distance versus
θwith ﬁxed φ, whereθis sampled every 5 degrees, φ= 0◦in
Fig. 13(a), φ= 30◦in Fig. 13(b), φ= 50◦in Fig. 13(c), and
φ= 60◦in Fig. 13(d). The markers and dotted curves denote9
-200 -150 -100 -50 0 50 100 150
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(a)φ= 0◦
-200 -150 -100 -50 0 50 100 150
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(b)φ= 30◦
-200 -150 -100 -50 0 50 100 150
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(c)φ= 50◦
-200 -150 -100 -50 0 50 100 150
  (degrees)01002003004005006007008009001000Thereshold Distance/mSimulation Result
Analytic Approximation
(d)φ= 60◦
Fig. 13: ULA-to-ULA scenario: The threshold distance versu s
θwith ﬁxed φ, whereN= 511 ,M= 128 , andλ= 0.01m.-100 -80 -60 -40 -20 0 20 40 60 80 100
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(a)θ= 0◦
-100 -80 -60 -40 -20 0 20 40 60 80 100
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(b)θ= 30◦
-100 -80 -60 -40 -20 0 20 40 60 80 100
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(c)θ= 50◦
-100 -80 -60 -40 -20 0 20 40 60 80 100
  (degrees)01002003004005006007008009001000Thereshold Distance (m)Simulation Result
Analytic Approximation
(d)θ= 60◦
Fig. 14: ULA-to-ULA scenario:The threshold distance versu s
φwith ﬁxed θ, whereN= 511 ,M= 128 , andλ= 0.01m.10
the simulation results and analytic approximation, respec tively.
Note that the analytic expression will be expounded later.
Denote the threshold distance when θ=φ= 0◦asr1. There
are some interesting ﬁndings: 1) When φ= 0◦, the simulation
results in Fig. 13(a) can be well approximated by r1cos2(θ).
2) When 0< φ <90◦, the simulation results have a peak
and two sub-peaks when −180◦≤θ≤120◦. Asφincreases,
the value of the peak will decrease, and the values of the
sub-peaks will increase. However, the summation of the peak
and the sub-peak is always equal to r1. 3) The peak arises at
θ=−φ
2. The sub-peaks arise at θ=−φ
2±90◦both with a
width of φdegrees.
Fig. 14 displays the threshold distance versus φwith ﬁxed
θ, whereφis sampled every 5 degrees, θ= 0◦in Fig. 14(a),
θ= 30◦in Fig. 14(b), θ= 50◦in Fig. 14(c), and θ= 60◦
in Fig. 14(d). A few remarks can be drawn: 1) When θ= 0◦,
the simulation results in Fig. 14(a) can be well approximate d
byr1|cos(φ)|, except for the points around φ=±90◦. 2) As
θincreases, the maximum value decreases and can be well
approximated by r1cos(θ). 3) When the simulation results in
Fig. 14 are normalized by its own maximum values, it can be
well approximated by |cos(φ+θ)|.
Based on the above ﬁndings, we have the following propo-
sition.
Proposition 3: If the threshold distance when θ0=φ0= 0◦
isr1, with ﬁxed antenna structure and ﬁxed wavelength, the
equi-rank surface for any angles θandφcan be approximated
by
r(θ,φ) =r1/vextendsingle/vextendsingle/vextendsingle/vextendsinglecos2/parenleftbigg
θ+1
2φ/parenrightbigg
−sin2/parenleftbigg1
2φ/parenrightbigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle. (25)
Proposition 3 reveals the relationship between the equi-
rank surface and the angles for a ﬁxed antenna structure. The
analytic approximation in Proposition 3 ﬁts the simulation
results well except for the scenario of φ=±90◦−θ, as shown
in Fig. 13 and Fig. 14. When φ=±90◦−θ, the ULA at the
user forms a line to the origin. Then, the actual threshold
distance is slightly greater than zero. However, the analyt ic
approximation in Proposition 3 is exactly zero. Thus, it cau ses
errors in this case. Overall, the analytic approximation in
Proposition 3 ﬁts the simulation results well.
Now, let us focus on the second part. Fig. 15 shows the
threshold distance versus the antenna number at the BS, wher e
λ= 0.01m, anddb=du=λ
2,θ=φ= 0◦,M= 128 , and
Nis taken from the set {8,16,32,64,128,256,512,1024}.
It is worth noting that the threshold distance has a linear
relationship with N, whether N < M orN≥M. Actually,
the threshold distance has a linear relationship with the ar ray
aperture, not only the number of antennas, when the number of
antennas of both the BS and user is larger than 6. This linear
relationship is likely due to the fact that when the number of
antennas increases by a certain value, the curve of effectiv e
rank vs. distance translates to the right by a corresponding
ﬁxed amount. In addition, inspired by the classical Rayleig h
distance2D2
λwhere the Rayleigh distance and the wavelength
have an inverse relationship, we have the following proposi -
tion.100101102103104
 Antenna Number, N101102103104Threshold Distance (m)
Fig. 15: ULA-to-ULA scenario: The threshold distance versu s
the antenna number N, whenθ=φ= 0◦,M= 128 , and
λ= 0.01m.
-80 -60 -40 -20 0 20 40 60 80
 (degrees)-80-60-40-20020406080 (degrees)
00.10.20.30.40.50.60.70.80.91
Threshold Distance (m)
Fig. 16: The equi-rank surface of a ULA to a ULA.
Proposition 4: If the threshold distance for λ0,N0,M0,
db0,du0, andθ0=φ0= 0◦isr0, then the threshold distance
for anyλ,N,M,dbanddu, whenθ0=φ0= 0◦can be
approximated by
r1=NdbMdu
N0db0M0du0λ0
λr0. (26)
Proposition 4 uncovers the relationships between the equi-
rank surface and antenna structure when θ=φ= 0◦. When
λ= 0.01m,db0=du0=λ
2, andN0=M0= 100 , the
threshold distance r0≈141.91m. Combining Proposition
3 and Proposition 4, the equi-rank surface for any antenna
structure and any angle can be obtained. For instance, when
λ= 0.005m,db=du=λ
2,N= 256 ,M= 64 ,θ= 10◦, and
φ= 30◦, we have r1= 116.25m according to Eq. (26), the
threshold distance r= 87.70m according to Eq. (25), while
the result obtained by simulation is 87.60 m, showing that th e
analytic approximation ﬁts the simulation results well. Fi g. 16
illustrates the equi-rank surface of ULA to ULA when r1= 1
m in Eq. (25) for better understanding.
Actually, Proposition 3 and Proposition 4 also work when11
TABLE II: Values of r0in Eq. (26) versus δ∆, whereλ= 0.01
m,db0=du0=λ
2, andN0=M0= 100 .
Threshold δ∆r0(m)
1.05 141.91
1.10 93.62
1.20 61.13
1.50 33.78
2.00 20.41
TABLE III: Comparison among different demarcations be-
tween applicable regions for SWM and PWM for the ULA-to-
ULA scenario, where N= 100 ,λ= 0.01m, andθ=φ= 0◦.
Different demarcations (m) M= 10M= 100
Classical Rayleigh distance 60.50 200.00
The distance in [27] 9.13 31.74
Proposed equi-rank surface 14.19 141.90
δ∆(1< δ∆≤2) is set to different values, with the difference
of varied values of r0in Eq. (26). Table II displays some
values of r0in Eq. (26) versus δ∆, whereλ= 0.01m,db0=
du0=λ
2, andN0=M0= 100 . With smaller threshold δ∆, the
distancer0is larger. The smaller the threshold δ∆is, the closer
the SWM is to the PWM, and the lower our error tolerance
is.
Besides, Table III compares different demarcations betwee n
applicable regions for SWM and PWM for the MIMO sce-
nario, where N= 100 ,λ= 0.01m,du=db=λ
2, and
θ=φ= 0◦. In Table III, the classical Rayleigh distance
is obtained according to2(D1+D2)2
λ[39], where D1andD2
denote the array aperture at the BS and user, respectively;
the distance in [27] is calculated by/radicalig
(N2−1)(M−1)2π2
6M(1−g)dudb
λ,
wheregis set to 0.99. The classical Rayleigh distance is
larger than the other two demarcations since it is based on th e
phase difference. In addition, the classical Rayleigh dist ance
is independent of the angles, which is not practical. The
authors in [27] only consider the largest eigenvalue, while all
eigenvalues are involved in our proposed equi-rank surface ,
and it turns out that the proposed equi-rank surface is large r
than the distance in [27].
Similar to Section II, we consider multiple scatterers here .
For simplicity and without loss of generality, suppose ther e
are two scatterers with polar coordinates of (r/2,θ+ζ)and
(r/2,θ−ζ), respectively, where ζis a constant angle. The
channel in Eq. (21) can be represented as
hnm=λ
4πrnme−j2π
λrnm+2/summationdisplay
ℓ=1βℓλ
4πrnℓrℓme−j2π
λ(rnℓ+rℓm),
(27)
wherernℓdenotes the distance between the n-th antenna at the
BS and the ℓ-th scatterer, rℓmdenotes the distance between
theℓ-th scatterer and the m-th antenna at the user, and βℓ
denotes the attenuation and phase shift caused by the ℓ-th
scatterer. For convenience, we assume |β1|=|β2|=|β|,
andarg{β1}= arg{β2} ∼ U(−π,π). Assume the user
and scatterers are located in the far ﬁeld of the ULA, we
can obtain the effective rank of the channel, denoted as Ξ.
Then, we deﬁne the distance where the effective rank of the
channel reaches Ξ+ 0.05as the equi-rank surface. The user-80 -60 -40 -20 0 20 40 60 80
 (degree)01020304050607080Threshold Distance (m)||=0.7
||=0.5
||=0.3
||=0.1
Analytic Approximation
Fig. 17: ULA-to-ULA scenario: The threshold distance versu s
θwith two scatterers, where φ= 0◦,ζ= 5◦,N= 128 ,
M= 32 , andλ= 0.01m.
-40 -30 -20 -10 0 10 20 30 40
 (degree)303540455055606570Threshold Distance (m)||=0.7
||=0.5
||=0.3
||=0.1
Analytic Approximation
Fig. 18: ULA-to-ULA scenario: The threshold distance versu s
θwith two scatterers, where φ= 0◦,ζ= 50◦,N= 128 ,
M= 32 , andλ= 0.01m.
and scatterers are assumed to be located in the right-hand si de
of the ULA. The threshold distance versus θis illustrated in
Figs. 17-19 for various values of φandζ, whereN= 128 ,
M= 32 ,λ= 0.01m, anddu=db=λ
2. The simulations
are averaged over 100 independent realizations of scatteri ng
phase shifts. It is found that when the power of the scatterer s,
i.e.,|β|is small, the obtained threshold distance is close to
the analytical approximation.
V. E QUI-RANK SURFACE OF A ULA TO A UPA
In this section, we focus on the equi-rank surface between
anM-element ULA and an N=Ny×NzUPA as shown in
Fig. 20, where the UPA lies in the YZ-plane, and the midpoint
of the UPA lies at (0,0,0). The coordinate of the nynz-
th antenna is (0,δ(n)
ydy,δ(n)
zdz), whereδ(n)
y=ny−Ny−1
2
withny= 0,1,...,N y−1,δ(n)
z=nz−Nz−1
2with
nz= 0,1,...,N z−1,dydenotes the antenna spacing
along the Y direction, and dzdenotes the antenna spacing
along the Z direction. The coordinate of the ﬁrst antenna of
the user is (x,y,z)with its polar coordinate (r,φ,ϕ). The
azimuth angle and elevation angle of the ULA of the user12
-80 -60 -40 -20 0 20 40 60 80
 (degree)010203040506070Threshold Distance (m)||=0.7
||=0.5
||=0.3
||=0.1
Analytic Approximation
Fig. 19: ULA-to-ULA scenario: The threshold distance versu s
θwith two scatterers, where φ= 50◦,ζ= 5◦,N= 128 ,
M= 32 , andλ= 0.01m.
φ   
ϕ   User
(x,y,z)
x-axis 
y-axis z-axis 
BS 
(   
Fig. 20: The system layout of a ULA to a UPA under the
SWM.
areϕuandφu, respectively. Thus, the coordinate of the m-
th antenna of the user is (x+δ(m)ducos(φu)cos(ϕu),y+
δ(m)ducos(φu)sin(ϕu),z+δ(m)dusin(φu)), whereδ(m)=
mwithm= 0,1,...,M−1, andduis the antenna spacing
of the ULA at the user. The channel matrix between the BS
and the user under the SWM is denoted as Hs∈CN×M,
where the ((nz−1)Ny+ny,m)-th entry of Hs, i.e.,hnynz,m,
denotes the channel between the nynz-th antenna at the BS
and them-th antenna at the user, satisfying
hnynz,m=λ
4πrnynz,me−j2π
λrnynz,m, (29)
wherernynz,mdenotes the distance between the nynz-th
antenna at the BS and the m-th antenna at the user, which
can be expressed as Eq. (28). Similar to Eq. (23), we are
interested in the effective rank of the matrix W. For brevity,
we only consider the scenario where the ULA of the user is
parallel to the UPA of the BS, which is the most typical settin g
in practical implementations. Speciﬁcally, we ﬁx φu= 0◦
andϕu= 90◦. Hence, the ULA is parallel to the Y-axis.
The solutions r(φ,ϕ)oferank(W)(r,φ,ϕ) =δ∆denote
approximately the same effective rank against the PWM.Thereby, we name the threshold distance r(φ,ϕ)asequi-rank
surface . Similar to Section IV, we explore the effective rank
of the matrix Wthrough two parts. The threshold δ∆in this
section is set to 1.05 as well.
To begin with, let us focus on the ﬁrst part to investigate the
relationship between the threshold distance and the angles for a
ﬁxed antenna structure, as shown in Fig. 21 and Fig. 22, where
Ny=Nz= 127 ,M= 32 ,λ= 0.01m, anddu=db=λ
2.
Fig. 21 illustrates the threshold distance versus the eleva tion
anglesφwith a ﬁxed azimuth angle ϕ, where the solid and
dotted curves represent the simulation results and the anal ytic
approximations, respectively. Note that the analytic expr ession
will be explained later. Denote the threshold distance when
φ=ϕ= 0◦asr1. There are some interesting observations:
1) When ϕ= 90◦, the simulation results ﬁt the expression
r1sin(φ)well, except for the points around φ= 0◦. 2)
As the elevation angle φincreases, all curves increase from
r1cos2(ϕ)tor1.
Fig. 22 shows the threshold distance versus the azimuth
angleϕwith a ﬁxed elevation angle φ. Whenφ= 0◦, the
simulation results ﬁt the expression r1cos2(ϕ)well apart from
the points around ϕ= 90◦. Furthermore, with the azimuth
angleϕincreasing, all curves decrease from r1tor1sin(φ).
Based on the above observations, we have the following
proposition.
Proposition 5: For the USPA structure, if the threshold
distance when φ0=ϕ0= 0◦isr1, with ﬁxed antenna
structure and ﬁxed wavelength, the equi-rank surface for an y
anglesφandϕis upper bounded by
r(φ,ϕ)≤r1−r1(1−|sin(φ)|)/parenleftbig
1−cos2(ϕ)/parenrightbig
. (30)
Proposition 5 unveils the relationship between the equi-ra nk
surface and the angles for a ﬁxed antenna structure. Fig. 21 a nd
Fig. 22 show that the analytic approximations in Propositio n
5 ﬁt the simulation results well when φorϕis close to 0◦or
90◦. However, the analytic approximation is an upper bound of
the simulation results for other angles. It may be caused by t he
antenna structure at the BS. We ﬁnd that when Ny≥Nz, the
analytic approximation in Proposition 5 is the upper bound o f
the simulation results. However, when Ny< Nz, the simula-
tion results may be larger than the analytic approximation. It is
worth noting that we are only looking for a simple hence easy-
to-understand analytic approximation here. More complex a nd
precise approximations are left for future studies.
Now, let us explore the relationship between the threshold
distance and the antenna structure, as shown in Fig. 23, wher e
φ=ϕ= 0◦,Ny= 100 , andλ= 0.01m. The antenna number
Mis selected from the set {25,50,100,200,400,800}. It is
remarkable that the threshold distance has a linear relatio nship
with the antenna number M. Similar to Section IV, actually,
the threshold distance has a linear relationship with the an tenna
aperture, when Ny>6andM >6. In addition, the threshold
distance is independent of Nzbecause the ULA at the user is
parallel to Y-axis and φ=ϕ= 0o. Consequently, we have the
following proposition.
Proposition 6: If the threshold distance for λ0,Ny0,M0,
dy0,du0, andφ0=ϕ0= 0◦isr0, then the threshold distance13
r2
nynz,m=/parenleftig
rcos(φ)cos(ϕ)+δ(m)ducos(φu)cos(ϕu)/parenrightig2
+/parenleftig
rcos(φ)sin(ϕ)+δ(m)ducosφusinϕu−δ(n)
ydy/parenrightig2
+/parenleftig
rsin(φ)+δ(m)dusinφu−δ(n)
zdz/parenrightig2(28)
0 10 20 30 40 50 60 70 80 90
Elevation Angle,  (degrees)0102030405060Threshold Distance (m)
Fig. 21: ULA-to-UPA scenario: The threshold distance versu s
the elevation angle φ, whenNy=Nz= 127 ,M= 32 , and
λ= 0.01m.
0 10 20 30 40 50 60 70 80 900102030405060Threshold Distance (m)=80, Analytic Approximation
=80, Simulation Result
=60, Analytic Approximation
=60, Simulation Result
=40, Analytic Approximation
=40, Simulation Result
=20, Analytic Approximation
=20, Simulation Result
=0, Analytic Approximation
=0, Simulation Result
Fig. 22: ULA-to-UPA scenario:The threshold distance versu s
the azimuth angle ϕ, whenNy=Nz= 127 ,M= 32 , and
λ= 0.01m.
for anyλ,Ny,M,dbanddu, whenφ0=ϕ0= 0◦, can be
approximated by
r1=NydyMdu
Ny0dy0M0du0λ0
λr0. (31)
Proposition 6 reveals the relationship between the equi-ra nk
surface and the antenna structure when φ=ϕ= 0◦. When
λ= 0.01m,dy0=du0=λ
2, andNy0=M0= 100 , the
threshold distance r1≈141.91m. Combing Proposition 5 and
Proposition 6, the equi-rank surface for any USPA structure
at the BS, any ULA structure at the user, and any angles can
be estimated. For instance, when λ= 0.005 m,dy=dz=
du=λ
2,Ny=Nz= 256 ,M= 64 , andφ=ϕ= 60◦, we0 100 200 300 400 500 600 700 800
Antenna number at the user, M020040060080010001200Threshold Distance (m)
Fig. 23: ULA-to-UPA scenario: The threshold distance versu s
the antenna number M, whenφ=ϕ= 0◦,Ny= 100 , and
λ= 0.01m.
-80 -60 -40 -20 0 20 40 60 80-80-60-40-20020406080
00.10.20.30.40.50.60.70.80.91
Threshold Distance (m)
Fig. 24: The equi-rank surface of a USPA to a ULA.
haver0= 116.25m based on Eq. (31), r= 104.57m based
on Eq. (30), while the actual distance obtained by simulatio n
results is 103.94m, demonstrating the accuracy of the analytic
approximation. It is worth noting that similar to Section IV ,
Proposition 5 and Proposition 6 also work when δ∆is set to
different values. Finally, Fig. 24 displays the equi-rank s urface
of a USPA to a ULA when r1= 1 m in Eq. (30) for more
intuitive understanding.
VI. C ONCLUSION
This paper studied the demarcations between applicable
regions for SWM and PWM for XL-array communication
from the viewpoint of channel gain and rank. For the single-
LoS-path scenario, closed-form expressions of the normali zed14
received power for a single point to a ULA/UCPA were de-
rived,and it was proved that |θ|=π
6andcos2(φ)cos2(ϕ) =1
2
were the dividing angles and curves, respectively. As for th e
MIMO case, a closed-form expression of the equi-rank surfac e
was obtained. With the analytical expressions derived abov e,
the equi-rank surface for any antenna structure and any angl e
could be well estimated.
The impact of multiple scatterers on the SWM/PWM de-
marcation was also considered. For the point-to-ULA case,
the threshold distance with the existence of LoS and scatter ed
paths was larger than that in the single-LoS-path case since
the phases of different paths could not be cancelled out
under MRC. The threshold distance also increased with the
number of scatterers in both LoS and NLoS environments,
and the increase is more prominent for the NLoS environment.
With fewer than 20 scattered paths in the LoS environment,
the near ﬁeld of a ULA can reach over 200 m, and this
number is even larger for the NLoS environment, which are
beyond the range of typical mmWave cells, indicating the
necessity of the consideration of SWM. For the ULA-to-ULA
case, the obtained threshold distance approached the analy tical
approximation when the power of scatterers was small. Futur e
work may consider more accurate analytic approximations of
the boundary surface for the ULA-to-UPA scenario as well
as the effect of multiple scatterers in the scenarios contai ning
UPAs.
APPENDIX
A. Proof of Theorem 1
The coefﬁcient µ(r,θ)can be calculated as Eq. (32). Note
that the operator1
2−1
2N/summationtext
m=−1
2+1
2Ncalculates the summation with
m=−1
2+1
2N,−1
2+3
2N,...,1
2−1
2N. Let∆m=1
N, Eq. (32)
can be translated into Eq. (33). Since/integraltext1
am2−bm+cdm=
2arctan/parenleftig
2am−b√
4ac−b2/parenrightig
√
4ac−b2+Const , whereConst denotes a con-
stant number, by letting a=N2d2,b= 2rNdsinθand
c=r2, we have
µ(r,θ) =r
Ndcos(θ)/bracketleftbigg
arctan/parenleftbiggNd
2rcos(θ)+tan(θ)/parenrightbigg
+ arctan/parenleftbiggNd
2rcos(θ)−tan(θ)/parenrightbigg/bracketrightbigg
.(42)
It is worth noting that the closed-form expression in Eq. (42 )
is accurate even when the antenna number Nis small, though
it is derived when N→ ∞ .
B. Proof of Proposition 1
Sinceµ(r,θ)is an even function over the distance r. Here,
we only consider 0≤θ <π
2. We will prove the proposition
by deriving its ﬁrst partial derivative, shown in Eq. (34), a nd
the second partial derivative over the distance r,
∂2µ(r,θ)
∂r2=8N2d2f1(r,θ)
f2(r,θ), (43)wheref1(r,θ)andf2(r,θ)are shown in Eq. (35).
Let us focus on f1(r,θ). We consider the following two
cases.
1) Whentan2(θ) =1
3, i.e.,θ=π
6,f1=−8N2d2−N4d4<
0. Thereby,∂2µ(r,θ)
∂r2is always smaller than zero. Note that
∂µ(r,θ)
∂r→0asr→+∞. As a result,∂µ(r,θ)
∂r→0is always
larger than zero. In this case, the coefﬁcient µalways increases
as the distance increase, and is always smaller than one.
2) When tan2(θ)/ne}ationslash=1
3, denote c=−N4d4,
a= 16cos4(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig
, andb=
−8N2d2cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig
, the discriminant ∆ =/parenleftbig
16N2d2cos2(θ)tan(θ)/parenrightbig2/parenleftbig
tan2(θ)+1/parenrightbig
>0. Thus, the roots
rf1off1(r,θ) = 0 is given by
rf1=N2d2tan2(θ)+1±2tan(θ)/radicalbig
tan2(θ)+1
4cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig.(44)
It can be found that when 0≤θ <π
6,tan2(θ) + 1−
2tan(θ)/radicalbig
tan2(θ)+1>0; whenπ
6< θ <π
2,tan2(θ) +
1−2tan(θ)/radicalbig
tan2(θ)+1<0. Whentan2(θ)<1
3, i.e.,
0≤θ <π
6, the two numerators of rf1are larger than zero.
The denominator of rf1is smaller than zero. Thus, the two
rootsrf1are smaller than zero. Therefore,∂2µ(r,θ)
∂r2is always
smaller than zero.∂µ(r,θ)
∂ris always bigger than 0. In this case,
the coefﬁcient µis always smaller than one.
Whentan2(θ)>1
3, i.e.,π
6< θ <π
2, one numerators of
rf1is larger than zero, and the other is smaller than zero.
The denominator of rf1is larger than zero. Thus, one root is
smaller than zero, and the other is larger than zero. Denote
r1/definesNd/radicaligg
tan2(θ)+1+2tan( θ)/radicalbig
tan2(θ)+1
4cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig,(45)
then when 0< r < r 1,∂2µ(r,θ)
∂r2<0; whenr > r 1,
∂2µ(r,θ)
∂r2>0. In this case, the coefﬁcient µ(r,θ)will ﬁrst
increase, and then decrease as the distance rincreases. r1is
the distance where the coefﬁcient µ(r,θ)drops the fastest. If
µ(r,θ)reaches its peak at the distance r2, thenr2is slightly
smaller than r1. When−π
2< θ <−π
6, we have
r1=Nd/radicaligg
tan2(θ)+1−2tan(θ)/radicalbig
tan2(θ)+1
4cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig.(46)
As such, r1can be expressed as
r1=Nd/radicaligg
tan2(θ)+1+2 |tan(θ)|/radicalbig
tan2(θ)+1
4cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig.(47)
C. Proof of Theorem 2
Note that area one for USPA is identical to that for a UCPA
with a radius of1√π. Thus, the integration area for USPA is
A={(ρ,θ)|0≤ρ≤1√π,−π≤θ≤π}. Denote my=
ρcos(θ), andmz=ρsin(θ), let us consider the following
two cases.
1) When φ=ϕ= 0 , considering uniform elliptical
planar array structure, µ(r,0,0)can be expressed as Eq.
(36). Without loss of generality, assume Nydy≥Nzdz, Eq.15
µ(r,θ) =r2
NN/summationdisplay
n=11
r2n
=r2
NN/summationdisplay
n=11
r2−2rsin(θ)dδ(n)+/parenleftbig
δ(n)d/parenrightbig2
=r2
NN−1/summationdisplay
n=01
r2−2rsin(θ)d/parenleftbig
n−N−1
2/parenrightbig
+/parenleftbig
n−N−1
2/parenrightbig2d2
=r2
NN−1
2/summationdisplay
n=−N−1
21
r2−2rsin(θ)nd+n2d2
=r21
2−1
2N/summationdisplay
m=−1
2+1
2N1
N2d2m2−2rNdsin(θ)m+r21
N.(32)
µ(r,θ) =r21
2−1
2N/summationdisplay
m=−1
2+1
2N1
N2d2m2−2rNdsin(θ)m+r2∆m
N→∞=r2/integraldisplay1/2
−1/21
N2d2m2−2rNdsin(θ)m+r2dm.(33)
∂µ(r,θ)
∂r=/parenleftbigg
−Nd
2cos(θ)/parenleftBig
(Nd
2 cos(θ)r+tan(θ))2+1/parenrightBig
r2−Nd
2cos(θ)/parenleftBig
(Nd
2 cos(θ)r−tan(θ))2+1/parenrightBig
r2/parenrightbigg
r
Ndcos(θ)
+arctan/parenleftig
Nd
2cos(θ)r+tan(θ)/parenrightig
+arctan/parenleftig
Nd
2cos(θ)r−tan(θ)/parenrightig
Ndcos(θ).(34)
f1(r,θ) = 16cos4(θ)/parenleftbig
tan2(θ)+1/parenrightbig/parenleftbig
3tan2(θ)−1/parenrightbig
r4−8N2d2cos2(θ)/parenleftbig
tan2(θ)+1/parenrightbig
r2−N4d4.
f2(r,θ) =/parenleftbig/parenleftbig
4cos2(θ)tan2(θ)+4cos2(θ)/parenrightbig
r2−4Ndcos(θ)tan(θ)r+N2d2/parenrightbig2
×/parenleftbig/parenleftbig
4cos2(θ)tan2(θ)+4cos2(θ)/parenrightbig
r2+4Ndcos(θ)tan(θ)r+N2d2/parenrightbig2.(35)
µ(r,0,0) =r2/integraldisplayπ
−π/integraldisplay1/√π
0ρ/parenleftbig
N2yd2ycos2(θ)+N2zd2zsin2(θ)/parenrightbig
ρ2+r2dρdθ. (36)
µ(r,0,0) =r2/integraldisplay1/√π
0/integraldisplayπ
−πρ
r2+ρ2N2zd2z+ρ2/parenleftbig
N2yd2y−N2zd2z/parenrightbig
cos2(θ)dθdρ
= 4r2/integraldisplay1/√π
0/integraldisplayπ/2
0ρ
r2+ρ2N2zd2z+ρ2/parenleftbig
N2yd2y−N2zd2z/parenrightbig
cos2(θ)dθdρ.(37)
µ(r,0,0) =2πr2
NydyNzdzln
Nzdz/radicalig
N2yd2y
πr2+1+Nydy/radicalig
N2zd2z
πr2+1
Nydy+Nzdz
. (38)
µ(r,φ,ϕ) =r2/integraldisplay1/√π
0/integraldisplayπ
−πρ
−2rcos(φ)sin(ϕ)Dρcos(θ)−2rsin(φ)Dρsin(θ)+D2ρ2+r2dθdρ. (39)
µ(r,φ,ϕ) = 2πr2/integraldisplay1/√π
0ρ/radicalbig
D4ρ4+(4cos2(φ)cos2(ϕ)−2)r2D2ρ2+r4dρ. (40)
µ(r,β) =πr2
2D2

ln
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4+/parenleftig
2D4
π+(4β−2)r2D2/parenrightig
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4−/parenleftbig2D4
π+(4β−2)r2D2/parenrightbig
+ln/bracketleftbigg1−β
β/bracketrightbigg

. (41)16
∂µ(r,φ,ϕ)
∂r=π
2D2
2rf1(r,β)−4D2r
π/radicalig
r4+D2(4β−2)r2
π+D4
π2
 (50)
∂2µ(r,φ,ϕ)
∂r2=π
2D2
2f1(r,β)−16D2
π/radicalig
r4+D2(4β−2)r2
π+D4
π2+4D2/parenleftbig
3π2r4+2πD2(4β−2)r2+D4/parenrightbig
π3/parenleftig
r4+D2(4β−2)r2
π+D4
π2/parenrightig3
2
 (51)
∂3µ(r,φ,ϕ)
∂r3=3(4β−2)D2π3r6+10D4π2r4+(4β−2)D6πr2−2D8
2D2π4/radicalig
r4+D2(4β−2)r2
π+D4
π2(52)
f1(r,β) = ln
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4+/parenleftig
2D4
π+(4β−2)r2D2/parenrightig
2D2/radicalig
D4
π2+(4β−2)r2D2
π+r4−/parenleftbig2D4
π+(4β−2)r2D2/parenrightbig
+ln/bracketleftbigg1−β
β/bracketrightbigg
, (53)
(36) can be translated into Eq. (37). Since/integraltexta
b+ccos2(θ)dθ=
aarctan/parenleftig√
btan(θ)√c+b/parenrightig
√
b√
c+b+Const , leta=ρ,b=r2+ρ2N2
zd2
z,
andc=ρ2/parenleftbig
N2
yd2
y−N2
zd2
z/parenrightbig
, yielding
µ(r,0,0) =/integraldisplay1/√π
02πr2ρ
/radicalbig
r2+ρ2N2zd2z/radicalig
r2+ρ2N2yd2ydρ.
(48)
Since/integraltext ρ/radicalbig
a+bρ2/radicalbig
a+cρ2dx =
ln/parenleftig√
b/radicalbig
cρ2+a+√c/radicalbig
bρ2+a/parenrightig
√
b√c+Const , leta=r2,
b=N2
zd2
z, andc=N2
yd2
y,µ(r,0,0)can be represented as
Eq. (38).
When it is UCPA structure, i.e., Nydy=Nzdz=D, we
have
µ(r,0,0) =πr2
D2ln/parenleftbiggD2
πr2+1/parenrightbigg
. (49)
2) When φ/ne}ationslash= 0 orϕ/ne}ationslash= 0 , considering the UCPA
structure, i.e., Nydy=Nzdz=D,µ(r,φ,ϕ)can
be calculated as Eq. (39). Since/integraltext1
acos(θ)+bsin(θ)+cdθ=
2√
c2−a2−b2arctan/parenleftig
(c−a)tan(θ/2)+b√
c2−a2−b2/parenrightig
+Const , leta=
−2rcos(φ)sin(ϕ)Dρ,b=−2rsin(φ)Dρ, andc=
D2ρ2+r2,µ(r,φ,ϕ)can be translated into Eq. (40). Since
/integraltextρ√
aρ4+bρ2+cdρ=1
4√aln/parenleftbigg
2√a√
aρ4+bρ2+c+(2aρ2+b)
2√a√
aρ4+bρ2+c−(2aρ2+b)/parenrightbigg
+
Const , leta=D4,b=/parenleftbig
4cos2(φ)cos2(ϕ)−2/parenrightbig
r2D2, and
c=r4,µ(r,φ,ϕ)can be expressed as Eq. (41), where
β= cos2(φ)cos2(ϕ).
D. Proof of Proposition 2
Whenφ=ϕ= 0, sinceln(x+1)
x<1forx >0,µ(r,0,0)
is always smaller than one.
Whenφ/ne}ationslash= 0 orϕ/ne}ationslash= 0, the ﬁrst, second and third partial
derivative of µ(r,β)can be expressed as Eq. (50), Eq. (51),
and Eq. (52), respectively, where f1(r,β)is given in Eq.
(53). Let f2(r,β) = 3(4β−2)D2π3r6+10D4π2r4+(4β−2)D6πr2−2D8, we have
∂f2(r,β)
∂r= 2πD2r/parenleftbig
9π2(4β−2)r4+20πD2r2/parenrightbig
+2πD2r/parenleftbig
D4(4β−2)/parenrightbig
/defines2πD2rf3(r,β)(54)
Let us consider the following three cases.
1) When β=1
2,∂f2(r,β)
∂r= 40π2D4r2>0. Since
f2(0,β) =−2D8<0andf2(r→+∞,β)>0,f2(r,β) = 0
only has one positive root.
2) When1
2< β < 1, the discriminant of f3(r,β)is
∆ = 4π2D4/parenleftbig
100−9(4β−2)2/parenrightbig
>0due to0≤β <1.
The roots of f3(r,β) = 0 areD2/parenleftBig
−10±√
100−9(4β−2)2/parenrightBig
9π(4β−2)<0.
Thus,f3(r,β)>0, and∂f2(r,β)
∂r>0,f2(r,β)only has one
positive root.
3) When 0< β <1
2, the roots of f3(r,β) = 0 are
D2/parenleftBig
−10±√
100−9(4β−2)2/parenrightBig
9π(4β−2)>0. Thus,f2(r,β) = 0 has two
positive roots.
Therefore, when1
2≤β <1,∂3µ(r,φ,ϕ)
∂r3= 0 only has one
positive root, denoted by r1. When0< r < r 1,∂3µ(r,φ,ϕ)
∂r3<
0; whenr > r1,∂3µ(r,φ,ϕ)
∂r3>0. Note that∂2µ(r,φ,ϕ)
∂r2|r→0→
+∞and∂2µ(r,φ,ϕ)
∂r2|r→+∞= 0. Thus,∂2µ(r,φ,ϕ)
∂r2= 0 has
only one positive root, denoted by r2. When0< r < r 2,
∂2µ(r,φ,ϕ)
∂r2>0; whenr > r 2,∂2µ(r,φ,ϕ)
∂r2<0. Note that
∂µ(r,φ,ϕ)
∂r|r→0→0and∂µ(r,φ,ϕ)
∂r|r→+∞= 0 . Thereby,
∂µ(r,φ,ϕ)
∂ris always bigger than zeros. Hence, µ(r,φ,ϕ)always
increases as the distance rincreases, and µ(r,φ,ϕ)is always
smaller than one.
When0< β <1
2,∂3µ(r,φ,ϕ)
∂r3= 0 has two positive roots,
denoted by r3andr4. When0< r < r 3orr > r 4,
∂3µ(r,φ,ϕ)
∂r3<0; whenr3< r < r 4,∂3µ(r,φ,ϕ)
∂r3>0. As
such,∂2µ(r,φ,ϕ)
∂r2= 0 has two positive roots, denoted by r5
andr6. When0< r < r 5orr > r6,∂2µ(r,φ,ϕ)
∂r2>0; when
r5< r < r 6,∂2µ(r,φ,ϕ)
∂r2<0. Then,∂µ(r,φ,ϕ)
∂r= 0 has one
positive root, denoted by r7. When0< r < r 7,∂µ(r,φ,ϕ)
∂r>0;
whenr > r7,∂µ(r,φ,ϕ)
∂r<0. Therefore, in this case, µ(r,φ,ϕ)
will ﬁrst increase, and then decrease until it approaches on e17
as the distance increases. µ(r,φ,ϕ)reaches its peak at the
distancer7. According to f3(r,β) = 0 , we have
r8=D/radicaligg
10+/radicalbig
100−9(4β−2)2
9π(2−4β). (55)
It is found that r8is close to the point where the second partial
derivative of µ(r,φ,ϕ)overris zero. Then, r7is slightly
smaller than r8.
REFERENCES
[1] J. Zhang, E. Bj¨ ornson, M. Matthaiou, D. W. K. Ng, H. Yang, and D. J.
Love, “Prospective multiple antenna technologies for beyo nd 5G,” IEEE
Journal on Selected Areas in Communications , vol. 38, no. 8, pp. 1637–
1660, Aug. 2020.
[2] W. Saad, M. Bennis, and M. Chen, “A vision of 6G wireless sy stems:
Applications, trends, technologies, and open research pro blems,” IEEE
Network , vol. 34, no. 3, pp. 134–142, May 2020.
[3] X. You, C.-X. Wang, J. Huang, X. Gao, Z. Zhang, M. Wang, Y . H uang,
C. Zhang, Y . Jiang, J. Wang et al. , “Towards 6G wireless communication
networks: Vision, enabling technologies, and new paradigm shifts,”
Science China Information Sciences , vol. 64, no. 1, pp. 1–74, 2021.
[4] Z. Wang, Y . Du, K. Wei, K. Han, X. Xu, G. Wei, W. Tong, P. Zhu, J. Ma,
J. Wang et al. , “Vision, application scenarios, and key technology trend s
for 6G mobile communications,” Science China Information Sciences ,
vol. 65, no. 5, pp. 1–27, Mar. 2022.
[5] J. C. Marinello, T. Abr˜ ao, A. Amiri, E. De Carvalho, and P . Popovski,
“Antenna selection for improving energy efﬁciency in xl-mi mo systems,”
IEEE Transactions on Vehicular Technology , vol. 69, no. 11, pp. 13 305–
13 318, 2020.
[6] I. F. Akyildiz and J. M. Jornet, “Realizing ultra-massiv e MIMO (1024 ×
1024) communication in the (0.06–10) terahertz band,” Nano Commu-
nication Networks , vol. 8, pp. 46–54, 2016.
[7] E. D. Carvalho, A. Ali, A. Amiri, M. Angjelichinoski, and R. W. Heath,
“Non-stationarities in extra-large-scale massive MIMO,” IEEE Wireless
Communications , vol. 27, no. 4, pp. 74–80, Aug. 2020.
[8] A. Amiri, M. Angjelichinoski, E. de Carvalho, and R. W. He ath,
“Extremely large aperture massive MIMO: Low complexity rec eiver
architectures,” in 2018 IEEE Globecom Workshops (GC Wkshps) , Dec.
2018, pp. 1–6.
[9] H. Lu and Y . Zeng, “Communicating with extremely large-s cale ar-
ray/surface: Uniﬁed modelling and performance analysis,” IEEE Trans-
actions on Wireless Communications , pp. 1–1, Jun. 2021.
[10] A. Liao, Z. Gao, Y . Yang, H. H. Nguyen, H. Wang, and H. Yin,
“Angle estimation for terahertz ultra-massive MIMO-based space-to-
air communications,” in 2021 IEEE/CIC International Conference on
Communications in China (ICCC) , 2021, pp. 776–781.
[11] S. J. Maeng, Y . Yapici, I. Guvenc, A. Bhuyan, and H. Dai, “ Precoder
design for physical-layer security and authentication in m assive MIMO
UA V communications,” IEEE Transactions on Vehicular Technology ,
vol. 71, no. 3, pp. 2949–2964, Mar. 2022.
[12] S. Hu, F. Rusek, and O. Edfors, “Beyond massive MIMO: The potential
of data transmission with large intelligent surfaces,” IEEE Transactions
on Signal Processing , vol. 66, no. 10, pp. 2746–2758, May 2018.
[13] L. Zhang, M. Z. Chen, W. Tang, J. Y . Dai, L. Miao, X. Y . Zhou , S. Jin,
Q. Cheng, and T. J. Cui, “A wireless communication scheme bas ed on
space-and frequency-division multiplexing using digital metasurfaces,”
Nature electronics , vol. 4, no. 3, pp. 218–227, Mar. 2021.
[14] R. Li, S. Sun, Y . Chen, C. Han, and M. Tao, “Ergodic achiev able rate
analysis and optimization of RIS-assisted millimeter-wav e MIMO com-
munication systems,” IEEE Transactions on Wireless Communications ,
pp. 1–1, 2022.
[15] X. Shao, C. You, W. Ma, X. Chen, and R. Zhang, “Target sens ing
with intelligent reﬂecting surface: Architecture and perf ormance,” IEEE
Journal on Selected Areas in Communications , vol. 40, no. 7, pp. 2070–
2084, Jul. 2022.
[16] R. Li, S. Sun, and M. Tao, “Ergodic achievable rate maxim ization of
RIS-assisted millimeter-wave MIMO-OFDM communication sy stems,”
IEEE Transactions on Wireless Communications , pp. 1–1, 2022.
[17] S. Sun and M. Tao, “Characteristics of channel eigenval ues and
mutual coupling effects for holographic reconﬁgurable int elligent
surfaces,” Sensors , vol. 22, no. 14, Jul. 2022. [Online]. Available:
https://www.mdpi.com/1424-8220/22/14/5297[18] B. Friedlander, “Localization of signals in the near-ﬁ eld of an antenna
array,” IEEE Transactions on Signal Processing , vol. 67, no. 15, pp.
3885–3893, Aug. 2019.
[19] Y . Miao, J.-i. Takada, K. Saito, K. Haneda, A. A. Glazuno v, and Y . Gong,
“Comparison of plane wave and spherical vector wave channel modeling
for characterizing non-specular rough-surface wave scatt ering,” IEEE
Antennas and Wireless Propagation Letters , vol. 17, no. 10, pp. 1847–
1851, Oct. 2018.
[20] Y . Miao, W. Fan, J. Takada, R. He, X. Yin, M. Yang, J. Rodr´ ıguez-
Pi¨ neiro, A. A. Glazunov, W. Wang, and Y . Gong, “Comparing ch annel
emulation algorithms by using plane waves and spherical vec tor waves in
multiprobe anechoic chamber setups,” IEEE Transactions on Antennas
and Propagation , vol. 67, no. 6, pp. 4091–4103, Jun. 2019.
[21] Y . Miao, K. Haneda, J.-I. Naganawa, M. Kim, and J.-I. Tak ada,
“Measurement-based analysis and modeling of multimode cha nnel
behaviors in spherical vector wave domain,” IEEE Transactions on
Wireless Communications , vol. 19, no. 8, pp. 5345–5358, Aug. 2020.
[22] C. A. Balanis, Advanced engineering electromagnetics . John Wiley &
Sons, 2012.
[23] ——, Antenna theory: analysis and design . John wiley & sons, 2015.
[24] K. T. Selvan and R. Janaswamy, “Fraunhofer and fresnel d istances : Uni-
ﬁed derivation for aperture antennas.” IEEE Antennas and Propagation
Magazine , vol. 59, no. 4, pp. 12–15, Aug. 2017.
[25] J.-S. Jiang and M. Ingram, “Spherical-wave model for sh ort-range
MIMO,” IEEE Transactions on Communications , vol. 53, no. 9, pp.
1534–1541, Sep. 2005.
[26] F. Bohagen, P. Orten, and G. E. Oien, “Design of optimal h igh-
rank line-of-sight MIMO channels,” IEEE Transactions on Wireless
Communications , vol. 6, no. 4, pp. 1420–1425, Apr. 2007.
[27] ——, “On spherical vs. plane wave modeling of line-of-si ght MIMO
channels,” IEEE Transactions on Communications , vol. 57, no. 3, pp.
841–849, Mar. 2009.
[28] P. Wang, Y . Li, X. Yuan, L. Song, and B. Vucetic, “Tens of g igabits wire-
less communications over E-Band LoS MIMO channels with unif orm
linear antenna arrays,” IEEE Transactions on Wireless Communications ,
vol. 13, no. 7, pp. 3791–3805, Jul. 2014.
[29] Z. Zhou, X. Gao, J. Fang, and Z. Chen, “Spherical wave cha nnel
and analysis for large linear array in LoS conditions,” in 2015 IEEE
Globecom Workshops (GC Wkshps) , Dec. 2015, pp. 1–6.
[30] L. Liu, D. W. Matolak, C. Tao, Y . Li, B. Ai, and H. Chen, “Ch annel
capacity investigation of a linear massive MIMO system usin g spherical
wave model in LOS scenarios,” Science China Information Sciences ,
vol. 59, no. 2, pp. 1–15, Feb. 2016.
[31] J. Chen, S. Wang, and X. Yin, “A spherical-wavefront-ba sed scatterer
localization algorithm using large-scale antenna arrays, ”IEEE Commu-
nications Letters , vol. 20, no. 9, pp. 1796–1799, 2016.
[32] X. Yin, S. Wang, N. Zhang, and B. Ai, “Scatterer localiza tion using
large-scale antenna arrays based on a spherical wave-front parametric
model,” IEEE Transactions on Wireless Communications , vol. 16, no. 10,
pp. 6543–6556, Oct. 2017.
[33] H. Lu and Y . Zeng, “How does performance scale with anten na number
for extremely large-scale MIMO?” in ICC 2021-IEEE International
Conference on Communications . IEEE, Jun. 2021, pp. 1–6.
[34] M. Cui, L. Dai, R. Schober, and L. Hanzo, “Near-ﬁeld
wideband beamforming for extremely large antenna array,”
arXiv preprint arXiv:2109.10054 , 2021. [Online]. Available:
https://arxiv.org/abs/2109.10054
[35] E. Bj¨ ornson, ¨O. T. Demir, and L. Sanguinetti, “A primer on near-ﬁeld
beamforming for arrays and reconﬁgurable intelligent surf aces,” in 2021
55th Asilomar Conference on Signals, Systems, and Computer s, 2021,
pp. 105–112.
[36] C. Feng, H. Lu, Y . Zeng, S. Jin, and R. Zhang, “Wireless co mmu-
nication with extremely large-scale intelligent reﬂectin g surface,” in
2021 IEEE/CIC International Conference on Communications in China
(ICCC Workshops) , Jul. 2021, pp. 165–170.
[37] J. C. B. Garcia, A. Sibille, and M. Kamoun, “Reconﬁgurab le intelligent
surfaces: Bridging the gap between scattering and reﬂectio n,”IEEE
Journal on Selected Areas in Communications , vol. 38, no. 11, pp. 2538–
2547, Nov. 2020.
[38] M. Zhang and X. Yuan, “Intelligent reﬂecting surface ai ded MIMO
with cascaded line-of-sight links: Channel modelling and c apacity
analysis,” arXiv preprint arXiv:2109.08913 , 2021. [Online]. Available:
https://arxiv.org/abs/2109.08913
[39] M. Cui, Z. Wu, Y . Lu, X. Wei, and L. Dai, “Near-ﬁeld
communications for 6G: Fundamentals, challenges, potenti als, and
future directions,” arXiv preprint arXiv:2203.16318 , 2022. [Online].
Available: https://arxiv.org/abs/2203.1631818
[40] O. Roy and M. Vetterli, “The effective rank: A measure of effective
dimensionality,” in 2007 15th European Signal Processing Conference ,
Sep. 2007, pp. 606–610.
[41] S. Sun, T. S. Rappaport, M. Shaﬁ, P. Tang, J. Zhang, and P. J. Smith,
“Propagation models and performance evaluation for 5G mill imeter-
wave bands,” IEEE Transactions on Vehicular Technology , vol. 67, no. 9,
pp. 8422–8439, Sep. 2018.