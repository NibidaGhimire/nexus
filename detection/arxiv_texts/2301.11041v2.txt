arXiv:2301.11041v2  [math.RT]  19 Apr 2023Fourier transform from the symmetric square
representation of PGL 2and SL 2
G´erard Laumon
Universit´ e Paris-Saclay, LMO, CNRS
gerard.laumon@u-psud.fr
Emmanuel Letellier
Universit´ e Paris Cit´ e, IMJ-PRG
emmanuel.letellier@imj-prg.fr
April 20, 2023
Abstract
LetGbe a connected reductive group over Fqand letρ∨:G∨→GLnbe an algebraic
representation of the dual group G∨. Assuming that Gandρ∨are deﬁned overFq, Braverman
and Kazhdan deﬁned an operator on the space C(G(Fq)) of complex valued functions on
G(Fq). In this paper we are interested in the case where Gis either SL 2or PGL 2andρ∨
is the symmetric square representation of G∨. We construct a natural G×G-equivariant
embedding G֒→G=Gρand an involutive operator (Fourier transform) FGon the space of
functionsC(G(Fq)) that extends Braverman-Kazhdan’s operator.
Contents
1 Introduction 2
1.1 Motivations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.2 Braverman-Kazhdan-Fourier operators on G. . . . . . . . . . . . . . . . . . . . 3
1.3 The problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
1.4 The main results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2 Braverman-Kazhdan kernels 7
2.1 Generalities for tori . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.2 The symmetric square representations . . . . . . . . . . . . . . . . . . . . . . . 7
12
2.3 Explicit computation : The case G=SL2. . . . . . . . . . . . . . . . . . . . . 9
2.4 Explicit computation : The case G=PGL 2. . . . . . . . . . . . . . . . . . . . 11
2.5 Explicit computation : The case G=GL 2. . . . . . . . . . . . . . . . . . . . . 12
3 Extending the BK-Fourier kernel: The case G=SL2,PGL 2 14
3.1 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3.2 The tori case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
3.3 Main result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 0
3.4 Fourier transforms on quadratic spaces . . . . . . . . . . . . . . . . . . . . . . . 21
3.5 Proof of Theorem 3.3.1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
3.6 Remarks on the torus case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
4 Partial extension of the BK-Fourier kernel in the case G=GL 2 26
4.1 The stackG. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
4.2 The BK-Fourier kernels φT,φTσ. . . . . . . . . . . . . . . . . . . . . . . . . . 28
4.3 The BK-Fourier kernel φG. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
5 The characteristic 2case 29
5.1 BK-Fourier operator on G. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
5.2 Extending the BK-Fourier operator . . . . . . . . . . . . . . . . . . . . . . . . . 30
1 Introduction
1.1 Motivations
LetAbe the ring of adeles of a global ﬁeld Fand letψ:A/F→C×be a non-trivial additive
character. We can deﬁne the Fourier transform of a locally co nstant function f: gln(A)→C
with compact support as
Fgln(f)(x)=/integraldisplay
gln(A)ψ(Tr(xy))f(y)dy.
Tate, for n=1 [11], and Godement-Jacquet for arbitrary n[5] proved that this Fourier transform
provides functional equations between L-functions. The involutivity property ofFgln, namely
Fgln◦Fgln(f)=f−
where f−(x) :=f(−x), is an important ingredient.
Given now a connected reductive group Gtogether with a representation ρ∨:G∨→GL n,
Braverman-Kazhdan [1], La ﬀorgue [6] and more recently Ngˆ o [10], considered a Fourier o per-
ator on a certain space of functions on G(A) deﬁned as a restricted product of Fourier operators3
over local ﬁelds Fv. These local Fourier operators are deﬁned spectrally and ar e not involutive.
One of the challenge would be to extend them to (involutive) F ourier transforms in order to
extend Godement-Jacquet’s work to L-functions deﬁned from ρ∨.
The construction of the Fourier operator relatively to ρ∨and the problem of extending them
to involutive Fourier transforms make also sense when repla cing local ﬁelds by ﬁnite ﬁelds. The
aim of this paper is to construct such a Fourier transform (in the ﬁnite ﬁeld case) when ρ∨is the
symmetric power representation of SL 2or PGL 2. We now explain this in details.
1.2 Braverman-Kazhdan-Fourier operators on G
LetGbe a connected reductive algebraic group with an Fq-structure and associated geometric
Frobenius F:G→G. In this paper, all geometric Frobenius with be denoted by Fand relative
toq. Denote by G∨the dual group of G(in the sense of Deligne-Lusztig), a connected reductive
algebraic group deﬁned over Fq. Lusztig has deﬁned a partition of the set /hatwiderGFof all irreducible
Qℓ-characters of GF(withℓa prime not dividing q) whose parts, called Lusztig series , are indexed
by the set of F-stable semisimple conjugacy classes of G∨. We then denote by LS( G) the set of
Lusztig series of GF.
Let us equip GL nwith its standard Frobenius and assume given a morphism ρ∨:G∨→
GL nwhich commutes with Frobenius. It induces a map between sets ofF-stable semisimple
conjugacy classes and so a transfert map
tρ: LS( G)→LS(GL n)
between Lusztig series (see [8, §3.6] for more details). Thi s is the analogue of Langlands func-
toriality for ﬁnite ﬁelds.
For a ﬁnite set X, letC(X) denotes theQℓ-space of all functions X→Qℓ.
Standard Fourier operator on C(GLF
n)
Fix a non-trivial additive character ψ:Fq→Q×
ℓand denote by Tr the trace map on matrices. We
have a natural Fourier transform Fgln:C(glF
n)→C (glF
n) deﬁned by
Fgln(f)(y)=/summationdisplay
x∈glF
nψ(Tr(yx))f(x),
for any f∈C(glF
n). The involutivity property of Fglnreads
Fgln◦Fgln(f)=qn2f−
where f−(x) :=f(−x).4
The above Fourier transform restricts to an operator
FGLn:C(GLF
n)→C (GLF
n)
(which unlikeFglnis not involutive) deﬁned by
FGLn(f)(h)=/summationdisplay
g∈GLF
nψ(Tr(hg))f(g).
The above operator deﬁnes a function γGLn:/hatwidestGLF
n→Qℓwhich is constant on Lusztig series and
which satisﬁes
FGLn(χ)=γGLn(χ)χ∗
for any irreducible character χof GLF
nwhereχ∗denotes the dual character of χ(see [8, §3.1] for
more details).
BK-Fourier operator on C(GF)
We transfert the gamma function γGLnto a gamma function γG
ρ:/hatwiderGF→Qℓby the formula
γG
ρ:=cGc−1
GLnγGLn◦tρ, (1.1)
with
cG:=(−1)Fq−rank( G)qν(G)
whereν(G) is the number of positive roots of G.
Following Braverman-Kazhdan [2], deﬁne a central function φG
ρ:GF→Qℓ, called BK-
Fourier kernel, by the formula
φG
ρ:=/summationdisplay
χ∈/hatwiderGFχ(1)γG
ρ(χ)χ∗.
The BK-Fourier operator FG
ρ:C(GF)→C (GF) is deﬁned by
FG
ρ(f)(h)=/summationdisplay
g∈GFφG
ρ(hg)f(g).
Notice that
FG
ρ(χ)=γG
ρ(χ)χ∗
for any irreducible character χ(see [8, §3.5] for more details).5
This is the spectral deﬁnition of FG
ρdue to Braverman-Kazhdan. They also gave an explicit
conjectural formula for φG
ρwhich they prove for G=GL mand which is proved in full generality
in [8] (see also [4] [3] for a more geometrical proof).
1.3 The problem
A crucial property of Fourier transforms is the involutivit y property. While FGLnarises as the
restriction of the Fourier transform Fgln, we can ask ourselves wether the operator FG
ρis also the
restriction of an involutive operator. More precisely,
Question : is there an open G×G-equivariant embedding G֒→Gρdeﬁned overFq(where
G×Gacts by right and left multiplication on G) and an involutive operator C(GF
ρ)→C (GF
ρ)
restricting toFG
ρon functions on GF?
This question has a positive answer in some simple cases. For instance, if ρ∨: SL n֒→GL n
is the inclusion then there exists a dual morphism ρ: GL n→PGL nwhich is the natural quotient
[8, §3.5]. The BK-Fourier kernel φG
ρis then just ρ!(ψ◦Tr). We can then take the quotient stack
[gln/Ker(ρ)]=[gln/GL 1] asGρand consider on it the kernel ρ!(ψ◦Tr) whereρ: gln→[gln/GL 1]
is the quotient. This deﬁnes an involutive Fourier transfor m on the space of functions C(GF
ρ)
which extendsFG
ρ.
We will see in this paper, that in fact Gρmay not be not unique (see §3.6).
1.4 The main results
Here we mention only the results in odd characteristic (the c haracteristic 2 case is much simpler
and is treated independently in §5). Let Gbe either SL 2or PGL 2equipped with the standard
Frobenius Fand consider the symmetric square representation ρ∨:G∨→GL 3(see §2.2).
We will use the following identiﬁcation for G
G={(x,α,b)∈GL 2×GL 1×GL 1|det(x)=α2}/GL 1×GL 1 ifG=SL2
G={(x,α,b)∈GL 2×GL 1×GL 1|det(x)=α2}/GL 1×µ2×GL 1 ifG=PGL 2
whereµ2acts on the second coordinate by α/maps⊔o→−αand GL 1×GL 1acts by ( s,t)·(x,α,b)=
(sx,sα,tb).
Consider the stack G=Gρdeﬁned as follows6
G:=[{(x,α,b)∈gl2×gl1×gl1|det(x)=α2}/GL 1×GL 1] if G=SL2
G:=[{(x,α,b)∈gl2×gl1×gl1|det(x)=α2}/GL 1×µ2×GL 1] if G=PGL 2
Notice that the inclusion i:G֒→G is aG×G-equivariant open embedding (where G×G
acts by left and right multiplication).
Consider the kernel φG:GF→Qℓdeﬁned as follows (see §3.3):
IfG=SL2,
φG([x,α,b])=/summationdisplay
s,t∈F×qψ(s(Tr(x)+2α)+tb)
=1−qδTr(x)+2α=0.
IfG=PGL 2,
φG([x,α,b])=/summationtext
s,t∈F×q,ε∈µ2ψ(s(Tr(x)+2εα)+tb)ifα∈glF
1,
0 if α∈glF′
1.
where F′: gl1→gl1,x/maps⊔o→− xq.
Our ﬁrst main theorem is the following one (see §3.3).
Theorem 1.4.1. (i) The Fourier transform FG:C(GF)→C (GF)deﬁned from the kernel φGis
involutive , more precisely
FG◦FG(f)=q5f
for any f∈C(GF).
(ii)FGextends the BK-Fourier operator FG=FG
ρ, i.e.
FG=i∗◦FG◦i!.
To prove the above theorem we need the following unsatisfact ory trick
/summationdisplay
s∈F×qψ(sτ)=/summationdisplay
s∈F×qψ(sτ2)
as an essential ingredient.
Finally we will discuss the case of the symmetric square repr esentation of G=GL 2. The
BK-Fourier kernel turns out be more complicated. However th ere is still a natural stack Gρand
a natural Fourier operator on the space of functions on Fq-points but it is not involutive.7
2 Braverman-Kazhdan kernels
We choose a ﬁnite ﬁeld Fqand a prime ℓwhich does not divide q. In sections 2.3 2.4 2.5 the
characteristic ofFqwill be assumed to be odd. Throughout this paper αo:F×
q→Q×
ℓwill denote
the character that takes the value 1 at squares and the value −1 at non-squares. We also ﬁx a
non-trivial additive linear character ψ:Fq→Q×
ℓand denote by Tr the trace map on matrices.
The maximal torus of GL nof diagonal matrices is denoted by Tn.
2.1 Generalities for tori
LetS,S∨be two tori deﬁned over Fqwith geometric Frobenius F. Recall that ( S,F) and ( S∨,F)
are dual if there exists an isomorphism X(S)≃Y(S∨) compatible with Galois action where X(S)
denotes the character group of SandY(S∨) the co-character group of S∨.
Given a morphism ρ∨:S∨→S′∨deﬁned overFq, we get a dual morphismρ:S′→S(see
for instance [8, §3.5]). More concretely, if
ρ∨:S∨→T∨
n=Tn,s/maps⊔o→(α1(s),...,α n(s))
withα1,...,α n∈X(S∨), then
ρ:Tn→S,(t1,..., tn)/maps⊔o→α1(t1)···αn(tn)
whereα1,...,α nare regarded as co-characters of Sunder the isomorphism X(S∨)≃Y(S).
IfTnis equipped with the standard Frobenius that raises matrix c oeﬃcients to their q-th
power, the BK-Fourier kernel φS
ρis then (see [8, Lemma 5.2.1])
φS
ρ=cSc−1
TnρF
!(ψ◦Tr|Tn).
where
cS:=(−1)Fq−rank( S). (2.1)
2.2 The symmetric square representations
LetGbe denote either PGL 2, SL 2or GL 2overFqequipped with standard Frobenius F:G→G
that raises matrix coe ﬃcients to their q-th power. Denote by ( G∨,F) the dual of ( G,F) (in the
sense of Deligne-Lusztig) so that PGL∨
2=SL2, SL∨
2=PGL 2and GL∨
2=GL 2equipped with
standard Frobenius.
Denote by
ρ∨:G∨→GL 38
thesymmetric square representation ofG∨, namely if we let Sym2: GL 2→GL 3be deﬁned by
Sym2/parenleftigga b
c d/parenrightigg
=a2ab b2
2ac ad+bc2bd
c2cd d2,
then
ρ∨=Sym2ifG=GL 2
ρ∨=Sym2|SL2ifG=PGL2
ρ∨=Sym2·det−1ifG=SL2.
Remark 2.2.1 .Notice that we have factorizations
SL2π∨/d47/d47
f∨/d35/d35●●●●●●●●GL 2Sym2/d47/d47GL 3
PGL 2Sym2·det−1/d59/d59✇✇✇✇✇✇✇✇✇(2.2)
where f∨is the canonical quotient and π∨the canonical inclusion.
The morphism ρ∨commutes thus with the Frobenius morphisms. We denote by Tthe max-
imal torus of Gconsisting of diagonal matrices, and we denote by W={1,σ}≃S2the Weyl
group of Gwith respect to T. The morphism ρ∨induces a morphism W→S3mapping the
non-trivial element σofWto the transposition (13) ∈S3which we also denote by σ.
We choose an element g∈G(resp. g∈GL 3) such that
g−1F(g)=σ.
We then denote by Tσ(resp. T3,σ) the F-stable maximal torus gTg−1(resp. gT3g−1).
Under conjugation by g−1we have
(Tσ,F)≃(T,σF), (T3,σ,F)≃(T3,σF).
In particular, TF
σ≃TσFandTF
3,σ≃TσF
3. It will be more convenient to represent elements of TF
σ
inTσF.
The morphism ρ∨restricts to a W-equivariant morphism T∨→T3inducing (see [8, Section
3.5]) a W-equivariant morphism ρ:T3→Tgiven as follows
ρ(a,b,c)=(a2b,bc2) if G=GL 2
ρ(a,b,c)=(a/c,c/a) if G=SL2
ρ(a,b,c)=[a2b,bc2] if G=PGL 29
where [ a2b,bc2] denotes the class of ( a2b,bc2) in PGL 2.
We thus get morphisms ρF:TF
3→TFandρσF:TσF
3→TσF, and the Braverman-Kazhdan
kernels (BK-Fourier kernels) φTandφTσonTFandTF
σrespectively are given by (see §2.1)
φT=cT3c−1
TρF
!(ψ◦Tr), φTσ=cT3,σc−1
TσρσF
!(ψ◦Tr). (2.3)
(we omitρfrom the notation of the BK-Fourier kernels as the context wi ll be always clear). The
BK-Fourier kernel on GFis then given by the formula [8, Theorem 5.2.3]
φG=1
2/parenleftig
RG
T(φT)+RG
Tσ(φTσ)/parenrightig
, (2.4)
where RG
TandRG
Tσdenote Deligne-Lusztig induction.
The right hand side of (2.4) can be computed explicitly. For G=GL 2we get :
g=/parenleftigga0
0a/parenrightigg
g=/parenleftigga0
0b/parenrightigg
g=/parenleftiggx 0
0xq/parenrightigg
g=/parenleftigga1
0a/parenrightigg
a∈F×
q a/nequalb∈F×
q x/nequalxq∈F×
q2a∈F×
q
φG 1
2/parenleftig
(q+1)φT(g)+(1−q)φTσ(g)/parenrightig
φT(g) φTσ(g)1
2/parenleftig
φT(gs)+φTσ(gs)/parenrightig(2.5)
where gsdenotes the semisimple part of g.
Remark 2.2.2 .Notice that the map f∨: SL 2→PGL 2in (2.2) is a normal morphism (i.e. its
image is a normal subgroup) with dual morphism f=f∨: SL 2→PGL 2(see [8, §3.5]). From
the transitivity of the transfert map between Lusztig serie s (see [8, §3.6]), we get from [8, Lemma
4.1.1] that
φPGL 2=fF
!(φSL2)
−q−1πF
!(φGL2).(2.6)
Notice that cPGL 2c−1
GL2=−1 and cPGL 2c−1
SL2=1 (see deﬁnition of the gamma function (1.1)).
2.3 Explicit computation : The case G=SL2
Recall that in this case
ρF:TF
3→TF,(a,b,c)/maps⊔o→(a/c,c/a),
ρσF:TσF
3→TσF,(a′,b,a′q)/maps⊔o→(a′1−q,a′q−1).
Notice that cT3c−1
T=cT3,σc−1
Tσ=1 and
Ker(ρF)={(s,t,s)|s,t∈F×
q}=Ker(ρσF).10
Therefore
φT(a/c,c/a)=ρF
!(ψ◦Tr)(a/c,c/a)
=/summationdisplay
s,tψ(s(a+c)+bt)
=−/summationdisplay
sψ(s(a+c))
φTσ(a′1−q,a′q−1)=ρσF
!(ψ◦Tr)(a′1−q,a′q−1)
=/summationdisplay
s,tψ(s(a′+a′q)+bt)
=−/summationdisplay
sψ(s(a′+a′q))
where a′∈F×
q2.
We now use the identiﬁcation
SL2≃{(x,α)∈GL 2×GL 1|det(x)=α2}/GL 1
where GL 1acts by s·(x,α)=(sx,sα), and we write the elements of SL 2in the form [ x,α] with
det(x)=α2.
Notice that
SLF
2={(x,α)∈GLF
2×GLF
1|det(x)=α2}/GLF
1.
The morphism ρFandρσFbecomes
ρF(a,b,c)=[(a2,c2),ac], ρσF(a′,b,a′q)=[(a′2,a′2q),a′q+1].
The crucial ingredient is the following obvious identity
/summationdisplay
s∈F×qψ(sτ)=/summationdisplay
s∈F×qψ(sτ2)=q−1 ifτ=0,
−1 otherwise.
Indeed we get
φT([(a2,c2),ac])=−/summationdisplay
s∈F×qψ(s(a+c))=−/summationdisplay
s∈F×qψ(s(a+c)2)=−/summationdisplay
s∈F×qψ(s(a2+c2+2ac)).
We thus have for [ x,α]∈TF
φT([x,α])=−/summationdisplay
s∈F×qψ(s(Tr(x)+2α)),11
and similarly for [ x′,α]∈TF
σ, we have
φTσ([x′,α])=−/summationdisplay
s∈F×qψ/parenleftbigs(Tr(x′)+2α)/parenrightbig.
We thus deduce from Formula (2.4) the following one.
Proposition 2.3.1. For[x,α]∈SLF
2we have
φG([x,α])=−/summationdisplay
s∈F×qψ(s(Tr(x)+2α))=−(q−1) ifTr(x)+2α=0,
1 otherwise.
Remark 2.3.2 .It will be useful to get rid of the sign by writing SL 2in the form
SL2≃[{(x,α,b)∈GL 2×GL 1×GL 1|det(x)=α}/GL 1×GL 1]
where GL 1×GL 1acts as ( s,t)·(x,α,b)=(sx,sα,tb). Indeed, under this identiﬁcation
φG([x,α,b])=/summationdisplay
s,t∈F×qψ(s(Tr(x)+2α)+bt).
2.4 Explicit computation : The case G=PGL 2
Recall that
ρ:T3→T, (a,b,c)/maps⊔o→[a2b,bc2]=[a/c,c/a].
and so
Ker(ρF)={(s,t,εs)|s,t∈F×
q,ε∈µ2},Ker(ρσF)={(u,t,uq)|t∈F×
q,u∈F×
q2,uq=±u}.
We thus have
φT([a/c,c/a])=/summationdisplay
s,t∈F×q,ε∈µ2ψ(s(a+εc)+t)
=−/summationdisplay
s,εψ(s(a+ǫc)2)
=−/summationdisplay
s,εψ(s(a2+c2+2εac))
φTσ([a′1−q,a′q−1])=−/summationdisplay
s∈F×q,ε∈µ2ψ(s(a′2+a′2q+2εa′q+1)).12
Let us identify
PGL 2=SL2/µ2=/braceleftig
(x,α)∈GL 2×GL 1|det(x)=α2/bracerightig
/GL 1×µ2
whereµ2acts by multiplication on the second coordinate. Notice tha t
PGLF
2=/braceleftig
(x,α)∈GLF
2×(GLF
1⊔GLF′
1)|det(x)=α2/bracerightig
/GLF
1×µ2
where F′: GL 1→GL 1,x/maps⊔o→− xqis the standard Frobenius twisted by the non-trivial elemen t of
H1(F,µ2)=µ2.
Using Formula (2.4) we deduce the following one.
Proposition 2.4.1. For[x,α]∈PGLF
2we have
φG([x,α])=−/summationtext
s∈F×q,ε∈µ2ψ(s(Tr(x)+2εα)) ifα∈GLF
1,
0 ifα∈GLF′
1.
Notice that the result could have been also deduced from Form ula (2.6) and Proposition 2.3.1.
Remark 2.4.2 .From Proposition 2.3.1 and Proposition 2.4.1, we see that th e kernelφGdescends
to the GIT quotient T//Wwhen Gis SL 2or PGL 2. We will see in the next section that this is not
true when G=GL 2.
2.5 Explicit computation : The case G=GL 2
We have
ρ:T3→T, (a,b,c)/maps⊔o→(a2b,bc2).
and so
Ker(ρF)={(s,s−2,εs)|s∈F×
q,ε∈µ2},Ker(ρσF)={(s,s−2,sq)|sq=±s,s/nequal0}.
Forb∈Fq, put
κ(b) :=/summationdisplay
s∈F×qψ(s−2b) and κ′(b) :=/summationdisplay
{s/nequal0,sq=−s}ψ(s−2b).
Notice that if r∈F×
qis a non-square, then
κ(rb)=κ′(b).13
Since cT3,T=cT3,σ,Tσ=−1, we have (for a,b,c∈F×
q)
φT(a2b,bc2)=−/summationdisplay
s∈F×q,ε∈µ2ψ(s(a+εc)+s−2b)
=−/summationtext
s,εψ(s+s−2(a+εc)2b) if a2/nequalc2,
−/parenleftig
κ(b)+/summationtext
sψ(s+s−2(a+εc)2b)/parenrightig
ifa=εc,
using the variable change s(a+εc)↔swhen a+εc/nequal0.
We get the formula for φTσas follows (where so∈F×
q2satisﬁes sq
o=−so)
φTσ(a′2b,ba′2q)=−/summationdisplay
sq=sψ(s(a′+a′q)+s−2b)−/summationdisplay
sq=−sψ(s(a′−a′q)+s−2b)
=−/summationdisplay
sq=sψ(s(a′+a′q)+s−2b)−/summationdisplay
sq=sψ(sso(a′−a′q)+s−2
os−2b)
=−/summationtext
s∈F×q,ε∈µ2ψ/parenleftig
s+s−2(a′+ǫa′q)2b/parenrightig
ifa′q/nequal±a′,
−/summationtext
s∈F×qψ/parenleftig
s+s−2(a′+a′q)2b/parenrightig
−κ′(b) if a′q=a′,
−/summationtext
s∈F×qψ/parenleftig
s+s−2(a′−a′q)2b/parenrightig
−κ(b) if a′q=−a′.
using the variable changes sso(a′−a′q)↔sifa′q/nequala′ands(a′+a′q)↔sifa′q/nequal−a′.
Remark 2.5.1 .The case a′q=−a′is not essential as we can write ( a′2b,ba′2q) in the form
(a2d,da2) with a,d∈F×
qby putting ( a,d) :=(soa′,s−2
ob).
We now consider the identiﬁcation
GL 2≃{(x,α,b)∈GL 2×GL 1×GL 1|det(x)=α2}/GL 1×µ2 (2.7)
where GL 1acts as t·[x,α,b]=[tx,tα,t−1b] andµ2acts by multiplication on the second coordinate
(under this identiﬁcation, the element [ x,α,b] corresponds to xb∈GL 2).
We have
GLF
2=/braceleftig
(x,α,b)∈GLF
2×(GLF
1⊔GLF′
1)×GLF
1|det(x)=α2/bracerightig
/GLF
1×µ2.
In the following table we write the elements of GLF
2in the form [ x,α,b] and we put
Φ([x,α,b]) :=/summationdisplay
s∈F×q,ε∈µ2ψ/parenleftig
s+s−2b(Tr(x)+2εα)/parenrightig
.14
/bracketleftigg/parenleftigga20
0 a2/parenrightigg
,a2,b/bracketrightigg/bracketleftigg/parenleftigga20
0 c2/parenrightigg
,ac,b/bracketrightigg/bracketleftigg/parenleftigga′20
0 a′2q/parenrightigg
,a′q+1,b/bracketrightigg
a,b∈F×
q a,c∈F×
q,a2/nequalc2a′2/nequala′2q
φT−κ(b)−1−Φ([x,α,b])−Φ([x,α,b]) ×
φTσ−κ′(b)−1−Φ([x,α,b])× −Φ([x,α,b])(2.8)
Notice that for b/nequal0
κ(b)+κ′(b)=−2,1
2(κ(b)−κ′(b))=/summationdisplay
t∈F×qαo(t)ψ(tb)=:S(αo,ψb)
where recall that αois the non-trivial square root of the identity character of F×
q(it takes the value
1 at squares and−1 at non-squares).
Using Table (2.5) and the above table we get the following pro position.
Proposition 2.5.2. For[x,α,b]∈GLF
2we haveφG([x,α,b])=0ifα∈GLF′
1and otherwise we
have
/bracketleftigg/parenleftigga20
0 a2/parenrightigg
,a2,b/bracketrightigg/bracketleftigg/parenleftigga20
0 c2/parenrightigg
,ac,b/bracketrightigg/bracketleftigg/parenleftigga′20
0 a′2q/parenrightigg
,a′q+1,b/bracketrightigg/bracketleftigg/parenleftigga21
0 a2/parenrightigg
,a2,b/bracketrightigg
a,b∈F×
q a,c∈F×
q,a2/nequalc2a′2/nequala′2qa,b∈F×
q
φG−qS(αo,ψb)−Φ([x,α,b])−Φ([x,α,b])−Φ([x,α,b])−Φ([x,α,b])(2.9)
This can be re-written for g ∈GLF
2as
φG(g)=0 ifdet(g)/nelement(F×
q)2,
−/summationtext
s,εψ/parenleftig
s+s−2/parenleftig
Tr(g)+2ε/radicalbig
det(g)/parenrightig/parenrightig
ifdet(g)∈(F×
q)2and g not central ,
−/summationtext
s,εψ/parenleftig
s+s−2/parenleftig
Tr(g)+2ε/radicalbig
det(g)/parenrightig/parenrightig
−qS(αo,ψλ)if g=λ·I2.
Notice that in the last case, φG(g)=1−/summationtext
sψ(s+4s−2λ)−qS(αo,ψλ).
We see that φGdoes not descend to T//Was the values of φGdepends on the unipotent part.
3 Extending the BK-Fourier kernel: The case G=SL2,PGL 2
3.1 Preliminaries
By a ﬁnite groupo¨ ıd, we shall mean a groupo¨ ıd with a ﬁnite nu mber of isomorphism classes
and whose automorphism groups are ﬁnite. For a ﬁnite groupo¨ ıdXwe denote by Xthe set of15
isomorphism classes of X. By aQℓ-valued function X→QℓonXwe shall mean aQℓ-valued
function on Xand we denote byC(X) theQℓ-vector space of functions on X. Given a morphism
ϕ:X→Yof ﬁnite groupo¨ ıds, we have the operator ϕ∗:C(Y)→C (X) deﬁned by composition
withϕand the operator ϕ!:C(X)→C (Y) deﬁned by
ϕ!(f)(y)=/summationdisplay
x∈Xy1
|Aut( x)|y∗
X(f)(x)
where•is a point, Xy=•× YX,
Xy
/d15/d15yX/d47/d47X
ϕ
/d15/d15
•y/d47/d47Y
IfGis a ﬁnite group acting on a ﬁnite set X, we denote by [ X/G] the groupo¨ ıd of G-equivariant
maps G→Xand byπ:X→[X/G] the quotient map. Then for f∈C(X) we have
π!(f)(π(x))=/summationdisplay
g∈Gf(g·x)
for any x∈X.
Given a function K∈C(X×X) we can deﬁne an operator
F:C(X)→C (X)
with kernel Kby
F(f)(y)=/summationdisplay
x∈X1
|Aut( x)|K(y,x)f(x)
forf∈C(X) and y∈X.
We have the following straightforward lemma.
Lemma 3.1.1. The operatorFis involutive, i.e.F◦F=1, if and only if for all y ,z∈X we
have
∆(z,x) :=/summationdisplay
y∈X1
|Aut(y)|K(z,y)K(y,x)=|Aut(z)|if z=x,
0 otherwise.(3.1)
LetZbe a ﬁnite set endowed with a right action of a ﬁnite group H.16
Lemma 3.1.2. Let KZ∈C(Z×Z)by H-invariant for the diagonal action of H on Z ×Z and
deﬁne K[Z/H]∈C([Z/H]×[Z/H])by
K[Z/H](x,y)=/summationdisplay
h∈HKZ(h·x,y)=/summationdisplay
h∈HKZ(x,h·y)
where x,y∈Z maps to x∈[Z/H]andy∈[Z/H]respectively. If KZsatisﬁes (3.1) then so does
K[Z/H].
Proof. Suppose that KZsatisﬁes (3.1).
/summationdisplay
y∈[Z/H]1
|CH(y)|K[Z/H](x,y)K[Z/H](y,z)=/summationdisplay
y∈[Z/H]1
|CH(y)|/summationdisplay
h∈HKZ(h·x,y)/summationdisplay
h′∈HKZ(y,h′·z)
=1
|H|/summationdisplay
y∈Z/summationdisplay
h∈HKZ(h·x,y)/summationdisplay
h′∈HKZ(y,h′·z)
=1
|H|/summationdisplay
h,h′∈H/summationdisplay
y∈ZKZ(h·x,y)KZ(y,h′·z)
=1
|H|/summationdisplay
h,h′∈Hδhx,h′x
=|CH(x)|δx,z.
/square
LetXbe anFq-scheme on which an Fq-algebraic group Gacts on the right. We denote by
[X/G] the associated quotient stack. We assume that X,Gand the action of GonXare deﬁned
overFqand we denote by Fthe associated geometric Frobenius on X,Gand [ X/G].
Recall that the isomorphism classes of G-torsors over Spec( Fq) are parametrized by the set
H1(F,G)=H1(F,G/Go) ofF-conjugacy classes on Gand so the groupoid [ X/G]FofFq-points
of [X/G] decomposes as
[X/G]F=/coproductdisplay
h∈H1(F,G)[XF◦h/GF◦h]
where h∈Gdenotes a representative of handGF◦h={g∈G|F(h−1gh)=g}.
IfGis connected then H1(F,G) is trivial and so [ X/G]F=[XF/GF].
Let
π: [X/Go]→[X/G]17
be the natural G/Go-torsor.
Notice that the induced map
πF: [X/Go]F→[X/G]F
is not surjective. But, for any h∈G, it induces a surjective map
[X/Go]F◦h=[XF◦h/Go(F◦h)]→[XF◦h/GF◦h]
with ﬁbers isomorphic to ( G/Go)F◦h=GF◦h/Go(F◦h).
LetS: [X/Go]×[X/Go]→Fqbe a G/Go-invariant algebraic map for the diagonal action of
G/Go. Then
S(F(y),F(x))=S(F◦h(y),F◦h(x))=S(y,x)q
for all x,y∈[X/Go] and h∈G, and so Sinduces maps
SF◦h: [X/Go]F◦h×[X/Go]F◦h→Fq.
For all h∈H1(F,G), we get a kernel
K[X/Go]
h: [X/Go]F◦h×[X/Go]F◦h→Qℓ, (x,y)/maps⊔o→ψ(S(x,y)).
and so a kernel
K[X/G]
h: [XF◦h/GF◦h]×[XF◦h/GF◦h]→Qℓ,
deﬁned by
K[X/G]
h(x,y)=/summationdisplay
w∈(G/Go)F◦hψ(S(w·x,y)),
forx,y∈[X/Go]F◦hwith images denoted respectively by x,yin the quotient [ XF◦h/GF◦h].
We deﬁne a kernel
K[X/G]: [X/G]F×[X/G]F→Qℓ
by
K[X/G](x,y)=K[X/G]
h(x,y) if x,yare both in [ XF◦h/GF◦h] for some h∈H1(F,G),
0 otherwise .
Proposition 3.1.3. The Fourier transform F[X/G]:C([X/G]F)→C ([X/G]F)deﬁned from the
kernel K[X/G]is involutive if and only if all the kernels K[X/Go]
h, with h∈H1(F,G), satisfy (3.1).18
Remark 3.1.4 .The above construction of the kernel K[X/G]has the following geometrical coun-
terpart. The geometric analogue of ψis the Artin-Schreier sheaf LψonA1and so K[X/Go]corre-
sponds to
K[X/Go]:=S∗(Lψ).
The sheafK[X/Go]isG/Go-equivariant for the diagonal action of G/Go(see for instance [7, §2.3]
for the deﬁnition of equivariance).
We consider
[X/Go]×[X/Go]π×1/d47/d47[X/G]×[X/Go]1×π/d47/d47[X/G]×[X/G]
Then the complex ( π×1)!K[X/Go]is naturally G/Go-equivariant and so by [8, Lemma 2.3.4] it
descends to a complex K[X/G]on [X/G]×[X/G], i.e.K[X/G]is the unique complex (up to a unique
isomorphism) such that
(1×π)∗K[X/G]=(π×1)!K[X/Go].
ThenK[X/G]is the geometrical counterpart of K[X/G], i.e. if we introduce Frobenius action, then
K[X/G]is the characteristic function of K[X/G]equipped with its natural Frobenius (see [8, §6.1]).
Then the geometrical counterpart of Proposition 3.1.3 says that the geometric Fourier trans-
formF[X/Go]deﬁned fromK[X/Go]is involutive if and only if the geometric Fourier transform
F[X/G]deﬁned fromK[X/G]is.
3.2 The tori case
LetSbe a torus deﬁned over Fqand assume given a surjective morphism
ρ:Tn→S
deﬁned overFq(the morphism ρmay not be surjective on Fq-points).
Consider the BK-Fourier kernel
φS
ρ=ρF
!(ψ◦Tr|Tn)
and consider the Fourier operator FS
ρ:C(SF)→C (SF) deﬁned from φS
ρ.
We wish to extend this operator to an involutive Fourier tran sform.
Put19
H:=Ker(ρ), tn:=Lie(Tn).
Consider the natural open embedding
ι:S≃Tn/Ker(ρ)֒→[tn/H].
On [t n/H]Fdeﬁne the kernel
φ[tn/H]:=qF
!(ψ◦Tr)
where q: tn→[tn/H].
Concretely
φ[tn/K](y)=/summationtext
t∈HFψ(Tr(tx)) if y=qF(x),
0 if x/nelementIm(qF).
Notice that qFis not surjective if His not connected.
The products t n×tn→tnandH×H→Hinduce a map
m: [tn/H]×[tn/H]→[tn/H]
which is compatible with Fq-structures. We thus get a morphism of groupo¨ ıds
mF: [tn/H]F×[tn/H]F→[tn/H]F.
We then deﬁne a two-variable kernel K[tn/H]: [tn/H]F×[tn/H]F→Qℓby
K[tn/H]=(mF)∗(φ[tn/H]).
Proposition 3.2.1. (1) The Fourier transform F[tn/H]:C([tn/H]F)→C ([tn/H]F)deﬁned from
the kernel K[tn/H]is involutive, i.e.
F[tn/H]◦F[tn/H](f)=qnf−
for any f∈C([tn/H]F)where f−∈C([tn/H]F)is deﬁned as f−([x]) :=f([−x]).
(2) It extends the Fourier operator FS
ρ:C(SF)→C (SF), i.e.
FS
ρ=ι∗◦F[tn/H]◦ι!.
Proof. The assertion (1) follows from the discussion in §3.1 as the F ourier transform on C(tF
n)
deﬁned from the kernel ψ◦Tr is involutive. The second assertion is straightforward. /square20
3.3 Main result
In this section the characteristic of the base ﬁeld Fqis assumed to be odd, Gis SL 2or PGL 2and
ρ∨:G→GL 3is as in §2.2. We consider the stack Gdeﬁned as follows :
G:=[{(x,α,b)∈gl2×gl1×gl1|det(x)=α2}/GL 1×GL 1] if G=SL2,
G:=[{(x,α,b)∈gl2×gl1×gl1|det(x)=α2}/GL 1×µ2×GL 1] if G=PGL 2,
whereµ2acts on the second coordinate and GL 1×GL 1as (s,t)·(x,α)=(sx,sα,tb).
The natural inclusion G֒→G,g/maps⊔o→[g,1,1] is open and G×G-equivariant for the left and
right multiplication of GonG.
We have
GF=[{(x,α,b)∈glF
2×glF
1×glF
1|det(x)=α2}/GLF
1×GLF
1] if G=SL2,
GF=[{(x,α,b)∈glF
2×(glF
1⊔glF′
1)×gl1|det(x)=α2}/GL 1×GL 1×µ2] if G=PGL 2,
where F′: gl1→gl1,x/maps⊔o→− xq.
We extend the kernel φGto a kernelφGonGFas follows (see Remark 2.3.2).
IfG=SL2, deﬁneφGby
φG([x,α,b])=/summationdisplay
s,t∈F×qψ(s(Tr(x)+2α)+tb).
IfG=PGL 2, deﬁneφGby
φG([x,α,b])=/summationtext
s,t∈F×q,ε∈µ2ψ(s(Tr(x)+2εα)+tb) ifα∈glF
1,
0 if α∈glF′
1.
Consider
FG:C(GF)→C (GF)
deﬁned by
FG(f)([x′,α′,b′])=/summationdisplay
[x,α,b]∈GF1
|Aut([ x,α,b])|φG([x′x,α′α,b′b])f([x,α,b])
for any function f∈C(GF). Here is the main result of our paper.21
Theorem 3.3.1. The Fourier transform FGisinvolutive , namely
FG◦FG(f)=q5f
for any f∈C(GF).
3.4 Fourier transforms on quadratic spaces
Assume given a vector space Vof dimension n=2m+1 overFqand a non-degenerate quadratic
form Q:V→Fqwith associated bilinear form
B(v′,v)=Q(v′+v)−Q(v′)−Q(v)
for all v′,v∈V.
From the classiﬁcation of quadratic forms over ﬁnite ﬁelds, we can ﬁnd a basis of Vin which
Qhas the form
Q(x1,..., x2m+1)=x1x2m+1+···+xmxm+2+cx2
m+1
where c∈F×
qis well-determined by Q(up to a multiplication by a square).
Consider the groupo¨ ıd
X=/bracketleftig
{v∈V|Q(v)=0}/F×
q/bracketrightig
.
Deﬁne the kernel
K:X×X→Qℓ, ([v′],[v])/maps⊔o→/summationdisplay
s∈F×qψ(B(sv′,v))=/summationdisplay
s∈F×qψ(B(v′,sv))
and the corresponding operator FX:C(X)→C (X) by
FX(f)([v′])=/summationdisplay
[v]∈X1
|Aut([ v])|K([v′],[v])f([v])
for all f∈C(X).
The aim of this section is to prove the following result.
Theorem 3.4.1. The Fourier operator FXis involutive, i.e.
FX◦FX(f)=q2mf.
Remark 3.4.2 .The theorem is not true anymore if the dimension of Vis even.22
To prove Theorem 3.4.1, we ﬁrst evaluate the sum
f(v′)=/summationdisplay
v∈V,Q(v)=0ψ(B(v′,v))
or equivalently the sum
f(v′)=1
q/summationdisplay
v∈V,λ∈Fqψ/parenleftbigλQ(v)+B(v′,v)/parenrightbig.
We have
f(v′)=1
q/summationdisplay
v∈Vψ(B(v′,v))+1
q/summationdisplay
v∈V,λ∈F×qψ/parenleftbigλ(Q(v)+B(v′/λ,v))/parenrightbig
=q2mδ0(v′)+1
q/summationdisplay
v∈V,λ∈F×qψ/parenleftigg
λ/parenleftigg
Q/parenleftiggv′
λ+v/parenrightigg
−Q/parenleftiggv′
λ/parenrightigg/parenrightigg/parenrightigg
=qn−1δ0(v′)+1
q/summationdisplay
λ1∈F×qψ(−λ1Q(v′))/summationdisplay
v1∈Vψ(λ−1
1Q(v1))
by the variables change v1=v′
λ+vandλ1=1/λ.
A straightforward calculation shows that
/summationdisplay
v∈Vψ(λQ(v))=qmαo(cλ)S(αo,ψ).
Therefore, setting αo(0)=0 and noticing that
/summationdisplay
x∈Fqψ(yx)αo(x)=αo(y)S(αo,ψ)
we get
f(v′)=q2mδ0(v′)+qm−1S(αo,ψ)αo(c)/summationdisplay
λ1∈Fqψ(−λ1Q(v′))αo(λ1)
=q2mδo(v′)+qm−1S(αo,ψ)2αo(c)αo(−Q(v′))
and using that S(αo,ψ)2=αo(−1)qwe end up with
f(v′)=q2mδo(v′)+qmαo(c)αo(Q(v′)). (3.2)
We now prove Theorem 3.4.1.23
Proof of Theorem 3.4.1. By Lemma 3.1.1 we need to prove that for [ v],[v′′]∈Xwe have
∆([v′′],[v])=/summationdisplay
[v′]∈X1
|Aut([ v′])|K([v′′],[v′])K([v′],[v])=q2m|Aut([ v])|if [v′′]=[v],
0 otherwise.
We have
∆([v′′],[v])=/summationdisplay
s,s′′∈F×q/summationdisplay
[v′]∈X1
|Aut([ v′])|ψ(B(s′′v′′,v′))ψ(B(v′,sv))
=/summationdisplay
s,s′′/summationdisplay
[v′]1
|Aut([ v′])|ψ(B(sv+s′′v′′,v′))
Notice that
/summationdisplay
s∈F×q/summationdisplay
v′,Q(v′)=0ψ(B(sX,v′))=/summationdisplay
s1+/summationdisplay
[v′]/nequal0/summationdisplay
σ∈F×qψ(B(sX,σv′))
=(q−1)+/summationdisplay
[v′]/nequal0/summationdisplay
σ/summationdisplay
sψ(B(sX,σv′))
=(q−1)+/summationdisplay
[v′]/nequal0/summationdisplay
σ/summationdisplay
sψ(B(sX,v′)
=/summationdisplay
s1+(q−1)/summationdisplay
[v′]/nequal0ψ(B(sX,v′)
=(q−1)/summationdisplay
s/summationdisplay
[v′]∈X1
|Aut([ v′])|ψ(B(sX,v′))
Therefore
∆([v′′],[v])=/summationdisplay
s,s′′/summationdisplay
[v′]∈X1
|Aut([ v′])|ψ(B(sv+s′′v′′,v′))
=1
q−1/summationdisplay
s,s′′/summationdisplay
v′,Q(v′)=0ψ(B(sv+s′′v′′,v′))
From Formula (3.2) we get
∆([v′′],[v])=1
q−1q2m/summationdisplay
s,s′′δo(sv+s′′v′′)+qmαo(c)/summationdisplay
s,s′′αo(Q(sv+s′′v′′))
The ﬁrst sum equals ( q−1)|Aut([ v])|if [v]=[v′′] and 0 otherwise. Since24
Q(sv+s′′v′′)=B(sv,s′′v′′)+Q(sv)+Q(s′′v′′)=ss′′B(v,v′′)
we get that/summationdisplay
s,s′′αo(Q(sv+s′′v′′))=/summationdisplay
s,s′′αo(ss′′B(v,v′′))=0
becauseαois a non-trivial character on F×
qandαo(0)=0.
We deduce that
∆([v′′],[v])=q2m|Aut([ v])|if [v]=[v′′],
0 otherwise .
/square
3.5 Proof of Theorem 3.3.1
3.5.1. Assume ﬁrst that G=SL2.
In this case we have
G=/bracketleftig
{(x,α)∈gl2×gl1|det(x)=α2}/GL 1/bracketrightig
×[gl1/GL 1].
Put
G1:=/bracketleftig
{(x,α)∈gl2×gl1|det(x)=α2}/GL 1/bracketrightig
,G2:=[gl1/GL 1].
Then
φG=φG1⊠φG2
where
φG1([x,α]) :=/summationdisplay
s∈F×qψ(s(Tr(x)+2α)), φG2([z])=/summationdisplay
s∈F×qψ(sz).
Since the Fourier transform FG2with respect to the kernel φG2is clearly involutive, it remains to
see that the Fourier transform FG1with kernel φG1is involutive.
Consider
Q: (gl2×gl1)F→F×
q, (x,α)/maps⊔o→det(x)−α2.
The associated bilinear form is given by
B((y,β),(x,α))=Tr(ι(y)x)−2βα
whereι: gl2→gl2is the involution25
/parenleftigga b
c d/parenrightigg
/maps⊔o→/parenleftiggd−b
−c a/parenrightigg
sending a matrix to the transpose of its co-factor matrix.
By Theorem 3.4.1, the Fourier transform ˆFG1:C(GF
1)→C (GF
1) deﬁned by
ˆFG1(f)([y,β])=/summationdisplay
[x,α]1
|Aut([ x,α])|φG1([ι(y)x,αβ])f([x,α])
is involutive from which we deduce the involutivity of FG1as Tr(ι(y)ι(x))=Tr(yx) for all x,y∈
gl2.
3.5.2. Let us now assume that G=PGL 2in which case we have
G=/bracketleftig/braceleftig
(x,α,b)∈gl2×gl1×gl1|det(x)=α2/bracerightig
/GL 1×GL 1×µ2/bracketrightig
.
If we put X={(x,α,b)∈gl2×gl1×gl1|det(x)=α2}, then we get a µ2-torsor
˜f: [X/GL 1×GL 1]−→[X/GL 1×GL 1×µ2]=G.
which extends the natural quotient f: SL 2→PGL 2(notice that [ X/GL 1×GL 1] is the stackGfor
G=SL2). If we denote by φ(instead ofφGto avoid any confusion) the kernel on [ X/GL 1×GL 1]F
studied in the previous section §3.5.1 we get that
φG=˜fF
!(φ)
extending the formula (2.6). Therefore, by §3.5.1 and the re sult of §3.1 we get Theorem 3.3.1
forG=PGL 2.
3.6 Remarks on the torus case
Recall, see Formula (2.3), that the BK-Fourier kernel on TFis given by
φT=ρF
!(ψ◦Tr)
whereρ:T3→Tis given by
ρ(a,b,c)=(a/c,c/a) if G=SL2,
ρ(a,b,c)=[a2b,bc2] if G=PGL 2.26
The following morphism induces a bijection between isomorp hism classes of objects
˜ρ: [t3/Ker(ρ)]→T, [a,b,c]/maps⊔o→[(a2,c2),ac,b]
where
T=/bracketleftig/braceleftig
(x,α,b)∈t2×gl1×gl1|det(x)=α2/bracerightig
/GL 1×GL 1/bracketrightig
ifG=SL2,
T=/bracketleftig/braceleftig
(x,α,b)∈t2×gl1×gl1|det(x)=α2/bracerightig
/GL 1×µ2×GL 1/bracketrightig
ifG=PGL 2.
Moreover, the size of the stabilizers are the same on both sid es of ˜ρ. Therefore, since the kernel
φ[t3/Ker(ρ)]from §3.2 deﬁnes an involutive Fourier transforms F[t3/Ker(ρ)], the kernel
φT:=˜ρF
!(φ[t3/Ker(ρ)])
deﬁnes also an involutive Fourier transforms FTonC(TF).
Notice that even if ˜ ρis not an isomorphism of stacks (as [t 3/Ker(ρ)] is smooth andTis
singular), both embeddings
T≃T3/Ker(ρ)֒→[t3/Ker(ρ)], T֒→T
provide a good space of functions with an involutive Fourier transform on it that extends the BK-
Fourier operatorFT=FT
ρ:C(TF)→C (TF). However, the ﬁrst one does not have an analogue
for the group Gwhile the second one does.
Following [9], we can extend the deﬁnition of Deligne-Luszt ig induction RG
TandRG
Tσto op-
erators
RG
T:C(TF)→C (GF), RG
Tσ:C(TF
σ)→C (GF).
Then we can verify that
φG=1
2/parenleftig
RG
T(φT)+RG
Tσ(φTσ)/parenrightig
(3.3)
whereφTσis obtained by pushing ψ◦Tr along the map tσF
3→TσF.
4 Partial extension of the BK-Fourier kernel in the case G=
GL 2
In this section qis assumed to be odd as before. We construct a stack Gρand an extension of
BK-kernel in the G=GL 2case by analogy with the construction in the SL 2and PGL 2cases.27
But unfortunately, the resulting Fourier operator is not in volutive and so our construction is only
a partiel solution to the problem.
4.1 The stackG
Assume that G=GL 2withρ∨=Sym2. By analogy with the SL 2and PGL 2cases, the results of
§2.5 suggest to consider the stack
G:=/bracketleftig/braceleftig
(x,α,b)∈gl2×gl1×gl1|det(x)=α2/bracerightig/slashig
GL 1×µ2/bracketrightig
where GL 1acts as t·[x,α,b]=[tx,tα,t−1b] andµ2acts on the second coordinate as α/maps⊔o→−α.
Notice that the open substack of [ x,α,b] withα,b/nequal0 is isomorphic to GL 2via the projection
(x,α,b)/maps⊔o→bx.
We thus have a G×G-equivariant embedding
G֒→G
for the right and left multiplication.
Consider the toric analogue of G
T:=/bracketleftig/braceleftig
(x,α,b)∈t2×gl1×gl1|det(x)=α2/bracerightig/slashig
GL 1×µ2/bracketrightig
Thenρ:T3→T,(a,b,c)/maps⊔o→(a2b,bc2) extends to a morphism of stacks
˜ρ: [t3/Ker(ρ)]→T, [a,b,c]/maps⊔o→[(a2,c2),ac,b]. (4.1)
Notice that ˜ ρis an isomorphism on the open subset {(a,c)/nequal(0,0)}but not globally (as for
instanceTis singular).
Above{[0,b,0]}with b/nequal0, the morphism becomes
/parenleftig
[{b/nequal0}/GL 1]→[{b/nequal0}/GL 1]=Spec(Fq)/parenrightig
×B(µ2)
where s∈GL 1acts by s2on the source and by son the target.
Therefore the morphism of stacks (4.1) is not a bijection bet ween isomorphism classes of
objects (unlike the cases of SL 2and PGL 2).28
4.2 The BK-Fourier kernels φT,φTσ
Recall that
Ker(ρ)={(s,s−2,εs)|ε∈µ2,s∈GL 1}.
Letq: t3→[t3/Ker(ρ)] be the quotient map.
Consider on [t 3/Ker(ρ)]Fand on [t 3/Ker(ρ)]σFthe kernels
φF=qF
!(ψ◦Tr), φσF=qσF
!(ψ◦Tr)
i.e.
φF([a,b,c])=/summationdisplay
s∈F×q,ε∈µ2ψ/parenleftig
s(a+εc)+s−2b/parenrightig
, φσF([a′,b,a′q])=/summationdisplay
sq=±sψ/parenleftig
s(a′+εa′q)+bs−2/parenrightig
considered in §3.2.
Analogously to the cases G=SL2,PGL 2(see §3.6), we consider the kernels
φT:=−(˜ρF)!(φF),andφTσ:=−(˜ρσF)!(φσF).
They are given by the formulas
φT([(a2,c2),ac,b])=−/summationdisplay
s∈F×q,ε∈µ2ψ/parenleftig
s(a+εc)+s−2b/parenrightig
φTσ([a′2,a′2q,a′q+1,b])=−/summationdisplay
sq=±sψ/parenleftig
s(a′+εa′q)+bs−2/parenrightig
By operating the variable change s(a+εc)↔s′when a+εc/nequal0 we get
φT([(a2,c2),ac,b])=−/summationtext
s,εψ/parenleftig
s+s−2b(a2+c2+2εac)/parenrightig
ifa2/nequalc2
−κ(b)−/summationtext
sψ(s+4s−2ba2) if a=εc/nequal0
−2κ(b) if a=c=0
We thus get the values on the elements [ x,α,b] as follows
/bracketleftigg/parenleftigga20
0 a2/parenrightigg
,a2,b/bracketrightigg /bracketleftigg/parenleftigga20
0 c2/parenrightigg
,ac,b/bracketrightigg/bracketleftigg/parenleftigga′20
0 a′2q/parenrightigg
,a′q+1,b/bracketrightigg
a,b∈Fq a,c∈Fq,a2/nequalc2a′2/nequala′2q
φT−κ(b)−1−Φ([x,α,b]) if a/nequal0
−2κ(b) if a=0−Φ([x,α,b]) ×
φTσ−κ′(b)−1−Φ([x,α,b]) if a/nequal0
−2κ′(b) if a=0× −Φ([x,α,b])(4.2)29
where for [ x,α,b]∈GFwe put
Φ([x,α,b]) :=/summationdisplay
s∈F×q,ε∈µ2ψ/parenleftig
s+s−2b(Tr(x)+2εα)/parenrightig
.
Remark 4.2.1 .(Non-involutivity) The Fourier operator FTdeﬁned from φTis not involutive.
This follows from Lemma 3.1.1 as a direct calculation shows t hat
∆([(1,0),0,1],[(0,1),0,1])=4αo(−1)q/nequal0.
4.3 The BK-Fourier kernel φG
We deﬁne the BK-Fourier kernel φGonGFby the formula (3.3).
We compute the values of the BK-Fourier kernel φGonGF: we haveφG([x,α,b])=0 if
α∈glF′
1and otherwise it is given by the following table
/bracketleftigg/parenleftigga20
0 a2/parenrightigg
,a2,b/bracketrightigg /bracketleftigg/parenleftigga20
0 c2/parenrightigg
,ac,b/bracketrightigg/bracketleftigg/parenleftiggx20
0 x2q/parenrightigg
,xq+1,b/bracketrightigg /bracketleftigg/parenleftigga21
0 a2/parenrightigg
,a2,b/bracketrightigg
a,b∈Fq a,b,c∈Fq,a2/nequalc2x2/nequalx2q,b∈Fq a,b∈Fq
φG−(qS(αo,ψb)δb/nequal0+qδb=0+Φ([x,α,b]))ifa/nequal0
−2(qS(αo,ψb)δb/nequal0+qδb=0−1) if a=0−Φ([x,α,b])−Φ([x,α,b])−(qδb=0+Φ([x,α,b])) if a/nequal0
−2(qδb=0−1) if a=0
(4.3)
We can see by a direct calculation that the operator FGonC(GF) deﬁned from φGis not involu-
tive (see Remark 4.2.1).
5 The characteristic 2case
In this section we assume that Fqis a ﬁnite ﬁeld of characteristic 2 (every element of Fqis then
a square inFq). In this case, our approach gives a complete answer to the pr oblem in the three
cases SL 2, PGL 2and GL 2. We explain it when G=GL 2.
5.1 BK-Fourier operator on G
First of all, notice that since the characteristic is 2 we hav e
Ker(ρF)=Ker(ρσF)={(s,s−2,s)|s∈F×
q}.
Following the calculation in §2.5 we ﬁnd30
φT([(a2,c2),ac,b])=−/summationtext
s∈F×qψ/parenleftig
s+s−2(a2+c2)b/parenrightig
ifa2/nequalc2i.e.a/nequalc,
−κ(b) if a2=c2.
and
φTσ([(a′2,a′2q),a′q+1,b])=−/summationtext
s∈F×qψ/parenleftig
s+s−2(a′2+a′2q)b/parenrightig
ifa′2/nequala′2qi.e.a′q/nequala′,
−κ(b) otherwise .
Since the characteristic is 2, the identiﬁcation (2.7) beco mes
G≃{(x,α,b)∈GL 2×GL 1×GL 1|det(x)=α2}/GL 1
Writing the elements of Gas [x,α,b] we get the values of the BK-Fourier kernel as follows
/bracketleftigg/parenleftigga20
0 a2/parenrightigg
,a2,b/bracketrightigg/bracketleftigg/parenleftigga20
0 c2/parenrightigg
,ac,b/bracketrightigg /bracketleftigg/parenleftiggx20
0 x2q/parenrightigg
,xq+1,b/bracketrightigg/bracketleftigg/parenleftigga21
0 a2/parenrightigg
,a2,b/bracketrightigg
a,b∈Fq a,b,c∈Fq,a2/nequalc2x2/nequalx2q,b∈Fq a,b∈Fq
φG−κ(b)−/summationtext
s∈F×qψ/parenleftig
s+s−2bTr(x)/parenrightig
−/summationtext
s∈F×qψ/parenleftig
s+s−2bTr(x)/parenrightig
−κ(b)(5.1)
5.2 Extending the BK-Fourier operator
Since the characteristic is 2, the morphism
ρ:T3→T,(a,b,c)/maps⊔o→(a2b,bc2)
extends to a group morphism
ρ: GL 2×GL 1→GL 2,(x′,b)/maps⊔o→ι2(x′)b
whereι2: gl2→gl2is the algebra isomorphism deﬁned by
ι2/parenleftigga b
c d/parenrightigg
:=/parenleftigga2b2
c2d2/parenrightigg
.
Remark 5.2.1 .Notice that
φG=−ρ!(ψ◦Tr)
where Tr( x′,b)=Tr(x′)+bfor (x′,b)∈gl2×gl1.31
The kernel of ρis
Ker(ρ)=/braceleftigg/parenleftigg/parenleftiggs0
0s/parenrightigg
,s−2/parenrightigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingles∈GL 1/bracerightigg
.
We consider the G×G-equivariant open embedding
G≃(GL 2×GL 1)/Ker(ρ)֒→G :=/bracketleftbig(gl2×gl1)/Ker(ρ)/bracketrightbig. (5.2)
We then consider on GFthe kernel
φG([x′,b])=−/summationdisplay
s∈F×qψ/parenleftig
sTr(x′)+s−2b/parenrightig
Consider the two-variable kernel KG:GF×GF→Qℓdeﬁned by
KG([x′
1,b1],[x′
2,b2])=φG([x′
1x′
2,b1b2]).
Theorem 5.2.2. (1) The Fourier operator FG:C(GF)→C (GF)deﬁned from KGis involutive,
i.e.
FG◦FG(f)=q5f,
for all f∈C(GF).
(2)FGextends the BK-Fourier operator FG.
Proof. The ﬁrst assertion follows from Lemma 3.1.2 and the fact that the Fourier transform on
gl2×gl1deﬁned from the kernel
(x′,b)/maps⊔o→ψ(Tr(x′)+b)
is involutive. For the second assertion we need to see that th e restriction of φGtoGalong the
embedding (5.2) is the kernel φGwhose values are given by the Table (5.1). To see that we use
(when Tr( x′)/nequal0) the variable change sTr(x′)↔swhich allows us to pass from
/summationdisplay
sψ(sTr(x′)+s−2b) to/summationdisplay
sψ(s+s−2bTr(x))
with x=ι2(x′).
/square32
References
[1] Braverman , A.andKazhdan , D.:γ-functions of representations and lifting (with an ap-
pendix by V . V ologodsky), GAFA 2000, Geom. Funct. Anal. 2000 , Special V olume, Part I,
237–278.
[2] Braverman , A.andKazhdan , D.:γ-sheaves on reductive groups , Studies in memory of Issai
Schur (Chevaleret/Rehovot, 2000), Progr. Math. 210, Birkh¨ auser Boston, Boston, MA (2003),
22–47.
[3] Chen, T.-H.: On a conjecture of Braverman-Kazhdan , J. Amer. Math. Soc. 35(2022), 1171–
1214.
[4] Cheng , S.andNgˆo, B. C.: On a conjecture of Braverman and Kazhdan , Int. Math. Res. Not.
20(2018), 6177–6200.
[5] Godement , R.andJacquet , H.: Zeta functions of simple algebras , Lecture Notes in Math.
260, Springer-Verlag (1972).
[6] Lafforgue , L.: Du transfert automorphe de Langlands aux formules de Poisso n non
lin´ eaires , Ann. Inst. Fourier 66(2016), 899–1012.
[7] Laumon , G.andLetellier , E.: On the derived Lusztig correspondence , Forum Math. Sigma
11(2023).
[8] Laumon , G.andLetellier , E.: Note on a conjecture of Braverman-Kazhdan , Adv. Math. 419
(2023).
[9] Letellier , E.: Fourier transforms of invariant functions on ﬁnite reducti ve Lie algebras ,
Lecture Notes in Mathematics, 1859 . Springer-Verlag, Berlin, 2005. xii +165 pp.
[10] Ngˆo, B. C.: Hankel transform, Langlands functoriality and functional equation of auto-
morphic L-functions , Jpn. J. Math. 15(2020), 121–167.
[11] Tate, J.: Fourier Analysis in Number Fields and Hecke’s Zeta-Functio ns, Ph.D. thesis,
Princeton University, Princeton, NJ, 1950.