arXiv:2302.03265v1  [cs.GT]  7 Feb 2023Evolutionary stability of cooperation in indirect recipro city under
noisy and private assessment
Yuma Fujimotoa,b,c,1and Hisashi Ohtsukia,d
aResearch Center for Integrative Evolutionary Science, SOKENDA I (The Graduate
University for Advanced Studies). Shonan Village, Hayama, Kanaga wa 240-0193, Japan
bUniversal Biology Institute (UBI), the University of Tokyo. 7-3-1 Hongo, Bunkyo-ku,
Tokyo 113-0033, Japan.
cCyberAgent, Inc.. 40-1, Udagawa-cho, Shibuya-ku, Tokyo 150- 0042, Japan.
dDepartment of Evolutionary Studies of Biosystems, SOKENDAI. Sh onan Village,
Hayama, Kanagawa 240-0193, Japan.
1fujimoto yuma@soken.ac.jp
Abstract
Indirect reciprocity is a mechanism that explains large-sc ale cooperation in humans. In indirect reci-
procity, individuals use reputations to choose whether or n ot to cooperate with a partner and update
others’ reputations. A major question is how the rules to cho ose their actions and the rules to update
reputations evolve. In the public reputation case, where al l individuals share the evaluation of others,
social norms called Simple Standing (SS) and Stern Judging ( SJ) have been known to maintain cooper-
ation. However, in the case of private assessment where indi viduals independently evaluate others, the
mechanism of maintenance of cooperation is still largely un known. This study theoretically shows for
the ﬁrst time that cooperation by indirect reciprocity can b e evolutionarily stable under private assess-
ment. Speciﬁcally, we ﬁnd that SS can be stable, but SJ can nev er be. This is intuitive because SS can
correct interpersonal discrepancies in reputations throu gh its simplicity. On the other hand, SJ is too
complicated to avoid an accumulation of errors, which leads to the collapse of cooperation. We conclude
that moderate simplicity is a key to success in maintaining c ooperation under the private assessment.
Our result provides a theoretical basis for evolution of hum an cooperation.
1 Introduction
Cooperation beneﬁts others but is costly to the cooperator itself . Nevertheless, cooperation is widespread
from microscopic to macroscopic scales, such as among microorgan isms, animals, humans, and nations. One
way to sustain cooperation is that agents conditionally cooperate w ith others who cooperate with them,
which is realized by, for example, repeated interactions [1–3] and p artner choice [4–7]. Such conditional
cooperation based on personal experiences is applicable only to a sm all population where members can
interact directly and repeatedly with most of the others.
However, cooperative behavior is observed even in a large-scale so ciety (e.g., human societies). Since
individuals inevitably encounter strangers there, they need reput ations of those strangers in order not to
cooperate unconditionally. Only individuals with good reputations can receive cooperation. The system that
individuals indirectly reward others via their reputations as describe d above is called indirect reciprocity [8–
10]. In reality, humans are particularly interested in reputations an d gossip about themselves and others [11–
13]. Furthermore, many experiments have pointed out that gossip s concern cooperative behaviors [14–16].
Errors that inevitably occur in actions and in assessment hinder coo peration by indirect reciprocity.
Indeed, the simplest socialnormcalledimagescoring[9,10] fails toma intainfull cooperationundererrors[17,
18](a similarfailureisalsoseenindirectreciprocity[18–20]). Thisisbe causeoneerroneousdefection triggers
furtherdefection. Nevertheless,previousstudieshavetheore ticallyshownthatcooperationcanbemaintained
1by the so-called “leading eight” social norms [21,22] even in the pres ence of such errors when all individuals
share the reputation of the same individual (i.e., public assessment) . Public reputation cases have been
thoroughly studied for about two decades [23–37]. When individuals c annot share their evaluations of the
same target (i.e., private assessment), however, errors cast a s hadow over cooperation more crucially. In this
case, a single disagreement in opinions between two individuals can lead to further disagreements [38–42].
Whether cooperation is maintained under the noisy and private asse ssment is still largely unsolved in theory
and is one of the major open problems in studies of indirect reciprocit y [36,43,44].
Previous studies have shown that maintaining cooperation with indire ct reciprocity is very diﬃcult un-
der noisy and private assessment. For example, Hilbe et al. [42] show ed by an evolutionary simulation
that the above leading eight strategies cannot succeed in coopera tion under private assessment. Some stud-
ies [45–47] have demonstrated the emergence of cooperation und er noisy and private assessment, but under
the restrictive assumption that only local mutations in the strateg y space are allowed, thus excluding the
possibility that a fully cooperative strategy is directly invaded by fre e-riders. Other studies have shown that
a mechanism to synchronize opinions between individuals has a positive inﬂuence on cooperation in indirect
reciprocity, such as empathy, generosity, spatial structure, a nd so on [48–57].
Most of these studies of private assessment have been performe d by computer simulations [42,45]. This
is because two-dimensional information of who assigns a reputation to whom (its matrix representation is
called “image matrix” [38,39,58,59]) becomes too complex to analyze . For example, its possible transition
is illustrated in Fig. 1-A, where a single assessment error can be ampliﬁ ed with time, leading to a mosaic
structure in the image matrix. An evolutionary analysis between wild- type and mutant makes the image
matrix further complex because the image matrix now includes four c ompartments based on diﬀerent rules of
reputation assignment adopted by wild-type and mutant individuals ( Fig. 1-B). In spite of these diﬃculties,
here we report that we have successfully developed an analytical m achinery to study the image matrix by
applying a technique previously developed by the authors [60]. This en ables us to make a general prediction
of when cooperation is sustained under noisy and private assessme nt over the full parameter region.
In the following, we will ﬁrst introduce the setting of indirect recipro city under noisy and private as-
sessment and explain a method to analytically calculate the expected payoﬀ of each individual through
analyzing a complex image matrix. Then, we will discuss which strategy can be an evolutionarily stable
strategy (ESS) [61,62] under which condition, and provide intuitive reasons for the result. To our knowl-
edge, this is the ﬁrst systematic study that has analytically investig ated evolutionary stability of strategies
in indirect reciprocity under noisy and private assessment.
Model
We consider a model of indirect reciprocity in a well-mixed population of sizeN. We assume that, in every
step, a binary reputation is assigned independently from everyone to everyone, either good or bad, which
is summarized by image matrix {βji}, whereβji= 1 (resp. βji= 0) if individual iassigns a good (resp.
bad) reputation to individual j. The model proceeds as follows. First, a donor and a recipient are r andomly
chosen from this population. Next, the donor takes its action, coo peration or defection, to the recipient.
When the donor cooperates, the donor incurs a cost c(>0) but gives a beneﬁt b(> c) to the recipient instead.
On the other hand, when the donor defects, no change occurs in t he payoﬀ of the donor or the recipient.
Here, a rule that speciﬁes how the donor chooses its action is called “ action rule”. Throughout this paper,
we assume that all the individuals adopt the “discriminator” action ru le [9,63], with which they choose
cooperation (resp. defection) to a good (resp. bad) recipient in t heir own eyes; that is, donor ichooses
cooperation toward recipient jifβji= 1, and chooses defection if βji= 0. We assume that the donor
unintentionally takes the opposite action to the intended one with pr obability 0 ≤e1<1/2 (action error).
All the individuals in the population observe this social interaction bet ween the donor and the recipient and
independently update the reputation of the donor in their eyes.
A rule that speciﬁes how each observer updates the reputations o f the others is called its “social norm”.
In models of public reputation, it has often been assumed that all th e individuals in the population adopt
the same social norm [21,29,64] (but see [38]), otherwise, they cannot share the reputation of the same
individual. Because we consider a model of private reputation here, however, we instead assume that
individuals can adopt diﬀerent social norms. This study deals with a sit uation where each observer (say,
2Figure 1: A. An illustration showing how an assessment error ampliﬁes. In all the three panels, there are
1st, 2nd, and 3rd persons, and the 3 ×3 image matrices and straight arrows indicate the reputations amon g
them. In the left panel, good reputations are assigned among all of them, hence they achieve cooperation.
In the center, the 2nd person cooperates with the 1st person, b ut the 3rd person erroneously assigns a bad
reputation to the 2nd person. In the right, the 3rd person defec ts with the 2nd person based on its bad
reputation in the eyes of the 3rd person, but because the 1st and 2nd persons believe that the 2nd person is
good, they assign bad reputations to the 3rd person. B. An illustration showing the complexity of the image
matrix. The left panel shows that wild-types and mutants are mixed in the population and that four kinds
of reputations exist; WW from wild-type to wild-type, WM from mutan t to wild-type, MW from wild-type
to mutant, and MM from mutant to mutant. The right panel shows t hat the image matrix is decomposed
into the corresponding four components, each of which has a diﬀer ent reputation structure.
3Table 1: All 16 second-order social norms in this study
Social norm GC BC GD BD
S01(ALLG) G G G G
S02 G G G B
S03(SS; Simple Standing) G G B G
S04(SC; Scoring) G G B B
S05 G B G G
S06 G B G B
S07(SJ; Stern Judging) G B B G
S08(SH; Shunning) G B B B
S09 B G G G
S10 B G G B
S11 B G B G
S12 B G B B
S13 B B G G
S14 B B G B
S15 B B B G
S16(ALLB) B B B B
k) refers to (i) whether the donor (say, i) cooperates (C) or defects (D) (ﬁrst-order information) and ( ii)
whether the recipient (say, j) is good (G) or bad (B) in the eyes of the observer (second-order information,
represented by βjk) when this observer updates the reputation of the donor in the ey es of the observer,
denoted by βik. Such social norms are called “second-order” social norms [10,1 8,33,36]. An observer who
adopts a second-ordersocial norm can face four diﬀerent cases , denoted by GC(“toward a Good recipient the
donor Cooperates”), BC(“toward a Bad recipient the donor Coop erates”), GD(“toward a Good recipient the
donor Defects”), and BD(“toward a Bad recipient the donor Defe cts”), respectively, and in each case, the
observer assigns either a good (G) or bad (B) reputation to the do nor. Thus, a social norm is represented
by a four-letter string. For example, GBBG is the social norm that a ssigns to the donor a good reputation
in GC- and BD-cases, and a bad reputation in BC- and GD-cases. The re are 24= 16 such social norms
in total, and we lexicographically order them with the rule that G comes ﬁrst and B comes second, and
number them from S01toS16. Table 1 shows a full list of 16 social norms studied here. When updat ing
the reputation, each observer independently commits an assessm ent error with probability 0 < e2<1/2, in
which case he/she accidentally assigns the opposite reputation to t he intended one to the donor.
Several norms are especially important in previous studies, so we ex plain them below. We call S01ALLG
and call S16ALLB because these norms unconditionally assign good or bad reput ations. Next, S03,S04,
S07, andS08belong to G ∗B∗family. These norms share the same feature that they regard coo peration
toward a good recipient as good, and defection toward a good recip ient as bad. They only diﬀer when the
recipient is bad in the observer’s eyes. First, S04is called Scoring (SC), which regards cooperation toward
a bad recipient as good and defection toward a bad recipient as bad, and therefore reputation assignment is
independent of whether the recipient is good or bad in the observer ’s eyes (thus, categorized as a ﬁrst-order
norm). Next, S07is called Stern Judging (SJ), which regards cooperation toward a ba d recipient as bad and
defection toward a bad recipient as good, as opposed to SC. Third, S03is called Simple Standing (SS) and it
regards any action toward a bad recipient as good, and therefore it is the most generous norm in this family.
Finally,S08is called Shunning (SH) and it regards any action toward a bad recipien t as bad, and therefore
it is the most intolerant one. Notably, SJ and SS are the two second- order norms that are included in the
“leading eight” norms [21], which are norms that can successfully main tain cooperation under the noisy and
public reputation that are found in the search within third-order no rms. In particular, SJ has long been
considered promising because it is evolutionarily successful [23] and because it sustains a very high level
of cooperation despite its simplicity [33,36]. SJ always suggests only o ne correct action to keep you good;
it recommends cooperation toward good individuals and defection to ward bad ones, and failure to follow
this rule leads to a bad reputation. Under the noisy public reputation , SH cannot achieve full cooperation
against itself but can prevent the invasion of ALLB (see SI for deta iled calculation).
Under these settings, the strategy of an individual is its social nor m. For this reason, we use “strategy”
4and “(social) norm” interchangeably in the following. We ask which str ategy is evolutionarily stable. To
this end, we study invasibility of a mutant strategy against a wild-typ e one. A strategy is ESS if it is not
invaded by any other 15 mutant strategies. To derive their payoﬀs , we need to analyze the image matrix,
which we shall perform below.
Analysis of reputation structure
Let us consider a situation where individuals with mutant norm M invade the population of wild-type
norm W( /\e}atio\slash= M). Here, the proportion of mutants is given by δ. By extending the Fujimoto & Ohtsuki’s
method [60] we can describe the image matrix by two probability distrib utions. Speciﬁcally, take a focal
individual whose norm is A∈ {W,M}, and let pAA′(hereafter called “goodness”) be the proportion of
individuals among norm A′users who assign a good reputation to the focal individual, for A′∈ {W,M}.
Thus, a wild-type individual is characterized by a pair of goodnesses , (pWW,pWM), and we represent its
distribution over all wild-type individuals by Φ W(pWW,pWM). In the same way, a mutant is characterized
by a pair of goodnesses, ( pMW,pMM), and Φ M(pMW,pMM) represents its distribution over all mutants. In
SI, we derive the dynamics of Φ Wand Φ Mby formulating a stochastic transition of the donor’s goodnesses
under the assumption of N≫1 (the population is large), δ≪1 (mutants are rare), and Nδ≫1 (yet
the number of mutants is suﬃciently large). Then, we derive the equ ilibrium distributions, Φ∗
Wand Φ∗
M.
These equilibrium distributions give expected payoﬀs of wild-types an d mutants, which enable us to study
the invasibility condition of mutants to wild-types (see SI again).
We ﬁnd that each of the two equilibrium distributions is well approximat ed by a weighted sum of two-
dimensional Gaussian functions with zero covariance, where each G aussian can be systematically labeled
by a nonzero integer, j∈Z\{0}(see an example in Fig. 2-B and the rule of labeling in Fig. 2-C). Hence
the number of Gaussians that appear in the sum is inﬁnitely but count ably many. In some cases, however,
these labels degenerate (i.e., two or more Gaussians are identical bu t they are given diﬀerent labels) and the
number of Gaussians can be ﬁnite. Weights to Gaussians decay expo nentially as jbecomes large positive
or large negative, so a truncation at some ﬁnite number of terms ap proximates well the inﬁnite sum for
numerical calculations.
ESS norms
Based on the analysis of the image matrix above, we have studied pair wise invasibility for all the pairs of
wild-type W and mutant M. In the following, we set the action error ra te ase1= 0, because this error,
especially when it is small positive, does not have a qualitative impact on our results as far as we studied.
Thus, the cost-beneﬁt ratio b/cand the assessment error rate e2are our environmental parameters.
We ﬁrst ﬁnd that the four strategies, S06,S07(SJ),S10, andS11, are completely indistinguishable, both
as wild-types and as mutants. This is because these norms always giv e the goodness of 1 /2 to anyone in
the population at equilibrium due to an accumulation of assessment er rors and hence they appear to choose
cooperation and defection in a random manner. In particular, they are neutral to each other. For these
reasons, we will discuss only S07(SJ) as a representative of them and exclude the other three in th e following
analysis.
Our exhaustive analysis demonstrates that only three norms, S03(SS),S08(SH), and S16(ALLB) can be
ESS, and all the others cannot. As shown in Fig. 3-A, ALLB is ESS inde pendent of b/cande2, because it is
the norm that assigns a bad reputation to everyone, saves the ow n cost, and provides no beneﬁt to others.
On the other hand, SS and SH achieve ESS for some b/cande2; there are upper and lower bounds of b/c
for them to be ESS, which depend on e2. Below we will look at its details.
Conditions for ESS
The ESS condition of S03(SS) is shown in Fig. 3-B. When b/cexceeds the upper bound, the norm is invaded
byS01(ALLG) (compare the right and center panels of Fig. 3-A). On the o ther hand, when b/cfalls below
the lower bound, the norm is invaded by S04(SC) (compare the left and center panels of Fig. 3-A). Fig. 3-C
5Figure 2: Illustrations of our method to analyze reputation struct ure.A. In the left panel, an example of
image matrix is shown. We analyze this image matrix divided into four par ts; whether the reputing side is
wild-type (W) ormutant (M) and whetherthe reputed side isWorM. I n the rightpanel, apairofgoodnesses
of each individual from wild-types (colored green) and mutants (blu e) are extracted from the image matrix.
Because the pair of goodnesses correlate with each other, we con sider the joint probability distribution of
them, denoted by Φ Wand Φ M.B. We analytically calculated this joint probability distribution. One can
see that the analytical estimation (the left panel) well ﬁts the simula tion (right). In both the panels, we
assume (W ,M) = (S09,S03),N= 5000, δ= 0.1, and (e1,e2) = (0,0.1). In the numerical simulation, we
used 3000 samples of image matrices from time t= 51,···,3050 (a random donor’s goodness is updated
Ntimes per unit time of t). On the other hand, in the theoretical analysis, we introduced th e cutoﬀ of
−100≤j≤+100. Each number near the heat peaks indicates the class label j.C. Rules for labeling
individual classes. Each class corresponds to one Gaussian distribu tion. Each box (labelled by j∈Z\{0})
indicates a class. The destination of each arrow indicates the class t hat the donor moves to after taking
cooperation (C) or defection (D) toward the recipient that belong s to the class that the arrow originates.
For example, a donor that cooperated with class j=−2 recipient moves to class j= +1.
shows that these theoretical bounds are also supported by individ ual-based simulations. Notably, the smaller
e2is, the wider the ESS region of S03(SS) becomes.
The ESS region of S08(SH) is quite narrow in comparison to that of S03(SS), as seen in Fig. 3-B. In
6Figure 3: Details of ESS analysis. A. Invasibility between all pairs of the social norms. The left, center ,
and right panels respectively show the cases of b/c≤1.1, = 3, and ≥20. Numbers in rows (resp. columns)
indicate the labels of wild-type (resp. mutant) norms. Each circle (r esp. cross) mark indicates that the
invasion by mutants is successful (resp. unsuccessful). Each ba r mark indicates that the wild-type and
mutant norms are neutral. All the panels are based on e2= 0.1 and−10000≤j≤+10000. B. The
ESS parameter region for norms S03(SS) (left) and S08(SH) (right). In each panel, the horizontal (resp.
vertical) axis indicates e2(resp.b/c). The blue (resp. red) color indicates that the norm is ESS (resp.
not ESS). C. Comparison between analytical and numerical calculations of the E SS region of S03(SS). The
horizontal and vertical axis are the same as in B. The cyan (resp. pink) line indicates the theoretical
upper (resp. lower) bound (the same as the left panel in B). Blue (resp. red) dots, connected by lines,
indicate the numerical estimates of the upper (resp. lower) bound . Those estimates were calculated based
on agent-based simulations of image matrix with N= 10000, δ= 0.03. The average of 50 samples from
generations 51 ≤t≤100 were used, except for in the calculation of the upper bound (blu e dots) for e2<0.1
where we instead used the average of 3000 samples from 51 ≤t≤3050 to reduce errors in estimation. D.
A comparison between public (top row) and private (bottom row) as sessment cases of how wild-type SS
individuals evaluate other SS individuals (left column) and how wild-type SS individuals evaluate mutant
ALLBindividuals(rightcolumn). In eachpanel, thehorizontalandve rticalaxesindicateindividualgoodness
and its frequency, respectively. Positions and heights of bars are correct only up to order e2. We see that
SS gives high goodness to most of the SS individuals (left column), tha t SS gives low goodness to most of
the ALLB individuals (right column), and that the diﬀerence between the top and bottom rows is minor
(in a scale of O(e2)). Thus, SS is robust against the invasion by ALLB under both public and private
assessment. E. Similar comparison to Dwas made for wild-type SJ and mutant ALLB. We see that SJ gives
high goodness to most of the SS individuals under public assessment ( top left), that SJ gives low goodness
to most of the ALLB individuals (top right), but that SJ gives goodne ss of 1/2 to both SJ (bottom left)
and ALLB (bottom right) individuals under private assessment. Thu s, SJ is robust against the invasion by
ALLB under public assessment while it is not under private assessmen t.7addition, when b/cexceeds the upper bound or falls below the lower bound, the norm is in vaded by S04(SC)
andS16(ALLB), respectively. The range of b/c-ratios that make SH evolutionarily stable is the widest at an
intermediate e2(about 0 .1).
In contrastto these results, we ﬁnd that S07(SJ), which is known to be a successful norm when reputation
is public, is invaded by norms such as S16(ALLB) and S08(SH) independent of the value of b/c(and also
independent of e2), and therefore that it is never an ESS. This is summarized in Fig. 3-A .
To summarize, SS, SH, and SJ are all the ESS norms under the public a ssessment, but whether they
remain ESS in the private assessment critically diﬀers. This diﬀerence is clearly understood by focusing
on how the reputation structure they give diﬀers between the pub lic and private reputation cases under a
suﬃciently small but positive assessment error rate, e2≪1. Let us consider below, for example, whether
each norm can prevent the invasion of ALLB, a potential invader no rm.
Success of Simple Standing: The reputation structure that S03(SS) gives diﬀers little between the
public and private reputation cases (see Fig. 3-D). Under the public reputation (see SI for the calculation),
SS assigns good reputations to SS themselves (represented by th e bar at goodness = 1 in the top-left panel
in Fig. 3-D), while bad reputations to ALLB (represented by the bar at goodness = 0 in the top-right panel
in Fig. 3-D). Thus, SS distinguishes between SS itself and the invader ALLB and prevents the invasion
of ALLB. Even under the private reputation, SS still assigns good r eputations to SS themselves (see the
bottom-left panel in Fig. 3; high goodness of 1 −e2are given to the fraction 1 −2e2of SS individuals, for
example), and assigns bad reputations to ALLB (see the bottom-r ight panel in Fig. 3; low goodness of 2 e2
are given to the fraction 1 −3e2of ALLB individuals, for example). Thus, the distinction between SS a nd
ALLB is maintained. For that reason, SS succeeds in achieving ESS ev en under the private assessment. The
cooperation rate at this ESS is as high as 1 −2e2for small e2, so it entails nearly perfect cooperation.
Failure of Stern Judging: Contrary to SS, the reputation structure that S07(SJ) gives extremely
diﬀers between the public and private reputation cases (see Fig. 3- E). Under the public reputation (see SI
for the calculation), wild-type SJ gives high goodness to other SJ (t op-left in Fig. 3-E) and wild-type SJ
gives low goodness to ALLB (top-right in Fig. 3-E). Thus, SJ preven ts the invasion of ALLB. Under the
private assessment, however, SJ gives goodness of 1/2 to other SJ individuals (bottom-left in Fig. 3-E) [39]
while SJ gives goodness of 1/2 to ALLB individuals as well (bottom-righ t in Fig. 3-E). Thus, the distinction
between SJ and ALLB is lost. This is why SJ fails to be ESS under the priv ate assessment.
Shunning can be ESS, but the level of cooperation is low: We can understand why S08(SH)
achieves ESS only in a narrow region under private reputation (see S I for the detailed calculation and see
Fig.S3forthe illustrationforeasyinterpretation). Underthe pub lic reputation, SHgivesgoodreputationsto
the half of other SH and bad reputations to the other half (top-lef t in Fig. S3) while SH gives bad reputations
toalmostallALLB(top-rightinFig.S3). Thus, SHpreventstheinva sionofALLB.Underprivatereputation,
on the other hand, SH gives low goodness to both SH and ALLB (bott om-left and bottom-right in Fig. S3).
Here, however, SH has a slightly better chance to receive good rep utations than ALLB, in the order of e2
2.
This explains why SH prevents the invasion from ALLB only in a narrow r egion and also explains why its
ESS condition becomes more strict for a smaller assessment error r ate,e2. The cooperation rate at a realized
ESS is as low as e2for small e2, so we conclude that S08(SH) does not contribute to cooperation.
Discussion
This study considered indirect reciprocity under noisy and private a ssessment. We focused on goodness
of individual (i.e., what proportion of individuals gives the individual goo d reputations) between diﬀerent
normsanddevelopedananalyticalmethodtocalculatethedistribut ionofgoodnessatequilibrium. Usingthis
methodology we studied whether a mutant norm succeeds in the inva sion into a wild-type norm. Although
bothS03(SS) and S07(SJ) can be ESS under public reputation, we found that their evolut ionary stability is
totally diﬀerent under private assessment. In particular, we foun d thatS03(SS) remains to be ESS under
private assessment if the assessment error rate is small, while S07(SJ) cannot be ESS no matter how small
the error rate is.
The reasonfor this diﬀerence between S03(SS) and S07(SJ) comes from the diﬀerence in the complexity of
these two norms. In the world of private assessment, errors in as sessment accumulate independently among
observers, which is a potential source of collapse of cooperation in the population. However, since S03(SS)
8regards a cooperating donor as good no matter whether the recip ient is good or bad, a discrepancy in the
opinion toward the recipient between two diﬀerent observers does not produce further discrepancy; those
two observers can agree that such a cooperating donor is good. I n contrast, S07(SJ) is more complex than
S03(SS) and recipient’s reputation is always decisive information (see Ta ble 1), so this complexity becomes
an obstacle for correcting discrepancy between observers.
Hilbe et al. [42] studied by computer simulations whether the leading eig ht norms can sustain cooperation
under the noisy and private assessment. They concluded that S03(SS) (referred to as “L3” in their paper)
andS07(SJ) (“L6”) fail to achieve cooperation, which is contrary to our r esult. This diﬀerence is because we
studied evolutionarystability in a deterministic model, while they studie d ﬁxation probability in a stochastic
model. Because those two criteria are diﬀerent, drawing a general conclusion is diﬃcult, but the signiﬁcance
of our study lies in that we have shown that cooperation can be evolu tionarily sustained even under private
assessment.
A future direction of this study would be to examine ESS conditions of social norms when some of the
assumptions are changed. For example, we have assumed second- order norms, in which individuals refer to a
donor’saction (ﬁrst-orderinformation) and a recipient’s reputat ion (second-orderone) when they update the
donor’s reputation. However, humans may use more complex norms than the second-order ones. Studying
the eﬀect of higher-order information [32,33,36,65], such as the previous reputation of the donor (third-
order information), would further deepen our understanding. We have also assumed that all individuals
simultaneously update their opinions toward the same donor. Howev er, in a real society, the number of
people who can observe a single person’s behavior is limited. Thus, the eﬀect of asynchronous updates of
reputations is worth studying. Last but not least, we have implicitly a ssumed that game interactions last
suﬃciently long so that we can use equilibrium distributions of goodnes s for calculating payoﬀs (i.e. discount
factor is 1). However, the eﬀect of initial reputation cannot nece ssarily be ignored in some cases.
In conclusion, we have demonstrated that cooperation can be evo lutionarily stable even under the noisy
and private assessment. Speciﬁcally, we have shown that Stern Ju dging, which is one of the most leading
norms under public reputation, cannot distinguish between cooper ators and defectors under private assess-
ment and thus fails to achieve ESS. On the other hand, we have reve aled that Simple Standing can be stable
in a wide range of parameters. Based on these results, we predict t hat Simple Standing should play a key
role in sustaining cooperation by indirect reciprocity under noisy priv ate assessment. These ﬁndings provide
a rigid theoretical basis for understanding human cooperation and pave the way for future studies in biology,
psychology, sociology, and economics.
Acknowledgement
Y.F. acknowledges the support by JSPS KAKENHI Grant Number JP2 1J01393. H.O. acknowledges the
support by JSPS KAKENHI Grant Number JP19H04431.
References
[1] Robert L Trivers. The evolution of reciprocal altruism. The Quarterly Review of Biology , 46(1):35–57,
1971.
[2] Robert Axelrod and William D Hamilton. The evolution of cooperation. Science, 211(4489):1390–1396,
1981.
[3] Robert Axelrod. The Evolution of Cooperation . Basic, New York, 1984.
[4] Toshio Yamagishi, Nahoko Hayashi, and Nobuhito Jin. Prisoner’s dile mma networks: selection strategy
versus action strategy. In Social dilemmas and cooperation , pages 233–250. Springer, 1984.
[5] Ronald No¨ e and Peter Hammerstein. Biological markets: supply a nd demand determine the eﬀect of
partner choice in cooperation, mutualism and mating. Behavioral Ecology and Sociobiology , 35(1):1–11,
1994.
9[6] Ronald No¨ e and Peter Hammerstein. Biological markets. Trends in Ecology & Evolution , 10(8):336–339,
1995.
[7] Pat Barclay. Strategies for cooperation in biological markets, e specially for humans. Evolution and
Human Behavior , 34(3):164–175, 2013.
[8] Richard D Alexander. The biology of moral systems . Aldine de Gruyter: New York, 1987.
[9] Martin A Nowak and Karl Sigmund. Evolution of indirect reciprocity by image scoring. Nature,
393(6685):573–577, 1998.
[10] Martin A Nowak and Karl Sigmund. Evolution of indirect reciprocit y.Nature, 437(7063):1291–1298,
2005.
[11] Nicholas Emler. Gossip, reputation, and social adaptation. University Press of Kansas, 1994.
[12] Robin Ian MacDonald Dunbar. Grooming, gossip, and the evolution of language . Harvard University
Press, 1998.
[13] Robin IM Dunbar. Gossip in evolutionary perspective. Review of General Psychology , 8(2):100–110,
2004.
[14] Matthew Feinberg, Robb Willer, Jennifer Stellar, and Dacher Kelt ner. The virtues of gossip: rep-
utational information sharing as prosocial behavior. Journal of Personality and Social Psychology ,
102(5):1015, 2012.
[15] Matthew Feinberg, Robb Willer, and Michael Schultz. Gossip and o stracism promote cooperation in
groups.Psychological Science , 25(3):656–664, 2014.
[16] Junhui Wu, Daniel Balliet, and Paul AM Van Lange. Reputation, g ossip, and human cooperation.
Social and Personality Psychology Compass , 10(6):350–364, 2016.
[17] Karthik Panchanathan and Robert Boyd. A tale of two defecto rs: the importance of standing for
evolution of indirect reciprocity. Journal of Theoretical Biology , 224(1):115–126, 2003.
[18] Karl Sigmund. The calculus of selﬁshness . Princeton University Press, 2010.
[19] Martin Nowak and Karl Sigmund. A strategy of win-stay, lose-s hift that outperforms tit-for-tat in the
prisoner’s dilemma game. Nature, 364(6432):56–58, 1993.
[20] Jianzhong Wu and Robert Axelrod. How to cope with noise in the ite rated prisoner’s dilemma. Journal
of Conﬂict Resolution , 39(1):183–189, 1995.
[21] Hisashi Ohtsuki and Yoh Iwasa. How should we deﬁne goodness ?—reputation dynamics in indirect
reciprocity. Journal of Theoretical Biology , 231(1):107–120, 2004.
[22] Hisashi Ohtsuki and Yoh Iwasa. The leading eight: social norms that can maintain cooperation by
indirect reciprocity. Journal of Theoretical Biology , 239(4):435–444, 2006.
[23] Jorge M Pacheco, Francisco C Santos, and Fabio AC C Chalub. St ern-judging: A simple, successful
norm which promotes cooperation under indirect reciprocity. PLoS Computational Biology , 2(12):e178,
2006.
[24] Shinsuke Suzuki and Eizo Akiyama. Evolution of indirect reciproc ity in groups of various sizes and
comparison with direct reciprocity. Journal of Theoretical Biology , 245(3):539–552, 2007.
[25] Francisco C Santos, Fabio ACC Chalub, and Jorge M Pacheco. A m ulti-level selection model for the
emergence of social norms. In European Conference on Artiﬁcial Life , pages 525–534. Springer, 2007.
[26] Feng Fu, Christoph Hauert, Martin A Nowak, and Long Wang. Re putation-based partner choice pro-
motes cooperation in social networks. Physical Review E , 78(2):026117, 2008.
10[27] Shinsuke Suzuki and Eizo Akiyama. Evolutionarystability of ﬁrst -order-informationindirect reciprocity
in sizable groups. Theoretical Population Biology , 73(3):426–436, 2008.
[28] Satoshi Uchida and Karl Sigmund. The competition of assessme nt rules for indirect reciprocity. Journal
of Theoretical Biology , 263(1):13–19, 2010.
[29] Hisashi Ohtsuki, Yoh Iwasa, and Martin A Nowak. Reputation eﬀ ects in public and private interactions.
PLoS Computational Biology , 11(11):e1004527, 2015.
[30] FernandoPSantos, FranciscoCSantos,andJorgeMPacheco . Socialnormsofcooperationin small-scale
societies. PLoS Computational Biology , 12(1):e1004709, 2016.
[31] Fernando P Santos, Jorge M Pacheco, and Francisco C Santos . Evolution of cooperation under indirect
reciprocity and arbitrary exploration rates. Scientiﬁc Reports , 6(1):1–9, 2016.
[32] Tatsuya Sasaki, Isamu Okada, and Yutaka Nakai. The evolution of conditional moral assessment in
indirect reciprocity. Scientiﬁc reports , 7(1):1–8, 2017.
[33] Fernando P Santos, Francisco C Santos, and Jorge M Pacheco . Social norm complexity and past
reputations in the evolution of cooperation. Nature, 555(7695):242–245, 2018.
[34] Fernando Santos, Jorge Pacheco, and Francisco Santos. So cial norms of cooperation with costly repu-
tation building. Proceedings of the AAAI Conference on Artiﬁcial Intelligen ce, 32(1), Apr. 2018.
[35] ChengyiXia, CarlosGracia-L´ azaro,and Yamir Moreno. Eﬀect ofmemory, intolerance, andsecond-order
reputation on cooperation. Chaos: An Interdisciplinary Journal of Nonlinear Science , 30(6):063122,
2020.
[36] Fernando P Santos, Jorge M Pacheco, and Francisco C Santos . The complexity of human cooperation
under indirect reciprocity. Philosophical Transactions of the Royal Society B , 376(1838):20200291,2021.
[37] Shirsendu Podder, Simone Righi, and K´ aroly Tak´ acs. Local re putation, local selection, and the leading
eight norms. Scientiﬁc Reports , 11(1):1–10, 2021.
[38] Satoshi Uchida. Eﬀect of private information on indirect recipr ocity.Physical Review E , 82(3):036111,
2010.
[39] Satoshi Uchida and Tatsuya Sasaki. Eﬀect of assessment err or and private information on stern-judging
in indirect reciprocity. Chaos, Solitons & Fractals , 56:175–180, 2013.
[40] Isamu Okada, Tatsuya Sasaki, and Yutaka Nakai. Tolerant indir ect reciprocity can boost social welfare
through solidarity with unconditional cooperators in private monito ring.Scientiﬁc Reports , 7(1):1–11,
2017.
[41] IsamuOkada,TatsuyaSasaki,andYutakaNakai. Asolutionfor privateassessmentinindirectreciprocity
using solitary observation. Journal of Theoretical Biology , 455:7–15, 2018.
[42] Christian Hilbe, Laura Schmid, Josef Tkadlec, Krishnendu Chatt erjee, and Martin A Nowak. Indirect
reciprocity with private, noisy, and incomplete information. Proceedings of the National Academy of
Sciences, 115(48):12241–12246, 2018.
[43] SamuelBowlesandHerbertGintis. Acooperativespecies. In A Cooperative Species .PrincetonUniversity
Press, 2011.
[44] Isamu Okada. A review of theoretical studies on indirect recipr ocity.Games, 11(3):27, 2020.
[45] Hitoshi Yamamoto, Isamu Okada, Satoshi Uchida, and Tatsuy a Sasaki. A norm knockout method on
indirect reciprocity to reveal indispensable norms. Scientiﬁc Reports , 7(1):1–7, 2017.
[46] Sanghun Lee, Yohsuke Murase, and Seung Ki Baek. Local sta bility ofcooperation in a continuous model
of indirect reciprocity. Scientiﬁc Reports , 11(1):1–13, 2021.
11[47] Sanghun Lee, Yohsuke Murase, and Seung Ki Baek. A second- order perturbation theory for the contin-
uous model of indirect reciprocity. arXiv preprint arXiv:2203.03920 , 2022.
[48] Eleanor Brush, ˚Ake Br¨ annstr¨ om, and Ulf Dieckmann. Indirect reciprocity with ne gative assortment and
limited information can promote cooperation. Journal of Theoretical Biology , 443:56–65, 2018.
[49] Roger M Whitaker, Gualtiero B Colombo, and David G Rand. Indirec t reciprocity and the evolution
of prejudicial groups. Scientiﬁc Reports , 8(1):1–14, 2018.
[50] Arunas L Radzvilavicius, Alexander J Stewart, and Joshua B Plot kin. Evolution of empathetic moral
evaluation. Elife, 8:e44269, 2019.
[51] Marcus Krellner and The Anh Han. Putting oneself in everybody’s shoes-pleasing enables indirect
reciprocity under private assessments. In Artiﬁcial Life Conference Proceedings 32 , pages 402–410.MIT
Press One Rogers Street, Cambridge, MA 02142-1209, USA, 2020 .
[52] Ji Quan, Xiukang Yang, Xianjia Wang, Jian-Bo Yang, KaibiaoWu, a nd Zilong Dai. Withhold-judgment
and punishment promote cooperation in indirect reciprocity under in complete information. EPL (Eu-
rophysics Letters ) , 128(2):28001, 2020.
[53] Marcus Krellner and The Anh Han. Pleasing enhances indirect rec iprocity-based cooperation under
private assessment. Artiﬁcial Life , 31:1–31, 2021.
[54] Laura Schmid, Pouya Shati, Christian Hilbe, and Krishnendu Chat terjee. The evolution of indirect
reciprocity under action and assessment generosity. Scientiﬁc Reports , 11(1):1–14, 2021.
[55] Taylor A Kessinger and Joshua B Plotkin. Indirect reciprocity in p opulations with group structure.
arXiv preprint arXiv:2204.10811 , 2022.
[56] Ji Quan, Jiacheng Nie, Wenman Chen, and Xianjia Wang. Keeping o r reversing social norms promote
cooperation by enhancing indirect reciprocity. Chaos, Solitons & Fractals , 158:111986, 2022.
[57] Pengfei Gu and Yanling Zhang. Reputation-based rewiring prom otes cooperation in complex network.
InAdvances in Guidance, Navigation and Control , pages 1405–1415. Springer, 2022.
[58] KarlSigmund. Moralassessmentin indirect reciprocity. Journal of Theoretical Biology , 299:25–30,2012.
[59] Koji Oishi, Takashi Shimada, and Nobuyasu Ito. Group format ion through indirect reciprocity. Physical
Review E , 87(3):030801, 2013.
[60] Yuma Fujimoto and Hisashi Ohtsuki. Reputation structure in ind irect reciprocity under noisy and
private assessment. Scientiﬁc Reports , 12(1):1–13, 2022.
[61] J Maynard-Smith and George R Price. The logic of animal conﬂict. Nature, 246(5427):15–18, 1973.
[62] John Maynard-Smith. Evolution and the Theory of Games . Cambridge university press, 1982.
[63] Martin A Nowak and Karl Sigmund. The dynamics of indirect recipr ocity.Journal of Theoretical
Biology, 194(4):561–574, 1998.
[64] Hisashi Ohtsuki and Yoh Iwasa. Global analyses of evolutionar y dynamics and exhaustive search for
social norms that maintain cooperation by reputation. Journal of Theoretical Biology , 244(3):518–531,
2007.
[65] Robert Sugden. The economics of rights, co-operation and welfare . Basil Blackwell, 1986.
12Supplementary Material
S1 Calculation of joint distribution of goodnesses
This section proposes an analytical method to obtain the rep utation structure under indirect reciprocity. We assume
a situation where rare mutants with norm M of ratio δinvade other wild-types with norm W of ratio 1 −δ. We
denote the population ratio of norm A∈ {W,M}asρA;ρA= 1−δwhenA= W, while ρA=δwhenA= M.
To characterize the reputation structure, we deﬁne piAas a proportion of individuals of norm Awho assign good
reputations to individual i. We call piAa goodness of individual ifrom norm A∈ {W,M}.
In the following, let us consider a stochastic transition of piAin each round. In a single round, a recipient and
a donor are chosen and labeled as iRandiD, respectively. In this round, piDAO, i.e., the goodness of donor from
normAO, changes into the next goodness p′
iDAOfor allAO∈ {W,M}. Below, we formulate the stochastic change
separately for cases that the donor chooses to cooperate or d efect.
C-map case: First, we consider a case that the donor cooperates with the r ecipient, occurring with a probability
of
h(piRAD) :=piRAD(1−e1)+(1−piRAD)e1. (1)
In this case, NρAOp′
iDAO, i.e., the number of observers with norm AOwho give good reputations to the donor in the
next round, follows a probability distribution of
NρAOp′
iDAO∼N1+N2, (2)
N1∼ B(NρAOpiRAO,aGC
AO), (3)
N2∼ B(NρAO(1−piRAO),aBC
AO). (4)
Here,B(n,a) denotes a binomial distribution with success probability aand trial number n. In addition, aXY
AO
denotes the probability that an observer with norm AOwho evaluates the recipient as X∈ {G,B}newly gives
a good reputation to the donor whose action is Y∈ {C,D}.aGC
AO,aBC
AO,aGD
AO, andaBD
AOare obtained by converting
corresponding G and B pivots into 1 −e2ande2in Table 1 of the main manuscript. Instead of (3), we use a shor thand
notation;
NρAOp′
iDAO∼ B(NρAOpiRAO,aGC
AO)+B(NρAO(1−piRAO),aBC
AO). (5)
Because NρAOis suﬃciently large, the mean and variance of p′
iDAOare given by
E[p′
iDAO] =piRAO(aGC
AO−aBC
AO/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
=:∆fC
AO)+aBC
AO(=:fC
AO(piRAO)), (6)
Var[p′
iDAO] =piRAOaGC
AO(1−aGC
AO)+(1−piRAO)aBC
AO(1−aBC
AO)
NρAO=e2(1−e2)
NρAO(=:ρ−1
AOs2). (7)
In (6),fC
AOrepresents a map from the recipient’s goodness in the presen t round to the donor’s goodness in the next
round. Because this map is applied only when the donor cooper ates, we call it “C-map”.
D-map case: On the other hand, we consider a case that the donor defects wi th the recipient, occurring with a
probability of
1−h(piRAD) = (1−piRAD)(1−e1)+piRADe1. (8)
In this case, NρAOp′
iDAOfollows a probability distribution of
NρAOp′
iDAO∼ B(NρAOpiRAO,aGD
AO)+B(NρAO(1−piRAO),aBD
AO). (9)
From this equation, the mean and variance of p′
iDAOare given by
E[p′
iDAO] =piRAO(aGD
AO−aBD
AO/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
=:∆fD
AO)+aBD
AO(=:fD
AO(piRAO)), (10)
Var[p′
iDAO] =piRAOaGD
AO(1−aGD
AO)+(1−piRAO)aBD
AO(1−aBD
AO)
NρAO=e2(1−e2)
NρAO(=:ρ−1
AOs2). (11)
Because the map fD
AOis applied when the donor defects, we call it D-map in the same way as C-map.
The above C-map fC
Skand D-map fD
Skare illustrated in Fig. 1 for all Sk∈ S.
13FIG. S 1: Materials for the reputation structure for all the secon d-order norms W = Sk. Green solid (resp.
broken) lines indicate C-map fC
W(resp. D-map fD
W) of the norm. Gray lines indicate the identity map,
which shows the ﬁxed points of the C-map and D-map as the crossing points with these maps. The orange
distribution shows the probability density function of goodnesses pWWwhen W = Sk. All the panels are
output under N= 2000,δ= 0, and ( e1,e2) = (0,0.1). Numbers over each peak indicate j.
14S2 Time evolution of reputation structure
Because the population of wild-types and mutants are suﬃcie ntly large, we can continualize the distribution of
individual goodness piAwith separating into the cases that the norm of individual iis W or M. In the following,
pAA′denotes a continualized goodness of an individual with norm Ain the eyes of individuals with norm A′. Let
us consider a time change of the distribution of pAA′. As shown above, however, we should keep in mind that pAW
andpAMare simultaneously changed by the C-map or D-map. Thus, we co nsider dynamics of Φ A(pAW,pAM), a joint
probability distribution of pAWandpAM. Note that a norm of the chosen recipient is M only with a proba bility of
δ, which contributes the dynamics of Φ Aonly in a scale of O(δ). By ignoring this scale of O(δ), the dynamics of Φ A
is given by
d
dtΦA(pAW,pAM) =−ΦA(pAW,pAM)+/integraldisplay1
0/integraldisplay1
0{h(p′
WA)g(pAW;fC
W(p′
WW),ρ−1
Ws2)g(pAM;fC
M(p′
WM),ρ−1
Ms2)
+(1−h(p′
WA))g(pAW;fD
W(p′
WW),ρ−1
Ws2)g(pAM;fD
M(p′
WM),ρ−1
Ms2)}
×ΦW(p′
WW,p′
WM)dp′
WWdp′
WM. (12)
Here,g(p;µ,σ2) denotes a Gaussian function with the mean µand variance σ2as
g(p;µ,σ2) :=1√
2πσ2exp/parenleftbigg
−(p−µ)2
2σ2/parenrightbigg
. (13)
Equation (12) explains an update of the donor’s goodness per time. The ﬁrst (resp. second) term in the right side
represents decrements (increments) by updating goodnesse s. In detail, Φ W(p′
WW,p′
WM) in the second term shows
the density that the recipient’s goodness is p′
WW(resp.p′
WM) in the eyes of wild-types (resp. mutants). h(p′
WA)
shows the probability that the donor cooperates, and the don or’s goodnesses after the update in the eyes of observers
with norm W and M are described by g(pAW;fC
W(p′
WW),ρ−1
Ws2) andg(pAM;fC
M(p′
WM),ρ−1
Ms2), respectively. A similar
explanation holds when the donor chooses to defect.
The equilibrium state of (12), i.e., Φ∗
A, satisﬁes
Φ∗
A(pAW,pAM) =/integraldisplay1
0/integraldisplay1
0{h(p′
WA)g(pAW;fC
W(p′
WW),ρ−1
Ws2)g(pAM;fC
M(p′
WM),ρ−1
Ms2)
+(1−h(p′
WA))g(pAW;fD
W(p′
WW),ρ−1
Ws2)g(pAM;fD
M(p′
WM),ρ−1
Ms2)}
×Φ∗
W(p′
WW,p′
WM)dp′
WWdp′
WM. (14)
To solve this equation, we assume that the equilibrium state can be described by a summation of two-dimensional
Gaussian functions without correlation as
Φ∗
A(pAW,pAM) =/summationdisplay
jqAjg(pAW;µAWj,ρ−1
Wσ2
AWj)g(pAM;µAMj,ρ−1
Mσ2
AMj). (15)
The assumption of Gaussian is justiﬁed by the above transiti on process of the donor’s goodness, where the goodness
is virtually determined only by the mean and variance in a suﬃ ciently large population. No correlation is assumed
because the variance is given independently by observers wi th diﬀerent norms.
We now derive equations which the equilibrium state satisﬁe s for each norm A∈ {W,M}. First, substituting (15)
15into (14) for A= W, we obtain
/summationdisplay
jqWjg(pWW;µWWj,ρ−1
Wσ2
WWj)g(pWM;µWMj,ρ−1
Mσ2
WMj)
=/integraldisplay1
0/integraldisplay1
0{h(p′
WW)g(pWW;fC
W(p′
WW),ρ−1
Ws2)g(pWM;fC
M(p′
WM),ρ−1
Ms2)
+(1−h(p′
WW))g(pWW;fD
W(p′
WW),ρ−1
Ws2)g(pWM;fD
M(p′
WM),ρ−1
Ms2)}
×/summationdisplay
jqWjg(p′
WW;µWWj,ρ−1
Wσ2
WWj)g(p′
WM;µWMj,ρ−1
Mσ2
WMj)dp′
WWdp′
WM,
=/summationdisplay
jqWj/integraldisplay1
0/integraldisplay1
0{h(p′
WW)g(pWW;fC
W(p′
WW),ρ−1
Ws2)g(pWM;fC
M(p′
WM),ρ−1
Ms2)
+(1−h(p′
WW))g(pWW;fD
W(p′
WW),ρ−1
Ws2)g(pWM;fD
M(p′
WM),ρ−1
Ms2)}
×g(p′
WW;µWWj,ρ−1
Wσ2
WWj)g(p′
WM;µWMj,ρ−1
Mσ2
WMj)dp′
WWdp′
WM,
≃/summationdisplay
jqWj/integraldisplay∞
−∞/integraldisplay∞
−∞{h(µWWj)g(pWW;fC
W(p′
WW),ρ−1
Ws2)g(pWM;fC
M(p′
WM),ρ−1
Ms2)
+(1−h(µWWj))g(pWW;fD
W(p′
WW),ρ−1
Ws2)g(pWM;fD
M(p′
WM),ρ−1
Ms2)}
×g(p′
WW;µWWj,ρ−1
Wσ2
WWj)g(p′
WM;µWMj,ρ−1
Mσ2
WMj)dp′
WWdp′
WM,
=/summationdisplay
jqWj{h(µWWj)g(pWW;fC
W(µWWj),ρ−1
W(s2+(∆fC
W)2σ2
WWj))g(pWM;fC
M(µWMj),ρ−1
M(s2+(∆fC
M)2σ2
WMj))}
+(1−h(µWWj))g(pWW;fD
W(µWWj),ρ−1
W(s2+(∆fD
W)2σ2
WWj))g(pWM;fD
M(µWMj),ρ−1
M(s2+(∆fD
M)2σ2
WMj))}.
(16)
This equation gives a constraint for ( qWj,µWWj,σ2
WWj,µWMj,σ2
WMj). Next, when A= M, in a similar manner, we
obtain
/summationdisplay
jqMjg(pMW;µMWj,ρ−1
Wσ2
MWj)g(pMM;µMMj,ρ−1
Mσ2
MMj)
=/integraldisplay1
0/integraldisplay1
0{h(p′
WM)g(pMW;fC
W(p′
MW),ρ−1
Ws2)g(pMM;fC
M(p′
MM),ρ−1
Ms2)
+(1−h(p′
WM))g(pMW;fD
W(p′
MW),ρ−1
Ws2)g(pMM;fD
M(p′
MM),ρ−1
Ms2)}
×/summationdisplay
jqMjg(p′
MW;µMWj,ρ−1
Wσ2
MWj)g(p′
MM;µMMj,ρ−1
Mσ2
MMj)dp′
MWdp′
MM
=/summationdisplay
jqMj/integraldisplay1
0/integraldisplay1
0{h(p′
WM)g(pMW;fC
W(p′
MW),ρ−1
Ws2)g(pMM;fC
M(p′
MM),ρ−1
Ms2)
+(1−h(p′
WM))g(pMW;fD
W(p′
MW),ρ−1
Ws2)g(pMM;fD
M(p′
MM),ρ−1
Ms2)}
×/summationdisplay
jqMjg(p′
MW;µMWj,ρ−1
Wσ2
MWj)g(p′
MM;µMMj,ρ−1
Mσ2
MMj)dp′
MWdp′
MM
≃/summationdisplay
jqMj/integraldisplay∞
−∞/integraldisplay∞
−∞{h(µWMj)g(pMW;fC
W(p′
MW),ρ−1
Ws2)g(pMM;fC
M(p′
MM),ρ−1
Ms2)
+(1−h(µWMj))g(pMW;fD
W(p′
MW),ρ−1
Ws2)g(pMM;fD
M(p′
MM),ρ−1
Ms2)}
×/summationdisplay
jqMjg(p′
MW;µMWj,ρ−1
Wσ2
MWj)g(p′
MM;µMMj,ρ−1
Mσ2
MMj)dp′
MWdp′
MM
=/summationdisplay
jqMj{h(µWMj)g(pMW;fC
W(µMWj),ρ−1
W(s2+(∆fC
W)2σ2
MWj))g(pMM;fC
M(µMMj),ρ−1
M(s2+(∆fC
M)2σ2
MMj))}
+(1−h(µWMj))g(pMW;fD
W(µMWj),ρ−1
W(s2+(∆fD
W)2σ2
MWj))g(pMM;fD
M(µMMj),ρ−1
M(s2+(∆fD
M)2σ2
MMj))}.
(17)
This equation gives a constraint for ( qMj,µMWj,σ2
MWj,µMMj,σ2
MMj).
To solve (16), let us consider a set of solutions {(µWWj,µWMj)}j. From the equilibrium condition of (16), the
equal set must be restored by applying C-map and D-map to all t he elements of the set. In other words, the condition
16is given by
{(µWWj,µWMj)}j={(fC
W(µWWj),fC
M(µWMj))}j∪{(fD
W(µWWj),fD
M(µWMj))}j. (18)
Similarly, toobtaintheequilibriumconditionfor(17), we shouldconsiderasetofsolutions {(µMWj,µMMj)}jsatisfying
{(µMWj,µMMj)}j={(fC
W(µMWj),fC
M(µMMj))}j∪{(fD
W(µMWj),fD
M(µMMj))}j. (19)
Here, although the appearance of the variables are diﬀerent , the problems are essentially between (18) and (19).
Thus, the problem to be solved is
{(µj,W,µj,M)}j={(fC
W(µj,W),fC
M(µj,M))}j∪{(fD
W(µj,W),fD
M(µj,M))}j. (20)
Furthermore, because W ,M∈ S, we can generalize the problem as
{(µj,S01,···,µj,S16)}j={(fC
S01(µj,S01),···,fC
S16(µj,S16))}j∪{(fD
S01(µj,S01),···,fD
S16(µj,S16))}j.(21)
Now, for all Sk∈ Sand, let us consider a set {µj,Sk}j∈Z\{0}satisfying
µ+1,Sk=fC
Sk(µ−1,Sk) =fC
Sk(µ−2,Sk) =···, (22)
µ+(j+1),Sk=fC
Sk(µ+j,Sk), (23)
µ−1,Sk=fD
Sk(µ+1,Sk) =fD
Sk(µ+2,Sk) =···, (24)
µ−(j+1),Sk=fD
Sk(µ−j,Sk), (25)
(the proof for these equations will be given later). This set {µj,Sk}j∈Z\{0}gives a solution to problem (21), and
thus solves (16) and (17). In (22)-(25), we consistently lab el eachµj,Sksuch that sequentially applying C-map (resp.
D-map) j(>0) times leads to label + j(resp.−j) (see the illustration in Fig. 1). In the following, we show t hat such
{µj,Sk}j∈Z\{0}actually exists for all k.
1. When neither C-map nor D-map is constant: First, we consider a case of ∆ fC
Sk/\e}atio\slash= 0 and ∆ fD
Sk/\e}atio\slash= 0.
Four norms of k= 06,07,09,10 correspond to this case. In this case, C-map and D-map have the same ﬁxed point (at
1/2). Only the position given by this ﬁxed point is achieved at a n equilibrium. Indeed, if we substitute µj,Sk= 1/2
for allj∈Z\{0}, (22)-(25) are simultaneously satisﬁed without any contra diction.
2. When both C-map and D-map are constant: Second, we consider a case of ∆ fC
Sk= 0 and ∆ fD
Sk= 0.
Four norms of k= 01,04,13,16 correspond to this case. Because fC
Skis a constant map, (22) and (23) are satisﬁed
by substituting the mapped value of this map into µ+j,Skfor allj= 1,2,···. In the same way, because fD
Skis a
constant map, (24) and (25) are satisﬁed by substituting the mapped value into µ−j,Skfor allj= 1,2,···. Thus, no
contradiction occurs.
3. When only C-map is constant: Third, we consider a case of ∆ fC
Sk= 0 and ∆ fD
Sk/\e}atio\slash= 0. Four norms
k= 02,03,14,15 correspond to this case. Because fC
Skis a constant map, (22) and (23) are satisﬁed by substituting
the mapped value of this map into µ+j,Skfor allj= 1,2,···. Then, we deﬁne µ−1,Skas the value to which D-map
maps all the same value µ+1,Sk=µ+2,Sk=···, and (24)is satisﬁed. Finally, we sequentially deﬁne µ−2,Sk,µ−3,Sk,···
by applying D-map to µ−1,Skone by one. Thus, no contradiction occurs.
4. When only D-map is constant: Finally, we consider a case of ∆ fC
Sk/\e}atio\slash= 0 and ∆ fD
Sk= 0. Four norms
k= 05,08,09,12 correspond to this case. Because fD
Skis a constant map, (24), (25) are satisﬁed by substituting th e
mapped value of this map into µ−j,Skfor allj= 1,2,···. Then, we deﬁne µ+1,Skas the value to which D-map maps
all the same value µ−1,Sk=µ−2,Sk=···, and (24) is satisﬁed. Finally, we sequentially deﬁne µ+2,Sk,µ+3,Sk,···by
applying C-map to µ+1,Skone by one. Thus, no contradiction occurs.
As summarized in Table 2, the set {µj,Sk}j∈Z\{0}can be analytically described. Furthermore, we also deﬁne
σ2
j,Skas the variance in Gaussian corresponding to the mean µj,Sk. Similarly to the mean values above, we solve the
variances as
(σ2
WWj,σ2
WMj) = (σ2
MWj,σ2
MMj) = (σ2
j,W,σ2
j,M). (26)
The recursion that the set {σ2
j,Sk}j∈Z\{0}should satisfy is
σ2
+1,Sk=s2+(∆fC
Sk)2σ2
−1,Sk=s2+(∆fC
Sk)2σ2
−2,Sk=···, (27)
σ2
+(j+1),Sk=s2+(∆fC
Sk)2σ2
+j,Sk, (28)
σ2
−1,Sk=s2+(∆fD
Sk)2σ2
+1,Sk=s2+(∆fD
Sk)2σ2
+2,Sk=···, (29)
σ2
−(j+1),Sk=s2+(∆fD
Sk)2σ2
−j,Sk, (30)
17Sk µ+j,Sk µ−j,Sk σ2
+j,Skσ2
−j,Sk
S01 1−e2 1−e2e2(1−e2)
Ne2(1−e2)
N
S02 1−e21+(1−2e2)j+1
2e2(1−e2)
N1−(1−2e2)2(j+1)
4N
S03 1−e21−{−(1−2e2)}j+1
2e2(1−e2)
N1−(1−2e2)2(j+1)
4N
S04 1−e2 e2e2(1−e2)
Ne2(1−e2)
N
S051+(1−2e2)j+1
21−e21−(1−2e2)2(j+1)
4Ne2(1−e2)
N
S071
21
21
4N1
4N
S081−(1−2e2)j+1
2e21−(1−2e2)2(j+1)
4Ne2(1−e2)
N
S091−{−(1−2e2)}j+1
21−e21−(1−2e2)2(j+1)
4Ne2(1−e2)
N
S121+{−(1−2e2)}j+1
2e21−(1−2e2)2(j+1)
4Ne2(1−e2)
N
S13 e2 1−e2e2(1−e2)
Ne2(1−e2)
N
S14 e21−(1−2e2)j+1
2e2(1−e2)
N1−(1−2e2)2(j+1)
4N
S15 e21+{−(1−2e2)}j+1
2e2(1−e2)
N1−(1−2e2)2(j+1)
4N
S16 e2 e2e2(1−e2)
Ne2(1−e2)
N
Table 2: Analytical solution of Gaussian functions. We omit S06,S10, andS11because the results are
identical to those of S07(SJ).
18andthesolutionexistsforall Sk(seeTable.2forthesolutionoftheseequations). Table.2s hows{(µj,Sk,σ2
j,Sk)}j∈Z\{0}.
We also calculate a set of the masses of Gaussian functions, i .e.,{qWj}j∈Z\{0}and{qMj}j∈Z\{0}. By substituting
the values in Table 2 into (16), we obtain the following relat ional expressions
qW+1=∞/summationdisplay
j=1h(µ−j,W)qW−j, (31)
qW+j=h(µ+(j−1),W)qW+(j−1)(j= 2,···,∞), (32)
qW−1=∞/summationdisplay
j=1(1−h(µ+j,W))qW+j, (33)
qW−j= (1−h(µ−(j−1),W))qW−(j−1)(j= 2,···,∞). (34)
Similarly, by substituting the values in Table 2 into (17), w e obtain
qM+1=∞/summationdisplay
j=1h(µ−j,M)qW−j, (35)
qM+j=h(µ+(j−1),M)qW+(j−1)(j= 2,···,∞), (36)
qM−1=∞/summationdisplay
j=1(1−h(µ+j,M))qW+j, (37)
qM−j= (1−h(µ−(j−1),M))qW−(j−1)(j= 2,···,∞). (38)
(31)-(38) includes the inﬁnite summations. Because these i nﬁnite summation cannot be analytically calculated, one
should set a cutoﬀ of the summations in the numerical calcula tion of (31)-(38).
Fig. 2-B in the main manuscript shows an example of Φ∗
W(pWW,pWM). In this example, the elements in
{(µj,W,µj,M)}j∈Z\{0}are all diﬀerent for diﬀerent j, and thus the labeling in this study is at least necessary for
the description of the reputation structure. This ﬁgure als o shows that the obtained analytical solutions well approx-
imate simulations of the image matrix.
S3 Calculation of expected payoﬀ
In order to consider an evolutionary process, we derive expe cted payoﬀs of wild-types W and mutants M from joint
probability distribution of goodnesses, i.e., Φ∗
Wand Φ∗
M. In the limit that mutants are rare δ→0, the expected
payoﬀs of the wild-types uWand mutants uMare given by
uW= (b−c)¯pWW,
uM=b¯pMW−c¯pWM,(39)
Here, ¯pAA′indicates the average goodnesses of pAA′, i.e., described as
¯pWW=/integraldisplay1
0/integraldisplay1
0pWWΦ∗
W(pWW,pWM)dpWWdpWM,
¯pWM=/integraldisplay1
0/integraldisplay1
0pWMΦ∗
W(pWW,pWM)dpWWdpWM,
¯pMW=/integraldisplay1
0/integraldisplay1
0pMWΦ∗
M(pMW,pMM)dpMWdpMM,(40)
This average goodness can be analytically calculated by Gau ssian approximation of Φ∗
A(pAW,pAM). According to the
conditions for the ESS, mutants can invade the population of wild-types if uW> uM.
Regions where a mutant norm can invade a wild-type norm are gi ven by Fig. 2. From this ﬁgure, we can obtain
the invasibilities for a certain b/c, as shown in Fig. 3-A in the main manuscript.
19FIG. S 2: Regions for possible invasions in the evolutionary processe s. The row and column indicate the
wild-type and mutant norms, respectively. The matrix shows the re gion ofb/c(>1) where the mutant
invades the wild-type. In some pairs of wild-type and mutant norms, the mutant always or never succeeds
in invading the wild-types for all b/c(>1). The calculation is based on e1= 0 and e2= 0.1.
20S4 Calculation of equilibrium state in public reputation
In this section, we derive the equilibrium distribution of r eputations under public assessment, based on the previous
study [28]. The basic setting is the same whether the reputat ion is publicly shared or privately held. We assume a
population of size Nwhich consists of mutants with norm M and wild-type individu als with norm W /\e}atio\slash= M. A donor
and a recipient are randomly chosen every round. The donor ch ooses cooperation to the good recipient and defection
to the bad recipient. Here, the donor erroneously chooses th e opposite action to the intended one with probability
0≤e1<1/2. Then, all the individuals update their reputations of the donor. The diﬀerence between the public and
private reputation cases is seen in the observers’ ways to up date reputations. We assume that one mutant observer
and one wild-type observer are chosen as representatives of each norm, and each gives a good or bad reputation to
the donor according to its norm. Here, each representative o bserver commits an assignment error independently, in
which case it erroneously assigns the opposite reputation t o the intended one with probability 0 < e2<1/2. (such
an assessment error was not assumed in [28]) Then, all the ind ividuals with the same norm copy the reputation of
the donor assigned by their representative. Thus, the reput ation of the same individual, even an erroneously assigned
one, is shared among all the individuals with the same norm. I n other words, each individual at any given time has
two reputations, one is shared by all the mutant individuals , and the other is shared by all the wild-type individuals
in the population.
Here we speciﬁcally consider the situation where rare mutan ts with norm M = S16(ALLB) invades a wild-type
population with norm W /\e}atio\slash= M. We use the same deﬁnition of pAA′, i.e., goodness of an individual with norm Ain
the eyes of norm A′users. Because reputations are public, pAA′can be either 1 (the individual is assigned as good
from all) or 0 (the individual is assigned as bad from all). Be low we will derive ¯ pAA′, the probability that a norm A
user has a good reputation in the eyes of norm A′users.
Since the mutant norm is ALLB, the probability that mutants a ssign a good reputation to the donor is always
aGC
M=aBC
M=aGD
M=aBD
M=e2. Thus we obtain ¯ pWM= ¯pMM=e2.
Next we aim to solve the equilibrium average goodnesses in th e eyes of wild-types, ¯ pWWand ¯pMW. First, let us
calculate ¯ pWW, which is relevant when the donor and the observer use norm W. Note that we can assume that the
recipient uses norm W, because mutants are rare. ¯ pWWshould satisfy
¯pWW= ¯pWW{(1−e1)aGC
W+e1aGD
W}+(1−¯pWW){e1aBC
W+(1−e1)aBD
W}, (41)
The equality between the left- and right-hand sides shows th at the proportion of good individuals balances before and
after updating the chosen donor’s reputation. In the right- hand side, ¯ pWWand 1−¯pWWin the ﬁrst and the second
terms indicate the probabilities that a randomly chosen rec ipient of norm W is good or bad from the viewpoint of
norm W, respectively. When the recipient is good, the donor c hooses cooperation or defection with probabilities
(1−e1) ande1. Then, aGC
WandaGD
Windicate the probabilities that the cooperating or defecti ng donor receives a
good reputation from observers of norm W. When the recipient is bad, the donor chooses cooperation or defection
with probabilities e1and (1−e1). Then, aBC
WandaBD
Windicate the probabilities that the cooperating or defecti ng
donor receives a good reputation from observers of norm W. Th e solution is
¯pWW=(1−e1)aBD
W+e1aBC
W
1−{(1−e1)(aGC
W−aBD
W)+e1(aGD
W−aBC
W)}. (42)
Second, let us calculate ¯ pMW, which is relevant when the donor uses norm M and the observer uses norm W.
Note that we can once again assume that the recipient uses nor m W because mutants are rare. ¯ pMWshould satisfy
¯pMW= ¯pWW{h(e2)aGC
W+(1−h(e2))aGD
W}+(1−¯pWW){h(e2)aBC
W+(1−h(e2))aBD
W}. (43)
Here, ¯pWWand (1−¯pWW) in the ﬁrst and second terms of the right-hand side indicate the probabilities that the
recipient is good or badfrom the viewpoint of norm W, respect ively. In bothterms, h(e2)(=e2(1−e1)+(1−e2)e1)and
1−h(e2) are the probabilities that the donor with norm M executes co operation or defection, which is independent
of whether the recipient is good or bad from the viewpoint of n orm W. In the ﬁrst term, aGC
WandaGD
Windicate the
probabilities that the cooperating and defecting donor rec eives a good reputation from the observers of norm W. In
the second term, aBC
WandaBD
Windicate the probabilities that the cooperating and defect ing donor receives a good
reputation from the observers of norm W.
We summarize the solutions, ¯ pWWand ¯pMW, in Table 3.
21Sk ¯pWW ¯pMW ¯pWW|e1=0 ¯pMW|e1=0
S01 1−e2 = 1−e2 1−e2 1−e2
S02e1+e2−2e1e2
e1+2e2−2e1e2<e1+e2−2e1e2+e22−2e1e22−2e32+4e1e32
e1+2e2−2e1e21
21
2+1
2e2−e22
S031−e2
1+e1−2e1e2>(1−e2)(2e1+3e2−6e1e2−2e22+4e1e22)
1+e1−2e1e21−e23e2−5e22+2e32
S041
2> e1+2e2−4e1e2−2e22+4e1e221
22e2−2e22
S051−e1−e2+2e1e2
1−e1+2e1e2>1−e1−e2+2e1e2−e22+2e1e22+2e32−4e1e32
1−e1+2e1e21−e21−e2−e22+2e32
S061
2=1
21
21
2
S071−e1−e2+2e1e2>2e1+3e2−2e21−12e1e2−6e22+12e21e2+24e1e22+4e32−24e21e22−16e1e32+16e21e32
1−e23e2−6e22+4e32
S08e2
e1+2e2−2e1e2>e2(2e1+3e2−6e1e2−2e22+4e1e22)
e1+2e2−2e1e21
23
2e2−e22
S091−e2
2−e1−2e2+2e1e2<(1−e2)(2−2e1−3e2+6e1e2+2e22−4e1e22)
2−e1−2e2+2e1e21
21−3
2e2+e22
S10e1+e2−2e1e2<2e1+3e2−2e21−12e1e2−6e22+12e21e2+24e1e22+4e32−24e21e22−16e1e32+16e21e32
e23e2−6e22+4e32
S111
2=1
21
21
2
S12e1+e2−2e1e2
1+e1−2e1e2<e1+2e2−4e1e2−3e22+6e1e22+2e32−4e1e32
1+e1−2e1e2e22e2−3e22+2e32
S131
2< 1−e1−2e2+4e1e2+2e22−4e1e221
21−2e2+2e22
S14e2
1−e1+2e1e2<e2(2−2e1−3e2+6e1e2+2e22−4e1e22)
1−e1+2e1e2e22e2−3e22+2e32
S151−e1−e2+2e1e2
2−e1−2e2+2e1e2>1−e1−2e2+4e1e2+3e22−6e1e22−2e32+4e1e32
2−e1−2e2+2e1e21
21
2−1
2e2+e22
S16 e2 = e2 e2 e2
Table 3: Analytical solution of reputation structure under public as sessment. Here, the equality (i.e., =) and inequality (i.e., >or<) signs show the
relations between ¯ pWWand ¯pMWfor all of 0 ≤e1<1/2 and 0< e2<1/2.
22Based on Table 3, we can see how the reputation structure diﬀe rs between the public and private reputation cases.
The reputation structure for norms S03(SS) and S07(SJ) are illustrated in Fig. 3-D and E in the main manuscript,
while that of S08(SH) is in Fig. 3.
FIG. S 3: Illustration of how the wild-type SH gives reputations to th e self and mutant ALLB norms. In
each panel, the horizontal and vertical axes indicate the goodnes s and its frequency, respectively. Positions
and heights of bars are correct only up to order e2
2. By comparing the upper panels with the lower ones, we
can see that the reputation from SH diﬀers signiﬁcantly between th e public and private reputation cases.
In the private reputation case, SH still manages to distinguish the s elf norm with ALLB, but only with the
diﬀerence of order of e2
2.
23S5 Numerical algorithm and error estimate
This section provides how to computationally calculate (31 )-(34) and (35)-(38) with suﬃcient accuracy.
Instead of (31)-(34), we aim to compute
QW+1:= 1, (44)
QW+j:=h(µ+(j−1),W)QW+(j−1)(j= 2,···,∞), (45)
QW−1:=∞/summationdisplay
j=1(1−h(µ+j,W))QW+j, (46)
QW−j:= (1−h(µ−(j−1),W))QW−(j−1)(j= 2,···,∞), (47)
(see Fig. 4 for the illustration of this computation). Via th ese equations, we obtain qWjby rescaling QWjas
qWj=QWj/summationtext±∞
k=±1QWk, (48)
which satisﬁes (31)-(34). We should also obtain average goo dnesses
¯pWA=/summationtext±∞
j=±1QWjµj,A/summationtext±∞
j=±1QWj, (49)
in order to obtain Fig. 2.
In a practical computer simulation, we approximate (44)-(4 7) by
ˆQW+1:= 1, (50)
ˆQW+j:=h(µ+(j−1),W)ˆQW+(j−1)(j= 2,···,jmax), (51)
ˆQW+j:= 0 (j=jmax+1,···,∞), (52)
ˆQW−1:=∞/summationdisplay
j=1(1−h(µ+j,W))ˆQW+j=jmax/summationdisplay
j=1(1−h(µ+j,W))ˆQW+j, (53)
ˆQW−j:= (1−h(µ−(j−1),W))ˆQW−(j−1)(j= 2,···,jmax), (54)
ˆQW−j:= 0 (j=jmax+1,···,∞), (55)
with suﬃcient large jmax(= 104) (see Fig. 4 for the illustration of this computation). We wi ll show below that these
computationally obtained ˆQWjwell approximate QWj. Note that in the following calculations we use the fact that
e2≤µj,A≤1−e2 (56)
holds for all j=±1,···,±∞andA.
FIG. S 4: An illustration of numerical algorithm and error estimation o f the masses. The black and gray
arrows show how theoretical calculations of (44)-(47) are perfo rmed, whereas only black arrows are relevant
in the computation of (50)-(55). Each box shows the size of QWj. The gray part in each box shows the size
of approximation error, QWj−ˆQWj. Apart from QWj, the area surrounded by dots show the calculation of
QM+1.
24From the deﬁnition, we obtain
QW+j−ˆQW+j= 0 (j= 1,···,jmax). (57)
Then, we obtain
QW+j=QW+1j−1/productdisplay
k=1µ+k,W≤(1−e2)j−1, (58)
⇒∞/summationdisplay
j=jmax+1(QW+j−ˆQW+j) =∞/summationdisplay
j=jmax+1QW+j≤∞/summationdisplay
j=jmax+1(1−e2)j−1=1
e2(1−e2)jmax. (59)
Then, we have
QW−1=∞/summationdisplay
j=1QW+j(1−µ+j,W) =jmax/summationdisplay
j=1QW+j(1−µ+j,W)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
=ˆQW−1+∞/summationdisplay
j=jmax+1QW+j(1−µ+j,W)≤ˆQW−1+1
e2(1−e2)jmax,
(60)
⇒QW−j=QW−1j−1/productdisplay
k=1(1−µ−k,W) =ˆQW−1j−1/productdisplay
k=1(1−µ−k,W)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
=ˆQW−j+(QW−1−ˆQW−1)j−1/productdisplay
k=1(1−µ−k,W)≤ˆQW−j+1
e2(1−e2)jmax+j−1,
(61)
⇒jmax/summationdisplay
j=1(QW−j−ˆQW−j)≤1
e2
2(1−e2)jmax, (62)
We also obtain
QW−1=∞/summationdisplay
j=1QW+j(1−µ+j,W)≤∞/summationdisplay
j=1QW+j≤1
e2, (63)
⇒QW−j=QW−1j−1/productdisplay
k=1(1−µ−k,W)≤1
e2(1−e2)j−1, (64)
⇒∞/summationdisplay
j=jmax+1(QW−j−ˆQW−j) =∞/summationdisplay
j=jmax+1QW−j≤∞/summationdisplay
j=jmax+11
e2(1−e2)j−1=1
e2
2(1−e2)jmax. (65)
From the above error estimations, we can obtain upper and low er bounds of (48) and (49) as
ˆQWj/summationtext±jmax
j=±1ˆQWj+3
e2
2(1−e2)jmax≤qWj≤ˆQWj+1
e2(1−e2)jmax
/summationtext±jmax
j=±1ˆQWj. (66)
/summationtext±jmax
j=±1ˆQWjµj,A
/summationtext±jmax
j=±1ˆQWj+3
e2
2(1−e2)jmax≤¯pWA≤/summationtext±jmax
j=±1ˆQWjµj,A+3
e2
2(1−e2)jmax
/summationtext±jmax
j=±1ˆQWj. (67)
25Here, we used
ˆQWj≤QWj=ˆQWj+(QWj−ˆQWj) (68)
≤ˆQWj+ max
j(QWj−ˆQWj)
/bracehtipupleft/bracehtipdownright/bracehtipdownleft /bracehtipupright
=QW−1−ˆQW−1≤1
e2(1−e2)jmax≤ˆQWj+1
e2(1−e2)jmax, (69)
±jmax/summationdisplay
j=±1ˆQWj≤±∞/summationdisplay
j=±1QWj=±jmax/summationdisplay
j=±1ˆQWj+±∞/summationdisplay
j=±1(QWj−ˆQWj) (70)
=±jmax/summationdisplay
j=±1ˆQWj+jmax+1/summationdisplay
j=1(QWj−ˆQW−j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax+∞/summationdisplay
j=jmax+1(QW+j−ˆQW+j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2(1−e2)jmax+∞/summationdisplay
j=jmax+1(QW−j−ˆQW−j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax
(71)
≤±jmax/summationdisplay
j=±1ˆQWj+3
e2
2(1−e2)jmax, (72)
±jmax/summationdisplay
j=±1ˆQWjµj,A≤±∞/summationdisplay
j=±1QWjµj,A≤±jmax/summationdisplay
j=±1ˆQWjµj,A+±∞/summationdisplay
j=±1(QWj−ˆQWj) (73)
≤±jmax/summationdisplay
j=±1ˆQWjµj,A+3
e2
2(1−e2)jmax. (74)
In the same way, let us consider (35)-(38) and compute
QM+1:=∞/summationdisplay
j=1h(µ−j,M)QW−j, (75)
QM+j:=h(µ+(j−1),M)QW+(j−1)(j= 2,···,∞), (76)
QM−1:=∞/summationdisplay
j=1(1−h(µ+j,M))QW+j, (77)
QM−j:= (1−h(µ−(j−1),M))QW−(j−1)(j= 2,···,∞). (78)
Via these equations, we obtain qWjby rescaling QMjas
qMj=QMj/summationtext±∞
k=±1QMk, (79)
which satisﬁes (35)-(38). We also need to obtain average goo dnesses
¯pMA=/summationtext±∞
j=±1QMjµj,A/summationtext±∞
j=±1QMj, (80)
in order to obtain Fig. 2.
In a practical computer simulation, we approximate (75)-(7 8) by
ˆQM+1:=∞/summationdisplay
j=1h(µ−j,M)ˆQW−j=jmax/summationdisplay
j=1h(µ−j,M)ˆQW−j, (81)
ˆQM+j:=h(µ+(j−1),M)ˆQW+(j−1)(j= 2,···,jmax), (82)
ˆQM+j:= 0 (j=jmax+1,···,∞), (83)
ˆQM−1:=∞/summationdisplay
j=1(1−h(µ+j,M))ˆQW+j=jmax/summationdisplay
j=1(1−h(µ+j,M))ˆQW+j, (84)
ˆQM−j:= (1−h(µ−(j−1),M))ˆQW−(j−1)(j= 2,···,jmax), (85)
ˆQM−j:= 0 (j=jmax+1,···,∞), (86)
26with suﬃcient large jmax(= 104).
By exactly similar calculations, we obtain
QM+j−ˆQM+j= 0 (j= 2,···,jmax), (87)
∞/summationdisplay
j=jmax+1(QM+j−ˆQM+j)≤1
e2(1−e2)jmax, (88)
jmax/summationdisplay
j=1(QM−j−ˆQM−j)≤1
e2
2(1−e2)jmax, (89)
∞/summationdisplay
j=jmax+1(QM−j−ˆQM−j)≤1
e2
2(1−e2)jmax. (90)
The diﬀerence from QWjexists only in j= +1, as
QM+1=∞/summationdisplay
j=1QW−jµ−j,M=jmax/summationdisplay
j=1ˆQW−jµ−j,M
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
=ˆqM+1+jmax/summationdisplay
j=1(QW−j−ˆQW−j)µ−j,M
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax+∞/summationdisplay
j=jmax+1ˆQW−jµ−j,M
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax(91)
≤ˆQM+1+2
e2
2(1−e2)jmax, (92)
(see the area surrounded by dots in Fig. 4 for the illustratio n of this computation).
From the above error estimations, we can obtain upper and low er bounds of (79) and (80) as
ˆQMj/summationtext±jmax
j=±1ˆQMj+5
e2
2(1−e2)jmax≤qMj≤ˆQMj+2
e2
2(1−e2)jmax
/summationtext±jmax
j=±1ˆQMj, (93)
/summationtext±jmax
j=±1ˆQMjµj,A
/summationtext±jmax
j=±1ˆQMj+5
e2
2(1−e2)jmax≤¯pMA≤/summationtext±jmax
j=±1ˆQMjµj,A+5
e2
2(1−e2)jmax
/summationtext±jmax
j=±1ˆQMj. (94)
Here, we used
ˆQMj≤QMj=ˆQMj+(QMj−ˆQMj) (95)
≤ˆQMj+ max
j(QMj−ˆQMj)
/bracehtipupleft/bracehtipdownright/bracehtipdownleft /bracehtipupright
=QM+1−ˆQM+1≤1
e2
2(1−e2)jmax≤ˆQMj+1
e2
2(1−e2)jmax,(96)
±jmax/summationdisplay
j=±1ˆQMj≤±∞/summationdisplay
j=±1QMj=±jmax/summationdisplay
j=±1ˆQMj+(QM+1−ˆQM+1)/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
≤2
e2
2(1−e2)jmax+jmax/summationdisplay
j=1(QM−j−ˆQM−j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax(97)
+∞/summationdisplay
j=jmax+1(QM+j−ˆQM+j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2(1−e2)jmax+∞/summationdisplay
j=jmax+1(QM−j−ˆQM−j)
/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
≤1
e2
2(1−e2)jmax(98)
≤±jmax/summationdisplay
j=±1ˆQMj+5
e2
2(1−e2)jmax, (99)
±jmax/summationdisplay
j=±1ˆQMjµj,A≤±∞/summationdisplay
j=±1QMjµj,A≤±jmax/summationdisplay
j=±1ˆQMjµj,A+±∞/summationdisplay
j=±1(QMj−ˆQMj) (100)
≤±jmax/summationdisplay
j=±1ˆQMjµj,A+5
e2
2(1−e2)jmax. (101)
27