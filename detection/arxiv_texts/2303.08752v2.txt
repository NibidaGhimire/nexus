Version November 7, 2023
Preprint typeset using L ATEX style openjournal v. 09/06/15
THE HALO MODEL FOR COSMOLOGY: A PEDAGOGICAL REVIEW
M. Asgari1,2,3∗, A. J. Mead4,3†, and C. Heymans3,4
1E. A. Milne Centre, University of Hull, Cottingham Road, Hull, HU6 7RX, UK
2Centre of Excellence for Data Science, AI, and Modelling (DAIM), University of Hull, Cottingham Road, Hull, HU6 7RX, UK
3Institute for Astronomy, University of Edinburgh, Royal Observatory, Blackford Hill, Edinburgh, EH9 3HJ, UK
4Ruhr University Bochum, Faculty of Physics and Astronomy, Astronomical Institute (AIRUB), German Centre for Cosmological
Lensing, 44780 Bochum, Germany
Version November 7, 2023
ABSTRACT
We present a pedagogical review of the halo model, a flexible framework that can describe the distribu-
tion of matter and its tracers on non-linear scales for both conventional and exotic cosmological models.
We start with the premise that the complex structure of the cosmic web can be described by the sum
of its individual components: dark matter, gas, and galaxies, all distributed within spherical haloes
with a range of masses. The halo properties are specified through a series of simulation-calibrated
ingredients including the halo mass function, non-linear halo bias and a dark matter density profile
that can additionally account for the impact of baryon feedback. By incorporating a model of the
galaxy halo occupation distribution, the properties of central and satellite galaxies, their non-linear
bias and intrinsic alignment can be predicted. Through analytical calculations of spherical collapse
in exotic cosmologies, the halo model also provides predictions for non-linear clustering in beyond-
ΛCDM models. The halo model has been widely used to model observations of a variety of large-scale
structure probes, most notably as the primary technique to model the underlying non-linear matter
power spectrum. By documenting these varied and often distinct use cases, we seek to further coherent
halo model analyses of future multi-tracer observables. This review is accompanied by the release of
pyhalomodel , flexible software to conduct a wide range of halo-model calculations.
Keywords: Cosmology, large-scale structures
CONTENTS
1. Introduction 1
2. The halo model basics 3
2.1. Standard derivation 3
2.1.1. The one-halo term 5
2.1.2. The two-halo term 5
2.2. Discrete tracers 6
2.3. Matter 7
3. Selecting the ingredients 8
3.1. Preliminary definitions 9
3.2. Halo mass function 9
3.3. Linear halo bias 10
3.4. Non-linear halo bias 11
3.5. Dark matter halo profiles 12
3.6. Baryonic feedback 13
3.7. Modelling the matter power spectrum 14
3.7.1. halofit 14
3.7.2. hmcode 14
4. Modelling tracers 14
4.1. Galaxies 15
4.2. Intrinsic Alignments of Galaxies 16
∗m.asgari@hull.ac.uk
†alexander.j.mead@googlemail.com4.3. Thermal Sunyaev-Zeldovich effect 17
4.4.X-rays 17
4.5. Cosmic Infrared Background 17
4.6. Neutral hydrogen 18
4.7.γ-rays 18
5. Extensions to the standard halo model 18
5.1. Smooth matter 19
5.2. Voids 19
5.3. Perturbation theory 19
5.4. Excess large-scale power 20
5.5. Halo compensation 20
5.6. Halo exclusion 20
5.7. Halo asphericity and substructure 21
5.8. Scatter in halo properties and assembly bias 22
6. Modelling beyond- ΛCDM cosmologies 22
6.1. Ingredients measured from simulations 22
6.2. Spherical collapse 23
6.3.react 24
7. Software 24
8. Summary 25
1.INTRODUCTIONarXiv:2303.08752v2  [astro-ph.CO]  6 Nov 20232
On large scales, and at early times, matter fluctuations
are small and can be described using linear perturbation
theory; the evolution of small perturbations can be solved
analytically. Once fluctuations become more developed,
however, their properties can no longer be explained by
linearised equations, and instead a full non-linear treat-
ment is needed. The halo model provides an intuitive
way to approximate the matter distribution in the non-
linear regime. It posits that all matter resides in haloes,
which are O(100) times denser than the cosmological av-
erage – a view that has been largely corroborated by
numerical simulations. Once the properties and distri-
bution of these haloes are known, one can estimate the
statistical properties of the matter distribution in the
cosmos. To be concrete, power spectra for matter and
its tracers can be understood as the sum of two com-
ponents: inter-halo (two-halo) and intra-halo (one-halo)
clustering. The halo model, therefore, can (and has) been
used in analysing cosmological data from various probes
of large-scale structure.
The statistical properties of any tracer of matter can
also be modelled, provided that the connection between
the tracer and host haloes is known. If haloes are taken
to be the sites of galaxy formation, all that is needed to
model the galaxy clustering signal is how galaxies occupy
haloes of different masses. The problem then can be split
into how galaxies cluster within the same halo and how
different haloes, which might include varying numbers of
galaxies, cluster with respect to each other. In principle,
the same logic can be applied to anytracer of the large-
scale structures, as long as the signal from the tracer em-
anates from haloes. For example, the thermal Sunyaev-
Zel’dovich (tSZ) effect is sourced by electron pressure,
which is at its most intense within haloes, and so reason-
able models for tSZ clustering, and its cross-correlation
with other tracers, may be derived using the halo model.
The halo properties that are required to make a predic-
tion using the halo model are the halo bias (how haloes
cluster relative to matter), halo mass function (number
density of haloes with different masses), and halo profile
(how matter or its tracers are distributed within a halo).
These ingredients are most often extracted from numeri-
cal simulations and (sometimes) calibrated across a range
of cosmological parameters. It is usual to assume that
haloes are linearly biased, spherical objects with proper-
ties that are only a function of the halo mass, although
these restrictions can be relaxed. We call this method of
using the halo model the “analytical approach”.
There is a second approach to using the halo model, the
“simulation-based approach”: Here, haloes are identified
in a simulation and then ‘painted’ with a specific tracer
(e.g., galaxies), such that the desired clustering prop-
erties can be directly measured. While the analytical
approach is quicker and more flexible, the simulation-
based approach is potentially more accurate, but it is
slower and requires N-body simulations. This can be-
come a problem in cosmological analyses where a wide
range of parameters and/or cosmological models need to
be explored. Once the analytical approach is adjusted
to reach a desired accuracy, it can be extended more
readily to other cosmological parameters and/or models
compared to the simulation based approach.
The halo model has been used in one form or another
to analyse data from weak gravitational lensing by large-scale structure, known as cosmic shear. This is because
cosmic shear relies on information from non-linear mat-
ter distribution. halofit (Smith et al. 2003; Takahashi
et al. 2012) and hmcode (Mead et al. 2015a, 2021) which
have their roots in the halo-model approach (see sec-
tion 3.7) form the basis of all primary analysis of recent
cosmic shear data: Canada France Hawaii Telescope lens-
ing Survey (CFHTLenS, Heymans et al. 2013; Joudaki
et al. 2017), Deep Lens Survey (DLS, Jee et al. 2013),
Kilo Degree Survey (KiDS, Hildebrandt et al. 2017, 2020;
Asgari et al. 2021), Dark Energy Survey (DES, Troxel
et al. 2018; Amon et al. 2022; Secco et al. 2022) and
Hyper Suprime-Cam (HSC, Hikage et al. 2019; Hamana
et al. 2020).
Data from galaxy clustering and the cross-correlation
between weak lensing and galaxy clustering, known as
galaxy–galaxy lensing, have been analysed with a flex-
ible halo model approach to capture information from
smaller scales (for example Cacciato et al. 2013; More
et al. 2015a; Miyatake et al. 2022b; Dvornik et al. 2023).
Tr¨ oster et al. (2022) applied the halo model formalism
of Mead et al. (2020) to the cross-correlation between
tSZ and weak lensing in a cosmological analysis. The
halo model can also predict the intrinsic alignments of
galaxies, which is a prominent astrophysical systematic
in cosmic-shear studies (Schneider & Bridle 2010; For-
tuna et al. 2021).
While data from modern galaxy surveys is most of-
ten modelled using a halo model applied to, or directly
calibrated against simulations, most analyses concerning
cross-correlations of different tracers use the ’vanilla’ halo
model as a first modelling effort (e.g., Komatsu & Seljak
2002; Hill & Spergel 2014; Hurier et al. 2014; Battaglia
et al. 2015; Tr¨ oster et al. 2017; Feng et al. 2017; Os-
ato et al. 2018; Wolz et al. 2019; Koukoufilippas et al.
2020; Yan et al. 2021). The limitations of the analytical
halo-model approach are appreciated and accounted for
when it comes to modelling the galaxy and matter cross-
correlation (galaxy–galaxy lensing), but less well appre-
ciated for other cross correlations where the modelling
and data are less mature. As we will discuss later, these
limitations are a strong function of exactly what one is
trying to model, particularly of the relationship between
tracer strength and halo mass. For these reasons, we feel
that a pedagogical review is useful and timely.
Extracting information about cosmological parameters
and galaxy-occupation statistics via the halo model has
been historically challenging. The simplicity of the an-
alytical halo model, which is appealing from the per-
spective of understanding, can become a problem as the
data to which it is exposed increases in quality. The
halo model should be calibrated against simulations to
check its accuracy, and a failure to do so may result in
incorrect parameter constraints where real signal is mis-
taken for some modelling deficiency. There have been
many attempts to use the halo model to constrain cos-
mological and galaxy–halo parameters (e.g., Tinker et al.
2005; van den Bosch et al. 2013; More et al. 2013; Cac-
ciato et al. 2013; More et al. 2015b; Leauthaud et al.
2017; Zacharegkas et al. 2022). Recent attempts to in-
clude non-linear halo bias (Nishimichi et al. 2019; Mead
& Verde 2021) within the halo model provide a promis-
ing way to improve the accuracy of the halo model to
the extent that it can be trusted to recover cosmological3
parameters and information about the galaxy–halo con-
nection from current (e.g., Mahony et al. 2022; Miyatake
et al. 2022b; Dvornik et al. 2023) and forthcoming sur-
vey data. Another powerful property of the halo model is
that its ingredients can be directly calibrated against real
observations, by allowing for parameters to vary freely in
likelihood analyses (see for example Gu et al. 2023).
The halo model first came to cosmological prominence
at the beginning of the millennium (Seljak 2000; Ma &
Fry 2000; Peacock & Smith 2000) following earlier work
by Scherrer & Bertschinger (1991) and, after a flurry
of related publications, was first reviewed by Cooray &
Sheth (2002). As far as we know, there has been no
subsequent attempt to review the halo model. Here, we
attempt to provide a pedagogical summary of the mod-
ern uses of the halo model with a focus on its cosmologi-
cal applications and the modelling of the auto and cross
power spectra of different fields.
The structure of this review is as follows: In Section 2
we provide a comprehensive derivation of the halo-model
power spectrum in order to highlight the assumptions
lurking behind the model. In Section 3 we discuss the in-
gredients that are necessary to make the halo model pre-
dictive in the case of the matter distribution and how it
is modelled in practice, while in Section 4 we see how the
halo model can be extended for tracers of matter, such as
galaxies. In Section 5 we discuss some non-standard ap-
proaches and improvements to halo modelling that have
appeared over the years. In Section 6 we discuss ap-plications to cosmologies beyond the standard ΛCDM.
In Section 7 we detail the publicly-available software for
performing halo-model calculations, and finally we sum-
marise in Section 8.
2.THE HALO MODEL BASICS
At the core of the halo model is the approximation that
we can fully describe the complex structure of the cos-
mic web simply as a sum of its individual components:
dark matter, gas, and galaxies, all distributed in haloes.
The complexity then translates into the problem of how
to model the profile, mass distribution and bias of these
haloes relative to the underlying (linear-theory) matter
distribution, and how to accurately populate haloes with
gas and galaxies. This ‘mapping information’ can be
motivated by, or extracted from, numerical simulations,
leading to a flexible analytical model of the statistical
properties of the cosmic web. By confronting this model
with observations, the halo-model approach can provide
constraints on the underlying cosmology of the Universe,
in addition to providing unique insight into the halo–
galaxy connection, and furthering our understanding of
galaxy formation and evolution. A schematic of the halo-
model approach is shown in Fig. 1, where the first panel
shows the density field in an N-body simulation, the sec-
ond panel shows this replaced by a spherical halo ap-
proximation, and the final panel shows a possible galaxy
distribution.
2.1.Standard derivation
We start by defining a field in real space, θu(x), where xis the three-dimensional comoving position and the label
u stands for the field we are interested in modelling. Fields are also a function of time, usually parameterised via z,
but we suppress this argument here and throughout this paper to make the notation less cluttered. Examples of such
fields would be ‘matter’, ‘halo’ or ‘galaxy’ over-densities that vary from place-to-place in the Universe. We make the
assumption that everything in our field is contained within haloes distributed throughout the space with a spherically
symmetric profile, Wu,i, centred at position xi, such that
θu(x) =X
iNiWu,i(|x−xi|), (1)
where the sum runs over all volume elements and Ni={0,1}determines whether there is a halo centre in that volume
element. The Fourier transform of the field, in terms of comoving wavenumber k, is given by
ˆθu(k) =Z
θu(x)e−ik·xd3x, (2)
With the variable change r=x−xi,
ˆθu(k) =X
ie−ik·xiNiZ
Wu,i(|r|)e−i|k||r|cosθd3r=X
ie−ik·xiNiˆWu,i(k), (3)
where we have recognised the integral as the Fourier transform of the halo profile, ˆWu,i(k). The spherical symmetry of
the halo profile allows us to integrate over the angular co-ordinates such that the Fourier transform of the halo profile
is given by
ˆWu,i(k) =Z∞
0sin(kr)
krWu,i(r) 4πr2dr . (4)
We assume that the properties of each halo iare defined solely by its mass Mi, such that Wu,i=Wu(Mi, r), and that
the halo masses are distributed according to the halo-mass-distribution function n(M), where n(M) dMis the number
density of haloes with masses between MandM+ dM. With these assumptions we can find the mean value of θu(x)4
Figure 1. A schematic visualisation of the halo-model process. The left-hand panel shows the matter density field in a 25 ×25×5 (h−1Mpc)3
region of an N-body simulation, centred on a massive ( ∼1014.5h−1M⊙) halo identified at z= 0. The central panel shows the result of
isolating all haloes identified in the simulation and replacing these with idealised spherical haloes of the same mass. The right-hand panel
shows the result of populating these haloes with galaxies according to a simple galaxy-occupation prescription.
by averaging over all haloes,
⟨ˆθu(x)⟩=*X
iNiWu(Mi,|x−xi|)+
=Z∞
0dM n(M)Z
d3x′Wu(M,|x−x′|) =Z∞
0dM W u(M)n(M).(5)
where we have translated the ensemble average, including Ni, intoR
dM n(M) ∆Viwith ∆ Videnoting the volume
element. The sum over ican then be converted into an integral over the volume,R
d3x′. To obtain the last equality
in equation (5) we have separated the halo shape information through Wu(M, x) =Wu(M)Uu(M, x), where Uu(M, x)
is the normalised halo profile,Z
d3x Uu(M, x) = 1 . (6)
All the information about the amplitude of the halo profile is contained in Wu(M). Similarly we can define ˆWu(M, k) =
Wu(M)ˆUu(M, k), where ˆUu(M, k) is the Fourier transform of Uu(M, x). From equation (6) we can conclude that
ˆUu(M, k→0) = 1, which implies that ˆWu(M, k→0) = ˆWu(M). We can understand this result by considering that
at large scales a halo acts as a point mass, which translates to a constant in Fourier space.
Next we consider the correlation between two fields, θuandθv, which could be identical, for example matter–matter,
or different, for example matter–galaxies. Our fields are real and translationally invariant such that
⟨θu(x)θv(x′)⟩=ξuv(|x−x′|), (7)
where ξuvis the two point correlation function between the two fields and it only depends on the separation |x−x′|.
In Fourier space we have an equivalent relation for the power spectrum, Puv(k),
⟨ˆθu(k)ˆθ∗
v(k′)⟩= (2π)3δD(k−k′)Puv(k), (8)
where δDis the Dirac delta function. The dimension of the power spectrum in equation (8) is volume times the
dimensions of θuandθv. Therefore we will sometimes use this definition of power spectrum instead
∆2
uv(k) = 4πk
2π3
Puv(k), (9)
which removes the dependence on a volume dimension.
We can find the power spectrum by inserting for the fields from equation (3),
⟨ˆθu(k)ˆθ∗
v(k′)⟩=*X
i,je−ik·xieik′·xjNiNjˆWu,i(M, k)ˆWv,j(M, k′)+
. (10)
We can separate the sums above into two parts: when i=j, we measure field correlations within a single halo,
corresponding to the one-halo term, P1h
uv(k); when i̸=j, we measure field correlations between distinct haloes, called
thetwo-halo term, P2h
uv(k).5
2.1.1. The one-halo term
The one-halo term, where i=jin equation (10), is given by
⟨ˆθu(k)ˆθ∗
v(k′)⟩=*X
ie−i(k−k′)·xiNiˆWu,i(M, k)ˆWv,i(M, k′)+
, (11)
where we have used N2
i=Ni. We take similar steps to what was done in equation (5) to turn the ensemble average
and the sum into continuous integrals,
⟨ˆθu(k)ˆθ∗
v(k′)⟩=Z∞
0dM n(M)Z
d3xe−i(k−k′)·xiˆWu(M, k)ˆWv(M, k′). (12)
The integral over the volume results in a (2 π)3δD(k−k′). Comparing equations (12) to (8) we arrive at the one-halo
power spectrum,
P1h
uv(k) =Z∞
0ˆWu(M, k)ˆWv(M, k)n(M) dM . (13)
Thek→0 limit of the one-halo term is independent of the shape of the halo profile as discussed after equation (6),
Wu(M, k→0)→Wu(M). For this reason at large scales the one-halo term only contributes as a constant P(k),
so-called shot noise.
2.1.2. The two-halo term
The two-halo term is defined when i̸=jin equation (10). This time to turn the sums and the ensemble average
into integrals we need to also consider the correlation between the positions of haloes, ⟨NiNj⟩=ξij
hh(|xi−xj|). We
then follow the same steps as the one-halo term and obtain two integrals over halo masses and two over the volume
elements where these haloes reside,
⟨ˆθu(k)ˆθ∗
v(k′)⟩=Z∞
0dM1Z∞
0dM2n(M1)n(M2)ˆWu(M1, k)ˆWv(M2, k) (14)
×Z
dx3Z
dx′3e−ik·xeik′·x′⟨N(M1,x)N(M2,x′)⟩.
We also know that
Z
dx3Z
dx′3e−ik·xeik′·x′⟨N(M1,x)N(M2,x′)⟩=⟨ˆN(M1,k)ˆN∗(M2,k′)⟩= (2π)3δD(k−k′)Phh(M1, M2, k),(15)
where Phh(M1, M2, k) is the power spectrum of the halo centres with the shot-noise contribution subtracted. Inserting
for the two volume integrals in equation (14) from equation (15) we find the two-halo power spectrum,
P2h
uv(k) =Z∞
0Z∞
0dM1dM2Phh(M1, M2, k)ˆWu(M1, k)ˆWv(M2, k)n(M1)n(M2). (16)
As haloes are biased tracers of the underlying matter field, we can approximate the power spectrum of the halo centres
as
Phh(M1, M2, k) =b(M1)b(M2)Plin
mm(k)[1 + βnl(M1, M2, k)], (17)
where b(M) is the linear bias of haloes with mass M, and Plin
mm(k) is the linear-theory matter power spectrum. The
function βnlthen models all non-linear effects that are missing from the linear-bias–linear-field model, vanishing on
large-scales: βnl(M1, M2, k→0) = 0. With this model we arrive at the two-halo power spectrum
P2h
uv(k) =Plin
mm(k)Inl
uv(k) +Plin
mm(k)Y
n=u,vZ∞
0ˆWn(M, k)b(M)n(M)dM
, (18)
where the non-linear halo bias modelling is captured in the term
Inl
uv(k) =Z∞
0Z∞
0βnl(M1, M2, k)ˆWu(M1, k)ˆWv(M2, k)b(M1)b(M2)n(M1)n(M2) dM1dM2. (19)
It is common to set Inl
uv(k) = 0 for all kand therefore assume that halo bias is linear, as there is no analytical solution
for this term. We will discuss this term in more detail in section 3.4.6
2.2.Discrete tracers
With some small modifications, the theory described in the previous subsection can be applied to discrete tracers,
such as galaxies. Modifications are necessary for two reasons: the first is that there can be a non-negligible scatter in
the number of tracers that occupy haloes of the same mass; the second is that when computing the autocorrelation
of a discrete tracer field, there is an automatic correlation of the field with itself at zero separation, the so-called shot
noise. In configuration space this manifests at r= 0 in the correlation function, but in Fourier space this is spread
evenly over all wavenumbers, resulting in a constant shot noise power spectrum, Psn= 1/¯n, where ¯ nis the mean
tracer number density.
In the following we consider a field of galaxies and in particular the galaxy number density contrast, θu=δg=
(ng−¯ng)/¯ng, although all calculations apply to any discrete tracer. The mean number density of galaxies, ¯ ng, is
defined as
¯ng=⟨ng⟩=Z∞
0dM n(M)Ng(M)Z
d3x Ug(M,|x−x′|) =Z∞
0dM n(M)Ng(M), (20)
where we have followed the same logic as in equation (5). Ng(M) is the number of galaxies occupying a halo of mass
MandUg(M, k) is the normalised distribution of the galaxies within the halo.
Let us first assume that there is no scatter in the halo-occupation distribution (HOD), Ng(M). The temptation
when converting equations (13) and (16) or (18) to be appropriate for discrete tracers is to set
ˆWg(M, k) =Ng(M)
¯ngˆUg(M, k), (21)
This substitution works for the two-halo term, and for cross spectra of discrete tracer populations, but fails when
computing the autospectrum of a discrete tracer field because it fails to take into account the fact that the field
necessarily self correlates. In this case Ngtracers create Ngcontributions to the self correlation or the shot noise.
Importantly, these shot noise terms are independent of the distribution of the tracers, Ug. To arrive at the correct one-
halo expression, we separate the cross galaxy term from the auto galaxy term by subtracting an Ng(M)U2
g(M)n(M)
from the integrand and replacing it with the shot noise contribution, Ng(M)n(M)1,
P1h
gg(k) =1
¯n2gZ∞
0h
Ng(M)(Ng(M)−1)ˆU2
g(M, k) +Ngi
n(M) dM , (22)
this is often written as
P1h
gg(k) =1
¯n2gZ∞
0Ng(M)(Ng(M)−1)ˆU2
g(M, k)n(M) dM+Psn
gg, (23)
where
Psn
gg=1
¯n2gZ∞
0Ng(M)n(M) dM=1
¯ng. (24)
This shot-noise term is often, but not always, subtracted from measured spectra, although it shows up again in the
covariance matrix. Note that in the N→ ∞ limit N2≫Nand equation (22) returns to the form obtainable from
the substitution in equation (21). This limit is appropriate for a general emissive profile, for example matter haloes
taken to be composed from sub-atomic dark-matter particles, or even those from comparatively massive simulation
particles. In this latter case, though the shot noise contribution is a real contribution, it is usually subtracted from
simulation measurements because it is an artefact that arises due to the discretisation-techniques necessarily employed
byN-body simulations.
In contrast, if we consider the cross spectrum between two different discrete populations (g and g′; which may live
in the same haloes), the one-halo term would be
P1h
gg′(k) =1
¯ng¯ng′Z∞
0Ng(M)Ng′(M)ˆUg(M, k)ˆUg′(M, k)n(M) dM , (25)
which is exactly the generalization of the result from the continuous emissivity case. Note that evaluating equation (22)
for haloes that contain Ng= 1 generates a pure shot-noise contribution. It is only when Ng>1 that terms that involve
the halo profile are generated, as one would expect.
When considering galaxy populations, it is usual that the galaxy population is broken down into separate contri-
butions from central galaxies, with occupation number either 0 or 1, and satellite galaxies. It is also usual that some
scatter is accounted for in the occupation numbers at fixed halo mass, which means we must keep the expectation
value from equation (11) to give:
P1h
cc(k) =1
¯n2gZ∞
0⟨Nc(M)⟩n(M) dM; (26)
1Another way to think of this is that if a halo contains only one galaxy, the one-halo term should be pure shot noise, with no dependence
on the halo profile; the N(N−1) term ensures the cancellation of this part of the one-halo term in that case.7
P1h
ss(k) =1
¯n2gZ∞
0h
⟨Ns(M)(Ns(M)−1)⟩ˆU2
s(M, k) +⟨Ns(M)⟩i
n(M) dM; (27)
P1h
cs(k) =1
¯n2gZ∞
0⟨Nc(M)Ns(M)⟩ˆUc(M, k)ˆUs(M, k)n(M) dM . (28)
We have used the fact that the occupation number of the central galaxies is Nc= 0,1 to eliminate the ⟨Nc(Nc−1)⟩
term from equation (26), which leaves a pure shot-noise contribution. It is often taken that the central galaxies lie at
the exact halo centre, in which case ˆUc= 1, but we have left this term, which only enters the central–satellite cross
spectrum, for completeness (some authors consider mis-centring, which can be included via this term). It is often
taken that the central and satellite occupation numbers are independent: ⟨NcNs⟩=⟨Nc⟩⟨Ns⟩or otherwise the ‘central
condition’ is imposed such that satellites can only exist if there is a central galaxy: ⟨NcNs⟩=⟨Ns⟩. It is often assumed
that the satellite occupation is determined by Poisson statistics: ⟨Ns(Ns−1)⟩=⟨Ns⟩2. If shot-noise is subtracted this
eliminates P1h
ccentirely, and also eliminates the term ∝ ⟨Ns⟩in the square bracket in equation (27); this is the most
common form of these equations to be found in the literature. The full galaxy autospectrum can be constructed from
these constituents via
Pgg(k) =Pcc(k) + 2Pcs(k) +Pss(k). (29)
Some expressions similar to equation (29) contain pre-factors of the fraction of galaxies that are centrals or satellites.
We avoid this here by defining the central and satellite fields as overdensity with respect to the total number of
galaxies. Note that it is notpossible to arrive at the same result for Pggby replacing Ng→Nc+NsandUg→Usin
equation (22) because this cannot account for the unique clustering and occupation properties of two distinct galaxy
populations. A common approximate (e.g., Seljak 2000) expression can be obtained by replacing the profile power of 2
in equation (22) with 1 if ⟨Ng⟩≲2 and retaining 2 otherwise. This roughly accounts for the fact that if more than one
satellite is present the one-halo contribution to the power is dominated by the satellite auto correlation (equation 27),
whereas if a single satellite is present then it is dominated by the central–satellite cross correlation (equation 28).
Another reasonable approximation would be to use equation (22) with an occupation-number-weighted halo profile
ˆUg(M, k)≃⟨Nc⟩ˆUc(M, k) +⟨Ns⟩ˆUs(M, k)
⟨Nc⟩+⟨Ns⟩, (30)
together with
⟨Ng(Ng−1)⟩=⟨Ns(Ns−1)⟩+ 2⟨NcNs⟩. (31)
This last equation is always true as long as ⟨Nc(Nc−1)⟩= 0 (i.e. 0 or 1 central galaxy only). The two terms on
the right-hand side of equation (31) can be evaluated following the logic in the paragraph after equation (28). Using
equation (30) in equation (22) is not perfect, but the relative error can be small compared to the proper evaluation of
equations (26–29) depending on the halo-occupation model.
2.3.Matter
Another special case is to evaluate the halo model solu-
tions for the ‘matter’ distribution in order to evaluate the
matter power spectrum, but this involves some unique
considerations. First, note that the adopted halo mass
function and linear halo bias must satisfy the following
properties for any power spectrum involving the matter
to have the correct large-scale limit
Z∞
0Mn(M) dM= ¯ρ , (32)
Z∞
0Mb(M)n(M) dM= ¯ρ . (33)
where ¯ ρis the mean comoving cosmological matter den-
sity. In other words, these equations enforce that all mat-
ter is contained in haloes and that, on average, matter
is unbiased with respect to itself. Achieving these lim-
its is difficult numerically because of the large amount
of mass contained in low-mass haloes according to most
popular mass functions. Therefore, special care must
be taken with the two-halo integral in the case of power
spectra that involve the matter field to ensure that equa-
tion (33) holds (see appendix A of Mead et al. 2020).Some popular mass function and bias relations enforce
these consistency relations while others do not. If they
do not, it might be possible to manually enforce these
relations, but this normally involves manipulating the
low-mass halo population.
In the special case of the power spectrum for matter
density contrast, δm= (ρ−¯ρ)/¯ρ, we use Wm(M, k) =
MU m(M, k)/¯ρand equation (13) becomes
P1h
mm(k) =1
¯ρ2Z∞
0M2ˆU2
m(M, k)n(M) dM . (34)
while equation (18) becomes
P2h
mm(k) =Plin
mm(k)
×1
¯ρZ∞
0MˆUm(M, k)b(M)n(M) dM2
,(35)
(ignoring non-linear halo biasing). We see that P2h
uv(k→
0) = Plin
mm(k→0) automatically as the term in the square
brackets equals unity (equation 33) in this limit. For
spectra other than matter this is no longer true, and in
general the large-scale limit of the two halo term will
be equal to the linear spectrum multiplied by amplitude8
101102103104Puv(k)/(h1Mpc)3
101
100101102Puv(k)/Plin(k)linear
2-halo term
1-halo termmatter
galaxy
matter-galaxy
103
102
101
100101
k/hMpc1
0.00.51.01.52.0Puv(k)/Pmm(k)
Figure 2. The upper panel shows example power spectra com-
puted using the halo model at z= 0: matter, galaxy and matter–
galaxy. The linear spectrum is shown for comparison as well as the
breakdown into two- and one-halo terms where that does not clut-
ter the plots. The middle panel shows the ratio of each spectrum to
linear while the lower panel shows the ratio to the non-linear halo
model matter spectrum. The galaxy sample can be seen to be pos-
itively biased relative to the matter. This bias is scale-independent
at large scales, but becomes scale dependent at intermediate scales
where the difference in the ways that galaxies and matter occupy
haloes becomes important.
factors (so-called bias) that account for the field con-
tent that arises from how the field populates haloes (e.g.
galaxy bias when the field is galaxy overdensity) and the
halo bias. Example power spectra at z= 0 for a ΛCDM
model are shown in Fig. 2 for matter, matter–galaxies
and galaxies2. The sample of galaxies chosen can be seen
to be positively biased ( b∼1.3) relative to the matter at
large scales. At smaller scales the spectra have different
shapes, a consequence of galaxy and matter occupying
haloes in different ways.
3.SELECTING THE INGREDIENTS
When using the halo model it is necessary to make
choices for the bias, halo mass function and halo profiles.
Due to the lack of an analytical theory for non-linear
gravitational clustering, it is common to calibrate these
ingredients via N-body simulations, or even via data.
Within the halo model, haloes are treated as discrete en-
2Non-linear halo bias is ignored, the mass function is taken from
Sheth & Tormen (1999), halo concentration from Duffy et al. (2008)
and the HOD from Zheng et al. (2005); discussed in Sections 3.2,
3.5 and 4.1 respectively. The HOD parameters are Mmin=M0=
M1= 1013h−1M⊙,σlog10M= 0.3 and α= 1 (equations 51 and
52). Satellite galaxies are taken to trace matter. Shot noise is
subtracted from the galaxy autospectra.tities, although real haloes never have clear boundaries.
When defining haloes in simulations it is necessary to
make a choice of boundary, and this choice must be con-
sistent when using collections of simulation-calibrated in-
gredients within a halo model. The fundamental choice
is how to identify a halo from the N-body particle distri-
bution. Two algorithms are in common usage: friends-
of-friends (FoF; Huchra & Geller 1982) and spherical-
overdensity (SO; Lacey & Cole 1994).
The FoF scheme is simpler, with the only user-specified
parameter being the ‘linking length’, which defines the
maximum distance between two particles that are con-
sidered to be part of the same halo. All particles within
the linking length of at least one other particle in the
halo are joined to that halo. Typically the linking length
is taken to be b= 0.2 times the mean-inter-particle
separation. A FoF finder with this linking length ap-
plied to particles following an isothermal distribution
(ρ∝r−2), will define a halo boundary such that the halo
has a mean overdensity close to the analytical spherical-
collapse result (see Section 6.2) in an Einstein-de Sitter
model (∆ v≃178 for Ω m= 1).
SO algorithms, on the other hand, first choose halo
centres (usually from minima in the gravitational poten-
tial, but sometimes in the density) and then grow spheres
out from these peaks until a fixed overdensity threshold
has been reached. With SO there are several choices
to be made: most obviously the value for the overden-
sity threshold (200¯ ρis common) but also exactly how
to define the halo centres (how are continuous fields de-
fined from the discrete particle distribution?) and how to
count haloes as distinct entities (so-called percolation).
While FoF is conceptually simpler, and is a mathemat-
ically unambiguous operation, SO is more common be-
cause it relates more closely to how halo formation is
thought to occur and to how haloes are identified in data
sets. SO haloes are, by definition, spherical (although
the particle distribution that contributes to them may
not be), whereas FoF haloes can be elongated structures,
some of which may look to be distinct objects joined by
a bridge.
It should be noted that there is no single ‘correct’ halo
definition, and the best choice will depend on the observ-
able that one is attempting to model. It is also important
to be consistent, and to use sets of relations that have
been calibrated on haloes identified using the same def-
inition. However, we note that it may be prudent to
identify haloes using a cosmology-dependent definition,
which accounts for the fact that halo formation happens
at different rates, with different end results, in different
cosmologies. Indeed, Courtin et al. (2011), Despali et al.
(2016) and Mead (2017) have all noted that more ‘uni-
versal’ (cosmology independent) behaviour is observed
when haloes are identified with an overdensity thresh-
old derived from the spherical-collapse model, with the
general trend that haloes become denser the more dark
energy takes hold of the expansion. Useful fitting func-
tions can be found in Bryan & Norman (1998) and Mead
(2017).
Aside from the virial radius, there are other physically
motivated definitions of the halo boundary. For example,
the splashback radius which is defined as the largest dis-
tance in the orbit of particles accreted into the haloes and
is usually measured by identifying the steepest gradient9
of the density profile (for example Fillmore & Goldreich
1984; Bertschinger 1985; Diemer & Kravtsov 2014; Ad-
hikari et al. 2014; More et al. 2015a; Shi 2016; Mansfield
et al. 2017; Diemer et al. 2017; O’Neil et al. 2021; Rana
et al. 2023, and references therein). The value of the
splashback radius is typical larger than or similar to the
virial radius depending on the accretion rate of the halo.
The turnaround radius is another typically larger phys-
ical radius which is motivated by the spherical collapse
model and is defined as the distance at which particles
reach zero velocity before falling into the halo (Pavlidou
& Tomaras 2014; Tanoglidis et al. 2015; Korkidis et al.
2020). The turnaround radius is generally larger than
the splashback radius and can be used as a test of grav-
ity (Tanoglidis et al. 2015; Nojiri et al. 2018; Lopes et al.
2019; Capozziello et al. 2019; Pavlidou et al. 2020). In
practice, the turnaround radius is defined as the radius
at which the amplitude of the particle infall velocity is
equal to the cosmic expansion. Two related and recent
definitions for physical radii are given by Fong & Han
(2021), called the depletion radii. The larger radius is
defined as the radius at which the maximum depletion
in the surrounding matter occurs and the smaller one as
the radius with the maximum matter inflow into a halo.
In practice, they are measured by finding the minimum
of the ratio of halo-matter to matter-matter correlation
functions and the minimum of the velocity profile around
the halo (see also Zhou & Han 2023; Gao et al. 2023).
3.1.Preliminary definitions
Let us define a few useful quantities before we intro-
duce the different ingredients. The variance in the lin-
ear matter overdensity field when smoothed on comoving
scale Ris
σ2(R) =Z∞
04πk
2π3
Plin(k)T2(kR) d ln k , (36)
where T(kR) is the filter window function, which is al-
most exclusively taken to be a real-space top hat; the
Fourier transform of which is
T(x) =3
x3(sinx−xcosx). (37)
The Lagrangian comoving scale, R, is the comoving ra-
dius of a sphere in a homogeneous Universe which con-
tains a given mass of M,
M=4
3πR3¯ρ , (38)
where ¯ ρis the mean comoving matter density. This rela-
tion allows us to write σ(R) in terms of mass. The ‘peak
height’,
ν(M) =δc/σ(M), (39)
is a useful quantity that increases monotonically with
the halo mass. Here δc(z)≃1.686/D(z) is the critical
linear overdensity needed for haloes to collapse under
the spherical-collapse model at redshift zandD(z) is
the linear growth factor normalised to 1 at z= 0.
3.2.Halo mass function
The halo mass function is usually parametrised in
terms of either σorν, rather than Mdirectly, because
0.000.020.040.06M2n(M)/
z=0
z=1
1091010101110121013101410151016
M/h1M
012345b(M)Sheth & T ormen (1999)
Tinker et al. (2010)
Despali et al. (2016)0.37 0.46 0.60 0.82 1.18 1.85 3.23 6.42
Figure 3. Upper panel: Dimensionless multiplicity function,
M2n(M)/¯ρ, as a function of halo mass for three popular halo-
mass functions (Sheth & Tormen 1999; Tinker et al. 2010; Despali
et al. 2016) at z= 0 (solid) and z= 1 (dashed) for the virial halo
definition. The top axis shows the νvalues corresponding to halo
mass at z= 0only (the mapping is z-dependent). For normalised
mass functions, integrating the multiplicity function over ln Mwill
equal unity, and therefore the shape of the function determines the
contribution of haloes in a logarithmic mass range to the total mass
in the cosmos, with the peak determining those most important.
As the universe evolves, more haloes of higher mass are created,
but this is done at the expense of those of lower mass via merg-
ers. Lower panel: the associated linear halo bias, low mass haloes
are anti-biased (0 < b < 1) with a constant asymptotic value at
low mass. The transition to biased, b >1, objects occurs around
the non-linear mass ( ν= 1). At fixed halo mass, haloes are com-
paratively rarer, and more highly biased, at higher z. The bias
shown for Tinker et al. (2010) is from their calibrated fitting func-
tion, whereas in the other two cases it is from the peak-background
split. Tinker et al. (2010) predicts fewer, but more highly biased,
high-mass haloes compared to the other models.
it has been shown that the halo mass function (and also
bias) exhibit close-to-universal behaviour as a function of
cosmology and redshift in terms of these variables (e.g.,
Press & Schechter 1974; Bond et al. 1991; Sheth & Tor-
men 1999; Tinker et al. 2008). Analytical approaches for
calculating (approximately) the halo mass function rely
on either peaks theory or excursion sets. These methods
start from the initial matter density field and relate some
of its properties to the haloes that form later. For peaks
theory, the focus is on peaks in the primordial matter
density field (Bardeen et al. 1986), while excursion sets
look at overdense regions (e.g., Bond et al. 1991; Bond &
Myers 1996; Stein et al. 2019). The peak height, ν, has
been shown to be the relevant quantity to consider when
calculating halo formation via peaks theory and excur-
sion sets. For reference, for a vanilla ΛCDM cosmology
atz= 0, ν= 0.5, 1, 2, and 3 correspond to ≃1010.4,
1012.5, 1014.2, and 1014.9h−1M⊙. Some common mass
functions are shown in Fig. 3, and the (generally non-
linear) mapping between Mandνcan be read off the
axes.
Now we can write the halo mass function in terms of
the peak height, by defining
f(ν) dν=M
¯ρn(M) dM . (40)10
Table 1 . A non-exhaustive list of popular halo mass functions, usually presented either as f(σ) orf(ν). For each mass function we
list the halo finder and definition, and we note that the mass function is a strong function of these choices: FoF haloes are uniquely
defined by the linking length, but SO haloes need the halo-centre-finding and percolation scheme to be defined, as well as the overdensity
threshold. SO haloes are then defined as spherical objects that are bounded such that they have a certain overdensity relative to either
the background (e.g., 200) or critical (e.g., 200c) densities. Where a virial definition is used, this is most commonly evaluated using the
fitting formula of Bryan & Norman (1998). For every mass function, a linear halo bias can be derived using the peak-background split
argument (equation 42) but this may not be an accurate description of the large-scale bias (e.g., Tinker et al. 2010; Manera et al. 2010).
The calibrated bias models of Sheth et al. (2001) and Tinker et al. (2010) are based on the mass functions of Sheth & Tormen (1999) and
Tinker et al. (2008) respectively, but do not use the peak-background split. We also note whether each mass function is normalised such
that all mass is in haloes (equation 32).
Reference Finder Definition Normalised Notes
Press & Schechter (1974) – – Yes Purely analytical argument using the spherical collapse model, not
connected to a specific mass definition, cosmology or redshift.
Sheth & Tormen (1999) SO virial Yes Original paper calculates the halo bias via the peak-background split;
Sheth, Mo & Tormen (2001) use an ellipsoidal-collapse argument for
a more accurate bias. Cosmology dependence of δcaccounted for via
spherical collapse.
Jenkins et al. (2001) FoF 0 .2 No First accurate parameterisation for FoF haloes.
Warren et al. (2006) FoF 0 .2 No Argument presented for resolution-dependent conversion between FoF
and SO masses. Correction to FoF masses for low-particle haloes.
Reed et al. (2007) FoF 0 .2 No Depends on effective power spectrum index at the collapse scale, neff,
as well as ν.
Peacock (2007) FoF 0 .2 Yes Based on fit to model of Warren et al. (2006).
Tinker et al. (2008) SO 200–3200 Both Parametrised in terms of σ. Principle result is unnormalised and has
redshift-dependent (non-universal) parameters for ∆ h= 200. How-
ever, redshift-independent results are presented for a variety of other
SO halo definitions, and these can be interpolated between (appendix
B) for a virial halo definition. A normalised mass function is also
presented (appendix C).
Tinker et al. (2010) SO 200–3200 Yes Mass function is the same as the normalised (appendix C) version from
Tinker et al. (2008) but recast in terms of ν. Once again, redshift-
dependent parameters are presented only for ∆ h= 200. A calibrated
halo bias is presented that fulfils equation (33) without using the peak-
background split argument.
Crocce et al. (2010) FoF 0 .2 No Uses functional form of Warren et al. (2006).
Bhattacharya et al. (2011) FoF 0 .2 No Consider wCDM dark energy.
Courtin et al. (2011) FoF virial No Results demonstrate that virial definitions are ‘more universal’; semi-
analytical relation to convert ∆ hto FoF linking length.
Watson et al. (2013) FoF/SO various No Consider wide redshift range, from z= 30 to 0.
Despali et al. (2016) SO virial No Argues that the mass function is ‘more universal’ when a cosmology-
dependent virial criterion is used to identify haloes, rather than a
fixed overdensity threshold.
Del Popolo et al. (2017) – – Yes Uses the excursion set approach and provides a semi-analytic solution
with a mass dependent collapse threshold.
McClintock et al. (2019) SO 200 Yes Parameters of a universal, σ-dependent, fitting function are emulated
to encompass cosmology and redshift dependence.
Bocquet et al. (2020) SO 200c No Mass function principle components are directly emulated.
If all mass is to be contained in haloes, then f(ν) in-
tegrated over all ν∈[0,∞] should equal unity, which
derives from mass conservation (equation 32). Note that
this condition is only imposed on some fitting functions.
Other than the constraint imposed by mass conservation,
the shape of the low-mass end of the halo-mass function
is difficult to access through N-body simulations due to
finite particle resolution. Commonly-used fitting func-
tions should be interpreted with caution in this regime.
A common form of f(ν) to be found in the literature is
that of Sheth & Tormen (1999):
f(ν) =A
1 + (qν2)−p
e−qν2/2, (41)
where p,qand (sometimes) Aare fitted to simulated
data. If Ais fitted independently of pandqthen the mass
function will not be normalised. If Ais not fitted then
it depends on pandqvia the normalisation condition.
In Table 1 we list some popular mass functions together
with the halo finder and definition on which they were
calibrated.
Finally we note that δc≃1.686 is usually assumed; a
value that corresponds to a universe with an Einstein-de Sitter background3. Although, δchas a weak cos-
mology dependence (e.g., Lacey & Cole 1993) that can
be calculated using the spherical-collapse model (fitting
formulae: Nakamura & Suto 1997; Mead 2017). This
cosmology dependence is often ignored in the conversion
between νandM. However, the general exponential
form of the halo mass functions (e.g., equation 41) can
make this weak dependence have a larger impact than
one might first assume. For example, spherical collapse
predicts that δc≃1.676 for Ω m= 0.3 ΛCDM, a small
decrease from the canonical 1 .686. However, this small
difference results in a ∼4 per cent increase in the abun-
dance of rare ( ν= 4;M≃2×1015h−1M⊙;z= 0) haloes
if the mass function of Sheth & Tormen (1999) applies.
Courtin et al. (2011) and Mead (2017) have suggested
that retaining this cosmology dependence of δcmay im-
prove the cosmological universality of halo mass func-
tions and halo-model calculations.
3.3.Linear halo bias
3A spatially flat cosmology with the matter density parameter
Ωm= 1.11
On scales large enough to comfortably encompass the
largest haloes, the overdensity of haloes of any mass
can be approximated by the (unconditional) halo mass
function via the peak-background split argument (Cole
& Kaiser 1989; Mo & White 1996; Sheth et al. 2001).
The density field is thought of as a sum of large- and
small-scale waves with haloes forming at global peaks;
more peaks are pushed over the formation threshold
when large and small-scale waves constructively inter-
fere, which will be in regions of large-scale overdensity,
leading to biased clustering. The peak-background split
argument can be used to calculate an approximate linear
halo bias from any mass function:
b(ν) = 1−1
δc
1 +d lnf(ν)
d lnν
. (42)
If a particular f(ν) satisfies the mass-normalisation con-
dition in equation (32), then the combination of f(ν)
with b(ν) calculated this way automatically satisfies the
bias-normalisation condition in equation (33). However,
if these normalisation conditions are not important, then
equation (42) can be still applied to any mass func-
tion to get an expression for the bias (although it may
not be accurate). In practice, not satisfying the bias-
normalisation condition is only a fundamental problem
when calculating the matter spectrum, and only then if
one explicitly integrates over all halo masses, which is
not normally done in halo-model codes4.
Note that the peak-background split is notthe only
way to satisfy the bias normalisation condition, and pop-
ular bias relations (Sheth, Mo & Tormen 2001; Tinker
et al. 2010) satisfy the normalisation condition using
other schemes. The accuracy of the peak-background
split has been disputed (e.g., Manera et al. 2010) and
calibrated bias relations may therefore be preferred.
3.4.Non-linear halo bias
As discussed in Subsection 2.1.2, the beyond-linear
portion of the halo bias is not often considered in halo-
model calculations: It is common to set βnl= 0 in
equation (17), and therefore implicitly Inl= 0 in equa-
tion (19). This means that the ‘standard’ two-halo term
at large scales for any tracer is always the linear power
multiplied by some scaling (bias) factors, which arise
jointly through the linear halo bias and halo occupation.
As shown by Mead & Verde (2021), the lack of beyond-
linear bias is mainly responsible for the poor performance
of the standard halo model in the transition region be-
tween the two- and one-halo terms. At smaller scales
the standard two-halo term is suppressed by the halo
window functions, but this effect is often not visible in
the total halo-model spectrum since it occurs on scales
where the one-halo term tends to dominate the power.
Note well that the presence of the window functions in
the standard two-halo term is notaccounting for halo
exclusion (the fact that spatially-exclusive haloes should
not overlap), but instead is a blurring of correlation be-
tween points in different haloes caused by the fact that
these points are not at the exact halo centre. In reality,
the two-halo term should be further suppressed by halo
4See the discussion in Appendix A of Mead et al. (2020)
102
101
100
k / hMpc1
0.00.20.40.60.81.0Rhh(M1,M2,k)
M1, M2 = 1012.5, 1013.0 h1M
M1, M2 = 1012.5, 1013.5 h1M
M1, M2 = 1012.5, 1014.0 h1M
M1, M2 = 1013.0, 1013.5 h1M
M1, M2 = 1013.0, 1014.0 h1M
M1, M2 = 1013.5, 1014.5 h1M
Figure 4. Halo–halo correlation coefficient as a function of scale
taken from the dark quest emulator. At large scales this is con-
sistent with unity, but it drops below unity at smaller scales. This
implies that there is a non-zero covariance in the clustering be-
tween haloes in different mass bins, which cannot be captured by
a simple linear bias model.
exclusion (Section 5.6), which is also absent in simple
linear bias models.
The two-halo term accounts for inter-halo clustering
and therefore the fundamentally-correct spectrum to in-
clude within the two-halo term is the halo power spec-
trum, for which no fitting function exists in the literature.
In our notation (equation 18) the beyond-linear portion
of this is factored out into βnl. To illustrate some prop-
erties of this, we define the halo–halo cross correlation in
Fourier space as
Rhh(M1,M2, k) =
Phh(M1, M2, k)p
Phh(M1, M1, k)Phh(M2, M2, k),(43)
and show this for various halo masses in Fig. 4, where the
correlation is calculated using the dark quest emulator
of Nishimichi et al. (2019); Miyatake et al. (2022a). The
fact that this departs from unity at small scales indicates
a non-zero covariance between the clustering of haloes in
different mass bins (Hamaus et al. 2010; Baldauf et al.
2013; Schmidt 2016). This indicates that any model for
the non-linear halo bias where the bias is separable,
Phh(M1, M2, k)≃b(M1, k)b(M2, k)Pmm(k) (44)
fails to describe the covariant structure, even if a scale
dependent b(M, k) (e.g., Fedeli et al. 2014) or if a non-
linear Pmm(k) is used: the non-linear halo-bias is fun-
damentally a non-separable function! The structure of
the halo power spectrum ensures that the clustering of
haloes in one mass bin respond to the clustering of haloes
in other mass bins. Tinker et al. (2005) use a fitting
function in real space for the radial dependence of the
non-linear halo bias and compute that as a function of
the non-linear matter correlation function. This fitting
function has no dependence on halo masses other than
through the linear halo bias, and is thus difficult to in-
terpret for different galaxy populations that may exist in
very different haloes.
Some authors (e.g., Cacciato et al. 2012; van den Bosch
et al. 2013), particularly those interested in using the
halo model to compute galaxy spectra, replace the lin-
ear spectrum that appears in equation (18) with the full12
non-linear matter spectrum5. We note that this is incon-
sistent with the halo-model ethos, since in principle the
non-linear matter power should be computable via the
halo model. However, for galaxies, it has been demon-
strated that using the non-linear power provides a better
approximation at quasi-linear ( k≃0.1hMpc−1) scales
compared to using the linear power. Despite this, we
advise an abundance of caution: the non-linear matter
power contains its own one-halo term, which arises due
to the auto-convolution of the matter profiles at small
scales. This feature has no analogue in the halo spectrum
(which is dominated by exclusion at such scales), even
though the shape of the halo spectrum may be super-
linear at quasi-linear scales. This means that using the
non-linear matter spectrum can be extremely wrong at
small scales, and one virtue of the linear approximation
is that it will be significantly less wrong. Incorporating
a small-scale halo-exclusion model may ameliorate the
problem induced when using the non-linear matter spec-
trum, with the ‘exclusion’ term performing the joint job
of dampening the excess one-halo power and account-
ing for the genuine spatially exclusivity of haloes, but
does not escape the physical incorrectness of employing
the non-linear matter spectrum in this role. Finally, the
replacement Plin(k)→Pnl(k), with Inl(k) = 0, in equa-
tion (18) suffers from the same problem demonstrated in
Fig. 4; the value of Rhh= 1 always, contrary to measure-
ments and theoretical expectations.
Few authors have tackled the issue of non-linear halo
bias in detail. Smith et al. (2007); Ginzburg et al. (2017)
used the combination of perturbation theory for both the
matter field and halo bias to demonstrate that improved
predictions could be made for quasi-linear scales. Un-
fortunately, because perturbation theory fails at smaller
scales, so does this method. Nishimichi et al. (2019)
emulated the halo power spectrum directly, so that it
could be incorporated within halo-model calculations of
the galaxy power spectrum. This emulated power con-
tains both classical non-linearity in the bias together with
halo exclusion, since both effects are present in simula-
tions and in the measured halo overdensity fields. Fi-
nally, Mead & Verde (2021) showed that incorporating
the non-linear halo bias (measured from N-body simu-
lations) within halo-model calculations dramatically im-
proves accuracy in the transition region. The βnldefined
in that work (equation 17) is related to the halo stochas-
ticity matrix defined by Hamaus et al. (2010) and the
halo stochasticity covariance defined by Schmidt (2016).
3.5.Dark matter halo profiles
By far the most common form taken for the density
profile of collisionless matter is that of Navarro, Frenk &
White (NFW; 1997)
ρ(r) =ρs
r/rs(1 +r/rs)2, (45)
where ρsandrsare the scale radius and density, both of
which depend on the halo mass. The profile is usually
5Usually from a fitting function, for example halofit (Smith
et al. 2003; Takahashi et al. 2012) or hmcode (Mead et al. 2015b,
2021), although this could also come from an emulator (e.g.,
Lawrence et al. 2017; Knabenhans et al. 2019; Angulo et al. 2020).truncated6at the halo radius rhand if this truncation is
not imposed then it should be noted that the total mass
of the profile is formally infinite. The halo radius (which
need not necessarily be the ‘virial’ radius7) is calculated
via
M=4
3πr3
h∆h¯ρ , (46)
where ∆ his the halo overdensity with respect to the
background matter density (usually either 200, or 200
times the critical density, or else the virial definition). A
less common, but possibly more accurate, choice for the
halo profile is that of Einasto et al. (1984),
ρ(r) =ρsexp
−2
αr
rs−1α
, (47)
which has an extra ‘shape’ parameter, α, as well as an rs
similar to the NFW profile, (also see Navarro et al. 2004;
Gao et al. 2008, for more details). A recent update to
the Einasto et al. (1984) halo profiles has been given by
Diemer (2022), which includes two characteristic scales
and fits to numerical simulations more accurately.
To fully specify the halo profile in equation (45) we
need to know the scale radius, rs, which is usually re-
lated to rhvia a concentration–mass relation: c=rh/rs.
These are always calibrated to haloes measured in N-
body simulations, and once again we stress that the rela-
tions will depend on the halo definition, as well as the de-
tails of precisely how the concentration was inferred from
the measured halo sample. For example: Is the relation
fitted to the mean or median halo profile in a mass bin,
or to individual haloes? Is the cumulative profile fitted or
the raw density? Are certain haloes discarded from the
sample? Is the concentration inferred from the circular
velocity profile? In Table 2 we list some concentration–
mass relations that are in common usage. We also note
that a scatter in the concentration parameter at fixed
halo mass is seen in haloes identified in N-body simula-
tions (e.g., Jing 2000; Bullock et al. 2001) with an ap-
proximate log-normal distribution with σlnc≃0.3. This
scatter can be included in halo-model calculations (see
Section 5.8).
The constant of proportionality from equation (45) can
be found by ensuring that integrating the density profile
over the halo volume gives the correct enclosed mass:
ρs=M
4πr3
hc3
ln(1 + c)−c/(1 +c)
. (48)
In passing, we note that the mass enclosed at a given
radius by an NFW profile is
M(r) =Mln(1 + r/rs)−(r/rs)/(1 +r/rs)
ln(1 + c)−c/(1 +c)
.(49)
Once the real-space halo profile has been specified it
must be Fourier transformed (equation 4) for use in the
6The profile truncation can be sharp or smooth. A smooth
truncation for galaxy clusters has been shown to provide a better
match to N-body simulations (see for example Oguri & Hamana
2011; Diemer & Kravtsov 2014).
7In the context of halo definitions, the ‘virial’ radius is often
used interchangeably with ‘halo’ radius. It need not have anything
to do with virialised haloes or the virial theorem.13
Table 2 . A non-exhaustive list of popular NFW profile concentration–mass relations that have been fitted to data from N-body simulations.
Note that different samples of haloes may have been used in fitting each relation (e.g., relaxed vs. all haloes) and different criteria may be
employed to isolate unique halo centres, and different cosmologies may have been considered. We encourage the reader to carefully read
the papers below to ensure that they understand the details of the relation they are using and to ensure that it is appropriate for their use
case.
Reference Definition Notes
Navarro et al. (1997) 200c Depends on a cosmology-dependent halo-collapse redshift that is calculated semi-
analytically.
Bullock et al. (2001) virial Two relations presented in paper: a simple model where cis a power-law in M(although
scaled by a cosmology-dependent non-linear mass) and a more complicated model where
cis related to a cosmology-dependent halo formation redshift, which is calculated semi-
analytically.
Eke et al. (2001) virial Depends on a cosmology-dependent halo-collapse redshift that is calculated semi-
analytically.
Neto et al. (2007) 200c Only considered the Millennium Springel et al. (2005) cosmology at z= 0.
Macci` o et al. (2008) virial Modified version of the Bullock et al. (2001) algorithm.
Duffy et al. (2008) 200, 200c, virial Simple c(M) power-law relations are presented that are fitted to simulations of WMAP
5 cosmology. Explicit zdependence. Separate relations for ‘relaxed’ and ‘full’ samples
of haloes.
Prada et al. (2012) 200c ‘Cosmology dependent’ relation presented as a function of σ(M, a). Upturn in halo
concentration for high-mass haloes.
Kwan et al. (2013) 200c Emulated relation for a variety of wCDM cosmologies.
Ludlow et al. (2014) 200c Relates halo concentration to mass-accretion history.
Klypin et al. (2014) 200c Parametrised in terms of ν.
Diemer & Kravtsov (2015) 200c Present a semi-analytical, cosmology-dependent model parametrised in terms of νand
neff– the effective slope of the power spectrum on collapse scales. Demonstrates that
concentration–mass relation is ‘most universal’ when masses are defined via 200c.
Correa et al. (2015) 200c Relates halo concentration to mass-accretion history. Only applies to relaxed haloes.
Okoli & Afshordi (2016) 200c Focusses on relaxed low-mass haloes using analytical arguments. Cosmology dependence
incorporated via νdependence.
Ludlow et al. (2016) 200c Applies for WDM as well as for CDM cosmologies. Depends on a collapse redshift that
is calculated semi-analytically.
Child et al. (2018) 200c Power-law relation but scaled via the cosmology-dependent non-linear mass. Also con-
sider Einasto profiles. Individual and stacked halo profiles considered separately.
Diemer & Joyce (2019) 200c Improved version of Diemer & Kravtsov (2015) with additional dependence on the log-
arithmic linear growth rate to capture non-standard expansion histories.
Ishiyama et al. (2021) 200c, virial Uses the same functional form as Diemer & Joyce (2019) but fitted to a larger simulation
resulting in up to 5% errors for a wide range of masses and redshifts.
101
100101
k / hMpc1
0.000.250.500.751.00Um(M,k)
1/rv1/rs
1013h1M
1014h1M
1015h1M
Figure 5. NFW profile normalised Fourier transforms. We show a
range of halo masses log-spanning 1013to 1015h−1M⊙with param-
eters corresponding to a ΛCDM cosmology at z= 0. This takes in
a range of virial radii from 0 .44 to 2 .1h−1Mpc and concentrations
from 6 .9 to 4 .7, with central M= 1014h−1M⊙,rh= 0.95h−1Mpc
andc= 5.7. The vertical lines show approximate wavenumbers
corresponding to the central halo virial and scale radius.
power spectrum calculation (equations 13 and 18). Ex-
ample normalised profile Fourier transforms are shown
in Fig. 5. Note that the shape dependence of smaller
haloes only affects the power at higher k. In the power
spectrum calculation the normalised windows are multi-
plied by halo mass, which boosts the contribution from
higher-mass haloes, but are also multiplied by the mass
function, which reduces the contribution.
The choice of halo overdensity to use in the halo model,
∆h, is fixed if using ingredients that have been calibrated
on haloes identified via a SO finder, but it is less obviouswhat to choose for ∆ hwhen dealing with FoF-identified
haloes. Many schemes have been proposed to relate a
linking length, b, to ∆ h, the simplest involve imagin-
ing halo profiles sampled by discrete particles, and then
calculating the corresponding linking length at the halo
boundary. This has the unattractive property that link-
ing length depends on the halo profile (e.g., Luki´ c et al.
2009), so often a simple isothermal halo is assumed when
performing this conversion, which leads to the approxi-
mate relation (Lacey & Cole 1994):
b
0.2−3
≃∆h
180. (50)
The correspondence with the matter dominated
spherical-collapse result is precisely why the linking
length b= 0.2 is often chosen. Warren et al. (2006)
demonstrated that FoF linking would underestimate the
masses of haloes with low particle number, and proposed
a correction that is sometimes applied to boost the halo
masses of FoF identified haloes. Other relations between
linking length and overdensity have been proposed in the
literature (e.g., Courtin et al. 2011; More et al. 2011).
It should be noted that SO finders can also underesti-
mate the halo mass function at low mass due to particle-
resolution issues, see Nishimichi et al. 2019.
3.6.Baryonic feedback
When modelling the matter power spectrum via the
halo model it is common to employ NFW profiles, which14
provide a reasonable match to gravity-only simulated
data at small scales. However, in reality ‘matter’ in the
universe is comprised of CDM, gas and stars/dust, each
of which occupies haloes in a unique way. The halo model
can be used to gauge the effect of the presence of gas and
stars, which alter the matter power spectrum compared
to the form it would have were gravity to be the only sig-
nificant force in structure formation. Larger-scale effects
(0.5hMpc−1≲k≲10hMpc−1) on the power spectrum
arise from redistributed gas, mainly due to the Active
Galactic Nuclei (AGN) expelling gas from halo centres8.
Due to these effects, and its intrinsic pressure, gas that
remains bound to a halo may have a different profile from
NFW. Smaller-scale contributions ( k≳10hMpc−1) to
the power deviation arise primarily from stars cluster-
ing densely in halo cores (see Chisari et al. 2019b, for a
review of feedback in cosmology).
Originally, White (2004) showed that the small-scale
matter spectrum could be changed at the O(10%) level
by reasonable changes to the halo structure that could
be calculated theoretically in a spherical-halo scenario
with angular-momentum-conserving gas collapse. Rudd,
Zentner & Kravtsov (2008) and Zentner, Rudd & Hu
(2008) show that a decrease in small-scale power was
expected due to AGN activity, and that this could be
captured by changing the concentration–mass relation in
the NFW profile that enters the halo-model power spec-
trum calculation. The exact impact that feedback has on
the matter spectrum is still uncertain (e.g., van Daalen
et al. 2011; McCarthy et al. 2017; van Daalen et al. 2020),
but is certainly at least O(10%) for reasonable feedback
scenarios.
Semboloni et al. (2011, 2013); Fedeli (2014); Fedeli
et al. (2014) show that total-matter power spectra can
be constructed by taking separate profiles for each com-
ponent of the matter, and that the impact of AGN feed-
back could be captured if the gas content of haloes was
assumed to be decreased. Mead et al. (2020) showed that
this could be extended to modelling all combinations of
auto/cross spectra that can be extracted from the hy-
drodynamic simulations. This modelling can then form
the basis of effective models of feedback that attempt to
model the response (or reaction) in power spectrum only
(e.g., Mead et al. 2020, 2021), thus circumventing the dif-
ficult issue of the general inaccuracy of the halo-model
calculation.
In approaches such as Mohammed & Seljak (2014);
Mohammed et al. (2014); Sullivan et al. (2021) where
the one-halo term is reduced to a series expansion, it has
been shown that the series can be fitted to power spec-
tra for a range of feedback scenarios with similar perfor-
mance to the gravity-only case. Debackere et al. (2020)
suggested that the mass-dependent halo baryon fraction
could be measured using external data (e.g., thermal or
kinetic Sunyaev-Zeldovich or X-ray observations), and
this could be used to provide an external constraint on
the impact that feedback may have on the power. How-
ever, such arguments rely on the halo model providing
a perfect mapping between the properties of haloes and
their power spectra.
How baryonic feedback alters the spectrum of tracers
8On smaller scales supernovae explosions can also contribute to
baryon feedback.other than matter has not received significant attention.
In most cases, galaxy–galaxy lensing and galaxy cluster-
ing studies have limited themselves to large scales where
the impact of baryon feedback and non-linear galaxy bias
are small. Although, feedback has been accounted for
in studies that push to smaller scales by allowing for
a variable halo-concentration amplitude (accounting for
matter redistribution) and a separate concentration am-
plitude for the satellite galaxies (see for example Cac-
ciato et al. 2013; Viola et al. 2015; van Uitert et al. 2016;
Dvornik et al. 2018; Debackere et al. 2020; Dvornik et al.
2023; Amon et al. 2023).
3.7.Modelling the matter power spectrum
Modelling the matter power spectrum is particularly
useful for weak-lensing studies, where the lensing signal is
sourced by the distribution of allmatter in the universe.
However, it has long been recognised that the accuracy
of the halo model prediction is poor compared to what is
required by contemporary lensing data (see Fig. 7). This
has led to several attempts to develop fitting functions
specifically for the matter power.
3.7.1. halofit
Originally presented by Smith et al. (2003), halofit
is a halo-model-inspired fitting function with ∼30 free
parameters that was fitted to N-body simulation data.
It does not use the halo model directly, but the power
spectrum is broken down as the sum of a ‘quasi-linear’
and ‘halo’ term, which are analogues of the two- and one-
halo terms. Further inspiration from the halo model is
used in that the fitting functions are parameterised in
terms of σ(R) (and its derivatives), as opposed to ran-
dom functions of the cosmological parameters. halofit
was updated in accuracy by Takahashi et al. (2012) and
a prescription for massive neutrinos was added by Bird
et al. (2012). halofit is accurate at around the ∼5%
level for k <10hMpc−1andz <2 for a wide range of
cosmologies. Note well that halofit cannot be used to
predict any spectra other than that of matter.
3.7.2. hmcode
Originally presented by Mead et al. (2015b) and then
updated by Mead et al. (2016) and Mead et al. (2021),
hmcode is a version of the halo model that has been
augmented to produce accurate matter power spectra.
While the backbone of the calculation is the vanilla halo
model described in Subsection 2.3, there are several addi-
tions and tweaks that were necessary in order to enhance
accuracy. These tweaks ensure that the model pertains
to a population of ‘effective haloes’ the physical reality of
which should not be taken too seriously. hmcode is ac-
curate at the ∼2.5% level for k <10hMpc−1andz <2
across a wide range of cosmologies. Note that hmcode
cannot be used to predict any spectra other than that of
matter. It is also not obvious that the same tweaks that
are required to provide accurate matter spectra would
work, or would even be appropriate, if one wanted to
extend the method to other tracers.
4.MODELLING TRACERS
So far, we have discussed the application of the halo
model for calculating the power spectrum of matter and15
galaxies, but we noted in Section 2.1 that our initial
derivation was applicable to anydiffuse tracer of large-
scale structure whose halo profile can be specified. In
this Section we review work where the halo model has
been used to calculate these other spectra. Most au-
thors simply replace the halo profiles in equations (13)
and (18; ignoring βnl) with those relevant for the new
tracer. There is no need to specify new mass functions
or halo-bias relations since, in a model where all sig-
nal originates from haloes, this is already included self
consistently. Generally, the spectrum of the new tracer
will have the linear shape at large scales, with an am-
plitude determined by the tracer occupation statistics.
At smaller scales the shape of the one-halo term will be
governed by the shape of the tracer profiles. Using the
halo model in this way might be accurate, but the ac-
curacy should be assessed on a case-by-case basis and
ideally should be confirmed by comparing the results of
calculations to measurements from simulations. Some
of the additions that will be discussed in Section 5 may
be more or less important for spectra of different trac-
ers. Finally, we note that any significant contribution
to a signal that is genuinely diffuse, such that it cannot
be tied to a halo, is difficult to include self consistently
within a model where all signal originates from haloes
(although see Section 5.1).
4.1.Galaxies
We touched on modelling galaxy power spectra in Sec-
tion 2.2. Here we go into more detail and explore the rela-
tion between halo masses and the distribution of galaxies
within those haloes, the so-called halo occupation distri-
bution (HOD). Note that, if a stochastic relationship be-
tween galaxy occupation and halo mass is assumed then
properties of the statistical distribution of galaxies also
need to be specified.
A commonly-used HOD is the five-parameter model of
Zheng et al. (2005), who measured the relation between
haloes and galaxies from a smoothed particle hydrody-
namics simulation and a semi-analytic galaxy formation
model. They find that the mean number of central galax-
ies given a halo mass, M, can be well described by
⟨Nc(M)⟩=1
2
1 + erflog10(M/M min)
σlog10M
,(51)
where erf( x), is the error function. Haloes can never
host more than a single central galaxy, as enforced by
the error function ranging from -1 to 1. Mminis the
characteristic minimum halo mass, which means that for
M≪Mmina halo is unlikely to host a central galaxy
while for M≫Mminhaloes are almost certain to host
a single central galaxy, with the width of the transition
around Mmingoverned by σlog10M. Any random pro-
cess whose outcome can only be zero or one is governed
by Bernoulli statistics; the statistical properties of this
distribution are given in Table 3.
In the Zheng et al. (2005) model the mean number of
satellite galaxies is
⟨Ns(M)⟩= Θ( M−M0)M−M0
M1α
,(52)
where M0is the truncation mass, below which a halo is
not expected to host any satellites (Θ( M−M0) = 1 forTable 3 . Halo-occupation properties for central and satellite
galaxies assuming that central galaxies are Bernoulli distributed
with mean p(equation 51) and satellite galaxies are Poisson dis-
tributed with mean λ(equation 52). Also shown is how the statis-
tics of satellite galaxies are modified if the central condition is
imposed. In this case the satellite galaxy distribution is no longer
Poisson and λis no longer the mean, even if λwould usually be
obtained from (something similar to) equation (52). If p= 1 then
the central condition has no impact and the expressions in the last
two rows of the table are equal. Note also that ⟨NcNs⟩=⟨Ns⟩=λ,
or equivalently Cov( Nc, Ns) =λ(1−p).
Galaxy type ⟨N⟩ ⟨ N2⟩ ⟨ N(N−1)⟩ Var(N)
Centrals p p 0 p(1−p)
Satellites λ λ (1 +λ) λ2λ
cen. cond. pλ pλ (1 +λ) pλ2pλ[1 +λ(1−p)]
M > M 0and 0 otherwise). Haloes with M=M0+M1
host a single satellite galaxy on average. If α= 1 then
the number of satellite galaxies scales linearly with halo
mass. Satellite galaxies are often assumed to follow Pois-
son statistics9; the statistical properties of this distribu-
tion are given in Table 3. A simpler three-parameter
HOD is that of Zehavi et al. (2004), which maps to that
of Zheng et al. (2005) in the limit that σlog10M= 0 in
equation (51) and M0= 0 in equation (52). A more com-
prehensive HOD model has been given in Cacciato et al.
(2012) which links the distribution of galaxies with their
luminosity and stellar mass functions; quantities that
can be more readily connected to observations. Emula-
tor based approaches have also been proposed to model
HOD, allowing for extra free parameters to be included:
for example those that capture assembly bias (Salcedo
et al. 2022).
If the parameters NcandNswere independent then
⟨NcNs⟩=⟨Nc⟩⟨Ns⟩in equation (28), but it would be pos-
sible for a halo to host a satellite galaxy without hosting
a central. To avoid this, the ‘central condition’ is of-
ten imposed such that the number of satellite galaxies
is fixed to zero if there is no central galaxy. Imposing
this additional constraint affects the (initially assumed)
statistics of Ns, especially for halo masses that contain
∼1 galaxy, where Nc∼0.5. In this case, the central con-
dition distorts the initial distribution, resulting in fewer
haloes containing satellites, and therefore more haloes
containing zero satellites than would otherwise be as-
sumed (e.g., Beutler et al. 2013). This means that the
assumption of Bernoulli statistics for central occupation,
Poisson statistics for satellite occupation, and the central
condition are mutually incompatible. Something has to
give, and traditionally it is the Poisson assumption for
satellite galaxies that is modified to retain consistency.
IfP(Ns) is the original probability for a halo to host Ns
satellite galaxies, then this is modified according to
P′(N′
s) =⟨Nc⟩P(Ns) + (1 − ⟨Nc⟩)δ0Ns,(53)
where δijis the Kroenecker delta. If ⟨Nc⟩= 1 then
the satellite distribution is unchanged; if ⟨Nc⟩= 0 then
P′(N′
s= 0) = 1 and P′(N′
s≥1) = 0 automati-
cally. These transformations of the probability distri-
bution modify ⟨Ns⟩,⟨N2
s⟩and⟨Ns(Ns−1)⟩in a calcu-
lable way, with each being lowered by a multiplicative
9Although, as we will discuss below, this condition usually does
not hold.16
101
100101Number of galaxiesCentrals
Satellites
with central condition
1012101310141015
Halo mass [h1M]
101
100101Number of galaxiesCentrals
Satellites
with central condition
Figure 6. Example HODs for typical surveys that targets red
galaxies (upper) and blue galaxies (lower). The solid lines show
the mean numbers of central and satellite galaxies as a function of
halo mass, while the bounded regions show the expected scatter
(±σ) about this. Note that the shaded region for central occupa-
tion includes values beyond 1, although this is a plotting artefact.
The darker dashed line shows the number of satellite galaxies when
imposing the central condition while the lighter dashed lines indi-
cate their expected scatter. The number of satellites is generally
lowered when this condition is imposed. This is a small effect, and
it induces a covariance between central and satellite galaxies in the
region where ⟨Nc⟩ ∼0.5 and the scatter is also affected. When
⟨Nc⟩ ∼1 this difference vanishes.
factor of ⟨Nc⟩relative to the values calculated for the
initially assumed distribution. Therefore, if applying the
central condition, the replacements in the final row of
Table 3 should be made when evaluating equations (27)
and (28). Note that this implies that ⟨Ns⟩calculated
from equation (52; or any similar equation) will notbe
the true mean number of satellites, and that a covari-
ance between NcandNsis generated. Recent studies
also show that the distribution of galaxies can be signifi-
cantly non-Poissonian in a mass-dependant manner, and
if ignored this can potentially bias cosmological results
(Dvornik et al. 2018; Avila et al. 2020; Beltz-Mohrmann
et al. 2020; Hadzhiyska et al. 2022; Dvornik et al. 2023).
Example HODs are shown in Fig. 6 where the small dif-
ference to the mean and variance of the satellite galaxy
distribution when imposing the central condition can be
seen. We show example HODs from surveys that target
red (e.g., BOSS; parameters taken from Zhai et al. 2017)
and mostly blue (e.g., GAMA; parameters taken from
Smith et al. 2017) galaxies. Red galaxies are mainly cen-
trals, with a few satellites, while blue galaxies are mainly
satellites at high halo mass10. There are more suitable
HOD models that describe purely blue samples, such as
star forming galaxies which are normally identified as
emission line galaxies (for example Avila et al. 2020).
4.2.Intrinsic Alignments of Galaxies
Galaxy formation processes are expected to imprint
a correlation between the ellipticity of a galaxy and its
environment, hence also with its neighbours. As the ob-
served correlation between galaxy shapes is the core mea-
10The parameters used for the mostly blue sample are taken
from Figure 4 of Smith et al. (2017) for r-band magnitude −21.surement to detect weak gravitational lensing by large-
scale structure, it is critical to determine the correlations
that arise purely from the intrinsic alignment (IA) of
galaxies. Without accurate IA models, robust cosmolog-
ical constraints can not be extracted from weak lensing
observations (see Joachimi et al. 2015, for a review).
Luminous red galaxies have been observed to align
with their local density field (see for example Mandel-
baum et al. 2006; Joachimi et al. 2011), but the intrin-
sic alignment between blue galaxies has yet to be de-
tected (Johnston et al. 2019). This suggests that differ-
ent shape-formation mechanisms may be in place. One
hypothesis is that the ellipticity of red/elliptical galaxies
is determined by the linear tidal field (Catelan et al. 2001;
Hirata & Seljak 2004), with blue/spiral galaxies gaining
their shape through a tidal-torque mechanism (Sch¨ afer
2009). Schneider & Bridle (2010) suggest that satellite
galaxies may also be subject to an infall alignment mech-
anism where their ellipticity points towards the centre
of their parent halo. Observations find a more complex
scenario with satellite radial alignment detected on small
scales, changing to a random alignment on large scales
(Georgiou et al. 2019), with the alignment strength also
sensitive to luminosity (Singh et al. 2015; Huang et al.
2018).
The halo model framework provides a route to encode
this complexity to define a flexible IA cosmological model
(Schneider & Bridle 2010). Fortuna et al. (2021) adopt
the commonly-used Bridle & King (2007) Non-linear Lin-
ear Alignment model (NLA) to describe the alignment
between central galaxies. The NLA model is based on
the Hirata & Seljak (2004) linear tidal field alignment
model where galaxy shape is determined not from the
properties of its parent halo, but from the external den-
sity field. This approach allows us to bypass the need
to model halo asphericity (see Section 5.7) that is known
to correlate with galaxy shape in hydrodynamical simu-
lations (Chisari et al. 2017; Xu et al. 2023). The NLA
model augments the linear model by replacing the linear
matter power spectrum with a non-linear version, such
ashmcode , which was found to improve the agreement
of the model with IA numerical simulations (Heymans
et al. 2006). The NLA matter-intrinsic ellipticity power
spectrum, commonly referred to as ‘GI’, is given by
PNLA
GI(k) =−AIA1 +z
1 +zpivotηC1ρcritΩm
DPnon−linear
mm (k),
(54)
where the amplitude, AIA, and the redshift evolution pa-
rameter, η, are free parameters that are usually fitted to
the data, Dis the linear growth factor, zpivot is an arbi-
trary pivot redshift and C1is a constant defined to match
early IA observations (Brown et al. 2002). Fortuna et al.
(2021) then use an HOD to estimate the fraction of blue
and red centrals to determine the ‘two-halo’ part of the
matter-intrinsic ellipticity power spectrum with
P2h
GI(k) =fred
cenPNLA,red
GI (k) +fblue
cenPNLA,blue
GI (k).(55)
Here different amplitudes (and sometimes η) for the NLA
model of the red and blue central populations are facili-
tated, although Fortuna et al. (2021) show that this may
not be necessary as the colour dependence of the IA sig-
nal is not seen when restricting the sample to central17
galaxies.
As the halo population is, on average, spherical, the
average inter-halo satellite-central alignment is zero. The
‘one-halo’ IA term then derives from the alignment of
satellites with each other and the local matter field with
P1h
GI(k) =Z
dM n(M)M
¯ρmfs⟨Ns|M⟩
¯ng|ˆγI(k|M)|ˆU(M, k).
(56)
Here n(M) is the halo mass function (Section 3.2), fsis
the fraction of satellites which may vary as a function
of redshift, ⟨Ns|M⟩is the halo occupation distribution
of satellites (equation 52), ¯ ngis the mean number den-
sity of galaxies (equation 20), and ˆU(M, k) is the Fourier
transform of the normalised matter density profile (equa-
tion 6). The alignment strength depends on ˆ γI, the den-
sity weighted average of the projected satellite elliptic-
ity, assuming all satellites point towards the halo centre.
This term can also include a radial dependence, to decor-
relate the alignment on large scales.
In this section we have outlined the halo model for
the correlation between intrinsic galaxy ellipticity and
the density field, the ‘GI’ term. We refer the reader to
Schneider & Bridle (2010) for the equivalent terms for
the correlation between intrinsic shapes, also known as
the ‘II’ term. Both terms contaminate a tomographic
weak-lensing analysis. Fortuna et al. (2021) argues that
this halo model approach is preferable to the most of-
ten used NLA model, as it provides a natural route to
include observations of the changing fraction of red and
blue galaxies across the redshift range of the weak lens-
ing survey, in addition to direct measurements of satellite
alignments within groups.
4.3.Thermal Sunyaev-Zeldovich effect
The thermal Sunyaev-Zeldovich (tSZ) effect arises
when CMB photons are scattered by free electrons, pre-
dominantly those hot electrons found in galaxy clusters.
This results in a spectral distortion of the CMB black-
body spectrum with a characteristic frequency depen-
dence, and this (Compton- ysignal) can be extracted
from CMB temperature data. The strength of the ysig-
nal depends on the product of the free electron temper-
ature and density, a quantity that has units of pressure,
and it is therefore the electron-pressure profile that is
relevant for tSZ halo-model calculations. The number of
free electrons in a halo scales with M, and the temper-
ature scales as ∼M2/3, so the overall profiles scales like
∼M5/3, which means that the shape and amplitude of
spectra involving tSZ are determined by more massive
haloes than either matter or galaxies, whose profiles scale
exactly as Mand∼M(if satellite dominated) respec-
tively. This in turn implies that spectra involving tSZ
are relatively sensitive to σ8(Refregier & Teyssier 2002;
Komatsu & Seljak 2002), which arises because the high-
mass end of the halo mass function is sensitive to σ8.
This also means that the one-halo term is comparatively
high amplitude, and the transition region in the power
spectrum occurs at a relatively larger scale (e.g., Mead
et al. 2020). The dependence on gas temperature makes
tSZ an interesting direct probe of baryonic feedback (e.g.,
McCarthy et al. 2014; Hojjati et al. 2015). A good peda-
gogical discussion of the halo model in the context of tSZis provided by Hill & Pajer (2013), as well as the idea of
masking massive low-redshift clusters in order to boost
the signal-to-noise (see also Hill et al. 2018).
Electron pressure profiles can be derived from theoret-
ical arguments (e.g., Komatsu & Seljak 2001; Ostriker
et al. 2005) or from fitting to observational data and
simulations (e.g., Arnaud et al. 2010, the so-called uni-
versal pressure profile). It is clear that concepts like
non-thermal pressure support and baryonic feedback af-
fect the pressure distribution with galaxy clusters (e.g.,
Shaw et al. 2010), and therefore that models based on
hydrostatic equilibrium are overly simplified.
While the tSZ auto spectrum can be measured, the cos-
mological constraints from this are in disagreement with
those from more developed probes (e.g., Planck Collab-
oration XXII 2016), possibly due to the self-correlation
of residual systematics in the ymaps (although see Mc-
Carthy et al. 2014; Horowitz & Seljak 2017; Bolliet et al.
2018). With the auto spectrum suspect, tSZ halo mod-
els have been used in cross correlation by: Addison et al.
(2012; Cosmic Infrared Background CIB); Hajian et al.
(2013; X-ray clusters); Hill & Spergel (2014; CMB lens-
ing); Ma et al. (2015; galaxy lensing); Vikram et al.
(2016; galaxy groups); Tanimura et al. (2019; galaxy
clustering); Koukoufilippas et al. (2020; galaxy cluster-
ing); Yan et al. (2021; CIB, galaxy clustering); Maniyar
et al. (2021; CIB). Much of the focus is on measuring the
pressure bias from the large-scale portion of the power
spectrum, which can be thought of as the k→0 limit
of the pressure integral that contributes to the two-halo
term
⟨bPe⟩=Z∞
0Pe(M)b(M)n(M) dM , (57)
where Pe(M) is the mean electron pressure in a halo of
mass M. Other focus is on the so-called hydrostatic-
mass bias , which arises due to deviations of the gas from
hydrostatic equilibrium, and this biases inferred cluster
masses compared to more direct (e.g., weak lensing) mea-
surements.
4.4.X-rays
X-rays are emitted via the bremsstrahlung process,
when the direction-of-travel of free electrons is modified
by an interaction with a proton. Since this is a two-
body scattering process the total contribution of a halo
profile scales like M2×T∼M8/3, even more strongly
than electron pressure. This ensures that the X-ray auto
spectrum will be completely dominated by the one-halo
contribution (unless masking is applied), which in turn
leads to a strong dependence on σ8(Diego et al. 2003)
via the dependence of the high-mass tail of the halo mass
function. Halo models of X-rays maps have been used in
cross-correlation analyses by: Hurier et al. (2014; 2015;
tSZ); Singh et al. (2017; AGN galaxy clustering); Hurier
et al. (2019; CMB lensing).
4.5.Cosmic Infrared Background
Warm dust in star-forming galaxies emits infrared radi-
ation, which can be detected by space-based telescopes.
The halo signal will be proportional to the amount of
dust in a halo, which in simple models can be taken
to scale with the number of galaxies (e.g., Xia et al.
2012), although different populations of galaxies (e.g.,18
spirals, star-burst, proto-spheroids) can also be consid-
ered as long as an occupation model for each is specified.
Given the galactic origin, one may expect the halo pro-
file of CIB emission to be similar to that of galaxies.
Note that CIB flux is typically measured in frequency
bins, and CIB emission from distant galaxies will be red-
shifted, so the resulting angular power spectra will mix
galaxy populations and redshifts in unintuitive ways. Xia
et al. (2012) considered the CIB power spectrum while
Addison, Dunkley & Spergel (2012) considered the cross
spectrum of CIB and tSZ. Addison, Dunkley & Bond
(2013) suggested that evolution of the dust spectral en-
ergy distribution and scale-dependent halo bias (i.e. βnl)
may be required to self consistently understand one- and
two-point functions of the CIB within the same theoret-
ical framework. More recently, Maniyar et al. (2021) has
presented a halo model where CIB emission is tied to the
halo-mass accretion history.
4.6.Neutral hydrogen
Neutral hydrogen ( hi) emits characteristic 21 cm wave-
length radiation when the electron and proton spin align
or misalign. The profile signal will scale with Mand the
fraction of hiin a halo, but hiis eroded by heat and
AGN activity, so the signal will be dominated by com-
paratively low-mass haloes that still retain significant hi
reservoirs. Ingredient lists for the hiabundance and halo
profiles can be found in Padmanabhan & Refregier (2017)
and Villaescusa-Navarro et al. (2018), and clustering cal-
culations are presented in Padmanabhan et al. (2017),
Feng et al. (2017; in cross-correlation with Lyman- α)
and Schneider, Giri & Mirocha (2021). Wolz et al. (2019)
investigates shot noise in the power spectrum of hiunder
differing assumptions about the source of hiemission –
either co-located with galaxies or with dark matter.
4.7.γ-rays
If dark matter has a significant self-interaction cross
section then dark matter–dark matter annihilation
events are expected to produce a potentially detectable
flux of γ-rays. This signal scales with the square of the
dark-matter density, with the result that halo cores, low-
mass haloes and subhaloes are expected to produce the
most significant contributions. The cross correlation of
gamma ray maps with large-scale structure has been in-
vestigated by Shirasaki et al. (2014) and Tr¨ oster et al.
(2017) using halo models to generate theory curves and
constrain the cross section.
5.EXTENSIONS TO THE STANDARD HALO MODEL
The standard derivation outlined in Section 2.1, its ex-
tension to discrete tracers outlined in Section 2.2 and sets
of ingredients like those mentioned in Section 3, consti-
tutes most of what is commonly called ‘the halo model’ in
the literature. In Fig. 7 we demonstrate the performance
of the standard calculation (ΛCDM; z= 0; ∆ h= 200;
Tinker et al. 2010 mass function and bias; Duffy et al.
2008 concentration–mass relation; Zheng et al. 2005
satellite-dominated HOD with Mmin= 1013h−1M⊙;σ=
0.5;M0=Mmin;M1= 1014h−1M⊙;α= 1) compared to
state-of-the-art semi-analytical theoretical calculations
for matter, galaxy and matter-galaxy power from the
darkemu (Nishimichi et al. 2019), which is accurate at
102
101
100101100101102103104105P(k)/(h1Mpc)3
matter
matter-galaxy
galaxyRef models
two-halo
one-halo
102
101
100101
k/hMpc1
0.800.850.900.951.001.051.101.151.20Phm(k)/PDarkQuest(k)
Standard halo model
HMcode
With non-linear halo biasFigure 7. The performance of the analytical halo model calcula-
tion compared to state-of-the-art semi-analytical calculations from
darkemu atz= 0 for matter, galaxy and matter-galaxy power
spectra. darkemu is accurate at the 4% level relative to simu-
lations (shaded region). The upper panel shows the total P(k)
(solid) and the one-halo (dotted) and two-halo (dot-dashed) terms.
The lower panel shows the ratio between the halo model and the
darkemu power spectra. The vanilla halo model predictions (solid
curves) show errors of between ∼10% and ∼15% with respect
to the reference model. When the non-linear halo bias, calculated
using the same emulator, is included (dashed lines) the error is
reduced to <10% for intermediate scales. Including this effect in
the halo model works best for the galaxy power spectrum bringing
its error to within ∼5% of the reference model. This is because
the dark emulator can only estimate the halo-halo power spectrum
for more massive haloes, which host most of the galaxies that con-
tribute to the signal. When modelling matter or matter-galaxy
power spectra, an estimate of the clustering of lower mass haloes
is also needed. As a result we fail to achieve the same level of
accuracy for these power spectra. The hmcode prediction on the
other hand provides a good agreement with the darkemu matter
power spectrum. hmcode is accurate at the 2 .5% level compared
to the simulations it was calibrated against.
the∼4% level relative to simulations. We see that the
analytical calculation is in error at the ∼15% level, with
a similarly-shaped residual for each power spectra. At
k∼0.03hMpc−1we see good agreement, where differ-
ences between the halo model and darkemu originate
from differences in linear halo bias. At k∼0.1hMpc−1
we see the standard halo models over predict the power,
which is due to perturbative effects suppressing the true
power at these scales, but this not being included in the
halo model. Including the non-linear halo bias amelio-
rates this because the non-linear halo clustering contains19
these non-linear effects. At k∼0.7hMpc−1all halo mod-
els under-predict the power, which is somewhat corrected
once the non-linear halo bias is added. For k >2hMpc−1
the match is quite good, but degrades at smaller scales
where the shapes of the halo profiles in the one-halo term
become important. For the matter power we also com-
pare hmcode (Mead et al. 2021) with darkemu and
find them in good agreement. hmcode is accurate at
the∼2.5% level relative to simulations.
To improve these discrepancies, many authors have
considered extensions to the standard model, and we dis-
cuss some of these here. These extensions will usually re-
quire some new ingredient to be calibrated from simula-
tions. The following subsections here are loosely ordered
in terms of the scale they have an impact on, from largest
to smallest. Some of the non-standard approaches only
apply to power spectra for a specific tracer combination,
while others offer more general potential improvements.
5.1.Smooth matter
When a halo finder is run on N-body simulation out-
put, it commonly allocates ∼half of the simulated mass
to haloes. The remaining half is either in structures of
low particle number (a threshold of ∼200 particles is of-
ten adopted) or else looks to be approximately smoothly
distributed in the inter-halo medium. If the simulation is
re-run with more N-body particles low-mass haloes are
often identified in regions that were previously thought
to be devoid of haloes. It remains an unsolved problem
in cosmology to determine whether all mass in the Uni-
verse is bound in haloes of ever lower masses, although
there are compelling theoretical arguments (e.g., Press
& Schechter 1974; Bond et al. 1991), and simulations
suggest that this should be so (e.g., Angulo et al. 2017;
Wang et al. 2020), at least for perfectly cold dark matter
particles11.
Halo mass functions are fitted to data from measured
haloes, above some mass threshold, and sometimes the
fitting forms are constrained such that all mass in the
universe iscontained in haloes if the fitting function is
interpreted literally (e.g., Sheth & Tormen 1999). Some
authors have considered how a genuinely smooth compo-
nent of matter could be added to the halo model, either
in the context of WDM (Smith & Markovic 2011), or in
the context of gas expelled from haloes by AGN feedback
(Fedeli 2014; Debackere et al. 2020; Mead et al. 2020). In
all cases the smooth matter is taken to be distributed as
per the linear matter perturbations, via a biased linear
power spectrum. In the case of matter spectra, the bias
of the smooth component is constrained by the fact that
an unbiased linear spectrum must be returned at large
scales.
van Daalen & Schaye (2015) used N-body experiments
to test the contribution of smooth (or non-halo) matter
to the overall matter power spectrum. If only matter in
FoF haloes (sometimes called groups) is used, then es-
sentially all power for k >3hMpc−1can be accounted
for, but if SO haloes are used then this drops to between
80 and 95% of the power, depending on the overdensity
threshold. In the SO case, presumably the remaining
11Although note that any realistic particle-based dark-matter
model has at least some streaming velocities, which translates to
some unbound particlespower arises from dense material just outside the (artifi-
cial) spherical halo boundary, which is contained within
FoF groups. It is less clear how this extra-halo material
contributes at intermediate scales, or if is better to think
of it as genuinely smooth matter, or matter that would
resolve itself into low-mass haloes were the simulation to
be run with higher resolution.
5.2.Voids
In the canonical (linear halo bias) halo model, only
‘linear’ voids will be present, which enter through the
lack of haloes in low-density regions. However, it is
clear from visual inspection of the particle distribution
inN-body simulations that the distribution of voids in
the Universe is not a Gaussian random field in detail.
Voivodic, Rubira & Lima (2020) create a version of the
halo model that explicitly accounts for voids and which
therefore requires a void abundance, linear bias and pro-
file to be specified. Voids are essentially considered in
the same way as haloes, but with under-density profiles
rather than over-density profiles. This then allows for
the calculation of correlations such as halo–void, void–
void etc. In addition, ‘dust’ (non-halo, non-void) matter
is also accounted for in the same manner as described in
Subsection 5.1. Because voids are physically larger than
haloes, their ‘one-halo’ (one-void) term peaks at larger
scales than the standard one-halo term, and therefore
adds some (much-needed) power into the transition re-
gion of the matter power spectrum. Note that in the
non-linear halo bias approach advocated in Section 3.4,
the two-point contribution voids will be included in the
βnlfunction, since voids are really a spatially-coherent
lack of haloes, and it is the two-point function of this
spatial coherence that is captured by βnl.
5.3.Perturbation theory
To go beyond linear halo bias and linear power
Valageas & Nishimichi (2011); Mohammed & Seljak
(2014); Seljak & Vlah (2015); Schmidt (2016); Hand et al.
(2017); Philcox et al. (2020) have all considered replacing
the linear theory spectrum with something higher-order
that can, in principle, be calculated via perturbation the-
ory. These approaches have been demonstrated to im-
prove the halo-model prediction for the matter spectrum
in the quasi-linear regime, but it is not obvious how to
translate their results to power spectra of tracers other
than the matter – if linear bias is employed the problem
indicated in Fig. 4 remains. Smith et al. (2007) jointly
consider a perturbative bias expansion with perturbation
theory for the matter, getting good results in the mildly
non-linear regime. Recently, Sullivan, Seljak & Singh
(2021) have looked at biased tracers together with a per-
turbative model at large scales, with an exclusion term
incorporated for halo and galaxy clustering. However,
the bias model is still effectively linear and fitting param-
eters mask the underlying physical relationship between
halo, matter, and galaxy clustering.
Valageas & Nishimichi (2011) combined perturbation
theory with the halo model to improve accuracy on quasi-
linear scales. Other schemes of which we are aware that
are halo-model inspired and that can be used for matter
spectra are the halo-Zel’dovich perturbation theory of
Mohammed & Seljak (2014), Seljak & Vlah (2015), and20
Sullivan et al. (2021). Here the two-halo term is modelled
using the Zel’dovich (1970) approximation, while a series
expansion is used for the one-halo term with halo-model
insight used to constrain the allowed terms in the series.
Finally, there is the effective halo model of Philcox et al.
(2020), which uses the effective field theory of large-scale
structure for a two-halo term combined with a standard
one-halo term.
5.4.Excess large-scale power
On large scales, the Fourier halo profiles ˆWu(M, k→
0)∝k0(constant) and therefore the same is true of
the scale-dependence of the one-halo term (equation 13):
P1h
uv(k→0)∝k0, a shot-noise-like contribution. In con-
trast, in the same limit the two-halo term (equation 18)
always has the linear spectrum shape at large scales:
P2h
uv(k→0)∝kns. It is then inevitable that the one-halo
term has more power than the two-halo term at some suf-
ficiently large scale, with the exact scale being governed
by the redshift and the fields uandv. This problem man-
ifests differently in configuration space, since terms ∝k0
contribute only to the r= 0 part of the correlation func-
tion. However, this can cause the integral over the cor-
relation function to be non-zero when r= 0 is included,
contrary to the requirement that the mean overdensity
be zero.
The standard halo model thus predicts that the to-
tal power spectrum transitions from being dominated
by the one-halo term at ultra-large scales (typically
k∼10−4hMpc−1), to two-halo power at large scales
(k∼10−2) and back to one-halo power at small scales
(k∼1hMpc−1). For the autospectrum of a discrete
tracer this might be the correct manifestation of shot
noise dominating the signal at very large scales (see
for example Seljak et al. 2009). For matter–matter, or
matter–galaxies this is wrong (e.g., Ginzburg et al. 2017),
since we would expect intra-halo power to dominate only
at small scales, leaving only inter-halo power at large
scales12. This problem can be seen at the largest scales
shown in Fig. 2. Some authors have suggested correc-
tions to halo exclusion (see section 5.6, Smith et al. 2011;
Schneider et al. 2023) or the interpretation of the 1-halo
term (Valageas & Nishimichi 2011) as possible solutions
to this problem.
Zel’dovich (1970) noted that any local process that
satisfies mass and momentum conservation must have
a large-scale spectrum that decreases faster than k4.
Galaxies do not obey these conservation laws, so can
have a shot-noise contribution at large scales. However,
matter should obey these conservation laws, but they
have not been imposed in the standard formulation of
the halo model, thus leading to the large-scale break-
age (Seljak 2000). Indeed, any shot-noise contribution
to the matter one-halo term at large scales is notob-
served in simulations (Crocce & Scoccimarro 2008). In
the effective models of Mohammed & Seljak (2014); Sel-
jak & Vlah (2015); Hand et al. (2017); Sullivan et al.
(2021) an ad-hoc ‘compensation kernel’ multiplies the
standard one-halo term to enforce mass conservation, k2,
and to ensure that predictions from perturbation the-
12In practice this rarely affects halo-model predictions since the
scales on which this problem is manifest are so large.ory are recovered on large scales. k2scaling is sufficient
to make the one-halo term subdominant at large scales,
and it was found that enforcing momentum conservation
spoiled predictions in the transition region. Presumably
k4scaling could be enforced with a different form of the
compensation kernel if necessary.
Valageas & Nishimichi (2011) demonstrated that mass
conservation could be imposed in the halo model if a
Lagrangian framework was adopted from the outset, re-
sulting in a one-halo term that decays like k2at large
scales, while Schmidt (2016) enforced mass and momen-
tum conservation and was able to get k4scaling. Hamaus
et al. (2010) showed that the large-scale power of mas-
sive haloes is sub-Poisson. Ginzburg et al. (2017) was
able to incorporate this within the halo model using a
halo-fluctuation field and the general bias expansion.
5.5.Halo compensation
Cooray & Sheth (2002) suggest using ‘compensated’
matter profiles as a way of avoiding excess large-scale
power in matter spectra. These profiles are compensated
in the sense that they have both a positive and a negative
overdensity that exactly cancel, in contrast to standard
profiles that only have positive overdensity. For a com-
pensated matter profile ˆWm(M, k→0)∝k2(rather
than constant) and therefore P1h
mm(k→0)∝k4, in line
with the expectation from mass and momentum conser-
vation (e.g., Smith et al. 2003). This occurs naturally
with compensated profiles, since each is massless and
therefore placing and moving these perturbations incurs
no mass or momentum cost. However, the compensation
also affects the halo-profile that appears in the two-halo
term, which therefore also removes the large-scale, linear
power from the halo model: P2h
mm(k→0)∝k4+nsrather
than kns; the baby is thrown out with the bath water.
This can be understood since compensated profiles have
no overall density perturbation when smoothed on scales
much larger than their radii. The two-halo term then just
re-arranges these zero-density perturbation features, and
when smoothed on a sufficiently large scale this will rep-
resent an unperturbed density field. A simple fix for this
was suggested by Chen & Afshordi (2020, 2022), who
view the density field as a sum of the linear perturba-
tions and the haloes13, if these haloes are compensated
then this two-halo term returns to linear form at large
scales.
5.6.Halo exclusion
One non-linear feature of the halo spectrum that has
received considerable attention in the literature is that of
‘halo exclusion’ (e.g., Takada & Jain 2003; Zehavi et al.
2004; Tinker et al. 2005; Smith et al. 2007; Schneider
et al. 2012; van den Bosch et al. 2013; Baldauf et al.
2013): the fact that haloes have finite radii means that
the halo correlation must drop to zero on scales below the
radii of the two haloes in question. The details of how
this operates depends on the exact definition of haloes
(e.g., Garc´ ıa & Rozo 2019). For example, different algo-
rithms may choose to discard halo centres if they are too
close. The eventual masses of haloes may include dou-
13In the standard halo model the haloes themselves arethe
linear density field.21
ble counted particles that lie within the boundary of two
proximate haloes.
Exclusion is automatically included if using Phhor
βnlcalibrated from simulations (e.g., Nishimichi et al.
2019; Mead & Verde 2021), but must be incorporated
by hand if using a simpler prescription for the two-halo
term (e.g., linear halo bias). The scale at which halo
exclusion becomes relevant depends on halo size and, by
proxy, halo mass. It will kick in at larger scales for more
massive haloes compared to those less massive, and con-
sequently smaller. Since exclusion affects the two-halo
term at small scales, it is a subdominant contribution to
the total power spectrum for some tracer combinations
(e.g., matter–matter), but is important for others (e.g.,
galaxy–halo).
Halo exclusion can be approximately included in
Fourier space by multiplying the halo power spectrum by
some suppressing window function (e.g., Schneider et al.
2013). However, most often halo exclusion is included by
fixing the halo correlation function to zero below some
radius. This strongly suppresses the two-halo term on
scales around the halo radius, but ignores the fact that
one might expect a more gentle truncation for scales near
the halo boundary.
To allow for a smoother transition, Zehavi et al. (2004)
and Tinker et al. (2005) proposed to alter the integra-
tion upper limits in equation (18) to be dependent on
the halo virial radii and the scale in question, in such a
way that the halo-halo correlation is fixed to zero if it
arises from haloes within some distance of each other:
ifr < r h,1+rh,2. A similar scheme was followed by
Smith et al. (2011), and this could be expanded to any
other function of the halo virial radii. Unfortunately, this
makes the halo-model prediction for the overall number
density of galaxies deviate from the true value, so the end
result needs to be corrected by hand to account for this.
In addition, this constraint must be imposed in configu-
ration space, which can make it numerically inefficient if
working in Fourier space (Murray et al. 2020a).
5.7.Halo asphericity and substructure
The standard halo model takes haloes to be perfect
spheres with a hard boundary. However, the reality is
that haloes have no clear boundary and are generally tri-
axial (aspherical) with a typical minor-to-major axis ra-
tio of∼0.6 (Jing & Suto 2002), furthermore this halo as-
phericity may be spatially correlated due to gravitational
tidal fields. This also applies to galaxies (or other fields)
that may exist within haloes, with the galaxy–galaxy
and galaxy–matter intrinsic alignments being a particu-
larly important contaminant in weak gravitational lens-
ing (e.g., Hirata & Seljak 2004). The lowest-order clus-
tering statistics average over all directions, and so a
spherical approximation for the halo profile may be rea-
sonable, but recall that ⟨WuWv⟩appears in the one-halo
term, and therefore any scatter (or covariance) about the
mean profile will contribute power. Particular configu-
rations of higher-order statistics are likely to be more
sensitive to profile shape than two-point statistics (e.g.,
Takada & Jain 2003).
Smith & Watts (2005) were the first to lay the theoret-
ical foundations for including asphericty within the halo
model. A triaxial profile is required, with distribution
functions for the axis ratios, these profiles are then in-tegrated over all orientations in the one- and two-halo
terms. An alignment correlation function is required
to capture spatial alignments and appears in the two-
halo term. In Smith & Watts (2005), halo-model mat-
ter power spectra were found to be lower at the ∼5%
level for k∼1 – 10 hMpc−1relative to a model with
no triaxiality, with the difference mainly driven by high-
mass haloes. An alternative approach to environmental
dependence is presented by Gil-Mar´ ın, Jimenez & Verde
(2011) where galaxies are split by environment and which
therefore allows cross-correlations between different pop-
ulations of galaxies to be computed. Tangentially related
to these methods are papers that use the halo model to
estimate the intrinsic alignment signal (e.g., Schneider
& Bridle 2010; Fortuna et al. 2021) for weak lensing.
In these cases, inter-halo intrinsic alignment is driven by
large-scale tidal alignment, whereas intra-halo tides align
halo satellite galaxies with the central galaxy.
Realistic haloes contain clumpy substructure, but this
is ignored when a smooth halo profile is adopted for use in
a halo-model calculation. Substructure can be included
by breaking the halo into smooth and clumpy compo-
nents and including a substructure mass function (e.g.,
Sheth & Jain 2003; Dolney et al. 2004; Giocoli et al.
2010). Halo models with substructure generally predict a
strong increase in power at small scales ( k≳10hMpc−1)
relative to a model with a smooth halo. Additionally,
matter can be broken down into that in clumps and
that in the smooth halo, and it is then possible to cal-
culate cross correlations between the clumps (or galaxies
therein) and the surrounding matter, which may be more
appropriate for galaxy–galaxy lensing.
The impact of halo alignment can also be investigated
using simulations: Halo particles (or galaxies) can be
randomly rotated about the halo centre to artificially
‘spherize’ the halo; alternatively, individual haloes can
be coherently, but randomly, rotated to break intrinsic
correlations in the cosmic web. Such numerical experi-
ments were performed by van Daalen, Angulo & White
(2012) for the case of galaxy clustering, where break-
ing intrinsic alignments was shown to decrease the power
spectrum by ∼2% at 0 .1≲k/ hMpc−1≲1 and break-
ing alignments within individual haloes was shown to
decrease the power, starting with a 1% level effect at
k≳0.2hMpc−1and reaching a more dramatic ∼20%
fork≃10hMpc−1. These are quite significant effects
on the power, but clearly the overall impact of these ef-
fects will depend on the galaxy sample. To investigate
the impact of substructure on the matter power spec-
trum Pace et al. (2015) performed a similar experiments
to van Daalen et al. (2012), but for matter profiles, show-
ing that power at k≳0.3hMpc−1was subdued at the
≳0.5% level for coherent rotation and ≳1% level for
spherizing rotation (which removes halo substructure).
It was also demonstrated that the two types of rotations
have similar ( ≳1% for k≳0.3hMpc−1) level effects on
the cross spectrum between those particles inside and
outside of haloes (a proxy for the substructure–matter
cross spectrum). These differences increase at smaller
scales and are likely to be strongly dependent on the
combination of tracers considered. Note well that halo
profiles measured from simulations are often subject to
the ‘spherizing’ technique discussed in this paragraph if22
they are measured from the stacked profiles.
5.8.Scatter in halo properties and assembly bias
When matter profiles are measured from simulations
a significant scatter is observed in the relation between
halo concentration and mass. For concentration mea-
sured for spherical NFW haloes, this scatter is approxi-
mately log-normal with σlnc∼0.3 (e.g., Jing 2000; Bul-
lock et al. 2001). The scatter may contain cosmological
information if it relates to the scatter in halo-formation
times, which itself depends on the power spectrum and
can be estimated using extended-Press-Schechter theory
(e.g., Bond et al. 1991).
However, this scatter is often ignored in the halo
model, and instead the mean halo profile and the mean
concentration–mass relation are used. This is not cor-
rect in detail because it is the expectation value of the
squared halo profile that appears in the one-halo term
(equation 13). In the limit that this scatter is not spa-
tially correlated, its impact may be accounted for by
introducing a second integral within equation (13) over
the probability distribution of halo concentrations (e.g.,
Cooray & Hu 2001; Dolney et al. 2004; Giocoli et al.
2010).
Realistic scatter boosts the matter power at the few
per-cent level for k≳10hMpc−1, but may have a larger
impact for other spectra or higher-order spectra. It
may be that the effect of this can be captured by us-
ing the standard deviation of the halo concentration re-
lation, rather than the mean or median. In the spatially-
correlated case this scatter is difficult to account for (al-
though the methods of Smith & Watts 2005 could be
employed), and falls under the general heading of ‘as-
sembly bias’, requiring its own power spectrum. In con-
trast, for galaxy power spectra the spatially-uncorrelated
scatter in halo-occupation number is usually accounted
for (via the variance that emerges from the expectation
values in equations 26 and 27). If a cross spectrum is
calculated there is also a possible covariance between the
halo profiles of the two tracers: Koukoufilippas et al.
(2020) consider this in the tSZ–galaxy cross correlation
as a mass-independent term that then affects the ampli-
tude of the one-halo term. More complicated would be
to consider the profile–structure covariance as a function
of halo mass. Finally, we note that for SO haloes there
will be no scatter in halo boundary as this is fixed by the
halo mass. However, the realistic density field contains
triaxial structures and the scatter in the ‘boundary’ of
these structures may well contribute additional power in
a realistic calculation that accounted for non-spherical
haloes.
6.MODELLING BEYOND-ΛCDM COSMOLOGIES
The halo model provides a framework for modelling
the matter distribution and its tracers in a way that is
not limited to a specific cosmological model. So far, we
have assumed that the underlying cosmological model is
standard ΛCDM. However, the methods discussed can be
applied to a variety of alternative cosmologies, as long as
we have an estimate of their ingredients: the halo mass
function, halo bias, halo profile (and HOD in the case of
galaxies). The halo model has been used to make predic-
tions for non-linear cosmological observables in a variety
of non-standard scenarios. This is achieved either byusing physically-motivated arguments to calibrate ingre-
dients that were fitted to ΛCDM to the new scenario, or
else by running simulations and extracting the required
ingredients (hopefully in a form that permits generalisa-
tion). In Section 3 we saw that the ingredients are usu-
ally calibrated against simulations, with the exception of
a few cases that use theoretical arguments.
6.1.Ingredients measured from simulations
Simulations have demonstrated that the density pro-
file of dark-matter haloes follow a double power law pro-
file across a wide range of cosmological scenarios. This
is perhaps due to the different modes of mass accretion
throughout their life time, where their initial steady mass
accretion phase creates a single power law profile and
their secondary violent merger phase flattens their pro-
file in the inner regions (e.g., Angulo et al. 2017). De-
pending on the cosmology, however, different concentra-
tion, c(M), relations are observed. These can be ex-
tracted from simulations, or somewhat understood via
arguments that relate halo concentration to halo forma-
tion time (Baldi et al. 2010; Diemer & Kravtsov 2015;
Correa et al. 2015; Ludlow et al. 2016; Diemer & Joyce
2019).
We can divide the alternative scenarios into several
general categories, ranging from models that modify the
properties of dark matter or dark energy, such as warm
dark matter (WDM) or dynamical dark energy, models
where gravity is modified, such as f(R) gravity and sce-
narios where extra components are included, for example
massive neutrinos.
A number of WDM simulations have been analysed
with a focus on measuring halo-model ingredients (for
example Schneider et al. 2012, 2013; Lovell et al. 2014;
Ludlow et al. 2016). WDM particles are expected to
wash out structure at smaller scales relative to CDM due
to their free streaming, with a characteristic scale de-
pendence linked to the particle mass. This washing-out
effect is seen in the halo-mass function in N-body sim-
ulations. For high-mass haloes, the abundance follows
ΛCDM, while there are fewer low-mass haloes. In addi-
tion, while massive haloes follow the same halo profile as
in ΛCDM, low-mass halos show a relatively steeper pro-
file in their centre (concentration is non-monotonic with
mass), suggesting that they have endured fewer mergers.
Smith & Markovic (2011) and Viel et al. (2012) consider
the halo model in WDM models, and find that predic-
tions are improved if a genuinely smooth component of
the matter is assumed and accounted for in the bias and
mass function (see Subsection 5.1). There are indica-
tions of an enhanced linear halo bias from both simu-
lations and theoretical work. Adding all of these new
components into a halo model approach, Schneider et al.
(2012) find a 10% agreement with the measured power
spectra from simulations. This may be further improved
with the addition of non-linear halo bias (see Section 3.4).
Aside from WDM, other dark matter models have been
explored in the literature, for example May & Springel
(2021); Dome et al. (2023) simulated fuzzy dark matter.
Dynamical dark energy is perhaps the most well-known
extension to ΛCDM. As a result many simulations in-
clude one or two equation-of-state parameters that de-
scribe the density variation of dark energy with time
(for example Heitmann et al. 2016) and can capture23
the behaviour of a wide range of such models, where
dark energy is minimally coupled (see Rasera et al. 2010,
for quintessence with Ratra-Peebles and SUGRA poten-
tials). These models generally only affect the background
cosmology, but their impact can be seen in the growth of
structures. A dark energy with a negative equation-of-
state parameter, acts as an anti-gravity force emptying
voids and creating a higher contrast cosmic web. Simula-
tions find a relative universality relation for the halo mass
function, at the 10% level, once the linear growth func-
tion is adjusted to include the impact of these dark en-
ergy models (Courtin et al. 2011; Heitmann et al. 2016).
Other dark-energy models, such as clustering dark en-
ergy have also been explored (see Batista & Marra 2017,
which focuses on cluster counts).
Dark energy may also interact with dark matter
through an energy exchange which couples these fields.
The energy can flow either direction, but most interest-
ing are models were dark matter is transformed into dark
energy, as they can potentially explain the dominance of
dark energy in the current epoch. Baldi et al. (2010);
Baldi (2023) simulations show that, as expected, the en-
ergy transfer from dark matter to dark energy reduces
the abundance of haloes as well as halo concentration,
across all masses. Such models have also been explored
via spherical collapse in the literature, finding qualita-
tively consistent results (Wintergerst & Pettorino 2010;
Tarrant et al. 2012; Barros et al. 2019, 2020).
Alternative gravity models that were originally intro-
duced to account for the origins of Λ, have more recently
been explored to test the validity of general relativity at
cosmological scales. These models require a screening
mechanism so that they reduce to the general relativity
solutions at smaller scale and/or denser regions in the
Universe. Simulations for the more popular models exist
today. For example f(R) has been simulated in Schmidt
et al. (2009); Li et al. (2012), showing that the abun-
dance of rare massive halos increases while their bias
is decreased and their profile remains unchanged (this
is preserved by the screening mechanism), as a result
power spectra are enhanced in a scale dependant man-
ner. Dvali, Gabadadze & Porrati (DGP; 2000) gravity
was explored in Schmidt et al. (2010); Schmidt (2010)
who find qualitative agreement between spherical col-
lapse and simulations. Barreira et al. (2014) simulate
two types of Galileon gravity and explored their impact
on halo model ingredients.
Massive neutrinos are a form of (subdominant) hot
dark matter that can wash out structures on larger scales
compared to WDM. The impact of massive neutrinos
on structures has been studied in simulations assuming
varying levels of model complexity, starting from back-
ground only effects to including neutrino particles and
evolving them alongside the cold dark matter particles
(Brandbyge et al. 2008; Brandbyge & Hannestad 2009;
Viel et al. 2010; Agarwal & Feldman 2011; Bird et al.
2012; Massara et al. 2014; Upadhye et al. 2014). Since
modelling the behaviour of the massive neutrino particles
is challenging, these studies disagree on the best method-
ology and their associated accuracy.
The impact of these models can be included in the halo
model to reach percent-level agreement for power spectra
when compared to simulation results. Mead et al. (2016),
for example, models the effect of several alternative cos-mologies within the hmcode formalism: dynamical dark
energy (calibrated against their own simulations), cou-
pled dark matter-dark energy (calibrated against Baldi
et al. 2010), massive neutrinos (calibrated against Mas-
sara et al. 2014), f(R) gravity (calibrated against Li
et al. 2013). They find a few percent agreement in all
cases, aside from the Vainshtein (1972) screening sce-
nario, which achieves a 10% accuracy. Dentler et al.
(2022) also used the hmcode formalism to set con-
straints on fuzzy dark matter from data. Note that hm-
code only provides matter power, and cannot easily be
generalised to other tracers.
Most simulations of alternative models do not include
baryonic effects such as AGN feedback. There are, how-
ever, a limited number of studies that have explored hy-
drodynamical simulations for alternative models. Puch-
wein et al. (2013) introduce a code for hydrodynamical
simulation of modified gravity models and show some de-
generacies on the power spectrum between the effects of
baryonic feedback and f(R) gravity. The impact of f(R)
gravity on abundance and other properties of clusters is
further investigated by Arnold et al. (2014). Other au-
thors have included baryons as a separate component
in their simulations to account for the differing cou-
pling mechanisms between baryons and other particles,
although they do not account for the full hydrodynam-
ics of baryons (for example Baldi et al. 2010; Hammami
et al. 2015; Baldi 2022).
6.2.Spherical collapse
The most accurate understanding of how structure
formation proceeds in non-standard cosmologies derives
from simulations. However, considering the collapse of
a single spherical perturbation in an otherwise feature-
less universe, the so-called ‘spherical-collapse model’, has
provided valuable insights about the formation process,
effective linear-collapse threshold, and the virial radius
of collapsed haloes.
The differential equation governing the collapse of a
perturbation of uniform overdensity δis
¨δ+ 2H˙δ−4
3˙δ2
1 +δ=3
2Ωm(a)H2δ(1 +δ), (58)
where dots denote time derivatives and it has been as-
sumed that an initially uniform perturbation remains
uniform throughout its evolution. His the (time-
dependent) Hubble parameter and Ω m(a) is the (time-
dependent) value of Ω m. Usually (but not always14)
solving equation (58) for an initially small perturbation
reveals that the perturbation grows, reaches a maximum
size, and then collapses (due to the spherical symmetry
this collapse is to an infinite-density singularity). Equa-
tion (58) can be linearised to give
¨δ+ 2H˙δ=3
2Ωm(a)H2δ , (59)
which is the familiar differential equation governing the
evolution of matter perturbations on sub-horizon scales.
Equations (58) and (59) can be solved in tandem, for
the same initial condition, to reveal what value linear
14Some perturbations can be prevented from collapsing as dark
energy, or similar, comes to dominate the expansion.24
theory would predict when the non-linear theory reaches
collapse. In an Einsten–de Sitter universe this value is
the oft-quoted δc≃1.686, but this value has some cos-
mology dependence, for example in an Ω m= 0.3 ΛCDM
universe δc≃1.676, lower by ∼0.5% (e.g., Nakamura &
Suto 1997). As we discussed at the end of Section 3.2, in-
cluding the cosmology dependence of δccan improve the
mass-function universality and halo-model predictions.
Of course, real perturbations are not perfectly spher-
ical, and even if they were, inhomogeneity in the true
gravitational field would distort them from this idealised
form. No perturbation will collapse to a singularity but
instead will equilibrate into a roughly spherical struc-
ture with a density gradient and with kinetic and poten-
tial energy split as per the virial theorem (a virialized
halo). If one takes the point of halo formation as given
by the time the spherical-model would predict a singular-
ity to form, one can then derive a rough estimate for the
density of the resulting structure by applying the virial
theorem at the point of collapse to derive a radius. In
an Einstein–de Sitter universe this gives the result that
the halo overdensity should be ∆ v≃178, independent
of halo mass. This is the origin of the ∼200 overden-
sity criterion that is often used when identifying haloes
in simulations. In an Ω m= 0.3 model ∆ v≃330 or
≃310 depending on whether the contribution of dark
energy is included within the virial theorem or not. Fit-
ting functions for the cosmology dependence of ∆ vcan
be found in Bryan & Norman (1998; ΛCDM) and Mead
(2017; homogeneous dark energy, ignoring dark-energy
contributions to virialization).
Analogues to equation (58) can also be derived and
solved in any fully-specified cosmological model. This
is done for dark energy models (Mota & van de Bruck
2004; Bartelmann et al. 2006; Abramo et al. 2007; Pace
et al. 2010; Wintergerst & Pettorino 2010; Mead 2017;
Barros et al. 2020), but care must be taken with dark en-
ergy perturbations which can be important if its sound
speed is smaller than speed of light (Batista 2021; Batista
et al. 2023). In early dark energy scenarios the initial
conditions for the equations need to be set in the cor-
rect linear growing mode. In coupled dark energy–dark
matter models the coupling needs to be incorporated, as
well as the back reaction of this on the local dark energy.
Spherical collapse in massive-neutrino cosmologies was
investigated by LoVerde (2014). In viable modified grav-
ity models (e.g., Brax et al. 2010; Schmidt et al. 2010;
Schmidt 2010; Borisov et al. 2012; Lombriser et al. 2013;
Kopp et al. 2013; Barreira et al. 2013; Taddei et al. 2014)
screening mechanisms must be incorporated. Spherical
collapse in generalised dark matter has been investigated
by Pace et al. (2020).
6.3.react
While the raw halo model predictions for the mat-
ter spectrum have been shown to be inaccurate at the
∼10%−30% level (e.g., Mead et al. 2015b), it has been
demonstrated that the ratio of halo model predictions
for different cosmologies can more accurately predict the
same ratio measured in simulations (e.g., Schmidt et al.
2010; Schmidt 2010; Mead 2017; Gupta et al. 2023). This
is particularly true if the two cosmologies are chosen such
that they share a linear spectrum in both shape and am-
plitude, and if the spherical-collapse model is used toinclude the cosmology dependence of δcand ∆ v.
Originally presented by Cataneo et al. (2019), the re-
actmethod uses this insight to produce accurate spectra
for dynamical dark energy and modified gravity mod-
els (f(R) and DGP), but also incorporates perturbation
theory. Within the react formalism a pseudo power
spectrum needs to be defined, which has the same shape
and amplitude as the linear power spectrum in the target
cosmology,
Ppsuedo
linear(k) =Ptarget
linear(k). (60)
Although there may not be a match for the pseudo lin-
ear power spectrum under the flat-ΛCDM model, its
evolution to non-linear power spectrum assumes a flat-
ΛCDM model without neutrinos. This evolution can
be calculated using hmcode or emulators (e.g., Giblin
et al. 2019). The non-linear power spectrum is then con-
structed via
Ptarget
non−linear=R(k)Ppsuedo
non−linear(k), (61)
where R(k) is the ‘reaction’. To predict the reaction a
combined halo model and perturbation theory approach
is employed (see Cataneo 2022, for a concise review).
Note that react currently only targets the matter spec-
tra and only predicts the reaction of the power spectrum
to a particular ingredient, and it therefore requires accu-
rate non-linear spectra for ΛCDM as an ingredient.
Updates to react have been presented by Cataneo
et al. (2020; massive neutrinos), Bose et al. (2020; mod-
ified gravity), and Bose et al. (2021; massive neutrinos
and baryonic feedback). Srinivasan et al. (2021) have
applied the reaction methodology to time dependent µ,
which captures the phenomenology of a range of modi-
fied gravity models. The react formalism was applied
to cosmological analysis of the KiDS weak lensing data
to set constraints on f(R) gravity (Tr¨ oster et al. 2021).
7.SOFTWARE
Together with this paper, we provide a python pack-
age that can be used to implement the calculations de-
scribed here: pyhalomodel15. Using the same software
we have also written a pure- python implementation of
hmcode16, although this has not been used to make fig-
ures for this paper. There are several other software
packages that are publicly available and that we have
investigated while writing this review:
•Thedark emulator17of Nishimichi et al. (2021)
emulates the halo mass function and power spec-
trum, and has the capacity to perform galaxy–
galaxy and galaxy–matter halo-model calculations
on top of the emulated quantities. Uniquely, be-
cause the halo power spectrum is emulated, the
non-linear halo bias (called βnlin this paper) is
automatically included.
•Recently, the halomod18package of Murray et al.
(2020b) has been released, which can be used as
15https://github.com/alexander-mead/pyhalomodel
16https://github.com/alexander-mead/HMcode-python
17https://darkquestcosmology.github.io/
18https://github.com/halomod/halomod25
either a python package or as a browser applica-
tion19. Currently, this can be used for matter and
galaxy power spectra, but the code is extendable
to other tracers in principle.
•colossus20(Diemer 2018) is a python toolkit
for calculations pertaining to cosmology, the large-
scale structure of the universe, and the properties
of dark matter haloes. It does not perform halo-
model calculations, but does provide the necessary
ingredients from a variety of different sources.
•The LSST Core Cosmology Library ( ccl21; Chis-
ari et al. 2019a) contains a standard halo model
calculator written in python .
•The hmcode22software, developed by (Mead
2015) performs a version of the standard halo
model calculation for the matter power spectrum.
The calculation is augmented for enhanced accu-
racy. The original source code is written in for-
tran , but a python wrapper23around the for-
tran is also available. hmcode is also included
within camb24.
Other public codes that we are aware of, but that
we have not had a chance to thoroughly investigate are
halogen25(Schaan 2020), aum26(More et al. 2015b)
andclass sz27(Bolliet et al. 2018, 2023).
8.SUMMARY
We have presented a pedagogical review of the halo
model and of its uses in analysing cosmological data. The
flexibility of this framework, and its ability to model non-
linear scales, makes it very attractive for analysing data
from a multitude of probes of large-scale cosmological
structure, and to extract information from smaller scales
where linear perturbation theory no longer applies.
We began with a derivation of the power spectrum
and introduced the concept of two- and one-halo terms.
We continued by describing how the power spectrum is
modified for discrete tracers of matter, such as galaxies
(Section 2). To make a prediction with the halo model
one needs estimates of its ingredients: the abundance
of haloes of different masses (halo mass function, HMF),
the relation between the halo distribution and the under-
lying linear matter field (halo bias) and the distribution
of matter or its tracers within the haloes (halo profile).
Aside from a few exceptions, these ingredients are mea-
sured and calibrated against simulations. In Section 3
we focused on modelling matter power spectra and the
ingredients needed to do so, including the modelling of
baryon feedback and versions of the halo model that are
directly calibrated against simulations, such as halofit
andhmcode .
19https://thehalomod.app
20https://bdiemer.bitbucket.io/colossus/index.html
21https://github.com/LSSTDESC/CCL
22https://github.com/alexander-mead/HMcode
23https://pypi.org/project/pyhmcode/
24camb.readthedocs.io
25https://github.com/EmmanuelSchaan/HaloGen
26https://github.com/surhudm/aum
27https://github.com/CLASS-SZ/class szWe then turned our focus to the modelling of tracers
of matter in Section 4. Once we know how a tracer pop-
ulates the haloes we can predict its distribution using
the same halo model formalism. We began with galaxies
and halo occupation distribution (HOD) and how central
and satellite galaxies need to be treated separately. Aside
from galaxy positions, large-scale structure impacts the
intrinsic alignments of galaxies which can be modelled
in a similar manner. While galaxies are discrete tracers
for matter, other tracers, such as hot electrons in galaxy
clusters, seen for example through the tSZ effect, are dif-
fused tracers. We further discussed a few examples of
such diffuse signals.
The standard ‘vanilla’ halo model makes simplifying
assumptions, such as that all haloes are spherical and
that they are linearly biased with respect to matter. In
Section 5 we relax some of these assumptions and dis-
cuss what improvements are expected when adding more
complexity to the base halo model formalism. We note
that some of these improvements are more important for
two-point functions of specific tracer combinations.
While the majority of the review is focused on solutions
within the standard ΛCDM cosmologies, in Section 6 we
show that the same approach can be applied to exotic
cosmological models and extensions to ΛCDM; for ex-
ample, models with massive neutrinos, f(R) gravity and
dynamical or interacting dark energy models. In these
cases the spherical-collapse model can provide useful in-
sights. In particular, we discuss that although the halo
model can be inaccurate in predicting power spectra, it
can estimate the ratios of non-linear power spectra at
percent level, when the linear power spectra are matched
between the two models. The spherical-collapse solutions
can then be applied to include the cosmology dependence
of key inputs for the halo model. The react formalism,
which we briefly introduce at the end of Section 6, takes
full advantage of this property of the halo model.
Finally, we release a halo model code including
jupyter notebooks for (almost) all figures in this paper
and many demo examples: pyhalomodel . In Section 7
we also listed other halo model related codes that we are
aware of.
The use of the halo model for cosmological analysis has
seen a recent boost (for example Miyatake et al. 2022b;
Tr¨ oster et al. 2022; Dvornik et al. 2023; Amon et al.
2023), thanks to creative applications of corrections and
adjustments to this flexible framework. The halo model
can be applied in a more analytic versus a more simula-
tion based approach. While simulation-based approaches
can be more accurate, they are limited to the range of
models that are simulated, and therefore lose some of
the flexibility of the halo model. Many recent analy-
ses, however, opt for a half-way method that inherits the
best of both worlds. New methods of applying the halo
model, for example react or the inclusion of non-linear
halo bias have the potential to address most or all of the
inaccuracies in the vanilla halo model predictions, while
maintaining flexibility. With these advancements, we ex-
pect the halo model to be applied with more rigour to
upcoming cosmological survey data, which was the main
motivation for writing this review. Finally, we note that
under the halo-model approach there is a pathway for
uniting astrophysics and cosmology.26
ACKNOWLEDGEMENTS
We are thankful for comments from Shahab Joudaki
and Constance Mahony. We are grateful for the con-
structive input from the community and an anony-
mous referee. We acknowledge support from the Eu-
ropean Research Council under grant number 647112
(MA,AM,CH), from the Max Planck Society and the
Alexander von Humboldt Foundation in the framework
of the Max Planck-Humboldt Research Award endowed
by the Federal Ministry of Education and Research (AM,
CH), and the UK Science and Technology Facilities
Council (STFC) under grant ST/V000594/1 (MA,CH).
REFERENCES
Abramo L. R., Batista R. C., Liberato L., Rosenfeld R., 2007, J.
Cosmol. Astropart. Phys., 2007, 012
Addison G. E., Dunkley J., Spergel D. N., 2012, MNRAS, 427,
1741
Addison G. E., Dunkley J., Bond J. R., 2013, MNRAS, 436, 1896
Adhikari S., Dalal N., Chamberlain R. T., 2014, J. Cosmol.
Astropart. Phys., 2014, 019
Agarwal S., Feldman H. A., 2011, MNRAS, 410, 1647
Amon A., et al., 2022, Phys. Rev. D, 105, 023514
Amon A., et al., 2023, MNRAS, 518, 477
Angulo R. E., Hahn O., Ludlow A. D., Bonoli S., 2017, MNRAS,
471, 4687
Angulo R. E., Zennaro M., Contreras S., Aric` o G.,
Pellejero-Iba˜ nez M., St¨ ucker J., 2020, arXiv e-prints, p.
arXiv:2004.06245
Arnaud M., Pratt G. W., Piffaretti R., B¨ ohringer H., Croston
J. H., Pointecouteau E., 2010, A&A, 517, A92
Arnold C., Puchwein E., Springel V., 2014, MNRAS, 440, 833
Asgari M., et al., 2021, A&A, 645, A104
Avila S., et al., 2020, MNRAS, 499, 5486
Baldauf T., Seljak U., Smith R. E., Hamaus N., Desjacques V.,
2013, Phys. Rev. D, 88, 083507
Baldi M., 2022, arXiv e-prints, p. arXiv:2207.11258
Baldi M., 2023, MNRAS,
Baldi M., Pettorino V., Robbers G., Springel V., 2010, MNRAS,
403, 1684
Bardeen J. M., Bond J. R., Kaiser N., Szalay A. S., 1986, ApJ,
304, 15
Barreira A., Li B., Baugh C. M., Pascoli S., 2013, J. Cosmol.
Astropart. Phys., 11, 56
Barreira A., Li B., Hellwing W. A., Lombriser L., Baugh C. M.,
Pascoli S., 2014, J. Cosmol. Astropart. Phys., 4, 29
Barros B. J., Amendola L., Barreiro T., Nunes N. J., 2019, J.
Cosmol. Astropart. Phys., 2019, 007
Barros B. J., Barreiro T., Nunes N. J., 2020, Phys. Rev. D, 101,
023502
Bartelmann M., Doran M., Wetterich C., 2006, A&A, 454, 27
Batista R. C., 2021, Universe, 8, 22
Batista R. C., Marra V., 2017, J. Cosmol. Astropart. Phys., 2017,
048
Batista R. C., de Oliveira H. P., Abramo L. R. W., 2023, J.
Cosmol. Astropart. Phys., 2023, 037
Battaglia N., Hill J. C., Murray N., 2015, ApJ, 812, 154
Beltz-Mohrmann G. D., Berlind A. A., Szewciw A. O., 2020,
Mon. Not. R. Astron. Soc., 491, 5771
Bertschinger E., 1985, ApJS, 58, 39
Beutler F., et al., 2013, MNRAS, 429, 3604
Bhattacharya S., Heitmann K., White M., Luki´ c Z., Wagner C.,
Habib S., 2011, ApJ, 732, 122
Bird S., Viel M., Haehnelt M. G., 2012, MNRAS, 420, 2551
Bocquet S., Heitmann K., Habib S., Lawrence E., Uram T.,
Frontiere N., Pope A., Finkel H., 2020, ApJ, 901, 5
Bolliet B., Comis B., Komatsu E., Mac´ ıas-P´ erez J. F., 2018,
MNRAS, 477, 4957
Bolliet B., Colin Hill J., Ferraro S., Kusiak A., Krolewski A.,
2023, J. Cosmol. Astropart. Phys., 2023, 039
Bond J. R., Myers S. T., 1996, ApJS, 103, 1
Bond J. R., Cole S., Efstathiou G., Kaiser N., 1991, ApJ, 379, 440
Borisov A., Jain B., Zhang P., 2012, Phys. Rev. D, 85, 063518Bose B., Cataneo M., Tr¨ oster T., Xia Q., Heymans C., Lombriser
L., 2020, MNRAS, 498, 4650
Bose B., et al., 2021, MNRAS, 508, 2479
Brandbyge J., Hannestad S., 2009, J. Cosmol. Astropart. Phys.,
5, 2
Brandbyge J., Hannestad S., Haugbølle T., Thomsen B., 2008, J.
Cosmol. Astropart. Phys., 8, 20
Brax P., Rosenfeld R., Steer D. A., 2010, J. Cosmol. Astropart.
Phys., 8, 33
Bridle S., King L., 2007, New Journal of Physics, 9, 444
Brown M. L., Taylor A. N., Hambly N. C., Dye S., 2002,
MNRAS, 333, 501
Bryan G. L., Norman M. L., 1998, ApJ, 495, 80
Bullock J. S., Kolatt T. S., Sigad Y., Somerville R. S., Kravtsov
A. V., Klypin A. A., Primack J. R., Dekel A., 2001, MNRAS,
321, 559
Cacciato M., Lahav O., van den Bosch F. C., Hoekstra H., Dekel
A., 2012, MNRAS, 426, 566
Cacciato M., van den Bosch F. C., More S., Mo H., Yang X.,
2013, MNRAS, 430, 767
Capozziello S., Dialektopoulos K. F., Luongo O., 2019,
International Journal of Modern Physics D, 28, 1950058
Cataneo M., 2022, arXiv e-prints, p. arXiv:2203.11827
Cataneo M., Lombriser L., Heymans C., Mead A. J., Barreira A.,
Bose S., Li B., 2019, MNRAS, 488, 2121
Cataneo M., Emberson J. D., Inman D., Harnois-D´ eraps J.,
Heymans C., 2020, MNRAS, 491, 3101
Catelan P., Kamionkowski M., Blandford R. D., 2001, Monthly
Notices of the Royal Astronomical Society, 320, L7
Chen A. Y., Afshordi N., 2020, Phys. Rev. D, 101, 103522
Chen A., Afshordi N., 2022, arXiv e-prints, p. arXiv:2210.11499
Child H. L., Habib S., Heitmann K., Frontiere N., Finkel H.,
Pope A., Morozov V., 2018, ApJ, 859, 55
Chisari N. E., et al., 2017, MNRAS, 472, 1163
Chisari N. E., et al., 2019a, CCL: Core Cosmology Library
(ascl:1901.003)
Chisari N. E., et al., 2019b, The Open Journal of Astrophysics, 2,
4
Cole S., Kaiser N., 1989, MNRAS, 237, 1127
Cooray A., Hu W., 2001, ApJ, 554, 56
Cooray A., Sheth R., 2002, Physics Reports, 372, 1
Correa C. A., Wyithe J. S. B., Schaye J., Duffy A. R., 2015,
MNRAS, 452, 1217
Courtin J., Rasera Y., Alimi J.-M., Corasaniti P.-S., Boucher V.,
F¨ uzfa A., 2011, MNRAS, 410, 1911
Crocce M., Scoccimarro R., 2008, Phys. Rev. D, 77, 023533
Crocce M., Fosalba P., Castander F. J., Gazta˜ naga E., 2010,
MNRAS, 403, 1353
Debackere S. N. B., Schaye J., Hoekstra H., 2020, MNRAS, 492,
2285
Del Popolo A., Pace F., Le Delliou M., 2017, J. Cosmol.
Astropart. Phys., 2017, 032
Dentler M., Marsh D. J. E., Hloˇ zek R., Lagu¨ e A., Rogers K. K.,
Grin D., 2022, MNRAS, 515, 5646
Despali G., Giocoli C., Angulo R. E., Tormen G., Sheth R. K.,
Baso G., Moscardini L., 2016, MNRAS, 456, 2486
Diego J. M., Silk J., Sliwa W., 2003, MNRAS, 346, 940
Diemer B., 2018, ApJS, 239, 35
Diemer B., 2022, arXiv e-prints, p. arXiv:2205.03420
Diemer B., Joyce M., 2019, ApJ, 871, 168
Diemer B., Kravtsov A. V., 2014, ApJ, 789, 1
Diemer B., Kravtsov A. V., 2015, ApJ, 799, 108
Diemer B., Mansfield P., Kravtsov A. V., More S., 2017, ApJ,
843, 140
Dolney D., Jain B., Takada M., 2004, MNRAS, 352, 1019
Dome T., Fialkov A., Mocz P., Sch¨ afer B. M., Boylan-Kolchin M.,
Vogelsberger M., 2023, MNRAS, 519, 4183
Duffy A. R., Schaye J., Kay S. T., Dalla Vecchia C., 2008,
MNRAS, 390, L64
Dvali G., Gabadadze G., Porrati M., 2000, Physics Letters B,
485, 208
Dvornik A., et al., 2018, MNRAS, 479, 1240
Dvornik A., et al., 2023, A&A, 675, A189
Einasto J., Klypin A. A., Saar E., Shandarin S. F., 1984,
MNRAS, 206, 529
Eke V. R., Navarro J. F., Steinmetz M., 2001, ApJ, 554, 114
Fedeli C., 2014, J. Cosmol. Astropart. Phys., 4, 2827
Fedeli C., Semboloni E., Velliscig M., Van Daalen M., Schaye J.,
Hoekstra H., 2014, J. Cosmol. Astropart. Phys., 8, 28
Feng C., Cooray A., Keating B., 2017, ApJ, 846, 21
Fillmore J. A., Goldreich P., 1984, ApJ, 281, 9
Fong M., Han J., 2021, MNRAS, 503, 4250
Fortuna M. C., Hoekstra H., Joachimi B., Johnston H., Chisari
N. E., Georgiou C., Mahony C., 2021, MNRAS, 501, 2983
Gao L., Navarro J. F., Cole S., Frenk C. S., White S. D. M.,
Springel V., Jenkins A., Neto A. F., 2008, MNRAS, 387, 536
Gao H., Han J., Fong M., Jing Y. P., Li Z., 2023, ApJ, 953, 37
Garc´ ıa R., Rozo E., 2019, MNRAS, 489, 4170
Georgiou C., et al., 2019, A&A, 628, A31
Giblin B., Cataneo M., Moews B., Heymans C., 2019, MNRAS,
490, 4826
Gil-Mar´ ın H., Jimenez R., Verde L., 2011, MNRAS, 414, 1207
Ginzburg D., Desjacques V., Chan K. C., 2017, Phys. Rev. D, 96,
083528
Giocoli C., Bartelmann M., Sheth R. K., Cacciato M., 2010,
MNRAS, 408, 300
Gu S., Dor M.-A., van Waerbeke L., Asgari M., Mead A., Tr¨ oster
T., Yan Z., 2023, arXiv e-prints, p. arXiv:2302.00780
Gupta S., Hellwing W. A., Bilicki M., 2023, arXiv e-prints, p.
arXiv:2301.12016
Hadzhiyska B., et al., 2022, preprint, 14, 1 ( arXiv:2210.10068 )
Hajian A., Battaglia N., Spergel D. N., Bond J. R., Pfrommer C.,
Sievers J. L., 2013, J. Cosmol. Astropart. Phys., 11, 064
Hamana T., et al., 2020, PASJ, 72, 16
Hamaus N., Seljak U., Desjacques V., Smith R. E., Baldauf T.,
2010, Phys. Rev. D, 82, 043515
Hammami A., Llinares C., Mota D. F., Winther H. A., 2015,
MNRAS, 449, 3635
Hand N., Seljak U., Beutler F., Vlah Z., 2017, J. Cosmol.
Astropart. Phys., 2017, 009
Heitmann K., et al., 2016, ApJ, 820, 108
Heymans C., White M., Heavens A., Vale C., van Waerbeke L.,
2006, MNRAS, 371, 750
Heymans C., et al., 2013, MNRAS, 432, 2433
Hikage C., et al., 2019, PASJ, 71, 43
Hildebrandt H., et al., 2017, MNRAS, 465, 1454
Hildebrandt H., et al., 2020, A&A, 633, A69
Hill J. C., Pajer E., 2013, Phys. Rev. D, 88, 063526
Hill J. C., Spergel D. N., 2014, J. Cosmol. Astropart. Phys., 2, 030
Hill J. C., Baxter E. J., Lidz A., Greco J. P., Jain B., 2018, Phys.
Rev. D, 97, 083501
Hirata C. M., Seljak U., 2004, Phys. Rev. D, 70, 063526
Hojjati A., McCarthy I. G., Harnois-Deraps J., Ma Y.-Z., Van
Waerbeke L., Hinshaw G., Le Brun A. M. C., 2015, J. Cosmol.
Astropart. Phys., 10, 047
Horowitz B., Seljak U., 2017, MNRAS, 469, 394
Huang H.-J., Mandelbaum R., Freeman P. E., Chen Y.-C., Rozo
E., Rykoff E., 2018, MNRAS, 474, 4772
Huchra J. P., Geller M. J., 1982, ApJ, 257, 423
Hurier G., Aghanim N., Douspis M., 2014, A&A, 568, A57
Hurier G., Douspis M., Aghanim N., Pointecouteau E., Diego
J. M., Macias-Perez J. F., 2015, A&A, 576, A90
Hurier G., Singh P., Hern´ andez-Monteagudo C., 2019, A&A, 625,
L4
Ishiyama T., et al., 2021, MNRAS, 506, 4210
Jee M. J., Tyson J. A., Schneider M. D., Wittman D., Schmidt
S., Hilbert S., 2013, ApJ, 765, 74
Jenkins A., Frenk C. S., White S. D. M., Colberg J. M., Cole S.,
Evrard A. E., Couchman H. M. P., Yoshida N., 2001, MNRAS,
321, 372
Jing Y. P., 2000, ApJ, 535, 30
Jing Y. P., Suto Y., 2002, ApJ, 574, 538
Joachimi B., Mandelbaum R., Abdalla F. B., Bridle S. L., 2011,
A&A, 527, A26
Joachimi B., et al., 2015, Space Sci. Rev., 193, 1
Johnston H., et al., 2019, A&A, 624, A30
Joudaki S., et al., 2017, MNRAS, 465, 2033
Klypin A., Yepes G., Gottlober S., Prada F., Hess S., 2014,
preprint (arXiv:e-prints 1411.4001),
Knabenhans M., et al., 2019, MNRAS, 484, 5509
Komatsu E., Seljak U., 2001, MNRAS, 327, 1353
Komatsu E., Seljak U., 2002, MNRAS, 336, 1256
Kopp M., Appleby S. A., Achitouv I., Weller J., 2013, Phys. Rev.
D, 88, 084015Korkidis G., Pavlidou V., Tassis K., Ntormousi E., Tomaras
T. N., Kovlakas K., 2020, A&A, 639, A122
Koukoufilippas N., Alonso D., Bilicki M., Peacock J. A., 2020,
MNRAS, 491, 5464
Kwan J., Bhattacharya S., Heitmann K., Habib S., 2013, ApJ,
768, 123
Lacey C., Cole S., 1993, MNRAS, 262, 627
Lacey C., Cole S., 1994, MNRAS, 271, 676
Lawrence E., et al., 2017, ApJ, 847, 50
Leauthaud A., et al., 2017, MNRAS, 467, 3024
Li B., Zhao G.-B., Teyssier R., Koyama K., 2012, J. Cosmol.
Astropart. Phys., 2012, 051
Li B., Hellwing W. A., Koyama K., Zhao G.-B., Jennings E.,
Baugh C. M., 2013, MNRAS, 428, 743
LoVerde M., 2014, Phys. Rev. D, 90, 083518
Lombriser L., Li B., Koyama K., Zhao G.-B., 2013, Phys. Rev. D,
87, 123511
Lopes R. C. C., Voivodic R., Abramo L. R., Sodr´ e Laerte J.,
2019, J. Cosmol. Astropart. Phys., 2019, 026
Lovell M. R., Frenk C. S., Eke V. R., Jenkins A., Gao L., Theuns
T., 2014, MNRAS, 439, 300
Ludlow A. D., Navarro J. F., Angulo R. E., Boylan-Kolchin M.,
Springel V., Frenk C., White S. D. M., 2014, MNRAS, 441, 378
Ludlow A. D., Bose S., Angulo R. E., Wang L., Hellwing W. A.,
Navarro J. F., Cole S., Frenk C. S., 2016, MNRAS, 460, 1214
Luki´ c Z., Reed D., Habib S., Heitmann K., 2009, ApJ, 692, 217
Ma C.-P., Fry J. N., 2000, ApJ, 543, 503
Ma Y.-Z., Van Waerbeke L., Hinshaw G., Hojjati A., Scott D.,
Zuntz J., 2015, J. Cosmol. Astropart. Phys., 9, 046
Macci` o A. V., Dutton A. A., van den Bosch F. C., 2008, MNRAS,
391, 1940
Mahony C., et al., 2022, MNRAS, 515, 2612
Mandelbaum R., Hirata C. M., Ishak M., Seljak U., Brinkmann
J., 2006, Monthly Notices of the Royal Astronomical Society,
367, 611
Manera M., Sheth R. K., Scoccimarro R., 2010, MNRAS, 402, 589
Maniyar A., B´ ethermin M., Lagache G., 2021, A&A, 645, A40
Mansfield P., Kravtsov A. V., Diemer B., 2017, ApJ, 841, 34
Massara E., Villaescusa-Navarro F., Viel M., 2014, J. Cosmol.
Astropart. Phys., 12, 53
May S., Springel V., 2021, MNRAS, 506, 2603
McCarthy I. G., Le Brun A. M. C., Schaye J., Holder G. P., 2014,
MNRAS, 440, 3645
McCarthy I. G., Schaye J., Bird S., Le Brun A. M. C., 2017,
MNRAS, 465, 2936
McClintock T., et al., 2019, ApJ, 872, 53
Mead A., 2015, HMcode: Halo-model matter power spectrum
computation, Astrophysics Source Code Library (ascl:1508.001)
Mead A. J., 2017, MNRAS, 464, 1282
Mead A. J., Verde L., 2021, MNRAS, 503, 3095
Mead A. J., Peacock J. A., Lombriser L., Li B., 2015a, MNRAS,
452, 4203
Mead A. J., Peacock J. A., Heymans C., Joudaki S., Heavens
A. F., 2015b, MNRAS, 454, 1958
Mead A. J., Heymans C., Lombriser L., Peacock J. A., Steele
O. I., Winther H. A., 2016, MNRAS, 459, 1468
Mead A. J., Tr¨ oster T., Heymans C., Van Waerbeke L.,
McCarthy I. G., 2020, A&A, 641, A130
Mead A. J., Brieden S., Tr¨ oster T., Heymans C., 2021, MNRAS,
502, 1401
Miyatake H., et al., 2022a, Phys. Rev. D, 106, 083519
Miyatake H., et al., 2022b, Phys. Rev. D, 106, 083520
Mo H. J., White S. D. M., 1996, MNRAS, 282, 347
Mohammed I., Seljak U., 2014, MNRAS, 445, 3382
Mohammed I., Martizzi D., Teyssier R., Amara A., 2014, preprint
(arXiv:e-prints 1410.6826),
More S., Kravtsov A. V., Dalal N., Gottl¨ ober S., 2011, ApJS, 195,
4
More S., van den Bosch F. C., Cacciato M., More A., Mo H.,
Yang X., 2013, MNRAS, 430, 747
More S., Miyatake H., Mandelbaum R., Takada M., Spergel D. N.,
Brownstein J. R., Schneider D. P., 2015a, Astrophys. J., 806, 2
More S., Miyatake H., Mandelbaum R., Takada M., Spergel
D. N., Brownstein J. R., Schneider D. P., 2015b, ApJ, 806, 2
Mota D. F., van de Bruck C., 2004, A&A, 421, 71
Murray S. G., Diemer B., Chen Z., 2020a, arXiv e-prints, p.
arXiv:2009.1406628
Murray S. G., Diemer B., Chen Z., 2020b, halomod: Flexible
interface for the halo model of dark matter halos (ascl:2009.016)
Nakamura T. T., Suto Y., 1997, Progress of Theoretical Physics,
97, 49
Navarro J. F., Frenk C. S., White S. D. M., 1997, ApJ, 490, 493
Navarro J. F., et al., 2004, MNRAS, 349, 1039
Neto A. F., et al., 2007, MNRAS, 381, 1450
Nishimichi T., et al., 2019, ApJ, 884, 29
Nishimichi T., et al., 2021, DarkEmulator: Cosmological
emulation code for halo clustering statistics (ascl:2103.009)
Nojiri S., Odintsov S. D., Faraoni V., 2018, Phys. Rev. D, 98,
024005
O’Neil S., Barnes D. J., Vogelsberger M., Diemer B., 2021,
MNRAS, 504, 4649
Oguri M., Hamana T., 2011, MNRAS, 414, 1851
Okoli C., Afshordi N., 2016, MNRAS, 456, 3068
Osato K., Flender S., Nagai D., Shirasaki M., Yoshida N., 2018,
MNRAS, 475, 532
Ostriker J. P., Bode P., Babul A., 2005, ApJ, 634, 964
Pace F., Waizmann J.-C., Bartelmann M., 2010, MNRAS, 406,
1865
Pace F., Manera M., Bacon D. J., Crittenden R., Percival W. J.,
2015, MNRAS, 454, 708
Pace F., Sakr Z., Tutusaus I., 2020, Phys. Rev. D, 102, 043512
Padmanabhan H., Refregier A., 2017, MNRAS, 464, 4008
Padmanabhan H., Refregier A., Amara A., 2017, MNRAS, 469,
2323
Pavlidou V., Tomaras T. N., 2014, J. Cosmol. Astropart. Phys.,
2014, 020
Pavlidou V., Korkidis G., Tomaras T. N., Tanoglidis D., 2020,
A&A, 638, L8
Peacock J. A., 2007, MNRAS, 379, 1067
Peacock J. A., Smith R. E., 2000, MNRAS, 318, 1144
Philcox O. H. E., Spergel D. N., Villaescusa-Navarro F., 2020,
Phys. Rev. D, 101, 123520
Planck Collaboration XXII 2016, A&A, 594, A22
Prada F., Klypin A. A., Cuesta A. J., Betancort-Rijo J. E.,
Primack J., 2012, MNRAS, 423, 3018
Press W. H., Schechter P., 1974, ApJ, 187, 425
Puchwein E., Baldi M., Springel V., 2013, MNRAS, 436, 348
Rana D., et al., 2023, MNRAS, 522, 4181
Rasera Y., Alimi J.-M., Courtin J., Roy F., Corasaniti P.-S.,
F¨ uzfa A., Boucher V., 2010, in Alimi J.-M., Fu¨ ozfa A., eds,
American Institute of Physics Conference Series Vol. 1241,
American Institute of Physics Conference Series. pp 1134–1139
(arXiv:1002.4950 ), doi:10.1063/1.3462610
Reed D. S., Bower R., Frenk C. S., Jenkins A., Theuns T., 2007,
MNRAS, 374, 2
Refregier A., Teyssier R., 2002, Phys. Rev. D, 66, 043002
Rudd D. H., Zentner A. R., Kravtsov A. V., 2008, ApJ, 672, 19
Salcedo A. N., Weinberg D. H., Wu H.-Y., Wibking B. D., 2022,
MNRAS, 510, 5376
Schaan E., 2020, HaloGen: Modular halo model code
(ascl:2011.009)
Sch¨ afer B. M., 2009, International Journal of Modern Physics D,
18, 173
Scherrer R. J., Bertschinger E., 1991, ApJ, 381, 349
Schmidt F., 2010, Phys. Rev. D, 81, 103002
Schmidt F., 2016, Phys. Rev. D, 93, 063512
Schmidt F., Lima M., Oyaizu H., Hu W., 2009, Phys. Rev. D, 79,
083518
Schmidt F., Hu W., Lima M., 2010, Phys. Rev. D, 81, 063005
Schneider M. D., Bridle S., 2010, MNRAS, 402, 2127
Schneider A., Smith R. E., Macci` o A. V., Moore B., 2012,
MNRAS, 424, 684
Schneider A., Smith R. E., Reed D., 2013, MNRAS, 433, 1573
Schneider A., Giri S. K., Mirocha J., 2021, Phys. Rev. D, 103,
083025
Schneider A., Schaeffer T., Giri S. K., 2023, Phys. Rev. D, 108,
043030
Secco L. F., Samuroff S., et al., 2022, Phys. Rev. D, 105, 023515
Seljak U., 2000, MNRAS, 318, 203
Seljak U., Vlah Z., 2015, Phys. Rev. D, 91, 123516
Seljak U., Hamaus N., Desjacques V., 2009, Physical Review
Letters, 103, 091303
Semboloni E., Hoekstra H., Schaye J., van Daalen M. P.,
McCarthy I. G., 2011, MNRAS, 417, 2020Semboloni E., Hoekstra H., Schaye J., 2013, MNRAS, 434, 148
Shaw L. D., Nagai D., Bhattacharya S., Lau E. T., 2010, ApJ,
725, 1452
Sheth R. K., Jain B., 2003, MNRAS, 345, 529
Sheth R. K., Tormen G., 1999, MNRAS, 308, 119
Sheth R. K., Mo H. J., Tormen G., 2001, MNRAS, 323, 1
Shi X., 2016, MNRAS, 459, 3711
Shirasaki M., Horiuchi S., Yoshida N., 2014, Phys. Rev. D, 90,
063502
Singh S., Mandelbaum R., More S., 2015, Monthly Notices of the
Royal Astronomical Society, 450, 2195
Singh P., Refregier A., Majumdar S., Nath B. B., 2017, MNRAS,
466, 3961
Smith R. E., Markovic K., 2011, Phys. Rev. D, 84, 063507
Smith R. E., Watts P. I. R., 2005, MNRAS, 360, 203
Smith R. E., et al., 2003, MNRAS, 341, 1311
Smith R. E., Scoccimarro R., Sheth R. K., 2007, Phys. Rev. D,
75, 063512
Smith R. E., Desjacques V., Marian L., 2011, Phys. Rev. D, 83,
043526
Smith A., Cole S., Baugh C., Zheng Z., Angulo R., Norberg P.,
Zehavi I., 2017, MNRAS, 470, 4646
Springel V., et al., 2005, Nature, 435, 629
Srinivasan S., Thomas D. B., Pace F., Battye R., 2021, J.
Cosmol. Astropart. Phys., 2021, 016
Stein G., Alvarez M. A., Bond J. R., 2019, MNRAS, 483, 2236
Sullivan J. M., Seljak U., Singh S., 2021, arXiv e-prints, p.
arXiv:2104.10676
Taddei L., Catena R., Pietroni M., 2014, Phys. Rev. D, 89, 023523
Takada M., Jain B., 2003, MNRAS, 340, 580
Takahashi R., Sato M., Nishimichi T., Taruya A., Oguri M., 2012,
ApJ, 761, 152
Tanimura H., Aghanim N., Douspis M., Beelen A., Bonjean V.,
2019, A&A, 625, A67
Tanoglidis D., Pavlidou V., Tomaras T. N., 2015, J. Cosmol.
Astropart. Phys., 2015, 060
Tarrant E. R. M., van de Bruck C., Copeland E. J., Green A. M.,
2012, Phys. Rev. D, 85, 023503
Tinker J. L., Weinberg D. H., Zheng Z., Zehavi I., 2005, ApJ,
631, 41
Tinker J., Kravtsov A. V., Klypin A., Abazajian K., Warren M.,
Yepes G., Gottl¨ ober S., Holz D. E., 2008, ApJ, 688, 709
Tinker J. L., Robertson B. E., Kravtsov A. V., Klypin A., Warren
M. S., Yepes G., Gottl¨ ober S., 2010, ApJ, 724, 878
Tr¨ oster T., et al., 2017, MNRAS, 467, 2706
Tr¨ oster T., et al., 2021, A&A, 649, A88
Tr¨ oster T., et al., 2022, A&A, 660, A27
Troxel M. A., et al., 2018, MNRAS, 479, 4998
Upadhye A., Biswas R., Pope A., Heitmann K., Habib S., Finkel
H., Frontiere N., 2014, Phys. Rev. D, 89, 103515
Vainshtein A., 1972, Phys. Lett., B39, 393
Valageas P., Nishimichi T., 2011, A&A, 527, A87
Viel M., Haehnelt M. G., Springel V., 2010, J. Cosmol. Astropart.
Phys., 6, 15
Viel M., Markoviˇ c K., Baldi M., Weller J., 2012, MNRAS, 421, 50
Vikram V., Lidz A., Jain B., 2016, MNRAS,
Villaescusa-Navarro F., et al., 2018, ApJ, 866, 135
Viola M., et al., 2015, MNRAS, 452, 3529
Voivodic R., Rubira H., Lima M., 2020, J. Cosmol. Astropart.
Phys., 2020, 033
Wang J., Bose S., Frenk C. S., Gao L., Jenkins A., Springel V.,
White S. D. M., 2020, Nature, 585, 39
Warren M. S., Abazajian K., Holz D. E., Teodoro L., 2006, APJ,
646, 881
Watson W. A., Iliev I. T., D’Aloisio A., Knebe A., Shapiro P. R.,
Yepes G., 2013, MNRAS, 433, 1230
White M., 2004, Astroparticle Physics, 22, 211
Wintergerst N., Pettorino V., 2010, Phys. Rev. D, 82, 103516
Wolz L., Murray S. G., Blake C., Wyithe J. S., 2019, MNRAS,
484, 1007
Xia J.-Q., Negrello M., Lapi A., De Zotti G., Danese L., Viel M.,
2012, MNRAS, 422, 1324
Xu K., Jing Y. P., Zhao D., 2023, arXiv e-prints, p.
arXiv:2307.12334
Yan Z., et al., 2021, arXiv e-prints, p. arXiv:2102.07701
Zacharegkas G., et al., 2022, MNRAS, 509, 3119
Zehavi I., et al., 2004, ApJ, 608, 1629
Zel’dovich Y. B., 1970, AAP, 5, 84
Zentner A. R., Rudd D. H., Hu W., 2008, Phys. Rev. D, 77,
043507
Zhai Z., et al., 2017, ApJ, 848, 76
Zheng Z., et al., 2005, ApJ, 633, 791
Zhou Y., Han J., 2023, MNRAS, 525, 2489
van Daalen M. P., Schaye J., 2015, MNRAS, 452, 2247
van Daalen M. P., Schaye J., Booth C. M., Dalla Vecchia C.,
2011, MNRAS, 415, 3649
van Daalen M. P., Angulo R. E., White S. D. M., 2012, MNRAS,
424, 2954van Daalen M. P., McCarthy I. G., Schaye J., 2020, MNRAS, 491,
2424
van Uitert E., Gilbank D. G., Hoekstra H., Semboloni E.,
Gladders M. D., Yee H. K. C., 2016, A&A, 586, A43
van den Bosch F. C., More S., Cacciato M., Mo H., Yang X.,
2013, MNRAS, 430, 725
This paper was built using the Open Journal of As-
trophysics L ATEX template. The OJA is a journal which
provides fast and easy peer review for new papers in the
astro-ph section of the arXiv, making the reviewing pro-
cess simpler for authors and referees alike. Learn more
athttp://astro.theoj.org .