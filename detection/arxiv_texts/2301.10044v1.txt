arXiv:2301.10044v1  [q-fin.MF]  24 Jan 2023Constructing Copulas Using Corrected Hermite Polynomial
Expansion for Estimating Cross Foreign Exchange V olatilit y
Kenichiro Shiraya * Tomohisa Yamakami†
January 24, 2023
Abstract
Copulas are used to construct joint distributions in many ar eas. In some problems, it is nec-
essary to deal with correlation structures that are more com plicated than the commonly known
copulas. A ﬁnite order multivariate Hermite polynomial exp ansion, as an approximation of a joint
density function, can handle complex correlation structur es. However, it does not construct copulas
because the density function can take negative values. In th is study, we propose a method to con-
struct a copula based on the ﬁnite sum of multivariate Hermit e polynomial expansions by applying
corrections to the joint density function.
Furthermore, we apply this copula to estimate the volatilit y smile of cross currency pairs in the
foreign exchange option market. This method can easily repr oduce the volatility smile of cross
currency pairs by appropriately adjusting the parameters a nd following the daily volatility ﬂuctua-
tions even if the higher-order parameters are ﬁxed. In the nu merical experiments, we compare the
estimation results of the volatility smile of EUR-JPY with t hose of USD-JPY and EUR-USD for
the proposed and other copulas, and show the validity of the p roposed copula.
Keywords: Finance, Copula, Hermite polynomial expansion, Currency o ption, Correction of prob-
ability density
1 Introduction
A copula is a function that expresses the relationship betwe en joint and marginal distributions in multi-
variate random variables. It allows us to treat the complex c orrelation structure among random variables
separately from the marginal distributions. Given this pro perty, copulas are used to compose a joint dis-
tribution from marginal distributions. In the ﬁeld of deriv atives pricing, a variety of applications have
been proposed by composing a joint distribution with a copul a and distributions of underlying assets
prices, such as basket options, worst of options, and option s of cross currency pairs (see e.g., Cherubini
et al. [6], Taylor and Wang [22]). For the valuation of Collat eralized Debt Obligations (CDOs), Li [13]
and Laurent and Gregory [12] have proposed a method to obtain the simultaneous survival probabilities
using copulas of the survival probabilities of each entity. In the ﬁeld of portfolio risk management, cop-
ulas are used to calculate conditional value-at-risk (CVaR ) (see e.g., Stoyanov et al. [18]). An extension
*Graduate School of Economics, The University of Tokyo. Keni chiro Shiraya is supported by Center for Advanced
Research in Finance (CARF).
†Graduate School of Economics, The University of Tokyo. Mizu ho-DL Financial Technology Co., Ltd. The opinions ex-
pressed herein are only those of the authors. They do not repr esent the oﬃcial views of the Mizuho-DL Financial Technology
Co., Ltd.
1of the CVaR using a copula has been studied by Krzemienowski a nd Szymczyk [11]. In X-Value Ad-
justment (XV A), such as Credit Valuation Adjustment, a copu la is used to construct the simultaneous
survival probability of self and a counterparty (see e.g., B rigo et al. [4]). Cherubini [5] have introduced
a copula to explain the correlation between a swap rate and su rvival probability to evaluate wrong way
risk.
Most of these examples have used Archimedes, Gaussian, and tcopulas which are classical and
commonly known. However, in some cases, these copulas canno t appropriately represent complex
correlation structures. Therefore, many attempts have bee n made to apply copulas which can represent
more complex correlation structures depending on problems . For example, Tavin [20] have proposed
to use Bernstein polynomial copulas for multi-asset option pricing. Tavin [21] have applied copulas to
measure dependence risk of a portfolio.
However, an extension of the Gaussian copula is more suitabl e for representing a joint distribu-
tion, which is close to a multidimensional normal distribut ion. Tsionas and Andrikopoulos [23] have
used a copula derived from a multivariate mixture of normal d istributions in their study. This cop-
ula can express a complex correlation structure using many p arameters. As an approximation of a
joint distribution by extension of a multidimensional norm al distribution, a method using multivari-
ate Hermite polynomial expansion, has been studied by Marum o and Wolﬀ[14] and Amengual et al.
[1]. To construct copulas, multivariate Hermite polynomia l expansions must be non-negative; how-
ever, non-negativity may not be satisﬁed in a general case tr uncated by ﬁnite terms. This point has not
been resolved in these studies. Quatto et al. [16] have propo sed a constraint on the coe ﬃcients of the
fourth-order multivariate Hermite polynomial expansion. While it satisﬁes the copula’s condition, the
constraint is very strong and di ﬃcult to apply to a variety of issues.
Takahashi and Tsuzuki [19] have proposed a method to correct a one-dimensional function to satisfy
the properties of the probability density, such as the non-n egativity and normalized conditions, which
means that the total probability is 1. The functions satisfy ing these properties are represented as closed
convex sets on Hilbert spaces. The correction is applied by c alculating the projection onto this set.
Dykstra’s algorithm calculates this projection. In our stu dy, we formulate a multidimensional Hermitian
polynomial expansion with a correlation matrix in a weight f unction and propose a method to construct
copulas by extending Takahashi and Tsuzuki’s method to Ndimensions. Furthermore, we apply this
copula to the problem of option-pricing of cross currency pa irs and show its validity.
Foreign exchange and its derivatives are the second most hea vily traded category of ﬁnancial in-
struments after interest rates. Therefore, market partici pants need to quickly reﬂect market information
and their views on their prices. A triangular relationship i n the foreign exchange rate among the three
currencies is a typical feature of the foreign exchange mark et. For example, let the foreign exchange
rates of EUR-USD, USD-JPY , and EUR-JPY be Se$,S$Y=, and SeY=. A currency pair with the key cur-
rency USD is called a straight currency pair, while a currenc y pair between two non-key currencies is
called a cross currency pair. Assuming no arbitrage, SeY==Se$×S$Y=must be satisﬁed. Therefore,
ifSe$is moved, traders also have to change the rates of SeY=andS$Y=to satisfy this equation. This
relationship among foreign exchange rates constrains the r elationship among the implied volatilities
of each currency pair. When two foreign exchange rates follo w a multi-asset Black-Scholes model, in
which a correlation between two Brownian motions is constan t, the joint distribution of log foreign ex-
change rates at option maturity follows a bivariate normal d istribution. In this situation, the correlation
structure is expressed using a Gaussian copula, and a simple relationship among the three volatilities is
derived. In the real market, implied volatility depends on t he strike price, called the volatility smile. A
relationship among the implied volatilities of currency pa irs, under the assumption of volatility smiles,
is complex and has been studied using several approaches.
One approach involves obtaining the option prices of cross c urrency pairs by focusing only on the
2risk-neutral probability distributions of the underlying asset prices at maturity. According to Breeden
and Litzenberger, risk-neutral probability distribution s can be obtained using implied volatilities. By
considering the risk-neutral probability distributions o f straight currency pairs as marginal distributions
and introducing an appropriate correlation structure usin g a copula, the joint distribution is constructed
and the option price of the cross-currency pair is obtained a s a two-asset option. Taylor and Wang [22]
have studied this approach.
Given that the volatility of cross currency pairs is less liq uid than that of straight currency pairs
in the market, there is a need to estimate volatility of cross currency pairs using volatilities of straight
currency pairs. Combinations of European options such as At -The-Money straddle (ATM), Risk Re-
versal (RR), and Butterﬂy (BF) are standard in the currency o ptions market. The liquidity of RR and
BF is lower than that of ATM. Therefore, when only the ATM of th e cross currency pairs and volatility
smiles of the straight currency pairs are available, it is re quired that the volatility smile of the cross-
currency pairs be more precisely estimated. Most of the exis ting studies that have considered the copula
approach have used classical copulas with a small number of p arameters, which are di ﬃcult to ﬁt the
entire volatility smile of cross currency pairs. In this stu dy, we derive a copula from a joint density
using a multivariate Hermite polynomial expansion and appl y it to estimate the volatility smiles of
cross currency pairs. We present a procedure for calculatin g option prices suitable for such a copula
and show that it has enough parameters that can be ﬁt to the vol atility smile of cross currency pairs.
The numerical examples generated using volatility data for currency pairs among EUR, USD, and JPY
show that the proposed copula is a better ﬁt to volatility smi les of cross currency pairs than other classi-
cal copulas. We also show that estimating the volatility smi le of cross currency pairs using parameters
calibrated on month-ends and volatility smiles of straight currency pairs calibrated during the month,
yield better estimation results than other classical copul as.
The remainder of this study is organized as follows. In Secti on 2, we describe the properties and
examples of classical copulas and introduce approximation method of the probability density using
orthogonal polynomial expansion to prepare the proposed me thod. In Section 3, we propose the con-
struction of copulas using a multivariate Hermite polynomi al expansion and its parameter estimation,
and a correction method using a projection onto a convex set i n a case where the deﬁnition of proba-
bility density is not satisﬁed. In Section 4, we discuss a met hod for estimating the volatility smile of
cross currency pairs using the proposed copula. In Section 5 , we present numerical examples of the
comparison between the proposed and other classical copula s. We do this by approximating the joint
distribution and estimating volatility smiles of cross cur rency pair using the volatility data on EUR,
USD, and JPY . We conclude the study in Section 6.
2 Preliminary
In this section, we introduce the properties of copulas and a pproximate probability density using the
orthogonal polynomial expansion to prepare for the propose d method. We assume a probability space
(Ω,F,P) satisfying appropriate conditions and use the following s ymbols throughout this study.
N+: the set of natural numbers. N0: the set of natural numbers containing 0. x:=(x1,···,xN)′:
N-dimensional vectors, and we use the notation that a functio n with a vector argument is identical to an
N-variable function as f(x)=f(x1,···,xN).∂x:=∂N
∂x1···∂xN: diﬀerentiation operator that di ﬀerentiates
partials once, using an element of x. Particularly, if the subscript is scalar, the di ﬀerential operation
∂x:=∂
∂xis used.ΦΣ(x):N-variate standard normal distribution with correlation ma trixΣ.Φ(x)=
Φ1(x): standard normal distribution, the latter is used when we w ant to especially emphasize that it is
one dimension./integraltext
Af(x)dx:=/integraltext
Af(x)dx1···dxN: multiple integrals in the domain A. In the context
3of functional, function arguments are omitted and real numb ers (such as 0, 1) are used as constant
functions that take their values.
2.1 Properties of Copula
A copula is a function that expresses the relationship betwe en a multivariate joint distribution and
marginal distributions. It is often used as a method to const ruct a joint distribution based on marginal
distributions.
We assume that N-dimensional random variables X:=(X1,···,XN)′have the joint distribu-
tion F(x1,···,xN) :=P(X1≤x1,···,XN≤xN)and also have the continuous marginal distributions
G1(x1) :=P(X1≤x1),···,GN(xN) :=P(XN≤xN). According to Sklar’s theorem (see e.g., Cherubini
et al. [6]), there exists a unique copula CF(u1,···,uN) satisfying
F(x1,···,xN)=CF(G1(x1),···,GN(xN)). (1)
Furthermore, if G1(x1),···,GN(xN) have inverse functions, we can write
CF(u1,···,uN) :=F/parenleftig
G−1
1(u1),···,G−1
N(uN)/parenrightig
, (2)
which is called the copula derived from the joint distributi onF(x). Based on this formula, copulas
can be considered as joint distributions whose marginal dis tributions follow the uniform distribution of
[0,1].
For simplicity of notation, we use lower-case in bold to deno teN-dimensional vectors as x:=
(x1,···,xN)′,u:=(u1,···,uN)′and identify a N-dimensional vector argument with Nvariable argu-
ments (e.g., F(x) :=F(x1,···,xN)). We use bold capital letters to map N-dimensional vectors onto
N-dimensional vectors (e.g., G(x) :=(G1(x1),···,GN(xN))′).
IfF(x) in (1) has a joint density, it can be di ﬀerentiated as
∂xF(x)=∂uCF(G(x))N/productdisplay
i=1∂xiGi(xi), (3)
where we use the di ﬀerential operator∂x:=∂N
∂x1···∂xN(∂x:=∂
∂xfor scalar), and∂uCF(u) is called the
copula density. Given the non-negativity of the joint densi ty, the copula density must also be non-
negative.
Next, we deﬁne a monotonically increasing function. α1(x),···,αN(x) which has inverse functions
in the whole regions and considers a random variable ¯X1:=α1(X1),···,¯XN:=αN(XN). Given the
joint distribution ¯F( ¯x1,···,¯xN) of these random variables are expressed as
¯F( ¯x1,···,¯xN) :=P/parenleftig¯X1≤¯x1,···,¯XN≤¯xN/parenrightig
=P/parenleftig
X1≤α−1
1( ¯x1),···,XN≤α−1
N( ¯xN)/parenrightig
=F/parenleftig
α−1
1( ¯x1),···,α−1
N( ¯xN)/parenrightig
, (4)
and the marginal distributions are
¯G1( ¯x1) :=P/parenleftig¯X1≤¯x1/parenrightig
=G1/parenleftig
α−1
1( ¯x1)/parenrightig
, (5)
...
¯GN( ¯xN) :=P/parenleftig¯XN≤¯xN/parenrightig
=GN/parenleftig
α−1
N( ¯xN)/parenrightig
. (6)
4The copula derived from ¯Fis
C¯F(u) :=¯F/parenleftig¯G−1
1(u1),···,¯G−1
N(uN)/parenrightig
=F/parenleftig
G−1
1(u1),···,G−1
N(uN)/parenrightig
, (7)
which is the same as CF(u). Therefore, when considering copulas derived from the pro bability dis-
tribution F(x), no generality is lost and it is assumed that the probabilit y distribution is standardized
by linear transformation scaled to mean 0 and variance 1. Fur thermore, when we consider the joint
distribution of exponential or logarithmic random variabl es on an appropriate domain, the same copula
is obtained. Moreover, the same copula is derived from a join t distribution obtained by transforming
the random variables such that the marginal distributions a re standard normal distributions.
The following are well-known classical copulas (see e.g., C herubini et al. [6], Taylor and Wang
[22]).
•Archimedean copula
Using a functionφthat satisﬁes appropriate conditions, which is called a gen erator function, a
copula that can be expressed as
C(u1,···,uN)=φ−1(φ(u1)+···+φ(uN)), (8)
is called an Archimedean copula. Table 1 shows typical varia tions.
Table 1: Typical Archimedean copulas’ generator functions and two-dimensional representations
Nameφ(u) C(u1,u2)
Clayton copula1
θ(t−θ−1)/braceleftig
max/parenleftig
u−θ
1+u−θ
2−1,0/parenrightig/bracerightig1
θ
Frank copula log/parenleftigeθu−1
eθ−1/parenrightig
−1
θlog/parenleftbigg
1+(e−θu1−1)(e−θu2−1)
e−θ−1/parenrightbigg
Gumbel copula (−log(u))θe−[(−log(u1))θ+(−log(u2)θ)]1/θ
•Plackett copula
A copula denoted by
CPl(θ):=[1+(θ−1)(u1+u2)]−/radicalbig
[1+(θ−1)(u1+u2)]2−4u1u2θ(θ−1)
2(θ−1), (9)
is called a two-dimensional Plackett copula.
•Gauss copula
A copula derived from the distribution ΦΣof A multivariate standard normal distributions with
correlation matrixΣ, is called a Gauss copula.
CΦΣ(u1,···,uN) :=ΦΣ/parenleftig
Φ−1(u1),···,Φ−1(uN)/parenrightig
. (10)
2.2 Orthogonal Polynomial Expansion
LetMNbe the set of all Lebesgue measurable subsets of RN(N∈N+) andµbe the measure with a
density pµ(x). We consider the measure space ( RN,MN,µ).
5The setHN
µ=L2(RN,MN,µ) of the square integrable real-valued functions on this mea sure space
is a Hilbert space deﬁned by the inner product
/an}bracketle{tf,g/an}bracketri}htµ:=/integraldisplay
RNf(x)g(x)dµf,g∈HN
µ, (11)
=/integraldisplay
RNf(x)g(x)pµ(x)dx. (12)
Hereafter, we consider only the measure µwhoseHN
µcontains all N-variable polynomials of arbitrary
degree. We deﬁne that /bardblf/bardblµ:=/radicalig
/an}bracketle{tf,f/an}bracketri}htµis the norm deﬁned based on the inner product.
First, we consider a case where N=1. A polynomial sequence Rnof degree nis called an or-
thogonal polynomial sequence if it satisﬁes /an}bracketle{tRm,Rn/an}bracketri}htµ=0,(m/nequaln m,n∈N0). The orthogonal poly-
nomial sequence can be constructed, for example, by applyin g Gram-Schmidt orthogonalization to the
monomial sequence 1 ,x,x2,···. Furthermore, the normalized polynomial sequence whose no rm is 1
is deﬁned as ¯Rn:=Rn
/bardblRn/bardblµand called an orthonormal polynomial sequence. A normalize d orthonormal
polynomial sequence exists uniquely if the coe ﬃcients of the highest order are assumed to be positive.
Using an orthonormal polynomial sequence ¯Ri(x) and a real number sequence mi,i∈N0, an
expansion
˜pµ(x) :=∞/summationdisplay
i=0mi¯Ri(x)pµ(x), (13)
is called the orthogonal polynomial expansion. According t o the Riesz-Fische’s theorem, this series
converges when/summationtext∞
i=0m2
i<∞(see Krall [10]).
Next, we consider the case where µis a probability measure and m0=1. Under this condition,
/integraldisplay
R˜pµ(x)dx=/integraldisplay
Rpµ(x)dx=1, (14)
holds. Additionally, if the condition ˜ pµ(x)≥0 is satisﬁed, ˜ pµ(x) is a probability density.
Based on the fact that xjis orthogonal to ¯Ri(i>j≥0),
/integraldisplay
Rxj˜pµ(x)dx=/integraldisplay
Rxjpµ(x)dx+j/summationdisplay
i=1mi/angbracketleftig
xj,¯Ri(x)/angbracketrightig
µ, (15)
holds. Therefore, mi(i>j>0) are parameters that do not a ﬀect the moments of jdegrees.
When we consider the measure µΦ1, whose density is the standard normal density function ∂xΦ1(x),
Rnare identiﬁed as the Hermite polynomials He ncalculated using
He0(x)=1, (16)
He1(x)=x, (17)
Hen+1(x)=xHen(x)−nHen−1(x). (18)
The norm is
/an}bracketle{tHen,Hen/an}bracketri}htµΦ1=n!, (19)
and ¯Hen:=1√
n!Henconstitutes an orthonormal polynomial sequence. Furtherm ore, when miis ex-
pressed using the cumulant of ˜ pµ(x), it is called the Gram-Charlier expansion.
6InN(>1)-dimensional case, an n-degree polynomial that is orthogonal to any ( n−1)-degree poly-
nomial is called an orthogonal polynomial. The dimension of the linear space based on n-degree N-
variable polynomials, which is orthogonal to a n−1-degree N-variable polynomial, is expressed using
the combination Mn:=/parenleftiggN+n−1
N−1/parenrightigg
. Therefore, there is no unique orthogonal polynomial and va rious
bases are possible. Among these variations, it is useful to c onsider the case where n-degree orthogonal
polynomials are orthogonal to each other in application.
As a special case, let us consider an N-dimensional density of a measure which is expressed as a
product of one-dimensional densities. Let the densities of the one-dimensional measures µ1,···,µNbe
pµ1(x),···,pµN(x) and ¯Rµ1,j,···,¯RµN,j(j∈N0) be their j-th orthonormal polynomials, respectively.
Assuming the density of N-dimensional measure µ⊥is deﬁned by pµ⊥(x) :=/producttextN
i=1pµi(xi), the set of
polynomials.
Eµ⊥,n:=N/productdisplay
i=1¯Rµi,ji(xi)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleji∈N0,N/summationdisplay
i=1ji=nn∈N0, (20)
aren-degree orthonormal polynomials whose elements are orthog onal to each other with respect to the
inner product./an}bracketle{t·,·/an}bracketri}htµ⊥. Note that the number of elements of (20) is Mn, indicating that the arbitrary
n-degree N-variate orthogonal polynomial can be expressed using the l inear combination of elements
in (20). Thus,
Eµ⊥:=∞/uniondisplay
n=0Eµ⊥,n, (21)
forms an N-variate orthonormal polynomial system, and any polynomia l can be expressed by the linear
combination of these elements. See Dunkl and Xu [8] for a deta iled discussion of the aforementioned
multivariate orthogonal polynomials.
Using the N-variate orthonormal polynomial system (21), we obtain an N-variate orthogonal poly-
nomial expansion
˜pµ⊥(x) :=∞/summationdisplay
n=0/summationdisplay
j1+···+jN=nmj1,···,jNN/productdisplay
i=1¯Rµi,ji(xi)N/productdisplay
l=1pµl(xl), (22)
with coeﬃcients mj1,···,jN.
Similar to the one-dimensional case, it converges if/summationtext∞
n=0/summationtext
j1+···+jN=nm2
j1,···,jN<∞. Furthermore,
whenµ⊥is a probability measure and m0,···,0=1,
˜pµ⊥(x) :=1+∞/summationdisplay
n=1/summationdisplay
j1+···+jN=nmj1,···,jNN/productdisplay
i=1¯Rµi,ji(xi)N/productdisplay
l=1pµl(xl), (23)
is a probability density if ˜ pµ⊥(x)≥0 is satisﬁed. Particularly, when µ1=···=µN=µΦ1, we obtain
the orthogonal polynomial expansions of the N-dimensional probability density using N-dimensional
Hermite polynomials.
2.3 Copulas derived from orthogonal polynomial expansion
Several copulas derived from the probability density expre ssed using the orthogonal polynomial expan-
sion have been proposed.
7Bakam and Pommeret [2] have proposed a copula derived from a s hifted Legendre polynomial ex-
pansion whose density of a probability measure is 1 on [0 ,1]N. Marumo and Wol ﬀ[14] and Amengual
et al. [1] have discussed copulas in two dimensions using Her mite polynomials. These probability
densities using orthogonal polynomial expansions and deri ved copulas have a problem: the probability
density may take a negative value when truncated using ﬁnite terms in a general case, and a copula
cannot be derived from the density. As a copula using non-ort hogonal polynomials, Sancetta et al. [17]
have proposed a copula using Bernstein polynomials in which the conditions for coe ﬃcients to satisfy
the copula are treated. However, in a problem where the copul a has a Gaussian-like joint distribu-
tion, using a copula extended from a Gaussian copula may prov ide a better approximation with fewer
parameters than other complex copulas such as Bakam and Pomm eret [2] and Sancetta et al. [17].
In the next section, we discuss the formulation of multivari ate Hermite polynomial expansions for
probability density and a method to solve the non-negativit y of probability density when the expansion
is truncated by ﬁnite terms.
3 Construction of Copulas using Hermite Polynomial Expansi on
Several studies have constructed a multidimensional proba bility density using multivariate Hermite
polynomial expansion. However, there are variations for ta king densities of measures and bases of the
polynomial expansion.
In our formulation, we consider the relation between the inn er product under the measures µΦΣ
andµΦIwhose densities are ∂xΦΣand∂xΦI. We derive a simple expression and calculation of the
multivariate Hermite expansion on the measure µΦΣconverting to that on the measure µΦI.
When orthogonal polynomial expansions are truncated by ﬁni te terms, the probability density may
become negative. In this case, the deﬁnition of probability density and copulas are not satisﬁed. To
solve this problem, we extend the correction method using a p robability density proposed by Takahashi
and Tsuzuki to N-dimensions. The method is then applied to obtain the probab ility density and copulas.
3.1 Hermite Polynomial Expansion for Joint Density
LetΣbe a regular N-dimensional correlation matrix and Γbe a decomposition that ﬁlls Σ=ΓΓT.
Cholesky decomposition is one example, but decomposition i s not limited to it.
LetµΦΣbe the measure with density ∂xΦΣwhich is the N-dimensional standard normal distribution
with the correlation matrix Σ. By performing the variables transformation v:=Γ−1x, the inner product
of any function f,g∈HN
µΦΣis
/an}bracketle{tf,g/an}bracketri}htµΦΣ=/integraldisplay
RNf(x)g(x)∂xΦΣ(x)dx
=/integraldisplay
RNf(Γv)g(Γv)∂vΦI(v)dv
=/an}bracketle{tf◦Γ,g◦Γ/an}bracketri}htµΦI, (24)
whereµΦIis a special case of Σ=Iand the notation ( f◦Γ)(v) :=f(Γv) is used as a composition of
maps. Therefore, the inner product is preserved by this vari able transformation and change of measures.
8Let{x}ibe the i-th element of the vector x. By considering (20) and (24),
EµΦΣ,n:=N/productdisplay
i=1¯Heji/parenleftig/braceleftig
Γ−1x/bracerightig
i/parenrightig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleji∈N0,N/summationdisplay
i=1ji=nn∈N0, (25)
EµΦΣ:=∞/uniondisplay
n=0EµΦΣ,n, (26)
consist of n-degree orthonormal polynomial sets and an orthonormal pol ynomial system under the inner
product/an}bracketle{t·,·/an}bracketri}htµΦΣ.
Next, let en:=(en,0,en,1,···,en,Mn−1)′be a vector of the elements of EµΦΣ,n. Consider the vector
(ˆen,0,ˆen,1,···,ˆen,Mn−1)′:=Unenis obtained by multiplying it with a suitable orthogonal mat rixUn
ofMndimensions. Let ˆEµΦΣ,n:=/braceleftbigˆen,i/vextendsingle/vextendsingle/vextendsinglei=0···,Mn−1/bracerightbigbe the set of multiplying vector elements.
ˆEµΦΣ:=/uniontext∞
n=0ˆEµΦΣ,nalso forms an orthonormal system, and any polynomial can be e xpressed by the
linear combination of the elements. Next, we consider the ex pression of the multivariate Hermite
polynomial expansion
a(x) :=1+∞/summationdisplay
n=1Mn/summationdisplay
i=1ˆmn,iˆen,i(x),
˜pµΦΣ(x) :=a(x)∂xΦΣ(x), (27)
with ˆ mn,ias the corresponding coe ﬃcient of ˆ en,i(x).
Here, we assume ˜ pµΦΣ(x) satisﬁes the deﬁnition of probability density. Let ˜FµΦΣ(x) be the joint
distribution of ˜ pµΦΣ(x) and ˜GµΦΣ(x) :=(˜GµΦΣ,1(x1),···,˜GµΦΣ,N(xN)) be the vector of marginal distri-
butions of ˜ pµΦΣ(x). We construct the copula
C˜FµΦΣ(u) :=˜FµΦΣ/parenleftig˜G−1
µΦΣ(u)/parenrightig
. (28)
This copula is an extension of the Gaussian copula because it coincides with the Gaussian copula when
all parameters ˆ mn,iare 0.
Next, we consider the integral calculations for a distribut ion constructed using this copula. Let Y:=
(Y1,···,YN) be random variables and GY(y) :=(GY,1(y1),···,GY,N(yN)) be the marginal distributions
ofY. The joint distribution of Ycomposed using copula C˜FµΦΣis
˜FY(y) :=˜FµΦΣ/parenleftig˜G−1
µΦΣ(GY(y))/parenrightig
. (29)
Considering the variables transformation of x:=˜G−1
µΦΣ(GY(y)), the integral with the appropriate
function h(y) is deﬁned by the domain A⊆RNin which the Yvalues can be written by
/integraldisplay
Ah(y)d˜FY(y)=/integraldisplay
Ah(y)∂y/bracketleftig˜FµΦΣ/parenleftig˜G−1
µΦΣ(GY(y))/parenrightig/bracketrightig
dy
=/integraldisplay
RNh/parenleftig
G−1
Y/parenleftig
GµΦΣ(x)/parenrightig/parenrightig
˜pµΦΣ(x)dx
=/integraldisplay
RNh/parenleftig
G−1
Y/parenleftig
GµΦΣ(Γv)/parenrightig/parenrightig
a(Γv)∂vΦI(v)dv, (30)
where we assume that h/parenleftig
G−1
Y/parenleftig
GµΦΣ(x)/parenrightig/parenrightig
∈HN
µΦΣis satisﬁed. If h/parenleftig
G−1
Y/parenleftig
GµΦΣ(Γv)/parenrightig/parenrightig
a(Γv) is suﬃ-
ciently smooth and increases with the polynomial speed, it c an be calculated with high accuracy using
9the trapezoidal formula, the midpoint formula, or the Gauss -Hermite integral for each dimension of v.
For example, if h(y) are the monomials where/producttextN
i=1yji
i,ji∈N0, the moments of the joint distribution
˜FY(y) are obtained. We can use (30) in this numerical integration setting.
We consider a method to calculate copula parameters ˆ mn,iusing a joint distribution FZof ran-
dom variables Z: (Z1,···,ZN). Letα1(z),···,αN(z) be the monotonically increasing function. We
normalize these random variables as ¯X:=(¯X1,···,¯XN) :=(α1(Z1),···,αN(ZN)). Here, all ele-
ments of ¯Xhave mean 0, variance 1, and take the values of R, respectively. Let F¯X(x1,···,xN) :=
FZ(α−1
1(z1),···,α−1
N(zN)) be the joint distribution of ¯X. Assuming F¯X(x)=˜FµΦΣ(x), multiplying
each density by ˆ en,i(x) and integrating, we obtain
/integraldisplay
RNˆen,i(x)∂xF¯X(x)dx=/integraldisplay
RNˆen,i(x)∂x˜FµΦΣ(x)dx
=ˆmn,i. (31)
From (31), the parameter ˆ mn,iis obtained by calculating the left-hand side of this equati on. Given
that all elements of ¯Xhave mean 0, ˆ m1,i=0. Furthermore, if Σis considered to coincide with the
correlation matrix of ¯Y, we can set ˆ m2,i=0. In section 5, we show the superiority of the latter
setting in two dimensions using numerical comparison betwe enΣ=IandΣ, which is matched with the
correlation matrix.
When we deal with time series data, they are considered to mod el a copula which changes with time.
This can be expressed by regarding parameters ˆ mn,i,Σin (27) as time-depending variables ˆ mn,i(t),Σ(t).
When the time tis ﬁxed, the basis transformation from EµΦΣ,ntoˆEµΦΣ,ncan be set so that∂
∂tˆmn,i(t)=0,
(i=2,···,Mn) is satisﬁed. In this case, it is possible to consider that th e parameters changing in small
time are onlyΣ(t) and ˆ mn,1(t) (n=1,···). From a diﬀerent perspective of treating time series data,
estimating higher-order moments from real data generally r equires more data than estimating lower-
order moments. To avoid the problem of estimating higher-or der moments with less data, one possible
approach is to ﬁx the higher-order moments, for example ˆ mn,i(t) (n≥3), and to estimate Σ(t) as time
dependent parameters.
3.2 Correction of Probability Density by Projection to a Con vex Set
Although the multivariate Hermite polynomial expansion (2 7) satisﬁes non-negativity as an inﬁnite
sum, the expansion truncated by the ﬁnite terms does not nece ssarily satisfy non-negativity.
Takahashi and Tsuzuki [19] have proposed a method to correct a function which does not satisfy
the deﬁnition of probability density, such as non-negativi ty, using projection onto a convex set in a one-
dimensional case. Here, we extend it to N-dimensions. The proposed method satisﬁes the conditions
of probability density and introduces an additional condit ion (31), after correction.
Letφbe an element of the Hilbert space HN
µ=L2(RN,MN,µ), andK⊂HN
µbe a nonempty closed
convex set. We deﬁne a projection from φtoKusing
Projµ,K(φ):=/braceleftigg
φ∗∈K/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextenddouble/vextenddouble/vextenddoubleφ−φ∗/vextenddouble/vextenddouble/vextenddoubleµ=inf
η∈K/bardblφ−η/bardblµ/bracerightigg
. (32)
According to the projection theorem in a Hilbert space, ther e is only one such element. Hereafter,
Projµ,K(φ)is also used to denote the element, unless there is a misunder standing. If a convex set K=
can be written asK=:=/braceleftbigg
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
φ,φ#/angbracketrightig
µ=c/bracerightbigg
with someφ#∈HN
µandc∈R, the projection is
10calculated by
Projµ,K=(φ) :=φ−/angbracketleftig
φ,φ#/angbracketrightig
µ−c
/vextenddouble/vextenddouble/vextenddoubleφ#/vextenddouble/vextenddouble/vextenddouble2
µφ#. (33)
Additionally, if a convex set can be written as K≤:=/braceleftbigg
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
φ,φ#/angbracketrightig
µ≤c/bracerightbigg
, the projection is calculated
by
Projµ,K≤(φ) :=φ−/braceleftbigg/angbracketleftig
φ,φ#/angbracketrightig
µ−c/bracerightbigg
+/vextenddouble/vextenddouble/vextenddoubleφ#/vextenddouble/vextenddouble/vextenddouble2
µφ#. (34)
If the inequality is reversed, we consider φ#→−φ#andc→− c.
LetKi⊂HN
µ,i=1,···,k,k∈N+be closed convex sets whose projection onto Kican be easily
calculated. Dykstra’s algorithm states a procedure to comp ute the projection Projµ,KAll(φ)onto the
non-empty closed convex set, KAll:=/intersectiontextk
i=1Ki, which satisﬁes all conditions.
For∀n∈N+, we deﬁne [ n]k:=((n−1) mod k)+1. Letφ0∈HN
µbe the element whose projection
we calculate and determine the following recurrence formul a.
e−(k−1):=···:=e−1:=e0:=0, (35)
φn:=Projµ,K[n]k(φn−1+en−k), (36)
en:=φn−1+en−k−φn. (37)
We obtain
lim
n→∞/vextenddouble/vextenddouble/vextenddoubleφn−Projµ,KAll(φ0)/vextenddouble/vextenddouble/vextenddoubleµ=0, (38)
from Boyle-Dykstra theorem (See Deutsch [7]).
Let ˜pbe an approximation of the probability density which may not satisfy the non-negativity
or normalized conditions. Considering ˜φ=˜p/pµas the element to be projected and Kias the con-
straints of probability density and other conditions, we ob tain a corrected probability density p∗
µ:=
Projµ,KAll/parenleftig˜φ/parenrightig
pµ, which satisﬁes all given conditions.
Here, we assume pµ(x)>0 (x∈RN) and the following example is given as a convex set Ki.
•Normalized condition of probability density
Kµ,1,(=1):=/braceleftig
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/an}bracketle{tφ,1/an}bracketri}htµ=1/bracerightig
. (39)
•Non-negativity of probability density
Kµ,δx,(≥0):=/intersectiondisplay
x∈RN/braceleftig
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/an}bracketle{tφ,δx/an}bracketri}htµ≥0/bracerightig
. (40)
whereδx(y1,···,yn) :=δ(y1−x1)···δ(yN−xN) (delta function) and ProjKµ,δx,(≥0)(φ)=max(φ,0).
•Moment matching: Let r(x) be some polynomial,
Kµ,r,(=mr):=/braceleftig
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/an}bracketle{tφ,r/an}bracketri}htµ=mr/bracerightig
. (41)
Particularly, when r(x) is a monomial, we express the condition that the moment is mr. In this
study, we call this as moment-matching conditions when r(x) is an arbitrary polynomial and mr
is the moment in a broader sense.
11•Matching of marginal distributions : Let G1(x1),···,GN(xN) be the marginal distribution, we
deﬁne
Kµ,Gi:=/intersectiondisplay
xi∈R/braceleftig
φ∈HN
µ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftbigφ,δ xi/angbracketrightbig
µ=∂xiGi(xi)/bracerightig
, (42)
whereδxi(y1,···,yn) :=δ(yi−xi).
Given the results of the projection based on the non-negativ e conditionKµ,δx,(≥0)the matching
Kµ,Giof the marginal distributions cannot be simply expressed in an orthonormal basis of Hilbert space.
Generally, numerical calculations are used when applying c orrections involving such conditions. For
example, the region is represented as an appropriate grid xi∈RNi=1,···,M, and the inner product
calculation of f(x),g(x)∈HN
µof real value functions is approximated by the numerical int egral
/an}bracketle{tf,g/an}bracketri}htµ≃M/summationdisplay
i=1wif(xi)g(xi)pµ(xi), (43)
where wi,i=1,···,Mare the weights of the numerical integration. Takahashi and Tsuzuki [19] have
shown that approximation using numerical integration corr esponds to considering a discrete Hilbert
space, and that calculations using properties of Hilbert sp ace, such as the Dykstra’s algorithm, are valid
in one dimension. The discussion of Hilbert spaces is dimens ion-independent and the same result can
be obtained by considering discrete Hilbert spaces in N-dimensional case.
As an example of concrete calculation grids and weights, we p ropose a method of applying numer-
ical integration (midpoint formula) with equally spaced Ca rtesian grids in each dimensional direction.
For the i-th dimension, we take the equidistant points Ui:=/braceleftbigxi,0+j∆i/vextendsingle/vextendsingle/vextendsinglej=0,1,···,Mi/bracerightbig,xi,0∈R,Mi∈
N+. The grid points are their direct product set U:={(x1,···,xN)|x1∈U1,···,xN∈UN}. The weights
of the numerical integrals at each point are all equal, w:=/producttextN
i=1∆i. The inner product is approximated
by
/an}bracketle{tf,g/an}bracketri}htµ≃/summationdisplay
xi∈Uw f(xi)g(xi)pµ(xi). (44)
3.3 Application of Corrections to Hermite Polynomial Expan sions
We consider applying the correction for probability densit y proposed in the previous section to a mul-
tivariate Hermite polynomial expansion truncated at nMof (27)
˜φnM(x) :=1+nM/summationdisplay
n=1Mn/summationdisplay
i=1ˆmn,iˆen,i(x), (45)
˜pµΦΣ,nM(x) :=˜φnM(x)∂xΦΣ(x). (46)
LetS:={(n,i)|n=1,···,nM,i=1,···,Mn}be the set of subscripts ( n,i) contained in a ﬁnite sum and
deﬁne its subsetS′⊆S. We deﬁne the following convex sets of properties that the co rrected function
must satisfy,
KΣ,1,(=1):=KµΦΣ,1,(=1), (47)
KΣ,δx,(≥0):=KµΦΣ,δx,(≥0), (48)
KΣ,ˆen,i,(=ˆmn,i):=/braceleftbigg
φ∈HN
µΦΣ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftbigφ,ˆen,i/angbracketrightbig
µΦΣ=ˆmn,i/bracerightbigg
(n,i)∈S′, (49)
12which contain (39), (40), and we use Σinstead of the measure µΦΣas the ﬁrst subscript for notational
simplicity. Then, let us deﬁne KΣ,All:=KΣ,1,(=1)∩KΣ,δx,(≥1)∩/parenleftig/intersectiontext
(n,i)∈S′KΣ,ˆen,i,(=ˆmn,i)/parenrightig
, and we calculate
the correction.
p∗,1
µΦΣ,nM(x) :=ProjµΦΣ,KΣ,All/parenleftig˜φnM/parenrightig
(x)∂xΦΣ(x), (50)
with the Dykstra algorithm. p∗,1
µΦΣ,nM(x) satisﬁes the probability density and parameter-matching condi-
tions
/integraldisplay
RNˆen,i(x)p∗,1
µΦΣ,nM(x)dx=ˆmn,i,(n,i)∈S′, (51)
of the expression (31) are also satisﬁed. If we want to give th e marginal distributions condition as
˜G(x)=/parenleftig˜G1(x1),···,˜GN(xN)/parenrightig′, we can add the convex set
KΣ,˜Gi:=/intersectiondisplay
xi∈R/braceleftbigg
φ∈HN
µΦΣ/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftbigφ,δ xi/angbracketrightbig
µΦΣ=∂xi˜Gi(xi)/bracerightbigg
i=1,···,N. (52)
intoKΣ,All. Given that the correction generally changes the marginal d istributions, the copula can be
constructed using the given marginal distributions withou t recalculation.
In the calculation of ProjµΦΣ,KΣ,All/parenleftig˜φnM/parenrightig
, we can consider an equivalent calculation on HN
µΦIfrom the
formula (24). Thus, the convex set may be deﬁned as
KI,ˆen,i◦Γ,(=ˆmn,i):=/braceleftbigg
φ∈HN
µΦI/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftbigφ,ˆen,i◦Γ/angbracketrightbig
µΦI=ˆmn,i/bracerightbigg
(n,i)∈S, (53)
KI,All:=KI,1,(=1)∩KI,δx,(≥0)∩/intersectiondisplay
(n,i)∈S′KI,ˆen,i◦Γ,(=ˆmn,i), (54)
and correction is calculated as
p∗,2
µΦΣ,nM(x) :=/parenleftig
ProjµΦIKI,All/parenleftig˜φnM◦Γ/parenrightig
◦Γ−1/parenrightig
(x)∂xΦΣ(x). (55)
Note that ˜φnM◦Γin (55) is a function which is independent of the correlation matrixΣ. If we consider
a time-dependent copula such that ˆ mn,iis a ﬁxed parameter and Σis a time-dependent parameter, the
computation can be reduced using the result of ProjµΦIKI,All/parenleftig˜φnM◦Γ/parenrightig
for the change ofΣ.
3.4 Correction to Product of One-Dimensional Densities
As a special case, we show the construction of a joint distrib ution with corrected univariate Hermite
expansions. Let mi,j,i=1,···,N,j=1,···,ni,ni∈N+be the coeﬃcients of univariate Hermite
expansions and we deﬁne
˜φi(vi) :=1+ni/summationdisplay
j=1mi,j¯He(vi),(i=1,···,N). (56)
We consider a situation where ˜φ⊥(Γv) can be written as
˜φ⊥(Γv) :=N/productdisplay
i=1˜φi(vi). (57)
13Let
K1,¯He,(=mi,j):=/braceleftbigg
φ∈H1
µΦ1/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftig
φ,¯Hej/angbracketrightig
µΦ1=mi,j/bracerightbigg
i=1,···,N,j=1,···,ni, (58)
K1,All,i:=K1,1,(=1)∩K 1,δx,(≥0)∩ni/intersectiondisplay
j=1K1,¯He,(=mi,j), (59)
be convex sets of conditions to be satisﬁed. One-dimensiona l corrections are applied for each ˜φi, and
theN-dimensional probability density is composed by product of them as
φ∗
⊥(v) :=N/productdisplay
i=1ProjK1,All,i(˜φi(vi)), (60)
p∗
⊥:=/parenleftig
φ∗
⊥◦Γ−1/parenrightig
∂xΦΣ. (61)
Generally, the computational complexity of numerically ca lculating the inner product using the
formula (44) is O/parenleftig/producttextN
i=1Mi/parenrightig
, whereas that of calculating the one-dimensional inner pro duct Ntimes is
O/parenleftig/summationtextN
i=1Mi/parenrightig
. The latter has an advantage in terms of computational compl exity over the N-dimensional
correction. This method is used to estimate cross currency v olatility in numerical examples.
4 Estimating Volatility Smile of Cross Currency Pair
4.1 Relationship between Volatilities of Cross and Straigh t Currency Pairs
According to Breeden and Litzenberger [3], a risk-neutral p robability distribution can be extracted from
an implied volatility smile. Considering risk-neutral pro bability distributions of straight currency pairs
as marginal distributions, a joint distribution is constru cted by applying a copula, and option prices for
the cross currency pairs are obtained using joint distribut ion. Taylor and Wang [22] has followed this
method. In this subsection, we outline the method described in existing studies.
Assume a frictionless market with no arbitrage opportunity . Let us consider a currency X,Yand a
key currencyZ. We considerXside the base currency and Yside as the quote currency in the currency
pairX−Y . Let DZ(T) be the discount factor of the key currency Z, and SXY(t) be the foreign exchange
rate for the currency pair X−Y .σXZ(K) is the implied volatility at maturity Tand a strike price K
denominated in the currency pair X−Z . By changing the currency of these subscripts, the rates of o ther
currencies are represented and we omit subscripts where the currencies do not need to be determined.
For these rates, the relationship with the inverse currency pair, SZY(t)=1
SYZ(t)andσZY(K)=
σYZ(1/K), holds. Generally, the key currency is Z=USD and the USD-JPY rate is traded in the
market. When the rate for JPY-USD is required, we convert the se rates using this relation.
LetD(T) be the discount factor of the quote currency, and Vput(K) be the put option price of the
quote currency at the strike price K,x:=logS(T) be the log exchange rate at maturity T, and p(x) be
the quote currency risk-neutral probability density. For t hese variables, the relation
Vput(K)=D(T)/integraldisplaylogK
0(K−exp(x))p(x)dx, (62)
∂Vput
∂K=D(T)/integraldisplaylogK
−∞p(x)dx, (63)
holds. Given that Vput(K) is a function of an implied volatility, the risk-neutral pr obability density can
be derived from a su ﬃciently smooth implied volatility smile.
14LetX1:=logSXZ(T),X2:=logSYZ(T) be the log rate at a maturity Tunder the risk-neutral mea-
sure of the currency Z. We also deﬁne a copula Cand the marginal distributions GX|Z(x1),GY|Z(x2)
forX1andX2, respectively. We write the joint distribution of X1andX2under the same measure as
PX,Y|Z(x1,x2) :=C(GX|Z(x1),GY|Z(x2)). (64)
Considering a call option on the strike price Kof theX−Y currency pair, theZ-denominated price
of this option is calculated as
VX,Y|Z=DZ(T)/integraldisplay∞
−∞/integraldisplay∞
−∞{exp(x1)−Kexp(x2)}+∂xPX,Y|Z(x1,x2)dx1dx2, (65)
and the implied volatility of the cross-currency pair is obt ained from the price. Additionally, by con-
sidering theZ-denominated price of the transaction that receives one amo unt of currencyYat time T,
the relationship
SYZ(0)DY(T)=DZ(T)/integraldisplay∞
−∞exp(x2)∂x2GY|Z(x2)dx2
=DZ(T)/integraldisplay∞
−∞/integraldisplay∞
−∞exp(x2)∂xPX,Y|Z(x1,x2)dx1dx2, (66)
is obtained.
4.2 Option Pricing of Cross Currency Pair Using Corrected He rmite Polynomial Ex-
pansion
We explain the application of a copula derived from a correct ed Hermite polynomial expansion to
calculate the option price of cross currency pairs discusse d in the previous subsection. Hereafter, we
assume N=2 because we consider two-dimensional probabilities for cr oss currency. In (27), we set
Σ:=/parenleftigg1ρ
ρ1/parenrightigg
, (67)
Γ:=/parenleftiggα1−α2
α1α2/parenrightigg
, (68)
Γ−1:=/parenleftiggβ1β1
−β2β2/parenrightigg
, (69)
ˆen,i(v1,v2) :=en,i(v1,v2) :=¯Hei(v1)¯Hen−i(v2),i=0,···,n, (70)
whereα1:=/radicalig
1+ρ
2,α2:=/radicalig
1−ρ
2,β1:=/radicalig
1
2(1+ρ),β2:=/radicalig
1
2(1−ρ). LetX:=(X1,X2)′be the random
variables that are not related to the exchange rates. The joi nt density ˜ pX(x1,x2), expressed using the
bivariate Hermite polynomial expansion truncated at nM(≥3), is
˜pX(x1,x2) :=1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,ien,i(β1(x1+x2),β2(−x1+x2))∂xΦΣ(x1,x2), (71)
wherev:=(v1,v2)′:=Γxand ˆm1,i=ˆm2,i=0 so that random variables ( X1,X2) have mean 0, variance
1, and correlationρ.
15LetS:={(n,i)|n=1,···,nM,i=0,···,n}be the set of subscripts for moment-matching, and
KI,en,i,(=ˆmn,i):=/braceleftbigg
φ∈H2
µΦI/vextendsingle/vextendsingle/vextendsingle/vextendsingle/angbracketleftbigφ,en,i/angbracketrightbig
µΦI=ˆmn,i/bracerightbigg
(n,i)∈S, (72)
KI,All:=KI,1,(=1)∩KI,δx,(≥0)∩/intersectiondisplay
(n,i)∈SKI,en,i,(=ˆmn,i), (73)
be the convex sets which represent the properties that must b e satisﬁed by probability density. The
probability density, represented by the formula (55), when corrected using Dykstra’s algorithm, is
obtained as
ˇpX(x1,x2) :=ProjµΦIKI,All1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,ien,i◦Γ−1(x)∂xΦΣ(x). (74)
Let the joint distribution of ˇ pX(x1,x2) beˇPX(x1,x2) and the marginal distributions be ˇGX1(x1),ˇGX2(x2),
and ˇCX(u1,u2) :=ˇPX/parenleftigˇG−1
X1(u1),ˇG−1
X2(u2)/parenrightig
be the copula derived from this probability density. Note th at
even though the marginal distributions of ˜ pX(x1,x2) and ˇ pX(x1,x2) are diﬀerent because of the e ﬀect
of the correction in (74), ˇCX(u1,u2) is a valid copula because it is based on the marginal distrib utions
ˇGX1(x1),ˇGX2(x2) recalculated from ˇ pX(x1,x2).
Applying this copula to (64) and (65), the joint distributio n of the logarithmic foreign exchange
rates becomes PX,Y|Z(x1,x2) :=ˇPX/parenleftigˇG−1
X1(GX|Z(x1)),ˇG−1
X2(GY|Z(x2))/parenrightig
. By applying the same variable
transformation as (30), the option price equation (65) beco mes
VX,Y|Z=DZ(T)/integraldisplay∞
−∞/integraldisplay∞
−∞{exp(x1)−Kexp(x2)}+∂xPX,Y|Z(x1,x2)dx1dx2
=DZ(T)/integraldisplay∞
−∞/integraldisplay∞
−∞/braceleftig
exp/parenleftig
G−1
X|Z/parenleftigˇGX1(α1v1−α2v2)/parenrightig/parenrightig
−Kexp/parenleftig
G−1
Y|Z/parenleftigˇGX2(α1v1+α2v2)/parenrightig/parenrightig/bracerightig
+
×ProjµΦIKI,All1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,ien,i∂v1Φ(v1)∂v2Φ(v2)dv1dv2. (75)
This expression can be regarded as an inner product calculat ion inH2
µΦIand can be calculated using the
same discretization as the calculation of the projection Pr ojµΦIKI,All/parenleftig
1+/summationtextnM
n=3/summationtextn
i=0ˆmn,ien,i/parenrightig
.
4.3 Change of ˆmn,iand Shape of Density
In this subsection, we show how the density of cross currency pair rates changes with the parameter
ˆmn,i, using simple calculation with rough approximation. Let νXZandσXZbe the mean and stan-
dard deviation of log( SXZ(T)), respectively, and νYZandσYZbe the mean and standard deviation of
log(SYZ(T)), respectively. We assumelog(SXZ(T))−νXZ
σXZ∼X1andlog(SYZ(T))−νYZ
σYZ∼X2, and obtain
G−1
X|Z(GX1(x1))=νXZ+σXZx1, (76)
G−1
Y|Z(GX2(x2))=νYZ+σYZx2. (77)
16Furthermore, by assuming ProjµΦIK¯a/parenleftig/braceleftig
1+/summationtextnM
n=3/summationtextn
i=0ˆmn,ien,i/bracerightig/parenrightig
=1+/summationtextnM
n=3/summationtextn
i=0ˆmn,ien,i,σ≃σXZ≃
σYZ,substituting them into (75), and rearranging, we get
VX,Y|Z≃DZ(T)/integraldisplay∞
−∞/braceleftbigexp/parenleftbigνXZ−νYZ−2σα2v2/parenrightbig−K/bracerightbig
+
×/integraldisplay∞
−∞exp/parenleftbigνYZ+σ(α1v1+α2v2)/parenrightbig1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,ien,i∂v1Φ(v1)dv1∂v2Φ(v2)dv2
=DZ(T) exp/parenleftigg
νYZ+1
2σ2/parenleftig
α2
1+α2
2/parenrightig/parenrightigg/integraldisplay∞
−∞/braceleftbigexp/parenleftbigνXZ−νYZ−2σα2v2/parenrightbig−K/bracerightbig
+
×1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,i/integraldisplay∞
−∞¯Hei(v1)∂v1Φ(v1−σα1)dv1¯Hen−i(v2)∂v2Φ(v2−σα2)dv2
=DZ(T)/integraldisplay∞
−∞/braceleftbigexp/parenleftbigνXZ−νYZ−2σα2v2/parenrightbig−K/bracerightbig
+Λ(v2−σα2)∂v2Φ(v2−σα2)dv2,(78)
whereΛ(v) is
Λ(v) :=eνYZ+1
2σ2(α2
1+α2
2)1+nM/summationdisplay
n=3n/summationdisplay
i=0ˆmn,i(σα1)i
√
i!¯Hen−i(v+σα2)
=eνYZ+1
2σ2(α2
1+α2
2)1+nM/summationdisplay
n=3n/summationdisplay
i=0n−i/summationdisplay
k=0ˆmn,i/radicalbigg
(n−i)!
i!k!σn−kαi
1αn−i−k
2
(n−i−k)!¯Hek(v)
=eνYZ+1
2σ2(α2
1+α2
2)1+nM/summationdisplay
k=0¯Hek(v)nM/summationdisplay
n=max(3,k)n−k/summationdisplay
i=0ˆmn,i/radicalbigg
(n−i)!
i!k!σn−kαi
1αn−i−k
2
(n−i−k)!.(79)
In the transformation of (79), the relations obtained using the Taylor expansion of the Hermite polyno-
mial
¯Hei(x+y)=/summationtexti
k=0/radicalig
i!
k!xi−k
(i−k)!¯Hek(y), (80)
/integraltext∞
−∞¯Hei(v1)∂v1Φ(v1−σα1)dv1=(σα1)i
√
i!, (81)
are used. Under the same assumptions as those described in th is subsection, (66) become
SYZ(0)DY(T)≃DZ(T)/integraldisplay∞
−∞Λ(v2−σα2)∂v2Φ(v2−σα2)dv2. (82)
Substituting it in (78), we obtain
VX,Y|Z≃SYZ(0)DY(T)/integraldisplay∞
−∞/braceleftbigexp/parenleftbigνXZ−νYZ−2σα2v2/parenrightbig−K/bracerightbig
+¯Λ(v2)dv2, (83)
¯Λ(v2) :=Λ(v2−σα2)∂v2Φ(v2−σα2)/integraltext∞
−∞Λ(v2−σα2)∂v2Φ(v2−σα2)dv2. (84)
By considering log SXY(T)≃νXZ−νYZ−2σα2v2, the option price becomes the integral of the product
of the payoﬀ/braceleftbigSXY(T)−K/bracerightbig
+and function ¯Λ(v2), which satisﬁes the condition of probability density.
Given that ¯Λ(v2) takes the form of a Hermite polynomial expansion from (79), the parameters
ˆmn,ican be adjusted according to the moments in this probability density. Particularly, the coe ﬃcients
17of any Hermite polynomial expansion can be represented by ch anging only the parameters ˆ mn,0,n=
3,···,nM. However, if ˆ mn,0=0,n=3,···,nMis satisﬁed, the coe ﬃcients of the Hermite polynomial
expansion converge to zero when α1goes to 0. Regardless of the other parameters ˆ mn,i(i/nequal0), the
distribution asymptotically approaches a normal distribu tion in the case ofα1→0.
-0.1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
-4 -3 -2 -1  0  1  2  3  4Density
v2Gauss
Shift hat m3,0Shift hat m4,0Shift hat m3,1Shift hat m4,1
Figure 1: Change of Cross Density by Hermite Expansion Param eter.
Under the aforementioned assumptions, the shape of the dens ity¯Λ(v2) withρ=0.5, and each
changing parameter ˆ mn,i, is shown in Figure 1. ”Gauss” takes all coe ﬃcients as 0, ”Shift hat m3,0” to
”Shift hat m4,1” are the conditions for each parameter, ˆ m3,0, ˆm4,0, ˆm3,1, and ˆ m4,1, which are all set to 1.
It can be seen that the changes in the shapes of the densities w hen ˆm3,1and ˆm4,1are shifted are smaller
than those of ˆ m3,0and ˆm4,0. Other cases of changing parameters are excluded from the gr aph because
they show almost the same lines as the ”Gauss” density.
Based on the results discussed in this subsection, we adopt a setting where all parameters are set
to 0 except for ˆ mn,0, and conﬁrm the ﬁtting of the proposed method to the volatili ty smile of the cross-
currency pair in the numerical example of the next section.
5 Numerical Examples
5.1 Approximation of Joint Distribution by Corrected Hermi te Polynomial Expansion
We show numerical examples of the approximation of several j oint distributions using the multivariate
Hermite expansion and its correction proposed in Section 3.
The target joint distributions are obtained by composing so me copulasC(u1,u2) and standard nor-
mal distributions as C(Φ(x1),Φ(x2)). The parameters of the proposed copula are calculated usi ng (31).
Next, we calculate joint density using (46) as ”No Correctio n” and (50) as ”Applying Correction” in
these parameters, and plot them as contours.
18The setting of the proposed copula is ˆ en,i(v1,v2) :=en,i(v1,v2) :=¯Hei(v1)¯Hen−i(v2),i=0,···,n
andnM=4. We prepare case (a) as Σ=Γ=I, and (b) asρ=/integraltext
R2x1x2∂xC(Φ(x1),Φ(x2))dxand using
(67), (68). In the correction, the projection satisﬁes the c onditions that the value of the integral in the
whole range is 1, the non-negativity condition of the probab ility density, and the matching condition of
the parameter ˆ mn,ifor the terms up to nM=4. To adjust the density function, we calculate 200 equal
sections for each direction in the region [ −6,6]×[−6,6]. For the copula to be approximated, we use the
two-dimensional Clayton, Frank, Gumbel, and Placett copul as with the parameters being set to reﬂect
that Spearman’s rank correlation is 0.6.
Figure 2 is a contour plot of the probability density when the Clayton copula is used to construct
a joint density whose marginal distributions are standard n ormal distributions. Figure 3 and Figure 4
show contour plots of (46) (No correction) and (50) (Applyin g correction) in the case (a). Figure 5
and Figure 6 show contour plots of (46) (No correction) and (5 0) (Applying correction) in the case
(b). Figures 27 - 31, Figures 32 - 36 and Figures 37 - 41 in appen dix are contour plots for the Frank,
Gumbel, and Placett copulas under the same settings as those of the Clayton copula.
For any case with target copulas, the proposed method with nM=4 reproduces the shape of the
original joint densities and presents good approximations . Additionally, it can be seen that the non-
negative constraint is satisﬁed when the correction is appl ied. In case (a), the contour lines tend to be
less smooth, while they are smoother and more similar to the o riginal density in case (b).
Table 2 shows the moments up to the eighth order, when the prob ability density is constructed using
the Clayton copula with the standard normal distribution as the marginal distributions. Table 3 shows
the moments up to the eighth order, when nM=4 andΣare set to case (a). Tables 6 - 11 in Appendix
show the moments for the Frank, Gumbel, and Placett copulas, under the same settings as Tables 2 and
3. It is conﬁrmed that the moments up to the fourth order are co nsistent with the original distribution.
Moreover, the moments related to the correction conditions are preserved even when the corrections
are applied.
190.20.180.16
0.160.14
0.140.120.12
0.10.10.08
0.080.080.06
0.060.060.04
0.040.040.02
0.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 2: Density by Clayton copula.
0.18 0.160.140.12
0.120.1
0.10.08
0.080.06
0.060.060.04
0.040.040.02
0.020.02
00
00
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 3: Expansion using (a) and (No correction)
ﬁtting to Clayton copula distribution0.20.180.160.14
0.140.12
0.120.1
0.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 4: Expansion using (a) and (Applying cor-
rection) ﬁtting to Clayton copula distribution
0.22 0.20.180.16
0.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.02
0.020.02
0
00
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 5: Expansion using (b) and (No correction)
ﬁtting to Clayton copula distribution0.20.180.16
0.160.14
0.140.12
0.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.020.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 6: Expansion using (b) and (Applying cor-
rection) ﬁtting to Clayton copula distribution
The moments of marginal distributions (columns of x0
1and rows of x0
2) in Table 3 diﬀer from the
20moments of the standard normal distribution in the higher-o rder terms, for which the moment condition
is not imposed. This indicates that the marginal distributi ons may change because of the correction.
Therefore, it is necessary to recalculate the marginal dist ributions or to correct them by introducing the
condition that the marginal distributions should also coin cide with those of the original joint distribution
to construct a copula from the corrected joint density.
Accordingly, the proposed method can properly approximate the diﬀerent simultaneous distribu-
tions and probability density can be corrected without chan ging the moments related to the speciﬁed
conditions.
Table 2: Moments of Clayton Copula with Normal Marginal
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 -0.000 1.000 -0.000 3.000 -0.000 15.000 -0.000 105.00 0
x1
2-0.000 0.611 -0.324 1.818 -1.766 8.994 -12.172 62.311
x2
21.000 -0.324 1.811 -1.885 8.145 -13.263 54.973
x3
2-0.000 1.818 -1.885 7.670 -13.818 50.886
x4
23.000 -1.766 8.145 -13.818 50.239
x5
2-0.000 8.994 -13.263 50.886
x6
215.000 -12.172 54.973
x7
2-0.000 62.311
x8
2105.000
Table 3: Moments of Fourth Hermite Expansion with Correctio n from Clayton Copula
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 -0.000 1.000 -0.000 3.000 -0.170 14.350 -2.291 92.643
x1
2-0.000 0.611 -0.324 1.818 -1.383 8.540 -7.619 54.865
x2
21.000 -0.324 1.811 -1.200 7.479 -6.120 44.569
x3
2-0.000 1.818 -1.200 6.811 -6.115 37.183
x4
23.000 -1.383 7.479 -6.115 35.883
x5
2-0.170 8.540 -6.120 37.183
x6
214.350 -7.619 44.569
x7
2-2.291 54.865
x8
292.643
5.2 Numerical Examples of Cross Currency Volatility
This section compares the method for estimating cross curre ncy volatilities using copulas proposed in
this study with the method that uses well-known classical co pulas, as presented in Taylor and Wang
[22].
5.2.1 Calibration to Cross Currency Volatility Smile
First, we examine the ﬁtting to the volatility smile of cross currency pairs. Supported by CARF, we
obtain the volatility data of ATM, 25 Delta Call, 25 Delta Put , 10 Delta Call, and 10 Delta Put for
EUR-USD and USD-JPY , provided by Bloomberg. Next, we interp olate and extrapolate the data to be
21continuous to the second derivative without any arbitrage, using the method by Kahale [9]. Further-
more, we calculate the volatilities of the ATM, 25 Delta Call , 25 Delta Put, 10 Delta Call, and 10 Delta
Put of the EUR-JPY using the Gauss, Frank, Placett, Clayton, and Gumbel copulas, and the proposed
copula. We calibrate the parameters of the copula to minimiz e the mean of squares of the di ﬀerence
between the original and estimated volatilities for ATM, 25 Delta Call, 25 Delta Put, 10 Delta Call, and
10 Delta Put of the EUR-JPY , obtained from Bloomberg. In the c ase with more than two parameters
(proposed copula), the quasi-Newton method is used for mini mization. For the case with one parameter
(other copulas), the Brent method (See Press et al. [15]) is u sed.
We set NM=6 in the formula (75). ρ,ˆm3,0,ˆm4,0,ˆm5,0,andˆm6,0are chosen as the calibration param-
eters, and the other parameters ˆ mn,iare set to 0. Non-negativity of the probability density, nor malized
condition of the probability density, and moments match of ˆ mi,0,(1≤i≤6) including ˆ m1,0=0
and ˆm2,0=0. They are chosen as the properties for the correction ProjµΦIKI,All/parenleftig
1+/summationtextnM
n=3/summationtextn
i=0ˆmn,ien,i/parenrightig
ˆmi,0,(1≤i≤6). In this situation, we use the correction of a one-dimensi onal product discussed in
subsection 3.4.
Hereafter, the volatilities set for ATM, 25 Delta Call, 25 De lta Put, 10 Delta Call, and 10 Delta
Put are called “smiles,” and estimating the parameters of ea ch copula using the method described here
is called calibrating to the smile. We also scale the coe ﬃcients according to the parameters of the
proposed copula, using ˇ mi=i!×ˆmi,0,i=1,···,6.
 0.064 0.066 0.068 0.07 0.072 0.074 0.076 0.078 0.08
 124  126  128  130  132  134  136  138Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 7: EUR-JPY 3M Implied volatility (Oct 29
2021) 0.085 0.09 0.095 0.1 0.105 0.11 0.115 0.12 0.125 0.13 0.135
 118  120  122  124  126  128  130  132  134  136  138Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 8: EUR-JPY 3M Implied volatility (Feb 28
2022)
22 0.07 0.075 0.08 0.085 0.09 0.095
 115  120  125  130  135  140  145  150Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 9: EUR-JPY 1Y Implied volatility (Oct 29
2021) 0.08 0.085 0.09 0.095 0.1 0.105 0.11 0.115 0.12 0.125 0.13
 110  115  120  125  130  135  140  145  150Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 10: EUR-JPY 1Y Implied volatility (Feb 28
2022)
 0.075 0.08 0.085 0.09 0.095 0.1 0.105 0.11 0.115
 90  100  110  120  130  140  150  160  170Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 11: EUR-JPY 5Y Implied volatility (Oct 29
2021) 0.08 0.09 0.1 0.11 0.12 0.13 0.14
 80  90  100  110  120  130  140  150  160  170Implied Volatility
strikeMarket
Clayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 12: EUR-JPY 5Y Implied volatility (Feb 28
2022)
Table 4: Fitting parameters for EUR-JPY Smile
Date Tenor Clayton Frank Gumbel Placett Gauss
Oct 29 2021 3M 0.8160 3.0926 1.3357 4.2196 0.4203
Feb 28 2022 3M 0.2601 1.3456 1.1283 1.9490 0.1928
Oct 29 2021 1Y 0.6031 2.6733 1.2842 3.5460 0.3657
Feb 28 2022 1Y 0.3859 1.8095 1.1679 2.4207 0.2541
Oct 29 2021 5Y 0.7708 3.1600 1.2982 4.2894 0.4068
Feb 28 2022 5Y 0.5922 2.5364 1.2211 3.3346 0.3342
23Table 5: Fitting Parameters of Hermite Expansion Copula for EUR-JPY Smile
Date Tenorρ ˇm3 ˇm4 ˇm5 ˇm6
Oct 29 2021 3M 0.3884 -0.2960 0.5528 0.0924 -2.4115
Feb 28 2022 3M 0.2080 -0.5156 0.6395 0.5010 -2.4400
Oct 29 2021 1Y 0.3661 -0.3535 0.9641 0.0827 -2.0537
Feb 28 2022 1Y 0.2679 -0.4929 0.7944 0.3854 -3.2577
Oct 29 2021 5Y 0.4068 -0.4090 1.2771 -0.1257 -2.6293
Feb 28 2022 5Y 0.3477 -0.7098 1.3640 0.2541 -5.1991
The results of calibrating to EUR-JPY smiles of 3M, 1Y , and 5Y on October 29, 2021 are shown
in Figures 7, 9, and 11. The results of calibrating to smiles o f 3M, 1Y and 5Y on February 28, 2022
are shown in Figures 8, 10, and 12. The date October 29, 2021 is selected because it was marked with
a period of relatively calm market movement throughout the f ollowing month, while February 28 2022
was selected as a time of market turbulence caused by the comb ination of the Ukrainian war and an
increased interest rate in the U.S. over the following month .
”Market” in Figures 7 -12 is the original smile of the EUR-JPY . ”Gauss”, ”Frank”, ”Placett”, ”Clay-
ton”, and ”Gumbel” are the implied volatilities of the respe ctive copulas. ”Hermite” is the implied
volatility of the proposed method. Tables 4 and 5 are the copu la parameters obtained through the
calibration.
The smiles estimated using the ”Hermite” are much closer to t he original smiles than those esti-
mated using other copulas. This indicates that the selected parameters can suﬃciently replicate the
original volatility smile. However, when other copulas are used, large diﬀerences from the original
volatility smile are observed. It is di ﬃcult to express a strongly skewed shape using these classica l
copulas.
The parameterρof the proposed method is close to that of the Gauss copula, wh ich is consistent
with the fact that it is an extension of the Gauss copula.
Additionally, negative values are obtained as the coe ﬃcient ˇ m6for the highest order. This indi-
cates that there exists a negative density region in the non- corrected Hermite polynomial expansion;
nonetheless, the correction method satisﬁes non-negativi ty and the copula is obtained.
5.2.2 Estimation of Monthly Cross Currency Volatility Smil e
In the market, the liquidity of the volatility of cross curre ncy pairs is generally less than that of the
straight currency pairs. For example, there could be a situa tion where the smiles for the straight cur-
rency pairs can be obtained daily but a smile for a cross curre ncy pair can only be obtained monthly.
We also consider the case that the smile of a cross currency pa ir can be obtained monthly but the ATM
volatility can be obtained daily.
In this section, we examine the same copulas as in the previou s section under two di ﬀerent settings.
One setting (c) is to calibrate the copula parameters accord ing to the smile of the cross-currency pair
at the end of the previous month. Next, one of the parameters i s calibrated to match the ATM volatility
of the cross-currency pair for each business day of the curre nt month. Accordingly, we calculate the
smile. In the other setting (d), the copula parameters are ca librated according to the smile of the cross-
currency pair at the end of the previous month, and the parame ters are used to calculate the smile of the
crosscurrency pair for each business day in the current mont h.
First, we verify which parameters of the proposed copula sho uld be used for daily calibrations in
setting (c).
24 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14
-4 -2  0  2  4Implied Volatility 
ParamterHermiteRho
Hermite3
Hermite4
Hermite5
Hermite6
Figure 13: V olatility of Parameter shift (Oct 29 2021)
Figure 13 plots the change in EUR-JPY ATM volatility when onl y one parameter is shifted from
the parameters set on October 29, 2021 with 1Y tenor in Table 5 .
”HermiteRho”, ”Hermite3”, ”Hermite4”, ”Hermite5”, and ”H ermite6”, correspond to the case
where each parameter ρ, ˇm3, ˇm4, ˇm5, and ˇ m6has moved. The horizontal axis denotes the value of
each parameter and the vertical axis denotes the value of ATM volatility.
ˇm3, ˇm4, and ˇ m5are not monotonically changing graphs. There may be more tha n one solution
for the root of the given ATM volatility, which leads to param eter instability when ﬁtting daily ATM
volatility.
25 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateHermiteRho
Hermite3
Hermite4
Hermite5
Hermite6
Figure 14: EUR-JPY 1Y Daily RMSE with calibration of Hermite parameters (Nov 2021)
Figure 14 plots the root mean squared error (RMSE) between th e real smile of EUR-JPY with 1Y
tenor and estimated smile with recalibrated parameters fro m each business day in Nov 2021. Recalibra-
tion is carried out by adjusting the ATM volatility of EUR-JP Y for each business day and by changing
one of the parameters that were calibrated according to the s mile on October 29, 2021. The Brent
method is used for recalibration.
The relations between the legend and parameters in Figure 14 are the same as those in Figure 13.
The RMSE of daily calibrations with ρis the smallest and stable throughout the whole term. These
results suggest that ρshould be used for calibrating to ATM volatility.
 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 15: Daily RMSE of tenor 3M and (c) in Nov
2021 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 16: Daily RMSE of tenor 3M and (d) in Nov
2021
26 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 17: Daily RMSE of tenor 1Y and (c) in Nov
2021 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 18: Daily RMSE of tenor 1Y and (d) in Nov
2021
 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 19: Daily RMSE of tenor 5Y and (c) in Nov
2021 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01
Nov 04 2021 Nov 11 2021 Nov 18 2021 Nov 25 2021RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 20: Daily RMSE of tenor 5Y and (d) in Nov
2021
Figures 15 - 20 show the daily RMSE in November 2021 whose mark et data are 3M, 1Y , and 5Y
tenor and settings are (c) and (d). Figures 42 - 47 in Appendix are the daily RMSE in March 2022
whose tenor and settings are the same as those in Figures 15 - 2 0.
The RMSE using the proposed copula show smaller RMSE for many days compared to those that
have been computed using other copulas. Additionally, the R MSE in setting (c) is much lower than that
in setting (d) across many days. This fact implies that the co pula parameterρcan accurately explain the
volatility smile ﬂuctuations in the cross-currency pair, w hich are not explained by the volatility smile
ﬂuctuations in straight currency pairs.
27 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035 0.04 0.045
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 21: Monthly RMSE tenor 3M and (c) 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035 0.04 0.045
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 22: Monthly RMSE tenor 3M and (d)
 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 23: Monthly RMSE tenor 1Y and (c) 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 24: Monthly RMSE tenor 1Y and (d)
 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 25: Monthly RMSE tenor 5Y and (c) 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035
2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 26: Monthly RMSE tenor 5Y and (d)
Figures 21 - 26 show the monthly RMSE calculated using 3M, 1Y , and 5Y tenor market data from
January, 2007 to April, 2022, for each business day in the mon th. In setting (c), after calibrating
the smile of the cross-currency pair at the end of the previou s month, one parameter ( ρfor proposed
28methods) is recalibrated to match the ATM volatility of the c ross-currency pair for each business day,
and the smile is calculated using the recalibrated paramete r. In setting (d), the copula parameters are
calibrated according to the smile of the cross-currency pai r at the end of the previous month, and the
same parameters are used to calculate the smile of the cross- currency pair for each business day.
For the maturities 1Y and 5Y , the errors of the proposed metho d are smaller than those of the other
copulas for most months. In the case of 3M maturity, it is foun d that the proposed method has smaller
errors for most months in setting (c), and the errors of the pr oposed method are similar to those of the
other copulas in setting (d). Therefore, it can be inferred t hat the parameterρin our method plays an
important role in explaining the daily ﬂuctuations in volat ility smiles of cross currency pairs, especially
in short-term maturities.
Therefore, the proposed method is more e ﬀective than the method that uses well-known copulas.
6 Conclusion
In this study, we proposed a method for constructing copulas using multivariate Hermite polynomial
expansion, a method for estimating parameters. We also prop osed a correction for satisfying properties
of density function using projection onto convex set in Hilb ert spaces. Furthermore, we proposed
its application to a method for estimating the volatility sm iles of cross currency pairs and compared
the results with those of the volatility smiles of straight c urrency pairs. We derive that the proposed
copula parameters can adjust the higher-order moments unde r risk-neutral measures for cross currency
pairs. Numerical experiments showed that the proposed copu la can approximate many types of joint
distributions. Additionally, the application to the estim ation of the volatility of the cross currency pairs
shows that the proposed copula provides better estimates th an the other copulas.
References
[1] Dante Amengual and Enrique Sentana. Is a normal copula th e right copula? Journal of Business
&Economic Statistics , V ol. 38, No. 2, pp. 350–366, 2020.
[2] Yves I Ngounou Bakam and Denys Pommeret. Nonparametric e stimation of copulas and copula
densities by orthogonal projections. arXiv preprint arXiv:2010.15351 , 2020.
[3] Douglas T Breeden and Robert H Litzenberger. Prices of st ate-contingent claims implicit in option
prices. Journal of business , pp. 621–651, 1978.
[4] Damiano Brigo, Massimo Morini, and Andrea Pallavicini. Counterparty credit risk, collateral
and funding: with pricing cases for all asset classes , V ol. 478. John Wiley & Sons, 2013.
[5] Umberto Cherubini. Credit valuation adjustment and wro ng way risk. Quantitative Finance
Letters , V ol. 1, No. 1, pp. 9–15, 2013.
[6] Umberto Cherubini, Elisa Luciano, and Walter Vecchiato .Copula methods in ﬁnance . John Wiley
& Sons, 2004.
[7] Frank Deutsch. Best approximation in inner product spaces , V ol. 7. Springer, 2001.
[8] Charles F Dunkl and Yuan Xu. Orthogonal polynomials of several variables . No. 155. Cambridge
University Press, 2014.
29[9] Nabil Kahal´ e. Smile interpolation and calibration of t he local volatility model. Risk Magazine ,
V ol. 1, No. 6, pp. 637–654, 2005.
[10] Allan M Krall. Hilbert space, boundary value problems, and orthogonal pol ynomials , V ol. 133.
Springer Science & Business Media, 2002.
[11] Adam Krzemienowski and Sylwia Szymczyk. Portfolio opt imization with a copula-based exten-
sion of conditional value-at-risk. Annals of Operations Research , V ol. 237, No. 1, pp. 219–236,
2016.
[12] Jean-Paul Laurent, Jon Gregory, et al. Basket default s waps, cdos and factor copulas. Journal of
risk, V ol. 7, No. 4, pp. 103–122, 2005.
[13] David X Li. On default correlation: A copula function ap proach. The Journal of Fixed Income ,
V ol. 9, No. 4, pp. 43–54, 2000.
[14] Kohei Marumo and Rondney Wol ﬀ. A non-parametric method for approximating joint densi-
ties and copula functions for ﬁnancial markets. Saitama University Japan Faculty of Economics
Working Paper Series , No. 4, pp. 0–46, 2013.
[15] William H. Press, Saul A. Teukolsky, William T. Vetterl ing, and Brian P. Flannery. Numerical
Recipes in C . Cambridge University Press, Cambridge, USA, second editi on, 1992.
[16] Piero Quatto, Gianmarco Vacca, and Maria Grazia Zoia. A new copula for modeling portfolios
with skewed, leptokurtic and high-order dependent risk fac tors. The North American Journal of
Economics and Finance , V ol. 58, p. 101529, 2021.
[17] Alessio Sancetta and Stephen Satchell. The bernstein c opula and its applications to modeling and
approximations of multivariate distributions. Econometric theory , V ol. 20, No. 3, pp. 535–562,
2004.
[18] Stoyan V Stoyanov, Borjana Racheva-Iotova, Svetlozar T Rachev, and Frank J Fabozzi. Stochastic
models for risk estimation in volatile markets: a survey. Annals of Operations Research , V ol. 176,
No. 1, pp. 293–309, 2010.
[19] Akihiko Takahashi and Yukihiro Tsuzuki. A new improvem ent scheme for approximation meth-
ods of probability density functions. Journal of Computational Finance , V ol. 19, No. 4, 2016.
[20] Bertrand Tavin. Application of bernstein copulas to th e pricing of multi-asset derivatives. In
Copulae in Mathematical and Quantitative Finance , pp. 277–288. Springer, 2013.
[21] Bertrand Tavin. Measuring exposure to dependence risk with random bernstein copula scenarios.
European Journal of Operational Research , V ol. 270, No. 3, pp. 873–888, 2018.
[22] Stephen J Taylor and Yaw-Huei Wang. Option prices and ri sk-neutral densities for currency cross
rates. Journal of Futures Markets: Futures, Options, and Other Der ivative Products , V ol. 30,
No. 4, pp. 324–360, 2010.
[23] Mike G Tsionas and Athanasios Andrikopoulos. On a high- dimensional model representation
method based on copulas. European Journal of Operational Research , V ol. 284, No. 3, pp. 967–
979, 2020.
30Appendix A Tables and Figures
In Appendix, tables and graphs of Sections 5.1 and 5.2 are pre sented.
Table 6: Moments of Frank Copula with Normal Marginal
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 0.000 1.000 0.000 3.000 0.000 15.000 0.000 105.000
x1
20.000 0.570 0.000 1.423 0.000 6.114 -0.000 37.736
x2
21.000 -0.000 1.361 -0.000 4.559 -0.000 23.865
x3
20.000 1.423 -0.000 3.781 -0.000 16.729
x4
23.000 0.000 4.559 -0.000 15.886
x5
20.000 6.114 -0.000 16.729
x6
215.000 -0.000 23.865
x7
20.000 37.736
x8
2105.000
Table 7: Moments of Fourth Hermite Expansion with Correctio n from Frank Copula
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 -0.000 1.000 0.000 3.000 -0.000 15.072 -0.000 107.551
x1
2-0.000 0.570 -0.000 1.423 -0.000 5.875 -0.000 32.682
x2
21.000 -0.000 1.361 -0.000 4.970 -0.000 29.094
x3
2-0.000 1.423 -0.000 3.541 -0.000 14.229
x4
23.000 -0.000 4.970 -0.000 20.087
x5
2-0.000 5.875 -0.000 14.229
x6
215.072 -0.000 29.094
x7
20.000 32.682
x8
2107.551
Table 8: Moments of Gumbel Copula with Normal Marginal
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 0.000 1.000 0.000 3.000 0.000 15.000 0.000 105.000
x1
20.000 0.622 0.175 1.911 1.014 9.716 7.333 68.788
x2
21.000 0.175 1.900 1.138 8.647 8.580 58.767
x3
20.000 1.911 1.138 8.082 9.113 53.277
x4
23.000 1.014 8.647 9.113 52.236
x5
20.000 9.716 8.580 53.277
x6
215.000 7.333 58.767
x7
20.000 68.788
x8
2105.000
31Table 9: Moments of Fourth Hermite Expansion with Correctio n from Gumbel Copula
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 0.000 1.000 0.000 3.000 0.103 14.934 0.936 103.464
x1
20.000 0.622 0.175 1.911 0.745 9.242 4.234 60.994
x2
21.000 0.175 1.900 0.625 8.029 2.984 49.564
x3
20.000 1.911 0.625 6.961 3.298 37.786
x4
23.000 0.745 8.029 3.298 38.846
x5
20.103 9.242 2.984 37.786
x6
214.934 4.234 49.564
x7
20.936 60.994
x8
2103.464
Table 10: Moments of Placett Copula with Normal Marginal
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 0.000 1.000 0.000 3.000 -0.000 15.000 0.000 105.000
x1
20.000 0.579 0.000 1.507 0.000 6.624 0.000 41.358
x2
21.000 0.000 1.533 0.000 5.442 0.000 29.348
x3
20.000 1.507 0.000 4.486 -0.000 21.085
x4
23.000 0.000 5.442 0.000 20.823
x5
20.000 6.624 0.000 21.085
x6
215.000 0.000 29.348
x7
20.000 41.358
x8
2105.000
Table 11: Moments of Fourth Hermite Expansion with Correcti on from Placett Copula
x0
1x1
1x2
1x3
1x4
1x5
1x6
1x7
1x8
1
x0
21.000 0.000 1.000 0.000 3.000 0.000 15.070 0.000 106.761
x1
2-0.000 0.579 0.000 1.507 -0.000 6.427 -0.000 37.382
x2
21.000 -0.000 1.533 -0.000 6.031 0.000 36.969
x3
2-0.000 1.507 -0.000 4.051 -0.000 17.464
x4
23.000 -0.000 6.031 0.000 26.791
x5
20.000 6.427 0.000 17.464
x6
215.070 -0.000 36.969
x7
20.000 37.382
x8
2106.761
320.20.18 0.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 27: Density by Frank copula.
0.16 0.140.12
0.120.1
0.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.0200
0
0
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 28: Expansion using (a) and (No correction)
ﬁtting to Frank copula distribution0.160.14
0.140.12
0.120.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 29: Expansion using (a) and (Applying cor-
rection) ﬁtting to Frank copula distribution
0.20.180.160.14
0.140.12
0.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
00
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 30: Expansion using (b) and (No correction)
ﬁtting to Frank copula distribution0.20.180.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 31: Expansion using (b) and (Applying cor-
rection) ﬁtting to Frank copula distribution
330.20.180.16
0.160.14
0.14
0.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 32: Density by Gumbel copula.
0.180.160.140.12
0.120.1
0.10.080.08
0.060.060.04
0.040.040.02
0.020.02
00
00
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 33: Expansion using (a) and (No correction)
ﬁtting to Gumbel copula distribution0.2 0.180.160.14
0.140.12
0.120.1 0.1
0.080.080.06
0.060.060.04
0.040.04 0.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 34: Expansion using (a) and (Applying cor-
rection) ﬁtting to Gumbel copula distribution
0.20.180.16
0.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.04
0.02
0.020.020
0
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 35: Expansion using (b) and (No correction)
ﬁtting to Gumbel copula distribution0.20.180.16
0.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.04
0.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 36: Expansion using (b) and (Applying cor-
rection) ﬁtting to Gumbel copula distribution
340.240.220.20.180.16
0.160.14
0.140.120.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 37: Density by Plackett copula.
0.18 0.160.140.12
0.120.1
0.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.0200
0
0
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 38: Expansion using (a) and (No correction)
ﬁtting to Plackett copula distribution0.180.160.14
0.140.12
0.120.1
0.10.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 39: Expansion using (a) and (Applying cor-
rection) ﬁtting to Plackett copula distribution
0.220.20.180.16
0.160.14
0.14 0.12 0.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 40: Expansion using (b) and (No correction)
ﬁtting to Plackett copula distribution0.220.20.180.16
0.160.14
0.14 0.12 0.12
0.10.1
0.080.080.06
0.060.060.04
0.040.040.02
0.020.02
-3 -2 -1  0  1  2  3
x2-3-2-1 0 1 2 3x1
Figure 41: Expansion using (b) and (Applying cor-
rection) ﬁtting to Plackett copula distribution
35 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 42: Daily RMSE of tenor 3M and (c) in
March, 2022 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 43: Daily RMSE of tenor 3M and (d) in
March, 2022
 0 0.002 0.004 0.006 0.008 0.01 0.012
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 44: Daily RMSE of tenor 1Y and (c) in
March, 2022 0 0.002 0.004 0.006 0.008 0.01 0.012
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 45: Daily RMSE of tenor 1Y and (d) in
March, 2022
 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 46: Daily RMSE of tenor 5Y and (c) in
March, 2022 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016
Mar 03 2022 Mar 10 2022 Mar 17 2022 Mar 24 2022 Mar 31 2022RMSE of Implied Volatility 
DateClayton
Frank
Gumbel
Placett
Gauss
Hermite
Figure 47: Daily RMSE of tenor 5Y and (d) in
March, 2022
36