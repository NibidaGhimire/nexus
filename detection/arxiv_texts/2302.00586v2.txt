Published in Transactions on Machine Learning Research (02/2023)
PRUDEX-Compass: Towards Systematic Evaluation of
Reinforcement Learning in Financial Markets
Shuo Sun shuo003@e.ntu.edu.sg
School of Computer Science and Engineering
Nanyang Technological University
Molei Qin molei.qin@ntu.edu.sg
School of Computer Science and Engineering
Nanyang Technological University
Xinrun Wang∗xinrun.wang@ntu.edu.sg
School of Computer Science and Engineering
Nanyang Technological University
Bo An∗boan@ntu.edu.sg
School of Computer Science and Engineering
Nanyang Technological University
Reviewed on OpenReview: https: // openreview. net/ forum? id= JjbsIYOuNi
Abstract
The ﬁnancial markets, which involve more than $90 trillion market capitals, attract the at-
tentionofinnumerableinvestorsaroundtheworld. Recently, reinforcementlearninginﬁnan-
cial markets (FinRL) has emerged as a promising direction to train agents for making prof-
itable investment decisions. However, the evaluation of most FinRL methods only focuses
on proﬁt-related measures and ignores many critical axes, which are far from satisfactory
for ﬁnancial practitioners to deploy these methods into real-world ﬁnancial markets. There-
fore, we introduce PRUDEX-Compass , which has 6 axes, i.e., Proﬁtability, Risk-control,
Universality, Diversity, rEliability, and eXplainability, with a total of 17 measures for a sys-
tematic evaluation. Speciﬁcally, i) since most existing FinRL algorithms are only designed
to maximize proﬁt with poor performance under systematic evaluation, we introduce Al-
phaMix+, which leverages mixture-of-experts and risk-sensitive approaches, to serve as one
strong FinRL baseline that outperforms market average on all 6 axes in PRUDEX-Compass,
ii) we evaluate AlphaMix+ and 7 other FinRL methods in 4 long-term real-world datasets
of inﬂuential ﬁnancial markets to demonstrate the usage of our PRUDEX-Compass and
the superiority of AlphaMix+, iii) PRUDEX-Compass1together with 4 real-world datasets,
standard implementation of 8 FinRL methods, a portfolio management environment and
related visualization toolkits is released as public resources to facilitate the design and com-
parisonofnewFinRLmethods. WehopethatPRUDEX-Compasscannotonlyshedlighton
future FinRL research to prevent untrustworthy results from stagnating FinRL into success-
ful industry deployment but also provide a new challenging algorithm evaluation scenario
for the reinforcement learning (RL) community.
∗Corresponding Authors
1https://github.com/TradeMaster-NTU/PRUDEX-Compass
1arXiv:2302.00586v2  [q-fin.TR]  2 Mar 2023Published in Transactions on Machine Learning Research (02/2023)
1 Introduction
Quantitative trading (QT)relies on mathematicaland statistical models to automatically identifyinvestment
opportunities (Chan, 2021). With the development of the artiﬁcial intelligence, it becomes more popular
and accounts for more than 70% and 40% trading volumes, in developed markets (e.g., US) and developing
markets (e.g., China), respectively (Karpoﬀ, 1987). How to make proﬁtable investment decisions against
the various uncertainties in quantitative trading becomes one of the main challenges for ﬁnancial practition-
ers (An et al., 2022). Among the various machine learning methods, such as deep learning (Xu & Cohen,
2018; Sawhney et al., 2021) and boosting decision trees (Ke et al., 2017), deep reinforcement learning (DRL)
is attracting increasing attention from both academia and ﬁnancial industries (Sun et al., 2023) due to its
stellar performance on solving complex sequential problems such as Go (Silver et al., 2017), StarCraft-II
(Vinyals et al., 2019), nuclear fusion (Degrave et al., 2022) and matrix mulplication (Fawzi et al., 2022).
Deep RL has achieved signiﬁcant success in various quantitative trading tasks. Speciﬁcally, FDDR (Deng
et al., 2016) and iRDPG (Liu et al., 2020b) are designed to learn ﬁnancial trading signals and micmic
behaviors of professional traders for algorithmic trading, respectively. For portfolio management, deep RL
methods are proposed to account for the impact of market risk (Wang et al., 2021b) and the commission
fee (Wang et al., 2021a). A PPO-based framework (Lin & Beling, 2020) is proposed for order execution
and a policy distillation mechanism is added to bridge the gap between imperfect market states and optimal
execution actions (Fang et al., 2021). For market making, deep RL methods are introduced from both
game-theoretic (Spooner et al., 2018) and adversarial learning (Spooner & Savani, 2020) perspectives as an
adaptation of traditional mathematical models.
However, the evaluation of existing FinRL methods (Sun et al., 2022; Wang et al., 2021a; Fang et al., 2021)
only focuses on proﬁt-related measures, which ignores several critical axes, such as risk-control and reliability.
In addition to proﬁtability, ﬁnancial practitioners care about many other aspects of FinRL methods, i.e.,
how much risk I need to take for per unit of proﬁt; how FinRL algorithms behave when the market status
changes. In preliminary experiments, we ﬁnd many examples that indicate the weakness of existing proﬁt-
seeking FinRL algorithms. For instance, IMIT (Ding et al., 2018) may lead to catastrophic capital loss when
black swan events happen (Section 6.7 ) and SAC (Haarnoja et al., 2018) shows poor risk-control ability,
which is not an ideal option for conservative traders (Section 6.3). In practice, due to the low signal-to-noise
and distribution shift nature of ﬁnancial markets (Malkiel, 2003), FinRL methods with only high proﬁt on
backtesting are very likely to overﬁt on historical data and fail in real-world deployment (De Prado, 2018).
As Robert Pardo (CEO of a hedge fund) said, he will never trade with a method that does not prove itself
through a systematic evaluation (Pardo, 2011). Therefore, a benchmark for the systematic evaluation of
FinRL methods is urgently needed.
In this paper, we ﬁrst introduce PRUDEX-Compass, which has 6 axes with a total of 17 measures for
systematic evaluation of FinRL methods. we then propose AlphaMix+, a deep RL method composed of
diversiﬁed mixture-of-experts and risk-aware Bellman backup, as a strong FinRL baseline that signiﬁcantly
outperforms existing FinRL methods under systematic evaluation by mimicking the bottom-up hierarchical
trading strategy design workﬂow in real-world companies (Khorana et al., 2007). In addition, we evaluate 7
widely used FinRL methods together with AlphaMix+ on 4 long-term real-world datasets spanning over 15
years on popular trading tasks to demonstrate the usage of PRUDEX-Compass and the superiority of Al-
phaMix+. Accompanied with an open-source library1of datasets, baseline implementation, RL environment
and evaluation toolkits, we call for a change in how we evaluate FinRL methods to facilitate the industry de-
ployment of FinRL methods. Moreover, PRUDEX-Compass also provides the RL community new algorithm
evaluation scenarios to test the eﬀectiveness of novel RL algorithms in the ever-changing ﬁnancial markets.
2 PRUDEX-Compass: Systematic Evaluation of FinRL
To provide a clear exposition of FinRL evaluation, we introduce PRUDEX-Compass to provide an intuitive
visual means to give ﬁnancial practitioners a sense of comparability and positioning of FinRL methods.
PRUDEX-Compass is composed of two central elements: i) the axis-level (inner), which speciﬁes the diﬀerent
axes considered for FinRL evaluation and ii) measure-level (outer), which speciﬁes the measures used for
2Published in Transactions on Machine Learning Research (02/2023)
Risk ControlProﬁtabilityExplainabilityReliabilityDiversityUniversalitycountryassettypetime-scaleriskrisk-adjustedextremeprofitalpha-decayequitycurveprofilevariabilityrankordert-SNEentropycorrelationrollingheatmap
1A2CPPOSACSARLDeepTraderEIIEIMITAlphaMix+
Figure 1: Illustration of our FinRL
methods evaluation benchmark
PRUDEX-Compass. The inner star
plot provides a visual indication of the
relative strength of diﬀerent FinRL
methods in terms of six axes. A mark
on the star plot’s inner circle suggests
the market average3. The outer level
of the PRUDEX-Compass speciﬁes
which particular measures have been
evaluated in practice to show the sta-
tus of evaluation. We ﬁll the compass
with AlphaMix+ and 7 widely-used
FinRL methods to provide an intuitive
example. In general, AlphaMix+ gets
the best performance (largest score in
4 out of 6 axes) with a comprehensive
evaluation (much more markers in the
outer level).
benchmarking FinRL methods. Figuratively speaking, the axis-level maps out the relative strength of FinRL
methods in terms of each axis, whereas the measure-level provides a compact way to visually assess which
setup and evaluation measures are practically reported to point out how comprehensive the evaluation are for
FinRL algorithms. To provide a practical basis, we have directly ﬁlled the exemplary compass visualization
in Figure 1. The contributions of PURDEX-Compass are three-fold: i) carefully collecting 17 measures
from the literature of multiple disciplines (e.g., ﬁnance, artiﬁcial intelligence, statistics and engineering)
and properly categorizing them into 6 axes; ii) proposing customized version of the measures suitable for
FinRL together with a set of easy-to-use visualization tools (Section 6.2–6.7); iii) introducing PRUDEX-
Compass, a uniﬁed visual interface composed of two core elements to indicate the relative performance
strength of FinRL methods (inner part) and their evaluation completeness (outer part). We remark that
the visualization design of PRUDEX-Compass is inspired and built on top of the template code provided in
CLEVA-Compass2(Mundt et al., 2021).
2.1 Axes of PRUDEX-Compass
We choose the design of the axis-level compass as a star diagram following the idea of (Wang et al., 2022;
Mundt et al., 2021). Speciﬁcally, the axis-level element contains two hexagons, marks on all vertices of the
two hexagons4, and lines connecting the central point and vertices of hexagons. We add marks in the middle
of central point and outer circle of the axis-level to indicate the performance of market average for convenient
check. To indicate the relative strength of FinRL methods in terms of 6 critical evaluation perspectives,
we ﬁrst calculate the normalized score of each FinRL algorithm in terms of each axis by normalizing the
numeric values of original experimental results into an integer score t∈[0,100]. Inspired by the widely used
performance ratio in Arcade Learning Environment (Mnih et al., 2015; Machado et al., 2018), we choose
to normalize FinRL methods performance based on their relative performance to market average strategy,
which is considered as the golden standard for many ﬁnancial practitioners. Speciﬁcally, we assign score
t= 50to market average and introduce a parameter k%, wherek%better or worse relative to the market
average is assigned 100 and 0, respectively. We further clip score values, which are larger than 100 to 100 and
lower than 0 to 0, to alleviate the impact of extreme values (e.g., extremely high return rate under markets
with sudden increase of some Crypto assets). For the value choice of k, we ﬁnd it is an empirically robust
2https://github.com/ml-research/CLEVA-Compass
3Market average indicates the trading strategy, which invests equal amount of money into all ﬁnancial assets in the pool, to
reﬂect the average market conditions.
4The edges and vertices of the inner hexagon become slightly blurry but still distinguishable after ﬁlling in the results of 8
FinRL algorithms.
3Published in Transactions on Machine Learning Research (02/2023)
option to set k= 20for our experiments on 8 FinRL methods across 4 ﬁnancial markets. Moreover, we
consult with our industry collaborators and they agree that it is reasonable to consider 20% better than the
market average as a very successful trading strategy (e.g., t= 100). Users can directly follow our settings
and compare the score (larger is better). Detailed descriptions of normalization equations are available in
Appendix A.3. We then decide the position of vertices based on the score and connect them to provide a
visual impression on the performance of each FinRL method. The advantages of this design are three-fold:
i) it provides an ideal visual representation when comparing plot elements (Fuchs et al., 2014), ii) it allows
human perceivers to quickly learn more facts by fast visual search (Elder & Zucker, 1993), and iii) the
geometric region boundaries in the star plot have high priority in perception (Elder & Zucker, 1998). We
introduce the 6 axis-level elements of PRUDEX-Compass as follows:
Proﬁtability. Aligned with the key objective of QT, proﬁtability focuses on the evaluation of FinRL
methods’ ability to gain market capital. Besides pure return, it also measures how stable (Franco & Leah,
1997) and persistent (Gârleanu & Pedersen, 2013) FinRL methods are to achieve high proﬁt.
Risk-Control. Due to the well-known tradeoﬀ between proﬁt and risk in ﬁnance (Brink & McCarl, 1978),
ﬁnancial practitioners take great eﬀorts on the assessment and control of both systematic risk and idiosyn-
cratic risk (Goyal & Santa, 2003), which is also of vital importance in FinRL evaluation.
Universality. The ﬁnancial market is a complex ecosystem that involves innumerable assets, countries,
time-scale and trading styles. Universality tries to evaluate FinRL’s ability to achieve satisﬁed performance
(e.g., better than market average) in various quantitative trading scenarios. Designing FinRL methods
with better universality (Fang et al., 2021) is in line with popular machine learning topics such as transfer
learning (Pan & Yang, 2009) and meta learning (Hospedales et al., 2021).
Diversity. In ﬁnance, diversiﬁcation refers to the process of allocating capitals in a way that reduces the
exposure to any one particular asset or risk. As Markowitz (Nobel Laureate in Economics) said (Tu & Zhou,
2011), diversity is the only free lunch in investing that plays an indispensable role on enhancing proﬁtability
and risk-control. In RL community, diversity is widely used to encourage exploration (Parker et al., 2020).
This axis of PRUDEX-Compass tends to address the lack of diversity evaluation of FinRL methods.
Reliability. RL methods tend to be highly variable in performance and considerably sensitive to a range
of diﬀerent factors such as random seeds (Henderson et al., 2018) and market stationarity shift across time
(Lee et al., 2010). This variability issue hinders a reliable method and can be costly or even dangerous
for high-stake applications such as quantitative trading. This axis introduces techniques on RL reliability
evaluation (Chan et al., 2019; Agarwal et al., 2021) with a focus on quantitative trading.
Explainability. Psychologically speaking, if the users do not trust a model, they will not use it (Ribeiro
et al., 2016). Explainability generally refers to any technique that helps users or developers of models
understand why models behave the way they do. In FinRL, it can come in the form that tells traders which
model is eﬀective under what market conditions or why one trading action is mistaken and how to ﬁx it.
Rigorous regulatory requirements in ﬁnancial markets further enhance its importance for model debugging
(Bhatt et al., 2020), monitoring (Pinto et al., 2019) and audit (Bhatt et al., 2020).
2.2 Measures of PRUDEX-Compass
As the inner star plot contextualizes macroscopic axes of FinRL evaluation, the outer measure-level places
emphasis on detailed evaluation setup and metrics. In essence, a mark on the measure-level indicates that a
method practically reports corresponding measures in its empirical investigation, where more marks indicate
a more comprehensive evaluation. We list the 17 measures on the outer level of the PRUDEX-Compass in
Table 1 with brief descriptions. In addition, we leave measures of FinRL explainability as future work due
to the lack of FinRL algorithms with solid design of explainability. We conduct literature review on RL
explainability and point their potential application in FinRL as follows. DSP (Landajuela et al., 2021) is
proposed to discover symbolic policy with expert knowledge. Diﬀerentiable decision trees are incorporated
into RL for better explainability (Silva et al., 2020). Another line of works tries to discover interpretable
features with techniques such as self-supervised learning (Shi et al., 2020) and adversarial learning (Gupta
et al., 2020). Open-XAI (Agarwal et al., 2022) oﬀers a comprehensive open-source framework for evaluating
4Published in Transactions on Machine Learning Research (02/2023)
and benchmarking post hoc explanation methods. We plan to incorporate suitable evaluation methods, i.e.,
LIME (Ribeiro et al., 2016) and SHAP (Lundberg & Lee, 2017), from Open-XAI into PRUDEX-Compass
with customized adoption on decision-based FinRL methods.
Table 1: Brief summary of evaluation measures in outer level of PRUDEX-Compass: Proﬁtability, Risk-
control, Universality, Diversity, rEliability, and eXplainability (see Appendix A.1 for details).
AxesMeasures Descriptions
PProﬁt A class of metrics to assess FinRL’s ability to gain market capital.
Alpha DecayLoss in the investment decision making ability of FinRL methods over time
due to distribution shift in ﬁnancial markets (Pénasse, 2022).
Equity Curve A graphical representation of the value changes over time.
RRisk A class of metrics to assess the risk level of FinRL methods (Shiller, 1992).
Risk-adjusted
ProﬁtA class of metrics that calculate the normalized proﬁt with regards to diﬀerent
kinds of risks, i.e., volatility and downside risk (Magdon & Atiya, 2004).
Extreme
MarketThe relative performance of FinRL methods on extreme market condition dur-
ing black swan events (Aven, 2013) such as war and covid-19.
UCountryFinancial market across both developed countries (e.g., US and Europe) and
developing countries (e.g., China and India).
Asset Type Various ﬁnancial asset types, i.e., stock, future, FX and Crypto
Time-ScaleBoth coarse-grained (e.g., day level) and ﬁne-grained (e.g., second level) ﬁnan-
cial data to match diﬀerent trading styles.
Dt-SNEA statistical visualization tool to map high-dimensional time-series data points
into 2-D dimension (Vander & Hinton, 2008) to assess the data-level diversity.
EntropyEntropy-based metrics from information theory (Reza, 1994) to show the di-
versity of FinRL methods’ trading behaviors.
CorrelationMetrics that account the correlation (Kirchner & Zunckel, 2011) between ﬁ-
nancial assets to assess the diversity of FinRL methods.
Diversity
HeatmapA visualization tool to demonstrate the diversity of investment decisions among
diﬀerent ﬁnancial assets with heatmap (Harris et al., 2020)
EPerformance
ProﬁleA visualization of FinRL methods’ empirical score distribution (Dolan & Moré,
2002), which is easy to read with qualitative comparisons.
VariabilityThe performance standard deviation across diﬀerent random seeds and hyper-
parameters (Henderson et al., 2018).
Rolling
WindowUsing rolling time window to retrain or ﬁne-tune FinRL methods and evaluate
the performance on multiple test periods (De Prado, 2018).
Rank
ComparisonA visualization toolkit to show the rank of FinRL methods across diﬀerent
metrics, which will not be dominated by extreme values (Agarwal et al., 2021).
X - We discuss current status and highlight promising further directions.
3 FinRL Preliminaries and Problem Formulation
3.1 Portfolio Management
Portfolio management is a fundamental quantitative trading task (Sun et al., 2023), where investors hold
a number of ﬁnancial assets, i.e., stocks, bonds, as well as cash, and reallocate the proportion of capitals
invested in each asset periodically to maximize future proﬁt.
5Published in Transactions on Machine Learning Research (02/2023)
OHLCV refers to the raw information of bar chart acquired from the ﬁnancial markets. OHLCV vector at
timetis denoted as xt= (po
t,ph
t,pl
t,pc
t,vt), wherepo
tis the open price, ph
tis the high price, pl
tis the low
price,pc
tis the close price and vtis the volume.
Technical Indicator indicates high-order features calculated by a formulaic combination of the original
OHLCV to uncover the underlying pattern of the ﬁnancial market. We denote the technical indicator vector
at timet:yt=/uniontext
kyk
t, whereyk
t=fk(xt−h,...,xt,θk),fkandθkare the formula function and the parameter
of technical indicator k, respectively.
Portfolio is the proportion of capitals allocated to each asset that can be represented as a vector:
wt= [w0
t,w1
t,...,wM
t]∈RM+1and/summationtextM
i=0wi
t= 1 (1)
whereM+ 1is the number of portfolio’s constituents, including cash and Mﬁnancial assets. wi
trepresents
the ratio of the total portfolio value invested at time ton assetiandw0
trepresents cash.
Asset Price refers to the vector of close price for each ﬁnancial asset deﬁned as pt= [p0
t,p1
t,...,pM
t], where
pi
tis the close price of asset iat timet. Note that the price of cash p0
tis a constant.
Portfolio Value vt+1at timet+ 1is deﬁned based on the asset price change and portfolio weight as:
vt+1=vt/summationtextM
i=0wi
tpi
t+1
pi
t(2)
The objective of portfolio management is to maximize the ﬁnal portfolio value given a long time horizon
by dynamically tuning the portfolio weight at each time step. As a uniﬁed benchmark, evaluation metrics
proposed in PRUDEX-Compass can be easily adopted to all quantitative trading tasks. We focus on portfolio
management in this work as a demonstrative example.
3.2 MDP Formulation
We consider a standard RL scenario in which an agent (investor) interacts with an environment (the ﬁ-
nancial market) in discrete time. Formally, we introduce MDP, which is deﬁned by the tuple: MDP
= (S,A,P,R,γ,H ). Speciﬁcally,Sis a ﬁnite set of states. Ais a ﬁnite set of actions. P:S×A×S−→ [0,1]
is a state transaction function, which consists of a set of conditional transition probabilities between states.
R:S×A−→R is the reward function, where Ris a continuous set of possible rewards and Rindicates the
immediate reward of taking an action in a state. γ∈[0,1)is the discount factor and His a time horizon
indicating the length of the trading period. A (stationary) policy πθ:S×A−→ [0,1], parameterized by θ,
assigns each state s∈Sa distribution over actions, where a∈Ahas probability π(a|s). A Q-value function
gives expected accumulated reward when executing action atin statestand following policy πin the future,
which isQ(st,at) =E(st+1,...,π)/bracketleftBig/summationtextT
i=tγir(si,ai)/bracketrightBig
. During training, one episode corresponds to adjusting the
portfolio at each time step through the whole trading periods, i.e., time scope of training set, with time hori-
zonH. The objective of the agent is to learn an optimal policy: πθ∗=argmaxπθEπθ/bracketleftBig/summationtextT
i=tγirt+i|st=s/bracketrightBig
.
Statest∈ Sat timetinvolves the concatenation of technical indicator vectors of Mﬁnancial assets
(y1
t,y2
t,...,yi
t)as the external markets state, where yi
trepresent the technical indicator vector of asset i
at timet. In addition, a 2-dimension tuple of investors’ position and remaining cash is added as internal
state.Action space at timetis anM+ 1dimension vector [w0
t,w1
t,...,wM
t]as a portfolio wtto represent
the proportion of capitals invested at each asset. Rewardrtat timetis the change of portfolio value:
rt=vt+1−vt, where positive/negative values indicate earning/losing money, respectively.
3.3 Soft Actor-Critic (SAC) and Other Popular FinRL Methods
We introduce SAC (Haarnoja et al., 2018), which is the base model of many popular FinRL methods (Yuan
etal.,2020). SACisanoﬀ-policyactor-criticmethodbasedonthemaximumentropyRLframework(Ziebart,
2010), which maximizes a weight objective of the reward and the policy entropy, to encourage robustness to
noise and exploration. For parameter updating, SAC alternates between a soft policy evaluation and a soft
6Published in Transactions on Machine Learning Research (02/2023)
policy improvement. At the soft policy evaluation step, a soft Q-function Qθ(st,at), which is modeled as a
neural network with parameters θ, is updated by minimizing the following soft Bellman residual:
LSAC
critic(φ) =Eτt∼D[LQ(τt,θ)], (3)
LQ(τt,θ) = (Qθ(st,at)−rt−γ¯V(st+1))2, (4)
where ¯V(st) =Eat∼πφ[Q¯θ(st,at)−αlogπφ(at|st)]. (5)
whereτt= (st,at,rt,st+1)is a transition,Dis a replay buﬀer, ¯θare the delayed parameters, and αis a
temperature parameter. For the soft policy improvement step, the policy πwith its parameter θis updated
through minimizing the following objective:
LSAC
actor(θ) =Est∼D[Lπ(st,φ)], (6)
Lπ(st,φ) =Eat∼πφ[αlogπφ(at|st)−Qθ(st,at)]. (7)
To handle continuous action spaces, the policy is modeled as a Gaussian with mean and covariance given
by neural networks. In addition to SAC, A2C (Mnih et al., 2016), a popular actor-critic RL method, shows
stellar performance in algorithmic trading (Zhang et al., 2020). The simple and eﬃcient policy gradient
method PPO (Schulman et al., 2017) performs well in capturing trading opportunities for order execution
(Lin & Beling, 2020). EIIE (Jiang et al., 2017) and Investor-Imitator (IMIT) (Ding et al., 2018) are two
pioneering works that apply deep RL for quantitative trading. Furthermore, SARL (Ye et al., 2020) and
Deeptrader (Wang et al., 2021b) are proposed with augmented market embedding to take market risk into
account for portfolio management.
4 AlphaMix+: A Strong Baseline
Up DownStock 1…Stock nUp DownStock 1…Stock n
!!!!Investment StrategyMarket StatusExpert 1
Expert KPortfolio ManagerRisk Control
Figure 2: Workﬂow of real-world trading ﬁrms.Before diving into our systematic evaluation bench-
mark PRUDEX-Compass5, AlphaMix+, an FinRL
algorithm based on ensemble learning, is proposed
to ﬁll the gap due to the poor performance of ex-
isting FinRL methods under systematic evaluation.
Considering the limitation of existing FinRL meth-
ods, the major one is that investment decisions are
made by a single agent with high potential risk.
The success of real-world trading ﬁrms relies on an
eﬃcient bottom-up hierarchical workﬂow with risk
management as illustrated in Figure 2). First, mul-
tiple experts conduct data analysis and build models independently based on personal trading style and
risk tolerance. Later on, a senior portfolio manager summarizes their results, manage risk and makes ﬁnal
investment decisions.
Inspired by it, we propose AlphaMix+, a universal deep RL framework with diversiﬁed risk-aware mixture-
of-experts following the idea of (Lee et al., 2021b), to mimic this eﬃcient workﬂow. In principle, AlphaMix+
can be combined with most modern oﬀ-policy RL algorithms for any quantitative trading task. As SAC
(Haarnoja et al., 2018) is a sample-eﬃciency algorithm in quantitative trading (Yuan et al., 2020), we pick
it as the base model of AlphaMix+ here for exposition. An overview of AlphaMix+ is shown in Figure 3.
Risk-aware Bellman backup. We consider a trading ﬁrm with Ntrading experts, i.e., {Qθi,πφi}N
i=1,
whereθiandφidenote the parameters of the i-th experting expert’s soft Q-function and policy. To apply
classic Q-learning based on the Bellman backup in Eq. (3) in FinRL, one major issue is the severe negative
5Readers whose main interest is the evaluation benchmark may skip this Section and take AlphaMix+ as a strong FinRL
baseline.
7Published in Transactions on Machine Learning Research (02/2023)
impact of error propagation that induces the market noise to the learning trading signals (true Q-value) of
the current Q-function (Kumar et al., 2020) , which can cause unstable convergence. In order to overcome
this issue, for trading expert i, we apply a risk-aware Bellman backup (Lee et al., 2021b) as follows:
LWQ(τt,θi) =w(st+1,at+1)(Qθi(st,at)−rt−γ¯V(st+1))2(8)
whereτt= (st,at,rt,st+1)is a transition, at+1∼πφi(a|st), andw(s,a)is a conﬁdence weight based on the
ensemble of target Q-functions:
w(s,a) =σ(−¯Qstd(s,a)∗T) +k (9)
where ¯Qstd(s,a)indicatestheempiricalstandarddeviationofalltradingexperts’targetQ-functions {Q¯θi}N
i=1
andT >0is a temperature parameter (Hinton et al., 2015) to adapt the scale of ¯Qstd(s,a).σis the sigmoid
function and k>0is used to control the value range of conﬁdence weight. The conﬁdence weight is bounded
in[k,k+ 0.5]as¯Qstd(s,a)is always a positive number. Intuitively, the objective LWQdown weights the
sample transitions with inconsistent trading suggestions from diﬀerent experts (high variance across target
Q-functions), resulting in a loss function for the Q-updates with better risk management.
Market HistoryBootstrapActor 1Critic 1ActorKCritic KRisk-aware Bellman backup
Expert 1Expert KInvestment Action
Figure 3: An illustration of AlphaMix+, a universal deep RL
framework with diversiﬁed risk-aware mixture-of-experts.Diversiﬁed Experts. We encourage
the diversity between trading experts
with two simple yet eﬃcient tricks. First,
we initialize the model parameters of
all trading experts with random parame-
ter values for inducing an initial diver-
sity in the models following (Lakshmi-
narayanan et al., 2017; Wenzel et al.,
2020). Second, we apply diﬀerent sam-
ples to train each agent based on simi-
lar idea in BatchEnsemble (Wen et al.,
2019). For each trading expert iat each time step t, we construct the binary masks mt,iby sampling from
the Bernoulli distribution with parameter β∈(0,1]. Later on, we multiply the bootstrap mask to each
objective function (e.g., mt,iLπ(st,φi)andmt,iLWQ(τt,θi)in Eq.(7) and Eq.(8)) while updating parameters
of trading experts. This encourages each expert to think individually with diversiﬁed strategies. We ﬁnd it
suﬃcient for AlphaMix+ to have desired diversity (experiments in Section 6.6) with the two simple tricks.
Other tricks such as a KL divergence (Yu et al., 2013) loss term is not further incorporated to keep simplicity.
We remark that although similar diversity encouragement techniques have been shown eﬀective in classic
RL tasks (Osband et al., 2016; Lee et al., 2021b), this work is the ﬁrst to explore their potential in ﬁnancial
markets. We conduct ablation studies on the eﬀectiveness of each component in AlphaMix+ and parameter
analysis to probe sensitivity. We put related experimental results in Appendix C.2 and C.3, respectively.
5 Experimental Setup
5.1 Datasets
End TestTestTestValidValidValidPhase 1: TrainingPhase 2: TrainingPhase 3: Training1 year 1 year 1 year 1 year Start Time Phase 
Figure 4: Train/valid/test split procedure with rolling windows.We collect real-world ﬁnancial datasets
spanningover15yearsofUSstock,China
stock, Cryptocurrency (Crypto) and For-
eign Exchange (FX) from Yahoo Finance
and Kaggle. All raw data and related
processing scripts are publicly available.
We summarize statistics of the 4 datasets
withfurtherelaborationinTable2. USStockdatasetcontains10-yearhistoricalpricesof29inﬂuentialstocks
with top unit price as a strong assessment of the market’s overall health and tendencies. China Stock dataset
contains 4-year historical prices of 47 inﬂuential stocks with top capitalization from the Shanghai exchange.
Both US and China stock data is collected from Yahoo-Finance6. Crypto7dataset contains 6-year historical
6https://github.com/yahoo-finance
7https://www.kaggle.com/datasets/sudalairajkumar/cryptocurrencypricehistory
8Published in Transactions on Machine Learning Research (02/2023)
prices of 9 inﬂuential virtual currency with top unit price and trading volume collected. FX8dataset contains
20-year historical prices of 22 most popular currency with top foreign exchange reserves for US dollars. For
each dataset, we ﬁlter out ﬁnancial assets with missing values. For data split, we apply the similar split
procedure in (Sawhney et al., 2020) with rolling window for all four datasets. As shown in Figure 4, phase
3 uses the last year for test, penultimate year for validation and the remaining of the dataset for training.
For phase one and two, their validation/test sets roll back one and two years, respectively.
Table 2: Dataset statistics
Dataset Market Freq Number Days From To Source
US Stock US 1d 29 2517 12/01/03 21/12/31 Yahoo
China Stock China 1h 47 1036 16/06/01 20/09/01 Yahoo
Crypto - 1d 9 2014 16/01/01 21/07/06 Kaggle
FX - 1d 22 5015 00/01/03 19/12/31 Kaggle
5.2 Features
Table 3: Features to describe the ﬁnancial markets
Features Calculation Formula
zopen,zhigh,zlowzopen=opent/closet−1
zclose zclose =closet/closet−1−1
zd_5,zd_10,zd_15
zd_20,zd_25,zd_30zd_5=/summationtext4
i=0closet−i/5
closet−1We generate 11 temporal features as shown in Table
3 to describe the stock markets following (Yoo et al.,
2021).zopen,zhighandzlowrepresent the relative
values of the open, high, low prices relative to the
close price at current time step, respectively. zclose
andzadj_closerepresent the relative values of the
closing and adjusted closing prices compared with
time stept−1.zdkrepresents a long-term moving
average of the adjusted close prices during the last ktime steps relative to the current close price. We apply
z-score normalization on each feature.
5.3 Baselines
We conduct experiments with 7 representative FinRL methods including 3 classic RL methods: A2C (Mnih
et al., 2016), PPO (Schulman et al., 2017), SAC (Haarnoja et al., 2018), 4 RL-based trading methods: EIIE
(Jiang et al., 2017), Investor-Imitator (IMIT) (Ding et al., 2018), SARL (Ye et al., 2020) and DeepTrader
(DT) (Wang et al., 2021b) and our AlphaMix+. Descriptions of baselines are as follows:
•A2C (Mnih et al., 2016) is a classic actor-critic RL algorithms that introduce an advantage function
to enhance policy gradient update by reducing variance.
•PPO (Schulman et al., 2017) is a proximal policy optimization that constrain the diﬀerence between
current policy and updated policy with simpliﬁed clipping term in the objective function.
•SAC (Haarnoja et al., 2018) is an oﬀ-policy actor-critic method based on the maximum entropy RL
framework, whichencouragestherobustnesstonoiseandexplorationbymaximizingaweightobjective
of the reward and the policy entropy.
•SARL(Yeetal.,2020)proposesastate-augmentedRLframework, whichleveragesthepricemovement
prediction as additional states, based on deterministic policy gradient (Silver et al., 2014) methods.
•DeepTrader (DT) (Wang et al., 2021b) is a policy gradient based method. To tackle the risk-return
balancing issue, it simultaneously uses negative maximum drawdown and price rising rate as reward
functions to balance between proﬁt and risk with an asset scoring unit.
•EIIE (Jiang et al., 2017) is a deterministic policy gradient based RL framework, which contains: 1)
an ensemble of identical independent evaluators topology; 2) a portfolio vector memory; 3) an online
stochastic batch learning scheme.
8https://www.kaggle.com/datasets/brunotly/foreign-exchange-rates-per-dollar-20002019
9Published in Transactions on Machine Learning Research (02/2023)
•Investor-Imitator (IMIT) (Ding et al., 2018) imitates behaviors of diﬀerent investors (e.g., ora-
cle/collaborate/public investor) using investor-speciﬁc reward functions with a set of logic descriptors.
Non-RL methods are not included as baselines for two reasons: i) In general, RL methods outperform
diﬀerent types of non-RL methods (Moskowitz et al., 2012; Ke et al., 2017; Xu & Cohen, 2018) in diﬀerent
trading tasks. ii) PRUDEX-Compass focuses on the evaluation of RL methods in ﬁnancial markets. We
leave comparison with non-RL methods as future directions and discuss our plan in Section 7.
5.4 Training Setup
We perform all experiments on an RTX 3090 GPU with 5 ﬁxed random seeds. We apply grid search for Al-
phaMix+ on Crypto and FX datasets and apply the same hyperparameters on China and US stock datasets.
We try scale parameter kin list [0.3,0.5,0.7,0.9], binomial sample parameter βin list [0.3,0.4,0.5,0.6,0.7]
and temperature Tin list [18,19,20,21,22].We explore batch size in list [256,512,1024]and hidden size in
range [64,128], We apply learning rate 7e−4for both actor and critic. Adam is used as the optimizer. One
full list of hyperparameters is available in Appendix B.1. We train AlphaMix+ for 10 epochs on all datasets.
It takes about 60 minutes to train and test on China stock, US stock, FX and Crypto datasets, respectively.
For other FinRL methods, there are two conditions: i) if there are authors’ oﬃcial or open-source FinRL
library (Liu et al., 2020a) implementations, we apply the same hyperparameters9for a fair comparison.
This condition applies for A2C, PPO, SAC, SARL and DeepTrader. ii) if there are no publicly available
implementations, we reimplement the algorithms and try our best to maintain consistency based on the
original papers. This applies for EIIE and IMIT.
5.5 RL Environment Implementation
In this work, we apply the popular portfolio management environment (Liu et al., 2020a) implemented based
on OpenAI Gym (Brockman et al., 2016), which simulates live ﬁnancial markets with realistic historical
market data according to the principle of time-driven simulations. During training, we feed observations of
technical indicators as input of RL agents. RL agents generate a portfolio (action) and the environment
returns the net value change at each time step as reward. By interacting with the environment, the trading
agents will try to derive a trading strategy with high proﬁts. In addition, the environment assumes the
trading volume of agents is not very large and has little impact on the market. Then, it is reasonable to
use the price ﬂuctuation of oﬄine historical ﬁnancial data to build a model for reward calculation during
online simulation. We provide a concrete example here to further clarify how FinRL environment is built.
Considering a simple trading scenario with only one stock, we obtain pc
tandpc
t+1, which denote the close
price of the stock at time tandt+ 1, from historical data. The action at time tis to buykshares of the
stock. Then, the reward rtat timetis the account proﬁt deﬁned as k∗(pc
t+1−pc
t). For state, we use
historical market data to calculate technical indicators in Table 3 as external state and investors’ private
information such as remaining cash and current position is applied as internal state. Similar procedures to
build RL environment with historical market data have been applied in many FinRL work (Liu et al., 2020a;
Wang et al., 2021b; Ye et al., 2020). Readers may check our open source code1for more details of the RL
environment.
6 Demonstrative Usages of PRUDEX-Compass and Related Evaluation Toolkits
In this section, we conduct experiments on portfolio management with real-world datasets of 4 inﬂuential
ﬁnancial markets to demonstrate the usage of PRUDEX-Compass and related evaluation toolkits. In Section
6.1, we show how diﬀerent investors can get a general impression on FinRL algorithms’ performance with
PRUDEX-Compass. Moreover, we provide example usage of other evaluation toolkits with a focus on one
particular perspective including: (1) t-SNE plot to show data-level diversity, (2) PRIDE-Star to report
the performance of 8 point-wise ﬁnancial metrics for evaluating proﬁtability, risk-control and diversity, (3)
performance proﬁle and rank distribution plot as unbiased and robust measures towards reliable FinRL
9Both authors’ oﬃcial or open-source FinRL library (Liu et al., 2020a) implementations are tuned in FinRL domains.
10Published in Transactions on Machine Learning Research (02/2023)
methods, (4)portfoliodiversityheatmaptoevaluatethedecision-leveldiversity, (5)extrememarketscenarios
with black swan events to evaluate the risk-control and generalization ability of FinRL algorithms. In
particular, investors can either use these evaluation toolkits together with PRUDEX-Compass to pursue a
systematic evaluation or as an independent measure with a focus on the perspective they care about.
6.1 A General Impression with PRUDEX-Compass
As shown in Figure 1, we ﬁll the PRUDEX-Compass based on the experimental results of the 8 FinRL
methods. For axis-level, it directly illustrates the relative performance of each method in terms of 6 axes to
provide a general impression. We normalized the score into 0 to 100 with 50 as the market average (details in
Appendix A.2). For explainability, all methods are scored 50 as we leave it as future direction. AlphaMix+
performs best in all 5 remaining axes. Speciﬁcally, it outperforms other FinRL methods 53% and 43% in
universality and diversity, respectively, which demonstrates the eﬀectiveness of the weighted Bellman backup
and diversiﬁed bootstrap initialization.
For measure-level, we give a mark if one measure is used in the evaluation of the FinRL methods, the goal
here is to show how comprehensive the methods are evaluated. Together with all measures we proposed,
AlphaMix+ clearly has a more rigorous evaluation, which makes the results more trustworthy. Arguably,
PRUDEX-Compass provides a compact visualization to evaluate FinRL methods that is much better than
only looking at a result table of diﬀerent metrics especially when lots of FinRL methods are involved. In
other words, the compass highlights the required subtleties, that may otherwise be challenging to extract
from text descriptions, potentially be under-speciﬁed and prevent readers to misinterpret results based on
result table display. With PRUDEX-Compass, users can ﬂexibly pick suitable methods with regards to their
personal interests. Conservative traders may prefer methods with a relative stable proﬁt rate and low risk.
Aggressive traders may pay more attention on proﬁtability, as they are willing to take high risk to pursue
extremely high proﬁt. For international trading ﬁrms, they may have high expectation on universality and
diversity.
6.2 Visualizing Financial Markets with t-SNE
Even though it is a wide consensus that diﬀerent ﬁnancial markets share diﬀerent trading patterns (Camp-
bell et al., 1998), there is a lack of visualization tool to demonstrate how diﬀerent are these mar-
kets. To show data-level diversity of evaluation, we use t-SNE here to map all 4 datasets into a
China US FX Crypto
Figure 5: t-SNE market visualization.2-D dimension plot with the 11 features described in Table 3
as the input. To avoid overlapping in ﬁnancial data, we pick a
data point every 30 time step for each asset across 4 ﬁnancial
markets. Each data point corresponds to the value vector of 11
features at each time step, where necessary temporal informa-
tionismaintained10. InFigure5, theUSstockandFXdatasets
lie in the lower left and upper right corner, respectively, as a
whole cluster, which is consistent with their status as relative
mature and stable markets (Emenyonu & Gray, 1996). For
China stock and the Crypto, data points are scattered with
more outliers that demonstrate their essence as emerging and
violate markets (De Santis et al., 1997). The t-SNE plot is use-
ful to provide an intuitive expression on the data-level diversity of diﬀerent markets while evaluating FinRL
methods.
6.3 PRIDE-Star for Evaluating Proﬁtability, Risk-Control and Diversity
As the evaluation measures for Proﬁtability, RIsk and DivErsity (PRIDE) are point-wise metrics with real
number values, we use the PRIDE-star, which is a star plot to show the relative strength of 8 metrics
10It is common to incorporate temporal information into features in Fintech. For instance, zd_5uses the close price at time
stept−4tot.
11Published in Transactions on Machine Learning Research (02/2023)
including 1 proﬁt metrics: total return (TR), 2 risk metrics: volatility (Vol) (Shiller, 1992) and maximum
drawdown (MDD) (Magdon & Atiya, 2004), 3 risk-adjusted proﬁt metrics: Sharpe ratio (SR) (Sharpe, 1998),
Calmar ratio (CR) and Sortino ratio (SoR), and 2 diversity metrics: entropy (ENT) (Jost, 2006) and eﬀect
number of bets (ENB) (Kirchner & Zunckel, 2011). The mathematical deﬁnitions of these metrics are in
Appendix A.1. We report the overall performance across the 4 ﬁnancial markets of the 6 FinRL methods
in Figure 6, where the inner circle represents market average. In general, AlphaMix+ performs best in the
PRIDE-Star plot. In addition, AlphaMix+ outperforms the second best by 25% in terms of ENT that shows
the eﬀectiveness of the boostrap with random initialization component in AlphaMix+.
TRSRCRSoRVolMDDENTENBTRSRCRSoRVolMDDENTENB
TRSRCRSoRVolMDDENTENBTRSRCRSoRVolMDDENTENBTRSRCRSoRVolMDDENTENBTRSRCRSoRVolMDDENTENB
TRSRCRSoRVolMDDENTENBTRSRCRSoRVolMDDENTENBA2CPPOSACSARL
DeepTraderEIIEAlphaMix+IMIT
Figure6: Overallperformanceacross4ﬁnancialmarketsonPRIDE-Startoevaluateproﬁtability, risk-control
and diversity, where AlphaMix+ achieves the best performance in 7 out of 8 metrics.
0 20 40 60 80 100
total return score ()
0.000.250.500.751.00Fraction of runs with score >
A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+
(a)
12345678020406080100TR
12345678020406080100SR
12345678020406080100VOL
12345678020406080100EntropyFraction (in %)A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+ (b)
Figure 7: (a) Performance proﬁle of total return score distributions across 4 ﬁnancial markets. Shaded
regions show pointwise 95% conﬁdence bands based on percentile bootstrap with stratiﬁed sampling. (b)
Rank distribution in terms of TR, SR, Vol and ENT across 4 ﬁnancial markets.
12Published in Transactions on Machine Learning Research (02/2023)
6.4 Performance Proﬁle: An Unbiased Approach to Report Performance
The performance proﬁle reports the score distribution of all runs across the 4 ﬁnancial markets that are
statistically unbiased, more robust to outliers and require fewer runs for lower uncertainty compared to
conventional point estimates such as mean. Performance proﬁles proposed herein visualize the empirical tail
distribution function of a random score (higher curve is better), with point-wise conﬁdence bands based on
stratiﬁed bootstrap (Efron, 1979). A score distribution shows the fraction of runs above a certain normalized
score that is an unbiased estimator of the underlying performance distribution. As shown in Figure 7a,
AlphaMix+ is generally a robust but conservative FinRL methods that shows the least bad runs, which
makes it an attractive option for conservative investors that care more about risk. However, radical investors
may pick SAC as it has the largest probability of achieving score 100, which indicates a return rate higher
than twice the market average.
6.5 Rank Distribution to Demonstrate the Rank of FinRL methods
In Figure 7b, we plot the rank distribution of 8 FinRL methods in terms of TR, SR, VOL and Entropy across
4 ﬁnancial markets with results of 5 random seeds in each market. The i-th column in the rank distribution
plot shows the probability that a given method is assigned rank iin the corresponding metrics. For x-axis,
rank 1 and 8 indicate the best and worst performance.11For y-axis, the bar length of a given method on a
given metric with rank icorresponds to the % fraction of rank iit achieves across the 4 ﬁnancial markets,
3 test periods and 5 random seeds (4 ×3×5 = 60 in total), i.e., if the rank 1 column of TR is purely red,
it indicates AlphaMix+ achieves the highest TR in all random seeds across 4 ﬁnancial markets.
For TR and SR, AlphaMix+ slightly outperforms other methods with 27% and 35% probability to achieve
top 2 performance. For Vol, SAC gets the overall best performance while AlphaMix+ goes through higher
volatility. For ENT, AlphaMix+ signiﬁcantly outperforms other FinRL methods with over 56% probability
for rank 1, which demonstrates its ability to train mixture of diversiﬁed trading experts.
6.6 Visualizing Strategy Diversity with Heatmap
To demonstrate the overall investment diversity of FinRL methods, we show the average portfolio across the
test period as a heatmap in Figure 8. Formally, we deﬁne the average portfolio as ¯w:
¯ w= [/summationtextt+h
j=tw0
i
h+ 1,/summationtextt+h
j=tw1
i
h+ 1,...,/summationtextt+h
j=twM
i
h+ 1] (10)
whereM+ 1is the number of portfolio’s constituents, including cash and Mﬁnancial assets. wi
trepresents
the ratio of the total portfolio value invested at time ton asseti,hrepresents the length of the evaluation
period and w0
trepresents cash.
A2C
PPO
SAC
SARL
DT
EIIE
IMIT
OursRelative weight of different stocks in a portfolio
0.00.10.2
Figure 8: Heatmap of average portfolio on China stock market.For IMIT, it puts all capital
in one or two assets. The
portfolio of SARL and EIIE is
not that diversiﬁed with near
0 weight on many assets more
(red). For A2C, DT, PPO and
SAC, the portfolio is closed to
uniform, which is not desir-
able due to poor proﬁtability.
Our AlphaMix+ achieves an
ideal investment portfolio, which is generally diversiﬁed and allocate more weights on a few bullish stocks.
11For TR, SR and entropy, higher values indicate better performance. For VOL, lower values indicate better performance
13Published in Transactions on Machine Learning Research (02/2023)
6.7 The Impact of Extreme Market Conditions
To further evaluate the risk-control and reliability, we pick three extreme market periods with black swan
events. For China stock market, the period is from February 1st to March 31st 2021 when strict segregation
policy is implemented in China to ﬁght against the COVID-19 pandemic (Lee et al., 2021a). For US stock
market, the period is from March 1st to April 30th 2020, when the global ﬁnancial markets are violate due
the global pandemic of COVID-19 (Mazur et al., 2021). For Crypto, the period is from April 1st to May
31st 2021 when many countries posed regulation against Crypto oligarch. To report the results of diﬀerent
metrics with diﬀerent numerical value scale, we normalize them into a score mscoreas follows:
mscore = (mave/|mave|)(mrl/mave−1)∗k+ 1 (11)
We deﬁne the metrics value for FinRL methods and market average as mrlandmave, respectively. kis a
scale parameter.
In Figure 9, we plot the bar chart of TR and SR during the period of extreme market conditions. As
a conservative method, AlphaMix+’s performance is unsatisfactory in extreme market conditions, which
proves the general consensus that radical methods such as DeepTrader (DT) and SARL are more suitable
for extreme markets (Marimoutou et al., 2009). Analyzing the performance on extreme market conditions
can shed light on the design of FinRL methods, which is in line with economists’ eﬀorts on understanding
the ﬁnancial markets. For instance, incorporating volatility-aware auxiliary task (Sun et al., 2022) and
multi-objective RL (Hayes et al., 2022) in AlphaMix+ may further make it be aware of extreme market
conditions in advance and behave as a proﬁt-seeking agents to achieve better performance during extreme
market conditions.
A2C PPO SAC SARL DT EIIE IMIT Ours7.5
5.0
2.5
0.02.55.07.510.0Scoreaverage TR SR
(a) US
A2C PPO SAC SARL DT EIIE IMIT Ours10
5
051015Scoreaverage TR SR (b) China
A2C PPO SAC SARL DT EIIE IMIT Ours10.0
7.5
5.0
2.5
0.02.55.07.5Scoreaverage TR SR (c) Crypto
Figure 9: Performance of FinRL methods during extreme market conditions.
7 Discussion
Complementary Related Eﬀorts. Apart from the above aspects described in PRUDEX-Compass, there
also exist several orthogonal perspectives for FinRL evaluation, which encompass a check-list (Pineau et al.,
2021) for quantitative experiments, the construction of elaborate dataset sheets (Gebru et al., 2021), and
the creation of model cards (Mitchell et al., 2019). We stress that these perspectives remain indispensable,
as novel datasets and their variants are regularly suggested in FinRL and the PRUDEX-Compass does not
disclose intended use with respect to human-centered application domains, ethical considerations, or their
caveats. We believe that it is best to report both the prior works and PRUDEX-Compass together to further
improve the evaluation quality.
Potential Impact. For FinRL community, PRUDEX-Compass can serve as i) a systematic evaluation
toolkit; ii) a benchmark for comprehensive comparison of FinRL methods and iii) a standard code base
for future design and development of novel FinRL algorithms. We hope that PRUDEX-Compass could
encourage both researchers and ﬁnancial practitioners to avoid fooling themselves by evaluating FinRL
methods in a systematic way and facilitate the design of stronger FinRL methods. While accounting for all
elements in PRUDEX-Compass is not a panacea, it provides a strong foundation for trustworthy results on
which the community can build on and further increase the conﬁdence for real-world industry deployment.
For RL community, PRUDEX-Compass introduces a new challenging scenario with diﬀerent evaluation
axes for the test of novel RL algorithms in ﬁnancial market. For FinTech community, this work enables
14Published in Transactions on Machine Learning Research (02/2023)
industry practitioners with limited RL background to easily explore the potential of RL in diﬀerent FinTech
scenarios. In addition, the usage of PRUDEX-Compass is not limited in RL settings, most elements of
PRUDEX-Compass can be easily generalized to supervised learning settings with broader impact.
Future Plans. We plan to improve PRUDEX-Compass from the following perspectives: i) For axis-level,
we plan to explore the evaluation of FinRL explainability with measures and plots; ii) For measure-level,
we plan to include metrics to evaluate alpha decay and more metrics, e.g., optimality gaps, for proﬁts
and risks; iii) To further improve the accuracy and reliability of PRUDEX-Compass, we plan to customize
existing scientiﬁc and non-exploitative RL evaluation procedures (Jordan et al., 2020) into FinRL domains
for the normalization and summarization of experimental results. iv) For a comprehensive evaluation under
diﬀerent market stationarity assumptions, we plan to add one toolkit to automatically categorize market
into diﬀerent styles (e.g., bull/bear) and evaluate the performance of FinRL methods under diﬀerent styles.
Furthermore, there can be a data-driven simulator to generate unseen stylized data for further evaluation; v)
For visualization, we plan to further develop a GUI software version accompanied with a website to further
lower the barrier for dissemination and use; vi) As most axes and measures in PRUDEX-Compass are also
key points for non-RL trading scenarios, we plan to bring PRUDEX-Compass into more general machine
learning settings with implementations and results of non-RL methods for broader impact.
Auxiliary Experiments. Due to space limitations, we have included some auxiliary yet important exper-
iments in Appendix C. Speciﬁcally, the result tables with mean and standard deviation of the 8 metrics in
PRIDE-Star are reported in Appendix C.1. We plot the PRIDE-Star, performance proﬁle and rank compar-
ison of each ﬁnancial market individually in Appendix C.4, C.5, C.6, respectively.Furthermore, we include
ablation studies on the eﬀectiveness of each component in AlphaMix+ in Appendix C.2 and hyperparameter
sensitivity experiments in Appendix C.3.
8 Acknowledgments
ThisprojectissupportedbytheNationalResearchFoundation,SingaporeunderitsIndustryAlignmentFund
– Pre-positioning (IAF-PP) Funding Initiative. Any opinions, ﬁndings and conclusions or recommendations
expressed in this material are those of the author(s) and do not reﬂect the views of National Research
Foundation, Singapore.
15Published in Transactions on Machine Learning Research (02/2023)
References
Chirag Agarwal, Eshika Saxena, Satyapriya Krishna, Martin Pawelczyk, Nari Johnson, Isha Puri, Marinka
Zitnik, and Himabindu Lakkaraju. Openxai: Towards a transparent evaluation of model explanations.
arXiv preprint arXiv:2206.11104 , 2022.
Rishabh Agarwal, Max Schwarzer, Pablo Samuel Castro, Aaron C Courville, and Marc Bellemare. Deep
reinforcementlearningattheedgeofthestatisticalprecipice. In Advances in Neural Information Processing
Systems, pp. 29304–29320, 2021.
Bo An, Shuo Sun, and Rundong Wang. Deep reinforcement learning for quantitative trading: Challenges
and opportunities. IEEE Intelligent Systems , 37(2):23–26, 2022.
Terje Aven. On the meaning of a black swan in a risk context. Safety Science , 57, 2013.
Umang Bhatt, Alice Xiang, Shubham Sharma, Adrian Weller, Ankur Taly, Yunhan Jia, Joydeep Ghosh,
Ruchir Puri, José MF Moura, and Peter Eckersley. Explainable machine learning in deployment. In ACM
Conference on Fairness, Accountability, and Transparency , pp. 648–657, 2020.
Lars Brink and Bruce McCarl. The tradeoﬀ between expected return and risk among cornbelt farmers.
American Journal of Agricultural Economics , 60(2), 1978.
Greg Brockman, Vicki Cheung, Ludwig Pettersson, Jonas Schneider, John Schulman, Jie Tang, and Wojciech
Zaremba. Openai gym. arXiv preprint arXiv:1606.01540 , 2016.
John Y Campbell, Andrew W Lo, A Craig MacKinlay, and Robert F Whitelaw. The econometrics of ﬁnancial
markets. Macroeconomic Dynamics , 2(4), 1998.
Ernest P Chan. Quantitative trading: how to build your own algorithmic trading business . Wiley, 2021.
Stephanie CY Chan, Samuel Fishman, Anoop Korattikara, John Canny, and Sergio Guadarrama. Measuring
the reliability of reinforcement learning algorithms. In International Conference on Learning Representa-
tions, 2019.
Marcos Lopez De Prado. Advances in ﬁnancial machine learning . John Wiley & Sons, 2018.
Giorgio De Santis et al. Stock returns and volatility in emerging ﬁnancial markets. Journal of International
Money and Finance , 16(4), 1997.
Jonas Degrave, Federico Felici, Jonas Buchli, Michael Neunert, Brendan Tracey, Francesco Carpanese, Timo
Ewalds, Roland Hafner, Abbas Abdolmaleki, Diego de Las Casas, et al. Magnetic control of tokamak
plasmas through deep reinforcement learning. Nature, 602(7897):414–419, 2022.
Yue Deng, Feng Bao, Youyong Kong, Zhiquan Ren, and Qionghai Dai. Deep direct reinforcement learning for
ﬁnancial signal representation and trading. IEEE Transactions on Neural Networks and Learning Systems ,
28(3), 2016.
Yi Ding, Weiqing Liu, Jiang Bian, Daoqiang Zhang, and Tie-Yan Liu. Investor-imitator: A framework for
trading knowledge extraction. In ACM SIGKDD International Conference on Knowledge Discovery &
Data Mining , 2018.
Elizabeth D Dolan and Jorge J Moré. Benchmarking optimization software with performance proﬁles.
Mathematical Programming , 91(2):201–213, 2002.
B Efron. Bootstrap methods: Another look at the jackknife. The Annals of Statistics , 7(1), 1979.
James Elder and Steven Zucker. The eﬀect of contour closure on the rapid discrimination of two-dimensional
shapes.Vision Research , 33(7):981–991, 1993.
James H Elder and Steven W Zucker. Evidence for boundary-speciﬁc grouping. Vision Research , 38(1):
143–152, 1998.
16Published in Transactions on Machine Learning Research (02/2023)
EmmanuelNEmenyonuandSidneyJGray. Internationalaccountingharmonizationandthemajordeveloped
stock market countries: an empirical study. The International Journal of Accounting , 31(3), 1996.
Yuchen Fang, Kan Ren, Weiqing Liu, Dong Zhou, Weinan Zhang, Jiang Bian, Yong Yu, and Tie-Yan Liu.
Universal trading for order execution with oracle policy distillation. In AAAI Conference on Artiﬁcial
Intelligence , pp. 107–115, 2021.
Alhussein Fawzi, Matej Balog, Aja Huang, Thomas Hubert, Bernardino Romera-Paredes, Mohammadamin
Barekatain, Alexander Novikov, Francisco J R Ruiz, Julian Schrittwieser, Grzegorz Swirszcz, et al. Dis-
covering faster matrix multiplication algorithms with reinforcement learning. Nature, 610(7930):47–53,
2022.
Franco and Leah. Risk-adjusted performance. Journal of Portfolio Management , 23(2):45–54, 1997.
Johannes Fuchs, Petra Isenberg, Anastasia Bezerianos, Fabian Fischer, and Enrico Bertini. The inﬂuence
of contour on similarity perception of star glyphs. IEEE Transactions on Visualization and Computer
Graphics , 20(12):2251–2260, 2014.
Nicolae Gârleanu and Lasse Heje Pedersen. Dynamic trading with predictable returns and transaction costs.
The Journal of Finance , 68(6):2309–2340, 2013.
Timnit Gebru, Jamie Morgenstern, Briana Vecchione, Jennifer Wortman Vaughan, Hanna Wallach,
Hal Daumé Iii, and Kate Crawford. Datasheets for datasets. Communications of the ACM , 64(12):
86–92, 2021.
Amit Goyal and Pedro Santa, Clara. Idiosyncratic risk matters! The Journal of Finance , 58(3), 2003.
Piyush Gupta, Nikaash Puri, Sukriti Verma, Dhruv Kayastha, Shripad Deshmukh, Balaji Krishnamurthy,
and Sameer Singh. Explain your move: understanding agent actions using speciﬁc and relevant feature
attribution. In International Conference on Learning Representations , 2020.
Tuomas Haarnoja, Aurick Zhou, Pieter Abbeel, and Sergey Levine. Soft actor-critic: Oﬀ-policy maximum
entropy deep reinforcement learning with a stochastic actor. In International Conference on Machine
Learning , pp. 1861–1870, 2018.
Charles R Harris, K Jarrod Millman, Stéfan J Van Der Walt, Ralf Gommers, Pauli Virtanen, David Cour-
napeau, Eric Wieser, Julian Taylor, Sebastian Berg, Nathaniel J Smith, et al. Array programming with
numpy.Nature, 585(7825), 2020.
Conor F Hayes, Roxana Rădulescu, Eugenio Bargiacchi, Johan Källström, Matthew Macfarlane, Mathieu
Reymond, TimothyVerstraeten, LuisaMZintgraf, RichardDazeley, FredrikHeintz, etal. Apracticalguide
to multi-objective reinforcement learning and planning. Autonomous Agents and Multi-Agent Systems , 36
(1), 2022.
Peter Henderson, Riashat Islam, Philip Bachman, Joelle Pineau, Doina Precup, and David Meger. Deep
reinforcement learning that matters. In AAAI conference on artiﬁcial intelligence , 2018.
Geoﬀrey Hinton, Oriol Vinyals, Jeﬀ Dean, et al. Distilling the knowledge in a neural network. arXiv preprint
arXiv:1503.02531 , 2015.
Timothy Hospedales, Antreas Antoniou, Paul Micaelli, and Amos Storkey. Meta-learning in neural networks:
A survey. IEEE Transactions on Pattern Analysis and Machine Intelligence , 44(9):5149–5169, 2021.
Zhengyao Jiang, Dixing Xu, and Jinjun Liang. A deep reinforcement learning framework for the ﬁnancial
portfolio management problem. arXiv preprint arXiv:1706.10059 , 2017.
Scott Jordan, Yash Chandak, Daniel Cohen, Mengxue Zhang, and Philip Thomas. Evaluating the per-
formance of reinforcement learning algorithms. In International Conference on Machine Learning , pp.
4962–4973, 2020.
17Published in Transactions on Machine Learning Research (02/2023)
Lou Jost. Entropy and diversity. Oikos, 113(2), 2006.
Jonathan M Karpoﬀ. The relation between price changes and trading volume: A survey. Journal of Financial
and Quantitative Analysis , 22(1):109–126, 1987.
Guolin Ke, Qi Meng, Thomas Finley, Taifeng Wang, Wei Chen, Weidong Ma, Qiwei Ye, and Tie-Yan Liu.
Lightgbm: Ahighlyeﬃcientgradientboostingdecisiontree. In Advances in Neural Information Processing
Systems, 2017.
Ajay Khorana, Henri Servaes, and Lei Wedge. Portfolio manager ownership and fund performance. Journal
of ﬁnancial economics , 85(1):179–204, 2007.
Ulrich Kirchner and Caroline Zunckel. Measuring portfolio diversiﬁcation. arXiv preprint arXiv:1102.4722 ,
2011.
Aviral Kumar, Abhishek Gupta, and Sergey Levine. Discor: Corrective feedback in reinforcement learning
via distribution correction. Advances in Neural Information Processing Systems , pp. 18560–18572, 2020.
Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell. Simple and scalable predictive uncer-
tainty estimation using deep ensembles. Advances in Neural Information Processing Systems , 2017.
Mikel Landajuela, Brenden K Petersen, Sookyung Kim, Claudio P Santiago, Ruben Glatt, Nathan Mund-
henk, Jacob F Pettit, and Daniel Faissol. Discovering symbolic policies with deep reinforcement learning.
InInternational Conference on Machine Learning , pp. 5979–5989, 2021.
Chi-Chuan Lee, Chien-Chiang Lee, and Yizhong Wu. The impact of covid-19 pandemic on hospitality stock
returns in china. International Journal of Finance & Economics , 2021a.
Chien-Chiang Lee, Jun-De Lee, and Chi-Chuan Lee. Stock prices and the eﬃcient market hypothesis:
Evidence from a panel stationary test with structural breaks. Japan and the world economy , 22(1):49–58,
2010.
Kimin Lee, Michael Laskin, Aravind Srinivas, and Pieter Abbeel. Sunrise: A simple uniﬁed framework
for ensemble learning in deep reinforcement learning. In International Conference on Machine Learning ,
2021b.
Siyu Lin and Peter A Beling. An end-to-end optimal trade execution framework based on proximal policy
optimization. In International Joint Conference on Artiﬁcial Intelligence , pp. 4548–4554, 2020.
Xiao-Yang Liu, Hongyang Yang, Qian Chen, Runjia Zhang, Liuqing Yang, Bowen Xiao, and Christina Dan
Wang. Finrl: A deep reinforcement learning library for automated stock trading in quantitative ﬁnance.
arXiv preprint arXiv:2011.09607 , 2020a.
Yang Liu, Qi Liu, Hongke Zhao, Zhen Pan, and Chuanren Liu. Adaptive quantitative trading: An imitative
deep reinforcement learning approach. In AAAI Conference on Artiﬁcial Intelligence , pp. 2128–2135,
2020b.
Scott M Lundberg and Su-In Lee. A uniﬁed approach to interpreting model predictions. Advances in neural
information processing systems , 30, 2017.
Marlos C Machado, Marc G Bellemare, Erik Talvitie, Joel Veness, Matthew Hausknecht, and Michael Bowl-
ing. Revisiting the arcade learning environment: Evaluation protocols and open problems for general
agents.Journal of Artiﬁcial Intelligence Research , 61:523–562, 2018.
Malik Magdon and Amir F Atiya. Maximum drawdown. Risk Magazine , 17(10):99–102, 2004.
Burton G Malkiel. The eﬃcient market hypothesis and its critics. Journal of Economic Perspectives , 17(1):
59–82, 2003.
Velayoudoum Marimoutou, Bechir Raggad, and Abdelwahed Trabelsi. Extreme value theory and value at
risk: Application to oil market. Energy Economics , 31(4), 2009.
18Published in Transactions on Machine Learning Research (02/2023)
Mieszko Mazur, Man Dang, and Miguel Vega. Covid-19 and the march 2020 stock market crash. evidence
from s&p1500. Finance research letters , 38, 2021.
Margaret Mitchell, Simone Wu, Andrew Zaldivar, Parker Barnes, Lucy Vasserman, Ben Hutchinson, Elena
Spitzer, Inioluwa Deborah Raji, and Timnit Gebru. Model cards for model reporting. In ACM Conference
on Fairness, Accountability, and Transparency , pp. 220–229, 2019.
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A Rusu, Joel Veness, Marc G Bellemare, Alex
Graves, Martin Riedmiller, Andreas K Fidjeland, Georg Ostrovski, et al. Human-level control through
deep reinforcement learning. nature, 518(7540):529–533, 2015.
Volodymyr Mnih, Adria Puigdomenech Badia, Mehdi Mirza, Alex Graves, Timothy Lillicrap, Tim Harley,
David Silver, and Koray Kavukcuoglu. Asynchronous methods for deep reinforcement learning. In Inter-
national Conference on Machine Learning , pp. 1928–1937, 2016.
Tobias J Moskowitz, Yao Hua Ooi, and Lasse Heje Pedersen. Time series momentum. Journal of Financial
Economics , 104(2):228–250, 2012.
Martin Mundt, Steven Lang, Quentin Delfosse, and Kristian Kersting. Cleva-compass: A continual learning
evaluation assessment compass to promote research transparency and comparability. In International
Conference on Learning Representations , 2021.
Ian Osband, Charles Blundell, Alexander Pritzel, and Benjamin Van Roy. Deep exploration via bootstrapped
dqn.Advances in Neural Information Processing Systems , 2016.
Sinno Jialin Pan and Qiang Yang. A survey on transfer learning. IEEE Transactions on Knowledge and
Data Engineering , 22(10), 2009.
Robert Pardo. The evaluation and optimization of trading strategies , volume 314. John Wiley & Sons, 2011.
Jack Parker, Aldo Pacchiano, Krzysztof M Choromanski, and Stephen J Roberts. Eﬀective diversity in
population based reinforcement learning. Advances in Neural Information Processing Systems , pp. 18050–
18062, 2020.
Julien Pénasse. Understanding alpha decay. Management Science , 2022.
Joelle Pineau, Philippe Vincent-Lamarre, Koustuv Sinha, Vincent Larivière, Alina Beygelzimer, Florence
d’Alché Buc, Emily Fox, and Hugo Larochelle. Improving reproducibility in machine learning research:
A report from the neurips 2019 reproducibility program. Journal of Machine Learning Research , 22(1):
7459–7478, 2021.
Fábio Pinto, Marco OP Sampaio, and Pedro Bizarro. Automatic model monitoring for data streams. arXiv
preprint arXiv:1908.04240 , 2019.
Fazlollah M Reza. An introduction to information theory . Courier Corporation, 1994.
MarcoTulioRibeiro, SameerSingh, andCarlosGuestrin. "whyshoulditrustyou?"explainingthepredictions
of any classiﬁer. In ACM SIGKDD International Conference on Knowledge Discovery and Data Mining ,
pp. 1135–1144, 2016.
Ramit Sawhney, Shivam Agarwal, Arnav Wadhwa, and Rajiv Ratn Shah. Spatiotemporal hypergraph con-
volution network for stock movement forecasting. In 2020 IEEE International Conference on Data Mining
(ICDM), pp. 482–491, 2020.
Ramit Sawhney, Shivam Agarwal, Arnav Wadhwa, and Rajiv Shah. Exploring the scale-free nature of stock
markets: Hyperbolic graph learning for algorithmic trading. In Acm Web Conference , pp. 11–22, 2021.
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov. Proximal policy optimiza-
tion algorithms. arXiv preprint arXiv:1707.06347 , 2017.
19Published in Transactions on Machine Learning Research (02/2023)
Claude Elwood Shannon. A mathematical theory of communication. The Bell system technical journal , 27
(3):379–423, 1948.
William F Sharpe. The sharpe ratio. Journal of Portfolio Management , 1998.
WenjieShi, GaoHuang, ShijiSong, ZhuoyuanWang, TingyuLin, andChengWu. Self-superviseddiscovering
of interpretable features for reinforcement learning. IEEE Transactions on Pattern Analysis and Machine
Intelligence , 44(5):2712–2724, 2020.
Robert J Shiller. Market volatility . MIT press, 1992.
AndrewSilva, MatthewGombolay, TaylorKillian, IvanJimenez, andSung-HyunSon. Optimizationmethods
forinterpretablediﬀerentiabledecisiontreesappliedtoreinforcementlearning. In International Conference
on Artiﬁcial Intelligence and Statistics , pp. 1855–1865, 2020.
David Silver, Guy Lever, Nicolas Heess, Thomas Degris, Daan Wierstra, and Martin Riedmiller. Determin-
istic policy gradient algorithms. In International Conference on Machine Learning , pp. 387–395, 2014.
David Silver, Julian Schrittwieser, Karen Simonyan, Ioannis Antonoglou, Aja Huang, Arthur Guez, Thomas
Hubert, Lucas Baker, Matthew Lai, Adrian Bolton, et al. Mastering the game of go without human
knowledge. Nature, 550(7676), 2017.
Thomas Spooner and Rahul Savani. Robust market making via adversarial reinforcement learning. In
International Joint Conference on Artiﬁcial Intelligence , 2020.
Thomas Spooner, John Fearnley, Rahul Savani, and Andreas Koukorinis. Market making via reinforcement
learning. In International Conference on Autonomous Agents and MultiAgent Systems , 2018.
Shuo Sun, Wanqi Xue, Rundong Wang, Xu He, Junlei Zhu, Jian Li, and Bo An. Deepscalper: A risk-aware
reinforcementlearningframeworktocaptureﬂeetingintradaytradingopportunities. In ACM International
Conference on Information & Knowledge Management , pp. 1858–1867, 2022.
Shuo Sun, Rundong Wang, and Bo An. Reinforcement learning for quantitative trading. ACM Transactions
on Intelligent Systems and Technology , 2023.
Jun Tu and Guofu Zhou. Markowitz meets talmud: A combination of sophisticated and naive diversiﬁcation
strategies. Journal of Financial Economics , 99(1):204–215, 2011.
Laurens Vander and Geoﬀrey Hinton. Visualizing data using t-sne. Journal of Machine Learning Research ,
9(11), 2008.
Oriol Vinyals, Igor Babuschkin, Wojciech M Czarnecki, Michaël Mathieu, Andrew Dudzik, Junyoung Chung,
David H Choi, Richard Powell, Timo Ewalds, Petko Georgiev, et al. Grandmaster level in starcraft ii using
multi-agent reinforcement learning. Nature, 575(7782), 2019.
Rundong Wang, Hongxin Wei, Bo An, Zhouyan Feng, and Jun Yao. Commission fee is not enough: A
hierarchicalreinforcedframeworkforportfoliomanagement. In AAAI Conference on Artiﬁcial Intelligence ,
pp. 626–633, 2021a.
Wenhui Wang, Hangbo Bao, Li Dong, Johan Bjorck, Zhiliang Peng, Qiang Liu, Kriti Aggarwal, Owais Khan
Mohammed, Saksham Singhal, Subhojit Som, et al. Image as a foreign language: Beit pretraining for all
vision and vision-language tasks. arXiv preprint arXiv:2208.10442 , 2022.
Zhicheng Wang, Biwei Huang, Shikui Tu, Kun Zhang, and Lei Xu. Deeptrader: A deep reinforcement
learning approach to risk-return balanced portfolio management with market conditions embedding. In
AAAI Conference on Artiﬁcial Intelligence , pp. 643–650, 2021b.
Yeming Wen, Dustin Tran, and Jimmy Ba. Batchensemble: an alternative approach to eﬃcient ensemble
and lifelong learning. In International Conference on Learning Representations , 2019.
20Published in Transactions on Machine Learning Research (02/2023)
Florian Wenzel, Jasper Snoek, Dustin Tran, and Rodolphe Jenatton. Hyperparameter ensembles for robust-
ness and uncertainty quantiﬁcation. Advances in Neural Information Processing Systems , pp. 6514–6527,
2020.
Yumo Xu and Shay B Cohen. Stock movement prediction from tweets and historical prices. In Annual
Meeting of the Association for Computational Linguistics , pp. 1970–1979, 2018.
Yunan Ye, Hengzhi Pei, Boxin Wang, Pin-Yu Chen, Yada Zhu, Ju Xiao, and Bo Li. Reinforcement-learning
based portfolio management with augmented asset movement prediction states. In AAAI Conference on
Artiﬁcial Intelligence , pp. 1112–1119, 2020.
Jaemin Yoo, Yejun Soun, Yong-chan Park, and U Kang. Accurate multivariate stock movement prediction
via data-axis transformer with multi-level contexts. In ACM SIGKDD Conference on Knowledge Discovery
& Data Mining , pp. 2037–2045, 2021.
Dong Yu, Kaisheng Yao, Hang Su, Gang Li, and Frank Seide. Kl-divergence regularized deep neural net-
work adaptation for improved large vocabulary speech recognition. In IEEE International Conference on
Acoustics, Speech and Signal Processing , 2013.
Yuyu Yuan, Wen Wen, and Jincui Yang. Using data augmentation based reinforcement learning for daily
stock trading. Electronics , 9(9), 2020.
Zihao Zhang, Stefan Zohren, and Stephen Roberts. Deep reinforcement learning for trading. The Journal of
Financial Data Science , 2(2), 2020.
Brian D Ziebart. Modeling purposeful adaptive behavior with the principle of maximum causal entropy .
Carnegie Mellon University, 2010.
21Published in Transactions on Machine Learning Research (02/2023)
Appendix
A PRUDEX-Compass
A.1 Additional Details of PRUDEX-Compass Measure
We elaborate 17 measures in Table 1 with mathematical deﬁnitions and detailed descriptions.
Proﬁtmeasure contains metrics to evaluate FinRL methods’ ability to gain market capital. Total return
(TR) is the percent change of net value over time horizon h. The formal deﬁnition is TR= (nt+h−nt)/nt,
wherentis the corresponding value at time t.
Alpha Decay indicates the loss in the investment decision making ability of FinRL methods over time due
to distribution shift in ﬁnancial markets. In ﬁnance, information coeﬃcient (IC) across time is widely-used
to measure alpha decay (Pénasse, 2022).
Equity Curve is a graphical representation of the value changes of trading strategies over time. An equity
curve with a consistently positive slope typically indicates that the trading strategies of the account are
proﬁtable. In RL settings, we usually plot equity curves with mean and standard deviation of multiple
random seeds.
Riskincludes a class of metrics to assess the risk level of FinRL methods.
•Volatility (Vol) is the variance of the return vector r. It is widely used to measure the uncertainty
of return rate and reﬂects the risk level of strategies. The deﬁnition is Vol=σ[r].
•Maximum drawdown (MDD) measures the largest decline from the peak in the whole trading
period to show the worst case. The formal deﬁnition is MDD = maxτ∈(0,t)[maxt∈(0,τ)nt−nτ
nt].
•Downside deviation (DD) refers to the standard deviation of trade returns that are negative.
Risk-adjusted Proﬁt calculates the potential normalized proﬁt by taking one share of the risk. We deﬁne
three metrics with diﬀerent types of risk:
•Sharpe ratio (SR) refers to the return per unit of deviation: SR=E[r]
σ[r].
•Sortino ratio (SoR) is another risk-adjusted proﬁt, which applies DD as risk measure: SoR =E[r]
DD.
•Calmarratio(CR) isanotherrisk-adjustedproﬁt, whichappliesMDDasriskmeasure: CR=E[r]
MDD.
Extreme Market. It is necessary to evaluate on extreme market conditions with black swan events to
show the reliability of FinRL methods .By analyzing the trading behaviors during extreme markets, we can
understand their cons and pros and further design better FinRL methods. There are a few potential testbed
such as COVID-19 pandemic, ﬁnancial crisis, government regulation and war.
Countries. Financial markets in diﬀerent countries have diﬀerent trading patterns, where markets in devel-
oped countries is more “eﬀcient” with high proportion of institutional investors and markets in developing
countries is more noisy with high personal investors. It is necessary to evaluate FinRL methods on multiple
mainstream ﬁnancial markets in diﬀerent countries, such as US, Europe and China, to evaluate universality.
Asset Type. A ﬁnancial asset is a liquid asset that derives its value from any contractual claim. Diﬀerent
asset types have diﬀerent liquidity, tradingrules andvaluemodels. It is necessary to evaluate FinRLmethods
on various ﬁnancial asset types to evaluate universality.
Time Scale. We can evaluate FinRL methods on multiple trading scenarios with ﬁnancial data on diﬀerent
time-scale (both coarse-grained and ﬁne-grained). For instance, second-level data can be used for high
frequency trading; minute-level data is suitable for intraday trading; day-level data can be applied for long-
term trend trading.
22Published in Transactions on Machine Learning Research (02/2023)
Rolling Window. Due to the remarkable distribution shift in ﬁnancial markets, researchers need to
train and evaluate FinRL methods in a rolling time window, which means retrain or ﬁne-tune RL models
periodically to ﬁt on current market status. Backtest with rolling window can evaluate the reliability of
FinRL.
t-SNEis a statistical method for visualizing high-dimensional data by giving each datapoint a location in
a two-dimensional map. First, t-SNE constructs a probability distribution over pairs of high-dimensional
objects where similar objects are assigned a higher probability. Second, t-SNE deﬁnes a similar probability
distribution over the points in the low-dimensional map, and it minimizes the KL divergence between the
two distributions with respect to the locations of the points in the map. In FinRL, we use t-SNE to visualize
ﬁnancial datasets to show the relative position of them.
Entropy. (Shannon, 1948) is applied in ﬁnance to measure the amount of information give by observing the
ﬁnancial market. In a portfolio, it is deﬁned as H(ω) =−exp(/summationtextn
i=1ωilogωi), whereω= (ω1,ω2,...,ωn)is a
portfolio among Nﬁnancial assets. This measure reach a minimum value 1 if a portfolio is fully concentrated
in one single asset and a maximum equal to Nthat representation the equally weighted portfolio.
Correlation. As entropy ignore the correlation between diﬀerent ﬁnancial assets, eﬀective number of bets
(ENB) is proposed to remove the correlation while calculating entropy. We ﬁrst deﬁne diversiﬁcation distri-
bution aspi(ω) =ω2
Fiλ2
i//summationtextn
i=1ω2
Fiλ2
i. We formulate the covariance matrix of Nassets ΣasE/primeΣE=λwhere
λis a diagonal matrix, λiis the element of the diagonal matrix and ωf=E−1ωwhereωis the our original
portfolios’ weights. The eﬀective number of bets is deﬁned as: ENB (ω) =−exp(/summationtextn
i=1pi(ω)logpi(ω)),
wherepi(ω)is theithdiversiﬁcation distribution for the portfolios’ weights ω.
Diversity Heatmap is a visualization tool to demonstrate the diversity of investment decisions among
diﬀerent ﬁnancial assets with heatmap (Harris et al., 2020). The x-axis refers to the relative weight of each
asset in the portfolio. The y-axis includes the results of diﬀerent FinRL algorithms.
Performance Proﬁle reports the score distribution of all runs across the 4 ﬁnancial markets that are
statistically unbiased, more robust to outliers and require fewer runs for lower uncertainty compared to
point estimates such as mean. Performance proﬁles proposed herein visualize the empirical tail distribution
function of a random score (higher curve is better), with point-wise conﬁdence bands based on stratiﬁed
bootstrap (Efron, 1979). A score distribution shows the fraction of runs above a certain normalized score
that is an unbiased estimator of the underlying performance distribution.
Variability refers the variance of performance across diﬀerent random seeds in RL. As a high stake domain,
it is important to test the variability, which is closely relevant to reliability.
Rank Comparison
In the rank distribution plot, the ithcolumn shows the probability that a given method is assigned rank i
in the corresponding metrics, which provides a indication on the overall rank of FinRL methods.
A.2 Creating a PRUDEX-Compass
To make the PRUDEX-Compass as accessible as possible and disseminate in a convenient way, we provide
two options for practical use.
•We provide a LaTeX template for PRUDEX-Compass, making use of the TikZ library to draw the
compass with. We envision that such a template makes it easy for readers to include a compass into
their future research, where they can adapt the naming and values of the entries respectively.
•We further provide a Python script to generate the PRUDEX-Compass. In fact, because the use
of drawing in LaTeX with TikZ may be unintuitive for some, we have written a Python script that
automatically ﬁlls above LaTeX template, so that it can later simply be included into a LaTeX
document. The Python script takes a path to a JSON ﬁle that needs to be ﬁlled by the user. There
is a default JSON ﬁle that is easy to adopt.
23Published in Transactions on Machine Learning Research (02/2023)
A.3 Computing Scores for PRUDEX-Compass Axes
We introduce how the value of each axe for each FinRL method is computed in this subsection. The basic
principleistoproposeadistinguishableandrobustwaytoshowtheperformancediﬀerenceofFinRLmethods
across multiple evaluation measures in terms of each axe. Generally speaking, we normalize the performance
of diﬀerent measures on the 6 axes to a score from 0 to 100. We mark market average strategy (evenly invest
on all assets) as 50. All scores are calculated with the average of 4 ﬁnancial markets. We deﬁne the metrics
value for FinRL methods and market average as mrlandmave, respectively. For the 4 proﬁt-related metrics
(TR, SR, CR, SoR), we normalized them into a score Sprowith range [0,100]:Spro= (mrl/mave−0.8)∗250,
where 20% higher proﬁt than market average is scored 100. We clip values lower than 0 and higher than 100
as 0 and 100, respectively. For the 2 risk metrics (Vol, MDD), we normalized them into a score Sriskwith
range [0,100]:Srisk= (1.2−mrl/mave)∗250, where 20% lower risk than market average is scored 100. We
clip values lower than 0 and higher than 100 as 0 and 100, respectively.
For universality, we directly use the raw return rate and calcualte the 4 indicators of proﬁtability, we then
plot a rank graph and for each measures of proﬁtability, we multiply the probability obtained from the rank
matrix and the rankscore(if it’s 1st, the score is 100 and if 6th, the score is 0) to get a score for that measure.
Then we average the 4 measures together to get the university score for that algorithm. For the 2 diversity
metrics (ENT, ENB), we normalized them into a score Sdiv:
Sdiv=/braceleftBigg
mrl/mave×100,for ENT
mrl/mave×50,for ENB
where the diversity of uniform policy is scored 100 for ENT and 50 for ENB. For explainability, we set the
explainability score 50 for all FinRL methods. For reliability, we use the total return rate score we just
normalized using average policy as a indicator and draw a performance proﬁle graph, then we use the area
under the curve for each algorithm to calculate the reliability. The constants in the equations (e.g., 20%)
are applied to make the plot distinguishable and easy to follow, which does not inﬂuence the robustness of
axes in PRUDEX-Compass.
B Experiment Setup
B.1 Training Setup
Table 4: Hyperparameters of AlphaMix+
Hyperparameter Value Hyperparameter Value
Replay buﬀer size 10000 Initial step 10000
Layer(MLP) (128,128) Stacked frame 3
Evaluation episodes 10 Optimizer Adam
Temperature 20 Uncertainty 0.5
Actor learning rate 0.0007 Critic learning rate 0.0007
Batch size 256 Action numbers 29(US) 47(China) 22(FX) 9(Crypto)
Discountγ 0.99 Ber_mean 0.5
Non-linear Sigmoid Observation Number of assets ×11
C Experimental Results
C.1 Result Table
In this subsection, we report detailed results of 8 metrics in the four ﬁnancial markets. Since we apply 1
year rolling window during training, each ﬁnancial market has 3 tables for 3 consecutive years.
24Published in Transactions on Machine Learning Research (02/2023)
Table 5: US Stock 2021
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 12.4 ±6.3 13.1 ±4.4 20.0 ±10.3 17.3 ±2.0 17.2 ±7.4 16.9 ±1.2 4.0 ±10.1 20.7 ±1.8
SR 1.03 ±0.50 0.94 ±0.26 1.30 ±0.57 1.37 ±0.12 1.22 ±0.50 1.39 ±0.08 0.35 ±0.64 1.64 ±0.11
CR 0.81 ±0.34 0.83 ±0.13 0.91 ±0.19 1.06 ±0.03 0.84 ±0.23 1.06 ±0.02 0.47 ±0.61 1.09 ±0.02
SoR 1.52 ±0.70 1.38 ±0.44 1.89 ±0.87 2.02 ±0.21 1.81 ±0.75 2.03 ±0.12 0.52 ±0.91 2.36 ±0.17
MDD(%) 15.0 ±1.9 15.3 ±2.5 19.7 ±4.6 15.6 ±1.2 19.1 ±3.9 15.2 ±0.6 14.6 ±3.7 17.9 ±1.4
VOL(%) 0.78 ±0.06 0.87 ±0.03 0.91 ±0.02 0.76 ±0.02 0.86 ±0.03 0.73 ±0.03 1.0 ±0.12 0.74 ±0.02
ENT 2.26 ±0.26 1.82 ±0.02 1.67 ±0.02 2.79 ±0.11 1.82 ±0.01 2.90 ±0.26 1.89 ±0.1 3.25 ±0.12
ENB 1.34 ±0.10 1.49 ±0.01 1.61 ±0.02 1.14 ±0.06 1.51 ±0.02 1.19 ±0.10 1.73 ±0.10 1.11 ±0.03
Table 6: US Stock 2020
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 7.46 ±4.86 18.3 ±8.4 7.77 ±21.1 9.23 ±8.79 10.2 ±10.5 15.8 ±16.1 -20.6 ±9.5 12.7 ±1.7
SR 0.36 ±0.12 0.62 ±0.19 0.37 ±0.52 0.41 ±0.21 0.42 ±0.25 0.55 ±0.30 -0.28 ±0.21 0.52 ±0.04
CR 0.36 ±0.12 0.54 ±0.15 0.30 ±0.48 0.38 ±0.19 0.42 ±0.22 0.49 ±0.22 -0.28 ±0.22 0.47 ±0.03
SoR 0.44 ±0.14 0.76 ±0.23 0.50 ±0.63 0.50 ±0.26 0.56 ±0.33 0.68 ±0.38 -0.36 ±0.27 0.62 ±0.05
MDD(%) 36.6 ±2.4 42.2 ±2.4 42.8 ±5.3 37.8 ±3.19 34.9 ±3.91 38.9 ±6.69 43.5 ±6.42 38.2 ±0.96
VOL(%) 2.25 ±0.09 2.32 ±0.03 2.45 ±0.16 2.26 ±0.17 2.31 ±0.09 2.21 ±0.23 2.9 ±0.39 2.16 ±0.04
ENT 1.96 ±0.20 1.82 ±0.02 1.61 ±0.03 2.07 ±0.67 1.82 ±0.02 2.41 ±0.67 1.85 ±0.21 3.22 ±0.03
ENB 1.05 ±0.01 1.05 ±0.004 1.1 ±0.003 1.05 ±0.03 1.05 ±0.002 1.05 ±0.05 1.13 ±0.04 1.0 ±0.006
Table 7: US Stock 2019
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 20.5 ±9.27 21.5 ±10.1 27.3 ±9.79 27.7 ±1.63 22.9 ±3.51 30.2 ±8.42 20.6 ±9.52 25.1 ±1.42
SR 1.47 ±0.58 1.53 ±0.62 1.72 ±0.54 2.00 ±0.15 1.60 ±0.24 2.12 ±0.27 1.28 ±0.21 1.98 ±0.06
CR 1.00 ±0.06 1.01 ±0.06 1.05 ±0.09 1.02 ±0.05 1.01 ±0.05 1.06 ±0.05 0.28 ±0.22 1.03 ±0.007
SoR 1.96 ±0.78 2.04 ±0.83 2.17 ±0.78 2.52 ±0.24 2.16 ±0.43 2.82 ±0.42 0.36 ±0.27 2.47 ±0.09
MDD(%) 18.8 ±5.95 19.4 ±6.26 23.4 ±4.70 24.7 ±2.63 21.2 ±2.41 25.2 ±4.83 43.6 ±6.42 22.3 ±0.99
VOL(%) 0.82 ±0.01 0.83 ±0.02 0.91 ±0.05 0.79 ±0.10 0.84 ±0.03 0.79 ±0.11 1.9 ±0.39 0.73 ±0.02
ENT 1.83 ±0.01 1.82 ±0.01 1.63 ±0.02 2.08 ±0.67 1.81 ±0.01 2.32 ±0.48 1.89 ±0.16 3.27 ±0.03
ENB 1.28 ±0.01 1.27 ±0.01 1.38 ±0.01 1.29 ±0.21 1.26 ±0.005 1.15 ±0.06 1.73 ±0.10 1.05 ±0.01
Table 8: China Stock 2020
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 5.52 ±4.82 6.20 ±7.57 13.4 ±20.1 11.4 ±8.84 12.3 ±14.2 13.0 ±3.8 52.6 ±20.8 14.8 ±3.30
SR 0.35 ±0.21 0.40 ±0.37 0.59 ±0.68 0.63 ±0.41 0.62 ±0.60 0.73 ±0.17 2.68 ±0.83 0.79 ±0.12
CR 0.25 ±0.15 0.29 ±0.27 0.41 ±0.48 0.42 ±0.27 0.36 ±0.39 0.51 ±0.08 1.18 ±0.24 0.53 ±0.06
SoR 0.40 ±0.24 0.45 ±0.42 0.71 ±0.81 0.71 ±0.46 0.71 ±0.69 0.80 ±0.18 4.04 ±1.2 0.89 ±0.15
MDD(%) 28.1 ±3.68 25.3 ±1.59 29.9 ±7.38 26.5 ±5.09 31.5 ±6.02 27.0 ±2.41 34.2 ±9.16 29.1 ±1.85
VOL(%) 0.74 ±0.04 0.68 ±0.004 0.81 ±0.06 0.68 ±0.02 0.76 ±0.01 0.67 ±0.02 0.66 ±0.09 0.69 ±0.01
ENT 1.85 ±0.42 2.82 ±0.01 1.10 ±0.02 2.60 ±0.17 1.53 ±0.001 2.39 ±0.10 1.30 ±0.85 3.12 ±0.02
ENB 1.12 ±0.05 1.04 ±0.01 1.27 ±0.01 1.04 ±0.01 1.16 ±0.004 1.06 ±0.01 2.82 ±0.85 1.02 ±0.01
Table 9: China Stock 2019
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 31.9 ±10.6 29.7 ±8.42 25.4 ±10.4 32.6 ±5.78 22.1 ±13.6 36.2 ±7.09 -7.14 ±0.82 32.2 ±2.20
SR 1.59 ±0.46 1.65 ±0.39 1.13 ±0.38 1.80 ±0.24 1.19 ±0.59 1.77 ±0.05 -0.34 ±0.1 1.79 ±0.10
CR 0.90 ±0.16 0.94 ±0.13 0.79 ±0.23 1.01 ±0.07 0.74 ±0.21 1.04 ±0.05 -0.29 ±0.07 1.01 ±0.02
SoR 2.32 ±0.75 2.41 ±0.63 1.70 ±0.64 2.63 ±0.34 1.72 ±0.91 2.57 ±0.15 -0.37 ±0.08 2.62 ±0.14
MDD(%) 31.7 ±2.85 28.6 ±2.82 29.8 ±2.38 28.9 ±2.38 27.5 ±4.92 30.5 ±3.74 20.4 ±0.63 28.9 ±0.90
VOL(%) 0.65 ±0.02 0.58 ±0.004 0.74 ±0.02 0.57 ±0.01 0.63 ±0.02 0.64 ±0.11 0.77 ±0.06 0.57 ±0.01
ENT 1.54 ±0.01 2.85 ±0.005 1.02 ±0.02 2.47 ±0.17 1.53 ±0.009 1.97 ±0.90 1.30 ±0.85 3.15 ±0.07
ENB 1.18 ±0.009 1.05 ±0.002 1.32 ±0.009 1.05 ±0.01 1.18 ±0.004 1.21 ±0.18 1.19 ±0.85 1.04 ±0.01
25Published in Transactions on Machine Learning Research (02/2023)
Table 10: China Stock 2018
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) -6.86 ±11.30 -6.56 ±3.66 -4.05 ±10.77 -5.77 ±4.04 5.67 ±5.95 -2.27 ±1.99 -7.14 ±0.82 -0.70 ±1.38
SR -0.28 ±0.61 -0.31 ±0.22 -0.12 ±0.50 -0.25 ±0.21 0.37 ±0.30 -0.05 ±0.12 -0.34 ±0.1 0.03 ±0.08
CR -0.14 ±0.50 -0.25 ±0.16 -0.06 ±0.42 -0.20 ±0.15 0.40 ±0.32 -0.04 ±0.11 -0.29 ±0.07 0.04 ±0.10
SoR -0.33 ±0.78 -0.41 ±0.26 -0.15 ±0.75 -0.35 ±0.29 0.54 ±0.45 -0.07 ±0.17 -0.37 ±0.08 0.04 ±0.11
MDD(%) 22.3 ±5.52 20.5 ±1.55 25.9 ±4.95 20.2 ±3.49 19.1 ±3.39 17.5 ±1.52 20.4 ±0.63 16.1 ±1.45
VOL(%) 0.67 ±0.03 0.59 ±0.01 0.75 ±0.03 0.61 ±0.03 0.66 ±0.02 0.59 ±0.03 0.77 ±0.06 0.57 ±0.02
ENT 1.54 ±0.01 2.85 ±0.007 1.01 ±0.03 2.41 ±0.40 1.53 ±0.007 2.55 ±0.15 1.30 ±0.85 3.12 ±0.02
ENB 1.31 ±0.01 1.08 ±0.005 1.57 ±0.009 1.11 ±0.10 1.30 ±0.009 1.05 ±0.01 1.19 ±0.08 1.03 ±0.003
Table 11: Crypto 2021
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 223 ±346 146 ±129 377 ±982 199 ±195 398 ±344 146 ±137 140 ±155 291 ±71
SR 1.38 ±0.74 1.22 ±0.56 1.13 ±0.67 1.41 ±0.45 1.71 ±0.45 1.46 ±0.42 1.24 ±0.34 1.87 ±0.09
CR 1.77 ±1.02 1.48 ±0.53 2.18 ±2.05 1.75 ±0.74 2.18 ±0.84 1.44 ±0.49 1.39 ±0.58 2.02 ±0.26
SoR 2.15 ±1.23 2.13 ±1.11 3.16 ±3.31 2.42 ±1.24 2.97 ±1.35 2.42 ±1.22 2.03 ±0.80 3.14 ±0.56
MDD(%) 77.1 ±15.7 74.9 ±10.4 80.1 ±15.6 79.4 ±10.0 85.1 ±8.42 72.5 ±10.2 71.0 ±11.2 85.7 ±4.14
VOL(%) 7.30 ±1.91 6.97 ±0.94 10.94 ±8.13 7.26 ±2.31 7.85 ±2.05 5.22 ±1.06 5.56 ±1.61 6.80 ±0.84
ENT 1.02 ±0.31 0.72 ±0.05 0.47 ±0.07 1.42 ±0.25 0.56 ±0.04 1.53 ±0.23 0.58 ±0.23 2.09 ±0.02
ENB 1.79 ±0.15 1.94 ±0.04 1.99 ±0.05 1.67 ±0.40 1.97 ±0.03 1.12 ±0.05 1.66 ±0.38 1.47 ±0.15
Table 12: Crypto 2020
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 61.4 ±58.1 59.1 ±58.4 16.0 ±38.4 31.4 ±12.8 37.9 ±27.1 30.7 ±11.7 55.3 ±17.6 33.8 ±6.16
SR 1.12 ±0.66 1.12 ±0.67 0.51 ±0.50 0.81 ±0.24 0.85 ±0.38 0.79 ±0.17 1.03 ±0.08 0.86 ±0.08
CR 1.06 ±0.47 1.02 ±0.45 0.59 ±0.58 0.86 ±0.23 0.97 ±0.42 0.82 ±0.19 0.73 ±0.07 0.87 ±0.09
SoR 1.58 ±1.20 1.62 ±1.22 0.59 ±0.63 0.89 ±0.29 1.04 ±0.54 0.92 ±0.18 1.49 ±0.32 0.94 ±0.10
MDD(%) 52.9 ±7.58 52.2 ±8.03 55.7 ±2.12 46.6 ±8.08 50.3 ±8.04 44.6 ±3.22 56.6 ±4.43 46.5 ±2.43
VOL(%) 3.86 ±0.22 3.75 ±0.17 4.46 ±0.35 3.66 ±0.76 4.05 ±0.32 3.37 ±0.36 2.86 ±0.53 3.46 ±0.22
ENT 0.59 ±0.04 0.59 ±0.04 0.45 ±0.02 1.32 ±0.45 0.60 ±0.01 1.24 ±0.52 0.58 ±0.52 2.17 ±0.07
ENB 1.05 ±0.01 1.06 ±0.03 1.07 ±0.03 1.01 ±0.005 1.05 ±0.01 1.01 ±0.01 1.01 ±0.01 1.00 ±0.001
Table 13: Crypto 2019
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 82.8 ±51.5 85.8 ±57.1 73.9 ±33.9 61.0 ±19.3 39.1 ±54.5 50.8 ±13.2 110.6 ±17.6 68.3 ±17.8
SR 1.37 ±0.50 1.39 ±0.55 1.27 ±0.35 1.26 ±0.26 0.83 ±0.59 1.15 ±0.20 2.06 ±0.08 1.43 ±0.22
CR 1.14 ±0.30 1.14 ±0.33 1.06 ±0.24 1.06 ±0.11 0.73 ±0.39 0.98 ±0.10 1.45 ±0.07 1.08 ±0.11
SoR 2.19 ±0.98 2.22 ±1.02 2.10 ±0.65 1.89 ±0.39 1.30 ±1.12 1.77 ±0.28 2.99 ±0.32 2.16 ±0.35
MDD(%) 59.5 ±9.64 59.9 ±10.5 59.1 ±7.74 52.4 ±6.49 51.3 ±11.3 49.9 ±5.80 56.6 ±4.43 55.5 ±3.58
VOL(%) 3.69 ±0.36 3.69 ±0.35 3.63 ±0.27 3.29 ±0.35 3.46 ±0.24 3.15 ±0.30 2.86 ±0.53 3.09 ±0.18
ENT 0.60 ±0.02 0.62 ±0.03 0.43 ±0.03 1.21 ±0.40 0.59 ±0.02 1.24 ±0.52 0.58 ±0.52 2.15 ±0.10
ENB 1.15 ±0.006 1.14 ±0.01 1.15 ±0.008 1.06 ±0.02 1.14 ±0.01 1.01 ±0.01 1.01 ±0.01 1.01 ±0.01
Table 14: Foreign Exchange 2019
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) -0.94 ±3.14 -1.49 ±2.68 -1.02 ±3.11 0.96 ±0.36 -0.19 ±2.88 1.42 ±0.24 -5.53 ±0.05 1.22 ±0.46
SR -0.22 ±0.73 -0.34 ±0.64 -0.21 ±0.64 0.29 ±0.09 -0.03 ±0.66 0.39 ±0.05 -0.97 ±0.01 0.41 ±0.16
CR -0.07 ±0.42 -0.16 ±0.35 -0.02 ±0.43 0.22 ±0.08 0.04 ±0.46 0.32 ±0.07 -0.49 ±0.01 0.36 ±0.17
SoR -0.32 ±1.05 -0.51 ±1.00 -0.26 ±0.86 0.50 ±0.17 0.06 ±1.11 0.65 ±0.07 -1.5 ±0.02 0.74 ±0.31
MDD(%) 7.90 ±1.85 6.28 ±1.37 6.94 ±2.07 4.60 ±0.47 6.84 ±1.38 4.65 ±0.43 11.17 ±0.05 3.77 ±0.56
VOL(%) 0.27 ±0.01 0.28 ±0.01 0.31 ±0.01 0.22 ±0.01 0.26 ±0.01 0.23 ±0.01 0.25 ±0.01 0.19 ±0.01
ENT 1.44 ±0.08 1.37 ±0.01 0.93 ±0.04 2.55 ±0.10 1.35 ±0.02 2.23 ±0.08 3.08 ±0.01 2.97 ±0.04
ENB 1.65 ±0.06 1.73 ±0.01 2.02 ±0.04 1.18 ±0.10 1.71 ±0.03 1.16 ±0.06 1.08 ±0.01 1.18 ±0.06
26Published in Transactions on Machine Learning Research (02/2023)
Table 15: Foreign Exchange 2018
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) -5.43 ±2.29 -5.25 ±2.45 -5.61 ±3.02 -4.52 ±1.91 -4.99 ±2.82 -6.15 ±0.28 -5.53 ±0.05 -4.92 ±0.32
SR -1.01 ±0.45 -0.97 ±0.49 -0.91 ±0.43 -0.93 ±0.41 -0.91 ±0.55 -1.15 ±0.14 -0.97 ±0.01 -1.15 ±0.10
CR -0.50 ±0.14 -0.48 ±0.16 -0.50 ±0.18 -0.48 ±0.19 -0.49 ±0.21 -0.59 ±0.04 -0.49 ±0.01 -0.57 ±0.03
SoR -1.43 ±0.64 -1.36 ±0.68 -1.23 ±0.44 -1.42 ±0.62 -1.29 ±0.74 -1.66 ±0.26 -1.5 ±0.02 -1.77 ±0.16
MDD(%) 10.4 ±1.67 10.4 ±1.85 10.7 ±1.80 9.08 ±0.96 9.41 ±2.20 10.6 ±0.91 11.2 ±0.05 8.66 ±0.14
VOL(%) 0.34 ±0.02 0.34 ±0.02 0.37 ±0.03 0.31 ±0.02 0.34 ±0.01 0.34 ±0.03 0.25 ±0.0 0.27 ±0.01
ENT 1.38 ±0.03 1.34 ±0.03 0.94 ±0.03 2.23 ±0.37 1.37 ±0.01 1.55 ±0.72 3.08 ±0.01 2.98 ±0.03
ENB 1.45 ±0.01 1.46 ±0.03 1.65 ±0.05 1.16 ±0.09 1.45 ±0.02 1.39 ±0.27 1.08 ±0.01 1.11 ±0.01
Table 16: Foreign Exchange 2017
Metrics A2C PPO SAC SARL DeepTrader EIIE IMIT AlphaMix+
TR(%) 6.93 ±1.71 6.85 ±1.44 8.25 ±3.62 5.81 ±2.26 5.94 ±2.50 6.71 ±2.72 6.42 ±0.16 7.16 ±0.36
SR 1.34 ±0.29 1.32 ±0.24 1.41 ±0.48 1.34 ±0.57 1.13 ±0.51 1.26 ±0.47 0.81 ±0.02 1.72 ±0.13
CR 0.82 ±0.12 0.81 ±0.12 0.88 ±0.17 0.79 ±0.27 0.77 ±0.19 0.88 ±0.11 0.73 ±0.01 0.93 ±0.02
SoR 2.15 ±0.45 2.14 ±0.42 2.17 ±1.01 2.28 ±0.97 1.74 ±0.89 1.89 ±0.80 1.21 ±0.03 3.04 ±0.27
MDD(%) 8.21 ±1.28 8.20 ±1.12 9.01 ±2.45 7.12 ±1.27 7.46 ±1.87 7.33 ±2.08 8.98 ±0.12 7.51 ±0.43
VOL(%) 0.32 ±0.01 0.32 ±0.01 0.35 ±0.03 0.28 ±0.04 0.33 ±0.02 0.34 ±0.08 0.36 ±0.01 0.25 ±0.01
ENT 1.34 ±0.02 1.35 ±0.02 0.90 ±0.03 2.17 ±0.45 1.37 ±0.01 1.41 ±0.57 3.08 ±0.01 2.98 ±0.10
ENB 1.58 ±0.01 1.59 ±0.04 1.82 ±0.02 1.29 ±0.15 1.57 ±0.02 1.55 ±0.18 1.05 ±0.04 1.10 ±0.04
C.2 Ablation Studies
Models Ensemble Weight BB Diveristy TR(%)↑SR↑CR↑SoR↑MDD(%)↓VOL(%)↓ENT↑ENB↑
SAC 7.77 0.37 0.30 0.50 42.8 2.45 1.61 1.10√10.2 0.46 0.50 0.55 31.6 2.15 3.25 1.01
AlphaMix+√ √10.1 0.45 0.48 0.54 32.3 2.15 3.28 1.01√ √10.9 0.47 0.52 0.57 32.0 2.19 3.26 1.02√ √ √12.7 0.52 0.47 0.62 38.2 2.16 3.22 1.00
Table 17: US Stock 2020 Ablation
Models Ensemble Weight BB Diveristy TR(%)↑SR↑CR↑SoR↑MDD(%)↓VOL(%)↓ENT↑ENB↑
SAC 13.4 0.59 0.41 0.71 29.9 0.81 1.10 1.27√13.6 0.75 0.77 0.83 19.0 0.69 3.15 1.01
AlphaMix+√ √11.6 0.66 0.68 0.73 18.7 0.68 3.09 1.02√ √12.0 0.68 0.70 0.76 18.7 0.68 3.20 1.02√ √ √14.8 0.79 0.53 0.89 29.1 0.69 3.12 1.02
Table 18: China Stock 2020 Ablation
Models Ensemble Weight BB Diveristy TR(%)↑SR↑CR↑SoR↑MDD(%)↓VOL(%)↓ENT↑ENB↑
SAC 16.0 0.51 0.59 0.59 55.7 4.46 0.45 1.07√24.4 0.73 0.72 0.76 44.8 3.26 2.08 1.00
AlphaMix+√ √27.7 0.77 0.78 0.82 46.5 3.42 2.14 1.00√ √32.2 0.83 0.86 0.89 48.0 3.62 2.19 1.00√ √ √33.8 0.86 0.87 0.94 46.5 3.46 2.17 1.00
Table 19: Crypto 2020 Ablation
Models Ensemble Weight BB Diveristy TR(%)↑SR↑CR↑SoR↑MDD(%)↓VOL(%)↓ENT↑ENB↑
SAC -1.02 -0.21 -0.02 -0.26 6.94 0.31 0.93 2.02√1.06 0.33 0.26 0.58 4.24 0.21 2.98 1.22
AlphaMix+√ √1.11 0.34 0.27 0.60 4.47 0.22 2.91 1.19√ √1.04 0.33 0.25 0.57 4.34 0.21 3.01 1.19√ √ √1.22 0.41 0.36 0.74 3.77 0.19 2.97 1.18
Table 20: Foreign Exchange 2019 Ablation
27Published in Transactions on Machine Learning Research (02/2023)
C.3 Parameter Analysis: Probing Sensitivity
0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
Binomial Sample 
100150200250300350400T otal Return (%)
Crypto
18.0 18.5 19.0 19.5 20.0 20.5 21.0 21.5 22.0
T emperature T150200250300350400T otal Return (%)
Crypto
0.3 0.4 0.5 0.6 0.7 0.8 0.9
Scale Factor k200225250275300325350375400T otal Return (%)
Crypto
0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
Binomial Sample 
1.61.82.02.22.42.6Sharpe Ratio
Crypto
18.0 18.5 19.0 19.5 20.0 20.5 21.0 21.5 22.0
T emperature T1.82.02.22.42.6Sharpe Ratio
Crypto
0.3 0.4 0.5 0.6 0.7 0.8 0.9
Scale Factor k2.02.12.22.32.42.5Sharpe Ratio
Crypto
Figure 10: Hyperparameter Sensitivity Experiment Results on Crypto
0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
Binomial Sample 
0.60.81.01.21.41.61.82.0T otal Return (%)
FX
18.0 18.5 19.0 19.5 20.0 20.5 21.0 21.5 22.0
T emperature T0.60.81.01.21.41.6T otal Return (%)
FX
0.3 0.4 0.5 0.6 0.7 0.8 0.9
Scale Factor k1.161.181.201.221.24T otal Return (%)
FX
0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
Binomial Sample 
0.00.10.20.30.40.50.60.70.8Sharpe Ratio
FX
18.0 18.5 19.0 19.5 20.0 20.5 21.0 21.5 22.0
T emperature T0.10.20.30.40.50.6Sharpe Ratio
FX
0.3 0.4 0.5 0.6 0.7 0.8 0.9
Scale Factor k0.340.350.360.370.380.390.400.410.42Sharpe Ratio
FX
Figure 11: Hyperparameter Sensitivity Experiment Results on FX
28Published in Transactions on Machine Learning Research (02/2023)
C.4 PRIDE-Star
TRSRCR
SoRVolMDDENT
ENB
(a) A2C
TRSRCR
SoRVolMDDENT
ENB (b) PPO
TRSRCR
SoRVolMDDENT
ENB (c) SAC
TRSRCR
SoRVolMDDENT
ENB (d) SARL
TRSRCR
SoRVolMDDENT
ENB
(e) DeepTrader
TRSRCR
SoRVolMDDENT
ENB (f) EIIE
TRSRCR
SoRVolMDDENT
ENB (g) IMIT
TRSRCR
SoRVolMDDENT
ENB (h) AlphaMix+
Figure 12: PRIDE-Star on US Stock
TRSRCR
SoRVolMDDENT
ENB
(a) A2C
TRSRCR
SoRVolMDDENT
ENB (b) PPO
TRSRCR
SoRVolMDDENT
ENB (c) SAC
TRSRCR
SoRVolMDDENT
ENB (d) SARL
TRSRCR
SoRVolMDDENT
ENB
(e) DeepTrader
TRSRCR
SoRVolMDDENT
ENB (f) EIIE
TRSRCR
SoRVolMDDENT
ENB (g) IMIT
TRSRCR
SoRVolMDDENT
ENB (h) AlphaMix+
Figure 13: PRIDE-Star on FX
29Published in Transactions on Machine Learning Research (02/2023)
TRSRCR
SoRVolMDDENT
ENB
(a) A2C
TRSRCR
SoRVolMDDENT
ENB (b) PPO
TRSRCR
SoRVolMDDENT
ENB (c) SAC
TRSRCR
SoRVolMDDENT
ENB (d) SARL
TRSRCR
SoRVolMDDENT
ENB
(e) DeepTrader
TRSRCR
SoRVolMDDENT
ENB (f) EIIE
TRSRCR
SoRVolMDDENT
ENB (g) IMIT
TRSRCR
SoRVolMDDENT
ENB (h) AlphaMix+
Figure 14: PRIDE-Star on China Stock
TRSRCR
SoRVolMDDENT
ENB
(a) A2C
TRSRCR
SoRVolMDDENT
ENB (b) PPO
TRSRCR
SoRVolMDDENT
ENB (c) SAC
TRSRCR
SoRVolMDDENT
ENB (d) SARL
TRSRCR
SoRVolMDDENT
ENB
(e) DeepTrader
TRSRCR
SoRVolMDDENT
ENB (f) EIIE
TRSRCR
SoRVolMDDENT
ENB (g) IMIT
TRSRCR
SoRVolMDDENT
ENB (h) AlphaMix+
Figure 15: PRIDE-Star on Crypto
30Published in Transactions on Machine Learning Research (02/2023)
C.5 Performance Proﬁle
0 20 40 60 80 100
total return score ()
0.000.250.500.751.00Fraction of runs with score >
A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+
(a) Crypto
0 20 40 60 80 100
total return score ()
0.000.250.500.751.00Fraction of runs with score >
A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+ (b) US Stock
0 20 40 60 80 100
total return score ()
0.000.250.500.751.00Fraction of runs with score >
A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+
(c) FX
0 20 40 60 80 100
total return score ()
0.000.250.500.751.00Fraction of runs with score >
A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+ (d) China Stock
Figure 16: Performance proﬁle on 4 inﬂuential ﬁnancial markets
C.6 Rank Distribution
12345678020406080100TR
12345678020406080100SR
12345678020406080100VOL
12345678020406080100EntropyFraction (in %)A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+
(a) Crypto
12345678020406080100TR
12345678020406080100SR
12345678020406080100VOL
12345678020406080100EntropyFraction (in %)A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+ (b) US Stock
12345678020406080100TR
12345678020406080100SR
12345678020406080100VOL
12345678020406080100EntropyFraction (in %)A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+
(c) FX
12345678020406080100TR
12345678020406080100SR
12345678020406080100VOL
12345678020406080100EntropyFraction (in %)A2C
DeepTraderPPO
EIIESAC
IMITSARL
AlphaMix+ (d) China Stock
Figure 17: Rank distribution on 4 inﬂuential ﬁnancial markets
31