arXiv:2301.07576v2  [math-ph]  11 Oct 2024A metriplectic formulation of polarized radiative
transfer
V. Bosboom1, M. Kraus2,3and M. Schlottbom1
1Department of Applied Mathematics, University of Twente, P.O. Box 217, 7500 AE
Enschede, The Netherlands.
2Max-Planck-Institut f¨ ur Plasmaphysik Boltzmannstraße 2, 8574 8 Garching,
Germany.
3Technische Universit¨ at M¨ unchen, Zentrum Mathematik, Boltzma nnstraße 3, 85748
Garching, Germany
E-mail:v.bosboom@utwente.nl ,michael.kraus@ipp.mpg.de ,
m.schlottbom@utwente.nl
Abstract. We present a metriplectic formulation of the radiative transfer equ ation
with polarization and varying refractive index and show that this for mulation
automatically satisﬁes the ﬁrst two laws of thermodynamics. In par ticular, the derived
antisymmetric bracket enjoys the Jacobi identity. To obtain this f ormulation we
suitably transform the equation and show that important physical quantities derived
from the solution remain invariant under such a transformation.
Keywords : Radiative transfer, polarization, metriplectic formulation, struc ture-
preservationA metriplectic formulation of polarized radiative transfe r 2
1. Introduction
We investigate the mathematical structure of the radiative trans fer equation (RTE),
which is a frequently used model in many applications, for example, at mospheric
science [1,2] or biomedical imaging [ 3,4]. While the RTE was ﬁrst derived based on
phenomenological arguments [ 5], it was later given a ﬁrm basis as a high-frequency limit
of the Maxwell equations [ 6,7].
The RTE is a linear integro-diﬀerential equation that describes the p ropagation
of polarized light through a medium with varying refractive index and it s scattering
due to random ﬂuctuations. These two processes, i.e., transport and scattering, often
require a diﬀerent treatment; for instance, in the mathematical a nalysis of the RTE,
see, e.g., [ 8,9], or in its numerical approximation by discrete ordinates methods [ 10].
As we will show in this paper, the transport process can be describe d by a
Hamiltonian ﬂow, while the scattering process constitutes a dissipat ive process. We
then combine these two processes into one theoretical framewor k by using the so-called
metriplectic formalism, originally conceived by Morrison [ 11–13]. The metriplectic
formalism not only illuminates both the conservation and dissipation pr operties of
an equation and gives a direct link to thermodynamics, but it also facilit ates the
construction of structure-preserving discretizations [ 14–16]. When unpolarized light
is considered the RTE reduces to a single equation for the light intens ity [7], and a
metriplectic formulation for this case has recently been reported in [17]. The extension
to polarized radiation considered here requires novel arguments.
The outline of this paper is as follows: In Section 2we give a brief overview of the
metriplectic formalism and explain that it can be used to reproduce th e ﬁrst two laws
of thermodynamics. In Section 3we introduce the radiative transfer equation, relate
the solution to the Stokes parameters describing polarized light, an d derive our main
results on the metriplectic formulation for the radiative transfer e quation. Furthermore,
we show that for unpolarized light this metriplectic formulation reduc es to one reported
in [17]. In Section 4we cast the RTE in a suitable form by eliminating the term that
describes optical rotation, which requires a proper relation of the RTE to Maxwell’s
equations. Additionally, we show that this procedure does not inﬂue nce the physical
quantities described by the solution. In Section 5we give a conclusion on our work and
discuss some open questions that could be of interest for future r esearch. Lastly, in the
appendix we give some of the tedious proofs of propositions in the pr evious sections.
2. Introduction to the metriplectic formalism
The metriplectic formalism [ 11–13,18–21] provides a framework for the description of
systems that contain both Hamiltonian and dissipative parts. The Ha miltonian part
of the evolution of such a system is determined by a Poisson bracket {·,·}and the
Hamiltonian functional H, which is usually related to the total energy of the system and
which stays constant in time. The dissipative part of the evolution is d etermined byA metriplectic formulation of polarized radiative transfe r 3
a metric bracket ( ·,·) and an entropy functional Sthat evolves monotonically in time.
The purpose of this section is to give an abstract outline of this form alism. Next, we
describe the metriplectic framework in more detail. The presentatio n follows [ 13].
2.1. General framework
LetHbe a Hilbert space of a certain class of functions on a domain D, with an inner
product/a\}b∇acketle{t·,·/a\}b∇acket∇i}ht, and let u∈Hbe a dynamical variable. In the metriplectic formalism the
time evolution of any functional Fofuis given by
dF
dt={F,G}+(F,G), (1)
whereG=H−Sis called the free energy functional, analogous to the Gibbs free
energy from thermodynamics, and HandSare the Hamiltonian and entropy functionals,
respectively. The Poisson bracket, which describes the ideal cons ervative evolution of
the system, is real bilinear, antisymmetric, and satisﬁes Leibniz’s ru le and the Jacobi
identity:
{aA+bB,C}=a{A,C}+b{B,C}, (2)
{A,B}=−{B,A}, (3)
{AB,C}=A{B,C}+{A,C}B, (4)
{{A,B},C}+{{B,C},A}+{{C,A},B}= 0, (5)
for arbitrary functionals A,B,Cofuand real numbers a,b. The Poisson bracket can be
represented via an anti-self adjoint operator J(u) :H→Hby
{A,B}=/angbracketleftbiggδA
δu,J(u)δB
δu/angbracketrightbigg
, (6)
whereδA
δu∈Hdenotes the functional derivative of A, i.e., for any v∈H,
/angbracketleftbiggδA
δu,v/angbracketrightbigg
= lim
ε→01
ε(A[u+εv]−A[u]). (7)
Furthermore, the entropy functional Sis a Casimir invariant of the Poisson bracket,
meaning that for all functionals Ait holds that
{A,S}= 0, (8)
or equivalently J(u)δS
δu= 0. The metric bracket describes the dissipative eﬀects of the
system. It is real bilinear, symmetric and negative semideﬁnite, i.e.,
(aA+bB,C) =a(A,C)+b(B,C), (9)
(A,B) = (B,A), (10)
(A,A)≤0, (11)A metriplectic formulation of polarized radiative transfe r 4
for arbitrary functionals A,B,andCofuand real numbers aandb. The metric bracket
(·,·) has the representation
(A,B) =/angbracketleftbiggδA
δu,K(u)δB
δu/angbracketrightbigg
, (12)
whereK(u) :H→His a self-adjoint operator. Additionally, the Hamiltonian functional
Hhas zero metric bracket with any other functional of u, or equivalently K(u)δH
δu= 0.
From the above-mentioned properties of these brackets it then f ollows that
dH
dt={H,G}+(H,G) ={H,H}= 0, (13)
dS
dt={S,G}+(S,G) =−(S,S)≥0, (14)
reproducing the First and Second Law of Thermodynamics.
3. The radiative transfer equation
The radiative transfer equation can be used to model the propaga tion of light through a
nonhomogeneous medium with many scatterers. We start by introd ucing the radiative
transfer equation in its form frequently encountered in the literat ure and illustrate the
physical meaning of the solution. We then present a suitable Lie brac ket in Section 3.2.
After exploiting the freedom of choosing a basis for the plane perpe ndicular to the
transport direction, we construct the ingredients for the metrip lectic formalism in
Section3.4, which constitute the main results of this paper. Section 3.5discusses
the relation of the metriplectic formulation for the case of unpolariz ed light to the
metriplectic formulation for the scalar radiative transfer equation derived in [ 17]. The
proofs and derivations of the results that follow are deferred to la ter sections and the
appendix.
3.1. Radiative transfer
The radiative transfer equation is a high-frequency limit of the Maxw ell equations
describing the propagation of polarized light. It is given by [ 5,7]
∂W
∂t+∇kω·∇xW −∇ xω·∇kW+ΣW=NW −WN +S(W).(15)
Thesolutiontothisequation W=W(x,k,t) iscalledthecoherence matrixandisa2 ×2
matrix-valuedfunction, depending onposition x∈R3, wave vector k∈R3\{0}andtime
t≥0. The second and third terms on the left-hand side are transport terms describing
the refraction of the light as it propagates through an inhomogene ous medium. The
expressions of the quantities in this equation follow from a proper de rivation of the
RTE from the Maxwell equations [ 7]. The function ω(x,k) =v(x)|k|is the dispersionA metriplectic formulation of polarized radiative transfe r 5
relation, with v(x) = 1//radicalbig
ǫ(x)µ(x) the velocity function, and ǫandµthe scalar local
permittivity and permeability, respectively. The optical rotation ma trixNis given by
N(x,k) =/parenleftigg
0n(x,k)
−n(x,k) 0/parenrightigg
=n(x,k)J, (16)
wheren(x,k) is a scalar function related to the rate of change in linear polarizatio n,
andJis the canonical symplectic matrix
J=/parenleftigg
0 1
−1 0/parenrightigg
.
The coupling term describes the rotation of the polarization plane du e to the torsion of
light rays in an inhomogeneous medium, also known as Rytov’s law [ 22]. The scattering
operator S, given by
(SW)(x,k,t) =/integraldisplay
|k′|=|k|σ(x,k,k′)T(x,k,k′)W(x,k′,t)T(x,k,k′)∗dλ(k′),(17)
describes the redistribution of light over diﬀerent propagation dire ctions and
polarizations. Here σis a positive function that is symmetric in kandk′,λis the
surface measure, and T(x,k,k′) is a real 2 ×2 matrix-valued function that satisﬁes
T(x,k,k′) =T(x,k′,k)∗, where the superscript∗denotes transposition and complex
conjugation. The total scattering rate is described by the scalar function Σ( x,k), which
is given by
Σ(x,k)I2=/integraldisplay
|k′|=|k|σ(x,k,k′)T(x,k,k′)T(x,k,k′)∗dλ(k′), (18)
withI2denoting the 2 ×2 identity matrix. It has been shown that under mild
assumptions on v(x),n(x,k) and Σ( x,k) equation ( 15) is well-posed and that the
solution W(x,k,t) is Hermitian [ 9]. Furthermore, the solution is related to the four
Stokes parameters I,Q,U,V , see [5,7], as
W=1
2/parenleftigg
I+Q U+iV
U−iV I−Q/parenrightigg
. (19)
HereIdenotes the intensity of the light, QandUdescribe diﬀerent modes of linear
polarization, and Vis related to the amount of circular polarization.
There are two major challenges for forming a metriplectic formulatio n of the
radiative transfer equation as stated in ( 15). First, the advective term ∇kω· ∇xW −
∇xω·∇kWcombines the scalar-valued function ωwith the matrix-valued solution W,
while the metriplectic formalism requires a pairing, i.e., a bracket, for t wo matrix-valued
functions. Second, the optical rotation term Nmakes it diﬃcult to construct a Poisson
bracket, i.e., a bracket that enjoys the Jacobi identity. In the ne xt two subsections we
address these challenges.A metriplectic formulation of polarized radiative transfe r 6
3.2. A Lie bracket for matrix-valued functions
Denote by σifori= 1,2,3 the normalized Pauli-matrices
σ1=1√
2/parenleftigg
0 1
1 0/parenrightigg
,σ2=1√
2/parenleftigg
0−i
i0/parenrightigg
,σ3=1√
2/parenleftigg
1 0
0−1/parenrightigg
.
Together with the identity matrix σ0=I2/√
2 these matrices form a basis for the real
vector space of 2 ×2 Hermitian matrices. It holds that
tr (σjσk) =δj,k,forj,k∈ {0,1,2,3}.
Hence, any 2 ×2 Hermitian matrix can be decomposed as
W=3/summationdisplay
j=0Wjσj,withWj= tr (Wσj)∈R.
For suﬃciently smooth 2 ×2 Hermitian matrix-valued functions U,Vwe deﬁne the
bracket
[U,V]M=3/summationdisplay
j=0[Uj,Vj]σj, (20)
where [·,·] is the canonical Poisson bracket given by
[f,g] =∇xf·∇kg−∇kf·∇xg (21)
for suﬃciently smooth functions f,g. When U= Ω =/summationtext3
j=0ωσjandV=W, this
bracket gives the transport term in ( 15), i.e.,
[Ω,W]M=3/summationdisplay
j=0[ω,Wj]σj=∇xω·∇kW −∇ kω·∇xW,
where we use the subscript Mto emphasize that the bracket acts on matrix-valued
functions. Furthermore, thefollowingpropertieshold, makingthis bracket aLiebracket.
Proposition 1. For suﬃciently smooth 2×2matrix-valued functions U,V,W, the
bracket deﬁned in (20)is bilinear, anti-symmetric and satisﬁes the Jacobi identi ty
[[U,V]M,W]M+[[V,W]M,U]M+[[W,U]M,V]M= 0. (22)
Proof.See the proof in the appendix.A metriplectic formulation of polarized radiative transfe r 7
3.3. Removal of the optical rotation term N
Fromthederivationoftheradiativetransferequationin[ 7]itcanbeseenthattheoptical
rotationtermdepends onachoice of anorthonormalbasis forthe planeperpendicular to
the vector k. There is freedom in choosing this basis and diﬀerent choices give diﬀe rent
values of the optical rotation term. Furthermore, there exists a speciﬁc choice of basis
that eliminates the optical rotation term completely [ 7,23]. We recall the procedure of
ﬁnding this basis in Section 4and show that this choice does not inﬂuence the physical
relevance of the solution W, which is contained in certain expressions in terms of the
Stokes parameters. Using this basis, and the bracket introduced in (20), the radiative
transfer equation is given by
∂W
∂t= [Ω,W]M+S(W)−ΣW, (23)
which is the form we employ for constructing our metriplectic formula tion in the
following. Let us note that the matrix T(x,k,k′) depends on the choice of basis as
well, but that the structural properties of the corresponding S(W) and Σ used in the
metriplectic formulation in ( 23) are still of the form given in ( 17) and (18), independent
of the choice of this basis, see Remark 7below.
3.4. Constructing the metriplectic formulation
We consider the radiative transfer equation on the domain ( x,k)∈D=R3×R3\{0}.
LetHdenote the space of 2 ×2 Hermitian matrices and let L2(D,H) be the Lebesgue
space of square-integrable functions from DtoH, equipped with the inner product
/a\}b∇acketle{tU,V/a\}b∇acket∇i}ht=/integraldisplay
DTr(UV) dxdk. (24)
Thisisthenaturalspacetoconsiderforthemetriplecticformulatio nsince, forsuﬃciently
smooth initial data, equation ( 23) has a unique solution W ∈C1([0,T],L2(D,H)) such
that [Ω,W]M∈C0([0,T];L2(D,H)) [9].
By multiplying equation ( 23) from the left with U ∈C∞
0(D,H), taking the trace
and integrating over Dwe obtain the equation
/angbracketleftbigg
U,∂W
∂t/angbracketrightbigg
=/angbracketleftig
U,[Ω,W]M/angbracketrightig
−/angbracketleftig
U(x,k),Σ(x,k)W(x,k)/angbracketrightig
+/angbracketleftbigg
U(x,k),/integraldisplay
|k|=|k′|σ(x,k,k′)T(x,k,k′)W(x,k′,t)T(x,k′,k)dk′/angbracketrightbigg
.
By applying integration by parts to the term /a\}b∇acketle{tU,[Ω,W]M/a\}b∇acket∇i}htand observing that boundary
terms vanish due to the compact support of U, we deduce that
d
dt/angbracketleftig
U,W/angbracketrightig
=/angbracketleftig
W,[U,Ω]M/angbracketrightig
−/angbracketleftig
U(x,k),Σ(x,k)W(x,k)/angbracketrightig
+/angbracketleftbigg
U(x,k),/integraldisplay
|k|=|k′|σ(x,k,k′)T(x,k,k′)W(x,k′,t)T(x,k′,k)dk′/angbracketrightbigg
.(25)A metriplectic formulation of polarized radiative transfe r 8
The ﬁrst term on the right-hand side of this equation is antisymmetr ic inUand Ω and
it is thus natural to deﬁne the bracket
{A,B}=/integraldisplay
DTr/parenleftbigg
W/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M/parenrightbigg
dxdk. (26)
HereδA
δWis the functional derivative as deﬁned in ( 7). By applying the Fubini theorem
to the last two terms on the right-hand side of equation ( 25) it can be seen that they
are symmetric in UandWand thus it is natural to deﬁne the bracket that describes
these terms by
(A,B) =1
2/integraldisplay
D/integraldisplay
|k|=|k′|σ(x,k,k′)Tr/bracketleftigg/parenleftbigg
T(x,k,k′)δA
δW′−δA
δWT(x,k,k′)/parenrightbigg
·/parenleftbigg
T(x,k′,k)δB
δW−δB
δW′T(x,k′,k)/parenrightbigg/bracketrightigg
dk′dkdx.(27)
HereδA
δW′denotes the evaluation ofδA
δWin (x,k′). Using these brackets, equation ( 25)
takes the form
dFU
dt={FU,H}−(FU,S), (28)
with the functionals
FU[W] =/integraldisplay
DTr(UW) dxdk, (29)
H[W] =/integraldisplay
DTr(ΩW) dxdk, (30)
S[W] =−1
2/integraldisplay
DTr/parenleftbig
W2/parenrightbig
dxdk. (31)
In the above, the functional derivatives are taken with respect t o the inner product
deﬁned in ( 24). It can be shown that the bracket in ( 26) is a Poisson bracket:
Proposition 2. For suﬃciently smooth functionals A,B,CofW, the bracket in (26)is
bilinear, antisymmetric. Additionally, it satisﬁes Leibn iz’s rule
{AB,C}=A{B,C}+{A,C}B,
and the Jacobi identity
{{A,B},C}+{{B,C},A}+{{C,A},B}= 0.
Proof.Bilinearity and antisymmetry of this bracket follow directly from the p roperties
of the bracket in ( 20). Furthermore, the Leibniz rule follows from the product rule for
functional derivatives
δAB
δW=AδB
δW+δA
δWB.
The Jacobi identity followsfromthe Jacobi identity for [ ·,·]Mand theprocedure given in
[24, p. 612]. For self-containedness we prove the Jacobi identity in th e appendix.A metriplectic formulation of polarized radiative transfe r 9
Similarly it can be shown that ( 27) deﬁnes a metric bracket:
Proposition 3. The bracket in (27)is bilinear, symmetric, and negative semideﬁnite.
Proof.The bracket in ( 27) is clearly bilinear. Symmetry follows by applying the Fubini
theorem to the kandk′integrals and relabeling the variables kandk′. Furthermore,
negative-semideﬁniteness of the bracket has been shown in [ 9, Proposition 4.5].
The ﬁnal step in the construction of the metriplectic formulation of the RTE
is to verify that HandSdeﬁned in ( 30) and (31), respectively, are Casimirs of the
corresponding brackets, which is established next.
Proposition 4. The entropy functional Sis a Casimir of the Poisson bracket and the
Hamiltonian functional His a Casimir of the metric bracket.
Proof.The proof can be found in the appendix.
Employing Proposition 4, equation ( 28) can be written as
dFU
dt={FU,G}+(FU,G) (32)
with the free energy functional
G[W] =H[W]−S[W]. (33)
These brackets provide a proper metriplectic formulation of the ra diative transfer
equation with conservation of the Hamiltonian and dissipation of the e ntropy following
as in Section 2.
Remark 5. We note that in the vacuum case, i.e., σ= 0andvconstant, the metric
bracket in (27)vanishes, and equation (32)contains only Hamiltonian dynamics.
Furthermore, we can consider the diﬀusion limit, which is va lid for propagation distances
that are large compared to the mean free path v(x)/Σ. In this limit the trace of
W(x,k,t)converges, for constant v, to a scalar function φ(x,r,t)satisfying the diﬀusion
equation [ 7, (5.29)]
∂φ
∂t=∇x·(D∇xφ),
with diﬀusion coeﬃcient D(x,r)>0. This can be described as a purely dissipative
system
∂F
∂t= (F,GD)D,
with metric bracket
(A,B)D=−/integraldisplay
R3/integraldisplay∞
0D∇xδA
δφ·∇xδB
δφdxr2dr,
and a free energy functional GD=HD−SD, with
HD[φ] =/integraldisplay
R3/integraldisplay∞
0φdxr2dr,SD[φ] =−1
2/integraldisplay
R3/integraldisplay∞
0φ2dxr2dr.A metriplectic formulation of polarized radiative transfe r 10
3.5. Scalar radiative transfer
If we consider only unpolarized light, the Stokes parameters Q,UandVare identically
zero and the coherence matrix can be written as
W(x,k,t) =1
2/parenleftigg
I(x,k,t) 0
0I(x,k,t)/parenrightigg
.
In this case equation ( 23) reduces to the scalar radiative transfer equation for the
intensity Iby taking traces, i.e.,
∂I
∂t+[I,ω] =/integraldisplay
|k|=|k′σ′(x,k,k′)I(x,k′,t)dk′−Σ′(x,k)I(x,k,t),(34)
with
σ′(x,k,k′) =1
2σ(x,k,k′)Tr[T(x,k,k′)T(x,k′,k)],
Σ′(x,k) =/integraldisplay
|k|=|k′|σ′(x,k,k′)dk′.
In this case the functionals ( 30), (31) and (33) reduce to
H[W] =/integraldisplay
DTr(ΩW) dxdk=/integraldisplay
Dω(x,k)I(x,k,t)dxdk=˜H[I], (35)
S[W] =−1
2/integraldisplay
DTr/parenleftbig
W2/parenrightbig
dxdk=−1
4/integraldisplay
DI2dxdk=˜S[I], (36)
˜G[I] =˜H[I]−˜S[I]. (37)
Similarly, setting U=ϕI2forϕ∈C∞
0(D), the functional FUdeﬁned in equation ( 29)
reduces to
FU[W] =/integraldisplay
DTr(UW) dxdk=/integraldisplay
Dϕ(x,k)I(x,k,t)dxdk=˜Fϕ[I].(38)
Here,δ˜F[I]
δIdenotes the functional derivative w.r.t. the usual L2-inner product on D. In
the case of unpolarized light the brackets in ( 26) and (27) reduce to
{A,B}s=/integraldisplay
DI/bracketleftbiggδA
δI,δB
δI/bracketrightbigg
dxdk, (39)
(A,B)s=/integraldisplay
Dσ′(x,k,k′)/parenleftbiggδA
δI−δA
δI′/parenrightbigg/parenleftbiggδB
δI′−δB
δI/parenrightbigg
dk′dkdx, (40)
and the metriplectic formulation of ( 34) becomes
d˜Fϕ
dt=/braceleftbig˜Fϕ,˜G/bracerightbig
s+/parenleftbig˜Fϕ,˜G/parenrightbig
s,
which is in full agreement with the formulation derived in [ 17].A metriplectic formulation of polarized radiative transfe r 11
4. Optical rotation
This section is concerned with the procedure of eliminating the optica l rotation term in
equation ( 15). For the convenience of the reader we ﬁrst recall the key aspec ts of the
derivation of the radiative transfer equation from Maxwell’s equatio ns and discuss the
physical meaning of the solution.
4.1. Derivation of the radiative transfer equation from Max well’s equation
Following [ 7], equation ( 15) can be derived from a transformation of the Maxwell
equations for the electric ﬁeld Eand the magnetic ﬁeld H:
/parenleftigg
ǫ0
0µ/parenrightigg
∂
∂t/parenleftigg
E
H/parenrightigg
+/parenleftigg
0−∇×
∇×0/parenrightigg/parenleftigg
E
H/parenrightigg
= 0. (41)
Using the vector u=/parenleftigg
E
H/parenrightigg
this equation can be cast into the standard form of a
symmetric ﬁrst-order hyperbolic system
A(x)∂u
∂t+3/summationdisplay
i=1Di∂u
∂xi= 0. (42)
In the procedure of deriving the RTE, the limiting Wigner matrix W(0)is deﬁned as a
high-frequency Wigner transformation of u:
W(0)(x,k,t) = lim
ε→0/parenleftbigg1
2π/parenrightbigg3/integraldisplay
R3eik·yu(t,x−1
2εy)u(t,x+1
2εy)∗dy. (43)
Since the electric and magnetic ﬁelds corresponding to a light wave alw ays lie in the
plane perpendicular to the direction of propagation ˆk=k/|k|. They are respectively
normal and binormal vectors to ˆk. By choosing a pair of orthonormal vectors/braceleftbig
z(1)(x,k),z(2)(x,k)/bracerightbig
thatspantheplaneperpendicularto ˆk,thelimitingWignermatrix
can be expanded as
W(0)(x,k,t) =2/summationdisplay
i,j=1a+
ijBi,j
++a−
ijBi,j
−=2/summationdisplay
i,j=1a+
ijb(i)
+b(j)T
++a−
ijb(i)
−b(j)T
−,
with
b(1)
+(x,k) =/parenleftigg/radicalbigg
1
2ǫz(1),/radicalbigg
1
2µz(2)/parenrightigg
, b(2)
+(x,k) =/parenleftigg/radicalbigg
1
2ǫz(2),−/radicalbigg
1
2µz(1)/parenrightigg
,
b(1)
−(x,k) =/parenleftigg/radicalbigg
1
2ǫz(1),−/radicalbigg1
2µz(2)/parenrightigg
, b(2)
−(x,k) =/parenleftigg/radicalbigg
1
2ǫz(2),/radicalbigg1
2µz(1)/parenrightigg
.A metriplectic formulation of polarized radiative transfe r 12
Here the + and −indicate right and left propagation modes, respectively. Furtherm ore,
the matrices Bi,j
±are orthonormal in the following sense
Tr/parenleftig
ABi,j
sABk,l
t/parenrightig
=δi,kδj,lδs,t.
Therefore, the coeﬃcients a±
i,j(x,k,t) can be determined as
a±
ij= Tr/parenleftbig
AW(0)∗ABij
±/parenrightbig
.
By symmetry (see [ 7] for the full details) the left propagating modes can be derived
from the right propagation modes, so we are only interested in the p art
W(0)
+(x,k,t) =2/summationdisplay
i,j=1a+
ijBij
+.
The expansion coeﬃcients a+
ij(x,k,t) determine the coherence matrix:
Wi,j(x,k,t) =a+
ij(x,k,t). (44)
The coherence matrix then satisﬁes ( 15) with the optical rotation term given by
Nmn(x,k) =/parenleftigg
b(n)
+,Di∂b(m)
+
∂xi/parenrightigg
−∂ω
∂xi/parenleftigg
A(x)b(n)
+,∂b(m)
+
∂ki/parenrightigg
−1
2∂2ω
∂xi∂kiδnm,(45)
where (·,·) denotes the inner product
(u,v) =6/summationdisplay
i=1ui(x,k)vi(x,k).
From this derivation we can conclude that both the coherence matr ixWand the optical
rotation matrix Ndepend on the choice of basis/braceleftbig
z(1)(x,k),z(2)(x,k)/bracerightbig
of the plane
perpendicular to ˆk. However, many quantities derived from Ware independent of this
choice:
Theorem 6. LetI,Q,U,V be the Stokes parameter components of Win the basis
determined by the vectors z(1)(x,k)andz(2)(x,k)as deﬁned in (19). Then for any
continuous function f:R3→Rit holds that f(I,Q2+U2,V)is invariant under a
rotation of z(1)(x,k)andz(2)(x,k)in the plane perpendicular to ˆk.
Proof.It suﬃces to show that the quantities I,VandQ2+U2are independent under
rotations of the basis. Under a rotation of angle θ(x,k) in the plane perpendicular to ˆk
the vectors z(1)(x,k) andz(2)(x,k) transform into vectors z(1)′(x,k) andz(2)′(x,k) as
z(1)′(x,k) = cos(θ)z(1)+sin(θ)z(2),
z(2)′(x,k) =−sin(θ)z(1)+cos(θ)z(2).A metriplectic formulation of polarized radiative transfe r 13
To simplify the notation we write the indices as ( B11
+,B12
+,B21
+,B22
+) = (B1
+,B2
+,B3
+,B4
+)
and (a+
11,a+
12,a+
21,a+
22) = (a+
1,a+
2,a+
3,a+
4). From the above transformation rule and the
deﬁnition of the corresponding matrices Bi
+andBi′
+, we obtain the relation

B1′
+
B2′
+
B3′
+
B4′
+
= (R⊗I6)
B1
+
B2
+
B3
+
B4
+
,
with the matrix
R=
cos2θcosθsinθcosθsinθsin2θ
−sinθcosθcos2θ−sin2θsinθcosθ
−sinθcosθ−sin2θcos2θsinθcosθ
sin2θ−sinθcosθ−sinθcosθcos2θ
.
The limiting Wigner matrix, however, is by deﬁnition independent of the choice of the
basis and can be expanded in the transformed basis as
W(0)(x,k,t) =4/summationdisplay
ia+′
iBi′
++a−′
iBi′
−.
Then the coeﬃcients a+′
i(x,k,t) are determined by
a+′
i= Tr/parenleftig
AW(0)∗ABi′
+/parenrightig
= Tr/parenleftig
AW(0)∗
+ABi′
+/parenrightig
=4/summationdisplay
k,l=1a+
kRi,lTr/parenleftbig
ABk
+ABl
+/parenrightbig
=4/summationdisplay
k,l=1a+
kRi,lδk,l=4/summationdisplay
k=1Ri,ka+
k.
The Stokes parameters after the transformation are deﬁned as , cf. (19) and (44),
I′=a+′
1+a+′
4, Q′=a+′
1−a+′
4
U′=a+′
2+a+′
3, V′=1
i(a+′
2−a+′
3),
the transformation law for the Stokes parameters can then be wr itten as

I′
Q′
U′
V′
=
1 0 0 0
0 cos(2 θ) sin(2 θ) 0
0−sin(2θ) cos(2θ) 0
0 0 0 1

I
Q
U
V
.
The theorem then follows immediately from this transformation law.A metriplectic formulation of polarized radiative transfe r 14
4.2. Eliminating the optical rotation term
Now that we know how equation ( 15) transforms under a change of basis/braceleftbig
z(1)(x,k),z(2)(x,k)/bracerightbig
, we will next construct a particular basis such that the optical
rotation matrix Ndeﬁned in ( 45) vanishes.
It can be seen that the third term on the right side of equation ( 45) is a diagonal
term. This term does not aﬀect equation ( 15) sinceNenters there in a commutator. It
wasaddedin[ 7]forconvenience becauseitcancelstheﬁrsttermontheright-ha ndsideof
(45) when the basis functions z(1)(x,k) andz(2)(x,k) are chosen as a pair of orthonormal
vectors perpendicular to the vectors ˆk. Hence, by expanding the remaining term in ( 45),
it can be seen that
Nij(x,k) =−1
22/summationdisplay
l,m=1(δjlδim+ǫjlǫim)z(l)(x,k)·(∇xv(x)·∇k)z(m)(x,k),
withǫijthe Levi-Civita symbol. Since z(1)(x,k) andz(2)(x,k) must be perpendicular to
ˆk, the rotation term vanishes if both∂z(1)
∂sand∂z(2)
∂sare parallel to ˆk, with the material
derivative∂
∂sgiven by
∂
∂s:= (∇xv(x)·∇k).
To construct these vectors we follow the procedure in [ 23]. We ﬁrst construct a Frenet-
Serret frame ( T,N,B), with the tangent vector T=ˆkand the normal vector Nand
binormal vector Bdeﬁned by
N:=1
κ∂T
∂s, B:=T×N,
which satisfy the equations
∂N
∂s=−κT+τB,∂B
∂s=−τN,
withκ=|∂T
∂s|the curvature and τthe torsion of the curve. The vectors NandBare
themselves not the correct choice of basis, but from the Frenet- Serret frame ( T,N,B)
we can construct a Darboux frame ( T,P,Q) as
P:= cosαN+sinαB,
Q:=−sinαN+cosαB,
and by choosing αsuch that∂α
∂s=−τit holds that
∂P
∂s=−κcosαT,
∂Q
∂s=κsinαT.
Since (T,P,Q) forms an orthonormal triplet and∂P
∂sand∂Q
∂sare parallel to ˆk, we can
choosez(1)(x,k) =Pandz(2)(x,k) =Qto make the optical rotation term vanish and
obtain equation ( 23).A metriplectic formulation of polarized radiative transfe r 15
Remark 7. Following the derivation of the RTE in [ 7], the scattering matrix Tis
deﬁned as Tij(x,k,k′) =z(i)(x,k)·z(j)(x,k′). From this expression, it can be seen that
after any rotation of the basis vectors, the rotated scatter ing matrix ˜Tstill satisﬁes
˜T(x,k,k′) =˜T(x,k′,k)∗, and the corresponding RTE can be written as in (23), with
S(W)andΣsatisfying equations (17)and(18), respectively, with the rotated scattering
matrix.
5. Conclusion and Discussion
In this paper, we constructed a metriplectic formulation of the rad iative transfer
equation with polarization by constructing a suitable matrix extensio n of the canonical
Poisson bracket and by deﬁning a suitably rotating basis for the pola rization plane that
eliminates the optical rotation term in the equations. In particular, this choice of basis
allowed us to show that the antisymmetric bracket deﬁned in ( 26) satisﬁes the Jacobi
identity. If a basis is chosen such that the optical rotation term Ndoes not vanish,
we were able to derive several almost-Poisson brackets, which are not shown here, i.e.,
antisymmetric bilinear forms that do not satisfy the Jacobi identity . Therefore, we
postulate the following conjecture:
Conjecture 8. It is not possible to construct a metriplectic formulation o f the radiative
transfer equation in any basis of the polarization plane tha t does not eliminate the optical
rotation term.
A heuristic argument supporting this conjecture is Rytov’s law [ 22], which may be
seen as a non-holonomic constraint, and that Hamiltonian systems w ith non-holonomic
constraints can only be described by an almost-Poisson bracket th at does not satisfy
the Jacobi identity [ 25].
In this manuscript, we considered the domain D=R3×R3\ {0}without any
boundary conditions. In future work, boundary conditions, which are relevant for
multi-physics problems or control applications, may be treated by c onsidering the port-
Hamiltonian formalism [ 26,27].
Finally, let us mention that the metriplectic formulation can be used to construct
discretizations that (automatically) preserve energy and dissipat e entropy also on the
discrete level, see [ 14–16] for works in this direction.
Acknowledgments
VB and MS acknowledge support by the Dutch Research Council (NW O) via the
Mathematics Clusters grant no. 613.009.133.
Appendix
Proof of Proposition 1: For suﬃciently regular 2×2matrix-valued functions U,V,W
the bracket [·,·]Mdeﬁned in (20)is bilinear, anti-symmetric and satisﬁes the JacobiA metriplectic formulation of polarized radiative transfe r 16
identity.
[[U,V]M,W]M+[[V,W]M,U]M+[[W,U]M,V]M= 0.
Proof.For suﬃciently smooth matrix-valued functions U,Vlet us recall the deﬁnition
of the bracket [ ·,·]Mgiven in ( 20), i.e.,
[U,V]M=3/summationdisplay
j=0[Uj,Vj]σj.
Bilinearity and anti-symmetry of the bracket follow directly from biline arity and anti-
symmetry of the canonical Poisson-bracket [ ·,·] given in ( 21). The Jacobi identity
follows, since
[[U,V]M,W]M+[[V,W]M,U]M+[[W,U]M,V]M
=3/summationdisplay
j=0([[Uj,Vj],Wj]+[[Vj,Wj],Uj]+[[Wj,Uj],Vj])σj= 0,
where we used in the last step that the canonical Poisson bracket [ ·,·]satisﬁes the Jacobi
identity.
Complement to the proof of Proposition 2: For suﬃciently smooth functionals
A,B,CofW, the bracket deﬁned in (26)satisﬁes the Jacobi identity.
{{A,B},C}+{{B,C},A}+{{C,A},B}= 0.
Proof.We adapt the steps presented in [ 24, pp. 571-572] to our situation. We will
denote the L2(D,H) inner product as /a\}b∇acketle{t·,·/a\}b∇acket∇i}ht; see also ( 24). For the ﬁrst derivative of a
functional Ait holds that:
DA[W](U) = lim
ε→01
ε(A[W+εU]−A[W]) =/angbracketleftbiggδA
δW[W],U/angbracketrightbigg
.
We recall also the deﬁnition of the second derivative of a functional A, denoted D2A. For
ﬁxedW,D2A[W] is a bilinear map in perturbations U,VofWdeﬁned as the derivative
ofDA[W](U), i.e.,
D2A[W](U,V) = lim
ε→01
ε(DA[W+εV](U)−DA[W](U))
= lim
ε→01
ε/parenleftbigg/angbracketleftbiggδA
δW[W+εV],U/angbracketrightbigg
−/angbracketleftbiggδA
δW[W],U/angbracketrightbigg/parenrightbigg
=/angbracketleftbiggδ2A
δW2[W](V),U/angbracketrightbigg
That is,δ2A
δW2[W](V)∈L2(D,H) represents D2A[W](·,V). For simplicity, we will
henceforth drop the explicit dependency on W, i.e., we writeδ2A
δW2(V) instead of
δ2A
δW2[W](V).A metriplectic formulation of polarized radiative transfe r 17
The derivative of the Poisson bracket evaluated in Win direction Vis computed
using the product rule
/angbracketleftbiggδ{A,B}
δW,V/angbracketrightbigg
=D{A,B}(V) =D/angbracketleftbigg
W,/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M/angbracketrightbigg
(V)
=/angbracketleftbigg
V,/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M/angbracketrightbigg
+/angbracketleftbigg
W,/bracketleftbiggδ2A
δW2(V),δB
δW/bracketrightbigg
M/angbracketrightbigg
+/angbracketleftbigg
W,/bracketleftbiggδA
δW,δ2B
δW2(V)/bracketrightbigg
M/angbracketrightbigg
.
In order to simplify the second and the third term, we introduce the unbounded adjoint
operator ad( X) deﬁned by ad( X)[Y] = [X,Y]Mand its dual operator ad( X)∗, deﬁned
by
/a\}b∇acketle{tad(X)∗U,Y/a\}b∇acket∇i}ht=/a\}b∇acketle{tU,[X,Y]M/a\}b∇acket∇i}ht,
for suﬃciently smooth Y,U. Using the adjoint and its dual, as well as the deﬁnition of
the second functional derivative, we obtain the following identities
/angbracketleftbigg
W,/bracketleftbiggδ2A
δW2(V),δB
δW/bracketrightbigg
M/angbracketrightbigg
=−/angbracketleftbigg
ad/parenleftbiggδB
δW/parenrightbigg∗
W,δ2A
δW2(V)/angbracketrightbigg
=−D2A/parenleftbigg
V,ad/parenleftbiggδB
δW/parenrightbigg∗
W/parenrightbigg
,
/angbracketleftbigg
W,/bracketleftbiggδA
δW,δ2B
δW2(V)/bracketrightbigg
M/angbracketrightbigg
=/angbracketleftbigg
ad/parenleftbiggδA
δW/parenrightbigg∗
W,δ2B
δW2(V)/angbracketrightbigg
=D2B/parenleftbigg
V,ad/parenleftbiggδA
δW/parenrightbigg∗
W/parenrightbigg
,
where we also used the symmetry of the second derivative. Collectin g the terms, we
identify
δ{A,B}
δW=/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M−δ2A
δW2/parenleftbigg
ad/parenleftbiggδB
δW/parenrightbigg∗
W/parenrightbigg
+δ2B
δW2/parenleftbigg
ad/parenleftbiggδA
δW/parenrightbigg∗
W/parenrightbigg
.
Consequently, we can evaluate
{{A,B},C}=/angbracketleftbigg
W,/bracketleftbiggδ{A,B}
δW,δC
δW/bracketrightbigg
M/angbracketrightbigg
=/angbracketleftbigg
W,/bracketleftbigg/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M,δC
δW/bracketrightbigg
M/angbracketrightbigg
−/angbracketleftbigg
W,/bracketleftbiggδ2A
δW2/parenleftbigg
ad/parenleftbiggδB
δW/parenrightbigg∗
W/parenrightbigg
,δC
δW/bracketrightbigg
M/angbracketrightbigg
+/angbracketleftbigg
W,/bracketleftbiggδ2B
δW2/parenleftbigg
ad/parenleftbiggδA
δW/parenrightbigg∗
W/parenrightbigg
,δC
δW/bracketrightbigg
M/angbracketrightbigg
=/angbracketleftbigg
W,/bracketleftbigg/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M,δC
δW/bracketrightbigg
M/angbracketrightbigg
+/angbracketleftbigg
ad/parenleftbiggδC
δW/parenrightbigg∗
W,δ2A
δW2/parenleftbigg
ad/parenleftbiggδB
δW/parenrightbigg∗
W/parenrightbigg/angbracketrightbigg
−/angbracketleftbigg
ad/parenleftbiggδC
δW/parenrightbigg∗
W,δ2B
δW2/parenleftbigg
ad/parenleftbiggδA
δW/parenrightbigg∗
W/parenrightbigg/angbracketrightbigg
=/angbracketleftbigg
W,/bracketleftbigg/bracketleftbiggδA
δW,δB
δW/bracketrightbigg
M,δC
δW/bracketrightbigg
M/angbracketrightbigg
+D2A/parenleftbigg
ad/parenleftbiggδB
δW/parenrightbigg∗
W,ad/parenleftbiggδC
δW/parenrightbigg∗
W/parenrightbigg
−D2B/parenleftbigg
ad/parenleftbiggδA
δW/parenrightbigg∗
W,ad/parenleftbiggδC
δW/parenrightbigg∗
W/parenrightbigg
Summing up the cycling permutations of the previous expression and using the fact that
[·,·]MsatisﬁestheJacobiidentity, veriﬁes theJacobiidentityfortheP oissonbracket.A metriplectic formulation of polarized radiative transfe r 18
Proof of proposition 4: The entropy functional Sdeﬁned in (31)is a Casimir of the
Poisson bracket given in (26)and the Hamiltonian functional Hin(30)is a Casimir of
the metric bracket in (27).
Proof.To show that Sisa Casimir invariant ofthe Poisson bracket, notethatδS
δW=−W
and take an arbitrary functional FU[W] with functional derivativeδFU
δW=U. The Poisson
bracket acting on these two functionals is then given by
−{FU,S}=/integraldisplay
DTr(W[U,W]M) dxdk
=/integraldisplay
DTr/parenleftigg3/summationdisplay
i=03/summationdisplay
j=0Wi[Uj,Wj]σiσj/parenrightigg
dxdk
=3/summationdisplay
j=0/integraldisplay
D(Wj[Uj,Wj]) dxdk
=3/summationdisplay
j=0/integraldisplay
D(Uj[Wj,Wj]) dxdk= 0,
where the last step follows from integration by parts, and the brac ket vanishes due to
the anti-symmetry of the canonical Poisson bracket.
To show that His a Casimir invariant of the metric bracket, note thatδH
δW= Ω.
Which depends on konly as|k|. Since in the metric bracket, these functional derivatives
are integrated over the sphere |k|=|k′|these terms cancel and the metric bracket
vanishes.
References
[1] Hansen J E and Hovenier J W 1974 Journal of the Atmospheric Sciences 31(4) 1137–1160 ISSN
0022-4928 URL https://doi.org/10.1175/1520-0469(1974)031<1137:IOT POV>2.0.CO;2
[2] van Diedenhoven B, Hasekamp O P and Landgraf J 2006 Applied Optics 45(23) 5993 ISSN 0003-
6935 URL https://doi.org/10.1364/AO.45.005993
[3] He C, He H, Chang J, Chen B, Ma H and Booth M J 2021 Light: Science and Applications 10(1)
194 ISSN 2047-7538 URL https://doi.org/10.1038/s41377-021-00639-x
[4] Zhu Z, Zhang D, Xie F, Ma J, Chen J, Gong S, Wu W, Cai W, Zhang X, R en M and Xu J 2022
Optica9(11) 1297 ISSN 2334-2536 URL https://doi.org/10.1364/OPTICA.471177
[5] Chandrasekhar S 1960 Radiative Transfer (Dover Publications)
[6] Papanicolaou G C and Burridge R 1975 Journal of Mathematical Physics 16(10) 2074–2085 ISSN
0022-2488 URL https://doi.org/10.1063/1.522422
[7] Ryzhik L, Papanicolaou G and Keller J B 1996 Wave Motion 24(4) 327–370 ISSN 01652125 URL
https://doi.org/10.1016/S0165-2125(96)00021-2
[8] Dautray R and Lions J L 1993 Mathematical Analysis and Numerical Methods for Science an d
Technology, Evolution Problems II vol 6 (Berlin: Springer)
[9] Bosboom V, Schlottbom M and Schwenninger F 2022 ArXiv Preprint URL
http://arxiv.org/abs/2203.03233
[10] Lewis E E and Miller Jr W F 1984 Computational Methods of Neutron Transport (New York
Chichester Brisbane Toronto Singapore: John Wiley & Sons, Inc.)A metriplectic formulation of polarized radiative transfe r 19
[11] Morrison P J 1984 Physics Letters A 100(8) 423–427 ISSN 03759601 URL
https://doi.org/10.1016/0375-9601(84)90635-2
[12] Morrison P J 1984 Some observations regarding brackets and d issipation Tech. Rep. PAM–228
University of California, Berkeley
[13] Morrison P J 1986 Physica D: Nonlinear Phenomena 18(1-3) 410–419 ISSN 01672789 URL
https://doi.org/10.1016/0167-2789(86)90209-5
[14] Suzuki Y and Ohnawa M 2016 Journal of Computational and Applied Mathematics 296690–708
[15] Kraus M and Hirvijoki E 2017 Physics of Plasmas 24(10) 102311 ISSN 1070-664X URL
https://doi.org/10.1063/1.4998610
[16] Hirvijoki E 2021 Plasma Physics and Controlled Fusion 63044003
[17] Schlottbom M 2021 Towards a metriplectic structure for radiat ive transfer equations pp 24–26
URLhttps://doi.org/10.4171/owr/2021/16
[18] Kaufman A N and Morrison P J 1982 Physics Letters A 88(8) 405–406 ISSN 03759601 URL
https://doi.org/10.1016/0375-9601(82)90664-8
[19] Kaufman A N 1984 Physics Letters A 100(8) 419–422 ISSN 03759601 URL
https://doi.org/10.1016/0375-9601(84)90634-0
[20] Grmela M 1984 Physics Letters A 102(8) 355–358 ISSN 03759601 URL
https://doi.org/10.1016/0375-9601(84)90297-4
[21] Grmela M 1985 Physics Letters A 111(1-2) 36–40 ISSN 03759601 URL
https://doi.org/10.1016/0375-9601(85)90797-2
[22] Vinitski˘ ı S I, Derbov V L, Dubovik V M, Markovski B L and Stepa novski˘ ı
Y P 1990 Soviet Physics Uspekhi 33(6) 403–428 ISSN 0038-5670 URL
https://dx.doi.org/10.1070/PU1990v033n06ABEH002598
[23] Lewis R 1966 IEEE Transactions on Antennas and Propagation 14(1) 100–101 ISSN 0096-1973
URLhttps://doi.org/10.1109/TAP.1966.1138610
[24] Abraham R, Marsden J E and Ratiu T 1988 Manifolds, Tensor Analysis, and
Applications 2nd ed vol 75 (Springer New York) ISBN 978-1-4612-6990-8 URL
https://link.springer.com/book/10.1007/978-1-4612-1 029-0
[25] der Schaft A V and Maschke B 1994 Reports on Mathematical Physics 34(2) 225–233 ISSN
00344877 URL https://doi.org/10.1016/0034-4877(94)90038-8
[26] van der Schaft A 2007Port-hamiltoniansystems: an introduct ory survey (European Mathematical
Society Publishing House) pp 1339–1365 URL https://doi.org/10.4171/022-3/65
[27] van der Schaft A and Jeltsema D 2014 Foundations and Trends in Systems and Control 1(2)
173–378 ISSN 2325-6818 URL http://dx.doi.org/10.1561/2600000002