arXiv:2304.07561v2  [cs.IT]  24 Jun 20231
N-Sum Box: An Abstraction for Linear
Computation over Many-to-one Quantum Networks
Matteo Allaix∗, Yuxiang Lu†, Yuhang Yao†, Tefjol Pllaha‡, Camilla Hollanti∗, Syed Jafar†
∗Aalto University, Finland. E-mails: {matteo.allaix, cami lla.hollanti}@aalto.ﬁ†University of California, Irvine, CA, USA.
E-mails: {yuxiang.lu, yuhangy5, syed}@uci.edu‡University of Nebraska, Lincoln, NE, USA. E-mail: tefjol.p llaha@unl.edu
Abstract
Linear computations over quantum many-to-one communicati on networks offer opportunities for communication
cost improvements through schemes that exploit quantum ent anglement among transmitters to achieve superdense
coding gains, combined with classical techniques such as in terference alignment. The problem becomes much more
broadly accessible if suitable abstractions can be found fo r the underlying quantum functionality via classical black
box models. This work formalizes such an abstraction in the f orm of an “N-sum box”, a black box generalization of
a two-sum protocol of Song et al. with recent applications to N-server private information retrieval. The N-sum box
has a communication cost of Nqudits and classical output of a vector of N q-ary digits linearly dependent (via an
N×2Ntransfer matrix) on 2Nclassical inputs distributed among Ntransmitters. We characterize which transfer
matrices are feasible by our construction, both with and wit hout the possibility of additional locally invertible
classical operations at the transmitters and receivers. Fu rthermore, we provide a sample application to Cross-
Subspace Alignment (CSA) schemes to obtain efﬁcient instan ces of Quantum Private Information Retrieval (QPIR)
and Quantum Secure Distributed Batch Matrix Multiplicatio n (QSDBMM). We ﬁrst describe N-sum boxes based
on maximal stabilizers and we then consider non-maximal-st abilizer-based constructions to obtain an instance of
Quantum Symmetric Private Information Retrieval.
I. I NTRODUCTION
Distributed computation networks are often limited by thei r communication costs. Improving the efﬁciency of
distributed computation by reducing communication costs i s an active area of research. Reductions in communication
cost may be achieved by coding techniques that are specializ ed for the type of distributed computation task (e.g.,
aggregation [3], MapReduce [4], matrix multiplication [5] ) as well as the nature of the communication network
(wireless [3], cable [6], optical ﬁber [7], quantum network s [8]). For instance, coding for over-the-air computation
reduces the communication cost of linear computation over m any-to-one wireless networks, by taking advantage
of the natural superposition property of the wireless mediu m [3].
Investigating the properties and the applications of quant um protocols is crucial for the development of a
quantum internet [9]–[11], which operates on the principle s of quantum mechanics and differs fundamentally
from the classical internet used in our daily lives. Our focu s in this work is on linear computations (possibly with
privacy and security constraints) over quantum many-to-one communication networks. The potential for red uced
communication costs in this setting comes from quantum enta nglement among the transmitters, which creates
opportunities for superdense coding gains [12]–[15] as wel l as classical techniques such as interference alignment.
However, unlike wireless networks for which there exists an abundance of simpliﬁed channel models and abstractions
to facilitate analysis from coding, information-theoreti c and signal-processing perspectives [16]–[18], similarl y
convenient abstractions of quantum communication network s are not readily available, which limits the study of
quantum communication networks largely to quantum experts . Our work is motivated by the observation that a
convenient abstraction for linear computation over quantu m many-to-one networks is indeed available, although
somewhat implicitly, in the works of Song et al. , in the form of a quantum two-sum protocol [19], [20], and its
This work was carried out while M. Allaix was visiting the res earch group of S. Jafar at University of California, Irvine. Partial results
were submitted to GLOBECOM 2023 [1] and to Asilomar 2023 [2]. The ﬁrst two authors contributed equally to this work.
C. Hollanti and M. Allaix were supported by the Academy of Fin land, under Grant No. 318937. M. Allaix was also supported by a
doctoral research grant from the Emil Aaltonen Foundation, Finland.
Y . Lu, Y . Yao and S. Jafar were supported by grants NSF CCF-190 7053 and CCF-2221379 and ONR N00014-21-1-2386.2
Tx1
Tx2Receiver|β00/angbracketrightZ
ZX
Xx3x1
x4x2x1+x2
x3+x4H
⊕1qubit
to Rx
1qubit
to RxTx1
x1
x3
Tx2x2
x4Receivery1=x1+x2
y2=x3+x42-Sum
Box
Com. Cost
2 qubits
Fig. 1. Quantum circuit and black-box representation for two-sum t ransmission protocol with |β00/ang⌊ra⌋k⌉tright=1√
2(|00/ang⌊ra⌋k⌉tright+|11/ang⌊ra⌋k⌉tright).
subsequent generalizations, as applied to QPIR [21]–[25]. A similar type of linear computation with a classical-
quantum multiple access channel has been discussed in [26]– [28], where the classical-quantum multiple access
channel might have noise, and further applied to the problem of quantum secret sharing and QPIR [29].
A. Two-Sum Protocol
The two-sum protocol [20] is shown in Figure 1, both as a quant um circuit and as a black box. In the quantum
circuit, we see two transmitters (Tx1 and Tx2), each in posse ssion of one qubit of an entangled pair. The entangled
state in this case is the Bell state |β00/a\}⌊ra⌋k⌉tri}ht. As classical 2-bit inputs become available to the two transmitters ( (x1,x3)
to Tx1,(x2,x4)to Tx2), they perform conditional quantum operations ( X,Zgates) on their respective qubits and
then send them to the receiver (Rx), for a total communicatio n cost of 2qubits. The receiver performs a Bell
measurement and obtains (y1,y2) = (x1+x2,x3+x4). The two-sum protocol can be abstracted into a black
box, also shown in Figure 1, with inputs (x1,x3),(x2,x4)controlled by Tx1 and Tx2, respectively, and output
y=Mx, whereM= (1 1 0 0
0 0 1 1)is the transfer matrix of this2-sum box and x⊤=/parenleftbig
x1,x2,x3,x4/parenrightbig
. The black-box
representation hides the details of the quantum circuit and speciﬁes only the functionality (transfer matrix M) and the
communication cost ( 2qubits), which makes it possible for non-quantum experts to design low-communication-cost
coding schemes for quantum communication networks using th is black box, e.g., to take advantage of super-dense
coding. Note that in the two-sum protocol, if Tx1 uses only ze ros for its data (x1=x3= 0) , then the protocol
allows Tx2 to send both its classical input bits (x2,x4)to the receiver, even though it sends only one qubit,
provided Tx1 sends its qubit to the receiver as well. This is a n example of superdense coding, made possible by the
entanglement between the two qubits. Indeed, without the en tanglement, qubits are worth no more than classical
bits by the Holevo bound [30].
B. Our Contribution
The main contribution of this work is to formalize a generali zation of the 2-sum box, namely an N-sum box. It is
worth pointing out immediately that the technical foundati ons of theN-sum box are not new, indeed the construction
draws upon the well-understood stabilizer formalism in qua ntum coding theory [31]–[34], and most of the technical
details of the generalization from 2-sum toN-sum are also contained in the works of Song and Hayashi on Qua ntum
Private Information Retrieval [21]. Nevertheless, the cry stallization of the black-box abstraction, as demonstrate d
in this study, holds signiﬁcant promise for researchers in t he classical information and coding theory domains.
These researchers, though less acquainted with stabilizer codes and quantum coding theory, can still make valuable
contributions to comprehending the fundamental boundarie s of transmitter-side entanglement-assisted distributed
classical computation over quantum multiple access (QMAC) networks. This is achieved through the utilization of
the aforementioned classical abstraction, which effectiv ely conceals the intricate details of the underlying quantu m
circuitry. For example, wireless researchers with little b ackground in quantum codes may recognize the N-sum
box as the familiar MIMO MAC setting illustrated via an examp le in Figure 2. The main distinctions from the
multiple antenna wireless setting are 1) that the channel is deterministic (noise-free), deﬁned over a ﬁnite ﬁeld ( Fq)
rather than complex numbers, and 2) that instead of being gen erated randomly by nature, the channel matrix can
be freely designed as long as it is strongly self orthogonal ( SSO) (cf. Deﬁnition 3). This is because it is shown
in this work that feasible N-sum box transfer functions are precisely those matrices M∈FN×2N
q that are either
strongly self-orthogonal themselves, or can be made strong ly self-orthogonal by local invertible transformations3
(cf. Deﬁnition 1) at various transmitters and/or the receiv er. Thus, from a wireless perspective, the problem of
coding for the QMAC becomes conceptually equivalent to that of designing a coding scheme as well as the channel
matrix for a MIMO MAC subject to given structural constraint s imposed by the N-sum box abstraction (SSO), such
that the resulting MIMO MAC is able to efﬁciently achieve the desired linear computation ‘over-the-air’ (actually,
through quantum entanglement). The efﬁciency gained by ‘ov er-the-air’ computation in this (constrained: SSO)
MIMO MAC translates into superdense coding gain over the QMA C.
Tx1x1
x4
Tx2x2
x5
Tx3x3
x6
Receivery1
y2
y3
y1
y2
y3
=
M1,1···M1,6
.........
M3,1···M3,6

x1
x2
...
x6

y∈F3×1
q,x∈F6×1
q,M∈F3×6
q
M⊤JM=0,rank(M) = 3 (SSO)
[Quantum Comm. Cost: 3qudits]
Fig. 2. TheN-sum box is illustrated as a MIMO MAC for N= 3.
TheN-sum box is intended to be useful primarily as a tool for explo ring the information-theoretic capacity of
Fq-linear classical computations over an ideal QMAC, with the potential to shed new light into the fundamental
limitations of superdense coding and quantum entanglement . As with other tools that information theorists have
at their disposal, it is difﬁcult to predict in advance if the N-sum box abstraction will turn out to be sufﬁcient to
construct capacity achieving schemes. Indeed the linear co mputation capacity of a MAC is a challenging problem
even in the classical setting, especially for vector linear computations. Nevertheless, we are cautiously opti mistic
that the stabilizer-based construction exhausts the scope of theN-sum box functionality for Fq-linear computations.
The optimistic outlook is supported by prior works on capaci ty of QPIR [21], [23], [24] where N-sum boxes have
been implicitly employed for capacity-achieving schemes, as well as a recent follow-up work that utilizes the
N-sum-box abstraction from this work, to ﬁnd the capacity of s um-computation over the QMAC [35].
Last but not the least, even when an exact capacity character ization is beyond reach, a fruitful strategy is to utilize
theN-sum box to design the best possible schemes allowed by the ab straction. In general the constraints of the
abstraction may lead to entirely new schemes. However, cert ain applications of interest, of which QPIR is a prime
example, have classical solutions with specialized struct ures that naturally resonate with the SSO constraint, the
deﬁning feature of N-sum boxes. For such applications, it can be particularly in sightful to ﬁnd ways to efﬁciently
quantumize the classical solutions, leading not only to good quantum co ding schemes but also a better understanding
of the role of the SSO structure for linear computations. Not ably, such a quantumization was introduced in [22] by
blending the star-product scheme [36] with the two-sum prot ocol. In this work, to further illustrate this aspect, we
provide another instance by quantumizing classical cross- subspace alignment (CSA) codes into QCSA codes. CSA
codes have been used in a variety of schemes ranging from XSTP IR [37] and MDS coded XSTPIR [38] to secure
distributed batch matrix multiplication (SDBMM) [5], [39] . Therefore, QCSA codes naturally open the door for the
general quantum MDS-coded XSTPIR (MDS-coded QXSTPIR) sett ing as well as quantum SDBMM (QSDBMM).
C. Organization of the Paper
In Section II we describe the stabilizer formalism over a ﬁni te ﬁeld, which provides the quantum building block
for stabilizer-based N-sum-box constructions. In Section III we formally deﬁne an N-sum box. In Section IV
we study which constructions based on a maximal stabilizer a re feasible both allowing and disallowing local
invertible transformations, i.e., invertible transformations applied to the inputs by the tr ansmitters or invertible
transformations applied to the output by the receiver. In Se ction V we provide an application to CSA schemes to
obtain a QCSA scheme that enables instances of MDS-coded QXS TPIR and QSDBMM. Finally in Section VI we
consider constructions based on non-maximal stabilizers t hat enable instances of symmetric MDS-coded QXSTPIR
without the need for shared randomness among the servers.4
D. Notations
We denote by [N]the set{1,...,N}, n∈N, and byFqthe ﬁnite ﬁeld with qelements. We use bold lower-case
letters and bold upper-case letters to denote vectors and ma trices, respectively. Given a matrix A,/a\}⌊ra⌋k⌉tl⌉{tA/a\}⌊ra⌋k⌉tri}htrowand/a\}⌊ra⌋k⌉tl⌉{tA/a\}⌊ra⌋k⌉tri}htcol
denote the spaces spanned by the rows and columns of A, respectively, while A⊤andA†represent its transpose
and its conjugate transpose, respectively.
II. S TABILIZER FORMALISM OVER FINITE FIELDS
The stabilizer formalism [31] is a compact framework for qua ntum computation that provides a useful bridge to
classical computation. Recently, this framework has been l everaged to boost several classical protocols. We describe
the stabilizer formalism over a ﬁnite ﬁeld, for the details o f which we refer the reader to [32], [33]. Throughout,
we will use the same notation as in [24].
Letq=prwith a prime number pand a positive integer r. LetHbe aq-dimensional Hilbert space spanned by
orthonormal states {|j/a\}⌊ra⌋k⌉tri}ht:j∈Fq}. Forx∈Fq, we deﬁne TxonFr
pas theFp-linear map y/ma√sto→xy∈Fq,y∈Fq, by
identifying the ﬁnite ﬁeld Fqwith the vector space Fr
p. Lettrx:= TrTx∈Fpforx∈Fq. Letω:= exp(2πi/p).
Fora,b∈Fq, we deﬁne unitary matrices X(a):=/summationtext
j∈Fq|j+a/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{tj|andZ(b):=/summationtext
j∈Fqωtrbj|j/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{tj|onH. For
s= (s1,...,s2N)∈F2N
q, we deﬁne a unitary matrix ˜W(s):=X(s1)Z(sN+1)⊗···⊗X(sN)Z(s2N)onH⊗Ncalled
Weyl operator .
Forx= (x1,...,x N),y= (y1,...,yN)∈FN
q, we deﬁne the tracial bilinear form /a\}⌊ra⌋k⌉tl⌉{tx,y/a\}⌊ra⌋k⌉tri}ht:= tr/summationtextN
i=1xiyi∈Fp
and the trace-symplectic bilinear form /a\}⌊ra⌋k⌉tl⌉{tx,y/a\}⌊ra⌋k⌉tri}htS:=/a\}⌊ra⌋k⌉tl⌉{tx,Jy/a\}⌊ra⌋k⌉tri}ht, whereJis the2N×2Nmatrix
J=/parenleftbigg
0−I
I 0/parenrightbigg
.
The dual of a subspace VofF2N
qwith respect to this form is V⊥S:=/braceleftbig
s∈F2N
q:/a\}⌊ra⌋k⌉tl⌉{tv,s/a\}⌊ra⌋k⌉tri}htS= 0 for anyv∈V/bracerightbig
.
A matrix F∈F2N×2N
q is called symplectic ifF⊤JF=J. Symplectic matrices are precisely those matrices that
preserve/a\}⌊ra⌋k⌉tl⌉{t·,·/a\}⌊ra⌋k⌉tri}htS, and its columns form a symplectic basis for F2N
q. If we write F=/parenleftbigA C
B D/parenrightbig
, thenFis symplectic if
and only if B⊤A,D⊤Care symmetric and A⊤D−B⊤C=I. Thus,
F−1=J⊤F⊤J=/parenleftbiggD⊤−C⊤
−B⊤A⊤/parenrightbigg
. (1)
Remark 1. IfF∈F2N×2N
q is a symplectic matrix, then it is easy to see that the matrix F′=F/parenleftbigIκ
0/parenrightbig
∈F2N×κ
q ,
i.e., the matrix containing the ﬁrst κ∈[N]columns of F, satisﬁes the relation (F′)⊤JF′=0. Conversely, a matrix
satisfying such relation can be completed to a symplectic ma trix ( e.g., using the Gram–Schmidt Algorithm).
Symplectic orthogonality in the vector space F2N
qis equivalent to commutativity in the Heisenberg-Weyl group
HWN
q:=/braceleftig
c˜W(s) :s∈F2N
q, c∈C\{0}/bracerightig
. In fact, there is a surjective homomorphism c˜W(s)∈HWN
q/ma√sto→s∈
F2N
qwith kernel/braceleftbig
cIqN:c∈C\{0}/bracerightbig
, so two matrices c1˜W(s1),c2˜W(s2)commute if and only if /a\}⌊ra⌋k⌉tl⌉{ts1,s2/a\}⌊ra⌋k⌉tri}htS= 0.
A commutative subgroup of HWN
qnot containing cIqNfor anyc/\⌉}atio\slash= 1is called a stabilizer group . Such groups are
precisely those groups for which the aforementioned homomo rphism is actually an isomorphism. Thus, a stabilizer
group deﬁnes a self-orthogonal subspace , that isV⊆V⊥S, inF2N
q. Conversely, given a self-orthogonal subspace
VofF2N
q, there exist complex numbers cvso that
S(V):=/braceleftig
W(v):=cv˜W(v) :v∈V/bracerightig
⊆HWN
q (2)
forms a stabilizer group. Thus, there is a one-to-one corres pondence between stabilizer groups in HWN
qand self-
orthogonal subspaces in F2N
q.
Throughout this paper, we focus primarily on maximal stabilizers, since they exhaust the scope of all possible
stabilizer-based N-sum boxes (cf. Remark 18). Maximal stabilizers are in one-t o-one correspondence with strongly
self-orthogonal (SSO) subspaces ,i.e.,V=V⊥S, sodim(V) =N. In Section VI we consider non-maximal stabilizer-
based constructions for the cases when we want to discard N−κof theNoutputs of an N-sum box.
WhileVdeﬁnes the stabilizer S(V), the quotient space F2N
q/V⊥Sdeﬁnes orthogonal projectors
PV:=/braceleftig
PV
s:s∈F2N
q/V⊥S/bracerightig
(3)5
which we use as a projective-value measurement (PVM). We wil l denote|s/a\}⌊ra⌋k⌉tri}htthe state which PV
sprojects onto.
Throughout this paper we will use the results shown in the fol lowing proposition.
Proposition 1. [24, Proposition 2.2] Let Vbe aD-dimensional self-orthogonal subspace of F2N
qandS(V)be a
stabilizer deﬁned from V. Then, we obtain the following statements.
(a) For any v∈V, the operation W(v)∈S(V)is simultaneously and uniquely decomposed as
W(v) =/summationdisplay
s∈F2N
q/V⊥Sω/ang⌊ra⌋k⌉tl⌉ftv,s/ang⌊ra⌋k⌉trightSPV
s (4)
with orthogonal projections/braceleftbig
PV
s/bracerightbig
such that
PV
sPV
t=0for anys/\⌉}atio\slash=t,/summationdisplay
s∈F2N
q/V⊥SPV
s=IqN.
(b) LetHV
s:= ImPV
s. We have dimHV
s=qN−Dfor anys∈F2N
q/V⊥Sand the quantum system H⊗Nis
decomposed as
H⊗N=/circlemultiplydisplay
s∈F2N
q/V⊥SHV
s=W⊗CqN−D, (5)
where the systemWis theqD-dimensional Hilbert space spanned by/braceleftbig
|s/a\}⌊ra⌋k⌉tri}ht:s∈F2N
q/V⊥S/bracerightbig
with the property
HV
s=|s/a\}⌊ra⌋k⌉tri}ht⊗CqN−D:=/braceleftig
|s/a\}⌊ra⌋k⌉tri}ht⊗|ψ/a\}⌊ra⌋k⌉tri}ht:|ψ/a\}⌊ra⌋k⌉tri}ht∈CqN−D/bracerightig
.
(c) For any s,t∈F2N
q, we have
W(t)|s/a\}⌊ra⌋k⌉tri}ht⊗CqN−D=|s+t/a\}⌊ra⌋k⌉tri}ht⊗CqN−D,
W(t)/parenleftbig
|s/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{ts|⊗IqN−D/parenrightbig
W(t)†=|s+t/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{ts+t|⊗IqN−D.
Measuring withPVas in Equation (3) would yield a coset. Proposition 2 aims to c larify the notation of
Proposition 1 by giving a unique representative of the outpu tted equivalence class. First, we need the following
lemma to prove that matrices satisfying the conditions of th e proposition exist.
Lemma 1. LetG∈F2N×κ
q be such that G⊤JG=0andrank(G) =κ. Then there exists a full-rank matrix
G⊥∈F2N×2N−κ
q such that
1)G⊤JG⊥=0,i.e.,/a\}⌊ra⌋k⌉tl⌉{tgi,g′
j/a\}⌊ra⌋k⌉tri}htS= 0fori∈[κ], j∈[2N−κ], wheregiis theithcolumn of Gandg′
jis thejth
column of G⊥, and
2)G=G⊥/parenleftbigIκ
0/parenrightbig
,i.e.,Gis the leftmost submatrix of G⊥.
Proof. LetFbe a symplectic completion of G,i.e., a symplectic matrix such that its ﬁrst κcolumns are equal to
G, which exists by the conditions imposed on G(cf. Remark 1). Then we can write it as F=/parenleftbig
G G2H1H2/parenrightbig
,
whereH1∈F2N×κ
q,G2,H2∈F2N×N−κ
q . SinceF⊤JF=J, it is clear that f⊤
iJfj= 0 for each pair of columns
fi,fjofFsuch thati∈[κ], j∈[N]∪{N+κ+ 1,...,2N}. Choosing G⊥=/parenleftbig
G G2H2/parenrightbig
proves the
statement.
Proposition 2. LetG∈F2N×κ
q andG⊥∈F2N×2N−κ
q be such that
•G=G⊥/parenleftbigIκ
0/parenrightbig
,
•G⊤JG⊥=0,
•there exists H∈F2N×κ
q such that/parenleftbig
G⊥H/parenrightbig
is full rank.
LetV=/a\}⌊ra⌋k⌉tl⌉{tG/a\}⌊ra⌋k⌉tri}htcoland(·)h:F2N
q→Fκ
qbe such that
(x)h:=/parenleftbig
0κ×2N−κIκ/parenrightbig/parenleftbig
G⊥H/parenrightbig−1x.
Then performing the PVM/braceleftbig
PV
s:s∈F2N
q/V⊥S/bracerightbig
on the state|x/a\}⌊ra⌋k⌉tri}htgives the outcome (x)h.
Proof. Condition 3 ensures that the matrices GandG⊥are full rank, so dim(V) =κanddim(V⊥S) = 2N−κ.
By conditions 1 and 2 we have that V⊆V⊥S=/a\}⌊ra⌋k⌉tl⌉{tG⊥/a\}⌊ra⌋k⌉tri}htcol, so the subgroup S(V)as in Equation (2) is a stabilizer.6
By Equation (5) we have that H⊗N=W⊗CqN−κ, whereWis theqκ-dimensional Hilbert space spanned by/braceleftbig
|s/a\}⌊ra⌋k⌉tri}ht:s∈F2N
q/V⊥S/bracerightbig
.
Letx∈F2N
q, then we can uniquely decompose it as x=G⊥xg+Hxh,xg∈F2N−κ
q,xh∈Fκ
q. Notice now
that(x)h=xh. Letg∈V⊥S, then we can write g=Gg′forg′∈F2N−κ
q andx+gcan be decomposed as
x+g=G(xg+g′)+Hxh=Gx′
g+Hxh,x′
g∈Fκ
q.
In Proposition 1, we have that s=s+V⊥S=/braceleftbig
s+g:g∈V⊥S/bracerightbig
. It follows that every x∈smaps to a unique
elementsh∈Fκ
q. Thus, we can identify each coset swith the element sh. Then we identify the states
|sh/a\}⌊ra⌋k⌉tri}htW=|s/a\}⌊ra⌋k⌉tri}ht (6)
to avoid confusion with the computational basis, since Wis the space spanned by the states |s/a\}⌊ra⌋k⌉tri}ht.
In the decomposition given by Equation (5) we have qκdistinct elements, since each HV
shas dimension qN−κ.
Thus, since there are qκvectorssh∈Fκ
q, we can write Equation (4) as W(v) =/summationtext
sh∈Fκ
qω/ang⌊ra⌋k⌉tl⌉ftv,H1sh/ang⌊ra⌋k⌉trightSPV
sh, where
PV
shis the projection associated with the measurement outcome sh. Ifκ=N, thendim(ImPV
sh) = 1 and we can
decompose it as PV
sh:=|sh/a\}⌊ra⌋k⌉tri}htW/a\}⌊ra⌋k⌉tl⌉{tsh|W, otherwise the projection is given by a density matrix.
In general, assume the system is in the state |x/a\}⌊ra⌋k⌉tri}htfor some x∈F2N
q/V⊥
S. By the discussion above, we can identify
xwith a unique xh∈FN
q. Then,
PV
sh|x/a\}⌊ra⌋k⌉tri}ht=/braceleftigg
|xh/a\}⌊ra⌋k⌉tri}htWifsh=xh,
0 ifsh/\⌉}atio\slash=xh.
We thus obtain the outcome (x)hwith probability 1 after performing the PVM/braceleftbig
PV
s:s∈F2κ
q/V⊥S/bracerightbig
=/braceleftbig
PV
sh:sh∈Fκ
q/bracerightbig
on the state|x/a\}⌊ra⌋k⌉tri}ht.
Remark 2. The PVM can be more clearly expressed as
PV:=/braceleftbig
PV
sh=|sh/a\}⌊ra⌋k⌉tri}htW/a\}⌊ra⌋k⌉tl⌉{tsh|W:sh∈Fκ
q/bracerightbig
. (7)
Remark 3. Ifκ=N, thenG⊥=G, so the ﬁrst two conditions of Proposition 2 can be simply rew ritten as
G⊤JG=0. In this case Gdeﬁnes an SSO subspace V, which is in correspondence with the maximal stabilizer
S(V). Furthermore, measuring over the PVM PVis equivalent to ﬁrst revert the unitary UG,H(cf. Remark 8) and
measuring on the computational basis, as such unitary is nee ded to map the computational basis to the PVM basis.
As the PVMPVis applied on Nqudits, one should expect N q-ary digits as output, but if κ<N , the output
of the PVM has only κ q-ary digits according to Proposition 2. We will clarify this aspect in Section VI.
III.N-SUMBOX
AnN-sum box is a black box with the following functional form:

y1
y2
...
yN
=
M1,1···M1,2N
.........
MN,1···MN,2N

x1
...
xN
xN+1
...
x2N
,
or equivalently y=Mx, wherey∈FN
qis the output vector, x∈F2N
qis the input vector, and M∈FN×2N
q is the
transfer matrix . The inputs to the N-sum box are controlled by Nparties ( transmitters ), where transmitter n∈[N]
is controlling (xn,xN+n). The output vector yis measured by another party, which we label as the receiver .
TheN-sum box is initialized with shared quantum entanglement am ong theNtransmitters, i.e.,Nentangled
q-dimensional qudits are prepared and distributed to the tra nsmitters, one qudit per transmitter. The initial qudit
entanglement is independent of the inputs xand any data that subsequently becomes available to the tran smitters.
No quantum resource is initially available to the receiver. In the course of operation of the N-sum box, each
of theNtransmitters acquires data from various sources, includin g possibly the receiver ( e.g., queries in private7
information retrieval), based on which it performs conditi onalX,Z-gate operations on its own qudit, and then sends
its qudit to the receiver. The receiver performs a quantum me asurement on the Nqudits, from which it recovers y.
In this setting, we allow the inputs (xn,xn+N)from each transmitter n∈[N]to be transformed by an invertible
matrix. This corresponds to multiplying the input vector by local invertible transformations, which are deﬁned as
follows.
Deﬁnition 1. LetdiagN,Fqbe the set of diagonal matrices of dimension N×Nand entries in Fq. The set of local
invertible transformations (LITs) is deﬁned as
LITN,Fq:=/braceleftbigg/parenleftbigg
Λ1Λ2
Λ3Λ4/parenrightbigg
:Λi∈diagN,Fq, i∈[4],det(Λ1Λ4−Λ2Λ3)/\⌉}atio\slash= 0/bracerightbigg
.
Notice that the submatrix with the entries in position (n,n),(n,n+N),(n+N,n),(n+N,n+N)ofΛ∈LITN,Fq
is the invertible matrix applied by transmitter n∈[N]to its inputs.
We also allow receiver invertible transformations ,i.e., we allow the receiver to transform the output vector of
theN-sum box by multiplying it by P∈GLN,Fq, whereGLN,Fqis the set of invertible matrices with dimension
Nand entries in Fq. This gives equivalent representations of the N-sum box as
y=PMΛx,P∈GLN,Fq,Λ∈LITN,Fq.
Deﬁnition 2. The relationLIT≡deﬁnes an equivalence class of pairs of matrices M1,M2∈FN×2N
q up to local and
receiver invertible transformations, i.e.,
M1LIT≡M2⇐⇒M1=PM2Λ,
whereP∈GLN,Fq,Λ∈LITN,Fq.
IV. S TABILIZER -BASEDN-SUMBOXESNqudits in entangled state |0/angbracketrightW
|0/angbracketrightW=UG,H|0/angbracketrightTx1 with data (x1,x1+N)
Tx2 with data (x2,x2+N)
TxNwith data (xN,x2N)...Z
Z
ZX
X
Xx1 x1+N
x2 x2+N
xN x2NTransmitters
x=Gxg+Hxh,
x∈F2N
qandxg,xh∈FN
qRx computes y=xh=Mx,
M=/parenleftbig0 I/parenrightbig/parenleftbigG H/parenrightbig−1,
M∈FN×2N
qU†
G,H1qudit
to Rx
1qudit
to Rx
1qudit
to Rx...Receiver
y1= (xh)1
y2= (xh)2
...
yN= (xh)NTx1
Tx2
TxN...x1
x1+N
x2
x2+N
xN
x2Ny1
y2
yN......ReceiverN-Sum Box
y=Mx
Com. Cost
Nqudits
y= (y1,y2,···,yN)⊤
x= (x1,x2,···,x2N)⊤
Fig. 3. Quantum circuit and black-box representation for an N-sum box with transfer function y=Mx.
First, we deﬁne strongly self-orthogonal matrices, which a re used in the construction of N-sum boxes based on
the stabilizer formalism.
Deﬁnition 3. A matrix M∈F2N×N
q is said to be strongly self-orthogonal (SSO) if its columns span an SSO
subspace, or equivalently, if M⊤JM=0andrank(M) =N. The set of SSO matrices is denoted by Mo.8
Remark 4. The reason why we deﬁne strongly self-orthogonal matrices i s because self-orthogonal matrices would
not generate SSO subspaces. For example, in F4
9whereF9≡F3[x]/(x2+x+ 2) with generator element α, the
matrix
G⊤=/parenleftbigg
1 0 0 2
0 1−α0/parenrightbigg
is self-orthogonal since the F3-trace of each element of the matrix
G⊤JG=/parenleftbigg
0α+2
α+2 0/parenrightbigg
is 0, but the space spanned by its rows wouldn not be strongly s elf-orthogonal since
/a\}⌊ra⌋k⌉tl⌉{tαv1,v2/a\}⌊ra⌋k⌉tri}htS= TrF9/F3(2α+α2)/\⌉}atio\slash= 0.
Let us now characterize some classes of N-sum boxes that can be constructed based on the stabilizer fo rmalism.
A. Case with disallowed LITs
The following theorem describes which transfer matrices ar e feasible from a stabilizer-based construction when
LITs are disallowed.
Theorem 1. Suppose there exists G∈F2N×N
q such that
1)G∈Mo,
2) there exists H∈F2N×N
q such that/parenleftbig
G H/parenrightbig
is full-rank,
3)M∈FN×2N
q is the submatrix comprised of the bottom Nrows of/parenleftbig
G H/parenrightbig−1,i.e.,M:=/parenleftbig
0 I/parenrightbig/parenleftbig
G H/parenrightbig−1.
Then there exists a stabilizer-based construction for an N-sum box over Fqwith transfer matrix M.
Proof. LetUG,H∈CqN×qNbe the unitary matrix such that its ithcolumn is the vector representing the state
|ν(i)/a\}⌊ra⌋k⌉tri}htW,i∈[qN], identiﬁed by Equation (6), where ν: [qN]→FN
qis the natural isomorphism (cf. Remark 8).
Let|0/a\}⌊ra⌋k⌉tri}htW=UG,H|0/a\}⌊ra⌋k⌉tri}htbe the initial entangled state over H⊗N. LetV=/a\}⌊ra⌋k⌉tl⌉{tG/a\}⌊ra⌋k⌉tri}htcol. Assume that transmitter n∈[N]
appliesX(xn),Z(xN+n)on his qudit and sends it to the receiver. Then the quantum sys tem received is in the state
W(x)|0/a\}⌊ra⌋k⌉tri}htW=|(x)h/a\}⌊ra⌋k⌉tri}htW. After performing the PVM PVdeﬁned in Equation (7) on the qudits the receiver measures
(x)hwithout error by Proposition 2. Let Mbe the submatrix comprised of the bottom Nrows of/parenleftbig
G H/parenrightbig−1, then
we have that Mx=xh, which is the output of the measurement. We proved that for an N-sum box with transfer
functionMsatisfying condition 3 there exists a quantum black box with inputxand output Mx.
Remark 5. The terminology “stabilizer-based construction" stems fr om the aforementioned correspondence between
stabilizers and self-orthogonal spaces. Explicitly, let S=/a\}⌊ra⌋k⌉tl⌉{tW(s1),...,W(sκ)/a\}⌊ra⌋k⌉tri}ht⊆HWN
qbe a stabilizer group, i.e.,
a stabilizer group with κindependent generators W(si)dependent on si∈F2N
q, i∈[κ]. LetG∈F2N×κ
q be the
matrix that has sias itsithcolumn, then G⊤JG=0andrank(G) =κ. For the case κ=N, the stabilizer is
maximal,|0/a\}⌊ra⌋k⌉tri}htWis its stabilized state, and G∈Mo.
Remark 6. A stabilizer-based construction for any feasible N-sum box y=Mx is information-theoretically
optimal as a black-box implementation in the sense that it ha s the least possible quantum download cost. In other
words, since the transfer matrix Mis full rank, there cannot exist a more efﬁcient (in terms of d ownload cost)
construction of the same N-sum box by some other (non-stabilizer-based) means so that the output yis capable of
deliveringN q-ary digits to the receiver, which cannot be done with a commu nication cost of less than Nqudits
by the Holevo bound [30].
Remark 7. From a quantum coding-theoretic perspective, a stabilizer -based construction for an N-sum box is
equivalent to preparing a stabilizer state, applying an N-qudit error corresponding to a string of 2Nsymbols from
a ﬁnite ﬁeld, and computing the syndrome on this state as outp ut.
We denote byMsbcthe set of all the transfer matrices resulting from stabiliz er-based constructions with disallowed
LITs. In the following, we establish that the set of transfer matrices achievable through the (G,H)-construction
established by Theorem 1 is the same as the set of SSO matrices ,i.e.,9
Lemma 2.Mo=Msbc.
Proof. LetM∈FN×2N
q be such that M⊤∈Msbc. By condition 3 of Theorem 1 we have that MG=0=G⊤JG.
SinceGis full-rank, also G⊤Jis full-rank, so/a\}⌊ra⌋k⌉tl⌉{tM/a\}⌊ra⌋k⌉tri}htrow=/a\}⌊ra⌋k⌉tl⌉{tG⊤J/a\}⌊ra⌋k⌉tri}htrow. This implies that M=PG⊤Jfor an invertible
matrixP∈FN
q, and since JJ⊤=Iwe can conclude that MJM⊤=PG⊤JJJ⊤GP⊤=0,i.e.,M⊤∈Moand
Msbc⊆Mo.
Now, let M∈FN×2N
q be such that M⊤∈Mo. LetN∈FN×2N
q be such that/parenleftbig
N⊤M⊤/parenrightbig
is full-rank. Then
the matrix/parenleftbig
N⊤M⊤/parenrightbigis invertible and we can write its inverse as/parenleftbigG H/parenrightbig, whereG,H∈FN×2N
q are full-rank
matrices. Clearly, M/parenleftbig
G H/parenrightbig
=/parenleftbig
0 I/parenrightbig
, so by the same argument above it is easy to see that G∈Mo,i.e.,
Mo⊆Msbc.
Remark 8. LetG=/parenleftbigA
B/parenrightbig
∈Mobe any SSO matrix and H=/parenleftbigC
D/parenrightbig
be such that the matrix F:=/parenleftbig
G H/parenrightbig
is
symplectic. Then, by Equation (1), we have/parenleftbig
0 I/parenrightbig
F−1=/parenleftbig
−B⊤A⊤/parenrightbig
which is again an SSO matrix. Lemma 2
implies that we only need to complete Gto a symplectic matrix (instead of invertible). The well-kn own connection
between symplectic matrices and the stabilizer formalism [ 34] allows for a simpler description of the matrix UG,H,
as the following example illustrates.
Example 1. Suppose we have two parties, Tx1 and Tx2, both possessing two bitsa= (x1,x3),b= (x2,x4)∈F2
2,
respectively (see Figure 1). The two-sum transmission prot ocol computes the sum of their bits (x1+x2,x3+x4)start-
ing with the Bell state |β00/a\}⌊ra⌋k⌉tri}ht= (|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)/√
2, which is stabilized by the stabilizer S=/a\}⌊ra⌋k⌉tl⌉{tW(0,0,1,1),W(1,1,0,0)/a\}⌊ra⌋k⌉tri}ht.
Consider the matrix
F=/parenleftbig
G H/parenrightbig
=
0 1 1 0
0 1 0 0
1 0 0 0
1 0 0 1
,
whereGis determined bySandHis chosen so that Fis a symplectic matrix. The symplectic matrix can be
decomposed, e.g., using the Bruhat decomposition [40], [41], as
F=
1 1 0 0
0 1 0 0
0 0 1 0
0 0 1 1
·
0 0 1 0
0 1 0 0
1 0 0 0
0 0 0 1
.
The components correspond to quantum gates CNOT and a partial Hadamard H⊗Ion the ﬁrst qudit [42]. This
is precisely the circuit UG,Hfor which|β00/a\}⌊ra⌋k⌉tri}ht=UG,H|00/a\}⌊ra⌋k⌉tri}ht. Using Equation (1)we then obtain the transfer matrix
M=/parenleftbig
0 I/parenrightbig
F−1=/parenleftbigg1 1 0 0
0 0 1 1/parenrightbigg
,
which is exactly the functional form of the two-sum transmis sion protocol. This approach allows for a straightforward
generalization that computes Mx starting with the state (|0..0/a\}⌊ra⌋k⌉tri}ht+|1..1/a\}⌊ra⌋k⌉tri}ht)/√
2, where
M=
110···00 000···00
011···00 000···00
......
000···11 000···00
000···00 111···11
∈FN×2N
q.
The following theorem fully characterizes N-sum boxes without LITs and follows directly from Theorem 1,
Remark 5 and Lemma 2.
Theorem 2. LetM∈Mo. A construction based on a stabilizer S⊆HWN
qexists for an N-sum box over Fqwith
transfer matrix M⊤if and only ifSis a maximal stabilizer.10
B. Case with allowed LITs
Now we explore what is possible when LITs are allowed. The fol lowing theorem shows that the transfer matrix
of any(G,H)construction is equivalent (up to LITs) to the null-space of G, which can be explicitly represented
asJ⊤G.
Proposition 3. LetM∈FN×2N
q be such that M⊤∈Msbc. ThenMLIT≡G⊤J, the null-space of G⊤.
Proof. This follows directly from the proof of Lemma 2, since we can w riteM=PG⊤JforP∈GLN,Fq,i.e.,
MLIT≡J⊤G.
A known property of SSO matrices is that they can be written in the so-called standard form [43], i.e., ifM∈Mo
then there exist P∈GLN,Fq,Q∈GL2N,Fqsuch that
PM⊤Q=/parenleftbig
I S/parenrightbig
, (8)
whereSis a symmetric N×Nmatrix, i.e.,S⊤=S. We denote byMsthe set of transfer matrices in standard
form, i.e.,
Ms:=/braceleftig
M∈F2N×N
q:M⊤=/parenleftbig
I S/parenrightbig
,S∈FN×N
q,S⊤=S/bracerightig
.
The following lemma shows that any SSO matrix Mcan be transformed by at most Nsigned column-swapping
operations into a matrix M′=/parenleftbig
M′
lM′
r/parenrightbig⊤∈Mosuch that M′
lis full-rank. For completeness, the proof is
included in Appendix A.
Lemma 3. For anyM∈Mothere exists a diagonal matrix Σ∈{0,1}N×Nsuch that
(M′)⊤=M⊤/parenleftbigg
I−Σ Σ
−Σ I−Σ/parenrightbigg
LIT≡M⊤, (9)
M′∈Mo, (10)
det/parenleftbig
M′
l/parenrightbig
/\⌉}atio\slash= 0. (11)
Remark 9. Notice that (M′)⊤is obtained from M⊤bysigned column-swapping operations, i.e., swapping
corresponding columns of GlandGrwith a sign-change operation. Speciﬁcally, if Σi,i= 1, theithcolumn
ofGlis replaced with the negative of theithcolumn of Gr, while theithcolumn of Gris replaced with the ith
column of Gl.
Our next result shows that with LITs, every feasible transfe r matrixM∈Mohas an equivalent representation
in the standard form MLIT≡/parenleftbig
I S/parenrightbig
, whereS⊤=S. Notice that in Equation (8) the matrix Qis not necessarily an
LIT. The contribution here is to show that the standard form r emains valid when only LITs are allowed.
Theorem 3. For every M∈Msbcthere exists M′∈Mssuch that (M′)⊤LIT≡M⊤. Conversely,Ms⊆Msbc.
Proof. By Lemma 3 in Appendix A, there exists M′:=/parenleftbig
M′
lM′
r/parenrightbig⊤∈Mosuch that M⊤LIT≡(M′)⊤andM′
l
is full-rank. Since multiplication on the left by an inverti ble square matrix preserves both rank and strong self-
orthogonality, we obtain that (M′′)⊤= (M′
l)−1(M′)⊤=/parenleftbig
I F/parenrightbig
andM′′∈Mo. Notice that Fis symmetric, since
M′′=/parenleftbig
I F/parenrightbig⊤∈Moimplies that
0= (M′′)⊤JM′′=/parenleftbig
F−I/parenrightbig/parenleftbig
I F/parenrightbig⊤=F⊤−F,
so we can conclude that M′′∈Ms.
Conversely, it is easy to see that the standard form/parenleftbig
I S/parenrightbig
is strongly self-orthogonal, since it has rank Nand
/parenleftbig
I S/parenrightbig
J/parenleftbig
I S/parenrightbig⊤=/parenleftbig
S−I/parenrightbig/parenleftbig
I S/parenrightbig⊤=S−S⊤=0.
Clearly we have that Ms⊆Mo=MG,H.11
F2N×N
qMLIT:=/braceleftBigg
M:∃M′∈ Msbc
M′LIT≡M/bracerightBigg
LIT≡
Thm. 4MsMo:=/braceleftbigg
M:M⊤JM=0
rank(M) =N/bracerightbigg
=
Lem. 2MsbcMs:=/braceleftbigg
M:M⊤=/parenleftbigINS/parenrightbig
S⊤=S/bracerightbigg
Fig. 4. Relationships between the various forms of transfer functi ons.
Remark 10. The standard form is not unique up to LITs. For example,
/parenleftbig
I S1/parenrightbig
=/parenleftbigg1011
0111/parenrightbigg
LIT≡/parenleftbigg1011
1−101/parenrightbigg
LIT≡/parenleftbigg1 0
1−1/parenrightbigg/parenleftbigg1 0 1 1
1−1 0 1/parenrightbigg
=/parenleftbigg1 0 1 1
0 1 1 0/parenrightbigg
=/parenleftbig
I S2/parenrightbig
,S2/\⌉}atio\slash=S1.
Next, we deﬁne the set MLITof all possible transfer matrices that we can obtain by apply ing LITs:
MLIT:=/braceleftig
M∈F2N×N
q:∃M′∈Msbc,MLIT≡M′/bracerightig
.
The following theorem shows that any transfer matrix in MLITis equivalent, up to LITs, to a transfer matrix in
standard form. Figure 4 provides an overview of the relation ships between the various forms of transfer functions.
Theorem 4. For every M∈MLITthere exists M′∈Mssuch that M′LIT≡M. Conversely, for every M′∈Ms
there exists M∈MLITsuch that MLIT≡M′.
Proof. By deﬁnition, for every M∈MLITthere exists M′∈Msbcsuch that M′LIT≡M. By Theorem 3 there exists
M′′∈Mssuch that M′′LIT≡M′, and since the equivalence is transitive, we have that M′′LIT≡M.
The converse is trivial by the deﬁnitions.
C. Feasibility of an N-Sum Box
Next we explore the problem of testing feasibility. Given a d esiredN-sum box speciﬁcation Y=M⊤Xfor some
M∈F2N×N
q , the goal is to determine if this N-sum box is feasible by stabilizer based constructions comb ined
with local invertible transformations. The easiest case is ifMis in the standard form M⊤=/parenleftbig
I S/parenrightbig
, which is
immediately seen to be feasible. Another easy case is when M∈Mo, which can be checked efﬁciently as well with
complexityO(N3). However, if Mis neither in standard form, nor a full-rank strongly self-o rthogonal matrix, it
could still be feasible through local invertible transform ations. Here we describe a test to determine such feasibilit y,
or to rule it out with certainty, with complexity no more than O(N4).
Theorem 5. The transfer matrix M⊤=/parenleftbig
MlMr/parenrightbig
∈FN×2N
q is feasible for an N-sum box construction, i.e.,
M∈MLIT, if and only if rank(M) =Nand there exists an invertible diagonal matrix ∆∈FN×N
q such that
(M′)⊤=/parenleftbig
MlMr∆/parenrightbig
∈Mo. (12)
Remark 11. Finding such a ∆can be done with complexity O(N4)by solving for the Nelements of ∆subject
to the linear constraints imposed by the self-orthogonalit y condition.
Proof. Consider a general feasible setting. By Theorem 4 we can writ eM⊤=P/parenleftbig
I S/parenrightbig
Λfor some P∈GLN,Fq
and
Λ=/parenleftbigg
Λ1Λ2
Λ3Λ4/parenrightbigg
∈LITN,Fq,12
where the matrices Λi∈diagN,Fq, i∈[4], are such that det(Λ1Λ4−Λ2Λ3)/\⌉}atio\slash= 0. LetΛd=Λ1Λ4−Λ2Λ3and
∆=Λ−1
d∈diagN,Fq, then
Λ/parenleftbiggI 0
0 ∆/parenrightbigg
J/parenleftbiggI 0
0 ∆/parenrightbigg⊤
Λ⊤=Λ/parenleftbigg0−I
∆ 0/parenrightbigg/parenleftbiggI 0
0 ∆/parenrightbigg
Λ⊤=Λ/parenleftbigg0−∆
∆ 0/parenrightbigg
Λ⊤
=/parenleftbiggΛ2∆−Λ1∆
Λ4∆−Λ3∆/parenrightbigg/parenleftbiggΛ1Λ3
Λ2Λ4/parenrightbigg
=/parenleftbiggΛ2∆Λ1−Λ1∆Λ2Λ2∆Λ3−Λ1∆Λ4
Λ4∆Λ1−Λ3∆Λ2Λ4∆Λ3−Λ3∆Λ4/parenrightbigg
=/parenleftbigg(Λ2Λ1−Λ1Λ2)∆(Λ2Λ3−Λ1Λ4)∆
(Λ4Λ1−Λ3Λ2)∆(Λ4Λ3−Λ3Λ4)∆/parenrightbigg
=/parenleftbigg(Λ1Λ2−Λ1Λ2)∆−(Λ1Λ4−Λ2Λ3)∆
(Λ1Λ4−Λ2Λ3)∆(Λ3Λ4−Λ3Λ4)∆/parenrightbigg
=J
by the commutativity of diagN,Fq. It follows that
(M′)⊤JM′=M⊤/parenleftbigg
I 0
0 ∆/parenrightbigg
J/parenleftbigg
I 0
0 ∆/parenrightbigg⊤
M
=P/parenleftbig
I S/parenrightbig
Λ/parenleftbigg
I 0
0 ∆/parenrightbigg
J/parenleftbigg
I 0
0 ∆/parenrightbigg⊤
Λ⊤/parenleftbig
I S/parenrightbig⊤P⊤
=P/parenleftbig
I S/parenrightbig
J/parenleftbig
I S/parenrightbig⊤P⊤=0,
i.e.,M′∈Mo.
For the other direction it is trivial to see that if such a ∆exists, then MLIT≡M′∈Mo⊆MLIT, which implies
thatM∈MLIT.
Remark 12. Notice that in the proof we proved that the matrix Λ′=Λ/parenleftbigI 0
0 ∆/parenrightbig
is symplectic, i.e., it satisﬁes the
property Λ′J(Λ′)⊤=J, as symplectic matrices are known to be the only kind of matri ces that preserves strong
self-orthogonality.
V.N-SUMBOXAPPLICATION : QUANTUM CSA S CHEME
Cross-subspace alignment (CSA) codes ﬁnd applications in v arious private information retrieval (PIR) schemes
(e.g., PIR with secure storage) and in secure distributed batch ma trix multiplication (SDBMM). Using the developed
N-sum box abstraction of a quantum multiple-access channel ( QMAC), we translate CSA schemes over classical
multiple-access channels into efﬁcient quantum CSA scheme s over a QMAC, achieving maximal superdense-coding
gain. Because of the N-sum box abstraction, the underlying problem of coding to ex ploit quantum entanglements
for CSA schemes becomes conceptually equivalent to that of d esigning a channel matrix for a MIMO MAC subject
to given structural constraints imposed by the N-sum box abstraction, such that the resulting MIMO MAC is abl e
to implement the functionality of a CSA scheme (encoding/de coding) over-the-air . Applications include Quantum
PIR with secure and MDS-coded storage, as well as Quantum SDB MM. In this section we ﬁrst introduce the
classical CSA scheme, then give the deﬁnition of some import ant concepts and ﬁnally present the way to translate
a CSA scheme to QCSA scheme and apply the QCSA scheme to speciﬁ c problems.
A. Cross Subspace Alignment (CSA) Codes
Conceptually, the setting for a CSA coding scheme (over a ﬁni te ﬁeldFq) is the following. We have Ndistributed
servers. The servers locally compute their answers An,n∈[N],to a user’s query. Each answer Anis a linear
combination of Lsymbols that are desired by the user, say δ1,δ2,···,δL, andN−Lsymbols of undesired
information (interference), say ν1,ν2,···,νN−L. The linear combinations have a Cauchy-Vandermonde struct ure
that is the deﬁning characteristic of CSA schemes, such that the desired terms appear along the dimensions13
corresponding to the Cauchy terms, while the interference a ppears (aligned) along the dimensions corresponding
to the Vandermonde terms. The bthinstance of a CSA scheme is represented as

Ab
1...
Ab
N

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Ab=
1
f1−α1···1
fL−α11α1···αN−L−1
1
1
f1−α2···1
fL−α21α2···αN−L−1
2
.....................
1
f1−αN···1
fL−αN1αN···αN−L−1
N

/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
GCSAq
N,L(α,f)
δb
1
:
δb
L
νb
1
:
νb
N−L

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Xb
δ,ν.
The CSA scheme requires that all the αi,fjare distinct elements in Fq(thus needing q≥N+L), which guarantees
that theN×NmatrixGCSAq
N,L(α,f)is invertible. After downloading Anfrom each server n,n∈[N], the user
is able to recover the desired symbols δb
1,...,δb
Lby inverting CSAq
N,L(α,f). Thus, each instance bof the CSA
scheme allows the user to retrieve Ldesired symbols at a cost of Ndownloaded symbols. The rate of the scheme,
deﬁned as the number of desired symbols recovered per downlo aded symbol, is L/N . The reciprocal, N/L , is the
download cost per desired symbol.
Remark 13. A noteworthy aspect of CSA schemes is that the number of serve rs can be reduced, i.e., the CSA scheme
can be applied to N′<N servers, with a corresponding reduction in the number of des ired symbols L′<L, as
long as the dimension of interference is preserved, i.e.,N−L=N′−L′. In the classical setting, this ﬂexibility is
not useful as it leads to a strictly higher download cost, i.e.,N′/L′= (N−L)/L′+1>(N−L)/L+1 =N/L .
In the quantum setting, however, this will lead to a useful si mpliﬁcation.
B. Deﬁnitions
In the following we represent GRS codewords as column vector s rather than the usual coding-theoretic notation
with row vectors in order to be consistent with the standard n otation used in linear computation. It follows that the
GRS generator matrix is represented as a n×kmatrix instead of the usual k×nmatrix.
Deﬁnition 4. (GRS Code) LetC= GRSq
n,k(α,u)be a Generalized Reed–Solomon (GRS) code over Fq, where
α= (α1,...,α n)∈F1×n
q,u= (u1,...,u n)∈F1×n
q,ui/\⌉}atio\slash= 0 andαi/\⌉}atio\slash=αjfor all distinct i,j∈[n]. Its generator
matrix can be deﬁned as
GGRSq
n,k(α,u):=
u1u1α1u1α2
1···u1αk−1
1
u2u2α2u2α2
2···u2αk−1
2
...............
ununαnunα2
n···unαk−1
n
∈Fn×k
q.
Deﬁnition 5. (Dual Code) For an[n,k]linear codeC⊂Fn×1
q, its dual codeC⊥is deﬁned as
C⊥:=/braceleftbig
v∈Fn×1
q:/a\}⌊ra⌋k⌉tl⌉{tv,c/a\}⌊ra⌋k⌉tri}ht= 0,∀c∈C/bracerightbig
.
The dual code of a GRS code is also a GRS code, e.g., according to the following construction [44].
Deﬁnition 6. (Dual GRS Code) [44] For v= (v1,...,vn)∈F1×n
qdeﬁned as
vj=1
uj
/productdisplay
i∈[n],i/n⌉gationslash=j(αj−αi)
−1
∀j∈[n], (13)
whereuj/\⌉}atio\slash= 0, we have
G⊤
GRSq
n,k(α,u)GGRSq
n,n−k(α,v)=0k×(n−k), (14)
i.e.,GRSq
n,n−k(α,v)is an[n,n−k]code that is the dual of the code GRSq
n,k(α,u).14
Deﬁnition 7. (QCSA Matrix) We deﬁne the QCSAq
N,L(α,β,f)matrix as the N×Nmatrix
GQCSAq
N,L(α,β,f):=

β1
f1−α1β1
f2−α1···β1
fL−α1GGRSq
N,⌊N/2⌋(α,β)
/bracehtipdownleft/bracehtipupright/bracehtipupleft/bracehtipdownright
β1β1α1···β1α⌊N/2⌋−1
1β1α⌈N/2⌉−1
1β1α⌈N/2⌉
1···β1αN−L−1
1
β2
f1−α2β2
f2−α2···β2
fL−α2β2β2α2···β2α⌊N/2⌋−1
2β2α⌈N/2⌉−1
2β2α⌈N/2⌉
2···β2αN−L−1
2
..............................
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
˜Hβ
CβN
f1−αNβN
f2−αN···βN
fL−αN/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
GGRSq
N,⌈N/2⌉(α,β)βNβNαN···βNα⌊N/2⌋−1
NβNα⌈N/2⌉−1
N/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
˜Hβ
VβNα⌈N/2⌉
N···βNαN−L−1
N
, (15)
whereα= (α1,...,α N)∈F1×N
q,β= (β1,...,β N)∈F1×N
q,f= (f1,f2,...,fL)∈F1×L
q, allβi,i∈[N]are non-
zero, the terms α1,...,α N,f1,...,fLareL+Ndistinct elements of Fq,q≥L+N,L≤N/2. The sub-matrices
GGRSq
N,⌊N/2⌋(α,β)andGGRSq
N,⌈N/2⌉(α,β)identiﬁed in Equation (15) are the generator matrices of [N,⌊N/2⌋]and
[N,⌈N/2⌉]GRS codes, respectively. As a special case, setting β1=...=βN= 1, we have,
GCSAq
N,L(α,f)=GQCSAq
N,L(α,1,f). (16)
Remark 14. WhenNis an even number, the two sub-matrices GGRSq
N,⌊N/2⌋(α,β)andGGRSq
N,⌈N/2⌉(α,β)become the
same sub-matrix GGRSq
N,N/2(α,β).
Remark 15. TheQCSAq
N,L(α,β,f)matrix is the product of an N×Ndiagonal matrix diag(β1,β2,···,βN)
and theN×NCauchy-Vandermonde matrix GCSAq
N,L(α,f)invoked by CSA schemes (cf. [38, Equation (11)]).
The former is full rank since βn/\⌉}atio\slash= 0,∀n∈[N], and the latter is full rank according to [38, Lemma 1] becaus e
α1,···,αN,f1,···,fNare distinct ( q≥L+N). Since multiplication with an invertible matrix preserve s rank,
theQCSAq
N,L(α,β,f)matrix is an invertible matrix.
C. From CSA Scheme to QCSA Scheme
Given a CSA scheme over Fq, we show how to translate it into a QCSA scheme over a QMAC. The process is
described by the following three steps.
1) From the CSAq
N,L(α,f)matrix, construct two matrices Qu
N=GQCSAq
N,L(α,u,f),Qv
N=GQCSAq
N,L(α,v,f).
2) From Qu
N,Qv
N, construct a feasible N-sum Box, i.e., a MIMO MAC with channel matrix MQCSA .
3) Over the MIMO MAC, realize ‘over-the-air’ decoding of two instances of the CSA scheme. By the N-sum
box abstraction, this automatically maps to a quantum proto col (a QCSA scheme) and the efﬁciency gained
by ‘over-the-air’ decoding in the MIMO MAC translates into t he superdense coding gain over the QMAC.
These steps are explained next.
Step 1. Generation of QCSA matrices: Letu= (u1,...,u N)∈F1×N
q andv= (v1,...,vN)∈F1×N
q, where
vj=1
uj
/productdisplay
i∈[N],i/n⌉gationslash=j(αj−αi)
−1
∀j∈[N], (17)
such that the sub-matrix GGRSq
N,⌈N/2⌉(α,u)ofQu
Nand the sub-matrix GGRSq
N,⌊N/2⌋(α,v)ofQv
Nsatisfy
G⊤
GRSq
N,⌈N/2⌉(α,u)GGRSq
N,⌊N/2⌋(α,v)=0⌈N/2⌉×⌊N/2⌋, (18)
according to Equation (13) and Equation (14).
Step 2. A suitable N-sum box: TheN-sum box is speciﬁed by the following theorem.
Theorem 6. For theQu
NandQv
Nconstructed in Step 1, there exists a feasible N-sum box y=MQCSAxinFq
with theN×2Ntransfer matrix,
MQCSA=
IL0L×⌈N/2⌉0 0 0 0
0 0 I ⌊N/2⌋−L0 0 0
0 0 0 I L0L×⌊N/2⌋0
0 0 0 0 0 I ⌈N/2⌉−L
/parenleftbiggQu
N0
0 Qv
N/parenrightbigg−1
. (19)
A proof of Theorem 6 is presented in Appendix B.15
Step 3. QCSA Scheme as ‘Over-the-Air’ CSA: Using the MIMO MAC with channel matrix MQCSA identiﬁed
in Step 2, we now describe how to achieve ‘over-the-air’ deco ding of several instances of CSA schemes. Since the
MIMO MAC is actually an N-sum box, which in fact represents a quantum protocol with co mmunication cost N
qudits, a QCSA scheme is automatically implied for the QMAC t hrough theN-sum box abstraction.
First consider the case where we are given a CSA scheme with L≤N/2. With 2 instances of the CSA scheme
we have /parenleftbigg
A1
A2/parenrightbigg
=/parenleftbiggGCSAq
N,L(α,f)0
0 G CSAq
N,L(α,f)/parenrightbigg/parenleftbiggX1
δ,ν
X2
δ,ν/parenrightbigg
, (20)
which retrieves 2Ldesired symbols at the download cost of 2Nsymbols. Now the corresponding QCSA scheme
(over-the-air MIMO MAC) is obtained as follows.
y=MQCSA/parenleftbigg
diag(u)0
0diag(v)/parenrightbigg/parenleftbigg
A1
A2/parenrightbigg
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
x(21)
=MQCSA/parenleftbigg
diag(u)0
0diag(v)/parenrightbigg/parenleftbiggGCSAq
N,L(α,f)0
0 G CSAq
N,L(α,f)/parenrightbigg/parenleftbiggX1
δ,ν
X2
δ,ν/parenrightbigg
(22)
=MQCSA/parenleftbigg
Qu
N0
0 Qv
N/parenrightbigg/parenleftbiggX1
δ,ν
X2
δ,ν/parenrightbigg
(23)
=
IL0L×⌈N/2⌉0 0 0 0
0 0 I ⌊N/2⌋−L0 0 0
0 0 0 I L0L×⌊N/2⌋0
0 0 0 0 0 I ⌈N/2⌉−L
/parenleftbiggX1
δ,ν
X2
δ,ν/parenrightbigg
=/parenleftig
δ1
1,···,δ1
L,ν1
(↽),δ2
1,···,δ2
L,ν2
(↽)/parenrightig⊤
. (24)
where theNentries of uare non-zero, vis speciﬁed in Equation (17), ν1
(↽)represents the last ⌊N/2⌋−L
symbols of the vector ν1=/parenleftbig
ν1
1,...,ν1
N−L/parenrightbig
, andν(↽)(2)represents the last ⌈N/2⌉−Lsymbols of the vector
ν2=/parenleftbig
ν2
1,...,ν2
N−L/parenrightbig
. Multiplication by diag(u,v)in Equation (21) simply involves each server j∈[N]scaling
its answers of the two instances of the CSA scheme A1
j,A2
jbyuj,vj, respectively, and applying ujA1
j,vjA2
jto
the inputs of the N-sum box (MIMO MAC) corresponding to that server. Evidently , all2Ldesired symbols are
recovered, and the total download cost is Nqudits (one qudit from each server), for a normalized downlo ad cost of
N/(2L)qudits per desired dit. The improvement from N/L (classical CSA) to N/2L(QCSA) reﬂects the factor
of2superdense coding gain in communication efﬁciency.
IfL > N/2, we discard ‘redundant’ servers (cf. Remark 13) and only emp loyN′= 2N−2L < N servers,
choosing a CSA scheme with L′=N′/2, such thatN−L=N′−L′,i.e., the dimensions of interference are
preserved, which results in a download cost of N′/(2L′) = 1 qudit per desired symbol.
D. QCSA Scheme Application
Based on the approach described above, existing achievabil ity results based on CSA schemes in the classical
setting translate into corresponding achievability resul ts for QCSA schemes in the quantum setting. In particular,
the following corollaries follow immediately from this app roach.
Corollary 1. For the(N,M,K,X,T )MDSXSTPIR [38], where N >X+T+K−1, a QCSA scheme achieves
rate
RQ= min/braceleftbigg
1,2/parenleftbigg
1−/parenleftbiggX+T+K−1
N/parenrightbigg/parenrightbigg/bracerightbigg
, (25)
i.e., the user is able to recover L=NRQq-ary symbols of desired information for every N q-dimensional qudits
that it downloads from the servers.
Remark 16. In an MDSXSTPIR problem, there are Mmessages and Nservers. Every Ksymbols of one message,
together with Xrandom noise symbols, are encoded according to an [N,K+X]MDS code and each codeword
symbol is stored at one of the Nservers. Thus, the storage cost of every server is1
Mof the size of all the M16
messages, and any group of up to Xcolluding servers learn nothing about the Mmessages. A user wishes to
retrieve one of the Mmessages by querying the Ndistributed servers such that any group of up to Tcolluding
servers can learn nothing about the desired message index.
Appendix C provides a proof of Corollary 1. In addition to est ablishing achievable rates for quantum versions of
XSTPIR [37], MDS-XSTPIR [38] that have not been previously e xplored, Corollary 1 recovers existing achievability
results in Quantum PIR for the cases of TPIR [21] and MDS-TPIR [24]. Relative to prior works, the ﬁeld size
required by the QCSA scheme is linear in N, because an even q≥L+NwhereL≤N
2guarantees the existence
of theQCSA matrix, while in [21], the ﬁeld size is exponential in N, due to anO(N)fold ﬁeld extension step.
It is also noteworthy that prior quantum PIR schemes employ m ixed quantum states to achieve symmetric privacy,
i.e., the user does not learn more than his desired information. W hile the QCSA scheme does not automatically
ensure symmetric privacy, the same can be accomplished by no ise alignment based on shared common randomness
among servers as in [39]. In Section VI-B we discuss how we can achieve symmetric privacy automatically with
a non-maximal stabilizer based construction. Shared (clas sical) common randomness among servers is not difﬁcult
to achieve when the servers share quantum entanglements.
Corollary 2. For the(N,XA,XB),N > X A+XBSDBMM (secure distributed batch matrix multiplication)
problem deﬁned in [5], where Lmatrices A1,...,AL∈Fλ×η
qareXA-securely shared among Nservers, another
LmatricesB1,...,BL∈Fη×µ
qareXB-securely shared among the same Nservers, and the user wants to compute
theLproductsA1B1,A2B2,...,ALBL∈Fλ×µ
qby querying the N >X A+XBservers, a QCSA scheme achieves
the rate
RQ= min/braceleftbigg
1,2/parenleftbigg
1−/parenleftbiggXA+XB
N/parenrightbigg/parenrightbigg/bracerightbigg
, (26)
i.e., from every N·(λµ)q-dimensional qudits downloaded from Nservers, the user recovers L=NRQdesired
product matrices in Fλ×µ
q.
Section C-A provides a proof of Corollary 2. Let us note that i n the original problem deﬁned in [5], the S
matrices A1,...,AS∈FL×K
q and another Smatrices B1,...,BS∈FK×M
q are to be pairwise multiplied. The
parameters (S,L,K,M )from [5] are mapped to (L,λ,η,µ)to ﬁt the notation in this work.
Remark 17. In both corollaries, the rate achieved with the QCSA scheme c an be expressed as RQ= min{1,2RC},
whereRCis the rate achieved by the CSA scheme in the corresponding cl assical setting. Considering that rates
greater than 1 are not possible according to the Holevo bound [45], it is apparent that the QCSA scheme achieves
the maximal superdense-coding gain relative to the classic al CSA scheme.
VI. N ON-MAXIMAL -STABILIZER -BASED CONSTRUCTIONS
In Section II we noticed that the output of the measurement as sociated with a non-maximal stabilizer has less
digits than one would expect. The reason is that the states th at form a basis for the space W(cf. Equation (5))
associated to a non-maximal stabilizer are mixed states, so the remaining N−κoutput digits result as uniformly
random and can be discarded . Thus, non-maximal stabilizers can be useful to describe bl ack boxes that output only
κ q-ary digits while discarding the last N−κdigits, which we call (κ,N)-sum boxes .
Furthermore, given a maximal stabilizer with NgeneratorsS(V′), one can always obtain a non-maximal stabilizer
S(V)by choosing κof those. Conversely, given a non-maximal stabilizer with κgeneratorsS(V), one can always
complete the generator basis to obtain a maximal stabilizer S(V′).
These two observations suggest that, in order to obtain the s tabilized state of a non-maximal stabilizer S(V),
one can start with Nqudits in the mixed state |0/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{t0|⊗IqN−κ
qN−κand apply the same unitary as one would use to
generate|0/a\}⌊ra⌋k⌉tri}htWfrom|0/a\}⌊ra⌋k⌉tri}htin a maximal stabilizer S(V′)that completesS(V). After we apply a unitary ˜W(s)for
somes∈F2N
qand measure using PV′, the output will have N−κuniformly random digits.
Example 2. LetG=/parenleftbig1 1 0 0/parenrightbig⊤andV=/a\}⌊ra⌋k⌉tl⌉{tG/a\}⌊ra⌋k⌉tri}htcol. Clearly Gis a submatrix of the matrix determined by Sin
Example 1, so we can take Sas the maximal-stabilizer completion of S(V). Consider s= (x1,x2,x3,x4)∈F4
2. Let
ρ=|0/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{t0|⊗I
2be the original state, and let ρ′=|ϕ/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{tϕ|be its puriﬁcation, where |ϕ/a\}⌊ra⌋k⌉tri}ht=|0/a\}⌊ra⌋k⌉tri}ht⊗(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)/√
2.
Here we consider a puriﬁcation to clarify the evolution of th e state before the measurement. By applying the17
same gates as one would use to prepare the initial entangled s tate for the two-sum transmission protocol, i.e., a
Hadamard gate on the ﬁrst qubit and a CNOT gate with the ﬁrst qu bit as control and the second qubit as target
(cf. Example 1), we obtain the initial pure state
|ϕ′/a\}⌊ra⌋k⌉tri}ht= (|000/a\}⌊ra⌋k⌉tri}ht+|110/a\}⌊ra⌋k⌉tri}ht+|101/a\}⌊ra⌋k⌉tri}ht+|011/a\}⌊ra⌋k⌉tri}ht)/2,
which is stabilized by the three independent Weyl operators W(1,1,0,0,0,0),W(1,0,1,0,0,0)andW(0,1,1,0,0,0).
The state evolves in the following way:
|ϕ′/a\}⌊ra⌋k⌉tri}htZ(x3)⊗Z(x4)⊗I→/parenleftbig
|000/a\}⌊ra⌋k⌉tri}ht+(−1)x3+x4|110/a\}⌊ra⌋k⌉tri}ht+(−1)x3|101/a\}⌊ra⌋k⌉tri}ht+(−1)x4|011/a\}⌊ra⌋k⌉tri}ht/parenrightbig
/2
X(x1)⊗X(x2)⊗I→/parenleftbig
|x1x20/a\}⌊ra⌋k⌉tri}ht+(−1)x3+x4|x1x20/a\}⌊ra⌋k⌉tri}ht+(−1)x3|x1x21/a\}⌊ra⌋k⌉tri}ht+(−1)x4|x1x21/a\}⌊ra⌋k⌉tri}ht/parenrightbig
/2
CNOT 1,2⊗I→/parenleftbig
|x1(x1+x2)0/a\}⌊ra⌋k⌉tri}ht+(−1)x3+x4|x1(x1+x2)0/a\}⌊ra⌋k⌉tri}ht
+(−1)x3|x1(x1+x2)1/a\}⌊ra⌋k⌉tri}ht+(−1)x4|x1x1+x21/a\}⌊ra⌋k⌉tri}ht/parenrightbig
/2 =/parenleftig/parenleftbig
|x1/a\}⌊ra⌋k⌉tri}ht+(−1)x3+x4|x1/a\}⌊ra⌋k⌉tri}ht/parenrightbig
/√
2/parenrightig
⊗/parenleftig
(|(x1+x2)0/a\}⌊ra⌋k⌉tri}ht+(−1)x4|(x1+x21)/a\}⌊ra⌋k⌉tri}ht)/√
2/parenrightig
=
/parenleftig
X(x1)/parenleftbig
|0/a\}⌊ra⌋k⌉tri}ht+(−1)x3+x4|1/a\}⌊ra⌋k⌉tri}ht/parenrightbig
/√
2/parenrightig
⊗/parenleftig
(X(x1+x2)Z(x4)⊗I)(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)/√
2/parenrightig
H⊗I⊗I→(Z(x1)|x3+x4/a\}⌊ra⌋k⌉tri}ht)⊗/parenleftig
(X(x1+x2)Z(x4)⊗I)(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)/√
2/parenrightig
Thus, after applying the Weyl operator W(s)and reverting the initial CNOT and Hadamard gates we end up wi th
the qubits in the state
|ϕ′′/a\}⌊ra⌋k⌉tri}ht= (−1)x1+x3+x4|x3+x4/a\}⌊ra⌋k⌉tri}ht⊗/parenleftig
W(x1+x2,0,x4,0)(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)/√
2/parenrightig
.
Lettr :H→Rbe the trace operator that maps a state to the trace of its dens ity matrix. Let tr :H1⊗H2⊗H3→
H1⊗H2the partial trace over the third quantum system. In this case , given the density matrix D, the partial trace
is given by
tr(D) =1/summationdisplay
x=0(I⊗I⊗/a\}⌊ra⌋k⌉tl⌉{tx|)D(I⊗I⊗|x/a\}⌊ra⌋k⌉tri}ht).
Notice that, by the properties of the tensor product, the sta te over the ﬁrst qubit has density matrix |x3+x4/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{tx3+x4|
after applying the partial trace operator. On the other side ,
1
21/summationdisplay
x=0(I⊗/a\}⌊ra⌋k⌉tl⌉{tx|)/parenleftig
W(x1+x2,0,x4,0)(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)(/a\}⌊ra⌋k⌉tl⌉{t00|+/a\}⌊ra⌋k⌉tl⌉{t11|)W†(x1+x2,0,x4,0)/parenrightig
(I⊗|x/a\}⌊ra⌋k⌉tri}ht) =
1
2W(x1+x2,x4)/parenleftigg1/summationdisplay
x=0(I⊗/a\}⌊ra⌋k⌉tl⌉{tx|)(|00/a\}⌊ra⌋k⌉tri}ht+|11/a\}⌊ra⌋k⌉tri}ht)(/a\}⌊ra⌋k⌉tl⌉{t00|+/a\}⌊ra⌋k⌉tl⌉{t11|)(I⊗|x/a\}⌊ra⌋k⌉tri}ht)/parenrightigg
W†(x1+x2,x4) =
1
2W(x1+x2,x4)IW†(x1+x2,x4) =I
2.
We conclude that, by tracing out the third qubit, the state ha s the density matrix
ρout=|x3+x4/a\}⌊ra⌋k⌉tri}ht/a\}⌊ra⌋k⌉tl⌉{tx3+x4|⊗I
2,
which outputs the bit x3+x4and a random bit.
A. Stabilizer-Based (κ,N)-Sum Boxes
The setting for (κ,N)-sum boxes is similar to the one described for N-sum boxes in Section III, with the
difference that the transfer matrix Mhas dimensions κ×2NandN−κoutputs of the measurement are discarded.
The following theorem generalizes Theorem 1 to non-maximal -stabilizer-based sum boxes. The proof is omitted,
as it is the same as the one provided for Theorem 1.18
Theorem 7. LetG∈F2N×κ
q andG⊥∈F2N×2N−κ
q be matrices satisfying the conditions of Proposition 2, i.e.,
such that
•G=G⊥/parenleftbigIκ
0/parenrightbig,
•G⊤JG⊥=0,
•there exists H∈F2N×κ
q such that/parenleftbig
G⊥H/parenrightbig
is full rank.
Then there exists a stabilizer-based construction for a (κ,N)-sum box over Fqwith transfer matrix
M=/parenleftbig
0κ×2N−κIκ/parenrightbig/parenleftbig
G⊥H/parenrightbig−1∈Fκ×2N
q.
The following example shows the implementation of a (1,2)-sum box over 2qubits.
Example 3. Suppose we have two parties, Tx1 and Tx2, both possessing two bitsa= (x1,x3),b= (x2,x4)∈F2
2,
respectively. LetS=/a\}⌊ra⌋k⌉tl⌉{tW(1,1,0,0)/a\}⌊ra⌋k⌉tri}htbe a 1-dimensional stabilizer over 2 qubits. Notice that its generator is
the restriction to the ﬁrst two qubits of W(1,1,0,0,0,0),i.e., the ﬁrst Weyl operator that ﬁxes |ϕ′/a\}⌊ra⌋k⌉tri}htdeﬁned in
Example 2. The stabilizer has a generator matrix that can be c ompleted to a symplectic matrix Fas follows:
F=
1 0 0 1
1 0 0 0
0 1 0 0
0 1 1 0
.
Thus, we can choose matrices G⊤andHas
G⊤=
1 0 1
1 0 0
0 1 0
0 1 0
,H=
0
0
0
1
.
The output of the box is then given by
/parenleftbig03×1I1/parenrightbig/parenleftbig
G⊤H/parenrightbig−1x=/parenleftbig0 0 0 1/parenrightbig
0 1 0 0
0 0 1 0
1 1 0 0
0 0 1 1

x1
x2
x3
x4
=x3+x4.
Now, notice that the Weyl operator W(a)⊗W(b)applied by the transmitters together and the non-maximal
stabilizerScorrespond, respectively, to the Weyl operator W(s)and the stabilizer S(V)in Example 2. As the
outputs match, it is easy to see that the (1,2)-sum box simpli ﬁes the description of the non-maximal-stabilizer
construction.
Remark 18. From the discussion above, one can see that maximal stabiliz ers exhaust the scope of stabilizer-based
constructions for black boxes of the form Y=MX , whereM∈Fκ×2N
q . More precisely, consider matrices G,H
that satisfy the conditions of Theorem 1, i.e., the matrices associated to a stabilizer-based constructi on for an
N-sum box. Then there is a correspondence between UG,Hand the maximal stabilizer S, whereUG,His the
unitary that prepares the initial state |0/a\}⌊ra⌋k⌉tri}htW=UG,H|0/a\}⌊ra⌋k⌉tri}htfor theN-sum box andS=S(/a\}⌊ra⌋k⌉tl⌉{tG/a\}⌊ra⌋k⌉tri}htcol). If we want N−κ
of the outputs of an N-sum box to be discarded, we can consider the initial state |0/a\}⌊ra⌋k⌉tri}htW′=UG,H/parenleftig
|0/a\}⌊ra⌋k⌉tri}ht⊗IqN−κ
qN−κ/parenrightig
,
as operations on the qudits initially prepared in the mixed s tate do not affect their mixedness and measuring them
at the end of the sum-box operations outputs random digits. T hus,(κ,N)-sum boxes can be obtained from N-sum
boxes by changing the initial (unentangled) state to a mixed state and their description (as in Theorem 7) can be
formalized by using a submatrix of Gas the generator for the non-maximal stabilizer.
B. Applications of (κ,N)-Sum Boxes
The utilization of a (κ,N)-sum box may be perceived as inefﬁcient due to the presence of non-informative qudits
among the total Nqudits being transferred. Nevertheless, it has some meanin gful applications, e.g., it is useful to
make symmetric QPIR protocols which use the N-sum box construction without the need for shared randomnes s
among the servers like in classical PIR [39].19
Remark 19. Notice that, in this case, we do not need to provide any additi onal information to the servers to
provide symmetry for the protocol. In fact, we only need to ch ange the initial entangled state distributed to the
servers, rather than providing additional shared randomne ss to the servers which requires additional computations
and storage.
For instance, consider the output of a QCSA scheme as given in Equation (24), i.e.,
/parenleftig
δ1
1,···,δ1
L,ν1
(↽),δ2
1,···,δ2
L,ν2
(↽)/parenrightig⊤
,
whereνb
(↽)represents the last ⌊N/2⌋−Lsymbols of the interference vector νb=/parenleftbig
νb
1,...,νb
N−L/parenrightbig
forb∈[2].
This interference contains linear combinations of other ﬁl es stored in the server that might be retrieved over many
rounds by a malicious user. Thus, we want to “hide” the interf erence outputs by replacing them with random digits,
which can be achieved in the following way. Some details are o mitted, as the procedure is similar to the one shown
in Appendix B.
Consider two GRS codes C1= GRSq
N,L(α,u)andC2= GRSq
N,L(α,v)wherevis generated by uaccording to
Equation (13), then we have that C2⊆C⊥
1or, equivalently, G⊤
C⊥
1GC2=0(N−L)×LforL≤⌊N/2⌋. Similarly, we
have thatC1⊆C⊥
2or, equivalently, G⊤
C⊥
2GC1=0N−L×L. Let
GC⊥
b=/parenleftbig
GCbG′
Cb/parenrightbig
, b∈[2].
Consider the matrices
G=/parenleftbigg
GC10
0 G C2/parenrightbigg
∈F2N×2L
q,
G⊥=/parenleftbiggGC10 G′
C10
0 G C20 G′
C2/parenrightbigg
∈F2N×2(N−L)
q,
H=/parenleftbigg˜Hu
C0
0˜Hv
C/parenrightbigg
∈F2N×2L
q,
where˜Hu
Cand˜Hv
Care the Cauchy submatrices of QCSA matrices deﬁned in Equati on (15). This matrix satisﬁes
the conditions of Theorem 7, then there exists a (2L,N)-sum box with transfer matrix
M=/parenleftbig
0κ×2N−κIκ×κ/parenrightbig/parenleftbig
G⊥H/parenrightbig−1.
Clearly there exists a permutation matrix Pπas deﬁned in Equation (27) such that
/parenleftbig
G⊥H/parenrightbig
=/parenleftbiggGQCSAq
N,L(α,u,f) 0
0 G QCSAq
N,L(α,v,f)/parenrightbigg
Pπ.
The transfer matrix is given by
MQCSA=/parenleftbiggIL0 0 0
0 0 I L0/parenrightbigg/parenleftbiggQu
N0
0 Qv
N/parenrightbigg−1
.
It is easily veriﬁed that the output of the (2L,N)-sum box is just
/parenleftbig
δ1
1,...,δ1
L,δ2
1,...,δ2
L/parenrightbig⊤,
without the interference terms that appear in Equation (24) . The QCSA scheme is thus symmetric, as the remaining
N−2Loutputs are randomized by construction.20
VII. C ONCLUSION
In this paper we considered a quantum protocol based on the st abilizer formalism to improve the communication
rates of classical many-to-one networks employing quantum communication. Although the protocol proposed in
this study may be considered obvious from a quantum coding-t heoretic perspective, as noted in Remark 7, it may
not be as straightforward for the classical-coding communi ty. TheN-sum box represents a quantum black-box with
classical inputs and classical outputs that can communicat eNsums fromNtransmitters, each holding 2 symbols
from a ﬁnite ﬁeld. In a classical setting, assuming that the t ransmitters cannot talk to each other, the only way
to achieve the communication of Nlinear combinations of 2Ninputs is to send all the 2Nsymbols from the
transmitters to the receiver, compared to sending only Nqudits with the N-sum box. We presented an application
of such black box to improve the rates of CSA-based PIR and SDM M using the underlying superdense-coding
gain. Furthermore, we showed how we can create a symmetric CS A-based QPIR protocol by using a non-maximal-
stabilizer-based (κ,N)-sum box instead of sharing common randomness among the serv ers.21
APPENDIX A
PROOF OF LEMMA 3
Proof. The ﬁrst two claims (9) and (10) are true not just for a particu larΣ, but for every diagonal Σwith elements
in{0,1}.
LetΛ=/parenleftbigI−Σ Σ
−Σ I−Σ/parenrightbig
. First, we prove Equation (9) by testing the LIT condition on Λ. We have that det((I−
Σ)2+Σ2) = det(I−2Σ+2Σ2) = det(I) = 1 , sinceΣ2=Σby the fact that Σis a diagonal matrix with entries
in{0,1}.
Equation (10) follows by the fact that ΛJΛ⊤=J(that is,Λ⊤is symplectic), which can be easily proved by
employing Σ2=Σ.
Finally, we prove that there exists a signed column-swap ope ration (Σ) that gives us the desired full-rank left
half-matrix of (M′)⊤. For this we proceed according to Algorithm 1, which tries at mostNdifferent signed-swap
operations before declaring either success or failure.
Algorithm 1: Signed column swap
input :M=/parenleftbig
MlMr/parenrightbig
∈FN×2N
q
output:M′=/parenleftbig
M′
lM′
r/parenrightbig
∈FN×2N
q: det(M′
l)/\⌉}atio\slash= 0
M′←M;
M′
l←Ml;
M′
r←Mr;
i←1;
whilei≤Ndo
if(M′
l)·,iis linearly independent of the ﬁrst i−1columns of M′
lthen
i←i+1;
else if(M′
r)·,iis linearly independent of the ﬁrst i−1columns of M′
lthat are already ﬁxed then
(M′
l)·,i,(M′
r)·,i←(−M′
r)·,i,(M′
l)·,i;
i←i+1;
else
return Failure;
end
end
return Success;
If the algorithm exits with success, then we obtain a full-ra nkM′
las desired. To show that the algorithm cannot
fail, let us show that failure would lead to a contradiction. Suppose the algorithm fails and exits with the value
i<N . At this point, the ﬁrst i−1columns of M′
lare linearly independent, but the ithcolumn of Mland theith
column of Mrare each linearly dependent on the ﬁrst icolumns of Ml. Note that since the only manipulations
performed by the algorithm are signed-swap operations, by E quation (10) M′∈Mo. The remainder of the proof
of (11) uses the following two facts.
1) Since M′∈Mo, the2N×Nmatrix(M′)⊥=JM′spans the null-space of M′. Moreover, (M′)⊥∈Mo,
since multiplication by an invertible matrix preserves ran k and
(J⊤M′)⊤J(J⊤M′) = (M′)⊤JJJ⊤M′= (M′)⊤JM′=0.
Thus, any matrix whose columns are null-vectors of Mmust be self-orthogonal.
2) IfV=/parenleftbig
VlVr/parenrightbig⊤∈Mo, then the dot product between the ithrow ofVland thejthrow ofVris equal to
the dot product between the jthrow ofVland theithrow ofVr. In fact, V⊤JV=0implies that
V⊤JV=0=⇒/parenleftbig
Vr−Vl/parenrightbig/parenleftbig
VlVr/parenrightbig⊤=0
=⇒VrV⊤
l−VlV⊤
r=0
=⇒(VrV⊤
l)i,j= (VlV⊤
r)i,j,∀i,j∈[N]
=⇒(Vr)i·(Vl)j= (Vl)i·(Vr)j,∀i,j∈[N].22
Since the (i+1)thcolumn of Mland the(i+1)thcolumn of Mrare each linearly dependent on the ﬁrst icolumns
ofMl, there exists a 2×NmatrixVsuch that
V⊤=/parenleftbig
VlVr/parenrightbig
=/parenleftbigg
α1···αiαi+100···0 0 0
β1···βi000···0βi+10/parenrightbigg
,
αi+1βi+1/\⌉}atio\slash= 0, and(M′)⊤V=0. In fact, since the ﬁrst (i+1) columns of Mlare linearly dependent, there exists
a non-trivial linear combination of them with coefﬁcients α1,...,α i+1that produces the zero vector. Notice that
αi+1cannot be zero because the ﬁrst icolumns are linearly independent by assumption. Thus, the ﬁ rst row of V⊤
is in the null-space of M′andαi+1/\⌉}atio\slash= 0. The second row of V⊤is similarly in the null-space of M′andβi+1/\⌉}atio\slash= 0.
So,V∈Moby fact 1), but the dot product of the ﬁrst row of Vlwith the second row of Vrisαi+1βi+1/\⌉}atio\slash= 0,
whereas the dot product of the second row of Vlwith the ﬁrst row of Vris 0, which contradicts fact 2). This
contradiction proves Equation (11).
APPENDIX B
PROOF OF THEOREM 6
For a permutation π: [2N]→[2N], deﬁne,
Pπ:=/parenleftbig
eπ(1)eπ(2)···eπ(2N)/parenrightbig
, (27)
whereeiis theithcolumn of I2N. WhenPπis multiplied to the right of a 2N×2NmatrixA, the columns of
Aare permuted according to the permutation π. Also, note that P−1
π=Pπ−1=P⊤
π, whereπ−1is the inverse
permutation of π.
Now let us prove Theorem 6 by specifying the N-sum box construction according to Theorem 1. Deﬁne,
˜G=/parenleftigg
GGRSq
N,⌈N/2⌉(α,u) 0
0 G GRSq
N,⌈N/2⌉(α,v)/parenrightigg
, (28)
whereGGRSq
N,⌈N/2⌉(α,u)andGGRSq
N,⌈N/2⌉(α,v)are sub-matrices of Qu
NandQv
N, respectively. If Nis even, then ˜G
is a2N×Nsquare matrix, and we choose G=˜Gfor theN-sum box construction. If Nis odd, then ˜Gis a
2N×(N+1) matrix, i.e., it has an extra column. In this case we choose Gas the2N×Nleft-sub-matrix of ˜G,
leaving out the (N+1)thcolumn. Thus,
G=/parenleftigg
GGRSq
N,⌈N/2⌉(α,u) 0
0 G GRSq
N,⌊N/2⌋(α,v)/parenrightigg
. (29)
Note that Gis a sub-matrix of diag(Qu
N,Qv
N) =/parenleftig
Qu
N0
0 Qv
N/parenrightig
. LetHin Theorem 1 be chosen as the remaining
columns of diag(Qu
N,Qv
N)after eliminating the columns that are present in G. Thus,
/parenleftbig
G H/parenrightbig
=/parenleftig
˜G˜Hu
C˜Hu
V0 00
˜Hv
C˜G·,N+10
˜Hv
V/parenrightig
(30)
=/parenleftbigg
Qu
N0
0 Qv
N/parenrightbigg
Pπ. (31)
The column ˜G(:,N+ 1) does not appear in Equation (30) ( i.e., it is empty) if Nis even, because in that case
˜Ghas onlyNcolumns. The matrices ˜Hu
C,˜Hv
Cand˜Hu
V,˜Hv
Vare the respective Cauchy and Vandermonde matrices
speciﬁed in Equation (15). Evidently, the 2N×2Nmatrix/parenleftbig
G H/parenrightbig
has full rank 2Nas required for an N-sum
box construction Theorem 1, since the rank of a block-diagon al matrix is the sum of the ranks of its blocks and23
Qu
N,Qv
Nhave full rank N, whilePπis an invertible square matrix which preserves the same rank . The permutation
πis explicitly expressed as
π=(π(1),...,π(2N))
=/parenleftbig
L+1,L+2,...,L+⌈N/2⌉,
N+L+1,N+L+2,...,N+L+⌊N/2⌋
1,2,...,L,L +⌈N/2⌉+1,L+⌈N/2⌉+2,...,N,
N+1,N+2,...,N+L,
N+L+⌊N/2⌋+1,N+L+⌊N/2⌋+2,...,2N/parenrightbig
.(32)
Note that Pπmoves the columns of diag(Qu
N,Qv
N)with indices in [L+1 :L+⌈N/2⌉]∪[N+L+1 :N+L+⌊N/2⌋]
to the left-most part.
Now, notice that Gis SSO, i.e.,G∈Mo, since/parenleftbig
G H/parenrightbig
has full rank 2Nby the previous discussion and
G⊤JG=0by Equation (18). It follows that this N-sum box is feasible according to Theorem 1.
For the speciﬁed G,Hmatrices, the transfer matrix Mof the resulting N-sum box is
M=/parenleftbig
0NIN/parenrightbig
=/parenleftbig
G H/parenrightbig
=/parenleftbig
0NIN/parenrightbig
P−1
π/parenleftbigg
Qu
N0
0 Qv
N/parenrightbigg−1
(33)
Recall that P−1
π=Pπ−1. The expression of the permutation π−1can be written explicitly as
π−1=/parenleftbig
N+1,N+2,···,N+L,1,2,···,⌈N/2⌉,
N+L+1,N+L+2,···,N+⌊N/2⌋,
N+⌊N/2⌋+1,N+⌊N/2⌋+2,···,N+⌊N/2⌋+L,
⌈N/2⌉+1,⌈N/2⌉+2,···,N, (34)
N+L+⌊N/2⌋+1,N+L+⌊N/2⌋+2,···,2N/parenrightbig
.
Now it is easily veriﬁed that/parenleftbig
0NIN/parenrightbig
P−1
πin Equation (33) is the same as the matrix in Equation (19). Th eorem 6
is thus proved. /square
APPENDIX C
PROOF OF COROLLARY 1
Before we move forward to the general scheme translation, le t us start from a speciﬁc example, (N= 5,M,K=
2,X= 1,T= 1) -MDSXSTPIR to give an intuition of how are the messages store d among servers and what do
the parameters mean. Other details are omitted and can be fou nd in [38, Section IV].
1)(N= 5,M,K= 2,X= 1,T= 1) MDSXSTPIR: In this example, we have L=N−(X+T+K−1) = 2 .
Thus, in the classical setting, we will use the CSA scheme bas ed on the CSAq
N=5,L=2(α,f)matrix. In this setting,
for thebthinstance of a CSA scheme, there are Mmessages Wb,1,...,Wb,M. For anyb∈[2], i∈[M], message
Wb,i=/parenleftigg
Wb,i
1,1Wb,i
1,2
Wb,i
2,1Wb,i
2,2/parenrightigg
∈FL×K
q (35)
consists ofLK= 4 symbols from Fq.
For anyl∈[L], k∈[K], b∈[2], let
Wb
l,k=/parenleftig
Wb,1
l,kW2
l,k···Wb,M
l,k/parenrightig
∈F1×M
q, (36)
be the1×Mrow vector that contains the (l,k)thsymbol of all the Mmessages in the bthinstance of a CSA
scheme.
There areN= 5 servers and the storage at server n∈[N]isSn= (S1
n,1,S1
n,2,S2
n,1,S2
n,2), where
Sb
n,l=1
(f1−αn)2Wb
l,1+1
f1−αnWb
l,2+Zb
l∈F1×K
q, l∈[2], (37)24
andZb
1,Zb
2are independent random noise vectors that are uniform over F1×K
q. Thus, it is obvious that the storage
cost at each server is 2LM= 4M q-ary symbols. Comparing with the replicated storage, the st orage cost is reduced
to1
K=1
2, since theMmessages consist of 2LKM= 8M q -ary symbols in total. Also, due to the fact that the
messages are padded with random noise, any X= 1 server learns nothing about the Mmessages.
A user wishes to retrieve the θthmessage by querying the N= 5servers, without letting any T= 1server learn
anything about θ. In the scheme of [38], for one instance of MDSXSTPIR there ar eK= 2 rounds of retrieval.
In each round, the user downloads 1 q-ary answer symbol from each server. In the ﬁrst round the use r recovers
Wθ
1,1,Wθ
2,1, while in the second round the user recovers Wθ
1,2,Wθ
2,2. Thus, in each round, the user recovers L= 2
symbols of the desired message Wθby downloading 5symbols in total from the servers. The total downloaded
symbols are NK= 10 , while the retrieved desired symbols are LK= 4, thus achieving a rate of
RC=2
5=LK
NK=N−(X+T+K−1)
N.
Clearly, the rate is the same for two instances of the same sch eme.
2) QCSA scheme for general MDSXSTPIR: Let us brieﬂy introduce the general CSA code-based classica l MD-
SXSTPIR scheme [38], whereupon the translation to the quant um scheme is obtained as described in Section V-C.
In the classical scheme there are Krounds of retrieval. In round κ,κ∈[K]aCSAN,Lscheme is applied, where
0<L=N−(X+T+K−1). Speciﬁcally, according to [38, Equations (65),(66)], the Nanswer symbols from
theNservers in the κthround of the bthinstance of a CSA scheme are

Ab,(κ)
1...
Ab,(κ)
N

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Ab,(κ))=
1
f1−α1···1
fL−α11α1···αN−L−1
1
1
f1−α2···1
fL−α21α2···αN−L−1
2
.....................
1
f1−αN···1
fL−αN1αN···αN−L−1
N

/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
GCSAN,L(α,f)
Wb,θ
1,κ...
Wb,θ
L,κ
∗
...
∗
+
/summationtext
l∈[L]/summationtext
k∈[κ−1]1
(fl−α1)κ−k+1Wb,θ
l,k/summationtext
l∈[L]/summationtext
k∈[κ−1]1
(fl−α2)κ−k+1Wb,θ
l,k
.../summationtext
l∈[L]/summationtext
k∈[κ−1]1
(fl−αN)κ−k+1Wb,θ
l,k

/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
Rb,(κ)
(38)
=
1
f1−α1···1
fL−α11α1···αN−L−1
1
1
f1−α2···1
fL−α21α2···αN−L−1
2
.....................
1
f1−αN···1
fL−αN1αN···αN−L−1
N

/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
GCSAN,L(α,f)
Wb,θ
1κ+Fb,(κ)
1=δb,(κ)
1...
Wb,θ
Lκ+Fb,(κ)
L=δb,(κ)
L
∗+Fb,(κ)
L+1=νb,(κ)
1...
∗+Fb,(κ)
N=νb,(κ)
N−L

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Xb,(κ)
δ,ν(i), (39)
=GCSAN,L(α,f)Xb,(κ)
δ,ν(40)
whereWb,θ
1,κ,···,Wb,θ
L,κare theL=N−(X+T+K−1)symbols of the desired message Wb,θ,∗represents
undesired information (interference) whose explicit expr ession is redundant, Rb,(κ)is anN×1column vector
which only depends on the message symbols that are decodable from the previous κ−1rounds (to be proved for
the quantum scheme later), and Fb,(κ)=/parenleftig
Fb,(κ)
1Fb,(κ)
2···Fb,(κ)
N/parenrightig⊤
is acquired by projecting the Rb,(κ)along
the columns of GCSAN,L(α,f),i.e.,
Fb,(κ)=G−1
CSAN,L(α,f)Rb,(κ). (41)
With the answers in the form of Equation (39) it is clear that i n roundκ∈[K], with2instances of the
CSA scheme, 2L“desired" symbols δ1,(κ)
1,...,δ1,(κ)
L,δ2,(κ)
1,...,δ2,(κ)
Lcan be recovered by using the N-sum Box
speciﬁed in Theorem 6 when L≤N
2, according to Section V-C.25
Note that when κ= 1 we have that Rb,(κ)=0, which implies Fb,(κ)=0. Thus, in the ﬁrst round, 2Lmessage
symbolsW1,θ
1,1=δ1,(1)
1,...,W1,θ
L,1=δ1,(1)
L,W2,θ
1,1=δ2,(1)
1,...,W2,θ
L,1=δ2,(1)
Lare decodable.
Let us then prove the decodability of 2LsymbolsW1,θ
1,κ,...,W1,θ
L,κ,W2,θ
1,κ,...,W2,θ
L,κin theκthround by induction
forκ∈{2,...,K}.
Suppose that in the ﬁrst (κ−1)rounds2L(κ−1)symbols/braceleftig
Wb,θ
l,k/bracerightig
l∈[L],k∈[κ−1],b∈[2]are successfully decoded,
then the user can ﬁnd the values Rb,(κ),b∈[2]in theκthround as they only depend on the message symbols
that are decoded in the previous (κ−1)rounds. The user is then able to ﬁnd Fb,(κ),b∈[2], asFb,(κ)is just a
deterministic function of Rb,(κ). Then by subtracting Fb,(κ)
lfromδb,(κ)
l, the user is able to recover Wb,θ
l,κfor all
l∈[L],b∈[2]. That is to say, in the ﬁrst κrounds, the user is able to decode 2Lκsymbols/braceleftig
Wb,θ
l,k/bracerightig
l∈[L],k∈[κ],b∈[2].
The induction is thus completed.
Thus, the rate when L=N−(X+T+K−1)≤N
2can be computed as2L
N= 2/parenleftbig
1−X+T+K−1
N/parenrightbig
.
For the case where L>N
2, we can eliminate “redundant” servers and construct a rate 1 scheme as mentioned
in Section V-C. Corollary 1 is thus proved. /square
A. Proof of Corollary 2
Without loss of generality, let us prove that the speciﬁed ra te is achievable for retrieving the (1,1)thentry of the
Lproducts A1B1,...,ALBL. Other entries are similarly retrieved.
For anyl∈[L], letCl=AlBl, and letclbe the(1,1)thentry of the matrix Cl. According to [5, Equa-
tions (103),(110),(112)], after applying a CSAN,Lscheme with 0<L=N−(XA+XB), theNanswer symbols
from theNservers regarding the (1,1)thentry of the Lproducts are

Ab
1...
Ab
N

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Ab=
1
f1−α1···1
fL−α11α1···αN−L−1
1
1
f1−α2···1
fL−α21α2···αN−L−1
2
.....................
1
f1−αN···1
fL−αN1αN···αN−L−1
N

/bracehtipupleft /bracehtipdownright/bracehtipdownleft /bracehtipupright
GCSAN,L(α,f)
cb
1=δb
1...
cb
L=δb
L
∗=νb
1...
∗=νb
N−L

/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
Xb
δ,ν, (42)
wherecb
1=δb
1,···,cb
L=δb
Lare the(1,1)thentry of the Lproducts in the bthinstance of the CSA scheme,
i.e., theLdesired symbols, and ∗denotes the undesired information (interference) whose ex plicit expressions are
redundant.
Thus, with 2instances of the CSA scheme, 2Ldesired symbols can be recovered by using the N-sum Box
speciﬁed in Theorem 2 when L=N−(XA+XB)≤N
2, according to Section V-C. The rate of retrieving one
entry of the Lproducts is thus2L
N= 2/parenleftbigg
1−XA+XB
N/parenrightbigg
whenL≤N
2. Again, we can achieve rate 1by eliminating
“redundant” servers when L>N
2, as mentioned in Section V-C. Corollary 2 is thus proved. /square26
REFERENCES
[1] M. Allaix, Y . Lu, Y . Yao, T. Pllaha, C. Hollanti, and S. Jaf ar, “N-sum box: An abstraction for linear computation over many-t o-one
quantum networks,” arXiv preprint arXiv:2304.07561 , 2023.
[2] Y . Lu and S. A. Jafar, “Quantum cross subspace alignment c odes via the N-sum box abstraction,” arXiv preprint arXiv:2304.14676 ,
2023.
[3] B. Nazer and M. Gastpar, “Computation over multiple-acc ess channels,” IEEE Transactions on information theory , vol. 53, no. 10, pp.
3498–3516, 2007.
[4] J. Dean and S. Ghemawat, “MapReduce: simpliﬁed data proc essing on large clusters,” Communications of the ACM , vol. 51, no. 1,
pp. 107–113, 2008.
[5] Z. Jia and S. A. Jafar, “On the capacity of secure distribu ted batch matrix multiplication,” IEEE Transactions on Information Theory ,
vol. 67, no. 11, pp. 7420–7437, 2021.
[6] R. Ahlswede, N. Cai, S.-Y . Li, and R. W. Yeung, “Network in formation ﬂow,” IEEE Transactions on information theory , vol. 46, no. 4,
pp. 1204–1216, 2000.
[7] M. Belzner and H. Haunstein, “Network coding in passive o ptical networks,” in 2009 35th European Conference on Optical
Communication . IEEE, 2009, pp. 1–2.
[8] M. Hayashi, K. Iwama, H. Nishimura, R. Raymond, and S. Yam ashita, “Quantum network coding,” in STACS 2007: 24th Annual
Symposium on Theoretical Aspects of Computer Science, Aach en, Germany, February 22-24, 2007. Proceedings 24 . Springer, 2007,
pp. 610–621.
[9] A. S. Cacciapuoti, M. Calefﬁ, R. Van Meter, and L. Hanzo, “ When entanglement meets classical communications: Quantu m teleportation
for the quantum internet,” IEEE Transactions on Communications , vol. 68, no. 6, pp. 3808–3833, 2020.
[10] A. S. Cacciapuoti, M. Calefﬁ, F. Tafuri, F. S. Cataliott i, S. Gherardini, and G. Bianchi, “Quantum internet: Networ king challenges in
distributed quantum computing,” IEEE Network , vol. 34, no. 1, pp. 137–143, 2020.
[11] M. Calefﬁ, M. Amoretti, D. Ferrari, D. Cuomo, J. Illiano , A. Manzalini, and A. S. Cacciapuoti, “Distributed quantum computing: a
survey,” arXiv preprint arXiv:2212.10609 , 2022.
[12] C. H. Bennett and S. J. Wiesner, “Communication via one- and two-particle operators on Einstein-Podolsky-Rosen st ates,” Physical
review letters , vol. 69, no. 20, p. 2881, 1992.
[13] R. F. Werner, “All teleportation and dense coding schem es,”Journal of Physics A: Mathematical and General , vol. 34, no. 35, p. 7081,
2001.
[14] X. S. Liu, G. L. Long, D. M. Tong, and F. Li, “General schem e for superdense coding between multiparties,” Physical Review A ,
vol. 65, no. 2, p. 022304, 2002.
[15] V . N. Gorbachev, A. I. Trubilko, A. A. Rodichkina, and A. I. Zhiliba, “Teleportation and dense coding via a multipart icle quantum
channel of the GHZ-class.” Quantum Inf. Comput. , vol. 2, no. 5, pp. 367–378, 2002.
[16] A. El Gamal and Y .-H. Kim, Network information theory . Cambridge university press, 2011.
[17] D. Tse and P. Viswanath, Fundamentals of wireless communication . Cambridge university press, 2005.
[18] A. Goldsmith, Wireless communications . Cambridge university press, 2005.
[19] S. Song and M. Hayashi, “Capacity of quantum private inf ormation retrieval with multiple servers,” IEEE Transactions on Information
Theory , vol. 67, no. 1, pp. 452–463, 2020.
[20] ——, “Capacity of quantum private information retrieva l with collusion of all but one of servers,” in 2019 IEEE Information Theory
Workshop (ITW) . IEEE, 2019, pp. 1–5.
[21] ——, “Capacity of quantum private information retrieva l with colluding servers,” IEEE Transactions on Information Theory , vol. 67,
no. 8, pp. 5491–5508, 2021.
[22] M. Allaix, L. Holzbaur, T. Pllaha, and C. Hollanti, “Qua ntum private information retrieval from coded and colludin g servers,” IEEE
Journal on Selected Areas in Information Theory , vol. 1, no. 2, pp. 599–610, 2020.
[23] ——, “High-rate quantum private information retrieval with weakly self-dual star product codes,” in 2021 IEEE International Symposium
on Information Theory (ISIT) , 2021, pp. 1046–1051.
[24] M. Allaix, S. Song, L. Holzbaur, T. Pllaha, M. Hayashi, a nd C. Hollanti, “On the capacity of quantum private informat ion retrieval
from MDS-coded and colluding servers,” IEEE Journal on Selected Areas in Communications , vol. 40, no. 3, pp. 885–898, 2022.
[25] S. Song and M. Hayashi, “Quantum private information re trieval for quantum messages,” in 2021 IEEE International Symposium on
Information Theory (ISIT) , 2021, pp. 1052–1057.
[26] M. Hayashi and Á. Vázquez-Castro, “Computation-aided classical-quantum multiple access to boost network commun ication speeds,”
Physical Review Applied , vol. 16, no. 5, p. 054021, 2021.
[27] M. A. Sohail, T. A. Atif, A. Padakandla, and S. S. Pradhan , “Computing sum of sources over a classical-quantum mac,” IEEE
Transactions on Information Theory , vol. 68, no. 12, pp. 7913–7934, 2022.
[28] M. A. Sohail, T. A. Atif, and S. S. Pradhan, “Uniﬁed appro ach for computing sum of sources over cq-mac,” in 2022 IEEE International
Symposium on Information Theory (ISIT) . IEEE, 2022, pp. 1868–1873.
[29] M. Hayashi and S. Song, “Uniﬁed approach to secret shari ng and symmetric private information retrieval with collud ing servers in
quantum systems,” arXiv preprint arXiv:2205.14622 , 2022.
[30] A. S. Holevo, “Bounds for the quantity of information tr ansmitted by a quantum communication channel,” Problemy Peredachi
Informatsii , vol. 9, no. 3, pp. 3–11, 1973.
[31] D. Gottesman, “Stabilizer codes and quantum error corr ection,” 1997, PhD thesis, California Institute of Technol ogy.
[32] A. Ashikhmin and E. Knill, “Nonbinary quantum stabiliz er codes,” IEEE Transactions on Information Theory , vol. 47, no. 7, pp.
3065–3072, 2001.
[33] S. K. A. Ketkar, A. Klappenecker and P. Sarvepalli, “Non binary stabilizer codes over ﬁnite ﬁelds,” IEEE Transactions on Information
Theory , vol. 52, no. 11, pp. 4892–4914, 2006.27
[34] A. R. Calderbank, E. M. Rains, P. W. Shor, and N. J. A. Sloa ne, “Quantum error correction via codes over GF(4) ,”IEEE Trans.
Inform. Theory , vol. 44, no. 4, pp. 1369–1387, 1998.
[35] Y . Yao and S. A. Jafar, “The capacity of classical summat ion over a quantum MAC with arbitrarily replicated inputs,” 2023.
[36] R. Freij-Hollanti, O. W. Gnilke, C. Hollanti, and D. A. K arpuk, “Private information retrieval from coded database s with colluding
servers,” SIAM Journal on Applied Algebra and Geometry , vol. 1, no. 1, pp. 647–664, 2017.
[37] Z. Jia, H. Sun, and S. A. Jafar, “Cross subspace alignmen t and the asymptotic capacity of X-secureT-private information retrieval,”
IEEE Transactions on Information Theory , vol. 65, no. 9, pp. 5783–5798, Sep. 2019.
[38] Z. Jia and S. A. Jafar, “ X-secureT-private information retrieval from MDS coded storage with Byzantine and unresponsive servers,”
IEEE Transactions on Information Theory , vol. 66, no. 12, pp. 7427–7438, 2020.
[39] Z. Chen, Z. Jia, Z. Wang, and S. A. Jafar, “GCSA codes with noise alignment for secure coded multi-party batch matrix m ultiplication,”
IEEE Journal on Selected Areas in Information Theory , vol. 2, no. 1, pp. 306–316, 2021.
[40] D. Maslov and M. Roetteler, “Shorter stabilizer circui ts via Bruhat decomposition and quantum circuit transforma tions,” IEEE
Transactions on Information Theory , vol. 64, no. 7, pp. 4729–4738, 2018.
[41] T. Pllaha, O. Tirkkonen, and R. Calderbank, “Binary sub space chirps,” IEEE Transactions on Information Theory , vol. 68, no. 12, pp.
7735–7752, 2022.
[42] T. Pllaha, N. Rengaswamy, O. Tirkkonen, and R. Calderba nk, “Un-Weyl-ing the Clifford Hierarchy,” Quantum , vol. 4, p. 370, Dec.
2020.
[43] O. T. O’Meara, Symplectic groups , ser. Mathematical Surveys. American Mathematical Societ y, Providence, R.I., 1978, vol. 16.
[44] F. J. MacWilliams and N. J. A. Sloane, The Theory of Error-Correcting Codes . Elsevier, 1977, vol. 1.
[45] A. S. Holevo, “Bounds for the quantity of information tr ansmitted by a quantum communication channel,” Problemy Peredachi
Informatsii , vol. 9, no. 3, pp. 3–11, 1973.