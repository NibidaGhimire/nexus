Imaging effects due to pixel distortions in CdZnTe (CZT) detectors -
results from the HREXI Calibration Facility (HCF).
Arkadip Basaka, b, *, Branden Allena, Jaesub Honga, Daniel P. Violettea, Jonathan Grindlaya
aHarvard University - Center for Astrophysics, 60 Garden Street, Cambridge, MA - 02138, USA.
bAnton Pannekoek Institute, University of Amsterdam, Science Park - 904, 1098XH Amsterdam, NL.
Abstract. ProtoEXIST2 (P2) was a prototype imaging X-ray detector plane developed for wide-ﬁeld Time Domain
Astrophysics (TDA) in the 5 - 200 keV energy band. It was composed of an 8 8 array of 5 mm thick, 2 cm 2 cm
pixelated (3232) CdZnTe (CZT) detectors with a 0.6 mm pitch that utilize the NuSTAR ASIC (NuASIC) for
readout.1–3During the initial detector development process leading up to post-ﬂight examination of the entire detector
plane, distortions in expected pixel positions and shapes were observed in a signiﬁcant fraction of the detectors.3, 4
The HREXI (High Resolution Energetic X-ray Imager) Calibration Facility (HCF) was designed and commissioned
to improve upon these early experiments and to rapidly map out and characterize pixel non-uniformities and defects
within CZT detector planes at resolutions down to 50 m. Using this facility, the sub-pixel level detector response of
P2 was measured at 100 m5resolution and analyzed to extract and evaluate the area and proﬁle of individual pixels,
their morphology across the entire P2 detector plane for comparison with previous measurements and to provide
additional characterization.4In this article, we evaluate the imaging performance of a coded-aperture telescope using
the observed pixel morphology for P2 detectors. This investigation will serve as an initial guide for detector selection
in the development of HREXI detector planes, for the future implementation of the 4pi X-Ray Imaging Observatory
(4piXIO)6mission which aims to provide simultaneous and continuous imaging of the full sky ( 4sr) in the 3-200
keV energy band with '2 arcmin angular resolution and '10 arcsec source localization, as well as other, future
coded-aperture instruments.
Keywords: Detector arrays, Semiconductors, Coded apertures, Image analysis, Astronomy, X-rays.
*Arkadip Basak, arkadip.basak@cfa.harvard.edu
1 Introduction
The High-Resolution Energetic X-Ray Imager (HREXI) program was initiated for the develop-
ment of a modular and highly scalable CdZnTe (CZT) detector plane architecture for broadband,
high resolution (both spatial and spectral) space-borne wide-ﬁeld coded aperture X-ray telescope.
HREXI will enable new investigations for high energy time-domain astrophysics (TDA) to probe
the properties and populations of all classes of X-ray (and soft gamma-ray) transients arising from
accretion onto black holes, neutron stars, and white dwarf X-ray binary populations as well as
enable high angular resolution searches for gravitational wave counterparts detected with the next
generation gravitational wave interferometers coming online over the next decade.6
The HREXI (successor to ProtoEXIST2) detector plane architecture is a close-tiled array of
pixelated CZT detectors, each directly bonded to the NuSTAR ASIC (NuASIC).1A 3232 array
of anode inputs (gold studs) on a linear X-Y pitch of 0.6048 mm are bonded on the upper surface
of the NuASIC.1These are each directly bonded with a conductive epoxy to a matching array of
square 550 m anode pixels deposited (Au) on the anode surface of Redlen 20 20 mm CZT
crystals, each 3 mm thick.2, 3, 7The full ProtoEXIST2 (P2) detector plane was constructed from
a closely-tiled 88 (numbered from 1 to 64) array of these Detector Crystal Units (DCUs) and
demonstrated the ﬁrst prototype large-scale tiling of CZT/NuASICs. In P2 each individual CZT
detector was 5 mm thick and biased with a nominal -600 V operating voltage ( Vbias). More recent
implementations utilize 3 mm thick CZT under a -400 Vbias(nominal).
1arXiv:2303.10075v1  [astro-ph.IM]  17 Mar 2023P2 was ﬂown as the active element of a high-altitude (39 km)8balloon-borne coded aperture
telescope and recovered in pre-ﬂight condition during October of 2012, demonstrating stable op-
eration in a space-like environment. Subsequently, P2 underwent extensive post-ﬂight calibration
and characterization including a precise 1D scan with a collimated Am-241 source carried out in-
dependently on two axes over the full detector plane. This revealed the presence of substantial
pixel-position and size distortion in some detectors.4Further investigation and conﬁrmation of this
effect were enabled with the completion of the HREXI Calibration facility (HCF),5which is capa-
ble of mapping the 2D response of individual pixels on a scale down to 50 m. The causes of these
defects are unknown and are under active investigation. Since this is a persistent phenomenon ob-
served in different batches of CZT grown a year apart over an 8-year span, a study was carried out
in order to evaluate the potential consequences of these distortions on the imaging capabilities of
P2 and future space-borne wide-ﬁeld instruments utilizing these detectors. Here, we evaluate the
effects of distortions on the imaging capability using the P2 telescope parameters.
Coded Aperture Imaging is an imaging technique that has found widespread use in X-ray as-
tronomy since its inception nearly 4 decades9ago and continues to be an indispensable tool for
TDA in the hard X-ray regime. In general, this technique may be implemented in 1-D or 2-D using
a collimator with a known hole pattern and a position-sensitive detector which are mounted a ﬁxed
distance from one another. An X-ray source in the sky above the mask will posit photons on the
detector plane through the open mask elements resulting in a projection of the mask pattern in
X-rays on the surface of the detector plane which in turn is collated within detector data. We are
then able to recover the position of the X-ray source through cross-correlation of the mask pattern
with the reconstructed detector-plane image. In the case of the detector in our lab for P2, a 2D
random pixel pattern with a '1.1mm linear pitch is utilized for the mask, where the detector plane
is composed of a planar pixelated detector with '0.6 mm pitch located '880 mm below the mask
surface. The mask and the detector planes are mounted parallel to one another.
This article has been organized in the following manner. Section 2.1 describes our novel pixel-
stacking technique, section 2.2 describes a reconstructed stacked pixel after cross-correlating with
a single mask element, section 3 extends the same set of analyses to an ensemble of detectors,
section 4 provides an elementary strategy to correct for pixel distortions while section 5 refers to
primary results and future scope of work in the context of 4piXIO.
2 HCF data and analysis
The HREXI Calibration Facility (HCF) is comprised of an X-ray tube source10mounted'2.2 m
above a tungsten collimator5(mask) with an array 4 or 85etched 100m100m square holes
distributed on a 2 cm 2 cm DCU grid. The design of the mask assembly and the orientation
of the mask holes are constrained by the P2 detector event rate handling capability as mentioned
explicitly in section 5 of Basak et. al. 2020.5The collimator is mounted to a computer-controlled
bi-directional (XY) linear rail system with an accuracy/step size of 5 m. Mapping of the
response of individual pixels is carried out by placing the detector(s) underneath the mask, turning
on the X-ray tube source, and exposing the detector to the collimated beam for approximately
10 s at each location. The mask array is then moved to the next X, Y position to be measured.
Data collection continues while the mask is moved in a boustrophedon pattern5until the entire
detector has been exposed to the beam. Figure 1 elucidates the X-ray source ﬂux, the collimator,
the detector(s), and the precision bi-directional rail system in HCF with a schematic. The collected
2X-ray tube source fluxCollimator assemblyFlux through 100 µm X 100 µm holes P2 / HREXI detectorBi–directionalrail systemFig 1: Schematic showing the X-ray tube source ﬂux, the collimator assembly, and simultaneous
illumination of several 100 m100m pixels as either the P2 or the HREXI detector plane
move along a bi-directional (X,Y) rail system. Figure adapted from Basak et. al. 20205
event data from the detector are combined with the collimator position information to produce a
response map for each of the individual pixels in the detector plane. Co-addition of the response
of all pixels for single-pixel events, i.e. events that contain nearly all of the charge induced by
an incident X-ray for each individual pixel, are co-added producing a full-detector response map
(e.g., Figure 2).
The HCF5has been designed to enable rapid characterizations of these detector planes in
timescales'3 days. However, since HREXI detectors are still under development as mentioned in
section 1, this article presents results from calibration runs of its predecessor P2. Individual P2 de-
tectors, or detector crystal units (DCUs), consist of a single 5 mm thick CZT crystal with a 32 32
anode pattern on a 604.8 mpitch hybridized directly to a NuSTAR ASIC (NuASIC) that is used
to readout individual events and their energies. Figure 2 presents a representative sample of DCU
maps reconstructed from data collected with the HCF. The blank pixels on some of the DCUs have
either been identiﬁed as hot and were disabled during the collection of data or, in some cases, the
connection between the CZT crystal and the ASIC has failed, resulting in non-functional pixels.5
For annotating hot pixels, DCUs with large pileup effects were identiﬁed, followed by looking at
anomalous trends in pixel counts in the unexposed portions of a DCU. These trends are usually
characterized by a pixel having 2Xcounts when compared to an adjacent set of pixels. These
large discrepancies can’t be attributed to the changes in X-ray tube source,5, 10the aberrations of
mask hole patterns,5or a difference in mask layer thicknesses5and were classiﬁed as ‘hot’.
DCUs 34 and 13 represent two extreme cases within P2 that were detected through HCF-
derived DCU maps; one detector displays signiﬁcant warping of the pixel pattern throughout the
entire DCU, while the other shows uniform pixel response except at the corners. DCU 18 is
comparable to DCU 34, except for a few other blank pixels on one of the corners. The DCU
maps become incrementally warped and unconstrained within the pixel boundaries as one traverses
from DCU 34 to DCU 13 in ﬁgure 2, making the analyses of DCUs 34 and 13 from section
2.1 a representation of a set of extrema in the P2 detector plane. Note that the relative intensity
differences seen in some pixels are the results of non-uniformities in the HCF collimator hole size
which results in enhanced ﬂux in quadrants of some of the individual detectors5which has not
30.251.01.750.251.01.750.251.01.750.251.01.750.251.01.750.251.01.751.751.00.251.751.00.251.751.00.251.751.00.251.751.00.251.751.00.25
X (cm)Y (cm)Fig 2: HCF Detector maps of the P2 detector plane for DCUs 34, 18, 56, 58, 29, and 13. The size
of each DCU is 2cm 2cm
been calibrated out here. However, they have been accounted for in the subsequent section(s). The
ﬁgures in section 2.1 to 2.3 have also been limited to DCUs 34 and 13, while the P2 detector plane
as a whole has been considered in section 3.
2.1 Pixel Stacking
After obtaining DCU maps, we have devised a ‘pixel stacking’ technique that enables the simulta-
neous visualization and analysis of the morphologies of collections of any number of pixels within
our detector plane, which is necessary due to the nature of our scanning and standard data-analysis
techniques. The time-resolved event data are used to derive a response map (event rate) for each
of the individual pixels as a function of the mask position within the nominal '1 cm1 cm scan
region of a 2 cm2 cm DCU. The scan region of '1 cm1 cm stems from using 4 holes per
DCU in the mask assembly as mentioned speciﬁcally in sections 2.1 and 5 of Basak et. al. 2020.5
The scan regions for individual beams are then offset and combined to produce maps in physical
space which yields the sub-pixel response maps presented here. A small overlap in the scan region
enables the direct comparison and removal of relative differences arising from hole-to-hole varia-
tion in our collimator across the full detector region as mentioned explicitly in Basak et. al. 2020.5
A stacked sub-pixel for nthDCU in the P2 detector plane is deﬁned as,
Pi;jjn=1024X
k=11
GkCi;jjk; (1)
Indices i;jdenote each element in the sub-pixel space whereas index krepresents each of the
1024 pixels in DCU n. Pi;jjnis the counts in a stacked sub-pixel (i;j),Ci;jjkrepresents the counts
in each sub-pixel for pixel k. The normalization factor Gkdenotes the total counts in pixel kand
4X (mm)
Y (mm)
Fig 3: Stacked pixel image of DCUs 34, 18, 56, 58, 29, and 13. The conﬁnes of a stacked pixel
image increase progressively from DCUs 34 to 13. The stacked pixel representation of DCU 34
is well constrained within a '1.5 mm1.5 mm sub-pixel grid, whereas the stacked pixel image
of DCU 13 requires at least a '2.0 mm2.0 mm grid to constrain itself. The coordinate (0,0)
represents the true center of the stacked DCU pixel.
hence takes care of inter-pixel count rate differences within a DCU due to ﬂuctuations in Mini-
X X-ray source10ﬂux and/or differences in mask hole sizes. Gkis calculated by imposing a '
60-100 sub-pixels boundary for each pixel kdepending on the DCU being considered, followed
by a summation of their responses, only when pixel kis illuminated. This essentially means that
the indices i;jrun between 1 and 60-100. The size of the sub-pixel boundary is limited to '60
sub-pixels for a DCU 34 while it is '100 sub-pixels for DCU 13.
Figure 3 illustrates the stacked pixel plots for DCUs 34, 18, 56, 58, 29, and 13, while ﬁgure
4(left) demonstrates an ideal P2 DCU ‘stacked pixel’. The ﬂux in ﬁgure 4 has been normalized
to conform with that of a nominal DCU pixel in HCF and to match the counts in ﬁgure 3. The
distribution of counts for the DCUs 34 and 18 are well constrained within a '1.5 mm1.5 mm
sub-pixel grid, whereas the presence of a signiﬁcant number of warped pixels in DCUs 56, 58,
29, and 13 results in a diffused distribution of sub-pixel counts. The disabled pixels which appear
as pixels with zero counts in the sub-pixel response maps have been left out of these analyses.
A stacked DCU pixel essentially represents the entire DCU response superimposed on a single-
pixel grid, with the inter-pixel ﬂux differences either due to ﬂuctuations in X-ray source ﬂux and
variations in mask hole sizes across a DCU or sections of DCUs corrected out. Cross-correlating
a stacked DCU pixel with a single P2 mask element yields an image, encoding the entire DCU
response when irradiated by an on-axis uniform source as mentioned in section 1.
2.2 Stacked pixel Image reconstruction
A stacked DCU image as seen from the sky is reconstructed by cross-correlating (a convolution
operation) a single P2 '1:1mm mask element with a stacked DCU pixel obtained in section 2.1.
5-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
2.5×102
2.6×102
2.7×102
2.8×102
2.9×102
3×102
Normalized countsFig 4: A ﬂux-normalized ideal P2 DCU stacked pixel(left) without any non-uniformities and a
reconstructed stacked pixel image after cross-correlating the DCU stacked pixel with a mask ele-
ment(right) size of 1.1 mm.
The ﬂux coming through from the mask element to the DCU pixel is assumed to be uniform, and
hence accordingly distributed among all sub-mask elements and normalized to match the ﬂux in
a DCU stacked pixel. Figure 5 shows stacked-pixel reconstructed images from DCUs 34, 18, 56,
58, 29, and 13, while ﬁgure 4(right) shows a ‘reconstructed stacked pixel image’ for an ideal DCU
pixel. The ‘reconstructed stacked pixel image’ is analogous to the point spread function of a DCU
calculated at a sub-pixel resolution for a continuum X-ray ﬂux between '5 - 25 keV.5When
ﬁgures 3 and 5 are set against each other, we can observe that the size of the reconstructed pixels
increases from DCUs 34 to 13, and the shape of each conforms with that of the stacked pixel.
The artifacts around each stacked pixel which lie beyond the mask element size, are smoothed
out in the case of a reconstructed stacked pixel as seen in ﬁgure 5. In order to further analyze
the reconstructed pixel images and quantify their morphologies, we select DCUs 34 and 13 as
mentioned in section 2.
Figure 6 refers to zoomed-in reconstructed stacked pixel images from DCUs 34 and 13. The
contour lines form boundaries within which 50%, 90%, and 95% of events are recorded. DCU
34 represents a best-case scenario in P2 where 95% of the total counts are constrained within 15
sub-pixels, whereas for DCU 13 the conﬁnes get extended up to 19-20 sub-pixels for the same
fraction of counts. Moreover, the shapes of the contours in DCU 34 conform more closely to that
of an ideal .6 mm.6 mm sub-pixel grid, whereas the ones in DCU 13 are elongated along one
of the diagonals matching the distribution of counts in the stacked pixel image.
2.3 From stacked pixel to angular offsets
The reconstructed stacked pixel images, along with their contour boundaries are used to estimate
the effective pixel sizes in each DCU. The presence of variations in DCU stacked pixels relative to
the mask hole pattern affects the angular resolution in a coded-aperture telescope.11The angular
resolution for a DCU in a P2-like coded aperture telescope is given by:9
ang= tan 1p
S2
m+ S2
d
f
; (2)
6X (mm)
Y (mm)
Fig 5: ‘Reconstructed Stacked pixel image’ of DCUs 34, 18, 56, 58, 29, and 13. The boundaries
of a reconstructed stacked pixel image increase progressively from DCUs 34 to 13. The cross-
correlated stacked pixel image of DCU 34 is well constrained within a '1515 sub-pixel grid,
whereas DCU 13 requires at least a '2323 sub-pixel grid to constrain itself.
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
105
104
103
Normalized counts
Fig 6: Reconstruction of the detectors’ response on the sky using the ‘stacked pixel’ images for
DCUs 34(left) and 13(right). The contour lines represent boundaries containing 50%, 90%, and
95% of counts as one moves successively from the center to the outer conﬁnes of the reconstructed
stacked pixel.
7where angis the angular resolution, Sm, and Sdare the sizes of the mask-hole and the pixel
respectively, fis the focal length of the telescope, which is essentially the distance between the
mask and the detector plane. For a P2-like telescope, Smis 1.1mm and fis 888 mm. To calculate
Sd, we use ﬁgure 4 (left) i.e. an ideal stacked pixel and Smto be 1.1 mm. The term on the
numerator in equation 2 turns out to bep
S2
m+ S2
d'1:26mm . We draw contour boundaries at
1.26mm on the ideal reconstructed stacked pixel and calculate the fraction of counts encompassed
within ('95%). The 95% contour boundaries as inferred from ﬁgure 6, can then be used to set the
effective pixel sizes ( Sd) to'1.4 mm and'1.9 mm for DCUs 34 and 13 respectively. Since Sd
values are an approximation, we henceforth refer to the term deﬁned by ‘ ang’ as angular offsets,
a proxy for angular resolution.
If a hypothetical P2-like telescope is primarily composed of DCU 34 like DCUs, its angular
offset is'6.7 arcmins, while if it is constructed using DCU 13 like DCUs, the angular offset
turns out to be'8.5 arcmins. The design speciﬁcations of HREXI detector planes have not been
ﬁnalized yet. Hence, is it imperative to look at the changes in the effective pixel sizes, and by
extension to the angular offsets as a function of the mask size element Sm.
Figure 7 demonstrates this for DCUs 34 and 13 by reconstructing stacked pixel images for
different mask sizes. The contour lines represent the effective pixel size boundaries, while the
labels illustrate the values of Smin mm. The background(s) along with its color scheme can be
used to get an estimate of the angular offsets of the pixels from their centers (annotated by a ‘+’)
for a ﬁxed value of f = 888:0mm. The presence of regular contours in the DCU-34 reconstructed
image(left) implies a quasi-linear increase in the effective pixel size, with increasing values of the
mask element size. DCU 13 has contours elongated along one of the diagonals for smaller values
ofSm. However, the shapes approach that of a regular mask pixel for larger values ( '2mm) i.e.
when Smtends towards Sd.
Theangalong with signal-to-noise ratio (SNR) is used to determine the source localization of
a coded-aperture telescope. The explicit calculation(s) of SNR is predicated upon the distribution
of open and closed mask elements,12the background rate(s), the position of a pixel in a particular
DCU, and more importantly the position of a DCU in the P2 detector plane. Pixels around the edge
of a DCU are exposed to additional background radiation on account of the gaps introduced by the
wire bonds to control and readout NuASICs.8Pixels adjacent to or in the vicinity of disabled hot
pixels also have a proclivity to exposure to more background.8Moreover, in-ﬂight calibration(s)
have clearly shown that there is a gradual increase in background counts as one moves to the
edge of a DCU8thereby making estimates of the SNR and by extension the angular resolution
non-trivial.
3 Detector stacked pixel
P2 detector comprises of an 88array of DCUs and the HREXI detector plane(s) is slated to
have an even bigger array of DCUs (at least 1616).6Hence, we construct detector ‘stacked
pixel image(s)’ averaged over all DCUs in the entire detector plane followed by the calculation of
angular offset(s). Equation 1 can be modiﬁed such that it takes into account the mean contribution
from each DCU in the detector plane,
Di;j=1
NNX
n=1Pi;jjn; (3)
8-1.5 0 1.5
X (mm)-1.501.5Y (mm)0.6
1.11.8
2.4
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
0.61.11.8
2.4
0246810Angular offset (arcmin)Fig 7: Reconstructed stacked pixel images for DCUs 34(left) and 13(right) for different mask
element sizes. The contour lines represent the effective pixel size ( '95% counts boundaries),
while the labels illustrate the values of mask element size ( Sm) in mm. The color scale (s) illustrates
the effective angular offset of the pixels from the pixel center, which in turn is represented by a ‘+’
. The blue contour line corresponding to 1.1 mm represents the mask element ( Sm) size of a
P2-type telescope.
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
107
106
105
104
103
102
Normalized counts
Fig 8: Left: Stacked pixel image for the entire P2 detector plane. Right: Stacked pixel image for
hypothetical HREXI detector plane made from a 50:50 split of DCU 34 and DCU 13-like detectors.
Here, Di;jrepresents the counts in a stacked detector sub-pixel (i;j). The index nrepresents
the DCU number in a NDCU detector plane. The other terms and indices in equation 3 are
the same as equation 1. Equation 3 can be modiﬁed to construct ‘stacked pixel image(s)’ of a
hypothetical HREXI detector plane comprising an ensemble of P2-type DCUs in terms of their
weighted averages.
Di;j= W nNX
n=1Pi;jjn; (4)
Here Wndenotes the weighted contribution from each DCU to the detector ‘stacked pixel
image’. For a HREXI detector plane made up of 50% DCU 34 like detector and 50% DCU 13 like
detectors, N = 2 ,W1= 0:5andW2= 0:5.
9-1.5 0 1.5
X (mm)-1.501.5Y (mm)0.6
1.11.8
2.4
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
0.6
1.11.8
2.4
0246810Angular offset (arcmin)Fig 9: Reconstructed stacked pixel images for P2 and a hypothetical HREXI detector plane for
different mask element sizes. The contour lines represent the effective pixel size ( '95% counts
boundaries), while the labels illustrate the values of mask element size ( Sm) in mm. The colorbar(s)
illustrates the effective angular offset(s) of the pixels from the center, which in turn is represented
by a ‘+’. The blue contour line corresponding to 1.1 mm represents the mask element size ( Sm) of
a P2 type telescope.
Figure 8 shows the stacked pixel image for a P2 detector plane, along with a sample HREXI
detector plane constituted from a 50:50 split of DCU 34 and 13-like detectors. The presence of
disabled hot pixels, the removal of elastomeric bond separation in DCUs along with other distor-
tions in the entire plane result in a noisier image in the case of P2. Cross-correlating a detector
stacked pixel with different sizes of mask elements, gives us an estimate of the detector’s effective
pixel size, and in turn the detector’s angular offset for a ﬁxed focal length fwithout any statistical
considerations. The contour lines in ﬁgure 9 represent the effective pixel sizes both in terms of
sub-pixel units and arcmins for different values of Sm, while the blue line demonstrates the case
for P2 type detector i.e. Sm= 1:1mm.
The primary parameter of interest from the reconstructed stacked pixel image i.e. the effective
pixel size turns out to be '18 sub-pixels for a P2 type detector, whereas it is '19 sub-pixels for
an HREXI detector plane comprising of an equal number of DCU 13 and DCU 34 type detectors.
As mentioned in section 2.3, the design speciﬁcations of the next generation HREXI detector
plane(s), especially in terms of Smandfhave not been ﬁnalized. Figures 7 and 9 already illustrate
the angular offset variations for different values of Sm, and also that the effective pixel sizes tend
towards the mask element size for sufﬁciently large values of Sm, further illustrating the crucial
interplay between SmandSdto optimize source localization.9, 12
4 Correcting detector distortions - the centroid approach
A method of mitigating asymmetrical stacked pixel shapes would be to superimpose pixels on
top of each other after aligning their centroid(s) rather than embossing them on the ideal 66
sub-pixel grid. Figure 10 (top) elucidates the reconstructed stacked pixel image along with its
effective pixel size for DCU 33, before and after the centroid corrections have been applied, while
ﬁgure 10(bottom) does the same for DCU 13. DCU 34 looks very similar to that of ﬁgure 6
whereas the asymmetric elongation along one of the diagonals for DCU 13 is mitigated. This
essentially implies that the non-uniform charge diffusion occurrences beyond pixel boundaries can
10-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
-1.5 0 1.5
X (mm)-1.501.5Y (mm)
105
104
103
Normalized counts
105
104
103
Normalized countsFig 10: Top: ‘Reconstructed stacked pixel images’ for DCUs 34 before(left) and after(right) the
centroid corrections have been applied. Bottom: ‘Reconstructed stacked pixel images’ for DCUs
13 before(left) and after(right) the centroid corrections. The white and blue contours(s) encompass
the effective pixel boundaries ( Sd) before and after the application of the centroid corrections for
each DCU.
be corrected by realigning pixels, whereas such events occurring uniformly across all four-pixel
boundaries are harder to account for. The effective pixel size for DCU 13 now reduces to '18
sub-pixels while there is virtually no change for DCU 34.
Figure 11 illustrates vector maps for DCUs 34 and 13, aligning each pixel from its true center to
its calculated centroid. The length and the distribution of vectors are measures of non-uniformities
present in a DCU region. Shorter and non-existent vectors imply uniform regions whereas longer
vectors ﬂock together in an imperfect region of a DCU. These vector maps calculated explicitly
for each DCU should be used in tandem with in-ﬂight observations to correct for systematic pixel
position uncertainties before any contribution from the background.
The change in the contour boundaries before and after application of the centroid correction(s),
and by extension of the angular offset is explicitly illustrated in Figure12 for DCUs 13 and 34, the
entire P2 detector and a hypothetical HREXI detector comprising of 50% DCU 13 and 50% DCU
34 type detectors. The reduction in the angular offset becomes more apparent for DCU 13 in ﬁgure
12 (right), whereas things remain virtually identical for the other three cases.
Figure 13 illustrates a schematic diagram of a DCU before (Top) and after (bottom) applying
vector maps correction, pixel stacking, and then cross-correlation with a mask element. The col-
11X (pixels)X (pixels)Y (pixels)Fig 11: Vector maps for aligning each pixel of DCUs 34(left) and DCU 13(right) from its true
center to its calculated centroid. The X-Y axes have been labeled in pixels, as each vector in the
map represents the correction per DCU pixel. The size of each pixel is '0:604mm as mentioned
in section 1.
1.2 1.8
Mask size Sm (mm)6912Angular offset (arcmin)
P2 mask (1.1 mm)DCU 13
DCU 34
P2
HREXI
1.2 1.8
Mask size Sm (mm)6912
P2 mask (1.1 mm)DCU 13
DCU 34
P2
HREXI
Fig 12: The variation(s) of angular offset(s) for different mask size elements ( Sm) before (left) and
after (right) application of the centroid correction routine. The red line corresponds to the P2 mask
size element of 1.1 mm.
12….Pixels stacked on true center
Apply vector maps correctionCross-corelate with Mask elementMask….Pixels stacked on centroidMisaligned DCU
Reduced effective pixel sizeΔangFig 13: Schematic diagram showing a DCU before (Top) and after (bottom) applying vector maps
correction, pixel stacking, and then cross-correlation with a mask element, with an annotated ang.
The colored lines on the bottom right diagram signify different sizes of mask elements used and
their corresponding angs.
ored lines on the bottom right diagram signify different sizes of mask elements and the resultant
stacked pixel from an edge-on view, along with their corresponding angular offsets ang. The
change in the effective pixel boundaries(s) before and after the correction(s) can be used to esti-
mate the change in the relative source counts within a reconstructed stacked pixel. This translates
to a change in the SNR for a given DCU, as events outside the pixel boundaries(s) would be in-
correctly assigned to the neighboring pixel(s) while applying the cross-correlation algorithm and
lead to a degradation of the source signal. The source detection SNR ( ^S=S) for a coded aperture
telescope can be quantiﬁed from section 3 in Skinner et. al. ’0812as a function of source counts
and background counts ( CS;CB), detector area (A), and coding fraction (F)
^S=S= C Ss
FA(1 F)
FCS+ C B; (5)
A relative gain in source counts (dC S), leads to a corresponding change in the background
counts dCB, and hence the relative change in SNR can be quantiﬁed as a function of the relative
change in source counts (dC S=CS), and a background scaling parameter = C B=CS
d(^S=S)
^S=S=dCS
CS
1 F
2CS(F +)
; (6)
Here, dCS= C S CS0.CSandCS0refer to the source counts in the stacked pixel before
and after the centroid corrections. For nthDCU in the detector plane, CS=PPn, whereas
13Table 1: Primary results from four sets of detector planes P2, HREXI, and the two DCUs 13 and
34, for a zero external background case.
DetectorPixel size
(mm)Offset
(arcmin)Pixel size after
centroid (mm)Offset after cen-
troid (arcmin)SNR
DCU 13 1.91 8.53 1.88 7.6 4%
DCU 34 1.43 7.13 1.58 7.1 1%
P2 1.87 7.6 1.84 7.53 '1%
HREXI 1.82 7.3 1.81 7.25 1%
CS0=PP0
n. The summation for both cases should be along the contour boundary C0after the
centroid corrections. PnandP0
nillustrate the DCU/detector stacked sub-pixel before and after the
centroid corrections. The coding fraction (F) refers to the ratio of open to closed mask elements
and is ﬁxed at 0.5. For DCU 34 the relative gain in SNR is almost negligible (1%) since the
reconstructed stacked pixel image looks identical before and after the centroid corrections, while
it is about'4%for DCU 13 in a P2 type telescope, without additional background. The relative
gain in SNR becomes more pronounced as one transitions to smaller mask hole sizes since the
DCU non-uniformities have bigger effects on the contour boundaries as illustrated in ﬁgure 7. The
SNRcan be as high as 8%for DCU 13 and a mask hole size of 0.6 mm. The primary results from
this set of analyses have been summarized in table 1 for Sm= 1:1mm andf = 888mm i.e. the P2
telescope parameters.
5 Discussions and Future work.
The efﬁciency of an X-Ray telescope to resolve different sources in the sky depends directly on the
capability of the detector to correctly reconstruct event positions on the detector plane. In order
to characterize the deviation of our detector systems from our ideal 32 32 anode pattern, we
have stacked the individual pixel responses relative to the ideal anode pattern using equation 1
which calculates the effective average pixel response and morphology of each DCU. Expanding
this further, in section 3 we have characterized the average pixel size and shape for the entire
P2/HREXI detector plane, and used these quantities to probe the effects of our imperfect detectors
on angular offset(s) for a number of different scenarios (see section 2). Section 4 illustrates a
strategy to eliminate some of the non-uniformities using pixel centroiding. Allen et. al.4calculates
DCU vector maps explicitly for the next generation of HREXI detectors. Moreover, there have
been attempts to develop a detector position reconstruction algorithm as a function of interaction
depth in the CZT crystal and the Vbiasbetween the anode and the cathode.4, 13Studies of pixel
sizes as a function of Vbiasphenomenologically reveal the decrease in size of these distortions
without a change in their morphology and pattern4asVbiasincreases. This can be qualitatively
attributed to the decrease in charge diffusion in direction(s) orthogonal to the direction of photon
propagation with the increase in Vbias. At present, the exact physical origins of these anomalies are
unknown and require further work. Future investigation is planned to investigate the origin of these
anomalies by extracting a cross-section of the crystal to enable direct characterization of the CZT
bulk properties. Additionally, a comparison with 3mm detectors is also planned, which would
14delve deeper into the quantiﬁcation of pixel sizes and morphologies as a function of interaction
depth.
The sensitivity of a hard X-ray telescope is also dependent on the contribution of the stochastic
background rate to the SNR, hence co-simulating response from the HREXI detector plane along
with an energy-dependent background model is essential to get a more accurate estimate of the
background rate. Since the ﬁnal design speciﬁcations of the next generation detector planes have
not been zeroed in on yet, and the background rates are heavily dependent on the geometry, orien-
tation, and the material of shields used around the detector plane,3this analysis beyond the scope
of this current article. However, a zeroth order calculation of SNR has been included in section 4.
HCF’s capability to scan entire large-area detector planes on timescales of '3 days5enables
rapid characterization of each of the individual detectors’ impact on the angular resolution of the
full detector plane. In future works, imaging simulations using detectors with non-ideal spatial
responses, that mimic those exemplars thus far observed for 5 mm and 3 mm CZT material, will
be carried out to inform selection criteria for future CZT-based telescopes. Furthermore, updated
characterizations of CZT quality from recently fabricated detectors will be integrated into this
analysis in order to perform a trade study for the evaluation of the cost-beneﬁt ratio of detector
screening. Ultimately this trade study would be carried out and applied to the fabrication and
integration of future hard X-ray telesocpes utilizing the code-aperture imaging technique.
6 Acknowledgements
This work was supported by NASA grant NNX17AE62G. The authors would like to thank Stan
G. Corteau and Mike Mckenna of Harvard John A. Paulson School of Engineering and Applied
Sciences machine shop for their support during the fabrication of HCF. The authors would also like
to thank the anonymous reviewer(s) for their comments which improve the quality, readability, and
content of the paper.
References
1 F. A. Harrison, W. W. Craig, F. E. Christensen, et al. , “The Nuclear Spectroscopic Telescope
Array (NuSTAR) High-energy X-Ray Mission,” The Astrophysical Journal 770, 103 (2013).
2 J. Hong, , B. Allen, et al. , “Tiled array of pixelated czt imaging detectors for protoexist2 and
mirax-hxi,” IEEE Transactions on Nuclear Science (TNS) 60(6), 4610–4617 (2013).
3 B. Allen, J. Hong, J. Grindlay, et al. , “Development of the protoexist2 advanced czt detector
plane,” in 2011 IEEE Nuclear Science Symposium Conference Record , 4470–4480 (2011).
4 B. Allen, J. Hong, J. Grindlay, et al. , “Sub-pixel position reconstruction in ﬁnely-pixelated
czt detectors,” In preparation .
5 A. Basak, B. Allen, J. Hong, et al. , “HREXI calibration facility: mapping out subpixel-level
responses from high-resolution cadmium zinc telluride imaging x-ray detectors,” Journal of
Astronomical Telescopes, Instruments, and Systems 6, 026002 (2020).
6 J. Grindlay, B. E. Allen, J. E. Hong, et al. , “High-resolution x-ray imaging spectrometer
(HREXI) SmallSat Pathﬁnder (HSP) (Conference Presentation),” in UV, X-Ray, and Gamma-
Ray Space Instrumentation for Astronomy XXI , O. H. Siegmund, Ed., 11118 , International
Society for Optics and Photonics, SPIE (2019).
7 B. H. G. Rodrigues, J. E. Grindlay, B. Allen, et al. , “The high resolution X-ray imaging
detector planes for the MIRAX mission,” Journal of Instrumentation 8, P09010 (2013).
158 J. Hong, B. Allen, J. Grindlay, et al. , “Imaging Analysis of the Hard X-Ray Telescope Pro-
toEXIST2 and New Techniques for High-resolution Coded-aperture Telescopes,” The Astro-
nomical Journal 153, 11 (2017).
9 E. Caroli, J. B. Stephen, G. Di Cocco, et al. , “Coded Aperture Imaging in X-Ray and Gamma-
Ray Astronomy,” Space Science Reviews 45, 349–403 (1987).
10 “Amptek Mini-X X-Ray source.” http://amptek.com/products/
mini-x-ray-tube . Accessed: 2018-06-13.
11 Z.-J. Shen and J.-F. Zhou, “Improving the angular resolution of coded-mask telescopes by
direct demodulation,” Chinese Journal of Astronomy and Astrophysics 8, 343–348 (2008).
12 G. K. Skinner, “Sensitivity of coded mask telescopes,” Applied Optics IP 47, 2739–2749
(2008).
13 J. Grindlay, J. Hong, B. Allen, et al. , “Concept Study for the HREXI SmallSat Pathﬁnder
(HSP) Mission,” in American Astronomical Society Meeting Abstracts #234 ,American As-
tronomical Society Meeting Abstracts 234, 212.08 (2019).
Biographies and photographs of the authors are not available.
List of Figures
1 Schematic showing the X-ray tube source ﬂux, the collimator assembly, and si-
multaneous illumination of several 100 m100m pixels as either the P2 or
the HREXI detector plane move along a bi-directional (X,Y) rail system. Figure
adapted from Basak et. al. 20205
2 HCF Detector maps of the P2 detector plane for DCUs 34, 18, 56, 58, 29, and 13.
The size of each DCU is 2cm 2cm
3 Stacked pixel image of DCUs 34, 18, 56, 58, 29, and 13. The conﬁnes of a stacked
pixel image increase progressively from DCUs 34 to 13. The stacked pixel repre-
sentation of DCU 34 is well constrained within a '1.5 mm1.5 mm sub-pixel
grid, whereas the stacked pixel image of DCU 13 requires at least a '2.0 mm
2.0 mm grid to constrain itself. The coordinate (0,0) represents the true center of
the stacked DCU pixel.
4 A ﬂux-normalized ideal P2 DCU stacked pixel(left) without any non-uniformities
and a reconstructed stacked pixel image after cross-correlating the DCU stacked
pixel with a mask element(right) size of 1.1 mm.
5 ‘Reconstructed Stacked pixel image’ of DCUs 34, 18, 56, 58, 29, and 13. The
boundaries of a reconstructed stacked pixel image increase progressively from
DCUs 34 to 13. The cross-correlated stacked pixel image of DCU 34 is well con-
strained within a'1515 sub-pixel grid, whereas DCU 13 requires at least a '
2323 sub-pixel grid to constrain itself.
6 Reconstruction of the detectors’ response on the sky using the ‘stacked pixel’ im-
ages for DCUs 34(left) and 13(right). The contour lines represent boundaries con-
taining 50%, 90%, and 95% of counts as one moves successively from the center
to the outer conﬁnes of the reconstructed stacked pixel.
167 Reconstructed stacked pixel images for DCUs 34(left) and 13(right) for different
mask element sizes. The contour lines represent the effective pixel size ( '95%
counts boundaries), while the labels illustrate the values of mask element size ( Sm)
in mm. The color scale (s) illustrates the effective angular offset of the pixels from
the pixel center, which in turn is represented by a ‘+’
8 Left: Stacked pixel image for the entire P2 detector plane. Right: Stacked pixel
image for hypothetical HREXI detector plane made from a 50:50 split of DCU 34
and DCU 13-like detectors.
9 Reconstructed stacked pixel images for P2 and a hypothetical HREXI detector
plane for different mask element sizes. The contour lines represent the effective
pixel size ('95% counts boundaries), while the labels illustrate the values of
mask element size ( Sm) in mm. The colorbar(s) illustrates the effective angular
offset(s) of the pixels from the center, which in turn is represented by a ‘+’. The
blue contour line corresponding to 1.1 mm represents the mask element size ( Sm)
of a P2 type telescope.
10 Top: ‘Reconstructed stacked pixel images’ for DCUs 34 before(left) and after(right)
the centroid corrections have been applied. Bottom: ‘Reconstructed stacked pixel
images’ for DCUs 13 before(left) and after(right) the centroid corrections. The
white and blue contours(s) encompass the effective pixel boundaries ( Sd) before
and after the application of the centroid corrections for each DCU.
11 Vector maps for aligning each pixel of DCUs 34(left) and DCU 13(right) from its
true center to its calculated centroid. The X-Y axes have been labeled in pixels, as
each vector in the map represents the correction per DCU pixel. The size of each
pixel is'0:604mm as mentioned in section 1.
12 The variation(s) of angular offset(s) for different mask size elements ( Sm) before
(left) and after (right) application of the centroid correction routine. The red line
corresponds to the P2 mask size element of 1.1 mm.
13 Schematic diagram showing a DCU before (Top) and after (bottom) applying vec-
tor maps correction, pixel stacking, and then cross-correlation with a mask element,
with an annotated ang. The colored lines on the bottom right diagram signify dif-
ferent sizes of mask elements used and their corresponding angs.
17