Quantile Autoregression-Based Non-causality Testing∗
Weifeng Jin†
January 10, 2023
click here for the latest version
Abstract
Non-causal processes have been drawing attention recently in Macroeconomics and
Finance for their ability to display nonlinear behaviors such as asymmetric dynamics,
clustering volatility, and local explosiveness. In this paper, we investigate the statis-
tical properties of empirical conditional quantiles of non-causal processes. Speciﬁcally,
we show that the quantile autoregression (QAR) estimates for non-causal processes do
not remain constant across diﬀerent quantiles in contrast to their causal counterparts.
Furthermore, we demonstrate that non-causal autoregressive processes admit nonlin-
ear representations for conditional quantiles given past observations. Exploiting these
properties, we propose three novel testing strategies of non-causality for non-Gaussian
processes within the QAR framework. The tests are constructed either by verifying the
constancy of the slope coeﬃcients or by applying a misspeciﬁcation test of the linear
QAR model over diﬀerent quantiles of the process. Some numerical experiments are
included to examine the ﬁnite sample performance of the testing strategies, where we
compare diﬀerent speciﬁcation tests for dynamic quantiles with the Kolmogorov-Smirnov
constancy test. The new methodology is applied to some time series from ﬁnancial mar-
kets to investigate the presence of speculative bubbles. The extension of the approach
based on the speciﬁcation tests to AR processes driven by innovations with heteroskedas-
ticity is studied through simulations. The performance of QAR estimates of non-causal
processes at extreme quantiles is also explored.
Keywords: non-causality, quantile autoregression, speciﬁcation test, KS constancy
test, non-linearity.
JEL Classiﬁcation: C01, C12, C22.
1 Introduction
A stationary autoregressive moving-average (ARMA) process is deﬁned as causal concerning
the speciﬁed innovation sequence if all roots of the autoregressive polynomials are outside
∗I would like to express my gratitude to my supervisor, Carlos Velasco, who guided me throughout this
research project. I also want to thank Juan Carlos Escanciano, Miguel Delgado, Jesus Gonzalo, Juan Jose
Dolado, Nazarii Salish, and Alain Hecq for their constructive comments, and also seminar and workshop
participants at Universidad Carlos III de Madrid, Time Series Workshop in Zaragoza and CEBA seminar
2022.
†Weifeng Jin: Universidad Carlos III de Madrid. jweifeng@eco.uc3m.es
1arXiv:2301.02937v1  [econ.EM]  7 Jan 2023of the unit circle, so it can be represented by an inﬁnite sum of past innovations. However,
non-causal autoregressive (AR) processes, due to their ability to display various non-linear
dynamics, have been drawing increasing attention in the econometrics literature during the
last two decades. The same concept has been fully exploited as a non-minimum phase in
the stochastic system with applications to natural sciences. Unlike the causal AR process in
the classical time series context, mixed causal and non-causal AR processes do not impose
presumptions on the location of the lag polynomial roots except for the exclusion of the unit
root, which allows these stationary processes to be dependent on past and future innovations
at the same time. Breidt et al. (2001) showed that non-causal AR processes can capture styl-
ized facts like clustering volatility in ﬁnancial data, which usually is associated with GARCH
models. The same argument is made in the paper by Lanne et al. (2013), where they derived
a closed-form expression for the correlation of squared values in levels in the ARMA(1 ,1)
case. Fries and Zakoian (2019); Gouri´ eroux and Zako¨ ıan (2017) and Cavaliere et al. (2020)
proposed to model speculative bubbles with non-causal AR or mixed causal and non-causal
AR processes generated by heavy-tailed innovations because they can display local explosive
behavior. Regarding forecasting, Lanne et al. (2012) and Hecq and Voisin (2021) argued that
there is an accuracy gain in forecasting performance after introducing non-causality into the
modeling procedure. Moreover, Lanne and Luoto (2013) pointed out that non-causal AR
processes can be an alternative to non-invertible processes for forward-looking behavior, see
Alessi et al. (2011) for a comprehensive survey of empirical applications of non-invertible
(non-fundamental) processes to Macroeconomics and Finance.
The emerging applications of non-causal AR processes promote an interest in testing non-
causality in practice, given that autocorrelation functions fail to discriminate non-causal
processes from their causal counterparts. Needless to say, the non-causality check can be
naturally achieved through testing classical linear hypotheses under robust estimation tech-
niques applicable to possibly non-causal processes. These estimation methods have been
developed by Breid et al. (1991) and Lii and Rosenblatt (1992, 1996) through non-Gaussian
maximum likelihood schemes or minimum distance estimation exploiting information con-
tained in higher order moments/cumulants or characteristic/cumulative distribution func-
tions of residuals, see Velasco and Lobato (2018), Velasco (2022), and Jin (2021). With this
approach, the test procedure is conﬁned to the assumptions required for the corresponding
estimates, which can be somehow stringent. Apart from that, a factorization of the coef-
ﬁcients is necessary for disentangling the roots, which becomes rather complicated as the
order of the AR process increases. Therefore, a testing strategy before the estimation, which
can potentially work as a model selection, needs investigation. Besides, the testing can serve
as a detection tool for the existence of speculative bubbles in empirical time series for the
ability of non-causal processes with heavy tails to exhibit local explosive behavior.
However, except for the robust estimation techniques introduced before, little has been done
on the theory of testing non-causality in AR processes. Nevertheless, all the estimation
techniques above deliver the same message that additional information beyond second-order
moments is required to identify non-causality. Following this message, we propose some
testing strategies for the non-causality of time series within the quantile autoregressions
framework (QAR hereafter) (Koenker and Xiao (2006)), which allows us to make use of the
2complete distribution to measure dependence. Similarly, Hecq and Sun (2021) applied QAR
to the target process and entertained the sum of rescaled absolute residuals as an information
criterion to select between purely causal and non-causal models. The approach of Hecq and
Sun (2021) obtains the proposed test statistic by running QAR in direct and reserved time,
respectively. This approach can bring up ambiguity in the model selection when the complex-
ity of the causality structure escalates as the order of the AR model increases. Thereby, this
strategy may yield misleading results when the time series is mixed causal and non-causal.
In this paper, we propose three testing procedures based on the well-developed inference for
QAR estimates exploiting the non-linear characteristics of non-causal processes. Recall that
the coeﬃcients in the conditional quantile regression for the location model1are quantile-
invariant except for the intercept. When the process is causal, the independence of current
innovation with past observations contributes to the invariant property of coeﬃcients in the
QAR model across diﬀerent quantiles. However, under non-causality the true conditional
quantile of a non-Gaussian AR process exhibits non-linearity in the past information. In-
duced from this, the best linear approximation to the true conditional quantile is expected to
show varying coeﬃcients across distinct quantiles. Using this feature, we introduce our ﬁrst
strategy for the objective of testing non-causality by carrying out the constancy test over
the entire quantile interval. Its easy-to-implement attribute makes it a perfect candidate for
a preliminary check of non-causality. The other approach to detect non-causality is achieved
through a speciﬁcation test of the linear functional form for the conditional quantile. With
this speciﬁcation-based approach, no distributional knowledge of the innovations beforehand
is required, nor does the correct speciﬁcation of the conditional quantile need to be spelled
out.
The testing strategies introduced in this paper ﬁll a gap in the theory of testing non-causality.
Apart from that, they share an appealing property of retaining power when the AR process
is higher-order with a mixture of causal and non-causal representation. Like the signiﬁcant
advantage of quantile regression over conditional mean regression, our approach is robust to
outliers, making it suitable for heavy-tailed processes commonly employed in ﬁnance. Our
speciﬁcation-based approach can also be tentatively extended to an AR process with condi-
tional heteroskedasticity. The tests achieve considerable power in relatively small samples.
In addition, some Monte Carlo simulation results suggest that the estimates in linear quan-
tile models approach the true parameters for non-causal processes as the quantile estimand
approaches to either extremum (0 or 1), which can be a potential viewpoint to investigate
the nonlinear features of non-causal processes in the future research.
The rest of the paper is organized as follows. The second section introduces mixed causal and
non-causal Autoregressions and some of their statistical properties. Section 3 investigates
the non-causality testing within the QAR framework. Section 4 discusses the ﬁnite sample
performance of our proposed testing procedures through Monte Carlo Simulations. Section
5 illustrates the tests using ﬁnancial data with the possible existence of speculative bubbles.
Section 6 closes the paper with conclusions and some extensions.
1The location model is any model of the form Y=µ(X) +σ·u, whereuis independent of X. Throughout
this paper, we refer to Yt=µ(Yt−1,Yt−2,...)+ut, whereµ(·) is a linear functional form, and utis a sequence
ofiidinnovations, when it comes to the location model.
32 Mixed Causal and Non-causal Autoregressions
In the context of classical time series analysis, it is customary to restrict attention to the
causal representation of autoregressive processes while modeling stationary univariate time
series. The reason is mentioned in Brockwell and Davis (2009). Every non-causal autoregres-
sive process is a stationary solution to a future-independent autoregressive process with explo-
sive roots. It provides the same second-order structure as its causal counterpart. However,
to feature higher-order dynamics, a general framework of autoregressive processes named
mixed causal and non-causal autoregressions (MAR( r,s) hereafter) is proposed where tem-
poral dependence in both past and future is introduced in the processes, deﬁned by
φ(L)ψ(L−1)Yt=ut (2.1)
whereφ(L) = 1−φ1L−φ2L2−···−φrLrandψ(L−1) = 1−ψ1L−1−ψ2L−2−···−ψsL−s
are polynomials with backward and forward operators, respectively. {ut}t∈Zis a sequence of
independent identically distributed ( iid) innovations with zero mean. p=r+sis the total
order encompassing both causal and non-causal polynomials. An equivalent expression of
equation (2.1) in moving average can be given by
Yt=φ(L)−1ψ(L−1)−1ut=∞/summationdisplay
j=−∞ρjut−j, (2.2)
whereYtmay depend on both future and past innovations. The stationarity of Ytis assured
by the absolute summability of ρj,/summationtext∞
j=−∞|ρj|<∞andE|ut|1+δ<∞forδ>0. The former
condition is guaranteed once the roots of both polynomials φ(z) andψ(z) are conﬁned to
locate outside the unit circle.
Whenψ(z) = 1 for all z, the process is reduced to a purely causal process MAR( r,0)
like in conventional studies. While if φ(z) = 1 for all z, the process becomes purely non-
causal. Below, we attach several examples to illustrate the statistical properties of a general
autoregressive process MAR( r,s).
Example 2.1 (Second-order Property) .Deﬁne a purely non-causal MAR( 0,1) sequence
(1−ψL−1)Yt=utstarting from an iidsequence of innovations utof zero-mean and ﬁnite
varianceσ2. The autocovariance function of Ytis provided by
Cov (Yt+h,Yt) =Cov
∞/summationdisplay
j=0ψjut+h+j,∞/summationdisplay
j=0ψjut+j

=∞/summationdisplay
j=0Cov/parenleftBig
ψjut+h+j,ψj+hut+h+j/parenrightBig
=ψh
1−ψ2σ2forh= 0,1,2,...
It is worth noting, after some simple calculation, that {Yt}t∈Zshares the same autocovariance
function as the MAR( 1,0) sequence{˜Yt}t∈Zdeﬁned by (1−ψL)˜Yt=ut, which is its causal
counterpart. A general conclusion can be drawn for MAR( r,s) through the autocovariance
4generating function (ACGF). The ACGF of a stationary autoregression is given by
G(L) =1
|φ(L)ψ(L−1)|2σ2=1
φ(L)φ(L−1)ψ(L−1)ψ(L)σ2
=1
φ(L)ψ(L)φ(L−1)ψ(L−1)σ2
=1
|φ(L)ψ(L)|2σ2,
from where it is clear that MAR( r,s) takes the identical form of ACGF with MAR( r/prime,s/prime) as
long as the total order r+s=r/prime+s/primeis satisﬁed and the roots to all polynomials match.
This second-order property explains the failure to distinguish non-causal processes from
causal processes based on the ACF. Moreover, it implies that non-Gaussianity of innovations
is required for identifying non-causal processes since second-order properties are suﬃcient to
characterize a Gaussian probabilistic structure but not to other distributions.
Example 2.2 (Local Explosiveness) .Deﬁne a MAR( 1,1) process by
(1−φL)(1−ψL−1)Yt=ut,whereut∼Lognormal (0,2)−exp(2)
A MAR(r,s) process with heavy-tailed innovations can generate multiple phases of local
explosiveness, which can be employed to model speculative bubbles. A detailed investigation
of probabilistic properties of a MAR process driven by α-stable non-Gaussian innovations
is provided by Fries and Zakoian (2019), where they show the properties of the marginal
and conditional distributions of a stable MAR( r,s). But in a general situation, there is
no closed-form solution to either the marginal or the conditional distribution of a non-
causal AR process. Here we illustrate the potential applications of MAR( r,s) processes in
modeling speculative bubbles with some simulated trajectories. In this example, we plot
four distinct scenarios by varying the parameters of both causal and non-causal components
of the MAR(1 ,1) process with log-normal distributed innovations2. Generally, with non-
causality, the processes can mimic bubbles by repetitive phases of upward trends followed
by a sharp drop; see the lower panel in Figure 2.1. The upper panel in the same ﬁgure
indicates more complicated dynamics can be generated by incorporating more causal/non-
causal components in the data-generating process regarding the number and magnitude of
bubbles.
Example 2.3 (Conditional heteroskedasticity) .Here we exemplify the applicability of MAR( r,s)
in characterizing clustering volatility as an alternative to ARCH or other stochastic volatility
models with a simple MAR( 1,1) process. This argument is originally made by Breidt et al.
(2001) in an empirical application to New Zealand/US exchange rate. Lanne et al. (2013)
elaborate on it by deriving explicitly the expression of the autocorrelation of Y2
tin an all-pass
2A log-normal distribution is a heavy-tailed continuous distribution deﬁned on the positive domain, whose
density function is characterized by the location parameter µand scale parameter σ. The mean and variance
are represented by exp(µ+σ2/2) and/parenleftbig
exp(σ2)−1/parenrightbig
exp/parenleftbig
2µ+σ2/parenrightbig
, respectively. In this example, we employ
centered log-normal distribution to be compatible with our setup of mean zero.
5Figure 2.1: Trajectories of MAR(1 ,1) processes with diﬀerent parameters ( φ,ψ), T=500: the upper
panel exhibits two MAR(1 ,1) processes with diﬀerent parameters on the causal/non-causal compo-
nents; the lower panel exhibits a purely non-causal AR(1) process (left) and a purely causal AR(1)
process (right) when one of the parameters degenerates to zero.
model of order 1. However, no formal justiﬁcation for the higher-order dependence structure
has been made on general non-causal processes. Nevertheless, we present the following ex-
ample that a non-causal process can exhibit higher-order dependence.
Continued with data generating process MAR( 1,1), it can be reexpressed by an AR(2) with
the1−ψL
1−ψL−1ﬁlter on the innovations.
(1−φL)(1−ψL−1)Yt=utut∼IID(0,σ2)
⇐⇒(1−φL)(1−ψL)Yt= ˜ut
with ˜ut=1−ψL
1−ψL−1ut=∞/summationdisplay
j=−∞ρjut+j
withρj=

0 ifj <−1
−ψ ifj=−1
ψj−ψj+2ifj≥0.
The1−ψL
1−ψL−1ﬁlter introduces higher-order dependence to an iidinnovation sequence3
3Actually, ˜utis an all-pass time series model, where all roots of the autoregressive polynomial are reciprocals
of roots in the moving average polynomial and vice versa.
6preserving its uncorrelatedness. By simple algebra, we can obtain the formula of the auto-
correlation function of ˜ u2
t,
Corr/parenleftBig
˜u2
t,˜u2
t+h/parenrightBig
=κ4(ut)/parenleftBig/summationtext∞
j=−∞ρ2
jρ2
j+h/parenrightBig
+ 2σ4/parenleftBig/summationtext∞
j=−∞ρjρj+h/parenrightBig2
κ4(ut)/parenleftBig/summationtext∞
j=−∞ρ4
j/parenrightBig
+ 2σ4/parenleftBig/summationtext∞
j=−∞ρ2
j/parenrightBig2
which, in general, does not vanish4. This property demonstrates the capability of non-causal
processes to exhibit volatility clustering, which is commonly observed in ﬁnancial data. The
higher-order dependence analysis of ˜ utis relegated to Appendix 7.1, indicating the possibility
of accommodating higher-order nonlinear dynamics with a general MAR( r,s) model.
As shown in the preceding examples, MAR( r,s) models can display various nonlinear char-
acteristics with a linear process generation scheme. This deviation from ”linearity” can be
employed as a crucial feature to detect non-causality in the linear time series. A fundamental
result is formalized by Rosenblatt (2000) on the best one-step predictor in the mean square
for a general AR process, where he demonstrates that the conditional expectation must be
nonlinear in the past if there is non-causality involved in the non-Gaussian AR processes
with ﬁnite variance. This statement provides us with the critical theoretical result where our
tests for non-causality are grounded, which will be elaborated on in the next section. The
extension to a general VARMA process framework has been developed by Chen et al. (2017)
and applied to a test for non-invertibility. Afterward, Fries and Zakoian (2019) consider the
case when the MAR(1 ,s) process is driven by symmetric α-stable innovations with inﬁnite
variance. They surprisingly ﬁnd that the conditional expectation can be explicitly expressed
by a linear function of the past information, in contrast to a MAR( r,s) model with ﬁnite
variance. However, no study has yet been done on the distributional characterization of a
MAR(r,s) process due to no closed-form solution. Following a simulation-based approach,
we perform a preliminary analysis of the conditional density function of a process given the
past observations, see Appendix 7.1. In short, in the presence of non-causality, the shape
of the conditional distribution of the process, say f(Yt|Yt−1=y), isy-dependent. Still, the
dependence pattern is hard to characterize since it varies across diﬀerent distributions.
3 QAR-based Non-causality Tests
3.1 Benchmark model: MAR( r, s)
In this section, we formalize the test procedures for non-causality. The null hypothesis of
interest isYtbeing a causal process, i.e.
H0:ψ1=···=ψs= 0 in (2.1) (3.1)
against the alternative hypothesis denoted by HA, which is{Yt}is non-causal,
HA:ψk/negationslash= 0 for some k∈{1,2,...,s}in (2.1). (3.2)
4κ4(X) is the fourth cumulant of the random variable X, deﬁned by κ4(X) =E/parenleftbig
(X−E(X))4/parenrightbig
−
3E2/parenleftbig
E(X−E(X))2/parenrightbig
.
7A primitive strategy is to take it as a joint signiﬁcance test for the coeﬃcients of leads
{Yt+j}j=1,2,...,s. This approach would call for the identiﬁcation of models and robust in-
ference for the estimates under both hypotheses. In this paper, we propose a test for H0
employing the linearity property of {Yt}based on the QAR, which is easy to implement
empirically and does not require consistent estimates for general autoregressive progresses.
Denoting the information set generated by the observations up to period tbyIt=σ(Yt,Yt−1,...)
and theτ−th quantile of Ytconditional on the past by QYt(τ|It−1), the following result on
the linearity of{Yt}justiﬁes our approach.
Assumption 1. Let{ut}t∈Zbe a non-Gaussian iidsequence with (k+ 1)th order moment
ﬁnite and (k+ 1)th cumulant nonzero for some k≥2.
Theorem 3.1. Under Assumption 1, a stationary MAR( r,s) process{Yt}has a non-degenerated
non-causal component, i.e., s/negationslash= 0 if and only if there exists QYt(τ|It−1)nonlinear in
{Yt−j}j≥1for at least one τ∈(0,1).
As discussed in Example 2.1, there is no meaning to discuss non-causality in a Gaussian
structure as there is always an equivalent causal representation of a Gaussian AR process for
its non-causal counterpart. The ﬁniteness of the moment condition and nonzero cumulants
are also required in Rosenblatt (2000). Theorem 3.1 is deduced from the nonlinearity of the
best predictor of Ytin the mean square criterion for non-causal processes. The nonlinearity
in the conditional mean implies dependence in the conditional distribution beyond the linear
correlation. Note that the theorem does not point out the quantile(s) where this nonlinear
relationship occurs, nor the manners in which this nonlinearity is expressed. Another remark
is that the information set considered in the theorem can be replaced by σ-ﬁeld generated
byYt−1up toYt−pdue to the Markovian property of MAR( r,s), which avoids the inﬁnite-
dimensional issue arising from It−1. The total number of the lags and leads of Ytincluded
to explain the conditional quantile of MAR( r,s) processes, p,is determined by the partial
autocorrelation function (PACF) of Yt.
This theorem prompts us to adopt QAR as a medium to detect non-causality. QAR is a
comprehensive analysis tool in the time series context, providing robust statistical analyses
against outliers in the measurement of the response variable, which has proven to be rather
prevailing in recent decades. Given a MAR( r,s) process of order pdeﬁned by (2.1), if the
non-causal component degenerates to 1, i.e., s= 0,r=p, the conditional quantile of Ytcan
be expressed by
QYt(τ|It−1) =Qut(τ) +φ1Yt−1+φ2Yt−2+···+φpYt−p
=θ0(τ) +θ1(τ)Yt−1+θ2(τ)Yt−2+···+θp(τ)Yt−p
=X/prime
tθ(τ)∀τ∈(0,1),(3.3)
whereQut(τ) denotes the τ-quantile of innovations ut, andφj’s are the coeﬃcients of corre-
spondingYt−jin the polynomial expansion of (2.1). Therefore, after imposing pure causality,
the conditional quantile of Ytcan be fully characterized by a linear function of past observa-
tions,X/prime
tθ(τ) withXt= (1,Yt−1,Yt−2,...,Yt−p)/primeandθ(τ) = (θ0(τ),...,θp(τ))/prime. The QAR
estimates of coeﬃcients θ(τ) in this linear quantile model can be obtained by minimizing
8the following problem,
ˆθ(τ) = argmin
θ∈Rp+1T/summationdisplay
t=1ρτ(Yt−X/prime
tθ), (3.4)
with the check function ρτ(u) =u(τ−I(u<0)). The asymptotic properties of linear QAR
estimates were ﬁrst established by Koenker and Xiao (2006). A brief review of QAR esti-
mates (3.4) can be found in Appendix 7.2. However, if Ythas a non-degenerated non-causal
component, the linear dynamic model (3.3) for its conditional quantile is misspeciﬁed for at
least oneτ∈(0,1), following Theorem 3.1.
Within the linear QAR framework, Hecq and Sun (2021) consider a statistic aggregating
the information of the residuals over quantiles, which they employ as a model selection cri-
terion between purely causal AR models and purely non-causal AR models. Given that
the calculation of residuals is done either by running QAR with direct or reversed time,
this methodology may provide misleading conclusions regarding MAR( r,s) in presence of
causality and non-causality at the same time. By contrast, our approaches address more
the correctness of the linear speciﬁcation of the conditional quantile through the QAR. For
non-causal autoregressive processes, no closed-form of the nonlinear conditional quantile of
Ytis required. Consequently, our approach is robust to the general MAR( r,s) setting. Before
we carry out the tests for non-causality, the following assumptions are imposed in the QAR
framework.
Assumption 2. The distribution function of innovations ut,F(u)admits a continuous
density function f(u)away from zero on the domain U={u: 0<F(u)<1}.
Assumption 3. Denote the family of conditional distribution {P(Yt<y|Xt=x),y∈R,x∈
Rr+s}asFx(y)and its Lebesgue density as fx(y), that is uniformly bounded on the space of
y×x⊆R×Rr+sand uniformly continuous.
Corollary 3.1.1. Under Assumptions 1-3 and null hypothesis H0, the coeﬃcients except for
the intercept of the conditional quantile are constant across diﬀerent quantiles in (0,1).
Corollary 3.1.1 is a consequence of the independence between utandYt−jforj=
1,2,...,p when the MAR( r,s) is purely causal. As shown in the equation (3.3), the slope
coeﬃcients{θj(τ)}j=1,...,pare constant over τ∈(0,1) and uniquely determined by the ex-
pansion of autoregressive polynomials of Yt. Instead, the performance of the QAR estimates
is more complicated in the mixed causal and non-causal autoregressive processes since the
linear model is under misspeciﬁcation. Angrist et al. (2006) demonstrated in their paper that
quantile regression is essentially an approximation to the true conditional quantile function
in a weighted mean squared criterion, with weights associated with the densities of Ytranging
from the linear approximation (3.3) to the true conditional quantile QYt(τ|Yt−1,...,Yt−p).
Their statement presents a rough idea of how well the linear function ﬁts the true conditional
quantile.
Constancy Test Our ﬁrst approach for detecting non-causality comes along with the
constancy test of QAR coeﬃcients over the entire quantile range. As stated in Corollary
93.1.1, if the process is causal, the constancy should hold for all θj(τ) for allj= 1,2,...,p and
τ∈(0,1). Whereas for a non-causal process, the estimated coeﬃcients of Yt−jin the quantile
regression may vary across diﬀerent quantiles much likely for the following intuitions: i) non-
causal processes display highly nonlinear dynamics, one of which is asymmetric dynamics;
ii) linear quantile model is misspeciﬁed; iii) the conditional distribution of Ytvaries both
in the location and shape at diﬀerent values of past observations. For instance, Figure 3.1
depicts the dynamic performance of QAR(1) estimates of the slope parameter across the
quantiles for a non-Gaussian autoregressive process, including causal and non-causal cases in
diﬀerent colors. The QAR(1) estimates in the non-causal processes (solid blue lines) exhibit
a trendy pattern over the quantile domain. However, since a general solution for the true
conditional quantile function of Ytis infeasible, we do not attempt to provide a detailed
characterization of the varying coeﬃcient property in the non-causal situation. The test for
non-causality based on the constancy test can only be used to check the necessary condition
of AR processes being causal. Nevertheless, the accessibility and straightforwardness of this
method make it a touchstone for non-causality testing in practice.
(a)QAR(1) estimates of the slope of Yt−1
over (0,1): exponential distribution
(b)QAR(1) estimates of the slope of Yt−1
over (0,1): chi-square distribution
Figure 3.1: QAR(1) estimates of a pair of AR(1) processes: one is causal, and the other is non-
causal. The left part of the ﬁgure is applied to the processes generated by exponential innovations,
and the right part is to the processes generated by chi-square innovations. The true parameter is
0.6(1/0.6) for the causal(non-causal) case.
To implement the constancy test of coeﬃcients under the QAR framework, we consider the
approach developed by Koenker and Xiao (2006), where the hypothesis is formulated in the
manner analog to the classical linear hypothesis:
H1
0:Rθ(τ) =φwithR=/parenleftBigg
0p×1...Ip/parenrightBigg
for allτ∈(0,1)
with the unknown τ-invariant parameter vector φ= (φ1,φ2,...,φp)/primewhich needs to be
estimated5. Naturally, the naive test for this hypothesis is constructed on the quantile
process
VT(τ) =√
T/bracketleftBig
RˆΣ−1
1ˆΣ0ˆΣ−1
1R/prime/bracketrightBig−1/2/parenleftBig
Rˆθ(τ)−ˆφ/parenrightBig
5For purely causal processes, the constant vector consists of the parameters in the autoregressive polyno-
mials, i.e.,φ1,φ2,...,φ pin (3.3)
10and the Kolmogorov-Smirnov (KS) type of test statistic is adopted for the interest of testing
a compact set of quantiles
KSVT= sup
τ∈T⊂ (0,1)VT(τ),whereTis a compact interval ,
where ˆθ(τ) is the linear QAR estimate, and ˆΣ1,ˆΣ0are the corresponding estimates of the
asymptotic variance, see appendix 7.4. ˆφis a√
Tconsistent estimator of φand a simple
choice is the QAR estimator ˆθ(τ∗) at anyτ∗∈T.6A closed interval [ /epsilon11,1−/epsilon12] with trivial
numbers/epsilon11,/epsilon12is proposed forTto avoid missing much information from the entire quantile
interval (0,1).
Under the hypothesis of constancy H1
0,
VT(τ) =⇒Bp(τ)−f/parenleftBig
F−1(τ)/parenrightBig/bracketleftBig
RΣ−1
0R/prime/bracketrightBig−1/2Z
whereBp(τ) is ap-dimensional standard Brownian bridge and Z= plimT→∞√
T/parenleftBigˆφ−φ/parenrightBig
is a drift brought up by the estimation of the nuisance parameter φ. To annihilate this
non-trivial eﬀect, a martingale transformation Kwas introduced into VT(τ) to retrieve the
distribution-free merit of the KS test. Denote the derivative of the density function by ˙f
and deﬁne
g(x) =/parenleftBig
1,/parenleftBig˙f/parenleftBig
F−1(x)/parenrightBig
/f/parenleftBig
F−1(x)/parenrightBig/parenrightBig/parenrightBig/primeand
C(z) =/integraldisplay1
zg(x)g(x)/primedx,
and the martingale transformation on the process VT(τ) is constructed as follows
˜VT(τ) =KVT(τ)
=VT(τ)−/integraldisplayτ
0/bracketleftbigg
g/prime
T(x)C−1
T(x)/integraldisplay1
xg(s)dVT(s)/bracketrightbigg
dx,
wheregT(x) andCT(x) are uniformly consistent estimators of g(x) andC(x) in the considered
domain, respectively. The proposed KS-type norm on the transformed process becomes
KS˜VT= sup
τ∈T/vextenddouble/vextenddouble/vextenddouble˜VT(τ)/vextenddouble/vextenddouble/vextenddouble.
Corollary 3.1.2 (Constancy test for non-causality) .Under Assumptions 1-3 and the causal-
ity hypothesis H0,
˜VT(τ)⇒Wp(τ)
KS˜VT⇒sup
τ∈T/bardblWp(τ)/bardbl,
whereWp(τ)represents a p-dimensional standard Brownian motion.
The related discussion on the estimation of density and score functions is given in Koenker
6Another appropriate choice is the estimator from the ordinary least square of φj,j= 1,2,...,p in (2.1).
11and Xiao (2002), providing suggestions on the choice of bandwidth in detail. In the command
KhmaladzeTest implemented in R studio, Hall/Sheather bandwidth (Hall and Sheather
(1988)) for sparsity estimation is set as default. The critical values are obtained through
approximating Wp(τ) by a Gaussian random walk, and the corresponding values at diﬀerent
signiﬁcance levels can be found in tables in the Appendix of Koenker and Xiao (2002). One
remark on the quantile interval in the proposition, typically a symmetric interval [ /epsilon1,1−/epsilon1]
trimmed by a small number /epsilon1close to 0 is considered for simplicity in practice. Monte Carlo
experiments have evidenced that an appropriate trimming in the entire quantile interval al-
leviates the over-rejection of the null hypothesis ascribable to the instability of estimation
at extremal quantiles without sacriﬁcing the power.
Speciﬁcation test-based approach Another direction to test non-causality is based on
Theorem 3.1, where non-causality in the linear processes is translated into the misspeciﬁ-
cation of conditional quantiles of non/causal processes by linear dynamic quantile models
(3.3). Equivalently, we aim to test
E/parenleftbigΨτ/parenleftbigYt−X/prime
tθ0/parenrightbig|Yt−1,...,Yt−p/parenrightbig= 0 a.s. for some θ0∈Band∀τ∈Υ⊂(0,1),(3.5)
where Ψτ(·) =I(·≤0)−τ, andBis a family of uniformly bounded functions from Υ ⊂(0,1)
to Θ⊂Rp+1.7Both Υ and Θ are compact sets. Escanciano and Velasco (2010) (hereafter
EV) characterize this restriction by unconditional moments
E/parenleftbigΨτ/parenleftbigYt−X/prime
tθ0/parenrightbigexp/parenleftbigix/primeXt/parenrightbig/parenrightbig= 0,∀x∈Rp+1,for someθ0∈Band∀τ∈Υ⊂(0,1),
(3.6)
wherei=√−1. Following the strategy of the EV test, we consider the statistic based on
the residual processes indexed by quantiles τ,θ∈Bandx∈Rp+1
REV
T/parenleftBig
x,τ;ˆθ/parenrightBig
=T−1/2T/summationdisplay
t=1Ψτ/parenleftBig
Yt−X/prime
tˆθ/parenrightBig
exp/parenleftbigix/primeXt/parenrightbig(3.7)
with true parameters θ0replaced by QAR estimates ˆθfrom a given sample/parenleftBig
Yt,X/prime
t/parenrightBig
t=1,2,...,T.
Xtis composed by a constant and the lags of Ytup to order p. Theoretically, T−1/2REV
T
approaches to zero at a certain rate when Tgoes to inﬁnity for any x∈Rp+1ifX/prime
tθ0(τ) is the
correct speciﬁcation for QYt(τ|It) and ˆθ(τ) is a√
T-consistent estimator of θ0(τ) forτ∈Υ.
Thus, the distance between this statistic (3.7) and zero naturally turns into a measure of
the deviation of X/prime
tθ0(τ) from the true QYt(τ|It). The suggested Cram´ er-von Mises (CvM)
norm on (3.7) is deﬁned by
/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREV
T/parenleftBig
x,τ;ˆθ/parenrightBig/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ), (3.8)
7In our case, actually only θ0(τ) is required to be a uniformly bounded function from Υ ⊂(0,1) to Θ⊂R,
and the rest θj(τ) are mapped to a constant for j= 1,2,...,p.∀τ∈(0,1).
12where Φ(x) andW(τ) are weighting functions deﬁned on Rp+1and Υ, respectively with pos-
itive derivative in the corresponding domain. This CvM norm permits us to consider inﬁnite
model speciﬁcations for conditional quantiles at all τ’s of interest. Other possible options of
norms aggregating the information over the quantiles and x, for instance, Kolmogorov-type,
are also applicable here. The following proposition presents the asymptotic behavior of the
EV test applied for testing non-causality.
Corollary 3.1.3 (EV Test for non-causality) .Under H0and Assumptions 1-3, let E(XtX/prime
t)
be nonsingular in a neighborhood of θ(τ) =θ0(τ)for allτ∈Υ,
REV
T/parenleftBig
x,τ;ˆθ/parenrightBig
=⇒˜REV
∞(x,τ),
and
/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREV
T/parenleftBig
x,τ;ˆθ/parenrightBig/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ)−→d/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingle˜REV
∞(x,τ)/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ)
where ˜REV
∞=R∞−∆R.R∞is a Gaussian process with mean zero and covariance function
deﬁned by
Cov (x1,x2;τ1,τ2) = (τ1∧τ2−τ1τ2)E/parenleftbigexp/parenleftbigi(x1−x2)/primeX0/parenrightbig/parenrightbig
and the drift ∆Ris introduced due to the asymptotic eﬀect from estimation error of ˆθ,
∆R(x,τ) =G/prime(x,θ0(τ))Q(τ),
whereG(x,θ0(τ)) =E[Xtf(Qut(τ)) exp(ix/primeXt)]andQ(·)isΣ−1/2
0Bp+1/f/bracketleftbigF−1(·)/bracketrightbig.Bp+1
is a(p+ 1)-dimensional standard Brownian bridge. fandFare the density and cumulative
distribution functions of the innovation ut, respectively. Σ0=E(XtX/prime
t).
The result immediately follows from Escanciano and Velasco (2010), where they develop
the result for a general class of quantile estimates covering various linear and nonlinear
models of interest with corresponding assumptions. Those conditions are satisﬁed under
Assumptions 1-3 in the context of MAR( r,s) processes under the null hypothesis. The
limiting distribution of the test statistic is no longer distribution-free due to the estimation
of nuisance parameters. Hence, a subsampling method is proposed to approximate the critical
value. The operation for calculating the residual process (3.7) and the test statistic (3.8) is
applied to a given subsample ( Yt,...,Yt+b) of sizeb, denoted by REV
b(x,τ;ˆθb,t) and Γ/parenleftBig
REV
b,t/parenrightBig
respectively, and repeated for t= 1,2,...,T−b+ 1. The cdf of the limiting distribution of
the proposed statistic is approximated by the empirical cdf across resamples, i.e.,
ˆP/bracketleftBig
Γ/parenleftBig
REV
b/parenrightBig
≤ω/bracketrightBig
=1
T−b+ 1T−b+1/summationdisplay
t=1I/parenleftBig
Γ/parenleftBig
REV
b,t/parenrightBig
≤ω/parenrightBig
.
Therefore, the 1−αth sample quantile, cEV
T,b(α) deﬁned as
cEV
T,b(α) = inf/braceleftBig
ω:ˆP/bracketleftBig
Γ/parenleftBig
REV
b/parenrightBig
≤ω/bracketrightBig
≥1−α/bracerightBig
,
intuitively serves as the critical value for this test at the α-level of the signiﬁcance. The
13validity of this subsampling approach has been veriﬁed by Escanciano and Velasco (2010),
who suggest an appropriate choice for bandwidth b=⌊kT2/5⌋for the sake of optimal minimax
accuracy8. Some numerical evidence has demonstrated that a diverse range of values of k,
like 4, 5, and 6 provide reasonably good performance in ﬁnite samples. A centering strategy
can be adopted for the resampling statistic to achieve better performance power-wise in ﬁnite
samples.
Alternatively, Escanciano and Goh (2014) (hereafter EG) translate the restriction (3.5) into
E/bracketleftbigΨτ/parenleftbigYt−X/prime
tθ0/parenrightbigI(Xt≤x)/bracketrightbig= 0∀x∈Rp+1,for someθ0∈Band for allτ∈Υ⊂(0,1).
(3.9)
Naturally, a new test statistic can be constructed on the sample analog of moment conditions
(3.9) with the replacement of θ0by their QAR estimates ˆθ,
T−1/2T/summationdisplay
t=1Ψτ/parenleftBig
Yt−X/prime
tˆθ/parenrightBig
I(Xt≤x)τ∈Υ,x∈Rp+1. (3.10)
Unlike the approach in the EV test, where the asymptotic behavior of the test statistic is
derived by incorporating the non-negligible eﬀect from the estimates of nuisance parameters
into the ﬁnal limiting distribution, Escanciano and Goh (2014) introduce a variant of weight-
ing functions I(Xt≤x) satisfying the orthogonality condition for the Taylor expansion of
the statistic (3.10) around the true parameter θ0. With this consideration, the test statistic
becomes
REG
T/parenleftBig
x,τ;ˆθ/parenrightBig
=√
TT/summationdisplay
t=1

Ψτ/parenleftBig
Yt−X/prime
tˆθ/parenrightBig
I(Xt≤x)−ˆD/prime
T/parenleftBig
x,ˆθ(τ)/parenrightBig/parenleftBigg
T−1T/summationdisplay
t=1ˆδt,τˆδ/prime
t,τ/parenrightBigg−1
ˆδt,τ



(3.11)
with ˆDT/parenleftBig
x,ˆθ(τ)/parenrightBig
=T−1/summationtextT
t=1ˆδt,τI(Xt≤x) and
ˆδt,τ=ˆf/parenleftBig
X/prime
tˆθ(τ)|Xt/parenrightBig
Xt,
where ˆf(y|Xt) is a consistent estimator of the conditional density function of Ytgiven the
past information, f(y|Xt). One suggested kernel estimator is proposed by Escanciano and
Goh (2012), deﬁned by
ˆf/parenleftBig
X/prime
tˆθ(τ)|Xt/parenrightBig
=1
MhMM/summationdisplay
j=1K/parenleftBigg
X/prime
tˆθ(τ)−X/prime
tˆθ(τj)
hM/parenrightBigg
, (3.12)
where{τj}M
j=1is a sequence randomly selected from Υ following the uniform distribution
withM−→∞ as well asT−→∞ .K(·) is a kernel function, and hMdenotes a smoothing
parameter which may depend on the data and the quantiles considered for the estimation.
Compared to other density estimator candidates, this estimator is computationally less cum-
bersome but still preserves the same convergence rate as Rosenblatt estimator when the
following assumption is imposed for the kernel function and the corresponding smoothing
8⌊z⌋denotes the largest integer that does not exceed z.
14parameter.
Assumption 4. 1. For kernel function K(s):
(a) K(s) is continuously diﬀerentiable;
(b)/integraltext∞
−∞K(s) = 1 ;
(c) K(s) is uniformly bounded;
(d) K(s) is of second order, i.e./integraltext∞
−∞sK(s) = 0,/integraltext∞
−∞s2K(s)ds∈(0,∞)and/integraltext∞
−∞K2(s)ds∈
(0,∞).
2. The convergence rate of smoothing parameter hMto 0 has to satisfy P(aM≤hM≤bM)→
1, for some deterministic sequences of positive numbers aMandbMsuch thatbM−→0
andap+2
MM/logM→∞ asT→∞ .
These regularity conditions for kernel functions apply to commonly used options in prac-
tice, for instance, the Gaussian kernel.
Corollary 3.1.4 (EG Test for non-causality) .Under H0and Assumptions 1-4, let the matrix
E/parenleftBig
δt,τδ/prime
t,τ/parenrightBig
be nonsingular in a neighborhood of θ(τ) =θ0(τ)for allτ∈Υ,
REG
T/parenleftBig
x,τ;ˆθ/parenrightBig
=⇒REG
∞(x,τ),
and
/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREG
T/parenleftBig
x,τ;ˆθ/parenrightBig/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ)−→d/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREG
∞(x,τ)/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ),
whereREG
∞is a Gaussian process with mean zero and covariance function characterized by
(τ1∧τ2−τ1τ2)E{Πτ1I(Xt≤x1) Πτ2I(Xt≤x2)},
with the so-called orthogonal projection operator on the weighting function
ΠτI(Xt≤x)≡I(Xt≤x)−D/prime(x,θ0(τ))E−1(δt,τδt,τ)δt,τ.
andδt,τ=f(X/prime
tθ0(τ)|Xt)Xt,D(x,θ0(τ)) =E(δt,τI(Xt≤x)).
As stated before, the main advantage of the EG test is the limiting distribution of the
test statistic being invariant to the estimation eﬀect of ˆθ(τ). Therefore, compared to the
asymptotic distribution of the EV test, there is no ”drift” term subtracted from a Gaussian
process. However, this asymptotic distribution still depends on the data-generating process.
Consequently, we cannot tabulate the critical values for the considered statistic. This is
coped with the aid of a multiplier bootstrap approach. The approximation based on a
transformation on REG
T/parenleftBig
x,τ;ˆθ/parenrightBig
is obtained by multiplying by a sequence of iid random
15variables{Wt}T
t=1with zero mean and unit variance, independent on Xt,
˜REG
T,t/parenleftBig
x,τ;ˆθ/parenrightBig
=√
TT/summationdisplay
t=1

Ψτ/parenleftBig
Yt−X/prime
tˆθ/parenrightBig
I(Xt≤x)−ˆD/prime
T/parenleftBig
x,ˆθ(τ)/parenrightBig/parenleftBigg
T−1T/summationdisplay
t=1ˆδt,τˆδ/prime
t,τ/parenrightBigg−1
ˆδt,τ


Wt.
(3.13)
One common choice of {Wt}T
t=1is


P(W= 1−ω) =ω/√
5
P(W=ω) = 1−ω/√
5,withω=/parenleftBig√
5 + 1/parenrightBig
/2.(3.14)
This transformation has been proven by Escanciano and Goh (2014) to restore the limiting
distribution of the original statistic. It allows us to use the empirical distribution of any
continuous functional, including CvM form, Γ/parenleftBig˜REG
T,t/parenrightBig
, i.e.,
ˆP/bracketleftBig
Γ/parenleftBig˜REG
T,t/parenrightBig
≤ω|{Wt}T
t=1/bracketrightBig
=1
TT/summationdisplay
t=1I/parenleftBig
Γ/parenleftBig˜REG
T,t/parenrightBig
≤ω/parenrightBig
to consistently estimate the limiting distribution of the original statistic Γ/parenleftBig
REG
T/parenrightBig
. Likewise,
the (1−α)-th empirical quantile of the transformed statistic,
cEG
T(α) = inf/braceleftBig
ω:ˆP/bracketleftBig
Γ/parenleftBig˜REG
T/parenrightBig
≤ω|{Wt}T
t=1/bracketrightBig
≥1−α/bracerightBig
,
will is a consistent estimate of the critical value at αsigniﬁcance level.
In the presence of non-causality, ψ(L−1) does not vanish from general MAR( r,s) processes.
Then, by Corollary 3.1.1,
E/parenleftbigΨτ/parenleftbigYt−X/prime
tθ1(·)/parenrightbigexp (i·Xt)/parenrightbig/negationslash= 0
and
E/parenleftbigΨτ/parenleftbigYt−X/prime
tθ1(·)/parenrightbigI(Xt≤·)/parenrightbig/negationslash= 0
in a set with a positive Lebesgue measure on Rp+1×Υ, provided that Φ and Ware absolutely
continuous on Rp+1×Υ with respect to the Lebesgue measure. Correspondingly, under the
alternative,
Γ/parenleftBig
REV
T/parenrightBig
=/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREV
T/parenleftBig
x,τ;ˆθ/parenrightBig/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ)→p∞
and
Γ/parenleftBig
REG
T/parenrightBig
=/integraldisplay
τ∈Υ,x∈Rp+1/vextendsingle/vextendsingle/vextendsingleREG
T/parenleftBig
x,τ;ˆθ/parenrightBig/vextendsingle/vextendsingle/vextendsingle2dΦ(x)dW(τ)→p∞,
so both speciﬁcation-based tests are consistent.
164 Monte Carlo Simulations
In this section, we study the performance of the three proposed tests in ﬁnite samples and
compare them with each other in terms of size and power.
Constancy Test In the ﬁrst experiment, we focus on the approach based on the constancy
test. In the simulation, we consider a pair of MAR(1 ,0) and MAR(0 ,1) models


(1−φL)Yt=ut
/parenleftbig1−ψL−1/parenrightbigY∗
t=ut,(4.1)
which are generated from 11 non-Gaussian distributed innovations, which cover a majority
of distributions commonly used in the empirics, ranging from symmetric to asymmetric,
bounded to unbounded support, with mixed types of tail behavior. The parameters ( φ,ψ)
with values (0 .3,0.6,0.9) enable us to investigate the sensitivity of the method responding to
data-generating processes with diﬀerent persistence. The sample sizes are 200 and 500 with
500 replications. /epsilon1= 0.05 is the default choice for the quantile interval [ /epsilon1,1−/epsilon1]⊂(0,1).
The empirical size and power of rejecting the constancy hypothesis to detect non-causality
under the QAR framework are summarized in Table 1.
Regarding the size, the constancy test has an empirical size close to the nominal level in most
cases but suﬀers from a severe over-rejection for heavy-tailed distributions. This corresponds
to the estimation of conditional quantiles of these processes when τis extremely close to 0
or 1, which generally calls for a larger sample size to produce less biased and more stable
estimates. The volatility of QAR estimates of extremal quantiles triggers the over-rejection
of the constant coeﬃcients under the causality hypothesis. Therefore, as seen in Figures
4.1c and 4.1d, where innovations follow truncated Cauchy distribution9and log-normal dis-
tribution, respectively, the QAR estimates at quantiles close to 0 and 1 turn rather volatile
compared to the estimates at other levels in (0 ,1). To alleviate this issue, we propose to
check diﬀerent trimming strategies in the quantile interval for the test. There is an obvious
trade-oﬀ in the selection of truncation of the quantile interval: over-trimmed, the power of
the test will decrease due to the loss of valuable information; under-trimmed, the volatile
estimate of extremal quantiles is not excluded, so the distortion in size will remain as be-
fore. Consequently, we conduct some experiments to analyze the sensitivity of the constancy
test in response to truncated intervals; see Table 2. The results suggest a trimmed quantile
interval [0.10,0.90] would be appropriate for the sample size considered because the power
remains relatively high while the size is close to the nominal level. Another possible reason
highlighted by Koenker and Xiao (2002) is that the default smoothing parameter selection
for estimating the density function of innovations, which comprises the test statistic in the
KhmaladzeTest command in R studio, produces satisfactory performance for the class of dis-
tributions considered there, but is not designed for heavy-tailed distributed innovations. A
more adaptive bandwidth choice of density function estimation of heavy-tailed distributions
at extreme quantiles needs further investigation.
9Truncated at a suﬃciently large value to ensure the existence of variance.
17From the perspective of power, the test achieves a signiﬁcant leap in power as the sample size
increases from 200 to 500 in most scenarios. More particularly, the method provides favorable
performance in the presence of asymmetry in the distributions of innovations with rejection
rates of 40%∼90% in 200-sized samples and 70% ∼90% in 500-sized samples, respec-
tively. This ﬁnding coincides with the idea shared in Velasco and Lobato (2018), where the
third-order moments contribute most to the identiﬁcation of non-causal AR processes. This
phenomenon is exceptionally well-illustrated in the ﬁrst four cases (Exponential, Gamma,
Beta, and F distributions) when the distribution of innovations is skewed but has no heavy
tails. However, in the cases where innovations do not display skewness or heavy-tailedness,
the test can barely distinguish non-causal processes from their causal counterparts, see Fig-
ure 4.2. The point of the failure is illustrated in the same ﬁgure. The QAR estimates for
non-causal AR(1) with symmetric innovations appear to be indistinguishable from the ones
for the causal counterparts, even under misspeciﬁcation.
Table 1: Empirical size and power of non-causality test using constancy⋆test in QAR in various cases
Distribution test T=200 T=500
ut φ(ψ) = 0.3†φ(ψ) = 0.6φ(ψ) = 0.9φ(ψ) = 0.3φ(ψ) = 0.6φ(ψ) = 0.9
Exp(1)-1size 4.20% 4.00% 4.80% 6.40 % 6.80% 4.80%
power 33.80% 38.80% 40.20% 65.40% 69.60% 72.40%
Gamma(1,1)-1size 4.40% 3.00% 3.80% 5.00 % 5.80% 4.40%
power 34.40% 37.00% 42.20% 64.40% 68.40% 70.20%
Beta(5,1)-5/6size 6.80% 6.60% 5.40% 6.80 % 9.40% 6.40%
power 15.40% 27.20% 39.00% 24.80% 65.00% 77.20%
F(5,5)-5/3size 5.00% 6.60% 3.40% 8.40 % 6.00% 4.20%
power 80.00% 81.80% 70.00% 97.20% 98.20% 96.20%
χ2
5−5size 5.00% 4.40% 4.00% 4.00 % 4.80% 5.20%
power 11.40% 11.40% 8.80% 27.40% 35.60% 17.40%
skewed normalsize 5.20% 6.60% 7.40% 9.80 % 7.40% 9.60%
power 8.00% 7.80% 10.60% 25.40% 20.00% 12.80%
truncated Cauchysize 26.60% 34.80% 43.00% 20.80 % 19.20% 33.20%
power 70.00% 96.40% 92.40% 80.00% 99.80% 91.80%
log normalsize 21.20% 19.60% 23.60% 23.20 % 26.40% 26.60%
power 98.20% 99.00% 99.60% 100.00% 100.00% 100.00%
t3size 5.40% 4.00% 5.00% 4.00 % 6.80% 4.80%
power 9.80% 13.00% 15.80% 11.60% 20.00% 25.80%
uniformsize 6.20% 7.60% 6.00% 6.00 % 6.80% 5.80%
power 13.40% 8.00% 13.20% 40.40% 7.80% 48.80%
Laplacesize 3.40% 4.00% 4.60% 2.60 % 3.80% 4.60%
power 8.40% 5.60% 17.00% 10.80% 8.60% 29.00%
⋆: constancy test over the quantile interval [0 .05,0.95].
†:φ(ψ) = 0.3 means the coeﬃcient in the lag polynomial of the MAR(1 ,0) process (purely causal) is 0 .3; the
coeﬃcient in the lead polynomial of the MAR(0 ,1) process (purely non-causal) is 0 .3 as well, for comparison.
EV Test With the same setting as the one in the Constancy Test, we take the case with
the coeﬃcient φ(ψ) = 0.6 for MAR(1 ,0) (MAR(0 ,1)) as the representative to examine the
performance of EV test in discriminating non-causal processes from their causal alternatives.
The sample size varies from 100 to 200 and 500. The number of replications is 500. Regarding
the bandwidth for the subsampling scheme to approximate the critical value, we choose
b=⌊4T2/5⌋. As for the weighting functions involved in the expression (3.8), a uniform
18(a)χ2
5−5 distribution
 (b)skewed normal distribution
(c)truncated Cauchy distribution
 (d)log normal distribution
Figure 4.1: Four cases of QAR(1) on MAR(1 ,0) and MAR(0 ,1), T=500, φ(ψ) = 0.6 : asymmetric
distributions
(a)t3distribution
 (b)uniform distribution
(c)Laplace distribution
Figure 4.2: Three cases of QAR(1) on MAR(1 ,0) and MAR(0 ,1), T=500, φ(ψ) = 0.6: symmetric
distributions
19Table 2: Empirical size and power of non-causality test using constancy test with diﬀerent trimmed quantile interval
Sample size [0 .05,0.95]φ(ψ) = 0.3φ(ψ) = 0.6φ(ψ) = 0.9φ(ψ) =−0.4φ(ψ) =−0.6φ(ψ) =−0.8
T=100size 2.40% 2.20% 2.60% 2.80% 2.00% 2.40%
power 22.40% 24.60% 22.00% 4.80% 32.80% 26.60%
T=200size 3.60% 3.60% 4.00% 5.00% 2.80% 4.40%
power 40.80% 38.60% 41.80% 8.40% 48.00% 44.00%
T=500size 3.40% 6.20% 4.80% 6.60 % 4.80% 3.40%
power 67.20% 67.00% 72.40% 14.20% 66.00% 72.20%
Sample size [0 .10,0.90]φ(ψ) = 0.3φ(ψ) = 0.6φ(ψ) = 0.9φ(ψ) =−0.4φ(ψ) =−0.6φ(ψ) =−0.8
T=100size 3.40% 3.20% 3.20% 3.80% 2.40% 3.40%
power 28.00% 25.40% 22.80% 6.00% 32.80% 28.20%
T=200size 3.20% 2.80% 5.00% 3.00% 4.20% 4.00%
power 37.40% 43.40% 43.20% 5.80% 49.40% 48.80%
T=500size 4.80% 5.40% 6.00% 4.60 % 3.80% 5.00%
power 71.20% 67.80% 69.20% 14.60% 65.40% 72.80%
Sample size [0 .15,0.85]φ(ψ) = 0.3φ(ψ) = 0.6φ(ψ) = 0.9φ(ψ) =−0.4φ(ψ) =−0.6φ(ψ) =−0.8
T=100size 4.40% 2.60% 3.60% 5.00% 3.00% 3.00%
power 27.80% 28.20% 21.80% 8.80% 37.60% 30.20%
T=200size 5.60% 3.80% 3.60% 6.60% 3.40% 4.40%
power 39.00% 40.00% 42.40% 9.60% 51.60% 46.60%
T=500size 5.40% 4.40% 5.00% 4.20 % 4.80% 5.40%
power 64.80% 65.80% 69.00% 21.80% 68.00% 71.60%
The innovations follow exponential distribution.
distribution is applied to W(τ) deﬁned on the evenly discretized quantile interval Υ =
[0.01,0.99] and 2-dimensional standard normal distribution to Ψ( x) for the sake of simplicity
in the calculation. The results of the empirical size and power are displayed in Table 3.
Concerning size, the results present some ﬂuctuation around the nominal level. The test
tends to under-reject the correct null hypothesis in the light-tailed scenarios while over-rejects
in the heavy-tailed scenarios. This comes from the subjective choice in the subsampling size,
whose performance can be sensitive to the quantile interval included in the test and the data-
generating process. Nevertheless, the distortion in size is not so signiﬁcant, and we believe
this can be eased by choosing diﬀerent subsampling schemes. As for power, the test achieves
reasonably good performance generally. From the simulation results, we observe that the
power of detecting non-causality is close to 100% in most cases when the sample size is 500,
which is as expected. It is worth noting that the convergence rate of power towards 100%
varies across diﬀerent distributions. The numerical evidence indicates that the further the
innovations depart from Gaussianity, the faster the convergence rate is. In such log-normal
and uniform distributions, a reasonably high power, like 86% or 92%, has been obtained in
relatively small samples. While others (chi-square) may need larger samples to reach the
same level of power.
EG Test The setup of DGP keeps unchanged, like in the EV test. The sample size varies
from 50 to 100 and 200. The weighting functions Ψ( x) andW(τ) in the CvM form of
REG
T/parenleftBig
x,τ;ˆθ/parenrightBig
are chosen to be the empirical distribution of Xtand uniform distribution
over the grid of quantiles from Υ = [0 .01,0.99] considered in the estimation. The critical
20Table 3: Empirical size and power of non-causality test using EV test
in QAR in various cases
Distribution parameter: φ(ψ) = 0.6
ut T: 100 200 500
Gaussiansize 2.20% 3.40% 3.40%
power 0.40% 0.60% 2.60%
exponentialsize 4.40% 1.80% 2.00%
power 29.20% 43.20% 97.20%
Gammasize 1.80% 3.00% 2.80%
power 10.60% 41.60% 97.60%
Betasize 3.20% 3.20% 3.40%
power 26.40% 67.80% 99.00%
Fsize 3.60% 5.80% 3.40%
power 24.00% 67.60% 99.00%
χ2
5−5size 4.80% 4.40% 3.60%
power 13.40% 22.20% 68.40%
log normalsize 5.40% 4.60% 6.80%
power 54.00% 92.40% 100.00%
t3size 6.20% 7.00% 6.40%
power 13.80% 42.40% 93.40%
Uniformsize 5.00% 6.00% 3.40%
power 44.00% 86.80% 100.00%
Laplacesize 4.40% 4.80% 4.40%
power 14.00% 47.20% 98.20%
EV test: the choice of size for subsampling is ⌊4T2/5⌋.
value is obtained through the multiplier bootstrap introduced in the methodology section.
Implementing the multiplier bootstrap avoids computing the estimates for each subsample.
The results are summarized in Table 4. Regarding the empirical size performance, this ap-
proach delivers stable rejection frequencies under the null hypothesis associated with their
nominal level in all cases considered in the simulation exercise. This is anticipated in accor-
dance with the argument in the previous section that there is no subjective choice involved
in the approximation of the critical value. In terms of power, the EG test has an increasing
trend as the sample is enlarged. Similar to the EV test, the EG approach outperforms in the
presence of skewness and excess kurtosis (regardless of negative or positive), with a rejection
probability over 70% in relatively small samples (200). For the cases where the performance
is less satisfactory, such as t3and Laplace distributions, power still increases when the sample
size becomes larger.
An overall comparison of the three methods is exhibited in Table 5. Size-wise, the EG test
has an appealing attribute of undistorted size in general scenarios compared to the other two
approaches. On the contrary, the constancy test suﬀers from over-rejection in heavy-tailed
cases, and the EV test delivers less accuracy than the EG test in some cases. Power-wise,
the EG test is the most robust one as it produces relatively good results in all situations but
is extraordinarily competent for asymmetric distributions. By contrast, the EV test achieves
the highest power among the three in the symmetric cases. In comparison, the constancy
test can be a powerful tool in detecting non-causality in processes with heavy tails. However,
given that the consistency of the constancy test for non-causality is not guaranteed and the
size is distorted, it may give misleading conclusions in empirical analysis. Thus, the con-
21Table 4: Empirical size and power of non-causality test using EG test
in QAR in various cases
Distribution parameter: φ(ψ) = 0.6
ut T: 50 100 200
Gaussiansize 6.00% 5.00% 4.00%
power 4.80% 5.60% 5.80%
exponentialsize 5.20% 4.60% 6.00%
power 24.80% 49.20% 76.40%
Gammasize 5.00% 5.60% 5.00%
power 23.80% 45.80% 75.80%
Betasize 6.40% 5.80% 6.00%
power 24.20% 42.20% 75.80%
Fsize 4.40% 5.00% 5.40%
power 22.60% 37.40% 67.00%
χ2
5−5size 6.60% 5.40% 4.60%
power 12.80% 22.60% 41.60%
log normalsize 5.60% 5.40% 4.00%
power 32.00% 60.60% 85.80%
t3size 4.40% 6.60% 7.00%
power 6.80% 14.80% 36.20%
Uniformsize 4.80% 6.60% 6.60%
power 10.20% 25.40% 64.80%
Laplacesize 5.60% 5.00% 6.80%
power 8.20% 14.40% 41.60%
EG test: critical value obtained from multiplier bootstrap.
stancy test can only be considered a preliminary test to check whether the process is likely
non-causal, followed by the implementation of the EV or EG tests, which serve as the formal
tests for non-causality. In practice, a combination of the constancy test and EV (EG) test
is suggested.
5 Empirical Applications
In this section, we apply our non-causality tests to six ﬁnancial series studied in Fries and
Zakoian (2019): cotton price, soybean price, sugar price, coﬀee price, Hang Seng Index (HSI),
and Shiller Price/Earning ratio (Shiller PE), where single or multiple spikes and asymmetric
dynamics are exhibited. Fries and Zakoian (2019) found numerical evidence in favor of
MAR(r,s) models in ﬁtting time series with local explosiveness phases compared to purely
causal AR models. The frequency of data is quarterly for the Shiller PE series and monthly
for the rest10. The trajectories of these series are displayed in Figure 5.1.
Before proceeding to our testing strategies, we must ensure that the series is stationary. The
augmented Dickey-Fuller tests indicate no unit roots in the cotton, soybean, sugar, and coﬀee
price. Neither the evidence of unit root is found in the series of HSI after a linear trend is
subtracted. The stationarity of the Shiller PE series is secured after the ﬁrst diﬀerence in the
levels. The sample partial autocorrelation function for each series is computed, see Figure
5.2, to determine the order of the lag orders: cotton: 2; soybean: 2; sugar: 4; coﬀee: 3; HSI:
10The access of the replication data can be found in Fries and Zakoian (2019)
22Table 5: Comparison of QAR-based non-causality tests
Distribution test type: constancy test EV test EG test
ut T: 100 200 100 200 100 200
Gaussiansize 2.80% 5.40% 2.20% 3.40 % 5.00% 4.00%
power 4.20% 3.40% 0.40% 0.60% 5.60% 5.80%
exponentialsize 3.20% 4.00% 4.40% 1.80% 4.60% 6.00%
power 25.40% 38.80% 29.20% 43.20% 49.20% 76.40%
Gammasize 3.80% 3.00% 1.80% 3.00% 5.60% 5.00%
power 26.60% 37.00% 10.60% 41.60% 45.80% 75.80%
Betasize 4.20% 6.60% 3.20% 3.20% 5.80% 6.00%
power 18.60% 27.20% 26.40% 67.80% 42.20% 75.80%
Fsize 6.80% 6.60% 3.60% 5.80% 5.00% 5.40%
power 62.40% 81.80% 24.00% 67.60% 34.70% 67.00%
χ2
5size 5.80% 4.40% 4.80% 4.40% 5.40% 4.60%
power 9.60% 11.40% 13.40% 22.20% 22.60% 41.60%
log normalsize 20.20% 19.60% 5.40% 4.60% 5.40% 4.00%
power 78.80% 99.60% 54.00% 92.40% 60.60% 85.80%
t3size 3.40% 4.00% 6.20% 7.00% 6.60% 7.00%
power 10.20% 13.00% 13.80% 42.40% 14.80% 36.20%
Uniformsize 6.80% 7.60% 5.00% 6.00% 6.60% 6.60%
power 7.40% 8.00% 44.00% 86.80% 25.40% 64.80%
Laplacesize 5.80% 4.00% 4.40% 4.80% 5.00% 6.80%
power 5.20% 5.60% 14.00% 47.20% 14.40% 41.60%
Constancy test: with trimmed quantile interval [0 .05,0.95]
1; Shiller PE: 7.
Three non-causality testing procedures: the constancy test, the EV test, and the EG test,
are applied to each series, respectively. The corresponding results are reported in Table 6. For
the constancy test, we consider two trimmed quantile intervals: [0 .05,0.95] and [0.10,0.90]
to mitigate the instability eﬀect on the power from the subjective choice in the quantiles.
Both in the cases of cotton and sugar series, a signiﬁcant ﬂuctuation in the coeﬃcients is
observed. Yet no strong evidence against linear quantile speciﬁcation is found based on the
EV or EG test. The strong rejection in the constancy test for these series may result from
the over-rejection issue in heavy-tailed scenarios, which makes the results from the EV or
EG tests more reliable. This does not deviate much from the results obtained by Fries and
Zakoian (2019), where they found one non-causal root (0.94) in the cotton series and a root
(0.92) in the sugar series. As seen in the numerical experiments, a non-causal AR model with
coeﬃcients near the unity makes it harder to distinguish from its causal counterpart, as well
as generates less distinct dynamics than its causal counterpart. For three series (soybean,
coﬀee, and Shiller PE), the tests show strong evidence favoring non-causal processes at 5%
or even 1% level from all three testing strategies. For HSI, the test shows mild evidence of
non-causality at the signiﬁcance level of 10% based on the EG test. This result is compatible
with the conclusion drawn in Fries and Zakoian (2019), where mixed models with nontrivial
non-causal components11are selected.
11The coeﬃcients of the non-causal components in the MAR( r,s) models are not closed to the unity.
23Figure 5.1: Financial series trajectories
24Figure 5.2: Sample partial autocorrelation functions of six ﬁnancial series
25Table 6: Non-causality tests for six ﬁnancial series in Fries and Zakoian (2019)
Financial series test type: constancy test EV test EG test
total AR order( r+s) [0 .05,0.95]†[0.10,0.90]
Cotton 2statistic 6 .897∗∗4.738∗∗0.012 0.025
critical value12(3.393) (3.287) (0.046) (0.032)
Soybean 2statistic 4 .703∗∗4.445∗∗0.209∗∗0.027∗∗
critical value (3.393) (3.287) (0.158) (0.021)
Sugar 4statistic 306 .043∗∗144.025∗∗0.009 0.065
critical value (5.560) (5.430) (0.102) (0.100)
coﬀee 3statistic 8 .457∗∗6.992∗∗0.149∗∗0.044∗∗
critical value (4.523) (4.383) (0.089) (0.025)
Hang Seng Index 1statistic 0.017 0.012 0.168 0 .078∗
critical value (2.140) (2.102) (0.176) (0.083)
Shiller’s P/E ratio 7statistic 15 .105∗∗9.027∗∗0.197∗∗0.135∗∗
critical value (8.578) (8.368) (0.189) (0.066)
†the trimmed quantile interval considered in the constancy test.
∗∗stands for signiﬁcance at level 5% and ∗stands for signiﬁcance at 10%.
the critical value at 10% signiﬁcance level for the EG test in the case of Hang Seng Index is 0.061.
6 Extensions and conclusion
6.1 Some Extensions
So far, the preceding discussion has been conﬁned to MAR( r,s) driven by iidinnovations.
Within this framework, the only possible source of non-linearity in MAR( r,s) is non-causality,
which contributes to the consistency of the test in the aforementioned methods. However,
stylized nonlinear dynamics like conditional heteroskedasticity or asymmetric dynamics are
prevalently observed in the ﬁnancial and macroeconomic data, which renders it more demand-
ing to detect non-causality in a time series process. A more robust methodology applicable
to AR models accommodating non-linear features needs investigation. The critical point is
how to disentangle non-linearity induced by non-causality from the other alternatives. If
these non-linear features can be captured by a parametric model, one plausible solution is to
incorporate these non-linear terms into the baseline model (2.1). Below we list some possible
extensions where this strategy is employed.
Asymmetric Dynamics This can be solved by allowing varying coeﬃcients in the MAR( r,s)
model in the spirit of the random coeﬃcient model, deﬁned by
˜φ(L)˜ψ(L−1)Yt=ut (6.1)
where ˜φ(L) = 1−φ1(Ut)L−···−φr(Ut)Lrand ˜ψ= 1−ψ1(Ut)L−1−···−ψs(Ut)L−s,Ut
is aniidsequence of random variables following standard uniform distribution, and utis an
iidinnovation sequence satisfying Assumptions 1. Denote
Ωc=/parenleftBigg
φ1(Ut)... φr−1(Ut)φr(Ut)
Ir−1 0(r−1)/parenrightBigg
and
Ωnc=/parenleftBigg
ψ1(Ut)... ψs−1(Ut)ψs(Ut)
Is−1 0(s−1)/parenrightBigg
.
26Similar to the p-th order autoregressive process, which is designed to accommodate asym-
metric dynamics in Koenker and Xiao (2006) for linear QAR model, we need to assume
E(Ωc⊗Ωc) and E(Ωnc⊗Ωnc) have eigenvalues with moduli less than one. This equation
(6.1) is able to mimic asymmetric dynamics since φj,ψj’s are functions [0 ,1]→R. The
deﬁnition of non-causality in this context will be adapted to that ˜ψ(L−1) does not decline
to constant. In the causal situation, this model (6.1) works like a random coeﬃcient model
with lags. The linearity of the conditional mean is restored, and the linear quantile dynamic
model with varying coeﬃcients over diﬀerent quantiles remains the correct speciﬁcation for
conditional quantiles of Yt. On the other hand, when the process is non-causal, it is con-
ceivable that linearity will not hold anymore. Therefore, the methodology relying on the
speciﬁcation tests is applicable here.
Volatility Clustering Concerning volatility clustering, which is routinely modeled by the
quadratic ARCH/GARCH model in squared residuals. Another popular choice is to replace
the squared value with the absolute value suggested by Taylor (2008) and make the model a
linear ARCH.
φ(L)ψ(L−1)Yt=vt
wherevt=σtut
σt=γ0+γ1|vt−1|+···+γq|vt−q|(6.2)
whereφ(L) andψ(L−1) are deﬁned following (2.1), and utis a sequence of iid innovations.
The linear ARCH model is able to capture the correlation in the variance and meanwhile
preserves a relatively simple linear speciﬁcation compared to other alternatives like GARCH.
Under the H0whereψ(L−1) degenerates to 1, the linearity of conditional quantile speciﬁca-
tion still holds after adding {|vt−j|}q
j=1into the regression equation.
QYt(τ|Yt−1,Yt−2,...) =φ1Yt−1+···+φrYt−r+Qut(τ) (γ0+γ1|vt−1|+···+γq|vt−q|)
=Qut(τ)γ0/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
˜γ0(τ)+Qut(τ)γ1/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
˜γ1(τ)|vt−1|+···+Qut(τ)γq/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
˜γq(τ)|vt−q|+φ1Yt−1+···+φrYt−r
= ˜γ0(τ) + ˜γ1(τ)|vt−1|+···+ ˜γq(τ)|vt−q|+φ1Yt−1+···+φrYt−r,
(6.3)
where|vt−j|can be recovered by Yt−j−φ1Yt−j−1−···−φrYt−j−r. Under non-causality,
the explicit expression of the conditional quantile of Ytremains unclear. Nevertheless, it
cannot be characterized by encompassing linear combinations of residuals in the model.
Consequently, the linear dynamic quantile model would not be the correct speciﬁcation
conceivably.
Overall, these two possible extensions to cases with nonlinear dynamics are tentative since
the statistical properties of conditional quantiles of Ytdeﬁned by (6.1) and (6.2) require
further investigation, which opens a couple of lines for future research. Some simulation
trials in Appendix 7.4 have shown the validity of the proposed strategies.
276.2 Perspective from Extreme Quantiles
One intriguing observation from the simulation is that QAR estimates at extreme quantiles
might be informative for identifying the true models even though linear quantile speciﬁcation
is incorrect for the conditional quantile of non-causal processes. As depicted in Figure 4.1,
for MAR(0,1) processes with coeﬃcient 0 .6 driven from asymmetric innovations,
/parenleftBig
1−0.6L−1/parenrightBig
Yt=ut⇔Yt= (0.6)−1Yt−1−(0.6)−1ut−1.
The estimated slope of Yt−1approaches (0 .6)−1when the quantile gets close to 0 or 1.
Somehow it indicates that the linear correlation at extreme quantiles between YtandYt−1
can help to discriminate causality and non-causality. A similar idea has been adopted for
model selection based on the extreme clustering of residuals by Fries and Zakoian (2019), but
the method is restricted to α−stable distributions. Rich data is required for further analysis
to get a less biased estimator for conditional quantiles close to 0 or 1. This opens a possible
avenue for future research in line with identifying causal and non-causal processes using tail
information of processes.
6.3 Conclusion
This paper introduces three novel testing strategies for non-causality in linear time series
within the quantile regression framework. The tests exploit the non-linearity of autoregressive
processes with non-causality and achieve the objective of detecting non-causality based on the
well-developed inference under the QAR framework. The constancy test shares the simplicity
of implementation but lacks consistency since the behavior of linear quantile autoregression
for non-causal processes is not clear yet. This issue from the constancy test is tackled
by testing the speciﬁcation of linear conditional quantile models to detect non-causality.
Speciﬁcation-based non-causality testing procedures like EV and EG tests yield stable size
at a nominal level and fairly satisfactory power. On the one hand, the EV test outperforms
the EG test in platykurtic and leptokurtic situations or symmetric distributions. On the
other hand, the EG test is less computationally cumbersome and shows better performance
when the process is skewed. However, no method is placed in a dominating situation. Thus,
a combined testing procedure with the constancy test as a preliminary check complemented
with either EV or EG test is suggested for practitioners.
Some possible extensions to accommodate diﬀerent dependence in model innovations, which
might bring obstacles in detecting non-causality, are proposed at the end of the paper. Some
simulation results in QAR estimate at extreme quantiles indicate the possibility of identifying
non-causal processes by employing information from the tails of processes.
28References
Alessi, L., Barigozzi, M. and Capasso, M. (2011) Non-fundamentalness in structural econo-
metric models: A review. International Statistical Review ,79, 16–47.
Angrist, J., Chernozhukov, V. and Fern´ andez-Val, I. (2006) Quantile regression under mis-
speciﬁcation, with an application to the us wage structure. Econometrica ,74, 539–563.
Breid, F. J., Davis, R. A., Lh, K.-S. and Rosenblatt, M. (1991) Maximum likelihood es-
timation for noncausal autoregressive processes. Journal of Multivariate Analysis ,36,
175–198.
Breidt, F. J., Davis, R. A., Trindade, A. A. et al. (2001) Least absolute deviation estimation
for all-pass time series models. The Annals of Statistics ,29, 919–946.
Brockwell, P. J. and Davis, R. A. (2009) Time series: theory and methods . Springer Science
& Business Media.
Cavaliere, G., Nielsen, H. B. and Rahbek, A. (2020) Bootstrapping noncausal autoregressions:
with applications to explosive bubble modeling. Journal of Business & Economic Statistics ,
38, 55–67.
Chen, B., Choi, J. and Escanciano, J. C. (2017) Testing for fundamental vector moving
average representations. Quantitative Economics ,8, 149–180.
Escanciano, J. C. and Goh, S.-C. (2012) Conditional density estimation in linear quantile
regression. (unpublished) .
— (2014) Speciﬁcation analysis of linear quantile models. Journal of Econometrics ,178,
495–507.
Escanciano, J. C. and Velasco, C. (2010) Speciﬁcation tests of parametric dynamic condi-
tional quantiles. Journal of Econometrics ,159, 209–221.
Fries, S. and Zakoian, J.-M. (2019) Mixed causal-noncausal ar processes and the modelling
of explosive bubbles. Econometric Theory ,35, 1234–1270.
Gouri´ eroux, C. and Zako¨ ıan, J.-M. (2017) Local explosion modelling by non-causal process.
Journal of the Royal Statistical Society: Series B (Statistical Methodology) ,79, 737–756.
Hall, P. and Sheather, S. J. (1988) On the distribution of a studentized quantile. Journal of
the Royal Statistical Society: Series B (Methodological) ,50, 381–391.
Hecq, A. and Sun, L. (2021) Selecting between causal and noncausal models with quantile
autoregressions. Studies in Nonlinear Dynamics & Econometrics ,25, 393–416.
Hecq, A. and Voisin, E. (2021) Forecasting bubbles with mixed causal-noncausal autoregres-
sive models. Econometrics and Statistics ,20, 29–45.
Jin, W. (2021) Estimation of time series models using generalized spectral distribution.
Preprint .
29Koenker, R. and Xiao, Z. (2002) Inference on the quantile regression process. Econometrica ,
70, 1583–1612.
— (2006) Quantile autoregression. Journal of the American statistical association ,101,
980–990.
Lanne, M. and Luoto, J. (2013) Autoregression-based estimation of the new keynesian phillips
curve. Journal of Economic Dynamics and Control ,37, 561–570.
Lanne, M., Luoto, J. and Saikkonen, P. (2012) Optimal forecasting of noncausal autoregres-
sive time series. International Journal of Forecasting ,28, 623–631.
Lanne, M., Meitz, M., Saikkonen, P. et al. (2013) Testing for linear and nonlinear predictabil-
ity of stock returns. Journal of Financial Econometrics ,11, 682–705.
Lii, K.-S. and Rosenblatt, M. (1992) An approximate maximum likelihood estimation for non-
gaussian non-minimum phase moving average processes. Journal of Multivariate Analysis ,
43, 272–299.
— (1996) Maximum likelihood estimation for nongaussian nonminimum phase arma se-
quences. Statistica Sinica , 1–22.
Portnoy, S. and Koenker, R. (1989) Adaptive l-estimation for linear models. The Annals of
Statistics ,17, 362–381.
Rosenblatt, M. (2000) Gaussian and non-Gaussian linear time series and random ﬁelds .
Springer Science & Business Media.
Taylor, S. J. (2008) Modelling ﬁnancial time series . world scientiﬁc.
Velasco, C. (2022) Estimation of time series models using residuals dependence measures.
The Annals of Statistics ,50, 3039–3063.
Velasco, C. and Lobato, I. N. (2018) Frequency domain minimum distance inference for
possibly noninvertible and noncausal arma models. The Annals of Statistics ,46, 555–579.
307 Appendices
7.1 Some Properties of Non-causal Autoregressive Processes
Higher-order Dependence of All-pass Time Series Models Following the same setup
in Example 2.3,
˜ut=1−ψL
1−ψL−1ut=∞/summationdisplay
j=−∞ρjut+j.
The skewness of ˜ utis
E/parenleftBig
˜u3
t/parenrightBig
=∞/summationdisplay
j=−∞ρ3
jE/parenleftBig
u3
t/parenrightBig
=/parenleftBigg
1−3ψ2(ψ+ 1)
ψ2+ψ+ 1/parenrightBigg
E/parenleftBig
u3
t/parenrightBig
,|ψ|<1,
where−1</parenleftBig
1−3ψ2(ψ+1)
ψ2+ψ+1/parenrightBig
<1. From the above expression, it is easy to tell that the
all-pass ﬁlter preserves the symmetry of the innovations if the original ones are not skewed
but might alter the direction of skewness if utis asymmetric by varying values of ψ. Apart
from the correlation in the squared value of ˜ utthat has been explicitly shown in Example
2.3, here we derive the closed-form solution for the dependence at order 3. It suﬃces to show
Cov/parenleftBig
˜u3
t,˜u3
t+h/parenrightBig
is nonzero for h/negationslash= 0.
E/parenleftBig
˜u3
t˜u3
t+h/parenrightBig
=E
∞/summationdisplay
j=−∞∞/summationdisplay
i=−∞∞/summationdisplay
m=−∞∞/summationdisplay
n=−∞∞/summationdisplay
l=−∞∞/summationdisplay
k=−∞ρjρiρmρnρlρkut+jut+iut+mut+h+nut+h+kut+h+l

=
∞/summationdisplay
j=−∞ρ3
jρ3
j+h
/parenleftBig
E(u6
t)−15E(u4
t)E(u2
t)−10E2(u3
t)−15E3(u2
t)/parenrightBig
+ 3
∞/summationdisplay
j=−∞/parenleftBig
ρj+hρ3
j+ρ3
j+hρj/parenrightBig
E(u4
t)E(u2
t)
+

∞/summationdisplay
j=−∞ρ3
j
2
+ 9
∞/summationdisplay
j=−∞ρ2
j+hρj

∞/summationdisplay
j=−∞ρj+hρ2
j

E2(u3
t)
after using/summationtext∞
j=−∞ρjρj+h= 0 (coincides with no correlation property of all-pass time series
process) and/summationtext∞
j=−∞ρ2
j= 1 (variance preserving property),
Cov/parenleftBig
˜u3
t,˜u3
t+h/parenrightBig
=E/parenleftBig
˜u3
t˜u3
t+h/parenrightBig
−E/parenleftBig
˜u3
t/parenrightBig
E/parenleftBig
˜u3
t+h/parenrightBig
generally is not zero. For instance, h= 1, after simpliﬁcation
Cov/parenleftBig
˜u3
t,˜u3
t+1/parenrightBig
=α1E(u6
t) +/parenleftBig
α2E(u4
t) +α4E2(u2
t)/parenrightBig
E(u2
t) +α3E2(u3
t)
with 

α1=−3ψ5(1−ψ2)3
ψ4+ψ2+1
α2=−3ψ3(1−ψ2)3+45ψ5(1−ψ2)3
ψ4+ψ2+1
α3=30ψ5(1−ψ2)3
ψ4+ψ2+1−9(1−ψ2)3(2ψ+1)ψ2
(ψ2+ψ+1)2
α4=45ψ5(1−ψ2)3
ψ4+ψ2+1
31where zeros are not attained at the same value of ψ∈(−1,1)\{0}.
Conditional Density Function of Non-causal Autoregressions In this section, we
try to study the properties of the conditional density function of the response variable in the
presence of non-causality in the autoregressive process through simulations. Consider a pair
of MAR(1,0) and MAR(0 ,1) processes generated from iidinnovations following the same
distribution with the density function fu(·),


Yt= 0.6Yt−1+ut
˜Yt= 0.6−1˜Yt−1+ut= 0.6˜Yt+1−0.6ut+1.(7.1)
One is purely causal, and the other is purely non-causal with a coeﬃcient of 0 .6. We start
by analyzing f(Yt≤y|Yt−1=x) in the causal case.
f(Yt=y|Yt−1=x) =dP(Yt≤y|Yt−1=x)
dy
=dP(0.6Yt−1+ut≤y|Yt−1=x)
dy
=dP(ut≤y−0.6x|Yt−1=x)
dy
=fu(y−0.6x) =fu(y−0.6Yt−1),(7.2)
It is not diﬃcult to conclude from equation 7.2 that the conditional density of YtgivenYt−1
is shifting horizontally as the value of Yt−1varies. Despite the change in the location of the
density function, the rest remains the same across diﬀerent values of Yt−1.
Similarly, we derive the conditional density function for the non-causal case,
f/parenleftBig˜Yt=y|˜Yt−1=x/parenrightBig
=f/parenleftBig˜Yt−1=x|˜Yt=y/parenrightBig
f/parenleftBig˜Yt=y/parenrightBig
f(˜Yt−1=x)by Bayes rule
=f/parenleftBig
0.6˜Yt−0.6ut=x|˜Yt=y/parenrightBig
f/parenleftBig˜Yt=y/parenrightBig
f(Yt−1=x)by deﬁnition of ˜Yt−1
=fu/parenleftbigy−0.6−1x/parenrightbigf/parenleftBig˜Yt=y/parenrightBig
f(Yt−1=x)by the independence of utand ˜Yt
=fu/parenleftbigy−0.6−1x/parenrightbigf/parenleftBig˜Yt=y/parenrightBig
/integraltext∞
−∞f/parenleftBig˜Yt−1=x|˜Yt=s/parenrightBig
f/parenleftBig˜Yt=s/parenrightBig
dslaw of total probability
=fu/parenleftbigy−0.6−1x/parenrightbigf/parenleftBig˜Yt=y/parenrightBig
/integraltext∞
−∞fu(s−0.6−1x)f/parenleftBig˜Yt=s/parenrightBig
ds.
(7.3)
There is no general closed-form solution to this expression. Note that no xplays a role in
f(Yt=y), and the denominator is x−dependent but highly nonlinear due to the integration.
32If we assign additive property13to the marginal distribution of Yt. This nonlinearity can be
shown more clearly. Say utfollows an exponential distribution with rate λ, then the equation
7.3 has the explicit form
f(Yt=y|Yt−1=x)
=/parenleftBig/integraltext∞
−∞e−isy/producttext∞
j=0λ
λ−is(0.6)jds/parenrightBig
λe−(x−0.6y)
/parenleftBig/integraltext∞
−∞e−isx/producttext∞
j=0λ
λ−is(0.6)jds/parenrightBig I(x−0.6y≥0).
This suggests that the shape (functional form) of the density function would diﬀer, corre-
sponding to the choice of x. The following simulation experiment demonstrates this argu-
ment. In this simulation, we generate two AR(1) processes (7.1) by exponentially distributed
(a)conditional density of Ytin the causal
case
(b) conditional density of ˜Ytin the non-
causal case
Figure 7.1: conditional density of Ytgiven diﬀerent x
innovations with rate 1. The sample size is 500. Estimated conditional density functions
f(y|Yt−1=x) are plotted in Figure 7.1, given ﬁve choices of x: 10%, 30%, 50%, 70%, and
90% percentiles of Yt−1sample. The density function is estimated by akjcommand in R
Studio, which is a univariate adaptive kernel estimation used by Portnoy and Koenker (1989).
The left panel displays the result for the causal case. As shown in (7.2), density functions
in diﬀerent colors (values of x) share the same shape but the location. Whereas in the right
panel, where the estimated density is plotted, ﬁve estimated conditional density functions
present distinct modes, skewness, and kurtosis.
7.2 Asymptotic Properties of QAR Estimates
QAR is ﬁrst proposed by Koenker and Xiao (2006) to study the conditional quantile functions
of the following pth-order AR process,
Yt=θ0(Ut) +θ1(Ut)Yt−1+···+θp(Ut)Yt−p, (7.4)
whereUtis an iid sequence distributed as a standard uniform. This expression can be re-
garded as an AR( p) process allowing coeﬃcients of lags to be random but somewhat depen-
13Additive property states the sum of independent variables from the same distribution would follow the
distribution from the same family. The common distributions which share this property are α-stable distri-
bution, exponential distribution, geometric distribution, etc.
33dent on each other. By the property of monotone transformation, our target, the conditional
quantile at each τ∈(0,1), can be written as
QYt(τ|Yt−1,...,Yt−p) =θ0(τ) +θ1(τ)Yt−1+···+θp(τ)Yt−p, τ∈(0,1). (7.5)
The estimates of θ(τ) = (θ0(τ),θ1(τ),...,θp(τ))/primeare obtained by minimizing the following
objective function,
ˆθ(τ) = argmin
θ∈Rp+1T/summationdisplay
t=1ρτ(Yt−X/prime
tθ), (7.6)
whereX/prime
t= (1,Yt−1,...,Yt−p) and check function ρτ(u) =u(τ−I(u<0)). A vectorized
form of (7.4) is introduced to facilitate the asymptotic analysis of the estimates ˆθ(τ),
Yt=AtYt−1+Vt,
with
At=/parenleftBigg
θ1(Ut)θ2(Ut)... θp(Ut)
Ip−1 0(p−1)×1/parenrightBigg
andVt=/parenleftBigg
/epsilon1t
0(p−1)×1/parenrightBigg
where/epsilon1t=θ0(Ut)−E(θ0(Ut)) andYt= (Yt,Yt−1,...,Yt−p+1)/prime. The study of asymptotic
properties is based on the following conditions
1.{/epsilon1t}are iid innovations with mean 0 and ﬁnite variance σ2<∞. The distribution
function of /epsilon1t, F, admits a continuous density f(/epsilon1) away from zero on E={/epsilon1: 0<
F(/epsilon1)<1}.
2. The eigenvalues of E(At⊗At) have moduli within unity.
3. The conditional distribution function P(Yt<·|Yt−1,Yt−2,...) denoted by Ft−1(·) has
a density function ft−1(·) uniformly integrable on E.
Under these three assumptions,
Σ−1/2√
T/parenleftBigˆθ(τ)−θ(τ)/parenrightBig
→dBp+1(τ)
whereBk(τ) is ak-dimensional Brownian bridge. By deﬁnition it can be written as N(0,τ(1−
τ)Ik) for any given τ. Σ is a matrix characterized by density and distribution function of /epsilon1t.
Let Σ 0=E(XtX/prime
t) and Σ 1=E/parenleftBig
ft−1/parenleftBig
F−1
t−1(τ)/parenrightBig
XtX/prime
t/parenrightBig
. Then Σ is deﬁned as Σ−1
1Σ0Σ−1
1.
In the special case where the data generating process is a conventional causal AR model
with ﬁxed coeﬃcients, the conditional density would be independent of Xt. We will have
Σ1=f(F−1(τ))E(XtX/prime
t). Further we can simplify the Σ to f−2(F−1(τ))E−1(XtX/prime
t).
7.3 Proof to Theorem 3.1
Non-causality⇒Nonlinear conditional quantile We prove this statement by con-
tradiction. Consider a stationary MAR( r,s) with innovations satisfying Assumption 1 and
s > 0. Assume all conditional quantiles of Ytare linear in ( Yt−1,Yt−2,...,Yt−p), where
34p=r+s. That is,
QYt(τ|Yt−1,Yt−2,...,Yt−p) =θ0(τ) +θ1(τ)Yt−1+···+θp(τ)Yt−pfor any given τ∈(0,1).
By aggregating QYt(τ|Yt−1,Yt−2,...,Yt−p) over the entire quantile range, the linearity is
maintained for the aggregation. Therefore, we have
/integraldisplay1
0QYt(τ|Yt−1,Yt−2,...,Yt−p)dτ=/integraldisplay1
0θ0(τ)dτ+/integraldisplay1
0θ1(τ)dτYt−1+···+/integraldisplay1
0θp(τ)dτYt−p
(7.7)
Equivalently, we can yield
E(Yt|Yt−1,Yt−2,...,Yt−p) =θ0+θ1Yt−1+···+θpYt−p,
which contradicts the statement in Corollary 5.2.3 by Rosenblatt (2000) on the nonlinearity
of conditional expectation in past information with the presence of non-causality. Thus, the
presumed statement is not valid. That is to say, there exists a conditional quantile of Yt
which is nonlinear in the past information for at least one τ∈(0,1) ifs>0.
Nonlinear conditional quantile ⇒Non-causality This can be demonstrated equiva-
lently by its contrapositive statement: an AR process Ytbeing causal implies its conditional
quantileQYt(τ|It−1) is linear for all τ∈(0,1).
If a MAR(r,s) is purely causal, i.e., s=0 and r=p. Then we have
Yt=φ1Yt−1+φ2Yt−2+···+φrYt−r+ut,
whereutis independent of past observations. The conditional quantile of the response
variable can be directly expressed as a linear combination of {Yt−j}j=1,...,r,
QYt(τ|Yt−1,...,Yt−r) =Qut(τ|Yt−1,...,Yt−r) +φ1Yt−1+φ2Yt−2+···+φrYt−rfor∀τ∈(0,1)
=Qut(τ)/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
θ0(τ)+φ1/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
θ1(τ)Yt−1+φ2/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
θ2(τ)Yt−2+···+φr/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
θr(τ)Yt−r.
7.4 Simulations of Extensions
In this section, we present some simulation results of non-causality testing strategies extended
to the autoregressive processes with heteroskedasticity. In this stage, we assume the form of
heteroskedasticity is known.
Consider a pair of MAR(1 ,0)-ARCH(1) and MAR(0 ,1)-ARCH(1) processes deﬁned by


Yt= 0.7Yt−1+vt
Y∗
t= 0.7−1Y∗
t−1+vt= 0.7Y∗
t+1−0.7vt+1
vt=σtut
σt= 0.2 + 0.8|vt−1|whereut∼IID(0,1).(7.8)
35As explained in the extension section, we want to detect non-causality by checking whether
the coeﬃcients (except the intercept) in the following linear dynamic quantile model are
τ-invariant
QYt(τ|Yt−1,vt−1) =θ0(τ) +θ1(τ)Yt−1+θ2(τ)|vt−1|, τ∈Υ⊂(0,1) (7.9)
provided that vt−1is recovered with 100% accuracy.
Another approach is to check whether the linear model (7.8) is the correct speciﬁcation for the
conditional quantile of YtandY∗
t. The innovation utvaries from exponential to t student and
Laplace distributions. The sample size in this trial is 100, 200, 500, and 1000. The trimmed
quantile interval for the constancy test is [0 .05,0.95] and Υ = [0 .01,0.99] for the speciﬁcation-
based test (here in this experiment, we only apply the EV test to see its performance). The
empirical size and power of non-causality tests for cases with heteroskedasticity are displayed
in Table 7. It is clear that both methods have fairly good performance, even in relatively small
samples. Regarding the empirical size, both approaches have a slight distortion compared to
the nominal level. In the case of the EV test, a diﬀerent bandwidth can be applied to adjust
the empirical size to the expected level. Concerning the empirical power, the speciﬁcation-
based approach dominates the constancy test in most cases. Except in the case of asymmetric
distribution, the constancy test outperforms the EV test in small samples ( T=100 and 200
). It is conceivable that when we replace vtby its estimate ˆ vt, the asymptotic eﬀect of the
estimation needs to be taken into account when we construct test statistics. This is beyond
the scope of this paper.
Table 7: Empirical size and power of non-causality tests for AR-ARCH models with known heteroskedasticity
Distribution test type T=100 T=200 T=500 T=1000
ut size power size power size power size power
Exponentialconstancy test 3.60% 39.00% 4.40% 54.60% 6.00% 75.80% 7.00% 90.80%
EV test 5.20% 16.80% 4.40% 34.80% 4.60% 82.80% 5.00% 97.80%
t studentconstancy test 5.20% 24.60% 6.60% 39.40% 6.00% 63.60% 7.80% 78.00%
EV test 8.20% 51.00% 7.20% 83.20% 8.20% 99.80% 7.20% 100.00%
Laplaceconstancy test 4.40% 14.40% 3.80% 25.00% 7.60% 38.80% 4.40% 55.00%
EV test 7.00% 45.40% 6.40% 82.60% 8.60% 99.20% 7.20% 10.00%
The bandwidth for approximating the critical value using subsampling for the EV test is 7.
36