Computing isogeny classes of typical principally polarized
abelian surfaces over the rationals
Raymond van Bommel, Shiva Chidambaram, Edgar Costa, and Jean Kieffer
Abstract. We describe an efficient algorithm which, given a principally polar-
ized (p.p.) abelian surface AoverQwith geometric endomorphism ring equal
toZ, computes all the other p.p. abelian surfaces over Qthat are isogenous to
A. This algorithm relies on explicit open image techniques for Galois repre-
sentations, and we employ a combination of analytic and algebraic methods
to efficiently prove or disprove the existence of isogenies. We illustrate the
practicality of our algorithm by applying it to 1440894 isogeny classes of
Jacobians of genus 2 curves.
1. Introduction
As a consequence of Faltingsâ€™ finiteness theorems for abelian varieties [Fal83],
the isogeny class of any abelian variety over a number field is finite. In the simplest
case of elliptic curves over Q, we have a good understanding of which shapes
of isogeny classes can arise. Mazurâ€™s isogeny theorem for elliptic curves [Maz78]
provides the list of primes â„“appearing as degrees of isogenies over Q, namely â„“â‰¤19
orâ„“âˆˆ {37,43,67,163}. Furthermore, isogeny classes all have size at most 8[Ken82].
In fact, the possible isogeny graphs can be explicitly listed [CL21, Â§6].
The standard approach to computing isogeny classes of elliptic curves over Q
is the following. Given an elliptic curve E, it is enough to consider isogenies
Eâ†’Eâ€²of prime degree â„“where â„“appears in Mazurâ€™s list. For each such â„“,
computing the possible image curves Eâ€²is a finite problem. The computation can be
carried out either by factoring the â„“-division polynomial of Eand applying VÃ©luâ€™s
formulas [VÃ©l71], or more efficiently using explicit parametrizations or equations for
the Hecke correspondence X0(â„“)â†’X(1)Ã—X(1)[Elk98; CW05]. This method was
used to generate the data currently contained in the L-functions and modular forms
database (LMFDB)1[LMFDB].
As one moves away from the case of elliptic curves over Q, very little is known
on the theoretical side. Nevertheless, by carrying out explicit computations, one can
hope to gain insight into the possible shapes of isogeny classes in higher dimensions.
In this paper, we make a first step in this direction: we describe an algorithm to
compute isogeny classes in the simplest higher-dimensional case, namely that of a
The first three authors were supported by Simons Foundation grant 550033. The fourth
author was supported by Simons Foundation grant 550031.
1Seehttps://www.lmfdb.org/EllipticCurve/Q/Source .
1arXiv:2301.10118v2  [math.NT]  26 Jul 20232 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
principally polarized (p.p.) abelian surface AoverQ. We also make the simplifying
assumption that the geometric endomorphism ring of AisZ, in other words, Ais
typical, although we plan to address more endomorphism ring types in future work.
Our overall strategy is to generalize the above method of computing isogeny
classes to the case of abelian surfaces. However, several obstacles immediately arise:
(1) Isogenies no longer decompose into rational, prime-degree isogenies.
(2)There is no known analogue of Mazurâ€™s theorem for higher-dimensional
abelian varieties.
(3)Division polynomials are too big to be efficiently computed, except for
very small values of â„“. The same is true of explicit equations for higher-
dimensional analogues of the modular curve X0(â„“)studied in [Mil15a]:
see [Mil15b] for examples for very small primes â„“.
We address the first issue in Section 2, where we show that we only need to
consider two types of isogenies of degree â„“2andâ„“4respectively, where â„“is a prime.
We circumvent the second issue in the following way. From any given typical
abelian surface, Serreâ€™s open image theorem for Galois representations [Ser99]
asserts that isogenies of the above types can exist over Qonly for a finite number of
primes â„“(depending on the abelian surface). It is sufficient to consider these primes
to enumerate the â€œneighborsâ€ of Ain the isogeny class. Further, Dieulefait [Die02]
describes how to efficiently compute a finite superset of this list. We review this
method in Section 3, and provide complete proofs for the readerâ€™s convenience.
To address the third issue, we advantageously replace purely algebraic methods
by complex-analytic ones relying on the Siegel moduli space of complex p.p. abelian
surfaces. Concretely, given an abelian surface A, we enumerate images of its period
matrix under certain Hecke correspondences, and compute modular invariants at
these points analytically. By keeping track of the correct scaling factors, we can
actually compute these invariants as algebraic integers (embedded in C), and thus
provably recognize which of these tuples of complex invariants correspond to abelian
surfaces defined over Q. This algorithm is the subject of Section 4. It is significantly
less expensive than writing down equations for modular varieties or factoring division
polynomials, and is practical for isogeny degrees as large as 294= 707 281 , the
largest value we encountered in our computations.
The output invariants only specify the Q-isomorphism class of the abelian
surface Aâ€²isogenous to A. In Section 5, we explain how to obtain the correct Q-
isomorphism class using a well-known and completely algebraic process. First,
Mestreâ€™s algorithm provides a genus 2 curve over Qwhose Jacobian is isomorphic
toAâ€²overQ. We then identify which quadratic twist of that curve represents the
desired Q-isomorphism class.
The resulting algorithm has been implemented: our code and data is publicly
available at https://github.com/edgarcosta/genus2isogenies . Numerical
computations are performed using the C library HDME [Kie23], itself based on the
Arb library [Joh17] for high-precision arithmetic with certified error bounds.
We finally discuss applications of our algorithm in Section 6. We first present
an illustrative example where we found an isogeny of degree 312. We also report
on the results of running our algorithm on a large dataset of Jacobians of genus 2
curves that includes the current LMFDB data [LMFDB]. This dataset consists of
1743737 curves split among 1440894 isogeny classes. By completing these isogeny
classes, we find 600948 new curves.COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 3
Acknowledgements. We thank Fabien ClÃ©ry for communicating us references
on Siegel modular forms, Andrew Sutherland and Noam Elkies for providing us with
interesting genus 2curves to use as an input to our algorithm, and Bjorn Poonen
for helpful conversations.
2. Classification of isogenies
In this section, we describe two fundamental isogeny types that are sufficient to
exhaust isogeny classes of typical p.p. abelian surfaces. The essential ingredient in
this classification is that every isogeny between p.p. abelian varieties is compatible
with the given polarizations up to the action of an endomorphism fixed by the
Rosati involution, as we detail below.
2.1. Isogenies between p.p. abelian varieties. Letkbe a field. For
simplicity, we assume thoughout that khas characteristic zero: this allows us to
identify group schemes over kwith the groups of their k-points endowed with an
action of Gal(k/k). Unless otherwise specified, we only consider abelian varieties
and isogenies that are defined over k. Two isogenies are considered isomorphic if
they have the same domain and differ by an isomorphism on their targets.
LetAbe an abelian variety over k, and denote its dual by Aâˆ¨. Apolarization on
Ais an isogeny Î»:Aâ†’Aâˆ¨of the shape a7â†’Tâˆ—
aL âŠ— Lâˆ’1for some (not necessarily
k-rational) ample line bundle LonA, where Tais the translation by ainA. A
polarization is called principal if it is an isomorphism.
From now on, we assume that Ais principally polarized (p.p.), in other words A
is endowed with a principal polarization Î»A. We then have a Rosati involution
onEnd(A)given by Ï†7â†’Î»âˆ’1
Aâ—¦Ï†âˆ¨â—¦Î»A. An endomorphism Î²âˆˆEnd(A)is called
symmetric if it is invariant under this involution. If Î²is symmetric, then the roots
of its characteristic polynomial are real numbers [Mum70, Thm. 6 p.208], and we
further say that Î²istotally positive if these roots are positive.
ForAas above and any integer n, there exists a canonical symplectic pairing
A[n]Ã—A[n]â†’Âµnknown as the Weil pairing . More generally, if Î²âˆˆEnd(A)is
any endomorphism that is symmetric and totally positive, then Î»Aâ—¦Î²is another
polarization of A[Mum70, (3) p.190 and (IV) p.209]. As in [Mum70, Def. p.227],
we can also define a symplectic pairing on A[Î²]Ã—A[Î²]that we also refer to as the
Weil pairing. We then have the following characterization of isogenies in terms of
maximal isotropic subgroups of torsion subgroups A[Î²]; see also [EGM, Prop. 11.25].
Lemma 2.1. Let(A, Î» A)be a p.p. abelian variety over k. Then there is a one-to-one
correspondence between isomorphism classes of isogenies from Ato other p.p. abelian
varieties Aâ€², and pairs (Î², G), where Î²is a totally positive symmetric endomorphism
ofA, and Gis a subgroup of A[Î²]which is defined over kand maximal isotropic
with respect to the Weil pairing. Explicitly, an isogeny Ï†:Aâ†’Aâ€²corresponds to
the pair (Î², G)such that kerÏ†=GandÎ²is the unique endomorphism satisfying
Ï†âˆ¨â—¦Î»Aâ€²â—¦Ï†=Î»Aâ—¦Î².
Proof. First, we note that any isotropic subgroup of A[Î²]has cardinality at
mostp
#A[Î²], and is maximal if and only if equality holds [Mum70, Thm. 4 p.233].
Let(Aâ€², Î»Aâ€²)be a p.p. abelian variety, and let Ï†:Aâ†’Aâ€²be an isogeny. Then
there is a unique endomorphism Î²ofAsuch that Ï†âˆ¨â—¦Î»Aâ€²â—¦Ï†=Î»Aâ—¦Î². This
Î²is fixed by the Rosati involution, and corresponds via the bijection of [Mum70,
Application III p.208] to an ample line bundle on A, namely the pullback by Ï†of4 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
the ample line bundle on Aâ€²defining the polarization Î»Aâ€². Thus Î²is totally positive.
Moreover, the pairing on A[Î²]becomes trivial on kerÏ†by [Mum70, (1) p.228]. As
deg(Ï†)2=deg(Ï†)deg(Ï†âˆ¨) =deg(Î²), it follows that kerÏ†is a maximal isotropic
subgroup of A[Î²].
On the other hand, if Î²andGare given, then Î»Aâ—¦Î²is a polarization on A,
and the quotient A/Gis principally polarized by [Mum70, Cor. p.231]. â–¡
2.2. Fundamental isogeny types. Assume now that kis a number field. An
abelian variety Aoverkis calledtypicalifEnd(AQ) =Z. IfAis typical, then only
a small number of isogeny types suffice in order to enumerate its isogeny class.
Lemma 2.2. Any isogeny between typical p.p. abelian varieties over a number
fieldkcan be decomposed into a chain of isogenies Ï†:Aâ†’Aâ€²defined over kwhose
kernels are maximal isotropic subgroups of either A[â„“]orA[â„“2], where â„“is a prime
number (depending on Ï†).
Proof. LetÏ†:Aâ†’Aâ€²be any isogeny. Since Ais typical, by Lemma 2.1,
there exists an integer nâ‰¥1such that K:=kerÏ†âŠ‚A[n]is maximal isotropic.
Factor n=â„“e1
1Â·. . .Â·â„“err. Then Kâˆ©A[â„“ei
i]is maximal isotropic inside A[â„“ei
i]for
alli= 1, . . . , r. Indeed, by [Mil86, Lemma 16.1] the subgroup is isotropic, and by
checking the cardinality, one sees that the subgroup is maximal isotropic. As each
subgroup Kâˆ©A[â„“ei
i]is defined over k, we can decompose Ï†as the composition of
isogenies whose degrees are prime powers.
Now suppose that n=â„“eis a prime power, and that e >2. Then we claim that
Kâ€²:=â„“Kâˆ©A[â„“eâˆ’2] =â„“K[â„“eâˆ’1]
is a maximal isotropic subgroup of A[â„“eâˆ’2]. We will then be able to decompose Ï†
into two isogenies of lower degree, namely Aâ†’A/Kâ€²andA/Kâ€²â†’A/K.
First, we prove that Kâ€²is isotropic: if âŸ¨Â·,Â·âŸ©â„“idenotes the Weil pairing on A[â„“i]
(for any iâ‰¥1), and â„“x1, â„“x2forx1, x2âˆˆKare arbitrary elements of Kâ€², we have that
âŸ¨â„“x1, â„“x2âŸ©â„“eâˆ’2=âŸ¨x1, x2âŸ©â„“e= 1by [Mil86, Lemma 16.1]. To see that Kâ€²is maximal,
we determine its cardinality. Let r1andr2be the ranks of K[â„“]andK/K [â„“eâˆ’1]as
Z/â„“Z-modules. We have an exact sequence
0â†’K[â„“]â†’K[â„“eâˆ’1]â„“â†’Kâ€²â†’0
and#K[â„“eâˆ’1] = # K/â„“r2. Hence
#Kâ€²= #K[â„“eâˆ’1]/#K[â„“] = # K/â„“r1+r2=â„“egâˆ’r1âˆ’r2.
On the other hand, we have r1+r2â‰¤2gbecause the Weil pairing on A[â„“]Ã—A[â„“]
vanishes on K[â„“]Ã—â„“eâˆ’1(K/K [â„“eâˆ’1]), and these subspaces have dimensions r1and
r2overZ/â„“Zrespectively. Indeed, for xâˆˆK[â„“]andyâˆˆâ„“eâˆ’1(K/K [â„“eâˆ’1]), we can
write xasâ„“eâˆ’1xâ€²for some xâ€²âˆˆA[â„“e]andyasâ„“eâˆ’1yâ€²for some yâ€²âˆˆK, and then
âŸ¨x, yâŸ©â„“=âŸ¨â„“eâˆ’1xâ€², â„“eâˆ’1yâ€²âŸ©â„“=âŸ¨xâ€², yâ€²âŸ©â„“eâˆ’1
â„“e=âŸ¨â„“eâˆ’1xâ€², yâ€²âŸ©â„“e=âŸ¨x, yâ€²âŸ©â„“e= 0,
by [Mil86, Lemma 16.1] and the fact that Kis isotropic.
Since Kâ€²is isotropic for the Weil pairing on A[â„“eâˆ’2]andr1+r2â‰¤2g, we must
have r1+r2= 2gandKâ€²is maximal isotropic in A[â„“eâˆ’2]. â–¡
From now on, we focus on the case of typical p.p. abelian surfaces. Let â„“be a
prime. We say that an isogeny Ï†:Aâ†’Aâ€²is
â€¢a1-step â„“-isogeny, ifker(Ï†)is maximal isotropic in A[â„“], andCOMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 5
â€¢a2-step â„“-isogeny, ifker(Ï†)is maximal isotropic in A[â„“2]and isomorphic
to(Z/â„“Z)2Ã—Z/â„“2Zas an abstract abelian group.
Note that the terminology â€œ2-step â„“-isogenyâ€ is slightly abusive, as the endomor-
phism Î²associated with Ï†via Lemma 2.1 is actually â„“2in that case.
Proposition 2.3. Any isogeny between typical p.p. abelian surfaces over a number
fieldkcan be decomposed into a chain of 1-step â„“-isogenies, 2-step â„“-isogenies, and
multiplication-by- â„“endomorphisms for a series of primes â„“, all defined over k.
Proof. By Lemma 2.2, we only need to consider an isogeny Ï†whose kernel K
is maximal isotropic inside A[â„“2]. Then #K=â„“4, soKis isomorphic to (Z/â„“Z)4,
(Z/â„“Z)2Ã—Z/â„“2Zor(Z/â„“2Z)2. In the first case, the isogeny Ï†is multiplication by â„“.
In the second case, Ï†is 2-step. In the third case, the group Kâˆ©A[â„“] =â„“Kis a
maximal isotropic subgroup of A[â„“]: it is isotropic by [Mil86, Lemma 16.1], and
maximal for cardinality reasons. We can thus decompose Ï†into two 1-step isogenies
Aâ†’A/â„“KandA/â„“K â†’A/K. â–¡
Remark 2.4. A 2-step isogeny factors as a composition of two 1-step isogenies
overk, but these 1-step isogenies are not necessarily defined over k. Here is a more
detailed look into this situation. If Kis the kernel of a 2-step â„“-isogeny, then â„“Kis
a rational 1-dimensional subspace of A[â„“]. We can extend â„“Kinâ„“+ 1ways to get a
maximal isotropic subgroup of A[â„“]contained in K. These â„“+ 1ways to factor the
2-step isogeny as a composition of two 1-step isogenies are permuted by Gal(k/k).
2.3. Computing an isogeny class. From now on, we assume that k=Q.
In the following sections, we will detect the existence of 1- or 2-step â„“-isogenies
from Ato another p.p. abelian surface by studying the action of Gal(Q/Q)onA[â„“].
LetL1(resp. L2) be the set of primes â„“such that A[â„“]admits a 1-dimensional
(resp. 2-dimensional and isotropic) Galois-stable subspace. Then the existence of a
rational 1-step (resp. 2-step) isogeny implies that â„“âˆˆ L 2(resp. L1).
Summarizing, we use the following algorithm to compute the isogeny class of a
typical p.p. abelian surface AoverQ, defined as the set of isomorphism classes of
p.p. abelian surfaces Aâ€²such that there exists an isogeny Ï†:Aâ†’Aâ€²defined over Q.
These abelian surfaces all are the Jacobian of a genus 2 curve over Qby [Lau01,
Appendix, Thm. 4], and this is how we encode both the input and output.
Algorithm 2.5. Input:a genus 2 curve CoverQsuch that A= Jac( C).
Output: the list of all p.p. abelian surfaces over Qthat are isogenous to A.
Step 1. Use Dieulefaitâ€™s tests to find finite supersets of L2andL1(see Â§3).
Step 2. For each â„“in these sets, compute invariants for all abelian surfaces Aâ€²
overQobtained as the image of a 1-step (resp. 2-step) â„“-isogeny with
domain A(see Â§4).
Step 3. Reconstruct each such Aâ€²as the Jacobian of a genus 2curve over Qby
applying Mestreâ€™s algorithm and identifying the correct twist (see Â§5).
Step 4. Repeat this process on all the newly obtained abelian surfaces as needed.
3. Rational â„“-torsion subgroups
LetAbe a typical p.p. abelian surface over Q, and let Nbe its conductor (see
[BK94, Â§6] for the definition of the conductor and further background). Let dbe the
maximal integer such that d2|N. Let Sdenote the set of primes of bad reduction
forA, i.e. the set of primes dividing N.6 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
For each prime â„“â‰¥2, let Ïâ„“: Gal (Q/Q)â†’GSp(4,Zâ„“)denote the Galois
representation on the â„“-adic Tate module
Tâ„“(A) = limâ† âˆ’nâ‰¥1A[â„“n]â‰ƒZ4
â„“,
where we fix a symplectic basis of Tâ„“(A)for this last isomorphism. The NÃ©ronâ€“Oggâ€“
Shafarevich criterion [ST68] states that Ïâ„“is unramified away from â„“andS; in other
words, if p /âˆˆSâˆª {â„“}is a prime, then the inertia group Ipatphas trivial image
under Ï. The prime-to- â„“part of the conductor of Ïâ„“equals Nwhen â„“is a prime of
good reduction [GRR72, ExposÃ© IX, Â§4]. For each prime pof good reduction, we let
Qp(x):=x4âˆ’apx3+bpx2âˆ’papx+p2âˆˆZ[x]denote the characteristic polynomial
ofÏâ„“(Frob p), which is independent of â„“Ì¸=p. The complex roots of Qp(x)all have
absolute valueâˆšp.
Considering all the â„“-adic representations at the same time, we obtain the
adelic Galois representation Ï: Gal (Q/Q)â†’GSp(4,bZ)attached to A. Serreâ€™s
open image theorem [Ser99] asserts that the image of Ïis an open subgroup
ofGSp(4,bZ), or equivalently has finite index in it. Consequently, the mod- â„“Galois
representation Ïâ„“:=Ïâ„“mod â„“, attached to the Galois action on A[â„“], is surjective
for all primes â„“outside a finite set.
Dieulefait [Die02] describes an algorithm to explicitly determine a finite set of
primes containing all primes â„“at which Ïâ„“is not surjective, using the classification of
maximal subgroups of GSp(4,Fâ„“). For each type of maximal subgroup, one can give
necessary conditions on â„“for the image of Ïâ„“to be contained in a subgroup of this
type, and these conditions are satisfied by finitely many primes â„“. The algorithm
has been implemented in SageMath [Sage] by the work of [BBKKMSV23].
In this work, we are only interested in two types of maximal subgroups, namely
the stabilizers of lines and two-dimensional isotropic subspaces in F4
â„“[BBKKMSV23,
Lemma 2.3(1)]. Keeping notation from Â§2.3, we call L1(resp. L2) the finite set of
primes â„“for which the image of Ïâ„“stabilizes a line (resp. a 2-dimensional isotropic
subspace). A 1-step â„“-isogeny with domain Aexists over Qif and only if â„“âˆˆ L 2.
Moreover, if a 2-step â„“-isogeny with domain Aexists over Q, then â„“âˆˆ L 1as per
Remark 2.4. We now describe the associated Dieulefait criteria [Die02, Â§3.1, Â§3.2]
in more detail, assuming from now on that Ahas good reduction at â„“.
3.1. Computing a finite superset of L1.Dieulefaitâ€™s tests rely on the
factorization of characteristic polynomials Qp(x)over finite fields, for a given list of
primes p. We include this list as part of the input of the following algorithm.
Algorithm 3.1. Input:
â€¢a genus 2 curve CoverQsuch that A= Jac( C),
â€¢the conductor NofA,
â€¢and a non-empty finite set Pof primes of good reduction for C.
Output: a finite superset of L1.
Step 1. Compute the maximal integer dsuch that d2|N.
Step 2. Compute QpâˆˆZ[x]forpâˆˆPby computing the number of points on C
overFpandFp2.
Step 3. Compute M=gcdpâˆˆPRes 
Qp(x), xf(p)âˆ’1
, where f(p)is the order of p
in(Z/dZ)Ã—.
Step 4. Return the list of prime divisors of M.COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 7
Proposition 3.2. Algorithm 3.1 returns a finite superset of L1.
Proof. Suppose that there exists a 1-dimensional subrepresentation (Ï€, V)
ofÏâ„“, induced by a stable line VâŠ‚A[â„“]. Let VâŠ¥denote the subgroup of A[â„“]that
pairs trivially with Vunder the Weil pairing. By Galois equivariance of the Weil
pairing, the 1-dimensional quotient representation on A[â„“]/VâŠ¥is given by Ï€âˆ’1Ï‡â„“,
where Ï‡â„“is the mod- â„“cyclotomic character. By results of Raynaud [Ray74, Cor.
3.4.4] and Serre [Ser72, Â§1.9], we know that Ï€restricted to the inertia group Iâ„“atâ„“
is either trivial or equal to Ï‡â„“.
In any case, there exists a character Îµ, unramified away from N, such that
the semisimplification Ïss
â„“admits both ÎµandÎµâˆ’1Ï‡â„“as direct summands. Hence
the conductor of Ïâ„“is divisible by the square of the conductor of Îµ, in other
words cond(Îµ)divides d. Class field theory then implies that Îµis a character
ofGal(Q(Î¶d)/Q)â‰ƒ(Z/dZ)Ã—. For each prime pâˆˆL, since f(p)is the order
ofpin(Z/dZ)Ã—, we have Îµ(Frob p)f(p)= 1. Therefore, Îµ(Frob p)is a root of the
characteristic polynomial of Ïâ„“(Frob p)and also of the polynomial xf(p)âˆ’1overFâ„“.
Thus â„“divides Res(Qp(x), xf(p)âˆ’1)and hence â„“divides M.
Since the complex roots of Qp(x)have absolute valueâˆšp, they are distinct from
the roots of xf(p)âˆ’1which have absolute value 1. So the resultants and thus M
are guaranteed to be non-zero and the computed superset is finite. â–¡
Remark 3.3. Building on results of Grothendieck [GRR72, ExposÃ© IX, Prop. 3.5]
and Larsonâ€“Vaintrob [LV14, Thm. 7.2], the authors of [BBKKMSV23] introduce
the following strengthening of the above technique (Alg. 3.3). For pâˆˆP, letr=
gcd(f(p),120). Let Rpbe the polynomial whose roots are the r-th powers of the
roots of Qp. Then each â„“âˆˆ L 1must divide p Rp(1). The original criterion by
Dieulefait, as presented above, was however sufficient for our purposes.
3.2. Computing a finite superset of L2.In the case of L2, the computation
of a finite superset might fail if the list of auxiliary primes pis too small, leading to
the following algorithm.
Algorithm 3.4. Input:
â€¢a genus 2 curve CoverQsuch that A= Jac( C),
â€¢the conductor NofA,
â€¢and a non-empty finite set Pof primes of good reduction for C.
Output: a finite superset of L2, orfalse.
Step 1. Compute d.
Step 2. ForpâˆˆP, compute Qp=x4âˆ’apx3+bpx2âˆ’papx+p2âˆˆZ[x].
Step 3. ForpâˆˆP, compute the polynomials
R1,p(x):= (bpxâˆ’1âˆ’p2x2)(px+ 1)2âˆ’a2
ppx2and
R2,p(x):= (bpxâˆ’pâˆ’px2)(x+ 1)2âˆ’a2
px2.
Step 4. Fori= 1and2, compute Mi=gcdpâˆˆPRes 
Ri,p(x), xf(p)âˆ’1
, where f(p)
is the order of pin(Z/dZ)Ã—. Let M=M1M2.
Step 5. IfMis nonzero, return the list of prime divisors of M, else return false.
Proposition 3.5. Algorithm 3.4 returns either falseor a finite superset of L2.
Proof. Suppose that Ïâ„“admits a 2-dimensional isotropic subrepresentation
denoted by (Ï€, V). The quotient representation on A[â„“]/Vis given by Ï‡â„“âŠ—(Ï€âˆ’1)t.8 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
By [Ray74, Cor. 3.4.4] and [Ser72, Â§1.9], we obtain as above that either det(Ï€) =ÎµÏ‡2
â„“
ordet(Ï€) =ÎµÏ‡â„“for some character Îµunramified away from N. The direct sum
decomposition Ïss
â„“â‰ƒÏ€âŠ•Ï‡â„“âŠ—(Ï€âˆ’1)tthen implies that cond( Îµ)still divides d.
Ifdet(Ï€) =ÎµÏ‡2
â„“, then for every prime pof good reduction, we have the following
factorization of Qp(x)into a product of two related quadratic polynomials modulo â„“:
Qp(x) = 
x2âˆ’rx+p2Îµ(p)
x2âˆ’r
pÎµ(p)x+Îµâˆ’1(p)
.
Ifdet(Ï€) =ÎµÏ‡â„“, then for all such p, we have
Qp(x) = 
x2âˆ’rx+pÎµ(p)
x2âˆ’r
Îµ(p)x+pÎµâˆ’1(p)
.
By comparing coefficients and eliminating r, one observes that the first kind of
factorization happens if and only if Îµ(p)is a root of the integral polynomial R1,p(x)
introduced in Algorithm 3.4 over Fâ„“for all p. Similarly, the second kind of factor-
ization happens if and only if Îµ(p)is a root of R2,p(x)overFâ„“for all p. Thus, there
is an iâˆˆ {1,2}such that for all pof good reduction, Res 
Ri,p(x), xf(p)âˆ’1
= 0
mod â„“. We deduce that â„“always divides M=M1M2. â–¡
We now show that Algorithm 3.4 returns a superset of L2provided that P
contains enough primes. In practice, failures are not an issue even for a small list P.
Proposition 3.6. ForBlarge enough and P={pâ‰¤B:pis a good prime for C},
Algorithm 3.4 returns a finite list of primes, in other words both M1andM2are
nonzero.
Proof. We first prove that M1Ì¸= 0. For p= 1 mod d, we have
Res(R1,p(x), xf(p)âˆ’1) = R1,p(1) = ( bpâˆ’1âˆ’p2)(p+ 1)2âˆ’a2
pp.
Using the bounds |ap| â‰¤4âˆšpand|bp| â‰¤6pcoming from the fact that the roots
ofQp(x)have absolute valueâˆšp, it follows that R1,p(1)<0ifpis large enough,
and thus M1Ì¸= 0for large B.
Second, we prove that M2Ì¸= 0. Consider all polynomials over Fâ„“which, over Fâ„“,
admit a factorization of the form
(x2âˆ’rx+pÎ·)(x2âˆ’r
Î·x+pÎ·âˆ’1),
where Î·âˆˆFâ„“is ad-th root of unity and râˆˆFâ„“. When â„“is sufficiently large,
these polynomials do not account for all characteristic polynomials of matrices
inGSp(4,Fâ„“). By Serreâ€™s open image theorem, we can further assume that the
representation Ïâ„“is surjective. For such an â„“, by the Chebotarev density theorem,
there must exist infinitely many psuch that Qp(x)does not factor over Fâ„“in
the above shape, and thus â„“âˆ¤Res(R2,p(x), xf(p)âˆ’1). Therefore M2Ì¸= 0ifBis
sufficiently large. â–¡
Remark 3.7. Showing that M2Ì¸= 0for a sufficiently large Bis non-trivial: indeed,
if the reduction of Amodulo pis isogenous to the square of an elliptic curve over Fp,
then Res(R2,p(x), xf(p)âˆ’1) = 0.
Remark 3.8. An improvement of a similar flavor to Remark 3.3 is also available
here: see [BBKKMSV23, Â§3.1.3].COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 9
3.3. Other tests for irreducibility. The output of Algorithms 3.1 and 3.4
usually consists of very short lists of primes, but might still contain extraneous
primes â„“ /âˆˆ L 1âˆª L 2. In order to further weed out some of these primes, one can
compute Qp(x)for a larger set of primes p, and eliminate any prime â„“with the
property that one of these polynomials is irreducible modulo â„“. In our computations,
we considered all primes pâ‰¤500of good reduction for C.
4. Invariants of isogenous abelian surfaces
In this section, we describe an efficient algorithm solving the following problem:
given a typical p.p. abelian surface AoverQand a prime number â„“, compute the
complete list of p.p. abelian surfaces Aâ€²overQsuch that AandAâ€²are linked by a
rational 1- or 2-step â„“-isogeny.
Devising a polynomial-time algorithm for this task is straightforward: we can
write down equations for the torsion subgroups A[â„“]orA[â„“2], look for rational
subgroups of the correct shape by factoring these polynomials over Q, and apply al-
gorithms to compute quotients of p.p. abelian surfaces by isotropic subgroups [CE15;
LR23]. Such an algorithm would however be hopelessly slow in practice.
A more efficient approach is to use modular equations for p.p. abelian surfaces,
which are higher-dimensional analogues of elliptic modular polynomials: see [BL09]
for their definition in the case of 1-step isogenies, and [Mil15a] for an efficient
algorithm to compute them. Evaluating modular equations at Aprovides tuples
of modular invariants (for instance Igusaâ€“Clebsch invariants) of abelian surfaces
isogenous to A, possibly defined over a number field. This evaluation can be done
within a reasonable complexity, namely eO(â„“6h)bit operations2in the case of 1-step
â„“-isogenies, where his the height of the invariants of A[Kie22b]. This algorithm
works by computing the invariants of isogenous abelian surfaces as complex numbers,
packagingthemintoapolynomial, andrecognizingitscoefficientsasrationalnumbers.
Then a rational isogeny from Aexists exactly when this polynomial has a rational
root (see Proposition 4.7 below).
Here we take this method one step further: we compute these invariants over C,
and directly recognize when they are attached to a p.p. abelian surface defined over Q.
In a sense, we detect rational roots of modular equations without computing the
number fields that other roots generate. When doing so, the cost is further lowered
toeO 
(n+ 1)â„“dh
bit operations, where d= 3(resp. 4) in the case of 1-step (resp. 2-
step) isogenies, and nis the number of roots â€œclose toâ€ being rational, in a precise
sense explained below. (We usually have n= 0, sometimes n= 1, and rarely more.)
Crucially, this analytic method allows for certification. The modular invariants we
compute provably correspond to p.p. abelian surfaces rationally isogenous to A, and
provably miss none of them.
The computations over Cmake use of structure theorems for Siegel modular
forms in dimension 2and explicit formulas for Hecke correspondences, recalled
in Â§4.1 and Â§4.2. Next, we explain why detecting rational isogenies reduces to
detecting invariants defined over Q(Â§4.3), and how to compute these invariants
as algebraic integers, which is the crucial idea behind certification (Â§4.4). Finally,
in Â§4.5 and Â§4.6, we describe the algorithm and sketch its complexity analysis.
2We use the notation eO(N)to denote O 
Nlogk(N)
for some value of k.10 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
4.1. Siegel modular forms. OverC, every p.p. abelian surface Acan be
written as a complex torus C2/(Z2âŠ•Ï„Z2), where Ï„belongs to the Siegel upper half
spaceH2, consisting of complex 2Ã—2symmetric matrices with positive definite imag-
inary part. Such a Ï„is called a (small) period matrix ofA. The group GSp(4,R)+
consisting of general symplectic matrices with positive similitude factor acts on H2
as follows:
Î³Ï„= (aÏ„+b)(cÏ„+d)âˆ’1,where Î³=
a b
c d
in2Ã—2blocks.
For later use, we also write
Î³âˆ—Ï„=cÏ„+d.
The period matrix of Ais unique up to the action of the modular group Sp(4,Z), so
the quotient Sp(4,Z)\H2is precisely the coarse moduli space of complex p.p. abelian
surfaces. In fact, this coarse moduli space A2exists as a quasi-projective variety
defined over Q, andA2(C)can be identified with Sp(4,Z)\H2.
A (scalar-valued) Siegel modular form onH2of weight kâˆˆZâ‰¥0(and level 1) is
a complex-analytic map f:H2â†’Csatisfying f(Î³Ï„) =det(Î³âˆ—Ï„)kf(Ï„)for all Ï„âˆˆH2
andÎ³âˆˆSp(4,Z). See [Gee08] for more background on these objects. Siegel modular
forms admit Fourier expansions: writing Ï„âˆˆH2as
Ï„=Ï„1Ï„3
Ï„3Ï„2
andqj= exp(2 Ï€iÏ„j)for1â‰¤jâ‰¤3, the Fourier expansion of a Siegel modular form
belongs to the power series ring C[q3, qâˆ’1
3][[q1, q2]].
By the Bailyâ€“Borel theorem, Siegel modular forms with rational Fourier coeffi-
cients yield projective embeddings of A2that are defined over Q, and can thus be
used as rational coordinates on this moduli space. Igusa [Igu62] proved the following
fundamental theorem.
Theorem 4.1. The graded C-algebra of Siegel modular forms on H2of even weight
is free with four generators M4, M6, M10, M12of weights 4,6,10,12with integral
Fourier coefficients.
In this paper, we normalize these generators so that their Fourier expansions
are primitive and M10, M12are cusp forms. This defines them uniquely up to sign.
We can fix these signs by specifying their first few Fourier coefficients:
M4(Ï„) = 1 + 240( q1+q2) +O 
q2
1, q2
2, q1q2
,
M6(Ï„) = 1âˆ’504(q1+q2) +O 
q2
1, q2
2, q1q2
,
M10(Ï„) = 
q3âˆ’2 +qâˆ’1
3
q1q2+O(q2
1, q2
2),and
M12(Ï„) = 
q3+ 10 + qâˆ’1
3
q1q2+O 
q2
1, q2
2
.
We find this normalization more convenient than the ones usually considered in the
literature. In terms of Igusaâ€™s notation in [Igu62], we have
M4=Ïˆ4, M 6=Ïˆ6, M 10= 4Ï‡10,and M12= 12Ï‡12.
In terms of the modular forms hkforkâˆˆ {4,6,10,12}from [Str14, Â§7.1], we have
(4.2) M4= 2âˆ’2h4, M 6= 2âˆ’2h6, M 10=âˆ’2âˆ’12h10,and M12= 2âˆ’15h12.
From Theorem 4.1, we deduce that for each Ï„âˆˆH2, at least one of the values Mk(Ï„)
forkâˆˆ {4,6,10,12}does not vanish.COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 11
Igusa [Igu79] further determined an explicit set of fourteen generators for the
graded ring of Siegel modular forms with integral Fourier coefficients, which contains
the above forms Mk. The following easy corollary of Igusaâ€™s result will play an
essential role in this paper.
Proposition 4.3 ([Kie22b, Â§2.1]) .Letfbe a Siegel modular form on H2of even
weight kwith integral Fourier coefficients. Then 12kfâˆˆZ[M4, M6, M10, M12].
Iffis a Siegel modular form of weight kwith rational Fourier coefficients, then
we can also give fan algebraic meaning as follows [FC90, Def. 1.1 p.137]. Let Abe
a p.p. abelian surface over a number field Lembedded in C, and let Ï‰be a basis of
the1-dimensional L-vector space âˆ§2â„¦1(A). Then f(A, Ï‰)is a well-defined element
ofL, and satisfies f(A, tÏ‰ ) =tâˆ’kf(A, Ï‰)for all tâˆˆLÃ—.
The relation between f(A, Ï‰)and the values of fon the Siegel half space H2is
the following [FC90, p.141]. Let Ï„âˆˆH2be a period matrix of A, and choose an
isomorphism Î·:A(C)â†’C2/(Z2âŠ•Ï„Z2). The basis of differentials (2Ï€i dz 1,2Ï€i dz 2)
induces a natural basis of âˆ§2â„¦1on the complex torus; call this basis Ï‰(Ï„). There is
a unique râˆˆCÃ—such that Ï‰=rÂ·Î·âˆ—Ï‰(Ï„). Then f(A, Ï‰) =râˆ’kf(Ï„); one can check
that this quantity f(A, Ï‰)does not depend on the choice of Ï„orÎ·.
Let now Abe a p.p. abelian surface over Q, and choose a basis Ï‰ofâˆ§2â„¦1(A).
Then the weighted projective point
(4.4) 
M4(A, Ï‰) :M6(A, Ï‰) :M10(A, Ï‰) :M12(A, Ï‰)
âˆˆP4,6,10,12(Q)
is independent of Ï‰, since scaling Ï‰bytâˆ’1âˆˆQÃ—scales the above coordinates
by(t4, t6, t10, t12). We call this projective point the modular invariants ofA. This
projective point has a unique representative (m4, m6, m10, m12)âˆˆZ4that is reduced
in the sense that no prime psatisfies pk|mkfor all kâˆˆ {4,6,10,12}; by a slight
abuse of language, we also call this tuple of integers the modular invariants of A.
IfAis the Jacobian of a genus 2curve Cdefined over Q, then the modular
invariants of Acan be computed as follows. Let (I2:I4:I6:I10)âˆˆP2,4,6,10(Q)be
the Igusaâ€“Clebsch invariants of Cas defined in [Str14, Â§2.1]; these invariants are
also denoted by (A:B:C:D)in [Igu62] and (Aâ€²:Bâ€²:Câ€²:Dâ€²)in [Mes91]. Then,
as a consequence of (4.2), the modular invariants of Aare
(4.5) (m4:m6:m10:m12) = 
2âˆ’2I4: 2âˆ’3(I2I4âˆ’3I6) :âˆ’2âˆ’12I10: 2âˆ’15I2I10
.
In particular, on the input of C, the modular invariants of Acan easily be computed
from the expression of I2, . . . , I 10as polynomials in the coefficients of C.
4.2. Hecke correspondences. Consider a period matrix Ï„âˆˆH2attached to
a p.p. abelian surface AoverC. Then the period matrices of abelian surfaces linked
toAby an isogeny of a given type can be computed by letting certain symplectic
matrices act on Ï„. This precisely corresponds to analytic formulas for the action of
Hecke operators on spaces of Siegel modular forms [CG15, Â§10], [Kri90, Chap. VI,
Â§5]. The case of 1-step isogenies corresponds to the Hecke operator usually denoted
byT(â„“), and 2-step isogenies correspond to the Hecke operator T1(â„“2). Concretely,
we define the following collections of matrices:
(1)S(â„“)consists of the â„“3+â„“2+â„“+ 1matrices of the form
1 0a b
0 1b c
0 0â„“0
0 0 0 â„“
,â„“0 0 0
âˆ’a1 0b
0 0 1 a
0 0 0 â„“
,1 0a0
0â„“0 0
0 0â„“0
0 0 0 1
orâ„“0 0 0
0â„“0 0
0 0 1 0
0 0 0 1
where a, b, crun through {0, . . . , â„“ âˆ’1};12 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
(2)S(â„“2)consists of the â„“4+â„“3+â„“2+â„“matrices of the following form:
â„“0 0 aâ„“
âˆ’b1a ab+d
0 0â„“ bâ„“
0 0 0 â„“2
, 
1 0 dâˆ’a
0â„“âˆ’â„“a0
0 0â„“20
0 0 0 â„“!
,â„“20 0 0
âˆ’aâ„“ â„“ 0 0
0 0 1 a
0 0 0 â„“
orâ„“0 0 0
0â„“20 0
0 0â„“0
0 0 0 1
where a, brun through {0, . . . , â„“ âˆ’1}anddruns through {0, . . . , â„“2âˆ’1};
as well as â„“0a b
0â„“ b c
0 0â„“0
0 0 0 â„“
where a, b, crun through {0, . . . , â„“ âˆ’1}with the additional conditions
thatac=b2and(a, b, c )Ì¸= (0,0,0).
Theset S(â„“)(resp. S(â„“2))consistsofmatricesin GSp(4,R)+withintegralcoefficients,
zero lower left block, and with the property that the determinant of their lower right
block divides â„“2(resp. â„“3).
Proposition 4.6. LetÏ„âˆˆH2, letA=C2/(Z2âŠ•Ï„Z2)be the p.p. complex abelian
surface attached to Ï„, and let â„“be a prime number.
(1)The matrices Î³Ï„forÎ³âˆˆS(â„“)are period matrices for the abelian sur-
faces A/Kwhere Kruns through the maximal isotropic subgroups of A[â„“].
(2)The matrices Î³Ï„forÎ³âˆˆS(â„“2)are period matrices for the abelian sur-
faces A/Kwhere Kruns through the maximal isotropic subgroups of A[â„“2]
isomorphic to (Z/â„“Z)2Ã—(Z/â„“2Z).
Proof. First, we consider 1-step isogenies. Consider the subgroup Î“0(â„“)of
Sp4(Z)defined as
Î“0(â„“):=
a b
c d
âˆˆSp(4,Z) :b= 0 (mod â„“)
.
The map
Ï„7â†’ 
C2/(Z2âŠ•Ï„Z2),(Z2âŠ•1
â„“Ï„Z2)/(Z2âŠ•Ï„Z2)
is a bijection between Î“0(â„“)\H2and the set of isomorphism classes of pairs (A, K),
where Ais a p.p. abelian surface over CandKâŠ‚A[â„“]is maximal isotropic for
the Weil pairing. (This is proved in an analogous way to [BL09, Thm. 3.2], which
uses the subgroup Î“0(â„“)instead.) The quotient surface A/Kadmits1
â„“Ï„as a period
matrix. The period matrices we wish to enumerate are therefore the1
â„“Î³Ï„, where Î³
runs through a (finite) set of representatives of Î“0(â„“)\Sp(4,Z).
We can rewrite these matrices using the action of GSp(4,Q)+, noting that for
allÎ³âˆˆSp(4,Z), 
Diag(1 ,1, â„“, â„“)Î³
Â·Ï„=1
â„“(Î³Ï„).
This leads us to the formalism of Hecke operators in terms of double cosets: we have
Î“0(â„“) = Sp(4 ,Z)âˆ©Diag(1 ,1, â„“, â„“)âˆ’1Sp(4,Z) Diag(1 ,1, â„“, â„“),
so the map Î³7â†’Diag(1 ,1, â„“, â„“)Î³induces a bijection
Î“0(â„“)\Sp(4,Z)â†’Sp(4,Z)\Sp(4,Z) Diag(1 ,1, â„“, â„“) Sp(4 ,Z).
By [CG15, Prop. 10.1], the set S(â„“)is a set of representatives for the coset space
on the right hand side (we acted on some representatives by elements of Sp4(Z)to
simplify them). This proves (1).
The 2-step case is similar. The reduction map Sp(4,Z)â†’Sp(4,Z/â„“2Z)is
surjective (see [BL09, Â§3]), and we define Î“0(â„“2)as the preimage in Sp(4,Z)ofCOMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 13
the stabilizer of the maximal isotropic subgroup
(0, â„“,0,0),(0,0,1,0),(0,0,0, â„“)
in(Z/â„“2Z)4. The map
Ï„7â†’ 
C2/(Z2âŠ•Ï„Z2),(ZâŠ•1
â„“Z)âŠ•Ï„(1
â„“2ZâŠ•1
â„“Z))/(Z2âŠ•Ï„Z2)
is a bijection between Î“0(â„“2)\H2and the set of isomorphism classes of pairs (A, K),
where Ais a p.p. abelian surface over CandKâŠ‚A[â„“2]is a maximal isotropic
subgroup for the Weil pairing and isomorphic to (Z/â„“Z)2Ã—Z/â„“2Z. A period
matrix for the quotient abelian surface A/Kis then Diag(1, â„“, â„“2, â„“)Ï„. As above, a
reformulation in terms of double cosets will be convenient. We have
Î“0(â„“2) = Sp(4 ,Z)âˆ©Diag(1 , â„“, â„“2, â„“)âˆ’1Sp(4,Z) Diag(1 , â„“, â„“2, â„“),
so the map Î³7â†’Diag(1 , â„“, â„“2, â„“)Î³induces a bijection
Î“0(â„“2)\Sp(4,Z)â†’Sp(4,Z)\Sp(4,Z) Diag(1 , â„“, â„“2, â„“) Sp(4 ,Z).
Combining [CG15, Prop. 10.5] with [Kri90, Chap. VI, Lem. 5.2], we find that S(â„“2)
is exactly a set of representatives for the coset space on the right hand side. â–¡
4.3. Rational invariants versus rational isogenies. Our algorithm will
enumerate period matrices Î³Ï„using Proposition 4.6 and evaluate the modular
forms Mkat these points. If Î³Ï„corresponds to an abelian surface Aâ€²that is
isogenous to AoverQ, then 
M4(Î³Ï„) :M6(Î³Ï„) :M10(Î³Ï„) :M12(Î³Ï„)
must be
rational as a weighted projective point, i.e. up to complex scaling with the correct
weights. In fact, the converse statement also holds.
Proposition 4.7. LetAbe a typical p.p. abelian surface over Q, letÏ„be a period
matrix of A, letâ„“be a prime number, and let iâˆˆ {1,2}. Then
(1)AsÎ³runs through S(â„“i), the projective points 
M4(Î³Ï„) :Â·Â·Â·:M12(Î³Ï„)
inP4,6,10,12(C)are all distinct.
(2)FixÎ³âˆˆS(â„“i), and assume that there exists a scalar Î»âˆˆCÃ—such that
Î»kMk(Î³Ï„)âˆˆQfor each kâˆˆ {4,6,10,12}. Then Î³Ï„is a period matrix of
a p.p. abelian surface Aâ€², defined over Q, such that there exists an i-step
isogeny Aâ†’Aâ€²of degree â„“2idefined over Q.
Proof. We first prove (1)by contradiction. If these projective points happen
to be equal for some Î³1Ì¸=Î³2, then we have a (non-commutative) diagram
A Aâˆ¨
A1 A2 Aâˆ¨
2f1 f2Î»A
Î·
âˆ¼Î»A2fâˆ¨
2
where f1, f2are isogenies with distinct kernels, and Î·is an isomorphism. Then
the compositions Î·â—¦f1â—¦Î»âˆ’1
Aâ—¦fâˆ¨
2â—¦Î»A2andf2â—¦Î»âˆ’1
Aâ—¦fâˆ¨
2â—¦Î»A2yield elements
ofEnd((A2)Q) =Zof the same degree â„“2i. They must therefore be equal up to sign.
Thus Î·â—¦f1=Â±f2andkerf1= ker f2, a contradiction.
For(2), letKbe the subgroup of Aattached to Î³. IfKis not defined over Q,
then the Galois orbit of Kconsists of several subgroups of A, and the associated
quotients have the same modular invariants, contradicting (1). Therefore Kand
the associated isogeny are defined over Q. â–¡14 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
4.4. Certification. By Proposition 4.7, evaluating modular invariants and
detecting when they are rational suffices to detect rational isogenies. In practice
however, we will have to manipulate these complex numbers up to some finite
precision. While rational invariants can still be detected heuristically and the
isogeny might be proved to exist by other methods, certifying the non-existence of a
rational isogeny is not immediate.
A key idea to achieve certification is to leverage the fact that we manipulate
modular forms with integral Fourier coefficients to compute algebraic integers
instead of just complex numbers. This technique is inspired from the description
of denominators for modular equations in [Kie22b], and allows us to rule out non-
rational isogenies. As a byproduct, we are also able to certify the existence of
rational isogenies using computations over Conly.
Concretely, let A, Ï„andâ„“be as in Proposition 4.7, and denote the modular
invariants of Aas defined in Â§4.1 by (m4, m6, m10, m12)âˆˆZ4. Then there exists a
scalar Î»âˆˆCÃ—, uniquely determined up to sign (but dependent on Ï„), such that
(4.8) Î»kMk(Ï„) =mkfor all kâˆˆ {4,6,10,12}.
Letfbe a Siegel modular form of even weight kwith integral Fourier coefficients.
ForÎ³âˆˆS(â„“i), we define
(4.9) N(f, Î³):= (12 Î»)k(â„“ddet(Î³âˆ—Ï„)âˆ’1)kf(Î³Ï„).
with d= 2ifi= 1, and d= 3ifi= 2. (The central factor â„“ddet(Î³âˆ—Ï„)âˆ’1is a power
ofâ„“independent of Ï„.) We will show that the N(f, Î³)are in fact algebraic integers.
The first step is to reinterpret the complex numbers N(f, Î³)algebraically. Let Ï‰
be a basis of âˆ§2â„¦1(A)such that Mj(A, Ï‰) =mjfor all jâˆˆ {4,6,10,12}, and let K
be the subgroup of Acorresponding to Î³via the correspondence of Proposition 4.6.
The subgroup Kis not necessarily defined over Q; letLbe its field of definition,
which is a number field embedded in C. Then pulling back differential forms along
the quotient isogeny Aâ†’A/Kinduces a bijection between the L-vector spaces
LâŠ—Qâ„¦1(A)andâ„¦1(A/K). Under this bijection, Ï‰corresponds to an L-basis Ï‰â€²
ofâˆ§2â„¦1(A/K ).
Lemma 4.10. With the above notation, we have N(f, Î³) = 12kf(A/K, Ï‰â€²).
Proof. By [BL04, Rem. 8.1.4], for every Ï„â€²âˆˆH2andÎ³âˆˆSp(4,Z), the map
z7â†’(Î³âˆ—Ï„â€²)âˆ’tzdefines an isomorphism between the abelian surfaces C2/(Z2âŠ•Ï„â€²Z2)
andC2/(Z2âŠ•(Î³Ï„â€²)Z2). Keeping the notation from above the lemma, we write
Î³=Î´2âˆ†Î´1where Î´1, Î´2âˆˆSp(4,Z)andâˆ†is either Diag(1,1, â„“, â„“)orDiag(1, â„“, â„“2, â„“)
depending on i. We then consider the commutative diagram
A A/K
C2/(Z2âŠ•Ï„Z2) C2/(Z2âŠ•Î³Ï„Z2)
C2/(Z2âŠ•Î´1Ï„Z2) C2/(Z2âŠ•âˆ†Î´1Ï„Z2)Î·1 Î·2
Î¶1
Î¾Î¶2
where Î¶1(resp. Î¶2) is the isomorphism z7â†’(Î´âˆ—
1Ï„)âˆ’tz(resp. z7â†’(Î´âˆ—
2(âˆ†Î´1Ï„))âˆ’tz),
double-tipped arrows denote natural quotient maps, Î·1is an isomorphism of complex
tori, and Î·2is another isomorphism that is determined by the choice of Î·1. We recall
thatÏ‰(Ï„)denotes the element 2Ï€idz 1âˆ§2Ï€idz 2ofâˆ§2â„¦1 
C2/(Z2âŠ•Ï„Z2)
, where z1, z2
are the coordinates of C2. Let râˆˆCÃ—be such that Ï‰â€²=r Î·âˆ—
2Ï‰(Î³Ï„)as differentialCOMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 15
forms on A/K. We have f(A/K, Ï‰â€²) =râˆ’kf(Î³Ï„). Using the bottom line of the
diagram, we find that
Ï‰(Ï„) = det( Î´âˆ—
1Ï„)Â·det 
Î´âˆ—
2(âˆ†Î´1Ï„)
Â·(Î¶2â—¦Î¾â—¦Î¶1)âˆ—Ï‰(Î³Ï„).
We can rewrite this equality using the following cocycle relation:
Î³âˆ—Ï„= (Î´2âˆ†Î´1)âˆ—Ï„=Î´âˆ—
2(âˆ†Î´1Ï„)Â·âˆ†âˆ—(Î´1Ï„)Â·Î´âˆ—
1Ï„.
Asdet âˆ†âˆ—(Î´1Ï„) =â„“d, we have
Ï‰(Ï„) =â„“âˆ’ddet(Î³âˆ—Ï„)Â·(Î¶2â—¦Î¾â—¦Î¶1)âˆ—Ï‰(Î³Ï„)
We deduce that Ï‰=r â„“ddet(Î³âˆ—Ï„)âˆ’1Î·âˆ—
1Ï‰(Ï„)as differential forms on A, and thus
Î»=Â±râˆ’1â„“âˆ’ddet(Î³âˆ—Ï„). From (4.9), we finally obtain
N(f, Î³) = 12krâˆ’kf(Î³Ï„) = 12kf(A/K, Ï‰â€²). â–¡
Theorem 4.11. LetAbe a p.p. abelian surface defined over Q, letÏ„âˆˆH2be a
period matrix of A, letâ„“be a prime, and let iâˆˆ {1,2}. For a Siegel modular form f
onH2of even weight with integral Fourier coefficients and Î³âˆˆS(â„“i)(cf. Â§4.2), we
define N(f, Î³)as in equation (4.9). Then
(1)For each such modular form f, the set {N(f, Î³) :Î³âˆˆS(â„“i)}is a Galois-
stable set of algebraic integers. Moreover, the action of Gal(Q/Q)on
this set corresponds to the Galois action on subgroups of A[â„“i]via the
correspondence of Proposition 4.6.
(2)IfÎ³âˆˆS(â„“i)corresponds to a subgroup KofAthat is defined over Q, then
 
N(M4, Î³) :N(M6, Î³) :N(M10, Î³) :N(M12, Î³)
âˆˆP4,6,10,12(Q)
are the modular invariants of the quotient A/Kin the sense of Â§4.1.
Proof. By Lemma 4.10, the complex numbers N(f, Î³)are in fact algebraic,
form a Galois-stable set, and the action of Gal(Q/Q)on them corresponds to the
Galois action on subgroups of A. We now show that the N(f, Î³)are algebraic
integers. To this end, we construct the monic polynomial
P(X) =Y
Î³âˆˆS(â„“i) 
Xâˆ’N(f, Î³)
.
Letn=deg(P) = # S(â„“i). Expanding the product, we observe as in [Kie22b, Prop.
2.4] that for each 0â‰¤jâ‰¤n, the coefficient of Xnâˆ’jinPtakes the form
(12Î»)kjÂ·gj(Ï„),
where gjis a Siegel modular form of weight kjwith integral Fourier coefficients. By
Proposition 4.3, the modular form 12kjgjis an element of Z[M4, M6, M10, M12]of
weight kj. Therefore
(12Î»)kjgj(Ï„)âˆˆZ[m4, m6, m10, m12] =Z.
Thus Phas integral coefficients, which concludes the proof of (1).
Item(2)is a direct consequence of Lemma 4.10: we showed the existence of a
basis Ï‰of the Q-vector space âˆ§2â„¦1(A/K)such that N(Mk, Î³) = 12kMk(A/K, Ï‰ )
for all kâˆˆ {4,6,10,12}, and absorbing the scalar factors 12kdoes not modify the
projective point. â–¡16 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
4.5. Outline of the algorithm. The theoretical background being set, we
describe the concrete computations over Cthat we perform to list the rational 1- or
2-step isogenies from a given typical p.p. abelian surface AoverQ. We take the
modular invariants of Aas input. If Ais given as the Jacobian of a genus 2curve C
overQas in Algorithm 2.5, then its modular invariants can be determined by
polynomial formulas in terms of the coefficients of C, as explained in Â§4.1. Similarly,
the output will consists of modular invariants of isogenous abelian surfaces: we refer
to Section 5 for the subsequent reconstruction of genus 2curve equations.
In the whole algorithm, we use interval arithmetic to keep track of precision
losses: each complex number is encoded as a ball that provably contains the exact
value. Of course, we need to assume more than mere correctness of the underlying
arithmetic for our algorithms to work, as we will not get far if every operation
returns the whole of C. A minimal assumption in this subsection is that any given
computation with exact input will output a complex ball whose radius tends to
zero as its working precision tends to infinity. This will ensure that our algorithms
terminate. In fact, we have a precise control on the precision losses incurred during
the computations: we postpone this discussion to the complexity analysis in Â§4.6.
There are two main stages in the algorithm. First, we use low-precision compu-
tations to filter out symplectic matrices Î³âˆˆS(â„“)orS(â„“2)whose associated N(f, Î³),
seen as a ball, does not contain any rational integer. By Theorem 4.11, these matri-
cesÎ³do not correspond to rational isogenies with domain A. One expects that all
remaining subgroups correspond to rational isogenies. Second, we use high-precision
computations to either certify or disprove that the remaining subgroups are defined
overQ. We will use two black boxes, namely the computation of a period matrix
from modular invariants and the evaluation the Siegel modular forms Mkat a point
ofHg; we also refer to Â§4.6 for a discussion of these steps. In the first stage, we
proceed as follows.
Algorithm 4.12. Input:
â€¢the modular invariants m4, m6, m10, m12of a p.p. abelian surface AoverQ,
â€¢a prime â„“, and iâˆˆ {1,2}indicating either 1-step or 2-step isogenies.
Output:
â€¢a period matrix Ï„ofA(to low precision),
â€¢a list Lof symplectic matrices that provably contains all Î³âˆˆS(â„“i)associ-
ated with a rational subgroup of A[â„“i]for this choice of Ï„,
â€¢for each Î³âˆˆLandkâˆˆ {4,6,10,12}, a candidate value mâ€²
k(Î³)âˆˆZfor the
algebraic integer N(Mk, Î³)satisfying |N(Mk, Î³)âˆ’mâ€²
k(Î³)| â‰¤2âˆ’10;
â€¢for each Î³ /âˆˆLandkâˆˆ {4,6,10,12}, a ball containing N(Mk, Î³)of radius
at most 2âˆ’10.
Step 1. Compute a low-precision approximation of a period matrix Ï„ofA, see
Theorem 4.17.
Step 2. Evaluate the modular forms M4, . . . , M 12atÏ„, and deduce an approxima-
tion of the scaling factor Î»as defined in Â§4.4.
Step 3. For each Î³âˆˆS(â„“i)and each kâˆˆ {4,6,10,12}, evaluate N(Mk, Î³). If
the radius of one of these approximations is larger than 2âˆ’10, double the
working precision and restart.
Step 4. LetLbe the list of all Î³such that each of the balls N(Mk, Î³)forkâˆˆ
{4,6,10,12}contains an integer mâ€²
k(Î³), and return the output listed above.COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 17
At the end of Algorithm 4.12, for each Î³âˆˆL, the integers mâ€²
k(Î³)are the only
possible values for the modular invariants of the isogenous abelian surface if it is
indeed defined over Q. One could stop here and certify the existence of an isogeny
by other methods. In order to certify that these likely isogenies indeed exist using
computations over Conly, we proceed as follows.
Lemma 4.13. Keep the notation of Algorithm 4.12. Let kâˆˆ {4,6,10,12}, let
mâˆˆZ, and let S0âŠ‚S(â„“i)be a nonempty subset such that |N(Mk, Î³)âˆ’m| â‰¤1for
allÎ³âˆˆS0, and N(Mk, Î³)Ì¸=mfor all Î³âˆˆS(â„“i)\S0. Let
B=Y
Î³âˆˆS(â„“i)\S0|N(Mk, Î³)âˆ’m|.
Then for each Î³âˆˆS0, the inequality |N(Mk, Î³)âˆ’m|<1
Bholds if and only if
N(Mk, Î³) =m.
Proof. LetS1âŠ‚S0be the subset of matrices Î³such that the equality
N(Mk, Î³) =mholds, and consider the polynomial
P=Y
Î³âˆˆS(â„“i) 
Xâˆ’N(Mk, Î³) +m
âˆˆZ[X],by Theorem 4.11 .
The coefficient of XjinPis zero for 0â‰¤jâ‰¤#S1âˆ’1, and the coefficient of X#S1
is, up to sign,
Y
Î³âˆˆS(â„“i)\S0 
N(Mk, Î³)âˆ’m
Â·Y
Î³âˆˆS0\S1 
N(Mk, Î³)âˆ’m
.
By construction, this integer is nonzero, hence at least 1in absolute value. Thus,
for every Î³âˆˆS0\S1, we have as claimed
|N(Mk, Î³)âˆ’m| â‰¥1
B. â–¡
Algorithm 4.14. Input:the input and output of Algorithm 4.12.
Output: the modular invariants of all the p.p. abelian surfaces linked to Aby an
i-step â„“-isogeny, as a list of integer-valued tuples (mâ€²
4, mâ€²
6, mâ€²
10, mâ€²
12).
Step 1. For each Î³0âˆˆLandkâˆˆ {4,6,10,12}, let S0âŠ‚Lto be the set of all
matrices Î³such that mâ€²
k(Î³) =mâ€²
k(Î³0), and compute a low-precision upper
bound for the quantity Bas in Lemma 4.13. Let B0be their maximum
value ranging over all Î³0andk.
Step 2. Choose a higher working precision (more on this below). Recompute the
period matrix Ï„, as well as N(Mk, Î³)for each Î³âˆˆLandkâˆˆ {4,6,10,12}.
Step 3. For each Î³âˆˆLandkâˆˆ {4,6,10,12}, check whether N(Mk, Î³)still contains
the candidate value mâ€²
k(Î³). If not, remove Î³from L. If yes, check whether
the inequality
|N(Mk, Î³)âˆ’mâ€²
k(Î³)|<1
B0
holds; if this cannot be decided, double the working precision and go back
to Step 2.
Step 4. Output the list of tuples (mâ€²
4(Î³), . . . , mâ€²
12(Î³))for the remaining Î³âˆˆL.
As soon as all the radii of the balls containing N(Mk, Î³)are less than1
2B0, there
will be no further doubling of the working precision in Step 3, thus Algorithm 4.14
terminates. Lemma 4.13 guarantees that the algorithm is correct.18 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
Remark 4.15. In practice, increasing the working precision by pbits results in
output intervals whose radius is multiplied by roughly 2âˆ’p. Therefore a good guess
for the choice of high precision in Step 2 of Algorithm 4.14 is to add âŒˆlog2(B0)âŒ‰bits
to the current working precision at the end of Algorithm 4.12. We then expect that
no further precision increases are needed in Step 3.
4.6. Implementation details and complexity analysis. We conclude this
section with a complexity analysis of the isogeny algorithm in terms of â„“,iand the
height of the integers mkforkâˆˆ {4,6,10,12}. First, we give an asymptotic upper
bound on the absolute values |N(Mk, Î³)|: this will specify the necessary working
precisions in Algorithms 4.12 and 4.14. Then, we review previous works on the
computation of period matrices and the evaluation of modular forms in quasi-linear
time in terms of the required precision, filling in the two black boxes of Â§4.5.
We may fix a compact subset G âŠ‚H2âˆª {âˆ}, where âˆdenotes the cusp at
infinity, such that the period matrix Ï„in Step 1 of Algorithm 4.12 always belongs
toG. For instance, we can take Gto be the set of points at a distance at most 2âˆ’10
from the Siegel fundamental domain F(see [Str14, Â§6.2]), plus the point âˆ. Recall
that the modular forms Mkare bounded in a neighborhood of âˆ, never vanish
simultaneously on H2, and that M4andM6take the value 1atâˆ. Thus there exist
two absolute constants 0< C 1< C 2<+âˆsuch that Mkâ‰¤C2uniformly on Gfor
each kâˆˆ {4,6,10,12}, and max
|Mk(Ï„)|:kâˆˆ {4,6,10,12}	
â‰¥C1for each Ï„âˆˆ G.
Lemma 4.16. In Algorithm 4.12, assume that Ï„âˆˆ G, and let
h= log max {|m4|, . . . ,|m12|}.
Then in Step 2 of that algorithm, we have log|Î»|=O(h). In Step 3, we have
log|N(Mk, Î³)|=O(h+logâ„“)for each Î³âˆˆS(â„“i)andkâˆˆ {4,6,10,12}. Both implied
constants are absolute.
Proof. For the first part, we have log|Î»| â‰¤1
4(hâˆ’logC1). For the second part,
we need to estimate |Mk(Î³Ï„)|. The matrix Î³Ï„âˆˆH2will not usually belong to G, but
its imaginary part is nevertheless â€œbounded belowâ€: if a, b,0, ddenote the 2Ã—2blocks
ofÎ³, we have Im(Î³Ï„) =aIm(Ï„)dâˆ’1, sodet Im (Î³Ï„)â‰¥C3/â„“2where C3is an absolute
constant. Let now Î·âˆˆSp(4,Z)be such that Î·Î³Ï„âˆˆ G, and let r=det(Î·âˆ—(Î³Ï„)).
Then by [Kli90, Proof of Prop. 1.1], we have
det(Im( Î·Î³Ï„)) =|r|âˆ’2det(Im( Î³Ï„))
so|r|âˆ’2â‰¤C4â„“2, where C4is an absolute constant. Finally we have
log|Mk(Î³Ï„)|= log|râˆ’kMk(Î·Î³Ï„)|=O(logâ„“)
where the implied constant is absolute. â–¡
With these estimates in hand, we focus on the two key computations left
aside in Â§4.5. From the data of modular invariants in Z, a corresponding period
matrix Ï„âˆˆ Fcan be efficiently computed using arithmetic-geometric means, an
algorithm described in [Dup06, Chap. 9] and proved correct in [Kie22a]. (In the
first low-precision step, we could also use numerical integration [MN19], but the
dependency of this algorithm on hhas not been made explicit.)
Theorem 4.17 ([Kie22b, Â§4.1]) .There exists an algorithm which, given the modular
invariants m4, . . . , m 12âˆˆZof a typical p.p. abelian surface AoverQandpâ‰¥1,COMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 19
computes an approximation of a period matrix Ï„âˆˆ FofAup to an error of 2âˆ’pwithin
a running time of eO(p+h)binary operations, where h=log max {|m4|, . . . ,|m12|}.
In order to evaluate the modular forms Mkat a point Î³Ï„âˆˆH2, we compute
a matrix Î·âˆˆSp(4,Z)such that Î·Î³Ï„is close to the fundamental domain Fand
evaluate Mk(Î·Î³Ï„). The latter can be rewritten as polynomials in terms of theta
constants at Î·Î³Ï„: see [Str14, Â§7.1] for explicit formulas. Following [Kie22b, Â§4.3],
we can control the cost of the reduction step in terms of the quantity
Î›(Î³Ï„) = log max {2,|Î³Ï„|,det(Im( Î³Ï„))âˆ’1},
where |Î³Ï„|denotes the largest absolute value of an entry of Î³Ï„. As a consequence
of [Str14, Cor. 7.8], we have |Ï„|=O(h), soÎ›(Î³Ï„) =O(logh+logâ„“)where the
implied constant is absolute. After the reduction step, the evaluation of theta
constants on Fcan be done in uniform quasi-linear time using arithmetic-geometric
means and Newtonâ€™s method. The following result summarizes this approach.
Theorem 4.18 ([Kie22b, Â§4.3]) .There exists an algorithm and an absolute con-
stant C5such that the following holds. Let Ï„âˆˆH2andpâ‰¥1. Then, given an approx-
imation of Ï„to precision p+C5Î›(Ï„), the algorithm computes a matrix Î³âˆˆSp(4,Z)
such that log|Î³|=O(Î›(Ï„)), a matrix Ï„â€²âˆˆ Fsuch that |Ï„â€²âˆ’Î³Ï„| â‰¤2âˆ’p, and an
approximation of the squares of theta constants at Î³Ï„up to an error of 2âˆ’p. Its
running time is eO(Î›(Ï„)2+p)binary operations.
We can now prove the complexity bound stated at the beginning of Section 4.
Corollary 4.19. LetAbe a typical p.p. abelian surface over Qwith modular
invariants m4, . . . , m 12, and let h=log max {|m4|, . . . ,|m12|}. Let â„“be a prime,
letiâˆˆ {1,2}, and let nbe the size of the list Lreturned by Algorithm 4.12 on this
input. Then one can run Algorithms 4.12 and 4.14 to detect i-step â„“-isogenies with
domain Ausing a total of eO 
(n+ 1)â„“dh
binary operations, where d= 3when i= 1
andd= 4when i= 2.
Proof. By Lemma 4.16, in Step 3 of Algorithm 4.12, we must evaluate Mk(Î³Ï„)
toO(h+logâ„“)bits of precision for each Î³âˆˆS(â„“i). By Theorems 4.17 and 4.18,
this can be done within eO(â„“dh)binary operations, as #S(â„“i) =O(â„“d). Similarly, in
Algorithm 4.14, we have log|B0|=O(â„“d(h+logâ„“)), so we need to evaluate Mk(Î³Ï„)
toO 
â„“d(h+logâ„“)
bits of precision for each Î³âˆˆL. This can be done in eO(nâ„“dh)
binary operations. â–¡
5. Reconstructing genus 2 curves
5.1. Mestreâ€™s algorithm. Given a quadruple of Igusaâ€“Clebsch invariants
I= (I2:I4:I6:I10)overQ, there always exists a genus 2 curve over Qhaving
these invariants, but it cannot always be defined over Q. This phenomenon is
known as Mestreâ€™s obstruction. Given I, Mestre [Mes91] constructs a conic L
overQtogether with an effective divisor Dof degree 6 on this conic with the
following properties. If L(Q)Ì¸=âˆ…and hence Lâˆ¼=P1, then there exists a genus 2
curve over Qwith invariants Iwhose Weierstrass points correspond to the points
inD. IfL(Q) =âˆ…, there is no genus 2 curve over Qhaving these invariants. This
reconstruction algorithm has been implemented in many computer algebra systems
and the reader is referred to [Mes91] for more details about the method.20 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
In our setting, Mestreâ€™s obstruction does not arise, and L(Q)is always non-
empty. Indeed, by Proposition 4.7, we only manipulate typical p.p. abelian surfaces
defined over Q. By [Lau01, Appendix, Thm. 4], these surfaces all are Jacobians of
genus 2 curves defined over Q.
Mestreâ€™s algorithm usually produces curves with very large coefficients. Their
sizes can be reduced by applying [SC03], which has been implemented in [PARI/GP]
and [Magma]. Note that even this reduced model is not necessarily unique.
5.2. Identifying the correct twists. Having constructed a curve Câ€²overQ
from the invariants output by Algorithm 4.14, we have no guarantee yet that Jac(C)
will be isogenous to Jac(Câ€²)overQ: we can only say that Jac(Câ€²)is a twist of the
abelian surface isogenous to Jac(C). Since End(Jac(Câ€²)Q) =Z, the only possible
twists of Jac(Câ€²)are quadratic twists, and correspond to quadratic twists of the
curve Câ€²itself. Therefore, there will be a unique twist Câ€²â€²ofCâ€²(up to isomorphism
overQ) such that Jac(C)is isogenous to Jac(Câ€²â€²).
We use the following method to find Câ€²â€². For a genus 2 curve Cand a prime of
good reduction â„“ofJac(C), we denote by aâ„“(C)âˆˆZthe trace of Frobenius on the
reduction on Jac(C)modulo â„“.
Algorithm 5.1. Input:curves CandCâ€²of genus 2 over Qwith typical Jacobians,
such that some twist of Jac(Câ€²)is isogenous to Jac(C).
Output: the unique twist Câ€²â€²ofCâ€²such that Jac(C)is isogenous to Jac(Câ€²â€²).
Step 1. Compute a set Bof primes containing the bad primes of CandCâ€². Let
G=âŸ¨âˆ’1âŸ© Ã— âŸ¨b:bâˆˆ BâŸ© âŠ‚ Qâˆ—/Qâˆ—2.
Step 2. Find auxiliary primes â„“1, . . . , â„“ ksuch that the Frobenius traces aâ„“i(C)are
nonzero and the map
Âµ:Gâ†’ {Â± 1}k, x7â†’x
â„“i
1â‰¤iâ‰¤k
is injective.
Step 3. Identify the unique element gâˆˆGfor which the twist Câ€²â€²ofCâ€²byg
satisfies aâ„“i(Câ€²â€²) =aâ„“i(C)for every 1â‰¤iâ‰¤k, and return Câ€²â€².
Proposition 5.2. Algorithm 5.1 terminates and is correct.
Proof. First, we will prove the existence of the auxiliary primes â„“1, . . . , â„“ k. By
[CDSS17, Theorem 1] and the fact that Jac(C)is typical, the equality aâ„“(C) = 0
holds only for a density 0 subset of primes. Write B âˆª {âˆ’ 1}={b1, . . . , b k}. For
each 1â‰¤iâ‰¤k, by quadratic reciprocity, we can find congruence conditions on â„“
guaranteeing that bi
â„“
=âˆ’1and bj
â„“
= 1for each jÌ¸=i. By Dirichletâ€™s prime
number theorem and the fact that only a density 0 subset of the primes are excluded,
there exists a prime â„“i(in fact infinitely many) satisfying these congruence conditions
and such that aâ„“i(C)Ì¸= 0. With this choice of â„“1, . . . , â„“ k, the map Âµis injective.
Next, we recall the NÃ©ronâ€“Oggâ€“Shafarevich criterion [ST68]: an abelian sur-
faceAhas good reduction at a prime pif and only if for all primes â„“Ì¸=p, the Galois
representation Tâ„“(A)is unramified at p. Hence, if Ahas good reduction at pandAâ€²
is the quadratic twist of Aby a squarefree integer Ddivisible by p, then Aâ€²has bad
reduction at p. Indeed, the Galois representation Tâ„“(Aâ€²)is obtained from Tâ„“(A)by
tensoring with the quadratic character associated with Q(âˆš
D), which is ramifiedCOMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 21
atp. On the other hand, any abelian surface isogenous to Amust have the same
primes of bad reduction.
As a consequence, the correct twist Jac(Câ€²â€²)ofJac(Câ€²)is given by a squarefree
integer Dthat can only be divisible by primes of bad reduction of Jac(C)orJac(Câ€²).
These form a subset of B, so the correct twist is among those enumerated by G.
By the choice of the auxiliary primes â„“1, . . . , â„“ k, the tuples of Frobenius traces
(aâ„“1, . . . , a â„“k)take distinct values for all the twists enumerated by G, so there is a
unique output in Step 3. â–¡
Algorithm 5.1 has an exponential complexity in terms of the number of bad
primes of CandCâ€², but this number is small in practice.
Remark 5.3. In the case of elliptic curves, an analogue of Algorithm 5.1 would not
be needed. Indeed, if Eis an elliptic curve over Qwith automorphism group {Â±1},
then the modular invariants of EinP4,6(Q)determine the Q-isomorphism class
ofE, as twisting Ebydmultiplies its invariants by d2andd3. Thus we would
obtain the correct twist as a direct result of the computations over C.
In genus 2however, quadratic twists have the same modular invariants: this
comes from the fact that twisting an abelian surface AbydâˆˆQÃ—acts on â„¦1(A)
asDiag(âˆš
d,âˆš
d), hence on âˆ§2â„¦1(A)as multiplication by d, which is a rational
number. Nevertheless, one would still be able to compute the correct twist directly
(and thus circumvent Algorithm 5.1) by considering vector-valued Siegel modular
forms, or equivalently by keeping track of big period matrices. This goes beyond
the scope of this paper, and Algorithm 5.1 was sufficient for our experiments.
6. Examples
We now give explicit illustrations of the methods developed above. First, we
discuss an example of a 1-step 31-isogeny; then, we report on the results of running
our algorithm on a large dataset of Jacobians of genus 2 curves that includes the
current LMFDB data [LMFDB]. The prime â„“= 31is the largest prime for which
the Galois representation on A[â„“]is not surjective among all the abelian surfaces A
in this dataset [BBKKMSV23].
All computations were ran on a server with an AMD EPYC 7713 2GHz CPU
and Sage 9.7 [Sage], Magma 2.28-2 [Magma], GP/PARI 2.15.0 [PARI/GP], and
pydhme v0.0.6 installed.3
6.1. A 1-step 31-isogeny. Consider the hyperelliptic curve
C:y2+ (x+ 1)y=x5+ 23x4âˆ’48x3+ 85x2âˆ’69x+ 45.
The conductor of Jac(C)is72Â·312. Combining this with the study of local Euler
factors at pâˆˆ {3,5,11}, we see that L1=âˆ…andL2âŠ† {31}in the notation of Â§3.
The Igusaâ€“Clebsch invariants (I2:I4:I6:I10)ofCinP2,4,6,10(Q)are
(âˆ’324608 : 7340502400 : âˆ’589129410429504 : 5306537926135312384) ,
from which we can deduce that Jac(C)has the following modular invariants:
(m4, m6, m10, m12) = (1909600 ,2582145496 ,45252529 ,âˆ’59231181184) .
3A Sage interface for [Kie23] is available at https://github.com/edgarcosta/pyhdme/ .22 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
We apply Algorithm 4.12 with â„“= 31andi= 1. After computing a period matrix
Ï„â‰ˆ1.69708 i 0.31188 + 0 .84854 i
0.31188 + 0 .84854 iâˆ’0.18812 + 2 .09922 i
in the Siegel fundamental domain with 300 bits of precision, we conclude that there
is a unique coset representative
Î³=ï£«
ï£¬ï£¬ï£­1 0 0 7
0 1 7 23
0 0 31 0
0 0 0 31ï£¶
ï£·ï£·ï£¸âˆˆS(31)
such that N(M4, Î³)contains an integer. Indeed, we have
|N(M4, Î³)âˆ’Î±2Â·318972640 |<7.8Ã—10âˆ’47
|N(M6, Î³)âˆ’Î±3Â·1225361851336 |<5.5Ã—10âˆ’39
|N(M10, Î³)âˆ’Î±5Â·10241530643525839 |<1.6Ã—10âˆ’29
|N(M12, Î³) +Î±6Â·307105165233242232724 |<4.6Ã—10âˆ’22
where Î±= 22Â·32Â·31. We then employ Algorithm 4.14, working with 4128800 bits
of precision, to certify that an abelian surface with projective invariants
(318972640 ,1225361851336 ,10241530643525839 ,âˆ’307105165233242232724)
is indeed isogenous to Jac(C)via a 1-step 31-isogeny.
Mestreâ€™s algorithm and a reduction step (Â§5.1) yield the hyperelliptic curve
y2=âˆ’1624248 x6+5412412 x5âˆ’6032781 x4+876836 x3âˆ’1229044 x2âˆ’5289572 xâˆ’1087304 .
Applying Algorithm 5.1 we learn that the desired curve Câ€²â€²is the quadratic twist of
this hyperelliptic curve by âˆ’83761, and is given by the equation
y2+xy=âˆ’x5+ 2573 x4+ 92187 x3+ 2161654285 x2+ 406259311249 x+ 93951289752862
with discriminant 72Â·313Â·8376112.
The overall computation took 175 minutes of CPU time and used 6.5 gigabytes
of ram, of which roughly 90% is spent certifying the existence of an isogeny between
these two curves, i.e. in Algorithm 4.14.
Given CandCâ€²â€², wecanalsoindependentlyproduceacertificatefortheexistence
of an isogeny of the correct degree [CMSV19]. It took about 6.5 CPU hours to
produce the 2.8 megabyte certificate.
6.2. LMFDB and beyond. We now report on the application of our algo-
rithms to a dataset of 1743737 genus 2 curves with trivial geometric endomorphism
algebra. These are all the typical abelian surfaces in a dataset of approximately
5 million curves with conductor up to 220provided to us by Andrew Sutherland
[Sut22]. This dataset expands the current set of genus 2 curves in the L-functions
and modular forms database (LMFDB) [LMFDB].
The 1743737 curves are split among 1440894 isogeny classes, while the LMFDB
subset contains 63107 curves split among 62600 isogeny classes. These isogeny
classes have been identified using Frobenius traces only [BSSVY16, Â§4.3], a heuristic
method whose results are confirmed by our computations.
We have applied our algorithms to one curve per isogeny class and found 600948
new curves in total. Table 1 lists the degrees of the irreducible isogenies that we
found (in other words we ignore 2-step isogenies arising as the composition of twoCOMPUTING ISOGENY CLASSES OF TYPICAL P.P. ABELIAN SURFACES 23
rational 1-step isogenies), and Table 2 shows the sizes of the 1440894 isogeny classes.
Most of the large classes only feature Richelot isogenies, i.e. 1-step 2-isogenies. In
total, however, only 242442 of the 600948 new curves can be reached from the
original dataset via Richelot isogenies.
dNumber of isogenies
of degree ddNumber of isogenies
of degree d
22419157 74246
24693519 1149
3211568 13220
3429742 1349
52415 1724
542440 3121
72154
Table 1. Number of isogenies of each degree in the extended dataset.
kNumber of isogeny
classes of size kkNumber of isogeny
classes of size k
1 1032456 12 52
2 116847 14 102
3 197253 16 1555
4 54543 18 706
5 15547 20 120
6 14323 22 99
7 430 24 6
8 5594 28 4
9 35 30 8
10 1214
Table 2. Distribution of isogeny class sizes in the extended dataset.
Remark 6.1. It is worth noting that 195806 of the 197253 isogeny classes of
size3and 15523 of the 15547 isogeny classes of size 5are only made up of 2-step
2-isogenies, of degree 16. The isogeny graphs in these two cases are a triangle â–³
and a bowtie â–· â—respectively. Moreover, there is no isogeny class of size 2made of a
single 2-step 2-isogeny.
These observations can be explained as follows: the existence of a 2-step
2-isogeny Ï†1:A1â†’A2always implies the existence of a triangle consisting of
three 2-step 2-isogenies. Indeed, assume that kerfis generated by e1,2e2,2f2,
where (e1, e2, f1, f2)is a symplectic basis of A1[4]. Then the subgroup generated
bye1+ 2f1,2e2,2f2is another rational maximal isotropic subgroup of A1[4], and
gives rise to an isogeny Ï†2:A1â†’A3. Furthermore, one can show that there exists
another 2-step 2-isogeny Ï†3:A2â†’A3such that Ï†2â—¦[2] = Ï†3â—¦Ï†1.
The whole computation took 111 days of CPU time and used 215 megabytes of
RAM on average per class. Only 30 classes taking more than 10 minutes. In these24 R. VAN BOMMEL, S. CHIDAMBARAM, E. COSTA, AND J. KIEFFER
29 cases, we had to search for and potentially certify isogenies of large degree. For
6 of the classes, it took on average 18 minutes to prove the nonexistence of 1 and
2-step 29-isogenies; one of them has LMFDB label 976.a, and contains a Jacobian
with a 29-torsion point. The remainder correspond to 23 = 9 + 9 + 4 + 1 isogeny
classes consisting of exactly two abelian surfaces linked by isogenies of degrees 114,
134,172, and 312respectively, as listed in Table 1. The only class that took more
than 1.5 hours is the example discussed in Â§6.1, featuring the isogeny of degree 312.
The largest degree of an irreducible isogeny was 134. For example, the class
349.a has two abelian surfaces connected by such an isogeny, namely the Jacobians
of the two curves
349.a.349.1:y2+ (x3+x2+x+ 1)y=âˆ’x3âˆ’x2
C:y2+y=x5âˆ’363x4âˆ’2517x3+ 151106 x2+ 487525 xâˆ’16355862 .
Table 3 continues our zoological study of isogeny graphs by listing all graphs on
at most four vertices that we observed. We label an edge by â„“(resp. â„“2) when it
corresponds to a 1-step (resp. 2-step) â„“-isogeny.
nfornâˆˆ {2,3,5,7,13,17,31,9,25,49,121,169}
n nfornâˆˆ {3,5,7,9}
4
44
n n nfornâˆˆ {3,5}
nn
m m for(m, n)âˆˆ {(2,3),2,5),(2,9),(2,25),
(3,3),(5,9),(9,25)}
n
n nfornâˆˆ {2,3}
Table 3. Observed isogeny graphs with 2 to 4 vertices.
The 1440894 isogeny classes represent 71 non-isomorphic graphs, the largest
having size 30 (see https://github.com/edgarcosta/genus2isogenies/tree/m
ain/data/graphs_2e20 ). In every class containing 18 or more abelian surfaces, the
only irreducible isogenies are Richelot isogenies.REFERENCES 25
Despite the size of our dataset, this list of graphs is not complete. The following
curve, suggested by Noam Elkies, gives rise to an isogeny graph consisting of 42
vertices connected by Richelot isogenies:
y2= (x+ 4)( x+ 11)(4 xâˆ’1)(12 x+ 13)(15 xâˆ’4).
Thiscurvehasconductor 224Â·33Â·52Â·72Â·13Â·172anddiscriminant 240Â·318Â·56Â·76Â·134Â·174.
Its isogeny graph is displayed in Figure 1.
Figure 1. Isogeny graph with 42 vertices.
6.3. Sanity checks. Running such a large scale computation allows us to
perform several sanity checks regarding the correctness of our implementation. For
each isogeny found, we heuristically confirmed that the Jacobians were isogenous in
two ways. First, we confirmed that all the traces of Frobenius agree for all primes up
to216, using [smalljac], that do not divide the discriminants of the curves involved.
Second, independent analytic computations based on [CMSV19] have confirmed the
isogeny degrees that we computed.
Regarding completeness of the isogeny classes, we ran two checks. As indicated
above, we started from only one curve in each of the 1440894 (heuristic) isogeny
classes in our dataset, and we checked that all the other curves in that class indeed
appeared in our result. We also confirmed that our isogeny classes are closed under
Richelot isogenies, using the function RichelotIsogenousSurfaces in [Magma]
based on algebraic formulas specific to this case.
References
[BBKKMSV23] Barinder S. Banwait, Armand Brumer, Hyun Jong Kim, Zev
Klagsbrun, Jacob Mayle, Padmavathi Srinivasan, and Isabel Vogt.
â€œComputing non-surjective primes associated to Galois represen-
tations of genus 2curves.â€ 2023 ( â†‘6, 7, 8, 21).26 REFERENCES
[BL04] C. Birkenhake and H. Lange. â€œComplex abelian varieties.â€ Second.
Springer, 2004 ( â†‘14).
[BSSVY16] Andrew R. Booker, Jeroen Sijsling, Andrew V. Sutherland, John
Voight, and Dan Yasaki. â€œA database of genus-2 curves over the
rational numbers.â€ In: LMS J. Comput. Math. 19 (2016), pp. 235â€“
254 (â†‘22).
[Magma] Wieb Bosma, John Cannon, and Catherine Playoust. â€œThe Magma
algebra system. I. The user language.â€ In: J. Symbolic Comput.
24.3-4 (1997). Computational algebra and number theory (London,
1993), pp. 235â€“265 ( â†‘20, 21, 25).
[BL09] Reinier BrÃ¶ker and Kristin Lauter. â€œModular polynomials for
genus 2.â€ In: LMS J. Comput. Math. 12 (2009), pp. 326â€“339 ( â†‘9,
12).
[BK94] Armand Brumer and Kenneth Kramer. â€œThe conductor of an
abelian variety.â€ In: Compositio Math. 92.2 (1994), pp. 227â€“248
(â†‘5).
[CL21] Garen Chiloyan and Ãlvaro Lozano-Robledo. â€œA classification of
isogeny-torsion graphs of Q-isogeny classes of elliptic curves.â€ In:
Trans. London Math. Soc. 8.1 (2021), pp. 1â€“34 ( â†‘1).
[CG15] Fabien ClÃ©ry and Gerard van der Geer. â€œConstructing vector-
valued Siegel modular forms from scalar-valued Siegel modular
forms.â€ In: Pure Appl. Math. Q. 11.1 (2015), pp. 21â€“47 ( â†‘11, 12,
13).
[CDSS17] Alina Carmen Cojocaru, Rachel Davis, Alice Silverberg, and
Katherine E. Stange. â€œArithmetic properties of the Frobenius
traces defined by a rational abelian variety (with two appen-
dices by J-P. Serre).â€ In: Int. Math. Res. Not. IMRN 12 (2017),
pp. 3557â€“3602 ( â†‘20).
[CMSV19] Edgar Costa, Nicolas Mascot, Jeroen Sijsling, and John Voight.
â€œRigorous computation of the endomorphism ring of a Jacobian.â€
In:Math. Comp. 88.317 (2019), pp. 1303â€“1339 ( â†‘22, 25).
[CE15] Jean-Marc Couveignes and Tony Ezome. â€œComputing functions
on Jacobians and their quotients.â€ In: LMS J. Comput. Math. 18.1
(2015), pp. 555â€“577 ( â†‘9).
[CW05] John E. Cremona and Mark Watkins. â€œComputing isogenies of
elliptic curves.â€ 2005 ( â†‘1).
[Die02] Luis V. Dieulefait. â€œExplicit determination of the images of the
Galois representations attached to abelian surfaces with End (A) =
Z.â€ In:Experimental Mathematics 11.4 (2002), pp. 503â€“512 ( â†‘2,
6).
[Dup06] RÃ©gis Dupont. â€œMoyenne arithmÃ©tico-gÃ©omÃ©trique, suites de Bor-
chardt et applications.â€ PhD thesis. Ã‰cole Polytechnique. 2006
(â†‘18).
[EGM] Bas Edixhoven, Gerard van der Geer, and Ben Moonen. â€œAbelian
varieties.â€ Unpublished book ( â†‘3).
[Elk98] Noam D. Elkies. â€œElliptic and modular curves over finite fields
and related computational issues.â€ In: Computational perspectivesREFERENCES 27
on number theory (Chicago, IL, 1995) . Vol. 7. AMS/IP Stud. Adv.
Math. Amer. Math. Soc., Providence, RI, 1998, pp. 21â€“76 ( â†‘1).
[Fal83] Gerd Faltings. â€œEndlichkeitssÃ¤tze fÃ¼r abelsche VarietÃ¤ten Ã¼ber
ZahlkÃ¶rpern.â€ In: Invent. Math. 73.3 (1983), pp. 349â€“366 ( â†‘1).
[FC90] Gerd Faltings and Ching-Li Chai. â€œDegeneration of abelian va-
rieties.â€ With an appendix by David Mumford. Springer-Verlag,
Berlin, 1990 ( â†‘11).
[Gee08] Gerard van der Geer. â€œSiegel modular forms and their applica-
tions.â€ In: The 1-2-3 of modular forms . Universitext. Springer,
Berlin, 2008, pp. 181â€“245 ( â†‘10).
[GRR72] A. Grothendieck, M. Raynaud, and D. S. Rim. â€œGroupes de mon-
odromie en gÃ©omÃ©trie algÃ©brique. I.â€ In: SÃ©minaire de GÃ©omÃ©trie
AlgÃ©brique du Bois-Marie 1967â€“1969 (SGA 7 I). Springer-Verlag,
Berlin-New York, 1972 ( â†‘6, 7).
[Igu62] Jun-ichi Igusa. â€œOn Siegel modular forms of genus two.â€ In: Amer.
J. Math. 84 (1962), pp. 175â€“200 ( â†‘10, 11).
[Igu79] Jun-ichi Igusa. â€œOn the ring of modular forms of degree two over
Z.â€ In:Amer. J. Math. 101.1 (1979), pp. 149â€“183 ( â†‘11).
[Joh17] Fredrik Johansson. â€œArb: efficient arbitrary-precision midpoint-
radius interval arithmetic.â€ In: IEEE Trans. Comput. 66.8 (2017).
https://arblib.org/ , pp. 1281â€“1292 ( â†‘2).
[smalljac] Kiran S. Kedlaya and Andrew V. Sutherland. â€œComputing L-series
of hyperelliptic curves.â€ In: Algorithmic number theory . Vol. 5011.
Lecture Notes in Comput. Sci. Springer, Berlin, 2008, pp. 312â€“326
(â†‘25).
[Ken82] M. A. Kenku. â€œOn the number of Q-isomorphism classes of elliptic
curves in each Q-isogeny class.â€ In: J. Number Theory 15.2 (1982),
pp. 199â€“202 ( â†‘1).
[Kie22a] J.Kieffer.â€œSignchoicesintheAGMforgenustwothetaconstants.â€
In:Pub. Math. BesanÃ§on (2022), pp. 37â€“58 ( â†‘18).
[Kie22b] Jean Kieffer. â€œEvaluating modular equations for abelian surfaces.â€
2022 ( â†‘9, 11, 14, 15, 18, 19).
[Kie23] Jean Kieffer. â€œHDME: a C library for the evaluation of higher-
dimensional modular equations.â€ https://github.com/j-kieff
er/hdme. 2023 ( â†‘2, 21).
[Kli90] H Klingen. â€œIntroductory lectures on Siegel modular forms.â€ Cam-
bridge University Press, 1990 ( â†‘18).
[Kri90] Aloys Krieg. â€œHecke algebras.â€ In: Mem. Amer. Math. Soc. 87.435
(1990) ( â†‘11, 13).
[LV14] Eric Larson and Dmitry Vaintrob. â€œDeterminants of subquotients
of Galois representations associated with abelian varieties.â€ In:
J. Inst. Math. Jussieu 13.3 (2014). With an appendix by Brian
Conrad, pp. 517â€“559 ( â†‘7).
[Lau01] Kristin Lauter. â€œGeometric methods for improving the upper
bounds on the number of rational points on algebraic curves over
finite fields.â€ In: J. Algebraic Geom. 10.1 (2001). With an appendix
in French by J.-P. Serre, pp. 19â€“36 ( â†‘5, 20).28 REFERENCES
[LMFDB] The LMFDB Collaboration. â€œThe L-functions and modular forms
database.â€ http://www.lmfdb.org . 2022 ( â†‘1, 2, 21, 22).
[LR23] David Lubicz and Damien Robert. â€œFast change of level and
applications to isogenies.â€ In: Res. Number Theory 9.1 (2023),
Paper No. 7, 28 ( â†‘9).
[Maz78] B. Mazur. â€œRational isogenies of prime degree (with an appendix
by D. Goldfeld).â€ In: Invent. Math. 44.2 (1978), pp. 129â€“162 ( â†‘1).
[Mes91] Jean-FranÃ§ois Mestre. â€œConstruction de courbes de genre 2Ã  partir
de leurs modules.â€ In: Effective methods in algebraic geometry
(Castiglioncello, 1990) . Vol. 94. Progr. Math. BirkhÃ¤user Boston,
1991, pp. 313â€“334 ( â†‘11, 19).
[Mil15a] Enea Milio. â€œA quasi-linear time algorithm for computing modular
polynomials in dimension 2.â€ In: LMS J. Comput. Math. 18.1
(2015), pp. 603â€“632 ( â†‘2, 9).
[Mil15b] Enea Milio. â€œModular polynomials.â€ https://members.loria.fr
/EMilio/modular-polynomials/ . [Online; accessed 2-May-2023].
2015 ( â†‘2).
[Mil86] J. S. Milne. â€œAbelian varieties.â€ In: Arithmetic geometry (Storrs,
Conn., 1984) . Springer, New York, 1986, pp. 103â€“150 ( â†‘4, 5).
[MN19] Pascal Molin and Christian Neurohr. â€œComputing period matrices
and the Abel-Jacobi map of superelliptic curves.â€ In: Math. Comp.
88.316 (2019), pp. 847â€“888 ( â†‘18).
[Mum70] David Mumford. â€œAbelian varieties.â€ Published for the Tata In-
stitute of Fundamental Research, Bombay by Oxford University
Press, London, 1970 ( â†‘3, 4).
[PARI/GP] PARI/GP version 2.15.0. available from http://pari.math.u
-bordeaux.fr/ . The PARI Group. Univ. Bordeaux, 2022 ( â†‘20,
21).
[Ray74] Michel Raynaud. â€œSchÃ©mas en groupes de type (p, . . . , p ).â€ In:Bull.
Soc. Math. France 102 (1974), pp. 241â€“280 ( â†‘7, 8).
[Sage] The Sage Developers. SageMath, the Sage Mathematics Software
System (Version 9.7) .https://www.sagemath.org . 2022 ( â†‘6,
21).
[Ser72] Jean-Pierre Serre. â€œPropriÃ©tÃ©s galoisiennes des points dâ€™ordre fini
des courbes elliptiques.â€ In: Invent. Math. 15.4 (1972), pp. 259â€“331
(â†‘7, 8).
[Ser99] Jean-Pierre Serre. â€œOeuvres â€“ Collected Papers IV: 1985â€“1998.â€
Oeuvres. Springer Berlin Heidelberg, 1999, pp. 1â€“55 ( â†‘2, 6).
[ST68] Jean-Pierre Serre and John Tate. â€œGood reduction of abelian
varieties.â€ In: Ann. of Math. (2) 88 (1968), pp. 492â€“517 ( â†‘6, 20).
[SC03] Michael Stoll and John E. Cremona. â€œOn the reduction theory of
binary forms.â€ In: J. Reine Angew. Math. 565 (2003), pp. 79â€“99
(â†‘20).
[Str14] Marco Streng. â€œComputing Igusa class polynomials.â€ In: Math.
Comp.83.285 (2014), pp. 275â€“309 ( â†‘10, 11, 18, 19).
[Sut22] Andrew V. Sutherland. â€œA database of genus 2curves over Qwith
conductor less than 220.â€https://math.mit.edu/~drew/st2e2
0.txt. 2022 ( â†‘22).REFERENCES 29
[VÃ©l71] Jacques VÃ©lu. â€œIsogÃ©nies entre courbes elliptiques.â€ In: C. R. Acad.
Sci. Paris SÃ©r. A-B 273 (1971), A238â€“A241 ( â†‘1).
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
MA 02139-4307, USA
Email address :bommel@mit.edu
URL:https://raymondvanbommel.nl
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
MA 02139-4307, USA
Email address :shivac@mit.edu
URL:https://math.mit.edu/~shivac
Department of Mathematics, Massachusetts Institute of Technology, Cambridge,
MA 02139-4307, USA
Email address :edgarc@mit.edu
URL:https://edgarcosta.org
Department of Mathematics, Harvard University, Cambridge, MA 02138, USA
Email address :kieffer@math.harvard.edu
URL:https://scholar.harvard.edu/kieffer