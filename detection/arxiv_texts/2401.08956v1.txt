1
A Unified NOMA Framework in Beam-Hopping
Satellite Communication Systems
Xuyang Zhang, Xinwei Yue, Senior Member IEEE, Tian Li, Member, IEEE, Zhihao Han, Yafei Wang, Yong Ding
and Rongke Liu, Senior Member IEEE
Abstract —This paper investigates the application of a unified
non-orthogonal multiple access framework in beam hopping
(U-NOMA-BH) based satellite communication systems. More
specifically, the proposed U-NOMA-BH framework can be ap-
plied to code-domain NOMA based BH (CD-NOMA-BH) and
power-domain NOMA based BH (PD-NOMA-BH) systems. To
satisfy dynamic-uneven traffic demands, we formulate the opti-
mization problem to minimize the square of discrete difference
by jointly optimizing power allocation, carrier assignment and
beam scheduling. The non-convexity of the objective function
and the constraint condition is solved through Dinkelbach’s
transform and variable relaxation. As a further development, the
closed-from and asymptotic expressions of outage probability are
derived for CD/PD-NOMA-BH systems. Based on approximated
results, the diversity orders of a pair of users are obtained in
detail. In addition, the system throughput of U-NOMA-BH is
discussed in delay-limited transmission mode. Numerical results
verify that: i) The gap between traffic requests of CD/PD-NOMA-
BH systems appears to be more closely compared with orthogonal
multiple access based BH (OMA-BH); ii) The CD-NOMA-BH
system is capable of providing the enhanced traffic request and
capacity provision; and iii) The outage behaviors of CD/PD-
NOMA-BH are better than that of OMA-BH.
Index terms— Beam hopping, non-orthogonal multiple
access, resource allocation, outage probability.
I. I NTRODUCTION
With the seamless coverage of the global information net-
work and the interconnection of all things, the terrestrial
wireless network will integrate with satellite communication
to form an integrated mobile internet of air-space-ground
[1]. The air-space-ground networks were designed to provide
seamless wide-area, high-throughput, and evenly distributed
elastic links for the sixth-generation (6G) communication
This work was supported in part by the National Key R&D Program of
China under Grant 2020YFB1807102, in part by National Natural Science
Foundation of China under Grant 62071052, Grant 62201533, in part by the
Beijing Natural Science Foundation under Grant L202003, and in part by the
Civil Aerospace Technology Advance Research Project of the 13th Five-Year
Plan under Grant D030301. (Corresponding author: Xinwei Yue.)
X. Zhang, X. Yue and Y . Wang are with the Key Laboratory of Information
and Communication Systems, Ministry of Information Industry and also
with the Key Laboratory of Modern Measurement &Control Technol-
ogy, Ministry of Education, Beijing Information Science and Technology
University, Beijing 100101, China (email: {xuyang.zhang, xinwei.yue and
wangyafei }@bistu.edu.cn).
T. Li is with the 54th Research Institute of China Electronics Technology
Group Corporation, Shijiazhuang Hebei 050081, China. (email: t.li@ieee.org).
Z. Han and R. Liu are with the School of Electronic and Information
Engineering, Beihang University, Beijing 100191, China. R. Liu is also
Shenzhen Institution of Beihang University, Shenzhen 518063, China (email:
{hzh 95, rongke liu}@buaa.edu.cn).
Y . Ding is with the Baicells Technologies Co. Ltd, Beijing 100095, China
(email: dingyong@baicells.com).networks [2]. Compared with geostationary earth orbit satel-
lites, the primary feature of low earth orbit (LEO) satellites
is the lower construction costs, low path loss and latency.
With respect to terrestrial communications, the LEO satellite
communication systems have ability to meet the requirements
of wider coverage and long distance [3]. To overcome non-
uniform traffic demand allocation and maximize the utilization
of satellite payload [4], the frequency multiplex in accordance
with acceptable interference was advanced seriously. In [5], the
resource management efficiency of ground-relay-satellite links
was enhanced by regulating satellite-relay antennas angle. In
addition, the efficient and flexible performance of high-speed
satellite-terrestrial links was investigated [6], which takes into
consideration the deployment of edge computing servers at
gateway stations.
Relative to orthogonal multiple access (OMA), non-
orthogonal multiple access (NOMA) has more obvious advan-
tages in the light of the fairness, flexibility of scheduling and
maximum capacity [7, 8]. Concerning avoiding user resource
conflict during NOMA transmission, spreading codes were
used [9]. Driven by this trend, the unified framework of
NOMA was proposed, which includes code-domain NOMA
(CD-NOMA) and power-domain NOMA (PD-NOMA) [10].
More particularly, the authors of [11] studied the conquering
resource waste problem of sparse code multiple access in
heterogeneous cellular networks, where the CD-NOMA based
systems achieved a better sum rate at the cost of more
complexity. As mentioned in [12], a multi-user orthogonal
time-frequency-space system with CD-NOMA technology was
analyzed to endure the dares of orthogonal frequency division
reusing in high Doppler conditions. The authors in [13]
described a serial code suggestion for system sequence cutting
back, which reduces detection complexity compared to OMA
and other NOMA schemes. To more raise the system effi-
ciency, the intelligence reflecting surface assisted CD-NOMA
was surveyed in [14], where the patterns of multiple users
were intelligently designed. Regarding PD-NOMA, the effect
of multiple users resource allocation in PD-NOMA was char-
acterized using successive interference cancellation (SIC) in
[15]. Moreover, the authors of [16] discussed a joint capacity
optimization and coordinated storing data program for hetero-
geneous networks based on PD-NOMA, aiming to minimize
the quality of service. From the parse of variable balanced
equitable dispatching in downlink PD-NOMA networks [17],
a highly efficient programme was researched by combining
power distribution and terminal congregation picking. In ad-
dition, the QoS-guarantee node power optimization algorithmarXiv:2401.08956v1  [cs.IT]  17 Jan 20242
in constraints of total satellite power and transmission delay
has been investigated [18], while the ground industrial internet
of things system model was adopted with a NOMA-based
Ka-band multibeam satellite. The authors of [19] proposed
NOMA optimization for multilayer satellite networks, where
the multi-user pairing problem was transformed into a max-
min pairing algorithm to guarantee fairness. A Hungarian joint
dichotomous algorithm based on the scheme of paired NOMA
users has been discussed in which the satellite calculates the
channel condition ratio for resource allocation and users-base
station association [20].
As one of key technologies for 6G networks, the beam
hopping (BH) has ability to drop the transmission delay for
multi-beam satellite networks [21, 22]. In actual, the BH was
regarded as the allocation of time domain resources on the
satellite, where the dwell time of the wave position coverage
area was changed according to the traffic needs and satellite
load capacity [23]. With the aim of solving satellite packet
queuing delay, the authors of [24] employed a novel mode for
active beam position regulation of BH satellite communication
scheme. In [25], the authors explored a flexible beam design
and bandwidth assignment network of deep reinforcement
learning according to three variables of time, space, and
frequency. From the perspective of carrier-to-interference ratio,
the authors in [26] evaluated the antenna systems of com-
bining BH and dimension drop of plenty applied speckles.
Furthermore, the improved cuckoo algorithm was optimized
to service a great deal of high-weight terminals as possible in
the BH networks [27]. In order to reduce operating costs, the
authors of [28] discussed a blended method for progressive
overhead throughput satellite systems utilizing BH. Recently,
a innovative joint BH and precoding scheme was surveyed
in [29], where the energy consumption optimization and
intra-beam interference inhibition were combined. From the
perspective of non-uniform traffic allocation [30], the authors
confirmed the performance advantages of BH compared to the
multiple polarization-frequency reuse networks.
For another special case, the coupling of off-the-ground
networks and NOMA is capable of achieving regional full
coverage and enhance transmission efficiency. The appli-
cation of NOMA to satellite communications has received
a great deal of attention [31–33]. As propounded in [31],
the authors investigated the outage probability of NOMA
based satellite communications over shadowed-rician fading
Channels. In [32], the authors employ NOMA to ease intra-
beam interference while achieving precoding to decrease inter-
beam influence. A NOMA based alliance conformation gamble
medium was proposed for optimizing overall cost [33], when
the satellite transmits data to the principal terminals of each
group by the NOMA. An unmanned aerial vehicle space-
ground-air integral relay network was proposed [34], where the
NOMA-assisted unmanned aerial vehicle was equipped with
a phased array antenna to receive satellite signals. According
to the advantages of downlink NOMA-BH in LEO satellite
systems, the authors of [35] derived the ergodic capacity, the
outage probability and mutual information of two users in a
spot beam. As a further achieving non-orthogonality in power
and frequency domains of the BH network [36], the design ofbandwidth compression was embedded in the NOMA scheme.
Based on the optimization of BH designed in multiple antenna
scenarios [37], the two-step resource optimization algorithm
better raising resource utilization was verified. The authors of
[38] investigated minimizing traffic matching errors by jointly
optimizing time slots and power allocation. Inspired by this
point, the upper-bound approach and lower-bound approach
have been highlighted through an efficient boundary way in
[39].
A. Motivation and Contributions
The above research works provide a solid foundation for
understanding the performance of U-NOMA-BH systems, the
papers for researching the unexcavated advantages by uniting
these two progressive technologies are still in the groping
stage of the field. As mentioned above, the existing research
contributions focus attention NOMA and BH operations on the
power domain, which leads to the satellite intra-beam inter-
ference and excessive complexity of SIC receivers. However,
the CD-NOMA-BH system can accomplish user pairing and
isolate intra-beam interference with limited carrier resources.
The PD-NOMA-BH system is designed as a special case
continuation of the idea. In addition, it is difficult to obtain
perfect channel state information (pCSI) in practical commu-
nication scenarios due to the effect of path loss, rain fading
and atmospheric ionization. Hence the impact of imperfect
channel state information (ipCSI) on the performance of U-
NOMA-BH systems should be considered. The authors of
[39] proposed a greedy algorithm to solve the mixed integer
non-convex programming (MINCP) for PD-NOMA-based BH
systems. From practical considerations, considering only the
PD-NOMA-BH system may lead to the low utilization of
satellite carrier resources. To the best of our knowledge, there
is no related work to analyze the optimization and performance
of unified NOMA based BH (U-NOMA-BH) framework,
which prompts us to develop this paper. More specifically,
we formulate the optimization of the U-NOMA-BH systems
for multiple users satisfaction and propose two corresponding
optimization algorithms. Then, we further derive the closed-
form expressions of outage probability and system throughput
for the CD/PD-NOMA-BH systems with ipCSI/pCSI. The
essential contributions of our paper are summarized as follows:
1) We formulate a resource optimization scheme for the
satisfaction of users, which minimizes the gap between
users achievable capacity and traffic requests, i.e., the
paired NOMA users traffic gap composed of users in
beam-center users (BCU) and beam-edge users (BEU).
On the basis of the proposed problem, the satisfaction
of users is constrained by optimizing carrier variables,
power allocation factors and beam-level time slots. Fur-
thermore, the optimization problem and constraints are
transformed into convex problems for analysis.
2) We design an efficient joint optimization scheme and de-
velop an iterative optimal algorithm to solve the convex
optimization problem. Multi-carrier users are optimized
by applying sparse matrix matching. The optimization
problem is divided into several subproblems, where the3
time slot allocation is based on user requirements. The
simulation results show that U-NOMA combined with
BH has excellent performance.
3) We derive the closed-form expressions of outage prob-
ability for the BCU and BEU by exploiting the U-
NOMA-BH optimization algorithm, respectively. For
obtaining more insights, we further derive the asymp-
totic outage probability of two users. Furthermore, we
calculate the diversity orders and the system throughput
in delay-limited transmission according to the derived
outage probability for U-NOMA-BH systems.
4) We study the outage probability and system throughput
of BCU and BEU with ipCSI. The results show that the
outage performance of BEU with pCSI is better than
OMA. We compare the performance of BCU and BEU
under different channel error parameters and overlapping
time slots. We observe that U-NOMA-BH systems are
capable of providing better fairness in the multi-user
state.
B. Organization and Notations
The U-NOMA-BH communication systems are illustrated
in Section II. In Section III, we formulate a joint resource
optimization problem and elaborate the operational steps for
CD-NOMA-BH and PD-NOMA-BH, respectively. In Section
IV , we analyze outage probability and system throughput
for the closed form solutions of BCU and BEU. Section V
provides the numerical results to verify the derived analytical
results. In Section VI concludes the paper.
The main notations of this paper are explained as follows:
fX(·)andFX(·)denote the probability density function (PDF)
and cumulative distribution function (CDF) of a random
variable X, respectively; (·)Trepresents stand for transpose
operations; ∥ · ∥2
2denotes Euclidean two norm of a vector;
diag(·)represents a diagonal matrix.
II. S YSTEM MODEL
We consider a unified NOMA framework to BH commu-
nication scenarios, as shown in Fig. 1, where multiple users
receive information from an LEO satellite. More precisely, the
coverage area of satellite is planned as Bbeam positions1, and
Bis the set of active beams. Note that the users are randomly
assigned to beams according to geographic coordinates. The
users are divided into the user nof BCU and user mof BEU
respectively based on channel conditions in each beam, where
the user nand user mare combined into paired NOMA
users. The gateway collects users traffic demand and CSI
from ground users delivering LEO via the feedback link.
According to the feedback, the resource manager optimizes the
beam illumination pattern based on the resource allocation of
algorithms used for U-NOMA-BH systems. It is assumed that
each user is equipped with one antenna. The beam of satellite
directly covers to Mground users, generating a sparse user-
subcarriers matrix GK×Min the form of an overload (i.e., the
1It is worth noting that considering time-varying multiple LEOs in the U-
NOMA-BH systems can further cover the changing regions, which will be
considered in our future work.information of user nand user mis mapped to the Ksparse
subcarriers (SC), which satisfies the relationship of M > K )2.
One frequency band serves all beams in common, i.e., the
mode transmission of single multiplexing [40].
The application scenarios for the combination of LEO and
BH are the areas of non-uniform users’ demand and poor
ground base stations, such as mountains, disaster relief and
non-hot spot area services. Besides, the U-NOMA-BH systems
can overcome shadow blocking and accomplish flexible re-
source allocation [41]. The BH satellite systems utilize multi-
port amplifiers and phased array antenna technology to achieve
excellent resource allocation capabilities. The implementation
equipments of PD-NOMA-BH system consists of multi-port
power amplifier and phased array antenna. For further explana-
tion, the multi-port power amplifier selects the corresponding
number of ports and allocates the power of each port by the
algorithm used for PD-NOMA-BH system [42]. The phased
array antenna changes the active beam position of BH by
controlling the phase of the radiation unit. Based on these, the
codebook is mapped to physical frequency domain resources
by the algorithm of the CD-NOMA-BH system. Meanwhile,
the codebook adopts high-dimensional quadrature amplitude
modulation (QAM) to more easily decode non-orthogonal user
signals at the receiver side [43, 44]. According to ground
users feedback, the input signal matrix is regrouped into
the output matrix by adjusting the NOMA power allocation
of the multi-port amplifier. Based on the on-board payload
capability, the BH system adopts the method of time division
and space division, and the phased array antenna adjusts the
feed phase flexibly to change the beam pattern. Assuming that
the satellite is equipped with a digital transparent transponder,
the satellite transmits ground data to users as a relay. The
ground stations solve queuing problem for beam allocation in
the BH systems. The joint allocation problem of time slots,
subcarriers and NOMA power factors is optimized through
the network resource manager. In CD/PD-NOMA-BH systems,
the number of active beams B0in each time slot exceed the
total number of beam positions is defined, i.e., B0≤B.
For convenience, the maximum number of active beams is
mentioned later with reference to the number of all beam
positions B. The scheduling period of the beam defines the BH
window, which consists of Ttime slots. Trepresents the set of
time slots. Let MandNrepresent the set of user mand user
n, respectively. Randomly selecting user φ, i.e., φ∈(n, m)
over ttime slot is given by
yφ,t= diag ( hφ,t)
gn,tp
Psan,txn+gm,tp
Psam,txm
+Iinter,t +Iintra,t +ω∗Ps+σ2, (1)
where amandanrepresent the power allocation factors of
user mand user nin the paired NOMA users, respectively.
Considering the fairness of users, anshould be less than am
andam+an= 1.σ2represents the Gaussian white noise.
Lethφ= [hφ1hφ2···hφk]Tdenotes the channel vector of
2As adopted by many multiple access concepts, the CD-NOMA-BH mainly
adopts sparse code multiple access (SCMA) or pattern division multiple
access (PDMA). Actually, CD-NOMA-BH is considered to be an extension
of SCMA.4
LEO Timeslots Window 
SC 1       1    1 ··· 0 ··· 1 ··· 0 
SC 2       1    1 ··· 1 ··· 0 ··· 0 
SC K       1    0 ··· 1 ··· 0 ··· 1 ···
············User n User m
K×M 
Ground users Active beam 
Inactive beam Gateway Feedbacks 
(CSI, demand, etc.) Data 
 User  n of BCU
 User  m of BEUOptimized decision 
Fig. 1: An illustration of U-NOMA-BH satellite communica-
tion systems.
carrier koccupied by user φwithin a satellite beam. Without
loss of generality, the effective channel gains between the
satellite and users are ordered as ∥hM,t∥2
2>···>∥hn,t∥2
2>
···>∥hm,t∥2
2>···>∥h1,t∥2
2. The users are paired by the
carrier distribution requirements, where paired NOMA users
are transmitted over the same subcarrier. As a result of the
channel estimation error in the actual satellite communication
network, the actual channel model can be expressed as ¯hφk=
hφk+eφk, where eφk∼ CN (0, w∗). We introduce the widely
adopted channel model in satellite systems, which is derived
ashφk=ηφk√Grr
λ
4πdφ2√Gt, where ηφk∼ CN (0,1)
represents the channel coefficient. Additionally, for free space
path loss factors, λanddφrepresent the wavelength and
distance between the satellite and the user φ, respectively. Gt
is the transmit antenna gain from the satellite antenna to user
φ.Grdenotes the receive antenna gain of user φ. In the BH
system, the channel gain is dynamically changed according to
the time slots, but the channel gain is assumed not to change
in time slot t.
The active beams are orthogonal to each other and have
independent decoding sequences, and thus multiple carriers are
assigned by the users within the beam to isolate interference.
For the case, e.g., ∥hn∥2>∥hm∥2, the user ndecodes and
removes the user m’s signal using SIC in the beam. The user
malso obtains more power to enhance its performance by the
NOMA protocol. Based on previous assumptions, the signal-
plus-interference-to-noise ratio (SINR) of the user m’s signal
xmdetected by user nis given by
γn→m=Ps∥diag (hn,t)gm,t∥2
2am,t
Ps∥diag (hn,t)gn,t∥2
2an,t+It+ω∗Ps+σ2,(2)
where It=∥Iinter,t∥2
2+∥Iintra,t∥2
2,Iinter,t =P
b∈B′P
φ′∈M,Ndiag(hφ′,t)gφ′,txφ′Ps and Iintra,t =
P
φ′∈M,N\{φ}diag(hφ′,t)gφ′,txφ′Psdenote the interference
of inter-beams and intra-beam, respectively.After applying SIC technology, the SINR that user nneeds
to decode itself information is given by
γn=Ps∥diag (hn,t)gn,t∥2
2an,t
It+ω∗Ps+σ2. (3)
The SINR of user mto decode the information of itself for
the target beam can be expressed as
γm=Ps∥diag (hm,t)gm,t∥2
2am,t
Ps∥diag (hm,t)gn,t∥2
2an,t+It+ω∗Ps+σ2.(4)
We assume that the interference between active beams
hardly influence the distribution of subcarriers and the order
of decoding signals by users. The achievable rate of user φat
time slot tfor U-NOMA-BH systems can be expressed as
Rφt=X
φ∈(m,n)X
k∈KWβφk
Nlog2(1 +γφt), (5)
where Wrepresents the bandwidth per carrier (multi-carrier
per beam), Nis the total number of subcarriers. βφkis defined
as:
βφk=(
1,userφis assigned at subcarrier k,
0,otherwise;
indicating whether subcarrier kused by user φor not. The
total reachable capacity of NOMA user φis given by
Rφ=X
t∈TRφt. (6)
It is worth pointing out that the U-NOMA-BH systems are
divided into two settings CD-NOMA-BH ( K̸= 1) and PD-
NOMA-BH ( K= 1 ) due to the variation in the number
of subcarriers. For the particular case PD-NOMA-BH, the
optimization of subcarriers will not be considered and equation
(4) degenerates to a single-carrier problem.
III. PROBLEM FORMULATION
A. Problem Formulation
In order to make the actual user satisfaction as high as pos-
sible, we formulate a joint optimization problem to compare
above the user reachable capacity and user demand calculated,
and minimize the gap. The variable of time slot is defined as:
δbt=(
1,beam bis actived at timeslot t,
0,otherwise.
The optimization objective function is solved by jointly op-
timizing time slot t, power factor aφand subcarrier variable
βφk. Let Dφrepresents the request traffic demand of user
φwithin the time slots window. Therefore, we use the well-
known mathematical model (Rφ−Dφ)2to average the con-5
tradictions of users traffic mismatch. The optimization problem
is formulated as
P0: min
δbt,βφk,aφtX
φ∈(M,N)(Rφ−Dφ)2(7a)
s.t.X
b∈Bδbt≤B0,∀t∈ T, (7b)
Rφ≥Rmin
φ,∀φ∈ M,N, (7c)X
k∈Kβφk≤Qδbt,∀t∈ T,∀b∈ B, (7d)
diag 
gm,tgT
n,t
0≥δbt,∀φ∈ M,N,∀t∈ T,(7e)
ant≤amt,∀φ∈ M,N,∀t∈ T, (7f)
where (7b) confines that the total number of active beams
not exceeding B0in any time slot. In (7c), the rate of each
user should satisfy the QoS minimum rate requirement in
order to maintain a certain level of fairness among users.
Constraints (7d) restricts the subcarriers length of user φat
any beam of each time slot to be less than or equal to Q, where
inactive beams are not scheduled subcarriers. Qis defined as
the maximum value of the user φassigned to the subcarriers
in the sparse matrix. To ensure the transmission of paired
NOMA users on the same subcarrier, (7e) is the carrier vector
transpose of user mmultiplied by user nand then the diagonal
element of the result is obtained. By exploiting the vector zero-
norm [37], the number of intersecting non-zeros for users m
andnis made no less than δbt. Considering the fairness of
the users in (7f), the power allocation coefficient of the user n
should be less than the user min each time slot, and the sum
of the power factors of the users in the paired NOMA user
is equal to one. In order to avoid the waste of resources, we
usually make the user φachievable capacity not exceed the
capacity requirement, i.e., Rφ< D φ.
Further analyses show that the optimization objectives in
P0having mutual constraints. When the beam is activated,
the power allocation of NOMA needs to consider the matching
between users, and the subcarriers allocation naturally requires
user pairs to transmit signals on the same subcarrier in a single
beam, which leads to complex design problems. In addition,
it is the problem of power allocation among NOMA users,
where different power allocations will affect the sum of intra-
beam interference. To improve the optimization result, the
change of mutual interference between users is recognized
at the same time slot when subcarriers allocation selects the
subcarrier-channel combination of the largest user. Formulat-
ing a high-quality BH system can effectively improve the
optimal results, where the design of the power and subcarriers
in the multi-dimension is particularly important for the BH
system. When the joint optimization of the three variables
is directly performed, more complex dimensionality problems
will arise. Hence the necessary intra-beam and inter-beams
problems are analyzed to realize an effective U-NOMA-BH
systems separately. The spatial properties of variables are used
for step-by-step design, which simplifies the design difficulty
of the algorithm.B. Subcarrier and Power Optimization in Solving P0
The begin of designing the optimization scheme, we need to
solve the non-convexity of P0. Since the objective function and
the constraints both have nonlinear functions, P0is a nonlin-
ear programming problem. Deciding nonlinear programming
directly is very difficult, so we relax the optimization problem
to solve the MINCP problem. P0has discrete variables in
(7c) and (7d), and still needs to address its non-convexity. We
relax the variables δbtinto continuous variables to reduce the
complexity of the solution.
In the power allocation algorithm, fixing subcarriers allo-
cation is assumed across all users. In general, decoupling
the numerator and denominator are applying to solve non-
convex problems, and Dinkelbach’s transform is still very
competitive in terms of power allocation [45]. Compared with
other solutions, the Dinkelbach’s transform does not divide the
result, but it gives and moves an answer according to a better
solution to approach the optimal way, which is more sufficient
for each judgment. Now turning our attention to problem (7)
again, the target is the optimization of aφtby fixing θφ. In
particular, Rφchanged from fractional format to the following
LR
φ(θφ, aφt) = log {1 +∥diag (hn,t)gn,t∥2
2anζ
+∥diag (hm,t)gm,t∥2
2amζ
+∥diag (hn,t)gn,t∥2
2∥diag (hm,t)gn,t∥2
2a2
n
+∥diag (hn,t)gn,t∥2
2∥diag (hm,t)gm,t∥2
2aman
−θφ[ζ(ζ+∥diag (hm,t)gn,t∥2
2an+ζ)]},(8)
where ζ=It+ω∗P+σ2,θφ>0. Due to the non-convexity
ofP0,LR
φis replaced by Rφto transform the optimization
problem. With fixed θφ,LR
φis a concave function. In each
iteration, the procedures of alternatively update θφandaφt
are discussed, respectively, where θφis updated with opti-
mized power allocation factor. With fixed LR
φ, the optimal θφ
is derived by (10). Thus, the optimization problem can be
formulated as [46]
P1: min
aφtX
φ∈(M,N) 
LR
φ−Dφ2(9a)
s.t. (7e),(7f). (9b)
As a further advance, we assume that the users pair power
within a beam is uniformly distributed. The subcarriers al-
location is optimized within each beam according to (7e)
and (7d). Firstly, subcarriers allocation for CD-NOMA-BH
users is a matching problem of user pairs. The combined user
pairs sharing the same subcarriers have intra-beam interference
with other users due to the sparse matrix. Consequently,
we pair fully orthogonal users in GK×Mwith other users,
which reduces code complexity and intra-beam interference.
Specifically, if MQ≤K, picking gφ,tthat are orthogonal
to each other is indicated to v. Matching user pairs according
tov, selecting gφ′,tandgφ,tto have mutually non-orthogonal6
subcarriers is expressed as

βn1
βnk
...
0

0
βmk
...
βmK
T
⇒
0 0 ··· 1
1βφk··· 0
............
0 0 ···βφ′K

K×M.
(11)
If the users are not satisfied (12), a matching exchange is
performed. Finally, the matched the set of user vandv′are
combined GK×M.
In the Algorithm 1, according to (8) and (11), a joint
optimization scheme of power and subcarriers is designed
through fixed time slots. In the subcarriers optimization
process, a non-orthogonal user groups are defined, and an
orthogonal user that is expected to be matched is searched,
which reduces the number of iterations for direct user pairing.
Compared with exhaustive search, the complexity is reduced
by[M−(K/Q )]!/M!times. In the optimal allocation of the
power factor, the power is optimized using the subcarrier and
user pair clusters obtained above. Based on (8) and (10) we
derive a better solution with the initial value of the power
factor. The power allocation algorithm can find the global
optimal solution, and the need to save the solution has little
effect on the time complexity. The complexity of Algorithm 1
mainly from the circular iterative process and the optimization
of power. To optimize aφt, we adopt the interior point method
to solve the complex P1. The complexity of the interior point
method is defined as O 
ψlog 1
ε
, where ψ >0represents
the parameter for self-concordant barrier and ε > 0is the
precision [47]. In conclusion, the user pairing carrier-based
cycle is B×(B−1)times. Thus, the complexity of Algorithm
1 isO 
N1 
B×(B−1) +N2ψ 
log 1
ε
, where N1and
N2are the maximum number of iterations.
It is worth noting that the optimization of PD-NOMA-BH is
still special. Since the single-carrier transmission with K= 1,
we cannot utilize subcarrier intersection for user pairing. The
set of users is divided according to the order of channel gain,
which can be changed from an exhaustive search of all users to
a match of MandN. Inter-users interference within a beam is
also increased due to a single carrier. Hence the optimization
scheme is more sensitive to interference between users. Then
the PD-NOMA-BH algorithm abandons (7d), (7e) and only
optimizes the power allocation. The problem is formulated as:
P2: min
aφtX
φ∈(M,N) 
LR
φ−Dφ2(12a)
s.t.(7d),(7e), (12b)
ant≤amt,∀φ∈ M,N,(M,N)∈Ω,∀t∈ T.(12c)
C. Optimization of time slots allocation
In this subsection, we apply iterations of users traffic
demands to solve the BH decision problem. The allocation
of time slots is related to the interference between beams.
Assuming that the user channel gain does not change in
each time slot, the interference between beams will cause theAlgorithm 1 Power and Subcarrier joint optimization scheme
Input: flexible θφ
Initialize: time slot, power factor
repeat
fori= 1,2....B
First round: Perform user pairing and select comple-
mentary orthogonal user sets v
Second round: Find orthogonal users between users
according to v
forj= 1:combinations of remaining users
ifgm,tgT
n,t
0≤1
break
else
Identifies as a NOMA user pair
end if
end for
Calculate (7a) to get the user allocation and βφk
end for
Consider βφkas the initial value of subcarrier allocation
in optimizing power.
Update θφby (10)
repeat
Optimize aφtandθφby solving P1
a∗
φt= arg min"
min
aφtP
φ∈(M,N) 
LR
φ−Dφ2#
θ′φ=θ′φ 
a∗
φt
until convergence
Obtain aφt, and replace the initial value of the power factor
until convergence
Obtain aφtandβφkfor a single timeslot
Output: Rφ,aφt
SINR to deteriorate. Given the power factor and subcarrier
assignments derived above, we relax the variable δbtto opti-
mize the time slots assignment. The design of BH turns the
optimization problem into a sub-problem within each time slot.
The remaining demand for user φin time period tis given by
Yφ=Dφ−t−1X
τ=0Rφτ. (13)
SinceP0is MINCP and difficult to calculate, we further relax
δbtinto continuous variables, i.e., 0≤δφt≤1. The resource
allocation problem for the current ttime slot is expressed as
P3: min
δbt,βφk,aφtX
φ∈(M,N) 
LR
φ−Yφ2(14a)
s.t.X
b∈Bδbt≤B0,∀t∈ T, (14b)
X
t∈Tδbt≤T,∀b∈ B, (14c)
X
φ∈(M,N)βφk≤Qδbt,∀t∈ T,∀b∈ B, (14d)
gm,tgT
n,t
0≥δbt∀φ∈ M,N,∀t∈ T, (14e)
ant≤amt,∀φ∈ M,N,∀t∈ T. (14f)7
θφ=h
∥diag (hm,t)gn,t∥2
2an+ζi
∥diag (hn,t)gn,t∥2
2an+h
amζ+∥diag (hn,t)gn,t∥2
2amani
∥diag (hm,t)gm,t∥2
2
ζ
ζ+∥diag (hm,t)gn,t∥2
2an+ζ .(10)
Algorithm 2 Timeslots optimization scheme
Input: aφt,βφk
Optimize aφtby solving P3via Algorithm 1
repeat
fort= 1, . . . . . . , T
Calculate the time slot required by the user φaccording
to the traffic demand Yφ, and mark the beam where it is
located as j
forb= 1, . . . . . . , B
ifδbt(j)>1
δbt(j) =δbt(j)−1
else
The working beam sets will remove the beam jwith
time slot less than 1 and seek the next beam
Yφj= +∞
end if
Select CD-NOMA-BH user pairs via Algorithm 1
end for
Optimize time slot allocation δbtis solved by solving P3
end for
Update Yφby (13)
until convergence
Obtain δbtandβφkby solving P3with the determined time
slot assignment
Output: aφt,δbt,βφk
The algorithm of BH pattern consists of two steps: the
pre-allocation and dynamic allocation of time slots. In the
initial phase, per beam is assigned a time slot to ensure that
time slots are not allocated to user beams that are rarely
requested. After pre-allocation, the dynamic allocation applies
continuous variable δbtto find the set of beams that requires
the least number of time slots, and allocates the current
time slot to the set of beams. The satellites serve users
with the smallest capacity optimized by Algorithm 1 in each
iteration. Specifically, Algorithm 2 works by updating per user
request traffic and continuing the search in the next time slot.
By calculating the total number of time slots to reach the
minimum range, it amplifies user demand so that it is no
longer falsely illuminated. The algorithm terminates and is not
updated when the number of allocated time slots reaches the
time slots window. The method ensures that satisfiable beams
are illuminated within the maximum window, maximizing
user satisfaction and greatly improving the system time slot
utilization.
In general, the algorithm 2 is applied to algorithm
1B×Ttimes, and it has complexity denoted as
O 
N3(B×T)N1 
B×(B−1) +N2ψ 
log 1
ε
, where
N3is the maximum number of time slot optimization iter-
ations. In continuation, the dynamic demand change problemof the above optimization problem is analyzed. To describe the
modification of the user iterative demand difference that may
occur in the optimization process, the following two situations
are required:
•Since the user demand changes with time slot, the pre-
viously obtained traffic demand gap may be changed in
the next time slot.
•Based on discrete variables whose result is 0 or 1 for δbt,
beam-level time slots assignments lead to differences in
the user traffic demands.
IV. P ERFORMANCE ANALYSIS
In this section, we further analyze the NOMA user pairs
within the beam exploiting the CD/PD-NOMA-BH algorithm
previously described. According to the above algorithm, a pair
of users, i.e., user nand user mare selected from BCU and
BEU to carried out NOMA protocol, respectively. To deeply
explore the reliable rate of user services in the BH system, the
outage probabilities of user nand user mfor the target beam
are studied based on the aforementioned algorithm.
A. The Outage Probability of User n
The outage for the user nof BCU can appear in the
following two cases [48]: i) The user ncan only decode its own
signal in NOMA-BH user pair; and ii) The user nsuccessfully
decodes user m’s signal, but fails to decode its own signal after
SIC.
To ensure high quality of service, we introduce the param-
eterκto explain the number of time slots shared by the target
beam and the interference beam in the BH, where the data
rate of user within κmust not be less than the set target rate.
Assuming that target SINR threshold εφ= 2Rφ
W−1, where
Rφis the achievable target rate. An outage event is defined as
the received SINR falls below the target SINR threshold. As a
result, the outage probability of user nin CD/PD-NOMA-BH
systems can be expressed as
PBH
n= 1−Pr (γn→m> εm, γn> εn). (15)
Theorem 1. The closed-form expression for the outage prob-
ability of the investigated user n with ipCSI can be expressed
as in CD-NOMA-BH system
PCD−BH
n,ipCSI =X
b′∈B\{ b}e−Λ1
χK−1X
i=11
i!Λ1
χi
Pavg(b′)κ,(16)
where χ=√Grr
λ
4πdm2√Gt,Ω1=εmω∗
amt−εmant,
Ω2=εnω∗
ant,τ1=εm
ρ(amt−εmant),τ2=εn
ρant,Λ1∆=
max ( τ1+ Ω1, τ2+ Ω2),ρ=Ps/σ2.Pavg(b′)κis the average8
probability of b′inter-beams interference in the direction of the
target beam for κ.
Proof. Considering a two-user in one beam case, the
user m and user n are paired together to perform
NOMA protocol. Supposing ∥diag (hn,t)gm,t∥2
2and
∥diag (hm,t)gn,t∥2
2follow the same distribution for
the satellite links, where ∥diag (hm,t)gm,t∥2
2=
√Grr
λ
4πdm2√GtPK
k=1gmk¯hmk2. It is observed that
Z=PK
k=1gmk¯hmk2is subject to a Gamma distribution
with the parameters of (K,1). The corresponding CDF and
PDF of Zare given by FZ(z) = 1 −e−zPK−1
i=0zi
i!and
fZ(z) =zK−1e−z
(K−1)!, respectively [49]. The probability of
co-channel interference has derived to provide a expression
by [50]
Pavg(b′)κ=1
πr2Z2π
0Zr
0P(b′|ϑ, r)κdϑdr, (17)
where ϑis the pointing direction of the target beam, ris
the radius of the target beam. Pavg(b′)κis evaluated using
a Monte Carlo simulation. The value of b′is determined for
each iteration of the Monte Carlo simulation for κ.
By definition, (15) denotes the complementary event at user
n and is calculated as
PCD−BH
n,ipCSI =1−Pr (γn→m> εm, γn> εn)
=1−X
b′∈B\{ b}Pr
|hn|2>Λ1
×1
πr2Z2π
0Zr
0P(b′|ϑ, r)κdϑdr
=1−X
b′∈B\{ b}Pavg(b′)κZ∞
Λ1f|hn|2(y|b′)dy.(18)
Substituting (3) into (17) and the PDF of Zcan be obtained
and the proof is completed.
Corollary 1. For the special case of ω∗= 0, the closed-form
expression of outage probability for user n with pCSI in CD-
NOMA-BH system can be given by
PCD−BH
n,pCSI =X
b′∈B\{ b}e−Λ2
χK−1X
i=11
i!Λ2
χi
Pavg(b′)κ,(19)
where Λ2∆= max ( τ1, τ2).
Corollary 2. For the special case of K= 1, the closed-form
expression of outage probability for user n with ipCSI/pCSI in
PD-NOMA-BH system can be represented as
PPD−BH
n,ipCSI =X
b′∈B\{ b}e−Λ1
χPavg(b′)κ, (20)
and
PPD−BH
n,pCSI =X
b′∈B\{ b}e−Λ2
χPavg(b′)κ, (21)
respectively.B. The Outage Probability of User m
According to NOMA protocol, the outage event occurs for
user mwhen it is unable to decode its own signal at both
time slots. Thus, the outage probability of user min CD/PD-
NOMA-BH systems can be expressed as
PBH
m= 1−Pr (γm> εm). (22)
Theorem 2. The closed-form expression for the outage prob-
ability of the investigated user m with ipCSI can be expressed
as in CD-NOMA-BH system
PCD−BH
m,ipCSI =X
b′∈B\{ b}Pavg(b′)κe−ω∗εm+τm(amt−εmant)
χ(amt−εmant)
×K−1X
i=11
i!ω∗εm+τm(amt−εmant)
χ(amt−εmant)i
,(23)
where τm=εm
ρ(amt−εmant).
Proof. By definition, (23) denotes outage events. The process
calculated is given by
PCD−BH
m,ipCSI =1−Pr (γm> εm)
=1−X
b′∈B\{ b}Pr
|hn|2> τm
×1
πr2Z2π
0Zr
0P(b′|ϑ, r)κdϑdr
=1−X
b′∈B\{ b}Pavg(b′)κZ∞
τmf|hm|2(y|b′)dy.
(24)
Combining (4), (22) and the PDF of Zcan be obtained and
the proof is completed.
Corollary 3. For the special case of ω∗= 0, the closed-form
expression of outage probability for user m with pCSI in CD-
NOMA-BH can be written as
PCD−BH
m,pCSI =X
b′∈B\{ b}e−τm(amt−εmant)
χ(amt−εmant)
×K−1X
i=11
i!τm(amt−εmant)
χ(amt−εmant)i
Pavg(b′)κ.
(25)
Corollary 4. For the special case of K= 1, the closed-form
expression of outage probability for user m with ipCSI/pCSI
in PD-NOMA-BH system can be given by
PPD−BH
m,ipCSI =X
b′∈B\{ b}e−ω∗εm+τm(amt−εmant)
χ(amt−εmant)Pavg(b′)κ,(26)
and
PPD−BH
m,pCSI =X
b′∈B\{ b}e−τm(amt−εmant)
χ(amt−εmant)Pavg(b′)κ, (27)
respectively.9
C. Diversity Order Analyses
To obtain more sufficient insights, the diversity order is
usually a crucial parameter to evaluate the outage performance,
which expresses the slope of the curves for outage probabilities
varying as SNR changes. Precisely speaking, the diversity
order is defined as
D=−lim
ρ→∞log (P∞(ρ))
logρ, (28)
where P∞(ρ)denotes the asymptotic outage probability at
high SNRs.
Corollary 5. Based on analytical results in (16), (19) and
(28), when ρ→ ∞ , the asymptotic outage probability of user
n with ipCSI/pCSI at high SNR for CD-NOMA-BH system can
be given by
PCD−BH,∞
n,ipCSI ="
1−1
K!Λ1
χK#X
b′∈B\{ b}Pavg(b′)κ,(29)
and
PCD−BH,∞
n,pCSI ="
1−1
K!Λ2
χK#X
b′∈B\{ b}Pavg(b′)κ,(30)
respectively.
Remark 1. Upon substituting (29) and (30) into (28), user
n gets zero diversity order as ipCSI applied, which achieves
the same results as terrestrial NOMA communications. The
diversity orders of the user n with pCSI is K.
Corollary 6. For the special case of K= 1 , based on
analytical result in (20) and (21), when ρ→ ∞ , the asymptotic
outage probability of the user mwith ipCSI/pCSI for PD-
NOMA-BH system can be given by
PPD−BH,∞
n,ipCSI =−Ωn
χ+τn
χX
b′∈B\{ b}Pavg(b′)κ,(31)
and
PPD−BH,∞
n,pCSI =
1−Λ2
χX
b′∈B\{ b}Pavg(b′)κ, (32)
respectively.
Remark 2. Upon substituting (31) and (32) into (28), the
diversity orders of the user n with ipCSI/pCSI are 0 and 1,
respectively.
Corollary 7. Based on analytical results in (23), (25) and
(28), when ρ→ ∞ , the asymptotic outage probability of user
m with ipCSI/pCSI at high SNR for CD-NOMA-BH system can
be given by
PCD−BH,∞
m,ipCSI =X
b′∈B\{ b}Pavg(b′)κ
×(
1−1
K!ω∗εm+τm(amt−εmant)
χ(amt−εmant)K)
,
(33)and
PCD−BH,∞
m,pCSI =X
b′∈B\{ b}Pavg(b′)κ
×(
1−1
K!τm(amt−εmant)
χ(amt−εmant)K)
,(34)
respectively.
Remark 3. Upon substituting (33) and (34) into (28), the
diversity orders of the user m with ipCSI/pCSI for CD-NOMA-
BH system are 0 and K, respectively.
Corollary 8. For the special case in (26) and (27) K= 1,
the asymptotic outage probability of user m with ipCSI/pCSI
at high SNR for PD-NOMA-BH system can be given by
PPD−BH,∞
m,ipCSI =
1−ω∗εm+τm(amt−εmant)
χ(amt−εmant)
×X
b′∈B\{ b}Pavg(b′)κ, (35)
and
PPD−BH,∞
m,pCSI =
1−τm(amt−εmant)
χ(amt−εmant)X
b′∈B\{ b}Pavg(b′)κ,
(36)
respectively.
Remark 4. Upon substituting (35) and (36) into (28), the
diversity orders of the user m with ipCSI/pCSI for PD-NOMA-
BH system are 0 and 1, respectively.
We can observe the above remarks that the CD-NOMA-
BH system have multi-carrier effect and obtain upper di-
versity order than PD-NOMA-BH system. Furthermore, the
constraints of the channel estimation error on the ranking
order are analyzed. Consequently, the design of the carrier and
the excellent channel estimation capability have a prominent
impact on U-NOMA-BH systems.
The relationship between different conditions and diversity
order is expounded in Table I, where we use ”D” to represent
diversity order.
TABLE I: The relationship between different factors for
CD/PD-NOMA-BH systems.
Pairing users NOMA CSI D
The user mCD-NOMA-BHipCSI 0
pCSI K
PD-NOMA-BHipCSI 0
pCSI 1
The user nCD-NOMA-BHipCSI 0
pCSI K
PD-NOMA-BHipCSI 0
pCSI 1
D. Throughput Analyses
The satellite transmits information at a constant rate, and
the system throughput is affected by the outage probability.10
TABLE II: Simulation parameters
Parameter Value
Frequency, ffr11.7 GHz
Bandwidth, W 200 MHz
Satellite covers the ground longitude range [85◦E,115◦E]
Satellite covers the ground Latitude range [−15◦S,15◦N]
Satellite location 101◦E
Satellite altitude 1000 km
Power budget per user-pair, Ps 5 dBW
User receive antenna gain, Gr 42.1 dBi
Satellite transmit antenna gain, Gt 49.6 dBi
Number of time slots, T 32
Number of beams, B 48
Maximum active beams, B0 8,6
Number of users per beam 8
Noise power, σ2-145 dBW
Traffic demand, Dφ 200 Mbps to 1.4 Gbps
Minimum capacity, Rmin
φ 5 Mbps
According to the analytical results derived in the above sub-
section, using (16), (19), (23) and (25) the CD-NOMA-BH
system throughput in the delay-limited mode is expressed as
RCD
TH= 
1−PCD−BH
m
Rm+ 
1−PCD−BH
n
Rn.(37)
Similar to (37), using (20), (21), (26) and (27), the system
throughput of PD-NOMA-BH system is given by
RPD
TH= 
1−PPD−BH
m
Rm+ 
1−PPD−BH
n
Rn.(38)
V. NUMERICAL RESULTS
In this section, We focus on the numerical analysis of the
proposed CD/PD-NOMA-BH systems. In section V-A, the
satellite is designated to cover the equatorial ground region.
The LEO coverage and users demand data are based on
[39, 51]. The satellite parameters and the number of beams
refer to 3GPP TR 38.811 [52]. Note that the objective
valueP
φ∈(M,N)(Rφ−Dφ)2remains consistent with the mini-
mal problem of the objective function in (7a). The number of
simulation results exceeds 1000, where per user traffic demand
is randomly distributed for each simulation. In section V-B, we
utilize Monte Carlo simulation to discuss the results of perfor-
mance analysis for the CD/PD-NOMA-BH systems. Moreover,
BPCU is used to denote bit per channel use. Additionally, the
conventional OMA is regarded as a benchmark for comparison
object. The parameter definitions are summarized in TABLE
II unless stated otherwise.
A. Simulation Results of Optimization
In this subsection, we compare U-NOMA-BH with three
other BH algorithms as follows,
1)Orthogonal multiple access beam hopping (OMA-BH):
The OMA-BH scheme solves P0by Algorithm 2. Since
there is no need for power and subcarriers allocation,(7b) and (7c) only are considered, and a single user of
the beam is analyzed.
2)Maximum SINR beam hopping (Max-SINR-BH ): The
scheme divides the optimization function into sub-
problems in units of each time slot, and decides the
allocation of time slots according to the users maximum
SINR [53]. The Algorithm 1 is still used for optimization
at user level.
3)Periodic beam hopping (P-BH): The scheme adopts
round-robin scheduling of beams [54]. Each beam is
illuminated in turn with the same optimizations for
subcarriers and power.
Fig. 2 plots the performance comparison between proposed
U-NOMA-BH systems and the existing OMA-BH, Max-
SINR-BH and P-BH in the literature. As can be observed that
the U-NOMA-BH systems outperform the other three bench-
marks in controlling the difference between user achievable
rate and traffic demand. When the average traffic demand is
relatively small (less than 450 Mbps), the performance gap
between the OMA-BH system and the proposed U-NOMA-
BH systems is not widen. However, the difference multiple
between U-NOMA-BH and OMA-BH promoting from 0.03
to 0.34 when the demand increases from 450 Mbps to 600
Mbps. This is because that the systems of U-NOMA-BH
optimize the subcarriers and power in a single time slot.
Compared with Max-SINR-BH and P-BH two BH algorithms,
the U-NOMA-BH systems have obvious advantages, which
also reduces the error of resource allocation caused by time
slots allocation. Additionally, the combination of the unified
framework NOMA and BH can effectively improve the users
satisfaction with resource allocation.
400 600 800 1000 1200 1400
Average traffic demand (Mbps)0.511.522.533.5Objective value108
P-BH
Max-SINR-BH
OMA-BH
U-NOMA-BH
Fig. 2: The U-NOMA-BH scheme is compared with the
benchmarks in terms of capacity gap.
Additionally, Fig. 3 plots the system of substituting
the objective value with BCU and BEU respectively in
different cases. To investigate the impact of U-NOMA-
BH systems on user fairness, we transform the ob-
jective functions into min
δbt,βmk,amtP
m∈M(Rm−Dm)2and11
200 300 400 500 600 700 800 900 1000
Average traffic demand (Mbps)123456Objective value108
0
0
0
0
0
0
0
0
Fig. 3: Performance comparison of BCU and BEU based on
different timeslots and number of active beams.
min
δbt,βnk,antP
n∈N(Rn−Dn)2. The performance metrics of BCU
and BEU are analyzed by the impact of changes in the number
of active beams and time slots, where T=32 or 64, and B0=8 or
6. We observe that changeing in time slots and active beams
number have an impact on the objective values for BEU at
350 Mbps, while BCU is at 450 Mbps. At the same time, the
fairness between BCU and BEU are improved by reducing
the number of time slots and active beams. The phenomenon
indicates that the achieved traffic demand is greater than the
constraint objective value.
We take the case of introducing polarization as different
benchmark schemes as follows,
1)1c-U-NOMA-BH : The U-NOMA-BH systems are con-
sidered for full-band reuse, and the users of active beams
in each time slot share a frequency band.
2)2c-U-NOMA-BH : The 2-color scheme introduces right
and left hand circular polarization, which can reduce
the co-channel interference between active beams in
the same time slot. The U-NOMA-BH adopts the 2-
color scheme to reduce inter-beams interference while
ensuring that users have the full bandwidth of the
satellite.
3)4c-U-NOMA-BH : The 4-color scheme introduces fre-
quency multiplexing on the basis of polarization mul-
tiplexing. The combination of U-NOMA-BH and the
4-color scheme makes the inter-beams interference
smaller, but also pays the price of sacrificing the fre-
quency band.
Fig. 4 compares the achievable capacity of the U-NOMA-
BH systems introduced by polarization reuse. The bar graph
reflect the comparison of U-NOMA-BH combined with the
three polarization modes and the user traffic demand. Com-
pared with other schemes, 2c-U-NOMA-BH can better fit the
gap between the user achievable capacity and traffic demand.
The reason for the phenomenon is that 2-color reuse not only
1 2 3 4 5 6 7 8 9 10
User ID050100150200250300350400450500Capacity (Mbps)Average requested demand
1c-CD-NOMA-BH
2c-CD-NOMA-BH
4c-CD-NOMA-BH
1 2 3 4 5 6 7 8 9 10
User ID050100150200250300350400Capacity (Mbps)Average requested demand
1c-PD-NOMA-BH
2c-PD-NOMA-BH
4c-PD-NOMA-BHFig. 4: A research of the achievable capacity of users with
three different polarization reuse methods and users traffic
requirements.
reduces the interference between beams, but also enables users
to achieve the full bandwidth, which fulfills the high-traffic
requirements of users. More particularly, the 2c-CD-NOMA-
BH the performance of users 1 and 7 is outstanding. It shows
that the satisfaction of users is reached. The effect of users 4, 6
and 8 are almost a cliff-like difference in 4c-PD-NOMA-BH.
This shows that there are gaps between different polarization
methods in achieving the satisfaction of users.
As a further advance, Fig. 5 plots the applicability of
the proposed CD-NOMA-BH system for different scenarios.
We can observe that the transmit power is increased, the
gap between the capacity and the traffic request becomes
smaller, which is more suitable for user satisfaction. At the
same time, it can be clearly seen from the figure that the
subcarrier allocation ratio (K/Q )can significantly improve
the performance of the CD-NOMA-BH system with different
comparisons (M, Q, K ). In addition, the result shows that the
performance of the CD-NOMA-BH system is superior as the12
400 600 800 1000 1200 1400 1600 1800
Average traffic demand (Mbps)0.511.522.533.544.55Objective value108
Ps=5,CD-NOMA-BH (8,2,5)
Ps=5,CD-NOMA-BH (8,2,6)
Ps=5,CD-NOMA-BH (8,3,6)
Ps=6,CD-NOMA-BH (8,2,5)
Ps=6,CD-NOMA-BH (8,2,6)
Ps=6,CD-NOMA-BH (8,3,6)
Fig. 5: The comparison of objective value performance of CD-
NOMA-BH with different carrier conditions.
number of assignable subcarriers Qgrows. This means that
the additional intra-beam interference has less impact on the
users achievable capacity, when the CD-NOMA-BH system
can accommodate more active subcarriers.
450 500 550 600 650 700 750 800 850 900 950
Average traffic demand (Mbps)0.511.52Objective value108
CD-NOMA-BH, =0
CD-NOMA-BH, =0.1
CD-NOMA-BH, =0.2
PD-NOMA-BH, =0
PD-NOMA-BH, =0.1
PD-NOMA-BH, =0.2670 680 6901.11.151.2108CD-NOMA-BH, =0
CD-NOMA-BH, =0.1
CD-NOMA-BH, =0.2
PD-NOMA-BH, =0
PD-NOMA-BH, =0.1
PD-NOMA-BH, =0.2
Fig. 6: The objective value versus the average traffic demand
of users with ipCSI/CSI for CD/PD-NOMA-BH systems.
Fig. 6 plots the applicability of the proposed CD/PD-
NOMA-BH systems for different channel estimation errors.
The red and blue lines represent CD-NOMA-BH and PD-
NOMA-BH systems with ipCSI/pCSI, respectively, where
ϖ∗= 0.1,ϖ∗= 0.2are postulated. We observe that the
severe performance deteriorates as the channel estimation error
increasing. This is due to that ipCSI will lead to an overall
addition in users interference and decrease the ability to satisfy
traffic demands. Hence it is crucial to consider the channel
estimation error in practical scenarios for the U-NOMA-BHsystems.
B. Simulation Results of Performance Analysis
Fig. 7 plots the outage probability versus SNR with different
channel error and time slots overlap parameters for CD-
NOMA-BH system. Based on (23) and (25), the CD-NOMA-
BH curves are plotted for different time slots overlap with
respect to ipCSI, where ϖ∗= 0.1,κ= 0.2 T,κ= 0.6 T are
set. The optimal power allocations an= 0.26andam= 0.74
are given according to the optimization algorithm. Apparently,
as the number of time slots overlaps increasing, the interrup-
tion behavior of paired users becomes worse. This is due to the
fact that the variable of time slots overlap mainly comes from
the influence of inter-beams interference. A larger amount of
time slots overlap will lead to increase the uncertainty of inter-
beams interference. For the purpose of comparison, the outage
probability curve with pCSI, i.e., ϖ∗= 0, is adopted as the
benchmark for comparison. It can be observed that the outage
probability of user nandmdecrease as ϖ∗increases. As
a consequence, the practical design of paired NOMA users
within a beam should take into account the channel estimation
error and the time slots overlap inter-beams.
5 10 15 20 25 30 35 40 45 50
SNR (dB)10-410-310-210-1100Outage ProbabilitySimulation
Error Floor
Asymptotic
OMA
User n-pCSI
User m-pCSI
User n-ipCSI
User m-ipCSI=0.6T-0.2T
Fig. 7: The outage probability of CD-NONA-BH system
versus SNR, with Rn= 1 BPCU andRm= 1.5 BPCU .
Fig. 8 plots the effect of channel estimation error in the
case of PD-NOMA-BH system on the outage performance
versus transmission SNR. For the special case of K= 1,
the outage probability curves of the BCU and BEU for PD-
NOMA-BH system are plotted according to (20), (21), (26)
and (27). Furthermore, Monte Carlo simulation curves of BCU
and BEU are plotted for ipCSI/pCSI with different amount of
time slots overlap and coincide with the derived results. It
can be observed that the outage probability of PD-NOMA-
BH system is higher than that of CD-NOMA-BH. The reason
for this phenomenon is that multiple subcarriers can reduce
interference within the beam.
Fig. 9 plots the effect of the considered channel error and
time slots overlap on the system throughput. The red and13
10 20 30 40 50 60
SNR (dB)10-410-310-210-1100Outage ProbabilitySimulation
Error Floor
Asymptotic
OMA
User n-pCSI
User m-pCSI
User n-ipCSI
User m-ipCSI=0.2T
=0.6T
Fig. 8: The outage probability of PD-NOMA-BH system
versus SNR, with Rn= 1 BPCU andRm= 1.5 BPCU .
10 20 30 40 50 60
SNR (dB)00.20.40.60.811.21.41.61.82Sum ThroughputCD-NOMA-BH, ipCSI, =0.6T
CD-NOMA-BH, pCSI, =0.6T
CD-NOMA-BH,  pCSI, =0.2T
PD-NOMA-BH, ipCSI, =0.6T
PD-NOMA-BH, pCSI, =0.6T
PD-NOMA-BH, pCSI, =0.2T
Fig. 9: System throughput of CD/PD-NOMA-BH systems
versus SNR with ipCSI/pCSI.
blue lines represent the system throughput of CD-NOMA-BH
and PD-NOMA-BH, respectively, which is obtained by (37)
and (38). As can be observed that the system throughput of
CD-NOMA-BH is better than that of PD-NOMA-BH. This
is because that CD-NOMA-BH achieves the smaller outage
probabilities. One can observed that the system throughput
still decrease with increasing time slots overlap. The system
throughput of ipCSI that we focus on is weaker than that of
pCSI.
VI. C ONCLUSION
In this paper, the U-NOMA-BH systems are proposed,
where contains an optimized CD/PD-NOMA-BH and the
performance of U-NOMA-BH systems. We propose a resource
allocation problem to minimize the gap between user trafficdemand and achieved capacity by jointly optimizing power
allocation, beam level time slots, and subcarriers allocation.
The results specified that the CD/PD-NOMA-BH algorithm
designed is better than P-BH, OMA-BH and Max-SINR-BH.
In addition, the closed expressions of the outage probabilities
of BCU and BEU have been derived based on the above
optimization algorithm. According to the analysis results, it
has been demonstrated that the outage probability of CD-
NOMA-BH is better than that of PD-NOMA-BH. Finally, the
system throughput in delay-limited modes has been studied.
Numerical results verified the outcome of the analysis. The
diverse scenarios and challenging tasks applying in U-NOMA-
BH systems are able to further provide additional design
optionswhich is a promising future research direction.
REFERENCES
[1] J. Ye, S. Dang, B. Shihada, and M.-S. Alouini, “Space-air-ground in-
tegrated networks: Outage performance analysis,” IEEE Trans. Wireless
Commun. , vol. 19, no. 12, pp. 7897–7912, Dec. 2020.
[2] S. Chen, S. Sun, and S. Kang, “System integration of terrestrial mobile
communication and satellite communicationłthe trends, challenges and
key technologies in B5G and 6G,” china commun , vol. 17, no. 12, pp.
156–171, Dec. 2020.
[3] P. Gu, R. Li, C. Hua, and R. Tafazolli, “Dynamic cooperative spectrum
sharing in a multi-beam LEO-GEO co-existing satellite system,” IEEE
Trans. Wireless Commun. , vol. 21, no. 2, pp. 1170–1182, Feb. 2022.
[4] T. S. Abdu, S. Kisseleff, E. Lagunas, and S. Chatzinotas, “Flexible
resource optimization for GEO multibeam satellite communication sys-
tem,” IEEE Trans. Wireless Commun. , vol. 20, no. 12, pp. 7888–7902,
Dec. 2021.
[5] S. Fu, J. Gao, and L. Zhao, “Collaborative multi-resource allocation
in terrestrial-satellite network towards 6G,” IEEE Trans. Wireless Com-
mun. , vol. 20, no. 11, pp. 7057–7071, Nov. 2021.
[6] S. Zhang, G. Cui, Y . Long, and W. Wang, “Joint computing and
communication resource allocation for satellite communication networks
with edge computing,” china commun , vol. 18, no. 7, pp. 236–252, Jul.
2021.
[7] Z. Ding, Y . Liu, J. Choi, Q. Sun, M. Elkashlan, I. Chih-Lin, and H. V .
Poor, “Application of non-orthogonal multiple access in LTE and 5G
networks,” IEEE Commun. Mag. , vol. 55, no. 2, pp. 185–191, Feb. 2017.
[8] X. Li, M. Zhao, Y . Liu, L. Li, Z. Ding, and A. Nallanathan, “Secrecy
analysis of ambient backscatter NOMA systems under I/Q imbalance,”
IEEE Veh. Technol. Mag. , vol. 69, no. 10, pp. 12 286–12 290, Oct. 2020.
[9] S. C., S. Sahithi, M. S. S. Gayathri, K. K. Spruha, K. S., and J. R., “Fair-
ness index analysis of NOMA over OMA system for B5G applications,”
inWiSPNET 2022 , Chennai, India, 2022.
[10] X. Yue, Z. Qin, Y . Liu, S. Kang, and Y . Chen, “A unified framework for
non-orthogonal multiple access,” IEEE Trans. Commun. , vol. 66, no. 11,
pp. 5346–5359, Nov. 2018.
[11] M. Moltafet, N. M. Yamchi, M. R. Javan, and P. Azmi, “Comparison
study between PD-NOMA and SCMA,” IEEE Trans. Veh. , vol. 67, no. 2,
pp. 1830–1834, Feb. 2018.
[12] K. Deka, A. Thomas, and S. Sharma, “OTFS-SCMA: A code-domain
NOMA approach for orthogonal time frequency space modulation,”
IEEE Trans. Commun. , vol. 69, no. 8, pp. 5043–5058, Aug. 2021.
[13] Y . Han, W. Zhou, M. Zhao, and S. Zhou, “Enabling high order SCMA
systems in downlink scenarios with a serial coding scheme,” IEEE
Access , vol. 6, pp. 33 796–33 809, May 2018.
[14] X. Dai, Z. Zhang, B. Bai, S. Chen, and S. Sun, “Pattern division multiple
access: A new multiple access technology for 5G,” IEEE Wireless
Commun. , vol. 25, no. 2, pp. 54–60, Apr. 2018.
[15] X. Li, J. Li, Y . Liu, Z. Ding, and A. Nallanathan, “Residual transceiver
hardware impairments on cooperative NOMA networks,” IEEE Trans.
Wireless Commun. , vol. 19, no. 1, pp. 680–695, Jan. 2020.
[16] M. Moghimi, A. Zakeri, M. R. Javan, N. Mokari, and D. W. K. Ng, “Joint
radio resource allocation and cooperative caching in PD-NOMA-based
hetnets,” IEEE Trans. Mob. Comput. , vol. 21, no. 6, pp. 2029–2044, Jun.
2022.
[17] F. Liu and M. Petrova, “Performance of proportional fair scheduling
for downlink PD-NOMA networks,” IEEE Trans. Wireless Commun. ,
vol. 17, no. 10, pp. 7027–7039, Oct. 2018.14
[18] X. Liu, X. B. Zhai, W. Lu, and C. Wu, “Qos-guarantee resource
allocation for multibeam satellite industrial internet of things with
NOMA,” IEEE Trans Industr. Inform. , vol. 17, no. 3, pp. 2052–2061,
Mar. 2021.
[19] R. Ge, D. Bian, J. Cheng, K. An, J. Hu, and G. Li, “Joint user pairing
and power allocation for NOMA-based GEO and LEO satellite network,”
IEEE Access , vol. 9, pp. 93 255–93 266, May 2021.
[20] L. Wang, Y . Wu, H. Zhang, S. Choi, and V . C. M. Leung, “Resource
allocation for NOMA based space-terrestrial satellite networks,” IEEE
Trans. Wireless Commun. , vol. 20, no. 2, pp. 1065–1075, Feb. 2021.
[21] T. Zhang, L. Zhang, and D. Shi, “Resource allocation in beam hopping
communication system,” in IEEE/AIAA 37th DASC , London, UK, Sep.
2018, pp. 1–5.
[22] S. Shaohui, H. Liming, and M. Deshan, “Beam switching solutions
for beam-hopping based LEO system,” in VTC2021-Fall , Norman, OK,
USA, Sep. 2021, pp. 1–5.
[23] H. Cai and Y . Wang, “Research on beam hopping technology of satellite
resource management,” in ICSP 2022 , Xi’an, China, Apr. 2022, pp.
1836–1840.
[24] J. Tang, D. Bian, G. Li, J. Hu, and J. Cheng, “Optimization method of
dynamic beam position for LEO beam-hopping satellite communication
systems,” IEEE Access , vol. 9, pp. 57 578–57 588, Apr. 2021.
[25] Z. Lin, Z. Ni, L. Kuang, C. Jiang, and Z. Huang, “Dynamic beam pattern
and bandwidth allocation based on multi-agent deep reinforcement
learning for beam hopping satellite systems,” IEEE Trans. Veh. , vol. 71,
no. 4, pp. 3917–3930, Apr. 2022.
[26] N. J. G. Fonseca and J. Sombrin, “Multi-beam reflector antenna system
combining beam hopping and size reduction of effectively used spots,”
IEEE Antennas Propag Mag , vol. 54, no. 2, pp. 88–99, Apr. 2012.
[27] C. Zhang, X. Zhao, and G. Zhang, “Joint precoding schemes for flexible
resource allocation in high throughput satellite systems based on beam
hopping,” china commun , vol. 18, no. 9, pp. 48–61, Sep. 2021.
[28] B. Koosha, H. J. Helgert, and R. Karimian, “A hybrid beam hopping
design for non-uniform traffic in HTS networks,” in USNC-URSI NRSM ,
Boulder, CO, USA, Jan. 2019, pp. 1–2.
[29] L. Xu, J. Cai, J. Chang, H. Fang, and X. Li, “Joint optimization scheme
based on beam selection and interference cancellation in lens millimeter
wave NOMA systems,” china commun , vol. 19, no. 4, pp. 57–66, Apr.
2022.
[30] Y . Li, Z. Luo, W. Zhou, and J. Zhu, “Benefits analysis of beam
hopping in satellite mobile system with unevenly distributed traffic,”
china commun , vol. 18, no. 9, pp. 11–23, Sep. 2021.
[31] X. Yue, Y . Liu, Y . Yao, T. Li, X. Li, R. Liu, and A. Nallanathan,
“Outage behaviors of NOMA-based satellite network over shadowed-
rician fading channels,” IEEE Trans. Veh. , vol. 69, no. 6, pp. 6818–6821,
Jun. 2020.
[32] A. Wang, L. Lei, A. I. Lagunas, S. Chatzinotas, and Ottersten, “NOMA-
enabled multi-beam satellite systems: Joint optimization to overcome
offered-requested data mismatches,” IEEE Trans. Veh. , vol. 70, no. 1,
pp. 900–913, Jan. 2021.
[33] Z. Gao, A. Liu, C. Han, and X. Liang, “Files delivery and share
optimization in LEO satellite-terrestrial integrated networks: A NOMA
based coalition formation game approach,” IEEE Trans. Veh. , vol. 71,
no. 1, pp. 831–843, Jan. 2022.
[34] N. Wang, F. Li, D. Chen, L. Liu, and Z. Bao, “NOMA-based energy-
efficiency optimization for UA V enabled space-air-ground integrated
relay networks,” IEEE Trans. Veh. , vol. 71, no. 4, pp. 4129–4141, Apr.
2022.
[35] Z. Gao, A. Liu, and X. Liang, “The performance analysis of downlink
NOMA in LEO satellite communication system,” IEEE Access , vol. 8,
pp. 93 723–93 732, May 2020.
[36] M. Jia, Q. Gao, Q. Guo, X. Gu, and X. Shen, “Power multiplexing
NOMA and bandwidth compression for satellite-terrestrial networks,”
IEEE Trans. Veh. , vol. 68, no. 11, pp. 11 107–11 117, Nov. 2019.
[37] T. Li, X. Yue, H. Li, and R. Liu, in IEEE Proc. of International Conf.
on Commun. Technol. (ICCT) .
[38] A. Wang, L. Lei, E. Lagunas, S. Chatzinotas, and A. I. Neira, “Joint
beam-hopping scheduling and power allocation in NOMA-assisted satel-
lite systems,” in IEEE WCNC , Nanjing, China, Apr. 2021, pp. 1–6.
[39] A. Wang, L. Lei, E. Lagunas, A. I. Prez-Neira, S. Chatzinotas, and
B. Ottersten, “Joint optimization of beam-hopping design and NOMA-
assisted transmission for flexible satellite systems,” IEEE Trans. Wireless
Commun. , vol. 21, no. 10, pp. 8846–8858, May 2022.
[40] Y . Couble, C. Rosenberg, E. Chaput, J.-B. Dup, C. Baudoin, and A.-L.
Beylot, “Two-color scheme for a multi-beam satellite return link: Impact
of interference coordination,” IEEE J. Sel. Areas Commun. , vol. 36,
no. 5, pp. 993–1003, May 2018.[41] Z. Yang, J. Cui, X. Lei, Z. Ding, P. Fan, and D. Chen, “Impact of
factor graph on average sum rate for uplink sparse code multiple access
systems,” IEEE Access , vol. 4, pp. 6585–6590, Oct. 2016.
[42] I. Hosoda, T. Kuroda, Y . Ogawa, M. Shimada, M. Kitahara,
M. Nakazawa, Y . Motohashi, and K. Katakami, “Ka band high power
multi-port amplifier (MPA) configured with TWTA for winds satellite,”
inIEEE Proc. of International Vacuum Electron. Conf. (IVEC) , Ki-
takyushu, Japan, May 2007, pp. 1–2.
[43] X. Ma, J. Zhang, Z. Yu, B. Bai, and Q. Mei, “A PAPR-reduction SCMA
codebook design for satellite communication systems,” in IEEE Proc.
of International Conf. on Wireless Commun. Signal Processing (WCSP) ,
Xi’an, China, Oct. 2019, pp. 1–6.
[44] J. Zhang, Q. He, Z. Yu, B. Bai, and M. Zhu, “Low-complexity coherent
iterative receiver for SCMA-based LEO satellite communications,” in
IEEE Proc. of Global Commun. Conf. (GLOBECOM) , Waikoloa, HI,
USA, Feb. 2019, pp. 1–6.
[45] A. Zappone, E. Bjrnson, L. Sanguinetti, and E. Jorswieck, “Globally
optimal energy-efficient power control and receiver design in wireless
networks,” IEEE Trans. Signal Process. , vol. 65, no. 11, pp. 2844–2859,
Jun. 2017.
[46] T. Wang and L. Vandendorpe, “Successive convex approximation based
methods for dynamic spectrum management,” in IEEE Proc. of Inter-
national Commun. Conf. (ICC) , Ottawa, ON, Canada, 2012, pp. 4061–
4065.
[47] L. Dong and J. Tang, “Interior-point method for second-order cone
programming based on a simple kernel function,” in IEEE Proc. of
International Conf. Natural Comput.(CINC) , vol. 1, Wuhan, Sep. 2010,
pp. 85–88.
[48] X. Yue and Y . Liu, “Performance analysis of intelligent reflecting surface
assisted NOMA networks,” IEEE Trans. Wireless Commun. , vol. 21,
no. 4, pp. 2623–2636, Apr. 2022.
[49] Y . Liu, Z. Qin, M. Elkashlan, Y . Gao, and L. Hanzo, “Enhancing the
physical layer security of non-orthogonal multiple access in large-scale
networks,” IEEE Trans. Wireless Commun. , vol. 16, no. 3, pp. 1656–
1672, Jan. 2017.
[50] I. Howitt and Y . Hawwar, “Evaluation of outage probability due to
cochannel interference in fading for a TDMA system with a beam-
former,” in VTC ’98. 48th IEEE , vol. 1, Canada, May 1998, pp. 520–524
vol.1.
[51] F. Wang, D. Jiang, Z. Wang, Z. Lv, and S. Mumtaz, “Fuzzy-CNN
based multi-task routing for integrated satellite-terrestrial networks,”
IEEE Trans. Veh. , vol. 71, no. 2, pp. 1913–1926, Feb. 2022.
[52] 3GPP, “TR 38.811: Study on new radio (NR) to support non-terrestrial
networks,” in 3GPP , techreport , 2019.
[53] J. Lei and M. . Vzquez-Castro, “Multibeam satellite frequency/time
duality study and capacity optimization,” J COMMUN NETW-S KOR ,
vol. 13, no. 5, pp. 472–480, Oct. 2011.
[54] R. Alegre-Godoy, N. Alagha, and M. A. Vzquez-Castro, “Offered
capacity optimization mechanisms for multi-beam satellite systems,” in
IEEE Proc. of International Commun. Conf. (ICC) , Ottawa, ON, Canada,
Jun. 2012, pp. 3180–3184.