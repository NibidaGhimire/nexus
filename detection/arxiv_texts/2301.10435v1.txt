arXiv:2301.10435v1  [cs.IT]  25 Jan 2023ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023 1
Optimal Transmit Power and Channel-Information
Bit Allocation With Zeroforcing Beamforming in
MIMO-NOMA and MIMO-OMA Downlinks
Kritsada Mamat and Wiroonsak Santipach, Senior Member, IEEE
Abstract —In downlink, a base station (BS) with multiple
transmit antennas applies zeroforcing beamforming to tran smit
to single-antenna mobile users in a cell. We propose the sche mes
that optimize transmit power and the number of bits for chann el
direction information (CDI) for all users to achieve the max -min
signal-to-interference plus noise ratio (SINR) fairness. The opti-
mal allocation can be obtained by a geometric program for bot h
non-orthogonal multiple access (NOMA) and orthogonal mult iple
access (OMA). For NOMA, 2 users with highly correlated
channels are paired and share the same transmit beamforming .
In some small total-CDI rate regimes, we show that NOMA can
outperform OMA by as much as 3 dB. The performance gain over
OMA increases when the correlation-coefﬁcient threshold f or
user pairing is set higher. To reduce computational complex ity,
we propose to allocate transmit power and CDI rate to groups
of multiple users instead of individual users. The user grou ping
scheme is based on K-means over the user SINR. We also propose
a progressive ﬁlling scheme that performs close to the optim um,
but can reduce the computation time by almost 3 orders of
magnitude in some numerical examples.
Index Terms —MIMO, NOMA, OMA, zeroforcing beamform-
ing, transmit power allocation, CSI quantization, downlin k, max-
min fairness, geometric program.
I. I NTRODUCTION
Combining multiple-input multiple-output (MIMO) with
non-orthogonal multiple access (NOMA) can support more
users and achieve higher spectral efﬁciency in wireless net -
works than that with orthogonal multiple access (OMA) [1]–
[4, and references therein]. Users in power-domain NOMA
may share the same time/frequency/spatial resource, but ar e
distinguished by proper transmit-power allocation and suc -
cessive interference cancellation (SIC) [1]. However, the gain
from NOMA is traded with additional complexity from su-
perposition coding, power allocation, user clustering, an d
SIC [5]–[7].
In downlink, a base station (BS) with multiple transmit an-
tennas employs zeroforcing beamforming to transmit messag e
signals to all users in a cell. Zeroforcing beamforming from the
This work was supported by the Program Management Unit for Hu man
Resources and Institutional Development, Research and Inn ovation through
the Ofﬁce of National Higher Education Science Research and Innovation
Policy Council (NXPO) under Grant B05F630035. (Corresponding author:
Wiroonsak Santipach.)
K. Mamat is with the Department of Electronic Engineering Te ch-
nology; College of Industrial Technology; King Mongkut’s U niversity
of Technology North Bangkok, Bangkok, 10800, Thailand (ema il: krit-
sada.m@cit.kmutnb.ac.th).
W. Santipach is with the Department of Electrical Engineeri ng; Faculty
of Engineering; Kasetsart University, Bangkok, 10900, Tha iland (email:
wiroonsak.s@ku.ac.th).BS nulls out all multi-user interference when the signal rea ches
mobile users. However, the BS requires current channel stat e
information (CSI) to determine transmit beamforming vecto rs
and user clustering. Users with highly correlated channel
direction information (CDI) are assigned to be in the same
cluster and share the same transmit beamforming [8]–[10].
Assuming perfect CSI, several existing works [11]–[18, and
references therein] studied beamforming design, power all o-
cation, and user clustering for MIMO-NOMA. However, CSI
errors incurred by quantizing with a ﬁnite number of bits or
by estimating the channels can have an adverse effect on the
system performance [8], [19]–[24].
For power-domain MIMO-NOMA, recent works focused
on imperfect CSI or ﬁnite CSI quantization rate in con-
junction with transmit power allocation [19]–[22], [24]–[ 29].
Several studies [19]–[21], [27]–[30] proposed the transmi ssion
schemes that maximize the sum rate of all users. In [21],
power allocation for users sharing the same transmit beam,
was optimized for given imperfect CSI. Both power and CSI
feedback allocations were optimized in [19], [20]. An im-
perfect CSI robust beamforming design and power allocation
for millimeter wave MIMO-NOMA was proposed in [28].
In [29], power allocation and user clustering were proposed . A
beamforming design with power allocation was studied in [30 ]
for satellite transmission. A low complexity power allocat ion
scheme that maximizes the sum rate while ensuring user’s
fairness was proposed in [27].
Other studies examined different objectives besides maxi-
mizing the sum rate. In our previous work [24], the allocatio n
of CDI rates between 2 groups of users was optimized
for a given total CDI rate to attain max-min fairness on
either achievable rate or outage probability. In [22], powe r
allocation and beamforming vectors were jointly optimized
under some outage constraints to maximize the sum of user’s
utility, which is a function of the rate. Eigen beamforming
technique was proposed in [25] to improve the physical layer
security for MIMO-NOMA-based cognitive radio networks
where the power allocation was also optimized. In [26], a
closed-form optimal power allocation was derived with the
objective function being energy efﬁciency of the system in b it-
per-joule. The work [31] applied deep reinforcement learni ng
to allocate power for each vehicular user in MIMO-NOMA
vehicular edge computing system for which the objective was
to minimize long-term power consumption and latency.
For MIMO-NOMA, the number of users sharing a single
beamforming vector can be greater than 2. However, as the
© 2023 IEEE. Personal use of this material is permitted. Perm ission from IEEE must be obtained for all other uses, in any cu rrent or future media, including
reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for r esale or redistribution to servers or lists, or reuse of any
copyrighted component of this work in other works.2 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
number of users increases, the complexity of SIC at the
receivers increases while the sum rate decreases [32]. Thus ,
for this work, we assume that 2 users with highly correlated
spatial channels are paired, and only the user with higher
channel power in the pair, quantizes and feeds CDI back to
the BS. This can reduce the total CDI rate over all users and
is in contrast with [19], [20] in which all users must quantiz e
and send back their CDI. To achieve max-min rate fairness
among all users, the BS must optimize the allocation of CDI
rate and transmit power for users. To reduce the number of
optimizing variables, grouping of user pairs is proposed fo r the
allocation. The proposed user-grouping scheme can support
any number of user groups and hence, generalizes our previou s
scheme [24] in which only 2 groups of users were considered
and only the CDI rate was optimized.
Given the total CDI rate and total transmit power, we
develop a max-min SINR problem optimizing the CDI rate
and transmit power for each user group, and user grouping.
For given grouping of users, we can ﬁnd the optimal CDI
rate and transmit power for all users by solving a geometric
program (GP). To reduce the complexity of ﬁnding solu-
tions, we propose a progressive-ﬁlling scheme that gradual ly
allocates the CDI rate and transmit power for each group
of users. Numerical results show that the progressive ﬁllin g
performs close to the optimum with much less computational
complexity. To further increase the system performance, we
optimize user grouping by applying K-means to cluster user
pairs with similar performance into the same group.
For MIMO-OMA, there is no user pairing and thus, all users
are assigned different transmit beamforming. Since all use rs
must send back CDI to the BS, the total CDI rate for OMA can
be higher than that for NOMA. However, the receiver in OMA
is simpler since SIC at the receivers is not needed. Similar
to MIMO-NOMA, we develop an allocation problem that
maximizes the minimum SINR. To accommodate an arbitrary
number of users, regularized zeroforcing is applied to ﬁnd
transmit beamforming for all users. For systems with a full
load1, we can ﬁnd the optimal CDI rate and transmit power
for each user group, and the optimal regularizing constant f rom
GP. Comparing NOMA and OMA, we ﬁnd that the NOMA
scheme can outperform the OMA scheme by up to 4 dB when
the total CDI rate is small or moderate. As the total CDI rate
increases, the performance gap between the 2 multiple acces s
schemes decreases and for a lighter load, OMA can perform
better than NOMA.
Our contribution in this work can be summarized as follows.
•We derive asymptotic SINR for all users when the number
of BS transmit antennas tends to inﬁnity. The derived
SINR is shown to approximate the actual SINR well when
the system size is large. For MIMO-NOMA downlink,
we found the optimal CDI rate and transmit power for
all users that maximize the minimum of the approximate
SINR. Optimal solutions can be obtained by GP for which
there are many efﬁcient and fast solvers. We propose a
suboptimal progressive ﬁlling scheme that performs close
to the optimum and can reduce the computation time by
1The number of users is equal to the number of transmit antenna s.almost 3 orders of magnitude in some cases. To better
the allocation and increase the system SINR, we propose
to group user pairs with an iterative scheme based on
K-means over all pairs’ SINR.
•For MIMO-OMA, we employ regularized zeroforcing
instead of conventional zeroforcing to accommodate sys-
tems with the number of users greater than that of trans-
mit antennas. For systems with a full load, we can solve
for the optimal CDI rate, transmit power, and regularizing
constant. For systems with arbitrary load, we propose a
suboptimal scheme that alternately solves subproblems.
We compare the performance of OMA and NOMA with
the number of users larger than the number of BS transmit
antennas and ﬁnd that with a higher threshold for user
pairing, NOMA can outperform OMA in all total-CDI
rate regimes.
This paper is organized as follows. Section II introduces th e
channel model, zeroforcing beamforming, CDI quantization ,
and transmit power allocation. In Section III, we derive the
SINR in a large system limit and develop a joint power CDI-
rate allocation problem that maximizes the minimum large-
system SINR. In Section IV, we propose the optimal solution
and the suboptimal solutions obtained from progressive-ﬁl ling
scheme. User grouping, which improves the system perfor-
mance, is proposed in Section V. In Section VI, we propose
the allocation schemes for MIMO-OMA. Numerical results
are presented in Section VII. Finally, we conclude this work
in Section VIII.
II. S YSTEM MODEL
We consider a discrete-time downlink channel in which a
BS withNttransmit antennas transmits message signals to K
single-antenna users. For a link from each transmit antenna to
a user’s antenna, we assume that the signal propagates throu gh
a rich-scattering environment with no line of sight, and tha t
the signal’s delay spread is much smaller than the symbol
period. Thus, a channel impulse response of each link can
be modeled by a single complex Gaussian random variable
with zero mean and unit variance. We assume that transmit
antennas at the BS are placed sufﬁciently far apart that they
are independent from one another. Hence, the channel gains
from all transmit antennas to a user are independent.
For power-domain NOMA, a user near the cell center should
be paired with another user toward the cell edge with a
similar channel direction. Thus, both users can share a tran smit
beamforming, but can be distinguished in the power domain
at a receiver. For pair k, lethk;sdenote an Nt×1channel
vector for the user with a stronger channel or the cell-cente r
user while hk;wdenotes the channel vector for the weaker
user or the cell-edge user. Each entry in a channel vector
corresponds to a channel gain from each transmit antenna
to the user. The correlation between 2 channels follows the
Gauss-Markov model given by [11], [21]
hk;w=ck(ρkhk;s+/radicalBig
1−ρ2
kek) (1)
where0< ck≤1is the degradation factor for pair k,0≤
ρk≤1is the correlation coefﬁcient for pair k, andekis anMAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 3
Nt×1error vector with independent complex Gaussian entries
with zero mean and unit variance. Note that the degradation
factorckis a ratio between the average channel power of
the cell-edge and the cell-center users of pair k. The value
ofckclose to zero indicates that 2 users are far apart from
each other. Otherwise, the 2 users are close to each other. Th e
correlation coefﬁcient ρkis close to 1 if the channels of the 2
users are highly correlated.2Those users could lie in the same
signal direction and hence, their CDI’s are similar. For bet ter
performance, 2 users should be paired if ckis small and ρkis
close to 1. The design of user pairing is important, but is out
of the scope of this work. Some users are not in pairs since
their channels may not be sufﬁciently correlated with other s.
These users are referred to as singletons. Let hldenote an
Nt×1channel vector for singleton or unpaired user l.
For our proposed NOMA schemes in Sections III–V, we
assumeM≤Nttransmit beamforming vectors.3If there exist
M1< M singletons, M1beams are assigned for singletons
and the remaining M−M1beams are for M−M1user
pairs. Hence, the total number of served users denoted by
K=M1+2(M−M1) = 2M−M1. To compute zeroforcing
beamforming vectors and allocate proper transmit power, th e
BS requires current CSI from all singletons and user pairs.
We assume that singletons and pairs feed back their channel
quality information (CQI) referring to /bardblhl/bardbl,/bardblhk;s/bardbl, andck,
∀l,k, to the BS perfectly . For CDI, which requires signiﬁcantly
more quantization bits, each singleton or pair quantizes an d
feeds back its normalized channel vector ¯hl=hl//bardblhl/bardblor
¯hk;s=hk;s//bardblhk;s/bardblwith a ﬁnite number of bits. Let bland
bkbe the number of bits to quantize ¯hlfor singleton land¯hk;s
for pairk, respectively. We assume channels are independent
block fading and the block length is sufﬁciently long that
feeding back CDI is meaningful.
With the quantized CDI, the BS forms the M×Ntmatrix
ˆHwhose rows are transpose of the quantized channel vectors
ˆhm. Zeroforcing beamforming vector for singleton or pair m
is denoted by wm, which is the normalized mth column of the
Nt×Mmatrix given by W=ˆH†(ˆHˆH†)−1. With the set
of transmit beamforming vectors, the BS transmits message
symbolslfor singleton land applies superposition coding to
convey symbols sk;sandsk,wfor strong and weak users of
pairk, respectively. The transmitted symbol
x=√pl/summationdisplay
l∈Swlsl+/summationdisplay
k∈Uwk(√pk;ssk;s+√pk;wsk;w)(2)
wheresl,sk;s, andsk;ware zero-mean unit-variance random
variables, plis transmit power for singleton lwith beam wl,
pk;sandpk;ware transmit power for strong and weak users in
pairksharing beam wk,SandUare sets of beam indices for
singletons and user pairs, respectively. Note that |S|=M1
and|U|=M−M1, andS∩U=∅. In any frequency-
time resource block, 2 users in each pair will interfere with
each other in time, frequency, and spatial domains, but will
be distinguished in the power domain. For transmit power
2Our previous work [24] strictly assumed a perfect channel al ignment
between 2 users for all pairs ( ρk= 1,∀k).
3In Section VI, we apply regularized zeroforcing beamforming. In that case,
the number of transmit beams Mcan be greater than Nt.allocation between 2 users in a pair, we apply the fractional -
transmit power allocation (FTPA) proposed by [33] as follow s
pk;s=c2αk
k
1+c2αk
kpk, (3)
pk;w=1
1+c2αk
kpk, (4)
wherepk=pk;s+pk;w,∀k∈U is the total transmit power for
beamwkandαk≥0is the power decay factor for pair k. If
αk= 0, both users in pair kare allocated equal transmit power
pk;s=pk;w=pk/2. By increasing the decay factor αk, more
power is allocated to the weaker user. This allocation schem e
also enforces the constraint pk;w≥pk;sof ensuring stability
of SIC at the receiver for the stronger user.
The instantaneous signal-to-interference plus noise rati o
(SINR) for singleton lis given by
γl=pl|h†
lwl|2
/summationtext
k/ne}ationslash=lpk|h†
lwk|2+σ2n(5)
whereσ2
ndenotes the power of zero-mean additive white
Gaussian noise. Since the zeroforcing solutions are comput ed
from quantized CDI, singleton lwill suffer from some residual
interference due to quantization error. The interference c an
be reduced if the CDI quantization error is decreased or the
number of bits to quantize the CDI for singleton lis increased.
For the stronger user of pair k, the signal of the weaker user
is decoded ﬁrst, and then that signal is reconstructed and
subtracted from the received signal. With perfect SIC, the
stronger user can decode its signal without any interferenc e
from the weaker user. Hence, an expression for the SINR for
the stronger user of pair kis similar to that for a singleton
and is given by
γk;s=pk;s|h†
k;swk|2
/summationtext
m/ne}ationslash=kpm|h†
k;swm|2+σ2n. (6)
For the weaker user with larger transmit power, its signal is
decoded directly by treating all interfering signals as noi se and
its SINR is given by
γk;w=pk;w|h†
k;wwk|2
/summationtext
m/ne}ationslash=kpm|h†
k;wwm|2+pk;s|h†
k;wwk|2+σ2n.(7)
From (7), we see the additional interference in the denom-
inator, which accounts for intra-pair interference from th e
stronger user in the pair.
We would like to maximize the minimum achievable rate
for all users in the cell to achieve max-min fairness. The
objective can be obtained by optimizing the transmit power
and CDI-quantization bit allocation with a total transmit- power
constraint given by
/summationdisplay
l∈Spl+/summationdisplay
k∈Upk=Ptot (8)
wherePtotis the total transmit power, and a total CDI-
quantization bit constraint is given by
/summationdisplay
l∈Sbl+/summationdisplay
k∈Ubk=Btot (9)4 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
whereBtotis the total number of quantization bits for CDI
or the number of CDI feedback bits from users to the
BS. From (8) and (9), there are 2Moptimizing variables.
Optimizing the power decay factor αkin (3) and (4) will
add another M−M1variables. For systems with a larger
number of BS transmit antennas, the number of optimizing
variables totaling 3M−M1can be large. To lessen the
computational complexity, we propose to approximate the
problem and present suboptimal solutions that perform well
in the subsequent sections.
III. A PPROXIMATE ALLOCATION PROBLEMS
To reduce the number of variables to be optimized, we
group all singletons into the ﬁrst user group since their SIN R
expressions (5) are similar. We assign all singletons with t he
same transmit power pl=P1and the same number of CDI
quantization bits bl=B1,∀l∈ S . For a user pair, its
performance will be dominated by the SINR of the weaker
user in (7), which largely depends on the degradation factor
ckand the channel correlation coefﬁcient ρk. We will later in
Section V propose to group user pairs by theirs SINR. Assume
that there are Ggroups of users, where the ﬁrst group is for
all singletons and the other G−1groups are for user pairs,
and2≤G≤M. LetG(·)be a grouping function whose input
is either an index of a pair or that of a singleton and output is
a group index g,1≤g≤G. We allocate the same resource
to all pairs in the same group. Thus, user pair kin group
g=G(k), will be allocated with transmit power pk=Pgand
a number of bits bk=Bg. After pair grouping, group gis
assumed to consist of Mguser pairs. Hence,/summationtextG
g=1Mg=M
whereM1is the number of singletons.
For the min-max rate fairness, we must allocate transmit
power and CDI bits based on the ergodic rates for all 3 types
of users, which depend on the distribution functions of the
SINR in (5), (6), and (7). Due to the intractability of the
distribution functions of those SINR for any ﬁnite Ntand
M, we approximate the rate by its large-system limit, which
is shown to be a good approximation when the system size is
sufﬁciently large [24], [34], [35]. To analyze the rate or th e
SINR in a large-system limit, we let Nt,M, andKtend to
inﬁnity with ﬁxed ratios ¯K=K/Ntand¯M=M/Nt. By
constraining the total transmit power Ptotto be ﬁnite, as the
number of users K→∞ , we assume that the transmit power
for group gdecreases as follows
PgK→ζgPtotforg= 1,2,...,G, (10)
where0< ζg<1denotes the limiting power fraction of
the total power assigned to each pair of group g. Hence, in a
large-system limit, the total-power constraint (8) conver ges to
G/summationdisplay
g=1ζg¯Mg=¯K (11)where¯Mg=Mg/Ntis the normalized number of user pairs
in group g. For meaningful CDI quantizing, the number of
bitsBgmust increase with the dimension of the CDI, which
isNt. We denote the normalized number of CDI quantization
bits per transmit antenna by ¯Bg=Bg/Nt. Hence, the total-bit
constraint (9) converges to
G/summationdisplay
g=1¯Bg¯Mg=ˆBtot (12)
whereˆBtot=Btot/N2
t. We note that Btotincreases quadrat-
ically with Ntsince both ¯Bgand¯Mgincrease linearly with
Nt.
With the above assumptions and the limits derived by [35],
we can obtain the limiting SINR for all 3 types of users as
follows. For singleton l, asNt→∞ ,
γl→γ∞
l=ζ1(1−¯M)(1−2−¯B1)
¯K/parenleftBig
2−¯B1+σ2n
Ptot/parenrightBig. (13)
Since this expression holds for all singletons, this is why t he
BS should group all singletons together and assign them with
the same transmit power and CDI bits. The limiting SINR (13)
increases with larger power factor ζ1or the normalized bits
¯B1, and with smaller load ¯Mor¯K. The SINR will converge
to 0 when CDI is not available at the BS ( ¯B1= 0), or the cell
is at a full load ( ¯M= 1).
For pair kin group g, the stronger user achieves the
following limiting SINR
γk;s→γ∞
k;s=ζgc2αk
k(1−¯M)(1−2−¯Bg)
¯K(1+c2αk
k)/parenleftBig
2−¯Bg+σ2
n
Ptot/parenrightBig. (14)
Similar to (13), we apply the limits derived by [35] to
obtain (14). In addition to ζgand¯Bg, the SINR for the stronger
user in pair kdepends on the intra-pair power allocation via
the power decay factor αk. Same as (13), the term 2−¯Bgin the
denominator of (14) accounts for the residual interference due
to CDI quantization error. As the CDI becomes more accurate,
both the singleton or the stronger user in a pair will suffer l ess
interference from other users.
For the weaker user in a pair, interference will be relativel y
larger due to additional interference from the stronger use r
and larger interference from other beams. The latter is caus ed
by the difference between the CDI of the weaker user and
that of the stronger. The CDI difference is dictated by the
correlation coefﬁcient ρkin (1), which plays a major role in
the performance of the weaker user. The limiting SINR of
the weaker user in pair kcan also be derived with the limits
in [35] and is given by (15).
Similar to that for the stronger user, the SINR for the weaker
user increases with a larger CDI rate ¯Bg. The SINR also
increases with better channel alignment between 2 users in a
γk;w→γ∞
k;w=ζg(1−¯M)(1−2−¯Bg)
¯K(1+c2αk
k)(c2
k−c2
kρ2
k(1−2−¯Bg))+σ2
n
Ptot)+ζgc4αk
k(1−¯M)(1−2−¯Bg)(15)MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 5
pair (a larger ρk). We note that the last term in the denominator
in (15) can be attributed to the interference from the strong er
user’s signal, which can be reduced by a smaller degradation
factorck. Hence, the performance of a pair that shares the
same beam can be increased by pairing users with a large
channel correlation coefﬁcient ( ρkclose to 1) and a signiﬁcant
difference in CQI ( ckclose to 0).
In a large-system limit, an achievable rate for each user
converges to log2(1 +γ∞)whereγ∞is obtained from
either (13), (14), or (15). We would like to maximize the
minimum rate of all users in the cell given the total CDI-rate
constraint and the total transmit-power constraint. Since the
rate increases monotonically with SINR, we optimize SINR
directly over power fractions {ζg}, normalized CDI bits {¯Bg},
power decay factors {αk}, and grouping function G. The
optimization problem is stated as follows.
max
{ζg},{¯Bg},{αk},Gmin
l∈S,k∈U{γ∞
l,γ∞
k;s,γ∞
k;w} (16a)
subject toG/summationdisplay
g=1ζg¯Mg≤¯K, (16b)
G/summationdisplay
g=1¯Mg¯Bg≤ˆBtot, (16c)
ζg≥0,¯Bg≥0, g= 1,2,...,G, (16d)
αk≥0,∀k∈U, (16e)
G(m) =/braceleftbigg1 : m∈S,
2,3,...,G :m∈U.(16f)
This generalizes the problem considered in our previous
work [24] in which there were only 2 groups, i.e., a group
of all singletons and a group of all pairs, and only ¯B1and
¯B2were optimized. Also, the work in [24] only assumed
perfect channel alignment between the 2 users in any pair or
ρk= 1,∀k∈U. Finding optimal solutions for the clustering
nonlinear problem in (16) is exceedingly complex. Hence, we
will propose a suboptimal solution by dividing the problem
into 2 subproblems. The ﬁrst subproblem is to optimize the
transmit power and the CDI rate with a ﬁxed pair grouping
and the second subproblem is to optimize the grouping of
user pairs with ﬁxed transmit power and CDI rate. We will
consider the ﬁrst subproblem in Section IV and the second
one in Section V.
IV. J OINT TRANSMIT POWER AND CDI-R ATE
OPTIMIZATION
In this section, we assume that the group assignment for
all user pairs is ﬁxed or the grouping function Gis provided.
Hence, problem (16) is simpliﬁed and transformed as follows .
max
{ζg},{¯Bg},{αk}γth (17a)
subject to (16b) ,(16c),(16d),(16e),
γ∞
l≥γth,∀l∈S,(17b)
γ∞
k;s≥γth, γ∞
k;w≥γth,∀k∈U.(17c)
Note that the objective function for problem (17) is the
minimum attainable SINR for all users denoted by γth. Withthe additional SINR constraints (17b) and (17c), the object ive
functions in (17) and (16) are equivalent.
A. Geometric Program
Problem (17) can be converted to a geometric program
(GP) [36], which requires the objective and inequality con-
straints to be posynomial. We substitute (13) into inequal-
ity (17b) and rearrange the inequality to obtain
ζ−1
1β1
1−β1+σ2
n
Ptotζ−1
11
1−β1≤Z (18)
whereβ1/defines2−¯B1andZ/defines1−¯M
¯Kγ th. For¯B1>0(β1<1),
we can expand1
1−β1= 1+/summationtext∞
i=1βi
1. With the expansion of
1
1−β1, (18) can be expressed as a posynomial inequality given
by
σ2
n
Ptotζ−1
1Z−1+/parenleftbigg
1+σ2
n
Ptot/parenrightbigg
ζ−1
1Z−1∞/summationdisplay
i=1βi
1≤1. (19)
Similarly, we can substitute (14) and (15) into (17c) and
obtain 2 posynomial constraints on SINR for stronger and
weaker users of pair kin group ggiven by
ζ−1
gZ−1(1+a−1
k)/bracketleftBigg
σ2
n
Ptot+/parenleftbigg
1+σ2
n
Ptot/parenrightbigg∞/summationdisplay
i=1βi
g/bracketrightBigg
≤1(20)
whereβg/defines2−¯Bgandak/definesc2αk
k, and
/parenleftbigg1−¯M
¯K/parenrightbigg
c2
kakZ−1
+/parenleftbigg
c2
k(1−ρ2
k)+σ2
n
Ptot/parenrightbigg
ζ−1
gZ−1(1+ak)
+/parenleftbigg
c2
k+σ2
n
Ptot/parenrightbigg
ζ−1
gZ−1(1+ak)∞/summationdisplay
i=1βi
g≤1,(21)
respectively. The constraints on total transmit power (16b )
and total CDI rate (16c) can also be converted to posynomial
inequalities given by
G/summationdisplay
g=1¯Mg
¯Kζg≤1, (22)
2−ˆBtotG/productdisplay
g=1β−¯Mg
g≤1. (23)
With the equivalent posynomial constraints, we can rewrite
problem (17) as
min
{ζg},{ak},{βg},ZZ (24a)
subject to (19) ,(22),(23),
(20),(21),∀k∈U,
0< ak≤1,∀k∈U, (24b)
ζg>0,0< βg<1, g= 1,2,...,G,
(24c)
Z >0. (24d)
Problem (24) is not convex due to its posynomial constraints .
However, it is a GP and can be solved efﬁciently by many6 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
readily available software packages, such as MOSEK ,CVXOPT ,
andGGPLAB . One efﬁcient method to solve a GP is to convert
it to a convex problem by logarithmic transformations of
variables and constraint functions [36]. We use MOSEK to
solve (24) and will show the results in Section VII. Let us
denote the optimal solutions for (24) by {ζ∗
g},{a∗
k},{β∗
g},
andZ∗. Hence, the optimal normalized CDI quantization rate
is¯B∗
g=−log2(β∗
g)and the optimal power decay factor for
pairkisα∗
k=−ln(a∗
k)/ln(c2
k), and the minimum SINR for
all users is γ∗
th= (1−¯M)/(Z∗¯K).
Since explicit complexity in polynomial form does not
exist for solving GP [37], we determine the complexity of
problem (24) by the number of optimizing variables and
constraints. There are 2G+M−M1+1 variables, 2K+ 3
inequality constraints, and another 2G+M−M1+1boundary
constraints on the variables. The complexity of solving (24 ) in-
creases with the system size and the number of user groups. To
compare the computational complexity of different schemes ,
we will compare the computation time in Section VII.
B. Progressive-Filling Allocation
To further reduce the complexity of ﬁnding the optimal
resource allocation, we propose to ﬁrst optimize the power
decay factor αkfor all user pairs for a given power factor ζg
and normalized CDI rate ¯Bg, and then allocate ζgand¯Bgfor
all user groups by a progressive-ﬁlling scheme. Progressiv e
ﬁlling has been previously applied to allocate limited reso urce
to nodes in a network to achieve max-min fairness [38].
For pair k, we ﬁrst ﬁnd the power decay factor αk≥
0that maximizes the SINR minimum of the 2 users,
min{γ∞
k;s,γ∞
k;w}.
Proposition 1: For a given ζgand¯Bg, if
2−¯Bg/parenleftbigg
1−c2
k+ζgc2
k(1−¯M)
2ρ2
k¯K/parenrightbigg
≥(ρ−2
k−1)(c2
k+σ2
n
Ptot)+ζgc2
k(1−¯M)
2ρ2
k¯K,(25)
the optimal power decay factor that maximizes the minimum
SINR between the stronger and weaker users of pair kisα∗
k=
0and the minimum SINR for pair kis given by
γ∞
k=ζg(1−¯M)(1−2−¯Bg)
2¯K/parenleftBig
2−¯Bg+σ2
n
Ptot/parenrightBig. (26)
Otherwise, the optimal power decay factor is
α∗
k=ln/parenleftBig/radicalbig
B2
k−4AkCk−Bk/parenrightBig
−ln(2Ak)
ln(c2
k)(27)and the resulting minimum SINR for pair kis given by (28)
where
Ak=c2
k+c2
k/parenleftbiggζg(1−¯M)
¯K−ρ2
k/parenrightbigg
(1−2−¯Bg)+σ2
n
Ptot,(29)
Bk= (1−ρ2
k)/parenleftbigg
c2
k+σ2
n
Ptot/parenrightbigg
−ρ2
k(1−c2
k)2−¯Bg, (30)
Ck=−ρ2
k/parenleftbigg
2−¯Bg+σ2
n
Ptot/parenrightbigg
. (31)
A proof of the proposition is in Appendix A.
From the above proposition, if the allocated CDI rate per
user pair ¯Bgis so low that (25) is true, the optimal power
allocation among the 2 users is uniform ( α∗
k= 0 ). The
resulting SINR for the stronger user will be smaller than tha t
for the weaker user, and will dictate the performance of the
pair. If¯Bgis sufﬁciently large such that (25) is false, the
optimal decay factor is given by (27) and both users achieve
the same SINR given by (28). Also, (27) is likely false for
user pairs with good channel alignment ( ρ2
k≈1) or with a
large CQI gap ( c2
k≈0). For user pairs with those properties,
the optimal power allocation will most likely be nonuniform
(α∗
k>0).
Before progressively allocating the transmit power and CDI
bits for each group, we divide the total power and total bits
into small chunks. Let N(0)
ζandN(0)
Bbe the initial number of
chunks for power and CDI-bit allocations, respectively. Bo th
N(0)
ζandN(0)
Bmust be greater than the number of user groups
G. First, each group will be allocated with the same cumulativ e
power factor of ¯K/N(0)
ζand the same cumulative normalized
bits ofˆBtot/N(0)
B. For group g, the power factor per beam and
normalized bits per beam are set to ζg=¯K/(N(0)
ζ¯Mg)and
¯Bg=ˆBtot/(N(0)
B¯Mg), respectively.
With this initial allocation, we compute the SINR for a
singleton (13) and the SINR for pair kfrom Proposition 1. The
group with the minimum SINR will be allocated an additional
power factor of ¯K/(N(0)
ζ¯Mg). We then recalculate the SINR
of the group with the additional power factor and ﬁnd the
group with the minimum SINR, which will be assigned an
additional chunk of CDI bits. Unlike the power factor, we
propose to allocate the remaining ˆBtot(1−G/N(0)
B)bits as a
geometric sequence of N(0)
B−Gchunks with decay factor
0< δ < 1. Therefore, the chunk size of the normalized
bits in the initial iterations is much larger than that in the
ﬁnal iterations. This is due to the small rate of change of the
SINR for each user with respect to the normalized bits ¯Bg
when¯Bgis close to zero. With too small CDI-bit allocation,
the SINR increase will be tiny and the algorithm will take
a larger number of iterations to converge. Thus, we allocate
larger chunks ﬁrst followed by smaller chunks. With a sum of
γ∞
k=2ζgρ2
k(1−¯M)(1−2−¯Bg)/radicalBig
¯K2(Bk−2Ck)2+4ζgc2
kρ2
k¯K(1−¯M)(1−2−¯Bg)(2−¯Bg+σ2n
Ptot)+¯K(Bk−2Ck)(28)MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 7
the geometric sequence, we can derive the chunk size of the
normalized CDI bits for the ith iteration given by
∆¯Bi=ˆBtot/parenleftBigg
1−G
N(0)
B/parenrightBigg
(1−δ)δi−1
1−δN(0)
B−G(32)
wherei= 1,2,...,N(0)
B−G. After allocating additional CDI
bits, the SINR for the group is re-computed. We then ﬁnd
the group with the minimum SINR to allocate the additional
power factor. Power factors and normalized bits are alterna tely
allocated to the group with the minimum SINR. In other
words, user groups are progressively ﬁlled with both resour ces
until both are exhausted. The allocation at the end is the
solution. We summarize the scheme in Algorithm 1.
Algorithm 1 The proposed progressive-ﬁlling power and CDI
bit allocation.
1:SetN(0)
ζ> G,N(0)
B> G,0< δ <1, andi= 0.
2:Initialize ¯Bg=ˆBtot
N(0)
B¯Mgandζg=¯K
N(0)
ζ¯Mgforg=
1,2,...,G .
3:Compute γ∞
l(ζ1,¯B1),∀l∈ S from (13) and
γ∞
k(ζg,¯Bg),∀k∈U from Proposition 1 where g=G(k).
4:Nζ=N(0)
ζ−G
5:NB=N(0)
B−G
6:Findg∗=G(m∗)wherem∗= argmin m∈S∪Uγ∞
m.
7:whileNζ>0orNB>0do
8:i←i+1
9: ifNζ>0then
10:ζg∗←ζg∗+¯K
N(0)
ζ¯Mg∗
11:Nζ←Nζ−1
12: Re-compute γ∞
g∗(ζg∗,¯Bg∗)from either (13) or Propo-
sition 1.
13: Findg+=G(m+)wherem+= argmin m∈S∪Uγ∞
m.
14: else
15:g+←g∗
16: end if
17: ifNB>0then
18: ¯Bg+←¯Bg++ˆBtot/parenleftbigg
(1−G/N(0)
B)(1−δ)
1−δN(0)
B−G/parenrightbigg
δi−1
19:NB←NB−1
20: Re-compute γ∞
g+(ζg+,¯Bg+)from either (13) or
Proposition 1.
21: Findg∗=G(m∗)wherem∗= argmin m∈S∪Uγ∞
m.
22: else
23:g∗←g+
24: end if
25:end while
26:return¯Bgandζgforg= 1,2,...,G .
Generally, N(0)
ζandN(0)
Bshould be sufﬁciently large that
the achieved minimum SINR is close to the optimum obtained
by GP from Section IV-A. However, as we discussed earlier,
we do not set N(0)
Btoo large to avoid tiny CDI-rate chunks.
From the numerical results in Section VII, N(0)
Bcan be set to
be much smaller than N(0)
ζ.
The complexity of this progressive-ﬁlling scheme depends
on the number of iterations, which is max{N(0)
ζ,N(0)
B}, andthe number of SINR computations, which is N(0)
ζ+N(0)
B−G,
and hence, increases with N(0)
ζandN(0)
B.
V. G ROUPING OF USERPAIRS
In addition to jointly optimizing the power factor and CDI-
bit allocation in Section IV, the minimum SINR can be further
increased by optimizing grouping function G. To improve max-
min fairness, user pairs with similar channel quality shoul d be
grouped together. The optimized grouping can signiﬁcantly
increase the system performance, especially when the numbe r
of groups is large. This motivated us to propose a grouping
scheme shown in Algorithm 2. The scheme applies when the
number of groups G≥3. ForG= 2, we simply group all
user pairs together.
For our proposed scheme, we ﬁrst cluster all pairs into G−1
groups with K-means, which is a well-known method of vector
quantization. Here, we apply one-dimensional K-means over
the SINR of each pair. In each subsequent iteration, we move
the pair with the worst SINR, which is also the system SINR,
from the current group to the group with a lower SINR mean.
We expect the pair will perform better in the next iteration
since it is in a group with a lower SINR mean and will likely
be allocated larger power factor and bit allocation. The sch eme
terminates when there is no pair to move or the SINR increase
∆γis less than threshold ǫγ. Beyond the initial grouping by
K-means, at the most one pair will be moved at each iteration.
Thus, the scheme reduces the likelihood that the grouping
oscillates and does not converge. From the numerical result s,
Algorithm 2 converges within a few iterations.
The complexity of Algorithm 2 depends largely on the
joint power and bit allocation scheme used in line 10 and the
number of iterations, which depends on the threshold ǫγ. The
computational complexity increases greatly if GP is applie d
instead of the progressive ﬁlling.
VI. O RTHOGONAL MULTIPLE ACCESS
In this section, we assume that the system does not pair
users whose spatial channels are highly correlated and henc e,
the system only consists of singletons. To accommodate an
arbitrary number of users, K, the BS with Nttransmit anten-
nas applies regularized zeroforcing beamforming to constr uct
for each user its transmit beamforming vector [39]. Assumin g
ﬂat Rayleigh fading, the channel vector for user nis given by
cnhnwherehnis anNt×1vector whose entries are complex
Gaussian with zero mean and unit variance, 0< cn≤1is
the degradation factor, and n= 1,2,...,K . For a cell-center
user,cnis close to or equal to 1. For a cell-edge user, cn
is small and closer to 0. Since there is no user pairing, the
BS randomly selects Kusers and hence, the channel vectors
corresponding to those users are independent.
Inspired by the proposed scheme in Section V, we group
users with similar degradation factor cninto a group and
allocate resources to each group based on its performance. W e
propose that user lin group gis assigned Bgbits to quantize
its CDI, which will be fed back to the BS. Similar to NOMA
transmission, the BS forms the K×Ntquantized channel
matrixˆHomawhosenth row is a transpose of quantized CDI8 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
Algorithm 2 The proposed user-pair grouping
1:SetG≥3.
2:Initialize ¯Bg= (ˆBtot−¯M1¯B1)/(¯M−¯M1),g=
2,3,...,G .
3:Initialize ζg= (¯K−¯M1ζ1)/(¯M−¯M1),g= 2,3,...,G .
4:Compute γ∞
k,∀k∈U with Proposition 1.
5:Apply K-means to cluster {γ∞
k}intoG−1groups and
obtain the SINR mean for each group.
6:Label the groups with index g= 2,3,...,G by ascending
SINR mean. (The group with label g= 2has the smallest
SINR mean.)
7:Deﬁne functionGwith input pair index k∈U and output
group index g∈{2,3,...,G}, based on the clustering in
line 5 and labeling in line 6.
8:Setγth-old= 0,0< ǫγ≪1, and∆γ=ǫγ+1.
9:while∆γ> ǫγdo
10: GivenˆBtot,¯K, andG(·), solve for ζg, and¯Bg,∀gby
either GP or Algorithm 1.
11: Compute γ∞
l,∀l∈S andγ∞
k,∀k∈U.
12:γth= min l∈S,k∈U{γ∞
l,γ∞
k}.
13: if∃k:γ∞
k=γthandG(k) =g >2then
14: Revise functionGsuch thatG(k) =g−1.
15: end if
16:∆γ=γth−γth-old
17:γth-old←γth
18:end while
19:returnG.
for userndenoted by ˆhn. For the same CDI accuracy, this
scheme will require a much higher total quantization rate th an
the NOMA scheme presented in previous sections since the
number of CDI vectors is generally higher. The BS computes
a regularized zeroforcing beamforming for user ngiven by
vn=VˆhnwhereV= (ˆH†
omaˆHoma+ϕNtI)−1andϕis
a regularizing constant. The regularized zeroforcing vect ors
obtained are semi-orthogonal with one another and hence,
induce less interference. As the CDI becomes more accurate
(asBgincreases), the beamforming vectors become more
orthogonal. Thus, this is an OMA scheme.
We can derive an expression for the SINR for user las
follows
γn=pnc2
n|h†
nvn|2//bardblvn/bardbl2
/summationtext
j/ne}ationslash=npjc2n|h†
nvj|2//bardblvj/bardbl2+σ2n(33)
wherepnis the transmit power for user nandpjis the
interfering power from user j. If usernbelongs in group g,
the base station allocates power pn=ζgPtot/KwherePtotis
the total transmit power and ζgis the power factor for group
g. With the results in [39], we can show that as Nt→∞ ,
γn−γ∞
n→0 (34)
where
γ∞
n=ζg(1−2−¯Bg)(m◦)2a◦
1−m◦(m◦+2)2−¯Bg+(1+m◦)2σ2n/(c2nPtot),
(35)m◦=1
2/radicalBigg/parenleftbigg
1+¯K−1
ϕ/parenrightbigg2
+4
ϕ−1
2/parenleftbigg
1+¯K−1
ϕ/parenrightbigg
,(36)
a◦=/parenleftbigg/radicalbig
¯K+ϕ(1+m◦)√¯K/parenrightbigg2
−1. (37)
The asymptotic SINR in (35) clearly increases with ζg,¯Bg,
and signal-to-noise ratio (SNR) c2
nPtot/σ2
n. For moderate to
largeNt, the asymptotic SINR γ∞
nis shown to be close to
the actual SINR γn[39]. For tractability, we will use the
asymptotic SINR to ﬁnd the optimal sets of power factors
{ζg}and the normalized CDI bits {¯Bg}. To achieve max-min
fairness for this OMA scheme, we would like to solve the
following problem
max
{ζg},{¯Bg},ϕ,Fmin
n=1,2,...,Kγ∞
n (38a)
subject toG/summationdisplay
g=1ζg¯Mg≤¯K, (38b)
G/summationdisplay
g=1¯Mg¯Bg≤ˆBtot, (38c)
ζg≥0,¯Bg≥0, g= 1,2,...,G, (38d)
ϕ >0, (38e)
F:{1,2,...,K}→{1,2,...,G} (38f)
whereFis a user-grouping function. Since γ∞
nmonotonically
decreases with degradation factor cn, the minimum SINR for
groupgis from the user with the minimum c2
nin the group
denoted by
n∗
g= arg min
n:F(n)=gc2
n. (39)
This set of users,{n∗
g}, will determine the resource allocation
for all groups. In this study, we do not directly solve prob-
lem (38), but focus on subproblems that optimize {ζg},{¯Bg},
andϕ, with a given user grouping F. The subproblems are
discussed next.
A. Optimizing ζg,¯Bg, andϕ
The ﬁrst subproblem of (38) is to jointly optimize ζgand
¯Bgfor given regularizing constant ϕand grouping function
F. This subproblem can also be solved by GP. Similar to
problem (17), SINR for all users must exceed a threshold γth.
Equivalently, the minimum SINR for each group γ∞
n∗g≥γth.
With (35), we can rewrite the inequality as follows
1+(1+ m◦)2σ2
n/(c2
n∗
gPtot)
ζg(1−2−¯Bg)a◦+m◦(m◦+2)2−¯Bg
ζg(1−2−¯Bg)a◦≤(m◦)2
γth.
(40)
Deﬁning βg/defines2−¯BgandY/defines(m◦)2
γth, we can rewrite (40)
with posynomials of ζg,βg, andYgiven by
/parenleftBigg
1+(1+m◦)2σ2
n
c2
n∗gPtot/parenrightBigg
(a◦)−1ζ−1
g(1+∞/summationdisplay
i=1βi
g)Y−1
+m◦(m◦+2)(a◦)−1ζ−1(∞/summationdisplay
i=1βi
g)Y−1≤1.(41)MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 9
Similar to problem (24), we can describe this problem so that
the objective and constraints are composed of posynomials o f
the variables to be optimized as shown
min
{ζg},{βg},YY (42a)
subject to (41) , g = 1,2,...,G,
(22) and (23) ,
ζg>0,0< βg<1, g= 1,2,...,G, (42b)
Y >0 (42c)
where (22) and (23) are the constraints on the total power
factor and the total normalized CDI bits, respectively. Hen ce,
problem (42) can be solved by a GP solver.
To further improve the performance, we can optimize reg-
ularizing constant ϕ. The optimal ϕwas derived from [39].
With the optimized ϕ, we re-solve problem (42) to obtain the
new power factor and bit allocations. The 2 subproblems are
alternately solved until the minimum SINR converges. The
steps are summarized in Algorithm 3. We note that the initial
value for ϕin line 1 is the optimal value when CDI is perfect
or¯Bg→∞ while that in line 7 is the optimal value with
quantized CDI [39]. Algorithm 3 terminates when the SINR
difference from the previous iteration is less than thresho ldǫγ.
Algorithm 3 The proposed suboptimal scheme to ﬁnd {ζg},
{¯Bg}, andϕ.
1:Initialize ϕ=¯Kσ2
n
Ptot.
2:Setγth-old= 0,0< ǫγ≪1, and∆γ=ǫγ+1.
3:while∆γ> ǫγdo
4: Solve (42) to obtain {ζg}and{¯Bg}.
5: Compute γ∞
n∗gforg= 1,2,...,G wheren∗
gis obtained
by (39).
6:γth= min
g=1,2,...,Gγ∞
n∗gandgmin= arg min
g=1,2,...,Gγ∞
n∗g
7:ϕ=c2
n∗gminPtot/σ2
n+2−¯Bgmin
1−2−¯Bgmin.
8:∆γ=|γth−γth-old|.
9:end while
10:return{ζg},{¯Bg}, andϕ.
B. Full Load ( ¯K= 1)
Next, we consider a system with a full load or with the
number of users equal to the number of transmit antennas at
the BS. Substitute ¯K= 1 into (36) and (37) to obtain
m◦=1
2/radicalbigg
1+4
ϕ−1
2, (43)
a◦=2m◦+1
(m◦)2. (44)
We let
d= 2m◦+1 =/radicalbigg
1+4
ϕ, (45)
S=1
γth. (46)Substituting (43)-(46) into (40), we can express inequalit y (40)
in terms of posynomials of ζg,βg,d, andSas follows
ζ−1
gS−1(2+d+d−1)/parenleftBigg∞/summationdisplay
i=1βi
g+(1+/summationtext∞
i=1βi
g)σ2
n
4c2
n∗gPtot/parenrightBigg
+ζ−1
gS−1d−1≤1.(47)
For¯K= 1, we can describe a problem that solves for max-min
fairness as follows :
min
{ζg},{βg},d,SS (48a)
subject to (47) , g = 1,2,...,G,
(22) and (23) ,
ζg>0,0< βg<1, g= 1,2,...,G, (48b)
S >0, d >1. (48c)
After solving (48) with GP, the optimized regularizing cons tant
ϕ∗= 4/((d∗)2−1)is obtained along with the optimized power
factors and bit allocations. Thus, ϕdoes not need to be solved
separately.
VII. N UMERICAL RESULTS
In Fig. 1, we compare the large-system SINR for a single-
ton (13), and the stronger user (14) and the weaker user (15)
in a pair with the corresponding SINR for ﬁnite-size systems
obtained by simulation. We consider a system with G= 3,
¯M1= 0.125,¯M2=¯M2= 0.0625 ,¯K= 0.375, and
Ptot/σ2
n= 20 dB. The number of transmit antennas at the
BS is either Nt= 32 or64. For the user pair, degradation
factorck= 0.8, channel correlation coefﬁcient ρk= 0.95,
and the decay factor αk= 5. As expected, SINR for all 3
users increases with the normalized CDI bit rate per antenna
(¯B1for a singleton and ¯B2for a user pair). We see that a
singleton achieves larger SINR γlwhen the CDI rate is high
since it does not share the transmit beam with other users
and therefore, does not suffer additional interference. Wi th a
large power decay factor αk= 5, more power is allocated
for the weak user in the pair and hence, in the small CDI-
rate regimes, SINR for the weak user is larger than that for
the strong user. As the CDI rate increases and the channel
information becomes more accurate, the strong user with SIC
performs better due to more accurate transmit beamforming
and less interference from other users.
As the system size increases from Nt= 32 to64, the
SINR obtained by simulation approaches the large-system
SINR in (13), (14), and (15). In addition to the simulation
for Rayleigh fading channels, we also obtain the simulation
results for millimeter wave (mmWave) channels utilized in
many mobile networks including long-term evolution (LTE)
networks. For this ﬁgure with moderate load ( ¯K= 0.375),
SINR for all 3 users in mmWave channels is a bit smaller
than that in Rayleigh fading, but follows the same trend as
the CDI rate increases. The model for mmWave channels in
this work is from [28] with 20 signal paths and an exponential
power-delay proﬁle. From our numerical study, we ﬁnd that
for a lighter-to-moderate load or a high CDI rate, our large-
system analysis can reasonably approximate the performanc e10 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
of mmWave channels. Thus, the optimized allocation derived
in this work is expected to also work well for systems operate d
in mmWave bands in those applicable regimes.
0 5 10 15
Bg/Nt-10-50510152025SINR (dB)ck = 0.8; ρk = 0.95; αk = 5; SNRtot = 20 dB
Large system
Rayleigh, sim. w/ Nt = 32; M1 = 4; M2 = M3 = 2
Rayleigh, sim. w/ Nt = 64; M1 = 8; M2 = M3 = 4
mmWave, sim. w/ Nt = 64; M1 = 8; M2 = M3 = 4γl
γk;s
γk;w
Fig. 1: SINR for singleton, γl, and that for the stronger user in
pairk,γk;sand the weaker user, γk;wfor ﬁnite-size systems
are compared with the large-system results.
In Fig. 2, we show a plot of γ∞
kobtained from Proposition 1
with varying c2
kandρ2
kfor a system with ¯M= 0.45,¯K= 0.8,
andPtot/σ2
n= 25 dB. If condition (25) applies, the expression
for the SINR for pair k(26) does not depend on c2
kand
ρ2
k. Thus, we see a ﬂat SINR surface. Otherwise, the SINR
expression (28) applies and the SINR decreases with larger c2
k
and smaller ρ2
k.
1
0.91.5γk∞
0.82
0.6M/Nt = 0.45; K/Nt = 0.8; Bg/Nt = 2; ζg = 2.5; SNRtot = 25 dB
ρk22.5
0.7
ck20.4 0.6
0.5
0.2
Fig. 2: A surface plot of γ∞
kobtained from Proposition 1 with
varyingc2
kandρ2
kfor a system with ¯M= 0.45,¯K= 0.8, and
Ptot/σ2
n= 25 dB.
In Fig. 3, we track the minimum SINR obtained from
Algorithm 1 with the number of iterations for systems with 2
groups with M1=M2= 4, and 4 groups with M1=M2=
M3=M3= 4. In the ﬁgure, N(0)
ζ= 500 whileN(0)
Bis set
to either 50, 300, or 600. The minimum SINR of all users
increases with the number of iterations. The maximum of the
minimum SINR is attained when all bit and power chunks
are allocated to the user pairs. The system with 4 groupsachieves lower SINR due to heavier load. From the results
shown, setting N(0)
B= 50 results in the fastest convergence
with about 650 iterations.
0 200 400 600 800 1000 1200
Number of iterations01020304050607080SINR (non-dB)Nt = 32; Btot/Nt2 = 4; SNR = 25 dB
Nz(0) = 600, Nb(0) = 50
Nz(0) = 600, Nb(0) = 300
Nz(0) = 600, Nb(0) = 600
G = 2 w/ M1 = M2 = 4
G = 4 w/ M1 = M2 = M3 = M4 = 4
Fig. 3: The minimum SINR from Algorithm 1 is plotted with
the number of iterations for systems with either G= 2 or
G= 4,Nt= 32 ,ˆBtot= 4,Ptot/σ2
n= 25 dB, andδ= 0.6.
For Fig. 4, we solve problem (24) with GP solver MOSEK
for a system with 4 user groups and Nt= 32 , and obtain
the optimal{α∗
k},{ζ∗
g}, and{¯B∗
g}. For one user pair, the
ratio between the optimal power for strong and weak users,
pk;s/pk;wis plotted with varying squared degradation factor
c2
k. As expected, the weak or the cell-edge user must be
allocated with higher power than the strong or the cell-cent er
user. As the weak user moves toward the cell center ( c2
k
increases to 1), the power assigned to both users becomes
more uniform. We also vary the channel correlation between
2 users and note that the weaker user is allocated with a
higher power fraction as ρ2
kincreases. This is due to stronger
intra-pair interference from the stronger user as both chan nels
become more aligned.
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
ck20.30.40.50.60.70.80.91Pk;s/Pk;wNt = 32; G = 4; Mg = [4,3,4,5]; Btot/Nt2 = 3; SNRtot = 25 dB
ρk2 = 0.8
ρk2 = 0.9
ρk2 = 0.99
Fig. 4: For a given pair, ratio pk;s/pk;wis plotted with c2
kfor
various values of ρ2
k.Nt= 32 ,G= 4,{Mg}={4,3,4,5},
K= 32 ,ˆBtot= 3, andPtot/σ2
n= 25 dB.
For Fig. 5, we consider a system with 2 groups ( G= 2),MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 11
Nt= 32 ,M= 20 , and vary the number of transmit beams
for group 1 or M1(M2=M−M1). A GP in (24) is solved.
The ratio between the optimized CDI rates for the 2 groups is
shown with varying M1/M2in Fig. 5a and the ratio between
the optimized power factors is shown in Fig. 5b. Since both
ratios are less than 1 for all settings shown, we conclude tha t
more resources should be allocated to user pairs instead of
singletons. User pairs must combat the intra-pair interfer ence
in addition to the interference from other users. From Fig. 5 a,
even larger fraction of the total CDI rate should be assigned
to user pairs when the total CDI rate is high or when the
channel alignment between the 2 users in a pair is better ( ρ2
k
close to 1). Since intra-beam interference is strong when ρ2
k
is high, a user pair will require a higher CDI rate to better
suppress inter-beam interference. Hence, with ﬁxed ˆBtot= 1,
¯B∗
1/¯B∗
2decreases with increasing ρ2
k. For Fig. 5b, we ﬁx the
normalized total CDI rate ˆBtot= 3. When the total SNR is
lowered to 10 dB, ζ∗
1/ζ∗
2is smaller. Therefore, an even higher
fraction of the total power should be devoted to user pairs.
AsM1/M2increases with ﬁxed M= 20 , the total number
of usersKdecreases. Due to a lighter load, the interference
among users is reduced. Hence, more resource can be devoted
to user pairs. As a result, the ratio between the resource for
singleton and that for user pair decreases in both Figs. 5a
and 5b.
0 0.5 1 1.5 2 2.5 3 3.5 4
M1/M20.660.670.680.690.70.710.720.73B1*/B2*Nt = 32; G = 2; M = 20; 0.2 ≤ ck2 ≤ 0.6; SNRtot = 25 dB
Btot/Nt2 = 1; 0.8 ≤ ρk2 ≤ 0.85
Btot/Nt2 = 1; 0.8 ≤ ρk2 ≤ 0.9
Btot/Nt2 = 1; 0.8 ≤ ρk2 ≤ 0.95
Btot/Nt2 = 1.5; 0.8 ≤ ρk2 ≤ 0.95
(a)¯B∗
1/¯B∗
2versusM1/M2
0 0.5 1 1.5 2 2.5 3 3.5 4
M1/M20.30.350.40.450.50.550.60.650.7ζ1*/ζ2*Nt = 32; G = 2; M = 20; 0.2 ≤ ck2 ≤ 0.6; Btot/Nt2 = 3
SNRtot = 10 dB; 0.8 ≤ ρk2 ≤ 0.95
SNRtot = 25 dB; 0.8 ≤ ρk2 ≤ 0.85
SNRtot = 25 dB; 0.8 ≤ ρk2 ≤ 0.9
SNRtot = 25 dB; 0.8 ≤ ρk2 ≤ 0.95
(b)ζ∗
1/ζ∗
2versusM1/M2
Fig. 5:Nt= 32 ,G= 2, andM= 20 . For group 2, 0.2≤
c2
k≤0.6andρ2
k≥0.8.
In Fig. 6, we compare the performance of 2 allocationschemes from Section IV. The GP solutions are shown
with blue lines and circular markers and solutions from the
progressive-ﬁlling scheme with Algorithm 1 in conjunction
with Proposition 1 are shown with orange lines and diamond
markers. In Fig 6a, the system SINR increases with a larger
total CDI rate and smaller load as expected. For a lighter loa d
M=M1+M2= 8, the normalized total CDI rate ˆBtotof
approximately 2 is sufﬁcient to achieve close to the maximum
performance. For a larger load, much higher ˆBtotis required.
Although the progressive-ﬁlling scheme is suboptimal, it c an
perform close to the optimal solutions obtained by GP. The
computational complexity measured by the computation time
is shown in Fig 6b. For the same set of parameters, the
progressive ﬁlling in Algorithm 1 is less complex than MOSEK ,
which is the GP solver employed, by more than 2 orders of
magnitude. As the number of users increases, the computatio n
time required for MOSEK steadily increases while that for
Algorithm 1 remains approximately constant.
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
Btot/Nt2-15-10-505101520SINR (dB)Nt = 32; G = 2; SNRtot = 25 dB
GP solver
Progressive fillingM1 = M2 = 10M1 = M2 = 4
(a) Minimum SINR for the system.
0 5 10 15 20 25 30 35 40 45
K10-310-210-1100101Compution timeNt = 32; G = 2; SNRtot = 25 dB
GP solver
Progressive filling
(b) Computation time.
Fig. 6: The SINR comparison between solving (42) with
GP solver MOSEK and Algorithm 1 in conjunction with
Proposition 1 for a system with Nt= 32 andPtot/σ2
n= 25
dB.
Fig. 7 illustrates the performance gain from user grouping
by applying Algorithm 2 in conjunction with Algorithm 1.
For the ﬁgure, the number of singletons is 8 and that of user
pairs is 28 with Nt= 64 . We vary the number of groups
Gfrom 5 (4 groups of user pairs) to 29 (each beam gets
its own optimized power and CDI rate). With increasing G,12 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
the system SINR increases as expected. We see a larger gain
when the total CDI rate is moderate ( ˆBtot≈2.5). The system
gains about 2 dB when Gis increased from 5 to 15 and a
fraction of a dB when Gis increased further to 29. However,
the complexity of ﬁnding these solutions will also increase
withG. Thus, there is a trade-off between the SINR and the
computational complexity.
0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
Btot/Nt2-4-202468101214SINR (dB)Nt = 64; M1 = 8; # of pairs = 28; SNRtot = 25 dB
5 groups
8 groups
15 groups
29 groups
Fig. 7: The system SINR obtained by Algorithm 2 in conjunc-
tion with Algorithm 1 is shown with varying the number of
groups,G.
In Fig. 8, we compare the SINR obtained from the large-
system analysis (35) with that from numerical simulation wi th
Nt= 100 ,¯B= 3,c2
nPtot/σ2
n= 20 dB, and various values of
ϕ. As the load ¯Kincreases, SINR decreases, as expected. For
a lighter load (small ¯K), SINR also decreases substantially
with larger ϕ. We remark that the large-system result gives an
accurate approximation of the simulation result with large Nt.
0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
K/Nt05101520253035SINRBg/Nt = 3; SNRtot = 20 dB
Sim w/ Nt = 100
Large sys.
Regularizing const. = 0.5
Regularizing const. = 1
Regularizing const. = 1.5
Fig. 8: The asymptotic SINR (35) is compared with the SINR
from numerical simulation with Nt= 100 ,¯B= 3,Ptot/σ2
n=
20dB, and varying ϕand¯K.
The performance of OMA schemes described in Section VI
is shown in Fig. 9. For the ﬁgure, we set Nt=K= 32
(¯K= 1), andG= 4. Since¯K= 1, we can directly solve for
both the allocation {ζg}and{¯Bg}, and regularizing constantϕfrom problem (48) with a GP solver. User grouping is based
on the degradation factor ck. The resulting SINR is indicated
by the green line in the ﬁgure. We also apply the suboptimal
scheme from Algorithm 3 and obtain the purple curve with
triangle markers. The SINR from Algorithm 3 is very close
to the optimum. Unlike problem (48), Algorithm 3 can be
applied to systems with arbitrary ¯K. Ifϕis ﬁxed while{ζg}
and{¯Bg}are optimized, the performance loss (the blue curve
with circular markers) is noticeable with a larger total CDI rate
ˆBtot. Finally, the orange curve with diamond markers indicates
the system SINR with uniform power and CDI rate with ﬁxed
ϕ=Kσ2
n/Ptot. The SINR with uniform allocation performs
the worst across all values of ˆBtot.
1 1.5 2 2.5 3 3.5 4 4.5 5
Btot/Nt2-6-4-20246SINR (dB)Nt = 32; M1 = 8; K/Nt = 1; SNRtot = 25 dB
Optimized ζg and Bg ; reg. const. = K/SNRtot
Uniform power and CDI rate
(48) w/ GP solver
Algorithm 3
Fig. 9: The SINR performance with different OMA schemes
for a system with Nt=K= 32 ,G= 4 withM1= 8 and
Ptot/σ2
n= 25 dB.
Fig. 10 compares the performance of the proposed NOMA
scheme from Algorithm 2 with that of the OMA from Al-
gorithm 3 with user grouping based on c2
k. To generate the
degradation factor ckfor this ﬁgure, we assume a cell with
radius of 100 meters and path-loss exponent of 2. The strong
user for pair kis uniformly placed within 50 meters from
the BS while the weak user is uniformly placed at least 60
meters away from the BS. Both NOMA and OMA schemes
are operated with the same system parameters. For Fig. 10a,
K= 142 , which is larger than Nt= 128 while for Fig. 10b,
K= 112 . For the NOMA scheme, we assume a correlation
coefﬁcient between the channels of the strong and weak
users is uniform. We consider user pairing with 2 different
thresholds on the channel correlation. For the ﬁrst setting ,
users are paired only if ρ2
k≥0.7. For the second setting,
ρ2
k≥0.9. From both Figs. 10a and 10b, we see a possible
SINR gain of 3 dB when the threshold for ρ2
kis higher.
With higher correlation between the channels of strong and
weak users in a pair, there is less interference from weaker
users due to more accurate transmit beamforming. Thus, user
pairing is crucial for NOMA. Compared with NOMA, OMA
performs much worse when the total CDI rate is not large.
This can be attributed to more CDI vectors that need to be
quantized for OMA. Thus, with limited CDI rate, the accuracy
of the quantized CDI for OMA is worse than that for NOMA,MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 13
especially when the user load is high (Fig. 10a). However, as
ˆBtotincreases, the SINR gap between OMA and NOMA is
closing.
With fewer number of users in Fig. 10b, OMA can out-
perform NOMA when the total CDI rate is large or when
channel information is highly accurate. In those regimes,
the transmit beams can more precisely cancel interference.
Additionally, there is no intra-beam interference for OMA
users to contend with. In Fig. 10b with K < N t, we are
able to add the performance of a system with conventional
zeroforcing beamforming (regularizing constant ϕ= 0). The
optimized power and bit allocations for that system are also
obtained from Algorithm 3. We note that with the optimized
regularizing constant, the regularized zeroforcing perfo rms
much better than the conventional zeroforcing does, especi ally
when the CDI rate is small or moderate.
From the numerical results shown in Figs. 10a and 10b, we
remark that the optimized NOMA scheme outperforms the
optimized OMA scheme when the number of CDI bits per the
number of transmit antennas squared ( ˆBtot) is between 1 and
4. The SINR gain of NOMA over OMA increases when users
in the NOMA scheme are paired with a higher threshold on
the channel correlation between the strong and weak users.
0 1 2 3 4 5 6 7 8 9 10
Btot/Nt2-15-10-50510SINR (dB)Nt = 128; Mg = [12, 17, 10, 15, 11, 12]; SNRtot = 25 dB
OMA w/ Regularized ZF.
NOMA w/ ρk2 ≥ 0.7
NOMA w/ ρk2 ≥ 0.9
(a)K= 142
0 1 2 3 4 5 6 7 8 9 10Btot/Nt2-15-10-505101520SINR (dB)Nt = 128; Mg = [12, 14, 7, 12, 8, 9]; SNRtot = 25 dB
OMA w/ Regularized ZF.
OMA w/ Conventional ZF.
NOMA w/ ρk2 ≥ 0.7
NOMA w/ ρk2 ≥ 0.9
(b)K= 112
Fig. 10: Performance for NOMA scheme from Algorithm 2
and OMA from Algorithm 3.VIII. C ONCLUSIONS
We have developed a joint transmit-power, CDI-rate, user-
grouping problem for MIMO-NOMA and MIMO-OMA down-
links that maximizes the minimum large-system SINR over
all users. For some joint power and CDI-rate optimization,
the optimal solutions can be obtained by a GP solver. A
suboptimal progressive-ﬁlling scheme was shown to perform
close to the optimum with the computation time cut by almost
3 orders of magnitude. The allocation complexity can be
further decreased by decreasing the number of user groups.
Although the system SINR increases with the number of
user groups, the SINR gain is diminishing. For larger system
SINR, users should be paired if the correlation coefﬁcient i s
sufﬁciently high. Additionally, a larger fraction of the tr ansmit
power should be allocated to user pairs. If the total CDI rate
is low to moderate ( ˆBtotis approximately between 1 and 4),
NOMA generally achieves a larger SINR than OMA does. The
performance gain over OMA increases when users are paired
with a high correlation threshold. On the other hand, OMA
can outperform NOMA when the total CDI-rate is very high
and the correlation threshold for user pairing is low.
In this work, the channel inaccuracy at the BS is attributed t o
limited CDI from mobile users in a frequency-division duple x.
Our results can also be applied to a time-division duplex
(TDD) in which the channel inaccuracy is caused by limited
training from mobile users. For TDD, the number of pilots for
each user pair and singleton must be optimized instead of CDI
bits. However, if the channel reciprocity between uplink an d
downlink is imperfect, the system performance will degrade .
Taking into account imperfect channel reciprocity could be
explored in the future work. Other possible topics include
a distributed joint power and CDI-rate allocation scheme fo r
uplink and learning-based allocation schemes for uplink an d
downlink.
APPENDIX
A. Proof of Proposition 1
From (14) and (15), we see that as αkincreases from 0, γ∞
k;s
decreases, but γ∞
k;wincreases. Larger αkwill lead to allocating
more transmit power to the weaker user, and less power to the
stronger user. Hence, the optimal decay factor that maximiz es
the minimum SINR of the 2 users, is at the intersection
between γ∞
k;sandγ∞
k;wobtained by setting γ∞
k;s=γ∞
k;w. By
substituting (14) and (15) into γ∞
k;s=γ∞
k;wand rearranging
the equation, we obtain the following quadratic equation
Ak(c2αk
k)2+Bkc2αk
k+Ck= 0 (49)
where coefﬁcients Ak,Bk, andCkare given by (29)–(31),
respectively. Since c2αk
kmust be greater than 0, the only
solution for (49) is
c2α∗
k
k=−Bk+/radicalbig
B2
k−4AkCk
2Ak. (50)
Note that AkCk<0. Solving for α∗
kin (50) gives (27). To
obtain the minimum SINR in (28), we substitute c2α∗
k
kshown
above into (14).14 ACCEPTED BY IEEE TRANSACTIONS ON COMMUNICATIONS, 2023
There is no intersection between γ∞
k;sandγ∞
k;wfor allαk>
0or the intersection occurs at αk= 0 if forαk= 0,
γ∞
k;w/vextendsingle/vextendsingle
αk=0≥γ∞
k;s/vextendsingle/vextendsingle
αk=0. (51)
Here,γ∞
k;w> γ∞
k;s,∀αk>0. Hence, the optimal α∗
k= 0.
Evaluating γ∞
k;sandγ∞
k;wwith (14) and (15), respectively at
αk= 0, we obtain
γ∞
k;s/vextendsingle/vextendsingle
αk=0=ζg(1−¯M)(1−2−¯Bg)
2¯K/parenleftBig
2−¯Bg+σ2n
Ptot/parenrightBig (52)
and (53).
Substitute (52) and (53) into (51) to obtain condition (25).
The minimum SINR is that of the stronger user in (52).
REFERENCES
[1] L. Dai, B. Wang, Z. Ding, Z. Wang, S. Chen, and L. Hanzo, “A s urvey of
non-orthogonal multiple access for 5G,” IEEE Commun. Surveys Tuts. ,
vol. 20, no. 3, pp. 2294–2323, 2018.
[2] M. Zeng, A. Yadav, O. A. Dobre, G. I. Tsiropoulos, and H. V . Poor,
“On the sum rate of MIMO-NOMA and MIMO-OMA systems,” IEEE
Wireless Commun. Lett. , vol. 6, no. 4, pp. 534–537, Aug. 2017.
[3] D. Zhang, Y . Liu, Z. Ding, Z. Zhou, A. Nallanathan, and T. S ato,
“Performance analysis of non-regenerative massive-MIMO- NOMA re-
lay systems for 5G,” IEEE Trans. Commun. , vol. 65, no. 11, pp. 4777–
4790, Nov. 2017.
[4] Y . Liu, G. Pan, H. Zhang, and M. Song, “On the capacity comp arison
between MIMO-NOMA and MIMO-OMA,” IEEE Access , vol. 4, pp.
2123–2129, 2016.
[5] G. Nain, S. S. Das, and A. Chatterjee, “Low complexity use r selection
with optimal power allocation in downlink NOMA,” IEEE Wireless
Commun. Lett. , vol. 7, no. 2, pp. 158–161, Apr. 2018.
[6] G. Im and J. H. Lee, “Outage probability for cooperative N OMA systems
with imperfect SIC in cognitive radio networks,” IEEE Commun. Lett. ,
vol. 23, no. 4, pp. 692–695, Apr. 2019.
[7] S. Bisen, P. Shaik, and V . Bhatia, “On performance of ener gy harvested
cooperative NOMA under imperfect CSI and imperfect SIC,” IEEE
Trans. Veh. Technol. , vol. 70, no. 9, pp. 8993–9005, Sep. 2021.
[8] Q. Yang, H. M. Wang, D. W. K. Ng, and M. H. Lee, “NOMA
in downlink SDMA with limited feedback: Performance analys is and
optimization,” IEEE J. Sel. Areas Commun. , vol. 35, no. 10, pp. 2281–
2294, Oct. 2017.
[9] H. He, Y . Liang, and S. Li, “Clustering algorithm based on azimuth in
mmwave massive MIMO-NOMA system,” in IEEE/CIC Int. Conf. on
Commun. in China (ICCC Workshops) , Xiamen, China, Jul. 2021, pp.
118–122.
[10] Z. Ding, Y . Liu, J. Choi, Q. Sun, M. Elkashlan, C.-L. I, an d H. V .
Poor, “Application of non-orthogonal multiple access in LT E and 5G
networks,” IEEE Commun. Mag. , vol. 55, no. 2, pp. 185–191, Feb. 2017.
[11] S. Dhakal, P. A. Martin, and P. J. Smith, “NOMA with guara nteed weak
user QoS: Design and analysis,” IEEE Access , vol. 7, pp. 32 884–32 896,
2019.
[12] J. Ding, J. Cai, and C. Yi, “An improved coalition game ap proach for
MIMO-NOMA clustering integrating beamforming and power al loca-
tion,” IEEE Trans. Veh. Technol. , vol. 68, no. 2, pp. 1672–1687, Feb.
2019.
[13] Z. Xiao, L. Zhu, J. Choi, P. Xia, and X. Xia, “Joint power a llocation
and beamforming for non-orthogonal multiple access (NOMA) in 5G
millimeter wave communications,” IEEE Trans. Wireless Commun. ,
vol. 17, no. 5, pp. 2961–2974, May 2018.
[14] Z. Ding, X. Lei, G. K. Karagiannidis, R. Schober, J. Yuan , and V . K.
Bhargava, “A survey on non-orthogonal multiple access for 5 G networks:
Research challenges and future trends,” IEEE J. Sel. Areas Commun. ,
vol. 35, no. 10, pp. 2181–2195, Oct. 2017.[15] S. Ali, E. Hossain, and D. I. Kim, “Non-orthogonal multi ple access
(NOMA) for downlink multiuser MIMO systems: User clusterin g,
beamforming, and power allocation,” IEEE Access , vol. 5, pp. 565–577,
2017.
[16] Q. Wang and Z. Wu, “Beamforming optimization and power a llocation
for user-centric MIMO-NOMA IoT networks,” IEEE Access , vol. 9, pp.
339–348, 2021.
[17] J. Ding and J. Cai, “Two-side coalitional matching appr oach for joint
MIMO-NOMA clustering and BS selection in multi-cell MIMO-N OMA
systems,” IEEE Trans. Wireless Commun. , vol. 19, no. 3, pp. 2006–2021,
Mar. 2020.
[18] H.-R. Kim, J. Chen, and J. Yoon, “Joint user clustering a nd beamforming
in non-orthogonal multiple access networks,” IEEE Access , vol. 8, pp.
111 355–111 367, 2020.
[19] X. Chen, Z. Zhang, C. Zhong, and D. W. K. Ng, “Exploiting m ultiple-
antenna techniques for non-orthogonal multiple access,” IEEE J. Sel.
Areas Commun. , vol. 35, no. 10, pp. 2207–2220, Oct. 2017.
[20] Z. Tang, L. Sun, L. Cao, S. Qi, and Y . Feng, “Reconsiderin g design
of multi-antenna NOMA systems with limited feedback,” IEEE Trans.
Wireless Commun. , vol. 19, no. 3, pp. 1519–1534, Mar. 2020.
[21] J. Zhang, Y . Zhu, S. Ma, X. Li, and K. K. Wong, “Large syste m
analysis of downlink MISO-NOMA system via regularized zero -forcing
precoding with imperfect CSIT,” IEEE Commun. Lett. , vol. 24, no. 11,
pp. 2454–2458, Nov. 2020.
[22] J. Cui, Z. Ding, and P. Fan, “Outage probability constra ined MIMO-
NOMA designs under imperfect CSI,” IEEE Trans. Wireless Commun. ,
vol. 17, no. 12, pp. 8239–8255, Dec. 2018.
[23] T. M. Hoang, B. C. Nguyen, X. N. Tran, and L. T. Dung, “Outa ge
probability and ergodic capacity of user clustering and bea mforming
MIMO-NOMA relay system with imperfect CSI over Nakagami- m
fading channels,” IEEE Systems Journal , vol. 15, no. 2, pp. 2398–2409,
Jun. 2021.
[24] K. Mamat and W. Santipach, “On optimizing feedback-rat e allocation for
downlink MIMO-NOMA with quantized CSIT,” IEEE Open J. Commun.
Soc., vol. 1, pp. 1551–1570, 2020.
[25] N. Nandan, S. Majhi, and H.-C. Wu, “Beamforming and powe r opti-
mization for physical layer security of MIMO-NOMA based CRN over
imperfect CSI,” IEEE Trans. Veh. Technol. , vol. 70, no. 6, pp. 5990–
6001, Jun. 2021.
[26] X. Wan, E. Li, Z. Wang, and Z. Fan, “Energy-efﬁcient reso urce alloca-
tion for multicarrier NOMA systems with imperfect CSI,” in IEEE Int.
Conf. on Electron. Info. and Commun. Technol. (ICEICT) , Xi’an, China,
Aug. 2021, pp. 823–827.
[27] X. Liu, J. Zhang, and S. Cai, “An optimal power allocatio n scheme in
downlink multi-user NOMA beamforming system with imperfec t CSI,”
inIEEE Int. Conf. on Commun. Syst. (ICCS) , Chengdu, China, Dec.
2018, pp. 99–103.
[28] K. K. Kota and P. Ubaidulla, “Sum-rate maximization in N OMA-based
mmwave analog beamforming under imperfect CSI,” in IEEE Veh.
Technol. Conf. (VTC2021-Spring) , Helsinki, Finland, Apr. 2021, pp. 1–7.
[29] M.-y. Gong and Z. Yang, “The application of antenna dive rsity to NOMA
with statistical channel state information,” IEEE Trans. Veh. Technol. ,
vol. 68, no. 4, pp. 3755–3765, Apr. 2019.
[30] Z. Gao, A. Liu, C. Han, and X. Liang, “Sum rate maximizati on of
massive MIMO NOMA in LEO satellite communication system,” IEEE
Wireless Commun. Lett. , vol. 10, no. 8, pp. 1667–1671, Aug. 2021.
[31] H. Zhu, Q. Wu, X.-J. Wu, Q. Fan, P. Fan, and J. Wang, “Decen tralized
power allocation for MIMO-NOMA vehicular edge computing ba sed on
deep reinforcement learning,” IEEE Internet Things J. , vol. 9, no. 14,
pp. 12 770–12 782, Jul. 2022.
[32] M. Zeng, A. Yadav, O. A. Dobre, G. I. Tsiropoulos, and H. V . Poor,
“Capacity comparison between MIMO-NOMA and MIMO-OMA with
multiple users in a cluster,” IEEE J. Sel. Areas Commun. , vol. 35, no. 10,
pp. 2413–2424, Oct. 2017.
[33] Y . Saito, A. Benjebbour, Y . Kishiyama, and T. Nakamura, “System-level
performance evaluation of downlink non-orthogonal multip le access
(NOMA),” in Proc. Int. Symp. on Personal, Indoor, and Mobile Radio
Commun. (PIMRC) , London, UK, Sep. 2013, pp. 611–615.
γ∞
k;w/vextendsingle/vextendsingle
αk=0=ζg(1−¯M)(1−2−¯Bg)
2¯K(c2
k−c2
kρ2
k(1−2−¯Bg))+σ2
n
Ptot)+ζg(1−¯M)(1−2−¯Bg)(53)MAMAT AND SANTIPACH: OPTIMAL TX POWER AND CHANNEL-INFO BIT A LLOC. WITH ZF BF IN MIMO-NOMA AND MIMO-OMA DOWNLINKS 15
[34] W. Santipach and M. L. Honig, “Capacity of a multiple-an tenna fading
channel with a quantized precoding matrix,” IEEE Trans. Inf. Theory ,
vol. 55, no. 3, pp. 1218–1234, Mar. 2009.
[35] W. Dai, Y . Liu, B. C. Rider, and W. Gao, “How many users sho uld be
turned on in a multi-antenna broadcast channel?” IEEE J. Sel. Areas
Commun. , vol. 26, no. 8, pp. 1526–1535, Oct. 2008.
[36] S. Boyd, S. Kim, L. Vandenberghe, and A. Hassibi, “A tuto rial on
geometric programming,” Optimization and Engineering , vol. 8, no. 67,
pp. 67–127, Apr. 2007.
[37] A. Chassein and M. Goerigk, “Robust geometric programm ing
is co-NP hard,” Dec. 2014, unpublished. [Online]. Availabl e:
http://nbn-resolving.de/urn:nbn:de:hbz:386-kluedo-3 9380
[38] M. A. Mollah, X. Yuan, S. Pakin, and M. Lang, “Rapid calcu lation
of max-min fair rates for multi-commodity ﬂows in fat-tree n etworks,”
IEEE Trans. Parallel Distrib. Syst. , vol. 29, no. 1, pp. 156–168, Jan.
2018.
[39] S. Wagner, R. Couillet, M. Debbah, and D. T. M. Slock, “La rge system
analysis of linear precoding in correlated MISO broadcast c hannels
under limited feedback,” IEEE Trans. Inf. Theory , vol. 58, no. 7, pp.
4509–4537, Jul. 2012.
Kritsada Mamat was born in Suphanburi, Thailand
in 1984. He received the B.Eng. degree in electri-
cal engineering from Burapha University, Chonburi,
Thailand, in 2007, and the M.Eng. and D.Eng.
degrees in electrical engineering from Kasetsart
University, Bangkok, Thailand, in 2010 and 2016,
respectively. After graduation, he joined the De-
partment of Electrical Engineering, Faculty of En-
gineering, Kasetsart University as a Post-Doctoral
Researcher for one year. He is currently an Assis-
tant Professor with the Department of Electronic
Engineering Technology, College of Industrial Technology , King Mongkut’s
University of Technology North Bangkok, Bangkok, Thailand . His research
interest is in optimization techniques for wireless commun ication channels.
Wiroonsak Santipach (Senior Member, IEEE) re-
ceived the B.S. (summa cum laude), M.S., and Ph.D.
degrees all in electrical engineering from Northwest-
ern University, Evanston, Illinois, USA, in 2000,
2001, and 2006, respectively. In 2006, he joined the
Department of Electrical Engineering, Faculty of En-
gineering, Kasetsart University, Bangkok, Thailand,
as a Lecturer and since 2019, he has been a Pro-
fessor. In 2013 and 2019, he was a visiting scholar
at the Institute of Telecommunications, Technische
Universit¨ at Wien, Austria. He has authored 2 books
titled Introduction to Telecommunication Engineering (Ka setsart University
Press, 2016) and Wireless Communications With Limited Feed back (Kasetsart
University Press, 2020), and coauthored more than 40 techni cal papers. His
current interest includes limited feedback in NOMA and MIMO channels,
and deep learning in wireless channels.