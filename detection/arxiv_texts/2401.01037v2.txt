arXiv:2401.01037v2  [math.AG]  9 Sep 2024SCHWARTZ κ-DENSITIES FOR THE MODULI STACK OF RANK 2
BUNDLES ON A CURVE OVER A LOCAL FIELD
ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLISHC HUK
Abstract. Let Bun be the moduli stack of rank 2 bundles with ﬁxed determinant on a
smooth proper irreducible curve Cover a local ﬁeld F. We show how to associate with
a Schwartz κ-density, for Re(κ)≥1/slash.left2, a smooth function on the corresponding coarse
moduli space of very stable bundles. In the non-archimedean case we also prove that the
stack Bun is κ-bounded in the sense of [4, Def. 2.10] for any κ∈C.
1.Introduction
LetCbe a smooth (connected) proper curve over a local ﬁeld Fand letGbe a reductive
group.
Theanalytic Langlands correspondence (that is still only partially understood) is con-
cerned with the study of certain Hecke operators on Schwartz ve ctor spaces associated
with the stack of G-bundles over C(see [10–12], [4] and [5]). Conjecturally, these (com-
muting) operators extend to compact operators on the corresp onding Hilbert space with a
discrete joint spectrum, which is expected to be related to some “G alois side” objects for
the Langlands dual group G∨.
In this paper we study the Schwartz spaces S(BunG,/divides.alt↪ω/divides.alt↪κ)ofκ-densities (where κ∈C)
on the stack Bun GoverF. In the non-archimedean case the Schwartz spaces of algebraic
stacks were introduced in [13] (see also [4] and [5]). In the archimede an case similar
spaces were introduced in [15]. These Schwartz spaces are deﬁne d as inductive limits of
the spacesS(X,/divides.alt↪p∗ω/divides.alt↪κ)H(F)of coinvariants, where [X/slash.leftH]↪BunGis an open substack
withXa smooth variety, p∶X→BunGis the corresponding map, and H≃GLN(in
the archimedean case taking coinvariants involves taking the closur e of the subspace of
elements of the form hv−v).
Recall that a G-bundlePonCis called very stable if there are no nonzero nilpotent
Higgsﬁelds φ∈H0(C,Pg)wherePgis thevector bundle corresponding to Pand theadjoint
representationof G. LetMvs
G⊂BunGdenotethecoarsemodulispaceofverystablebundles.
Then [4, Conjecture 3.5(1)] states in particular that for Re (κ)≥1/slash.left2, every Schwartz κ-
density inS(BunG,/divides.alt↪ω/divides.alt↪κ)deﬁnes in a natural way a smooth κ-density on Mvs
G(F). The
main result of the present paper is a proof of this Conjecture in the case whenG=SL2in
both archimedean and non-archimedean cases.
D.K. is partially supported by the ERC grant 101142781. A.P. is partia lly supported by the NSF
grants DMS-2001224 and DMS-2349388, by the Simons Travel gra nt MPS-TSM-00002745, and within the
framework of the HSE University Basic Research Program.
12 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLISH CHUK
Namely, for each line bundle L0onC, we consider the stacks Bun L0of rank 2 bundles
Ewith det(E)≃L0(for trivial L0this is exactly Bun SL2), and the open DM-substack
of very stable bundles Mvs
L0⊂BunL0, which is dense if Chas genusg≥2. The stack
Mvs
L0is a quotient of a smooth variety Mvs
L0by the trivial action of µ2(soMvs
L0is also the
coarse moduli space of Mvs
L0). We prove that for Re (κ)≥1/slash.left2, for ﬁnite type substacks
[X/slash.leftG]⊂BunL0(withG=GLN), the integrals of Schwartz κ-densities on X(F)overF-
points of very stable G-orbits are absolutely convergent (away from a subset of orbits o f
measure zero) and deﬁne a map
πκ∶S(BunL0,/divides.alt↪ω/divides.alt↪κ)→C∞(Mvs
L0,/divides.alt↪ω/divides.alt↪κ),
where in the non-archimedean case the class C∞consists of locally constant sections. More
precisely, weconsiderpush-forwardsofSchwartz κ-densitieson X(F)(restrictedtothevery
stable locus) to Mvs
L0in the sense of distributions, and prove that the obtained distribut ions
are of class C∞(see Theorem 6.8).
In addition, in the non-archimedean case we prove a certain bounde dness result (an-
nounced in [4]), Theorem 6.9, stating that in the Schwartz spaces S(BunL0,/divides.alt↪ω/divides.alt↪κ)one can
replace Bun L0by a substack of ﬁnite type.
Note that in [10] the authors consider in the archimedean case anot her Schwartz space
of half-densities on Bun Gdeﬁned using global (twisted) diﬀerential operators on Bun G.
Conjecturally their space should coincide with the space S(BunG,/divides.alt↪ω/divides.alt↪1/slash.l⟩ft2)used in our paper.
This is related to the conjectural statement that the image of π1/slash.l⟩ft2is inL2(an archimedean
analog of [4, Conj. 3.5(3)]).
Thepaper isorganizedasfollows. InSection 2, wegathernecessar y factsaboutSchwartz
spaces. In the archimedean case we refer to results from [1], [3] a nd [2]. We extend some
of these results to the case of Schwartz sections depending holom orphically on a complex
parameter. In Section 3, we prove a slight extension of [7, Thm. 6.9 ], which gives acriterion
for an element of the Schwartz coinvariants space to come from an invariant open subset.
In Section 4 we prove a similar surjectivity criterion in the archimedea n case, Theorem 4.1,
which is an extension of [2, Thm. B.0.2] and is proved in a similar way. In Se ction 5 we
apply the results of Sections 3 and 4 to study the push-forwards o f Schwartz κ-densities
on aG-varietyXtoU0/slash.leftG, whereU0⊂Xis an open subset such that G-acts freely on U0
and the geometric quotient U0/slash.leftGexists. The main results are Lemma 5.2 and Lemma 5.4
which compare properties of such push-forwards for Schwartz κ-densities on Xand on a
G-invariant open subset U⊂X. In Section 6, we apply these results to the stacks Bun L0
and their natural ﬁltration by substacks Bun≤n
L0(see 6.1). The main additional ingredient
(which is hardtogeneralize to thecase ofhigher rank) isﬁnding anex plicit formof possible
specializations of very stable bundles (see Sec. 6.2). The main result s, Theorems 6.8 and
6.9 are proved in Sec. 6.3.
Acknowledgment . We thank Pavel Etingof for help with the proof of Lemma 5.3.SCHWARTZ κ-DENSITIES 3
2.Schwartz spaces
2.1.Schwartz spaces for varieties. LetFbe a local ﬁeld. We denote by /divides.alt↪⋅/divides.alt↪∶F∗→C∗
the standard absolute value (so for F=Cwe have/divides.alt↪z/divides.alt↪=zz, and for a non-archimedean
ﬁeld,/divides.alt↪a/divides.alt↪=q−v(a), whereqis the number of elements in the residue ﬁeld).
For any smooth F-varietyX, an (algebraic) line bundle LoverX, and a continuous
characterχ∶F∗→C∗we have the corresponding complex line bundle LχoverX(F).
In particular, for κ∈Cwe denote by/divides.alt↪L/divides.alt↪κthe complex line bundle corresponding to the
characterχ(a)=/divides.alt↪a/divides.alt↪κ. Note that for a non-archimedean ﬁeld F, the topological space X(F)
is anl-space1, and the transition functions of /divides.alt↪L/divides.alt↪κare locally constant.
For example, if ωXis the algebraic line bundle of top forms on Xthen/divides.alt↪ωX/divides.alt↪is the line
bundle of complex densities on X(F).
Assume ﬁrst that Fis non-archimedean. Then we can deﬁne Schwartz spaces of line
bundles on X(F). More generally, if Xis anl-space and Lis a complex line bundle on
X(so the transition functions of Lare are locally constant), we denote by C∞(X,L)the
space of locally constant sections, and deﬁne the Schwartz subsp aceS(X,L)⊂C∞(X,L)
as sections with compact support. These deﬁnitions also make sens e for arbitrary sheaves
ofC-vector spaces (see [6, Sec. 1.3] and Sec. 3.2 below).
Now consider the archimedean case, F=CorR. Recall that for any smooth variety X
overF, Aizenbud and Gourevitch deﬁne in [1] the space S(X)of Schwartz functions on
X(F)(which agrees with the standard Schwartz space in the case X=An). They also
deﬁne the space of tempered functions T(X), which are smooth functions fsuch that
for any aﬃne open U⊂Xand a polynomial diﬀerential operator DonU, the function
D(f/divides.alt↪U)grows at most polynomially. An important property of tempered fun ctions is that
forf∈T(X), one hasf⋅S(X)⊂S(X). Note that for any open embedding U↪Xthere
is a natural linear embedding S(U)→S(X).
Now letVbe an algebraic vector bundle over X,L1andL2are algebraic line bundles,
andκ∈C. We consider the corresponding complex vector bundle
Eκ∶=V⊗F/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪
overX(F). We denote by C∞(X,Eκ)the space of smooth sections.
Similarly to [1] we can deﬁne the Schwartz subspace S(X,Eκ)⊂C∞(X,Eκ). Note that
Eκis not a Nash bundle, so the deﬁnitions of [1] do not directly apply. How ever, we can
still mimic the deﬁnition of [1] by choosing a ﬁnite open covering (Ui)such thatV/divides.alt↪Ui,
L1/divides.alt↪UiandL2/divides.alt↪Uiare trivial and considering the linear span of the spaces of C∞-sections of
Eκcoming from the Schwartz sections of the trivial bundles Eκ/divides.alt↪UioverUi(see Deﬁnition
2.2 below for a similar deﬁnition with holomorphic dependence on κ). One can show that
the usual properties still hold for the obtained Schwartz spaces S(X,Eκ)using tempered
partitions of unity (see [1, Thm. 5.2.1]) and the fact that the transit ion functions of Eκare
tempered.
1This means that it is locally compact, Hausdorﬀ, and every point has a basis of compact open
neighborhoods.4 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLISH CHUK
2.2.Schwartz sections with holomorphic dependence on a paramet er.LetXbea
smooth variety over F. We can deﬁne Schwartz functions on Xdepending holomorphically
onκ∈C. LetD⊂Cbe an open region.
Deﬁnition 2.1. We deﬁneShol(X×D)as the space of holomorphic functions on Dwith
values inS(X). By deﬁnition, these are functions f∶D→S(X), such that for every
continuous linear functional (any functional if Fis non-archimedean) ϕ∶S(X)→Cthe
functionϕ○fis holomorphic.
Note that if fis a tempered function on X(F)(locally constant in the non-archimedean
case), then we have a well deﬁned continuous operator on Shol(X×D)given byϕ(x,κ)↦
f(x)⋅ϕ(x,κ).
We can also talk about Schwartz sections of the trivial bundle over X, depending holo-
morphically on a parameter κ∈D(and this notion does not change under a tempered
change of trivializations).
It is known that in the archimedean case,
Shol(X×D)≃S(X)ˆ⊗H(D), (2.1)
whereH(D)is the space of holomorphic functions on D, andˆ⊗is the topological tensor
product of nuclear spaces (see [14, ch.II, §3, n.3, Ex.2,3]).
In the non-archimedean case we have instead
Shol(X×D)≃S(X)⊗H(D).
Next, we want to consider Schwartz sections of nontrivial vector bundles. Assume ﬁrst
thatF=RorC. As before, let Vbe an algebraic vector bundle over X,L1andL2are
algebraic line bundles, and
Eκ∶=V⊗F/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪,
whereκ∈C.
Then we can deﬁne Schwartz sections of Eκ. depending holomorphically on κ∈D.
Deﬁnition 2.2. We deﬁneShol(X×D,Eκ)as the space of smooth sections of Eκover
X×D, lying in the image of
/uni2295.big.disp
iShol(Ui×D,Eκ/divides.alt↪Ui)→C∞(X×D,Eκ)
for some open covering (Ui)ofXsuch thatV/divides.alt↪UiandL1/divides.alt↪Ui,L2/divides.alt↪Uiare trivial.
The existence of tempered partition of unity shows that this deﬁnit ion does not depend
on a choice of an open covering.
IfFis non-archimedean, we can give an analogous deﬁnition for the Schw artz space
Shol(X×D,/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪)(i.e., for trivial V).
Note that if U⊂Xis Zariski open then we have a natural embedding (extension by
zero),
Shol(U×D,Eκ)→Shol(X×D,Eκ).
Also, for every κ∈Dwe have a continuous map
Shol(X×D,Eκ)→Shol(X,Eκ)SCHWARTZ κ-DENSITIES 5
given by the evaluation at κ.
Lemma 2.3. Letf∶Y→Xbe a smooth morphism of algebraic varieties, surjective on
F-points, and let E′κ=f∗Eκ⊗/divides.alt↪ωf/divides.alt↪(in the nonarchimedean case we assume Vto be trivial).
Then for each D, the integration map
f∗∶Shol(Y×D,E′
κ)→Shol(X×D,Eκ)
is surjective.
Proof.Let us give a proof for archimedean F. The non-archimedean case is analogous but
simpler. By the partition of unity, the assertion is local in X, so we can assume that Eκis
trivial, and we just need to prove the surjectivity of the map
f∗∶Shol(Y×D)→Shol(X×D).
But this follows from the surjectivity of f∗∶S(Y)→S(X)(see [3, Thm. B.2.4]) and
from isomorphisms (2.1) (using the fact that all the spaces involved are nuclear Frechet
spaces). /square
2.3.Schwartz spaces for stacks and coinvariants. We consider admissible smooth
algebraic stacks over F(see [5, Sec. 2.2]). Recall that they are increasing unions of open
substacks of the form [X/slash.leftG]whereGis a linear algebraic group over Facting on a smooth
F-varietyX. The Schwartz spaces can still be deﬁned for line bundles over such stacks. In
the non-archimedean case this is done in [13] (see also [5, Sec. 2.2]). I n the archimedean
case this is due to Sakellaridis (see [15]).
Inthecaseofaquotientstack [X/slash.leftG],whereG=GLN,theSchwartzspaces S([X/slash.leftG],/divides.alt↪L/divides.alt↪κ)
can be computed as (algebraic) coinvariants of S(X,/divides.alt↪L/divides.alt↪κ⊗/divides.alt↪⋀top(g)/divides.alt↪−1)with respect to the
G(F)-action, where Lis the pull-back of LtoX. In the archimedean case, the deﬁnition
of coinvariantsS(X,/divides.alt↪L/divides.alt↪κ⊗/divides.alt↪⋀top(g)/divides.alt↪−1)G(F)is slightly diﬀerent: one has to take the quotient
by the closure of the span of elements of the form gv−v. Note that we can pull out the
factor/divides.alt↪⋀top(g)/divides.alt↪−1when taking coinvariants since G=GLNacts trivially on it.
Similarly, for an open domain D⊂C, we deﬁneShol([X/slash.leftG]×D,/divides.alt↪L/divides.alt↪κ)as appropriate
coinvariants ofS(X×D,/divides.alt↪L/divides.alt↪κ⊗/divides.alt↪⋀top(g)/divides.alt↪−1).
Lemma 2.4. AssumeG=GLNandFis archimedean. Then there are natural surjective
maps
S(X,/divides.alt↪L/divides.alt↪κ)g→S(X,/divides.alt↪L/divides.alt↪κ)G(F),
Shol(X×D,/divides.alt↪L/divides.alt↪κ)g→Shol(X×D,/divides.alt↪L/divides.alt↪κ)G(F),
where we use the usual algebraic coinvariants with respect t o the Lie algebra g.
Proof.This follows from the fact that gacts trivially onS(X,/divides.alt↪L/divides.alt↪κ)G(F)(resp.,Shol(X×
D,/divides.alt↪L/divides.alt↪κ)G(F)). /square6 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLISH CHUK
2.4.Borel’s theorem with a holomorphic parameter. Here we assume that F=R
orC. LetXbe a smooth F-variety,Z⊂Xa smooth closed subvariety, and let NZ
be the normal bundle to ZinX. Let us consider the decreasing ﬁltration on Shol(X×
D,Eκ)deﬁned as follows: Fi
ZShol(X×D,Eκ)consists off(x,κ)such that for any algebraic
diﬀerential operator Dof order≤i−1 deﬁned on an open U⊂X, one hasDf/divides.alt↪U∩Z=0.
Lemma 2.5. One has
Fi
ZShol(X×D,Eκ)/slash.leftFi+1
ZShol(X×D,Eκ)≃Shol(Z×D,SiN∨
Z⊗E/divides.alt↪Z).
Proof.It is clear that the natural map from the left-hand side to the right -hand side is
injective. Thus, we need to prove surjectivity. Using partition of u nity and local ´ etale
coordinates, we can reduce to the case of a trivial bundle Eand of an embedding Z=Ak⊂
An×Ak=X. Let us partition coordinates on Xas(y,z)wherezare coordinates on Z.
Then we can identify Shol(Z×D,SiN∨
Z)with functions f(y,z,κ)which are homogeneous
polynomial of degree iiny, with coeﬃcients that are in Shol(Z×D). But we can view
suchfas elements of Fi
ZShol(X×D,Eκ). /square
We need the following analog of Borel’s theorem.
Proposition 2.6. For each open subset D⊂Clet us consider the map
τD∶Shol(X×D,Eκ)/slash.leftShol((X−Z)×D,Eκ)→lim←/l⟩ftrightlin⟩Shol(X×D,Eκ)/slash.leftFi
ZShol(X×D,Eκ).
Then it is injective, and for any open D′such thatD′is compact and is contained in D,
the natural restriction map
lim←/l⟩ftrightlin⟩Shol(X×D,Eκ)/slash.leftFi
ZShol(X×D,Eκ)→lim←/l⟩ftrightlin⟩Shol(X×D′,Eκ)/slash.leftFi
ZShol(X×D′,Eκ)(2.2)
factors through the image of τD′.
Proof.First, we claim that Shol((X−Z)×D,Eκ)is exactly the kernel of the map
̃τD∶Shol(X×D,Eκ)→lim←/l⟩ftrightlin⟩Shol(X×D,Eκ)/slash.leftFi
ZShol(X×D,Eκ).
Indeed, this immediately follows from the similar statement for a ﬁxed κ.
Thus, it remains to check that the map (2.2) factors through the im age of̃τD′. Using
partition of unity and local ´ etale coordinates, we reduce to the ca se of trivial Eand of an
embedding Z=Ak⊂An×Ak=X. Then the element of lim←/l⟩ftrightlin⟩Shol(X×D,Eκ)/slash.leftFi
ZShol(X×
D,Eκ)can be viewed as a formal series
f(y,z,κ)=/summ⊃tion.disp
i≥0fi(y,z,κ),
wherefi(y,z,κ)is a homogeneous polynomial of degree iiny, with coeﬃcients that are
inShol(Z×D). We claim that there exists then F(y,z,κ)∈Shol(X×D′), such that the
formal expansion of Finyis equal to f/divides.alt↪D′. Indeed, this follows from the standard proof
of Borel’s theorem. /squareSCHWARTZ κ-DENSITIES 7
3.Coinvariants for Schwartz sections: non-archimedean case
3.1.Homology for smooth representations of l-groups. We use the setup of l-spaces
andl-groups from [7] (see also [6]).
LetGbe anl-group,H(G)the Hecke algebra of locally constant compactly supported
distributions on G,M(G)the category of smooth representations of G. Recall that it
is equivalent to the category M(H(G))of nondegenerate left H(G)-modules (see [6, Sec.
2.1]). It is known that this category has enough projectives (see [6 , Sec. 2.2]).
Lemma 3.1.H(G)is projective as a left H(G)-module.
Proof.H(G)is the direct limit of the projective modules H(G)eK, whereeKis the idem-
potent corresponding to a compact open subgroup K⊂G. Hence, for any M∈M(G)we
have
HomH(G)(H(G),M)≃lim←/l⟩ftrightlin⟩KHom(H(G)eK,M)=lim←/l⟩ftrightlin⟩KeKM,
where the maps eKM→eK′MforK⊂K′are given by the multiplication with eK′. But
these maps are surjective (since eK′=eK′eK), so for an exact sequence 0 →M1→M2→
M3→0 we get an exact sequence of inverse systems satisfying the Mitta g-Leﬄer condition,
which implies that the functor Hom H(G)(H(G),⋅)is exact. /square
For a smooth G-representation M, we denote by MGthe space of G-coinvariants. The
integration deﬁnes a homomorphism H(G)→C, and we view Cas a rightH(G)-module
viathishomomorphism. Itiseasytoseethatfor M∈M(G)thereisanaturalisomorphism
MG≃C⊗H(G)M. (3.1)
Deﬁnition 3.2. We deﬁne smooth homology Hsm
i(G,M)ofGwith coeﬃcients in M∈
M(G)as the left derived functors of the functor of coinvariants M↦MGon the category
M(G).
It follows from (3.1) that
Hsm
i(G,M)≃TorH(G)
i(C,M).
Example 3.3. IfGis a union of compact subgroups then the functor M↦MGis exact,
soHsm
>0(G,M)=0.
Lemma 3.4. LetFbe a local non-archimedean ﬁeld, G=F∗⋉Fn, whereF∗acts linearly
onFn. Letχ∶F∗→C∗be a character, trivial on some open subgroup of F∗. We denote by
Cχthe smooth 1-dimensional representation of G, whereχextends toGvia the projection
G→F∗. Assumeχ≠1. Then
Hsm
∗(G,Cχ)=0.
Proof.SinceFnis a union of compact subgroups, this reduces to the case G=F∗. More-
over, we can replace Gby its quotient G0by an open compact subgroup. Note that G0is
an extension of Zby a ﬁnite commutative group K, and we just need to compute the usual
homologyH∗(G0,Cχ). Ifχ/divides.alt↪K≠1, the assertion follows from the spectral sequence. In the8 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLISH CHUK
caseχ/divides.alt↪K=1, we reduce to the case G0=Z. Then we immediately compute the homology
using the resolution
0→C[t,t−1]t−1✲C[t,t−1]→C→0
of the trivial module over C[Z]=C[t,t−1]. /square
Now letH⊂Gbe a closed subgroup. We denote by
indG
H∶M(H)→M(G)
the functor of compact induction. It is known that it is an exact fun ctor.
Note thatH(G)has a naturalH(G)-bimodule structure, hence, we can view it as an
H(G)−H(H)-bimodule.
For a locally compact group Hwe denote by ∆ Hthemodular character H→R∗
>0(see [8,
0.5]), [7, Sec. 1.19]). In the case when H=H(F), whereFis a local ﬁeld, and His
a linear algebraic group over F, we have an algebraic modular character ∆alg
H∶H→Gm
given by the adoint action of Hon⋀topLie(H)∗. Then ∆ His the composition of the
∆alg
H(F)∶H(F)→F∗with/divides.alt↪⋅/divides.alt↪∶F∗→R∗
>0.
Lemma 3.5. ( [8, Thm. 1.4]) For a closed subgroup H⊂GandM∈M(H), one has a
natural isomorphism
indG
H(M)≃H(G)⊗H(H)(M⋅(∆H/slash.left∆G/divides.alt↪H)),
Lemma 3.6. The functor indG
Htakes projectives to projectives.
Proof.The right adjoint functor to indG
His given by N↦HomH(G)(H(G),N), where the
H(H)-structure is induced by the right action of H(H)onH(G). The assertion follows
from the fact that the latter functor is exact since H(G)is projective as an object of M(G)
by Lemma 3.1. /square
Lemma 3.7. ForM∈M(H), one has a natural isomorphism
Hsm
i(G,indG
HM)≃Hsm
i(H,M⋅(∆H/slash.left∆G/divides.alt↪H)).
Proof.Fori=0, this follows from [7, Prop. 2.29], or can be deduced from Lemma 3.5
together with (3.1). The general case follows from Lemma 3.6. /square
3.2.Equivariant sheaves on l-spaces. LetGbe anl-group acting on an l-spaceX.
LetM(G,X)denote the category of G-equivariant sheaves on X(see [6, Sec. 1.3]). Recall
that aG-equivariant sheaf FonXis equipped with an isomorphism of sheaves on G×X,
α∶p∗F→a∗F,
wherep∶G×X→Xis the projection and a∶G×X→Xis the action map, satisfying the
natural cocycle condition on G×G×X.
IfXis a point thenM(G,pt)is naturally equivalent to M(G), the category of smooth
representations of G(see [6, Sec. 1.3]).SCHWARTZ κ-DENSITIES 9
Ifπ∶X→Yis a continuous map of l-spaces, compatible with actions of GonXandY,
then we have an exact functor
π!∶M(G,X)→M(G,Y).
Furthermore, a G-equivariant version of the base change holds, similar to [6, Sec. 1.3, Prop.
3].
In the case of the projection to the point π∶X→pt, we haveπ!(F)=S(X,F), the
Schwartz space of compactly supported sections of F, with the natural (smooth) action of
G.
IfYhas a trivial G-action, then by the base change, for any point y∈Yand aG-
equivariant sheaf FonX, we have an isomorphism in M(G),
(π!F)y≃S(π−1(y),F/divides.alt↪π−1(y)). (3.2)
IfH⊂Gisaclosedsubgroup, thenfor M∈M(H), thecompactlyinducedrepresentation
indG
HMcan be identiﬁed with the Schwartz space of the corresponding G-equivariant sheaf
onG/slash.leftH. Hence, we get the following Corollary from Lemma 3.7.
Corollary 3.8. LetH⊂Gis a closed subgroup, and let Lbe aG-equivariant complex line
bundle onG/slash.leftH. Then
Hsm
i(G,S(G/slash.leftH,L))≃Hsm
i(H,χL⋅(∆H/slash.left∆G/divides.alt↪H)),
whereχL∶H→C∗is the character given by the action of Hon the ﬁber of Lat the point
with the stabilizer H.
IfU⊂Xis an open subset, Z=X∖Uthe complementary closed subset, then for any
sheafFonXwe have an exact sequence
0→S(U,F)→S(X,F)→S(Z,F/divides.alt↪Z)→0
(see [6, Sec. 1.3, Prop. 4]). We also have the following co-Cech comple xes associated with
open coverings.
Lemma 3.9. For any open covering (Ui)ofXand anyG-equivariant sheaf FonX, where
eachUiisG-invariant, we have an exact sequence of smooth G-representations
.../uni2295.big.disp
i,jS(Uij,F)→/uni2295.big.disp
iS(Ui,F)→S(X,F)→0,
in which the diﬀerentials are deﬁned in a dual way to the Cech c omplex (see [16, Sec.
21.8]).
Proof.This follows from the exactness of the functor S(X,⋅)and the exactness of the
corresponding sheaﬁﬁed complex, where we use the direct sums of sheaves of the form
j!F/divides.alt↪U, forj∶U↪XwithU=Ui1...ik. /square
It is well known that sheaves of C-vector spaces on an l-spaceYcorrespond to nonde-
generateS(Y)-modules (see [6, Sec. 1.3]), while smooth G-representations correspond to
nondegenerateH(G)-modules, whereH(G)is the Hecke algebra. We can get a similar
description for the category of G-equivariant sheaves on Y, whereGacts trivially on Y.10 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Deﬁnition 3.10. We say that anH(G)⊗S(Y)-moduleMisstrongly nondegenerate if
H(G)M=MandS(Y)M=M.
Lemma 3.11. IfYhas a trivial G-action then the functor F↦S(Y,F)gives an equiva-
lence ofM(G,Y)with the category of strongly nondegenerate H(G)⊗S(Y)-modulesM.
Under this equivalence the functor of push-forward to the po intF↦S(Y,F)∈M(G)cor-
responds to restricting the module structure to H(G). Also, for each point y∈Y, the stalk
functorF↦Fy∈M(G)corresponds to the functor M↦M⊗S(Y)Cy, whereCyis the
S(Y)-module corresponding to the homomorphism evy∶S(Y)→Cof evaluation at y.
Proof.Let us denote by M′(H(G)⊗S(Y))the category of nondegenerate H(G)⊗S(Y)-
modules. First, we observe that the functor F↦S(Y,F)can be enriched to a functor
M(G,Y)→M′(H(G)⊗S(Y)).
Indeed, the nondegenerate S(Y)-moduleS(Y,F)has aG-action commuting with the
S(Y)-module structure, and S(Y,F)is a smooth G-representation. Hence, S(Y,F)has a
nondegenerateH(G)-module structure commuting with the S(Y)-module structure, i.e.,
it becomes a strongly nondegenerate H(G)⊗S(Y)-module.
Conversely, starting with M∈M′(H(G)⊗S(Y)), we get a sheaf FonYwithS(Y,F)=
M, and we can use the smooth G-action on Mto get aG-equivariant structure on F.
Namely, we know that Mcorresponds to a G-equivariant sheaf on a point, which is given
by a map ofS(G)-modules,
α∶S(G)⊗M→S(G)⊗M
satisfying a certain cocycle condition. But the map αcommutes with the S(Y)-module
structures, hence, it corresponds to a map p∗F→p∗Fof sheaves on G×X, so it gives a
G-equivariant structure on F. /square
AssumeYhas a trivial G-action. For each open compact subgroup K⊂Gand each
open compact L⊂Y, letPK,Ldenote the object of M(G,Y)corresponding to the strongly
nondegenerateH(G)⊗S(Y)-moduleH(G)eK⊗S(Y)eL, whereeK∈H(G)(resp.,eL∈
S(Y)) is the idempotent corresponding to K(resp.,L).
Lemma 3.12. The objects PK,L∈M(G,Y)are projective. For every object FofM(G,Y)
there is a surjective from a direct sum of some PK,LtoF. For every point y∈Y, the stalk
(PK,L)yis a projectiveH(G)-module. Also,S(Y,PK,L)is a projectiveH(G)-module.
Proof.It is clear that the H(G)⊗S(Y)-moduleH(G)eK⊗S(Y)eLis projective since
Hom(H(G)eK⊗S(Y)eL,M)=(eK⊗eL)M. Furthermore, since for a strongly nondegen-
erateH(G)⊗S(Y)-moduleM, everyx∈Mis contained in(eK⊗eL)Mfor some(K,L),
there is a surjection from a direct sum of some H(G)eK⊗S(Y)eLtoM.
The stalks of PK,Lare given by
(PK,L)y≃(H(G)eK)⊗(S(Y)eL)⊗S(M)Cy)≃/braceleft.alt4H(G)eK, y∈L
0, y/slash.left∈L,
so they are projective H(G)-modules.SCHWARTZ κ-DENSITIES 11
Finally, viewed as an H(G)-module,H(G)eK⊗S(Y)eLis a direct sum of copies of
H(G)eK, hence it is projective. /square
Still assuming that Yhas a trivial G-action let us consider the functor of G-coinvariants
M(G,Y)→M(Y)∶F↦FG,
whichcorrespondstothefunctor M↦C⊗H(G)Monstronglynondegenerate H(G)⊗S(M)-
modules. Thus, by deﬁnition S(Y,FG)=S(Y,F)G. We denote by F↦Hi(G,F)the left
derived functorsM(G,Y)→M(Y).
Lemma 3.13. AssumeYhas a trivial G-action. Then for F∈M(G,Y)andy∈Y, we
have natural isomorphisms
Hi(G,F)y≃Hi(G,Fy),
S(Y,Hi(G,F))≃Hi(G,S(Y,F)).
Proof.Fori=0 the ﬁrst isomorphism is [7, Prop. 2.36] and the second holds by deﬁn ition.
The general case follows from Lemma 3.12 by considering projective resolutions consisting
of direct sums of objects PK,L. /square
Now assume we have an l-spaceXwith an action of an l-groupGand a continuous
map ofl-spacesπ∶X→Y, such that π(gx)=π(x)(so it isG-equivariant, where Gacts
trivially on Y).
Lemma 3.14. For aG-equivariant sheaf FonXand a point y∈Y, we have natural
isomorphisms
Hi(G,π!F)y≃Hi(G,S(π−1(Y),F/divides.alt↪π−1(y))).
Proof.SetF′∶=π!F∈M(G,Y). By Lemma 3.13, we have
Hi(G,F′)y≃Hi(G,F′
y).
It remains to apply the isomorphism (3.2). /square
Recall that the graph of a G-action on Xis the image of the map G×X→X×X∶
(g,x)↦(x,gx).
Deﬁnition 3.15. An action of an l-groupGon anl-spaceXis called locally separated
(resp.,separated ) if the graph of the action in X×Xis locally closed (resp., closed).
By [7, Lem. 6.2], this is equivalent to requiring that the diagonal in (X/slash.leftG)×(X/slash.leftG)is
locally closed (resp., closed).
Note that in [7] separated group actions are called regular. By [7, Le m. 6.4], if the action
ofGonXis separated then the quotient X/slash.leftGis anl-space.
Proposition 3.16. Assume that the action of GonXis locally separated, and let Fbe
aG-equivariant sheaf on X. Fixi0≥0. Assume that for every G-orbitΩ⊂X, one has
Hi(G,S(Ω,F/divides.alt↪Ω))=0fori≤i0. ThenHi(G,S(X,F))=0fori≤i0.12 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Proof.Assume ﬁrst that the actionof GonXis separated, set Y=X/slash.leftG, and letπ∶X→Y
be the natural projection, so that the ﬁbers of πare exactly G-orbits.
SetF′∶=π!F∈M(G,Y). By Lemma 3.14, our assumption implies that the sheaf
Hi(G,F′)has zero stalks, hence it is zero. Now using Lemma 3.13, we get
Hi(G,S(X,F))≃Hi(G,S(Y,F′))≃S(Y,Hi(G,F′))=0.
Now consider the general case when the action of GonXis locally separated. Then
the diagonal in(X/slash.leftG)×(X/slash.leftG)is closed in a neighborhood of every point (x,x). Hence,
there exists an open neighborhood UofxinX/slash.leftG, such that the diagonal is closed in
U×U. The preimage U⊂XofUis aG-equivariant open subset such that the action
ofGonUis separated. Hence, there exists an open covering (Ui)ofXsuch thatUiare
G-invariant and the action of Gon eachUiis separated. It follows that the action of Gon
eachUi1...ik=Ui1∩...Uikis separated, and so by the ﬁrst part of the argument,
Hi(G,S(Ui1...ik,F))=0
fori≤i0. Now the similar vanishing for Hi(G,S(X,F))follows from the long exact
sequence of smooth G-representations
.../uni2295.big.disp
i,jS(Uij,F)→/uni2295.big.disp
iS(Ui,F)→S(X,F)→0
(see Lemma 3.9). /square
3.3.Adding acoeﬃcient ring. LetXbeanl-space,Ganl-group. Insteadofconsidering
G-equivariant sheaves of C-vector spaces on Xas before, we can consider the category
M(G,X;R)ofG-equivariant sheaves of R-modules on X, whereRis a commutative C-
algebra.
All the results of Section 3.2 extend naturally to this setup. For exa mple, in the case
whenGacts trivially on X, the categoryM(G,X;R)is equivalent to the category of
strongly nondegenerate R⊗H(G)⊗S(X)-modules.
Deﬁnition 3.17. AnR-line bundle overXis a sheafLofR-modules such that for some
open covering(Ui)we have an isomorphism of L/divides.alt↪Uiwith the sheaf of R-valued locally
constant functions. Thus, such Lis given by the transition functions fijwhich are locally
constantR∗-valued functions on Ui∩Uj. For an extension of rings R↪R′and anR-line
bundleL, we have a natural R′-line bundleL⊗RR′, given by the same transition functions
via the embedding R↪R′.
Let us describe the main example of an R-line bundle we are interested in (for the
coeﬃcent ring R=C[t,t−1]). Consider the homomorphism
F∗→C[t,t−1]∗∶x↦/divides.alt↪x/divides.alt↪t∶=t−v(x),
where/divides.alt↪x/divides.alt↪=q−v(x). SupposeX=X(F), whereXis anF-variety, and Lis an algebraic line
bundle onX. Then we can construct an C[t,t−1]-line bundle/divides.alt↪L/divides.alt↪tonXas follows. Let(Ui)
be an open covering such that Lis glued from trivial line bundles on Uiusing transitionSCHWARTZ κ-DENSITIES 13
functionsfij∈O∗(Ui). Then we glue/divides.alt↪L/divides.alt↪tout of sheaves of locally constant C[t,t−1]-valued
functions on Ui=Ui(F)using/divides.alt↪fij/divides.alt↪tasC[t,t−1]∗-valued transition functions.
For any open region D⊂C, we have a natural embedding of C-algebras,
C[t,t−1]↪H(D)∶t↦qκ,
and the corresponding embedding
S(X,/divides.alt↪L/divides.alt↪t)↪S(X,/divides.alt↪L/divides.alt↪t⊗H(D))≃Shol(X×D,/divides.alt↪L/divides.alt↪κ).
Forc∈C∗, we can consider the localization
Rc∶=C[t,t−1][1
t−c].
Then ifqκ≠con the region D⊂C, the above embeddings extend to
Rc↪H(D),S(X,/divides.alt↪L/divides.alt↪t⊗C[t,t−1]Rc)↪Shol(X×D,/divides.alt↪L/divides.alt↪κ).
We have the following analog of Lemma 3.4.
Lemma 3.18. Letχ∶G→C[t,t−1]∗be a locally constant homomorphism. Assume that
there exists a closed embedding F∗↪G, such that
χ/divides.alt↪F∗(x)=t−v(x)⋅cv(x),
for somec∈C∗. LetRbe anRc-algebra. Then viewing χas a homomorphism G→R∗,
we have
Hsm
0(G,Rχ)=0,
whereRχisRwith theG-action given by χ. Assume in addition that G=F∗⋉Fn, andχ
is trivial on Fn. ThenHsm
∗(G,Rχ)=0.
Proof.The proof is completely parallel to that of Lemma 3.4. We just have to use the fact
thatt/slash.leftc−1 is invertible in Rc. /square
We also have the following versions of Corollary 3.8 and Proposition 3.16 . The proofs
are similar, so we omit them.
Corollary 3.19. LetRbe a commutative C-algebra. For a closed subgroup H⊂Ga
G-equivariant R-line bundle LonG/slash.leftH, one has
Hsm
i(G,S(G/slash.leftH,L))≃Hsm
i(H,χL⋅(∆H/slash.left∆G/divides.alt↪H)),
whereχL∶H→R∗is the character given by the action of Hon the ﬁber of Lat the point
with the stabilizer H(and we view ∆H/slash.left∆G/divides.alt↪Has taking values in C∗⊂R∗).
Proposition 3.20. Assume that the action of GonXis locally separated, and let Fbe
aG-equivariant sheaf of R-modules on X(whereRis a commutative ring). Fix i0≥0.
Assume that for every G-orbitΩ⊂X, one hasHi(G,S(Ω,F/divides.alt↪Ω))=0fori≤i0. Then
Hi(G,S(X,F))=0fori≤i0.14 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
3.4.An extension result for coinvariants of Schwartz sections. We formulate a
general result in the framework of l-spaces and l-groups, which extends the classical [7,
Thm. 6.9] on invariant distributions.
Theorem 3.21. LetXbe anl-space equipped with action of an l-groupG,Z⊂Xbe aG-
invariant closed subset. Assume that the action of GonZis constructible (i.e., the graph
of the action in Z×Zis constructible). Let Rbe a commutative ring, LaG-equivariant
R-line bundle on X. Assume that for every z∈Z, one has
Hsm
i(Gz,χL,z⋅∆Gz/slash.left∆G/divides.alt↪Gz)=0 (3.3)
fori=0,1(resp., fori=0), whereGzis the stabilizer of z∈Z. Then the natural map
S(X−Z,L)G→S(X,L)G (3.4)
is an isomorphism (resp., surjective).
Note that by [7, Sec. 6.15], the condition of constructibility of action is satisﬁed if
G=G(F),X=X(F), whereXis a variety over a local ﬁeld F,Gis a linear algebraic
group over Facting algebraically on X.
Lemma 3.22. Assume that the action of GonZis constructible. Then there exists a
ﬁltrationZ=Z0⊃Z1⊃...⊃Zk=∅by closedG-invariant subsetss, such that the action of
GonZi∖Zi+1is locally separated (see Def. 3.15).
Proof.SetZ=Z/slash.leftGand let us consider the diagonal ∆ ⊂Z×Z. As in [7, Sec. 6.7], let us
consider the ﬁnite ﬁltration ∆ ⊃∆1⊃...⊃∆k=∅by closed subsets, deﬁned recursively as
follows: ∆i+1is the set of points (z,z)∈∆isuch that ∆iis not closed in any neighborhood
of(z,z)(inZ×Z). By the identiﬁcation ∆ ≃Zwe get a ﬁltration Z⊃Z1⊃...ofZ.
We claim that the corresponding ﬁltration of ZbyG-invariant closed subspaces satisﬁes
our requirement. Indeed, by deﬁnition, ∆i∖∆i+1is locally closed in Z×Z, hence, in
(Zi∖Zi+1)×(Zi∖Zi+1). Therefore, the diagonal is locally closed in (Zi∖Zi+1)×(Zi∖Zi+1),
and so the action of GonZi∖Zi+1is locally separated. /square
Proof of Theorem 3.21. The exact sequence of smooth G-representations
0→S(X−Z,L)→S(X,L)→S(Z,L/divides.alt↪Z)→0
and the long exact sequence of smooth G-homology show that it is enough to prove the
vanishing
Hsm
i(G,S(Z,L/divides.alt↪Z))=0
fori=0,1 (resp.,i=0).
Using Lemma 3.22 we reduce to the case when the action of GonZis locally separated.
Now applying Proposition 3.20, we are reduced to showing that for ea chG-orbit Ω⊂Z,
one has
Hsm
i(G,S(Ω,L/divides.alt↪Ω))=0
fori=0,1 (resp.,i=0). It remains to apply Corollary 3.19 and the vanishing (3.3) for
i=0,1 (resp.,i=0). /squareSCHWARTZ κ-DENSITIES 15
3.5.Corollary for admissible stacks. LetX=[X/slash.leftG]be an admissible stack of ﬁnite
type overF(whereFis a nonarchimedean local ﬁeld, G=GLN),La line bundle onX,L
the corresponding G-equivariant line bundle on X.
We can associate with Land with a number κ∈C, aG(F)-equivariant C-line bundle
/divides.alt↪L/divides.alt↪κonX(F), and by passing to G(F)-coinvariants, the Schwartz space S(X,/divides.alt↪L/divides.alt↪κ)(see
Sec. 2.3). On the other hand, we can deﬁne a G(F)-equivariant C[t,t−1]-line bundle/divides.alt↪L/divides.alt↪t
onX(F)and aC[t,t−1]-moduleS(X,/divides.alt↪L/divides.alt↪t)deﬁned asG(F)-coinvariants ofS(X(F),/divides.alt↪L/divides.alt↪t)
(see Sec. 3.3).
For an open substack U⊂Xandκ∈C, there is a natural map
jU→X,L,κ∶S(U,/divides.alt↪L/divides.alt↪κ)→S(X,/divides.alt↪L/divides.alt↪κ).
Also, for every commutative C[t,t−1]-algebraR, we can consider a natural map
jR
U→X,L∶S(U,/divides.alt↪L/divides.alt↪t⊗R)→S(X,/divides.alt↪L/divides.alt↪t⊗R).
For every point x∈X, the action of the group Aut (x)on the line bundle Lgives a
character
χL,x∶Aut(x)→Gm.
On the other hand, we have the algebraic modular character ∆alg
Aut(x)∶Aut(x)→Gm.
For a character χ∶Aut(x)→Gmand a cocharacter λ∨∶Gm→Aut(x), we deﬁne an
integerm=⟨χ,λ∨⟩so that
χ(λ∨(a))=am.
Lemma 3.23. (i) Fixκ∈C. Assume that for every point x∈X(F)∖U(F), there exists
an algebraic homomorphism λ∨∶Gm→Aut(x)(deﬁned over F), such that
qκ⋅⟨χL,x,λ∨⟩≠q−⟨∆alg
Aut(x),λ∨⟩,
whereqis the number of elements in the residue ﬁeld. Then jU→X,L,κis surjective. Assume
in addition that for each x∈X(F)∖U(F), we have Aut(x)≃Gm⋉Gna, whereλ∨∶Gm→
Aut(x)given by the natural embedding. Then jU→X,L,κis an isomorphism.
(ii) LetRbe a commutative C[t,t−1]-algebra. Assume that for every point x∈X(F)∖U(F),
there exists an algebraic homomorphism λ∨∶Gm→Aut(x), such that
t⟨χL,x,λ∨⟩−q−⟨∆alg
Aut(x),λ∨⟩∈R∗.
Then the map jR
U→X,Lis surjective. If in addition Aut(x)≃Gm⋉Gnaandλ∨∶Gm→Aut(x)
is given by the natural embedding, then jR
U→X,Lis an isomorphism.
(iii) LetD⊂Cbe an open region. Assume that for every point x∈X(F)∖U(F), there
exists an algebraic homomorphism λ∨∶Gm→Aut(x), such that
Re(κ)⋅⟨χL,x,λ∨⟩≠⟨−∆alg
Aut(x),λ∨⟩
for everyκ∈D. Then the map
jhol
U→X,L∶Shol(U×D,/divides.⊃lt0L/divides.⊃lt0κ)→Shol(X×D,/divides.⊃lt0L/divides.⊃lt0κ)
is surjective.16 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Proof.(i)LetU⊂XbetheG-invariantopensubset correspondingto U⊂X. Forx∈X(F),
we have Aut X(x)=Gx⊂G, the stabilizer of x. Since ∆ G(F)=1, by Theorem 3.21, to check
thatjU→X,L,κsurjective (resp., an isomorphism), we need to know that
Hsm
i(Gx(F),/divides.⊃lt0χL,x/divides.⊃lt0κ⋅/divides.⊃lt0∆alg
Gx/divides.⊃lt0)=0
forx/sl⊃sh.left∈U(F)andi=0 (resp.,i≤1). Fori=0 we are just computing the coinvariants,
and the assumption implies that the corresponding character Gx(F)→C∗is nontrivial.
To compute higher homology we use the extra assumption on the str ucture of Aut(x)and
apply Lemma 3.4.
(ii) This is parallel to (i) using Lemma 3.18.
(iii) This follows from (ii) with R=H(D), viewed as a C[t,t−1]-algebra via t↦qκ./square
4.Coinvariants for Schwartz sections: archimedean case
4.1.Formulation of the extension result and the ﬁrst reduction. Now we assume
thatF=RorC. We want to prove the following version of [2, Thm. B.0.2]2.
Theorem 4.1. LetXbe the set of F-points of a smooth algebraic F-variety equipped
with an algebraic action of a connected linear algebraic gro upG(overF) with the Lie
algebrag, and letZ⊂Xbe aG-invariant closed subvariety. Let V(resp.,L1,L2) be an
algebraicG-equivariant vector bundle (resp., line bundles) over X. As in Sec. 2.1, consider
Eκ=V⊗/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪, whereκ∈C. Forz∈Zwe denote by Gz⊂Gthe stabilizer subgroup,
and bygzits Lie algebra. Let χLi,z∶Gz→Gmdenote the character of action on L/divides.alt↪z. Let
Dbe either an open region in Cor a single point D={κ0}. Assume that for any z∈Z,
κ∈Dandm≥0we have
[/divides.alt↪χL1,z/divides.alt↪κ⊗/divides.alt↪χL2,z/divides.alt↪⊗V/divides.alt↪z⊗Sm(N∨
Gz)/divides.alt↪z⊗∆Gz/slash.left∆G/divides.alt↪Gz]gz,r=0
for some reductive subalgebra gz,r⊂gz, whereN∨
Gzis the conormal bundle to GzThen for
any openD′⊂Dsuch thatD′is compact and is contained in D, the map on coinvariants
[Shol(X×D,Eκ)/slash.leftShol((X−Z)×D,Eκ)]g→[Shol(X×D′,Eκ)/slash.leftShol((X−Z)×D′,Eκ)]g
is zero. In the case D={κ0}, the conclusion is
[S(X,Eκ0)/slash.leftS(X−Z,Eκ)]g=0
We follow the same steps as in [2].
First, we observe that if we have a ﬁltration Z1⊂Z2⊂...Zr=ZbyG-invariant closed
subvarieties then it is enough to prove the result for each pair (X−Zi−1,Zi−Zi−1).
Deﬁnition 4.2. An action of an algebraic group Gon an algebraic variety Zis called
factorizable ifZis smooth, the schematic image Yof the map G×X→X×X∶(g,x)↦
(x,gx)is a smooth variety, and the map G×Z→Yis smooth.
2The modular characters appear in [2, Thm. B.0.2] with the opposite sig n due to a diﬀerent convention.SCHWARTZ κ-DENSITIES 17
There exists a ﬁltration Z1⊂...⊂Zr=ZbeG-invariant closed subvarieties, such that
the action of GonZi−Zi−1is factorizable (see [2, Thm. B.0.11]). Thus, we can assume
thatZis smooth and the action of GonZisfactorizable .
By an analog of Borel’s theorem (see Prop. 2.6) together with Lemma 2.5, Theorem 4.1
now reduces to the following result (which is an analog of [2, Thm. B.0.12 ]), which has to
be applied to X=Zand the bundle Sm(N∨
Z)⊗(V⊗/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪)/divides.alt↪Z. Note that to deduce
Theorem 4.1 from Theorem 4.3 we use reductivity of gz,r, as we have to pass from the
spaceN∨
Gz/divides.alt↪zto its subspace N∨
Z/divides.alt↪z.3
Theorem 4.3. Let(X,G,V,L 1,L2,D)be as in Theorem and assume in addition that the
action ofGonZis factorizable. Assume that for any z∈Zandκ∈Dwe have
[/divides.alt↪χL1,z/divides.alt↪κ⊗/divides.alt↪χL2,z/divides.alt↪⊗V/divides.alt↪z⊗∆Gz/slash.left∆G/divides.alt↪Gz]gz=0,
wheregzis the Lie algebra of Gz. Then
Shol(X×D,Eκ)g=0.
In the case D={κ0}, the conclusion is
Shol(X,Eκ0)g=0.
4.2.Description of coinvariants.
Lemma 4.4. Letgbe a ﬁnite dimensional Lie algebra (over RorC), and letVbe a
nuclear Frechet space with a continuous g-action, such that g⋅Vis closed in V. Then for
a nuclear Frechet space W(with the trivial g-action), we have
g⋅(Vˆ⊗W)=(g⋅V)ˆ⊗W.
Proof.By deﬁnition g⋅(Vˆ⊗W)is the image of the action map
g⊗(Vˆ⊗W)→Vˆ⊗W,
which can be identiﬁed with the map (g⊗V)ˆ⊗W→Vˆ⊗Winduced by the action map
g⊗V→V. By assumption, the latter map factors as the composition of the s urjection
g⊗V→V0∶=g⋅Vand a closed embedding V0→V. Now the assertion follows from the
fact that the induced maps (g⊗V)ˆ⊗W→V0ˆ⊗WandV0ˆ⊗W→Vˆ⊗Ware still surjective
and injective, respectively. /square
Leta∶G×X→Xbe the action map (g,x)↦gx,p∶G×X→Xthe projec-
tion. TheG-equivariant structure on Eκgives a (tempered) map of bundles on G×X,
p∗(Eκ)∼✲a∗(Eκ), and hence a map
α∶p!(Eκ)∼✲a!(Eκ),
where for a smooth morphism fwe setf!(F)∶=f∗(F)⊗/divides.alt↪ωf/divides.alt↪(here we use the identiﬁcations
ωp≃ωa≃p∗
GωG).
Similar to [2], we consider the kernel of the integration map,
Shol(G×X×D,p!Eκ)0,X∶=ker(p∗∶Shol(G×X×D,p!Eκ)→Shol(X×D,Eκ)).
3There seems to be a gap in the proof of [2, Thm. B.0.2] at a similar step.18 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
and then we consider the image of this subspace under the above ma pα,
Shol(G×X×D,a!Eκ)0,X,a∶=α(Shol(G×X×D,p!Eκ)0,X).
Proposition 4.5. We have
g⋅Shol(X×D,Eκ)=a∗(Shol(G×X×D,a∗Eκ⊗/divides.alt↪ωa/divides.alt↪)0,X,a).
Proof.The integration map
a∗∶Shol(G×X×D,a∗Eκ⊗/divides.alt↪ωa/divides.alt↪)→Shol(X×D,Eκ)
is surjective (see Lemma 2.3) and is compatible with G-actions, where Gacts on the G-
coordinate in G×X. It follows that g⋅Shol(X×D,Eκ)is the image of g⋅Shol(G×X×
D,a∗Eκ⊗/divides.alt↪ωa/divides.alt↪). Furthermore, the isomorphism
p∗Eκ⊗/divides.alt↪ωp/divides.alt↪≃p∗Eκ⊗/divides.alt↪p∗
GωG/divides.alt↪≃a∗Eκ⊗/divides.alt↪ωa/divides.alt↪
is compatible with G-actions, where p∗Eκhas a trivial G-action. Now we have an isomor-
phism of g-representations,
Shol(G×X×D,p∗Eκ⊗/divides.alt↪p∗
GωG/divides.alt↪)≃S(G,/divides.alt↪ωG/divides.alt↪)ˆ⊗Shol(X,Eκ).
Recall that g⋅S(G,/divides.alt↪ωG/divides.alt↪)coincides with the (closed) subspace S(G,/divides.alt↪ωG/divides.alt↪)0offwith∫Gf=0
(see [2]). This gives an identiﬁcation
g⋅Shol(G×X×D,p∗Eκ⊗/divides.alt↪p∗
GωG/divides.alt↪)≃S(G,/divides.alt↪ωG/divides.alt↪)0ˆ⊗Shol(X,Eκ)
(see Lemma 4.4). It remains to observe that the completed tensor ed product of the exact
sequence
0→S(G,/divides.alt↪ωG/divides.alt↪)0→S(G,/divides.alt↪ωG/divides.alt↪)∫G✲C→0
withShol(X,Eκ)gives the exact sequence
0→Shol(G×X×D,p∗Eκ⊗/divides.alt↪p∗
GωG/divides.alt↪)0,X→Shol(G×X×D,p∗Eκ⊗/divides.alt↪p∗
GωG/divides.alt↪)p∗✲Shol(X×D,Eκ)→0.
/square
Next, we will consider the case of a smooth group scheme over X.
Proposition 4.6. Letπ∶H→Xbe a smooth group scheme over X,Vκa family of H(F)-
equivariant vector bundles over X(F)of the form P⊗/divides.alt↪L1/divides.alt↪κ⊗/divides.alt↪L2/divides.alt↪, whereκ∈D0. Assume
that for every x∈Xandκ∈D⊂D0, one has(Vκ/divides.alt↪x)h/divides.⊗lt0x=0. Then the composition
Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)0,Xα✲Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)π∗✲Shol(X×D,Vκ),
induced by the H-action map α∶π∗Vκ→π∗Vκfollowed by the integration along π∶H→X,
is surjective.
Proof.Step 1. The surjective composed map
Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)α✲Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)π∗✲Shol(X×D,Vκ),
is a map ofS(X,h)-representations, where the action on the source considers Vκwith the
trivialH-action (cf. the proof of [2, Cor. 9.17]).SCHWARTZ κ-DENSITIES 19
Step 2. The image of the map S(X,h)⊗Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)→Shol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)
associated with the trivial H-action onVκis contained inShol(H×D,π∗Vκ⊗/divides.alt↪ωπ/divides.alt↪)0,X.
Indeed, by partition of unity, we can assume that Vκis trivial. We have the following
identiﬁcations:
Shol(H×D,/divides.alt↪ωπ/divides.alt↪)≃S(H,/divides.alt↪ωπ/divides.alt↪)ˆ⊗Shol(D),Shol(X×D)≃S(X)ˆ⊗Shol(D),
Shol(H×D,/divides.alt↪ωπ/divides.alt↪)0,X≃S(H,/divides.alt↪ωπ/divides.alt↪)0,Xˆ⊗Shol(D),
where the latter identiﬁcation is obtained by looking at the completed tensor product with
Shol(D)of the sequence
0→S(H,/divides.alt↪ωπ/divides.alt↪)0,X→S(H,/divides.alt↪ωπ/divides.alt↪)π∗✲S(X)→0.
By [2, Lem. B.1.14], we have an inclusion
im(S(X,h)⊗S(H,/divides.alt↪ωπ/divides.alt↪)→S(H,/divides.alt↪ωπ/divides.alt↪))⊂S(H,/divides.alt↪ωπ/divides.alt↪)0,X.
This implies that the composition
S(X,h)ˆ⊗S(H,/divides.alt↪ωπ/divides.alt↪)→S(H,/divides.alt↪ωπ/divides.alt↪)π∗✲S(X)
is zero. Tensoring with Shol(D), we deduce that the composition
S(X,h)ˆ⊗S(H,/divides.alt↪ωπ/divides.alt↪)ˆ⊗Shol(D)→S(H,/divides.alt↪ωπ/divides.alt↪)ˆ⊗Shol(D)π∗⊗id✲S(X)ˆ⊗Shol(D),
is zero, which gives the assertion in view of the above identiﬁcations.
Step 3. The mapS(X,h)⊗Shol(X×D,Vκ)→Shol(X×D,Vκ)(induced by the H-action
onVκ) is surjective. The action of honVκgives a morphism of vector bundles
αh∶h⊗Vκ→Vκ
overX×D, and our assumption implies that it is surjective. By the partition of u nity, we
can assume that Xis aﬃne, and can trivialize P,L1andL2. andhas a vector bundle.
Let us write h=h0⊗O,Vκ=V0⊗O, whereh0andV0are ﬁnite-dimensional vector spaces.
Thenαhcan be viewed as a surjective algebraic morphism
h0⊗V0⊗OX×D→V0⊗OX×D
overX×D(the dependence on κwill be linear).
We have identiﬁcations
S(X,h)≃h0⊗S(X),Shol(X×D,Vκ)≃V0⊗Shol(X×D),
so the map we are interested in is obtained as the composition
h0⊗S(X)⊗V0⊗Shol(X×D)→h0⊗V0⊗Shol(X×D)αh✲V0⊗Shol(X×D),
where the ﬁrst arrow is induced by the natural surjective map S(X)⊗Shol(X×D)→
Shol(X×D). Thus, it suﬃces to prove surjectivity of the map
h0⊗V0⊗Shol(X×D)αh✲V0⊗Shol(X×D). (4.1)
To this end we can choose a section
s∶V0⊗OX×D→h0⊗V0⊗OX×D20 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
ofαfh. Thensgives rise to a map
V0⊗Shol(X×D)→h0⊗V0⊗Shol(X×D),
which is a section of (4.1), proving its surjectivity.
Step 4. Now the assertion follows formally from Steps 1, 2 and 3. /square
4.3.Representation of torsors. We use the terminology of [2, Sec. B.1.4] concerning
(families of) torsors.
We consider a smooth morphism of F-varieties,π∶T→Ywith the torsor structure over
Y. This means that we are given a map m∶T×YT×YT→Twhich is locally of the form
m(x,y,z)=z(z−1x)(z−1y)for some group structure. For every t∈Twe denote by Htthe
ﬁberπ−1(π(t))with the unique group structure such that tis the neutral element. In the
archimedean case we denote by htthe Lie algebra of Ht. An (algebraic) representation of
Tis a pair of (algebraic) vector bundles V1,V2onY, together with a morphism α∶π∗V1→
π∗V2such that for every t0∈T, the mapt↦αtα−1
t0∶V2/divides.alt↪π(t0)→V2/divides.alt↪π(t0)gives an action of
Ht0onV2/divides.alt↪π(t0). There is a natural operation of tensor product of representat ions ofT.
We have the following Corollary from Proposition 4.6 (an analog of [2, Co r. B.1.27]).
Corollary 4.7. Letπ∶T→Ybe an algebraic torsor over F,(V1,κ,V2,κ,α)a family
of representations of T(F), obtained as the tensor product of an algebraic representa-
tion(P1,P2), with1-dimensional representations of the form (/divides.alt↪L1/divides.alt↪κ,/divides.alt↪L2/divides.alt↪κ)and(/divides.alt↪M1/divides.alt↪,/divides.alt↪M2/divides.alt↪)
(where(L1,L2)and(M1,M2)are algebraic representations of T). Assume that for every
t∈Tandκ∈D, one has(V2,κ/divides.alt↪p(t))ht=0. Then the composition
Shol(T×D,π∗V1,κ⊗/divides.alt↪ωπ/divides.alt↪)0,Yα✲Shol(T×D,π∗V2,κ⊗/divides.alt↪ωπ/divides.alt↪)π∗✲Shol(Y×D,Vκ),(4.2)
is surjective.
Proof.If there is a section σ∶Y→TthenTbecomes a family of smooth groups and the
assertion follows from Proposition 4.6. The general case follows fro m this by choosing local
sections and a partition of unity. /square
Proof of Theorem 4.3. LetY⊂X×Xdenote the image of the map (p,a)∶G×X→X×X∶
(g,x)↦(x,gx). In other words, Yis the variety of pairs (x1,x2)such thatx1andx2are
in the same G-orbit. By assumption, Yis smooth and the map
b∶G×X→Y∶(g,x)↦(x,gx)
is smooth. Hence, the projections p1,p2∶Y→Xare also smooth.
Via the map b, we can view G×Xas a torsor over Y. Note that b−1(x1,x2)is identiﬁed
with{g∈G/divides.alt↪gx1=x2}. For each(g,x)∈G×X, thecorresponding group Hg,xis canonically
identiﬁed with Hx≃Hgx.
The pair of bundles on Y,
Vi,κ=p∗
iEκ⊗/divides.alt↪ωpi/divides.alt↪, i=1,2,SCHWARTZ κ-DENSITIES 21
has a natural structure of a representation over the torsor G×X. Namely, for(x1,x2)∈Y,
and an element g∈Gsuch thatgx1=x2, we use the map
V1,κ/divides.alt↪(x1,x2)≃Eκ/divides.alt↪x1⊗/divides.alt↪ωΩ/divides.alt↪/divides.alt↪x2αg⊗αg−1✲Eκ/divides.alt↪x2⊗/divides.alt↪ωΩ/divides.alt↪/divides.alt↪x1,
induced by the action of gonEκand by the action of g−1onωΩ, where Ω is the G-orbit
containing x1andx2. The corresponding representation of HxonV2,κ/divides.alt↪xcan be identiﬁed
withEκ⊗∆Hx⊗∆−1
G/divides.alt↪Hx. Thus our assumption implies that for every x∈X, one has
(V2,κ/divides.alt↪x)hx=0.
Applying Corollary 4.7 we deduce surjectivity of the composition (4.2) . On the other
hand, by Proposition 4.5, we need to prove surjectivity of the comp osition
Shol(G×X×D,p!Eκ)0,X↪Shol(G×X×D,p!Eκ)α✲Shol(G×X×D,a!Eκ)a∗✲Shol(X×D,Eκ).
Sincea=p2○b, and the map p2∶Y→Xis smooth and surjective on F-points, by Lemma
2.3, it is enough to prove surjectivity of the similar composition with a∗replaced by the
map
b∗∶Shol(G×X×D,a!Eκ)→Shol(Y×D,p!
2Eκ).
Finally, we observe that we have an inclusion
Shol(G×X×D,b∗V1,κ⊗/divides.alt↪ωb/divides.alt↪)0,Y⊂Shol(G×X×D,p!Eκ)0,X
(the ﬁrst space is the kernel of b∗, while the second is the kernel of p∗), and a commutative
diagram
Shol(G×X×D,p!Eκ)α✲Shol(G×X×D,a!Eκ)
Shol(G×X×D,b!V1,κ)∼
❄α✲Shol(G×X×D,b!V2,κ).∼
❄
Hence, the assertion follows from surjectivity of (4.2). /square
4.4.Corollary for admissible stacks. LetXbe an admissible stack of ﬁnite type over
F,La line bundle onX.
LetU⊂Xan open substack. For every κ∈C, there is a natural map
jU→X,L,κ∶S(U,/divides.alt↪L/divides.alt↪κ)→S(X,/divides.alt↪L/divides.alt↪κ)
and for an open region D⊂C, a map
jhol
U→X,L,D∶Shol(U×D,/divides.alt↪L/divides.alt↪κ)→Shol(X×D,/divides.alt↪L/divides.alt↪κ)
As before, for every point x∈X, we consider the character
χL,x∶Aut(x)→Gm.
and the algebraic modular character ∆alg
Aut(x)of Aut(x)(F).22 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Lemma 4.8. LetDbe either an open region in CorD={κ0}. Assume that for every
pointx∈X∖Uandκ∈D, there exists an algebraic homomorphism λ∨∶Gm→Aut(x),
such that for any character a↦amofGmappearing in the action on S●H0T∗
X/divides.alt↪xone has
κ⋅⟨χL,x,λ∨⟩+m≠−⟨∆alg
Aut(x),λ∨⟩.
Then for any open D′⊂Dsuch thatD′is compact and is contained in D, the image of
the restriction map
Shol(X×D,/divides.⊃lt0L/divides.⊃lt0κ)→Shol(X×D′,/divides.⊃lt0L/divides.⊃lt0κ)
is contained in the image of jhol
U→X,L,D′. In the case D={κ0}, the conclusion is that jU→X,L,κ0
is surjective.
Proof.We can assume that X=[X/slash.leftG], whereG=GLN, andU=[U/slash.leftG], whereU⊂Xis
open. LetLdenote the pull-back of LtoX. We have Aut X(x)=Gx⊂G, the stabilizer
subgroup of x∈X. Theorem 4.1 implies that the top horizontal arrow in the diagram
Shol(X×D,/divides.alt↪L/divides.alt↪κ)g/slash.leftimShol(U×D,/divides.alt↪L/divides.alt↪κ)g✲Shol(X×D′,/divides.alt↪L/divides.alt↪κ)g/slash.leftimShol(U×D′,/divides.alt↪L/divides.alt↪κ)g
Shol(X×D,/divides.alt↪L/divides.alt↪κ)/slash.leftimShol(U×D,/divides.alt↪L/divides.alt↪κ)❄
✲Shol(X×D′,/divides.alt↪L/divides.alt↪κ)/slash.leftimShol(U×D′,/divides.alt↪L/divides.alt↪κ)❄
is zero. Now we observe that the vertical arrows in this diagram are surjective by Lemma
2.4. Hence, the bottom horizontal arrow is also zero. /square
5.Integration over orbits
5.1.Setup and two extension results. In this section Fis either archimedean or non-
archimedean.
LetXbe a smooth G-scheme over F(whereG=GLN),LaG-equivariant line bundle on
Xrepresenting a line bundle Lon the stack[X/slash.leftG], and letU0⊂Xbe an open G-invariant
subscheme such that Gacts freely on U0and the quotient U0/slash.leftGexists. Let us choose a
trivialization vol g∈/divides.alt↪⋀top(g)−1/divides.alt↪.
First, we observe that for each κ∈C, there is a well deﬁned map
πU0,κ∶S(U0(F),/divides.alt↪L/divides.alt↪κ)G(F)→S((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ),
whereL0is the descent of LtoU0/slash.leftG, given by absolutely convergent integrals
πU0,κ(ϕ)(x)=/inte∅r⊗l.dispΩx(F)ϕ⋅volg, (5.1)
where Ω x⊂Xis theG-orbit ofx∈U0(which is closed in U0).
We are interested in ﬁnding conditions under which the above map ext ends to a map
πX,U0,κ∶S(X(F),/divides.alt↪L/divides.alt↪κ)G(F)→C∞((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ), (5.2)
given by the same formula (5.1) (where in the nonarchimedean case C∞refers to lo-
cally constant functions). For technical reasons we will deﬁne πU0,κ(ϕ)as distributionsSCHWARTZ κ-DENSITIES 23
on(U0/slash.leftG)(F), so actually we will be able to control the integrals (5.1) only away fro m a
set of orbits of measure zero.
We will consider the space of distributions D((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ)acting on sections of
/divides.alt↪L0/divides.alt↪−κ⊗/divides.alt↪ω/divides.alt↪, so that we have an inclusion
C∞((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ)⊂D((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ).
Deﬁnition 5.1. We say that the pair (U0,X)is/divides.alt↪L/divides.alt↪κ-niceif for every ϕ∈S(X(F),/divides.alt↪L/divides.alt↪κ),
and everyψ∈S((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪−κ⊗/divides.alt↪ω/divides.alt↪), the integral
πX,U0,κ(ϕ)(ψ)∶=/inte∅r⊗l.dispU0(F)ψ⋅ϕ/divides.alt↪U0(F)⋅volg (5.3)
isabsolutelyconvergent, andthecorrespondingdistribution πX,U0,κ(ϕ)∈D((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ)
belongs to the subspace C∞((U0/slash.leftG)(F),/divides.alt↪L0/divides.alt↪κ).
It is easy to see using Fubini’s theorem that in the situation of the abo ve deﬁnition the
integrals (5.1) are absolutely convergent away from a set of orbits of measure zero. It is
plausible that if(U0,X)is/divides.alt↪L/divides.alt↪κ-nice then in fact the values of the obtained C∞-sections
πX,U0,κ(ϕ)are given by absolutely convergent integrals (5.1) but we do not kno w how to
prove this (and this is not essential for us).
From now on we specialize to the case L=ωX, soL=ωX⊗⋀top(g). Note that since the
action ofGon⋀top(g)is trivial, we can (and will) identify LwithωXas aG-equivariant
bundle.
Assume we have some open G-invariant subschemes U0⊂U⊂Xsuch thatGacts freely
onU0and the quotient U0/slash.leftGexists.
As before, for x∈X(F),Gx=Aut[X/slash.l⟩ftG](x)is the stabilizer of x, andχω,x∶Gx→Gmis
the character given by the action on ωX/divides.alt↪x.
Lemma 5.2. Fix some real numbers a<1,b>1. Assume that for any real number kin
the interval(a,b)⊂R, the pair(U0,U)is/divides.alt↪ω/divides.alt↪k-nice. Assume in addition that
●eitherFis non-archimedean, and for any x∈(X∖U)(F)there exists a cocharacter
λ∨∶Gm→Gxsuch that
k⋅⟨χω,x,λ∨⟩≠−⟨∆alg
Gx,λ∨⟩
for anyk∈(a,b);
●orFis archimedean, and for any x∈(X∖U)(F)there exists a cocharacter λ∨∶
Gm→Gx, such that for any character a↦amofGmappearing in S●H0T∗
[X/slash.l⟩ftG]/divides.⊃lt0x,
k⋅⟨χω,x,λ∨⟩+m≠−⟨∆alg
Gx,λ∨⟩
for anyk∈(a,b).
Then the pair(U0,X)is/divides.⊃lt0ω/divides.⊃lt0κ-nice for any κin the strip a<Re(κ)<b.
Proof.By shrinking U0/sl⊃sh.leftGwe can assume that there exists a nowhere vanishing G-invariant
top formη0onU0/sl⊃sh.leftG. On the other hand, we can cover Xwith open subsets Uisuch that
there exist nowhere vanishing top forms ηionUi, so thatηi⋅vol−1
gare trivializations of
ωX/divides.⊃lt0Ui⊗⋀top(g).24 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
It is enough to consider sections of S(X(F),/divides.⊃lt0L/divides.⊃lt0κ)supported on some Ui. Using the
trivializations of L/divides.⊃lt0Ui, we can write these sections as
ϕκ∶=ϕ⋅/divides.⊃lt0ηi⋅vol−1
g/divides.⊃lt0κ,
whereϕ∈S(Ui(F)), so the corresponding integrals can be written as
πX,U0,κ(ϕκ)(ψ/divides.⊃lt0η0/divides.⊃lt01−κ)=/inte∅r⊗l.dispU0(F)∩Ui(F)ψ⋅ϕ⋅/divides.⊃lt0ηi
volgη0/divides.⊃lt0κ⋅/divides.⊃lt0η0/divides.⊃lt0⋅volg, (5.4)
whereψ∈S((U0/sl⊃sh.leftG)(F)). Note that here ηi/sl⊃sh.left(volgη0)is a non-vanishing function on (Ui∩
U0)(F).
Furthermore, it is enough to consider the Schwartz sections as ab ove withϕnon-negatve
(since anyϕcan be expressed as a diﬀerence of non-negative Schwartz funct ions). From
now one, we ﬁx such ϕ∈S(Ui(F)).
Step 1. We observe that for Re (κ)=1, the integral (5.4) absolutely converges, since
the measure ϕ⋅/divides.⊃lt0ηi/divides.⊃lt0has ﬁnite volume. Hence, (5.4) deﬁnes a well deﬁned distribution
πX,U0,κ(ϕκ)∈D((U0/sl⊃sh.leftG)(F),/divides.⊃lt0ω/divides.⊃lt0κ).
Step 2. It isenoughto prove therelevant absolute convergence for κinanyslightly smaller
stripa′<Re(κ)<b′, wherea′=a+ǫ,b′=b−ǫ. Let us pick a bounded open domain D′
contained in this strip such that D′∩R=(a′,b′). By Lemma 4.8 in the archimedean case
or by Lemma 3.23(iii) in the non-archimedean case, there exists an ele ment
̃ϕκ∈S(U(F)×D′,/divides.⊃lt0ω/divides.⊃lt0κ)G(F)
liftingϕκ. Note that
πU,U0,κ(̃ϕκ)∈C∞((U0/sl⊃sh.leftG)(F),/divides.⊃lt0ω/divides.⊃lt0κ)⊂D((U0/sl⊃sh.leftG)(F),/divides.⊃lt0ω/divides.⊃lt0κ)
depends holomorphically on κ∈D′.
Step 3. We know that for Re (κ)=1, the integrals deﬁning the distribution πX,U0,κ(ϕκ)
are absolutely convergent and we have an equality of twisted distrib utions on(U0/sl⊃sh.leftG)(F).
πU,U0,κ(̃ϕκ)=πU,U0,κ(ϕκ)=πX,U0,κ(ϕκ).
In particular, for Re (κ)=1, the image of πX,U0,κis contained in C∞((U0/sl⊃sh.leftG)(F),/divides.⊃lt0ω/divides.⊃lt0κ).
Step 4. Now we arrive at the following situation: we have a holomorphic map
{κ∈C/divides.⊃lt0a′<Re(κ)<b′}→C∞((U0/sl⊃sh.leftG)(F))⊂D((U0/sl⊃sh.leftG)(F))∶κ↦πU,U0,κ(̃ϕκ),
such that for Re(κ)=1 it is given by absolutely converging integrals πX,U0,κ(ϕκ)(ψ/divides.⊃lt0η0/divides.⊃lt01−κ).
NowbyLemma5.3below, weconcludethatforanynon-negative ψtheintegral(5.4)con-
verges absolutely for all κin the strip a′<Re(κ)<b′, and agrees with πU,U0,κ(̃ϕκ)(ψ/divides.⊃lt0η0/divides.⊃lt01−κ).
In particular, the distribution it deﬁnes belongs to C∞((U0/sl⊃sh.leftG)(F)). /square
The proof of the following Lemma is due to Pavel Etingof.SCHWARTZ κ-DENSITIES 25
Lemma 5.3. LetYbe a smooth variety over a local ﬁeld F,fan invertible function on
Y,µa positive measure on Y(F). Consider the integrals depending on s∈C,
I(s)=/inte∅r⊗l.dispY(F)/divides.⊃lt0f/divides.⊃lt0sµ.
Assume that I(s0)<∞for somes0∈R, so thatI(s)is well deﬁned for Re(s)=s0,
and there exists an analytic continuation of I(s)into an open neighborhood U⊂Cofs0.
Supposes0⊂(a,b)⊂U∩R. ThenI(s)<∞fora<Re(s)<b.
Proof.Without loss of generality we can assume that s0=0. Let us write I(s)=I+(s)+
I−(s), where
I+(s)=/inte∅r⊗l.disp/divides.⊗lt0f/divides.⊗lt0≥1/divides.⊃lt0f/divides.⊃lt0s⋅µ, I−(s)=/inte∅r⊗l.disp/divides.⊗lt0f/divides.⊗lt0<1/divides.⊃lt0f/divides.⊃lt0sµ.
SinceI(0)<∞, the integral I+(s)(resp.,I−(s)) converges absolutely for Re (s)≤0 (resp.,
Re(s)≥0).
It is enough to prove that I+(b)<∞andI−(a)<∞. Let us prove the convergence of
I−(a)(the proof for I+(b)is analogous). The existence of an analytic continuation of I(s)
intoa<Re(s)<ǫ(whereǫ>0) implies that I−(s)extends to a function on a<Re(s)≤0,
analytic on a<Re(s)<0 and continuous on a<Re(s)≤0 (note for I+(s)this follows
from the absolute convergence in a<Re(s)≤0). It follows that I−(s)has an analytic
continuation to the region a<Re(s).
Set
a0∶=inf{s∈R/divides.⊃lt0I−(s)<∞}.
Note thata0≤0. We want to prove that a0≤a. Assume that a0>a. Consider the positive
measure
ν∶=/divides.⊃lt0f/divides.⊃lt0a0⋅δ/divides.⊗lt0f/divides.⊗lt0<1⋅µ.
Then the integral
J(s)∶=/inte∅r⊗l.dispY(F)/divides.⊃lt0f/divides.⊃lt0s⋅ν
has the following properties:
●J(s)<∞for everys>0;
●J(s)has an analytic continuation to a−a0<Re(s).
The analyticity of J(s)nears=0 implies that snear 0 one has
J(n)(s)=/inte∅r⊗l.dispY(F)(ln/divides.⊃lt0f/divides.⊃lt0)n⋅/divides.⊃lt0f/divides.⊃lt0s⋅ν,
for eachn≥0. SinceJ(s)is analytic at s=0, there exists some R>0 and a constant
C>0, such that
/divides.⊃lt0J(n)(0)/divides.⊃lt0=/inte∅r⊗l.dispY(F)(−ln/divides.⊃lt0f/divides.⊃lt0)nν≤C⋅n!⋅Rn.
But this implies that for 0 ≤t<R−1, one has
J(−t)=/inte∅r⊗l.disp/divides.⊃lt0f/divides.⊃lt0−tν=/inte∅r⊗l.disp∞
/summ⊗tion.disp
n=0tn
n!(−ln/divides.⊃lt0f/divides.⊃lt0)nν≤∞
/summ⊗tion.disp
n=0C(tR)n<∞.26 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Hence,I−(a0−t)<∞for 0≤t<R−1, contradicting the deﬁnition of a0. /square
We also need another type of extension of πU,U0,κ.
Lemma 5.4. Assume that the pair (U0,U)is/divides.⊃lt0ω/divides.⊃lt0κ-nice. Assume also that for every point
y∈(U0/sl⊃sh.leftG)(F), there exists a neighborhood Vy⊂(U0/sl⊃sh.leftG)(F)ofyand a closed subset
Zy⊂X(F), such that Zy⊂U(F), and for every x∈U0(F)mapping to Vy, one has
G(F)x⊂Zy. Then the pair(U0,X)is/divides.⊃lt0ω/divides.⊃lt0κ-nice.
Proof.It is enough to prove the assertion about distributions πX,U0,κ(ϕ)restricted to Vy,
i.e., whenψis supported on Vy. SetWy∶=X(F)∖Zy. Consider the open covering
X(F)=U(F)∪Wy. For every ϕ∈S(X(F),/divides.⊃lt0ω/divides.⊃lt0κ), we can write
ϕ=ϕU+ϕWy,
whereϕU∈S(U(F),/divides.⊃lt0ω/divides.⊃lt0κ)andϕWy∈S(Wy,/divides.⊃lt0ω/divides.⊃lt0κ). Nowbyourassumptions, thedistribution
πX,U0,κ(ϕU)=πU,U0,κ(ϕU)
is well deﬁned and of class C∞, whileπX,U0,κ(ϕWy)/divides.⊃lt0Vy≡0. This immediately implies the
assertion. /square
5.2.A version with smooth coarse moduli. LetXbe a smooth G-scheme over F
(whereG=GLN),LaG-equivariant bundle on X, andU0⊂Xan openG-invariant subset
such that there exists a smooth coarse moduli space U0/sl⊃sh.leftGof[U0/slash.leftG]. In other words, U0/slash.leftG
is a geometric quotient for the action of GonU0, but we do not require the action of Gon
U0to be free. Then the natural projection U0→U0/slash.leftGis smooth and its ﬁbers are exactly
G-orbits. Assume also that Ldescends to a line bundle LonU0/slash.leftG. We have natural
integration maps
πU0,κ∶S(U0(F),/divides.alt↪L/divides.alt↪κ)G(F)→S((U0/slash.leftG)(F),/divides.alt↪L/divides.alt↪κ),
and the results of Section 5.1 about extensions of these maps to ma psπX,U0,κof the form
(5.2) are still valid.
6.Application to BunG
6.1.Filtration of the stack of rank 2bundles. LetCbe a curve of genus g≥2.
Let Bun L0denote the stack of rank 2 bundles EonC, equipped with an isomorphism
det(E)≃L0, whereL0is a ﬁxed line bundle. Morphisms in this stack are isomorphisms
compatible with the identiﬁcations of the determinant bundles. In pa rticular, for L0=O,
BunOis the stack of SL 2-bundles on C.
It is well known that each stack Bun L0is admissible (but not of ﬁnite type). We denote
by Bunss
L0⊂BunL0the substack of semistable bundles.
Deﬁnition 6.1. For eachn, we deﬁne an open substack Bun≤n
L0⊂BunL0consisting of
bundlesEsuch that any line subbundle A⊂Ehas deg(A)≤n.
The ﬁltration(Bun≤n
O)plays an important role in the proof that the stack Bun SL2is
truncatable in [9, Sec. 6]. Note that Bun≤⌊deg(L0)/sl⊗sh.left2⌋
L0is exactly the substack of semistable
bundles Bunss
L0.SCHWARTZ κ-DENSITIES 27
Deﬁnition 6.2. For anyn, we deﬁne(Bun≤n
L0)0⊂Bun≤n
L0to be the substack consisting of
Esuch that for any degree nline subbundle A⊂Eone hasH1(A2L−1
0)=0.
Lemma 6.3. (i) ForE∈Bun≤n
L0, we haveE∈(Bun≤n
L0)0if and only if for any degree nline
bundleAwithH1(A2L−1
0)≠0one hasHom(A,E)=0.
(ii)(Bun≤n
L0)0is an open substack of Bun≤n
L0.
(iii) Every E∈(Bun≤n
L0)0∖Bun≤n−1
L0has formE=A⊕A−1L0, wheredeg(A)=nand
H1(A2L−1
0)=0.
(iv)(Bun≤n
L0)0=Bun≤n−1
L0unlessn≥(g−1+deg(L0))/slash.left2.
(v)(Bun≤n
L0)0=Bun≤n
L0forn>g−1+deg(L0)/slash.left2.
Proof.(i) Wejust have tonotethatif A→Eisa nonzero morphism froma linebundle Aof
degreenthenAis necessarily is a subbundle of E(otherwise, there would be a subbundle
inEof degree>n).
(ii) The subvariety Z⊂Picn(C)ofAwithH1(A2L−1
0)≠0 is closed in Picn(C), hence
proper. Therefore, the locus of Esuch that Hom(A,E)≠0 for some A∈Zis closed, and
so its complement is open.
(iii)Forsuch Ethereexistsalinesubbundle A⊂EsuchthatExt1(A−1L0,A)≃H1(A2L−1
0)=
0, so the extension 0 →A→E→E/slash.leftA→0, whereE/slash.leftA≃A−1L0, splits.
(iv) IfH1(A2L−1
0)=0 then deg(A2L−1
0)=2n−deg(L0)≥g−1. Hence,Ecannot have a line
subbundleAof degreenwithH1(A2L−1
0)=0 unlessn≥(g−1+deg(L0))/slash.left2.
(v) This follows from the fact that if deg (A2L−1
0)=2n−deg(L0)>2g−2 thenH1(A2L−1
0)=
0. /square
Lemma 6.4. Assumen≥(g−1+deg(L0))/slash.left2, and
Re(κ)⋅2(2n−deg(L0))−(2n−deg(L0)−g+1)/slash.left∈Z≤0
(resp.,
Re(κ)≠2n−deg(L0)−g+1
2(2n−deg(L0))
in the non-archimedean case). Then for every point x∈((Bun≤n
L0)0∖Bun≤n−1
L0)(F), there
exists a cocharacter λ∨∶Gm→Aut(x)such that in the archimedean case, for any character
a↦amofGmappearing in S●H0T∗
BunL0/divides.alt↪x, one has
Re(κ)⋅⟨χL,x,λ∨⟩+m≠−⟨∆alg
Aut(x),λ∨⟩;
while in the non-archimedean case,
Re(κ)⋅⟨χω,x,λ∨⟩≠−⟨∆alg
Aut(x),λ∨⟩.
Proof.By Lemma 6.3(iii), every Ein(Bun≤n
L0)0∖Bun≤n−1
L0has formE=A⊕A−1L0, with
deg(A)=nandH1(A2L−1
0)=0. Note that this implies that deg (A2L−1
0)≥g−1>0, hence
H0(A−2L0)=0.
One has
End0(E)≃O⊕A2L−1
0⊕A−2L0.28 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
Hence, the Lie algebra of automorphisms of E(with trivial determinant) is H0(O)⊕
H0(A2L−1
0), and the ﬁber of the canonical line bundle of Bun L0atEis identiﬁed with
ωBunL0/divides.⊃lt0E≃det(H1(O)∗)⊗det(H1(A−2L0)∗)⊗det(H0(A2L0)).
Let us consider the subgroup λ∨∶Gm↪Aut(E)acting by(a,a−1)onA⊕A−1L0. Since
the induced action of GmonA2L−1
0(resp.,A−2L0) has weight 2 (resp., −2), we have
⟨χω,λ∨⟩=2(χ(C,A2L−1
0)−χ(C,A−2L0))=4(2n−deg(L0)),
−⟨∆alg
Aut(E),λ∨⟩=2χ(C,A2L−1
0)=2(2n−deg(L0)−g+1)
(here we use the vanishing of h1(A2L−1
0)).
Also, the Gm-weights of H0T∗
BunL0,E≃H1(A−2L0)∗⊕H1(O)∗are 0 and 2. Hence, the
weights on the symmetric algebra of H0T∗
BunL0,Eare non-negative even integers. Now the
assertion follows from our assumption on κ. /square
6.2.Limits of very stable bundles. Recall that a rank 2 bundle EonCisvery stable
if any nilpotent Higgs ﬁeld φ∶E→E⊗ωCis zero. It is known that a very stable bundle
is stable.
We need some information on bundles which can appear as specializatio ns of very stable
bundles. Recall that a bundle E0is a specialization of Eif there exists a family of bundles
onC,(Es), parametrized by an irreducible base Sand a point s0∈Ssuch thatEs≃Efor
s≠s0andEs0≃E0.
Lemma 6.5. LetEbe a very stable bundle with det(E)≃L0. AssumeE0∈Bun≤n
L0, where
n≥deg(L0)/slash.l⟩ft2, is such that Hom(E,E0)≠0. ThenE0∈(Bun≤n
L0)0. In particular, Edoes
not specialize to any bundle in Bun≤n
L0∖(Bun≤n
L0)0, wheren≥deg(L0)/slash.l⟩ft2.
Proof.Assume that Hom (E,E0)≠0 andE0∈Bun≤n
L0∖(Bun≤n
L0)0. Then there exists an
exact sequence
0→A→E0→A−1L0→0
with deg(A)=n, whereH1(A2L−1
0)≠0. Sincen≥deg(L0)/slash.l⟩ft2, we have deg(A−1L0)≤
µ(E)=deg(L0)/slash.l⟩ft2, hence Hom(E,A−1L0)=0 by the stability of E.
Since Hom(E,E0)≠0, the exact sequence
0→Hom(E,A)→Hom(E,E0)→Hom(E,A−1L0)=0
shows that Hom(E,A)≠0. LetE→Abe a nonzero map. Such a map factors through a
surjectionE→A(−D), whereDis an eﬀective divisor. Therefore, Eﬁts into an extension
0→A−1L0(D)→E→A(−D)→0
Next, we observe that
Hom(A,ωCA−1L0)≃H0(ωCA−2L0)≃H1(A2L−1
0)∗≠0,
Hence, the composition
E→A(−D)→A→ωCA−1L0→ωCA−1L0(D)→KE
gives a nonzero nilpotent Higgs ﬁeld on E, soEcannot be very stable. /squareSCHWARTZ κ-DENSITIES 29
Corollary 6.6. Forn<(g−1+deg(L0))/slash.l⟩ft2, a very stable bundle Ewith determinant L0
never specializes to a bundle in Bun≤n
L0which is not isomorphic to E.
Proof.AssumeEspecializes to E0∈Bun≤n
L0, whereE0/slash.l⟩ft≃E. Applying Lemma 6.5 itera-
tively, and taking into account Lemma 6.3(iv), we see that E0is semistable. But then the
condition Hom(E,E0)≠0 gives a contradiction, since EandE0have the same slope and
Eis stable. /square
The following result on possible specializations of very stable bundles is not needed for
our argument but it clariﬁes the picture.
Proposition 6.7. LetEbe a rank 2very stable bundle, and let E0be a specialization
ofEsuch thatE0/slash.l⟩ft≃E. ThenE≃A⊕B, whereAandBare line bundles such that
Ext1(B,A)=0.
Proof.LetL0∶=det(E). By Corollary 6.6, E0∈Bun≤n
L0∖Bun≤n−1
L0for somen≥(g−1+
deg(L0))/slash.l⟩ft2. Hence, by Lemma 6.5, E∈(Bun≤n
L0)0∖Bun≤n−1
L0, and the assertion follows from
Lemma 6.3(iii). /square
6.3.Main theorems. Consider the open substack Mvs
L0⊂BunL0of very stable bundles,
and letMvs
L0be its coarse moduli space. The variety Mvs
L0is smooth and the line bundle ω
onMvs
L0descends to ωonMvs
L0.
Theorem 6.8. Assume that g≥2. For every open substack of the form [X/slash.leftGLN]in
BunL0, letXvs⊂Xdenote the open subset corresponding to very stable bundles . Then for
Re(κ)≥1/slash.left2, the pair(Xvs,X)is/divides.alt↪ω/divides.alt↪κ-nice, so there is a well deﬁned map
πκ∶S(BunL0,/divides.alt↪ω/divides.alt↪κ)→C∞(Mvs
L0,/divides.alt↪ω/divides.alt↪κ),
whereπκ(ϕ), viewed as a distribution, is given by absolutely convergen t integrals (5.3).
Proof.First, letXs⊂Xbe theG-invariant open subset corresponding to stable bundles
(whereG=GLN). Then we have a smooth geometric quotient Xs/slash.leftGof the action of Gon
Xs, which implies that the pair (Xvs,Xs)is/divides.alt↪ω/divides.alt↪κ-nice for any κ∈C.
Next, let us show that for n<(g−1+deg(L0))/slash.left2, the pair(Xvs,X≤n)is/divides.alt↪ω/divides.alt↪κ-nice for
anyκ∈C, whereX≤n⊂Xis theG-invariant open subset corresponding to Bun≤n
L0. Indeed,
since(Bun≤n
L0)0=Bun≤n−1
L0forn<(g−1+deg(L0))/slash.left2 (see Lemma 6.3(iv)), by Lemma
6.5, for such ntheG-orbits of points in Xvsare contained in Xs. Hence, the assertion
follows from Lemma 5.4 applied to the embedding Xs↪X≤n. In more detail, given a
compact set KofG-orbits inXvs/slash.leftG, we have a closed subset ZK⊂X(F)consisting of
points corresponding to bundles E0such that Hom(E,E0)≠0 for someE∈K. By Lemma
6.5, we have ZK⊂Xs(F). On the other hand, by semicontinuity of dimHom (E,E0), the
closures ofG-orbits inKare contained in ZK. Hence, we can apply Lemma 6.5 to deduce
that the pair(Xvs,X≤n)is/divides.alt↪ω/divides.alt↪κ-nice.
Next, we will use inductionon ntoprove thatfor every n, thepair(Xvs,X≤n)is/divides.alt↪ω/divides.alt↪κ-nice
for Re(κ)≥1/slash.left2. For some n≥(g−1+deg(L0))/slash.left2, let
X≤n−1⊂(X≤n)0⊂X30 ALEXANDER BRAVERMAN, DAVID KAZHDAN, AND ALEXANDER POLIS HCHUK
denote the open subsets corresponding to the substacks Bun≤n−1
L0⊂(Bun≤n
L0)0. By the
induction assumption (or the case n<(g−1+deg(L0))/slash.left2), we can assume that the claim
holds forX≤n−1, i.e, the pair(Xvs,X≤n−1)is/divides.alt↪ω/divides.alt↪κ-nice.
Note that we have
Re(κ)≥1
2>2n−deg(L0)−g+1
2(2n−deg(L0)).
Hence, byLemma6.4, wecanapplybyLemma5.2totheinclusion [X≤n−1/slash.leftG]⊂[(X≤n)0/slash.leftG]
and to the interval
(a,b)=(2n−deg(L0)−g+1
2(2n−deg(L0)),b)
withbsuﬃciently large, and deduce that the pair (Xvs,(X≤n)0)is/divides.alt↪ω/divides.alt↪κ-nice.
Finally, we would like to apply Lemma 5.4 to the embedding (X≤n)0⊂X≤n. We need to
check that the assumptions of this lemma are satisﬁed. Given a comp act setKofG-orbits
inXvs/slash.leftG, wehaveaclosedsubset ZK⊂X(F)consisting ofpointscorresponding tobundles
E0such that Hom(E,E0)≠0 for some E∈K. By Lemma 6.5, we have ZK⊂(X≤n)0(F).
On the other hand, by semicontinuity of dimHom (E,E0), the closures of G-orbits inK
are contained in ZK. Hence, by Lemma 5.4, the pair (Xvs,X≤n)is/divides.alt↪ω/divides.alt↪κ-nice.
SinceX≤n=Xfor suﬃciently large n, the assertion follows. /square
In the non-archimedean case we can also prove the following bounde dness result, which
implies that the stack S(BunL0)isκ-bounded for each κ∈Cin the terminology of [4, Def.
2.10].
Theorem 6.9. AssumeFis non-archimedean and g≥2.
(i) Forn>g−2+deg(L0)/slash.left2andRe(κ)≥1/slash.left2, the natural map
S(Bun≤n
L0,/divides.alt↪ω/divides.alt↪κ)→S(BunL0,/divides.alt↪ω/divides.alt↪κ)
is an isomorphism.
(ii) For any κ∈C, the map
S(Bun≤n
L0,/divides.alt↪ω/divides.alt↪κ)→S(BunL0,/divides.alt↪ω/divides.alt↪κ)
is an isomorphism for large enough n.
Proof.(i) It suﬃces to prove that under these assumptions the map
S(Bun≤n
L0,/divides.alt↪ω/divides.alt↪κ)→S(Bun≤n+1
L0,/divides.alt↪ω/divides.alt↪κ) (6.1)
isanisomorphism. WearegoingtoapplyLemma 3.23(i)totheinclusionBu n≤n
L0↪Bun≤n+1
L0.
First of all, we observe that by Lemma 6.3(v), we have Bun≤n+1
L0=(Bun≤n+1
L0)0, so by
Lemma 6.3(iii), every E∈Bun≤n+1
L0∖Bun≤n
L0has formE=A⊕A−1L0, whereH1(A2L−1
0)=0.
In this case deg(A2L−1
0)>0, soH0(A−2L0)=0. It follows that the group Aut (E)is
the semidirect product of Gmacting by(a,a−1)onA⊕A−1L0with the additive group
Hom(A−1L0,A)=H0(A2L−1
0). Together with Lemma 6.4 this implies that the assumptions
of Lemma 3.23(i) are satisﬁed and we deduce that the map (6.1) is an is omorphism.
(ii) PickNsuch thatN>g−2+deg(L0)/slash.left2 and Re(κ)≠2n−deg(L0)−g+1
2(2n−deg(L0))forn>N. Then the
same argument as in (i) shows that (6.1) is an isomorphism for n≥N. /squareSCHWARTZ κ-DENSITIES 31
Note that Theorems 6.8 and 6.9 imply [4, Conj. 3.5(1)] for G=SL2.
References
[1] A. Aizenbud, D. Gourevitch, Schwartz functions on Nash manifolds , IMRN(2008), no.5, Art. ID rnm
155, 37 pp.
[2] A. Aizenbud, D. Gourevitch, Smooth transfer of Kloosterman integrals (the archimedean case), Amer.
J. Math. 135 (2013), no. 1, 143–182.
[3] A. Aizenbud, D. Gourevitch, Generalized Harich-Chandra descent, Gelfand pairs and an a rchimedean
analog of Jacquet-Rallis’s theorem , Duke Math. J. 149 (2009), no. 3, 509–567.
[4] A. Braverman, D. Kazhdan, Automorphic functions on moduli spaces of bundles on curves over local
ﬁelds: a survey , arXiv: 2112.08139.
[5] A. Braverman, D. Kazhdan, A. Polishchuk, Hecke operators for curves over non-archimedean local
ﬁelds and related ﬁnite rings , arXiv:2305.09595.
[6] J. Bernstein, Representations of p-adic Groups , Notes of lectures at Harvard Univ., 1992, available at
math.tau.ac.il/∼bernstei.
[7] J.Bernstein, A.Zelevinsky, Representations of the group GL(n,F), whereFis a local non-Archimedean
ﬁeld, Uspehi Mat. Nauk 31 (1976), no. 3, 5–70.
[8] P. Cartier, Representations of p-adic groups: a survey , inAutomorphic forms, representations and
L-functions (Corvallis, Ore., 1977) , Part 1, 111–155, AMS, Providence, RI, 1979.
[9] V. Drinfeld, D. Gaitsgory, Compact generation of the category of D-modules on the stack of G-bundles
on a curve , Camb. J. Math. 3 (2015), no. 1-2, 19–125.
[10] P. Etingof, E. Frenkel, D. Kazhdan, An analytic version of the Langlands correspondence for com plex
curves, arXiv:1908.09677.
[11] P. Etingof, E. Frenkel, D. Kazhdan, Hecke operators and analytic Langlands correspondence for curves
over local ﬁelds , arXiv:2103.01509.
[12] P. Etingof, E. Frenkel, D. Kazhdan, A general framework for the analytic Langlands corresponde nce,
arXiv:2311.03743.
[13] D. Gaitsgory, D. Kazhdan, Algebraic groups over a 2-dimensional local ﬁeld: some further construc-
tions, inStudies in Lie theory , 97–130, Birkh¨ auser Boston, MA, 2006
[14] A. Grothendieck, Produits tensoriels topologiques et espaces nucl´ eaires , Mem. AMS 16 (1955).
[15] Y. Sakellaridis, The Schwartz space of a smooth semi-algebraic stack , Selecta Math. (N.S.) 22 (2016),
no. 4, 2401–2490.
[16]Stacks project , at stacks.math.columbia.edu.
Deparment of Mathematics, University of Toronto, Ontario, Canada
Email address :braval@math.toronto.edu
Einstein Institute of Mathematics, The Hebrew University o f Jerusalem, Jerusalem
91904, Israel
Email address :kazhdan@math.huji.ac.il
Department of Mathematics, University of Oregon, Eugene, O R 97403, USA; National
Research University Higher School of Economics, Moscow, Ru ssia
Email address :apolish@uoregon.edu