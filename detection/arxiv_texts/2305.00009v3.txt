Reconstructing Cardiac Electrical Excitations from Optical Mapping
Recordings
C. D. Marcotte,1,a)M. J. Hoffman,2F. H. Fenton,3and E. M. Cherry4
1)Department of Computer Science, Durham University, Durham, UK, DH1 3LE
2)School of Mathematical Sciences, Rochester Institute of Technology, Rochester, NY, USA,
14623
3)School of Physics, Georgia Institute of Technology, Atlanta, GA, USA, 30332
4)School of Computational Science and Engineering, Georgia Institute of Technology, Atlanta, GA, USA,
30332
(Dated: 6 September 2023)
The reconstruction of electrical excitation patterns through the unobserved depth of the tissue is essen-
tial to realizing the potential of computational models in cardiac medicine. We have utilized experimental
optical-mapping recordings of cardiac electrical excitation on the epicardial and endocardial surfaces of a
canine ventricle as observations directing a local ensemble transform Kalman Filter (LETKF) data assimila-
tion scheme. We demonstrate that the inclusion of explicit information about the stimulation protocol can
marginally improve the confidence of the ensemble reconstruction and the reliability of the assimilation over
time. Likewise, we consider the efficacy of stochastic modeling additions to the assimilation scheme in the
context of experimentally derived observation sets. Approximation error is addressed at both the observation
and modeling stages, through the uncertainty of observations and the specification of the model used in the
assimilation ensemble. We find that perturbative modifications to the observations have marginal to delete-
rious effects on the accuracy and robustness of the state reconstruction. Further, we find that incorporating
additional information from the observations into the model itself (in the case of stimulus and stochastic
currents) has a marginal improvement on the reconstruction accuracy over a fully autonomous model, while
complicating the model itself and thus introducing potential for new types of model error. That the inclusion
of explicit modeling information has negligible to negative effects on the reconstruction implies the need for
new avenues for optimization of data assimilation schemes applied to cardiac electrical excitation.
Keywords: data assimilation, cardiac dynamics, experimental data
Typical cardiac electrophysiology experiments
record excitation data with optical cameras that
are tuned to measure fluorescence of voltage-
sensitive dyes and are only able to observe excita-
tion patterns on the surfaces of tissues. We know
from theoretical and computational evidence that
the details of excitation patterns through the
depth of tissues are important for prediction and
control, while those observable on the surface
are a very small portion of the overall excitation
structure. These patterns may be pro-arrhythmic
due to structures that are unobservable near the
surfaces of the tissue, which can pin organizing
features of the dynamics and thus simplify the
excitation patterns. As the interiors of the tis-
sue are inaccessible using traditional experimen-
tal means, we turn to reconstructing the interior
using computational methods—specifically, data
assimilation.
a)Corresponding Author: christopher.marcotte@durham.ac.ukI. INTRODUCTION
Experiments in cardiac excitation dynamics provide
only a limited window into a very complex system.
Micro-electrode recordings trade spatial resolution for
temporal resolution, electrocardiograms eschew cellular
detail for organ-level holism, and optical-mapping exper-
iments focus on the electrical excitations near the ex-
posed surfaces of a tissue whose internal dynamics may
be much more complex. Data assimilation (DA) promises
to address the difficulties of the latter; with a reliable dy-
namical model and sufficiently precise observations of the
experimental state, the techniques of data assimilation
aim to reconstruct the unobserved interior dynamics of
the tissue, subject to the observations at the surface(s).
Importantly, the techniques of data assimilation are ro-
bust with respect to uncertainty, as the uncertainty of
the truth state and of the observation values, as well as
of the specificity of model predictions, are all ever-present
when working with real experimental data.
Data assimilation has co-developed with the weather
and climate forecasting communities, for whom the tools
are often specialized and well-tuned. Ensemble meth-
ods, in particular, are relative newcomers to the applica-
tion1, but are favored due to their simpler relationshiparXiv:2305.00009v3  [q-bio.QM]  5 Sep 20232
to nonlinear dynamical models. Numerous studies have
developed new data assimilation methods and compared
them to existing approaches2–7, developed innovations
for improving the performance8,9and robustness of re-
sults from data assimilation10, defined fair scoring rules
for the rigorous definition of ‘improving’ data assimila-
tion results11–14, and even considered such subtleties as
the connection between the observations, assimilation fil-
ter, and the model15–18.
Significant efforts in the assimilation of cardiac exci-
tation patterns in three-dimensional tissue have focused
on the foundational aspects of the problem—data dis-
tributions, uncertainty quantification, model error, and
robustness with respect to noise19–21—in the context of
synthetic observations generated by a model, rather than
from experiment. In previous work22we have found a
sensitivity to some parameter uncertainties in the accu-
racy of local ensemble transform Kalman filter (LETKF)
reconstructions, as well as improved robustness and ac-
curacy with stochastic formulations of the underlying
model. This work considers the efficacy of our recon-
struction schemes in the case of experimental data typical
of the field: periodic pacing of a tissue, with excitations
captured by optical mapping on the epicardial and endo-
cardial surfaces of the tissue.
Throughout this manuscript we will be using a dataset
previously published in experimental studies23–26. The
dataset corresponds to activation patterns subject to
a localized, periodic, current stimulation in canine ven-
tricular tissue. We will investigate the use of both au-
tonomous and non-autonomous models for the recon-
struction of these experimental observations, and the ef-
fect of stochastic model interventions on the accuracy of
the reconstructions. Finally, we investigate the effect of
additional synthetic observations generated in the inte-
rior of the tissue on the robustness of the assimilation and
accuracy of the reconstruction of experimental dynamics.
II. METHODS
In this section we outline the mathematical details of
the dynamical model, the determination of reasonable
model parameters, the generation of observations from
the experimental data, and finally the local ensemble
transform Kalman filter (LETKF) used in the assimi-
lation of the observations for the reconstruction of the
experimental dynamics.
A. Model
We use the Fenton-Karma three-variable model27for
the electrophysiology, with anisotropic diffusion con-
trolled by a fiber orientation that rotates with in the
x, y-plane with depth, denoted by angle with respect tothex-axis, θ(z). The evolution equations are
∂tu− ∇ · (D(x)∇u) =Istim−Ifi−Iso−Isi, (1)
∂tv= Θ( uc−u)(1−v)/τ−
v(u)−Θ(u−uc)v/τ+
v(2)
∂tw= Θ( uc−u)(1−w)/τ−
w−Θ(u−uc)w/τ+
w,(3)
in conjunction with the no-flux boundary conditions, ˆn·
D(x)∇u= 0. The currents and explicit relaxation scale
forvare given by
Ifi(u, v) =−vΘ(u−uc)(1−u)(u−uc)/τd,(4)
Iso(u) =uΘ(uc−u)/τo+ Θ(u−uc)/τr, (5)
Isi(u, w) =−w(1 + tanh( k(u−usi
c)))/(2τsi),(6)
τ−
v(u) =τ−
v1Θ(u−uv) +τ−
v2Θ(uv−u), (7)
save for the explicit stimulation current Istim(t,x), which
is zero identically for autonomous dynamics, and is spec-
ified in particular assimilation experiments (see Sec-
tion III A 3). The diffusive spatial coupling is imple-
mented using a finite-difference scheme that follows that
in the original model description27. The diffusive cou-
pling of the tissue is subject to fiber orientation that ro-
tates through the tissue depth d,θ(z) =θ0+δθ(−1/2 +
z/d), where 0 ≤z≤d,θ0andδθare specified through-
out this manuscript, with D∥= 0.001 cm2/ms and
D⊥= 0.0002 cm2/ms, for an (diffusion) anisotropy ratio
D∥/D⊥= 5, which is relatively small compared to some
ratios measured in cardiac tissue28,29.
We use the model parameters defined in Ref. 26 for
this model and experimental dataset. These parameters
are quite different from other parameter sets used with
this model for physically relevant dynamics; cf. Ref. 27.
However, for the present investigation we have opted to
consider the smallest model errors to better determine
the affect of changing the model and observation proper-
ties.
In all experiments, we use a Rush-Larson time-
stepping scheme for the gating variables vandwcom-
bined with a Forward-Euler method for the transmem-
brane potential u30. When we incorporate stochastic ef-
fects (cf. Section III A 4) we adapt the Forward-Euler
method for the transmembrane potential uto an Euler-
Maruyama method. In this work we do not incorporate
stochastic terms in the dynamics of the gating variables,
as previous work demonstrated that similar ensemble in-
flation effectiveness can be achieved with only stochastic
currents for this model22, which makes the implementa-
tion simpler and more performant.
B. Observation extraction
The experimental data comprises optical recordings of
fluorescence (c.f., Ref. 23 and 31 for details of the orig-
inal preparation) corresponding to transmembrane po-
tential, which have been smoothed and denoised. The
observations ( yo) are a vector of tuples ( yo
i) containing3
a tag designating the observed field variable, coordinates
in the domain ([ xi, yi, zi]), the observed field variable at
these coordinates (e.g., ui=u(xi, yi, zi)), and the un-
certainty of the observation value ( ηi), for each observa-
tion. The observed field values are also normalized such
that 0 ≤ui≤1. As the observations only cover the
transmembrane potential u, we may use yo
ianduiinter-
changeably to denote the values of the observations. The
recordings cover response excitations for canine ventricle
tissue subject to a periodic stimulus applied from a single
position, across a large range of stimulus periods or basic
cycle lengths (BCLs).
t [ms]54005700 6000u
0.00.51.0
u
0.00.51.0(a) (b)
(c)
EPI
ENDO
FIG. 1. Example of the experimental data used for the recon-
struction experiments. (a) Epicardial snapshot and (b) endo-
cardial snapshot at time t= 5734 ms, with (c) time traces of
the recording at positions labeled by the + (epicardial) and
×(endocardial) markers. The thin black curve in (a) and (b)
designates the boundary of the opposing surface recording,
and the thick black curve designates the boundary of their
mutual intersection. The inset dashed square has side-length
3 cm, aligned to the horizontal and vertical axes, and shows
the region selected to extract observations for assimilation.
For the purposes of this study, we have focused on a
dataset with stimulation period of 118 ±2 ms, as the pat-
terns generated with this short stimulation period are the
most irregular, spatially and temporally, and thus present
the most challenging reconstruction task. An example of
the recordings from this dataset is shown in figure 1, de-
tailing (a) the epicardial and (b) the endocardial surface
recordings, along with (c) temporal traces of the record-
ing at the center-points of the tissue surfaces. The figure
likewise shows an inset 3 cm square used for the gener-
ation of the observation sets for the assimilation exper-
iments, as well as the boundaries for the epicardial and
endocardial surfaces. The recording features a very fast
wavefront propagating from figure-upper-left to figure-
lower-right, nearly simultaneously on both surfaces (c.f.
figure 1(c)) from a stimulus current applied to the base
of the endocardium23.
Over time this data displays the alternans typical ofcardiac tissue excitation paced faster than the normal
rhythm, namely, variation in the duration and ampli-
tude of the action potential. We generate observations
from the dataset by constructing a cubic interpolant over
space with linear interpolation over time, for both the
epicardial and endocardial datasets, and sampling into
this interpolant for pre-specified coordinates correspond-
ing to the inset domain shown as dashed squares in fig-
ure 1(a,b). In the case of synthesized observations gener-
ated for the interior of the domain (cf. Section III B 1) we
linearly interpolate through the depth between the val-
ues of the observations at the projected positions on the
surface to determine the value of the synthesized observa-
tion in the interior. This ensures that we are propagating
information from the surfaces into the mid-depth.
Each yo
iis likewise assigned an uncertainty ηi, which
we identify as η= 0.05, or 5% of the action potential
amplitude range, by default. The value of η= 0.05 was
estimated from the full-width at half-maximum of the
distribution of uo(t)−uo(t−τ) for the dataset, with
τthe assimilation interval. See figure S2 for a detailed
motivation of this computation. In the case of syn-
thetic observations interpolated into the mid-depth of
the tissue (cf. Section III B 1), we assign a larger uncer-
tainty, ηi=η= 0.5, to account for the perturbative effect
of these synthetic observations on the assimilated state,
since the diagonal elements of the observation covariance
are related to the inverse, Rii=η−1
i; i.e., they contain no
new information from the experimental data other than
a highly uncertain suggestion that the mid-plane is ex-
cited or unexcited at a particular place and time. In the
case of encoding uncertainty about the precise form of
the wavefronts (cf. Section III B 2), we perform a similar
modification of the observation uncertainty, using a non-
linear function of the observation field value η(yo
i) which
is bounded by [ η,η] and peaks at η= 0.5 foryo
i= 0.5.
C. LETKF
The Ensemble Transform Kalman Filter (ETKF) finds
best-fit linear combinations of the prior states to match
a set of observations in a quadratic sense. The LETKF32
transforms an ensemble representing the prior covariance
and mean in accordance with the local observations of the
state, to affect an ensemble representing the posterior
covariance and mean. We consider the classical Kalman
filter optimization functional33,
J(x) =(x−xb)⊤(Pb)−1(x−xb)+ (8)
(yo−H(x))⊤R−1(yo−H(x)),
where the prior ensemble of size Mis the sum of the en-
semble deviation matrix ( Xb) and mean ( xb),xb=Xb+
xb[1, . . .]⊤, similarly for the decomposition of the poste-
rior ensemble, xa. The covariance of the prior ensemble
is described by the matrix Pb= (M−1)−1Xb(Xb)⊤.
The observations of the physical state are collected in4
yo∈RO, while the observation operator H:RN→RO
transforms from the state space to the observation space,
and matrix R∈RO×Odescribes the covariance of the
observations. The observation operator maps the state
vector to the observations, with additive noise per ob-
servation with variance η, according to the uncertainty.
The minimizing solution to (8) is denoted by the analysis
ensemble, xa, which best approximates the truth state as
observed by the data yoand constituted from the back-
ground ensemble xb.
The ETKF applies the analysis update in the span
of the background ensemble states. The analysis en-
semble covariance is expressed as ˜Pa= [(M−1)I/ρ+
(Yb)⊤R−1(Yb)]−1, where ˜Pa∈RM×M, and the anal-
ysis ensemble mean xa=xb+Xbwa. The scalar fac-
torρ≥1 is the (uniform, constant) multiplicative co-
variance inflation factor. The mean weights are deter-
mined by xa=˜Pa(Yb)⊤R−1(yo−yb). The weights of
the analysis ensemble mean deviations are similarly ex-
pressed in the basis of the background mean deviations,
Wa= [(M−1)˜Pa]1/2, and xa=xb+Xb(wa+Wa).
This deviates from the error subspace transform Kalman
filter (ESTKF)2, which performs the transformation in
the (M−1)-dimensional subspace corresponding to the
span of Xb.
The LETKF extends this analysis update in the space
of the background ensemble locally – in the sense of the
observation influence and the covariance. The inclusion
of observation and covariance localization applies the pre-
ceding analysis to each element of the state vector, where
the inclusion of observations for a particular state vec-
tor element is determined by the localization procedure.
In this work we use an isotropic localization weighting
controlled by multiplying the background covariance ma-
trixPbby a decaying fifth-order function, which goes to
zero at a distance of 2/radicalbig
10/3σo, where we have retained
σo= 6 (21 .9 spatial units, or ≈0.33 cm) for consis-
tency with our earlier work. We refer the reader to Ref-
erences 20, 22, and 32 for further mathematical details
of the implementation of the localization procedure.
Finally, in lieu of an optimized multiplicative and ad-
ditive inflation scheme, we used multiplicative inflation
only. The LETKF utilizes multiplicative inflation of the
analysis ensemble deviations ( Xa=xa−xa) with a fixed
value of ρ= 1.05. We did not utilize additive inflation in
this work, despite previous results that showed it to be ef-
fective22, in the expectation that our stochastic approach
would similarly affect the ensemble while requiring sub-
stantially less disk space.
III. RESULTS
We report results for several data-assimilation experi-
ments. In all experiments, we use an observation dataset
derived from optical-mapping recordings of periodic stim-
ulation of a canine ventricle and a fixed model integration
time (equivalently, assimilation interval) of Ta= 2 msbased on the data recording frequency. The assimilation
outputs are the background ( xb) and analysis ensembles
(xa), their respective means x∗=M−1/summationtextM
m=1x∗
mwhere
m= 1, . . . , M indexes the ensemble, and their ensemble
spreads,
SPRD∗= (M−1)−1/parenleftiggM/summationdisplay
m=1|x∗
m−x∗|2/parenrightigg1/2
,(9)
which is the variance of the ensemble state vectors. We
have used here the vector-of-vectors notation for the en-
sembles, x∗= [x∗
1, . . . ,x∗
M], but we may equivalently
make the spatial ( ijk), variable ( l), and ensemble ( m)
indices explicit in a five-index array, x∗= [x∗
ijklm] where
the indices ( i, j, k, l ) are linearized for the vector form.
We report the root-mean-square-error (RMSE) of the
reconstruction by the point-wise error of the recon-
structed state by comparing the ensemble mean to the
observations yo(t),
RMSE∗=/parenleftigg
N−1
obsNobs/summationdisplay
i=1|yo
i−x∗
ι(i)|2/parenrightigg1/2
, (10)
where yo
i(t) is the i-th observation, and the index ι(i)
maps the corresponding observation index ito the corre-
sponding element of the state vector. Thus, the RMSE∗
summation is restricted in our experiments to the sur-
faces of the domain. Depth information is available from
SPRD∗; by reducing over indices of the state vector cor-
responding to the length and width we find a measure
of the spread through the depth of the domain for each
state variable,
SPRD∗
kl=/radicaltp/radicalvertex/radicalvertex/radicalbt(nxny)−1nx/summationdisplay
i=1ny/summationdisplay
j=1(SPRD∗
ijkl)2, (11)
where we have implicitly reshaped SPRD∗from a vector
to a four-dimensional array with explicit spatial ( i, j, k )
and variable ( l) indices. In the experiments, this scalar
field is computed for the background ensemble xbandu
field elements of the SPRDbover time and reported as
SPRDb
u(t, z).
The definition of (10) restricts its evaluation to the
subset of the domain where there are observations, which
tell us nothing about the consistency of the interior recon-
structions. Canonical reporting of reconstruction con-
sistency for unknown states is handled by proper scor-
ing rules, like the continuous ranked probability score
(CRPS) of the ensemble, which can be formulated solely
in terms of the ensemble states without (necessary) re-
course to observations or a ‘truth’ state.34We refer to
the kernel representation of the adjusted CRPS35,
CRPS∗(xb,y) =M/summationdisplay
m=1∥xb
m−y∥
M−M/summationdisplay
m,m′=1∥xb
m−xb
m′∥
2M(M−1),
(12)5
withy=yoory=xaas CRPSoor CRPSa, respectively,
which has desirable properties for exchangable ensembles
with i.i.d. members irrespective of ensemble size M. In
the above, the norm ( ∥···∥ ) corresponds to the 1-norm
over the indices of the vector y. When yreferences the
observations yo, then the summation is over the obser-
vations (and thus surface-restricted); when yreferences
the analysis ensemble mean xathe sum measures the con-
sistency of the entire background ensemble with respect
to the best approximation of the observations according
to the LETKF, xa, over the entire state. We encourage
the reader to peruse the Supplementary materials for a
closer look at representative dynamics of the reconstruc-
tion over time.
A. Influence of model variations on reconstruction
accuracy
We have run several experiments for the reconstruc-
tion of cardiac excitation patterns. In the simplest case,
we compute the baseline accuracy of the reconstruction
procedure by incorporating information about the stim-
ulus pattern in the observations into the model dynam-
ics, without any assimilation procedure. Additionally,
we consider a strong assimilation process without this
stimulus information, to assess the importance of mod-
eling the non-autonomous forcing inherent to the obser-
vation data for the reconstruction accuracy. Finally, we
incorporate the stimulus forcing into the model dynam-
ics in concert with a strong assimilation procedure; this
approach maximizes the information supplied to the as-
similation and provides clear measure of the importance
of non-autonomous model information to the reconstruc-
tion reliability.
1. Free-Run
To begin, we ask to what degree the assimilation pro-
cedure may be responsible for the reconstruction of the
state, compared with the averaging procedure of the en-
semble and the synchronization of the ensemble states
with the stimulus cadence. We solely assess the uncon-
trolled dynamics of the ensemble members with the stim-
ulus forcing (as, in the absence of stimulus forcing, the
ensemble member states all return to quiescence) for the
reconstruction problem. To this end, we report the recon-
struction results with the assimilation update excised –
equivalently, the observations are not permitted to affect
any of the state variables – where the model is stimu-
lated periodically to match the stimulus observed in the
observations.
In the free-run setting we perform no assimilation
by explicitly filtering all observations from the analysis
computation, so that the LETKF reduces to a scaling-
permutation operator as the ensemble index is not guar-
anteed to be preserved, and xa≡xb. The Free-Runexperiment serves as an effective method of distinguish-
ing the improvement due to the LETKF and the stimulus
model in the reconstruction over long assimilation times.
Additionally, to avoid the trivial solution, we include a
stimulus current forcing in the dynamical model for the
free-run experiment. Thus, in this setting, we are testing
the accuracy of reproducing the observations with only
the model and stimulus information, without recourse
to the assimilation method. We constructed an explicit
stimulus current for the ensemble model using the ob-
servation data. We determined the period T, temporal
offset t0, and centroid position x0for the stimulus current
assuming a model of the form,
Istim(t,x) =I0Π(t) e−κ2((x−x0)2+(y−y0)2), (13)
which affects the dynamics of u(t,x) by entering the evo-
lution equations in addition to the autonomous currents
Iso,Ifi, and Isipresent in the dynamical model. The
stimulus current is temporally modulated by the ‘top-
hat’ function Π( t), which turns the stimulus current ‘on’
for a short interval τon(Π(t) = 1) and otherwise leaves
it ‘off’, Istim= 0 (Π( t) = 0).
The experiment which produced the dataset used in
this study use a periodic biphasic stimulation, applied
outside of the assimilated domain at the base of the en-
docardium. The stimulus current model, equation (13),
is monophasic and independent of depth, which is not
the same as the experimental stimulus current. Rather,
the our stimulus current model approximates the effect
of the experimental stimulus on the observations within
the assimilated domain; i.e. it is a data-driven model,
and only approximates the observed effects. As we only
observe the effect of the experimental current some dis-
tance from its direct point of application, we effectively
filter the experimental stimulus current through the tis-
sue observations to construct our stimulus current model.
Throughout, we set I0= 0.1 ms−1, with the duration
of the stimulus set to τon= 10 ms, and set the spatial
scale of the stimulus current to ( κ/hx)2= 5×10−4to
match that observed in the observation data. The period
between successive stimuli is 118 ms, likewise matching
the observation data. Tests were performed to assess the
impact of the stimulus current parameters on the state,
which were found to tall into two classes: (a) sub-critical
(non-excitatory) and (b) super-critical (excitatory) stim-
uli, which showed no meaningful variation for physically
realistic values within each class. This critical excitation
phenomenon is well-understood in the one-dimensional
case.36–38
In figure 2, we show the CRPSa,o(t), the RMSEb(t),
and the spread through the depth of the tissue
SPRDb
u(t, z) for the Free-Run experiment using the
Barone et al . parameter set. The CRPSo(t) and
CRPSa(t) indicate signficant disagreement between the
background ensemble and the observations, as well as
in comparison to the analysis ensemble mean. The
RMSEb(t) indicates that the ensemble does not accu-
rately reconstruct the surface dynamics in the absence6
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. 2. Free-Run experiment results, depicting the (a)
CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t) (line)
plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
of assimilation, as expected. Furthermore, the variabil-
ity of RMSEb(t) decreases over time, as the forcing of the
stimulus current synchronizes the large-scale features of
the ensemble states as information about the ensemble
initialization is slowly lost. Likewise, the SPRDb
u(t, z)
is nearly invariant with respect to z, indicating that we
correctly restore the z-invariance symmetry of the ensem-
ble states when the observations are not present in the
reconstruction procedure.
These results serve as a baseline for comparing with
the experiments to follow. For the Free-Run experiment
we have used our unmodified observation set and stan-
dard ensemble initialization, with the stimulus model and
absent any assimilation. The ensemble means therefore
do not correspond to a reconstruction, as there are no
guiding observations, and so we do not show the mean
fields.
2. Autonomous model
The first experiment uses an autonomous, determinis-
tic, cardiac excitation model for the ensemble members
in the assimilation of these observations to consider the
significance of model error arising from model parameters
which may or may not effectively reproduce the observed
action potentials. Instead of adapting the model to ev-
ery stimulus protocol, it is dramatically simpler to use
the properties of the Kalman filter to match the peri-odicity of the stimulation without explicit recourse to a
modelled stimulus pattern. This approach has the obvi-
ous limitation that we have rejected a potential source of
additional information and introduced latency into the
assimilation, as the ensemble can only react to the next
stimulus after it has already appeared in the observa-
tions. Given this restriction, this experiment shows the
worst-case, ‘low-information’, estimate of the state of the
system using the LETKF assimilation infrastructure. We
refer to this experiment as ‘Autonomous’.
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. 3. Autonomous experiment results, depicting the (a)
CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t) (line)
plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
Figure 3 shows the (a) CRPSa,o(t), (b) RMSEb(t), and
(c) SPRDb
u(t, z) metrics over time for the reconstruction
using the Fenton-Karma model with the Barone et al.
parameter set. The assimilation does a very good job
of reconstructing the surfaces of the state to match the
observations after the initial transient, which arises from
the phase mismatch of the initial ensemble and the ob-
servations, producing high initial error. The CRPSo(t)
is strongly correlated with the RMSEb(t), as expected,
and CRPSa(t) remains small over long time scales, grow-
ing slowly and oscillating due to the underlying excita-
tion period. This behavior is due to the lag inherent to
this assimilation experiment, due to the information of
the next excitation needing to propagate through the full
LETKF before affecting the background ensemble. The
dominant contribution to the RMSEb(t) corresponds to
a peak occuring during the full excitation of the domain,
with fast relaxation of the error as the excitation ampli-
tude dissipates. One interpretation of this contribution is7
that, on the surfaces, the LETKF struggles with the un-
certainty of the wavefront and deviation of the recorded
wavefront shape from those generated by the nonlinear
model for the background ensemble (the model lags the
observed wavefront, by construction), but manages to
reproduce the waveback accurately. Indeed, the innova-
tion of the LETKF is large during the propagation of the
wavefront—the LETKF is correcting a slow CV in the
model to match the excitation pattern observed in the
data—and relatively smaller during the propagation of
the waveback. The spread for this parameter set begins
small and quickly grows in the interior, representing the
dominant contribution of the uncertainty of the state of
the system, as expected. As the information about the
excitation propagates from the surfaces toward the inte-
rior of the domain, it is clear that the LETKF is unable
to constrain the interior of the solution using only the
surface observations. That said, the maximum of the
spread at z/d= 1/2 saturates after t≈250 ms, indicat-
ing that this time period reflects the true uncertainty of
the interior.
On the surfaces, after an excitation, the next action
potential (AP) is driven by the assimilation perturbing
the state in an appropriate region to cause a new prop-
agating wave that matches those in the observations, as
expected. Additionally, as the different parameter sets
generate APs with different wave speeds ( c∥≈/radicalbig
D∥/τd),
the assimilation continually corrects the propagation di-
rectly ahead of the wavefront. When the wave is slightly
too slow, this correction is effective as the region pre-
ceeding the wavefront is expected to be excitable; thus
small perturbations ahead of the wave create a new front
that connects to the existing lagged wavefront before the
next assimilation time. When the wave is slightly too
fast, this correction is ineffective, as reducing the value
ofuby a small amount on the wavefront does not sig-
nificantly hinder the propagation—doing so requires a
larger, quenching, perturbation related to the gap be-
tween the middle unstable nullcline of Ifiand the rest
state. This asymmetry in effective control is apparent on
the surfaces because of the presence of observations, and
likewise means uncontrolled wave speed errors propagate
in the interior.
The phenomenology of the assimilation dynamics is
exemplified by figure 4, which shows z-slices of the back-
ground ensemble mean xbat fixed depths for three sam-
ple times from the Autonomous experiment. Near the
beginning of a new excitation in the observations, cf. fig-
ure 4(a), the ensemble mean is a very good approxima-
tion of the distribution of the excitation at the surfaces
(z/d= 0.0,1.0) while the interior slices are not reason-
able approximations to an interpolating function through
the depth. Rather, the interior is too uncertain to match
the propagation of a wave across the domain, which we
expect to pass uniformly in z, in time with the surfaces.
Further, these slices highlight a significant contribution
to the model error: the timing of the front in the ensem-
ble is lagged compared to the observation data. This
uo
ub
uo
ub
uo
ub
uo
ub
uo
z/d=0.0ub
z/d= 0 .2
z/d=0.5
z/d=0.8
z/d=1.0
t=700.0 [ms] (a)
t=708.0 [ms] (b)
t=716.0 [ms] (c)
t=756.0 [ms] (d)
t=772.0 [ms] (e)
uo, ub0.0 0.5 1.0FIG. 4. Slices of the the u-field of the observations ( uo)
and the background ensemble mean ( ub) at depths z/d=
0.0,0.2,0.5,0.8,1.0 and times t= 700 ,708,716,756,772 ms
for (a-e), respectively.8
behavior is due to the interaction of three phenomena re-
lated to the timing of the periodicity of the observations
and how these synchronize the ensemble dynamics.
The first and most significant is the slower conduction
velocity of the model than the observation data. Despite
being manually tuned to the data26, the parameter set
is unable to adequately match the observed front speed
without a significant overestimate of the tissue conduc-
tivity (cf. Ref. 26, their σ∥= 9×D∥andσ⊥= 15×D⊥)39
and thus any timing of the excitation wave in the ensem-
ble with the observations becomes a significant, ongo-
ing, correction for the LETKF. Previous in silico studies
have found the LETKF to adequately address a variety
of systemic model errors in 3D, including fiber angle ro-
tation, tissue conductivity, and the explicit time scales of
the model.20–22Ahead of the wavefront, the LETKF can
readily excite the leading edge of quiescent tissue in the
ensemble member states, speeding up the front to match
the excitation propagation in the observations, provided
there are ensemble members that are already excited in
that leading region. Due to the slower conduction ve-
locity, this scenario is rarely the case, as the ensemble
members synchronize their phase with the observations
due to the driving of the LETKF.
The second contributor to the model error is the lag
inherent to the propagation into the interior of the do-
main for the autonomous model. The interior dynamics
are lagged by at least τ≈c⊥d/2, the time it takes in-
formation on the surfaces to propagate to the interior
for a transverse wave speed of c⊥. Thus, even when the
surfaces correctly estimate the distribution of the excita-
tion in the observations, the interior distribution is dom-
inated by the dynamics from several assimilation steps
ago. These discrepancies are systematic errors in the
reconstruction that are largely invisible to the RMSEb
metric, as it relies on the surface observations, but should
affect CRPSaif the ensemble members differ in the inte-
rior, and likewise SPRDb
u(t, z).
The third contributor is the lag associated with the
autonomous model dynamics due to the lack of stimu-
lus information. During quiescence, the next excitation
wave is observed at time t; these observations are used in
the LETKF and their influence appears in the analysis
ensemble states at time t. These analysis ensemble states
form new initial conditions for the dynamical model, and
the effect of this perturbation due to the initial observa-
tions appears in the next background ensemble, at t+Ta,
thereby introducing a lag between the background ensem-
ble and the observations of no less than the assimilation
interval time. If the threshold for excitation is not met
for the analysis ensemble state, then the lag between the
observed excitation stimulus and the resulting wave will
be larger, which is typically the case as the initial ob-
servations of an excitation are, by definition, small, and
likely sub-threshold.
Finally, we must note several features of the obser-
vations and reconstruction that will become relevant in
later results. The observations smoothly interpolate fromquiescent ( u(t, x, y, z )≈0) to fully excited ( u(t, x, y, z )≈
1) across the wavefront, cf. figure 4(a). Such blunted
fronts represent a configuration not achievable with the
model at hand—this model exhibits a threshold, such
that the wavefront is sharply defined; i.e., u(t, x, y, z ) is
very likely to be close to 0 or close to 1, and the prob-
ability that u(t, x, y, z ) is near 0 .5 along the wavefront
is exceptionally small. The observations suggest that, at
this particular time, uohas a signficant probability of
being close to 0 .5. This tension between the spatially
smooth data and the sharp features of the model forms
a significant impediment to reliable reconstruction.
Additionally, the dynamics of the model with the cho-
sen parameter set—despite being manually tuned for this
dataset—tends to overshoot the action potential ampli-
tude (APA) of the observations, c.f. figure 4(a-c). This
behavior is caused, first, by the analysis step of the
LETKF over-correcting the ensemble states. The effect
then persists due to the relatively short model integration
interval ( Ta= 2 ms), which is not sufficient for the state
to relax onto the slow manifold. This effect may also
be observed in the Free-Run experiment due to the rela-
tively high frequency of the stimulus current (not shown).
Notably, the effect of the high-frequency pacing stimulus
current and the overshoot of the analysis step are not
additive.
3. Explicit stimulus current modeling
This experiment considers the effect of including a non-
autonomous, spatially localized, explicit stimulation cur-
rent in the dynamics of the model that is tuned both spa-
tially and temporally to qualitatively match the stimula-
tion observed in the experimental dataset, and the poten-
tial for catastrophic synchronization of the ensemble in
the presence of this explicit modeling choice. The stimu-
lus current used is the same as that used in the Free-Run
results (Section III A 1). We refer to this experiment as
‘Stimulus’.
The results for the model are shown in figure 5, where
the reconstruction is largely insensitive to the inclusion
of the stimulus current. Several small changes appear
in the RMSEb(t) compared to the Autonomous results.
The reconstruction error exhibits smaller peaks during
the excitation phase, where the stimulus current triggers
the excitation wave ahead of the lag associated with the
observation-LETKF-model path in the Autonomous ex-
periment. After t= 1.5 s, drift in the timing of the stim-
uli leads to an early stimulus, which is corrected by the
LETKF on the surfaces, effectively constraining the tim-
ing error. These early stimuli appear as small ( ≲0.1) in-
creases in the RMSEb(t) from the baseline outside of the
dominant contributions from the excitation wave in fig-
ure 5(a)—the short-lived effect on the surface error is also
an indication that the reconstruction procedure is robust
with respect to errors in the specification of the stimulus
period, a prime concern due to the timing-related contri-9
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. 5. Stimulus experiment results, depicting the (a)
CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t) (line)
plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
butions covered in the Autonomous reconstruction.
RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1. 5 2.0SPRDub(t)
0.00.51.0(a)
(b)Free Aut o. St im.
FIG. 6. (a) RMSEb(t) and (b) depth-average SPRDb
u(t) for
the Free-Run, Autonomous, and Stimulus experiments, with
the distribution of (right, top) surface errors and (right, bot-
tom) ensemble spread over time.
In figure 6 we show the (a) RMSEb(t) for the Au-
tonomous, Stimulus, and Free-Run experiments over
time (left), and the marginal density plots of the sur-
face errors (right), for the reconstruction using Fenton-
Karma and the Barone et al. parameter set. The im-provement of the RMSEbover the Free-Run experiment
is significant, but the surface errors for the Autonomous
and Stimulus experiments are comparable, both overall
and over time. The most significant correction of the
RMSEb(t) for the Stimulus results over the Autonomous
model is a shorter initial transient, as the first excita-
tion ( t≈125 ms) reaches a lower amplitude error on
the surfaces, and thus the ensemble synchronizes to the
true stimulus rhythm more quickly. The RMSEbmakes
it clear that the inclusion of the LETKF effectively low-
ers the expectation value of the surface error, overall.
For both the Autonomous and Stimulus experiments, the
surface error is nearly identical – it appears that the in-
clusion of stimulus information into the model dynamics
has a minimal impact on the surface reconstruction er-
ror over long times, save for the minor advantages noted
above. The depth-averaged SPRDb
u(t) for the Free-Run
experiment is larger than in either the Autonomous ex-
periment or Stimulus, reflecting the low-confidence of the
reconstruction in the absence of the LETKF. Indeed the
depth-averaged SPRDb
u(t) is nearly identical for the Au-
tonomous and Stimulus results, with a subtle bias in the
latter toward larger variation over time, cf. figure 6(b).
t [s]0.0 0.5 1.0 1.5 2.0Auto.
0.00.51.0
APD [ms]60 8 0 100APA
0.850.900.951.001.05(a)
(b)
uo(t)
ub(t)
FIG. 7. (a) Temporal trace for the Autonomous experi-
ment and associated observations, sampled on the epicardium
(z/d= 0) at ( x, y) = (0 .825,0.42) cm, and (b) correspond-
ing action potential durations (APD) and amplitudes (APA)
(uthr= 0.1).
In addition to the reconstruction error of the field, it
is worth considering the error in physiologically relevant
quantities which are derived from the state, e.g. those
which inherit from the structure of the action potential,
including the action potential duration (APD) and am-
plitude (APA). We report the temporal trace of the au-
tonomous reconstruction for a randomly selected posi-
tion in the observations in figure 7(a). After an initial10
transient which lasts less than two BCL ( <250 ms) the
reconstruction at this point is excellent, with minor er-
rors appearing in the apex of the action potential, and
thus contributing to a poor estimate of the true APA,
cf. figure 7(b). The distribution of APD between the
observation and reconstruction traces match exception-
ally well, as expected because the predominant error in
the reconstruction appears far from the threshold value
(uthr= 0.1). Similar calculations for all LETKF-driven
reconstructions are included in the Supplement, cf. Fig-
ure S1.
4. Stochastic current model effects
This experiment incorporates stochasticity into the
model to investigate the efficacy on the accuracy of state
reconstruction in the context of uncontrolled model er-
rors. We have previously introduced these stochastic
model effects for the assimilation of observations gener-
ated from state sequences generated by a model, subject
to model uncertainty22. These techniques improved the
reconstruction of the state over LETKF in concert with a
deterministic ensemble model, occasionally by significant
margins; their introduction for assimilating experimen-
tal observations may help to recover the state dynamics
when the model error is due to the model being unable to
perfectly reproduce experimental data. For this work we
will introduce a stochastic current (SDE- u) and stochas-
tically selected time-scale parameters (SMP- τ) into the
model. The SDE- uformulation introduces a new stochas-
tic current Istoin the role of Istimin the dynamics of the
voltage variable uin (1),
Isto=ξ, ξ ∼N(0, σ2
u), (14)
while the SMP- τaffects the selection of all the explicit
time-scales of the model,
τ∗∼N(τ∗,(τ∗σp)2), (15)
where τ∗is the baseline parameter value. We refer to this
experiment as ‘Stochastic’. We consider fixed standard
deviations ( σu= 0.04 and σp= 0.04) for both stochastic
effects.
In figure 8(a) we show the surface errors RMSEb(t)
of the reconstruction for the Fenton-Karma model with
Barone et al. parameter set, with the current-based SDE
and SMP- τstochastic effects. For these relatively low-
amplitude stochastic effects, we find very minor changes
to the surface reconstruction error—an effective smooth-
ing of the peaks of RMSEb(t) corresponding to the exci-
tation wavefront and waveback, which is expected from a
uniformly stochastic effect. Analogously with the Stimu-
lus result, the transient in the RMSEb(t) is slightly wors-
ened by the inclusion of the Stochastic effects; the exci-
tation near t≈125 ms exhibits a larger peak error.
In previous work, we showed that the stochastic ad-
ditions were capable of permitting the ensemble to bet-
ter approximate the local degrees of freedom of the true
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0FIG. 8. Stochastic experiment results, depicting the (a)
CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t) (line)
plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
dynamics by effectively inflating the spread for a given
ensemble size. In this experiment, we find no such ef-
fect. We find that the addition of the stochastic cur-
rent accelerates the depth-averaged SPRDb
u(t), leading
to faster average spread growth over the initial phase,
before switching to a conservative effect over the long-
term reconstruction, suppressing short-lived variations in
the spread. Indeed, what this behavior indicates is that
the addition of stochastic processes to the model may en-
hance synchronization of the ensemble in some scenarios,
lessening the ensemble spread, or suppress total decoher-
ence for the ensemble.
Comparing the surface errors RMSEb(t) corresponding
to the autonomous (figure 3), stimulus (figure 5), and
stochastic (figure 8) model experiments, we find that the
inclusion of the stimulus current or stochastic effects has
a small effect on the overall reconstruction error. We may
interpret this as, at best, a marginal improvement in the
accuracy of the surface reconstruction with the inclusion
of the stochastic or stimulus current into our dynamical
model. Alternatively, we may interpret the autonomous
result as achieving reconstruction errors lower than ex-
pected and with confidence comparable to these more
informed model approaches. Likewise, due to the slow
drift of the timing of the stimulus current in the observa-
tions and model, we may be confident in the robustness
of the reconstruction with respect to model errors related
to stimulus timing.11
B. Influence of observation perturbations on
reconstruction accuracy
If modifications to the model have only subtle effects
on the reconstruction of the state dynamics, then perhaps
the tuning of experimental observations will have more
significant effect. In these experiments, we perturb the
observations from the experimental data to better model
the uncertainty associated with the physical processes in-
volved in the recordings, or to buttress the highly-sparse
observations with some intermediate information based
on the apparent temporal structure of the data. Likewise,
this investigation presents an opportunity to ensure that
our reconstruction is robust for the type of data available
to the cardiac researcher.
1. Addition of synthetic observations
In this experiment, we explore the generation of mid-
depth synthetic observations, in addition to those on the
surfaces, for use in the assimilation process. The role
of these synthesized observations is to gently constrain
the ensemble spread in the interior of the tissue, which
we have previously identified as a predominant source of
error in the reconstruction of the state in this system22.
The synthesized interior observations are interpolated be-
tween the observation values from their projections onto
the epicardial and endocardial surfaces. The synthetic
observations are appended to the real observations, the
former having fixed point-wise uncertainty estimates of
η= 0.50 and the latter having fixed point-wise uncer-
tainty estimates of η= 0.05. Different spatial distribu-
tions of mid-depth observations can have a significant
effect on the robustness and accuracy of the reconstruc-
tion. A full arrangement of observations that sample the
(x, y)-grid in the same positions as on the surfaces led to
immediate ensemble collapse due to strong contraction of
the analysis step (not shown). We use a relatively sparse
arrangement where 64 observations were distributed uni-
formly in an 8 ×8 grid, which did not collapse the en-
semble.
We add these synthesized observations due to the spa-
tiotemporal pattern of the underlying excitations, where
the wave on the surfaces passes nearly uniformly over
(x, y) and in time. We thus treat the observations on each
surface as strongly coupled and thus amenable to inter-
polation through the depth, i.e., between the surface sets.
We report the impact the 64 additional observations (a
0.7% increase in the total number of observations) has
on the reconstruction fidelity.
The results of the assimilation with the synthetic mid-
depth observations are depicted in figure 9. Immediately,
we note that while CRPSa(t) is not significantly affected,
CRPSo(t) now peaks significantly higher than any other
assimilation experiment, cf. figure 9(a). This finding im-
mediately indicates a significant deviation from the ob-
servations, but does not reveal whether this discrepancy
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0FIG. 9. Synthetic Observations experiment results, depicting
the (a) CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t)
(line) plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
is due to the interior, synthesized observations, or the
‘true’ surface observations. The contribution is distin-
guished by RMSEb(t), which likewise peaks significantly
higher than any other assimilation experiment; cf. fig-
ure 9(b), and is computed over the surface observations
only for consistency with the other reconstruction ex-
periments. Notably, the RMSEb(t) may be decomposed
into contributions from the surfaces and the synthetic
observations in the interior; doing so would provide a
direct estimate of the error of the reconstruction in the
interior provided our interpolation ansatz is correct and
reasonable. However, we have no rigorous way to assess
the interpolation ansatz and so cannot assert the cor-
rectness of the reconstruction in the interior using this
method. So we conclude that the inclusion of the inte-
rior synthetic observations interpolated from the surface
observations leads to significantly worse reconstructions
on the surfaces, despite the high uncertainty of the syn-
thetic observations.
The resolution of this puzzle may appear from a con-
sideration of the ensemble spread. While additional mid-
depth observations are extremely good at restricting the
uncertainty of the reconstruction in the mid-depth of the
domain, cf. figure 9(c), as information from the surface
observations can affect the interior layers of the solution,
this effect is not always desirable. By constraining the
interior, we limit the spread of states used in the recon-
struction of the surfaces, as well. This now-restricted
ensemble of states may not adequately cover the physi-
cal instabilities present in the observed surface dynamics,12
limiting the accuracy of the reconstruction for observa-
tions for which we are confident (those on the surface) for
the sake of observations for which we are not (those in
the interior). Tuning the uncertainty and distribution of
the interior observations compared to the surface obser-
vations to critically constrain the ensemble thus presents
an additional window for optimization, although it is be-
yond the scope of this work.
2. Observation uncertainty modeling for fronts
For this experiment we seek to infuse the observational
data with uncertainties based on our knowledge of the
physical and numerical filtering of the experimental data
and the dynamics of the model. To this end, we iden-
tify the slow dynamics of unear the rest state ( u≈0)
and in the excited state ( u≈1), and note that while
the model produces sharp wavefront features, the obser-
vation data is relatively smooth. In practice, this assigns
an observation uncertainty that depends on the obser-
vation value, ηi=η(yo
i), and specifically on the value
ofu< u < u, where u= 0.1 corresponds to a thresh-
old marking the boundary of quiescence and u= 1.0−u
marks the boundary of the fully excited state. The non-
linear uncertainty function takes the form of a scaled and
truncated Gaussian,
η(yo
i) =η+ (η−η) exp/parenleftbig
−k2(ui−(u+u)/2.0)2/parenrightbig
,(16)
where η=u/2 = 0 .05 and η= 0.50 are lower and up-
per bounds for the uncertainty, and kis chosen so that
η(0.0) = η(1.0) = ηandη((u+u)/2) = η. The simplest
interpretation of the wavefront uncertainty maximum η
is that anywhere along the wavefront, the smoothing of
the observation data makes it unclear whether an ensem-
ble member should be in a fully excited or quiescent state
at the same point in time, i.e., |ub−yo
i| ∼U(−η,+η).
In principle, this approach encourages the growth of the
ensemble spread along the wavefront, so that the ensem-
ble mean is a good approximation to the observation data
while the individual ensemble members retain their sharp
wavefront features. Tuning the precise distribution of
uncertainty, whether through a different ( η,η) pairing
or differently motivated nonlinear function η(yo) alto-
gether, is beyond the scope of this work; in the present
investigation we seek to perturb the existing observation
data to determine if the reconstruction accuracy may be
improved.
In figure 10, we report the effects of the Wavefront
Uncertainty experiment. We find that the additional
uncertainty along the wavefronts and wavebacks in the
observation data leads to a small, but consistent, in-
crease in the RMSEb(t) near the end of the wavefront,
and likewise increases the surface error during the end
of the waveback, introducing a set of smaller peaks in
RMSEb(t) between the usual set associated with the end
of the wavefront. As we are encouraging deviations in the
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0FIG. 10. Uncertain wavefront experiment results, depicting
the (a) CRPSa(t) (line) and CRPSo(t) (band), (b) RMSEb(t)
(line) plus and minus one standard deviation (band), and (c)
SPRDb(t, z) (color) for the reconstruction using the Barone
et al. parameter set.
ensemble members near the beginning and end of the ex-
citation wave, this finding is not unexpected—exactly in
the transition between excited and unexcited, the spread
is increased slightly, and it makes the most significant rel-
ative contribution to the surface error where and when
the error is already low. Additionally, as the observa-
tions are synchronizing forces for the ensemble subject
to the inverse observation covariance weighting, R−1, a
higher uncertainty for the observations should lead to
less synchronization overall and higher ensemble spread.
We observe faster initial growth of the SPRDb
u(t, z) com-
pared to the Autonomous experiment, but the long-term
maximum is not significantly altered.
In figure 11, we show the RMSEb(t) and SPRDb
u(t)
for the Autonomous, Wavefront Uncertainty, and Synthe-
sized Observations experiments. Both the wavefront un-
certainty and synthesized observations experiments lead
to larger surface reconstruction errors (RMSEb) over-
all compared to the Autonomous experiment, though
their relative contribution over time is highly non-
uniform. Whereas the Autonomous experiment recon-
struction manages to match the APD and DI of the ob-
servation data, the Synthesized Observation experiment
reconstruction undergoes large deviations from accurate
reconstructions, frequently lasting longer than the APD
of the observations. Likewise, while the Wavefront Un-
certainty experiment explicitly makes a trade-off between
confidence about the precise position of the wavefronts
for the robustness of higher ensemble spreads, this ro-
bustness never materializes in practice; the Autonomous13
RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1. 5 2.0SPRDub(t)
0.00.51.0(a)
(b)Auto. Wave Un c. Sy nth.
FIG. 11. (a) RMSEb(t) and (b) SPRDb
u(t) for the Au-
tonomous, Wave Uncertainty, and Synthetic observations ex-
periments, with the distribution of (right, top) surface errors
and (right, bottom) ensemble spread over time.
experiment spread is comparable to that from the Wave-
front Uncertainty experiment.
IV. DISCUSSION
In all results, the unobserved interior layers that are
not driven by the LETKF analysis ensemble update form
the dominant contribution to the reconstruction error, as
expected from previous results using surface observations
generated from model runs22. However, previous experi-
ments focused on dynamics that are autonomous and (in
the large scale) structured by topological features, i.e.,
the dynamics of scroll waves are organized around their
filaments; in the present work we have focused on ex-
perimental results that are necessarily non-autonomous
and driven by external stimuli, as these conditions are
endemic to experimental investigations of cardiac tissue
excitation. In the present scenario, all the dynamics are
driven by the observations and thus the LETKF update
of the analysis ensemble, save the Free-Run experiment
which corresponds to the absence of any observations,
without such topological constraints on the dynamics.
A. Model error interactions with the assimilation
Several considerations have an outsized impact on
the accuracy and stabilty of the reconstruction for this
dataset. The first is the model error due to, primar-
ily, misparameterization. For example, when the refrac-
tory period is sufficiently long, then subsequent excita-
tions generated by the LETKF develop into conduction
block due to the refractory behavior of the model. The
blocked wavefronts then prevent accurate reconstructionin the next assimilation step. Additionally, the propa-
gation speed of the wave is important to match in the
model parameterization; slow waves rely on the assimi-
lation scheme to excite the tissue ahead of the wavefront
to match the observations, while fast waves rely on the
assimilation scheme to suppress the propagation of waves
in the model to match the observed wavefront. That the
asymmetry between the ignition and quenching problems
has significance for the reliability of the state reconstruc-
tion is surprising, at first glance. However, this effect
mirrors our understanding of critical transitions for ex-
citable media: the ignition problem relies only on the lo-
cal threshold response of the excitable medium, while the
quenching problem is sensitive to the particular pattern
of the excitation and is thus a more nonlinear process.
The parameterization of the model can also affect the
dynamical range of the ensemble states, such that the
analysis may drive the fields beyond the range of the
observations, i.e. ‘overshoot’. In our present problem,
the action potentials of the Fenton-Karma model are only
weakly bounded to the same domain as the observations,
i.e. 0 ≤u≤1, whereas the assimilation step utilizes a
strict bound for the analysis states 0 ≤ua≤1.5. Due
to the short model integration times ( Ta= 2.0 ms) and
the overshoot of the analysis step, the state cannot relax
sufficiently quickly to account for the overshoot, resulting
in anomalously large field values, which likewise must be
accounted for in the next assimilation step. This model-
assimilation feedback cycle presents further opportunity
for assimilation filter investigations.
One possible way to improve the robustness of the re-
construction process is by extending the reconstruction
to the model parameters in addition to the state vec-
tor. This approach is especially useful for model (pa-
rameter) identification in the absence of a known model
(parameter set). We have opted to reserve this avenue
of investigation for future work, both because a pub-
lished model parameter set for this dataset and model
exists25and because our stochastic model inflation tech-
niques have previously been shown to be adept at ac-
counting for model errors (specifically those arising from
mis-parameterizations)22. A thorough study of the iden-
tification of model parameters for cardiac electrical ex-
citation models using data-assimilation techniques may
provide useful advances for clinical applications.
B. Observation interactions with the model dynamics
Observation processing is also a more subtle art than it
first appears. Optical mapping recordings effectively blur
the position of the wavefront by recording fluorescence
not only from the top-most layer of cells in the tissue,
but the transferred fluorescing of excited layers of cells
below the surface. This blurring manifests as, instead of
a sharp wavefront, a leading edge that smoothly transi-
tions from quiescent to excited across a width as large as
1 cm. Numerical post-processing to improve the signal-14
to-noise ratio of the data is typically achieved with a spa-
tiotemporal convolution, which exacerbates this smooth-
ing of the sharp features of the wavefront into a distri-
bution of marginally excited cells. However, as the ex-
perimental data we use during constant pacing reaches
steady state, stacking was used40, which increases the
signal-to-noise ratio without further spatial smoothing.
This distribution of marginally excited cells cannot be
reconstructed by a threshold excitable model—we rely
on the assimilation scheme to effectively interpret the
steep wavefronts generated by the ensemble models for
a given smooth observed wavefront. We have considered
the blurring of the state observations ybby an obser-
vation operator which does not merely sample the field
at particular positions, but computes the local average
of the field through a fixed-width box-filter convolution.
We anticipated that the convolution length scale would
compete with the length scale of the localization process
and likewise the convolution filter would compete with
the filtering step of the LETKF, and expected an overall
reduction in informational content about the ensemble
as the elements of the l-dimensional ybare now substan-
tially more correlated, harming the reconstruction by in-
troducing an error into the ensemble observations which
is essentially uncontrollable. We found that, in practice,
the difference from the sampling based observation oper-
ator used in this work is minimal—cf. Figure S3 in the
Supplement for further details and results.
Likewise, the estimation of observation uncertainty for
cardiac experimental recordings is an important topic
that we have treated only superficially in this work. As
the optical-mapping recordings and post-processing in-
volve a spatial averaging that essentially smooths the
steep wavefronts endemic to real excitable models, we
may heuristically assign a nonlinear uncertainty to the
observation data based on the approximate value of the
observation, as in Section III B 2. Because there are
effectively three ‘slow’ states observed in the data for
the transmembrane potential—quiescent, marginally ex-
cited, and fully excited—and we suppose the middle state
is an apparent figment due to the measurement scheme,
we may estimate the probability that the observation of a
cell in that state should remain in that same state by the
next observation time, equivalently, assimilation interval,
and interpret this proportionality factor for the uncer-
tainty of the observed transmembrane potential. For the
Fenton-Karma model, we may map these observed slow
states based on the range of uand model parameters,
specifically uc< ui(t)< usi
crepresenting the marginally
excited state. The uncertainty of observations outside
this range should be determined by the noise floor of the
observations. As the true values of ucandusi
care unde-
fined, but may be assumed to be close to those used in
this work, the smooth extension to all observation val-
ues is needed; heuristics for nonlinear observation un-
certainty depending on the state lead to a lesser weight-
ing (higher uncertainty) for observations of the wavefront
and waveback. Precisely constructing these estimates re-quires building a statistical model of the observations,
which is beyond the scope of this work. Our initial exper-
imentation based on heuristics that smoothly increase the
uncertainty of observations in the marginally excited re-
gion suggest that this subtle modification of uncertainty
can have significant impacts on the accuracy and robust-
ness of state reconstructions.
Finally, while we have focused on a particular dataset
for the reconstruction task, we have computed recon-
struction with related data (BCL = 234 ±2 ms) and
different model parameter sets. For a slower BCL the
conclusion is the same: the propagation of excitation in-
formation from the observations to the ensemble state
vectors is slow and requires consistent work from the
LETKF to correct, which manifests as peaked errors in
the surface reconstructions which match each new exci-
tation. For alternative model parameters, the periodicity
is still matched but the difference in wave shape results
in significant increases in reconstruction error. These ex-
periments suggest that our approach is robust to pecu-
liarities of the dataset and model specification. Further
details are available in the Supplement, see Figures S4-
S8.
C. Assimilation interactions with the observation
uncertainty
The specification of the LETKF includes several nu-
merical parameters that we found to influence the effi-
cacy of the assimilation program. The first is a floating-
point parameter named ‘gross error’, designated by σg,
which controls whether an observation is sufficiently de-
viant from the background mean xbto be truncated,
with the goal of maintaining a ‘light touch’ for the as-
similation and enhancing the stability of the scheme in
the presence of large-deviations from the observations.
For an observation-uncertainty pair ( yo
i, ηi) and corre-
sponding value of the background mean field ub
i(t), if
|yo
i(t)−ub
i(t)|> σgηi, then the corresponding element of
(yo−H(xb)) is overwritten by 0, i.e., the update of the
analysis ensemble is invariant with respect to this obser-
vation. As the range of 0 ≲ub≲1 and the minimum of
the uncertainty of the surface observations η= 0.05 are
fixed, when σg≳20 every observation is used in every
assimilation step. However, we find that setting the pa-
rameter below this saturation value (e.g., σg= 10) can
significantly affect the results, producing maximal sur-
face reconstruction errors nearly 25% lower than those
in the saturated case ( σg= 20). For this reason, we set
σg= 10 for all experiments in this work. In program logs,
it is clear that fewer than 5% of observations are ignored
by assimilation step 50 (100 ms) for the autonomous ex-
periment, which suggests that we are only filtering truly
extreme values, and only in the initial iterations of the
assimilation. In principle, controlling this parameter is
akin to inflation – it is a measure of our relative confi-
dence in the observations and the background ensemble15
members. It is not clear a priori what value this param-
eter should take, and because it affects the accuracy of
the reconstruction, characterizing its effects should be a
priority in future investigations.
Further, we have used η= 0.05 throughout this
work, which was estimated from the full-width at half-
maximum of the distribution of the observation values.
While we found some sensitivity to the precise value of
the uncertainty (e.g., experiments with η= 0.025 and
η= 0.10 produced reconstructions with higher RMSEb
overall), they are qualitatively similar to the presented
results. A rigorous estimation of the observation uncer-
tainty from the statistical properties of the dataset is
beyond the scope of the present work, but may reveal
that the accuracy of the reconstruction may be improved
through better estimation of the observation covariance
matrix.
In this work we have used ‘strongly coupled’ DA (in
analogy to the same term used in domain-decomposed
models in weather forecasting) for the analysis update to
the state variables for all experiments. We permit obser-
vations of the state uto affect the analysis update of the
vandwfields. In contrast, ‘weakly coupled’ DA com-
municates information between the state variables only
through the model evaluation. Strongly coupled DA is
expected to be able to extract more information from the
same observations than weakly coupled DA41. Strongly
coupled DA permits more significant corrections to the
state for our relatively sparse observation pattern, at the
risk of over-driving the corrections to vandwin ways
that are atypical for cardiac excitations. Restricting the
analysis update due to observations of the uvariable to
theuvariable only reduces the efficacy of the assimila-
tion by preserving more ensemble state information in
the analysis, while permitting larger ensemble spreads
due to the uncontrolled dynamics of vandw. In nu-
merical experiments, we found that in some scenarios we
could drive the gating variables to their rest state val-
ues during the assimilation, when in model simulations
of comparable dynamics the gating variables never at-
tain their rest values. Open questions include whether
the relatively weak coupling of the cardiac model is suffi-
cient to ameliorate some of the challenges to robustness
strongly coupled DA is expected to expose, or whether a
weakly coupled DA approach unacceptably degrades the
accuracy of the reconstructions. A systematic analysis of
strongly and weakly coupled DA in the cardiac context
would clarify the effect this choice has on robustness and
accuracy and should be a focus of future work.
Relatedly, when we found that the LETKF was over-
driving the gating variables and leading to physically un-
likely values, we bounded the gating variables between
their explicitly known limit values, 0 ≤va, wa≤1.
This bounding prevents the assimilation from creating
unreachable analysis states that have little to do with the
true dynamics—a hazard for what is effectively an initial
condition for the model. Additionally, we found that a
similar effect could be found in ua, where some ensemblemembers would be driven to exceedingly large-valued and
hyper-localized corrections of the state leading to anoma-
lously large ensemble spreads (i.e., SPRDa
u≳4.0), which
should not be possible for typical values of u. To suppress
this growth, we bounded −0.1≤ua≤1.5, which has the
positive effect of bounding the ensemble spread. Further,
while the limits on uaare sufficiently strong to bound the
ensemble spread, they are not strong enough to prevent
overshoot such that ua>1≥uo. However, it is presently
unclear whether this is an innocuous addendum to the
assimilation procedure to account for numerical instabil-
ities in the model-LETKF interaction or symptomatic of
a limitation of our approach. Nor are the constraints
on the initial conditions to the model sufficiently well-
defined mathematically to say these limits need never be
adjusted for this or another model.
The observation localization is controlled by two pa-
rameters for space and one for time; the latter is set so
that only the current time affects the assimilation as this
is compatible with the clinical application and is com-
putationally efficient. The spatial localization scales are
isotropic, and we have not investigated the choice of dif-
ferent localization scales or anisotropies. In principle,
given the density and low noise of surface observations,
it may be computationally advantageous for their influ-
ence to extend through the depth of the tissue while re-
tracting their overlap on the surface. However, this per-
spective is difficult to justify physically—indeed, it as-
sumes a surface-dominant dynamics of the interior that
is, at an abstract level, the phenomenological question
we are considering in this work. Physically, the influ-
ence of each observation may extend to the spatial re-
gion that may be excited by the propagation of excita-
tion information in the time between observations—that
is,σo,i∝ciTa∝√Difor a quiescent state—making it
wholly anisotropic, and, in fact, shortening the extent
of influence into the thickness of the tissue compared
to the effect along the surfaces, as Dz=D⊥≪D∥,
by design. The corresponding fiber-informed localiza-
tion scales are then related by the inverse conductivity
anisotropy ratio, σo,∥= (D∥/D⊥)σo,⊥, and vary with
spatial position. Likewise, this scaling informs the ob-
servation distribution—while we are limited to surface
recordings of electrofluoresence, a consideration of local-
ization from the properties unique to cardiac excitation
may benefit the cardiac researcher.
D. Accuracy measurement in the absence of ‘truth’ states
Finally, we have focused on the surface error of the
state reconstructions and appealed to CRPS for a mea-
surement of ensemble consistency in the absence of in-
terior observations or a ‘truth’ state. The choice of this
measure is motivated by its convergence properties with
respect to ensemble size and its simple interpretation
rather than its particular relevance to cardiac state recon-
struction. Alternative error measures have been used in16
other works, e.g., threshold-based error21, which makes
reference to an unknown truth state, a prescribed thresh-
old value, and knowledge of the dynamical properties of
the model. Constructing a fair (in the sense of CRPS)
measure of unknown state feature error requires the con-
struction of a statistical model of the dynamics of the
state itself, against which we might compare the expec-
tations of the reconstructed state. This effort would also
aid in physically motivated estimation of observation un-
certainties, as mentioned above.
The creation of a statistical model of the dynamics
for the state reconstruction problem is precisely the ap-
proach taken by researchers in the machine-learning liter-
ature, which has shown promising results. Ref. 42 investi-
gated the use of a long short-term memory recurrent neu-
ral network, autoencoder, and diffusion artificial neural
network (ANN) models for the 3D reconstruction prob-
lem for a simple excitable model, while varying the his-
tory available to the model and the layer depth of the re-
construction. The central results of this approach are en-
couraging, especially for shallow depths (close to the ob-
servations) and long histories. Notably, considering the
parsimony of their observations ( l/N≈T·8.3×10−3, for
1≤T≤32) compared to this work ( l/N≈1.5×10−3),
the authors found similar reconstruction limitations to
our approach for a remarkably different dynamical model
and geometry. Ref. 43 investigated the reconstruction
problem for the Aliev-Panfilov model using a U-net ar-
chitecture ANN with similar considerations to the infor-
mational content of the observations as our work. In
particular, the authors found that simultaneous obser-
vations of both the top and bottom layers of the ex-
citable medium produced more reliable reconstructions
than single-surface observations, but that ‘projection’
observations—those integrating over the depth of the
tissue—worked even better. Their results using the U-net
ANN architecture in the ‘laminar’ dynamics regime (an
isolated scroll wave with size comparable to the depth of
the tissue) are comparable to previous in silico results for
a similar dynamical pattern produced by a different car-
diac excitation model in conjunction with LETKF and
stochastic inflation.22The authors also found that the
encoding of depth information into the observations was
essential for the success of their methods, which limits
its application to ventricular fibrillation.43
The combination of statistical model (machine-
learning) and dynamical model (data assimilation) ap-
proaches to reconstruction is an active avenue of re-
search. One of the central pragmatic limitations of
ensemble data assimilation approaches is that storage
requirements grow as O(MN) while computation (for
LETKF32) grows as O(M2N); replacing some of the
ensemble members with a pre-trained machine learn-
ing model could reduce both costs. Likewise, machine-
learning models require training, and do not offer an esti-
mate of their prediction uncertainty; coordination within
a data assimilation framework could alleviate the latter
issue with existing infrastructure, while hot-swapping dy-namical models with machine-learning models could pro-
vide relief for the former. In particular, we have found
that it may take up to 250 ms for the ensemble to set-
tle into a good approximation of the true uncertainty of
this system; machine learning may provide an acceler-
ated convergence path through better estimates for the
initial state covariance, or ensemble state initial condi-
tions, based on extensive training data.
V. CONCLUSION
In this work we have performed several assimila-
tion experiments using physical data with variations
to the model and observations. We have found that
the assimilation of experimental observations for car-
diac reconstruction brings unique challenges compared
to the assimilation of model-produced observations. The
leading contributors to difficulty for state reconstruc-
tion are the type of dynamics under study, i.e., non-
autonomous stimulated dynamics, model error due to
mis-parameterization, the presence of synchronizing in-
puts (i.e., the stimulus current), and the estimation of
uncertainties for experimental observations.
When the model generates fundamentally different
types of dynamics compared to that described by the ex-
perimental data, we rely on significant corrections from
the LETKF. These large corrections, in turn, increase the
likelihood of generating physically unrealizable states. In
the cardiac context, unphysical behavior may manifest
as an excitation that spreads significantly faster than the
model permits for our parameter setting—thus, the re-
production of the wave speed by the model is an impor-
tant feature for the reproduction of the state dynamics.
An important issue, only briefly touched upon in this
manuscript, is the tuning of model parameters to account
for data features. Especially relevant for this dataset is
the ability to reproduce alternans – both in the dura-
tion (APD) and amplitude (APA) of excitations. While
APD alternans are readily reproducible with the Fenton-
Karma model, APA alternans are not a common feature
in this model. Modifications to the dynamics or model
parameters to reproduce APA alternans in the Fenton-
Karma model may be designed, but are outside the scope
of the present work.
Model error forms a dominant contribution to the re-
construction error on the surfaces, and has significant
effect on the interior spread of the ensemble and the con-
fidence in the reconstruction in the interior. The CRPSa
may give an overly optimistic estimate of the confidence
of the reconstruction accuracy in the interior due to syn-
chronization from the periodicity of the observations over
time. Further methods of assessing reconstruction per-
formance without recourse to observations are necessary.
Our data assimilation scheme, while effective for re-
constructing the state from model-derived observations
with the same distribution pattern in use in the present
study, struggles with the experimental data in use in this17
work. We suspect that this difficulty reflects a funda-
mental difference between our previous three-dimensional
reconstruction efforts and the current dataset, which is
the non-autonomous nature of the observed dynamics.
Data assimilation experiments with experimental data
showcasing autonomous dynamics—i.e., a spiral or scroll
wave—would present an interesting and informative ex-
tension of this study.
In conclusion, we have found that we can reliably re-
construct the surface dynamics of a driven excitable state
from experimental observations on the surfaces, but that
reliable reconstruction of the interior requires further ef-
forts to understand our dataset and how it interacts with
the dynamics of excitable models. We have found that
while inclusion of explicit modeling of the stimulation
current or stochastic effects may yield subtle improve-
ments to the reconstruction, the coupling of the LETKF,
observations, and the model is sufficiently close that it
does not correct the leading error cause in the recon-
struction of this dataset. On the surfaces, these errors are
dominated by poor model fit to the excitation wavefronts
and wavebacks. In the interior, it is the lack of propa-
gation of information from the surfaces, such that the
interior becomes a fount of uncertain excitation. Like-
wise, we have determined that incorporating additional
modeling insight into the features of the observations,
whether through the identification of a coherent wave
pattern and using it to constrain the uncertainty of the
interior dynamics or through modeling of the uncertainty
associated with the observations, is subtle and produces
new challenges which, at this initial stage, do not appear
to improve on the low-information approach.
VI. SUPPLEMENTARY MATERIAL AND DATA
AVAILABILITY
We have included two video files in the online sup-
plement. The first, auto ensmeans.mp4 , displays the
dynamics of ub(t, x, y, z ) and ua(t, x, y, z ), for z/d =
0,0.2,0.4,0.6,0.8,1.0, and emphasizes the difference due
to the assimilation, ua−ub, and the observations
uo, for the autonomous model experiment. The sec-
ond, auto b.mp4 , displays the dynamics of ub(t, x, y, z ),
vb(t, x, y, z ), and wb(t, x, y, z ) over time, for z/d =
0,0.2,0.4,0.6,0.8,1.0 for the autonomous model exper-
iment.
We have also included a short supplement which in-
cludes results for a number of experiments referenced
throughout the text.
The data that support the findings of this study are
available from the corresponding author upon reasonable
request.ACKNOWLEDGMENTS
We thank Alessio Gizzi for providing access to the
data used for this study. M.J.H. and E.M.C. were sup-
ported by the NSF under Grant Nos. CMMI-2011280
and CMMI-1762803. F.H.F. was supported by the NSF
under Grant No. CMMI-1762553. C.D.M., F.H.F., and
E.M.C. were supported by the NIH under Grant No.
1R01HL143450-01. This research was supported in part
through research infrastructure resources and services
provided by the Partnership for an Advanced Computing
Environment (PACE) at the Georgia Institute of Tech-
nology, Atlanta, Georgia, USA44. This work has likewise
made use of the Hamilton HPC Service of Durham Uni-
versity. All figures in this report were generated using
theMakie.jl45software package.
1G. Evensen, “Sequential data assimilation with a nonlinear quasi-
geostrophic model using monte carlo methods to forecast error
statistics,” Journal of Geophysical Research: Oceans 99, 10143–
10162 (1994).
2L. Nerger, T. Janji´ c, J. Schr¨ oter, and W. Hiller, “A Unification of
Ensemble Square Root Kalman Filters,” Monthly Weather Re-
view 140, 2335–2345 (2012).
3L. Nerger, T. Janji´ c, J. Schr¨ oter, and W. Hiller, “A regulated lo-
calization scheme for ensemble-based Kalman filters,” Quarterly
Journal of the Royal Meteorological Society 138, 802–812 (2012).
4J. T¨ odter, P. Kirchgessner, L. Nerger, and B. Ahrens, “As-
sessment of a Nonlinear Ensemble Transform Filter for High-
Dimensional Data Assimilation,” Monthly Weather Review 144,
409–427 (2016).
5P. Kirchgessner, J. T¨ odter, B. Ahrens, and L. Nerger, “The
smoother extension of the nonlinear ensemble transform filter,”
Tellus, Series A: Dynamic Meteorology and Oceanography 69,
1–15 (2017).
6S. Vetra-Carvalho, P. J. van Leeuwen, L. Nerger, A. Barth,
M. U. Altaf, P. Brasseur, P. Kirchgessner, and J.-M. Beckers,
“State-of-the-art stochastic data assimilation methods for high-
dimensional non-Gaussian problems,” Tellus A: Dynamic Mete-
orology and Oceanography 70, 1–43 (2018).
7L. Nerger, “Data assimilation for nonlinear systems with a hybrid
nonlinear Kalman ensemble transform filter,” Quarterly Journal
of the Royal Meteorological Society 148, 620–640 (2022).
8E. Cosme, J.-M. Brankart, J. Verron, P. Brasseur, and M. Krysta,
“Implementation of a reduced rank square-root smoother for high
resolution ocean data assimilation,” Ocean Modelling 33, 87–100
(2010).
9U. K. Dash, S.-Y. Park, C. H. Song, J. Yu, K. Yumimoto,
and I. Uno, “Performance comparisons of the three data as-
similation methods for improved predictability of PM2 ·5: En-
semble Kalman filter, ensemble square root filter, and three-
dimensional variational methods,” Environmental Pollution 322,
121099 (2023).
10V. Rao, A. Sandu, M. Ng, and E. D. Nino-Ruiz, “Robust Data
Assimilation Using $L1$and Huber Norms,” SIAM Journal on
Scientific Computing 39, B548–B570 (2017).
11H. Hersbach, “Decomposition of the Continuous Ranked Prob-
ability Score for Ensemble Prediction Systems,” Weather and
Forecasting 15, 559–570 (2000).
12J. Br¨ ocker, “Evaluating raw ensembles with the continuous
ranked probability score,” Quarterly Journal of the Royal Me-
teorological Society 138, 1611–1617 (2012).
13J. Thorey, V. Mallet, and P. Baudin, “Online learning with the
Continuous Ranked Probability Score for ensemble forecasting,”
Quarterly Journal of the Royal Meteorological Society 143, 521–
529 (2017).
14M. Leutbecher and T. Haiden, “Understanding changes of the18
continuous ranked probability score using a homogeneous Gaus-
sian approximation,” Quarterly Journal of the Royal Meteoro-
logical Society 147, 425–442 (2021).
15D. J. Lea, I. Mirouze, M. J. Martin, R. R. King, A. Hines,
D. Walters, and M. Thurlow, “Assessing a New Coupled Data
Assimilation System Based on the Met Office Coupled Atmo-
sphere–Land–Ocean–Sea Ice Model,” Monthly Weather Review
143, 4678–4694 (2015).
16M. Goodliff, T. Bruening, F. Schwichtenberg, X. Li, A. Linden-
thal, I. Lorkowski, and L. Nerger, “Temperature assimilation into
a coastal ocean-biogeochemical model: assessment of weakly and
strongly coupled data assimilation,” Ocean Dynamics 69, 1217–
1237 (2019).
17S. G. Penny, E. Bach, K. Bhargava, C.-C. Chang, C. Da, L. Sun,
and T. Yoshida, “Strongly Coupled Data Assimilation in Mul-
tiscale Media: Experiments Using a Quasi-Geostrophic Coupled
Model,” Journal of Advances in Modeling Earth Systems 11,
1803–1829 (2019).
18Q. Tang, L. Mu, H. F. Goessling, T. Semmler, and L. Nerger,
“Strongly Coupled Data Assimilation of Ocean Observations Into
an Ocean-Atmosphere Model,” Geophysical Research Letters 48
(2021), 10.1029/2021GL094941.
19N. S. LaVigne, N. Holt, M. J. Hoffman, and E. M. Cherry, “Ef-
fects of model error on cardiac electrical wave state reconstruc-
tion using data assimilation,” Chaos: An Interdisciplinary Jour-
nal of Nonlinear Science 27, 093911 (2017).
20M. J. Hoffman, N. S. LaVigne, S. T. Scorse, F. H. Fenton, and
E. M. Cherry, “Reconstructing three-dimensional reentrant car-
diac electrical wave dynamics using data assimilation,” Chaos:
An Interdisciplinary Journal of Nonlinear Science 26, 013107
(2016).
21M. J. Hoffman and E. M. Cherry, “Sensitivity of a data-
assimilation system for reconstructing three-dimensional cardiac
electrical dynamics,” Philosophical Transactions of the Royal So-
ciety A 378, 20190388 (2020).
22C. D. Marcotte, F. H. Fenton, M. J. Hoffman, and E. M. Cherry,
“Robust data assimilation with noise: Applications to cardiac
dynamics,” Chaos: An Interdisciplinary Journal of Nonlinear Sci-
ence 31, 013118 (2021).
23A. Gizzi, E. Cherry, R. F. Gilmour Jr, S. Luther, S. Filippi, and
F. H. Fenton, “Effects of pacing site and stimulation history on
alternans dynamics and the development of complex spatiotem-
poral patterns in cardiac tissue,” Frontiers in physiology 4, 71
(2013).
24A. Loppini, A. Gizzi, C. Cherubini, E. M. Cherry, F. H. Fenton,
and S. Filippi, “Spatiotemporal correlation uncovers character-
istic lengths in cardiac tissue,” Physical Review E 100, 020201
(2019).
25A. Barone, M. G. Carlino, A. Gizzi, S. Perotto, and A. Veneziani,
“Efficient estimation of cardiac conductivities: A proper general-
ized decomposition approach,” Journal of Computational Physics
423, 109810 (2020).
26A. Barone, A. Gizzi, F. Fenton, S. Filippi, and A. Veneziani,
“Experimental validation of a variational data assimilation pro-
cedure for estimating space-dependent cardiac conductivities,”
Computer Methods in Applied Mechanics and Engineering 358,
112615 (2020).
27F. Fenton and A. Karma, “Vortex dynamics in three-dimensional
continuous myocardium with fiber rotation: Filament instability
and fibrillation,” Chaos: An Interdisciplinary Journal of Nonlin-
ear Science 8, 20–47 (1998).
28M. S. Spach, W. T. Miller, D. B. Geselowitz, R. C. Barr, J. M.
Kootsey, and E. A. Johnson, “The discontinuous nature of prop-agation in normal canine cardiac muscle. Evidence for recurrent
discontinuities of intracellular resistance that affect the mem-
brane currents.” Circulation Research 48, 39–54 (1981).
29I. Kotadia, J. Whitaker, C. Roney, S. Niederer, M. O’Neill,
M. Bishop, and M. Wright, “Anisotropic Cardiac Conduction,”
Arrhythmia & Electrophysiology Review 9, 202–210 (2020).
30M. Perego and A. Veneziani, “An efficient generalization of
the rush-larsen method for solving electro-physiology membrane
equations,” Electronic Transactions on Numerical Analysis 35,
234–256 (2009).
31E. M. Cherry and F. H. Fenton, “Visualization of spiral and
scroll waves in simulated and experimental cardiac tissue,” New
Journal of Physics 10, 125016 (2008).
32B. R. Hunt, E. J. Kostelich, and I. Szunyogh, “Efficient data as-
similation for spatiotemporal chaos: A local ensemble transform
kalman filter,” Physica D: Nonlinear Phenomena 230, 112–126
(2007).
33R. E. Kalman et al. , “A new approach to linear filtering and
prediction problems [j],” Journal of basic Engineering 82, 35–45
(1960).
34T. Gneiting and A. E. Raftery, “Strictly proper scoring rules,
prediction, and estimation,” Journal of the American statistical
Association 102, 359–378 (2007).
35M. Leutbecher, “Ensemble size: How suboptimal
is less than infinity?” Quarterly Journal of the
Royal Meteorological Society 145, 107–128 (2019),
https://rmets.onlinelibrary.wiley.com/doi/pdf/10.1002/qj.3387.
36I. Idris and V. Biktashev, “Critical fronts in initiation of excita-
tion waves,” Physical Review E 76, 021906 (2007).
37R. D. Simitev and V. N. Biktashev, “Conditions for propagation
and block of excitation in an asymptotic model of atrial tissue,”
Biophysical journal 90, 2258–2269 (2006).
38C. D. Marcotte and V. N. Biktashev, “Predicting critical ignition
in slow-fast excitable models,” Physical Review E 101, 042201
(2020).
39In our experiments these values yield faster wave propagation,
but also strongly drive the ensemble states to quiescence, dramat-
ically worsening the overall reconstruction with (trivial) ensemble
collapse. Even when including the stimulating current into the
model dynamics, the reconstruction error is significantly worse
(not shown). Hence, we use more physiologically reasonable val-
ues for the tissue conductivity in this work.
40I. Uzelac and F. H. Fenton, “Robust framework for quantitative
analysis of optical mapping signals without filtering,” in 2015
Computing in Cardiology Conference (CinC) (IEEE, 2015) pp.
461–464.
41T. C. Sluka, S. G. Penny, E. Kalnay, and T. Miyoshi, “Assim-
ilating atmospheric observations into the ocean using strongly
coupled ensemble data assimilation,” Geophysical Research Let-
ters43, 752–759 (2016).
42R. Stenger, S. Herzog, I. Kottlarz, B. R¨ uchardt, S. Luther,
F. W¨ org¨ otter, and U. Parlitz, “Reconstructing in-depth activity
for chaotic 3d spatiotemporal excitable media models based on
surface data,” Chaos: An Interdisciplinary Journal of Nonlinear
Science 33(2023).
43J. Lebert, M. Mittal, and J. Christoph, “Reconstruction of three-
dimensional scroll waves in excitable media from two-dimensional
observations using deep neural networks,” Physical Review E
107, 014221 (2023).
44PACE, Partnership for an Advanced Computing Environment
(PACE) (2017).
45S. Danisch and J. Krumbiegel, “Makie.jl: Flexible high-
performance data visualization for julia,” Journal of Open Source
Software 6, 3349 (2021).1
I. SUPPLEMENTAL MATERIALS
A. Reconstructing Action Potentials
We include here temporal traces of the reconstruction
and coordinating observation trace for several numerical
experiments presented in the main text. The location of
the trace is selected randomly from the coordinates of
the observations for each experiment.
Auto.
0.00.51.0
APA
0.91.01.1W. Unc.
0.00.51.0
APA
0.91.01.1Synth.
0.00.51.0
APA
0.91.01.1Stim.
0.00.51.0
APA
0.91.01.1
t [s]0.00.51.01.52.0Stoch.
0.00.51.0APD [ms]60 80100120
APA 0.91.01.1(a) (f)
(b) (g)
(c) (h)
(d) (i)
(e) (j)uo(t) ub(t)
FIG. S1. Pairs of (a-e) temporal traces of the reconstruction
ub(t) and observation uo(t) at randomly selected locations for
experiments presented in the main text, and (f-j) the distri-
bution of APD and APA for both traces ( uthr= 0.2).
In all experiments, the reconstruction reliably recovers
the action potential (AP) shape after a short transient of
less than two cycle lengths ( <250 ms), cf. figure S1(a-
e). The dominant error of the AP shape occurs near the
apex, where over- and undershoot of the reconstruction
lead to poor estimates for the APA. In contrast, since the
estimates for the APD use a threshold which is smaller
than the apex, the estimates are consistent between the
observation and reconstruction. The APD and APA cal-
culations used to produce figure S1(f-j) use a thresholduthr= 0.2 to avoid reporting APD + BCL for the long
waves which do not reach quiescence before re-ignition.
B. Estimation of the minimal observation uncertainty
A rigorous calculation of the minimal observation un-
certainty is beyond the scope of this work. However, we
estimated the minimal observation uncertainty ηfrom
the full-width at half-maximum of the distribution of de-
layed differences in the dataset, using the assimilation
interval for the delay time, τ= 2.0 ms.
uo(t)
0.0 0.5 1.0
uo(t)−uo(t−𝜏)
-0.10.00.10.2
uo(t)0.0 0.5 1.0uo(t)−uo(t−𝜏)
-0.10.00.10.2
#
100101102103104105106(a)
(b) (c)
FIG. S2. (a) Distribution of field values in the dataset, (b)
distribution of values in the dataset against the assimilation
interval time-delayed difference, and (c) the distribution of
time-delayed differences in the dataset corresponding to the
assimilation interval. The baseline uncertainty of the obser-
vations is estimated from the full-width at half-maximum of
the Gaussian peak occurring near zero (black dashed curve).
In figure S2(b) we show the distribution of the
observations against their assimilation-interval-delayed
differences with a resolution of (0 .05,0.05/3) on the
(uo(t), uo(t)−uo(t−τ)) axes, respectively. Begin-
ning from the rest state (0 ,0), the dynamics progress
around the apparent loop in the clockwise direction. The
marginal distribution of uo(t) and uo(t)−uo(t−τ) is
shown in figures S2(a,c), respectively. We estimate the
full-width at half-maximum of the distribution in (c) us-
ing a Gaussian with standard deviation σ=η/(2√
2 ln 2)
for the peak near 0, with η≈0.05, shown as a dashed
black curve for uo(t)−uo(t−τ)∈[−0.1,0.1]. This
value likewise makes the identification of quiescent ob-
servations between 0 ≤uo≤2ηmore reliable.arXiv:2305.00009v3  [q-bio.QM]  5 Sep 20232
C. Observation Operator Local Averaging
In the body of this work, the observation operator
H(xb) =ybis the action of a large, sparse, rectangu-
lar matrix, to reduce the N-dimensional state vector to
thel-dimensional observation of the state, l≪N. The
operator strictly samples the u-field at particular posi-
tions. Meanwhile, the observation data from the experi-
ment is filtered twice: first by the transmission of subsur-
face fluorescence, and second by post-processing with a
spatiotemporal kernel for an improvement of the signal-
to-noise ratio of the recording. The effect is to smooth
the dataset by reducing the influence of outlier signals,
which also removes the resolution of truly sharp features
in the system from the data.
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. S3. Autonomous model reconstruction results with the
spatial convolution observation operator reporting the (a)
CRPSa,o(t), (b) RMSEb(t), and (c) spread through the depth
SPRDb
u(t, z).
To this end we have extended the observation opera-
tor; rather than H(xb) returning the value of the field
at a particular index (position) ub
i, we instead compute
and return the local average in a p×ppatch centered on
the index (position), where we have chosen p= 5 so that
observations (in our default surface distribution) sample
the entire surface in aggregate, but each observation does
not include any other observation position in its average.
This is equivalent to a spatial convolution with a two-
dimensional box filter. Results of this filtering observa-
tion operator are shown in figure S3, corresponding to the
autonomous reconstruction problem (cf. Section III.A.2
in the main text). The results are marginally different
from the canonical sampling observation operator, with
minor increases in the RMSEb(t) and marginal decreasesin the ensemble spread, overall.
D. Stimulus Period Robustness
In addition to the robustness of our approach with re-
spect to model parameters, we applied the reconstruc-
tion to additional datasets with longer cycle lengths,
which produce substantially slower dynamics and less
pronounced alternans. However, despite the relatively
calmer dynamics, the assimilation becomes substantially
more sensitive to incorrect AP shapes. We consider
an autonomous model reconstruction result for a signif-
icantly longer BCL = 234 ±2 ms in figure S4. Both
the CRPSa(t) and maximal RMSEb(t) are significantly
increased for this reconstruction.
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. S4. Reconstruction results with the dataset with BCL =
234±2 ms, reporting the (a) CRPSa,o(t), (b) RMSEb(t), and
(c) spread through the depth SPRDb
u(t, z).
While the deviation in the RMSEb(t) is high-
amplitude, it is very short-lived (cf. figure S4(b)), and
the AP shape is reliably recovered for this dataset (cf.
figure S5(a)). As the model is able to fully recover be-
tween excitations, an entire mechanism of nonlinear feed-
back between the model, observations, and the LETKF
is no longer in effect. As expected for simpler dynam-
ics with longer BCLs, our approach performs remarkably
well both in detail and in aggregate. Notably, often the
reconstructed AP shape in figure S5(a) exhibits a pro-
nounced spike-and-dome structure, a structure which is
not typically exhibited for this model but appears in nu-
merous ionic models of cardiac excitation. The appear-
ance of this structure is why depictions of the AP for the
reconstruction must be approached with caution, as this3
is likely due to an over-eager excitation by the model
followed by LETKF correction of the ensemble states,
rather than a statistical feature of the data being repro-
duced by the reconstruction.
t [s]0.0 0.5 1.0 1.5 2.0Auto.
0.00.51.0
APD [ms]6080 100 120 140APA
0.91.01.1(a)
(b)
uo(t)
ub(t)
FIG. S5. (a) Temporal traces for the observations with
BCL=234 ±2 ms and the reconstruction using the autonomous
model, and (b) the distribution of APD and APA for the APs
in this sequence ( uthr= 0.2).
The APD and APA distribution is well-matched for
this trace, cf. figure S5(b); the former is expected based
on the shorter BCL results, and the latter appears to be
due to the longer period between excitations, lessening
the impact of APA alternans and thus better tuning to
the attainable AP morphologies for the Fenton-Karma
model. That is, while the dynamics is well within the 1:1
regime, the reconstruction is better able to correct for the
AP shape because the entire ensemble is guaranteed to
have the same periodicity and phase, whereas in regimes
with strong alternans some ensemble members may be
on a different beat than others, constraining the available
degrees of freedom for correcting the AP shape.
E. Model Parameter Sensitivity
1. Conductivities
In Ref. 1 the model parameters are determined (“man-
ually tuned”) and the conductivity of the tissue is
estimated using a customized data assimilation ap-
proach. The model parameters are used throughout this
manuscript in the reconstruction problem, save for the
estimated conductivities, which are unphysically high
to account for the very fast propagation of excitation
across the tissue. The values used in this manuscript are
D∥=σ∥/9 and D⊥=σ⊥/15, where σ∥,⊥are the reportedestimates for the fiber-aligned and fiber-orthogonal con-
ductivities, respectively.
In the interest of robustness, we tested the unphys-
ically high conductivities (with a reduced model inte-
gration time-step δt= 2×10−4) in our reconstruction
problem. As stated in the text, we found that the re-
construction was substantially worse than the Free-Run
experiment as without a periodic stimulus current, the
ensemble returns to quiescence and is unable to re-excite
through the LETKF driving alone.
CRPSa,o(t)
0.00.51.0RMSEb(t)
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0z/d
0.00.51.0
(a)
(b)
(c)
SPRDub(t,z)
0.00.51.0
FIG. S6. Reconstruction for the stimulated Barone model
with D∥,⊥=σ∥,⊥= (0.009,0.003) cm2/ms from Ref. 1, with
the (a) CRPSa,o(t), (b) RMSEb(t), and (c) spread through
the depth SPRDb
u(t, z).
In conjunction with the stimulus current, we were able
to match the baseline frequency of the excitations in the
observations and consistently ignite the ensemble states.
Figure S6 depicts the reconstruction problem for the
stimulated ‘fast’ model with unphysically large conduc-
tivities. Clearly this reconstruction is worse in every
measure—indeed, even with these high conductivities,
the ensemble can not match the wave speed in the ob-
servations, due to consistent interaction with refractory
tissue.
2. Excitable model parameters
Finally, we turn to the excitable model parameters
themselves. As the Fenton-Karma model is sufficiently
flexible to fit large space of possible restitution curves,
we used three different parameter sets to compare the
reconstruction sensitivity to the excitable model param-
eters, summarized in Table I. The Beeler-Reuter (BR)4
and Guinea Pig (GP) parameter sets are adapted from
Ref. 2.
Parameter BR GP Barone units
τsi 30.0 22.0 127 [ms]
τ−
v1 1250 333 38.2 [ms]
τ−
v2 19.6 40.0 38.2 [ms]
τ+
v 3.33 10.0 1.62 [ms]
τ−
w 41.0 65.0 80 [ms]
τ+
w 870 1000 1020 [ms]
τd 0.25 0.12 0.1724 [ms]
τo 12.5 12.5 12.5 [ms]
τr 33.0 25.0 130 [ms]
k 10.0 10.0 10
uc 0.13 0.13 0.13
uv 0.04 0.025 ∗
usi
c 0.85 0.85 0.85
TABLE I. Fenton-Karma model parameter values used in dy-
namical model for the reconstruction of experimental data.
∗Note: as τ−
v1≡τ−
v2, the switching parameter uvis unspeci-
fied in Ref. 1.
Barone
0.00.51.0
APA
0.91.01.1BR
0.00.51.0
APA 0.91.01.1
t [s]0.0 0.51.0 1.5 2.0GP
0.00.51.0APD [ms]6080100 120
APA
0.91.01.1(a) (d)
(b) (e)
(c) (f)uo(t) ub(t)
FIG. S7. Pairs of (a-c) temporal traces of the reconstruction
ub(t) and observation uo(t) at randomly selected locations for
the Barone et al. , BR, and GP parameter sets, and (d-f) the
corresponding distributions of APD and APA ( uthr= 0.2).
In figure S7(a) we reproduce the temporal traces of the
observations and reconstruction using the Barone et al.
parameter set for a randomly selected position covered
by the observations, and show the APD and APA distri-
butions for both signals in figure S7(d). The BR and GP
model parameters predominantly impact the AP shape,
driving the larger RMSEb(t) in figure S8(b,c). The AP
shape is not reliably recovered for the reconstructions
with the BR and GP parameter sets, cf. figure S7(b,c),
respectively. As a result, both the BR and GP modelsperform worse at approximating the APD and APA dis-
tributions of the observations, cf. figure S5(e,f), respec-
tively. This indicates that the Barone et al. parameter
set adequately models the underlying true dynamics, de-
spite localized surface reconstruction errors during each
new excitation.
We computed autonomous data assimilation recon-
structions for each new parameter set to understand the
impact of the excitable model parameters on the recon-
struction, and summarize these results in figure S8 in
which we (a) reproduced the the baseline autonomous
reconstruction outputs with the Barone et al. parameter
set used throughout the main text, and consider the re-
construction using (b) Beeler-Reuter and (c) Guinea Pig
parameter sets, reporting CRPSa,o(t), RMSEb(t), and
the spread through the depth SPRDb
u(t, z). Not only
is the RMSEb(t) substantially larger (worse) for the (b)
Beeler-Reuter (BR) and (c) Guinea-Pig (GP) parameter
sets, the change in excitability parameter τdyields dra-
matically different AP shapes and conduction velocities;
this likewise changes the steady-state distribution of en-
semble spread through the depth. For example, slower
waves for the BR parameter set propagate into the inte-
rior less over the assimilation interval leading to higher
erroneous certainties, while the relatively fast GP waves
propagate information from the surfaces into the interior.
Of particular note is the change in the CRPSo(t) for
the BR and GP parameter sets, cf. figure S8(b,c). In
both cases, the background ensemble shows significant
disagreement with the observation sequence compared to
the Barone et al. parameter set, and likewise reaffirms
our earlier conclusion from the AP traces that the pa-
rameter set used in this work is an adequate model of
the true dynamics for this dataset and model.
F. Deviation from the Autonomous Model Reconstruction
In figure S9, we compare the deviation in the recon-
struction error and the reconstruction spread for the
Stochastic and Stimulus models, with the autonomous
results as a baseline. Both the Stochastic and Stimu-
lus model reconstructions show minor deviations from
the Autonomous results, corresponding to oscillating im-
provements (for ∆RMSEb(t)>0) or detriments (for
∆RMSEb(t)<0) over time. The reconstruction errors
correspond to ∆RMSEb(t) = RMSEb
*(t)−RMSEb
Auto.(t),
and similarly for the spread ∆SPRDb
u(t) = SPRDb
u,*(t)−
SPRDb
Auto.,u (t), where ∗ ∈ { Stim. ,Stoch. }. Additionally,
we can compare the the error between the background
ensemble mean and the observations, denoting this quan-
tity as a vector function e∗(t) =ub−uo∈Rl, where l
is the observation dimension. The expectation value of
the change in the reconstruction error for the Stimulus
and Stochastic models over time and space for the error
is smaller than the variation in the reconstruction error,
mean( |e∗(t)−eAuto.(t)|)≪std(|e∗(t)|),5
Barone
0.00.51.0CRPSa,o(t)BR
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2. 0GP
0.00.51.0RMSEb(t)
t [s]0.0 0.5 1.0 1.52.0
z/d
0.00.51.0SPRD ub(t,z)
z/d
0.00.51.0
t [s]0.0 0.5 1.0 1.5 2.0
z/d
0.00.51.0
(a)
(b)
(c)
SPRD ub(t,z)
0.00.51.0
FIG. S8. Reconstruction results for the autonomous model using the (a) Barone et. al, (b) Beeler-Reuter, and (c) Guinea Pig
parameter sets.
ΔRMSEb(t)
-0.2-0.10.00.10.2
t [s]0.0 0 .5 1.0 1 .5 2.0ΔSPRD ub(t)
-0.2-0.10.00.10.2(a)
(b)Stoch. Stim.
FIG. S9. Difference from the Autonomous reconstruction er-
ror for the Stochastic and Stimulus model reconstructions;
depicting the (a) ∆RMSEb(t) and (b) ∆SPRDb
u(t), as well as
their marginal distributions.where mean and std are the standard mean and standard-
deviation functions, evaluated over all 1000 assimilation
intervals and all lindices in e∗(t), enumerating the ob-
servations. At these scales, figure S9(b) clearly shows
the increased spread of the ensemble for the Stochastic
model reconstruction; where peaks in ∆SPRDb
Stoch. ,u(t)
achieve similar magnitudes as the Stimulus model, but
each peak is appreciably non-zero over longer intervals.
1A. Barone, A. Gizzi, F. Fenton, S. Filippi, and A. Veneziani,
“Experimental validation of a variational data assimilation pro-
cedure for estimating space-dependent cardiac conductivities,”
Computer Methods in Applied Mechanics and Engineering 358,
112615 (2020).
2F. Fenton and A. Karma, “Vortex dynamics in three-dimensional
continuous myocardium with fiber rotation: Filament instability
and fibrillation,” Chaos: An Interdisciplinary Journal of Nonlinear
Science 8, 20–47 (1998).