LATEX template
Experimental and numerical investigations
on heat transfer in fused lament fabrication
3D-printed specimens
Nathalie Ramos1,2*, Christoph Mittermeier2and Josef
Kiendl2,1
1Department of Marine Technology, Norwegian University of
Science and Technology, Otto Nielsens Veg 10, Trondheim, 7491,
Norway.
2Institute of Engineering Mechanics & Structural Mechanics,
Bundeswehr University Munich, Werner-Heisenberg-Weg 39,
Neubiberg, 85577, Germany.
*Corresponding author(s). E-mail(s): nathalie.ramos@ntnu.no;
Abstract
A good understanding of the heat transfer in fused lament fabrica-
tion is crucial for an accurate stress prediction and subsequently for
repetitive, high quality printing. This work focuses on two challenges
that have been presented when it comes to the accuracy and eciency
in simulating the heat transfer in the fused lament fabrication pro-
cess. With the prospect of choosing correct thermal boundary conditions
expressing the natural convection between printed material and its envi-
ronment, values for the convective heat transfer coecient and ambient
temperature were calibrated through numerical data tting of exper-
imental thermal measurements. Furthermore, modeling simplications
were proposed for an ecient numerical discretization of inll struc-
tures. Samples were printed with varying inll characteristics, such
as varying air void size, inll densities and inll patterns. Thermal
measurements were performed to investigate the role of these param-
eters on the heat transfer and based on these observations, possible
modeling simplications were studied in the numerical simulations.
Keywords: 3D printing, fused lament fabrication, heat transfer, convective
boundary conditions, inll structures, air voids
1arXiv:2305.04307v1  [math.NA]  7 May 2023LATEX template
2
1 Introduction
Fused lament fabrication (FFF), or fused deposition modeling, is one of the
most widely applied additive manufacturing methods. It is a three-dimensional
(3D) printing method in which a thermoplastic material is extruded through a
nozzle to construct a layer-by-layer structure [1]. Once lauded for its potential
in prototype manufacturing, it has now found its way into a plethora of elds
and applications, such as biomedical, electrical and aerospace engineering [2].
Advantages of FFF printing are the relatively low costs, wide applicability and
availability, large variety of suitable materials and the ease of use [3, 4]. Some
of these advantages have caused a surge of the use of FFF in four-dimensional
(4D) printing, where the fourth dimension represents the change of shape over
time of the smart materials [5, 6]. By combining FFF printing, and the use
of shape memory polymers (SMP), structures can be printed that can main-
tain a temporary shape and that can return to their original shape after being
exposed to an external stimulus, such as heat [7]. The thermal sensitive nature
of printed SMP parts enables potential applications such as fasteners in active
assembly/disassembly, smart actuators and deployable structures for aerospace
applications [3, 8, 9].
However, deposition of the lament at high temperatures, followed by quick
cooling to enforce solidication results in signicant thermal gradients and
subsequently, residual stresses [1]. The presence of residual stresses can lead
to warping during printing which can result in a failed print [10]. This is a
common problem for Acrylonitrile Butadiene Styrene (ABS). Residual stresses
can also cause distortion of parts and a loss of strength [11]. In case of printed
parts with strict geometrical tolerances or structural requirements, this eect
can lead to a loss of functionality.
During FFF printing the material is extruded at a temperature which is
typically higher than the glass transition temperature. It is either deposited
on the building platform or cooled existing layers, causing the material to be
(partially) stretched as it bonds, to cool down and to nally solidify [12]. The
induced pre-strain will be released as soon as the material is heated above
the glass transition temperature and a 'new' permanent shape emerges. An
example of such programming can be seen in gure 1 where two rectangular
specimens are printed at, but with a dierent orientation of the printed l-
ament. After reheating the samples above the glass transition temperature,
they either bend upwards, or twist upwards depending on the printing orien-
tation. Such approach has been used in 4D printing to design structures with
self-folding, self-bending, self-twisting and shape-shifting mechanisms [12{15].
Whether the objective is to repetitively print parts of high quality, or to
print SMP parts with a 4D eect, understanding the heat transfer is crucial
for an accurate stress and bond strength prediction [16]. Several eorts have
been made to predict thermal gradients and the development of the residual
stresses in printed parts by performing thermo-mechanical nite element sim-
ulations. Such simulations often make use of sequential element activation to
represent the deposition sequence that takes place during FFF printing. ZhangLATEX template
3
and Chou [17] used such a model to perform a parametric study to predict part
distortions in ABS. The analysis was thermo-mechanically coupled and the
inuence of various process parameters on the residual stresses was studied.
Zhou et al.[18] presented a numerical model in which the heat transfer in ABS
material was analyzed during the FDM process. In their model temperature-
dependent material properties were used for the specic heat capacity and
thermal conductivity. Cattenone et al. [1] performed thermo-mechanical simu-
lations in which the FFF process was simulated to predict part distortions in
ABS. Special attention was paid to the constitutive modeling of the polymer,
and the inuence of numerical considerations on the predicted residual stresses,
such as time step size and meshing strategies. Yin et al. [16] performed sim-
ilar heat transfer simulations but with a dierent objective. They used such
models to predict the inter-facial bonding strength between printed laments.
This work focuses on two challenges that have been presented when it
comes to the accuracy and eciency in simulating the heat transfer in the
FFF process. The rst challenge that arises is the correct choice of thermal
boundary conditions, particularly the convective heat transfer coecient. The
exact magnitude of this parameter is not always explicitly stated, its empiri-
cal determination can be quite cumbersome and often the focus is on forced
convection. Pereira et al. [19] focused on forced convection in their investi-
gation of the eect of surface roughness on the convective heat transfer on
the surfaces of FFF printed ABS cylindrical specimens. Zhou et al. [20] also
calculated a value of the heat transfer coecient based on forced convection
over a rectangular body model. Costa et al. [21] did focus on natural convec-
tion between printed lament and the ambient air, but the determined values
for the heat transfer coecient still varied between a fairly large range (5-60
W/m2K) and this range was not experimentally validated. Lepoivre et al.
[22] determined the heat transfer coecient by an empirical correlation for an
external free convection ow. The magnitude of the parameters used in said
correlation were not listed or further elaborated.
In this work the heat transfer coecient is determined experimentally.
Experimental thermal measurements are numerically simulated and a value
for the heat transfer coecient that describes natural convection is determined
through data tting.
The second challenge is related to the computational eort which is
required for an accurate heat transfer simulation. In previous work, the printed
material is often modeled as a continuum in which the nite element size
is determined by the lament cross-sectional dimensions. This is a computa-
tionally expensive exercise as the cross-section of a lament is much smaller
than the global dimensions of printed geometries. As a result, the question
arises how the modeling can be simplied to speed up simulations. The rst
question that must be answered is whether the assumption of discretizing the
material as a continuum without accounting for the inherent air voids is an
accurate one. If this is the case, methods to simplify the discretization of the
characteristic mesostructure can be investigated and the computational eortLATEX template
4
(a) Programmed bending
 (b) Programmed twisting
Fig. 1 : Shape change after heating FFF printed specimens above T g
required in heat transfer simulations can be reduced. Thus, in this work sam-
ples are printed with varying inll characteristics, such as varying air void
size, inll densities and inll patterns. Thermal measurements are performed
to investigate the role of these parameters on the heat transfer. Based on the
observations made in these experiments, possible modeling simplications are
studied in the numerical simulations.
The remainder of this paper is set up as follows. The materials and meth-
ods used in the thermal measurements and numerical simulations on samples
of varying inll geometries are presented in section 2. The results of the experi-
mental thermal measurements are subsequently presented in section 3. Section
4 is dedicated to the numerical simulations. A value for the heat transfer coe-
cient is determined by numerically tting the data obtained in the experiments
and modeling simplications of complex inll geometries are investigated.
Finally the conclusions are presented in section 5 and ideas for future research
are proposed.
2 Materials and Methods
2.1 Experimental set-up
All specimens used in this work were printed with a Prusa i3 MK3 printer.
The material used was Poly Lactid Acid (PLA) and the thermal properties
as provided by the manufacturer Fillamentum are listed in table 1. A JADE
CW infrared camera from Cedip Infrared Systems was used for the thermal
measurements. The experimental set-up used in this paper is shown in gure
2. The measuring procedure was as follows. First the printing bed was heated
up to a nominal temperature of 60C. A printed specimen was then placed on
the heated printing bed for a suciently long time to allow for time to reach
a steady-state. The heating of the specimens was recorded with the thermalLATEX template
5
Property Value
Density 1240 kg/m3
Specic heat capacity cp1800 J/kg K
Conductivity K0 0.13 W/m K
Table 1 : Thermal properties PLA
(a) Set-up thermal recording
 (b) Data points thermal measurements
Fig. 2 : Experimental set-up
camera and the temperature proles were recorded with a sampling frequency
of 1 Hz. The temperature evolution in time was recorded for ve points on
the top surface of the specimens (gure 2). All measurements were performed
three times and they were spaced at least 4 hours apart to ensure full cooling
prior to reheating. Even though the temperature of the printing bed was set
to 60C, the temperature which was measured on the surface of the bed with
the thermal camera was equal to 56C. The temperature of the ambient air in
the room was 25C.
2.2 Geometries and inll structure
To facilitate the study of the two objectives in this paper dierent specimens
printed with varying global and inll geometries were used during the thermal
measurements. A reference specimen was printed which was used in the tting
process of the convective thermal boundary condition. All of the other printed
specimens had a dierent inll geometry (air content, inll pattern) to investi-
gate the inuence of dierent inlls on heat ow through the specimen. There
are two dierent ways to vary the air content in the FFF printed specimens:
1. By variation of the extrusion factor
2. By variation of the inll density
Both approaches are shown schematically in gure 3. Varying the extrusion
factor in a densely packed setting of laments inuences the size of the air
voids between those laments. The inll density controls the gap size between
the printed laments.
The Prusa slicer recommends a default value for the extrusion factor. ThisLATEX template
6
will be referred to as the default extrusion factor of 1.0 (EF=1.0). One sam-
ple was printed with the default extrusion factor, and the second sample was
printed with an extrusion factor which was 10% higher than the default value.
The dimensions of these samples were 30x30x2 mm and both specimens were
printed with an inll density of 100%. These specimens were heated for ve
minutes. For the numerical discretization of the geometries with varying extru-
sion factor, a model as shown in gure 4 was used. The diamond shaped air
voids were assumed based on a CT-scan of one of the printed samples (gure
4). The air void size is governed by parameter aand it was used to express
the area of the air voids Aairas a fraction of the total area Atot:
Atot=wh
Aair=1
2awah4 = 2a2wh
Af=Atot Aair= (1 2a2)wh
vfr;a=Aair
Atot= 2a2(1)
wherewandhare the width and the height of a printed lament respectively,
as can be seen in gure 4. The width of the lament equaled 0.45 mm and the
layer height equaled 0.2 mm for all samples used in this work. By calculating
the real volume fractions of air and lament in the printed samples, eq. 1 was
solved fora. The real volume fractions were calculated as follows (eq. 2):
1. The mass ( m) and total volume ( Vtot) of each printed sample were mea-
sured. The total volume was calculated by measuring the length, width
and thickness of the printed specimens with a vernier caliper.
2. From the mass, the (real) extruded volume Vextrwas calculated. The
density of PLA was used (table 1).
3. The volume fractions of the lament vfr;fand airvfr;awere then
calculated.
Vextr=m

vfr;f=Vextr
Vtot
vfr;a= 1 vfr;f(2)
The samples for which the inll density and pattern were varied were
printed with an extrusion factor of 1.0 and an inll density 100%. These sam-
ples were printed in the shape of a block with the dimensions of 30x30x20 mm.
Two inll patterns were chosen; a rectilinear and a gyroid inll pattern (gure
5). The total steady-state heating time for these specimens was 40 minutes.
An overview of all the FFF printed samples with their dimensions, inll
characteristics and heating time is given in table 2. The additional parameters
required to describe the geometry of the cross-section of the printed specimens
with varying air void size are listed in table 3.LATEX template
7
(a) Default inll
 (b) Varying the extrusion fac-
tor
(c) Varying the inll density
Fig. 3 : Two dierent ways of varying the air content
(a) CT-scan of the cross-section of a printed
specimen
(b) Schematization laments & air
voids
(c) FE mesh of laments and air voids
Fig. 4 : Discretization of air voids in the printed samples
Sample lwh[mm] Inll pattern Extrusion factor [-]Inll density [%] Heating time [min]
S1 30x30x20 rectilinear 1.0 100 40
S2 30x30x20 rectilinear 1.0 50 40
S3 30x30x20 rectilinear 1.0 25 40
S4 30x30x20 gyroid 1.0 50 40
S5 30x30x20 gyroid 1.0 25 40
S6 30x30x2 rectilinear 1.0 100 5
S7 30x30x2 rectilinear 1.1 100 5
Table 2 : Overview of the printed samples and their characteristics
2.3 Thermal analysis
The heat transfer can be divided into various heat exchange modes [21]:
1.Convection with the environment,
2.Radiation with the environment and between adjacent laments,
3.Conduction with the printing bed and between adjacent laments.LATEX template
8
Fig. 5 : Examples of FFF printed specimens with rectilinear (left) and gyroid
(right) inll patterns (both at 25% inll density)
EF m [g]Vtot[cm3]Vextr[cm3]vfr;f[-]vfr;a[-]a[-]
1.0 2.10 1.78 1.69 0.95 0.05 0.16
1.1 2.32 1.89 1.87 0.99 0.01 0.07
Table 3 : Geometrical paramaters of the cross-section of samples printed with
dierent extrusion factors
Generally, conduction is well described by utilizing conductivity parameters
found either in literature or provided by lament manufacturers. Filament
cooling due to radiative heat exchange between the laments is negligible [21].
Radiation with the environment can have an inuence on lament temper-
ature when the value of the heat transfer coecient, the parameter which
expresses convection, is relatively low (5 W/m2K) [21]. However, in most prac-
tical applications this value is much higher, which means that overall lament
cooling becomes convection controlled [21]. Thus, in this work heat transfer
by radiation was neglected and the focus was on determining the heat transfer
coecient and the temperature of the ambient air that describes the convec-
tion with the environment.
The temperature eld T(x;t) is described by the heat equation:
cp@T(x;t)
@t=r(K0rT(x;t)) +q (3)
wherecp[J/kgK] is the specic heat capacity, [kg=m3] is the material density,
K0[W/mK] is the conductivity of the material, and q[W/m3] is the internal
heat source. The thermal properties of PLA shown in table 1 were used here.
The initial temperature of the specimens equaled the room temperature Ta,
thus the initial condition is expressed as:
T(x;0) =Tax2
 (4)
where 
 represents the domain of the printed specimen. Distinction is made
between the boundary conditions at the interface between the heated print-
ing bed and the sample   b, and at the free surfaces of the sample   f. TheLATEX template
9
temperature of the heated printing bed is applied as a Dirichlet boundary
condition:
T(x;t) =Tbx2 b (5)
At the free surfaces, it is assumed that the heat exchange between the sam-
ple and the environment is governed by convection. The Neumann boundary
conditions are expressed as:
K0@T(x;t)
@n+qc= 0 x2 f
qc=h(T(x;t) Tc)(6)
whereh[W/m2K] is the heat transfer coecient, and Tcis the temperature of
the ambient air. These two parameters were calibrated by tting the numerical
simulations to the experimental data acquired in the thermal measurements.
Due to the nature of the thermal measurements, it was not entirely clear how
the temperature was distributed in the vicinity of the outer surface of the
sample. Since the printed specimens were relatively small, the heated printing
bed might have inuenced the temperature of the air surrounding the samples.
This eect was taken into account during the calibration of the heat transfer
coecient. The process was structured in such a way that three situations were
taken into account for the temperature of the ambient air:
1. Case 1
It was assumed that the printing bed did not have a signicant inuence
on the temperature of the ambient air. The temperature of the ambient
air equaled room temperature Ta.
2. Case 2
The temperature of the ambient air was higher than the room tempera-
ture due to the heated printing bed. The same elevated temperature was
assumed for all of the free surfaces of the heated specimen.
3. Case 3
In this case, it was still assumed that the free surfaces on the sides of the
specimen,   f;swere exposed to air of which the temperature was higher
than room temperature. However, since the top surface of the specimen,
 f;twas more distant from the printing bed, a dierent temperature was
assumed for this surface.
2.4 Numerical set-up
All nite element (FE) analyses simulating the heat transfer in the printed
specimens were set up in Ansys (Mechanical APDL 19.2). The analysis type
was a transient thermal analysis. The initial and boundary conditions are
listed in equations 4-6. The FE samples were discretized with 8-node thermal
nite elements (SOLID70). The default element size coincided with the width
of the extruded lament and layer height of the printed specimens. This is
the case unless it is explicitly stated that a dierent mesh discretization was
used. Convergence analyses were performed prior to all simulations presentedLATEX template
10
Fig. 6 : Summary of experimental and numerical methodology used in this
paper
in this paper to ensure that the chosen mesh sizes were appropriate. As the air
content in the printed samples was included in some simulations, distinction
was made between the material properties of the air and of the PLA. Both
materials were discretized with the same element type. All analyses that were
performed in this work were assumed to be physically linear. This assumption
is deemed valid as the maximum temperature that the specimens were heated
up to is lower than the glass transition temperature of PLA. Thus, the constant
thermal properties as given in table 1 were used in the numerical simulations.
In the simulations, the measured value of 56C was used for the temperature
of the heated printing bed, unless it is explicitly stated otherwise.
The overall experimental and numerical methodology is summarized in
gure 6. On the left side of the chart it is shown that the inuence of the
inll density (and pattern) is measured experimentally in specimens S1 - S5.
Specimens S6 and S7 are used for the measurement of the inuence of the
air voids. Prior to numerical validation of these two factors, the convective
thermal parameters handTcare numerically calibrated by using the experi-
mental measurements on specimen S1, and numerically validated by comparing
numerical and experimental results on specimens S2 and S3.
3 Experimental results
3.1 Varying inll density
Specimens S1, S2 and S3 were heated to capture the inuence of the inll
density on the heat ow. Figure 7 shows the measured average temperature and
envelope for each specimen as well as a comparison of the measured average
temperature between the specimens with dierent inll density. The envelope
data consists of three measurement repetitions on ve data points for each
measurement (15 data points total). It can be seen that the inll density aects
the steady-state temperature and the heating rate. The signicant increase inLATEX template
11
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=100%, AVG values
(a) 100% inll density
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=50%, AVG values (b) 50% inll density
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=25%, AVG values
(c) 25% inll density
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=100%, exp.
ID=50%, exp.
ID=25%, exp. (d) Inuence inll density
Fig. 7 : Experimental results of thermal measurements samples with varying
inll density
air content for the samples with lower inll density results in less mass to be
heated, which explains the faster heating rate.
3.2 Varying extrusion factor
Figure 8 shows the results of the thermal measurements on the specimens S6
and S7 with varying air void size. Both the average values and the envelopes
are plotted. Additionally, a comparison is made between the results of samples
S6 and S7 to see what the inuence is of the air void content. It can be seen
that there is no signicant dierence between the temperatures measured on
the samples printed with dierent extrusion factors. Varying the extrusion
factor and thus the air void size does not seem to inuence the heat transfer
in the printed samples.LATEX template
12
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]EF=1.0, AVG values
(a) EF=1.0
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]EF=1.1, AVG values (b) EF=1.1
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]EF=1.0
EF=1.1
(c) Inuence extrusion factor
Fig. 8 : Results thermal measurements on specimens printed with 100% inll
density and varying extrusion factors
3.3 Varying inll pattern
To see whether the type of inll pattern inuences the heat transfer, a com-
parison is made between samples printed with a rectilinear inll pattern and
samples with a gyroid inll pattern. The comparison is done at an inll den-
sity of 50% (S2 and S4) and 25% (S3 and S5). The experimental results of
the thermal measurements are shown in gure 9. At both inll densities, the
dierences between the measured temperatures of the rectilinear and gyroid
specimen are negligible. Both the heating rate and steady-state temperature
are similar for the samples with a rectilinear and gyroid inll pattern.LATEX template
13
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Rectilinear inﬁll
Gyroid inﬁll
(a) Inll density=50%
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Rectilinear inﬁll
Gyroid inﬁll (b) Inll density=25%
Fig. 9 : Inuence of inll pattern on heat transfer (experimental results)
4 Numerical results & discussion
4.1 Determining the convective parameters
The three cases as described in section 2.3 were used in the calibration of
the convective parameters, handTc. The numerical results presented below
were tted to the the experimental results from the thermal measurements
on sample S1. The experimental thermal measurements of samples S2 and S3
were used for validation of the determined parameters.
4.1.1 Case 1
The rst situation considered in the tting process was the one in which the
ambient temperature was assumed to be equal to the room temperature of
25C. This value was also used as the initial temperature of the FE sample
in the numerical simulations. The heat transfer coecient in the simulations
was varied between 10 and 30 W/m2K. The results are plotted in gure 10
forh=10, 20, 30 W/m2K. It is obvious that none of the simulations show
agreement with the measurements. In each of the simulations, the converged
temperature is signicantly lower than the steady-state temperature found
in the measurement (within the time frame of 40 minutes). Increasing the
heat transfer coecient above 30 W/m2K leads to an even lower steady-state
temperature and a faster heating rate. For h=10 W/m2K, the steady-state is
not reached within the considered time span, so using a smaller value for the
heat transfer coecient will delay this even further.
4.1.2 Case 2
The assumption of the printed specimen being subjected to room tempera-
ture convection in the vicinity of its free surfaces seems to be incorrect. The
simulations were therefore repeated for the same values of has in gure 10,LATEX template
14
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Exp. meas.
h=10 W/m2·K, sim.
h=20 W/m2·K, sim.
h=30 W/m2·K, sim.
Fig. 10 : Numerical simulations compared to experiments (case 1)
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Exp. meas.
Ta=25◦C, sim.
Ta=30◦C, sim.
Ta=32◦C, sim.
(a) h=20 W/m2K
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Exp. meas.
Ta=25◦C, sim.
Ta=30◦C, sim.
Ta=32◦C, sim. (b) h=30 W/m2K
Fig. 11 : Numerical simulations compared to experiments (case 2)
but in combination with higher values for the ambient temperature. In gure
11 the results are plotted for the simulations in which the ambient tempera-
ture was varied between 25-32C, with heat transfer coeents of 20 W/m2K
and 30 W/m2K. The same convective parameters were applied at all free sur-
faces. It can be seen that the correct steady-state temperature is reached for
h=20 W/m2K andTc=32C. However, the temperature at the start of the
simulation increases much faster than in the experimental measurements. This
problem is not solved by choosing a dierent value for hthan those displayed
in gure 11.
4.1.3 Case 3
In an attempt to tackle the overestimated heating rate at the start of the
simulations, the ambient air temperature at the top surface Tc;t, was variedLATEX template
15
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Exp. meas.
h=20 W/m2·K, sim.
h=25 W/m2·K, sim.
h=30 W/m2·K, sim.
(a)Tc;t=27C,Tc;s=56C
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Exp. meas.
h=20 W/m2·K, sim.
h=25 W/m2·K, sim.
h=30 W/m2·K, sim. (b)Tc;t=27C,Tc;s=60C
Fig. 12 : Fitting of numerical simulations to experiments (case 3)
between 25C and 32C. The temperature at the side surfaces of the spec-
imensTc;s, was chosen to be higher than room temperature, again under
the assumption that the printing bed heated up the air above it too. This
temperature was varied between 32C and the bed temperature. Heat transfer
coecients of 20, 25 and 30 W/m2K were prescribed at all free surfaces. In
gure 12 the results are plotted for the case in which the temperature at the
side surfaces is equal to the bed temperature and the temperature at the top
surface equals 27C. It can be seen that these values for the air temperature
combined with a heat transfer coecient of 25 W/m2K provide a good match
with the experimental measurements.
Typically, the exact temperature on the surface of the printing bed is
not measured but assumed to be equal to the value prescribed in the print-
ing settings. To account for this, the data tting process was repeated for
Tb=Tc;s=60C. These results are shown in gure 12. It can be seen that h=30
W/m2K combined with Tc;s=60C andTc;t= 27C also provides a good t
with the experimental results. In the remainder of this paper, the following
convective parameters are used: h=25 W/m2K,Tc;s=56C,Tc;t=27C.
4.1.4 Validation h&Tc
The accuracy of the calibrated convective parameters was validated by sim-
ulating the thermal measurements performed on the specimens printed with
50% and 25% inll density. The results of the numerical simulations are plotted
against the experiments in gure 13 for both of the specimens. Good agreement
is found between the simulations and experiments.LATEX template
16
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=50%, sim.
ID=50%, exp.
(a) Inll density=50%
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]ID=25%, sim.
ID=25%, exp. (b) Inll density=25%
Fig. 13 : Validation of determined convective boundary conditions: numerical
simulations against experiments
4.2 Modeling simplications of the inll structure
4.2.1 Air voids
In the simulations of the samples with an inll density of 100% and an extru-
sion factor of 1.0 presented in section 4.1, the FE meshes were made completely
dense, ignoring the air voids that were present between the printed laments.
At the same time, the experiments performed on the samples with 100% inll
density and a varying extrusion factor (section 3.2), implied that role of the
air voids was negligible. In this section, we investigate whether a simplied
material discretization as used in aforementioned simulations is accurate, or if
it is necessary to model the air voids as well.
The simulations presented in this section were performed with a FE mesh
which didn't include air voids, and with FE meshes which included air voids
according to the extrusion factors that were used in the printed specimens
(table 3). A sample of the detailed mesh including air voids is shown in gure
4. It consists of 13 hexahedral and prismatic elements for the cross-section of
a single printed lament with surrounding air compared to one brick element
when air voids are not included in the discretization.
The numerical results are shown in gure 14. First, the experimental results
for the specimens printed with dierent extrusion factors are compared with
the simulations obtained with the meshes including air voids. It can be seen
that there is good agreement between the experimental and numerical results.
The dierence between the steady-state temperatures found in the simula-
tions and experiments is less than 2%. A comparison is also made between the
numerical results for the meshes in which air voids of varying size are included
with a mesh in which the material is discretized as a continuum without air
voids (gure 15). No signicant dierence is found between the measured tem-
peratures for the dierent meshes. This coincides with the observation foundLATEX template
17
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]EF=1.0 (a=0.16), sim.
EF=1.0, exp.
(a) Validation for EF=1.0: exp. vs. sim.
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]EF=1.1 (a=0.07), sim.
EF=1.1, exp. (b) Validation for EF=1.1: exp. vs. sim.
Fig. 14 : Inuence of the air void size: numerical results and experimental
validation
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]Air voids (a=0.16)
Air voids (a=0.07)
No air voids
(a) Air voids vs. no air voids (simulations)
0 50 100 150 200 250 3002030405060
Time [s]Temperature [◦C]No air voids: mesh 1
No air voids: mesh 2
No air voids: mesh 3 (b) Inuence mesh coarseness
Fig. 15 : Inuence of the air voids and mesh coarseness (simulations)
in the experimental measurements of the air voids size being of insignicant
inuence on the heat ow. Lastly, the meshes without air voids are coarsened
to a mesh where the element dimensions are twice as large as the lament
cross-sectional dimensions (mesh 2), and to a mesh where the element dimen-
sions are ve times as large as the lament dimensions (mesh 3). As can be
seen in gure 15, no signicant dierence is found between the results obtained
with these three meshes.
4.2.2 Inll density and pattern
From section 3.1 we know that varying the inll density has a signicant inu-
ence on the heating rate and steady-state temperature (gure 7), whereas theLATEX template
18
Elements [-] CPU [min]
Mesh 1 422500 96
Mesh 2 54450 5
Mesh 3 3380 <1
Table 4 : Comparison of CPU for various FE meshes
exact inll pattern doesn't seem to inuence the aforementioned characteris-
tics (gure 9). This means that it might be possible to simulate the accurate
heat transfer within complex inll geometries by using much coarser and sim-
plied FE meshes. To test this hypothesis, numerical models were set-up which
simulated the heat transfer in the samples printed with a 25% rectilinear inll.
In the models the geometry was discretized with the correct inll density and
type, but with meshes of varying coarseness. In the default mesh the element
dimensions equaled the dimensions of the lament cross-section. Based on the
default mesh, two other, coarser FE meshes were used. In mesh 2, the element
dimensions were twice as large as the lament cross-sectional dimensions. In
the coarsest mesh (mesh 3) the element dimensions were ve times as large as
those of the lament cross-section. Since the empty spaces between the printed
material were modeled with air elements, the air elements were also coarsened
accordingly. The three dierent meshes are shown in gure 16.
The results are plotted in gure 17. It can be seen that all of the aforemen-
tioned mesh discretizations yield a similar temperature prole. By using the
simplied and coarse rectilinear mesh (mesh 3), the computational time was
reduced signicantly. The number of elements and the CPU time required to
solve the numerical models with the various meshes are listed in table 4. When
compared to the experimental results of the thermal measurements performed
on the printed samples with rectilinear inll, there is also a good agreement.
The next modeling simplication was to discretize a complex inll pattern,
with both a simplied pattern and a coarser mesh. This has been done by
comparing the experimental results of the specimen with a gyroid inll pat-
tern with the coarsest rectilinear nite element model, both with a 25% inll
density. These results are shown in gure 18. Again, there is good agreement
between the experiments and the simulations. Both results in gures 17 and
18 support the experimental ndings, namely that exact inll pattern does not
inuence the temperature proles, as long as the correct inll density is taken
into account.
5 Conclusions & Outlook
The overall objective of this work was to provide more clarity on two aspects
which aect the accuracy and eciency of heat transfer simulations of FFF
printing. On one hand, a closer look has been taken at the prescription of ther-
mal convective boundary conditions. A value for the heat transfer coecient
and ambient temperature, expressing the natural convection between FFFLATEX template
19
(a) Mesh 1
 (b) Mesh 2
 (c) Mesh 3
Fig. 16 : FE meshes of varying coarseness for an inll density of 25% (blue:
PLA elements, purple: air elements)
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Rectilinear inﬁll (mesh 1), sim.
Rectilinear inﬁll (mesh 2), sim.
Rectilinear inﬁll (mesh 3), sim.
(a) Numerical results
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Rectilinear inﬁll (mesh 3), sim.
Rectilinear inﬁll, exp. (b) Numerical vs. experimental results
Fig. 17 : Comparison of various meshes for a rectilinear inll with 25% inll
density
printed material and its environment have been calibrated through numerical
data tting of experimental thermal measurements.
On the other hand, simplications for modeling air-lled and complex inll
structures have been investigated. It has been found that accurate heat trans-
fer can be simulated in such structures, as long as the inll density is respected.
Discretization of the exact inll geometry does not lead to a signicant increase
in accuracy of the heat transfer simulations when compared to the experimen-
tal data. In densely packed geometries, the printed material can be modeled
as a continuum. Discretization of the air voids between the printed lament is
not necessary for an accurate heat transfer prediction.
The work performed in this paper was limited to the use of PLA and a Prusa
i3 MK3 printer. For practical applications it would be of interest to expand
the research to other materials such as ABS and to industrial 3D printers. ItLATEX template
20
0 500 1000 1500 200020304050
Time [s]Temperature [◦C]Gyroid inﬁll, exp.
Rectilinear inﬁll (mesh 3), sim.
Fig. 18 : Complex inll structure discretized with a simplied coarse mesh:
gyroid inll vs. FE mesh 3
must also be noted that the inuence of the surface roughness of the printed
samples on the convective heat transfer was not taken into account. Lastly,
the modeling simplications proposed in this work have only been applied in
thermal simulations. The next step is to model the extrusion process in FFF
printing and to investigate the inuence of the process parameters on the heat
transfer and residual stresses.LATEX template
21
References
[1] Cattenone, A., Morganti, S., Alaimo, G., Auricchio, F.: Finite element
analysis of additive manufacturing based on fused deposition modeling:
Distortions prediction and comparison with experimental data. Journal
of Manufacturing Science and Engineering, Transactions of the ASME
141(1), 1{17 (2019). https://doi.org/10.1115/1.4041626
[2] Berman, B.: 3-D printing: The new industrial revolution. Business Hori-
zons 55(2), 155{162 (2012). https://doi.org/10.1016/j.bushor.2011.11.
003
[3] Yang, Y., Chen, Y., Wei, Y., Li, Y.: 3D printing of shape memory poly-
mer for functional part fabrication. International Journal of Advanced
Manufacturing Technology 84(9-12), 2079{2095 (2016). https://doi.org/
10.1007/s00170-015-7843-2
[4] Tymrak, B.M., Kreiger, M., Pearce, J.M.: Mechanical properties of
components fabricated with open-source 3-D printers under realistic envi-
ronmental conditions. Materials and Design 58, 242{246 (2014). https:
//doi.org/10.1016/j.matdes.2014.02.038
[5] Tibbits, S.: 4D printing: Multi-material shape change. Architectural
Design 84(1), 116{121 (2014). https://doi.org/10.1002/ad.1710
[6] Farid, M.I., Wu, W., Liu, X., Wang, P.: Additive manufacturing land-
scape and materials perspective in 4D printing. https://doi.org/10.1007/
s00170-021-07233-w
[7] Li, Y., Hu, J., Liu, Z.: A constitutive model of shape memory polymers
based on glass transition and the concept of frozen strain release rate.
International Journal of Solids and Structures 124, 252{263 (2017). https:
//doi.org/10.1016/j.ijsolstr.2017.06.039
[8] Ge, Q., Qi, H.J., Dunn, M.L., Ge, Q., Qi, H.J., Dunn, M.L.: Active
materials by four-dimension printing Active materials by four-dimension
printing. Applied physics letters 103(131901) (2013). https://doi.org/10.
1063/1.4819837
[9] Ge, Q., Dunn, C.K., Qi, H.J., Dunn, M.L.: Active origami by 4D printing.
Smart Materials and Structures 23(9) (2014). https://doi.org/10.1088/
0964-1726/23/9/094007
[10] Fitzharris, E.R., Watanabe, N., Rosen, D.W., Shofner, M.L.: Eects of
material properties on warpage in fused deposition modeling parts. Inter-
national Journal of Advanced Manufacturing Technologymanufacturing
95, 2059{2070 (2018). https://doi.org/10.1007/s00170-017-1340-8LATEX template
22
[11] Kuznetsov, V.E., Solonin, A.N., Urzhumtsev, O.D., Schilling, R., Tavi-
tov, A.G.: Strength of PLA components fabricated with fused deposition
technology using a desktop 3D printer as a function of geometrical param-
eters of the process. Polymers 10(3) (2018). https://doi.org/10.3390/
polym10030313
[12] Hu, G.F., Damanpack, A.R., Bodaghi, M., Liao, W.H.: Increasing dimen-
sion of structures by 4D printing shape memory polymers via fused
deposition modeling. Smart Materials and Structures 26(2017)
[13] Bodaghi, M., Damanpack, A.R., Liao, W.H.: Adaptive metamaterials by
functionally graded 4D printing. Materials and Design 135, 26{36 (2017).
https://doi.org/10.1016/j.matdes.2017.08.069
[14] Van Manen, T., Janbaz, S., Zadpoor, A.A.: Programming 2D/3D shape-
shifting with hobbyist 3D printers. Materials Horizons 4(6), 1064{1069
(2017). https://doi.org/10.1039/c7mh00269f
[15] van Manen, T., Janbaz, S., Zadpoor, A.A.: Programming the shape-
shifting of at soft matter. Elsevier B.V. (2018). https://doi.org/10.1016/
j.mattod.2017.08.026
[16] Yin, J., Lu, C., Fu, J., Huang, Y., Zheng, Y.: Interfacial bonding during
multi-material fused deposition modeling (FDM) process due to inter-
molecular diusion. Materials and Design 150, 104{112 (2018). https:
//doi.org/10.1016/j.matdes.2018.04.029
[17] Zhang, Y., Chou, K.: A parametric study of part distortions in fused
deposition modelling using three-dimensional nite element analysis.
International Journal of Engineering and manufacturing 222, 959{967
(2008). https://doi.org/10.1243/09544054JEM990
[18] Zhou, Y., Nyberg, T., Xiong, G., Liu, D.: Temperature Analysis in
the Fused Deposition Modeling Process. In: Proceedings - 2016 3rd
International Conference on Information Science and Control Engineer-
ing, ICISCE 2016, pp. 678{682. Institute of Electrical and Electronics
Engineers Inc., ??? (2016). https://doi.org/10.1109/ICISCE.2016.150
[19] Pereira, L., Letcher, T., Michna, G.J.: The eects of 3D printing param-
eters and surface roughness on convective heat transfer performance.
ASME 2019 Heat Transfer Summer Conference, HT 2019, collocated with
the ASME 2019 13th International Conference on Energy Sustainability
(October 2020) (2019). https://doi.org/10.1115/HT2019-3591
[20] Zhou, X., Hsieh, S.J., Sun, Y.: Experimental and numerical investigation
of the thermal behaviour of polylactic acid during the fused deposition
process. Virtual and Physical Prototyping 12(3), 221{233 (2017). https:LATEX template
23
//doi.org/10.1080/17452759.2017.1317214
[21] Costa, S.F., Duarte, F.M., Covas, J.A.: Thermal conditions aecting heat
transfer in FDM/FFE: a contribution towards the numerical modelling
of the process. Virtual and Physical Prototyping 10(1), 35{46 (2015).
https://doi.org/10.1080/17452759.2014.984042
[22] Lepoivre, A., Boyard, N., Levy, A., Sobotka, V.: Heat transfer and
adhesion study for the FFF additive manufacturing process. In: Pro-
cedia Manufacturing, vol. 47, pp. 948{955. Elsevier B.V., ??? (2020).
https://doi.org/10.1016/j.promfg.2020.04.291LATEX template
24
Funding
This work was supported by the European Research Council through
the H2020 ERC Consolidator Grant 2019 n. 864482 FDM2. The support of
AMOS under project 3: Risk management and maximized operability of ships
and ocean structures is also gratefully acknowledged.
Conicts of interest
No conicts of interest were reported by the authors during the writing of
this work.
Authors' contributions
Nathalie Ramos : Conceptualization, Methodology, Data acquisition
and validation, Writing and visualization (original draft). Christoph
Mittermeier : Methodology, Writing (review & editing). Josef Kiendl :
Methodology, Writing (review & editing), Supervision.