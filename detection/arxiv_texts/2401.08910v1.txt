Prepared for submission to JCAP
Inferring galaxy cluster masses from
cosmic microwave background
lensing with neural simulation based
inference
Eric J. Baxter,1Shivam Pandey2
1Institute for Astronomy, University of Hawai‘i, 2680 Woodlawn Drive, Honolulu, HI 96822,
USA
2Columbia Astrophysics Laboratory, Columbia University, 550 West 120th Street, New York,
NY 10027, USA
E-mail: ebax@hawaii.edu, sp4204@columbia.edu
Abstract. Gravitational lensing by massive galaxy clusters distorts the observed cosmic
microwave background (CMB) on arcminute scales, and these distortions carry information
aboutclustermasses. StandardapproachestoextractingclustermassconstraintsfromtheCMB
cluster lensing signal are either sub-optimal, ignore important physical or observational effects,
are computationally intractable, or require additional work to turn the lensing measurements
into constraints on cluster masses. We apply simulation based inference (SBI) using neural
likelihood models to the problem. We show that in circumstances where the exact likelihood
can be computed, the SBI constraints on cluster masses are in agreement with the exact
likelihood, demonstrating that the SBI constraints are close to optimal. In scenarios where
the exact likelihood cannot be feasibly computed, SBI still recovers unbiased estimates of
individual cluster masses and combined constraints from multiple clusters. SBI will be a
powerful tool for constraining the masses of galaxy clusters detected by future cosmic surveys.
Code to run the analyses presented here will be made publicly available.
1Corresponding author.arXiv:2401.08910v1  [astro-ph.CO]  17 Jan 2024Contents
1 Introduction 1
2 Methodology 4
2.1 Exact likelihood in an idealized scenario 4
2.2 Modeling the cluster lensing deflection field 5
2.3 Modeling lensing by uncorrelated LSS 6
2.4 Astrophysical contaminants 6
2.5 Simulator 7
2.6 Neural likelihood model 7
2.7 Stacking posteriors 8
3 Results 9
3.1 Comparison to the exact likelihood in idealized scenario 9
3.2 Comparison to exact likelihood in general scenario 10
4 Robustness to variations in SBI methodology 10
5 Discussion 10
1 Introduction
The abundance of galaxy clusters is highly sensitive to cosmological parameters such as σ8
andΩm, as well as to possible departures from general relativity on cosmological scales [ 1].
However, using the abundance of galaxy clusters as a cosmological probe requires accurate
calibration of cluster masses: the cluster abundance falls exponentially with increasing mass,
so small errors in cluster mass measurements can lead to significant biases in the inferred
cosmological parameters. Future cosmic microwave background (CMB) surveys like CMB
Stage 4 (CMB-S4; [ 2]) will detect of order 105clusters at high redshift ( z≳1) via the Sunyaev
Zel’dovich (SZ) effect [ 3], caused by CMB photons inverse Compton scattering with hot gas
inside of clusters [ 4]. Fully harnessing the statistical power of these future cluster samples
— more than an order of magnitude larger than current samples [e.g 5–7] — will necessitate
high-precision constraints on cluster masses over a broad redshift range. Gravitational lensing
provides a powerful way to obtain these constraints because it is sensitive to all mass in the
cluster, and does not rely on assumptions about e.g. the thermal state of gas within the
cluster. Because the signal-to-noise per cluster is typically low for lensing measurements, one
often uses the lensing measurements primarily to calibrate the overall normalization of the
relationship between the cluster mass and some cluster observable which can be measured at
high signal-to-noise, like the cluster SZ or X-ray signal.
However, measuring the lensing signal from the distortions of galaxy shapes is not feasible
for high redshift clusters because of the difficulty of obtaining galaxy shape measurements for
high redshift background galaxies. Moreover, galaxy lensing is subject to a number of difficult
to model sources of systematic uncertainty, including photometric redshift errors, boost factors
and intrinsic alignments [e.g. 8].
– 1 –Another powerful way to calibrate the masses of galaxy clusters at high redshift is to
instead use gravitational lensing of the CMB. Gravitational lensing by galaxy clusters causes
small distortions in the CMB on arcminute scales [ 9]. These distortions can be estimated, and
used to constrain the masses of the lensing clusters. CMB lensing is not impacted by intrinsic
alignments, photometric redshift errors or boost factors, making it a powerful crosscheck of
galaxy lensing measurements. Moreover, because the CMB originates at z∼1100, CMB
cluster lensing can be used to calibrate the masses of clusters at essentially arbitrarily high
redshift.
The standard approach to measuring the CMB lensing signal is to use estimators formed
from quadratic combinations of the Fourier modes of the observed CMB field at different
multipoles. In the absence of lensing, the expectation value of these quadratic terms vanishes;
in the presence of lensing, an appropriately weighted combination of these quadratic terms
will provide an estimate of the lensing deflection field [ 10]. The standard quadratic estimator
is biased in the presence of strong lensing by the cluster, but this bias can be removed with
an acceptable degradation in signal-to-noise by using an appropriate choice of filtering [ 11].
Once the deflection maps (or some related quantity, such as the lensing convergence) have
been estimated with a quadratic estimator, they can be fit with parameterized models for the
cluster mass distribution to obtain constraints on the cluster masses, which are ultimately the
parameters of interest. This approach has been applied in several analyses [e.g. 12–15].
However, atsmallscales, thequadraticestimatorapproachisknowntobesub-optimal[e.g.
16–18] and will lead to unnecessarily weak constraints on the cluster masses by factors of order
two at noise levels comparable to those expected for CMB-S4 [ 16,19]. Additionally, since the
clustermassisultimatelytheparameterofinterest, theintermediatestepofgeneratingalensing
deflection or convergence map is not strictly necessary, and can present additional challenges
in practice. For instance, a standard approach is to compresses the lensing measurements to a
summary such as the convergence profile, and to then fit the profile measurements to a model
which depends on the cluster mass. This process can result in loss of information, and also
requires additional work to estimate the covariance of the convergence profile measurements.1
An alternative to the quadratic estimator approach is to compute the likelihood of the
observed CMB given the known statistics of the unlensed CMB and a model for the cluster
mass distribution. [ 16,20,21]. In principle, if this likelihood could be computed, it would
yield optimal constraints on the parameters of the cluster mass distribution without the need
to construct the deflection field map and perform additional fitting to the cluster profile, as is
done in quadratic estimator-based analyses. However, outside of highly idealized scenarios,
computing the exact likelihood for the lensed CMB becomes difficult. For example, the
telescope beam and anisotropic filtering of the observed CMB necessitate many calculations of
high-dimensional integrals over the latent space of the possible unlensed and un-beamed CMB
realizations [21].
Further complicating the likelihood calculation is the fact that the CMB is also lensed
by other large scale structure (LSS) along the line of sight in addition to the galaxy cluster.
Some of this structure will be in front of the cluster (i.e. at lower redshift), while some will be
behind (i.e. at higher redshift), leading to complex changes to the observed CMB that are
difficult to include exactly in a likelihood approach.
A number of other methods beyond quadratic estimators and the exact likelihood have
been considered for extracting the CMB cluster lensing signal. [ 19] use the techniques of
1Of course, there are also advantages to estimating a lensing convergence map. For instance, such maps
provide an easy to interpret summary of the lensing information.
– 2 –maximum a posteriori (MAP) lensing reconstruction to constrain the lensing profiles of galaxy
clusters, taking into account lensing by LSS. These profiles can then be fit to extract cluster
mass constraints. These constraints, like those of the exact likelihood approach, should be
optimal. [ 22] demonstrated that a two-stage neural network based on ResUNet [23] could be
trained to predict the masses of galaxy clusters from observations of the lensed CMB. [ 24]
stack maps of CMB temperature or polarization along directions of the locally measured CMB
gradient, and fit the resultant lensing-induced dipole to constrain the cluster masses.
Here, we present a new method for inferring the masses of galaxy clusters from CMB
lensing that relies on simulation based inference (SBI). While analytically computing the exact
likelihood becomes complicated outside of highly idealized scenarios, simulating realizations of
the cluster-lensed CMB in full complexity is straightforward and fast. One simply generates
a Gaussian realization of the unlensed CMB, remaps this field using a simulated lensing
deflection map for the cluster and for additional line-of-sight structures, and then adds
whatever observational effects (e.g. beam and filtering) are appropriate. The key point is
that simulation requires only drawing from the high-dimensional distributions of primordial
CMB, LSS, and noise realizations, while computing the likelihood requires integrating over
these distributions. The intractability of the likelihood and the ease of simulation make the
problem especially well suited to the techniques of simulation based inference (SBI). In SBI,
one uses simulations to obtain a sufficiently accurate approximation to the posterior, rather
than computing it exactly.
WeapplyseveralrelatedSBImethodstotheproblem, focusingonNeuralRatioEstimation
(NRE) [25]. NRE, and the other methods we consider, use a neural network to approximate
functions of the likelihood and/or posterior. With the right choice of loss function, the neural
network approximations will converge to the exact function being approximated during training
on many simulated realizations of the data. The resultant posterior estimates are sufficiently
accurate for most purposes.
There are several advantages to our proposed SBI approach to CMB cluster lensing.
First, unlike the quadratic estimator approach, our SBI approach should naturally and close-
to-optimally use all information in the data. Indeed, we will show that our SBI method
yields cluster mass constraints that are in agreement with the exact (and optimal) likelihood
calculation in scenarios where the likelihood can be easily computed. This presents a significant
advantage over quadratic estimator approaches. Second, SBI allows for the handling of non-
idealities in the data (e.g. lensing from multiple structures, telescope beam and filtering)
that cannot be easily incorporated into the exact likelihood. Third, our SBI analysis directly
produces constraints on cluster masses, without requiring intermediate steps like estimating
the lensing convergence or measuring a lensing profile and estimating its covariance. An
additional advantage of the SBI approach introduced here is its simplicity: once the simulator
has been created, training the neural likelihood/posterior models is easy, fast and robust to
details of implementation (as we demonstrate below). Once the posterior model is trained,
it is very fast (essentially instantaneous) to compute constraints on cluster masses from new
data realizations. This last property may become relevant for future large samples of clusters.
We also note that while the exact likelihood, MAP, and quadratic estimator approaches
may be appealing because of their analytical nature, these methods often rely implicitly
on simulations. For instance, [ 21] and [16] used a hybrid simulation and exact likelihood
approach, wheresimulationswereusedtoincorporatetheimpactofthebeamintothelikelihood
calculation, the MAP method of [ 19] uses simulations for calculation of the normalization,
and the method of [ 24] relies on simulations for calibration of the model for the lensing dipole.
– 3 –The outline of the paper is as follows. In §2 we describe our methodology, including the
calculation of the exact likelihood in an idealized scenario, and the SBI method. In §3 we
present our main results, including demonstrating that the SBI method recovers the exact
likelihood in the limit that the likelihood can be easily computed, and that it continues to
perform well outside of this limit. In §4 we test the robustness of our results to variation in
our SBI method. We conclude in §5.
Throughout, we assume a flat ΛCDM cosmological model with parameters consistent
with the results of the Planck2018 analysis [26]
2 Methodology
2.1 Exact likelihood in an idealized scenario
If we consider CMB cluster lensing to be a single, parameterizable remapping of a Gaussian
random field and we ignore the impact of the telescope beam and filtering, then the exact
likelihood for the CMB observations can be easily computed, as we now describe. For a
Gaussian random field with power spectrum Cℓ, the pixel-pixel covariance matrix is
Cij=g(|⃗θij|)≡X
lCℓ2l+ 1
4πJ0(l|⃗θij|), (2.1)
where J0is the zeroth order Bessel function of the first kind and |⃗θij|is the magnitude of
the angular separation between pixels iandj, and vectors are in the image plane. We have
assumed small angles, as appropriate for the cluster lensing context. Below, we will assume
square pixel grids of dimension Npix×Npix, where each pixel is θpix= 0.5′on a side and we
will explore different choices of Npix. In the idealized scenario considered in this subsection,
we will assume that all large scale structure (LSS) along the line of sight to the cluster is
behind (i.e. at higher redshift than) the cluster. In practice, this is not a bad assumption
since CMB lensing is most sensitive to structure at z∼2, and the clusters of interest are
typically at zc<2, so most lensing by LSS does occur at higher redshift than the cluster. We
will also assume in this idealized scenario that even after lensing by LSS, the CMB remains
Gaussian, which is not exactly correct. We compute the LSS-lensed CMB power spectrum
using CAMB2[27, 28].
We write the angular deflection field caused by cluster lensing as ⃗ αi(M), where iindexes
the pixel and we use Mto generically represent some parameter(s) describing the mass
distribution of the cluster. For instance, this could be the total mass of the cluster or a
parameter describing the shape of the mass profile. The deflection field is a continuous vector
field, but assuming the pixel size is sufficiently small compared to fluctuations in the map,
little information will be lost by pixelizing.
Since the covariance of two pixels in the unlensed CMB depends only on the magnitude
of the angular separation between the pixels, the crucial quantity for describing the lensed
CMB is the difference in deflection angles for the two pixels: if two pixels are deflected by the
same amount, then their angular separation would remain unchanged, and their covariance
before and after lensing would be the same. We write the difference in deflection angles for
two pixels as
⃗δij(M) =⃗ αi(M)−⃗ αj(M). (2.2)
2camb.info
– 4 –Given a mass model for the cluster, ⃗ αi(M)and thus ⃗δij(M)can be computed, as we discuss
in §2.2.
The likelihood for the observed CMB in the simplified scenario considered in this section
is then
P(⃗dobs|M) =N(⃗dobs;⃗ µ= 0,C=C′(M) +N), (2.3)
whereC′(M)is the covariance of the lensed CMB field, given by
C′
ij(M) =g(|⃗θij+⃗δij(M)|), (2.4)
where g(θ)is given by Eq. 2.1 with Clset equal to the LSS-lensed CMB power spectrum, and
whereNis the noise covariance matrix of the observations. For many CMB observations, it is
reasonable to assume that the noise covariance matrix is proportional to the identity matrix:
N=σ2
NINpix, (2.5)
where σ2
Nis set by the sensitivity of the observations. We will set σ2
N= (1µK arcmin )2/θ2
pix.
This is roughly the expected noise level for CMB-S4 [ 2], and comparable to the noise levels
of existing deep-field observations from SPT-3G [ 29], and planned observations from the
upcoming Simons Observatory [ 30]. A non-white noise spectrum could be easily incorporated
with appropriate modification to the noise covariance.
2.2 Modeling the cluster lensing deflection field
In order to model ⃗ α(M), we begin by modeling the cluster mass distribution. On average, the
density profiles of clusters, ρ(r), are well-described by spherically symmetric Navarro-Frenk-
White (NFW) profiles [31], given by
ρ(r) =ρ0
(r/rs)(1 + r/rs)2, (2.6)
where ρ0andrsare parameters of the model. We adopt the spherical overdensity mass
convention, such that the cluster mass is
M∆c= ∆(4 π/3)R3
∆cρcrit(zc), (2.7)
where ρcrit(zc)is the critical density of the Universe at the redshift of the cluster, zcandR∆is
the cluster-centric radius at which the mean enclosed density is ∆ρcrit(zc). The concentration
parameter is defined by
c∆c=R∆c/rs. (2.8)
Our convention will be to take ∆ = 200. The main mass parameter of our analysis is then
M200c, while c200cimpacts the shape of the profile. We fix c200cusing the mass-concentration
relation from [ 32]. At around R200c, the density profile will begin to depart from the NFW
form owing to the presence of correlated LSS, i.e. the two-halo term [ 33]. For simplicity, we
ignore this contribution here, since most of the information about the cluster mass comes from
near the cluster center. We postpone a full treatment of the two-halo term to future work.
The lensing convergence, κ, is related to the line of sight integral of the cluster mass
distribution:
κ(⃗θ) =1
ΣcritZ
dl ρ(r(⃗θ, l)), (2.9)
– 5 –where lis the line of sight distance, ⃗θis a vector in the image plane, and r(l,⃗θ)is the
cluster-centric distance corresponding to a point at land⃗θ. The critical surface density, Σcrit,
is given by
Σcrit=c2ds
4πGd ldls, (2.10)
where dlanddsare the angular diameter distances to the lens (cluster) and source (CMB),
respectively, and dlsis angular diameter distance between these redshifts. In practice, we use
Colossus [34] to compute the lensing convergence profiles of the clusters.
The lensing deflection field, ⃗ α, is related to the convergence field via
κ=1
2∇ ·⃗ α. (2.11)
We convert between deflections and the lensing convergence in Fourier space through the use
of FFTs. We now have all of the ingredients needed to compute the likelihood from Eq. 2.3.
2.3 Modeling lensing by uncorrelated LSS
We now move beyond the simple treatment of §2.1, where all lensing by LSS was treated as
occuring at redshifts greater than that of the cluster. Far away from the cluster, the LSS can
be treated as effectively uncorrelated with the cluster (as noted previously, we ignore nearby
correlated structure). We separate these uncorrelated contributions to the total LSS lensing
signal into two parts, one from z > z cand one from z < z c. We compute the power spectra of
these two contributions using the Limber approximation [35, 36]:
Cκκ
l(zmin, zmax) =Zχ(zmax)
χ(zmin)dχW2(χ)
χ2PNLl+ 1/2
χ, z(χ)
, (2.12)
where χ(z)andz(χ)are the comoving distance and redshift to redshift zand comoving
distance χ, respectively, PNL(k, z)is the nonlinear matter power spectrum at wavenumber k
and redshift z, which we compute using CAMBwith the halofit [37] prescription for nonlinear
evolution, and
W(χ) =3ΩmH2
0χ
2c2a(χ)χ∗−χ
χ∗, (2.13)
is the lensing weight function, where a(χ)is the scale factor corresponding to comoving
distance χ, and χ∗is the comoving distance to the last scattering surface. If we consider
structure at redshifts below that of the cluster, then (zmin, zmax) = (0 , zc), while if we consider
structure at redshifts above the cluster, then (zmin, zmax) = (zc, z(χ∗)).
2.4 Astrophysical contaminants
A number of additional sources can contribute to CMB observations near galaxy clusters
besides the lensed CMB and noise. These include, for example, the thermal (tSZ) and
kinematic (kSZ) SZ effects, dusty galaxies and radio galaxies. Perhaps the most significant of
these is the thermal SZ signal, which can significantly bias the inference of CMB cluster lensing
[e.g.14,21]. In principle, there are several techniques one could use to mitigate the impact of
these sources. To remove the tSZ one could combine CMB maps at multiple frequencies to
null the frequency-dependent tSZ signal, although this will come at the cost of an increase
– 6 –in noise levels. Alternatively, one could use polarization data instead of temperature data
to extract the CMB cluster lensing signal. Astrophysical sources typically produce much
smaller biases to lensing estimation from CMB polarization than from CMB temperature.
However, using CMB polarization instead of temperature will also lead to some reduction in
signal-to-noise. Here, for simplicity, we ignore the presence of the additional astrophysical
sources. In principle, using tSZ-cleaned maps or polarization data instead of temperature data
would not significantly change the SBI methodology that we introduce. We postpone a more
detailed treatment of astrophysical foregrounds to future work.
2.5 Simulator
Our SBI analysis relies on having the ability to generate mock realizations of the cluster-lensed
CMB given a choice of parameters for the cluster mass distribution. We generate simulated
cluster-lensed CMB maps with the following steps:
1.Draw an unlensed CMB realization :⃗dunl∼ N(⃗ µ= 0,C), where Cis given by
Eq. 2.1.
2.Compute the convergence field due to the cluster at parameter values Mfollowing
the steps in §2.2
3.Generate Gaussian random convergence fields from LSS atz > z candz < z c
using the power spectra described in §2.3.
4.Apply the successive lensing operations to the unlensed CMB realization .
Convert the three convergence fields into deflection fields using Eq. 2.11, and apply the
deflections in succession to the unlensed CMB realization from (1). That is, first lens
by the LSS at redshifts above the cluster, then lens the resultant map by the cluster,
then lens the result by LSS at redshifts below the cluster. For each lensing operation,
we use fifth order spline interpolation to interpolate the unlensed map at the positions
corresponding to the deflected pixels.
5.Apply beam . We apply a Gaussian beam with σ= 1′to the lensed CMB maps. This
beam size is comparable to that of SPT and CMB-S4.
6.Add instrumental noise . Draw a Gaussian realization from the noise covariance
matrix Nand add it to the map.
We use pixels of size 0.5′throughout. The convergence maps are computed using
Npix= 32, the unlensed CMB maps are computed using Npix= 16, and the final SBI analysis
is restricted to a region with Npix= 8centered on the cluster.
2.6 Neural likelihood model
We now describe the SBI methodology that we apply to estimate cluster masses from the
CMB lensing signal. As noted above, the use of SBI is motivated by the intractability of the
exact likelihood in the general problem, while simulating samples from the forward model is
easy.
Our baseline analysis uses the neural likelihood ratio estimator (NRE) method of [ 25].
This method trains a neural classifier to learn the likelihood ratio between different points in
parameter space, given the data. The estimator is amortized in the sense that it is trained
– 7 –to work for different possible realizations of the data, not just the actual observed data.
Briefly, given a set of observations xand parameters θ, the NRE method trains a classifier
to distinguish between samples (x, θ)obtained from two different probability distributions.
First is the joint parameter distribution, p(x, θ)and second is the product of the marginal
distributions p(x)p(θ). We use the lensed CMB maps as our observations xand the mass
of the cluster as the parameter θ. We use a residual network to extract the features from
the data and train the neural network as a classifier to learn the optimal decision function
distinguishing samples obtained from p(x, θ)versus from p(x)p(θ)which is given by:
s(x, θ) =p(x, θ)
p(x, θ) +p(x)p(θ). (2.14)
Thedecisionfunction s(x, θ)isdirectlyrelatedtothelikelihoodratio r=p(x, θ)/(p(x)p(θ))
through r=s/(1−s). Finally, once the likelihood ratio estimator is trained, standard MCMC
can be used to generate samples from the posterior. We use the default NRE architecture as
implemented in the sbipackage [ 38]. We use 90000 simulations for the training set and 10000
simulations as validation set.
Note that there exist other neural network-based SBI approaches to estimate posteriors
such as neural posterior estimate (NPE; [ 39]) and neural likelihood estimate (NLE; [ 40]). The
NPE and NLE estimator aims to learn the posterior, p(θ|x), or the likelihood, p(x|θ), by
modeling this conditioned probability distributions using stacks of normalizing flows. NLE is
generally followed by a MCMC step to obtain the posterior from the learned likelihood. In
this study we use the stacks of masked autoregressive flows in both NLE and NPE methods,
again following the default architecture of the sbipackage [38].
We perform a study of robustness of our results to these different approaches in §4.
2.7 Stacking posteriors
The constraints on Mfrom a single cluster can be very weak, even when the instrumental
noise is very low. This is because variance in the unlensed CMB contributes significantly
to variance in the signal. Without a significant gradient in the unlensed CMB behind the
cluster, there will be no cluster lensing signal [ 9]. Because the constraints from individual
clusters can be weak, it is standard practice to enhance the signal-to-noise of the CMB cluster
lensing measurements by combining mass constraints across multiple clusters (i.e. stacking).
In the quadratic estimator approach to CMB cluster lensing, stacking is often done at the
level of the convergence maps. Stacking the convergence maps with equal weighting (as is
often done) can be suboptimal, since the signal-to-noise for each cluster varies widely due to
the different background CMB realizations. Here, we instead “stack” the likelihoods (or the
SBI approximation to the likelihoods), by taking the product across the individual cluster
likelihoods. Each cluster can be assumed to be independent, since they are likely to be well
separated on the sky. Given our assumptions, stacking the likelihoods will yield optimal
constraints on the average cluster mass of the stacked clusters. This is essentially the quantity
of interest for cosmological analyses since it sets the normalization of the mass-observable
relation. We note that the NFW model for the cluster mass distribution may not describe
individual clusters very well. For instance, individual clusters may be triaxial [ 41]. By
computing the likelihood for individual clusters and then stacking the resultant likelihoods,
we may incur some bias from departures from the NFW form. In principle, this bias could
be ameliorated with a more flexible mass model. We postpone a detailed investigation into
departures from our assumed NFW model to future work.
– 8 –1.6 1.8 2.0 2.2 2.4
M200c[M⊙]×10150.00.20.40.60.81.0L(M200c)SBI−NRE
Exact Likelihood
True mass
0.0 0.5 1.0 1.5 2.0
TrueM200c[M⊙]×10150.00.51.01.52.0RecoveredM200c[M⊙]×1015
SBI−NLE
SBI−NRE
SBI−NPE
Exact LikelihoodFigure 1 . Comparison of the stacked exact likelihood and the SBI results for the idealized case where
the exact likelihood can be computed. Top: the blue (SBI) and red (exact likelihood) curves represent
combined constraints from 20 clusters, where the true mass is indicated by the vertical dotted line. The
SBI estimate of the stacked likelihood is close to that from the exact calculation. Bottom: We show
the recovered mean and standard deviation of the exact likelihood (red) and SBI (blue) constraints on
the cluster mass as a function of the true cluster mass. Each point represents a stack over 20 clusters
with the same mass. We see that the SBI constraints are consistent with those of the exact likelihood
over a range of cluster masses.
3 Results
3.1 Comparison to the exact likelihood in idealized scenario
We first apply our SBI analysis in the simplified case where the exact likelihood can be quickly
computed (i.e. no instrumental beam, and treating lensing as a single remapping of a Gaussian
random field, as described in §2.1). We generate a set of 20 mock lensed CMB observations
– 9 –using this model. The cluster mass and redshift for this set of simulations is the same for each
cluster: M200c= 3×1015M⊙andzc= 0.5. Fig. 1 shows the resultant stacked likelihoods from
these 20 clusters (top panel) as a function of M200c. The input cluster mass is indicated with
the vertical dotted line. As expected the exact likelihood peaks near to the input cluster mass.
The SBI analysis recovers a posterior consistent with the exact likelihood. In the bottom panel,
we repeat this test across a range of cluster masses. We find that the posteriors from SBI
agree very well with those of the exact likelihood across the range of cluster masses considered.
These results suggest that the SBI method is close-to-optimally extracting the information in
the data about the cluster mass.
3.2 Comparison to exact likelihood in general scenario
We next consider the case where the data come from the more general model that includes
the instrumental beam and the more correct lensing implementation, with high- zand low z
structure are treated separately. We train the SBI model on data of this type, but preserve
the same simple likelihood calculation for comparison.
The results of this test are shown in Fig. 2. As expected, SBI continues to recover
reasonable estimates of the true cluster masses. The constraints on the cluster masses are
unbiased and have comparable uncertainty to the case where the beam and other effects
are not included. We would expect the presence of the beam to slightly degrade the cluster
mass constraints since a 1 arcmin beam is comparable to the scale of the lensing defelections.
Indeed, the SBI constraints become somewhat weaker in the presence of the beam. The results
of the likelihood calculation that ignores the instrumental beam and the different impact of
high and low- zlensing are shown with the red errorbars. We see that the beam and LSS
lensing significantly bias the simple likelihood calculation. Essentially all of the bias comes
from ignoring the beam, while the treatment of LSS has little impact on the constraints.
Apparently, the likelihood calculation is very sensitive to modeling the beam correctly. It is
not too surprising that the treatment of LSS has a small impact on the results, since effectively
all that matters for the cluster lensing signal is the local gradient of the unlensed CMB, and
the typical size of this gradient will not be significantly changed by LSS lensing, which mostly
modifies the small-scale CMB power spectrum.
4 Robustness to variations in SBI methodology
We now explore the sensitivity of our results to different network architectures and SBI
methods by obtaining posteriors with NLE, NRE and NPE. We unify the training and test
datasets used in all three methodologies. The results are shown with the different solid curves
in Fig. 2. We see that all three SBI methods give consistent posteriors, suggesting that the
SBI analysis is highly robust to neural network implementation.
5 Discussion
We have presented the first application of SBI to the problem of estimating cluster masses
from gravitational lensing of the CMB, and to our knowledge, the first application of NRE
to CMB lensing. The CMB cluster lensing problem is well-suited to SBI since it is relatively
easy to simulate cluster-lensed CMB maps, but dificult to compute their likelihood in full
generality. We find that in idealized cases where the exact likelihood can be computed, our SBI
method recovers the exact likelihood well, indicating that this method is close-to-optimally
– 10 –0.0 0.5 1.0 1.5 2.0
TrueM200c[M⊙]×10150.00.51.01.52.0RecoveredM200c[M⊙]×1015
SBI−NLE
SBI−NRE
SBI−NPE
Exact LikelihoodFigure 2 . Same as bottom panel of Fig. 1, except now the data are generated using the full lensing
model and include an instrumental beam. In this case, the SBI analysis continues to recover good
estimates of the cluster mass. The simple likelihood calculation (green dashed), on the other hand,
is significantly biased. The solid curves indicate the results when we vary the details of the SBI
methodology.
exracting the cluster mass information from the data. In the general problem for which the
likelihood cannot be easily computed, SBI recovers unbiased estimates of the cluster mass.
These constraints are quite robust to the details of the SBI implementation. SBI with neural
posterior/likelihood models therefore present a powerful set of tools for extracting cluster
mass estimates from current and future observations of the lensed CMB.
We plan to make the code used for this analysis publicly available at https://github.
com/ebaxter/CMBClusterLens upon acceptance of the paper by a journal.
Acknowledgments
We thank Peter Sadowski for useful discussions related to this work, and Srinivasan Raghu-
nathan for detailed comments. SP is supported by the Simons Collaboration on Learning the
Universe. EB is partially supported by NSF Grant AST-2306165.
References
[1] Andreas Albrecht, Gary Bernstein, Robert Cahn, Wendy L. Freedman, Jacqueline Hewitt,
Wayne Hu, John Huth, Marc Kamionkowski, Edward W. Kolb, Lloyd Knox, John C. Mather,
Suzanne Staggs, and Nicholas B. Suntzeff. Report of the Dark Energy Task Force. arXiv
e-prints, pages astro–ph/0609591, September 2006.
[2]Kevork N. Abazajian, Peter Adshead, Zeeshan Ahmed, Steven W. Allen, David Alonso, Kam S.
Arnold, Carlo Baccigalupi, James G. Bartlett, Nicholas Battaglia, Bradford A. Benson, Colin A.
Bischoff, Julian Borrill, Victor Buza, Erminia Calabrese, Robert Caldwell, John E. Carlstrom,
Clarence L. Chang, Thomas M. Crawford, Francis-Yan Cyr-Racine, Francesco De Bernardis,
Tijmen de Haan, Sperello di Serego Alighieri, Joanna Dunkley, Cora Dvorkin, Josquin Errard,
– 11 –Giulio Fabbian, Stephen Feeney, Simone Ferraro, Jeffrey P. Filippini, Raphael Flauger,
George M. Fuller, Vera Gluscevic, Daniel Green, Daniel Grin, Evan Grohs, Jason W. Henning,
J. Colin Hill, Renee Hlozek, Gilbert Holder, William Holzapfel, Wayne Hu, Kevin M.
Huffenberger, Reijo Keskitalo, Lloyd Knox, Arthur Kosowsky, John Kovac, Ely D. Kovetz,
Chao-Lin Kuo, Akito Kusaka, Maude Le Jeune, Adrian T. Lee, Marc Lilley, Marilena Loverde,
Mathew S. Madhavacheril, Adam Mantz, David J. E. Marsh, Jeffrey McMahon, Pieter Daniel
Meerburg, Joel Meyers, Amber D. Miller, Julian B. Munoz, Ho Nam Nguyen, Michael D.
Niemack, Marco Peloso, Julien Peloton, Levon Pogosian, Clement Pryke, Marco Raveri,
Christian L. Reichardt, Graca Rocha, Aditya Rotti, Emmanuel Schaan, Marcel M. Schmittfull,
Douglas Scott, Neelima Sehgal, Sarah Shandera, Blake D. Sherwin, Tristan L. Smith, Lorenzo
Sorbo, Glenn D. Starkman, Kyle T. Story, Alexander van Engelen, Joaquin D. Vieira, Scott
Watson, Nathan Whitehorn, and W. L. Kimmy Wu. CMB-S4 Science Book, First Edition. arXiv
e-prints, page arXiv:1610.02743, October 2016.
[3]Srinivasan Raghunathan, Nathan Whitehorn, Marcelo A. Alvarez, Han Aung, Nicholas Battaglia,
Gilbert P. Holder, Daisuke Nagai, Elena Pierpaoli, Christian L. Reichardt, and Joaquin D. Vieira.
Constraining Cluster Virialization Mechanism and Cosmology Using Thermal-SZ-selected
Clusters from Future CMB Surveys. ApJ, 926(2):172, February 2022.
[4] R. A. Sunyaev and Ya. B. Zeldovich. Small-Scale Fluctuations of Relic Radiation. Ap&SS,
7(1):3–19, April 1970.
[5]L. E. Bleem, B. Stalder, T. de Haan, K. A. Aird, S. W. Allen, D. E. Applegate, M. L. N. Ashby,
M. Bautz, M. Bayliss, B. A. Benson, S. Bocquet, M. Brodwin, J. E. Carlstrom, C. L. Chang,
I. Chiu, H. M. Cho, A. Clocchiatti, T. M. Crawford, A. T. Crites, S. Desai, J. P. Dietrich, M. A.
Dobbs, R. J. Foley, W. R. Forman, E. M. George, M. D. Gladders, A. H. Gonzalez, N. W.
Halverson, C. Hennig, H. Hoekstra, G. P. Holder, W. L. Holzapfel, J. D. Hrubes, C. Jones,
R. Keisler, L. Knox, A. T. Lee, E. M. Leitch, J. Liu, M. Lueker, D. Luong-Van, A. Mantz, D. P.
Marrone, M. McDonald, J. J. McMahon, S. S. Meyer, L. Mocanu, J. J. Mohr, S. S. Murray,
S. Padin, C. Pryke, C. L. Reichardt, A. Rest, J. Ruel, J. E. Ruhl, B. R. Saliwanchik, A. Saro,
J. T. Sayre, K. K. Schaffer, T. Schrabback, E. Shirokoff, J. Song, H. G. Spieler, S. A. Stanford,
Z. Staniszewski, A. A. Stark, K. T. Story, C. W. Stubbs, K. Vanderlinde, J. D. Vieira,
A. Vikhlinin, R. Williamson, O. Zahn, and A. Zenteno. Galaxy Clusters Discovered via the
Sunyaev-Zel’dovich Effect in the 2500-Square-Degree SPT-SZ Survey. ApJS, 216(2):27, February
2015.
[6]L. E. Bleem, S. Bocquet, B. Stalder, M. D. Gladders, P. A. R. Ade, S. W. Allen, A. J. Anderson,
J. Annis, M. L. N. Ashby, J. E. Austermann, S. Avila, J. S. Avva, M. Bayliss, J. A. Beall,
K. Bechtol, A. N. Bender, B. A. Benson, E. Bertin, F. Bianchini, C. Blake, M. Brodwin,
D. Brooks, E. Buckley-Geer, D. L. Burke, J. E. Carlstrom, A. Carnero Rosell, M. Carrasco Kind,
J. Carretero, C. L. Chang, H. C. Chiang, R. Citron, C. Corbett Moran, M. Costanzi, T. M.
Crawford, A. T. Crites, L. N. da Costa, T. de Haan, J. De Vicente, S. Desai, H. T. Diehl, J. P.
Dietrich, M. A. Dobbs, T. F. Eifler, W. Everett, B. Flaugher, B. Floyd, J. Frieman, J. Gallicchio,
J. García-Bellido, E. M. George, D. W. Gerdes, A. Gilbert, D. Gruen, R. A. Gruendl,
J. Gschwend, N. Gupta, G. Gutierrez, N. W. Halverson, N. Harrington, J. W. Henning,
C. Heymans, G. P. Holder, D. L. Hollowood, W. L. Holzapfel, K. Honscheid, J. D. Hrubes,
N. Huang, J. Hubmayr, K. D. Irwin, D. J. James, T. Jeltema, S. Joudaki, G. Khullar, M. Klein,
L. Knox, N. Kuropatkin, A. T. Lee, D. Li, C. Lidman, A. Lowitz, N. MacCrann, G. Mahler,
M. A. G. Maia, J. L. Marshall, M. McDonald, J. J. McMahon, P. Melchior, F. Menanteau, S. S.
Meyer, R. Miquel, L. M. Mocanu, J. J. Mohr, J. Montgomery, A. Nadolski, T. Natoli, J. P.
Nibarger, G. Noble, V. Novosad, S. Padin, A. Palmese, D. Parkinson, S. Patil, F. Paz-Chinchón,
A. A. Plazas, C. Pryke, N. S. Ramachandra, C. L. Reichardt, J. D. Remolina González, A. K.
Romer, A. Roodman, J. E. Ruhl, E. S. Rykoff, B. R. Saliwanchik, E. Sanchez, A. Saro, J. T.
Sayre, K. K. Schaffer, T. Schrabback, S. Serrano, K. Sharon, C. Sievers, G. Smecher, M. Smith,
M. Soares-Santos, A. A. Stark, K. T. Story, E. Suchyta, G. Tarle, C. Tucker, K. Vanderlinde,
– 12 –T. Veach, J. D. Vieira, G. Wang, J. Weller, N. Whitehorn, W. L. K. Wu, V. Yefremenko, and
Y. Zhang. The SPTpol Extended Cluster Survey. ApJS, 247(1):25, March 2020.
[7]M. Hilton, C. Sifón, S. Naess, M. Madhavacheril, M. Oguri, E. Rozo, E. Rykoff, T. M. C. Abbott,
S. Adhikari, M. Aguena, S. Aiola, S. Allam, S. Amodeo, A. Amon, J. Annis, B. Ansarinejad,
C. Aros-Bunster, J. E. Austermann, S. Avila, D. Bacon, N. Battaglia, J. A. Beall, D. T. Becker,
G. M. Bernstein, E. Bertin, T. Bhandarkar, S. Bhargava, J. R. Bond, D. Brooks, D. L. Burke,
E. Calabrese, M. Carrasco Kind, J. Carretero, S. K. Choi, A. Choi, C. Conselice, L. N. da Costa,
M. Costanzi, D. Crichton, K. T. Crowley, R. Dünner, E. V. Denison, M. J. Devlin, S. R. Dicker,
H. T. Diehl, J. P. Dietrich, P. Doel, S. M. Duff, A. J. Duivenvoorden, J. Dunkley, S. Everett,
S. Ferraro, I. Ferrero, A. Ferté, B. Flaugher, J. Frieman, P. A. Gallardo, J. García-Bellido,
E. Gaztanaga, D. W. Gerdes, P. Giles, J. E. Golec, M. B. Gralla, S. Grandis, D. Gruen, R. A.
Gruendl, J. Gschwend, G. Gutierrez, D. Han, W. G. Hartley, M. Hasselfield, J. C. Hill, G. C.
Hilton, A. D. Hincks, S. R. Hinton, S. P. P. Ho, K. Honscheid, B. Hoyle, J. Hubmayr, K. M.
Huffenberger, J. P. Hughes, A. T. Jaelani, B. Jain, D. J. James, T. Jeltema, S. Kent, K. Knowles,
B. J. Koopman, K. Kuehn, O. Lahav, M. Lima, Y. T. Lin, M. Lokken, S. I. Loubser,
N. MacCrann, M. A. G. Maia, T. A. Marriage, J. Martin, J. McMahon, P. Melchior,
F. Menanteau, R. Miquel, H. Miyatake, K. Moodley, R. Morgan, T. Mroczkowski, F. Nati, L. B.
Newburgh, M. D. Niemack, A. J. Nishizawa, R. L. C. Ogando, J. Orlowski-Scherer, L. A. Page,
A. Palmese, B. Partridge, F. Paz-Chinchón, P. Phakathi, A. A. Plazas, N. C. Robertson, A. K.
Romer, A. Carnero Rosell, M. Salatino, E. Sanchez, E. Schaan, A. Schillaci, N. Sehgal,
S. Serrano, T. Shin, S. M. Simon, M. Smith, M. Soares-Santos, D. N. Spergel, S. T. Staggs, E. R.
Storer, E. Suchyta, M. E. C. Swanson, G. Tarle, D. Thomas, C. To, H. Trac, J. N. Ullom, L. R.
Vale, J. Van Lanen, E. M. Vavagiakis, J. De Vicente, R. D. Wilkinson, E. J. Wollack, Z. Xu, and
Y. Zhang. The Atacama Cosmology Telescope: A Catalog of >4000 Sunyaev-Zel’dovich Galaxy
Clusters. ApJS, 253(1):3, March 2021.
[8] T. McClintock, T. N. Varga, D. Gruen, E. Rozo, E. S. Rykoff, T. Shin, P. Melchior, J. DeRose,
S. Seitz, J. P. Dietrich, E. Sheldon, Y. Zhang, A. von der Linden, T. Jeltema, A. B. Mantz, A. K.
Romer, S. Allen, M. R. Becker, A. Bermeo, S. Bhargava, M. Costanzi, S. Everett, A. Farahi,
N. Hamaus, W. G. Hartley, D. L. Hollowood, B. Hoyle, H. Israel, P. Li, N. MacCrann, G. Morris,
A. Palmese, A. A. Plazas, G. Pollina, M. M. Rau, M. Simet, M. Soares-Santos, M. A. Troxel,
C. Vergara Cervantes, R. H. Wechsler, J. Zuntz, T. M. C. Abbott, F. B. Abdalla, S. Allam,
J. Annis, S. Avila, S. L. Bridle, D. Brooks, D. L. Burke, A. Carnero Rosell, M. Carrasco Kind,
J. Carretero, F. J. Castander, M. Crocce, C. E. Cunha, C. B. D’Andrea, L. N. da Costa, C. Davis,
J. De Vicente, H. T. Diehl, P. Doel, A. Drlica-Wagner, A. E. Evrard, B. Flaugher, P. Fosalba,
J. Frieman, J. García-Bellido, E. Gaztanaga, D. W. Gerdes, T. Giannantonio, R. A. Gruendl,
G. Gutierrez, K. Honscheid, D. J. James, D. Kirk, E. Krause, K. Kuehn, O. Lahav, T. S. Li,
M. Lima, M. March, J. L. Marshall, F. Menanteau, R. Miquel, J. J. Mohr, B. Nord, R. L. C.
Ogando, A. Roodman, E. Sanchez, V. Scarpine, R. Schindler, I. Sevilla-Noarbe, M. Smith, R. C.
Smith, F. Sobreira, E. Suchyta, M. E. C. Swanson, G. Tarle, D. L. Tucker, V. Vikram, A. R.
Walker, J. Weller, and DES Collaboration. Dark Energy Survey Year 1 results: weak lensing
mass calibration of redMaPPer galaxy clusters. MNRAS, 482(1):1352–1378, January 2019.
[9] Uroš Seljak and Matias Zaldarriaga. Lensing-induced Cluster Signatures in the Cosmic
Microwave Background. ApJ, 538(1):57–64, July 2000.
[10] Wayne Hu and Takemi Okamoto. Mass Reconstruction with Cosmic Microwave Background
Polarization. ApJ, 574(2):566–574, August 2002.
[11]Wayne Hu, Simon DeDeo, and Chris Vale. Cluster mass estimators from CMB temperature and
polarization lensing. New Journal of Physics , 9(12):441, December 2007.
[12] Mathew Madhavacheril, Neelima Sehgal, Rupert Allison, Nick Battaglia, J. Richard Bond,
Erminia Calabrese, Jerod Caligiuri, Kevin Coughlin, Devin Crichton, Rahul Datta, Mark J.
Devlin, Joanna Dunkley, Rolando Dünner, Kevin Fogarty, Emily Grace, Amir Hajian, Matthew
Hasselfield, J. Colin Hill, Matt Hilton, Adam D. Hincks, Renée Hlozek, John P. Hughes, Arthur
– 13 –Kosowsky, Thibaut Louis, Marius Lungu, Jeff McMahon, Kavilan Moodley, Charles Munson,
Sigurd Naess, Federico Nati, Laura Newburgh, Michael D. Niemack, Lyman A. Page, Bruce
Partridge, Benjamin Schmitt, Blake D. Sherwin, Jon Sievers, David N. Spergel, Suzanne T.
Staggs, Robert Thornton, Alexander Van Engelen, Jonathan T. Ward, Edward J. Wollack, and
Atacama Cosmology Telescope Collaboration. Evidence of Lensing of the Cosmic Microwave
Background by Dark Matter Halos. Phys. Rev. Lett., 114(15):151302, April 2015.
[13] Jean-Baptiste Melin and James G. Bartlett. Measuring cluster masses with CMB lensing: a
statistical approach. A&A, 578:A21, June 2015.
[14] E. J. Baxter, S. Raghunathan, T. M. Crawford, P. Fosalba, Z. Hou, G. P. Holder, Y. Omori,
S. Patil, E. Rozo, T. M. C. Abbott, J. Annis, K. Aylor, A. Benoit-Lévy, B. A. Benson, E. Bertin,
L. Bleem, E. Buckley-Geer, D. L. Burke, J. Carlstrom, A. Carnero Rosell, M. Carrasco Kind,
J. Carretero, C. L. Chang, H. M. Cho, A. T. Crites, M. Crocce, C. E. Cunha, L. N. da Costa,
C. B. D’Andrea, C. Davis, T. de Haan, S. Desai, J. P. Dietrich, M. A. Dobbs, S. Dodelson,
P. Doel, A. Drlica-Wagner, J. Estrada, W. B. Everett, A. Fausti Neto, B. Flaugher, J. Frieman,
J. García-Bellido, E. M. George, E. Gaztanaga, T. Giannantonio, D. Gruen, R. A. Gruendl,
J. Gschwend, G. Gutierrez, N. W. Halverson, N. L. Harrington, W. G. Hartley, W. L. Holzapfel,
K. Honscheid, J. D. Hrubes, B. Jain, D. J. James, M. Jarvis, T. Jeltema, L. Knox, E. Krause,
K. Kuehn, S. Kuhlmann, N. Kuropatkin, O. Lahav, A. T. Lee, E. M. Leitch, T. S. Li, M. Lima,
D. Luong-Van, A. Manzotti, M. March, D. P. Marrone, J. L. Marshall, P. Martini, J. J.
McMahon, P. Melchior, F. Menanteau, S. S. Meyer, C. J. Miller, R. Miquel, L. M. Mocanu, J. J.
Mohr, T. Natoli, B. Nord, R. L. C. Ogando, S. Padin, A. A. Plazas, C. Pryke, D. Rapetti, C. L.
Reichardt, A. K. Romer, A. Roodman, J. E. Ruhl, E. Rykoff, M. Sako, E. Sanchez, J. T. Sayre,
V. Scarpine, K. K. Schaffer, R. Schindler, M. Schubnell, I. Sevilla-Noarbe, E. Shirokoff,
M. Smith, R. C. Smith, M. Soares-Santos, F. Sobreira, Z. Staniszewski, A. Stark, K. Story,
E. Suchyta, G. Tarle, D. Thomas, M. A. Troxel, K. Vanderlinde, J. D. Vieira, A. R. Walker,
R. Williamson, Y. Zhang, and J. Zuntz. A measurement of CMB cluster lensing with SPT and
DES year 1 data. MNRAS, 476(2):2674–2688, May 2018.
[15]Mathew S. Madhavacheril, Cristóbal Sifón, Nicholas Battaglia, Simone Aiola, Stefania Amodeo,
Jason E. Austermann, James A. Beall, Daniel T. Becker, J. Richard Bond, Erminia Calabrese,
Steve K. Choi, Edward V. Denison, Mark J. Devlin, Simon R. Dicker, Shannon M. Duff,
Adriaan J. Duivenvoorden, Jo Dunkley, Rolando Dünner, Simone Ferraro, Patricio A. Gallardo,
Yilun Guan, Dongwon Han, J. Colin Hill, Gene C. Hilton, Matt Hilton, Johannes Hubmayr,
Kevin M. Huffenberger, John P. Hughes, Brian J. Koopman, Arthur Kosowsky, Jeff Van Lanen,
Eunseong Lee, Thibaut Louis, Amanda MacInnis, Jeffrey McMahon, Kavilan Moodley, Sigurd
Naess, Toshiya Namikawa, Federico Nati, Laura Newburgh, Michael D. Niemack, Lyman A.
Page, Bruce Partridge, Frank J. Qu, Naomi C. Robertson, Maria Salatino, Emmanuel Schaan,
Alessandro Schillaci, Benjamin L. Schmitt, Neelima Sehgal, Blake D. Sherwin, Sara M. Simon,
David N. Spergel, Suzanne Staggs, Emilie R. Storer, Joel N. Ullom, Leila R. Vale, Alexander van
Engelen, Eve M. Vavagiakis, Edward J. Wollack, and Zhilei Xu. The Atacama Cosmology
Telescope: Weighing Distant Clusters with the Most Ancient Light. ApJ, 903(1):L13, November
2020.
[16] Srinivasan Raghunathan, Sanjaykumar Patil, Eric J. Baxter, Federico Bianchini, Lindsey E.
Bleem, Thomas M. Crawford, Gilbert P. Holder, Alessandro Manzotti, and Christian L.
Reichardt. Measuring galaxy cluster masses with CMB lensing using a Maximum Likelihood
estimator: statistical and systematic error budgets for future experiments. J. Cosmology
Astropart. Phys., 2017(8):030, August 2017.
[17] Benjamin Horowitz, Simone Ferraro, and Blake D. Sherwin. Reconstructing small-scale lenses
from the cosmic microwave background temperature fluctuations. MNRAS, 485(3):3919–3929,
May 2019.
[18]Boryana Hadzhiyska, Blake D. Sherwin, Mathew Madhavacheril, and Simone Ferraro. Improving
small-scale CMB lensing reconstruction. Phys. Rev. D, 100(2):023547, July 2019.
– 14 –[19] Sayan Saha, Louis Legrand, and Julien Carron. Cluster profiles from beyond-the-QE CMB
lensing mass maps. arXiv e-prints , page arXiv:2307.11711, July 2023.
[20] Scott Dodelson. CMB-cluster lensing. Phys. Rev. D, 70(2):023009, July 2004.
[21] E. J. Baxter, R. Keisler, S. Dodelson, K. A. Aird, S. W. Allen, M. L. N. Ashby, M. Bautz,
M. Bayliss, B. A. Benson, L. E. Bleem, S. Bocquet, M. Brodwin, J. E. Carlstrom, C. L. Chang,
I. Chiu, H. M. Cho, A. Clocchiatti, T. M. Crawford, A. T. Crites, S. Desai, J. P. Dietrich, T. de
Haan, M. A. Dobbs, R. J. Foley, W. R. Forman, E. M. George, M. D. Gladders, A. H. Gonzalez,
N. W. Halverson, N. L. Harrington, C. Hennig, H. Hoekstra, G. P. Holder, W. L. Holzapfel,
Z. Hou, J. D. Hrubes, C. Jones, L. Knox, A. T. Lee, E. M. Leitch, J. Liu, M. Lueker,
D. Luong-Van, A. Mantz, D. P. Marrone, M. McDonald, J. J. McMahon, S. S. Meyer, M. Millea,
L. M. Mocanu, S. S. Murray, S. Padin, C. Pryke, C. L. Reichardt, A. Rest, J. E. Ruhl, B. R.
Saliwanchik, A. Saro, J. T. Sayre, K. K. Schaffer, E. Shirokoff, J. Song, H. G. Spieler, B. Stalder,
S. A. Stanford, Z. Staniszewski, A. A. Stark, K. T. Story, A. van Engelen, K. Vanderlinde, J. D.
Vieira, A. Vikhlinin, R. Williamson, O. Zahn, and A. Zenteno. A Measurement of Gravitational
Lensing of the Cosmic Microwave Background by Galaxy Clusters Using Data from the South
Pole Telescope. ApJ, 806(2):247, June 2015.
[22] N. Gupta and C. L. Reichardt. Mass Estimation of Galaxy Clusters with Deep Learning II.
Cosmic Microwave Background Cluster Lensing. ApJ, 923(1):96, December 2021.
[23] Foivos I. Diakogiannis, François Waldner, Peter Caccetta, and Chen Wu. ResUNet-a: A deep
learning framework for semantic segmentation of remotely sensed data. ISPRS Journal of
Photogrammetry and Remote Sensing , 162:94–114, April 2020.
[24]S. Raghunathan, S. Patil, E. Baxter, B. A. Benson, L. E. Bleem, T. M. Crawford, G. P. Holder,
T. McClintock, C. L. Reichardt, T. N. Varga, N. Whitehorn, P. A. R. Ade, S. Allam, A. J.
Anderson, J. E. Austermann, S. Avila, J. S. Avva, D. Bacon, J. A. Beall, A. N. Bender,
F. Bianchini, S. Bocquet, D. Brooks, D. L. Burke, J. E. Carlstrom, J. Carretero, F. J. Castander,
C. L. Chang, H. C. Chiang, R. Citron, M. Costanzi, A. T. Crites, L. N. da Costa, S. Desai, H. T.
Diehl, J. P. Dietrich, M. A. Dobbs, P. Doel, S. Everett, A. E. Evrard, C. Feng, B. Flaugher,
P. Fosalba, J. Frieman, J. Gallicchio, J. García-Bellido, E. Gaztanaga, E. M. George,
T. Giannantonio, A. Gilbert, R. A. Gruendl, J. Gschwend, N. Gupta, G. Gutierrez, T. de Haan,
N. W. Halverson, N. Harrington, J. W. Henning, G. C. Hilton, D. L. Hollowood, W. L. Holzapfel,
K. Honscheid, J. D. Hrubes, N. Huang, J. Hubmayr, K. D. Irwin, T. Jeltema, M. Carrasco Kind,
L. Knox, N. Kuropatkin, O. Lahav, A. T. Lee, D. Li, M. Lima, A. Lowitz, M. A. G. Maia, J. L.
Marshall, J. J. McMahon, P. Melchior, F. Menanteau, S. S. Meyer, R. Miquel, L. M. Mocanu,
J. J. Mohr, J. Montgomery, C. Corbett Moran, A. Nadolski, T. Natoli, J. P. Nibarger, G. Noble,
V. Novosad, R. L. C. Ogando, S. Padin, A. A. Plazas, C. Pryke, D. Rapetti, A. K. Romer,
A. Roodman, A. Carnero Rosell, E. Rozo, J. E. Ruhl, E. S. Rykoff, B. R. Saliwanchik,
E. Sanchez, J. T. Sayre, V. Scarpine, K. K. Schaffer, M. Schubnell, S. Serrano, I. Sevilla-Noarbe,
C. Sievers, G. Smecher, M. Smith, M. Soares-Santos, A. A. Stark, K. T. Story, E. Suchyta,
M. E. C. Swanson, G. Tarle, C. Tucker, K. Vanderlinde, T. Veach, J. De Vicente, J. D. Vieira,
V. Vikram, G. Wang, W. L. K. Wu, V. Yefremenko, Y. Zhang, SPTpol, and DES Collaboration.
Detection of CMB-Cluster Lensing using Polarization Data from SPTpol. Phys. Rev. Lett.,
123(18):181301, November 2019.
[25] Joeri Hermans, Volodimir Begy, and Gilles Louppe. Likelihood-free MCMC with Amortized
Approximate Ratio Estimators. arXiv e-prints , page arXiv:1903.04057, March 2019.
[26] Planck Collaboration, N. Aghanim, Y. Akrami, M. Ashdown, J. Aumont, C. Baccigalupi,
M. Ballardini, A. J. Banday, R. B. Barreiro, N. Bartolo, S. Basak, R. Battye, K. Benabed, J. P.
Bernard, M. Bersanelli, P. Bielewicz, J. J. Bock, J. R. Bond, J. Borrill, F. R. Bouchet,
F. Boulanger, M. Bucher, C. Burigana, R. C. Butler, E. Calabrese, J. F. Cardoso, J. Carron,
A. Challinor, H. C. Chiang, J. Chluba, L. P. L. Colombo, C. Combet, D. Contreras, B. P. Crill,
F. Cuttaia, P. de Bernardis, G. de Zotti, J. Delabrouille, J. M. Delouis, E. Di Valentino, J. M.
– 15 –Diego, O. Doré, M. Douspis, A. Ducout, X. Dupac, S. Dusini, G. Efstathiou, F. Elsner, T. A.
Enßlin, H. K. Eriksen, Y. Fantaye, M. Farhang, J. Fergusson, R. Fernandez-Cobos, F. Finelli,
F. Forastieri, M. Frailis, A. A. Fraisse, E. Franceschi, A. Frolov, S. Galeotta, S. Galli, K. Ganga,
R. T. Génova-Santos, M. Gerbino, T. Ghosh, J. González-Nuevo, K. M. Górski, S. Gratton,
A. Gruppuso, J. E. Gudmundsson, J. Hamann, W. Handley, F. K. Hansen, D. Herranz, S. R.
Hildebrandt, E. Hivon, Z. Huang, A. H. Jaffe, W. C. Jones, A. Karakci, E. Keihänen,
R. Keskitalo, K. Kiiveri, J. Kim, T. S. Kisner, L. Knox, N. Krachmalnicoff, M. Kunz,
H. Kurki-Suonio, G. Lagache, J. M. Lamarre, A. Lasenby, M. Lattanzi, C. R. Lawrence, M. Le
Jeune, P. Lemos, J. Lesgourgues, F. Levrier, A. Lewis, M. Liguori, P. B. Lilje, M. Lilley,
V. Lindholm, M. López-Caniego, P. M. Lubin, Y. Z. Ma, J. F. Macías-Pérez, G. Maggio,
D. Maino, N. Mandolesi, A. Mangilli, A. Marcos-Caballero, M. Maris, P. G. Martin,
M. Martinelli, E. Martínez-González, S. Matarrese, N. Mauri, J. D. McEwen, P. R. Meinhold,
A. Melchiorri, A. Mennella, M. Migliaccio, M. Millea, S. Mitra, M. A. Miville-Deschênes,
D. Molinari, L. Montier, G. Morgante, A. Moss, P. Natoli, H. U. Nørgaard-Nielsen, L. Pagano,
D. Paoletti, B. Partridge, G. Patanchon, H. V. Peiris, F. Perrotta, V. Pettorino, F. Piacentini,
L. Polastri, G. Polenta, J. L. Puget, J. P. Rachen, M. Reinecke, M. Remazeilles, A. Renzi,
G. Rocha, C. Rosset, G. Roudier, J. A. Rubiño-Martín, B. Ruiz-Granados, L. Salvati, M. Sandri,
M. Savelainen, D. Scott, E. P. S. Shellard, C. Sirignano, G. Sirri, L. D. Spencer, R. Sunyaev,
A. S. Suur-Uski, J. A. Tauber, D. Tavagnacco, M. Tenti, L. Toffolatti, M. Tomasi, T. Trombetti,
L. Valenziano, J. Valiviita, B. Van Tent, L. Vibert, P. Vielva, F. Villa, N. Vittorio, B. D.
Wandelt, I. K. Wehus, M. White, S. D. M. White, A. Zacchei, and A. Zonca. Planck 2018 results.
VI. Cosmological parameters. A&A, 641:A6, September 2020.
[27] Antony Lewis, Anthony Challinor, and Anthony Lasenby. Efficient computation of CMB
anisotropies in closed FRW models. ApJ, 538:473–476, 2000.
[28] Cullan Howlett, Antony Lewis, Alex Hall, and Anthony Challinor. CMB power spectrum
parameter degeneracies in the era of precision cosmology. J. Cosmology Astropart. Phys.,
1204:027, 2012.
[29]B. A. Benson, P. A. R. Ade, Z. Ahmed, S. W. Allen, K. Arnold, J. E. Austermann, A. N. Bender,
L. E. Bleem, J. E. Carlstrom, C. L. Chang, H. M. Cho, J. F. Cliche, T. M. Crawford,
A. Cukierman, T. de Haan, M. A. Dobbs, D. Dutcher, W. Everett, A. Gilbert, N. W. Halverson,
D. Hanson, N. L. Harrington, K. Hattori, J. W. Henning, G. C. Hilton, G. P. Holder, W. L.
Holzapfel, K. D. Irwin, R. Keisler, L. Knox, D. Kubik, C. L. Kuo, A. T. Lee, E. M. Leitch, D. Li,
M. McDonald, S. S. Meyer, J. Montgomery, M. Myers, T. Natoli, H. Nguyen, V. Novosad,
S. Padin, Z. Pan, J. Pearson, C. Reichardt, J. E. Ruhl, B. R. Saliwanchik, G. Simard,
G. Smecher, J. T. Sayre, E. Shirokoff, A. A. Stark, K. Story, A. Suzuki, K. L. Thompson,
C. Tucker, K. Vanderlinde, J. D. Vieira, A. Vikhlinin, G. Wang, V. Yefremenko, and K. W. Yoon.
SPT-3G: a next-generation cosmic microwave background polarization experiment on the South
Pole telescope. In Wayne S. Holland and Jonas Zmuidzinas, editors, Millimeter, Submillimeter,
and Far-Infrared Detectors and Instrumentation for Astronomy VII , volume 9153 of Society of
Photo-Optical Instrumentation Engineers (SPIE) Conference Series , page 91531P, July 2014.
[30]Peter Ade, James Aguirre, Zeeshan Ahmed, Simone Aiola, Aamir Ali, David Alonso, Marcelo A.
Alvarez, Kam Arnold, Peter Ashton, Jason Austermann, Humna Awan, Carlo Baccigalupi, Taylor
Baildon, Darcy Barron, Nick Battaglia, Richard Battye, Eric Baxter, Andrew Bazarko, James A.
Beall, Rachel Bean, Dominic Beck, Shawn Beckman, Benjamin Beringue, Federico Bianchini,
Steven Boada, David Boettger, J. Richard Bond, Julian Borrill, Michael L. Brown, Sarah Marie
Bruno, Sean Bryan, Erminia Calabrese, Victoria Calafut, Paolo Calisse, Julien Carron, Anthony
Challinor, Grace Chesmore, Yuji Chinone, Jens Chluba, Hsiao-Mei Sherry Cho, Steve Choi,
Gabriele Coppi, Nicholas F. Cothard, Kevin Coughlin, Devin Crichton, Kevin D. Crowley,
Kevin T. Crowley, Ari Cukierman, John M. D’Ewart, Rolando Dünner, Tijmen de Haan, Mark
Devlin, Simon Dicker, Joy Didier, Matt Dobbs, Bradley Dober, Cody J. Duell, Shannon Duff,
Adri Duivenvoorden, Jo Dunkley, John Dusatko, Josquin Errard, Giulio Fabbian, Stephen
– 16 –Feeney, Simone Ferraro, Pedro Fluxà, Katherine Freese, Josef C. Frisch, Andrei Frolov, George
Fuller, Brittany Fuzia, Nicholas Galitzki, Patricio A. Gallardo, Jose Tomas Galvez Ghersi,
Jiansong Gao, Eric Gawiser, Martina Gerbino, Vera Gluscevic, Neil Goeckner-Wald, Joseph
Golec, Sam Gordon, Megan Gralla, Daniel Green, Arpi Grigorian, John Groh, Chris Groppi,
Yilun Guan, Jon E. Gudmundsson, Dongwon Han, Peter Hargrave, Masaya Hasegawa, Matthew
Hasselfield, Makoto Hattori, Victor Haynes, Masashi Hazumi, Yizhou He, Erin Healy, Shawn W.
Henderson, Carlos Hervias-Caimapo, Charles A. Hill, J. Colin Hill, Gene Hilton, Matt Hilton,
Adam D. Hincks, Gary Hinshaw, Renée Hložek, Shirley Ho, Shuay-Pwu Patty Ho, Logan Howe,
Zhiqi Huang, Johannes Hubmayr, Kevin Huffenberger, John P. Hughes, Anna Ijjas, Margaret
Ikape, Kent Irwin, Andrew H. Jaffe, Bhuvnesh Jain, Oliver Jeong, Daisuke Kaneko, Ethan D.
Karpel, Nobuhiko Katayama, Brian Keating, Sarah S. Kernasovskiy, Reijo Keskitalo, Theodore
Kisner, Kenji Kiuchi, Jeff Klein, Kenda Knowles, Brian Koopman, Arthur Kosowsky, Nicoletta
Krachmalnicoff, Stephen E. Kuenstner, Chao-Lin Kuo, Akito Kusaka, Jacob Lashner, Adrian
Lee, Eunseong Lee, David Leon, Jason S. Y. Leung, Antony Lewis, Yaqiong Li, Zack Li, Michele
Limon, Eric Linder, Carlos Lopez-Caraballo, Thibaut Louis, Lindsay Lowry, Marius Lungu,
Mathew Madhavacheril, Daisy Mak, Felipe Maldonado, Hamdi Mani, Ben Mates, Frederick
Matsuda, Loïc Maurin, Phil Mauskopf, Andrew May, Nialh McCallum, Chris McKenney, Jeff
McMahon, P. Daniel Meerburg, Joel Meyers, Amber Miller, Mark Mirmelstein, Kavilan Moodley,
Moritz Munchmeyer, Charles Munson, Sigurd Naess, Federico Nati, Martin Navaroli, Laura
Newburgh, Ho Nam Nguyen, Michael Niemack, Haruki Nishino, John Orlowski-Scherer, Lyman
Page, Bruce Partridge, Julien Peloton, Francesca Perrotta, Lucio Piccirillo, Giampaolo Pisano,
Davide Poletti, Roberto Puddu, Giuseppe Puglisi, Chris Raum, Christian L. Reichardt, Mathieu
Remazeilles, Yoel Rephaeli, Dominik Riechers, Felipe Rojas, Anirban Roy, Sharon Sadeh, Yuki
Sakurai, Maria Salatino, Mayuri Sathyanarayana Rao, Emmanuel Schaan, Marcel Schmittfull,
Neelima Sehgal, Joseph Seibert, Uros Seljak, Blake Sherwin, Meir Shimon, Carlos Sierra,
Jonathan Sievers, Precious Sikhosana, Maximiliano Silva-Feaver, Sara M. Simon, Adrian Sinclair,
Praween Siritanasak, Kendrick Smith, Stephen R. Smith, David Spergel, Suzanne T. Staggs,
George Stein, Jason R. Stevens, Radek Stompor, Aritoki Suzuki, Osamu Tajima, Satoru
Takakura, Grant Teply, Daniel B. Thomas, Ben Thorne, Robert Thornton, Hy Trac, Calvin Tsai,
Carole Tucker, Joel Ullom, Sunny Vagnozzi, Alexander van Engelen, Jeff Van Lanen, Daniel D.
Van Winkle, Eve M. Vavagiakis, Clara Vergès, Michael Vissers, Kasey Wagoner, Samantha
Walker, Jon Ward, Ben Westbrook, Nathan Whitehorn, Jason Williams, Joel Williams,
Edward J. Wollack, Zhilei Xu, Byeonghee Yu, Cyndia Yu, Fernando Zago, Hezi Zhang, Ningfeng
Zhu, and Simons Observatory Collaboration. The Simons Observatory: science goals and
forecasts. J. Cosmology Astropart. Phys., 2019(2):056, February 2019.
[31] Julio F. Navarro, Carlos S. Frenk, and Simon D. M. White. A Universal Density Profile from
Hierarchical Clustering. ApJ, 490(2):493–508, December 1997.
[32]Benedikt Diemer and Michael Joyce. An Accurate Physical Model for Halo Concentrations. ApJ,
871(2):168, February 2019.
[33]Asantha Cooray and Ravi Sheth. Halo models of large scale structure. Phys. Rep., 372(1):1–129,
December 2002.
[34] Benedikt Diemer. COLOSSUS: A Python Toolkit for Cosmology, Large-scale Structure, and
Dark Matter Halos. ApJS, 239(2):35, December 2018.
[35] D. Nelson Limber. The Analysis of Counts of the Extragalactic Nebulae in Terms of a
Fluctuating Density Field. ApJ, 117:134, January 1953.
[36] Marilena LoVerde and Niayesh Afshordi. Extended Limber approximation. Phys. Rev. D,
78(12):123506, December 2008.
[37]Ryuichi Takahashi, Masanori Sato, Takahiro Nishimichi, Atsushi Taruya, and Masamune Oguri.
Revising the Halofit Model for the Nonlinear Matter Power Spectrum. ApJ, 761(2):152,
December 2012.
– 17 –[38] Alvaro Tejero-Cantero, Jan Boelts, Michael Deistler, Jan-Matthis Lueckmann, Conor Durkan,
Pedro J. Gonçalves, David S. Greenberg, and Jakob H. Macke. sbi: A toolkit for
simulation-based inference. Journal of Open Source Software , 5(52):2505, 2020.
[39]George Papamakarios and Iain Murray. Fast ϵ-free Inference of Simulation Models with Bayesian
Conditional Density Estimation. arXiv e-prints , page arXiv:1605.06376, May 2016.
[40] George Papamakarios, David C. Sterratt, and Iain Murray. Sequential Neural Likelihood: Fast
Likelihood-free Inference with Autoregressive Flows. arXiv e-prints , page arXiv:1805.07226, May
2018.
[41] Y. P. Jing and Yasushi Suto. Triaxial Modeling of Halo Density Profiles with High-Resolution
N-Body Simulations. ApJ, 574(2):538–553, August 2002.
– 18 –