 
1 A Multi -Resolution  Physics -Informed Recurrent Neural Network : Formulation and 
Application to  Musculo skeletal Systems  
Karan Tanejaa, Xiaolong Heb, Qizhi Hec and J . S. Chena* 
a Department of Structural Engineering, University of California San Diego, La Jolla , CA, USA  
b ANSYS Inc ., Livermore,  CA, USA  
c Department of Civil, Environmental, and Geo - Engineering, University of Minnesota, 
Minneapolis, MN, USA  
Abstract  
This work presents a  multi -resolution physics -informed recurrent neural network (MR PI -RNN) , 
for simultaneous  predict ion of musculoskeletal  (MSK) motion and parameter identification of the 
MSK systems . The MSK application was selected as the model problem due to its  challenging 
nature in mapping the high-frequency surface electromyography  (sEMG)  signals to the low-
frequency body joint motion  controlled by the MSK  and muscle  contraction  dynamics . The 
proposed method utilizes the fast wavelet transform to decompose the mixed frequency  input  
sEMG and output joint motion signals  into nested multi -resolution signals . The prediction model 
is subsequently trained on coarse r-scale input -output  signals using a gated recurrent unit (GRU), 
and then the trained parameters are transferred to the next level  of training with finer -scale signals . 
These training processes are repeated recursively  under a transfer -learning  fashion  until the full-
scale  training ( i.e., with unfiltered signal s) is achieved , while satisfying the underlying dynamic 
equilibrium . Numerical examples  on recorded subject data demonstrate the effectiveness of the 
proposed framework in generating a physics -informed forward -dynamics surrogate , which  yields 
higher accura cy in  motion predictions of elbow flexion -extension of a n MSK system compared to 
the case with single -scale training.  The framework is also  capable of  identify ing muscle parameters 
that are physiologica lly consistent with the subjectâ€™s  kinematics data.  
Keywords: multi -resolution recurrent  neural  network, p hysics -informed parameter identification, 
musculoskeletal  system , gated recurrent unit , fast wavelet transform  
 
* Corresponding author  
E-mail address : js-chen@ucsd.edu  (J. S. Chen)  
  
2  
1. Introduction  
The prediction of the evolution of state variables  in dynamical systems  has been a vital component 
to several scientific applications such as biology , geophysics , earthquake engineering , solid 
mechanics , robotics,  computer vision  [1â€“7] etc. Black -box techniques based on data -driven 
mapping and development of parameterized multi -physics models describing the progression of 
the data  have been previously  utilized for making predictions on the states. This task continues to 
be an active area of research due to challenges on many fronts,  such as, the quality and scarcity of 
relevant physical data,  the dynamics and complexity of the system , and the reliabili ty and accuracy 
of the prediction model.    
On the other hand, t he characterization of p arameter s in the multi -physics models  of these  
dynamical systems  is also critical  [8â€“14]. The task is challenging  due in parts to potential noise 
pollution  captured by  sensors in the systemâ€™s  measured data, as well as the potential of the 
parameter space being high-dimensional , leading to ill-posed problem s that pose difficulties in 
numerical solutions . Standard optimization techniques such as genetic algorit hms [15,16] , 
simulated annealing  [17], and non -linear least squares  [18,19]  have been employed  for parameter 
identification , but can be computationally expensive  and may not converge  for ill -posed , non -
convex optimization problems  that are encountered while  solving inverse problems on MSK 
systems  [15,20] . 
In recent years, machine learning (ML) or deep -learning -based approaches have gained  significant  
popularity  for solving forward and inverse problems, attributed  to their capability in effectively 
extracting complex features and patterns  from data [21]. This has been successfully demonstrated 
in numerous  engineering applications such as reduced -order modeling [22â€“26], and materials 
modeling [27â€“29], among others.  Data -driven computing  techniques that enforce constraints of 
conservation laws in the learning algorithms of a material database , have been developed in the 
field of computational  mechanics  [29â€“37]. More recently, physics -informed neural networks 
(PINNs) have been developed [11,3 8,39]  to approximate the solutions of given physical equations 
by using neural networks (NNs) . By minimizing the residuals of the governing partial differential 
equations (PDEs) and the associated initial and boundary conditions , PINN s have been 
successfully applied to solve forward problems [11,40,41] , and inverse problems [11,38,42 â€“44],  
3 where the unknown system characteristics are considered trainable parameters or functions [38,45] . 
For biomechanics and biomedical applications [1,46 â€“50], this method has been applied extensively 
along with other ML techniques [51,52] . These attempt to bridge the gap between ML -based data -
driven surrogate models and  the satisfaction of physical laws.  
In this study, we focus on the application to musculoskel etal systems , where we aim to utilize non-
invasive muscle activity measurements  such as surface  electromyography (sEMG) signals to 
predict joint kinetics or  kinematics  [1,18,19] , e.g., for health assessment and rehabilitation 
purposes  [15,16] . These sEMG signals can be used  as control inputs to drive the physiological 
subsyst ems, which are governed by parameterized non -linear differential equations , that form  the 
forward dynamics  problem . Hence, g iven information o n muscle activations , the joint motio n of a 
subject -specific MSK system can be obtained by solving a forward dynamics problem.  Data-driven 
approaches  for motion prediction have also been introduced to directly map the input sEMG signal 
to joint kinetics/kinematics, bypassing the forward dynamics equations and the need for parameter 
estimation [26â€“30]. However, the resulting ML -based surrogate models lack interpretability and 
may not s atisfy the underlying physics. Another challenge is that the sEMG signal usually exhibit s 
a wide range of frequencies that are non-trivial for ML  models  [1] to map to the joint motion . 
In our previous work  [1], a physics -informed parameter identification n eural network (PI-PINN) 
was proposed for the simultaneous prediction of motion and parameter identification with 
application to  MSK systems. Using the  raw transient sEMG signals obtained from the sensors and 
the corresponding joint motion data, the PI-PINN learn ed to predict the motion and identif y the 
parameters of the hill-type muscle models representing  the contractile muscle -tendon complex . A 
feature -encoded approach  was introduced  to enhance the training of the PI -PINN, which yield ed 
high motion prediction accuracy  and identif ied system parameters within a physiological range , 
with only a limited number of training samples . However, this method relies on mapping in a 
feature domain constituted by  Fouri er and polynomial bases , which require s the input sEMG signal 
to span over the entire duration of the motion . Thus , it prevents real-time predictions as the signal 
is obtained from the sensor.   
To enhance the predictive accuracy of the time-dependent signa ls, recurrent neural networks 
(RNNs) such as gated recurrent units (GRUs)  [29,53,54]  are utilized in this study to inform 
prediction s with the history information of the motion. To overcome the limitation of the size of  
4 the data  and provide more information from the composite frequency bands in the signal s, a multi -
resolution based (MR) approach  is proposed . Wavelets are used to decompose the raw sEMG  and 
joint motion signals into  coarse -scale components at various frequency sca les and the remaining 
fine-scale details . Using principles of multi -resolution theory  and transfer learning , multi -
resolution  training processes are repeated recursively from coarse -scale to  the full -scale to map the 
sEMG to the joint motion . To enhance the robustnes s and generalizability of the model , gaussian 
noise is introduced to the recorded  motion data  used for training  [29]. The trained model  can be 
applied for real-time motion  predictions  given  the raw sEMG signal obtained from the sensor . 
This manuscript  is organized as follows. Section 2 introduces the subsystems and mathematical 
formulations of MSK forward dynamics, followed by an introduction of the  proposed multi -
resolution PI-RNN  framework for simultaneous motion prediction and  system parameter 
identification  in Section 3 . The following sections  verify  the proposed framework  using synthetic 
data and validate  it by modeling the elbow flexion -extension movement using subject -specific 
sEMG signals and recorded motion data  in Sectio n 4 and 5 , respectively . Concluding remarks and 
future work are summarized  in Section 6 .  
 
2. Formulations for Muscle Mechanics  and Musculo skeletal Forward  
Dynamics  
This section provides a  brief  overview  of muscle mechanics and forward dynamics of the human 
MSK system , with details in Appendix A and B . As depicted  in Fig. 1, multiple subsystems within 
the MSK forward dynamics interact  hierarchically : 1) the neural excitation ğ‘¢(ğ‘¡) transforms into 
muscle activation  ğ‘(ğ‘¡) (activation dynamics ); 2) Muscle activation  drives muscle fibers to produce 
force  ğ¹ğ‘€ğ‘‡ (muscle -tendon (MT) contraction dynamics ); 3) the result ant forces produce  joint 
motion q (translation and rotation) of MSK systems , called  the MSK forward  dynamics  [11,12,37] .  
5  
Fig. 1: The subsystems involved in the forward dynamics  of an MSK system are depicted in this 
flowchart . Neural excitations are  transmitted to muscle fibers (activation dynamics) that contract 
to produce force (muscle -tendon contraction  dynamics). These forces generate torques at the joints 
(structural level MSK dynamics) leading to joint motion  [1,55] . 
2.1 Neural Excitation -to-Activation Dynamics  
While a ctivations  ğ‘(ğ‘¡) in the muscle fibers  can be obtained  through  a non -linear transformation 
on neural excitations  ğ‘¢(ğ‘¡), they are difficult to measure in-vivo. Therefore, the excitations are 
estimated from  [15,16]  the raw sEMG signals ğ‘’(ğ‘¡) considering an electro -mechanical delay :  
 ğ‘¢(ğ‘¡)=ğ‘’(ğ‘¡âˆ’ğ‘‘). (1) 
 
6 where ğ‘‘ measures the delay between the neural excitation originating and reaching the muscle 
group . The muscle activation signal ğ‘(ğ‘¡) is then expressed  as, 
 
ğ‘(ğ‘¡)=exp(ğ´ğ‘¢(ğ‘¡))âˆ’1
exp(ğ´)âˆ’1 (2) 
where ğ´ is a shape factor. These activations initiate muscle  fiber contraction leading to force 
production from the muscle group.  
 
2.2 Muscle -Tendon  Force Generation through Contraction Dynamics  
 
(a)                                                        (b) 
Fig. 2: A muscle -tendon complex in the arm modelled by  a homogenized hill-type model  where   
muscle group â€™s in (a) are a homogenized muscle -tendon (MT) complex described by the model 
shown in (b).  
Forces in the muscle -tendon (MT) complex are generated  by the dynamics of MT contractions, 
where for structural length scale  behaviour of the  MT complex, homogenized  hill-type m uscle 
model s are utilized  (described in Appendix B)  . Each muscle group can be characterized by a 
parameter vector , 
 ğœ¿ = [ğ‘™0ğ‘€,ğ‘£ğ‘šğ‘ğ‘¥ğ‘€,ğ‘“0ğ‘€,ğ‘™ğ‘ ğ‘‡,ğœ™0], (3) 
containing  constants such as  the maximum isometric force in the muscle ( ğ‘“0ğ‘€), the optimal muscle 
length (ğ‘™0ğ‘€) corresponding to the maximum isometric force, the maximum contraction velocity 
 
7 (ğ‘£ğ‘šğ‘ğ‘¥ğ‘€), the slack length of the tendon ( ğ‘™ğ‘ ğ‘‡), and the initial pennation angle ( ğœ™0) [56,57] . The total 
force produ ced by the MT complex, ğ¹ğ‘€ğ‘‡, can be expressed as :  
 ğ¹ğ‘€ğ‘‡(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€,ğœ™;ğœ¿)=ğ¹ğ‘€(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€;ğœ¿)cosğœ™. (4) 
where ğ‘ is the activation function in  Eq. (2), ğ‘™Ìƒğ‘€ is the normalized muscle length , ğ‘£Ìƒğ‘€ is the 
normalized velocity of the muscle . In this study, the tendon is assumed to be rigid (ğ‘™ğ‘‡=ğ‘™ğ‘ ğ‘‡) which 
simplifies the MT contraction dynamics [58,59]  account ing for the interaction of the activation, 
force length , and force velocity properties of the MT complex. More details can be found i n 
Appendi ces A and B . 
2.3 MSK Forward Dynamics  of Motion  
Body m ovemen t is the result of the force produced by actuators (MT complexes), converted to 
torques at the joints of the body , leading to rotation and translation of joints , which are considered 
as the generalized degrees of freedom of an MSK system (ğ’’). The dynamic equilibrium can be 
expressed as  
 ğ‘°(ğ’’) ğ’’Ìˆâˆ’ğ‘»ğ‘€ğ‘‡(ğ’‚,ğ’’,ğ’’Ì‡;ğœ¿)âˆ’ğ‘¬(ğ’’)=ğŸ, (5) 
where ğ’’,ğ’’Ì‡,ğ’’Ìˆ are the vectors of generalized angular motion s, angular velocities, and angular 
accelerations, respectively; ğ‘¬(ğ’’) is the torque from the external forces acting on the MSK system, 
e.g., ground reactions, gravitational loads etc.; ğ‘°(ğ’’) is the inertial matrix;  ğ‘»ğ‘€ğ‘‡ is the torque  from  
all muscles in the model calculated by ğ‘»ğ‘€ğ‘‡(ğ’‚,ğ’’,ğ’’Ì‡;ğœ¿)=ğ‘¹(ğ’’)ğ‘­ğ‘€ğ‘‡(ğ’‚,ğ’’,ğ’’Ì‡;ğœ¿),  where  ğ‘¹(ğ’’) are 
the m oment arm â€™s and ğ‘­ğ‘€ğ‘‡(ğ’‚,ğ’’,ğ’’Ì‡;ğœ¿) are the forces from the MT complex . Given the muscle 
activation signals ğ’‚, initial conditions  and parameters of involved muscle groups  ğœ¿, the 
generalized angular motions  ğ’’ and angular velocities ğ’’Ì‡ of the joints can be obtained by solving  
Eq. (5). An example of these vectors is shown in Section 4 and Appendix D.    
 
3. Multi -Resolution Recurrent Neural Network s for Physics -Informed  
Parameter Identification  
This section describes the recurrent neural network  algorithm s, followed by the physics -informed 
parameter identification  that enables the development  of a forward dynamics surrogate  and 
simultaneous parameter identification . The employment of multi -resolution analysis based on fast  
8 wavelet transform [60,61]  for training data augmentation is then defined . The computational 
framework for m ulti-resolution recurrent neural network for physics -informed parameter 
identification  is also discussed .  
3.1 Recurrent Neural Network s and Gated Recurrent Units   
 
Fig. 3: Computational graph of a standard recurrent neural netwo rk using â€˜mâ€™ history steps for 
prediction.  
The compu tational graph of a standard recurrent neural network  (RNN) and its unfolded graph is 
shown in  Fig. 3. The hidden state ğ’‰ allows for RNNs to learn important  history -dependent  features 
from the data  in sequential ti me steps [29,53,54] . The unfolded  graph shows  the sharing of 
parameters across the architecture of the network, allowing for efficient training.  The forward 
propagation  of an RNN starts with an initial hidden state  that embeds history -dependent features 
and propagates through all input steps . Considering an RNN with ğ‘š history steps  as shown in  Fig. 
3, the propagation of the hidden  state can be expressed as follows  [29]. 
 ğ’‰ğ‘–=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ‘¾â„â„ğ’‰ğ‘–âˆ’1+ğ‘¾ğ‘¥â„ğ’™ğ‘–+ğ’ƒâ„),    ğ‘–=ğ‘›âˆ’ğ‘š,â€¦,ğ‘› (6) 
 
The hidden state at the final (current)  step ğ‘› is then used to inform  the prediction.  
 
 ğ’’Ì‚ğ‘›=ğ‘¾â„ğ‘ğ’‰ğ‘›+ğ’ƒğ‘ (7) 
Here, ğ‘ğ‘¡ğ‘ğ‘›â„ is the hyperbolic tangent function ; ğ‘¾ğ‘¥â„,ğ‘¾â„â„,  and ğ‘¾â„ğ‘ are the trainable weight 
coefficients ; ğ’ƒâ„ and ğ’ƒğ‘ are the trainable bias coefficients . The trainable parameters are shared 
 
9 across all RNN steps.  Let ğ’™ğ‘›=[ğ‘¡ğ‘›,ğ‘’ğ‘›1,â€¦,ğ‘’ğ‘›ğ‘ğ‘] be the  current  time and  current sEMG data of the 
ğ‘ğ‘ muscle components and ğ’’Ì‚ğ‘› be the predicted joint motion s at the current time ğ‘¡ğ‘›. Fig. 4(a) 
illustrates the computational graph of an RNN model trained to predict the motion at step ğ‘› by 
using m history step s of ğ’™ and ğ’’ as well as the ğ’™ at step ğ‘›. The forward propagation is defined as  
 ğ’‰ğ‘–=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ‘¾â„â„ğ’‰ğ‘–âˆ’1+ğ‘¾ğ‘¥â„ğ’™ğ‘–+ğ‘¾ğ‘â„ğ’’ğ‘–+ğ’ƒâ„), ğ‘–=ğ‘›âˆ’ğ‘š,â€¦,ğ‘›âˆ’1 (8) 
 
 ğ’‰ğ‘›=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ‘¾â„â„ğ’‰ğ‘›âˆ’1+ğ‘¾ğ‘¥â„ğ’™ğ‘›+ğ’ƒâ„), (9) 
 
 ğ’’Ì‚ğ‘›=ğ‘¾â„ğ‘Ì‚ğ’‰ğ‘›+ğ’ƒğ‘ (10) 
with trainable parameters including the weight coefficients ğ‘¾â„â„,ğ‘¾ğ‘¥â„,ğ‘¾ğ‘â„ and ğ‘¾â„ğ‘Ì‚ and bias 
coefficients ğ’ƒâ„ and ğ’ƒğ‘. During training, the â€˜teacher -forcingâ€™ method is used where the measured 
motion data is given to the model in the history steps. In test mode,  the model  is fed back to  the 
previous  predictions as input to inform  future predictions.  The inputs received in this  scenario 
could be quite different from those passed through in the training process, leading  the network to 
make extrapolative predictions and therefore, accumulate errors which  will pollute the predictions .   
To improve the testing performance and enhanc e model accuracy and robustness,  a user-controlled  
amount of  random Gaussian noise is added to the recorded  motion data to introduce stochasticity 
so that the network can learn variable input conditions, resembling those in the test mode , see [29] 
for deta ils. 
 
 
 
 
  
10  
                                   (a)                                                                              (b) 
Fig. 4: An example c omputational graph of an RNN that uses one history step : (a) The t rain mode  
and (b)  the test mode , where the motion predicted from the previous step is used as part of the 
input to predict motion at the current step . 
Standard RNNs , however, have difficulties in learning long -term dependencies due  to vanishing 
and exploding gradie nt issues  arising from the recurrent connections. To mitigate these issues, 
gated recurrent units (GRUs) have been developed [48,50].  A standard GRU consist s of a reset 
gate ğ’“ğ‘›, that removes irrelevant history information, an update gate ğ’–ğ‘› that controls the amount 
of history information that is passed to the next step, and a candidate hidden state ğ’‰Ìƒğ‘› that is used 
to calculate the current hidden state ğ’‰ğ‘› [53,62] . Consideri ng a GRU with  ğ‘š history step s, the 
forward propagation can be expressed as follows  [29]: 
 
ğ’“ğ‘–=ğ‘ğœ(ğ‘¾â„ğ‘Ÿğ’‰ğ‘–âˆ’1+ğ‘¾ğ‘¥ğ‘Ÿğ’™ğ‘–+ğ‘¾ğ‘ğ‘Ÿğ’’ğ‘–+ğ’ƒğ‘Ÿ)
ğ’–ğ‘–=ğ‘ğœ(ğ‘¾â„ğ‘¢ğ’‰ğ‘–âˆ’1+ğ‘¾ğ‘¥ğ‘¢ğ’™ğ‘–+ğ‘¾ğ‘ğ‘¢ğ’’ğ‘–+ğ’ƒğ‘¢)
ğ’›(ğ‘–,ğ‘–âˆ’1)=ğ’“ğ‘–âŠ™ğ‘¾â„â„Ìƒğ’‰ğ‘–âˆ’1
ğ’‰Ìƒğ‘–=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ’›(ğ‘–,ğ‘–âˆ’1)+ğ‘¾ğ‘¥â„Ìƒğ’™ğ‘–+ğ‘¾ğ‘â„Ìƒğ’’ğ‘–+ğ’ƒâ„Ìƒ)
ğ’„(ğ‘–,ğ‘–âˆ’1)=ğ’–ğ‘–âŠ™ğ’‰ğ‘–âˆ’1
ğ’„Ìƒ(ğ‘–,ğ‘–)=ğ’–ğ‘–âŠ™ğ’‰Ìƒğ‘–
ğ’‰ğ‘–=ğ’„(ğ‘–,ğ‘–âˆ’1)+ğ’‰Ìƒğ‘–âˆ’ğ’„Ìƒ(ğ‘–,ğ‘–)+ğ’ƒâ„ 
âˆ€ ğ‘–=ğ‘›âˆ’ğ‘š,â€¦,ğ‘›âˆ’1,  
 
(11) 
 
11  
ğ’“ğ‘›=ğ‘ğœ(ğ‘¾â„ğ‘Ÿğ’‰ğ‘›âˆ’1+ğ‘¾ğ‘¥ğ‘Ÿğ’™ğ‘›+ğ’ƒğ‘Ÿ)
ğ’–ğ‘›=ğ‘ğœ(ğ‘¾â„ğ‘¢ğ’‰ğ‘›âˆ’1+ğ‘¾ğ‘¥ğ‘¢ğ’™ğ‘›+ğ’ƒğ‘¢)
ğ’›(ğ‘›,ğ‘›âˆ’1)=ğ’“ğ‘›âŠ™ğ‘¾â„â„Ìƒğ’‰ğ‘›âˆ’1
ğ’‰Ìƒğ‘›=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ’›(ğ‘›,ğ‘›âˆ’1)+ğ‘¾ğ‘¥â„Ìƒğ’™ğ‘›+ğ’ƒâ„Ìƒ)
ğ’„(ğ‘›,ğ‘›âˆ’1)=ğ’–ğ‘›âŠ™ğ’‰ğ‘›âˆ’1
ğ’„Ìƒ(ğ‘›,ğ‘›)=ğ’–ğ‘›âŠ™ğ’‰Ìƒğ‘›
ğ’‰ğ‘›=ğ’„(ğ‘›,ğ‘›âˆ’1)+ğ’‰Ìƒğ‘›âˆ’ğ’„Ìƒ(ğ‘›,ğ‘›)+ğ’ƒâ„  
 
(12) 
 
 ğ’’Ì‚ğ‘›=ğ‘¾â„ğ‘Ì‚ğ’‰ğ‘›+ğ’ƒğ‘ (13) 
 
where âŠ™ denotes the element -wise (Hadamard)  product; ğ‘ğœ(â‹…) is the sigmoid activation function 
and ğ‘ğ‘¡ğ‘ğ‘›â„(â‹…)  is the hyperbolic tangent function ; 
ğ‘¾â„ğ‘Ÿ,ğ‘¾ğ‘¥ğ‘Ÿ,ğ‘¾ğ‘ğ‘Ÿ,ğ‘¾â„ğ‘¢,ğ‘¾ğ‘¥ğ‘¢,ğ‘¾ğ‘ğ‘¢,   ğ‘¾â„â„Ìƒ,ğ‘¾ğ‘¥â„Ìƒ,ğ‘¾ğ‘â„Ìƒ and ğ‘¾â„ğ‘Ì‚ are the trainable weight coefficients; 
ğ’ƒğ‘Ÿ,ğ’ƒğ‘¢,ğ’ƒâ„Ìƒ,ğ’ƒâ„ and ğ’ƒğ‘ are the trainable bias coefficie nts. The current hidden state ğ’‰ğ‘› is calculated 
by a linear interpolation between the previous hidden state ğ’‰ğ‘›âˆ’1 and the candidate hidden state ğ’‰Ìƒğ‘›, 
based on the update gate ğ’–ğ‘›. The model is trained via the backpropagation through time algorithm 
applied to RNNs [21]. Training occurs  by plugging in the measured motion data in history steps 
(shown in Fig. 5), known as the teacher forcing procedure [21]. For predictions , the prediction 
from the previous step is used to predict the current step. The addition of gaussian noise to 
measured data , as described before,  is adopted in GRU models as well.    
12                                                                                                       
                                        (a)                                                                            (b) 
Fig. 5: An example computational graph of a GRU  in train  mode  that uses one history step : (a) 
Starting with an initial  or previously obtained  hidden state (ğ’‰ğ‘›âˆ’2), the m ain GRU cell takes the 
input  ğ’™ğ‘›âˆ’1 and motion ğ’’ğ‘›âˆ’1 that are used to obtain the GRU hidden state  ğ’‰ğ‘›âˆ’1 at step ğ‘›âˆ’1 (Eq. 
(11))  and, (b) where the hidde n state  ğ’‰ğ‘›âˆ’1 is plugged back in to the GRU along with input  ğ’™ğ‘› at 
step ğ‘› to predict the motion ğ’’Ì‚ğ‘› (Eq. (12)-(13)). The â€˜+â€™ cell produces an output  (arrow pointing 
outwards)  that is the summation of the inputs  (arrows pointing into the cell) .  
3.2 Simultaneous Forward Dynamics Learning and Parameter Identification  
With the governing equations for a general  MSK forward dynamics (Section 2.1), the following 
parameterized ODE  system  is defined  as 
 ğ“›[ğ’’(ğ‘¡);ğ€]=ğ’”(ğ‘¡;ğ), âˆ€ ğ‘¡âˆˆ (0,T],ğ“‘[ğ’’(0)]=ğ’ˆ , 
 (14) 
where the differential operator ğ“›[(â‹…);ğ€] is parameterized by a set of parameters ğ€. The right -hand 
side ğ’”(ğ‘¡;ğ) is parameterised by ğ. ğ“‘[(â‹…)] is the operator for initial conditions , and ğ’ˆ is the vector 
of prescribed initial conditions. To simpl ify notations, the ODE parameters are denoted by   ğœ=
{ğ€,ğ}. The solution to the ODE system  ğ’’:[0,ğ‘‡]â†’â„ depends on the choice of parameters ğœ. 
 
13 Here , an RNN  is used to relate data inputs  containing discrete sEMG signals and discrete time  
from all the ğ‘š previous history time -steps  of a trial , âˆªğ‘–=ğ‘›âˆ’ğ‘šğ‘›ğ’™ğ‘–âˆˆâ„ğ‘›ğ‘–ğ‘›,ğ‘šâˆˆâ„¤+, to discrete joint 
motion data outputs  at the current time -step, ğ’’ğ‘›âˆˆâ„ , approximat ing the MSK forward dynamics.  
Let the traini ng input at the ğ‘–ğ‘¡â„ history step be defined as ğ’™ğ‘–=[ğ‘¡ğ‘–,ğ‘’ğ‘–1,â€¦,ğ‘’ğ‘–ğ‘ğ‘], where  ğ‘¡ğ‘– denote s 
the time at the ğ‘–ğ‘¡â„ time step, and {ğ‘’ğ‘–ğ‘—}ğ‘—=1ğ‘ğ‘ denotes the sEMG signals of ğ‘ğ‘ muscle groups involved 
in the MSK joint motion  at ğ‘¡ğ‘–. The motion at time step ğ‘›, is then predicted using the training input 
from all the previous ğ‘š steps using the RNN . 
 ğ’’Ì‚ğ‘›(ğœ½)=ğ‘“ğ‘…ğ‘ğ‘(ğ’™ğ‘›,ğ’™ğ‘›âˆ’1,ğ’’ğ‘›âˆ’1,â€¦,ğ’™ğ‘›âˆ’ğ‘š,ğ’’ğ‘›âˆ’ğ‘š;ğœ½) (15) 
 
where ğ‘“ğ‘…ğ‘ğ‘ denotes RNN evaluations  (depending on model chosen)  discussed  in Eq. (11)-(13). 
The optimal RNN  parameters ğœ½Ìƒ and the ODE parameters ğœÌƒ  are obtained by minimizing the 
composite loss function ğ½ as follows , 
 ğœ½Ìƒ,ğœ Ìƒ=argmin
ğœ½,ğœ(ğ½)=argmin
ğœ½,ğœ( ğ½ğ‘‘ğ‘ğ‘¡ğ‘+ğ›½ ğ½ğ‘Ÿğ‘’ğ‘ ) (16) 
where ğ›½ is the parameter to regularize the loss contribution from the ODE residual term in the loss 
function and can be  estimated analytically  [1]. The data loss is defined by ,  
 
ğ½ğ‘‘ğ‘ğ‘¡ğ‘=1
ğ‘ğ‘‘ğ‘ğ‘¡ğ‘âˆ‘â€–ğ’’Ì‚ğ›¼(ğœ½)âˆ’ğ’’ğ›¼â€–ğ¿22ğ‘ğ‘‘ğ‘ğ‘¡ğ‘
ğ›¼=1 (17) 
where ğ’’Ì‚ğ›¼(ğœ½) is the predicted motion , and ğ’’ğ›¼ is the recorded motion  of MSK joints . In addition to 
training a n MSK forward dynamics surrogate, the proposed framework aims to simultaneously 
identify important MSK parameters from the training data by minimizing residual of the governing 
equation of MSK system dynamics  in Eq. (5).  
 
ğ½ğ‘Ÿğ‘’ğ‘ =1
ğ‘ğ‘‘ğ‘ğ‘¡ğ‘âˆ‘â€–ğ’“(ğ’’Ì‚ğ›¼(ğœ½);ğœ)â€–ğ¿22ğ‘ğ‘‘ğ‘ğ‘¡ğ‘
ğ›¼=1 
ğ’“(ğ’’Ì‚ğ›¼(ğœ½);ğœ)=ğ“›[ğ’’Ì‚ğ›¼(ğœ½);ğ€]âˆ’ğ’”(ğ‘¡ğ›¼;ğ) (18) 
   
where ğ’“(ğ’’Ì‚ğ›¼(ğœ½);ğœ)is the residual  associated with Eq. (14) for the ğ›¼ğ‘¡â„ sample;  ğœ={ğ€,ğ} 
represents the ODE parameters relevant to the MSK system.  The gradients of the network  outputs 
with respect to the network  parameters (ğœ½), MSK parameters (ğœ), and inputs are needed in the  
14 loss function minimization  in Eq. (16), which  can be obtained efficiently by automatic 
differentiation [63]. The formulation  in Eq. (15) is general such that  more advanced RNN 
frameworks can be used such as the GRU described in Eq. (11)-(13). 
3.3 Multi -Resolution Training with Transfer Learning  
To improve the training efficiency of RNN  for MSK applications with mixed -frequency sEMG 
input signals and low -frequency output joint motion , a multi -resolution decomposition of the 
training input -output  data is introduced in Section  3.3.1, followed by the  transfer learning based  
multi -resolution  training protocols to be discussed in Section 3.3.2.  
3.3.1 Wavelet based Multi -Resolution Analysis  
Consider a sequence of nested subspaces â€¦âŠ‚ğ‘‰âˆ’1âŠ‚ğ‘‰0âŠ‚ğ‘‰1âŠ‚â‹¯âŠ‚ğ¿2(ğ‘…) where  
â‹ƒğ‘‰ğ‘—ğ‘—âˆˆğ’µ=ğ¿2(ğ‘…), and â‹‚ğ‘‰ğ‘—ğ‘—âˆˆğ’µ=âˆ…. Each subspace ğ‘‰ğ‘— of scale [ğ‘—] is spanned by a set  of scaling 
functions ğœ™ğ‘—,ğ‘˜(ğ‘¡), i.e.,  
ğ‘‰ğ‘—={ğœ™ğ‘—,ğ‘˜(ğ‘¡)|ğœ™ğ‘—,ğ‘˜(ğ‘¡)=2ğ‘—
2ğœ™(2ğ‘—ğ‘¡âˆ’ğ‘˜),ğ‘˜âˆˆğ’µ} 
 
Each subspace is related to the finer subspace through the law of dilation i.e., if ğœ™(ğ‘¡)âˆˆğ‘‰ğ‘—, then 
ğœ™(2ğ‘¡)âˆˆğ‘‰ğ‘—+1,âˆ€ğ‘—âˆˆğ’µ. Translations of the scaling function span the same subspace, i.e., if  ğœ™(ğ‘¡)âˆˆ
ğ‘‰ğ‘—,then ğœ™(ğ‘¡âˆ’ğ‘˜)âˆˆğ‘‰ğ‘—,âˆ€ğ‘—,ğ‘˜âˆˆğ’µ.  
A mutually orthogonal complement of ğ‘‰ğ‘— in ğ‘‰ğ‘—+1 is ğ‘Šğ‘—, such that , 
 ğ‘‰ğ‘—+1=ğ‘‰ğ‘—âŠ•ğ‘Šğ‘—,âˆ€ğ‘—âˆˆğ’µ (19) 
where âŠ• is a direct sum. This subspace ğ‘Šğ‘— is spanned by a set of wavelet functions ğœ“ğ‘—,ğ‘˜(ğ‘¡), i.e.,  
ğ‘Šğ‘—={ğœ“ğ‘—,ğ‘˜(ğ‘¡)|ğœ“ğ‘—,ğ‘˜(ğ‘¡)=2ğ‘—
2ğœ“(2ğ‘—ğ‘¡âˆ’ğ‘˜),ğ‘˜âˆˆğ’µ} 
where ğœ“(ğ‘¡) is the mother wavelet. It follows that , 
 âŠ•ğ‘—âˆˆğ’µğ‘Šğ‘—=ğ¿2(ğ‘…) (20) 
and therefore,   
15  ğ‘‰ğ‘—=ğ‘‰ğ‘–âŠ•(âŠ•ğ‘˜=0ğ‘—âˆ’ğ‘–âˆ’1ğ‘Šğ‘–+ğ‘˜),ğ‘—>ğ‘–.  (21) 
The two -scale dilation and translation relations for the scaling functions can be written as  
 
ğœ™(ğ‘¡)=âˆš2âˆ‘ğ‘‘ğ‘˜ğœ™(2ğ‘¡âˆ’ğ‘˜)âˆ
ğ‘˜=âˆ’âˆ. (22) 
Orthogonal wavelet functions can be obtained by imposing orthogonality conditions between 
scaling and wavelet functions in the frequency domain using Fourier transform,  
 
ğœ“(ğ‘¡)=âˆš2âˆ‘(âˆ’1)ğ‘˜âˆ’1ğ‘‘âˆ’ğ‘˜âˆ’1ğœ™(2ğ‘¡âˆ’ğ‘˜)âˆ
ğ‘˜=âˆ’âˆ (23) 
where ğ‘‘ğ‘˜ is the coefficient.  
Orthogonal scaling functions can be constructed by choosing a candidate function ğœ™âˆ—(ğ‘¡) such that 
ğœ™âˆ—(ğ‘¡) have reasonable decay and a finite support. In addition, âˆ«ğœ™âˆ—(ğ‘¡)ğ‘‘ğ‘¡â‰ 0. It should also sati sfy 
the two -scale relation , 
 ğœ™âˆ—(ğ‘¡)=âˆ‘ğ‘ğ‘˜ğœ™âˆ—(2ğ‘¡âˆ’ğ‘˜)
ğ‘˜,ğ‘˜âˆˆğ’µ. (24) 
With these, an orthogonal scaling function ğœ™(ğ‘¡) can be expressed in terms of ğœ™âˆ—(ğ‘¡) as 
 
ğœ™(ğ‘¡)=âˆ‘ğ‘ğ‘˜ğœ™âˆ—(ğ‘¡âˆ’ğ‘˜)âˆ
ğ‘˜=âˆ’âˆ. (25) 
It is then possible to define the scaling function at the coarse scale in terms of the scaling function 
at the fine scale and the wavelet functions at the coarser scale , 
 
ğœ™(2ğ‘¡âˆ’ğ‘™)=âˆ‘ğ‘‘ğ‘™âˆ’2ğ‘˜ğœ™(ğ‘¡âˆ’ğ‘˜)+âˆ‘â„ğ‘™âˆ’2ğ‘˜ğœ“(ğ‘¡âˆ’ğ‘˜),ğ‘™âˆˆğ’µâˆ
ğ‘˜=âˆ’âˆâˆ
ğ‘˜=âˆ’âˆ. (26) 
Any function can be approximated at scale  [ğ‘—] by using ğœ™ğ‘—,ğ‘˜ as a basis  as well as  using its coarse  
scale [ğ‘—âˆ’1] representation and details at  the coarse scale , i.e.,   
16  
ğ‘ƒğ‘—ğ‘“=âˆ‘ğ‘†ğ‘˜[ğ‘—]ğœ™ğ‘—,ğ‘˜âˆ
ğ‘˜=âˆ’âˆ=ğ‘ƒğ‘—âˆ’1ğ‘“ +ğ»ğ‘—âˆ’1ğ‘“
=âˆ‘ğ‘†ğ‘˜[ğ‘—âˆ’1]ğœ™ğ‘—âˆ’1,ğ‘˜âˆ
ğ‘˜=âˆ’âˆ+âˆ‘ğ‘‡ğ‘˜[ğ‘—âˆ’1]ğœ“ğ‘—âˆ’1,ğ‘˜âˆ
ğ‘˜=âˆ’âˆ (27) 
where ğ‘ƒğ‘— and ğ»ğ‘— are the operators projecting ğ‘“ onto the subspaces ğ‘‰ğ‘— and details of ğ‘“ at scale [ğ‘—] in 
the orthogonal subspace ğ‘Šğ‘—, respectively. ğ‘†ğ‘˜[ğ‘—] and ğ‘‡ğ‘˜[ğ‘—] are the corresponding basis coefficients  at 
the coarse scale [ğ‘—]. While the example shown here is for a one -dimensional case, t his multi -
resolution representation  can be extended to multi -dimension s. 
3.3.2 Multi -Resolution Data Representation  and Training Protocols  
In this approach, a  given signal ğ‘“(ğ‘¡) is represented  using  the multi -resolution scaling functions 
and wavelets.  A scale [ğ‘—] representation of  signal  ğ‘“(ğ‘¡) can be obtained from the scale [ğ‘Ÿ] (ğ‘—>ğ‘Ÿ) 
representation with the addition of wavelet components  (high frequency components) of the scales 
higher than [ğ‘Ÿ], using the discrete wavelet transform  modified from  Eq. (27),  
 
ğ‘ƒğ‘—ğ‘“(ğ‘¡)=ğ‘ƒğ‘Ÿğ‘“(ğ‘¡) +âˆ‘ğ»ğ‘ğ‘“(ğ‘¡)ğ‘—âˆ’1
ğ‘=ğ‘Ÿ=âˆ‘ğ‘†ğ‘˜[ğ‘Ÿ]ğœ™ğ‘Ÿ,ğ‘˜(ğ‘¡)âˆ
ğ‘˜=âˆ’âˆ+âˆ‘âˆ‘ğ‘‡ğ‘˜[ğ‘]ğœ“ğ‘,ğ‘˜(ğ‘¡)âˆ
ğ‘˜=âˆ’âˆğ‘—âˆ’1
ğ‘=ğ‘Ÿ 
 (28) 
where ğ‘ƒğ‘Ÿ is the projection operator  at scale [ğ‘Ÿ] and ğ»ğ‘ are the wavelet  projector s of the signal  that 
are added from scale [ğ‘Ÿ] to scale [ğ‘—âˆ’1] to reconstruct the  signal at scale [ğ‘—]; ğ‘†ğ‘˜[ğ‘Ÿ] and ğ‘‡ğ‘˜[ğ‘] are the 
scaling and wavelet functionâ€™s coefficients, obtained by the orthogonality condition  as given  in 
Section 3.3.1 .  
Using the Wavelet transform  to represent  a time series under multiple resolutions  offers advantages 
for feature extraction from signals. Compared to the Fourier transform which offers only  
localization in the  frequency domain , the Wavelet transform provides both frequency and time 
domain localization , making it more suitable for time history  (or sequence)  learning algorithms 
such as the standard RNN and its enhanced variant GRU. More specifically, one can enhance 
training  efficienc y by using a sequential training  strategy  for the time-history input (sEMG)  and 
output (joint motion)  data. Applying the Fast Wavelet Transform [57,58]  to obtain the in put and 
output  data from low to high resolutions  resul ts in better generalization performance of the RNN   
17 trained to map  from sEMG signals to joint motion time history  as described below . The second 
order Daubechies wavelets are used in this work.   
Here we consider a general MSK system described in Section 2. The original unfiltered data is 
denoted as  scale [0], which will be decomposed into a sequence of lower scales [âˆ’ğ‘—],ğ‘—âˆˆâ„¤+ for 
multi -resolution training .  
Let ğ‘«[0] be the input training data at the full-scale  (ğ‘—=0) of the raw signals i.e.,  
 ğ‘«[0]=[ğ’™1[0],ğ’™2[0],â€¦,ğ’™ğ‘ğ‘‘ğ‘ğ‘¡ğ‘[0]], 
ğ’™ğ‘–[0]=[ğ‘¡ğ‘–,ğ‘’ğ‘–1[0],â€¦,ğ‘’ğ‘–ğ‘ğ‘[0]]. (29) 
and the  motion of joints of the  MSK system at the  ğ‘–ğ‘¡â„ time-step at the full -scale (ğ‘—=0) is ğ’’ğ‘–[0] 
such that  the array of the unfiltered motion data for the duration  of the motion is  ğ’’[0]=
[ğ’’1[0],ğ’’2[0],â€¦ğ’’ğ‘ğ‘‘ğ‘ğ‘¡ğ‘[0]]. 
 From MR theory, subtracting details from the fine scale representations at the full-scale  of the 
signal , i.e., [0],  results in a course scale representation of the signal at scale [âˆ’ğ‘˜],ğ‘˜=1,â€¦ğ‘—. The 
projected  training data at coarse scale [ -j] is defined as  
 ğ‘«[âˆ’ğ‘—]=[ğ’™1[âˆ’ğ‘—],ğ’™2[âˆ’ğ‘—],â€¦,ğ’™ğ‘ğ‘‘ğ‘ğ‘¡ğ‘[âˆ’ğ‘—]], (30) 
where ğ‘ğ‘‘ğ‘ğ‘¡ğ‘ is the total number of data points  and  
 ğ’™ğ‘–[âˆ’ğ‘—]=[ğ‘¡ğ‘–,ğ‘’ğ‘–1[âˆ’ğ‘—],â€¦,ğ‘’ğ‘–ğ‘ğ‘[âˆ’ğ‘—]], i=1â€¦, ğ‘ğ‘‘ğ‘ğ‘¡ğ‘ (31) 
is the input data of scale [ -j] at time step ğ‘–. The motion of the MSK joints at the  ğ‘–ğ‘¡â„ time-step at 
the scale [âˆ’ğ‘—] is ğ’’ğ‘–[âˆ’ğ‘—]. The data sets  for a representative muscle group  â€˜ğ‘€ğ‘‡â€™, ğ‘’ğ‘–ğ‘€ğ‘‡[âˆ’ğ‘—] and motion  
ğ’’ğ‘–[âˆ’ğ‘—], are obtained from the original raw data ğ‘’ğ‘–ğ‘€ğ‘‡[0] and ğ’’ğ‘–[0] by wavelet projection using  Eq. (27), 
that is,  
 ğ‘’ğ‘€ğ‘‡[âˆ’ğ‘—](ğ‘¡)â‰¡ğ‘ƒğ‘—ğ‘’ğ‘€ğ‘‡[0](ğ‘¡)=ğ‘ƒğ‘—âˆ’1ğ‘’ğ‘€ğ‘‡[0](ğ‘¡)+ğ»ğ‘—âˆ’1ğ‘’ğ‘€ğ‘‡[0](ğ‘¡)
=ğ‘’ğ‘€ğ‘‡[0](ğ‘¡)âˆ’âˆ‘ğ»ğ‘ğ‘’ğ‘€ğ‘‡[0](ğ‘¡)ğ‘—âˆ’1
ğ‘=0 (32)  
18 ğ’’[âˆ’ğ‘—](ğ‘¡)â‰¡ğ‘·ğ‘—ğ’’[0](ğ‘¡)=ğ‘·ğ‘—âˆ’1ğ’’[0](ğ‘¡)+ğ‘¯ğ‘—âˆ’1ğ’’[0](ğ‘¡)=ğ’’[0](ğ‘¡)âˆ’âˆ‘ğ‘¯ğ‘ğ’’[0](ğ‘¡)ğ‘—âˆ’1
ğ‘=0 
 
 
where ğ‘·ğ‘— and ğ‘¯ğ‘— are the projection operators in multi -dimensions.  Hence, datasets that contain 
lower resolution representations of the original signal at scale s [0] can be expressed as: 
 ğ‘«[âˆ’ğ‘—]âŠ‚ğ‘«[âˆ’ğ‘—+1]âŠ‚â‹¯ğ‘«[âˆ’1]âŠ‚ğ‘«[0] 
ğ’’[âˆ’ğ‘—]âŠ‚ğ’’[âˆ’ğ‘—+1]âŠ‚â‹¯ğ’’[âˆ’1]âŠ‚ğ’’[0] (33) 
where ğ’’[âˆ’ğ‘—]=[ğ’’1[âˆ’ğ‘—],ğ’’2[âˆ’ğ‘—],â€¦,ğ’’ğ‘ğ‘‘ğ‘ğ‘¡ğ‘[âˆ’ğ‘—]]. 
Instead of learning the signal mapping from  input original raw sEMG data  ğ‘«[0] to motion data ğ’’[0], 
we initiate  learn ing the mapping by starting from a coarse  scale representation of the input -output  
data at scale [âˆ’ğ‘—] and map ğ‘«[âˆ’ğ‘—] to ğ’’[âˆ’ğ‘—]. For multi -resolution RNN, the init ial learning starts from 
the coarsest scale [âˆ’ğ‘—] as foll ows: 
 ğ’‰ğ‘–[ğ‘—]=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ‘¾â„â„[âˆ’ğ‘—]ğ’‰ğ‘–âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥â„[âˆ’ğ‘—]ğ’™ğ‘–[âˆ’ğ‘—]+ğ‘¾ğ‘â„[âˆ’ğ‘—]ğ’’ğ‘–[âˆ’ğ‘—]+ğ’ƒâ„[âˆ’ğ‘—]),  
âˆ€ğ‘–=ğ‘›âˆ’ğ‘š,â€¦,ğ‘›âˆ’1 (34) 
 ğ’‰ğ‘›[âˆ’ğ‘—]=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ‘¾â„â„[âˆ’ğ‘—]ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥â„[âˆ’ğ‘—]ğ’™ğ‘›[âˆ’ğ‘—]+ğ’ƒâ„[âˆ’ğ‘—]), (35) 
 
 ğ’’Ì‚ğ‘›[âˆ’ğ‘—]=ğ‘¾â„ğ‘Ì‚[âˆ’ğ‘—]ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+ğ’ƒğ‘[âˆ’ğ‘—]. (36) 
 
 
At the next finer scale [âˆ’ğ‘—+1], the weights at scale [âˆ’ğ‘—] (using an early stopping [64]) are used 
as the initial values for ğ‘¾â„â„[âˆ’ğ‘—+1], ğ‘¾ğ‘¥â„[âˆ’ğ‘—+1], ğ‘¾ğ‘â„[âˆ’ğ‘—+1], ğ‘¾â„ğ‘Ì‚[âˆ’ğ‘—+1],ğ’ƒâ„[âˆ’ğ‘—],ğ’ƒğ‘[âˆ’ğ‘—], similar to the concept of 
transfer learning [65]. 
Similarly, for multi -resolution GRU, the initial learning starts from the coarsest scale [âˆ’ğ‘—] as 
described in Appendix C. The s ame procedures to transfer the NN parameters  in Eq. (34)-(36) are 
repeate d with  [âˆ’ğ‘—]â†’[âˆ’ğ‘—+1] until it reaches scale [0]. To enhance model accuracy and 
robustness , variations based on Gaussian noise are added to the motion data  in each sequential step,  
as suggested by [29]. The sequential MR training process is described in Algorithm  1.   
19 Algorithm 1: Sequential Multi -Resolution PI-RNN  training process.  
Ste Step1: Initialize parameters.  
ğœ½=ğœ½0,ğœ=ğœ0 
Step 2: Sequential learning through parameter transfer from coarse -scale to fine -scale.  
For ğ‘™=0â†’ğ‘— 
    1. Train the RNN on the dataset ğ‘«[âˆ’ğ‘—+ğ‘™] by calculating the predictions as  
ğ’’Ì‚ğ‘›[âˆ’ğ‘—+ğ‘™](ğœ½,ğœ)=ğ‘“ğ‘…ğ‘ğ‘(ğ’™ğ‘›[âˆ’ğ‘—+ğ‘™],ğ’™ğ‘›âˆ’1[âˆ’ğ‘—+ğ‘™],ğ’’ğ‘›âˆ’1[âˆ’ğ‘—+ğ‘™],â€¦,ğ’™ğ‘›âˆ’ğ‘š[âˆ’ğ‘—+ğ‘™],ğ’’ğ‘›âˆ’ğ‘š[âˆ’ğ‘—+ğ‘™];ğœ½,ğœ) 
                        ğ‘šâ†’ # of history steps   
                        ğ‘›â†’ current time step  
ğœ½Ìƒ,ğœ Ìƒ=argmin
ğœ½,ğœ(ğ½)=argmin
ğœ½,ğœ( ğ½ğ‘‘ğ‘ğ‘¡ğ‘(ğœ½)+ğ›½ ğ½ğ‘Ÿğ‘’ğ‘ (ğœ½,ğœ)) 
    2. ğœ½=ğœ½Ìƒ,ğœ=ğœÌƒ 
 
 
4. Verification  Example  
For verification of  the proposed MR PI-RNN framework , an elbow flexion -extension model [1] 
and s ynthetic sEMG signals with gaussian noise  and associated motion responses were considered . 
The flowchart  of the proposed computational framework for simultaneous forward dynamics 
prediction and parameter identification of MSK parameters is shown in Fig. 6.  
The model contai ned two rigid links corresponding to  the upper arm and forearm with lengths ğ‘™ğ‘¢ğ‘ 
and ğ‘™ğ‘“ğ‘, respectively . They wer e connected at a hinge resembling the elbow joint â€œAâ€, while the 
upper arm link was fixed at the top joint â€œBâ€, and the bicep s (Bi) and triceps  (Tri) muscle -tendon 
complex es (modeled by Hill-type model s with parameters ğœ¿ğµğ‘– and ğœ¿ğ‘‡ğ‘Ÿğ‘–) were represented by the 
lines connecting the links, as  shown in Fig. 6. The degree of freedom of the model was the elbow 
flexion angle ğ‘. The mass in the forehand was  assumed to be  concentrated at the wrist location, 
hence, a mass ğ‘šğ‘“ğ‘ was attached to one end of the forearm link with a moment ar m ğ‘™ğ‘“ğ‘ from the 
elbow joint. Tendons were assumed as rigid  [58] for ease of computation.  
  
20  
 
Fig. 6: An o verview of the application of this framework to the recorded motion data. The location 
of motion capture markers is circled in red and the sEMG sensor s on Biceps and Triceps muscle 
groups  in blue  and green , respectively . The simplified rigid body model was used in the forward 
dynamics equations within the framework with appropriately scaled anthropometric properties (for 
geometry) and physiological parameters (for muscle -tendon material models). The raw sEMG 
signals were mapped  to the  target  angular motion of the elbow  and used to simultaneously 
characterize the  MSK system using the proposed Multi -Resolution PI-RNN framework . 
 
The equation of motion for this rigid body system is given in Appendix D. Given the synthetic 
sEMG signals  (ğ‘’ğµğ‘–(ğ‘¡),ğ‘’ğ‘‡ğ‘Ÿğ‘–(ğ‘¡)), the initial conditions ğ‘(0)=ğœ‹
6 radians  and ğ‘Ì‡(0)=0 radians/
sec  and the parameters in Table 1, the motion of the elbow joint, ğ‘, can be  obtained by solving 
the MSK forward dynamics problem using a  synthetic solver . 
 
21 Table 1: Parameters involved in the forward d ynamics setup of elbow flexion -extension motion . 
 
 
 
 
 
 
 Parameter  Type  Value  Parameter  Type  Value  
ğ‘™0,Biğ‘€ Bicep s Muscle Model  0.6 m  ğ‘šğ‘“ğ‘ Equation 
of motion  1.0 kg  
ğ‘£ğ‘šğ‘ğ‘¥,ğµğ‘–ğ‘€ Bicep s Muscle Model  6 m/sec ğ‘™ğ‘¢ğ‘ Geometric  1.0 m  
ğ‘“0,Biğ‘€ Bicep s Muscle Model  300 N  ğ‘™ğ‘“ğ‘ Geometric  1.0 m  
ğ‘™ğ‘ ,ğµğ‘–ğ‘‡ Bicep s Muscle Model  0.55 m  ğ‘™1,ğµğ‘– Geometric  0.3 m  
ğœ™ğµğ‘– Bicep s Muscle Model  0.0 
radians  ğ‘™2,ğµğ‘– Geometric  0.8 m  
ğ‘™0,Triğ‘€ Triceps Muscle Model  0.4 m  ğ‘™1,ğ‘‡ğ‘Ÿğ‘– Geometric  0.2 m  
ğ‘£ğ‘šğ‘ğ‘¥,ğ‘‡ğ‘Ÿğ‘–ğ‘€ Triceps Muscle Model  4 m/sec ğ‘™2,ğ‘‡ğ‘Ÿğ‘– Geometric  0.7 m  
ğ‘“0,ğ‘‡ğ‘Ÿğ‘–ğ‘€ Triceps Muscle Model  300 N  ğ‘‘ Activation 
Dynamics  0.08 sec  
ğ‘™ğ‘ ,ğ‘‡ğ‘Ÿğ‘–ğ‘‡ Triceps Muscle Model  0.33 m  
A Activation 
Dynamics  0.2 
ğœ™ğ‘‡ğ‘Ÿğ‘– Triceps Muscle Model  0.0 
radians  
  
22  
Fig. 7: The original â€˜noiseless â€™ input data set with the synthetic biceps and tricep s sEMG signals 
having variations in frequency for five trials  are shown at the top.  Increasing levels of noise are 
added to develop 3 cases of synthetic mixed frequency input sEMG , from which corresponding 
output motions are solved , using the forward dynamics equations. To verify  the MR framework , 
these  three cases  with their respective mixed frequency  input data  are then mapped to the ir 
corresponding  motion data . 
To verify  and check the robustness of the MR framework to different levels of noise in the input , 
the following test was performed. O riginally,  five synthetic samples i.e., Tria l's 1 to 5, of noiseless  
synthetic muscle sEMG signals  are assumed , as shown in Fig. 7. In practical applications, signals 
obtained from measurement devices  such as sEMG sensors  contain noise in their content. 
Therefore,  three cases were developed by adding Gaussian noise  (ğ’©(ğœ‡,ğœ))  with zero mean  
(ğœ‡=0) and increasing  levels of  standard deviations  (ğœ) to the input  synthetic  sEMG signals  as 
mentioned in  Table 2. As the maximum value of the noiseless  sEMG signals is 1, the chosen ğœ's 
were kept within 10% - 20% of the signal maximum  for a reasonable level of noise . Then the 
corresponding  output  motions are generated by passing the noisy sEMG as input to the FD 
 
23 equations in Section 2.  The following training procedures were performed for each  of the three 
cases.  
1-scale  Training  
The mixed frequency  input sEMG signals  and corresponding output motion data ğ’’ at scale [0] , 
denoted by ğ‘«[0] and ğ’’[0], respectively , are mapped to get a baseline performance. This is termed 
as 1-scale  training as only the full-scale  (i.e., [0]) of the mixed frequency  data is used for training.   
2-scale Training  
a. Initiate  learning from a coarse  scale representation of the mixed frequency  input data at 
scale [âˆ’1] and map ğ‘«[âˆ’1] to the corresponding motion data  at scale [ -1], ğ’’[âˆ’1], of that 
case. 
b. Transfer parameters  to the next scale training and finish the learning by mapping ğ‘«[0] to 
ğ’’[0]. 
3-scale Training  
a. Start learning from a coarse  scale representation of the mixed frequency  input data at scale 
[âˆ’2] and map ğ‘«[âˆ’2] to the corresponding motion data  at scale [ -2] , ğ’’[âˆ’2], of that case .  
b. Transfer parameters  to the next scale training and continue learning by mapping ğ‘«[âˆ’1] to 
ğ’’[âˆ’1]. 
c. Transfer parameters  to the next scale training and finish the learning by mapping ğ‘«[0] to 
ğ’’[0]. 
Table 2: Input data and gaussian noise level for each case.  
Case ID  Input  Synthetic  sEMG data  + ğ’©(ğœ‡,ğœ) 
1 Original + ğ’©(0,0.1) 
2 Original + ğ’©(0,0.15) 
3 Original + ğ’©(0,0.2) 
  
24 For each case  and for each  of the training scale s in that case, the training data samples  contained 
the data of trial â€™s 1, 2, 4, 5 while trial 3  was used for testing, each trial with ğ‘›=500 data points.  
The MSK parameters ğœ={ğ›¤ğ‘™}ğ‘™=14={ğ‘“0,ğµğ‘–ğ‘€,ğ‘™0,ğµğ‘–ğ‘€,ğ‘“0,ğ‘‡ğ‘Ÿğ‘–ğ‘€,ğ‘™0,ğ‘‡ğ‘Ÿğ‘–ğ‘€} were chosen  to be  identified from the 
training data using the proposed framework . Due to differences in  units and physiological nature 
of the parameters, the conditioning of the parameter identification system could be affected. To 
mitigate this issue, normalization [1,44]  was applied to  each of the parameters ,  
 ğ›¤Ì…ğ’=ğ›¤ğ‘™
ğ›¤ğ‘™(0) (37) 
where ğ›¤ğ‘™(0) was the initial value of the parameter. Therefore, the parameters to be identified 
became ğœÌ…={ğ›¤Ì…ğ‘™}ğ‘™=14. 
The proposed  framework, as described in Section  3, was applied to each case to simultaneously 
learn the MSK forward dynamics surrogate and identify the MSK  parameters ğœÌ… by optimiz ing Eq. 
(16), where the residual of the governing equation  for the current time step ğ‘˜, was expresse d as 
 ğ‘Ÿ(ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ì‡ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ìˆğ‘˜[âˆ’ğ‘—](ğœ½ğ’’);ğœ(ğœÌ…;ğœ(0))) 
=ğ¼ğ‘Ì‚Ìˆğ‘˜[âˆ’ğ‘—](ğœ½ğ’’)âˆ’ğ¸(ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’))
âˆ’ğ‘‡ğ‘€ğ‘‡(ğ‘ğµğ‘–(ğ‘¡ğ‘˜),ğ‘ğ‘‡ğ‘Ÿğ‘–(ğ‘¡ğ‘˜),ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ì‡ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’);ğœ(ğœÌ…;ğœ(0)))   
(38) 
 
and is included in the residual term  ğ½ğ‘Ÿğ‘’ğ‘  in the loss function in Eq. (16). While the training happens 
sequentially  from coarse to fine -scales of the motion, the  final identification of parameters happens 
at the scale [0], i.e., the full-scale  in each of the 1 -, 2- and 3 -scale  MR training type s. 
 
A GRU  with 2 history steps, 1 hidden layer and 50 neurons in each layer was used . The training 
was performed using the Adam algorithm  [66] with a n initial  learning rate of 1Ã—10âˆ’3 and the 
penalty parameter for the  MSK residual term in the loss  function , ğ›½âˆÎ”ğ‘¡2
ğ¼=10âˆ’3. Î”ğ‘¡ is the time -
step between data points and ğ¼ is the moment of inertia  in Eq. (38). Multiple parameter 
initialization seeds were used for an averaged response of the MR training.   
25 To compare the  post-training  performance of 1-, 2- and 3-scale MR trainingâ€™s, the average test ing 
mean squared error (MSE) and testing R2 scores were compared , where these measures for a single 
trial are defined as:   
 MSE=1
ğ‘›â€–ğ’’âˆ’ğ’’Ì‚â€–ğ¿22 (39) 
 
 
 R2=1âˆ’âˆ‘(ğ‘ğ‘–âˆ’ğ‘Ì‚ğ‘–)2 ğ‘›
ğ‘–=1
âˆ‘(ğ‘ğ‘–âˆ’ğ‘Ì…)2 ğ‘›
ğ‘–=1 (40) 
 
where ğ’’ is the  motion  data of the trial, ğ’’Ì‚ is the trialâ€™s predicted motion from the MR PI -RNN 
framework, and ğ‘Ì… is the mean of trialâ€™s motion data  with ğ‘› being the number of data points in the 
trial. At each epoch in the MR training,  the training loss  is calculated by using the  scale of the  
training data used in that training scale , i.e., scale [âˆ’ğ‘—] of the data is used in ğ‘—-scale training . 
The gradual im provement in these metrics is evident from Fig. 8 where , as further scales of 
information are added  and the training data is augmented , the generalization performance shows 
improvement from 1 -scale to 3 -scale . Overall,  it is noted that t he test metrics  such as  the MSE 
reduces, and the  R2 score  gets closer to one, indic ating an increase in the generalization accuracy  
as more traini ng scales are introduced . This can  be explained through the  theory of  bias-variance 
tradeoff ; training  on various scales of the data introduces more variance  to the training, helping 
the ML framework to  reduce the bias it develops  by just training on the full-scale  of the data.  
Together, this reduction in bias and growth in variance leads to a better generalization performance. 
Computationally , this method improves accuracy  in the same amount of training epochs  showing 
the efficiency  of this method . As generalization  predictions  post-training  are made using the full-
scale  of the data, there is no increase  in time  needed to perform the forward pass  for any scale .            
Meanwhile, the MSK parameters, ğ‘“0ğ‘€ (maximum isometric force) and ğ‘™0ğ‘€ (optimal muscle length 
corresponding to the maximum isometric force ), of both the biceps and the triceps were accurately 
identified from the motion data, as shown in  Table 3. Compared with the parameter identification  
from our previou s work  [1] where in addition to ğ‘“0ğ‘€, the maximum contraction velocity ğ‘£ğ‘šğ‘ğ‘¥ğ‘€ was 
independently identified , due to non -convergence of ğ‘™0ğ‘€ by the time -domain and feature -encoded  
26 trainings , the proposed method  can accurately identify ğ‘™0ğ‘€. ğ‘£ğ‘šğ‘ğ‘¥ğ‘€ can then by obtain by the 
experiment ally obs erved  relationship of  ğ‘£ğ‘šğ‘ğ‘¥ğ‘€ğ‘™0ğ‘€â„=10ğ‘ âˆ’1 [58,67] . 
For the identification of optimal muscle length parameters (ğ‘™0ğ‘€), the initial points need to be chosen 
with respect to constraints applied by the geometry of the MSK system . The errors reported in 
Table 3 are calculated by taking  the average  of the percentage error  of the identified  MSK  
parameters from the  3-scale training  with the multiple  parameter  (ğœ½,ğœ) initializations . It was 
observed that in MSK parameter identification , similar  accura cy in  characterization was obtained 
from  all training scale approaches  used within each case , with errors less than 1% . This  indicat es 
that the MR PI -RNN i mproves  the generalization performance of the motion prediction , without 
loss in parameter identification accuracy.   
 
Fig. 8:  The training loss and testing metrics  are shown.  The shaded area in the loss  and average 
test MSE and R2 score figures is one standard deviation from the mean (solid line). As more scales 
of data are introduced in the MR training, the average Test MSE and R2 score  calculated post-
training improve in each case.  
 
 
27 Table 3: The average percentage error  (shown as mean Â± standard deviation ) between predicted  
and true values of the parameters  for 3-scale training for each case  from multiple initialization 
points . 
Parameter  Case 1  Case 2  Case 3  
ğ‘“0,ğµğ‘–ğ‘€ 0.50Â±0.02 0.50Â±0.01 0.37Â±0.04 
ğ‘“0,ğ‘‡ğ‘Ÿğ‘–ğ‘€ 0.06Â±0.02 âˆ’0.04Â±0.02 âˆ’0.02Â±0.03 
ğ‘™0,ğµğ‘–ğ‘€ 0.10Â±0.03 0.10Â±0.02 0.05Â±0.05 
ğ‘™0,ğ‘‡ğ‘Ÿğ‘–ğ‘€ âˆ’0.06Â±0.07 âˆ’0.05Â±0.02 âˆ’0.03Â±0.10 
 
5. Validation : Elbow Flexion -Extension Motion  
5.1 Application of MR  PI-RNN  method to Subject -Specific Data  
The recorded motion data  and sEMG  signals were  collected  and processed  as per the data 
acquisition protocols mentioned in  [1]. Three elbow  flexion -extension motion trials were 
performed by the  subject , with the sEMG sensors placed on  the biceps and triceps  muscle groups . 
The processed  sEMG signals were transformed as described in Section  2.1 to obtain muscle 
activation signals , used to calculate the MSK forward dynamics ODE residual . The same  
simplified rigid body model  was used as in Section  4 and appropriately scaled anthropometric 
properties (for the geometry  of the model ) and physiological parameters (for muscle -tendon 
material model s used for the muscle groups ) based on the generic upper body model defined in 
[68,69]  were used . Fig. 9 shows the measured data of the thr ee trials, including the transient raw 
sEMG signals and the corresponding angular motion of the elbow flexion -extension of the subject . 
 
Fig. 9: The measured raw sEMG signa ls and the corresponding angular motion of the elbow 
flexion -extension of the subject  are plotted . 
 
28 In this example, the raw sEMG signals were used as input . A 5-scale  MR training procedure as 
described in Section 4 was used on a GRU with 1 hidden layer with 50 neurons. The data of trials 
1 and 3 were used for training , while trial 2 was used for testing , where  each signal contained 500 
temporal data poi nts.  
5.1.1 Parameter Identification   
The muscle parameters to be identified by the framework include the maximum isometric force 
and the optimal muscle length from both muscle groups, which are denoted as  ğœ=
{ğ‘“0,ğµğ‘–ğ‘€,ğ‘™0,ğµğ‘–ğ‘€,ğ‘“0,ğ‘‡ğ‘Ÿğ‘–ğ‘€,ğ‘™0,ğ‘‡ğ‘Ÿğ‘–ğ‘€}. It was observed  in our tests  that despite  the normalization  process  
described in Eq. (37) and (38), the parameters obtained at the end of the MR training  with motion 
data either diverged or converged to non -physiological values. T o obtain physio logically 
consistent parameters, we use the values obtained from literature studies and constrain the space 
of parameter search  [44]. 
Let the  parameter to be identified be defined as  
 
ğ›¤ğ‘™(ğ)=1
ğ‘âˆ‘ğ›¾Ì…ğ‘Ÿsig(ğœ“ğ‘Ÿ)ğ‘
ğ‘Ÿ=1,ğ=[ğœ“1,ğœ“2,â€¦,ğœ“ğ‘] (41) 
 
where ğ›¾Ì…ğ‘Ÿ is the value defined in  the ğ‘Ÿğ‘¡â„ literature  study and ğœ“ğ‘Ÿ is the parameter to be optimized in 
the training such that it can be used to evaluate the sigmoid  function  sig(ğœ“ğ‘Ÿ) and ğ is the vector 
of these trainable parameters . Using the optimized ğ, the desired MSK parameters can be 
estimated.  This formulation constrains the identified parameters  to be consistent  with parameters 
obtained through experimental studies [68â€“70].      
The proposed  framework was then applied to simul taneously learn the MSK forward dynamics 
surrogate and identify the MSK parameters ğœ by optimiz ing Eq. (16), where the residual of the 
governing equation  for the current time step ğ‘˜, was expresse d as 
 ğ‘Ÿ(ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ì‡ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ìˆğ‘˜[âˆ’ğ‘—](ğœ½ğ’’);ğœ(ğ)) 
=ğ¼ğ‘Ì‚Ìˆğ‘˜[âˆ’ğ‘—](ğœ½ğ’’)âˆ’ğ¸(ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’))âˆ’ğ‘‡ğ‘€ğ‘‡(ğ‘ğµğ‘–(ğ‘¡ğ‘˜),ğ‘ğ‘‡ğ‘Ÿğ‘–(ğ‘¡ğ‘˜),ğ‘Ì‚ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’),ğ‘Ì‚Ì‡ğ‘˜[âˆ’ğ‘—](ğœ½ğ’’);ğœ(ğ))   
(42) 
  
29 and could be plugged into the residual term ğ½ğ‘Ÿğ‘’ğ‘  in the loss function such that the optimization 
problem becomes , 
 ğœ½Ìƒ,ğÌƒ=argmin
ğœ½,ğ(ğ½ğ‘‘ğ‘ğ‘¡ğ‘(ğœ½)+ğ›½ğ½ğ‘Ÿğ‘’ğ‘ (ğœ½,ğ)). (43) 
As mentioned in the verification example  (Section 4) , the final parameter identification happens 
at the full-scale , i.e., at  [0]. 
 
5.2 Results  
The training was performed using the Adam algorithm [66] with an initial learning rate of 
1Ã—10âˆ’3 and 4 history steps were considered . Multiple parameter initialization seeds were used 
for an averaged response of the MR training. To quantify  the err or in th e testing predictions, a 
normalized mean squared error was defined,  
 NMSE=1
ğ‘›âˆ‘(ğ‘ğ‘–âˆ’ğ‘Ì‚ğ‘–)2 ğ‘›
ğ‘–=1
âˆ‘(ğ‘ğ‘–âˆ’ğ‘Ì…)2 ğ‘›
ğ‘–=1 (44) 
 
where ğ‘ğ‘– is the  ğ‘–ğ‘¡â„ target  motion  data point , ğ‘ğ‘–Ì‚ is the ğ‘–ğ‘¡â„ predicted motion data point , from the MR 
PI-RNN framework, and ğ‘Ì… is the mean of target  motion data.  The R2 score was calculated using 
the metric defined in Eq. (40). From  Fig. 10, Fig. 11 and Table 4, it is clear that addition of training 
scales leads to improved motion predictions . The multi-resolution training leads to an increase in 
average  test R2 score  of more than 4 0% (bringing it closer to one ), averaged over multiple 
initialization seeds . With the addition of more scales , Fig. 10 clearly shows the progression in 
improvement of the predictions as more scales are involved in the training.   
  
30  
Fig. 10: Comparison of test predictions post-training for each MR training scale performed.  The 
solid dash line is the mean of the prediction s post -training  when various  initialization points are 
utilized to begin the  MR training , with shaded region indicating one standard deviation from the 
mean. 
 
Fig. 11: The test normalized mean squared error (NMSE)  and test R2 score are plot for the testing 
predictions  post-training , averaged over multiple initialization seeds . The mean of the metric is the 
solid marker line, the sha ded portion being one standard deviation from the mean.  
 
 
 
 
31 Table 4: The t est metrics such as NMSE and R2 score averaged over multiple initialization seeds , 
for the various training scales involved  are reported here . The % decrease in average NMSE and % 
increase in average R2 w.r.t 1 -scale training are shown in the 3rd and 5th columns respectively . 
Training 
Scale  Avg. Test 
NMSE  Decrease (%) in Avg. 
Test NMSE  w.r.t 1 -scale 
Training  Avg. Test ğ‘ğŸ 
Score Increase  (%) in Avg. 
Test ğ‘ğŸ score  w.r.t 1 -
Scale training  
1 8.00E -04 - 0.599  - 
2 5.74E -04 28% 0.713  19% 
3 4.14E -04 48% 0.793  32% 
4 2.33E -04 71% 0.884  47% 
 
The identified MSK parameters from  the MR PI-RNN training are summarized in  Table 5 with 
the mean of the final converged values  of ğ‘“0ğ‘€ and ğ‘™0ğ‘€ obtained from multiple parameter 
initializations  at 4-scale training , consistent with  the physiological estimates of these param eters 
reported in literature [68â€“70]. ğ‘™0,ğµğ‘–ğ‘€ is slightly outside the estimated range, which could be 
attributed to t he variance in population . Similar values were obtained across all scales of training  
hence parameters obtained from a representative 4-scale training are shown here . The results 
demonstrate d the effectiveness of the proposed MR PI -RNN  framework and promising potential 
for real applications.  
Table 5: The identified parameter estimates using MR PI -RNN  training , and their values reported 
in literature [68â€“70]. 
 
Parameter  Identified values  Estimates from 
literature  
ğ‘“0,ğµğ‘–ğ‘€ (N) 348.23Â±0.2 158.4 -845 
ğ‘™0,ğµğ‘–ğ‘€ (m) 0.108Â±0.001 0.115-0.142 
ğ‘“0,ğ‘‡ğ‘Ÿğ‘–ğ‘€ (N) 758.36Â±0.5 554.4-2332.916  
ğ‘™0,ğ‘‡ğ‘Ÿğ‘–ğ‘€ (m) 0.069Â±0.001 0.067 -0.087   
32  
6. Discussion and Conclusion s 
In this work,  we proposed a  multi -resolution physics -informed recurrent neural  network  (MR PI-
RNN ) for an application to MSK systems , for time-domain motion prediction and parameter 
identification . A GRU with a physics -informed loss function that minimized the error in the 
training data and the residual of the MSK forward dynamics equilibrium was used for this purpose. 
Wavelet based multi -resolution techniques were used to decompose the input sEMG signals  and 
output joint motion data  into coarse -scale approximations at different scales and fine -scale details  
at those scales. The  sEMG and joint motion multi -scale components were then mapped to  each 
other  starting from a chosen coarse -scale  components and then sequentially train ed (via transfer 
learning)  to higher scales, completing the training on the full-scale  of the data .    
By initializing training on the coarse -scale of the  training data, the optimization reaches a local 
minim um that serves as a better initialization state for the training data that includes the  sequential  
fine-scale details.  The proposed transfer -learning based sequential training scheme  can be used  for 
learning datasets that have high frequency  signals  as shown in the verification example with 
synthetic  mixed frequency  sEMG data . The numerical examples show an improvement in  testing 
prediction and identifying the parameters . We observe from the loss profiles that the test ing loss 
decrease d while the training loss increased as more scales of data were brought in. It was also 
observed that the average test MSE and R2 metrics showed a clear  improvement in the 
generalization accuracy. These phenomena can be  explain ed through the theory of bias -variance 
tradeoff; training on various scales of the data introduces more variance to the training, helping 
the ML framework to reduce the bias it develops by just training on the full-scale  of the data. 
Computationally , it is noted that the proposed method achieves  improved accuracy by using the 
same amount of training epochs.  
The proposed MR framework was validated on recorded sEMG and motion data  from a subject  [1] 
and significant improvement s were observed in the testing prediction accuracy , with 1 -scale 
training often leading to large errors . The predicted motion at higher training scales showed 
improvements across all initialization points used , indicating the robustness of the method.  The 
ident ified parameters were also consistent with the  physiological range  observed in literature .   
33 This method also has the advantage of operating in the time -domain as compared to the feature -
encoded (FE) trainin g [1], where the input sEMG signals were projected on to the frequency 
domain using the Fourier basis. In the FE training, to make a prediction, the input signal for the 
entire duration of the movement  prediction  was needed whereas  the physics informed MR training  
of the RNN enables the trained model to make  real-time predictions by using the information of 
the previous time -steps  and the current sEMG signal . In addition, for mixed frequency signals, 
wavelet resolution can better capture  the local frequenc y information as compared to the Fourier 
basis which captures the global frequency information.   
This method is presented as a general  case where multi -resolution is applied to both input and 
output . For some applications , for e.g., those  that require only data mapping, the MR training can 
be applied by only considering the decomposition to the input , keeping the output at the full -scale 
(i.e., scale [0]) throughout , or vice versa . To further improve this method , we can consider the use 
of multi -resolution as activation functions of the ML framework, instead of relying on data 
filtration processes  for better computational efficiency . This method will also be tested on other  
physics -informed ML techniques to solve forward problems with  PDEs having  mixed frequency 
source terms .  
 
7. Acknowledgment   
The support of this work by the National Institute of Health under grant number 5R01AG056999 -
04 to K. Taneja & J. S. Chen are very much appreciated.  
 
8. References  
[1] Taneja, K., He, X., He, Q., Zhao, X., Lin, Y. -A., Loh, K. J., and Chen, J. -S., 2022, â€œA 
Feature -Encoded Physics -Informed Parameter Identification Neural Network for 
Musculoskeletal Systems,â€ J. Biomech. Eng., 144(12).  
[2] Costello, Z., and Martin, H. G., 2 018, â€œA Machine Learning Approach to Predict Metabolic 
Pathway Dynamics from Time -Series Multiomics Data,â€ npj Syst Biol Appl, 4(1), pp. 1 â€“
14. 
[3] Damle, C., and Yalcin, A., 2007, â€œFlood Prediction Using Time Series Data Mining,â€ 
Journal of Hydrology, 333(2), pp. 305 â€“316.  
34 [4] Nishino, T., and Hokugo, A., 2020, â€œA Stochastic Model for Time Series Prediction of the 
Number of Post -Earthquake Fire Ignitions in Buildings Based on the Ignition Record for 
the 2011 Tohoku Earthquake,â€ Earthquake Spectra, 36(1), pp.  232â€“249. 
[5] Manevitz, L., Bitar, A., and Givoli, D., 2005, â€œNeural Network Time Series Forecasting of 
Finite -Element Mesh Adaptation,â€ Neurocomputing, 63, pp. 447 â€“463. 
[6] Frank, R. J., Davey, N., and Hunt, S. P., â€œTime Series Prediction and Neural Netwo rks.â€  
[7] LÃ¤ngkvist, M., Karlsson, L., and Loutfi, A., 2014, â€œA Review of Unsupervised Feature 
Learning and Deep Learning for Time -Series Modeling,â€ Pattern Recognition Letters, 42, 
pp. 11 â€“24. 
[8] CalderÃ³n -MacÃ­as, C., Sen, M. K., and Stoffa, P. L., 2000, â€œ Artificial Neural Networks for 
Parameter Estimation in Geophysics,â€ Geophysical Prospecting, 48(1), pp. 21 â€“47. 
[9] Hubbard, S. S., and Rubin, Y., 2000, â€œHydrogeological Parameter Estimation Using 
Geophysical Data: A Review of Selected Techniques,â€ Journal of Contaminant Hydrology, 
45(1), pp. 3 â€“34. 
[10] Ebrahimian, H., Astroza, R., and Conte, J. P., 2015, â€œExtended Kalman Filter for Material 
Parameter Estimation in Nonlinear Structural Finite Element Models Using Direct 
Differentiation Method,â€ Earthquake En gineering & Structural Dynamics, 44(10), pp. 
1495 â€“1522.  
[11] Haghighat, E., Raissi, M., Moure, A., Gomez, H., and Juanes, R., 2021, â€œA Physics -
Informed Deep Learning Framework for Inversion and Surrogate Modeling in Solid 
Mechanics,â€ Comput. Methods Appl. Mech. Eng., 379, p. 113741.  
[12] Heine, C. B., and Menegaldo, L. L., 2018, â€œNumerical Validation of a Subject -Specific 
Parameter Identification Approach of a Quadriceps Femoris EMG -Driven Model,â€ Medical 
Engineering & Physics, 53, pp. 66 â€“74. 
[13] Hirschvog el, M., Bassilious, M., Jagschies, L., Wildhirt, S. M., and Gee, M. W., 2017, â€œA 
Monolithic 3D -0D Coupled Closed -Loop Model of the Heart and the Vascular System: 
Experiment -Based Parameter Estimation for Patient -Specific Cardiac Mechanics,â€ 
International J ournal for Numerical Methods in Biomedical Engineering, 33(8), p. e2842.  
[14] Schmid, H., Nash, M. P., Young, A. A., and Hunter, P. J., 2006, â€œMyocardial Material 
Parameter Estimation â€”A Comparative Study for Simple Shear,â€ Journal of Biomechanical 
Engineer ing, 128(5), pp. 742 â€“750. 
[15] Pau, J. W. L., Xie, S. S. Q., and Pullan, A. J., 2012, â€œNeuromuscular Interfacing: 
Establishing an EMG -Driven Model for the Human Elbow Joint,â€ IEEE Trans. Biomed. 
Eng., 59(9), pp. 2586 â€“2593.  
[16] Zhao, Y., Zhang, Z., Li, Z.,  Yang, Z., Dehghani -Sanij, A. A., and Xie, S., 2020, â€œAn EMG -
Driven Musculoskeletal Model for Estimating Continuous Wrist Motion,â€ IEEE Trans. 
Neural Syst. Rehabil. Eng., 28(12), pp. 3113 â€“3120.  
[17] Kian, A., Pizzolato, C., Halaki, M., Ginn, K., Lloyd, D.,  Reed, D., and Ackland, D., 2019, 
â€œStatic Optimization Underestimates Antagonist Muscle Activity at the Glenohumeral 
Joint: A Musculoskeletal Modeling Study,â€ J. Biomech., 97, p. 109348.  
[18] Buchanan, T. S., Lloyd, D. G., Manal, K., and Besier, T. F., 200 4, â€œNeuromusculoskeletal 
Modeling: Estimation of Muscle Forces and Joint Moments and Movements from 
Measurements of Neural Command,â€ J. Appl. Biomech., 20(4), pp. 367 â€“395. 
[19] Lloyd, D. G., and Besier, T. F., 2003, â€œAn EMG -Driven Musculoskeletal Model to 
Estimate Muscle Forces and Knee Joint Moments in Vivo,â€ J. Biomech., 36(6), pp. 765 â€“
776.  
35 [20] Buongiorno, D., Barsotti, M., Barone, F., Bevilacqua, V., and Frisoli, A., 2018, â€œA Linear 
Approach to Optimize an EMG -Driven Neuromusculoskeletal Model for Movem ent 
Intention Detection in Myo -Control: A Case Study on Shoulder and Elbow Joints,â€ Front. 
Neurorobot., 12, p. 74.  
[21] Goodfellow, I., Bengio, Y., and Courville, A., 2016, Deep Learning , MIT Press, 
Cambridge, MA, USA.  
[22] Kaneko, S., Wei, H., He, Q., Che n, J.-S., and Yoshimura, S., 2021, â€œA Hyper -Reduction 
Computational Method for Accelerated Modeling of Thermal Cycling -Induced Plastic 
Deformations,â€ J. Mech. Phys. Solids, 151, p. 104385.  
[23] Kim, B., Azevedo, V. C., Thuerey, N., Kim, T., Gross, M., and Solenthaler, B., 2019, 
â€œDeep Fluids: A Generative Network for Parameterized Fluid Simulations,â€ Comput. 
Graph. Forum, 38(2), pp. 59 â€“70. 
[24] Xie, X., Zhang, G., and Webster, C., 2019, â€œNon -Intrusive Inference Reduced Order Model 
for Fluids Using Deep Multi step Neural Network,â€ Mathematics, 7(8), p. 757.  
[25] Fries, W., He, X., and Choi, Y., 2022, â€œLaSDI: Parametric Latent Space Dynamics 
Identification,â€ arXiv:2203.02076 [cs, math].  
[26] He, X., Choi, Y., Fries, W. D., Belof, J., and Chen, J. -S., 2022, â€œGLaS DI: Parametric 
Physics -Informed Greedy Latent Space Dynamics Identification,â€ arXiv:2204.12005 
[physics].  
[27] Ghaboussi , J., Garrett, J. H., and Wu, X., 1991, â€œKnowledgeâ€Based Modeling of Material 
Behavior with Neural Networks,â€ J. Eng. Mech. - ASCE, 117(1), pp. 132 â€“153. 
[28] Lefik, M., Boso, D. P., and Schrefler, B. A., 2009, â€œArtificial Neural Networks in 
Numerical Model ling of Composites,â€ Comput. Methods Appl. Mech. Eng., 198(21), pp. 
1785 â€“1804.  
[29] He, X., and Chen, J. -S., 2022, â€œThermodynamically Consistent Machine -Learned Internal 
State Variable Approach for Data -Driven Modeling of Path -Dependent Materials,â€ 
Comput.  Methods Appl. Mech. Eng., 402, p. 115348.  
[30] Kirchdoerfer, T., and Ortiz, M., 2017, â€œData Driven Computing with Noisy Material Data 
Sets,â€ Comput. Methods Appl. Mech. Eng., 326, pp. 622 â€“641. 
[31] Eggersmann, R., Kirchdoerfer, T., Reese, S., Stainier, L. , and Ortiz, M., 2019, â€œModel -Free 
Data -Driven Inelasticity,â€ Comput. Methods Appl. Mech. Eng., 350, pp. 81 â€“99. 
[32] He, Q., and Chen, J. -S., 2020, â€œA Physics -Constrained Data -Driven Approach Based on 
Locally Convex Reconstruction for Noisy Database,â€ Comp ut. Methods Appl. Mech. Eng., 
363, p. 112791.  
[33] He, X., He, Q., Chen, J. -S., Sinha, U., and Sinha, S., 2020, â€œPhysics -Constrained Local 
Convexity Data -Driven Modeling of Anisotropic Nonlinear Elastic Solids,â€ DCE, 1, p. e19.  
[34] He, Q., Laurence, D. W. , Lee, C. -H., and Chen, J. -S., 2021, â€œManifold Learning Based 
Data -Driven Modeling for Soft Biological Tissues,â€ J. Biomech., 117, p. 110124.  
[35] Bahmani, B., and Sun, W., 2022, â€œManifold Embedding Data -Driven Mechanics,â€ J. Mech. 
Phys. Solids, 166, p. 10 4927.  
[36] Carrara, P., De Lorenzis, L., Stainier, L., and Ortiz, M., 2020, â€œData -Driven Fracture 
Mechanics,â€ Comput. Methods Appl. Mech. Eng., 372, p. 113390.  
[37] He, X., He, Q., and Chen, J. -S., 2021, â€œDeep Autoencoders for Physics -Constrained Data -
Driven Nonlinear Materials Modeling,â€ Comput. Methods Appl. Mech. Eng., 385, p. 
114034.   
36 [38] Raissi, M., Perdikaris, P., and Karniadakis, G. E., 2019, â€œPhysics -Informed Neural 
Networks: A Deep Learning Framework for Solving Forward and Inverse Problems 
Involvi ng Nonlinear Partial Differential Equations,â€ J. Comput. Phys., 378, pp. 686 â€“707. 
[39] Karniadakis, G. E., Kevrekidis, I. G., Lu, L., Perdikaris, P., Wang, S., and Yang, L., 2021, 
â€œPhysics -Informed Machine Learning,â€ Nat. Rev. Phys., 3(6), pp. 422 â€“440. 
[40] He, Q., and Tartakovsky, A. M., 2021, â€œPhysicsâ€Informed Neural Network Method for 
Forward and Backward Advectionâ€Dispersion Equations,â€ Water Resour. Res., 57(7). 
[41] Zhu, Q., Liu, Z., and Yan, J., 2021, â€œMachine Learning for Metal Additive Manufacturing: 
Predicting Temperature and Melt Pool Fluid Dynamics Using Physics -Informed Neural 
Networks,â€ Comput. Mech., 67(2), pp. 619 â€“635. 
[42] Xu, K., Tartakovsky, A. M., Burgha rdt, J., and Darve, E., 2021, â€œLearning Viscoelasticity 
Models from Indirect Data Using Deep Neural Networks,â€ Comput. Methods Appl. Mech. 
Eng., 387, p. 114124.  
[43] Tartakovsky, A. M., Marrero, C. O., Perdikaris, P., Tartakovsky, G. D., and Barajas -Solano , 
D., 2020, â€œPhysics -Informed Deep Neural Networks for Learning Parameters and 
Constitutive Relationships in Subsurface Flow Problems,â€ Water Resour. Res., 56(5), p. 
e2019WR026731.  
[44] He, Q., Stinis, P., and Tartakovsky, A. M., 2022, â€œPhysics -Constrained  Deep Neural 
Network Method for Estimating Parameters in a Redox Flow Battery,â€ J. Power Sources, 
528, p. 231147.  
[45] He, Q., Barajas -Solano, D., Tartakovsky, G., and Tartakovsky, A. M., 2020, â€œPhysics -
Informed Neural Networks for Multiphysics Data Assimi lation with Application to 
Subsurface Transport,â€ Adv. Water Resour., 141, p. 103610.  
[46] Kissas, G., Yang, Y., Hwuang, E., Witschey, W. R., Detre, J. A., and Perdikaris, P., 2020, 
â€œMachine Learning in Cardiovascular Flows Modeling: Predicting Arterial Bl ood Pressure 
from Non -Invasive 4D Flow MRI Data Using Physics -Informed Neural Networks,â€ 
Comput. Methods Appl. Mech. Eng., 358, p. 112623.  
[47] Sahli Costabal, F., Yang, Y., Perdikaris, P., Hurtado, D. E., and Kuhl, E., 2020, â€œPhysics -
Informed Neural Netwo rks for Cardiac Activation Mapping,â€ Front. Phys., 8. 
[48] Alber, M., Buganza Tepole, A., Cannon, W. R., De, S., Dura -Bernal, S., Garikipati, K., 
Karniadakis, G., Lytton, W. W., Perdikaris, P., Petzold, L., and Kuhl, E., 2019, â€œIntegrating 
Machine Learning  and Multiscale Modeling â€”Perspectives, Challenges, and Opportunities 
in the Biological, Biomedical, and Behavioral Sciences,â€ npj Digit. Med., 2(1), pp. 1 â€“11. 
[49] Yazdani, A., Lu, L., Raissi, M., and Karniadakis, G. E., 2020, â€œSystems Biology Informed 
Deep Learning for Inferring Parameters and Hidden Dynamics,â€ PLOS Comput. Biol., 
16(11), p. e1007575.  
[50] Zhang, J., Zhao, Y., Bao, T., Li, Z., Qian, K., Frangi, A. F., Xie, S. Q., and Zhang, Z. -Q., 
2022, â€œBoosting Personalised Musculoskeletal Modelling with  Physics -Informed 
Knowledge Transfer,â€ arXiv:2211.12315.[eess.SP].  
[51] Bartsoen, L., Faes, M. G. R., Andersen, M. S., Wirix -Speetjens, R., Moens, D., Jonkers, I., 
and Sloten, J. V., 2023, â€œBayesian Parameter Estimation of Ligament Properties Based on 
Tibio-Femoral Kinematics during Squatting,â€ Mech. Syst. Signal Process., 182, p. 109525.  
[52] Linden, N. J., Kramer, B., and Rangamani, P., 2022, Bayesian Parameter Estimation for 
Dynamical Models in Systems Biology , Systems Biology.  
[53] Chung, J., Gulcehre, C., Cho, K., and Bengio, Y., 2014, â€œEmpirical Evaluation of Gated 
Recurrent Neural Networks on Sequence Modeling.â€   
37 [54] Lipton, Z. C., Berkowitz, J., and Elkan, C., 2015, â€œA Critical Review of Recurrent Neural 
Networks for Sequence Learning,â€ arXiv:1506.00 019 [cs].  
[55] Hamner, S. R., Seth, A., and Delp, S. L., 2010, â€œMuscle Contributions to Propulsion and 
Support during Running,â€ J Biomech, 43(14), pp. 2709 â€“2716.  
[56] Zhang, Y., Chen, J., He, Q., He, X., Basava, R. R., Hodgson, J., Sinha, U., and Sinha, S., 
2020, â€œMicrostructural Analysis of Skeletal Muscle Force Generation during Aging,â€ Int. J. 
Numer. Methods Biomed. Eng., 36(1). 
[57] Chen, J. -S., Basava, R. R., Zhang , Y., Csapo, R., Malis, V., Sinha, U., Hodgson, J., and 
Sinha, S., 2016, â€œPixel -Based Meshfree Modelling of Skeletal Muscles,â€ Comput. Methods 
Biomech. Biomed. Eng. Imaging Vis., 4(2), pp. 73 â€“85. 
[58] Millard, M., Uchida, T., Seth, A., and Delp, S. L., 201 3, â€œFlexing Computational Muscle: 
Modeling and Simulation of Musculotendon Dynamics,â€ J. Biomech. Eng., 135(2), p. 
021005.  
[59] Winters, J. M., 1990, â€œHill -Based Muscle Models: A Systems Engineering Perspective,â€ 
Multiple Muscle Systems , Springer New York,  New York, NY, pp. 69 â€“93. 
[60] Mallat, S. G., 1989, â€œMultiresolution Approximations and Wavelet Orthonormal Bases of L 
2 (R),â€ Trans. Am. Math. Soc., 315(1), p. 69.  
[61] Mallat, S. G., 1989, â€œA Theory for Multiresolution Signal Decomposition: The Wavelet 
Representation,â€ IEEE Trans. Pattern Anal. Mach. Intell., 11(7), pp. 674 â€“693. 
[62] Cho, K., van Merrienboer, B., Bahdanau, D., and Bengio, Y., 2014, â€œOn the Properties of 
Neural Machine Translation: Encoder -Decoder Approaches.â€  
[63] Baydin, A. G., Pearlmutt er, B. A., Radul, A. A., and Siskind, J. M., 2018, â€œAutomatic 
Diï¬€erentiation in Machine Learning: A Survey,â€ J. Mach. Learn. Res., 18, p. 43.  
[64] Yao, Y., Rosasco, L., and Caponnetto, A., 2007, â€œOn Early Stopping in Gradient Descent 
Learning,â€ Constr Appr ox, 26(2), pp. 289 â€“315. 
[65] Weiss, K., Khoshgoftaar, T. M., and Wang, D., 2016, â€œA Survey of Transfer Learning,â€ J. 
Big Data, 3(1), p. 9.  
[66] Kingma, D. P., and Ba, J., 2017, â€œAdam: A Method for Stochastic Optimization,â€ 
arXiv:1412.6980 [cs].  
[67] Thelen , D. G., 2003, â€œAdjustment of Muscle Mechanics Model Parameters to Simulate 
Dynamic Contractions in Older Adults,â€ J. Biomech. Eng., 125(1), pp. 70 â€“77. 
[68] Garner, B. A., and Pandy, M. G., 2003, â€œEstimation of Musculotendon Properties in the 
Human Upper L imb,â€ Ann. Biomed. Eng., 31(2), pp. 207 â€“220. 
[69] Holzbaur, K. R. S., Murray, W. M., and Delp, S. L., 2005, â€œA Model of the Upper 
Extremity for Simulating Musculoskeletal Surgery and Analyzing Neuromuscular Control,â€ 
Ann. Biomed. Eng., 33(6), pp. 829 â€“840. 
[70] An, K. N., Hui, F. C., Morrey, B. F., Linscheid, R. L., and Chao, E. Y., 1981, â€œMuscles 
across the Elbow Joint: A Biomechanical Analysis,â€ J. Biomech., 14(10), pp. 659 â€“669. 
 
Appendix A: Muscle -Tendon  Force Generation  
The total muscle force ğ¹ğ‘€ can b e expressed as  
 ğ¹ğ‘€(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€;ğœ¿)=ğ‘“0ğ‘€(ğ‘“ğ´(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€;ğœ¿)+ğ‘“ğ‘ƒ(ğ‘™Ìƒğ‘€;ğœ¿)), (45)  
38 where ğ‘“ğ‘ƒ(ğ‘™Ìƒğ‘€) is the passive muscle length dependent force generation function.  The active force 
ğ‘“ğ´ component can be expressed as : 
 ğ‘“ğ´(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€;ğœ¿)=ğ‘ğ‘“ğ´,ğ¿(ğ‘™Ìƒğ‘€;ğœ¿)ğ‘“ğ‘‰(ğ‘£Ìƒğ‘€;ğœ¿), 
ğ‘™Ìƒğ‘€=ğ‘™ğ‘€ğ‘™0ğ‘€â„,  
ğ‘£Ìƒğ‘€=ğ‘£ğ‘€ğ‘£ğ‘šğ‘ğ‘¥ğ‘€â„ , (46) 
where ğ‘ is the activation function in  Eq. (2), ğ‘™Ìƒğ‘€ is the normalized muscle length , ğ‘£Ìƒğ‘€ is the 
normalized velocity of  the muscle . The total length of the MT system ğ‘™ğ‘€ğ‘‡ is given by , 
 ğ‘™ğ‘€ğ‘‡=ğ‘™ğ‘€cosğœ™+ğ‘™ğ‘‡. (47) 
Given the current joint angle ğ‘ and the angular velocity ğ‘Ì‡, the current length, ğ‘™ğ‘€ğ‘‡ of the MT 
system can be calculated using trigonometric relations.  
The ğ‘“ğ´,ğ¿(ğ‘™Ìƒğ‘€) and ğ‘“ğ‘‰(ğ‘£Ìƒğ‘€)  are generic function s of the  length and velocity dependent  force 
generation  properties of the  active  muscle , represented by dimensionless quantities . In this study, 
the tendon is assumed to be rigid (ğ‘™ğ‘‡=ğ‘™ğ‘ ğ‘‡). The total force produced by the MT complex, ğ¹ğ‘€ğ‘‡, 
can be expressed as :  
 ğ¹ğ‘€ğ‘‡(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€,ğœ™;ğœ¿)=ğ¹ğ‘€(ğ‘,ğ‘™Ìƒğ‘€,ğ‘£Ìƒğ‘€;ğœ¿)cosğœ™. (48) 
The rigid -tendon model simplifies the MT contraction dynamics [57,58]  which accounts for the 
interaction of the activation, force length , and force velocity properties of the MT complex.  
Appendix B. Hill -Type Muscle Models   
For the length dependent muscl e force relations, this work uses the equations given in [56]. The 
active muscle force dependent on variation in length is given as  
 
ğ‘“ğ´,ğ¿(ğ‘™Ìƒğ‘€)=
{  9(ğ‘™Ìƒğ‘€âˆ’0.4)2,ğ‘™Ìƒğ‘€â‰¤0.6
1âˆ’4(1âˆ’ğ‘™Ìƒğ‘€)2,0.6â‰¤ğ‘™Ìƒğ‘€â‰¤1.4 
9(ğ‘™Ìƒğ‘€âˆ’1.6)2,ğ‘™Ìƒğ‘€>1.4 (49)  
39  ğ‘“ğ‘ƒ(ğ‘™Ìƒğ‘€)
={0,ğ‘™Ìƒğ‘€â‰¤1
ğ›¾1(exp(ğ›¾2(ğ‘™Ìƒğ‘€âˆ’1))âˆ’1),1â‰¤ğ‘™Ìƒğ‘€â‰¤1.4 
(ğ›¾1ğ›¾2exp(0.4ğ›¾2))ğ‘™Ìƒğ‘€+ğ›¾1((1âˆ’1.4ğ›¾2)exp(0.4ğ›¾2)âˆ’1),ğ‘™Ìƒğ‘€>1.4 (50) 
Where ğ›¾1=0.075 and ğ›¾2=6.6 correspond to parameters in the passive muscle force model 
related to an adult human. The muscle force velocity relationship ğ‘“ğ‘‰(ğ‘£Ìƒğ‘€) is used directly from 
[67]. 
Appendix C: Multi -Resolution GRU Formulation  
For multi -resolution GRU, the initial learning starts from the coarsest scale [âˆ’ğ‘—] as follows  with 
notations according to Section 3.3.2 , 
 
ğ’“ğ‘–[âˆ’ğ‘—]=ğ‘ğœ(ğ‘¾â„ğ‘Ÿ[âˆ’ğ‘—]ğ’‰ğ‘–âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥ğ‘Ÿ[âˆ’ğ‘—]ğ’™ğ‘–[âˆ’ğ‘—]+ğ‘¾ğ‘ğ‘Ÿ[âˆ’ğ‘—]ğ’’ğ‘–[âˆ’ğ‘—]+ğ’ƒğ‘Ÿ[âˆ’ğ‘—])
ğ’–ğ‘–[âˆ’ğ‘—]=ğ‘ğœ(ğ‘¾â„ğ‘¢[âˆ’ğ‘—]ğ’‰ğ‘–âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥ğ‘¢[âˆ’ğ‘—]ğ’™ğ‘–[âˆ’ğ‘—]+ğ‘¾ğ‘ğ‘¢[âˆ’ğ‘—]ğ’’ğ‘–[âˆ’ğ‘—]+ğ’ƒğ‘¢[âˆ’ğ‘—])
ğ’‰Ìƒğ‘–[âˆ’ğ‘—]=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ’“ğ‘–[âˆ’ğ‘—]âŠ™ğ‘¾â„â„Ìƒ[âˆ’ğ‘—]ğ’‰ğ‘–âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥â„Ìƒ[âˆ’ğ‘—]ğ’™ğ‘–[âˆ’ğ‘—]+ğ‘¾ğ‘â„Ìƒ[âˆ’ğ‘—]ğ’’ğ‘–[âˆ’ğ‘—]+ğ’ƒâ„Ìƒ[âˆ’ğ‘—])
ğ’‰ğ‘–[âˆ’ğ‘—]=ğ’–ğ‘–[âˆ’ğ‘—]âŠ™ğ’‰ğ‘–âˆ’1[âˆ’ğ‘—]+(ğŸâˆ’ğ’–ğ‘–[âˆ’ğ‘—])âŠ™ğ’‰Ìƒğ‘–[âˆ’ğ‘—]+ğ’ƒâ„[âˆ’ğ‘—] 
âˆ€ ğ‘–=ğ‘›âˆ’ğ‘š,â€¦,ğ‘›âˆ’1, (51) 
 
ğ’“ğ‘›[âˆ’ğ‘—]=ğ‘ğœ(ğ‘¾â„ğ‘Ÿ[âˆ’ğ‘—]ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥ğ‘Ÿ[âˆ’ğ‘—]ğ’™ğ‘›[âˆ’ğ‘—]+ğ’ƒğ‘Ÿ[âˆ’ğ‘—])
ğ’–ğ‘›[âˆ’ğ‘—]=ğ‘ğœ(ğ‘¾â„ğ‘¢[âˆ’ğ‘—]ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥ğ‘¢[âˆ’ğ‘—]ğ’™ğ‘›[âˆ’ğ‘—]+ğ’ƒğ‘¢[âˆ’ğ‘—])
ğ’‰Ìƒğ‘›[âˆ’ğ‘—]=ğ‘ğ‘¡ğ‘ğ‘›â„(ğ’“ğ‘›[âˆ’ğ‘—]âŠ™ğ‘¾â„â„Ìƒ[âˆ’ğ‘—]ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+ğ‘¾ğ‘¥â„Ìƒ[âˆ’ğ‘—]ğ’™ğ‘›[âˆ’ğ‘—]+ğ’ƒâ„Ìƒ[âˆ’ğ‘—])
ğ’‰ğ‘›[âˆ’ğ‘—]=ğ’–ğ‘›[âˆ’ğ‘—]âŠ™ğ’‰ğ‘›âˆ’1[âˆ’ğ‘—]+(ğŸâˆ’ğ’–ğ‘›[âˆ’ğ‘—])âŠ™ğ’‰Ìƒğ‘›[âˆ’ğ‘—] +ğ’ƒâ„[âˆ’ğ‘—]  (52) 
 ğ’’Ì‚ğ‘›[âˆ’ğ‘—]=ğ‘¾â„ğ‘Ì‚[âˆ’ğ‘—]ğ’‰ğ‘›[âˆ’ğ‘—]+ğ’ƒğ‘[âˆ’ğ‘—] (53) 
where  the weights  ğ‘¾â„ğ‘Ÿ[âˆ’ğ‘—],ğ‘¾ğ‘¥ğ‘Ÿ[âˆ’ğ‘—],ğ‘¾ğ‘ğ‘Ÿ[âˆ’ğ‘—],ğ‘¾â„ğ‘¢[âˆ’ğ‘—],ğ‘¾ğ‘¥ğ‘¢[âˆ’ğ‘—],ğ‘¾ğ‘ğ‘¢[âˆ’ğ‘—],ğ‘¾â„â„Ìƒ[âˆ’ğ‘—],ğ‘¾ğ‘¥â„Ìƒ[âˆ’ğ‘—],ğ‘¾ğ‘â„Ìƒ[âˆ’ğ‘—] and biases 
ğ’ƒğ‘Ÿ[âˆ’ğ‘—],ğ’ƒğ‘¢[âˆ’ğ‘—],ğ’ƒâ„Ìƒ[âˆ’ğ‘—],ğ’ƒâ„[âˆ’ğ‘—],ğ’ƒğ‘[âˆ’ğ‘—] are trainable parameters.   
40 Appendix D: Equation of Motion of the Simplified MSK Model  
The equation of motion for th e rigid body system  used in Section 4 is, 
 ğ¼ğ‘Ìˆ=ğ¸(ğ‘)+ğ‘‡ğ‘€ğ‘‡(ğ‘ğµğ‘–,ğ‘ğ‘‡ğ‘Ÿğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğµğ‘–,ğœ¿ğ‘‡ğ‘Ÿğ‘–) 
 (54) 
where,  
  ğ¼=ğ‘šğ‘“ğ‘ğ‘™ğ‘“ğ‘2 
 (55) 
 ğ¸(ğ‘)=âˆ’ğ‘šğ‘“ğ‘ğ‘”ğ‘™ğ‘“ğ‘sin(ğ‘) 
 (56) 
 ğ‘‡ğ‘€ğ‘‡(ğ‘ğµğ‘–,ğ‘ğ‘‡ğ‘Ÿğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğµğ‘–,ğœ¿ğ‘‡ğ‘Ÿğ‘–)=ğ‘‡ğµğ‘–ğ‘€ğ‘‡(ğ‘ğµğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğµğ‘–)âˆ’ğ‘‡ğ‘‡ğ‘Ÿğ‘–ğ‘€ğ‘‡(ğ‘ğ‘‡ğ‘Ÿğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğ‘‡ğ‘Ÿğ‘–) (57) 
 
ğ‘‡ğµğ‘–ğ‘€ğ‘‡(ğ‘ğµğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğµğ‘–)=ğ¹ğµğ‘–ğ‘€ğ‘‡(ğ‘ğµğ‘–,ğ‘™Ìƒğµğ‘–ğ‘€,ğ‘£Ìƒğµğ‘–ğ‘€,ğ‘™Ìƒğµğ‘–ğ‘‡;ğœ¿ğµğ‘–)ğ‘™2,ğµğ‘–sin(ğ‘)ğ‘™1,ğµğ‘–
ğ‘™ğµğ‘–ğ‘€ğ‘‡(ğ‘) (58) 
 
ğ‘‡ğ‘‡ğ‘Ÿğ‘–ğ‘€ğ‘‡(ğ‘ğ‘‡ğ‘Ÿğ‘–,ğ‘,ğ‘Ì‡;ğœ¿ğ‘‡ğ‘Ÿğ‘–)=ğ¹ğ‘‡ğ‘Ÿğ‘–ğ‘€ğ‘‡(ğ‘ğ‘‡ğ‘Ÿğ‘–,ğ‘™Ìƒğ‘‡ğ‘Ÿğ‘–ğ‘€,ğ‘£Ìƒğ‘‡ğ‘Ÿğ‘–ğ‘€,ğ‘™Ìƒğ‘‡ğ‘Ÿğ‘–ğ‘‡;ğœ¿ğ‘‡ğ‘Ÿğ‘–)ğ‘™2,ğ‘‡ğ‘Ÿğ‘–sin(ğ‘)ğ‘™1,ğ‘‡ğ‘Ÿğ‘–
ğ‘™ğ‘‡ğ‘Ÿğ‘–ğ‘€ğ‘‡(ğ‘). (59) 
 
 
 