arXiv:2301.06232v1  [quant-ph]  16 Jan 2023Optimal/Nearly-optimal simulation of multi-periodic tim e-dependent Hamiltonians
Kaoru Mizuta1,∗
1RIKEN Center for Quantum Computing (RQC), Hirosawa 2-1, Wak o, Saitama 351-0198, Japan
(Dated: January 18, 2023)
Simulating Hamiltonian dynamics is one of the most fundamen tal and signiﬁcant tasks for charac-
terising quantum materials. Recently, a series of quantum a lgorithms employing block-encoding of
Hamiltonians have succeeded in providing eﬃcient simulati on of time-evolution operators on quan-
tum computers. While time-independent Hamiltonians can be simulated by the quantum eigenvalue
transformation (QET) or quantum singularvalue transforma tion with the optimal query complex-
ity in time tand desirable accuracy ε, generic time-dependent Hamiltonians face at larger query
complexity and more complicated oracles due to the diﬃculty of handling time-dependency. In this
paper, we establish a QET-based approach for simulating tim e-dependent Hamiltonians with multi-
ple time-periodicity. Such time-dependent Hamiltonians i nvolve a variety of nonequilibrium systems
such as time-periodic systems (Floquet systems) and time-q uasiperiodic systems. Overcoming the
diﬃculty of time-dependency, our protocol can simulate the dynamics under multi-periodic time-
dependent Hamiltonians with optimal/nearly-optimal quer y complexity both in time tand desirable
accuracy ε, and simple oracles as well as the optimal algorithm for time -independent cases.
I. INTRODUCTION
Hamiltonian simulation, that is, constructing time-
evolution operators by a set of elementary quantum
gates, is one of the most important tasks of quantum
computers [1]. For instance, it can be exploited for re-
producing the solution of Schr¨ odinger equation [2–4] or
identifying energy eigenvalues and eigenstates by quan-
tum phase estimation algorithms [5–9], both of which
areclassicallyhardbut signiﬁcantproblems in condensed
matter physics and quantum chemistry. Therefore, accu-
rate and eﬃcient Hamiltonian simulation has been the
central issue in quantum computation, addressed by var-
ious strategies, such as Trotterization [10–13], and vari-
ational quantum compling [14–16].
Recently, the so-called qubitization technique [17] has
become one of the most promising protocols for simu-
lating large-scale Hamiltonians, which can achieve high
accuracy with much smaller cost than the standard way
Trotterization. Based on quantum eigenvalue transfor-
mation (QET) or quantum singular value transforma-
tion (QSVT) [18, 19], it organizes the time-evolution
U(t) =e−iHtunder time-independent Hamiltonians
Hwith some ancillary qubits and queries to a block-
encoding. Signiﬁcantly, it works with the theoretically-
best query complexity both in time tand acceptable er-
rorε[20, 21]. However, when it comes to time-dependent
Hamiltonians H(t), we suﬀer from the diﬃculty of time-
dependency as the time-evolution becomes
U(t) =Texp/parenleftbigg
−i/integraldisplayt
0dt′H(t′)/parenrightbigg
. (1)
We cannot generally use QET or QSVT which are only
valid for one-variable functions of H, and implementing
∗kaoru.mizuta@riken.jpthe time-ordered integration is not straightforward. Al-
thoughthe truncated-Dyson-seriesalgorithm[22,23] and
others[24–27]dealwiththistaskbydiscretizingthetime,
we need complicated oracles, larger query complexity,
and largerancilla systems comparedto time-independent
cases. As far as we know, QET-based approaches for
simulating time-dependent systems as eﬃciently as time-
independent systems have been limited to time-periodic
Hamiltonians such that H(t+T) =H(t) with some pe-
riodT[28]. It is therefore important to explore what
kind of time-dependent Hamiltonians can be simulated
as eﬃciently as time-independent systems by explicitly
constructing algorithms.
In this paper, we formulate an eﬃcient QET-based
approach for simulating multi-periodic time-dependent
Hamiltonians in the form of
H(t) =/summationdisplay
/vector mH/vector me−i/vector m·/vector ωt, /vector m∈Zn, /vector ω∈Rn.(2)
Not only they include time-periodic Hamiltonians by
n= 1, they provide a signiﬁcant class of nonequilibrium
systems known as time-quasiperiodic systems [29]. In
a similar way to the optimal algorithm for time-periodic
Hamiltonians[28], we establishaprotocoltosimulate the
time-evolution without relying on neither time-ordered
product nor Dyson-series expansion. Instead, we pre-
pare an ancillary quantum state |/vectorl/a\}brack⌉tri}htwhich labels mul-
tiple Fourier indices /vectorl∈Znin the frequency domain.
This procedure enables much simpler realization of the
time-evolution by the qubitization technique for a cer-
tain time-independent Hamiltonian, called the eﬀective
Hamiltonian. As a result, with employing the block-
encoding of each Fourier component H/vector m, we achieve the
query complexity as the computational cost in the form
of
αt+ωt×o(log(ωt/ε)). (3)
Here, we have α∈poly(N) andω∈ O/parenleftbig
N0/parenrightbig
for typ-
icalN-site quantum many-body systems. This scaling2
is optimal in time tand nearly-optimal in allowable er-
rorε. Importantly, its additive form implies that multi-
periodic Hamiltonians can be simulated almost as eﬃ-
ciently as time-independent systems, which reaches the
theoretically-best scaling [17].
Ouralgorithmformulti-periodicHamiltoniansextends
a class of time-dependent systems that can be eﬃciently
addressed based on QET, in spite of the diﬃculty of
handling time-dependency on quantum circuits. Fur-
thermore, multi-periodic time-dependent Hamiltonians
themselves have been attractive platforms for various
nonequilibrium phenomena [29–33], such as frequency
conversionin multiple-light-irradiatedmaterials[30], and
topological or time-quasicrystalline phenomena in time-
quasiperiodic systems [33]. Therefore, our result will en-
hance potential of quantum computers towardcondensed
matter physics and quantum chemistry.
The rest of this paper is organized as follows. In Sec-
tionII,webrieﬂyreviewqubitizationforsimulatingtime-
independent Hamiltonians. After summarizing our main
result in Section III, we provide its detailed derivation
from Section IV to Section VI. We conclude this paper
in Section VII.
II. BRIEF REVIEW ON QUBITIZATION
In this section, we brieﬂy review Hamiltonian simula-
tion of time-independent systems based on QET, which
is so-called the qubitization technique [17].
We ﬁrst construct block-encoding which embeds time-
independent Hamiltonians Hinto a unitary gate Osuch
that
/a\}brack⌉tl⌉{t0|O|0/a\}brack⌉tri}hta=H
α, α>0. (4)
The quantum state |0/a\}brack⌉tri}htadenotes a trivial reference state
of anna-qubit ancilla system. Due to the unitarity of O
implying /bar⌈blO/bar⌈bl= 1 (/bar⌈bl·/bar⌈bl; operator norm), the denominator
αshould satisfy α≥ /bar⌈blH/bar⌈bl. As a result, α∈poly(N) is
satisﬁed for typical N-site quantum many-body systems.
For instance, let us consider a Hamiltonian given by a
linear combination of unitaries (LCU),
H=jmax/summationdisplay
j=1αjUj, αj≥0, Uj; unitary,(5)
where the number of terms jmaxtypically satisﬁes jmax∈
poly(N). We can organize its block-encoding by
O= (Ga⊗I)†
jmax/summationdisplay
j=1|j/a\}brack⌉tri}ht/a\}brack⌉tl⌉{tj|a⊗Uj
(Ga⊗I),(6)
Ga|0/a\}brack⌉tri}hta=jmax/summationdisplay
j=1/radicalbiggαj
α|j/a\}brack⌉tri}hta, α=jmax/summationdisplay
j=1αj, (7)
with the number of ancilla qubits na=⌈log2jmax⌉ ∈
O(logN). LCUs cover various spin systems andfermionicsystemsin condensed matterphysicsand quan-
tum chemistry [17, 18, 34].
The next step of the qubitization is to execute QET
with the oracle O[18]. We use the phase rotation on the
ancilla system given by
R(φ) =eiφ(2|0/a\gbrack⌉tright/a\gbrack⌉tl⌉ft0|a−Ia)⊗I, φ∈[0,2π),(8)
which yields O(na) elementary gates. Then, we organize
a unitary operation WQwithO(Q)-times usage of R(φ)
andO(orO†), and also with O(1) additional qubits.
By properly tuning the parameter set φ1,...,φ O(Q)in
the rotations R(φ) using the technique of quantum signal
processing [21], the unitary gate WQenables to execute
broad classes of degree- Qpolynomial functions of Has
/a\}brack⌉tl⌉{t0|WQ|0/a\}brack⌉tri}hta′=fQ(H) =Q/summationdisplay
k=0ckHk, ck∈C,(9)
with an {na+O(1)}-qubit ancilla system a′. For
Hamiltonian simulation, we employ a degree- Qpolyno-
mialfQ(H) approximately giving e−iHt(e.g., truncated
Jacobi-Anger expansion or Taylor-series expansion). As
aresult, wecanapply U(t) =e−iHttoarbitraryquantum
states|ψ/a\}brack⌉tri}ht ∈ Hby the unitary gate WQas
WQ|0/a\}brack⌉tri}hta′|ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′e−iHt|ψ/a\}brack⌉tri}ht+O(εQ), εQ=/parenleftbiggαt
Q/parenrightbiggQ
,
(10)
where the error εQarises from degree- Qpolynomial ap-
proximation of e−iHt.
The cost of Hamiltonian simulation is evaluated by the
resource for WQwith achieving a desirable error εas
εQ=/parenleftbiggαt
Q/parenrightbiggQ
≤ε. (11)
The number Qrequired for satisfying this inequality is
obtained by the notion of the Lambert W function W(x)
[35], whose consequence dictates
/parenleftBigκ
x/parenrightBigx
≤η,∀x≥eκ+4log(1/η)
log(e+κ−1log(1/η)),(12)
foranyκ∈[0,∞) andη∈(0,1][18]. Thus, it is suﬃcient
to chooseQ, which gives the number of the oracle Oand
the rotation R(φ) used forWQ, by
Q∈ O/parenleftbigg
αt+log(1/ε)
log(e+(αt)−1log(1/ε))/parenrightbigg
,(13)
to implement U(t) with the desirable error ε. Qubiti-
zation requires following resources for simulating time-
independent Hamiltonians H;
•Number of ancilla qubits na′;na+O(1)
•Query complexity; Q[Eq. (13)]
•Additional gate per query Na;O(na)3
Query complexity means the number of the oracle Oin
the algorithm, which dominantly determines the compu-
tational cost. Additional gates per query comes from the
resource for each phase rotation R(φ). When the oracle
Ocanbe executed by Noelementarygates, the algorithm
needsO(QNo+QNa) gates.
Signiﬁcantly, linear scaling in time as O(t) and loga-
rithmic scaling in accuracy as O(log(1/ε)/loglog(1/ε))
are both known to be optimal for the query complex-
ity of Hamiltonian simulation [20, 21]. The query com-
plexity of qubitization, given by Eq. (13) in an addi-
tive way, achieves the best scaling in time and accuracy
for time-independent systems. In contrast, while QET
allows eﬃcient quantum algorithms by proper polyno-
mial approximation, it is unsuited for time-dependent
systems since their time-evolution U(t) is not simply
expressed by univariate polynomial functions. This re-
sults in larger resources for Hamiltonian simulation of
time-dependent systems like the truncated-Dyson-series
algorithms [22, 23]. Nevertheless, we will show that we
can exploit this technique for time-dependent systems
if we impose multiple time-periodicity. This leads the
optimal/nearly-optimal cost of our algorithm having an
additive form, as discussed later.
III. SUMMARY OF MAIN RESULTS
A. Setup
We ﬁrst specify time-dependent systems of interest
throughout the paper. We consider a quantum sys-
tem on a ﬁnite-dimensional Hilbert space H. With the
frequency of multiple drives by a n-dimensional vector
/vector ω= (ω1,ω2,...,ω n) (ωi>0), a Hamiltonian on the
Hilbert space His assumed to be written by
H(t) =/summationdisplay
/vector m∈MH/vector me−i/vector m·/vector ωt, (14)
whereMis a ﬁnite set of Znand eachH/vector mis a matrix
on the Hilbert space H. The hermiticity of H(t) at every
time imposes H−/vector m=H†
/vector m. We assume the satisfaction of
n,|M| ∈ O(1),max
/vector m∈M(|/vector m|)≤mmax∈ O(1) (15)
throughout the discussion. We deﬁne the characteristic
scale of frequency ωand the characteristic time scale T
by
ω=|/vector ω|1=n/summationdisplay
i=1ωi, T=2π
ω, (16)
which we simply call frequency and period later. We also
impose that the frequency ωis anO/parenleftbig
N0/parenrightbig
constant much
smaller than the total energy scale of the Hamiltonian
maxt∈R{/bar⌈blH(t)/bar⌈bl} ∈poly(N) for typical size- Nquantum
many-body systems.The above Hamiltonian can be re-described by a
n-dimensional Fourier series expansion as H(t) =
H(/vector x)/vextendsingle/vextendsingle
/vector x=/vector ωt(/vector x∈Rn), which is deﬁned by
H(/vector x) =/summationdisplay
/vector m∈MH/vector me−i/vector ω·/vector x, (17)
H/vector m=/integraldisplay
[0,2π)nd/vector x
(2π)nH(/vector x)ei/vector m·/vector x.(18)
The Hamiltonian H(/vector x) satisﬁesH(/vector x+2π/vector ei) with a unit
vector/vector eiin any direction i= 1,2,...,n. In that sense,
the above multi-periodic Hamiltonians H(t) are natural
extensionsoftime-periodicHamiltonian, andsaidtohave
multiple time translation symmetry. We also note that
H(t) becomes time-quasiperiodic if there exists a pair of
ωiandωjgiving an irrational ratio ωi/ωj. Although Eq.
(14) is often used for describing time-quasiperiodic cases,
we do not impose this condition. Finally, we deﬁne γby
γ= sup
/vector x∈[0,2π)n/parenleftbig/vextenddouble/vextenddoubleH(/vector x)−H/vector0/vextenddouble/vextenddouble/parenrightbig
. (19)
This provides the upper bound on the total energy scale
of time-dependent terms in multi-periodic Hamiltonians
H(t).
B. Main results
Webrieﬂyshowthemainresultsofthispaperhere. We
organize a unitary circuit that applies a time-evolution
operatorU(t) to an arbitrary initial state |ψ/a\}brack⌉tri}ht ∈ H. First,
we assume that the following oracles are given;
1. A set of unitary gate {O/vector m}/vector m∈Mgiving a block-
encoding of each Fourier component as
/a\}brack⌉tl⌉{t0|O/vector m|0/a\}brack⌉tri}hta=H/vector m
α/vector m, α/vector m>0, (20)
where|0/a\}brack⌉tri}htadenotes a trivial reference state of an
na-qubit ancilla system.
2. A unitary gate Gcoefgiving an access to each coef-
ﬁcientα/vector mas
Gcoef|/vector0/a\}brack⌉tri}htb=/summationdisplay
/vector m∈M/radicalbiggα/vector m
α|/vector m/a\}brack⌉tri}htb, α=/summationdisplay
/vector m∈Mα/vector m.(21)
The system bhasO(log(|M|)) =O(1) qubits and
can occupy quantum states spanned by {|/vector m/a\}brack⌉tri}ht}/vector m∈M.
3. A unitary gate Gfreqgiving an access to each fre-
quencyωias
Gfreq|0/a\}brack⌉tri}htc=n−1/summationdisplay
i=0/radicalbiggωi+1
ω|i/a\}brack⌉tri}htc, (22)
where the ancilla system cpossesses O(logn) =
O(1) qubits.4
Ancilla qubits Query complexity Additional gates per query
Time-independent H
(Qubitization [17])na+O(1) αt+log(1/ε)
log(e+(αt)−1log(1/ε))O(na)
Multi-periodic H(t)
(ωt∈ O(1), Thm. 3)na+O(log(γt)+loglog(1 /ε)) αt+o(log(1/ε)) O(na+log(γt)+loglog(1 /ε))
Multi-periodic H(t)
(ωt∈Ω(1), Thm. 4)na+O(log(γ/ω)+loglog( ωt/ε))αt+ωt×o(log(ωt/ε))O(na+log(γ/ω)+loglog( ωt/ε))
Time-dependent H(t)
(Dyson series [22, 23])na+O(log{(γωt/α+αt)/ε}) αtlog(αt/ε)
loglog( αt/ε)O(na+log{(γωt/α+αt)/ε})
TABLE I. Comparison of computational resource for Hamilton ian simulation. Our results on multi-periodic Hamiltonian s are
based on Theorems 3 and 4. We note that we replace deﬁnitions o f some symbols by those having similar scales to make
the comparison easier. Precisely speaking, the symbol αdenotes the energy scale of the whole Hamiltonian α/greaterorsimilar/bardblH/bardblor
α/greaterorsimilarmaxt(/bardblH(t)/bardbl). The symbol γis used for the energy scale of time-dependent terms, i.e., γω∼maxt(/vextenddouble/vextenddoubled
dtH(t)/vextenddouble/vextenddouble).
The block-encoding Eq. (20) requires α/vector m≥ /bar⌈blH/vector m/bar⌈blfor
every/vector m, and we obtain
/bar⌈blH(t)/bar⌈bl ≤/summationdisplay
/vector m∈M/bar⌈blH/vector m/bar⌈bl ≤α. (23)
The parameter αis therefore poly( N) for typical size-
Nquantum many-body systems. We also note that the
oracleO/vector musually yields more resource than the others
GcoefandGfreqsince they manipulate O(1) qubits and
similar quantum gates are often included in O/vector m[e.g. See
Eq. (7) for LCUs]. Comparing with the oracles used for
qubitization given by Eq. (4), the diﬃculty of preparing
oracles for our setups is essentially the same as that for
time-independent systems.
Upon the above setup, our central result is construc-
tion of a unitary gate W(t) which gives a time-evolution
operatorU(t) underthe multi-periodicHamiltonian H(t)
to an arbitrary quantum state |ψ/a\}brack⌉tri}ht ∈ Has
W(t)|0/a\}brack⌉tri}hta′|ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′{U(t)|ψ/a\}brack⌉tri}ht}+O(ε).(24)
Here,|0/a\}brack⌉tri}hta′is a trivial reference state of an ancilla sys-
tema′. The cost of Hamiltonian simulation is deter-
mined by the number of ancilla qubits for |0/a\}brack⌉tri}hta′and the
query complexity, which means the number of the ora-
cles{O/vector m,Gcoef}employedfor the unitarygate W(t). We
summarize our results in Table I, although the detailed
discussion is left for Section VI. We obtain eﬃcient algo-
rithms fortwodiﬀerent time scales. Theﬁrst oneis O(1)-
period dynamics with ωt∈ O(1), while the second one is
Ω(1)-period dynamics in which we typically have ωt≫1.
At ﬁrst glance, we see that the number of ancilla qubits
is just between the qubitization and the Dyson-series al-
gorithm. Signiﬁcantly, the query complexity has optimal
scaling both in time tand inverse error 1 /ε, and takes an
additive form of αtand log(1/ε). This scaling is equal or
close to the theoretically best one for time-independent
systems. As a matter of fact, the computational resource
for multi-periodic Hamiltonians is essentially the same
as that for time-periodic Hamiltonians [28], where we set
n= 1 in Eq. (14). Therefore, our result reveals that
a larger class of time-dependent Hamiltonians includingmulti-periodicity can be simulated as eﬃciently as time-
independent systems.
IV. TIME-EVOLUTION FROM
FLOQUET-HILBERT SPACE
In this section, we discuss how we compute the exact
time-evolved state U(t)|ψ/a\}brack⌉tri}htfor an arbitrary initial state
|ψ/a\}brack⌉tri}ht, with keeping the error up to O(ε). The principal
strategy relies on a natural extension of the optimal al-
gorithm for time-periodic Hamiltonians [28]. Analogous
to time-periodic systems, we introduce an ancilla quan-
tum system flabeling Fourier indices /vectorlby{|/vectorl/a\}brack⌉tri}htf}/vectorl∈[L]n,
where the domain [ L]ndenotes a subset of Zndeﬁned by
[L]n={−L+1,−L+2,...,L}n.(25)
We refer to a space HL
Fdeﬁned by
HL
F= span/braceleftBig
|/vectorl/a\}brack⌉tri}htf/bracerightBig
/vectorl∈[L]n⊗H (26)
as a Floquet-Hilbert space. We also deﬁne an eﬀective
Hamiltonian HLacting on the Floquet-Hilbert space by
HL=/summationdisplay
/vector m∈MAddL
/vector m⊗H/vector m−HL
LP,(27)
HL
LP=/summationdisplay
/vectorl∈[L]n/vectorl·/vector ω|/vectorl/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vectorl|f⊗I. (28)
Here, the unitary operator AddL
/vector mexecutes addition of /vectorl
as
AddL
/vector m=/summationdisplay
/vectorl∈[L]n|/vectorl⊕/vector m/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vectorl|f, (29)
where each li⊕mi∈[L] is deﬁned modulo 2 L. The term
HL
LPrepresents a linear potential for Fourier indices. We
note that the form of the eﬀective Hamiltonian HLis
diﬀerent from that of the standard many-mode Floquet
theory [29], in that HLincludes unphysical excitations
|/vectorl⊕/vector m/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vectorl|⊗H/vector mwith/vectorl⊕/vector m/\⌉}atio\slash=/vectorl+/vector m.5
To construct the optimal algorithm for multi-periodic
Hamiltonians H(t), we ﬁrst establish another expression
of the time-evolved state U(t)|ψ/a\}brack⌉tri}ht. This expression does
not rely on Dyson-series expansion, but instead exploits
the Floquet-Hilbert space and the eﬀective Hamiltonian
HL, as we discuss in Section IVA. Next, we construct a
quantum algorithmtoobtain this expressiononquantum
circuits with certainty. We devote Section IVB for its
discussion.
A. Representation of time-evolution
Here, we establish the way to express the time-
evolution without Dyson-series expansion for the algo-
rithm. In an analogy to time-periodic cases in Ref. [28],
we aim at reproducing the time-evolution operator U(t)
by a unitary operation on the Floquet-Hilbert space. Let
WL
fdenote a unitary gate which generates a uniform su-
perposition as
WL
f|/vector0/a\}brack⌉tri}htf=1/radicalbig
(2L)n/summationdisplay
/vectorl∈[L]n|/vectorl/a\}brack⌉tri}htf, (30)
which yields at-most O(logL) elementary gates. For
some natural numbers p,qsatisfyingp < q, we deﬁne
a unitary operation UL
p,q(t) by
UL
p,q(t) = (WqL
f⊗I)†e−iHqL
LPte−iHqLt(WpL
f⊗I),(31)
which acts on the Floquet-Hilbert space HqL
F. In this
section, weprovethat thetime-evolution U(t)isprovided
by this unitary gate as
/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf≃/parenleftbiggp
q/parenrightbiggn
2
U(t), (32)
ifthe cutoﬀ Lis suﬃciently large. In otherwords, UL
p,q(t)
is interpreted as an approximate block-encoding of U(t).
1. Preliminary results for proving Eq. (32)
From the deﬁnition of UL
p,q(t) asEq. (31), the diagonal
element of interest is computed as follows;
/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf=/a\}brack⌉tl⌉{t/vector0|fWqL†
fe−iHqL
LPte−iHqLtWpL
f|/vector0/a\}brack⌉tri}htf
=1/radicalbig
(2pL)n(2qL)n/summationdisplay
/vectorl′∈[pL]nUqL
/vectorl′(t),(33)
UqL
/vectorl′(t) =/summationdisplay
/vectorl∈[qL]ne−i/vectorl·/vector ωt/a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht.(34)
We ﬁrst concentrate on evaluating UqL
/vectorl′(t) before proving
Eq. (32). Remarkably, we can prove the following the-
orem onUqL
/vectorl′(t), which claims that it approximates the
time-evolution operator U(t) under suﬃciently large L
regardless of /vectorl′∈[pL]n.Theorem 1. (Floquet-Hilbert space description)
We impose all the assumptions in Section IIIA on
multi-periodic Hamiltonians H(t), and assume p<qfor
p,q∈NandL≥e2mmaxγt+mmaxwhereγis deﬁned by
Eq. (19). Then, for every point /vectorl′∈[pL]n, the operator
UqL
/vectorl′(t) [See Eq. (34)] approximates the time-evolution
operatorU(t) as
/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddouble≤Cn,mmaxα0t/parenleftbigge2mmaxγt
L−mmax/parenrightbiggL/mmax−1
,
(35)
withα0=α−α/vector0. TheO(1) constant Cn,mmaxis ex-
pressed by
Cn,mmax= 4(2√πmmax)nΓ(n)
Γ(n/2)e√n/mmax,(36)
where Γ(x) denotes the gamma function.
Proof.— Throughout this proof, we omit the subscript
fin|/vectorl/a\}brack⌉tri}htfand|/vectorl′/a\}brack⌉tri}htf. We begin with diﬀerentiating UqL
/vectorl′(t)
in time as follows,
d
dtUqL
/vectorl′(t)
=−i/summationdisplay
/vectorl∈[qL]ne−i/vectorl·/vector ωt/a\}brack⌉tl⌉{t/vectorl|(/vectorl·/vector ω+HqL)e−iHqLt|/vectorl′/a\}brack⌉tri}ht
=−i/summationdisplay
/vectorl∈[qL]n/summationdisplay
/vector m∈Me−i(/vectorl⊕/vector m)·/vector ωtH/vector m/a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht.
(37)
In the second equality, /vectorl⊕/vector mcomes from the addition
AddqL
/vector mon the torus [ qL]nas Eq. (29), and hence each
li⊕mi∈[qL] is deﬁned modulo 2 qLfor each direction
i= 1,2,...,n. We substitute −iH(t)UqL
/vectorl′(t) from the
above equality, which results in
d
dtUqL
/vectorl′(t)+iH(t)UqL
/vectorl′(t)
=/summationdisplay
/vectorl∈[qL]n/summationdisplay
/vector m∈Mf(/vectorl,/vector m)H/vector m/a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht ≡E(t),
(38)
where the factor f(/vectorl,/vector m) is deﬁned by
f(/vectorl,/vector m) =e−i(/vectorl⊕/vector m)·/vector ωt−e−i(/vectorl+/vector m)·/vector ωt.(39)
We can solve the time-dependent diﬀerential equation
Eq. (38) with using the initial condition UqL
/vectorl′(0) =I
from Eq. (34). This results in
UqL
/vectorl′(t) =U(t)+/integraldisplayt
0dt′U(t)U(t′)†E(t′),(40)
and hence the error of interest is bounded by
/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddouble≤tsup
t′∈[0,t](/bar⌈blE(t′)/bar⌈bl).(41)6
We concentrate on evaluate the bound on /bar⌈blE(t)/bar⌈bl. The
factorf(/vectorl,/vector m) implies that each term in the summation
of Eq. (38) can survive only when /vectorlis included in the
boundary of [ qL]n, i.e.,∂[qL]n≡[qL]n\[qL−mmax]n.
We also note that the terms corresponding to /vector m=/vector0
always vanish by /vectorl⊕/vector m=/vectorl+/vector m. This results in the
inequality,
/bar⌈blE(t)/bar⌈bl ≤/summationdisplay
/vector m∈M;/vector m/\⌉gatio\slash=/vector02/bar⌈blH/vector m/bar⌈bl/summationdisplay
/vectorl∈∂[qL]n/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble.
(42)
Then, we use the Lieb-Robinson bound in the Floquet-
Hilbert space, which gives the upper bound of the tran-
sition amplitude /a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht. When we deﬁne the dis-
tance between /vectorland/vectorl′measured on the torus [ qL]nby
dqL(/vectorl,/vectorl′) =/radicaltp/radicalvertex/radicalvertex/radicalbtn/summationdisplay
i=1(min{|li−l′
i|,2qL−|li−l′
i|})2,(43)
the transition amplitude is bounded from above by
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHqLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble≤/parenleftBigg
emmaxγt
dqL(/vectorl,/vectorl′)/parenrightBiggdqL(/vectorl,/vectorl′)/mmax
,(44)
in casedqL(/vectorl,/vectorl′)≥2mmaxγt. Since the derivation is sim-
ilar to that for time-periodic Hamiltonians [28], we pro-
vide it in Appendix A. For every point /vectorl′∈[pL]n, the
distance from /vectorl∈∂[qL]nsatisﬁes
dqL(/vectorl,/vectorl′)≥(qL−mmax)−pLmax
≥L−mmax≥e2mmaxγt, (45)
due to the assumptions, and hence we can safely apply
the Lieb-Robinson bound, Eq. (44). By combining Eq.
(42) with the relation /bar⌈blH/vector m/bar⌈bl ≤α/vector m, the error /bar⌈blE(t)/bar⌈blis
further bounded by
/bar⌈blE(t)/bar⌈bl ≤2(α−α/vector0)/summationdisplay
/vectorl∈∂[qL]n/parenleftBigg
emmaxγt
dqL(/vectorl,/vectorl′)/parenrightBiggdqL(/vectorl,/vectorl′)/mmax
≤2α0/parenleftbiggemmaxγt
L−mmax/parenrightbigg(L−mmax)/mmax
×/summationdisplay
/vectorl∈∂[qL]n/parenleftbiggemmaxγt
e2mmaxγt/parenrightbiggdqL(/vectorl,/vectorl′)−(L−mmax)
mmax
≤2α0/parenleftbigge2mmaxγt
L−mmax/parenrightbiggL−mmax
mmax/summationdisplay
/vectorl∈∂[qL]ne−dqL(/vectorl,/vectorl′)
mmax.
(46)
Theremainingtaskforevaluating /bar⌈blE(t)/bar⌈blistocompute
the summation over /vectorl∈∂[qL]nin Eq. (46). Let D/vectorl′be a
closed orthant to which /vectorl′belongs, represented by D/vectorl′={/vector x∈Rn;xisgn(l′
i)≥0(i= 1,2,...,n)}withsgn(0) ≡0.
The summation over /vectorl′in Eq. (46) is bounded by
/summationdisplay
/vectorl∈∂[qL]ne−dqL(/vectorl,/vectorl′)
mmax≤2n/summationdisplay
/vectorl∈∂[qL]n∩D/vectorl′e−|/vectorl−/vectorl′|
mmax
≤2n/integraldisplay∞
L−mmaxdrSnrn−1e−(r−√n)/mmax
≤(2mmax)ne√n/mmaxSnΓ(n),(47)
whereSn≡2πn/2/Γ(n/2) gives the surface area of an
n-dimensional unit ball. Finally, with using the relations
Eqs. (41), (46), and (47), we arrive at the bound on/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddoubleintheformofEq. (35),whichcompletes
the proof. /square
Since the right hand side of Eq. (35) vanishes under
L→ ∞, Theorem 1 says that we can reproduce the exact
time-evolution operator U(t) byUqL
/vectorl′(t) with suﬃciently
largeL.
2. Proof of Eq. (32)
We are ready to prove Eq. (32), which indicates that
the unitary operator UL
p,q(t) can provide block-encoding
of the time-evolution U(t). This relation is precisely
stated by the following theorem.
Theorem 2. (Block-encoding of time-evolution)
We impose all the assumptions in Section IIIA on
multi-periodic Hamiltonians H(t), and assume p<qfor
p,q∈N. When we choose the cutoﬀ Lfor the Fourier
indices by
L∈ O/parenleftbigg
αt+log(1/ε)
log(e+(αt)−1log(1/ε))/parenrightbigg
,(48)
the unitary gate UL
p,q(t) on the Floquet-Hilbert space
HqL
Fcan generate the block-encoding of the time-
evolutionU(t) as
/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf−/parenleftbiggp
q/parenrightbiggn
2
U(t)/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble≤/parenleftbiggp
q/parenrightbiggn
2
ε.(49)
Proof of Theorem 2.— We choose the cutoﬀ Lso that
the diﬀerence/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddoublebecomes smaller than the
desirable error ε. We apply the inequality Eq. (12) with
κ=e2γt,η=ε(Cn,mmaxα0t)−1, andx=L/mmax−1,
and setLby
L=mmax
e3γt+4log/parenleftBig
Cn,mmaxα0t
ε/parenrightBig
log/parenleftBig
e+1
e2γtlog/parenleftBig
Cn,mmaxα0t
ε/parenrightBig/parenrightBig+1

(50)
≤e3mmaxγt+4mmaxlog(1/ε)
log(e+(e2γt)−1log(1/ε))
+4mmaxlog(Cn,mmaxα0t)+mmax+1.(51)7
Then, Theorem 1 ensures/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddouble≤ε. We also
note that the above choice of Lsatisﬁes the scaling of
Eq. (48) since we have the assumption n,mmax∈ O(1)
and the relation γ,α0≤αfrom Eqs. (19) and (23). The
expression of UL
p,q(t) given by Eq. (33) leads to
/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf−/parenleftbiggp
q/parenrightbiggn
2
U(t)/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble
≤1/radicalbig
(2pL)n(2qL)n/summationdisplay
/vectorl′∈[pL]n/vextenddouble/vextenddouble/vextenddoubleU(t)−UqL
/vectorl′(t)/vextenddouble/vextenddouble/vextenddouble
≤/parenleftbiggp
q/parenrightbiggn
2
ε, (52)
which completes the proof of Eq. (49). /square
B. Extracting time-evolution with certainty
Theorem 2 claims that the unitary operator UL
p,q(t)
gives the block-encoding of the time-evolution U(t). We
next provide the way to exploit it for accurately obtain-
ing the time-evolved state U(t)|ψ/a\}brack⌉tri}htwith certainty, using
the oblivious amplitude ampliﬁcation [36]. With deﬁning
the projections P0≡ |/vector0/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vector0|f⊗IandP⊥
0=I−P0, the
block-encoding provides the time-evolution probabilisti-
cally by
UL
p,q(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht= (P0+P⊥
0)UL
p,q(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht
=|/vector0/a\}brack⌉tri}htf/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht+|Ψ⊥/a\}brack⌉tri}ht
=/parenleftbiggp
q/parenrightbiggn
2
|/vector0/a\}brack⌉tri}htf{U(t)|ψ/a\}brack⌉tri}ht+|ψε/a\}brack⌉tri}ht}+|Ψ⊥/a\}brack⌉tri}ht,
(53)
where|Ψ⊥/a\}brack⌉tri}ht ≡P⊥
0UL
p,q(t)|/vector0/a\}brack⌉tri}htfis always orthogonal to
|/vector0/a\}brack⌉tri}htf. The deviation |ψε/a\}brack⌉tri}ht, which is given by
|ψε/a\}brack⌉tri}ht ≡/parenleftbiggq
p/parenrightbiggn
2
/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht−U(t)|ψ/a\}brack⌉tri}ht,(54)
has the norm bounded by /bar⌈bl|ψε/a\}brack⌉tri}ht/bar⌈bl ≤εby Theorem 2.
When we measure the ancilla system fand post-select
the result |/vector0/a\}brack⌉tri}htf, we can obtain the target state U(t)|ψ/a\}brack⌉tri}ht
with the allowable deviation |ψε/a\}brack⌉tri}ht. The success probabil-
ity of post-selection Psuccessamounts to
Psuccess=/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vector0|UL
p,q(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble2
=/parenleftbiggp
q/parenrightbiggn
(1+2Re {/a\}brack⌉tl⌉{tψε|U(t)|ψ/a\}brack⌉tri}ht}+/a\}brack⌉tl⌉{tψε|ψε/a\}brack⌉tri}ht).
(55)
Considering the relation |/a\}brack⌉tl⌉{tψε|U(t)|ψ/a\}brack⌉tri}ht| ≤εand
/a\}brack⌉tl⌉{tψε|ψε/a\}brack⌉tri}ht ≤ε2< εforε∈[0,1], the success probability
lies in
Psuccess∈/bracketleftbigg/parenleftbiggp
q/parenrightbiggn
(1−3ε),/parenleftbiggp
q/parenrightbiggn
(1+3ε)/bracketrightbigg
.(56)The condition p < q(p,q∈N) suggests that the uni-
tary gate UL
p,q(t) fails to achieve success probability suf-
ﬁciently close to 1.
In order to deterministically get the time-evolved state
|ψ/a\}brack⌉tri}ht, we employ the oblivious amplitude ampliﬁcation
which ampliﬁes the success probability [36]. With a
phase rotation operator R(ϕ) =eiϕ(2|/vector0/a\gbrack⌉tright/a\gbrack⌉tl⌉ft/vector0|f−I)⊗I, it ex-
ploits a unitary operator deﬁned by
UL(t) =eiϕ0/braceleftbig
UL
p,q(t)R(ϕ1)[UL
p,q(t)]†R(ϕ2)/bracerightbigDUL
p,q(t),
(57)
with tunable parameters ϕ0,ϕ1,ϕ2∈Rand an iteration
numberD∈N. In a similar manner to the generalized
Grover’s search algorithm with ﬂexible rotation angles
ϕ1,ϕ2[37–39], we deﬁne the iteration number by
D≥π
4arcsin/parenleftBig√
P/parenrightBig−1
2∈ O/parenleftbigg1√
P/parenrightbigg
(58)
whenthe successprobabilitysatisﬁes Psuccess≥P−O(ε).
Then, there exists a parameter set ϕ0,ϕ1,ϕ2∈Rrealiz-
ing the success probability 1 as
UL(t)|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht=|/vector0/a\}brack⌉tri}htfU(t)|ψ/a\}brack⌉tri}ht+O(Dε),∀|ψ/a\}brack⌉tri}ht ∈ H.
(59)
We set the natural numbers pandqby
p=n, q=n+1, (60)
with the number ofthe frequencies n∈ O(1). This choice
ensures the lower bound of the success probability
Psuccess≥/parenleftbigg
1+1
n/parenrightbigg−n
(1−3ε)≥1
e(1−3ε).(61)
The choice of the iteration number by
D=
π
4arcsin/parenleftBig√
e−1/parenrightBig−1
2
= 1 (62)
is enough in this case. Based on the generalized Grover’s
search algorithm by Ref. [39], the rotation phases ϕ1,ϕ2
are chosen by
ϕ1=ϕ2= arcsin/braceleftbigg1√
Psin/parenleftbiggπ
4D+2/parenrightbigg/bracerightbigg
= arcsin/braceleftbigg1
2/parenleftbig
1+n−1/parenrightbign/2/bracerightbigg
,(63)
while the global phase ϕ0is irrelevant in practice.
In consequence, the unitary operator UL(t) on the
Floquet-Hilbert space H(n+1)L
Fgeneratesthe targettime-
evolved state U(t)|ψ/a\}brack⌉tri}htwith an error up to O(ε). Accord-
ing to Eqs. (31) and (57), the computational resources
required for UL(t) is summarized as follows;
(i) Ancilla system {|/vectorl/a\}brack⌉tri}ht}/vectorl∈[(n+1)L]nfor labeling Fourier
indices. It requires ⌈log2{(n+ 1)L}n⌉ ∈ O(logL)
qubits.8
(ii) 2D+1 = 3 times usage of the time-evolution oper-
atorse−iH(n+1)L
LPtande−iH(n+1)Lt, or their inverse
operations.
(iii) The other gates on the ancilla system f, i.e., the
unitary gates WnL
f,W(n+1)L
f[See Eq. (30)], and
R(ϕ) =eiϕ(2|/vector0/a\gbrack⌉tright/a\gbrack⌉tl⌉ft/vector0|f−I)⊗I. Each of them is used
O(1) times, requiring O(logL) elementary gates.
In terms of the number of quantum gates, the dominant
task in the Hamiltonian simulation is to implement the
time-evolutionunder the time-independent Hamiltonians
H(n+1)L
LPandH(n+1)L. We use the qubitization tech-
nique [17], introduced in Section II, for this implementa-
tion in the following section.
V. TIME-EVOLUTION OPERATORS UNDER
EFFECTIVE HAMILTONIAN
The unitary gate UL(t), given by Eq. (57), executes
Hamiltonian simulation under multi-periodic Hamilto-
nians, with making use of O(1) times queries to the
time-evolution operators under the Hamiltonians on the
Floquet-Hilbert space, H(n+1)L
LPandH(n+1)L. Since
they are no longer time-dependent, we can employ the
QET-based qubitization technique for implementing the
time-evolution operators under them. In this section, we
identify how much resource is required for the qubitiza-
tion in terms of the supposed oracles {O/vector m}/vector m∈M(block-
encoding ofeach Fouriercomponent H/vector m) and some other
elementary gates.
A. Linear potential Hamiltonian
We ﬁrst evaluate the cost for implementing the time-
evolution operator under the linear potential Hamilto-
nianH(n+1)L
LP, given by Eq. (28). For brevity, we orga-
nize the block-encoding of HL
LPwith omitting the O(1)
coeﬃcient in the cutoﬀ, n+ 1. Each ancilla state |/vectorl/a\}brack⌉tri}htf
for/vectorl∈[L]ncan be decomposed into |/vectorl/a\}brack⌉tri}htf=/circlemultiplytextn
i=1|li/a\}brack⌉tri}htfi
withli∈[L], and then the linear potential Hamiltonian
is rewritten by
HL
LP=n/summationdisplay
i=1
/summationdisplay
li∈[L]liωi|li/a\}brack⌉tri}ht/a\}brack⌉tl⌉{tli|fi
⊗If\fi⊗I.(64)
Thus, it is a linear combination of one-dimensional linear
potential Hamiltonians Each of them has an eﬃciently-
implementable block-encoding Oi
LP[28], such that
/a\}brack⌉tl⌉{t0|Oi
LP|0/a\}brack⌉tri}htd=1
2Lωi/summationdisplay
li∈[L]liωi|li/a\}brack⌉tri}ht/a\}brack⌉tl⌉{tli|fi,(65)
which can be equipped with O(logL) elementary gates
and anO(logL)-qubit ancilla trivial state |0/a\}brack⌉tri}htd. Onceblock-encodingofeachterminalinearcombinationisob-
tained, its block-encoding is also immediately organized
[18]. We use the ancilla system chavingnlevels and the
oracleGfreq, deﬁned by Eq. (22). The block-encoding for
HL
LPis organized by
OL
LP=G†
freq/parenleftBiggn−1/summationdisplay
i=0|0/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t0|c⊗Oi
LP/parenrightBigg
Gfreq,(66)
where we omit identity operators. We can conﬁrm the
relation,
/a\}brack⌉tl⌉{t0|OLP|0/a\}brack⌉tri}htcd=n/summationdisplay
i=1ωi
ω/a\}brack⌉tl⌉{t0|Oi
LP|0/a\}brack⌉tri}htd=HL
LP
2Lω.(67)
We employ the qubitization technique to implement
exp/parenleftbig
−iHL
LPt/parenrightbig
with using the block-encoding OL
LP. The
unitary gate OL
LPrequires two queries to the supposed
oracleGfreq. As a results, the qubitization technique dic-
tates the existence of a unitary gate UL
LP(t) such that
UL
LP(t)|0/a\}brack⌉tri}htcd|Ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}htcde−iHL
LPt|Ψ/a\}brack⌉tri}ht+O(ε),(68)
(∀|Ψ/a\}brack⌉tri}ht ∈ HL
F), which can be implemented with following
resources;
•Ancilla qubits for candd;
⌈log2n⌉+O(logL)∈ O(logL). (69)
•Query complexity of the oracle Gfreq;
O/parenleftbigg
Lωt+log(1/ε)
log(e+(Lωt)−1log(1/ε))/parenrightbigg
(70)
•Additional elementary gates per query; O(logL)
The actual algorithm works with the time-evolution
exp/parenleftBig
−iH(n+1)L
LPt/parenrightBig
, and the accurate cost is obtained by
substituting ( n+1)LintoLin the above results. Since
nis supposed to be an O(1) constant, the resulting cost
is essentially the same as the above one.
B. Eﬀective Hamiltonian
We discuss the cost for implementing the time-
evolution exp/parenleftbig
−iH(n+1)Lt/parenrightbig
. Here, we again omit the
coeﬃcientn+ 1 and consider the block-encoding of the
eﬀective Hamiltonian HL. We concentrate on the ﬁrst
term in Eq. (27),
HL
Add≡/summationdisplay
/vector m∈MAddL
/vector m⊗H/vector m. (71)
The block-encoding of HL
Addcan be composed of the or-
aclesO/vector mandGcoef[See Section IIIB] by
OL
Add=G†
coef/parenleftBigg/summationdisplay
/vector m∈M|/vector m/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vector m|b⊗O/vector m/parenrightBigg
Gcoef,(72)9
where we need the O(log(|M|))-qubit ancilla system b. It
satisﬁes
/a\}brack⌉tl⌉{t0|OL
Add|0/a\}brack⌉tri}htab=/summationdisplay
/vector m∈Mα/vector m
α/a\}brack⌉tl⌉{t0|O/vector m|0/a\}brack⌉tri}hta=HL
Add
α,(73)
where we deﬁne the reference state by |0/a\}brack⌉tri}htab=|0/a\}brack⌉tri}hta⊗|/vector0/a\}brack⌉tri}htb.
We introduce another ancilla qubit eto organize the
block-encoding of HL. Under the preparation of the
ancilla system a′composed of the systems a,b,c,d,e , and
f, we deﬁne a unitary gate OLon it by
OL=RL/parenleftbig
|0/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t0|e⊗OL
Add−|1/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t1|e⊗OL
LP/parenrightbig
RL,(74)
where the unitary gate RLdenotes a single-qubit rota-
tion around Y-axis on the system eas
RL=/parenleftbig
e−iθLY/parenrightbig
e, θL= arccos/parenleftbigg/radicalbiggα
α+2Lω/parenrightbigg
.(75)
The unitary operator OLprovides the block-encoding of
HLwith the reference state |0/a\}brack⌉tri}hta′=|0/a\}brack⌉tri}hta|/vector0/a\}brack⌉tri}htb|0/a\}brack⌉tri}htc|0/a\}brack⌉tri}htd|0/a\}brack⌉tri}hte
as
/a\}brack⌉tl⌉{t0|OL|0/a\}brack⌉tri}hta′=α/a\}brack⌉tl⌉{t0|OL
Add|0/a\}brack⌉tri}htab−2Lω/a\}brack⌉tl⌉{t0|Oi
LP|0/a\}brack⌉tri}htd
α+2Lω
=HL
α+2Lω. (76)
We can obtain the cost for implementing the time-
evolution exp/parenleftbig
−iHLt/parenrightbig
with an allowable error εbased
on Section II. The numbers of calls for the oracles O/vector m,
Gcoef, andGfreqare respectively given by |M|, 2, and 2
via Eqs. (66) and (72), and all of them can be attributed
toO(1) numbers. We can organize a unitary gate UL
eﬀ(t)
such that
UL
eﬀ(t)|0/a\}brack⌉tri}hta′|Ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′e−iHLt|Ψ/a\}brack⌉tri}ht+O(ε),(77)
for arbitrary quantum states |Ψ/a\}brack⌉tri}ht ∈ HL
Fby the following
resources.
•Ancilla qubits for a′;na+O(logL).
•Query complexity counted by the oracles;
O/parenleftbigg
(α+Lω)t+log(1/ωt)
log(e+(α+Lω)−1log(1/ε))/parenrightbigg
.(78)
•Additional gates per query; O(logL).
VI. ALGORITHM OF HAMILTONIAN
SIMULATION
In this section, we complete the algorithm for Hamil-
tonian simulation of multi-periodic time-dependent sys-
tems, and derive its computational cost. Depending on
the time scale of interest, we establish two diﬀerent ap-
proaches. Theﬁrstcaseis O(1)-perioddynamicsinwhichωt∈ O(1) is satisﬁed, while the other is Ω(1)-period dy-
namics with ωt∈Ω(1). Combining the explicit formula
for the cutoﬀ L, Eq. (50), and the query complexity,
Eqs. (70) and (78), a naive execution of the algorithm
experiences quadratic increase of the cost in time t. We
need proof by cases based on the time scale to avoid such
a problem. We also note that the results provided below
completely includes those for Hamiltonian simulation of
time-periodic systems [28], and share the same scaling of
the cost. In other words, we succeed in clarifying broader
classes of time-dependent Hamiltonians that can be sim-
ulated as eﬃciently as time-independent Hamiltonians.
A.O(1)-period dynamics
We here providethe algorithmfor O(1)-period dynam-
ics. This case is useful when we are interested in slow
modulation in time with small ω, exempliﬁed by (quasi-
)adiabatic quantum dynamics [40, 41].
We ﬁrst prepare the target system initialized to |ψ/a\}brack⌉tri}ht ∈
Hand the ancilla quantum system ffor Fourier in-
dices, so that they canembody the Floquet-Hilbert space
H(n+1)L
F. Here, the cutoﬀ Lis chosen by Eq. (50), whose
scaling is given by Eq. (48). With attaching additional
ancilla qubits for a,b,c,d, anderequired for the qubiti-
zation technique, we initialize the combined ancilla sys-
tema′to the reference state |0/a\}brack⌉tri}hta′. We organize the uni-
tary operator UL(t) designated by Eq. (57) in which
we substitute the results of qubitization, U(n+1)L
LP(t) and
U(n+1)L
eﬀ(t), instead of the time-evolution operators un-
derH(n+1)L
LPandH(n+1)L. The resulting unitary gate
UL(t) reproduces the time-evolution operator U(t) as
UL(t)|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htfU(t)|ψ/a\}brack⌉tri}ht+O(ε),(79)
which completes the algorithm.
Let us evaluate the computational cost. The ancilla
systemsa′andfrespectively yield na+O(logL) and
O(logL) qubits, whose scaling is designated by Eq. (48)
as
O(logL)⊂
O(log(αt)+loglog(1 /ε)+log(mmaxlogCn,mmax)).
(80)
Although the constant Cn,mmaxsuper-exponentially in-
creases innby Eq. (36), it hardly aﬀects the number of
ancilla qubits as
log(mmaxlogCn,mmax)∈ O(logn+logmmax),(81)
under the assumption n,mmax∈ O(1). Next, the query
complexity Q, measured by the oracles O/vector m,Gcoef, and
Gfreqis determined by the qubitization technique in Sec-
tion II. It is obtained by substituting the form of L, Eq.
(48), into Eqs. (70) and (78). The oblivious amplitude
ampliﬁcation employed in Section IVB aﬀects the query10
complexity only by the multiplicative factor O(1). Fi-
nally, we need additional gates other than the oracles,
only acting on the ancilla systems. They are composed
ofO(1)-times use of WL
f[See Eq. (30)], O(1)-times use
of the phase rotation R(ϕ) for the oblivious amplitude
ampliﬁcation, and some other gates for the qubitization.
The last one has a dominant scaling in the total number
of elementary gates, given by O(Q(na+logL)), while
those for the former two requires at-most O(logL). As a
result, wearriveat the followingtheoremon Hamiltonian
simulation of multi-periodic time-dependent systems.
Theorem 3. (Cost for O(1)-period dynamics)
We impose all the assumptions in Section IIIA on
multi-periodic time-dependent Hamiltonians H(t), and
are allowed to use the oracles O/vector m,Gcoef, andGfreq. The
time of interest is supposed to be t∈ O(1)×T. Then,
we can simulate the time-evolved state U(t)|ψ/a\}brack⌉tri}htfrom ar-
bitrary initial states |ψ/a\}brack⌉tri}ht ∈ Hwith a desirable error up to
O(ε), by the following resources;
•Number of ancilla qubits;
na+O(log(αt)+loglog(1 /ε)). (82)
•Scaling of query complexity Q;
αt+log(1/ε)
log(e+{αt+o(log(1/ε))}−1log(1/ε)).(83)
•Additional gates per query;
O(na+log(αt)+loglog(1 /ε)). (84)
In the query complexity, the term o(log(1/ε)) exactly
scales as
log(1/ε)
log(e+(αt)−1log(1/ε)), (85)
which is smaller than log(1 /ε).
Let us discuss the eﬃciency of the algorithm and com-
pare it with those of conventional algorithms. When in-
dependently increasingthe time tor the inverseerror 1 /ε
with ﬁxing the other, we observethat the querycomplex-
ityQhas optimal linear scaling in t, and nearly-optimal
scaling in 1 /εgiven by
O/parenleftbigglog(1/ε)
logloglog(1 /ε)/parenrightbigg
. (86)
When we consider scaling both in tand 1/ε, we empha-
size that our algorithm achieves additive scaling given
by
poly(N)t+o(log(1/ε)). (87)
This is suﬃciently close to the one for qubitization [See
Eq. (13)], and saves much cost compared to the trun-
cated Dyson series algorithm [22, 23], which gives pro-
ductive scaling as
αtlog(αt)
loglog(αt/ε). (88)In particular, when we impose αt/greaterorsimilarlog(1/ε), which nat-
urally arises from α∈poly(N), Eq. (83) says that the
query complexity of our algorithm corresponds to that of
qubitization, which is the best one for time-independent
cases.
B.Ω(1)-period dynamics
We establish the algorithm when the time tis given
byωt∈Ω(1). It is useful in case we are interested in
long-timedynamics when the frequency ωis not sosmall.
For instance, when we simulate quantum materials un-
der multiple lights [29, 30] or nonequilibrium phases of
matters under time-quasiperiodic drive [31, 33], we need
their dynamics over multiple periods t∈Ω(1)×T.
Our strategy of the algorithm is dividing the time t
intor≡ ⌈ωt⌉parts and repeating time-evolution for the
separated time t/r∈ O(1)×T. The time-evolution op-
erator can be split into
U(t) =r−1/productdisplay
s=0U((s+1)t/r;st/r),(89)
U(t1;t2) =Texp/parenleftbigg
−i/integraldisplayt2
t1dtH(t)/parenrightbigg
.(90)
First, due to the relation t/(rT)∈ O(1), we can execute
the time-evolution U(t/r,0) =U(t/r) by the algorithm
provided in Section VIA, with setting the desirable error
O(ε/r). To be precise, when we introduce the cutoﬀ LT
for Fourier indices by substituting t/randε/rintotand
εof Eq. (50), which results in
LT∈ O/parenleftbiggαt
r+log(r/ε)
log(e+(αt/r)−1log(r/ε))/parenrightbigg
,(91)
we can organize a unitary gate ULT
s=0such that
ULT
s=0|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htfU(t/r;0)|ψ/a\}brack⌉tri}ht+O(ε/r).
(92)
The cost for ULT
s=0is obtained by t/randε/rintotand
εin Theorem 3.
We repeat this procedurefor the time-evolution U((s+
1)t/r;st/r) froms= 0 tos=r−1. We should be careful
of the change in the time origin When we implement the
time-evolution for each time step [ st/r,(s+ 1)t/r], we
execute Hamiltonian simulation from t′= 0 tot′=t/r
with the following Hamiltonian;
Hs(t′) =/summationdisplay
/vector m∈M/parenleftBig
H/vector me−i/vector m·/vector ωst/r/parenrightBig
e−i/vector m·/vector ωt′.(93)
Each Fourier component H/vector mis replaced by
H/vector me−i/vector m·/vector ωst/r. As a result, it is required to substitute
O/vector me−i/vector m·/vector ωst/rinto the oracle O/vector min the block-encoding
OL
Add[See Eq. (72)]. This can be executed by inserting
the unitary operation exp/parenleftbig
−i/summationtext
/vector m∈M(st/r)|/vector m/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vector m|/parenrightbig
into
OL
Add, and its cost is obtained in a similar way to Section11
VA. Since the resulting cost does not aﬀect the scaling,
implementing each time-evolution U((s+ 1)t/r;st/r)
can be executed with essentially the same cost as U(t/r).
After repetition until s=r−1, we obtain the target
time-evolved state as
r−1/productdisplay
s=0ULT
s|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htf|ψ/a\}brack⌉tri}ht=|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htfU(t)|ψ/a\}brack⌉tri}ht+O(ε).(94)
Let us evaluate the computational cost. First, the
number of ancilla qubits is determined by the ancilla sys-
temsa′andfand the choice of the cutoﬀ LT. We note
that, while each time time-evolution U((s+1)t/r;st/r)
needs the ancilla systems, we need a single pair of a′and
f. This is because the ancilla system is initialized to
|0/a\}brack⌉tri}hta′|/vector0/a\}brack⌉tri}htfat the end of each step by Eq. (94), and can be
reused. Thequerycomplexitycountedbytheoracles O/vector m,
Gcoef, andGfreqis dominated by rtimes implementation
of the time-evolution U((s+1)t/r;st/r). We can specify
its scaling by multiplying the query complexity Eq. (83)
byr=⌈ωt⌉ ∈ O(ωt) under the substitution t→t/rand
ε→ε/r. The number of additional elementary gates is
given in a similar way. Finally, we arrive at the follow-
ing theorem on the cost of Hamiltonian simulation for
Ω(1)-period dynamics.
Theorem 4. (Cost for Ω(1)-period dynamics)
We impose all the assumptions in Section IIIA on
multi-periodic time-dependent Hamiltonians H(t), and
are allowed to use the oracles O/vector m,Gcoef, andGfreq. The
time of interest is supposed to be t∈Ω(1)×T. Then,
we can simulate the time-evolved state U(t)|ψ/a\}brack⌉tri}htfrom ar-
bitrary initial states |ψ/a\}brack⌉tri}ht ∈ Hwith a desirable error up to
O(ε), by the following resources;
•Number of ancilla qubits;
na+O(log(α/ω)+loglog(ωt/ε)).(95)
•Scaling of query complexity Q;
αt+ωtlog(ωt/ε)
log(e+(α/ω+o(log(ωt/ε)))−1log(ωt/ε)).(96)
•Additional gates per query;
O(na+log(α/ω)+loglog(ωt/ε)).(97)
In the query complexity, the o(log(ωt/ε)) term scales as
log(ωt/ε)
log(e+(α/ω)−1log(ωt/ε)). (98)
Let us investigate the optimality of the query com-
plexity and compare it with other algorithms presented
in Table I. The scaling of Eq. (96) in time tunder ﬁxed
εis bounded from above by
αt+ωtlog(ωt)+ωtlog(1/ε). (99)Due to the second quasi-linear term, this scaling is
nearly-optimal rather than optimal in a precise sense.
However, the assumption ω∈ O/parenleftbig
N0/parenrightbig
indicates that the
second term cannot be dominant unless we consider in-
accessible exponentially-large time scale t/greaterorsimilareα/ωT∈
O/parenleftbig
epoly(N)T/parenrightbig
. Therefore, the query complexity is opti-
mal in time twithin practical usage of quantum comput-
ers. On the other hand, the scaling in εis given by
ωtlog(1/ε)
logloglog(1 /ε), (100)
which is nearly-optimal.
When comparing the query complexity with those of
other algorithms, we emphasize that our algorithm again
achieves the additive scaling in the form of
poly(N)t+ωt×o(log(1/ε)), (101)
where we neglect the second term in Eq. (99). Although
it has a product of time tand theo(log(1/ε)) term, it is
suﬃcientlyclosetothetheoretically-bestscalingfortime-
independent systems given by Eq. (13) due to the scale
ω∈ O/parenleftbig
N0/parenrightbig
. Thisalsoconcludesthatouralgorithmsaves
the cost also for Ω(1)-period dynamics compared to the
Dyson-series algorithm yielding the productive scaling as
Eq. (88).
VII. DISCUSSION AND CONCLUSION
In this paper, we establish an eﬃcient and ac-
curate way to simulate multi-periodic time-dependent
Hamiltonians, which include time-periodic and time-
quasiperiodic systems. Exploiting the block-encoding
for each Fourier component as oracles, the algorithm
can be executed with optimal/nearly-optimalquery com-
plexity in time tand allowable error ε. In addition,
it achieves the query complexity with additive scaling
suﬃciently close to the best one for Hamiltonian sim-
ulation, and thereby deals with time-dependency much
more eﬃciently than the truncated-Dyson-series algo-
rithm. While we assume the cutoﬀ mmax∈ O(1) for
Fourier components H/vector m, we expect the same results for
multi-periodic Hamiltonianswith exponentially-decaying
Fourier components such that /bar⌈blH/vector m/bar⌈bl ≤e−O(|/vector m|)in a
similar way to Ref. [28]. Our result provides one sig-
niﬁcant step for understanding the complexity of time-
dependent Hamiltonian simulation. Furthermore, it will
serve a promising application of quantum computers for
condensedmatterphysicsandquantumchemistry; forin-
stance, it will be useful for exploration of nonequilibrium
phenomena in quantum materials [29–33] or preparing
preferable quantum states by adiabatic dynamics [40].
We end up with leaving some future directions. Our
results play a role in extending a class of eﬃciently-
simulatable nonequilibrium systems to multi-periodic
time-dependent systems. It is of great importance12
whether Hamiltonian simulation for otheror all the time-
dependent systems can reach the theoretically-best ad-
ditive query complexity in time tand allowable error ε.
Our success relies on the fact that their time-dependency
is designated by {ei/vector m·/vector ωt}/vector m. This results in a feasible ex-
tendedHilbertspaceequipped withFourierindices {|/vectorl/a\}brack⌉tri}ht}/vectorl,
which can be dealt with QET. A possible direction for
simulatingothertime-dependentHamiltoniansmaybe to
consider those described by a ﬁnite set of basis functions
likeei/vector m·/vector ωt. Once one can ﬁnd a proper ancilla degrees of
freedomandaneﬀectiveHamiltonianforthem, weexpect
that their Hamiltonian simulation can be accelerated by
QET.
We also expect that our algorithm can be a clue to ef-
ﬁciently implementing multi-variable functions of matri-
ces based on QET or QSVT. In the present stage, deal-
ing with multi-variable functions is diﬃcult, except forcases where a set of matrices commutes with one another
[42, 43]. Our algorithm can be viewed as the realization
of the time-evolution U(t), which nontrivially depends
on the non-commutative variables {H/vector m}/vector m∈M. The key
ingredient for this success is to embed multiple variables
into a single variable in an extended Hilbert space, and
to extract a desirable solution from it. We hope that this
strategycan be exploited for QETor QSVT towardsome
other multi-variable functions in broad ﬁelds.
ACKNOWLEDGMENT
We thank K. Fujii for fruitful discussion. K. M. is sup-
ported by RIKEN Special Postdoctoral Researcher Pro-
gram.
[1] R. P. Feynman, Simulating Physics with Computers, Int.
J. Theor. Physics 21, 467 (1982).
[2] B. P. Lanyon, C. Hempel, D. Nigg, M. M¨ uller, R. Ger-
ritsma, F. Z¨ ahringer, P. Schindler, J. T. Barreiro,
M. Rambach, G. Kirchmair, M. Hennrich, P. Zoller,
R. Blatt, and C. F. Roos, Universal digital quantum sim-
ulation with trapped ions, Science 334, 57 (2011).
[3] A. Smith, M. S. Kim, F. Pollmann, and J. Knolle, Sim-
ulating quantum many-body dynamics on a current dig-
ital quantum computer, npj Quantum Information 5, 1
(2019).
[4] F. Arute et al., Observation of separated dynam-
ics of charge and spin in the Fermi-Hubbard model,
arXiv:2010.07965 [quant-ph] (2020).
[5] A. Yu. Kitaev, Quantum measurements and the Abelian
Stabilizer Problem, arXiv:quant-ph/9511026 [quant-ph]
(1995).
[6] R. Cleve, A. Ekert, C. Macchiavello, and M. Mosca,
Quantum algorithms revisited, Proceedings of the Royal
Society of London. Series A: Mathematical, Physical and
Engineering Sciences 454, 339 (1998).
[7] J. Du, N. Xu, X. Peng, P. Wang, S. Wu, and D. Lu,
NMR implementation of a molecular hydrogen quantum
simulation with adiabatic state preparation, Phys. Rev.
Lett.104, 030502 (2010).
[8] B. P. Lanyon and et al., Towards quantum chemistry on
a quantum computer, Nat. Chem. 2, 106 (2010).
[9] P. J. J. O’Malley et al., Scalable Quantum Simulation of
Molecular Energies, Phys. Rev. X 6, 031007 (2016).
[10] S. Lloyd, Universal Quantum Simulators, Science 273,
1073 (1996).
[11] D. S. Abrams and S. Lloyd, Simulation of Many-Body
FermiSystems onaUniversal QuantumComputer, Phys.
Rev. Lett. 79, 2586 (1997).
[12] A. T. Sornborger and E. D. Stewart, Higher-order meth-
ods for simulations on quantum computers, Phys. Rev.
A60, 1956 (1999).
[13] A. M. Childs, Y. Su, M. C. Tran, N. Wiebe, and S. Zhu,
Theory of Trotter Error with Commutator Scaling, Phys.
Rev. X11, 011020 (2021).[14] C. Cˆ ırstoiu, Z. Holmes, J. Iosue, L. Cincio, P. J. Coles ,
and A. Sornborger, Variational fast forwarding for quan-
tum simulation beyond the coherence time, Npj Quan-
tum Inf. 6(2020).
[15] B. Commeau, M. Cerezo, Z. Holmes, L. Cincio, P. J.
Coles, and A. Sornborger, Variational Hamiltonian
Diagonalization for Dynamical Quantum Simulation,
arXiv:2009.02559 [quant-ph] (2020).
[16] K. Mizuta, Y. O. Nakagawa, K. Mitarai, andK. Fujii, Lo-
cal variational quantum compilation of large-scale hamil-
tonian dynamics, PRX Quantum 3, 040302 (2022).
[17] G. H. Low and I. L. Chuang, Hamiltonian simulation by
qubitization, Quantum 3, 163 (2019).
[18] A. Gily´ en, Y. Su, G. H. Low, and N. Wiebe, Quantum
singular value transformation and beyond: exponential
improvements for quantum matrix arithmetics, in Pro-
ceedings of the 51st Annual ACM SIGACT Symposium
on Theory of Computing , STOC 2019 (Association for
Computing Machinery, New York, NY, USA, 2019) pp.
193–204.
[19] J. M. Martyn, Z. M. Rossi, A. K. Tan, and I. L. Chuang,
Grand Uniﬁcation of Quantum Algorithms, PRX Quan-
tum2, 040203 (2021).
[20] D. W. Berry, A. M. Childs, and R. Kothari, Hamilto-
nian Simulation with Nearly Optimal Dependence on
all Parameters, in 2015 IEEE 56th Annual Symposium
on Foundations of Computer Science (ieeexplore.ieee.org,
2015) pp. 792–809.
[21] G. H. Low and I. L. Chuang, Optimal Hamiltonian Sim-
ulation by Quantum Signal Processing, Phys. Rev. Lett.
118, 010501 (2017).
[22] G. H. Low and N. Wiebe, Hamiltonian simulation in the
interaction picture, arXiv:1805.00675 [quant-ph] (2018) .
[23] M. Kieferov´ a, A. Scherer, and D. W. Berry, Simulat-
ing the dynamics of time-dependent Hamiltonians with a
truncated Dyson series, Phys. Rev. A 99, 042314 (2019).
[24] Berry, Childs, Su, Wang, and Wiebe, Time-dependent
Hamiltonian simulation with L1-norm scaling, Quantum
(2020).
[25] J. Haah, M. B. Hastings, R. Kothari, and G. H. Low,
Quantum algorithm for simulating real time evolution of13
latticeHamiltonians, SIAMJ. Comput.,FOCS18(2021).
[26] Y.-H. Chen, A. Kalev, and I. Hen, Quantum Algorithm
for Time-Dependent Hamiltonian Simulation by Permu-
tation Expansion, PRX Quantum 2, 030342 (2021).
[27] J. Watkins, N. Wiebe, A. Roggero, and D. Lee, Time-
dependent Hamiltonian Simulation Using Discrete Clock
Constructions, arXiv:2203.11353 [quant-ph] (2022).
[28] K. Mizuta and K. Fujii, Optimal Hamiltonian simulation
for time-periodic systems, arXiv:2209.05048 [quant-ph]
(2022).
[29] S.-I. Chuand D. A. Telnov, Beyond the Floquet theorem:
generalized Floquet formalisms and quasienergy meth-
ods for atomic and molecular multiphoton processes in
intense laser ﬁelds, Phys. Rep. 390, 1 (2004).
[30] I. Martin, G. Refael, and B. Halperin, Topological Fre-
quency Conversion in Strongly Driven Quantum Sys-
tems, Phys. Rev. X 7, 041008 (2017).
[31] P. J. D. Crowley, I. Martin, and A. Chandran, Topo-
logical classiﬁcation of quasiperiodically driven quantu m
systems, Phys. Rev. B 99, 064306 (2019).
[32] H. Zhao, F. Mintert, and J. Knolle, Floquet time spi-
rals and stable discrete-time quasicrystals in quasiperi-
odically driven quantum many-body systems, Phys. Rev.
B100, 134302 (2019).
[33] D. V. Else, W. W. Ho, and P. T. Dumitrescu, Long-
Lived Interacting Phases of Matter Protected by Mul-
tiple Time-Translation Symmetries in Quasiperiodically
Driven Systems, Phys. Rev. X 10, 021032 (2020).
[34] R. Babbush, C. Gidney, D. W. Berry, N. Wiebe, J. Mc-
Clean, A.Paler, A.Fowler, andH.Neven,EncodingElec-
tronic Spectra in Quantum Circuits with Linear T Com-
plexity, Phys. Rev. X 8, 041015 (2018).
[35] Hoorfar and Hassani, Inequalities on the Lambert W
function and hyperpower function, J. Inequal. Pure and
Appl. Math (2008).
[36] D. W. Berry, A. M. Childs, R. Cleve, R. Kothari, and
R. D. Somma, Exponential improvement in precision for
simulating sparse Hamiltonians, Forum of Mathematics,
Sigma5(2017).
[37] L. K. Grover, Quantum Mechanics Helps in Searching for
a Needle in a Haystack, Phys. Rev. Lett. 79, 325 (1997).
[38] P. Høyer, Arbitrary phases in quantum amplitude ampli-
ﬁcation, Phys. Rev. A 62, 052304 (2000).
[39] G.L. Long, Groveralgorithm with zerotheoretical fail ure
rate, Phys. Rev. A 64, 022307 (2001).
[40] T. Albash and D. A. Lidar, Adiabatic quantum compu-
tation, Rev. Mod. Phys. 90, 015002 (2018).
[41] F. Nathan, R. Ge, S. Gazit, M. Rudner, and M. Kolo-
drubetz, Quasiperiodic Floquet-Thouless Energy Pump,
Phys. Rev. Lett. 127, 166804 (2021).
[42] A. P´ erez-Salinas, D. L´ opez-N´ u˜ nez, A. Garc´ ıa-S´ a ez,
P. Forn-D´ ıaz, and J. I. Latorre, One qubit as a universal
approximant, Phys. Rev. A 104, 012405 (2021).
[43] Z. M. Rossi and I. L. Chuang, Multivariable quantum
signal processing (M-QSP): prophecies of the two-headed
oracle, Quantum 6, 811 (2022).
[44] R. M. Gray, Toeplitz and Circulant Matrices: A Review,
Foundations and Trends ®in Communications and In-
formation Theory 2, 155 (2006).
[45] E. H. Lieb and D. W. Robinson, The ﬁnite group velocity
of quantum spin systems, Commun. Math. Phys. 28, 251
(1972).
[46] Z. Gong and R. Hamazaki, Bounds in nonequi-
librium quantum dynamics, International Jour-nal of Modern Physics B 36, 2230007 (2022),
https://doi.org/10.1142/S0217979222300079.
[47] D. W. Robinson, Properties of propagation of quantum
spin systems, ANZIAM J. 19, 387 (1976).
[48] B. Nachtergaele and R. Sims, Lieb-Robinson bounds
and the exponential clustering theorem, Commun. Math.
Phys.265, 119 (2006).
Appendix
Appendix A: Lieb-Robinson bound in
Floquet-Hilbert space
Here, we prove the inequality Eq. (44) stated in Sec-
tion IVA. The proof is completely similar to that for
time-periodic Hamiltonians, given by Ref. [28]. The
precise statement and its proof for multi-periodic time-
dependent Hamiltonians are given as follows.
Theorem 5. (Lieb-Robinson bound)
We impose all the assumptions on multi-periodic
Hamiltonians H(t) described in Section IIIA. We deﬁne
the parameter γby
γ= sup
/vector x∈[0,2π)n/parenleftbig/vextenddouble/vextenddoubleH(/vector x)−H/vector0/vextenddouble/vextenddouble/parenrightbig
≤α. (A1)
We consider two points /vectorl,/vectorl′∈[L]n, and deﬁne their dis-
tance by that on the n-dimensional torus [ L]nas
dL(/vectorl,/vectorl′) =/radicaltp/radicalvertex/radicalvertex/radicalbtn/summationdisplay
i=1(min{|li−l′
i|,2L−|li−l′
i|})2.(A2)
Then, the transition amplitude is bounded from above
by
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble≤/parenleftBigg
emmaxγt
dL(/vectorl,/vectorl′)/parenrightBiggdL(/vectorl,/vectorl′|)/mmax
,(A3)
in cased(/vectorl,/vectorl′)≥2mmaxγt.
Proof.— We split the eﬀective Hamiltonian by HL=
H0+HIwith
H0=/summationdisplay
/vectorl∈[L]n|/vectorl/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vectorl|f⊗(H/vector0−/vectorl·/vector ωI),(A4)
HI=/summationdisplay
/vector m∈M;/vector m/\⌉gatio\slash=/vector0AddL
/vector m⊗H/vector m. (A5)
We employ the interaction picture based on the unitary
transformation HI(t) =eiH0tHIe−iH0t. The transition
amplitude is evaluated by the Dyson-series expansion as
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble
≤∞/summationdisplay
j=0/integraldisplayt
0dtj.../integraldisplayt2
0dt1/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|HI(tj)...HI(t1)|/vectorl′/a\}brack⌉tri}htf/vextenddouble/vextenddouble/vextenddouble.
(A6)14
By inserting the identity/summationtext
/vectorlj′∈[L]n|/vectorlj′/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vectorlj′|f⊗I, each
integrand is equal to
/a\}brack⌉tl⌉{t/vectorl|HI(tj)...HI(t1)|/vectorl′/a\}brack⌉tri}htf
=/summationdisplay
/vectorl1,...,/vectorlj−1
j−1/productdisplay
j′=0/a\}brack⌉tl⌉{t/vectorlj′+1|HI(tj′)|/vectorlj′/a\}brack⌉tri}ht
,(A7)
where we ﬁx /vectorl0=/vectorl′and/vectorlj=/vectorl. Each term in the right
hand side means transition amplitude from /vectorl′to/vectorlwithj-
time jumps via the path /vectorl′→/vectorl1→...→/vectorlj−1→/vectorlunder
the Hamiltonian HI(t). From the deﬁnitions denoted by
Eqs. (A4) and (A5), HI(t) can induce the shift of /vectorlj′by
/vector m∈Mon the torus [ L]n. Since we assume |/vector m| ≤mmax
for every/vector m∈M, we obtain
/a\}brack⌉tl⌉{t/vectorl|HI(tj)...HI(t1)|/vectorl′/a\}brack⌉tri}htf= 0,ifjmmax<dL(/vectorl,/vectorl′),
(A8)
with the usageof the distance on the torus, dL. Equation
(A6) results in
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble
≤∞/summationdisplay
j=⌈dL(/vectorl,/vectorl′)/mmax⌉/integraldisplayt
0dtj.../integraldisplayt2
0dt1j/productdisplay
j′=1/bar⌈blHI(tj)/bar⌈bl
≤∞/summationdisplay
j=⌈dL(/vectorl,/vectorl′)/mmax⌉(/bar⌈blHI/bar⌈blt)j
j!. (A9)
We next evaluate the operator norm of HI. This is a
kind of multi-dimensional circular matrix [44], according
to the deﬁnition Eq. (A5). We switch the basis from
{|l/a\}brack⌉tri}htf}/vectorl∈[L]nto{|x/a\}brack⌉tri}htf}/vector x∈[L]nby Fourier series as
|/vector x/a\}brack⌉tri}htf=/summationdisplay
/vectorl∈[L]nei2π(/vectorl·/vector x/2L)|l/a\}brack⌉tri}htf. (A10)
Then, the Hamiltonian HIis block-diagonalized in this
basis as
HI=/summationdisplay
/vector x∈[L]n|/vector x/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vector x|f⊗
/summationdisplay
/vector m∈M;/vector m/\⌉gatio\slash=/vector0H/vector me−i2π(/vector m·/vector x/2L)

=/summationdisplay
/vector x∈[L]n|/vector x/a\}brack⌉tri}ht/a\}brack⌉tl⌉{t/vector x|f⊗/parenleftbigg
H/parenleftbiggπ/vector x
L/parenrightbigg
−H/vector0/parenrightbigg
.(A11)We obtain /bar⌈blHI/bar⌈bl ≤γfrom its deﬁnition Eq. (A1). Un-
der the assumption dL(/vectorl,/vectorl′)≥2mmaxγtand the notation
jmin=⌈dL(/vectorl,/vectorl′)/mmax⌉, this relation leads to
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble≤∞/summationdisplay
j=jmin(γt)j
j!
≤(γt)jmin
jmin!∞/summationdisplay
j=jmin/parenleftbigg1
2/parenrightbiggj−jmin
≤2(γt)jmin
jmin!. (A12)
Using the inequality 2 xj/j!≤(ex/j)jforx >0 and
j∈N, originating from the Stiring formula, we arrive
at the inequality Eq. (A3), which completes the proof.
/square
We brieﬂy explain the origin of this bound. The ef-
fective Hamiltonian HLcan be viewed as the one de-
scribing quantum walk on an n-dimensional lattice. In
this picture, each Fourier index /vectorl∈[L]nand each Fourier
component H/vector mrespectivelyplayrolesofalatticesiteand
hopping by a vector /vector m. The assumption |/vector m| ≤mmaxim-
plies that the hopping is ﬁnite-ranged. As a result, the
inequality Eq. (A3) corresponds to the Lieb-Robinson
bound on the transition amplitude of a n-dimensional
quantum walk with ﬁnite-ranged hopping [45, 46], and
this is why we refer to Theorem 5 as the Lieb-Robinson
bound.
Similarly, when we assume /bar⌈blH/vector m/bar⌈bl ≤e−O(/vector m)for ev-
ery/vector minstead of H/vector m= 0 for |/vector m|> mmax, we ex-
pect the Lieb-Robinson bound corresponding to an n-
dimensional quantum walk with exponentially-decaying
quantum walk as
/vextenddouble/vextenddouble/vextenddouble/a\}brack⌉tl⌉{t/vectorl|e−iHLt|/vectorl′/a\}brack⌉tri}ht/vextenddouble/vextenddouble/vextenddouble≤Const.×e˜αt−dL(/vectorl,/vectorl′)/ξ(A13)
with some constants ˜ α∈poly(N) andξ∈ O(1)
[47, 48]. As discussed in Ref. [28] for time-periodic
Hamiltonians, this relation leads to a proper cutoﬀ
L∈ O(˜αt+log(1/ε)) for the Floquet-Hilbert space
to accurately reproduce the dynamics within the error
O(ε). Therefore, as a consequence of universality of
the Lieb-Robinson bound, we expect that our protocol
achieves the additive query complexity in the form of
O(αt+log(1/ε)) [ωt∈ O(1)] orO(αt+ωtlog(ωt/ε))
[ωt∈Ω(1)] also for time-dependent Hamiltonians sat-
isfying/bar⌈blH/vector m/bar⌈bl ≤e−O(|/vector m|).