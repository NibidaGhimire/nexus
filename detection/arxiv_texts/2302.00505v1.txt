arXiv:2302.00505v1  [math.NT]  1 Feb 2023On Pisot Units and the Fundamental Domain of Galois
Extensions of Q
Christian Porter, Alexandre Bali, Alar Leibak
February 2, 2023
Abstract
In this paper, we present two main results. Let Kbe a number ﬁeld that is Galois
overQwith degree r+2s, whereris the number of real embeddings and sis the number
of pairs of complex embeddings. The ﬁrst result states that t he number of facets of
the reduction domain (and therefore the fundamental domain ) ofKis no greater than
O/parenleftbigg/parenleftBig
1
2(r+s−1)δ(r+s)1+1
2(r+s−1)/parenrightBigr+s−1/parenrightbigg
·/parenleftBig
e1+1
2e/parenrightBigr+s
(r+s)!, where δ= 1/2ifr+s≤11
orδ= 1 otherwise. The second result states that there exists a li near time algorithm to
reduce a totally positive unary form axx∗, such that the new totally positive element a′
that is equivalent to ahas trace no greater than a constant multiplied by the intege r
minimum of the trace-form Tr( axx∗), where the constant is determined by the shortest
Pisot unit in the number ﬁeld. This may have applications in r ing-based cryptography.
Finally, we show that the Weil height of the shortest Pisot un it in the number ﬁeld can be
no greater than1
[K:Q]/parenleftbigg
γ
2(r+s−1)δ−1
2(r+s−1)R1
r+s−1
K+(r+s−1)ǫ/parenrightbigg
, whereRKdenotes
the regulator of K,γ= 1 ifKis totally real or 2 otherwise, and ǫ >0 is some arbitrarily
small constant.
1 Introduction
LetKbe an algebraic ﬁeld of degree n=r+ 2s(whereris the number of real embeddings
andsis the number of pairs of complex embeddings) over Qwith ring of integers OKand unit
groupO∗
K. We associate to Kthe canonical embeddings σ1,...,σ r,σr+1,...,σ r+s,...,σ r+2s
intoC, whereσr+s+k(x) =σr+k(x)∗for all 1≤k≤sand∗denotes the complex conjugate.
Deﬁne byKR=K⊗QR. Note that KR=Rr×Cs. We deﬁne the canonical involution
∗:KR→KRthat acts as the identity on Rrand acts as complex conjugation on Cs. For any
α= (α1,...,α r+s),β= (β1,...,β r+s)∈KR, deﬁneαβ= (α1β1,α2β2,...,α r+sβr+s). We say
an element α= (α1,...,α r+s)∈KRis totally positive if every αi∈R+. Throughout the paper,
we will assume that any number ﬁeld Kthat we consider is Galois over Q. In fact, the only
lemma that requires this property is Lemma 3, but unfortunately th is lemma is crucial to prove
the result of the paper, so we must restrict ourselves to such ﬁeld s.
Consider
Tr(axx∗), x,a∈KR,
1whereais a totally positive element. This generates a real positive-deﬁnite q uadratic form of
dimensionr+s. We callaxx∗a unary form.
We will set OKRto be the set of elements ( σ1(x),...,σ r+s(x)), wherex∈ OK, andO∗
KRthe
set of elements ( σ1(u),...,σ r+s(u)) such that u∈ O∗
K. Then a totally positive element ais said
to be reduced if it satisﬁes
Tr(a)≤Tr(avv∗), (1)
forallv∈ O∗
KR. Ifv= (σ1(u),...,σ r+s(u)),weusethenotation v−1= (σ1(u−1),...,σ r+s(u−1))∈
O∗
KR. We say that two totally positive elements a,a′are equivalent if a′=avv∗for some
v∈ O∗
KR. Note then that since a=a′v−1v−1∗,acan be considered by its equivalence class,
where equivalence is determined by multiplying abyvv∗wherev∈ O∗
KR, and so the real
quadratic forms Tr( axx∗),Tr(a′xx∗) are equivalent. The reduction domain of KR, denoted
FKR, is the set of all reduced totally positive elements of KR, and so clearly every positive
element is equivalent to an element in FKR. Note that the reduction domain is a fundamental
domain for the set of totally positive elements of K. The reduction domain is known to be the
union of ﬁnitely many perfect cones ([2, Satz 4]). In [3], an upper bou nd on the number of
perfect unary forms in any given totally real number ﬁeld was deter mined. The facets of the
coneFKare deﬁned by the inequalities 1, and it is known that the number of fa cets of the
reduction domain are ﬁnite in number, meaning that only ﬁnitely many in equalities need to be
satisﬁed in order to determine whether or not a unary form is reduc ed.
Letx∈ OKbe an algebraic integer of K. We say that xis a Pisot-Vijayaraghavan number
(shortened to a Pisot number) if the absolute value of xis greater than 1, but the absolute value
of all its Galois conjugates, except for the conjugates that corr espond to complex conjugation,
have absolute value less than 1. We say that xis a Pisot unit if x∈ O∗
K.
By Dirichlet’s unit theorem, we know that the rank of O∗
Kisr+s−1. Suppose then that
O∗
Kis multiplicatively generated by the elements u1,u2,...,u r+s−1andζwhereζis some root
of unity in OK. Consider the logarithmic embedding:
Log :K→Rr+s: Log(x) =(log(|σ1(x)|),log(|σ2(x)|),...,log(|σr(x)|),
2log(|σr+1(x)|),2log(|σr+2(x)|),...,2log(|σr+s(x)|)).
Then note that under the logarithmic embedding, Λ K:= Log(O∗
K) generates a lattice in the
space
V=/braceleftBigg
(x1,...,x r+s)∈Rr+s:r+s/summationdisplay
i=1xi= 0/bracerightBigg
. (2)
Let/⌊ard⌊lv/⌊ard⌊lbe thelpnorm of an element v∈Rr+s. Throughout the paper, we will use the notation
ρp(Λ) = max
x∈Wmin
v∈ΛK/⌊ard⌊lx−v/⌊ard⌊lp
for any lattice Λ, where Wis the space in which Λ is full-rank. We will also make use of the
notation
λi,K(Λ) = min {c∈R≥0: dim(Λ∩cK) =i},
2which is called the ith successive minima of Λ, and Kis some 0-symmetric convex body. We
will use the notation λi,p(Λ) to denote the ith successive minima of Λ with respect to the convex
body drawn out by the lp-norm.
The aim of this paper is to prove the following results.
Theorem 1. LetNKdenotes the number of facets of the reduction domain of KR. Then
NK<2(r+s−1)
+2
1
2(r+s−1)δ(r+s)1−1
2(r+s−1)+r+s−1
2log/parenleftbigr+s+1
r+s−1/parenrightbig
R1
r+s−1
K+log/parenleftbigr+s−1
2/parenrightbig
R1
r+s−1
K
r+s−1
·(r+s)⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
,
where
δ=/braceleftBigg
1/2,1≤r+s−1≤10,
1,10<r+s−1.
andRKis the regulator of K.
Using Lemma 9, and the fact that RK>0.2052...for all number ﬁelds K[11], this gives
us
NK<O/parenleftBigg/parenleftbigg1
2(r+s−1)δ(r+s)1−1
2(r+s−1)/parenrightbiggr+s−1/parenrightBigg
·/parenleftBig
e1+1
2e/parenrightBigr+s
(r+s)!.
Numerical evidence seems to suggest that the term/parenleftBig
e1+1
2e/parenrightBigr+s
can also be dropped in the
expression above.
The logarithmic Weil height of an algebraic number xinKis deﬁned by
h(x) =1
[K:Q]/parenleftBiggr/summationdisplay
i=1log+|σi(x)|+2s/summationdisplay
i=1log+|σi(x)|/parenrightBigg
,
where log+(α) = max{log(α),0}. We also prove the following interesting proposition, bounding
the height of the Pisot unit with the smallest Weil height.
Proposition 1. For allǫ>0, there exists a Pisot unit with Weil height h(u)satisfying
h(u)≤1
[K:Q]/parenleftbiggγ
2(r+s−1)δ−1
2(r+s−1)R1
r+s−1
K+(r+s−1)ǫ/parenrightbigg
,
whereδis deﬁned as before, and γ= 1ifKis totally real, or γ= 2ifKis totally complex.
Using ideas outlined inthis work, we also provide analgorithmto reduce unary forms, which
could have applications in ring-based cryptography (see e.g. [4], [5], [6 ]).
3Theorem 2. For any totally positive element a∈KR, deﬁne by
µ(a)/definesmin
x∈OKR\{0}Tr(axx∗).
Then given a totally positive element a, a Pisot unit uand some parameter minj/\e}atio\slash=1|σj(u)|2<
δ <1, there exists an algorithm that computes an equivalent elem enta′such that
Tr(a′)≤max/braceleftbiggtK(u,δ)2
minx∈STr(xx∗),1/bracerightbigg
µ(a), (3)
where
tK(u,δ) =/radicalBigg
1+|u|2−δ
δ−maxj/\e}atio\slash=1|σj(u)|2,
andSdenotes the elements of OKRthat do not correspond to roots of unity or zero in OK.
Also, if
µ(a) =Tr(axx∗)
for somex∈ OKR, then
Tr(xx∗)≤tK(u,δ)2.
Moreover, the algorithm takes at most O(log(X)((r+s+1)log(X)+(r+s)log(max i|σi(u)|)))
bit operations, where X= max iai, wherea= (a1,...,a r+s).
2 Reduction of Unary Forms Via Pisot Units, and Some
Useful Lemmas
Proposition 2. IfKis not either Qor imaginary quadratic (i.e. has a nontrivial unit group),
then for any ε>0, there exists a Pisot unit usuch that
e(r+s−2)ρ∞(ΛK)+(r+s−1)ε≤|u| ≤e(r+s)ρ∞(ΛK)+(r+s−1)ε,
e−(2ρ∞+ε)≤|σi(u)| ≤e−ε,
for alli/ne}ationslash= 1.
Proof.Ifuis a Pisot unit, then clearly log( |u|)>0 and log( |σ(u)|)<0 for any Galois conjugate
σthat does not correspond to complex conjugation. Let x= (x1,...,x r+s) be an element of
V. By deﬁnition,/summationtextr+s
i=1xi= 0, and
min
w∈ΛK/⌊ard⌊lx−w/⌊ard⌊l∞=/⌊ard⌊lx−v/⌊ard⌊l∞= max
1≤i≤r+s|xi−vi| ≤ρ∞(ΛK),
4for some appropriate v= (v1,...,v r+s)∈ΛK. Setx1= (r+s−1)ρ∞(ΛK)+(r+s−1)ε,x2=
x3=···=xr+s=−ρ∞(ΛK)−εfor someε>0. Then we must have
|(r+s−1)ρ∞(ΛK)−v1+(r+s−1)ε| ≤ρ∞(ΛK),
|v2+ρ∞(ΛK)+ε| ≤ρ∞(ΛK),
|v3+ρ∞(ΛK)+ε| ≤ρ∞(ΛK),
...
|vr+s+ρ∞(ΛK)+ε| ≤ρ∞(ΛK).
Clearlyρ∞(ΛK) is nonzero if Kis not either Qor imaginary quadratic, so these inequalities
yield the following inequalities:
0<(r+s−2)ρ∞(ΛK)+(r+s−1)ε≤v1≤(r+s)ρ∞(ΛK)+(r+s−1)ε,
−2ρ∞(ΛK)−ε≤v2≤ −ε<0,
−2ρ∞(ΛK)−ε≤v3≤ −ε<0,
...
−2ρ∞(ΛK)−ε≤vr+s≤ −ε<0,
which proves the lemma.
Lemma 3. Suppose that a= (a1,a2,...,a r+s)∈KRis a totally positive element. Let u∈ O∗
K
be a Pisot unit and suppose that
Tr(aviv∗
i)≥Tr(a),
for all1≤i≤r+2swhereviis the element of KRobtained by embedding σi(u)intoKR. Let
tK(u) =/radicalBigg
1+|u|2−1
1−max2≤j≤r+s|σj(u)|2.
Then for any x∈KRsatisfying Tr (xx∗)≥tK(u)2, Tr(axx∗)≥Tr(a).
Proof.By assumption, for each 1 ≤i≤r+2s,
Tr(aviv∗
i) =/parenleftBiggr/summationdisplay
j=1+2r+s/summationdisplay
j=r+1/parenrightBigg
aj|σj(σi(u))|2≥Tr(a) =/parenleftBiggr/summationdisplay
j=1+2r+s/summationdisplay
j=r+1/parenrightBigg
aj
⇐⇒/parenleftBiggr/summationdisplay
j=1+2r+s/summationdisplay
j=r+1/parenrightBigg
aj(|σj(σi(u))|2−1)≥0.
Suppose that |σk(σi(u))|=|u|for some value of k. Then
(|u|2−1)ak≥/parenleftBiggr/summationdisplay
j/\e}atio\slash=k=1+2r+s/summationdisplay
j/\e}atio\slash=k=r+1/parenrightBigg
aj≥(1−max
j/\e}atio\slash=1|σj(u)|2)/parenleftBiggr/summationdisplay
j/\e}atio\slash=k=1+2r+s/summationdisplay
j/\e}atio\slash=k=r+1/parenrightBigg
aj
⇐⇒Tr(a)≤tK(u)2ak.
5By cycling through all values 1 ≤i≤r+s, we attain the above inequality for all 1 ≤k≤r+s,
and so ifx= (x1,...,x r+s)∈KRand Tr(xx∗)≥tK(u)2,
Tr(axx∗) =r+s/summationdisplay
j=1aj|xj|2≥tK(u)−2Tr(a)r+s/summationdisplay
j=1|xj|2=tK(u)−2Tr(a)Tr(xx∗)≥Tr(a),
as required.
Lemma 4. Letρ∞(Λ)denote the covering radius in the l∞norm of a lattice Λof ranknwith
volume Vol (Λ), and also assume that Λis well-rounded (that is, the successive minima are all
equal in value). Then
ρ∞(Λ)≤/braceleftBigg√n
2Vol(Λ)1
n,1≤n≤10,
n
2Vol(Λ)1
n,10<n.(4)
Proof.To prove the ﬁrst inequality, note ﬁrst that ρ∞(Λ)≤ρ2(Λ). It was shown in [7] that
ρ2(Λ)≤√n
2Vol(Λ) for all rank nlattices, where n≤10.
For the second case, note ﬁrst that λi,∞(Λ)≤λi,2(Λ)≤√nλi,∞(Λ). It is well-known that
ρ2(Λ)≤√n
2λn,2(Λ),
and since Λ is assumed to be well-rounded, we get
ρ∞(Λ)≤ρ2(Λ)≤√n
2λn,2(Λ)≤n
2λn,∞(Λ) =n
2λ1,∞.
It is also well-known that λ1,∞≤Vol(Λ)1
nfor any lattice Λ, and so the second inequality
holds.
Lemma 5 ([8]).LetC(R)denote the n-dimensional hypercube of side-length R, and letV
denote then−1-dimensional half-plane as in 2. Then
Vol(C(R)∩V) =Rn−1√n
(n−1)!⌊n
2⌋/summationdisplay
k=0(−1)k/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1
.
Lemma 6 ([9]).LetKbe a convex 0-symmetric body of rank n. Then
|K∩Zn| ≤n!Vol(K)+n.
3 Determiningan UpperBoundon theNumberofFacets
ofFK
Proof of Theorem 1. By Lemma 3, any totally positive element a= (a1,...,a r+s)∈ FKhas
Tr(axx∗)≥Tr(a),
6for allx∈KR,Tr(xx∗)≥t2
K, wheretK= min u∈PtK(u) andPis the set of all Pisot units of K.
Therefore, if u∈ O∗
KRdetermines a facet of the reduction domain it must satisfy
Tr(uu∗)≤t2
K⇐⇒log(Tr(uu∗))≤2log(tK).
Letǫ(u) = max i{|σi(u)|,1/|σi(u)|: 1≤i≤r+s}. Then exactly half of the (nontrivial)
unit group satisfy ǫ(u) = max i|σi(u)|and exactly half of them satisfy ǫ(u) = max i|σi(u)|−1,
since ifǫ(u) = max i|σi(u)|thenǫ(1/u) = max i|σi(u)|−1. We consider only units that satisfy
ǫ(u) =|σi(u)|, so
2log(tK)≥log(Tr(uu∗))≥2/⌊ard⌊lLog(u)/⌊ard⌊l∞,
so the only possible units satisfying ǫ(u) = max i|σi(u)|that can possibly constitute facets of
the reduction domain must satisfy /⌊ard⌊lLog(u)/⌊ard⌊l∞≤log(tK). Hence, we want to determine the
number of lattice points of Λ Kare contained within the convex body
C=/braceleftbig
x∈Rr+s:/⌊ard⌊lx/⌊ard⌊l∞≤log(tK)/bracerightbig
. (5)
Now, since Λ Kis of full-rank in the half plane Vas described in 2, we need to consider the
0-symmetric convex body C∩V. By Lemma 5, this shape has volume equal to
Vol(C∩V) =log(tK)r+s−1√r+s
(r+s−1)!⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
.
We apply the transform that takes Λ Kto the set Zr+s−1, rotated in Rr+sso that it sits within
the half-plane V. Then applying a similar transform to the convex body C∩Vgives us the
new convex body Kwhich has volume
Vol(K) =log(tK)r+s−1(r+s)
RK(r+s−1)!⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
,
whereRKis the regulator of the ﬁeld K, using the fact that Vol(Λ K) =RK/√r+s(see [10]).
Then by Lemma 6, the number of integer lattice points inside Kis upper bounded by
r+s−1+log(tK)r+s−1(r+s)
RK⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
.
It remains to prove a bound on log( tK). Clearly, since max j/\e}atio\slash=1|σj(u)|2<1 for any Pisot unit u,
1<1
1−maxj/\e}atio\slash=1|σj(u)|2,
so
tK= min
u∈P/radicalBigg
1+|u|2−1
1−maxj/\e}atio\slash=i|σj(u)|2<min
u∈P/radicalBigg
|u|2
1−maxj/\e}atio\slash=1|σj(u)|2,
7wherePdenotes the set of Pisot units of K. Hence by Lemma 2, we must have
log(tK)<(r+s)ρ∞(Λ)+(r+s−1)ǫ−log(1−e−2ǫ),
for anyǫ>0. The right-hand side of the above inequality attains its minimum at ǫ=1
2(log(r+
s+1)−log(r+s−1)), for which we get
log(tK)<(r+s)ρ∞(Λ)+r+s−1
2log/parenleftbiggr+s+1
r+s−1/parenrightbigg
+log/parenleftbiggr+s−1
2/parenrightbigg
.
Finally, by Lemma 4 and the fact that the log-unit lattice is well-rounde d with respect to the
inﬁnity norm (since Kis Galois, if say Log( u) is the minimum vector, then Log( σi(u)) has
identical length with respect to the inﬁnity norm, and there are r+s−1 linearly independent
vectors of this form),
ρ∞(ΛK)≤

√r+s−1
2√r+s1
r+s−1R1
r+s−1
K,1≤r+s−1≤10,
(r+s−1)
2√r+s1
r+s−1R1
r+s−1
K,10<r+s−1.
Then since we have counted exactly half of the required integer latt ice points, we get
NK<2(r+s−1)
+2
1
2(r+s−1)δ(r+s)1−1
2(r+s−1)+r+s−1
2log/parenleftbigr+s+1
r+s−1/parenrightbig
R1
r+s−1
K+log/parenleftbigr+s−1
2/parenrightbig
R1
r+s−1
K
r+s−1
·(r+s)⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
,
where
δ=/braceleftBigg
1/2,1≤r+s−1≤10,
1,10<r+s−1.
3.1 The Special Case of [K:Q] = 3
The case where [ K:Q] = 3 can be treated separately, as in this case, every element of th e unit
group is either ±1, a Pisot unit, the inverse of a Pisot unit, the conjugate of a Pisot u nit or the
inverse conjugate of a Pisot unit. We begin by proving the following us eful lemma.
Lemma 7. Suppose that b1= (α,β,−α−β)andb2= (γ,δ,−γ−δ)for someα,β,γ,δ ∈R
satisfying |α|,|β|,|γ|,|δ|,|α+β|,|γ+δ|>0, and assume that b1,b2are linearly independent
overR. Suppose that b1,b2satisfy
/⌊ard⌊lb1/⌊ard⌊l∞≤ /⌊ard⌊lb2/⌊ard⌊l∞≤ /⌊ard⌊lb1±b2/⌊ard⌊l∞. (6)
Letv=xb1+yb2, forx,y∈Z. Then unless (|x|,|y|)are in the following set:
S={(0,0),(1,0),(0,1),(1,1),(2,1),(1,2)}, (7)
/⌊ard⌊lv/⌊ard⌊l∞≥2λ∞.
8Proof.See appendix.
Now, letKbe a number ﬁeld of degree 3 over Q. Suppose that the vectors b1,b2generate
Log(O∗
K), andsupposethat b1,b2satisfy6without lossofgenerality. Let udenotetheunitthat
corresponds to the shortest non-zero element of Log( O∗
K), under the logarithmic embedding.
We may assume that uis a Pisot unit, as otherwise uis either the inverse or a conjugate (or
both) of a Pisot unit, which does not aﬀect the length of the element under the logarithmic
embedding. Note then that
tK(u) =/radicalBigg
1+|u|2−1
1−maxj/\e}atio\slash=1|σj(u)|2</radicalBigg
1+|u|2−1/producttext
j/\e}atio\slash=1(1−|σj(u)|2).
SinceKis Galois,Kmust be totally real. Clearly 1 −u2is an algebraic integer, so |NmK/Q(1−
u2)| ≥1, which gives
|NmK/Q(1−u2)|= (u2−1)/productdisplay
j/\e}atio\slash=1(1−σj(u)2)≥1⇐⇒/productdisplay
j/\e}atio\slash=1(1−σj(u)2)≥(u2−1)−1,
and so
tK(u)</radicalbig
1+(u2−1)2.
Assume without loss of generality that
Tr(au2)≥Tr(a)
(this may be done without loss of generality, as otherwise we may ﬁnd an equivalent totally
positive element a′such that this holds). Given that /⌊ard⌊lLog(u)/⌊ard⌊l∞=λ∞
1by construction, by
a similar argument as the one posed in the previous section that lead t o us constructing the
convex body in 5, we are looking for integer solutions to the inequality
/⌊ard⌊lxb1+yb2/⌊ard⌊l∞≤1
2log(1+(σi(u)2−1)2) =1
2log(1+(exp(2 λ∞)−1)2),
which gives
/⌊ard⌊lxb1+yb2/⌊ard⌊l∞
λ∞≤1
2log((1+(exp(2 λ∞)−1)2)1/λ∞).
The right hand side of the inequality tends to 2 as λ∞→ ∞, and so the solutions ( x,y) to the
above equation have absolute values that are limited to those in the s etSin 7.
4 A Linear Complexity Reduction Algorithm
Whilst usually we say that a form axx∗is reduced if a∈ FKR, the notion of reduction can also
be deﬁned more broadly. For example, types of reduction of (ratio nal) quadratic forms include
Minkowski [12], Korkin-Zolotarev [13] and Lenstra-Lovasz-Lovas z (LLL) [14]. We present a
very simple algorithm that, given some totally positive element a∈KR, ﬁnds an equivalent
totally positive element a′with “desirable” properties.
9Algorithm 1: A simple reduction algorithm.
input : A totally positive element a∈KR, a unitu∈ O∗
Kand its associated elements
vi∈ O∗
KR, whereviis the result of embedding σi(u) intoKR, and some real
constant 0<δ≤1.
output: A totally positive element a′that is equivalent to a.
1Setj= 1.
2Ifj=r+s, returnaand end the algorithm.
3If Tr(avjvj∗)<δTrK/Q(a), seta→avjv∗
jand return to step 1. Otherwise, set
j→j+1 and return to step 2.
Proposition 3. With inputs δ,bandu, assuming that δis strictly less than 1, algorithm 1
performs at most O(log(X)((r+s+1)log(X)+(r+s)log(max i|σi(u)|)))bit operations, where
X= max iai, wherea= (a1,...,a r+s).
Proof.Clearlyeachfullroundofthealgorithmeitherresultsintheterminat ionofthealgorithm,
or we ﬁnd some equivalent a′such that Tr( a′)< δTr(a), and so since δ <1 the algorithm
can only perform O(log(X)) rounds. In the worst case, a full round would require us to
compute the value of Tr( avjv∗
j)r+stimes. The values of aiare bounded above by Xand
the values of |σj(u)|are bounded above by max j|σj(u)|, so a round can have a maximum of
O((r+s)log(max i|σi(u)|)+(r+s+1)log(X)) bit computations.
Theorem 8. Supposethatalgorithm 1takes asinput atotally positiveel ementa= (a1,a2,...,a r+s)∈
KR, a Pisot unit u, and some parameter 0< δ≤1, and outputs some a′= (a′
1,a′
2,...,a′
r+s)
equivalent to a. Denote by
µ(a)/definesmin
x∈OKR\{0}Tr(axx∗).
Then
Tr(a′)≤max/braceleftbiggtK(u,δ)2
minx∈STr(xx∗),1/bracerightbigg
µ(a), (8)
where
tK(u,δ) =/radicalBigg
1+|u|2−δ
δ−maxj/\e}atio\slash=1|σj(u)|2,
andSdenotes the elements of OKRthat do not correspond to roots of unity or zero in OK.
Moreover, if
µ(a) =Tr(axx∗)
for somex∈ OKR, then
Tr(xx∗)≤tK(u,δ)2. (9)
10Proof.First, by an argument similar to that in Lemma 3, each a′
ifor 1≤i≤r+smust satisfy
a′
i≥Tr(a′)tK(u,δ)−2.
Suppose that x= (x1,...,x r+s)∈ OKRis the element that satisﬁes Tr( a′xx∗) =µ(a). Clearly,
inequality 8 holds if xcorresponds to a root of unity in OK, so we assume that x∈ S. Then
µ(a) = Tr(a′xx∗) =/parenleftBiggr/summationdisplay
j=1+2r+s/summationdisplay
j=r+1/parenrightBigg
a′
ixix∗
i≥tK(u,δ)−2Tr(a′)/parenleftBiggr/summationdisplay
j=1+2r+s/summationdisplay
j=r+1/parenrightBigg
xix∗
i.
Inequalities 8 and 9 follow.
References
[1] Vavra, T., Veneziano, F.: “Pisot unit generators in number ﬁelds” . Journal of Symbolic
Computation, vol. 89, pp. 94–109 (2018).
[2] Koecher, M.: “Beitr¨ agezu einer Reduktionstheorie in Positivit¨ a tsbereichen. I”. Math. Ann.,
vol. 141, pp. 384–432 (1960).
[3] Porter, C., Mendelsohn, A.: “An Upper Bound on the Number of Cla sses of Perfect Unary
Forms in Totally Real Number Fields”. Preprint.
[4] Cramer R., Ducas L., Peikert C., and Regev O.: “Recovering Short G enerators of Principal
Ideals in Cyclotomic Rings”. In Proceedings of the 35th Annual Inte rnational Conference
on Advances in Cryptology — EUROCRYPT 2016 - Volume 9666. Springe r-Verlag, Berlin,
Heidelberg, 559–585.
[5] Kim, T., Lee, C., “Lattice reduction over Euclidean rings with applica tions to cryptanaly-
sis”, Cryptography and Coding, 16th IMA International Confere nce, vol. 10655, pp. 371–391
(2017).
[6] Porter, C., Leibak, A., Ling, C.: “Reduction Theory of Free Module s over Unit-Reducible
Fields”. Preprint, https://arxiv.org/abs/2111.06937 .
[7] Kathuria, L., Raka, M.: “On conjectures of Minkowski and Woods forn= 10”. Proceedings
in Mathematical Sciences, vol. 132, no. 45 (2022).
[8] achille hui: “The volume of an n-dimensional unit hypercube intersected with the plane/summationtextn
i=1xi= 0”.Mathematics StackExchange https://math.stackexchange.com/q/4611874
(2023).
[9] Blichfeldt, H.F.: “A new principle in the geometry of numbers, with so me applications”.
Trans. Amer. Math. Soc., vol. 15, no. 3, pp. 227-235 (1914).
[10] Neukirch, J.: “Algebraic Number Theory”. Transl. from the Ger man by Norbert Schap-
pacher, vol 322. Berlin: Springer (1999).
11[11] Friedman, E.: “Analytic formulas for the regulator of a number ﬁ eld”. Invent. Math., vol.
98, pp. 599–622 (1989).
[12] Minkowski, H.: “Geometrie der Zahlen”. Leipzig-Berlin, B.G. Teubn er Verlag (1910).
[13] Lagarias, J.c., Lenstra, H.w., Schnorr, C.P.: “Korkin-Zolotarev bases and successive min-
ima of a lattice and its reciprocal lattice”. Combinatorica, vol. 10, pp . 333-348 (1990).
[14] Lenstra, A.K., Lenstra, H.W., Lov´ asz, L.: “Factoring polynomia ls with rational coeﬃ-
cients”, Mathematische Annalen 261(4), pp. 515–534 (1982).
Appendix
Proof of Lemma 7. Throughout this proof, we will let v=xb1+yb2for some integer pair
(x,y)∈Z2. Our method of proof is to assume that we have a pair ( x,y) that is not contained
inSsuch that /⌊ard⌊lv/⌊ard⌊l∞<2λ∞, such that b1,b2obey the inequalities 6, and to show that we
come by a contradiction. We omit the case where either xoryis zero, since obviously then
we will come by a contradiction. We may freely assume throughout th at/⌊ard⌊lb1/⌊ard⌊l∞=α>0. We
will assume throughout that /⌊ard⌊lb2/⌊ard⌊l∞<2/⌊ard⌊lb1/⌊ard⌊l∞, as otherwise, since it was shown in [ ?] under
the assumption that inequalities 6 holds we have /⌊ard⌊lxb1+yb2/⌊ard⌊l∞≥ /⌊ard⌊lb2/⌊ard⌊lfor all nonzero x,y, we
would come to a contradiction.
Throughout the next part of the proof, we will assume that /⌊ard⌊lb2/⌊ard⌊l∞=γ >0, as we can force
γto be positive by a switch of signs. By 6, at least one of the following ine qualities holds:
|α−γ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞,, (10)
|β−δ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞, (11)
|α+β−γ−δ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞. (12)
Clearly, since γ >0 andγ=/⌊ard⌊lb2/⌊ard⌊l<2α, clearly 10 cannot hold. So, the inequalities we have
to possibly consider are
|β−δ| ≥γ,, (13)
|α+β−γ−δ| ≥γ. (14)
Assume that holds. Since |α+β| ≤α, we must have β <0, so necessarily we must also have
thatδ >0. But|γ+δ| ≤γalso implies that δ <0, which is a contradiction. So instead assume
that holds. Then
max{α+β−γ−δ,γ+δ−α−β} ≥γ.
But this cannot hold:
α+β−γ−δ≥γ⇐⇒α>α+β≥2γ+δ,
but|γ+δ| ≤γimplies that δ <0, so this would imply that α > γwhich is a contradiction,
and
γ+δ−α−β≥γ⇐⇒δ≥α+β >0,
12but again we need δ <0, which is a contradiction. Hence, it cannot hold that γ=/⌊ard⌊lb2/⌊ard⌊l∞.
Throughout the next part of the proof, we will assume that /⌊ard⌊lb2/⌊ard⌊l∞=δ >0, as we can force
δto be positive by a switch of signs, and we stop assuming any sign on γ. In fact, |γ+δ| ≤δ
necessarily implies that γ <0 now. By 6, at least one of the following inequalities hold:
|α+γ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞, (15)
|β+δ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞, (16)
|α+β+γ+δ| ≥ /⌊ard⌊lb2/⌊ard⌊l∞. (17)
Sinceγ <0 andα≤δ, clearly 15 cannot hold. Moreover, clearly 16 cannot hold since
necessarily β <0. So the only case we need to consider here is
|α+β+γ+δ| ≥δ.
Sinceα≥ −βandδ≥ −γ,
α+β+γ+δ≥δ⇐⇒α≥ −β−γ
Hence, ifx,yare of opposite signs,
/⌊ard⌊lv/⌊ard⌊l∞≥max{|x|α+|y||γ|,|x||β|+|y|δ},
which is greater than or equal to 2 λ∞if min{|x|,|y|} ≥2, so we assume that x,yare of the
same sign. Then
/⌊ard⌊lv/⌊ard⌊l∞≥ ||x|(α+β)+|y|(γ+δ)| ≥ |x|α+|y|δ−max{|x|,|y|}α≥min{|x|,|y|}α,
which is greater than or equal to 2 λ∞if min{|x|,|y|} ≥2, so this would give us another
contradiction when we assume that /⌊ard⌊lb2/⌊ard⌊l∞=δ.
For the remainder of the proof, we will assume that /⌊ard⌊lb2/⌊ard⌊l∞=γ+δ >0, as we can force
the sign of γ+δto be positive by a switch of signs, and we stop assuming a sign on δ. Since
α+β >0, clearly now 12 cannot hold, so we need to consider the possible ineq ualities
|α−γ| ≥γ+δ, (18)
|β−δ| ≥γ+δ. (19)
In fact, note that γ,δmust be the same sign, as otherwise we would have |γ+δ|<min{|γ|,|δ|}.
Therefore,γ,δ>0 asγ+δ>0 by assumption. Therefore, 18 cannot hold as |α−γ|<α, since
γ <γ+δ <2αby assumption. So the only possibility is
|β|+δ≥γ+δ⇐⇒ |β| ≥γ. (20)
Ifx,yare the same sign,
/⌊ard⌊lv/⌊ard⌊l ≥max{|x|α,|y|(γ+δ)}
which is greater than or equal to 2 λ∞if min{|x|,|y|} ≥2, so assume that x,yare of opposite
signs. Then
/⌊ard⌊lv/⌊ard⌊l ≥ |x||β|+|y|δ≥ |x|γ+|y|δ,
13which isgreaterthanorequal to2 λ∞ifmin{|x|,|y|} ≥1. Thereforeassumethatmin {|x|,|y|}=
1. If min {|x|,|y|}=|x|= 1, then
/⌊ard⌊lv/⌊ard⌊l ≥ |y|(γ+δ)−(α+β)≥(|y|−1)α,
which is greater than or equal to 2 λ∞if|y| ≥3. Finally, assume that min {|x|,|y|}=|y|= 1.
Then by 20,
/⌊ard⌊lv/⌊ard⌊l ≥ |x|α−γ≥ |x|α−|β| ≥(|x|−1)α,
which is greater than or equal to 2 λ∞if|x| ≥2. Therefore, we have arrived at a contradiction
for every case, and so the lemma holds.
Lemma 9.⌊r+s
2⌋/summationdisplay
k=0(−1)k/parenleftbiggr+s
k/parenrightbigg/parenleftbiggr+s
2−k/parenrightbiggr+s−1
≤/parenleftbigg√e
2π+o(1)/parenrightbigg/parenleftBig
e1+1
2e/parenrightBigr+s
(r+s−1)!as
r+s→+∞.
Proof.As we’re treating r+sas a single variable, we will deﬁne n=r+sas a substitute. The
left-hand side may now be written as/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle⌊n/2⌋/summationtext
k=0(−1)k/parenleftbign
k/parenrightbig/parenleftbign
2−k/parenrightbign−1/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle. The alternating sum makes
it quite tedious, so from there on, we will split the sum in even and odd p arts, giving us
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle⌊n/2⌋/summationdisplay
k=0(−1)k/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle⌊n/2⌋/summationdisplay
k=0
keven/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1
−⌊n/2⌋/summationdisplay
k=1
kodd/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
To ﬁgure out whether the odd (negative) or even (positive sum is gr eater in the end, we can
ﬁgure out that, from Lemma 5 ,⌊n/2⌋/summationtext
k=0(−1)k/parenleftbign
k/parenrightbig/parenleftbign
2−k/parenrightbign−1= Vol(C(R)∩V)·(n−1)!
Rn−1√n≥0, so :
⌊n/2⌋/summationdisplay
k=0(−1)k/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1
≤⌊n/2⌋/summationdisplay
k=0
keven/parenleftbiggn
k/parenrightbigg/parenleftBign
2−k/parenrightBign−1
As our ﬁrst operation, we will expand/parenleftbign
k/parenrightbig
asn!
k!(n−k)!. As these are positive sums, an
asymptotic bound of their summand will yield a sum which has a similar asy mptotic relation.
Indeed, for positive-valued functions fandgover the integers, f(n) =o(g(n)) implies/summationtext
nf(n) =o(/summationtext
ng(n)), andf(n)∼cg(n) =⇒/summationtext
nf(n) = (c+o(1))/summationtext
ng(n). We will use
this property on the even sum using Stirling’s formula, which states t hatn!∼√
2πn/parenleftbign
e/parenrightbign. We
will expand the ( n−k)! term from then!
k!(n−k)!formula as its asymptotic behavior, according
to Stirling :
⌊n/2⌋/summationdisplay
k=0
kevenn!
k!(n−k)!/parenleftBign
2−k/parenrightBign−1
∼en·n!√
2π⌊n/2⌋/summationdisplay
k=0
keven1
k!(n−k)n−k+1/2/parenleftbigg1
e/parenrightbiggk/parenleftBign
2−k/parenrightBign−1
14In order to get something a bit simpler to handle, we will upper bound t he summand to
ﬁgure out a simpler expression. We notice that n/2≤n−k≤n. Therefore :
en·n!√
2π⌊n/2⌋/summationdisplay
k=0
keven1
k!(n−k)n−k+1/2/parenleftbigg1
e/parenrightbiggk/parenleftBign
2−k/parenrightBign−1
≤en·n!√
2π(n/2)3/2⌊n/2⌋/summationdisplay
k=0
keven1
k!/parenleftBign
2e/parenrightBigk
We will try to ﬁnd a supremum to the summand. For this, we will comput e the derivative
ofx/ma√sto→(n/(2e))x/Γ(x+1) :
∂
∂x/parenleftbigg1
Γ(x+1)/parenleftBign
2e/parenrightBigx/parenrightbigg
=1
Γ(x+1)/parenleftBign
2e/parenrightBigx/parenleftBig
log/parenleftBign
2e/parenrightBig
−ψ(x+1)/parenrightBig
,
whereψis the digamma function. ψis a strictly increasing function over (0 ,+∞), and spans
all ofRwithin this interval, which means it has precisely one root. Since logn
2e→+∞as
n→+∞, thatψ(x) = log(x)+o(1), and that more precisely exp ψ(x) =x+O(1), we can infer
that the root of this derivative is asymptotic ton
2easn→+∞.
Hence, we can derive the following relation :
en·n!√
2π(n/2)3/2⌊n/2⌋/summationdisplay
k=0
keven1
k!/parenleftBign
2e/parenrightBigk
≤en·n!√
2π(n/2)3/2⌊n/2⌋/summationdisplay
k=0
kevensup
k′∈[0,n/2]/braceleftbigg1
k′!/parenleftBign
2e/parenrightBigk′/bracerightbigg
∼en·n!√
2π(n/2)3/2⌊n/2⌋/summationdisplay
k=0
keven1
Γ(n
2e+1)/parenleftBign
2e/parenrightBign
2e
=en·n!√
2π(n/2)3/2/floorleftBign
4/floorrightBig1
Γ(n
2e+1)/parenleftBign
2e/parenrightBign
2e
Using Stirling’s approximation once again, this time as Γ( x+1)∼√
2πx(x/e)x, as well as
⌊x⌋ ∼x,
en·n!√
2π(n/2)3/2/floorleftBign
4/floorrightBig1
Γ(n
2e+1)/parenleftBign
2e/parenrightBign
2e∼√e
2π/parenleftBig
e1+1
2e/parenrightBign
(n−1)!
This concludes the proof.
15