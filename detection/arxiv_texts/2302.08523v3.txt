MNRAS 000, 1–15 (2022) Preprint 10 August 2023 Compiled using MNRAS L ATEX style file v3.0
Cosmic Variance and the Inhomogeneous UV Luminosity Function of
Galaxies During Reionization
Taha Dawoodbhoy,1★Paul R. Shapiro,1Pierre Ocvirk,2Joseph S. W. Lewis,3,4Dominique Aubert,2
Jenny G. Sorce,5,6,7Kyungjin Ahn,8Ilian T. Iliev,9Hyunbae Park,10,11,12Romain Teyssier,13
Gustavo Yepes14,15
1Department of Astronomy and Texas Center for Cosmology and Astroparticle Physics, The University of Texas at Austin, Austin, TX 78712-1083, USA
2Université de Strasbourg, Observatoire astronomique de Strasbourg, UMR 7550, F-67000 Strasbourg, France
3Zentrum für Astronomie der Universität Heidelberg, Institut für Theoretische Astrophysik, Albert-Ueberle-Straße 2, 69120 Heidelberg, Germany
4Max-Planck-Institut für Astronomie, Königstuhl 17, D-69117 Heidelberg, Germany
5Univ. Lille, CNRS, Centrale Lille, UMR 9189 CRIStAL, F-59000 Lille, France
6Leibniz-Institut für Astrophysik Potsdam (AIP), An der Sternwarte 16, D-14482 Potsdam, Germany
7Université Paris-Saclay, CNRS, Institut d’Astrophysique Spatiale, 91405, Orsay, France
8Chosun University, 375 Seosuk-dong, Dong-gu, Gwangjiu 501-759, Korea
9Astronomy Center, Department of Physics & Astronomy, Pevensey II Building, University of Sussex, Falmer, Brighton BN1 9QH, United Kingdom
10Lawrence Berkeley National Laboratory, CA 94720-8139, USA
11Berkeley Center for Cosmological Physics, UC Berkeley, CA 94720, USA
12Kavli IPMU (WPI), UTIAS, The University of Tokyo, Kashiwa, Chiba 277-8583, Japan
13Department of Astrophysical Sciences, Princeton University, Princeton, NJ 08540, USA
14Departamento de Física Teórica M-8, Universidad Autónoma de Madrid, Cantoblanco, 28049, Madrid, Spain
15Centro de Investigación Avanzada en Física Fundamental (CIAFF), Universidad Autónoma de Madrid, 28049 Madrid, Spain
Accepted XXX. Received YYY; in original form ZZZ
ABSTRACT
Whenthefirstgalaxiesformedandstarlightescapedintotheintergalacticmediumtoreionizeit,galaxyformationandreionization
werebothhighlyinhomogeneousintimeandspace,andfully-coupledbymutualfeedback.ToshowhowthisimprintedtheUV
luminosity function (UVLF) of reionization-era galaxies, we use our large-scale, radiation-hydrodynamics simulation CoDa II
to derive the time- and space-varying halo mass function and UVLF, from 𝑧≃6–15. That UVLF correlates strongly with local
reionizationredshift:earlier-reionizingregionshaveUVLFsthatarehigher,moreextendedtobrightermagnitudes,andflatterat
thefaintendthanlater-reionizingregionsobservedatthesame 𝑧.Ingeneral,asaregionreionizes,thefaint-endslopeofitslocal
UVLFflattens,and,by 𝑧=6(whenreionizationended),theglobalUVLF,too,exhibitsaflattenedfaint-endslope,‘rolling-over’
at𝑀UV≳−17. CoDa II’s UVLF is broadly consistent with cluster-lensed galaxy observations of the Hubble Frontier Fields at
𝑧=6–8, including the faint end, except for the faintest data point at 𝑧=6, based on one galaxy at 𝑀UV=−12.5. According
to CoDa II, the probability of observing the latter is ∼5%. However, the effective volume searched at this magnitude is very
small,andisthussubjecttosignificantcosmicvariance.Wefindthatpreviousmethodsadoptedtocalculatetheuncertaintydue
to cosmic variance underestimated it on such small scales by a factor of 2–4, primarily by underestimating the variance in halo
abundance when the sample volume is small.
Key words: galaxies: high-redshift – galaxies: luminosity function, mass function – dark ages, reionization, first stars –
cosmology: theory
1 INTRODUCTION
Reionization – the process by which starlight from early galaxies
leaks into the surrounding intergalactic medium (IGM), gradually
changing its ionization state from almost completely neutral before
the first stars formed, at 𝑧≳20, to almost completely ionized at
𝑧≲5.5– was highly inhomogeneous in space and time (see, e.g.,
Yoshidaetal.2012;Dayal&Ferrara2018;Bosmanetal.2022).The
inhomogeneity was seeded by the gravitational growth of density
★E-mail: tahad@astro.as.utexas.eduperturbations in the early Universe, which, when non-linear, formed
small overdense regions packed with clusters of dark matter halos
in some places, and vast underdense voids in others. The largest-
amplitudeperturbationsformedthesenon-linearstructuresfirst,and
so the most overdense regions were the earliest sites of star forma-
tion. As such, these regions were the first to reionize, and were the
originsofthefirstHIIbubblesthatgrewradiallyoutwardfromthem,
‘exporting’theirexcessionizingradiationtonearbylower-densityre-
gionsandreionizingthem,aswell,intheprocess(Dawoodbhoyetal.
2018). Over time, regions of progressively smaller-amplitude over-
density also reached their non-linear phase, forming more galaxies
©2022 The AuthorsarXiv:2302.08523v3  [astro-ph.CO]  8 Aug 20232T. Dawoodbhoy et al.
andstars,makingexistingHIIbubbleslargerandformingnewones
where none had been before, eventually overlapping and filling all
ofspacetocompletetheEpochofReionization (“EOR”).Thus,the
local reionization history of any given region is strongly correlated
withitslocaloverdensity,anditiscruciallyimportanttotakethiscor-
relation into account when making predictions for observables that
depend on both the density and the ionization state of the observed
region. As we stress throughout this paper, the high-redshift UV lu-
minosity function (UVLF; the number density of galaxies per unit
UV luminosity or absolute magnitude, denoted Φ) – especially that
for faint galaxies (absolute UV magnitudes 𝑀UV≳−16) observed
in small volumes through high-magnification gravitational lenses –
is one such observable (see, e.g., Kulkarni & Choudhury 2011, for
a semi-analytic study).
Recentanalysesofhigh- 𝑧galaxiesfoundviathelensingclustersin
theHubbleFrontierFields(HFF)(Lotzetal.2017)haveledtosome
debate about the shape of the faint-end of the UVLF, especially at
𝑧∼6. The UVLF is often fit and parameterized with the Schechter
function (Schechter 1976), which asymptotes to a power law at the
faint end (Φ∝(𝐿/𝐿∗)𝛼,𝛼 < 0, for𝐿≪𝐿∗) and an exponential
cut-offatthebrightend( Φ∝exp(−𝐿/𝐿∗),for𝐿≫𝐿∗).SomeHFF
studies (Bouwens et al. 2017; Atek et al. 2018) have argued that the
faint-end of the 𝑧∼6UVLF deviates from the power law behavior
of the Schechter function by gradually flattening in slope faint-ward
of𝑀UV∼−16, while others (Livermore et al. 2017; Ishigaki et al.
2018) have argued that the power law behavior is maintained well
below this luminosity, with no evidence of a change in slope. How-
ever, the observations and analyses of these extremely faint galaxies
athighredshiftarenecessarilyvolume-limited;thegalaxiescanonly
be observed if they are located in particular regions such that their
magnificationbytheforegroundclusterissufficienttoraisetheirap-
parentbrightnessabovethesurvey’sfluxlimit.Thesesmall-volume,
high-magnificationobservationsaresubjecttosignificantuncertain-
ties, due to both potential errors in the lensing model and cosmic
variance. In this work, we seek to understand the latter.
ThereareseveralfactorsthatcausetheUVLF–orthestarforma-
tionrate,onwhichtheUVLFstronglydepends–tovaryfromregion
to region (see, e.g., Dawoodbhoy et al. 2018):
(i) overdense/early-reionizing regions have higher halo number
densities than underdense/late-reionizing regions, especially at the
high-mass end, and higher mass halos have higher star formation
rates than lower mass halos;
(ii) halos of a given mass in overdense/early-reionizing regions
have higher star formation rates on average than halos of the same
mass in underdense/late-reionizing regions;
(iii) low-mass halos ( 𝑀≲109.5M⊙) have lower star formation
rates in regions that have already been reionized at a given redshift
than regions that have yet to be reionized.
Accurate modeling of these factors and their contribution to the
cosmic variance of the UVLF requires the use of large-scale, high-
resolution, fully-coupled radiation-hydrodynamics simulations, be-
cause they are highly contingent on the complex mutual feedback
between galaxy formation and reionization. The last factor, in par-
ticular, is due to the feedback of ionizing radiation photo-heating
the IGM in the vicinity of low-mass halos, thereby inhibiting their
ability to accrete gas and form stars (cf. Shapiro et al. 1994). Since
low-masshalospreferentiallyoccupythefaintendoftheUVLF,this
reionization-induced suppression of star formation will have a sig-
nificantimpactonthefaintend,whereobservationaluncertaintydue
tocosmicvarianceislargest.Acompleteanalysisofcosmicvariance
atthefaintend,therefore,requiresasimulationthatcanresolvesuchsimulation 𝑚dm(M⊙)𝐿box(cMpc)
CoDa I 3.49×10591.4
CoDa I-AMR 2.79×10691.4
CoDa II 4.07×10594.4
CoDa III 5.09×10494.4
THESAN-1 3.12×10695.5
Table 1. A comparison of the dark matter particle masses ( 𝑚dm) and box
sizes (𝐿box) of high-resolution, large-scale, radiation-hydrodynamics EOR
simulations.
low-masshalosinaboxlargeenoughtosampleawiderangeoflocal
reionization histories, and treat the interplay between their star for-
mation and the back-reaction of ionizing radiation self-consistently.
Specifically, as we will show, the faint-end HFF observations probe
haloswithmasses 𝑀≳108.5M⊙,sowerequireasimulationwitha
darkmatterparticlemassof 𝑚dm≲106M⊙,toresolvetheformation
ofsuchhaloswithatleastafewhundredparticleseach.Furthermore,
since the volume searched by an HFF survey is ∼3000cMpc3, we
require a simulation with a box size of 𝐿box≳100cMpc, so that it
contains a statistically-meaningful sample of at least a few hundred
survey volumes, with a self-consistent distribution of overdensities
and reionization histories. While several radiation-hydrodynamics
reionization simulations have been produced in recent years (e.g.
Gnedin & Fan 2006; Finlator et al. 2011; Iliev et al. 2014; Gnedin
2014;Soetal.2014;Xuetal.2016;Ocvirketal.2016;Pawliketal.
2017; Pallottini et al. 2017; Aubert et al. 2018; Rosdahl et al. 2018;
Ocvirk et al. 2020; Lewis et al. 2022; Kannan et al. 2022), only a
few meet these size and resolution requirements, simultaneously –
namely,theCosmicDawn(“CoDa”)(Ocvirketal.2016;Aubertetal.
2018; Ocvirk et al. 2020; Lewis et al. 2022) and thesan(Kannan
et al. 2022) simulations (see Table 1), though, until now, these have
not been analyzed for this purpose.
In what follows, therefore, we present the first study of the in-
homogeneous UVLF during the EOR based upon a self-consistent
radiation-hydrodynamics simulation of fully-coupled galaxy forma-
tion and reionization with the required large volume and high mass-
resolution described above. We use the second-generation CoDa II
simulation (Ocvirk et al. 2020)1to determine how the UVLF at
𝑧≥6varies spatially in correlation with regional variations in the
halo mass function and the local timing of reionization, to establish
thecosmicvarianceoftheUVLFonscaleslargeandsmallinastatis-
ticallymeaningfulway.WewillcompareourpredictedUVLF’swith
observations and assess the implications of our results for surveys
based upon HFF lensing data.
Our paper is organized as follows. In §2, we briefly describe the
CoDaIIsimulationanditsrelevantpost-processingforthiswork.In
§3.1,weillustratethetemporalevolutionandspatialinhomogeneity
of the UVLF in CoDa II across a wide range of local reionization
histories and overdensities. In §3.2, we compare our results to the
HFF observations, and demonstrate a substantial discrepancy be-
tween the estimate of uncertainty due to cosmic variance derived
from our simulation and that used in previous studies, when applied
tothesmall-volumelensingresultsdiscussedhere.In§3.3,wefitour
1Some results for the high- 𝑧UVLF from the CoDa II simulation were
presented by us before, in Ocvirk et al. (2020), but here we will analyze its
inhomogeneity for the first time, while also presenting fitting formulae for
theglobally-averagedUVLFfordirectcomparisonwiththeobservedUVLF,
with special attention to evidence for flattening at the faint end.
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 3
parameter value
ℎ 0.677
Ω𝑚0.307
ΩΛ0.693
Ω𝑏0.048
𝜎80.829
𝑛 0.963
Table 2.Cosmological parameters from Planck Collaboration et al. (2014),
which are used in CoDa II.
globally-averaged CoDa II UVLF at 𝑧=6,7,8,10,15to Schechter
functions with and without modifications to the faint-end behavior,
todeterminewhetheroursimulationpredictsaflatteningofthefaint-
end slope. We conclude and summarize our results in §4.
2 CODA II SIMULATION
CoDa II, described in detail in Ocvirk et al. (2020), is the second-
generation radiation-hydrodynamics simulation of fully-coupled
galaxyformationandreionizationina ΛCDMuniverseby TheCos-
micDawn(“CoDa”)Project ,baseduponthemassively-parallelized,
hybrid CPU-GPU code ramses-cudaton . CoDa II has periodic
boundary conditions in a cubic volume 94.4 cMpc on a side, with
40963𝑁-body particles for the dark matter and 40963grid cells for
the baryonic gas and radiation field, resolving the formation of the
full range of atomic-cooling halo (“ACH”) masses, 𝑀≳108M⊙,
and simulating through the end of reionization to 𝑧=5.8. The sim-
ulation adopts cosmological parameters from Planck Collaboration
et al. (2014), which are provided in Table 2.
Hydrodynamicsand 𝑁-bodydynamicsarehandledbythe ramses
code (Teyssier 2002), which uses a second-order Godunov scheme
Riemann solver for the gas and a particle-mesh integrator for the
darkmatter.Radiativetransfer(“RT”)andthermochemistryarehan-
dled by the atoncode (Aubert & Teyssier 2008), which relies on
a moment-based description of the radiative transfer equations and
usestheM1closurerelation(Gonzálezetal.2007).Ittrackstheout-
of-equilibrium ionizations and cooling processes involving atomic
hydrogen. Radiative quantities (energy density, flux, and pressure)
are described on a fixed, comoving, Eulerian grid – the same grid
as is used for its particle-mesh 𝑁-body gravity solver – and evolved
according to an explicit scheme under the constraint of a CFL con-
dition.
Thelatterconditionisespeciallychallengingforthecosmicreion-
izationproblem,sinceweak,R-typeionizationfronts,drivenbyUV
starlightemittedinsidegalaxies,breakoutofthegalaxiesandaccel-
erateinthelow-densityIGMuptovelocitiesthataremanythousands
of km/s, even approaching an appreciable fraction of the speed of
light. As a result, the time-step upper-limit set by the CFL in the
presence of such high-speed I-fronts is orders of magnitude smaller
thanthatsetbytheCFLconditionforhydrodynamicsalone(without
RT), even if the latter hydro assumes optically-thin photoionization
that raises the sound speed of ionized gas by heating it to 104K.
The small time steps required by the CFL when hydro and RT are
fully coupled has the unfortunate consequence that the number of
time-steps required to integrate over a given interval of cosmic time
by finite-differencing the hydro, gravity, and RT equations together
(with the same time-step) is orders of magnitude larger than for a
cosmological simulaton of hydro and gravity without RT. It is cur-rently computationally infeasible to do this on the scale required for
as large a simulation as CoDa II.
Theramses-cudaton code was specifically developed to over-
come this obstacle. It is unique in solving this problem, by being
coded to run on a massively-parallel, hybrid CPU-GPU supercom-
puter like Titan at Oak Ridge OLCF, in which each of its thousands
ofnodeshave,notonlydozensofCPUs,butalsoGPUs.Inthesame
wall-clock time it takes to advance the hydro and gravity equations
ontheCPUsforonehydro-gravitytime-step, ramses-cudaton uses
theGPUstoadvancethrough ∼100sub-stepsoftheRTandioniza-
tionrateequations,aswell.Thisenablesthenetcomputationaltime
of the problem with RT to approach the computational time of the
problem with no RT, by speeding it up by two orders of magnitude.
Othersimulationsofreionizationandgalaxyformationwithfully-
coupled hydro and RT that solve the RT equations by a moment
method, as ramses-cudaton does, have attempted to side-step this
severe requirement of extremely small RT-step-size dictated by the
CFL condition by replacing the true speed of light by an artificially
reduced value – the so-called reduced-speed-of-light approximation
“RSLA” – to “trick” the CFL into allowing larger time steps for the
RT.Thisisnotnecessaryfor ramses-cudaton .Asaresult,CoDaII
was able to adopt the full speed of light, thereby avoiding the well-
known artifacts introduced in the other reionization simulations by
their adoption of the RSLA (see Deparis et al. 2019; Ocvirk et al.
2019). Nevertheless, to simulate through the end of the EOR, down
to redshift5.8, CoDa IIhad to runfor about6 days on16,384 nodes
of the Titan supercomputer, using 4 cores and 1 GPU per node, for
atotalof65,536cores,witheachnodehosting4MPIprocessesthat
each managed a subvolume of 64×128×128cells.
Since the mass scale of individual stars is completely unresolved
by all reionization simulations, CoDa II included, star formation is
modeledbyasubgridalgorithm.InCoDaII,starparticlesarecreated
in each hydro cell in which the baryon overdensity exceeds 50, with
the rate of change of the stellar mass density given by
¤𝜌★=𝜖★𝜌gas
𝑡ff(1)
where𝜌gasis the baryon density, 𝑡ffis the free-fall time, and 𝜖★is
a calibration parameter referred to as the star formation efficiency,
which is set to 0.02.
We add to our subgrid star formation algorithm a parameterized
ionizing photon efficiency (IPE; the number of ionizing photons
released per unit stellar baryon per unit time) into the host grid
cell of each star particle. We define this IPE as 𝜉ipe≡𝑓esc,★𝜉ph,imf,
where𝑓esc,★isthestellar-birthplaceescapefractionand 𝜉ph,imfisthe
numberofionizingphotonsemittedperMyrperstellarbaryon.Each
stellar particle is considered to radiate for one massive star lifetime
𝑡★=10Myr,afterwhichthemassivestarsdie(triggeringasupernova
explosion) and the particle becomes dark in the H-ionizing UV.
We adopted an emissivity 𝜉ph,imf=1140ionizing photons/Myr per
stellar baryon. This is consistent with emission by our assumed 𝑍=
0.001BPASSbinarystellarpopulationmodel(Eldridgeetal.2017),
withaKroupainitialmassfunction(Kroupa2001),assumingnodust
extinction.Weusedamono-frequencytreatmentoftheradiationwith
an effective frequency of 20.28 eV. Finally, we calibrated 𝑓esc,★by
adjustingthevalueinasetofsmaller-boxsimulations,soastoobtain
a reionization redshift close to 𝑧=6, which led us to adopt a value
of𝑓esc,★=0.42.
In order compute the UVLF, we must post-process the CoDa re-
sults to find its galaxies by a dark matter halo finding algorithm, as-
signstarparticlestoeachhosthaloaccordingtotheirspatialoverlap
with the halo volumes, and sum theemission of all the star particles
MNRAS 000, 1–15 (2022)4T. Dawoodbhoy et al.
Figure 1. ContourmapofaslicethroughtheCoDaIIreionizationredshiftfield,0.25 ℎ−1cMpcthick,dividedintoregionsthatreionizerelativelyearly( 𝑧re>9;
cyan), late (𝑧re<7; magenta), and at intermediate redshifts ( 7<𝑧re<9; blue). Black circles show the locations of halos in the same slice at 𝑧=10, with the
size of each circle proportional to the halo’s mass.
𝑧=6𝑧=7𝑧=8𝑧=9𝑧=10𝑧=15
⟨𝑋hii⟩v1 – 1.2e-5 5.0e-1 1.7e-1 5.3e-2 1.6e-2 2.4e-4
Table 3.Volume-weighted global ionized fraction in CoDa II at given 𝑧.
associated with a given halo below the Lyman limit of H atoms to
compute that galaxy’s UV continuum luminosity. Dark matter halos
are identified using a Friends-of-Friends algorithm with a standard
linkinglengthparameterof0.2.Themassofeachhalo, 𝑀,isdefined
as the total mass of all linked dark matter particles, and the virial
radius is estimated as
𝑅200=3𝑀
4𝜋×200 ¯𝜌dm1/3
(2)where ¯𝜌dmisthecosmicmeandarkmatterdensity.Starparticlesare
then assigned to halos if they fall within the halo’s virial radius, and
themassesandagesofeachhalo’sstarparticlesareusedtocompute
thehalo’sUVluminosityandmagnitude( 𝑀UV)at1600Å,according
to the𝑍=0.001BPASS binary stellar population model described
above, again assuming no dust extinction.
To track and analyze the progress, patterns, and patchiness of
reionizationweconstructthereionizationredshiftfieldoftheCoDaII
simulation,illustratedinFig.1.Westartbycoarseningthesimulated
gridto 2563cells,andcomputingthevolume-weightedaverageion-
ized fraction in each of these cells at each snapshot. (See Table 3
for the global ionized fraction at select redshifts.) The purpose of
this coarsening is to smooth over the interiors of halos, which can
be shielded from ionizing radiation due to their high densities, and
instead probe the ionization state of the IGM. Then, we identify the
redshift at which each coarse-grained cell first reaches an ionized
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 5
Figure 2. Halo mass functions in CoDa II at 𝑧=6,7,8,10. Black solid lines show the HMF in the full simulated volume, while cyan, blue, and magenta lines
show the HMF in early-, intermediate-, and late-reionizing regions, respectively, as labeled. Here and elsewhere, logimplies log10.
𝑧=6𝑧=7𝑧=8𝑧=10
𝑧rebin volume halo halo halo halo
fraction fraction fraction fraction fraction
>90.022 0.074 0.081 0.089 0.125
7–9 0.395 0.506 0.496 0.517 0.556
<70.583 0.420 0.422 0.393 0.319
Table 4.The fraction of the total volume occupied by early-, intermediate-,
and late-reionizing regions, along with the fraction of all halos contained in
these regions.
fraction of 90%, which we define as the cell’s reionization redshift,
𝑧re.Correspondingly,weidentifyeachhalo’s 𝑧reasthatofthecoarse-
grained cell its center of mass belongs to. For the purposes of this
work, we consider three ranges of reionization redshift – 𝑧re>9,
7<𝑧re<9,and𝑧re<7–whichwerefertoasearly-,intermediate-,
andlate-reionizingregions,respectively.Fig.1showsacontourmap
of a slice through the reionization redshift field divided into these
three ranges (cyan, blue, and magenta, respectively), along with the
positions of 𝑧=10halos (black dots) in the same slice. There is
a clear correlation between halo number density and 𝑧re, with the
earlier reionizing regions containing a higher density of halos than
the later reionizing regions. For example, while the early-reionizing
regions are the rarest and most compact, occupying only around 2%
of the total volume, they contain around 13% of all halos at 𝑧=10
(see Table 4). On the other hand, the vast late-reionizing regions,
which occupy 58% of the volume, contain around 32% of the halos
at𝑧=10.Weexplorethiscorrelationfurtherinthefollowingsection.3 CODA II UV LUMINOSITY FUNCTION
3.1 The Imprint of Patchy Reionization
In general, the UVLF can be decomposed into two factors: the halo
mass function, and the star formation rate of halos as a function of
mass. As we described in Dawoodbhoy et al. (2018), both of these
factors are strongly correlated with the reionization history of the
region in which they are observed, and so too must the UVLF be.
The earliest regions to reionize will be those that are the most
dense, since these regions will be the first to form a large number
of star-forming galaxies – the primary sources of reionization. The
latest regions to reionize will be the voids, which typically do not
formenoughstarstoreionizethemselves,andsorequire‘importing’
ionizing radiation from external, earlier-reionizing regions nearby,
in order for them to become reionized. Therefore, there is a positive
correlationbetweenthereionizationredshiftofaregionanditshalo
mass function (HMF; the number density of halos per unit mass):
higher-𝑧reregionshavehigherHMFsthatextendouttohighermass.
We show the combined HMFs in regions binned by their 𝑧re, for
fourdifferentredshifts,inFig.2.Ascanbeseen,theearly-reionizing
regions (𝑧re>9) have the highest and most extended (i.e. the turn-
overtoasteeperdeclineoccursatahighermass)HMFatallredshifts,
followed by the intermediate- ( 7< 𝑧re<9) and late-reionizing
(𝑧re<7) regions. The globally averaged HMF tracks closest to the
intermediate-reionizing regions at the low-mass end.
Naturally, a higher HMF will result in a higher UVLF, overall, so
we should expect the correlation between HMF and 𝑧reto translate
to a correlation between UVLF and 𝑧re. However, the actual UV lu-
minosityofeachhaloisdeterminedbyitsstarformationrate(SFR),
which has a more complicated relationship with 𝑧re. First, for rela-
MNRAS 000, 1–15 (2022)6T. Dawoodbhoy et al.
z=6SFR~M5/3globalzre<77<zre<9zre>9-20
-15
-10
-5MUVz=7SFR~M5/3
z=8SFR~M5/38.0 8.5 9.0 9.5 10.0 10.5 11.0-20
-15
-10
-5
log(M/M⊙)MUVz=10SFR~M5/38.0 8.5 9.0 9.5 10.0 10.5 11.0
log(M/M⊙)
Figure 3. 95%contoursforUVmagnitudevs.halomassofluminousgalaxiesinCoDaII,binnedby 𝑧re,forthesame4redshiftsasinFig.2andusingthesame
colorlinesfordifferent 𝑧rebins.Thethickgreylineistheglobalmedian.Theblackdashedlineistheroughexpectationgivena(pre-suppression)SFR ∝𝑀5/3.
tively high-mass halos ( 𝑀≳109M⊙), the SFR scales as ∼𝑀5/3
(see,e.g.,Ocvirketal.2016,2020),whichmeansHMFsthataremore
extended to high mass (i.e. those of earlier reionizing regions) will
correspond to UVLFs that are more extended to the bright end (i.e.
theturn-overtoasteeperdeclineoccursatabrightermagnitude).We
illustrate the effect of this SFR scaling in Fig. 3, which shows 95%
contoursfortheUVmagnitudevs.halomassofluminousgalaxiesin
CoDaII,binnedby 𝑧re,at𝑧=6−10.Theroughexpectationfromthe
SFR∼𝑀5/3scaling(i.e.assumingUVluminosityisproportionalto
SFR)iswell-obeyedfor 𝑀≳109.5M⊙.Furthermore,inadditionto
the earlier reionizing regions having more halos at all masses and a
HMF that extends out to higher mass, there is also a higher fraction
of halos of a givenmass at a given redshift with brighter UV mag-
nitudes in earlier reionizing regions than in later reionizing regions
(e.g.noticethatthebrightedgeofthecontoursare‘stacked’by 𝑧re),
which further contributes to the difference in their UVLFs.
On the other hand, lower mass halos ( 𝑀≲109.5M⊙)2deviate
from the𝑀5/3scaling at low redshift, due to the suppression of
star formation in low-mass halos, caused by reionization feedback
(e.g. notice that the faint edge of the contours drop more sharply
than the𝑀5/3scaling for𝑀≲109.5M⊙at late redshift). After
a region becomes reionized, low-mass halos are unable to accrete
the photo-ionized gas in the IGM, due to its increased temperature,
and so they will no longer have the fuel required to form stars (see,
2Notethattheflatteningseenat 𝑀≲108.5M⊙inFig.3islikelyaresolution-
limit effect.
7<zre<9z=6z=7z=8z=10
-22 -20 -18 -16 -14 -1210-510-410-310-210-1100
MUVΦ cMpc-3mag-1Figure 4. The evolution of the UVLF in intermediate-reionizing regions
(7< 𝑧re<9), from pre-reionization ( 𝑧=10) to post-reionization ( 𝑧=6).
Notice that the latter features a much flatter faint-end than the former.
e.g.,Dawoodbhoyetal.2018;Ocvirketal.2020).Sincethesehalos
populate the faint-end of the UVLF prior to their local reionization,
we should expect to see a reduction at this faint-end over time as
reionizationoccursandthesuppressedhalosmovetofaintermagni-
tudes(ordisappearentirely),whichisusuallycharacterizedinterms
of a “turn-over” in the faint-end slope. For example, in their semi-
analytical study of inhomogeneous reionization feedback, Kulkarni
& Choudhury (2011) found such a turn-over for 𝑀UV≳−17at
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 7
Figure 5. UV luminosity functions in CoDa II at 𝑧=6,7,8,10. Black lines represent the full simulated volume, while cyan, blue, and magenta lines show
early-, intermediate-, and late-reionizing regions, respectively.
𝑧=8, preferentially in the UVLFs of overdense regions (which
reionize relatively early). To illustrate this effect in our simulation,
we show the UVLF of intermediate-reionizing regions over time in
Fig.4.Noticethechangeinslopeandcurvatureovertimeatmagni-
tudes−16≲𝑀UV≲−11. Prior to these regions’ local reionization
(i.e𝑧=10), the faint-end slope is fairly steep, roughly following
Φ∝𝑀0.4
UVfor−13≲𝑀UV≲−11. During local reionization, how-
ever,thefaint-endslopegraduallyflattensout,andbythetimereion-
ization has ended for these regions (i.e. 𝑧=6), the faint-end power
law index is close to 0 in this magnitude range.
Consequently, the UVLF one observes depends on whereone
looks–anearly-reionizingpatchoftheUniversewillhavearelatively
highandbright-end-extendedUVLF,whereasalate-reionizingpatch
will have a relatively low and bright-end-compressed UVLF – and
alsowhenone looks – a region that is observed prior to its local
reionization will have a relatively steep faint-end slope, whereas a
region observed after its local reionization will have a relatively flat
faint-end slope. We show these trends in Fig. 5, which plots the
CoDaIIUVLFsforearly-,intermediate-,andlate-reionizingregions
at four redshifts, along with the global average.
An important implication of these results is that small-volume
observations of the UVLF will necessarily be biased in one way or
another, due to the strong correlations with local density and reion-
ization redshift. For example, observations that search in uniformly
randomvolumesarelikelytobeprobingvoids,whichareunderdense
regions,sincetheyoccupythemostvolume.Asaresult,suchobser-
vations are likely to return UVLFs that are lower and less extended
at the bright end than the cosmic mean. Furthermore, since these
regionsreionizerelativelylate,theinferredUVLFsarelikelytohavesteeper-than-average faint-end slopes. On the other hand, observa-
tions that preferentially search near the brightest sources are likely
tobeprobinghighlyoverdense regionsthatreionizerelativelyearly,
since these regions have UVLFs that are the most extended to the
bright-end. Thus, such observations are likely to return UVLFs that
arehigherandmoreextendedatthebrightendthanthecosmicmean,
with a flatter-than-average faint-end slope.
3.2 Implications for Faint-End HFF Observations
Theanalysisoftheprevioussectionillustratesthedramaticvariabil-
ityoftheUVLFamongregionswithdifferentreionizationhistories.
However, the volume of the 𝑧re-binned cells in which the UVLF is
computed is rather small, only (250/ℎckpc)3. For many observa-
tionalpurposes,itismoreusefultoassessthevarianceintheUVLF
on larger scales, e.g. characteristic of the size of a galaxy survey.
To that end, we divided our CoDa II box into 256 non-overlapping
subvolumes, each spanning around 3300 cMpc3, which is of order
the survey volumes searched by each of the HFF lensing-cluster
fields, which have been used previously to measure the faint-end of
thehigh-𝑧UVLF.Eachsubvolumecontains 32×32×64=65536of
the2563coarse-grained cells used in the reionization redshift field
of the previous section, and so will encompass a range of reioniza-
tion histories. To characterize their typical reionization history, we
compute the mean reionization redshift of each subvolume in two
ways: (1) a halo-weighted average ⟨𝑧re⟩h, obtained by averaging
over the reionization redshifts of all halos in the subvolume, and
(2) a volume-weighted average ⟨𝑧re⟩v, obtained by averaging over
the reionization redshifts of all coarse-grained cells in the subvol-
MNRAS 000, 1–15 (2022)8T. Dawoodbhoy et al.
all subvolumesselect subvolumeshalo -averaged
volume -averaged
6.5 7.0 7.5 8.0051015202530
〈zre〉number of subvolumes
y=xy=0.88x -0.14
0.0 0.5 1.0 1.5 2.0 2.50.00.51.01.52.02.5
〈zre〉h-6〈zre〉v-6
Figure 6. Top:HistogramsofthemeanreionizationredshiftsofCoDaIIsub-
volumes (3300 cMpc3in size, each). Solid lines represent the halo-weighted
average of𝑧reacross each subvolume (i.e. the average 𝑧reof all halos in
eachsubvolume),whiledashedlinesrepresentthevolume-weightedaverage.
Yellow lines show the distribution for all subvolumes, while blue lines show
thatofasubsetof50subvolumesthatmostcloselymatchthebright-enddata
fromLivermoreetal.(2017)(seeFig.8andaccompanyingtextforadescrip-
tion of how these 50 subvolumes are selected). Bottom: Volume-weighted
vs. halo-weighted averages of 𝑧reacross each subvolume (blue points) fit to
a linear relation (blue line). All points fall below the equality line (yellow),
meaning⟨𝑧re⟩vis always less (i.e. later) than ⟨𝑧re⟩h.
ume.Thedistributionsofthesetwomeansacrossoursubvolumesis
shown in the top panel of Fig. 6.
Asthehistogramsshow,thedistributionofvolume-averagedreion-
ization redshifts is skewed towards later redshifts than those of the
halo-weighted averages. This is made clear by the plot of ⟨𝑧re⟩vvs.
⟨𝑧re⟩hfor each subvolume, in the bottom panel of Fig. 6. This trend
is to be expected, since the effects of reionization tend to propagate
“inside-out”, from the neighborhoods of clustered galaxies to the
surrounding,largervolumesoftheIGM.Nevertheless,Fig.6makes
it clear that, even after averaging over the full range of local reion-
izationredshiftswithinagivensurveyvolume,thosesurveyvolumes
are small enough that there is still a large variation in this average
reionizationredshiftfromonesurveyvolumetoanother.Thismeans
we should expect there to be a corresponding scatter amongst the
UVLF’s derived for different survey volumes of this size.
We plot the 𝑧=6,7,8UVLFs of our subvolumes in Fig. 7. The
curves for each subvolume are colored according to their ⟨𝑧re⟩h,
withcyancorrespondingtoearlier-reionizingregions,magentacorre-
spondingtolater-reionizingregions,andblueinbetween.Naturally,
the earlier-reionizing regions have higher UVLFs, and so on.
z=6
6.5 7.0 7.5 8.0
CoDa II subvolume 〈zre〉hCoDa II full volumeLivermore et al. (2017 )Bouwens et al. (2022 )Ishigaki et al. (2018 )Atek et al. (2018 )
10-310-210-1100101-20 -18 -16 -14 -12Φ cMpc-3mag-1MUV
z=7 10-310-210-1100101Φ cMpc-3mag-1
z=8
-20 -18 -16 -14 -1210-310-210-1100101
MUVΦ cMpc-3mag-1Figure 7. CoDaIIUVLFsat 𝑧=6,7,8comparedtoobservationalHFFdata
from Livermore et al. (2017); Bouwens et al. (2022); Ishigaki et al. (2018);
Ateketal.(2018).InadditiontothefullvolumeUVLF(thickblackline),we
also show the UVLFs of 256 CoDa II subvolumes – each spanning around
3300 cMpc3, which is of order the survey volumes searched by each of
the HFF lensing-cluster fields – as thin lines colored according to the mean
reionization redshift of their constituent halos, as indicated in the legend in
the top panel. The spread in the UVLFs of this collection of subvolumes is a
measure of the cosmic variance on this scale.
For comparison, we also plot the HFF observational results from
Livermore et al. (2017) (red circles), Bouwens et al. (2022) (blue
squares), Ishigaki et al. (2018) (brown diamonds), and Atek et al.
(2018) (green triangles).3Their inferred UVLFs are broadly con-
sistent with our CoDa II subvolumes, but there is one noteworthy
discrepant data point from Livermore et al. (2017) at the faint-end
3Note that Bouwens et al. (2022), Ishigaki et al. (2018), and Atek et al.
(2018) each analyze the full set of six HFF clusters, while Livermore et al.
(2017) analyze a subset of two of them.
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 9
·············
z=6
-20 -18 -16 -14 -1210-310-210-1100101
MUVΦ cMpc-3mag-1
Figure 8. A comparison of the 𝑧=6UVLF data from Livermore et al.
(2017) to the UVLFs in a selection of 50 CoDa II subvolumes – a subset of
the256subvolumesshowninFig.7,chosentomostcloselymatchthebright-
end of the observational data (saturated red points). Despite their matching
at the bright-end, the subvolumes are still discrepant with the data point at
𝑀UV=−12.5.Forreference,thefullvolumeCoDaIIUVLF(thicksolidline)
and best-fit Schechter function from Livermore et al. (2017) (thick dashed
line) are also shown.
at𝑧=6.4By this late redshift, most of the volume in our CoDa II
simulation has been reionized, so most low-mass halos in the sub-
volumeshavebeensuppressed,andhencethefaint-endslopesofthe
subvolumes’ UVLFs are rather flat. However, due to the fact that
they identified a single 𝑀UV=−12.5galaxy at𝑧=6, Livermore
et al. (2017) inferred a faint-end slope that remains steep down to
this low magnitude. Galaxies that faint must be located very close
to caustics in the lensing field, in order to be sufficiently magni-
fied so as to be visible, so the effective volume searched for such a
galaxyismuchsmallerthanthefullvolumeprobedbytheentiresur-
vey field. According to the lensing models used by Livermore et al.
(2017), the effective volume searched for a 𝑀UV=−12.5galaxy is
around 0.73 cMpc3. Therefore, identifying even a single galaxy in
a randomly sampled volume that small implies a high UVLF at that
galaxy’smagnitude–highenoughtobeinconsistentwiththeaverage
UVLFatthatmagnitudeinallofourCoDaIIsubvolumes. Wenote
that this data point is similarly discrepant with the UVLF predicted
bythesan(Kannanetal.2022),anotherlarge-scale,high-resolution
radiation-hydrodynamics simulation that is otherwise broadly con-
sistent with high- 𝑧UVLF observations (as CoDa II is), though they
do not explore the inhomogeneity of their UVLF.
To assess the degree of discrepancy between our CoDa II results
andtheobservationsofLivermoreetal.(2017),wecanestimatethe
probabilityofobservingasingle 𝑀UV=−12.5galaxyinarandomly
sampled0.73cMpc3regionwithineachCoDaIIsubvolume.Forthis
purpose, we identified a subset of 50 of our CoDa II subvolumes,
chosen because their UVLF at brighter magnitudes most closely
matches the UVLF of Livermore et al. (2017) at those magnitudes,
forwhichtheeffectivevolumesurveyedmatchesthesubvolumesize,
as shown in Fig. 8. In particular, we selected the subvolumes with
the 50 lowest 𝜒2values when compared to the number of observed
galaxies at each magnitude in the range −19.5≤𝑀UV≤−17. The
4While the second-faintest point from the Bouwens et al. (2022) results at
𝑧=8isalso somewhatdiscrepant withourresults, sinceboth datapoints on
either side of it are not, we consider this to be anomalous and do not discuss
it further here.
full volumeall subvolumesselect subvolumes
0.02 0.04 0.06 0.08 0.10010203040
Pi(1;-12.5 )number of subvolumesFigure 9. The number of subvolumes in which one 𝑀UV=−12.5galaxy
maybefoundinarandom0.73cMpc3regionwithprobability 𝑃𝑖(1;−12.5).
Orange bars represent all 256 subvolumes in CoDa II, while blue bars rep-
resent only those select subvolumes that most closely match the bright-end
HFF data from Livermore et al. (2017). The orange and blue lines mark the
median probability for their color-coordinated samples, while the black line
marks the probability for the globally-averaged CoDa II UVLF.
data points at these magnitudes are indicated by the saturated red
circlesinthefigure. Then,giventhenumberdensityof 𝑀UV=−12.5
galaxies in the 𝑖thsubvolume,
𝑛𝑖(−12.5)≃Φ𝑖(−12.5)Δ𝑀UV (3)
whereΔ𝑀UV=0.5(as was used by Livermore et al. 2017), the
probability of finding 𝑁such galaxies in a random search of a
𝑉eff(−12.5)=0.73 cMpc3volume is given by the Poisson distri-
bution5
𝑃𝑖(𝑁;−12.5)= 𝑛𝑖(−12.5)𝑉eff(−12.5)𝑁𝑒−𝑛𝑖(−12.5)𝑉eff(−12.5)
𝑁!
(4)
Thus, the probability of finding one such galaxy in the limit
𝑛𝑖(−12.5)𝑉eff(−12.5)≪ 1is
𝑃𝑖(1;−12.5)≈𝑛𝑖(−12.5)𝑉eff(−12.5) (5)
We find that across all of the selected subvolumes, this probability
fallsintherange[3.2%,6.5%],withamedianprobabilityofaround
4.8%. On the other hand, if we compute the probability across all
subvolumes, not just the selected ones, we find a range of [1.3%,
9.5%], with a median around 4.4%. Using the globally-averaged
CoDa II UVLF, instead, we find a probability of 4.6%. We show
a histogram of probability estimates for detecting a 𝑀UV=−12.5
galaxy in our subvolumes in Fig. 9.
3.2.1 Cosmic Variance in Faint-End Lensing Surveys
It is worth noting that there is significant uncertainty in the analysis
of these extremely high-magnification faint galaxies, due to uncer-
tainties in both the lensing models and cosmic variance, since the
5Note that there are at least 143 such galaxies in each of the select
∼3300cMpc3subvolumes, and around 209 on average. When considering
all subvolumes, not just those selected to most closely match the bright-end
of Livermore et al. (2017), there are at least 58 such galaxies in each, and
around 215 on average.
MNRAS 000, 1–15 (2022)10T. Dawoodbhoy et al.
effective volumes searched are so small. With regards to the former,
the analysis of Bouwens et al. (2017), for example, re-interprets the
𝑀UV=−12.5galaxy as a brighter galaxy ( 𝑀UV=−14.25) in a
larger effective search volume, with a greater uncertainty attributed
to the lensing models. With regards to the latter, Livermore et al.
(2017) account for uncertainty due to cosmic variance when fitting
theirdatatoSchechterfunctionsbyfollowingtheworkofRobertson
et al. (2014), which expresses the uncertainty in terms of the galaxy
clustering bias, e.g.
𝜎cv,l(𝑉)=√︁
⟨(𝑛l(x,𝑉)−¯𝑛l)2⟩x
¯𝑛l=𝑏l(𝑉)𝜎dm(𝑉) (6)
where𝜎cv,l(𝑉)is the fractional uncertainty due to cosmic variance
for galaxies of luminosity (or magnitude) 𝐿observed in a volume
𝑉,𝑛l(x,𝑉)is the local number density of galaxies of the same lu-
minosity in a volume 𝑉located at x,¯𝑛lis the global mean number
density of galaxies of the same luminosity, ⟨ ⟩xdenotes a global
averageoveralllocations x,𝑏l(𝑉)isthebiasofgalaxiesofthesame
luminosity on the scale of volume 𝑉, and𝜎dm(𝑉)is the linearly-
extrapolated RMS of dark matter density fluctuations on the same
scale. Robertson et al. (2014) use, as their estimate of the bias, the
analysisofdarkmattersimulationsinTinkeretal.(2010).However,
since the focus of Tinker et al. (2010) was on large-scale bias –
i.e. in the limit where the bias is scale-independent, 𝑏l(𝑉)→𝑏l
– their analysis was restricted to only the 5–10 largest wavelength
modes in each simulation, with simulation box lengths in the range
80–1280ℎ−1cMpc. Therefore, we believe their results will under-
estimate the bias on the very small scales probed by the extremely
high-magnification regions of the HFF data, for which the bias is
scale-dependent. As a consequence, the use of this bias in Robert-
son et al. (2014) will underestimate the uncertainty due to cosmic
varianceonsuchsmallscales,aswell.Sincedetectionofthefaintest
galaxies requires the greatest magnification, the use of observations
like the Livermore et al. (2017) 𝑀UV=−12.5galaxy to infer the
UVLF is especially affected by this underestimation.
To illustrate this, we further sub-divide the CoDa II simulation at
𝑧=6into sets of ‘sub-subvolumes’ of different scales, all the way
down to𝑉=0.8cMpc3, which is close6to the effective volume
searchedbyLivermoreetal.(2017)at 𝑀UV=−12.5.Wethencom-
putedthebiasofgalaxiesinthemagnitudebin 𝑀UV=−12.5±0.25
in each of these sets of sub-subvolumes by computing the variance
in their number densities to obtain 𝜎cv,l, and show the results as a
function of volume in Fig. 10 (black points). For comparison, we
show the bias as estimated from the (large-scale) analysis of Tinker
etal.(2010)forgalaxiesatthismagnitudeasahorizontalblackline.
We obtained this estimate by applying the Tinker et al. (2010) bias
fittingfunctiontothehalomassobtainedbyabundancematchingthe
Tinker et al. (2008) HMF with the Livermore et al. (2017) UVLF
at𝑀UV=−12.5. As expected, our bias estimates from CoDa II
approach the Tinker et al. (2010) estimate on large scales, but de-
viate substantially from the latter on smaller scales. In particular,
near the effective volume searched by Livermore et al. (2017) at
𝑀UV=−12.5, our bias (𝑏−12.5) is larger than the (large-scale) Tin-
ker et al. (2010) estimate by a factor of 4.2. Correspondingly, our
estimate of the contribution to the uncertainty due to cosmic vari-
ancefromanobservationatthisvolumeandmagnitude( 𝜎cv,-12.5)is
6We obtained the sub-subvolumes by evenly sub-dividing the 3300 cMpc3
subvolumesintoasequenceofsmallervolumeswithintegernumbersofgrid
cells per dimension, and arrived at 3300/4096=0.8cMpc3as the closest
sub-division to 𝑉eff=0.73cMpc3.
Figure 10. Thebiasof𝑀UV=−12.5galaxiesinCoDaIIat 𝑧=6,computed
bycountinggalaxies/halosinvolumesofsize 𝑉.Thesmallestvolumeshown,
𝑉=0.25ℎ−3cMpc3=0.8cMpc3,issimilartotheeffectivevolumesearched
byLivermoreetal.(2017)atthismagnitude,whilethelargestvolumeshown,
𝑉=1024ℎ−3cMpc3=3300cMpc3, corresponds to our subvolumes.
The black points are obtained by counting galaxies in the magnitude bin
𝑀UV=−12.5±0.25directly, whereas the red and blue points are obtained
bycountinghaloswithmassesobtainedbyabundancematching(AM)tothe
magnitude bin, using the CoDa II HMF and the UVLFs from CoDa II and
Livermore et al. (2017), respectively. For comparison, we show the bias as
computed using the fitting function from Tinker et al. (2010) as horizontal
lines. The black line is the bias obtained by abundance matching using the
HMF from Tinker et al. (2008) and the UVLF from Livermore et al. (2017).
TheredlineisobtainedbyabundancematchingusingtheCoDaIIHMFand
UVLF, which is analogous to the red points. The blue line is obtained by
abundance matching using the CoDa II HMF and Livermore et al. (2017)
UVLF, which is analogous to the blue points. Our results diverge from the
Tinker et al. (2010) fitting function estimates at small volumes.
a factor of 4.2 larger than that which Robertson et al. (2014) (and,
following the former, Livermore et al. 2017) would have found.
This result compares the variance of galaxies in a given lumi-
nosityrange in the CoDa II simulation to that of halos of a given
massaccording to the scale-independent bias estimate from Tinker
et al. (2010). In order to perform a more ‘apples-to-apples’ com-
parison (i.e. ‘mass-to-mass’, rather than ‘luminosity-to-mass’), we
alsocomputedthebiasintwodifferentways,forbothoursimulation
results and the Tinker et al. (2010) estimate. For our simulation re-
sults, rather than calculating the variance in the number density of
𝑀UV=−12.5±0.25galaxiesdirectly,weinsteadcalculatethevari-
anceinhaloswithmassesinarangeobtainedbyabundancematching
to this magnitude bin, i.e.
𝜎cv,m(𝑉)=√︁
⟨(𝑛m(x,𝑉)−¯𝑛m)2⟩x
¯𝑛m=𝑏m(𝑉)𝜎dm(𝑉) (7)
where the subscript 𝑀now refers to the same quantities as before –
uncertainty due to cosmic variance, local and global number densi-
ties, and bias – but for halos with mass 𝑀, rather than galaxies with
a given luminosity. We perform the abundance matching using our
numerical CoDa II HMF and either the CoDa II UVLF (red points)
or the Livermore et al. (2017) UVLF (blue points). Then, we apply
these abundance-matched halo masses to the Tinker et al. (2010)
fitting function to obtain new estimates, which are shown in Fig. 10
as red and blue horizontal lines, to be compared with the red and
bluepoints,respectively.Weillustratetherelationshipbetweenthese
different abundance matching methods in Fig. 11.
Asbefore,thepointsconvergetotheTinkeretal.(2010)estimate
onlargescales,butdivergeonsmallscales. Sincetheredpointsshow
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 11
Figure 11. Top: Cumulative number densities of halos with mass > 𝑀for
CoDa II (solid gray) compared to that obtained from the HMF of Tinker
et al. (2008) (dashed gray), both of which are used for abundance matching.
Thehorizontalredandbluebandsrepresentthecumulativenumberdensities
of galaxies with magnitudes brighter than the bin −12.5±0.25, according
to the UVLFs from CoDa II and Livermore et al. (2017), respectively. The
vertical red and blue bands represent the mass ranges obtained by matching
theaforementionedgalaxynumberdensitieswiththeCoDaIIcumulativehalo
numberdensitycurve.Thesemassrangesareusedtocomputetheredandblue
pointsinFig.10.Theredandbluelinesrepresentabundancematchingforthe
center of the magnitude bin ( 𝑀UV<−12.5), and the resulting masses are
usedtoobtaintheredandbluehorizontallinesinFig.10.Theblackvertical
lineisobtainedbyinsteadmatchingtheLivermoreetal.(2017)abundanceof
𝑀UV<−12.5galaxies to the Tinker et al. (2008) cumulative halo number
densitycurve,andtheresultingmassisusedtoobtaintheblackhorizontalline
inFig.10.Bottom:Thedistributionofhalomassesfor 𝑀UV=−12.5±0.25
galaxiesinCoDaII,whichisencodedintheblackpointsinFig.10,compared
to the abundance-matched masses discussed above.
the cosmic variance in halos that are self-consistently abundance-
matchedtothegalaxiesrepresentedbytheblackpoints,theynaturally
exhibit roughly the same behavior as the black points, and are a
factorof3.5timeshigherthanthecorrespondingTinkeretal.(2010)
estimate at𝑉=0.25ℎ−3cMpc3. Although the blue points (halos
chosen by abundance matching the CoDa II HMF to the Livermore
et al. 2017 UVLF, rather than the CoDa II UVLF) exhibit less of
a discrepancy, our CoDa II result is still a factor of 2 larger than
the comparable fitting function estimate on this small scale. Thus,
we find that the procedure adopted by Livermore et al. (2017) to
model their uncertainty due to cosmic variance underestimates the
contribution from their observation of a 𝑀UV=−12.5galaxy in an
effective volume of 0.73 cMpc3by at least a factor of 2.
For future small-effective-volume searches that require cosmic
varianceestimates,wesuggestcomputingthevariancedirectlyfrom
simulations, on the scale of the effective search volume, as we have
done here, rather than using fitting functions that are only applica-ble in the large-scale limit. Even using dark-matter-only simulations
for this purpose will provide a much more accurate estimate of the
uncertainty due to cosmic variance than the latter approach. As we
discussedintheintroductionand§3.1,cosmicvarianceintheUVLF
is a result of both variance in the HMF and variance in the SFRs
ofhalosofagivenmass.Whiledark-matter-onlysimulationscannot
account for the latter, the proximity of the red (variance in halos of
agivenmass)andblack(varianceingalaxiesofagivenluminosity)
pointsinFig.10indicatesthatthevarianceinSFRsisasub-dominant
contributor to the deviation of our result from the large-scale fitting
function, since this variance is accounted for in the black points but
not the red ones. Thus, most of the deviation is captured just by ac-
countingforvarianceindarkmatterhaloabundancesonsmallscales,
which can be approximated from dark-matter-only simulations.
3.3 Fitting Functions for the CoDa II UVLF
To parameterize the shape of our CoDa II UVLFs, it is useful to fit
themtoSchechterfunctions,ormodificationsthereof.TheSchechter
function is defined as
Φl=Φ∗
𝐿∗ 𝐿
𝐿∗𝛼
exp
−𝐿
𝐿∗
(8)
whereΦ∗,𝐿∗, and𝛼are free parameters, the last of which is the
logarithmic slope of the faint-end. By convention, the Schechter
function is usually reparameterized in terms of magnitude as
Φm=0.4 ln(10)Φ∗100.4(𝑀∗−𝑀UV)(𝛼+1)exph
−100.4(𝑀∗−𝑀UV)i
(9)
We fit this function to our 𝑧=6CoDa II UVLF in the top panel
of Fig. 12 (thin black line). As can be seen there, the shape of
the Schechter function fails to capture the curvature of the CoDa II
UVLF,duetothefactthattheSchechterfunctionmaintainsaconstant
power law slope at the faint end, while the CoDa II UVLF flattens
out gradually towards fainter magnitudes, due to the suppression of
star formation in low-mass halos caused by reionization feedback.
We can construct a better fit by allowing the power law slope to
changeaboveacertainmagnitude,usingwhatwewillrefertoasthe
Schechter + turn-over function from Jaacks et al. (2013):
Φt=Φm
1+100.4(𝑀𝑇−𝑀UV)𝛽−1
(10)
where𝑀𝑇is the so-called turn-over magnitude, above which the
powerlawslopechanges(inluminosityspace)from 𝛼to𝛼−𝛽.The
fit of this function to the CoDa II UVLF is shown as the red dashed
line in Fig. 12. The fitted model exhibits a turn-over at
𝑀𝑇=−16.9±0.4 (11)
from a power law slope of
𝛼=−2.23±0.05 (12)
to
𝛼−𝛽=−1.36±0.06 (13)
Giventhisturn-overmagnitude,wecanseemoreclearlythedeviation
ofourCoDaIIUVLFfromtheSchechterfunction,byfittingonlythe
bright-end of the UVLF ( 𝑀UV<−17) to a Schechter function, and
extrapolatingthatbright-endfitfaint-ward.Thisisshownastheblack
hashed line in the figure. We can see that the bright-end fit clearly
starts to deviate from the faint-end of the UVLF for 𝑀UV≳−16.
Another modification of the Schechter function was proposed by
Bouwensetal.(2017),whereinthefaintendgradually‘rolls’overat
magnitudesfainterthan −16,takingonasmoothly-varyingparabolic
MNRAS 000, 1–15 (2022)12T. Dawoodbhoy et al.
CoDa IISchechterfit
Schechter +turn-overfit
Schechter +roll-overfitBright -end Schechterfit extrapolated
-22 -20 -18 -16 -14 -1210-510-410-310-210-1100101
MUVΦ cMpc-3mag-1
z=6
z=7
z=8
z=10
z=15CoDa IISchechterfit
Schechter
+roll-overfit
-22 -20 -18 -16 -14 -1210-910-810-710-610-510-410-310-210-1100
MUVΦ cMpc-3mag-1
Figure 12. Left: A comparison of various fitting functions to the CoDa II
full volume UVLF, as labeled. The black hashed line is a Schechter function
fit only to magnitudes bright-ward of −17, but extrapolated faint-ward from
there, to illustrate the degree to which the CoDa II UVLF deviates from the
faint-endpower-lawbehavioroftheSchechterfunction.Right:PureSchechter
and Schechter+roll-over fits at different redshifts. Curves for 𝑧=7,8,10,15
are shifted downward by 1, 2, 3, and 4 dex, respectively.
shape, rather than another power law. We will refer to this as the
Schechter + roll-over function, which is defined as
Φr=(
Φm, 𝑀 UV<−16
Φm10−0.4(−16−𝑀UV)2𝛿, 𝑀UV>−16(14)
Theadvantageofthisfittingfunctionisthatitcapturesthecontinued
changeinslopethatoccursintheUVLFtowardsfaintermagnitudes.
We show this fit as the blue dashed line in Fig. 12. In addition to
𝑧=6,wealsoshowthepureSchechterandSchechter+roll-overfits
totheCoDaIIUVLFat 𝑧=7,8,10,15inthebottompanelofFig.12.
With the exception of 𝑧=15(where our data is most limited), the
pureSchechterfitgetsworsewithdecreasing 𝑧,duetotheincreasing
suppression of low-mass halos as reionization progresses.
AmongstthepreviouslydiscussedHFFanalyses,Livermoreetal.
(2017) and Ishigaki et al. (2018) preferred pure Schechter function
fits,astheirdatashowednosignofaturn-overatthefaint-end,while
Bouwens et al. (2022) and Atek et al. (2018) preferred Schechter
+ roll-over fits. We show each of their best-fit functions, with cor-
responding error, compared to our CoDa II UVLF in Fig. 13, and
provide the best-fit parameter estimates in Table 5. As can be seen,
CoDaIIhasaclearpreferencefortheroll-overmodels,withparam-
eters that are most similar to those of Bouwens et al. (2022).4 CONCLUSIONS
Inthiswork,weanalyzedtheCoDaIIsimulationtostudythespatial
and temporal variations in the high-redshift UVLF during the EOR.
WefindthattheUVLFisstronglycorrelatedwiththelocalreioniza-
tion history of the region in which it is measured. Earlier-reionizing
regions, which have higher overdensities and HMFs, have corre-
spondingly higher UVLFs with brighter exponential cut-off magni-
tudes (𝑀∗). Therefore, the results of small-volume observations of
the high-𝑧UVLF, e.g. those made through high-magnification grav-
itational lenses, will depend on where one looks (e.g. at an early-,
intermediate-, or late-reionizing patch of the universe). In addition,
such observations will also depend on whenone looks – i.e. before
or after the observed region has been reionized. Due to the fact that
the photoheating of gas in the IGM during reionization suppresses
the formation of stars in low-mass halos, the faint-end of the UVLF
in a given region evolves over the course of its local reionization,
becoming increasingly flattened over time. The UVLF of a region
observed after its local reionization will exhibit a turn-over or roll-
over at the faint-end, at magnitudes ≳−17. By𝑧=6, when most
of the universe is reionized, the global UVLF exhibits this faint-end
turn-over, as well, and the gradual flattening of the global faint-end
slope over time can be seen starting from 𝑧=10.
WefindthatourCoDaIIUVLFsareingoodagreementwithdata
from HFF lensing surveys, with the exception of a single data point
from Livermore et al. (2017) of a 𝑀UV=−12.5galaxy observed
at𝑧=6in an effective search volume of 𝑉eff=0.73cMpc3. This
observationimpliesaUVLFthatis ∼10timeshigheratthismagni-
tudethanwhatwepredictfromCoDaII,aswellasafaint-endslope
thatremainssteepdownto 𝑧=6.Thismotivatedustoaskaboutthe
variationoftheUVLFwithpositioninCoDaII,todeterminethelike-
lihoodofthefaint-enddetectionreportedbyLivermoreetal.(2017)
given the limitations of the search technique involving gravitational
lensing amplification by a foreground cluster. Given the abundance
of𝑀UV=−12.5galaxiesinourCoDaIIsimulation,theprobability
of encountering one in a randomly-placed 0.73 cMpc3search vol-
ume at that redshift is found to be relatively small, at ∼4.5%. As
such, our results are more consistent with the analysis of Bouwens
et al. (2017), wherein this observation is re-interpreted as a brighter
galaxyinalargereffectivesearchvolume,withagreateruncertainty
attributed to the lensing models. Indeed, of the four observational
papers whose UVLFs we compare to our simulated one, our results
are most similar to those of Bouwens et al. (2022).
Furthermore, given the stark differences in galaxy abundances on
smallscalesresultingfromspatialandtemporalvariationsindensity
and reionization history, we believe that the uncertainty due to cos-
mic variance attributed to these observations – when using them to
infer the global UVLF – has been underestimated. The uncertainty
duetocosmicvarianceforlensingsurveysliketheHFFsistypically
estimated according to Robertson et al. (2014), in which it is pro-
portional to the galaxy clustering bias derived from the large-scale
𝑁-body simulations and halo bias analysis of Tinker et al. (2010).
However,forthesesmall-scalelensingobservations,wefindthatthe
bias of𝑀UV=−12.5galaxies in 0.8 cMpc3volumes is a factor
of 2– 4 higher than this large-scale estimate, primarily due to the
increased variance in dark matter halo abundances on small scales
vs. large scales. As next-generation space- and ground-based tele-
scopesstarttoprobethehigh- 𝑧Universedowntofaintermagnitudes
than ever before, we expect a more thorough accounting of cosmic
variance–onethataccommodatesthefullscopeofspatialandtem-
poralinhomogeneityduringtheEOR–tobeessentialforreconciling
competing observational inferences and theoretical models.
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 13
Figure 13. Comparisonofour 𝑧=6CoDaIIUVLFwiththefittingfunctions(lightgraylineswitherrorsshownindarkshading)fromLivermoreetal.(2017);
Bouwensetal.(2022);Ishigakietal.(2018);Ateketal.(2018).Livermoreetal.(2017);Ishigakietal.(2018)preferpureSchechterfunctionfits,whileBouwens
et al. (2022); Atek et al. (2018) prefer Schechter functions modified to roll-over at the faint end. Our CoDa II results favor the latter.
Table 5. Best-fit (modified) Schechter function parameters for CoDa II’s globally-averaged UVLFs vs. those inferred from HFF data by 4 studies. The HFF
results are for 𝑧=6.
logΦ∗ 𝑀∗ 𝛼 𝛿
Livermore et al. (2017) −3.647+0.039
−0.037−20.825+0.055
−0.043−2.10+0.05
−0.04–
Bouwens et al. (2022) −3.24±0.08−20.87±0.07−1.87±0.04 0.05±0.10
Ishigaki et al. (2018) −3.78+0.15
−0.15−20.89+0.17
−0.13−2.15+0.08
−0.06–
Atek et al. (2018) −3.54+0.06
−0.07−20.84+0.27
−0.30−2.01+0.12
−0.140.48+0.49
−0.25
CoDa II (𝑧=6)−3.95±0.086−22.3±0.099−1.92±0.026 0.105±0.011
CoDa II (𝑧=7)−4.60±0.16−22.3±0.21−2.08±0.039 0.106±0.016
CoDa II (𝑧=8)−4.74±0.22−21.6±0.30−2.14±0.046 0.100±0.016
CoDa II (𝑧=10)−4.67±0.11−19.8±0.13−2.23±0.026 0.080±0.007
CoDa II (𝑧=15)−6.50±0.08−17.8±0.07−3.06±0.147 0.146±0.034
ACKNOWLEDGEMENTS
ThismaterialisbaseduponworksupportedbytheNationalScience
FoundationGraduateResearchFellowshipProgramunderGrantNo.
DGE-1610403. Any opinions, findings, and conclusions or recom-
mendationsexpressedinthismaterialarethoseoftheauthorsanddo
not necessarily reflect the views of the NSF. This research used re-
sourcesoftheOakRidgeLeadershipComputingFacilityattheOak
Ridge National Lab, which is supported by the Office of Science of
the US Dept. of Energy under Contract No. DE-AC05-00OR22725.CoDaIIwasperformedonTitanatOLCFunderDOEINCITE2016
award to Project AST031. Data analysis was performed using the
computing resources from NSF XSEDE grant TG-AST090005 and
the Texas Advanced Computing Center at the University of Texas
at Austin. PRS acknowledges support from NASA under Grant No.
80NSSC22K175. JL acknowledges support from the DFG via the
Heidelberg Cluster of Excellence STRUCTURES in the framework
of Germany’s Excellence Strategy (grant EXC-2181/1-390900948).
JS acknowledges support from the ANR LOCALIZATION project,
grant ANR-21-CE31-0019 of the French Agence Nationale de la
MNRAS 000, 1–15 (2022)14T. Dawoodbhoy et al.
Recherche. KA is supported by Korea NRF-2021R1A2C1095136,
NRF-2016R1A5A1013277andRS-2022-00197685.KAalsoappre-
ciates the APCTP for its hospitality during completion of this work.
ITIwassupportedbytheScienceandTechnologyFacilitiesCouncil
[grantnumbersST/I000976/1andST/T000473/1]andtheSoutheast
Physics Network. HP was supported by the World Premier Interna-
tionalResearchCenterInitiative,MEXT,JapanandJSPSKAKENHI
grant No. 19K23455. GY acknowledges financial support from MI-
CIU/FEDER under project grant PGC2018-094975-C21.
DATA AVAILABILITY
The data underlying this article are available in the article and in its
online supplementary material.
REFERENCES
Atek H., Richard J., Kneib J.-P., Schaerer D., 2018, MNRAS, 479, 5184
Aubert D., Teyssier R., 2008, MNRAS, 387, 295
Aubert D., et al., 2018, The Astrophysical Journal Letters, 856, L22
Bosman S. E. I., et al., 2022, MNRAS, 514, 55
BouwensR.J.,OeschP.A.,IllingworthG.D.,EllisR.S.,StefanonM.,2017,
ApJ, 843, 129
BouwensR.J.,IllingworthG.,EllisR.S.,OeschP.,StefanonM.,2022,ApJ,
940, 55
Dawoodbhoy T., et al., 2018, MNRAS, 480, 1740
Dayal P., Ferrara A., 2018, Phys. Rep., 780, 1
Deparis N., Aubert D., Ocvirk P., Chardin J., Lewis J., 2019, A&A, 622,
A142
EldridgeJ.J.,StanwayE.R.,XiaoL.,McClellandL.A.S.,TaylorG.,NgM.,
Greis S. M. L., Bray J. C., 2017, Publ. Astron. Soc. Australia, 34, e058
Finlator K., Davé R., Özel F., 2011, ApJ, 743, 169
Gnedin N. Y., 2014, ApJ, 793, 29
Gnedin N. Y., Fan X., 2006, ApJ, 648, 1
González M., Audit E., Huynh P., 2007, A&A, 464, 429
Iliev I. T., Mellema G., Ahn K., Shapiro P. R., Mao Y., Pen U.-L., 2014,
MNRAS, 439, 725
IshigakiM.,KawamataR.,OuchiM.,OguriM.,ShimasakuK.,OnoY.,2018,
ApJ, 854, 73
Jaacks J., Thompson R., Nagamine K., 2013, ApJ, 766, 94
Kannan R., Garaldi E., Smith A., Pakmor R., Springel V., Vogelsberger M.,
Hernquist L., 2022, MNRAS, 511, 4005
Kroupa P., 2001, MNRAS, 322, 231
Kulkarni G., Choudhury T. R., 2011, MNRAS, 412, 2781
Lewis J. S. W., et al., 2022, MNRAS, 516, 3389
Livermore R. C., Finkelstein S. L., Lotz J. M., 2017, ApJ, 835, 113
Lotz J. M., et al., 2017, ApJ, 837, 97
Ocvirk P., et al., 2016, MNRAS, 463, 1462
OcvirkP.,AubertD.,ChardinJ.,DeparisN.,LewisJ.,2019,A&A,626,A77
Ocvirk P., et al., 2020, MNRAS, 496, 4087
Pallottini A., Ferrara A., Gallerani S., Vallini L., Maiolino R., Salvadori S.,
2017, MNRAS, 465, 2540
Pawlik A. H., Rahmati A., Schaye J., Jeon M., Dalla Vecchia C., 2017,
MNRAS, 466, 960
Planck Collaboration et al., 2014, A&A, 571, A16
RobertsonB.E.,EllisR.S.,DunlopJ.S.,McLureR.J.,StarkD.P.,McLeod
D., 2014, ApJ, 796, L27
Rosdahl J., et al., 2018, MNRAS, 479, 994
SawalaT.,FrenkC.S.,CrainR.A.,JenkinsA.,SchayeJ.,TheunsT.,Zavala
J., 2013, MNRAS, 431, 1366
Schechter P., 1976, ApJ, 203, 297
Shapiro P. R., Giroux M. L., Babul A., 1994, ApJ, 427, 25
Sheth R. K., Mo H. J., Tormen G., 2001, MNRAS, 323, 1
So G. C., Norman M. L., Reynolds D. R., Wise J. H., 2014, ApJ, 789, 149
Teyssier R., 2002, A&A, 385, 337Tinker J., Kravtsov A. V., Klypin A., Abazajian K., Warren M., Yepes G.,
Gottlöber S., Holz D. E., 2008, ApJ, 688, 709
TinkerJ.L.,RobertsonB.E.,KravtsovA.V.,KlypinA.,WarrenM.S.,Yepes
G., Gottlöber S., 2010, ApJ, 724, 878
Watson W. A., Iliev I. T., D’Aloisio A., Knebe A., Shapiro P. R., Yepes G.,
2013, MNRAS, 433, 1230
XuH.,WiseJ.H.,NormanM.L.,AhnK.,O’SheaB.W.,2016,ApJ,833,84
Yoshida N., Hosokawa T., Omukai K., 2012, Progress of Theoretical and
Experimental Physics, 2012, 01A305
APPENDIX A: COMPARISON OF THE CODA II GLOBAL
HALO MASS FUNCTION TO STANDARD FITS FROM
DARK-MATTER-ONLY N-BODY RESULTS
A comparison of the global CoDa II HMF at 𝑧=6to the fitting
functions of Sheth et al. (2001); Tinker et al. (2008); Watson et al.
(2013), derived from dark-matter-only (“DMO”) 𝑁-body simula-
tions,isshowninFig.A1.ThetoppanelshowstheHMFsthemselves,
while the bottom panel shows the log of the ratios of the CoDa II
HMFtoeachofthesefittingfunctions,aslabeled.Theshadedregion
in the bottom panel roughly highlights the trend in the difference
between CoDa II and the DMO simulation fits. There is a tendency
fortheCoDaIIHMFtobeabitlowerthantheDMOfitsoverabroad
range of masses, by an amount that is comparable to the spread in
amplitudes of these different fits. This trend steepens, however, at
the low-mass end, below 𝑀≲108.5M⊙. There, we approach the
resolution limit of our simulation, and the trend for the ratios is that
of a power-law with a relatively steep index of ∼0.35. Above this
mass, however, where CoDa II halos contain more than ∼1000DM
particles, the trend flattens to an index of ∼0.1–0.15. This latter
power-lawcontinuesoverordersofmagnitudeinhalomass,allwell
above our resolution limit, until around 𝑀∼1011M⊙. Therefore,
webelievethisloweringoftheHMFinCoDaIIrelativetotheDMO
fitsisaphysicalconsequenceofincludinghydrodynamicsinthesim-
ulation,ratherthananumericallimitation.Inshort,sinceourresults
here for the inhomogeneity of the UVLF, including our use of the
CoDaIIHMFforabundance-matchingdownthroughthefaintendof
theLF,onlydependontheHMFabove 𝑀≳108.5M⊙,theyshould
be robust with respect to our numerical resolution of the HMF.
As shown here by analyzing the CoDa II simulation, the self-
consistent treatment of halo formation including baryonic feedback
effects from star formation, supernovae, and reionization tends to
reduce the HMF relative to that predicted from DMO simulations
by a modest amount. This trend was demonstrated previously by
Sawala et al. (2013), by directly comparing their GIMIC hydrody-
namical simulations with DMO simulations from the same initial
conditions, for halos all the way up to 𝑀≲1012M⊙. As these
authors reported, while the two types of simulation agreed well on
large scales, objects below this mass scale had systematically lower
masses in the GIMIC simulation (i.e. with baryonic hydrodynam-
ics) than in the DMO simulation, resulting in a corresponding shift
downward in the HMF, by a larger amount for smaller mass halos.
This is consistent with the results found here for CoDa II. In fact,
the CoDa II simulation strengthens the case for this trend, since it is
based on fully-coupled radiation-hydrodynamics (i.e. with radiative
transfer), while the GIMIC simulation (with coarser particle-mass
resolution than ours but comparable length resolution) adopted a
uniform, optically-thin photoionizing background, instead.
MNRAS 000, 1–15 (2022)Inhomogeneous UVLF During Reionization 15
1000 particlesCoDa II
SMTTinker
Watson (b=0.2)
Watson (b=0.15 )
8 9 10 11 12-20-15-10-5
log(M/M⊙)logdn
dM[M⊙-1cMpc-3]
M0.35
M0.1-0.151000 particlesSMTTinker
Watson (b=0.2)
Watson (b=0.15 )
8 9 10 11 12-1.0-0.50.00.51.0
log(M/M⊙)log(dn/dM)CoDa II
(dn/dM)fit
Figure A1. AcomparisonoftheCoDaIIHMFat 𝑧=6tothefittingfunctions
fromShethetal.(2001);Tinkeretal.(2008);Watsonetal.(2013).Weshow
two versions of the Watson et al. (2013) fit, adopting Friends-of-Friends
linking parameters of 𝑏=0.2and𝑏=0.15. The top panel shows the HMFs
themselves, while the bottom panel shows the log ratio of the CoDa II HMF
to the various fitting functions, as labeled. The shaded region in the bottom
panel roughly highlights the trend in the difference between CoDa II and the
dark-matter-only simulation fits. At the low-mass end ( 𝑀≲108.5M⊙), we
approachtheresolutionlimitofoursimulation,andthetrendisthattheratios
follow a power-law with an index of ∼0.35. Above this mass, however, the
trendflattenstoanindexof ∼0.1−0.15.Thislatterpower-lawcontinueswell
aboveourresolutionlimit,untilaround 𝑀∼1011M⊙.Therefore,webelieve
thelatterdifferenceisaphysicalconsequenceofincludinghydrodynamicsin
the simulation, rather than a numerical limitation.
APPENDIX B: RELATED MEASURES OF THE UVLF
We present here some additional quantities related to the UVLF,
whichmaybeusefulforfurthertheoreticalorobservationalcompar-
isons.InFig.B1,weplotthenumberofgalaxiesinCoDaIIthatfall
within each magnitude and 𝑧rebin used throughout this paper. This
figure amounts to a renormalization of the various curves shown in
Fig.5,toshowtherelativecontributionsofearly-,intermediate-,and
late-reionizingregionstotheglobalUVLF.Forinstance,onefeature
that can be gleaned easily from this figure is that the magnitude at
which our early-reionization bin transitions from the dominant con-
tributor to a sub-dominant contributor becomes brighter over time.
This is due to the fact that while the early-reionizing regions are
relatively overdense, they also occupy a relatively small volume.
Therefore, these regions form the dominant share of bright galaxies
at early times, but are eventually over-taken as the less-overdense-
but-larger-volume regions become increasingly non-linear at later
times.ThisplotoftheactualnumbersofgalaxiesintheCoDaIIsimula-
tionvolumeateachredshiftalsoillustrateswhyasimulationwithas
largeavolumeasCoDaIIisrequiredinordertomakeastatistically-
meaningful analysis of the UVLF possible. There must be enough
galaxiesformedinthesimulationvolumetoenableustobinthemin
a multi-dimensional space at each redshift, not only by reionization
redshift, but also by magnitude over a wide range, from as faint as
−11to as bright as−23. For example, in order to fit our UVLF to
SchechterfunctionsasinTable5,wemusthavealargeenoughsam-
ple of galaxies in magnitude bins brighter than ∼−21to model the
exponential cut-off without much noise, while also maintaining fine
bin-spacing. For our desired bin size of Δ𝑀UV=0.5, CoDa II con-
tains∼80galaxies at𝑀UV=−21at𝑧=6. A simulation with half
the box size per dimension would, therefore, contain only ∼10, and
wouldhavealmostnogalaxiesinbinsbrighterthan −22.Thus,apart
from their lack of realism in simulating reionization, simulations of
smallervolumewouldunder-samplethebrightend.Whilethenum-
ber of galaxies is much higher at the faint end, it is also necessary
to have the high mass-resolution of CoDa II in order to represent
this number and their luminosities faithfully enough to establish the
flattening of the UVLF relative to the bright end, as an effect of the
suppression of low-mass halos due to reionization.
In Fig. B2, we plot the cumulative number density of CoDa II
galaxies brighter than a given magnitude, again split into 𝑧rebins.
The global line in this figure is used for abundance matching to the
CoDa II HMF in §3.2.1.
This paper has been typeset from a T EX/LATEX file prepared by the author.
MNRAS 000, 1–15 (2022)16T. Dawoodbhoy et al.
Figure B1. Histogram of CoDa II galaxies as a function of magnitude for the same 𝑧rebins and redshifts as previous figures.
Figure B2. Cumulative number density of CoDa II galaxies brighter than a given magnitude for the same 𝑧rebins and redshifts as previous figures.
MNRAS 000, 1–15 (2022)