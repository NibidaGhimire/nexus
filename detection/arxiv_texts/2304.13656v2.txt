A diagrammatic method to compute the
effective Hamiltonian of driven nonlinear oscillators
Xu Xiao,∗Jayameenakshi Venkatraman,∗Rodrigo G. Corti˜ nas, Shoumik Chowdhury,†and Michel H. Devoret‡
Department of Applied Physics and Physics, Yale University, New Haven, CT 06520, USA
(Dated: December 25, 2024)
In this work, we present a new diagrammatic method for computing the effective Hamiltonian
of driven nonlinear oscillators. At the heart of our method is a self-consistent perturbation ex-
pansion developed in phase space, which establishes a direct correspondence between the diagram
and algebra. Each diagram corresponds to a Hamiltonian term, the prefactor of which, like those
in Feynman diagrams, involves a simple counting of topologically equivalent diagrams. Leveraging
the algorithmic simplicity of our diagrammatic method, we provide a readily available computer
program that generates the effective Hamiltonian to arbitrary order. We show the consistency of
our schemes with existing perturbation methods such as the Schrieffer-Wolff method. Furthermore,
we recover the classical harmonic balance scheme from our result in the limit of ℏ→0. Our method
contributes to the understanding of dynamic control within quantum systems and achieves preci-
sion essential for advancing future quantum information processors. To demonstrate its value and
versatility, we analyze five examples from the field of superconducting circuits. These include an ex-
perimental proposal for the Hamiltonian stabilization of a three-legged Schr¨ odinger cat, modeling of
energy renormalization phenomena in superconducting circuits experiments, a comprehensive char-
acterization of multiphoton resonances in a driven transmon, a proposal for an inductively shunted
transmon circuit, and a characterization of classical ultra-subharmonic bifurcation in driven oscilla-
tors. Lastly, we benchmark the performance of our method by comparing it with experimental data
and exact Floquet numerical diagonalization.
CONTENTS
I. Introduction and Motivation 2
II. The System of Interest 4
III. Quantum Harmonic Balance Approach to the
Diagrammatic Perturbation Method 5
A. Self-consistent perturbation expansion 5
B. Introducing the diagrammatic
representation 8
C. Enter the bare diagrams: order 1 10
D. Enter the off-resonant excitations: order 2 13
E. Dressed off-resonant excitation 14
F. Dressed resonant excitation 17
IV. Axiomatic Presentation of the Diagrammatic
Perturbation Method 19
A. Motivation 19
B. Recipe for evaluating diagrams 19
V. Remarks and Extensions 20
A. General form of the effective Hamiltonian 20
B. Extension to multi-mode and multi-tone
systems 21
C. Extension to open quantum systems 21
∗These two authors contributed equally; xu.xiao@yale.edu,
jaya.venkat@yale.edu
†present address: Massachusetts Institute of Technology, Cam-
bridge, MA 02139
‡michel.devoret@yale.eduD. Choice of rotating frame and the general
slow-evolving effective Hamiltonian 23
E. Relation to Floquet formalism 25
VI. Application Examples 26
A. Stabilization of three-legged Schr¨ odinger
cats 26
B. Modeling the energy renormalization effects
of a driven superconducting circuit and
comparison with experimental results 30
C. Multiphoton resonances in a driven
superconducting circuit 32
D. Mitigating nonlinear resonance with
inductively-shunted transmon 40
E. Ultrasubharmonic bifurcation in classical
driven nonlinear oscillator 43
VII. Conclusion 49
Acknowledgements 50
Appendix A. Glossary 50
Appendix B. List of Symbols 51
Appendix C. Frame Transformation 53
Appendix D. Proof of
∂˜a∗(˜a+ ˜a∗)m
›=m(˜a+ ˜a∗)m−1
› 54
Appendix E. Quantum Harmonic Balance as a
Refined Averaging Method 54
Appendix F. Equivalence between the additive
and exponential forms of the framearXiv:2304.13656v2  [quant-ph]  24 Dec 20242
transformation underlying USH 55
Appendix G. A self-consistent reformulation of
Rayleigh-Schr¨ odinger perturbative expansion 56
Appendix H. Hamiltonian of Multimode
Nonlinear Oscillator in Normal Modes 61
Appendix I. Computing Coupling Strength
Through the Effective Hamiltonian 63
Appendix J. Floquet Numerical
Diagonalization 66
Appendix K. Estimated Transmon States Under
Displacement and Excitation Possibility 66
Appendix L. Duffing Equation and Duffing
Bifurcation 68
References 69
I. INTRODUCTION AND MOTIVATION
The nonlinear oscillator driven by a sinusoidally time-
varying force, whose archetype is the driven pendu-
lum, is a rich playground of diverse dynamical behav-
iors that include bifurcation and chaos [1, 2]. Latest
advances in quantum electrodynamics with Josephson
circuits (cQED) transpose century-old, classical nonlin-
ear dynamical phenomena into a new quantum regime.
This results from the property of the Josephson junc-
tion to behave at dilution refrigerator temperatures as
an extremely fast non-dissipative pendulum-like electro-
magnetic oscillator. Quantum-limited amplification [3–
6] for high-fidelity readout [7], fast parametric gates for
bosonic codes [8, 9], and the generation and stabiliza-
tion of non-classical states like Schr¨ odinger cat states [10]
and Gottesman-Kitaev-Preskill (GKP) states [11] are ex-
amples of processes taking place in this new quantum
regime.
The Hamiltonian of the generic driven nonlinear oscil-
lator can be written as
ˆH(t)
ℏ=ωoˆa†ˆa+X
m≥3gm
m(ˆa+ ˆa†)m
−iΩd(ˆa−ˆa†) cosωdt,(1)
where ωoandgm≪ωoare the natural frequency and
m-th rank nonlinearity coefficient of the oscillator, ˆ ais
the bosonic annihilation operator, and the driving force
(thereafter shortened to “drive”) is specified by its ampli-
tude Ω dand frequency ωd. In the context of cQED, the
Hamiltonian Eq. (1) represents a charge-driven Joseph-
son circuit with a single degree of freedom, whose hard-
ware design determines the nonlinear constants gm.1
1In certain devices, and to a certain extent, these coefficients are
tunable in situ by the magnetic flux threading the loops of the
circuit.The Hamiltonian Eq. (1) gives rise to a variety of dy-
namical processes with no static counterpart. Their rel-
ative strengths can be adjusted in situ by the drive am-
plitude Ω dand frequency ωd. Remarkably, in the pertur-
bative regime, to be defined rigorously below, these pro-
cesses can be described by a time-independent effective
Hamiltonian. We now illustrate this claim by describ-
ing two simple examples whose exact calculation will be
treated in the rest of the work.
Example I: the Kerr-cat qubit Hamiltonian. We first
consider the case where we limit the range of nonlinearity
rank to g3andg4and the effective Hamiltonian terms to
first order in these coefficients. This situation can be
obtained in practice with a SNAIL circuit [12] operating
with non-zero external magnetic flux. When the drive
frequency ωdis tuned in the vicinity of 2 ωo, the system
undergoes a period-doubling bifurcation. In the quantum
regime, the effective ground state of the system will be
doubly quasi-degenerate and exhibit a Schr¨ odinger cat
manifold (see Figure 1 (a) and [10, 13]). Under a frame
transformation amounting to ˆ a→ˆae−iωd
2t+ξe−iωdt+
O(1/ωd) with ξ≈4iΩd
3ωd,2we arrive at an effective time-
independent Hamiltonian
ˆKωd
2
ℏ= ∆ˆa†ˆa+3g4
2ˆa†2ˆa2
+g3ξ∗ˆa†2+g3ξˆa2+O1
ωd(2)
where ∆ = ωo−ωd
2+ 3g4+ 6g4|ξ|2. The subscript in the
Hamiltonian Eq. (2) indicates the rotating frame to which
the oscillator is transformed. This level of approximation
is often called the rotating wave approximation (RWA).
Inside the O(1/ωd) will be obtained later in this article.
The Hamiltonian Eq. (2) has received lately theoretical
and experimental attention in the context of quantum
information processing [10, 13].
The emergence of the effective time-independent
Hamiltonian Eq. (2) from the time-dependent Eq. (1)
can be understood from diagrams that have been previ-
ously proposed [6, 14, 15]. In this way, the static effective
squeezing term g3ξ∗ˆa†2in Eq. (2) corresponds to the di-
agram
. (3a)
This diagram should be read in the usual “Feynman dia-
gram” manner: each diagrammatic element corresponds
to a factor that is multiplied with other factors to give
the term corresponding to the whole. The diagram illus-
trates an harmonic mixing process: a 3-wave interaction,
2Here Ω dis taken to be O(ωd) and thus ξto beO(1).3
(a)
(b)
FIG. 1. Wigner functions Wof the ground state manifold
for a driven nonlinear oscillator with nonlinearities g3/ωo=
0.04, g4/ωo= 0.003 under different driving conditions. They
are obtained by numerical diagonalization. Panel (a) corre-
sponds to Eq. (2) with ωd/ωo= 1.996 and Ω d/ωo= 0.2. The
ground states are two perfectly degenerate Schr¨ odinger cat
states. Panel (b) corresponds to Eq. (4) with ωd/ωo= 1.481
and Ω d/ωo= 0.7. The ground states are three-fold nearly
degenerate comprising three-legged cat-like states.
which stems from the 3rd rank nonlinearity of the oscil-
lator, takes in a drive excitation
 at frequency ωdand
generates two resonant excitations of the oscillator
 ,
which are at frequencies in the vicinity of the oscillator’s
natural frequency, i.e., ωd/2≈ωo. The corresponding
term has a net zero frequency oscillation and thus be-
longs to the effective time-independent Hamiltonian.
Similarly, the Kerr nonlinearity3g4
2ˆa†2ˆa2in Eq. (2) can
be represented by the diagram
, (3b)
in which a 4-wave interaction, which stems from the 4th
rank nonlinearity of the oscillator, intakes two resonant
excitations and produces two resonant excitations of the
oscillator.
Example II: three-legged cat Hamiltonian. Our second
example consists of another type of bifurcation that re-
quires more involved diagrams. When the same hard-
ware described above is submitted to a drive with fre-
quency ωdin the vicinity of 3 ωo/2, the system undergoes
a period-tripling bifurcation. The effective ground state
becomes triply quasi-degenerate and exhibits a three-
legged Schr¨ odinger cat manifold (see Fig. 1 (b)). Under
a frame transformation amounting to ˆ a→ˆae−i2
3ωdt+
ξe−iωdt+O(1/ωd) where ξ≈9iΩd
5ωd, Eq. (1) transformsinto another time-independent Hamiltonian capturing
this effective dynamics
ˆK2
3ωd
ℏ= ∆ˆa†ˆa+3g4
2−5g2
3
ωd
ˆa†2ˆa2
+195g3
3
4ω2
d−165g3g4
8ωd
ξ2ˆa†3+ h.c.
+O1
ω3
d
,(4)
where ∆ = ωo−2ωd
3+ 3g4−10g2
3
ωd+ (6g4−180g2
3
7ωd)|ξ|2+
O(1
ω2
d). The threefold symmetry emerges from the “be-
yond RWA” term ξ2ˆa†3, which, in this condition, is reso-
nant. The three-legged cats emerging from Hamiltonian
in the form of Eq. (4) have also received theoretical and
experimental attention recently for quantum information
processing [16–18].
From the diagrammatic heuristics, the beyond RWA
terms in Eq. (4) can be understood as cascaded diagrams.
For example, the term (195g3
3
4ω2
d−165g3g4
8ωd)ξ2ˆa†3corresponds
to the diagrams
(5)
in which three 3-wave “mixing vertices”, nicknamed
“mixers” in the following, are cascaded together to form
the first diagram and a 3-wave and a 4-wave mixers are
cascaded together to form the second. Each of the dia-
grams intakes two drive excitations and produces three
resonant excitations of the oscillator. However, it is not
easy to see how the negative sign in −165g3g4
8ωdemerges
from the diagrams above. This problem points to the lim-
itations of the heuristic diagrams, which, at this stage,
have only an interpretational role instead of a calcula-
tional one.
Beyond heuristic diagrams. Can the heuristic dia-
grams that we have presented in these two examples be
formalized as components of a systematic procedure? In
this article, we answer positively to this question and con-
struct a stand-alone diagrammatic method to efficiently
compute effective static Hamiltonian of driven nonlinear
oscillators. At the level of pen and paper, our formaliza-
tion of the diagrammatic heuristics leads to the complete
list of Hamiltonian terms at any order. Their prefactors
involve the simple counting of topologically equivalent
diagrams. Because the analytical work becomes tedious
as order in perturbation is increased, we also provide a
ready-to-use computer program to generate the full ex-
pansion to any order [19]. We validate the approach by
benchmarking our results against numerical simulation
and experimental data. We also use it to explain and
predict novel phenomena in the context of cQED.4
The rest of the article is divided into two main parts:
First, in Sections II to IV, we formally introduce the
diagrammatic formulation. In Sections V and VI we dis-
cuss the implications of this new method and apply it to
analyze particular systems in cQED. Each of these sec-
tions and the subsections within are written in a mod-
ular manner so that the readers can selectively engage
with the topics. Specifically, in Section II we discuss the
Hamiltonian of a generic driven nonlinear oscillator and
the required frame transformations to prepare it for the
perturbative analysis. In Section III, we derive our di-
agrammatic expansion from a novel quantum averaging
perturbation method named as quantum harmonic bal-
ance (QHB). This method is developed in phase space
that puts classical and quantum dynamics on equal foot-
ing while highlighting their difference arising from order-
ℏcorrections to the classical Poisson bracket. By car-
rying out QHB iteratively to lowest orders, we derive
the rules for operating and evaluating diagrams from
those of an algebra. In Section IV, we present the di-
agrammatic method in an axiomatic and non-iterative
form, which provides a succinct and compact recipe. In
Section V, we discuss the general form of the effective
Hamiltonian, the extension of the diagrams to multi-
mode and multi-tone nonlinear oscillators, its extension
to open quantum systems described by the effective Lind-
bladian, the necessary conditions and limits of choosing
a specific rotating frame to construct the diagrams, and
the relation between our diagrammatic method and other
Floquet methods. In Section VI A we use diagrams to
compute the effective Hamiltonian governing the three-
legged Schr¨ odinger cat as an illustrative example. In Sec-
tion VI B, we compute the energy renormalization of a
multi-mode superconducting circuit, which consists of a
cavity coupled to a transmon, and show good agreement
with experimental data. In Section VI C, we provide a
systematic characterization of multiphoton resonance in
Josephson circuits, which limits most of the readout and
pumping schemes in cQED. These processes lacked an
analytical description until our work. We validate these
description with the exact Floquet numerical diagonal-
ization and comment on the relationship between the de-
scriptions in terms of an effective static Hamiltonian and
the quasienergies provided by Floquet diagonalization.
In Section VI D, we propose a circuit, the inductively-
shunted transmon (IST), to mitigate the multiphoton
resonance. In Section VI E, we characterize the gen-
eral ultra-subharmonic bifurcation process that occurs
in a driven nonlinear oscillator, which has important im-
plications in the design of bifurcation-based amplifiers,
Schr¨ odinger-cat logical qubits, and readout schemes. In
Section VII we conclude our work and discuss future di-
rections.II. THE SYSTEM OF INTEREST
In this section, we formally introduce the system of in-
terest, its inherent perturbative structure, and the frame
transformations to prepare it for the perturbation analy-
sis. We write the general Hamiltonian of a driven quan-
tum oscillator as
ˆH(t) =ˆp2
2µ+ˆU(ˆq) +fcos (ωdt)ˆq, (6)
where µis the mass of the oscillator, ˆ qand ˆpare the
conjugate position and momentum coordinates satisfying
[ˆq,ˆp] =iℏ. The function ˆU(ˆq) is the nonlinear potential
of the oscillator, which we assume to have the form of
ˆU(ˆq) =X
m≥2cmˆqm
when Taylor expanded around the potential minimum at
q= 0. Here the coefficients c2=1
2µω2
oandcm>2de-
fine the harmonic and anharmonic parts of the oscillator
potential respectively, where ωois the small-oscillation
frequency of the oscillator. The parameters fandωdin
Eq. (6) are respectively the strength and frequency of the
external drive.3
The Hamiltonian Eq. (6) can be re-expressed in a
bosonic basis as
ˆH(t) =ωoˆa†ˆa+X
m≥3gm
m(ˆa+ ˆa†)m
+ Ωd(ˆa+ ˆa†) cos( ωdt),(7)
where we have defined the scaled bosonic coordinates
ˆa,ˆa†with ˆ a=√
ℏ
2
ˆq
qzps+iˆp
pzps
, and qzps=p
ℏ/2µωo
andpzps=p
ℏµωo/2 are the zero-point-spreads of the
corresponding coordinates. Here, we impose the commu-
tator [ˆ a,ˆa†] =ℏto explicitly track the quantum correc-
tions to the classical driven nonlinear dynamics. Rescal-
ing the coordinates, such that [ˆ a,ˆa†] = 1, yields the stan-
dard bosonic ladder operators used in Eq. (1). The co-
efficient gm=mcmℏωo
4c2ℏm/2qm−2
zps in Eq. (7) is the m-th rank
nonlinearity of the oscillator and Ω d=fqzps/√
λis the
drive amplitude.
We further perform a frame transformation amounting
to ˆa→ˆae−iω′
ot+ξe−iωdt, where ξ=Ωdωo
ω2o−ω2
d(see footnote4
3Unlike in Eq. (1), Eq. (6) features a drive that couples to the
position degree of freedom, which is more natural for a driven
mechanical oscillator. This choice does not affect qualitatively
our treatment and we address any change arising from the
momentum-coupling usually found in superconducting circuits
in the following footnote.
4When the drive couples to the system through the momentum
degree of freedom ˆ pas in Eq. (1), we have Ω d=√
λfpzpsand
ξ=iΩdωd
ω2
d−ω2oin Eq. (8), with no further change in the rest of the
treatment.5
and Appendix C for details), to bring the pertinent non-
linear process into focus. The transformed Hamiltonian
reads
ˆH(t) =δˆa†ˆa+X
m≥3gm
m(ˆae−iω′
ot+ ˆa†eiω′
ot
+ξe−iωdt+ξ∗eiωdt)m,(8)
where δ=ωo−ω′
o. We note that the choice of ω′
ocontains
a priori knowledge about the rotating frame in which
the nonlinear process of interest occurs. For example, in
the Kerr-cat and three-legged cat systems in Section I,
ω′
ois respectively taken to be ωd/2 and 2 ωd/3, corre-
sponding to the dominant ultra-subharmonics generated
from the drive in a period-doubling and a period-tripling
bifurcation. This relevant frame, which is discussed in
more detail in Section V D, is usually some p/q-th ultra-
subharmonic of the drive that is near-resonant with the
oscillator, i.e. δ=ωo−pωd/q≪ωo∼ωdfor some inte-
gersq, p. For now, we assume there is only one such frame
containing nontrivial nonlinear processes. The treatment
for multiple nontrivial nonlinear processes coexisting will
be discussed later in the text.
The Hamiltonian Eq. (8) constitutes the starting point
of the perturbative analysis underlying the diagrammatic
method. Our perturbative parameters are δandgm’s.
We also demand the oscillator to be in the weakly excited
quantum regime, which translates into the nonlinearities
obeying the perturbative structure:
ℏm
2
ℏωo|ξ|gm+1<∼ℏm
2
ℏωoq
⟨ˆa†ˆa⟩gm+1≪ℏm
2
ℏωogm≪1,(9)
where ⟨ˆa†ˆa⟩is the expectation value of the pertinent
quantum states over the operator ˆ a†ˆa. Note that with
non-zero gm’s, only the Fock states below a certain ex-
citation number satisfy the above perturbative condition
and our treatment is restricted to them. Recalling the
definition of gm∼mcmℏωo
4c2ℏm/2qm−2
zps, it is then convenient
to introduce the notation gm=O(qm−2
zps) and use qzps
to count the perturbative order of terms in Eq. (8) and
the subsequent perturbative expansion. For detuning
δ≪ωoand effective drive strength ξ=Ωdωo
ω2
d−ω2o, we assign
the perturbative order O(qzps) andO(q0
zps), respectively.
We also remark that in the case of multiple modes or
drives, one still obtains a Hamiltonian in the transformed
frame resembling Eq. (8), but with more participants in
the multinomial expansion. The diagrammatic rule de-
rived for the single-mode problem can be extended to
the multi-mode or multi-tone cases, which we discuss in
Section V B.
Note that with non-zero gm’s, only the Fock states
below a certain excitation number satisfy the above per-
turbative condition and our treatment is restricted to
them. Recalling the definition of gm∼mcmℏωo
4c2ℏm/2qm−2
zps, it is
then convenient to introduce the notation gm=O(qm−2
zps)
and use qzpsto count the perturbative order of terms in
Eq. (8) and the subsequent perturbative expansion. Fordetuning δ≪ωoand effective drive strength ξ=Ωdωo
ω2
d−ω2o,
we assign the perturbative order O(qzps) and O(q0
zps),
respectively. We also remark that in the case of mul-
tiple modes or drives, one still obtains a Hamiltonian in
the transformed frame resembling Eq. (8), but with more
participants in the multinomial expansion. The diagram-
matic rule derived for the single-mode problem can be
extended to the multi-mode or multi-tone cases, which
we discuss in Section V B.
III. QUANTUM HARMONIC BALANCE
APPROACH TO THE DIAGRAMMATIC
PERTURBATION METHOD
A. Self-consistent perturbation expansion
1. proposing a canonical transformation
We are now ready to introduce the perturbation
method underlying our diagrammatic method, which we
refer to as the quantum harmonic balance (QHB), be-
cause of its analogy to the harmonic balance method in
classical nonlinear dynamics [20]. The starting point of
the QHB is the Heisenberg equation of motion for the
operator ˆ asubmitted to the Hamiltonian ˆHin Eq. (8):
dtˆa=−1
iℏ[ˆH,ˆa]. (10)
Under the drive, the evolution of ˆ aexhibits distinct time-
scales: a slow evolving dynamics on the time-scale of δ
andgm/ℏm
2−1, and a fastoscillating one comparable to
the drive oscillation at frequency ωd. In many driven
systems, the nonlinear processes of interest happen on
a relatively slow time-scale5while the fast dynamics is
considered a secondary “micromotion”. While this sepa-
ration of time-scales provides simplification in describing
the driven nonlinear dynamics, it is important to recog-
nize that the slow dynamics and the micromotion cou-
ple to each other through the oscillator’s nonlinearity.
Therefore, the goal here — as in high frequency per-
turbation theories in general [21] — is to seek a frame
transformation ˆ a→ˆAplacing the relevant dynamics at
the forefront. In this sought-after frame, the dynamics
of the transformed operators ˆA,ˆA†should be generated
by a time-independent hermitian “Kamiltonian” [22] ˆK
through the equation of motion:
dtˆA=−1
iℏ[ˆK(ˆA,ˆA†),ˆA], (11)
and we call ˆKas the static effective Hamiltonian.
5For instance, the Rabi oscillation frequency between two nearby
levels in a quantum nonlinear system is usually much lower than
the Larmor frequency inducing the transition.6
To find this effective frame, we assume that the original
frame is only perturbatively different from the sought-
after one by a time-independent quantity ˆ σ= ˆσ(ˆA,ˆA†)
and a purely oscillating quantity ˆ µ= ˆµ(ˆA,ˆA†, t), i.e.
ˆa=ˆA+ ˆσ(ˆA,ˆA†) + ˆµ(ˆA,ˆA†, t). (12)
A non-zero periodic function fis deemed purely oscil-
lating if its time-average is zero, i.e.RT
0dtf= 0 for T
being the period of the function f. Eq. (12) should be
understood as an additive representation of the frame
transformation that generalizes the widely-employed av-
eraging methods [23–27] that address rapidly-driven sys-
tems. In addition, to enforce that this frame transfor-
mation is canonical, we further express Eq. (12) as an
exponential map:
ˆa=eLˆSˆA
=ˆA+1
iℏ[ˆS,ˆA] +1
2!(iℏ)2[ˆS,[ˆS,ˆA]] +···(13)
where ˆS=ˆS(ˆA,ˆA†, t) is assumed to be a hermitian oscil-
lating function generating the frame transformation. The
super-operator LˆS
=1
iℏ[ˆS,
] is the Hilbert space Lie
derivative with respective to ˆS. This exponential map is
also a unitary transformation, i.e. eLˆSˆA=eˆS/iℏˆAe−ˆS/iℏ,
and its equivalence to Eq. (13) can be obtained via the
Baker-Campbell-Hausdorff formula. For clarity in our
discussion, we opt for the super-operator notation LˆSfor
the generator of the transformation in Eq. (13).
We note that the canonical constraint Eq. (13) is a
theoretical improvement we introduce in this work over
the conventional averaging methods [23–27] which often
suffer from the issue of non-canonicity [28]. We will
elaborate this problem and its remedy in more detail
in Appendix E. In addition, we also remark that there
exists an alternative class of high-frequency perturba-
tion techniques, such as the Schrieffer-Wolff expansion
[21, 29, 30] and the Floquet-Magnus expansion [31], that
construct the exponential map directly through finding
ˆSin Eq. (13). As we will subsequently demonstrate in
Section V E and rigorously prove in Appendix F, the per-
turbation method we develop in this work aligns with the
Schrieffer-Wolff expansion and provides deeper insights
into the dynamics of driven nonlinear systems, along with
computational speed-up.
With this frame transformation defined by Eq. (12),
Eq. (10) can be rewritten as
1
iℏ[ˆK,ˆA]−∂tˆµ+1
iℏ[ˆK,ˆσ+ ˆµ] =1
iℏ[ˆH,ˆa]ˆa=ˆA+ˆσ+ˆµ
ˆa†=ˆA†+ˆσ†+ˆµ†,
(14)
where, on the left-hand side of the equation, we have used
the Heisenberg equation of motion for ˆA,ˆσ, and ˆ µ. The
task now is to perturbatively find ˆK,ˆσ, and ˆ µthat satisfy
the Eq. (14) at each order of the perturbative parameter.2. phase-space representation of quantum mechanics
Prior to performing the explicit computation, it is im-
portant to note that our perturbative analysis will be
developed in phase space rather than Hilbert space. To
facilitate this approach, we introduce the Husimi trans-
formH, a modification of Wigner transform [32–34], that
transforms physical quantities in the Hilbert space to
the Husimi Q phase space. Comparing with the Hilbert
space formulation that operates via matrix algebra, the
phase-space formulation of quantum mechanics operates
by taking partial derivatives of phase-space functions and
thus lends itself more naturally to a diagrammatic rep-
resentation that features quantum corrections to clas-
sical results. Moreover, the Husimi Q representation
is chosen, among other isomorphic representations of
the phase-space formulation, because it privileges the
normal-ordering of operators in Hilbert space, a con-
venient choice for studying quantum nonlinear dynam-
ics [34]. We emphasize that developing a diagrammatic
method in Hilbert space is also feasible using bosonic op-
erator identities. Yet many diagrammatic properties and
the relationship between quantum and classical regimes
would then be obscured.
In the Husimi space, Eq. (14) transforms under Has:
{ {˜K,˜A} } ˜A,˜A∗−∂t˜µ+{ {˜K,˜σ+ ˜µ} }˜A,˜A∗
={ {˜H,˜a} }˜a=˜A+˜σ+˜η
˜a∗=˜A∗+˜σ∗+˜η∗,
(15)
with the Husimi transform Hobeying the properties
H(ˆf) =˜f, H(ˆfˆg) =˜f›˜g,
H1
iℏ[ˆf,ˆg]
={ {˜f,˜g} }=1
iℏ(˜f›˜g−˜g›˜f),(16)
where Hilbert-space operators ˆf, ˆgare transformed to
phase-space functions ˜fand ˜g. We have here introduced
the symbol { {
,
} }standing for the Husimi bracket (a
modification of Moyal’s bracket [32]). Crucial to this
scheme, the bidifferential operator ›(a modification
of Groenwold’s star-product [32, 33]) is the underlying
product of this phase-space algebra and is defined as
˜f›˜g=˜fexp
ℏ← −∂˜a− →∂˜a∗
˜g
=X
k≥0ℏk
k!˜f(← −∂˜a− →∂˜a∗)k˜g
=˜f˜g+ℏ∂˜a˜f∂˜a∗˜g+···.(17)
When we subscript a Husimi bracket, for example as
{ {
,
} }˜A,˜A∗, it is evaluated over the subscript phase
space complex coordinates. As one can easily verify,
from a normal-ordered operator ˆf, the phase-space func-
tion ˜f=H(ˆf) is obtained readily by replacing its argu-
ments ˆ aand ˆa†by (now commuting) arguments which7
are complex scalars ˜ aand ˜a∗. Conversely, the operator
ˆf=H−1(˜f) can be obtained from ˜fby simply mov-
ing the ˜ a∗factors in ˜fto the left of ˜ aand replacing the
phase-space coordinates by their respective Hilbert space
operators, with no other change.
To leading order in ℏ, the star product defined by
Eq. (17) is just the regular multiplication, and at the
same order, the Husimi bracket is just the Poisson
bracket that generates classical dynamics. Thanks to
the continuous deformation between the phase-space for-
mulation of quantum mechanics and classical mechanics,controlled by the single real parameter ℏ[32], all of the
analysis we develop next can be applied to a classical
driven nonlinear oscillator by taking the limit ℏ→0.
3. self-consistent equations underlying the perturbative
method
We now plug ˜H, the phase-space function associated
with Eq. (8), into the Eq. (15) and rewrite the latter as
∂˜A∗˜K+i∂t˜µ−i{ {˜K,˜σ+ ˜µ} }˜A,˜A∗=X
m≥3eiω′
otgm
(˜A+ ˜σ+ ˜µ)e−iω′
ot+ (˜A∗+ ˜σ∗+ ˜µ∗)eiω′
ot+ξe−iωdt+ξ∗eiωdtm−1
›
+δ(˜A+ ˜σ+ ˜µ).(18)
In writing the right-hand side of Eq. (18), we have em-
ployed the chain rule ∂˜A∗(α˜A+β˜A∗)m
›=mβ(α˜A+
β˜A∗)m−1
› for constants αandβ(see Appendix D for a
proof), and the multinomial expansion with subscript ›
means that any two terms in the expansion are associ-
ated with a star product, which here and in the rest of
the paper is evaluated over ˜Aand ˜A∗.
With Eq. (18), analyzing the dynamics of the oscillator
translates to solving the equation for the unknowns ˜K,
˜σ, and ˜ µsubject to the constraints that (1) ˜Kand ˜σare
time-independent (2) ˜ µis purely oscillating, and (3) the
transformation ˜ a→˜Ais canonical, i.e.
˜A+ ˜σ+ ˜µ=eL˜S˜A, (19)
with a real function ˜S=˜S(˜A,˜A∗, t). However, solving
Eq. (18) directly is challenging due to the intricate inter-
dependency between ˜K, ˜σ, and ˜ η. A critical strategy we
adopt involves a set of change of variables:
˜M=i∂t˜µ−i{ {K,˜µ} } −δ˜µ, (20a)
˜B=˜A+ ˜σ, (20b)
˜Γ =−i{ {˜K,˜B} }=∂˜A∗˜K−i{ {˜K,˜B − ˜A} }, (20c)
where ˜Band˜Γ are time-independent, and ˜Mis purely
oscillating by construction. These changes of variables
are inspired by the diagrammatic formulation yet to be
introduced. For the moment, they should be understood
as to decompose Eq. (18) into a set of coupled equations
each of simpler form and clearer physical meaning.
Specifically, with the new set of variables, Eq. (18) can
be written in a more succinct form as:
˜Γ + ˜M=X
m≥3eiω′
otgm
(˜B+ ˜µ)e−iω′
ot+ (˜B∗+ ˜µ∗)eiω′
ot
+ξe−iωdt+ξ∗eiωdtm−1
›+δ˜B (21)By further imposing that ˜Γ is time-independent and ˜M
is purely oscillating, we have
˜Γ = Sta X
m≥3eiω′
otgm
(˜B+ ˜µ)e−iω′
ot+ (˜B∗+ ˜µ∗)eiω′
ot
+ξe−iωdt+ξ∗eiωdtm−1
›+δ˜B!
(22a)
˜M= Rot X
m≥3eiω′
otgm
(˜B+ ˜µ)e−iω′
ot+ (˜B∗+ ˜µ∗)eiω′
ot
+ξe−iωdt+ξ∗eiωdtm−1
›! ,
(22b)
where the operators Sta( ˜f) =RT
0dt˜fand Rot( ˜f) =
˜f−Sta(˜f) respectively extract the static and rotating
components of a given periodic function ˜fwith period
T. From the canonicity of the transformation enforced
by Eq. (19) and from Eqs. (20a) to (20c), we can also
obtain
˜µ=−iZ
dt˜M+Z
dt 
−iδµ+{ {˜K,˜µ} }
(22c)
˜B=˜A+
Sta(eL˜S˜A)−˜A
(22d)
i˜S=Z
d˜A∗˜µ+Z
d˜A∗
−Rot(eL˜S˜A) +i{ {˜A, i˜S} }
(22e)
˜K=Z
d˜A∗˜Γ +Z
d˜A∗i{ {˜K,˜B − ˜A} } (22f)
where Eq. (22e) represents the inversion of the relation
˜µ= Rot( eLˆS˜A), thereby defining ˜Sself-consistently.
Eqs. (22a) to (22f) form a set of self-consistent equa-
tions, each having the structure
x=f(⃗ y) +g(x, ⃗ y),8
where x∈ {˜Γ,˜M,˜µ,˜B,˜S,˜K}is an unknown of the prob-
lem, and ⃗ yrepresents the other unknowns. The term
f(⃗ y) provides the leading-order contribution in x, while
g(x, ⃗ y) contains higher-order corrections that depend self-
consistently on xitself.6To systematically solve these
equations order by order, we introduce a perturbative
expansion in terms of the small parameter qzps:
˜Γ =X
n>0˜Γ(n),˜M=X
n>0˜M(n),˜µ=X
n>0˜µ(n),
˜K=X
n>0˜K(n),˜B=˜A+X
n>0˜B(n),˜S=X
n>0˜S(n),(23)
where ˜Ais considered the zeroth-order term. Within this
perturbative framework, one can substitute these expan-
sions into the original self-consistent equations and de-
termine each correction ˜Γ(n),˜M(n),˜µ(n),˜K(n),˜B(n),˜S(n)
iteratively, ensuring a systematic approach to solving the
full nonlinear problem. Notably, Eq. (22) is structurally
akin to the Dyson equation in quantum electrodynamics,
which defines the Green’s function of a particle in a self-
consistent manner and serves as a foundation for deriving
Feynman diagrams [35, 36]. Analogously, Eq. (22) can be
regarded as a stand-alone perturbative framework from
which our diagrammatic method will be constructed.
In the remainder of this section, we will implement
the self-consistent equations in Eq. (22) using diagram-
matic representation that clarifies their relevance to phys-
ical processes. Later, in Section IV, we will introduce
a stand-alone diagrammatic approach that does not de-
pend on Eq. (22). It is also important to remark that,
while our current focus is on driven bosonic systems,
the self-consistent framework presented herein is versa-
tile and can be adapted to other perturbative techniques.
In Appendix G, we demonstrate the universal applicabil-
ity of this approach by reformulating the well-established
Rayleigh-Schr¨ odinger perturbation theory as operator-
valued self-consistent equations. This reformulation not
only allows for more insightful physical interpretations
but also bridges it with another widely-used method, the
Brillouin-Wigner perturbative theory.
B. Introducing the diagrammatic representation
To introduce the diagrammatic representation, we first
translate Eqs. (22a) and (22b), each with an additional
6For Eqs. (22a) and (22b), their corresponding g(x, ⃗ y)’s are zero.global phase e−iω′
ot, into the diagrams as follows:
=X
m≥3
 
+
 +
 +
 +
+
!m−1
›+
(24a)
=X
m≥3
 
+
 +
 +
 +
+
!m−1
›,
(24b)
where each diagrammatic element corresponds to an al-
gebraic expression in Eqs. (22a) and (22b). The corre-
spondence is:
=˜Γe−iω′
ot;
 =˜Me−iω′
ot;
 =gm;
 =δ;
=e−iω′
otSta (eiω′
ot
);
 =e−iω′
otRot ( eiω′
ot
);
,
=˜Be−iω′
ot,˜B∗eiω′
ot;
 ,
 = ˜µe−iω′
ot,˜µ∗eiω′
ot;
,
=ξe−iωdt, ξ∗eiωdt.
The diagrams, while initially inspired by heuristic prin-
ciples introduced in Section I, are elaborated by rigorous
algebraic construction. Specifically, each diagram is in-
variant by rotation of the page, for example,
=
 =
 =
 =˜Be−iω′
ot.
Note that the black dot •in
 (and other similar
diagrams) is employed to unambiguously define the ar-
row’s traveling direction. Moreover, a diagram consist-
ing of multiple components has to be interpreted as the
product of the algebraic expressions corresponding to its
constituent diagrams. For example, the last diagram in
Eq. (24a) corresponds to:
=e−iω′
otSta
eiω′
otδ(˜Be−iω′
ot)
=δ˜Be−iω′
ot.
Here, the black dot •in
 is not shown since the di-
rection of the arrow can be inferred from the position of
. The diagram above showcases two types of multipli-
cations underlying composite diagrams. The conjunction
between
 and
 represents a standard commutative
multiplication, while the conjunction between
 and9
represents a non-commutative multiplication. In
the second case,
 (δ˜Be−iω′
ot) is taken as the ar-
gument for
 (e−iω′
otSta (eiω′
ot
)) represented by the
placeholder
 . We also remark that e−iω′
otSta (eiω′
ot
)
selectively retains the Fourier component with the phase
e−iω′
otin
 . This motivates introduction of the non-
commutative diagram
 resembling a band-pass filter
that selectively passes through the frequency ω′
o. Con-
versely, the diagram
 (e−iω′
otRot ( eiω′
ot
)) in Eq. (24b)
acts like a band-stop filter retaining all Fourier compo-
nents in
 except for those with phase e−iω′
ot.
Eqs. (24a) and (24b) illustrates a key frequency mixing
process within our diagrammatic method. The multi-
nomial expansion in the right-hand side of Eqs. (24a)
and (24b) can be understood as frequency mixing factors.
Each mixing factor comprises of an m-wave mixer
 of
strength gm, receiving m−1 inputs chosen from the items
inside the parenthesis.7Each element in the parenthesis
is interpreted as some type of excitation —
 (˜Be−iω′
ot)
and
 (˜B∗eiω′
ot) represent the dressed resonant excita-
tions at frequency ω′
oresonant with the oscillator,
(˜ξe−iωdt) and
 (˜ξ∗eiωdt) represent drive excitations at
the drive frequency ωd, and
 (˜µe−iω′
ot) and
(˜µ∗eiω′
ot) represent dressed off-resonant excitations with
various frequency components. The term “off-resonant
excitation” is appropriate because ˜ µis purely rotating,
meaning that ˜ µe−iω′
otlacks any Fourier component reso-
nant with the oscillator. By applying the frequency con-
servation law, the output frequency of each mixer is then
determined and subsequently “filtered” by either
 or
. The outputs at frequency ω′
oor otherwise contribute
to
 (˜Γe−iω′
ot) or
 (˜Me−iω′
ot) on the left-hand side
of the equations, making ˜Γ and ˜Mtime-independent and
purely rotating, respectively, as anticipated. As diagram-
matically suggested,
 will in turn determine the dressed
off-resonant excitation
 (their relation will be dis-
cussed shortly), which will “feedback” to the mixing pro-
cesses on the right-hand side of Eqs. (24a) and (24b).
This “feedback link”, stemming from the self-consistent
nature of Eq. (22), will result in cascaded mixers or mix-
ing networks that constitute
 and
 . We will elabo-
rate more on this in Sections III C and III D.
Similarly to Feynman diagrams, in our diagrammatic
method, a dressed excitation is represented as a bare ex-
citation plus higher order correction. The dressing of
these excitations is formally defined by the diagrammatic
representation of Eqs. (24c) to (24f), which we will now
7The second term in the right-hand side of Eq. (24a) is a 2-wave
mixer of strength δand intakes one input
 .briefly discuss. Specifically, with an additional global
phase e−iω′
ot, Eq. (22c) is diagrammatically represented
as:
=
 +
 +
 , (24c)
where we have introduced several new diagrams:
=˜K;
 =−ie−iω′
otZ
dt eiω′
ot
;
=i{ {
,
} }.
The diagram connected to a
 (−ie−iω′
otR
dt eiω′
ot
)
represents the argument for the placeholder
 . For in-
stance, the first term on the right-hand side of Eq. (24c)
corresponds to
=−ie−iω′
otZ
dt eiω′
ot(˜Me−iω′
ot).
Similarly, the dashed boxes
 in the Husimi box
(i{ {
,
} }) should be understood as placeholders, each
taking the diagrams under
 as the first and sec-
ond arguments of the Husimi bracket, respectively. For
example,
=i{ {˜K,˜µe−iω′
ot} }.
Written in the form of Eq. (24c), the leading order con-
tribution of the dressed off-resonant excitation
 is
, interpreted as the bare off-resonant excitation .
Diagrammatically, both
 and
 are generated
by the mixing networks in
 , appended with either a
or a
 , respectively. Therefore,
 and
are designated as the dressed propagator andbare prop-
agator of an off-resonant excitation. Their physical sig-
nificance and evaluation rules will be further detailed in
Sections III D and III E.
Moreover, Eqs. (22d) to (22f) can also be translated10
into diagrammatic form as follows:
=
 exp 
 !
(24d)
=
 −
 exp 
 !
+
 (24e)
=
 +
 −
 (24f)
In these diagrams, Eq. (24d) corresponds to Eq. (22d)
with an added phase e−iω′
ot, while Eq. (24e) is derived
from Eq. (22e) with a global phase e−iω′
otand a derivative
operator ∂˜A∗applied to both sides. These diagrammatic
equations introduce several new diagrams and new rules:
,
=˜Ae−iω′
ot,˜A∗eiω′
ot;
 =ie−iω′
ot∂˜A∗˜S;
=Z
d˜A∗eiω′
ot
.(25)
Eqs. (24d) and (24e) provides a self-consistent defini-
tion of dressed oscillator excitation
 (˜Be−iω′
ot) with
(ie−iω′
ot∂˜A∗˜S) serving as an intermediate variable.
To leading order, the dressed oscillator excitation corre-
sponds to
 (˜Ae−iω′
ot), which we thus interpret as the
bare resonant excitation . In Section III F, we will detail
the computation of the dressed resonant excitation.
Lastly, Eq. (24f) establishes a self-consistent relation-
ship for the effective Hamiltonian
 , with its leading
order contribution being
 as shown on the right-hand
side. Diagrammatically, the unbold diagram
 is sim-
ilar to the bold diagram
 but replaces the dressed
resonant excitation
 with the bare one
 . Alge-
braically,
 corresponds to
=Z
d˜A∗eiω′
ot(e−iω′
ot˜Γ). (26)
Here, when a bare resonant excitation
 (˜A∗eiω′
ot) is
appended to the output of a mixing network, which is
(e−iω′
ot˜Γ) in the diagram above, the composite diagram
is evaluated as an integration of the mixing network with
respect to ˜A∗eiω′
ot(c.f. the last term in Eq. (25)). Anal-
ogously, we can reinterpret
 as “integrating” over
with respect to the dressed resonant excitation
(˜B∗eiω′
ot), where this modified integration action is for-
mally defined by Eq. (24f). In Section III F, we will dis-
cuss the physical significance and evaluation rules of this
equation in more detail.
Up to now, we have translated the algebraic self-
consistent equations Eq. (22) at the core of our pertur-
bative method into their diagrammatic form Eq. (24).
These diagrammatic equations depict nonlinear mixing
processes involving dressed excitations at various fre-
quencies, while further elaborating how each dressed
quantity relates to its bare counterparts. In the remain-
der of this section, we will exploit the diagrammatic rep-
resentations by doing one perturbative iteration step of
the self-consistent equations Eq. (24). Specifically, in
Sections III C and III D, we will explore the structure
of the mixing networks generated from these processes
through bare diagrams that only involve bare excitations.
In Sections III E and III F, we will detail the dressing of
bare excitations and their implications.
C. Enter the bare diagrams: order 1
In the next two subsections, we will solve Eq. (24) to
the leading orders, which only involve the bare form of
each type of excitation. The resulting diagram is the bare
diagram, which is illustrative to study as it resembles the
structures of the dressed diagram representing the full
solution of Eq. (24). To start, we consider Eqs. (24a)
and (24b) at the first order, which reads
(1)=
 
+
 +
 +
!2
›+
 ,(27a)
(1)=
 
+
 +
 +
!2
›. (27b)
To understand the order of the above equations, recall
that
 =gmis of order m−2 in the perturbative pa-
rameter qzps,
=δis of order 1, and the drive excita-
tions
 (ξe−iωdt)
 (ξeiωdt) are of order 0. The
resonant excitations in Eq. (27) are taken in their bare
forms
 (˜Ae−iω′
ot) and
 (˜A∗eiω′
ot) introduced in
Eq. (24d), which are also of order 0. The off-resonant
excitations
 (˜µe−iω′
ot) and
 (˜µ∗eiω′
ot) are not
included because they are of order 1 (c.f. Eq. (23)).
In Eq. (27), we first note that the last diagram in
Eq. (27a) is evaluated as δ˜Ae−iω′
ot, which is a direct
consequence of the rotating frame at ω′
o, featured in
Eq. (8), being detuned from the frequency of the oscilla-
torωo=ω′
o+δ. This diagram represents a linear pro-
cess that exists even in the absence of any nonlinearity
gm. For the nonlinear part, i.e. the binomial expansions
in the right-hand of Eqs. (27a) and (27b), we diagram-
matically carry it out by picking two elements within the11
parenthesis and appending each as an input to the 3-wave
mixer in an ordered manner. Specifically, the binomial
expansion yields 16 diagrams:
+
 +
 +
 +
 +
 +
 +
+
 +
 +
 +
 +
 +
 +
 +
 ,(28)
where ›in each 3-wave mixer indicates the product
among the underlying inputs; we have also suppressed
both the black dot •associated with each arrow in
Eq. (27) and the mixer label g3. These simplifications
introduce no ambivalence to the diagrams as the direc-
tion of the inputs can now be inferred from the position
of the mixer and the rank of nonlinearity can be inferred
from the number of inputs. As we have previously in-
troduced, the types of the inputs are indicated by the
associated arrows:
 represents the resonant excitation
of the oscillator at frequency ω′
oand
 represents the
drive excitation at frequency ωd; an excitation traveling
into/away from the mixer adds/subtracts the correspond-
ing frequency from the mixer. The output, which will
leave at the top of each mixer, is at the frequency ωout
that can be read off from the diagram directly by im-
posing frequency conservation at the mixer element; for
example, the output frequencies of the first two diagrams
in Eq. (28) are 2 ω′
oand 0, respectively.
Each bare diagram in Eq. (28) is evaluated by multiply-
ing the factor(s) associated with its constituent elements.
Importantly, because ›is a non-commutative product, we
choose to read off the diagram counterclockwise starting
from the output. With these rules, Eq. (28) is evaluated
as
g3e−i2ω′
ot˜A›˜A+g3˜A›˜A∗+g3e−i(ωd+ω′
o)t˜A›ξ
+g3ei(−ω′
o+ωd)t˜A›ξ∗+g3˜A∗›˜A+g3ei2ω′
ot˜A∗›˜A∗
+g3ei(ω′
o−ωd)t˜A∗›ξ+g3ei(ω′
o+ωd)t˜A∗›ξ∗
+g3e−i(ω′
o+ωd)tξ›˜A+g3ei(ω′
o−ωd)tξ›˜A∗
+g3e−i2ωdtξ›ξ+g3ξ›ξ∗+g3ei(−ω′
o+ωd)tξ∗›˜A
+g3ei(ω′
o+ωd)tξ∗›˜A∗+g3ξ∗›ξ+g3ei2ωdtξ∗›ξ∗,(29)
and the phase of each term above is simply e−iωoutt.
The output of each diagram in Eq. (28) will then go
through the “band-pass filter”
 or the “band-stop fil-
ter”
 in Eqs. (27a) and (27b), respectively. These
two filters select the outputs at frequency ωout=ω′
oand
those not, which respectively contribute to
 and
 .Consequently,
(1)is determined according to:
=


+
 +
 ω′
o=ωd/2
+
 ω′
o= 2ωd
otherwise ,(30)
where the last term in each case above is just the last
term in Eq. (27a) and for consistency of style we have
suppressed the δsymbol inside this diagram and replaced
it with ›. Moreover, in the diagrams in Eq. (30) we have
also suppressed
 for simplicity, since it contributes a
trivial factor of 1 with the given driving condition.
With
(1)determined in Eq. (30),
(1)consequently
corresponds to the remaining diagrams in Eq. (28), and
thus Eqs. (24a) and (24b) are solved at order 1. The
effective Hamiltonian
(1)(˜K(1)) can then be con-
structed from
(1)(˜Γ(1)) using Eq. (24f) while only
considering the leading order term, i.e. the first one
(R
d˜A∗eiω′
ot˜Γ) on the right-hand side of the equa-
tion. Specifically, we have
(1)=


+
 +
 ω′
o=ωd/2
+
 ω′
o= 2ωd
otherwise .(31)
As illustrated in Eq. (26), the
 (˜A∗eiω′
ot) appending
to the outcome of a mixer is interpreted as integration
over ˜A∗eiω′
ot. Therefore, Eq. (31) is evaluated as:
˜K(1)=

g3ξ˜A∗2+g3ξ∗˜A2+δ˜A∗˜Aω′
o=ωd/2
g3ξ2˜A∗+g3ξ∗2˜A+δ˜A∗˜Aω′
o= 2ωd
δ˜A∗˜A otherwise ,(32)
where we have explicitly carried out the Husimi prod-
uct›in the relevant terms in Eq. (31) according to its
definition in Eq. (16). We also remark that one can al-
ternatively construct the effective Hamiltonian through
the EOM over ˜A∗(instead of that over ˜Aas in Eq. (18))
and obtain the corresponding diagram
 (˜K∗). Since
the effective Hamiltonian is real, we have
 =
 .
We have so far introduced a set of diagrammatic no-
tations and operations to solve the equation of motion12
Eq. (18) up to leading order. Before discussing the sec-
ond order, we will take a detour and present an alter-
native representation of the diagrams discussed thus far.
This new representation explicitly displays the classical
and quantum components of a diagram by expanding the
mixing vertices
 in the diagram. Therefore, we refer
to this new type of diagrams as the expanded diagrams ,
whereas the ones with
 as the mixing vertices, e.g.
those in Eqs. (28), (30) and (31), are referred to as the
unexpanded diagrams .
To derive the expanded diagrams, we first recall that
the inputs of a mixing vertex
 are associated by Husimi
product ›defined as
˜f›˜g=X
k≥0ℏk
k!˜f(← −∂˜A− →∂˜A∗)k˜g (33)
for some generic phase-space functions ˜fand ˜g. The clas-
sical component of the Husimi product, i.e. the k= 0
term in Eq. (33), is just an ordinary commutative prod-
uct. The quantum components, i.e. those terms with
k >0, involve knumber of ℏ← −∂˜A− →∂˜A∗bidifferential opera-
tors and introduce the non-commutativity.
With these observations, we can similarly expand each
diagram in Eq. (28) into a classical diagram and quantum
diagrams. For example, the first two diagrams in Eq. (28)
can be expanded as
=
|{z}
classical,
 =
|{z}
classical+
|{z}
quantum.
(34)
Here, we construct the classical diagram simply by re-
placing the mixing vertex
 in an unexpanded diagram
with
 to indicate that its inputs are associated with
a regular commutative product. To construct the quan-
tum diagrams, we diagrammatically interpret each factor
ℏ← −∂˜A− →∂˜A∗in Eq. (33) as forming a quantum bond , i.e. the
orange bond in Eq. (34), between two inputs in a classical
diagram. The non-commutativity of ℏ← −∂˜A− →∂˜A∗is reflected
by the directionality of the quantum bond — the arrow
to the left of the bond represents a resonant excitation
traveling into the mixer and is associated with ˜A, while
the arrow to the right represents a resonant excitation
traveling away and is associated with ˜A∗. It is easy to
verify that, at k-th order in ℏ, the combinatorial factor
resulting from Eq. (33) equals to the number of configura-
tions with kquantum bonds formed. In the two examples
in Eq. (34), no quantum bond can be formed in the first
classical diagram, and thus its associated quantum dia-
gram is absent. In the second classical diagram, there is
only one possible configuration for forming such a bond.
Later in the text, we will examine more complicated ex-
amples involving more than two resonant excitations ina diagram. Since the Husimi product is associative, this
diagrammatic interpretation of Eq. (33) is also applicable
in those more involved cases.
The expanded diagrams are evaluated the same way
as the unexpanded ones but with ordinary multiplication
as the underlying product. In addition, each quantum
bond is associated with a factor of ℏand each pair of
connected arrows associated with a factor of 1. For ex-
ample, Eq. (34) is evaluated as
g3e−iω′
ot˜A›˜A=g3e−iω′
ot˜A2,
g3eiω′
ot˜A›˜A∗=g3eiω′
ot˜A∗˜A+ℏg3eiω′
ot.(35)
Note that in the case of a commutative product such
as the terms in the right-hand side of Eq. (35), we have
chosen to write the ˜A∗-factors to the left of the ˜A-factors,
so that the Hilbert space representation can be readily
recovered by replacing ˜Awith ˆA, and ˜A∗withˆA†.
Lastly, we would like to make two remarks about the
expanded diagram. First, the specific order of the in-
puts of each vertex in an expanded diagram is not rel-
evant since their underlying product is a commutative
ordinary product. Therefore, when evaluating all the
unexpanded diagrams in the effective Hamiltonian, one
can simply evaluate the unordered expanded diagram,
which is the class of topologically equivalent ordered ex-
panded diagrams that we have treated thus far, and mul-
tiply the result with an additional factor of the total
number of topologically equivalent diagrams associated
with the unordered diagram. Second, we note that if
one chooses to develop expanded diagrams in a different
phase-space representation of quantum mechanics (such
as the Wigner representation with Groenewold star prod-
uct (⋆) [37, 38] as the underlying product), the classical
diagrams remain unchanged, whereas the quantum dia-
grams and the evaluation rules for their quantum bonds
must be adapted accordingly.13
D. Enter the off-resonant excitations: order 2
We now return to the task of solving Eq. (24) itera-
tively. At order two, Eqs. (24a) and (24b) read
(1)=
 
+
 +
 +
!3
›
+
 
+
 +
 +
 +
+
!2
›(1)
,
(36a)
(1)=
 
+
 +
 +
!3
›
+
 
+
 +
 +
 +
+
!2
›(1)
,
(36b)
where for the resonant and off-resonant excitation only
their bare constituents are relevant at this order.8In
the first multinomial expansion in the right-hand side of
Eqs. (36a) and (36b), a 4-wave mixer
 mediates the
mixing between three inputs selected from
 ,
 ,
, and
 . The multinomial expansion results in
a sum of 43= 64 bare diagrams, each represented in an
unexpanded form. We evaluate these diagrams using the
same approach as discussed in Section III C, and there-
fore, do not repeat the process here.
In the second multinomial expansion, a 3-wave mixer
mediates the mixing between two inputs chosen from
the six terms inside the parentheses. These terms consist
of two bare resonant excitations and two drive excita-
tions, which we have discussed, and the off-resonant exci-
tations
 and
 , which we will elaborate shortly.
Furthermore, the superscript (1) on the parentheses of
the second multinomial expansion selects only first-order
terms resulting from the expansion. Thus, the entire mix-
ing process, which involves another factor g3=O(qzps),
is at second order in qzps.
Let us now consider the off-resonant excitations par-
ticipating in the 3-wave mixing process in Eq. (36). For
the diagram
 , it should be understood as be-
ing constructed from
 (˜M) and a bare propagator
(−ie−iω′
otR
dt eiω′
ot
), which is defined in Eq. (24c)
and the discussion below it. Considering the mixing
8For the dressed resonant excitation, the correction to its bare
counterpart is O(q2
zps) and thus irrelavent at this order. We will
discuss this in more detail in Section III F.processes constituting
 (˜M) each corresponds to an
oscillating function with phase e−iω′
outt(e.g. Eqs. (28)
and (29)), the bare propagator associated with each par-
ticipating process is thus of the form 1 /(ωout−ω′
o). This
definition justifies the notation of the propagator; intu-
itively, the propagator is weaker when the off-resonant
excitation is more detuned from the oscillator. With this
definition, the first two diagrams in Eq. (28), for example,
would yield the off-resonant excitation at order 1 as
=g3e−2iω′
ot
2ω′o−ω′o˜A›˜A,
 =g3
0−ω′o˜A›˜A∗.(37)
We reiterate that a propagator always remains finite by
construction: any diagram with ωout=ω′
ois collected by
(1)and does not propagate into another mixing process
as an input.
Given a diagram constituting
 , there exists a
corresponding one constituting
 whose algebraic
expression is just the complex conjugate of the former.
Diagrammatically, the complex conjugate expression is
formed and evaluated in the same way as the direct ex-
pression with modifications stipulating that: (1) the trav-
elling direction of all arrows are inverted, and (2) the in-
verted inputs of each mixer are reflected about the line
drawn through the output of the mixer. These rules ap-
ply to constructing the complex conjugate of any dia-
gram. For example, the complex conjugate of Eq. (37)
is
=g3e2iω′
ot
2ω′o−ω′o˜A∗›˜A∗,
 =g3
0−ω′o˜A›˜A∗(38)
and they should be understood as the off-resonant exci-
tation traveling in the opposite direction compared with
those in Eq. (37).
At order 1, each off-resonant diagram (at frequency
ωout̸=ω′
o) in Eq. (28) yields an input constituting
and also the corresponding conjugate input constituting
. Once all of them are determined with the above
procedure, one is ready to explicitly draw the mixing
processes resulting from the g3multinomial expansion in
Eq. (36). For example, a mixing process involving the
first diagram in Eq. (38) as an input is evaluated as
=g3(˜Ae−iω′
ot)›1
2ω′o−ω′o×
g3(˜A∗eiω′
ot)›(˜A∗eiω′
ot)
=g2
3eiω′
ot
ω′o˜A›˜A∗›˜A∗.(39)14
The diagram in Eq. (39) should be understood as a graph-
ical representation of cascaded mixers, whose output is
that of the 3-wave mixer at the top. Such a diagram
is evaluated in the same way as those shown in order
one and starting from the output of the diagram; this is
illustrated by the first line in right-hand side of Eq. (39).
Similarly to Eq. (34), a bare diagram involving off-
resonant excitations can also be represented in the ex-
panded form. Specifically, following the same rules dis-
cussed in Section III C, Eq. (39) can be rewritten as
=
 +
 +
 , (40)
and with each diagram evaluated explicitly the above
equation reads
g2
3eiω′
ot
ω′o˜A›˜A∗›˜A∗=g2
3eiω′
ot
ω′o˜A∗2˜A+ℏg2
3eiω′
ot
ω′o˜A∗
+ℏg2
3eiω′
ot
ω′o˜A∗.(41)
Up to now, we have introduced the bare diagrams by
iteratively solving Eq. (24) at the first two orders. At
each iteration, the multinomial expansions in the right-
hand side of Eqs. (24a) and (24b) generate mixing dia-
grams, among which the ones at frequency ω′
oand those
not contribute to
 (˜Γ) and
 (˜M) in the left-hand
side, respectively. With
 (˜Γ) determined, the effective
Hamiltonian
 (˜K) can be computed via Eq. (24f),
which to leading order is
 (R
d˜A∗eiω′
ot˜Γ). Mean-
while, the diagram
 (˜M) at this order will produce off-
resonant excitations following Eq. (24c), which to leading
order are the bare ones
 (e−iω′
otR
dteiω′
ot˜M) and
(eiω′
otR
dte−iω′
ot˜M∗).
As the iteration proceeds, the off-resonant excitations
at lower order feeds back to the mixing processes at
higher order, and the generated diagrams are of the same
type as those in Eqs. (27) and (39) but involving more
and more cascaded mixers. In the notation of graph
theory, these bare diagrams in the unexpanded form9
share a simple graphical structure of rooted trees (see
Appendix A for the exact definition). The root vertex
in the tree is the output of the entire diagram, the inter-
nal vertices are the mixers, the external edges are drive
9When an diagram is expressed in its expanded form, e.g. as in
the right-hand side of Eq. (40), the underlying graph of a clas-
sical diagram is a rooted tree while that of a quantum diagram
contains one or more loops.excitations or bare resonant excitations, and the internal
edges are the propagators of off-resonant excitations.
It is important to recognize that the dressed diagrams,
corresponding to the full solution of Eq. (24), share the
same structure as the bare diagrams but with all bare
quantities replaced but their dressed counterparts. These
dressed quantities are determined by Eqs. (24c) to (24f).
In the rest of the section, we will elaborate on the eval-
uation rule and the physical significance of these dressed
quantities.
E. Dressed off-resonant excitation
In this subsection, we discuss the dressed off-resonant
excitation, represented as
 , along with its corre-
sponding dressed propagator, depicted by
 . These
concepts are formally defined through the self-consistent
equation presented in Eq. (24c):
=
 +
 +
 ,
which to the leading order is just the bare off-resonant
excitation
 elaborated in Section III D. To shed
lights on the physical meaning of the dressed off-resonant
excitation, we first rewrite the self-consistent equation
Eq. (24c) into two alternative forms. The first one is an
infinite series:
=
 +
 +
 +
 +
+
 +
 +···,
(42)
achieved by expanding Eq. (24c) in a self-consistent man-
ner, i.e. successively substituting each
 component
appearing in the right-hand of Eq. (24c) with all the tree
diagrams in the right-hand. Further, by identifying that
Eq. (42) is a series of the same form as the Taylor series15
of 1/(1−x), we can succinctly express Eq. (42) as
=1
−
 −
. (43)
Eqs. (42) and (43) each defines the dressed off-resonant
excitation in a form that is useful for evaluating and inter-
preting this physical quantity, respectively. We first focus
on Eq. (43) to discuss the physical meaning of dressing
an off-resonant excitation and will discuss its evaluation
later. In particular, from Section III C, we note that
corresponds to an oscillating function containing various
Fourier components
=˜M(˜A,˜A∗, t) =X
k˜Mk(˜A,˜A∗, t),
˜Mk(˜A,˜A∗, t) =˜fk(˜A,˜A∗)e−iωout,kt(44)
where ˜fk(˜A,˜A∗) is a polynomial function of the phase-
space coordinates with no explicit time dependence and
ωout,k̸=ω′
ois the frequency of the off-resonant excitation
output from the corresponding diagram (c.f. Eq. (37)).
Besides the fast-oscillating phase e−iωout,ktin Eq. (44),
it is also important to recognize that ˜f(˜A,˜A∗) contains
an implicit time dependence from the slow dynamics of
˜Aand ˜A∗generated by the effective Hamiltonian ˜K. In
particular, the equation of motion for
 (˜M) in dia-
grammatic and algebraic forms, respectively, reads
dt
 =∂t
− { {
 ,
} } (45a)
X
kdt˜Mk=X
k
∂t˜Mk− { {˜K,˜Mk} }
=X
k
−iωout,k˜Mk− { {˜K,˜Mk} }
.(45b)
From the above, it is clear that, heuristically,10ωout,k=
i∂t˜Mk/˜Mkcorresponds to the bare frequency of the off-
resonant excitation stemming from its explicit time de-
pendence. It is therefore natural to define a “dressed
frequency” imitating the same form of the bare one as
˜ωout,k=idt˜Mk/˜Mk, which corresponds to the “true”
frequency of the off-resonant excitation output by the
constituent diagram in
 . The frequency dressing is
δωout,k= ˜ωout,k−ωout,k=−i{ {˜K,˜Mk} }/˜Mk, whose di-
agrammatic representation, remarkably, is just the last
term in the denominator of Eq. (43). We remind the
10This is a heuristically expression because dividing operation is
not formally defined in the phase space.reader that the first term (
 )−1in the denominator is
evaluated as ωout−ω′
o, the detuning between the bare
off-resonant and resonant excitations, while the latter is
itself detuned from the oscillator’s natural oscillation fre-
quency by δ=ωo−ω′
o. Therefore the full denominator
in Eq. (43) simply corresponds to ˜ ωout−ωo, the detun-
ing between the dressed off-resonant excitation and the
natural frequency of the oscillator, and the inversion of
this dressed detuning defines the dressed propagator.11
We have so far introduced the definition of dressed
propagator in three different forms — as a self-consistent
relation in Eq. (24c), as an infinite series in Eq. (42),
and as a simple fraction in Eq. (43). Akin to Feyn-
man diagrams, evaluating a dressed diagram involves
expanding each dressed propagator in the diagram as
the series in Eq. (42) and further evaluating each re-
sulting diagram individually. We evaluate the first di-
agram
 in the series following the procedure dis-
cussed in Section III D when the diagram constituting
is specified. We then evaluate the second diagram
and the fourth diagram by multiplying the expression
corresponding to the first diagram with one or two ex-
tra factors of δ/(ωout−ω′
o), each contributed by a dia-
grammatic component
 . For the rest of diagrams
explicitly displayed in Eq. (42), each of them contains
the component
 =i{ {
,
} }. Evaluating this type
of diagram involves non-associative diagrammatic opera-
tions, stemming from the Husimi bracket, which we now
discuss.
We take the third term in the series in Eq. (42) as
an example. This term is evaluated as another series of
diagrams obtained by specifying the particular diagram
constituting
 and writing out each diagram constitut-
ing
 . A term in such a series, for example, reads
, (46)
where for the diagram constituting
 we have chosen
the classical diagram in Eq. (39) and for
 we have
11We also note that one can further simplify Eq. (43) by redefin-
ing the bare off-resonant excitation as
 := 1/(ωout−ωo)
and then removing
 . Consequently Eqs. (24c) and (42) are
also simplified since any term involving
 in the equations is
removed. In the rest of this section, we continue to follow the
definition in Eq. (43) as it is.16
chosen a term resulting from the first multinomial ex-
pansion in Eq. (36). With Eq. (46) written as it is, the
algebraic expression associated with the left and right
subdiagrams under
 =i{ {
,
} }should be under-
stood as the first and second arguments of the Husimi
bracket. Therefore, Eq. (46) is evaluated as
i
−2ω′o{ {g4
2˜A∗2˜A2,g2
3eiω′
ot
−2ω′2o˜A∗2˜A} }
=g2
3g4
4ω′3o(˜A∗3˜A2+ℏ˜A∗2˜A)eiω′
ot.(47)
We note that the non-associativity of the Husimi bracket
manifests in the rule that each of the two subdiagrams
below a
 must be treated as a whole. If a subdi-
agram itself contains another
 the
 within
the subdiagram should be evaluated first, and then the
entire subdiagram is treated as an argument of the up-
per
 . For example, the last term of Eq. (42) is
evaluated as
=Z
dt{ {˜K,Z
dt{ {˜K,Z
dt˜Me−iω′
ot} }} }.
The evaluation rules associated with
 =
i{ {
,
} }elaborated above enable us to systematically
evaluate any diagram containing dressed propagators. In
the remainder of this subsection, we introduce the ex-
panded representation of the diagrams involving
 .
Similar to Eq. (34), this representation explicitly exhibits
the classical and quantum components of a dressed prop-
agator by expanding
 within it. Furthermore, this
representation replaces the complex algebraic operations
underlying the Husimi bracket with simple diagrammatic
components.
We use the diagram in Eq. (42) as an example to elab-
orate on this expanded representation. By noting that
i{ {˜f,˜g} }=1
ℏ˜f›˜g−1
ℏ˜g›˜f, (48)
we first rewrite the diagram in Eq. (42) in a way resem-
bling Eq. (48) as
=
 −
 .
(49)Each diagram in the right-hand side of Eq. (49) consists
of two subdiagrams, which are essentially the same as
those appearing under
 on the left-hand side, but
with the order of the subdiagrams permuted. It is im-
portant to note that the left subdiagram under
contributes to
 (˜K). In the first diagram in the right-
hand side of Eq. (49), this contribution is written as its
conjugate, which contributes to
 (˜K∗). This substi-
tution is made for the convenience of later diagrammatic
operations and is valid since ˜K=˜K∗.
For each of the diagrams in the right-hand side of
Eq. (49), its two subdiagrams are related by a dashed line
decorated by
 /ℏresembling the ›and the 1 /ℏfactor
Eq. (48). From the definition of star product in Eq. (17),
we know that
 /ℏis algebraically associated with the
operation
/ℏ=X
s≥0ℏs
(s+ 1)s!(← −∂˜A− →∂˜A∗)s+1, (50)
where sindexes the order of ℏin the expansion.12Similar
to Eqs. (33) and (34), each factor of← −∂˜A− →∂˜A∗in Eq. (50)
can be translated to a diagrammatic operation of form-
ing a bond between the two subdiagrams related by
 /ℏ
— the← −∂˜Afactor translates to consuming an arrow as-
sociated with ˜Ain the left subdiagram, the− →∂˜A∗factor
translates to consuming another arrow associated with
˜A∗in the right, and a directional bond if formed between
the two consumed arrows. For the term ℏs(← −∂˜A− →∂˜A∗)s+1,
we then interpret it as forming one classical bond and s
number of quantum bonds. With this, Eq. (49) can be
expanded as the following diagrams, by writing out all
12The series does not contain ℏ−1order term because, at this order,
the two terms in the right-hand side of Eq. (49) cancel out. In
other words, algebraically, the Husimi bracket { {˜f,˜g} }= (˜f˜g−
˜g˜f)(iℏ)−1+{˜f,˜g}ℏ0+O(ℏ) is zero at order ℏ−1while its classical
contribution is a Poisson bracket.17
unique configurations of forming such bonds
+
+
 +
 −
 .
(51)
The first two diagrams above are expanded from the first
one in the right-hand side of Eq. (49). They correspond
to the two configurations of forming one classical bond
and zero quantum bond ( s= 0) between the left and
right subdiagrams. Comparing with the one in Eq. (49),
in these two diagrams we have rotated the output of the
left subdiagram for visual simplicity without changing
its relative ordering with respect to the inputs. More-
over, by choice, the output of this subdiagram connects
to the classical bond. On top of the first two, the third
and fourth diagrams in Eq. (51) correspond to the con-
figurations with one extra quantum bond (orange). Note
that each bond stemming from← −∂˜A− →∂˜A∗is directional, i.e.
the associated arrow always points from the right subdia-
gram to the left one, therefore in these specific diagrams
no more one quantum bond can be formed. Similarly,
the last diagram in Eq. (51) corresponds to the only way
of forming a bond in the last diagram in Eq. (49), i.e.
between the output of the right subdiagram constituting
(˜K) to an input in the left subdiagram.
A diagram like those in Eq. (51) can be evaluated with
the same rules associated with the bare diagrams but
with two additional ones: (1) the two resonant excita-
tions connected by the classical bond between the two
subdiagrams contributes only a factor of 1 (instead of
˜A∗˜A), and (2) the dashed line contributes another factor
1/(s+ 1) where sis the number of orange bonds drawn
between the subdiagrams. As a result, the five diagrams
in Eq. (51) are respectively evaluated as
1
−2ω′og4˜A∗2˜Ag2
3eiω′
ot
−2ω′2o˜A∗˜A+1
−2ω′og4˜A∗2˜Ag2
3eiω′
ot
−2ω′2o˜A∗˜A
+ℏ
−2ω′og4˜A∗2g2
3eiω′
ot
−2ω′2o˜A+ℏ
−2ω′og4˜A∗2g2
3eiω′
ot
−2ω′2o˜A
−1
−2ω′o×g2
3eiω′
ot
−2ω′2o˜A∗2g4˜A∗˜A2
=g2
3g4
4ω′3o(˜A∗3˜A2+ℏ˜A∗2˜A)eiω′
ot,which equals to Eq. (47) obtained from evaluating
Eq. (46) directly.
F. Dressed resonant excitation
We have now discussed the first three equations in
Eqs. (24a) to (24f), which are the core equations under-
lying our diagrammatic method. In the last part of this
section, we will discuss the remaining three Eqs. (24d)
to (24f) that are related to the dressed resonant ex-
citation
 . Specifically, we will first comment on
Eqs. (24d) and (24e) that formally define the dressed res-
onant excitation. Then we will discuss Eq. (24f), which
relate the effective Hamiltonian
 (˜K) to
 (˜Γ) and
(˜Be−iω′
ot).
Eqs. (24d) and (24e) define the dressed resonant exci-
tation in a self-consistent manner as
=
 exp 
 !
(52a)
=
 +
 +
 +···
(52b)
=
 −
 exp 
 !
+
 (53a)
=
 −
 −
 − ··· .
(53b)
Here, Eqs. (52a) and (53a) simply restate Eqs. (24d)
and (24e), while in Eqs. (52b) and (53b), we expand the
exponentiation operation from the initial equations and
obtain two infinite series of similar structure. We note
that in Eq. (52b) the term
=e−iω′
otSta(eiω′
oti{ {e−iω′
ot˜A, i˜S} })
is not explicitly displayed. This is because ˜Sis con-
structed to be purely oscillating (c.f. Eq. (22e)) and thus
the above term is zero.18
In Eq. (52),
 is defined in terms of the intermediate
quantity
 , which is further defined by a self-consistent
relation Eq. (53). These two coupled equations should
be carried out by iteratively substituting
 in Eqs. (52)
and (53) with Eq. (53). This yields
=
 +
 +
−
 −
 +···.
(54)
Remarkably, Eq. (54) defines the dressed oscillator
in terms the dressed off-resonant excitation
 , which
is a known quantity from Sections III C to III E. By sub-
stituting the specific diagrams constituting
 , one
can then construct
 to any desired order. It is impor-
tant to note that the leading order contribution of
is at order q1
zps(see Eq. (23)). Therefore, for a dressed
resonant excitation defined by Eq. (54), the correction to
the bare resonant excitation is O(q2
zps).
When evaluating a diagram in Eq. (54), one follows
the same rules introduced earlier in this section but with
an additional one: for each bare resonant excitation
that goes through knumber of
 before being termi-
nated by a
 or
 , an extra factor of 1 /k! is associated
with it. This factor stems from expanding the exponen-
tial functions in Eqs. (52) and (53). For instance, the
five diagrams in the right-hand side of Eq. (54) are asso-
ciated with the overcounting factors of 1 /0!, 1/2!, 1/3!,
1/(2!×2!), and 1 /(2!×2!), respectively.
Lastly, we discuss Eq. (24f),
=
 +
 −
 ,
that relates the effective Hamiltonian
 (˜K) to
 (˜Γ)
and
 (˜Be−iω′
ot). To see their relationship more ex-plicitly, we can manipulate Eq. (24f) (or directly translate
Eq. (20c) to diagrammatic representation) and get
=−
 , (55a)
which corresponds to
˜Γ =−i{ {˜K,˜Be−iω′
ot} }. (55b)
Physically, this equation indicates that
 (˜Γ) is a quan-
tity describing the slow dynamics of motion for
(˜Be−iω′
ot). In other words, the equation of motion for
is just
dt
=∂t
−i
. (56)
Mathematically, constructing
 (˜K) from
 (˜Γ) and
(˜Be−iω′
ot) involves inverting the Husimi bracket in
Eq. (55), the operation of which is formally defined as
Eq. (24f) (and algebraically as Eq. (22f)).
To explicitly compute
 (˜K), we take Eq. (24f)
as a self-consistent relation and substituting each
component in the right-hand side of the equation with
the equation itself. Carrying this out iteratively yields
an infinite series
=
 +
 −
+
 −
 +···.(57)
One can then compute
 to the desired order by eval-
uating the relevant diagrams above provided that
 and
are specified.13
We have now discussed all the equations necessary
for implementing our diagrammatic method, specifically
Eqs. (24a) to (24f). To conclude this section, we concisely
13In order for the series Eq. (57) to converge, a diagram involving
should be evaluated together with those diagrams that
look alike but with
 replaced by
 .19
recapitulate this new method. The general goal of our
method is to describe the effective dynamics of a driven
nonlinear oscillator governed by Hamiltonian Eq. (7). To
achieve this, we seek for a frame transformation ˜ a→˜A,
discussed in Eq. (12), so that in the transformed frame
the dynamics of the bosonic coordinate ˜Ais governed by
a time-independent Hamiltonian ˜K, which we call the ef-
fective Hamiltonian. Finding this frame then boils down
to solving the equation of motion Eq. (18), which we fur-
ther breaks down into 6 coupled self-consistent equations
Eqs. (22a) to (22f) by introducing the change of variables
in Eq. (20). Due to the structural similarity between
Eq. (22) and the equations underlying the classical har-
monic balance method, we refer to this algebraic proce-
dure as the quantum harmonic balance (QHB) method.
Our diagrammatic method is developed through solv-
ing Eqs. (22a) to (22f) in their corresponding diagram-
matic form Eqs. (24a) to (24f). Specifically, solving
Eqs. (24a) and (24b) elucidates the cascaded mixing
networks underlying the effective Hamiltonian and the
frame transformation. These mixing networks, which are
termed as dressed diagrams, represent mixing processes
involving the dressed oscillator excitation
 ,
 , the
dressed oscillator excitation
 ,
 , and the drive
excitation
 ,
 . Like Feynman diagrams, a dressed
diagram to leading order is a bare diagram involving only
bare excitations. In Sections III C and III D, we solve
Eqs. (24a) and (24b) to leading order to introduce the
bare diagram and its structure, i.e. the cascaded mixing
networks, shared by the its dressed counterpart. In Sec-
tion III E, we then introduce the specific construction of
the dressed off-resonant excitation by solving Eq. (24c).
In Section III F, we introduce the specific construction
of the dressed resonant excitation by solving Eqs. (24d)
to (24f) This formalizes a diagrammatic tools for the com-
putation of nonlinear quantum effects in an oscillator, up
to now used only heuristically in the literature.
IV. AXIOMATIC PRESENTATION OF THE
DIAGRAMMATIC PERTURBATION METHOD
A. Motivation
In Section III, we have introduced the QHB expansion
to diagrammatically construct the effective Hamiltonian
(˜K) governing the dynamics of a driven nonlinear
oscillator. This method provided us with a systematic
way to find the effective Hamiltonian as a sum of dia-
grams involving different kinds of excitations, where the
diagrams themselves are of simple graphical structure as
rooted trees. However, the QHB expansion involves an
iterative process that is cumbersome to be carried out to
high orders. In this section, we introduce an axiomatic
approach to the diagrammatic method that yields the
same effective Hamiltonian as the QHB expansion. As in
the case of Feynman diagrams, this axiomatic approachbypasses the iterative procedure and allows the effective
Hamiltonian
 (˜K) to be written down directly at any
given order by following diagrammatic rules. We present
each step of the axiomatic procedure as a well-defined
task in graph theory. Each step in this procedure can
thus be efficiently implemented by a computer program.
B. Recipe for evaluating diagrams
To construct and evaluate of the diagrams for all ˜K(n),
we proceed with the following procedure:
1. Write down the forest comprising all possible un-
rooted trees with k+ 2 leaf vertices for 0 < k≤n.
In graph theory, an unrooted tree is a tree that
has no vertex designated as a root and a forest is a
disjoint union of trees.
2. Write down all unique diagrams14a tree represents
by,
(a) to each internal vertex, assigning a
 repre-
senting a mixer,
(b) to each external edge (connecting a leaf and an
internal vertex), assigning
 or a
 travel-
ing in either direction that are associated with
the dressed resonant excitation and the drive
excitation, respectively.
(c) and, to each internal edge (connecting internal
vertices), assigning a
 arrow traveling in
either direction that represents a dressed off-
resonant excitation.
3. Eliminate any diagram with nonzero net frequency.
4. Compute the frequency of the off-resonant excita-
tions by imposing frequency (energy) conservation
at each mixer. Eliminate diagrams containing off-
resonant excitation at frequency ω′
o.
The resulting diagrams is a forest of unrooted trees, each
an underlying graph shared by a family of rooted trees
constituting
 (˜K). This forest is already an unam-
biguous, succinct15, and intuitive representation of the
effective Hamiltonian. Indeed, the diagrammatic heuris-
tics discussed in Section I are developed at this level but
14Two diagrams are said to be equivalent if one can be recovered
from the other by an overall rotation.
15A more succinct representation is possible by using an underlying
unordered diagram to represent the ordered ones sharing it — i.e.
for diagrams can be converted to each other through successive
permutation of inputs into the mixers, one represents them by
one single diagram. We use this representation in the actual code
implementation [19].20
without internal edges elaborated as off-resonant excita-
tions or the resonant excitation being dressed. Evaluat-
ing the diagrams generated from the above steps follows
the following procedure:
5. For each diagram produced after Step 4, write down
all possible unique diagrams it can generate by con-
verting a
 traveling away from a mixer to a
 ;
eliminate any diagram if such a replacement is not
possible. The resulting diagrams are the dressed
diagrams constituting
 (˜K).
6. Find the set of off-resonant excitations partic-
ipating in the diagrams above. The resulting
diagrams are the dressed diagrams constituting
(˜µe−iω′
ot).
7. Consider only the bare off-resonant excitations and
bare resonant excitation in each diagram constitut-
ing
 . Evaluate the resulting bare diagram fol-
lowing the prescription in Sections III C and III D
and example of Eqs. (39) and (40).
8. Construct the dressed diagrams in
 and
stemming from the diagrams already constructed.
Specifically, the dressed off-resonant excitation, ex-
panded by Eq. (42), depends on
 while the
dressed resonant excitation, expanded by Eq. (54),
depends on
 . When computing these dressed
excitations in a dressed diagram, the diagrams con-
stituting
 and
 should be considered as
those already constructed from the previous steps.
Evaluate the resulting dressed diagrams following
the prescription in Sections III E and III F.
9. Repeat Step 8 until all unique diagrams of the de-
sired order are constructed and evaluated.
We remark that Steps 7-9 contains iterative elabora-
tions of the dressed off-resonant excitation and resonant
excitation with the set of constructed diagrams constitut-
ing
 and
 , while each round of elaboration up-
dates the constructed set itself. It is also possible to avoid
the iterative procedure completely by further exploiting
the graphical structure behind dressed diagrams. We dis-
cuss this and other tricks facilitating code implementa-
tion in [19], an open-source program to compute the ef-
fective Hamiltonian based on the diagrammatic method
developed in this work.
We also note that if one is only interested in specific
driven processes, e.g. the terms involving ξ2˜A†3respon-
sible for the three-legged cat discussed in Section I, in the
Steps 2 and 3 above one can directly draw the relevant
diagrams, e.g. those involving three
 and two
 as
external edges, instead all diagrams of zero net frequency.
This provides significant computational advantage of the
diagrammatic method over other high-frequency expan-
sions. We illustrate this in more detail in the examplestreated in the rest of the work, where we obtain analyt-
ical descriptions for high-order processes that were not
possible before.
V. REMARKS AND EXTENSIONS
A. General form of the effective Hamiltonian
The axiomatic procedure explained in Section IV pro-
vides a simple way to construct the diagrams that con-
stitute ˜Kas shown in
 . Furthermore, this procedure
also reveals the general structure of these Hamiltonian
diagrams, which we elaborate on in this subsection. We
would like to remind the reader that the driven oscillator
of interest usually has a drive with frequency ωdin the
vicinity of qωo/p, where ωois the natural frequency of the
oscillator and qandpare positive integers. When the fre-
quency configuration is such, the effective Hamiltonian is
constructed in the rotating frame at ω′
o=pωd/q, which
is in the vicinity of ωo. In this frame, the resonant ex-
citation
 is associated with ˜Ae−iω′
ot, and the drive
excitation
 is associated with ξe−iωdt. Since a dia-
gram that constitutes the effective Hamiltonian has zero
net frequency, it can be expressed as
. . .
...
. . ....}
}
} }
(58)
where n, k, l are natural numbers and q′, p′are coprime
such that p′/q′is the simplest form of p/q. Note that
in later text, different pairs of q, passociated with the
same lowest terms p′/q′can represent different nonlinear
processes. In Eq. (58), the gray box should be under-
stood as some diagram whose content can be found by
following the procedure in Section IV. Collecting all rel-
evant diagrams, we obtain the effective Hamiltonian of
the form
˜K=X
n>0Kn˜A†n˜An+X
l>0Ωlq′,lp′ξlp′ˆA†lq′+ h.c.,(59)
where the first summation groups the diagrams with l=
0, while each summand itself is computed by summing
the relevant diagrams over the index kin Eq. (58), and
the second summation groups the terms with l >0, while
each summand is computed by summing over the indices
nandk.
In Eq. (59), we refer to Kn˜A†n˜Anas the energy renor-
malization terms because they renormalize the energy
spacing between Fock states, which are the eigenstates
of these terms, from the bare detuning δ(orωowhen the21
rotating frame transformation at ω′
ois undone). Terms
associated with the ac-Stark shift, Lamb shift, and Kerr
nonlinearity belong to this category and we discuss them
in more detail in Sections VI A and VI B. Correspond-
ingly, we refer to Ω lq′,lp′ξlp′˜A†lq′+ h.c.as the coupling
terms, since they induce a coupling between Fock states
whose indices differ by lq′. These terms are responsible
for the nontrivial nonlinear processes such as the Kerr-cat
and three-legged Schr¨ odinger cat states previewed in Sec-
tion I and we discuss other processes derived from them
in Sections VI C and VI E. We also note that Ω lq′,lp′, to
leading order, is a complex number whose value is deter-
mined by diagrams like that in Eq. (58) with k=n= 0.
At higher order, it is corrected by terms ∝ |ξ|2k˜A†n˜An
and as written they can be understood as the renormal-
ization of the coupling amplitude Ω lq′,lp′.
B. Extension to multi-mode and multi-tone
systems
The diagrammatic procedure prescribed above can be
extended to multi-mode and multi-tone problems, keep-
ing the same conceptual and computational foundations.
Specifically, we may be interested in modeling a system
in which one nonlinear mode, like the one described by ˆH
in Eq. (6), is linearly coupled with multiple linear modes
and driven by multiple sinusoidal drives. Following the
procedure in Appendix H, we obtain the Hamiltonian in
the displaced/rotated frames in the normal modes:
ˆH=X
kδkˆakˆa†
k+X
m≥3gm
mX
k(λkˆa†
keiω′
kt+λkˆake−iω′
kt)
+X
l(ξ∗
leiωd,lt+ξle−iωd,lt)m
,
(60)
where ˆ akand ˆa†
kare the conjugate bosonic operators for
the normal mode ksatisfying [ˆ a,ˆa†] =ℏ,δk=ωk−ω′
k
is the detuning between the natural frequency and the
rotating frame frequency of mode kandλkis a dimen-
sionless factor that measures the hybridization strength
between the mode kand the nonlinear mode. For read-
ers familiar with the energy participation ratio (EPR)
method [39] of analyzing Josephson circuits, it is related
toPk, the energy participation ratio of mode kin the
nonlinear element, by λ2
k=Pkωk/ωoandP
kPk= 1.
The factor ξlare the effective drive amplitude of a drive
tone at frequency ωd,l. This Hamiltonian resembles the
single mode one Eq. (8) and is the general form of the
ones describing many cQED experiments [40, 41].
Carrying out the averaging procedure over the Hamil-
tonian similar to the single mode one, we find that the
only modifications to the diagrammatic procedure stated
in Section IV are:
•In Step 2(b), the straight arrows and wavy arrows
have different colors, representing different oscilla-tor modes (indexed by k) and drive tones (indexed
byl) at their corresponding frequencies.
•Every straight arrow, including the one linked with
another straight arrow, is associated with an addi-
tional factor λk.
•Every double-line arrow
 , representing a bare
off-resonant excitation at frequency ωout, is associ-
ated with a propagatorP
kλ2
k
ωout−ω′
k(1−δωout,ω′
k).
It can be intuited as the off-resonant excita-
tion propagates in the medium of each oscillator
mode with a weight factor λk. For a propaga-
tor successively dressed by nKamiltonian terms,
the associated compounded propagation factor isP
kλ2
k
(ωout−ω′
k)n+1(1−δωout,ω′
k) (c.f. Eq. (51) for
n= 1 in the single mode case).
•The Husimi Q product is defined over the
multiple dimensional phase space as ˜f›˜g=
˜fP
kℏ← −∂˜Ak− →∂˜A∗
k
˜g.
We illustrate this procedure further in Section VI B with
a concrete example involving a system with two modes.
C. Extension to open quantum systems
It is important to reiterate that in the perturbation
method we have presented in this work, we have con-
structed a frame in which the slow dynamics of interest
is described by a time-independent effective Hamiltonian
ˆK. Besides the Hamiltonian, the passage to this frame
also transforms other physical objects, for example, the
coupling between the driven nonlinear oscillator and a
thermal bath. It turns out that this transformation leads
to nontrivial dissipative dynamics such as the heating of
the oscillator at zero temperature. In this section, we
briefly discuss a diagrammatic way to describe the ef-
fective dissipative dynamics of the driven nonlinear os-
cillator, which can be done by computing some effective
Lindbladian governing the oscillator. This calculation is
a natural extension of that of the effective Hamiltonian
we have so far discussed.
We now consider an extended Hamiltonian describing
not only the driven nonlinear oscillator but also its cou-
pling to a thermal bath
ˆHtot=ˆHs(t) +ˆHsb+ˆHb, (61)
where ˆHs(t) is the oscillator Hamiltonian defined in
Eq. (7), ˆHb=R∞
0dωˆb†
ωˆbωis the thermal bath Hamilto-
nian containing a continuum of modes each at frequency
ωwith bosonic operator ˆbω, and ˆHsb=−(ˆa−ˆa†)×R∞
0dωhω
ˆbω−ˆb†
ω
defines the coupling between the os-
cillator mode ˆ aand each bath mode ˆbωwith strength hω.
We note that here we impose the commutator [ ˆbω,ˆb†
ω] =ℏ
to be consistent with that of the ˆ amode (cf. Eq. (7)).22
In the diagrammatic method, which is carried out in
the Husimi Q space, the effective Hamiltonian of the
oscillator ˜Ksis constructed in a frame defined by ˜A
whose relationship to the lab frame amounts to ˜ a→
ξe−iωdt+e−iω′
ot(˜B+˜µ). In this frame, Eq. (61) transforms
to
˜Ktot=˜Ks+˜Ksb(t) (62a)
˜Ksb(t) =−˜C(t)×Z∞
0dωhω
˜bωe−iωt−˜b∗
ωeiωt
(62b)
˜C(t) =˜Be−iω′
ot−˜B∗eiω′
ot+ ˜µe−iω′
ot−˜µ∗eiω′
ot
+ξe−iωdt+ξ∗eiωdt,(62c)
where we have also gone to the rotating frame of each ˆbω
mode ˜bω→˜bωe−iωt. With ˜Ktotdefined as Eq. (62), one
can obtain the effective Lindbladian under the standard
Born-Markov approximation16as
∂t˜Qs={ {˜Ks,˜Qs} }+ 2πX
j
Dq
Sff[−ωj]˜Cωj
˜Qs
+Dq
Sff[ωj]˜C†
ωj
˜Qs
,
D[˜O]˜f:=˜O›˜f›˜O∗−(˜O∗›˜O›˜f+˜f›˜O∗›˜O)/2
Sff[−ωj] := (1 + ¯ nωj)hωj, S ff[ωj] := ¯nωjhωj
(63)
where ˜Qsis the Husimi Q quasiprobability distribution
of the system, ¯ nωjis the thermal photon number at
frequency ωjin the bath, and ˜Cωjis the Fourier com-
ponent of ˜C(t) defined by Eq. (62c) such that ˜C(t) =P
j˜Cωje−iωjt+˜C∗
ωjeiωjtwith ωj≥0. The effect of the
bath under the Markov approximation is equivalent to a
stochastic force coupled to the system by if(t)(˜a−˜a∗)
with amplitude spectral density Sff[±ωj].
We note that, remarkably, ˜C(t) defined by Eq. (62c) is
just the sum of the resonant, off-resonant, and drive exci-
tations participating in diagrams generated by Eq. (18).
Therefore, the transformed collapse operators in Eq. (63)p
Sff[−ωj]˜Cωjandp
Sff[ωj]˜C∗
ωjcan be readily ex-
pressed as and computed through diagrams. For exam-
ple, the order q0
zpscontribution of the collapse operators,
which are merely the untransformed onesp
Sff[−ω′o]˜A
16The standard treatment also involves going to the interac-
tion picture and performing Born-Markov approximation on
eL˜Kst˜Ksb(t). Yet this treatment can be avoided under the as-
sumption that the thermal bath is white within the neighbour-
hood around some frequency ωjwith the width covering the
relevant portion of the spectrum of ˜Ks. See supplement of [42]
for more discussion.andp
Sff[ω′o]˜A∗, can be expressed as
,
 , (64)
where
=eiωjtq
Sff[−ωj],
 =e−iωjtq
Sff[ωj]
The two diagrams in Eq. (64) are understood as the res-
onant conversion of a bare resonant excitation
 (or
) at frequency ω′
ointo a bath excitation
 (or
 )
at frequency ωjwith strengthp
Sff[−ωj]∝p¯nωj+ 1
and the reverse process with strengthp
Sff[ωj]∝p¯nωj.
This association makes physical sense since the creation
of a bath excitation, as in the first diagram of Eq. (64), is
viable even for a thermal bath at zero temperature, i.e.
¯nωj= 0. Correspondingly, the absorption of a bath exci-
tation, as in the second diagram of Eq. (64), occurs only
at finite temperaturep
Sff[ωj]∝p¯nωj. The resonance
condition of the conversion process determines the bath
excitation frequency, which, in this case, is ωj=ω′
o.
Beyond the leading order, other terms in the trans-
formed collapse operator can be similarly computed
through diagrams like Eq. (64). Specifically, those corre-
sponding top
Sff[−ωj]˜Cωjcomprise of all possible two-
wave mixing processes of net frequency zero involving
one bath excitation of frequency ωj>0 traveling away
from one dressed off-resonant excitation or dressed reso-
nant excitation17of frequency ±ωjtraveling into or away
from
 . For example, in the general case of ωd> ω′
o
andωd̸= 2ω′
o, the transformed collapse operator at or-
derq1
zpsinvolves the off-resonant excitations generated
17The two-wave mixer with one input as the drive excitation also
constitutes a valid diagram. Yet its resulting collapse operatorp
Sff[ωd]ξdoes not alter the evolution of the oscillator state and
we thus omit these diagrams here.23
by the 3-wave mixers in Eq. (28) and reads
| {z }
ωj=ω′o+ωd
|{z}
ωj=2ω′o
| {z }
ωj=ωd−ω′o
| {z }
ωj=0(65)
Following the same evaluation rules introduced in Sec-
tion III, the diagrams in Eq. (65) are evaluated asP
ωjp
Sff[−ωj]˜Cωjwith
˜Cω′o+ωd=2g3
ωdξ˜A −2g3
ωd+ 2ω′oξ˜A,˜C2ω′o=4g3
3ω′o˜A2,
˜Cωd−ω′o=2g3
ωd−2ω′oξ˜A∗−2g3
ωdξ˜A∗,˜C0= 0. (66)
Accordingly, the diagrams associated withp
Sff[ωj]˜C∗
ωj
at these order are just the conjugate diagrams (c.f.
Eqs. (37), (38) and (64)) of the diagrams in Eq. (65).
As suggested by the diagrams, the transformed col-
lapse operators can be understood as the nonlinear mix-
ing between the resonant excitation, drive excitation and
the incoherent fluctuation in the thermal bath. Besides
a trivial renormalization, these transformed collapse op-
erators can lead to nontrivial physics absent in the non-
driven system. For example, in the ωj=ωd−ω′
oterms
in Eqs. (65) and (66) a drive excitation is simultaneously
converted to a resonant excitation and a bath excita-
tion, suggesting a non-zero population in the driven ex-
cited states even when the oscillator is coupled to a bath
at zero temperature [42]. Nevertheless, in this section
we content ourselves with extending the diagrammatic
representation of the effective Hamiltonian to the effec-
tive Lindbladian. We refer the readers to a few recent
works for more in-depth discussion regarding the effec-
tive dissipative dynamics in the driven nonlinear system,
namely [42] on the life-time renormalization of Joseph-
son circuit when dispersively readout, and [43] on the
effective Lindbladian of the Kerr-cat system. In these
works the frames hosting the effective Lindbladians are
constructed via other high-frequency expansions different
from the one used in the current work (see Section V E
on how they are related); yet one can easily translate the
results into the diagrammatic language. The advantage
of our diagrammatic method is to directly capture thediagrams that contribute to the oscillator’s decoherence
dynamics bypassing the need for high-frequency expan-
sions which get cumbersome at high orders.
D. Choice of rotating frame and the general
slow-evolving effective Hamiltonian
When computing the effective Hamiltonian, an a priori
knowledge we have injected into the analysis is some per-
tinent rotating frame at ω′
oin which diagrams are con-
structed. The choice of rotating frame defines the fre-
quency of the resonant excitation
 =˜Ae−iω′
otand
plays a crucial role in capturing the relevant nonlinear
processes — in Eqs. (58) and (59) the coupling term
Ωlq′,lp′ξlp′˜A†lq′+ h.c.exists only in the frame rotating
atω′
o=p′ωd/q′but not in any other frame in the vicin-
ity of ω′
o. It is natural to then pose the question: in the
absence of an a priori knowledge concerning this rotat-
ing frame, how should one perform QHB to capture the
concerned effective dynamics of the oscillator?
In this section, we address this question by introduc-
ing the notion of a “slow-evolving effective Hamiltonian”,
which captures the near-resonant dynamics of the os-
cillator. This is a generalization of the static effective
Hamiltonian, which captures the resonant dynamics. To
illustrate the necessity of this generalized notion, let us
first take the example of the Kerr-cat as a concrete exer-
cise and examine the concerned dynamics in two different
frames.
The first frame, as discussed in Section I, corresponds
to a frame rotating at ω′
o=ωd/2. This choice entails
the knowledge that a Kerr-cat system is the quantum
manifestation of the classical period doubling bifurcation
(thus 4 π/ω′
o= 2π/ωd) when the drive is near the vicinity
of twice the oscillator frequency. The second frame does
not entail any intuition and, for convenience, we choose
it to be ω′′
o=ωothat is close to the first choice ω′
o. We
consider the following diagram, which stems from the
multinomial expansion in Eqs. (24a) and (24b), that is
responsible for the squeezing action generating the Kerr-
cat:
,
 .(67)
In these two frames, this diagram corresponds to
g3ξ˜A∗e−iω′
otandg3ξ˜A∗e−i(ωd−ω′′
o)t, respectively, which
are resonant and off-resonant with their corresponding
rotating frames at ω′
oandω′′
o. Solving the Eqs. (24a)
and (24b), the left resonant diagram in Eq. (67) con-
tributes to
 while the right off-resonant diagram con-
tributes to
 . Consequently,
 constructed in the
rotating frame ω′′
owillnotcollect this three-wave mixer,24
causing its corresponding effective Hamiltonian to failin
capturing the squeezing action intrinsic to the Kerr-cat
system.
To capture the Kerr-cat dynamics constructed in the
rotating frame ω′′
o, we need to relax the requirement
for
 to be strictly resonant with the excitation at ωo
and allow it to be “near-resonant” instead. The ra-
tionale for this modification will be discussed shortly.
Note that in the driving condition of a Kerr-cat, where
δ=ωo−ωd/2≪ωo, the right diagram in Eq. (67), which
corresponds to g3ξ˜A∗e−i(ωd−ωo)t=g3ξ˜A∗e−i(ωo+2δ)t, is
indeed near-resonant with the oscillator and should now
be collected by
 . Following this revised procedure,
we can compute the effective Hamiltonians
 in each
frame as:
˜Kω′o=δ˜A∗˜A+g3ξ˜A∗2+ c.c.+O(q2
zps)
˜Kω′′o=g3ξ˜A∗2e2iδt+ c.c.+O(q2
zps),
where the subscripts in ˜Kω′oand ˜Kω′′odenote the ro-
tating frame in which the corresponding Hamiltonian
lives. Here ˜Kω′ois the same static effective Hamiltonian
as Eq. (2), whose ground state manifold comprises of
Schr¨ odinger cat states shown in Fig. 1 (a). In addition,
˜Kω′′ois a slow-evolving Hamiltonian also capturing the
Kerr-cat dynamics — with numerical method, e.g. the
Floquet numerical diagonalization which we will intro-
duce in Section V E, one can find that the ground state
manifold of ˜Kω′′oare also Shr¨ odinger cat states but with
slow-evolving phase at frequency δ. Indeed, the slow-
evolving Kω′′ocan be further converted to a static ef-
fective Hamiltonian by going to another rotating frame
˜A → ˜Aeiδt, which yields
˜Kω′′o−δ=δ˜A∗˜A+g3ξ˜A∗2+ c.c.+O(q2
zps).
Note that ˜Kω′′o−δis just the effective Hamiltonian ˜Kω′o
constructed in the rotating frame at ω′
o=ωd/2 =ω′′
o−δ.
To better understand the motivation behind the con-
cept of the slow-evolving Hamiltonian, let us revisit the
general goal of QHB that underlies the diagrams. When
analyzing a driven nonlinear oscillator described by a
bosonic coordinate ˜ a, the QHB seeks to find a frame
transformation so that the dynamics of ˜ ais separated
into
 (˜Be−iω′
ot) and
 (˜µ(t)e−iω′
ot). The for-
mer, termed as resonant-excitation, is to capture the ef-
fective dynamics of interest near-resonant with the os-
cillator, and the latter, termed as the off-resonant exci-
tation, is to capture the micromotion, which is of less
physical importance. It should be recognize that
(˜Be−iω′
ot) and
 (˜µ(t)e−iω′
ot) both contain an ex-
plicit time-dependence as a rotating phase, which occurs
at frequency ω′
oandmω′
o+nωd(with m, n∈Z) for
the two excitations, respectively, as well as an implicit
time-dependence generated by the effective Hamiltonian
(˜K) and assumed to be much slower than the rotat-
ing phase. The terms “near-resonant”, “off-resonant”,“slow”, and “fast” here are used in a perturbative sense
— we assume that the detuning between full dynam-
ics of
 (˜Be−iω′
ot) and the oscillator frequency ωois
much smaller than ωowhile the detuning associated with
(˜µ(t)e−iω′
ot) is of the same order as ωo. Reinforc-
ing this perturbative hierarchy leads to a separation of
time-scale for the dynamics of the oscillator.
In the process of constructing a strictly static Hamilto-
nian,
 (˜µ(t)e−iω′
ot) is designed to include all terms
with explicit frequency mω′
o+nωd̸=ω′
o. However, this
could lead to the failure to separate the time scales if
|(mω′
o+nωd)−ω′
o| ≪ω′
o
for some m, n, causing
 (˜µ(t)e−iω′
ot) to contain
near-resonant dynamics that is supposed to be captured
by
 (˜Be−iω′
ot) and
 (˜K). This is the failure mode
for the Kerr cat analysis at rotating frame ω′′
o=ωo, as
illustrated above. To maintain the perturbative hierar-
chy in the dynamics of the oscillator, it is neccessary to
include the terms with frequency mω′
o+nωd≈ω′
oin
(˜Be−iω′
ot) instead. This adjustment is equivalent to
relaxing the requirement that the effective Hamiltonian
˜Kbe strictly static, allowing it to be “slow-evolving” in
the perturbative sense.
In some simpler cases, a well-chosen rotating frame
ω′
ocan still lead to time-independent Hamiltonian, while
this is not possible in general cases. In particular, if
the oscillator only exhibits energy renormalization effects
(captured by diagrams with l= 0 in Eq. (58)) but not
coupling effects (captured by diagrams with l̸= 0) up
to the perturbative order of interest, then any rotating
frame in the vicinity of ωocan result in a static effective
Hamiltonian. This can be seen from Eq. (58) by noting
that the diagrams with l= 0 are always static, indepen-
dent of the resonant excitation frequency ω′
o, which is
determined by the choice of rotating frame. In the case
that the oscillator only exhibits one dominant nonlinear
process labeled as ( q:p), in which qnumber of oscillator
quanta near-resonantly couple to pnumber of drive pho-
tons, there exists a special rotating frame ω′
o=pωd/qin
the vicinity of ωo, e.g. ( q:p) = (2 : 1) in the Kerr-cat,
that renders the coupling diagram in the effective Hamil-
tonian to be static. Other choices of rotating frame will
yield a slow-varying effective Hamiltonian.
However, in more complicated cases where multiple
nonlinear processes coexist, it is impossible to find a ro-
tating frame that can render all these processes static
simultaneously. For example, if ( q1:p1) and ( q2:p2)
processes coexist and p1/q1̸=p2/q2, there exists no ro-
tating frame that can render two diagrams, each involv-
ingq1orq2incoming resonant excitations and p1orp2
drive outgoing excitations, respectively, to be static si-
multaneously. In these cases, the generalized procedure
of constructing a slow-evolving effective Hamiltonian is
essential to capture the full effective dynamics. We will
illustrate this generalized procedure and the power of it
in a concrete system in Section VI C (see Eq. (107)).25
E. Relation to Floquet formalism
In this subsection, we briefly discuss the relationship
between our diagrammatic perturbation method and the
widely-used Floquet-based methods [16, 26, 29–31] for
analyzing periodically driven nonlinear systems. As will
be demonstrated, our diagrammatic approach can be
construed as a non-traditional variant of Floquet per-
turbation theory. The effective Hamiltonian derived
through our diagrammatic procedure concurs with spe-
cific instances of the Floquet methodologies, notably the
Schrieffer-Wolff expansion [21, 26, 30].
Floquet theory states that the solution of a time-
dependent Schr¨ odinger equation ˆH(t)|Ψ(t)⟩=iℏ∂
∂t|Ψ(t)⟩
for some periodic Hamiltonian ˆH(t+T) =ˆH(t) takes the
form of
|Ψm(t)⟩=e−ˆΛ(t)/iℏeˆHFt/iℏ|˜m⟩, (68)
where ˆΛ(t), called the micromotion generator, is a peri-
odic function with periodicity T, and ˆHF, called the Flo-
quet Hamiltonian, is a time independent function with
eigenstates |˜m⟩and eigenvalues ϵF
m. The Floquet state
|Ψm(t)⟩, written in the form of Eq. (68), conveys a phys-
ical picture similar to that in the QHB: the dynamics of
a driven state is decomposed into a slow dynamics gen-
erated by the static Hamiltonian ˆHFand a micromotion
generated by the periodic function ˆΛ(t). It is worth not-
ing that the construction of ˆΛ and ˆHFis not unique. The
static part of ˆΛ, denoted as Sta( ˆΛ), can vary as a gauge
transformation, and as a result, the Floquet Hamiltonian
ˆHFis uniquely determined up to a gauge transforma-
tion. However, the quasienergy spectrum of the system
remains invariant across different gauge choices.
To find the solution of the Floquet state, one class
of methods, known as Floquet perturbation methods
[26, 30, 31], takes Eq. (68) as an ansatz and plugs it into
the Schr¨ odinger equation. With some rearrangement,
one finds that the Floquet Hamiltonian ˆHFis related to
ˆH(t) by ˆHF=eˆΛ/iℏ(ˆH(t) +iℏ∂t)e−ˆΛ/iℏ. Floquet pertur-
bation methods assume that ˆH(t),ˆΛ(t), and ˆHFeach is a
perturbative series starting at order one in some relevant
perturbative parameter. These methods construct ˆΛ(t)
order by order using specific iterative procedures so that
the Floquet Hamiltonian ˆHFis time-independent at each
order. The Schrieffer-Wolff expansion (also known as the
van Vleck expansion) [26, 30] and the Floquet-Magnus
expansion [31] are two notable examples of Floquet per-
turbation methods each prescribing a particular iterative
procedure mentioned above. In addition, different Flo-
quet perturbation methods are associated with different
gauges Sta( ˆΛ) [21].
To relate the Floquet formalism and our diagrammatic
method, we consider the periodic Hamiltonian ˆH(t) de-
fined in Eq. (8). This Hamiltonian describes a driven
nonlinear oscillator in a displaced and rotated frame at
a frequency ω′
o=pωd/q. The period of the Hamiltonian
isT= 2πq/ω d. As discussed in Section III, the effectiveHamiltonian ˆKcan be computed using diagrams, and
it is related to ˆH(t) by a unitary transformation gener-
ated by ˆS(t), which can be found diagrammatically from
Eq. (53). Therefore, the Floquet states associated with
ˆH(t) are related to the eigenstates of ˆKby
|Ψm(t)⟩=e−ˆS(t)/iℏeˆKt/iℏ|˜m⟩, (69)
where |˜m⟩denotes the eigenstates of ˆK. Upon compar-
ison of Eq. (69) and Eq. (68), it becomes evident that
the effective Hamiltonian ˆKand the generator ˆScon-
structed from our diagrammatic method are respectively
a Floquet Hamiltonian ˆHFand a micromotion generator
ˆΛ. Furthermore, since ˆSis constructed as a purely oscil-
lating function, the diagrammatic method corresponds
to the Floquet perturbation method with the gauge of
Sta(ˆΛ) = 0, which is the choice made in the Schrieffer-
Wolff expansion [26, 30].
In the discussion above, we can see that the diagram-
matic method serves as an unconventional Floquet per-
turbation method. It begins with an additive ansatz (see
Eq. (12)) rather than an exponential one (see Eq. (68)),
yet it produces the same micromotion generator ˆSand ef-
fective Hamiltonian ˆKas the Schrieffer-Wolff expansion.
This equivalence, already analytically demonstrated, will
be further illustrated in a concrete example in Sec-
tion VI B, where we apply the diagrammatic method
to an experimental system previously analyzed using a
Schrieffer-Wolff-like expansion in our recent work ([21]).
We will show that both methods indeed yield the same
effective Hamiltonian to a very high order in the pertur-
bative parameter.
In comparison to the conventional Floquet perturba-
tion method, a significant advantage of our diagrammatic
method is its ability to independently compute each di-
agram. This feature not only makes the diagrammatic
method compatible with parallel computing but also en-
ables the calculation of specific effective Hamiltonian
terms of interest, such as the coupling term in Eq. (59),
without computing the others. In contrast, the iterative
nature of the conventional Floquet methods requires the
knowledge of all previous terms in the Floquet Hamilto-
nian ˆHFand the micromotion generator ˆΛ at each order.
As a result, the diagrammatic method can be executed
more efficiently to a perturbative order that is signifi-
cantly higher than that achievable by conventional Flo-
quet perturbation methods. This advantage is showcased
in Section VI C, where we analyze the multiphoton res-
onance process in driven superconducting circuits to an
order that was previously unattainable.
Besides the Floquet perturbation methods, a Floquet
problem can be solved exactly through Floquet numeri-
cal diagonalization, which we will review in more detail
in Appendix J. Here we consider the time-evolution op-
erator associated with ˆH(t) as ˆU(0, t). The evolution of26
a Floquet state over one period of time reads
ˆU(0, T)|Ψm(0)⟩=|Ψm(T)⟩ (70a)
ˆU(0, T)e−ˆΛ(0)/iℏ|˜m⟩=e−ˆΛ(T)/iℏeϵF
mT/iℏ|˜m⟩(70b)
=eϵF
mT/iℏe−ˆΛ(0)/iℏ|˜m⟩.(70c)
As written in Eq. (70c), we see that the eigenvalues
and eigenvectors of ˆU(0, T) are respectively eϵF
mT/iℏand
e−ˆΛ(0)/iℏ|˜m⟩, while |Φ(t)⟩=e−ˆΛ(t)/iℏ|˜m⟩is also known
as the Floquet mode. Floquet numerical diagonalization
exploits this relation and finds the eigenenergies and Flo-
quet modes by diagonalizing ˆU(0, T), which is obtained
by numerically integrating ˆH(t) to one period.
In our work, we perform Floquet numerical diagonal-
ization, in order to capture the exact dynamics, as a
benchmark of our diagrammatic method. However, for
a strongly driven nonlinear system with around 10 or
more states, the quasienergy spectrum and Floquet states
solved from Floquet numerical diagonalization can be
challenging to decipher, especially under strong driving
conditions where many states hybridize with each other.
In contrast, our analytical method provides the advan-
tage of mapping the Floquet states into the Fock state
basis analytically. This mapping not only reveals the an-
alytical structure of the driven dynamics and but can
also serve as a useful tool when employed in conjunc-
tion with Floquet numerical diagonalization to decipher
the quasienergy spectrum and Floquet states. This will
become more clear in the concrete examples treated in
Sections VI C and VI D.
VI. APPLICATION EXAMPLES
A. Stabilization of three-legged Schr¨ odinger cats
In this section, we exemplify the axiomatic procedures
outlined in Section IV by providing a detailed calculation
of the three-legged Schr¨ odinger cat states, as mentioned
in Section I. This example is particularly instructive as
it encompasses all the diagrammatic elements and rules
introduced thus far.
In particular, we consider a driven SNAIL supercon-
ducting circuit (see [12]) described by the Hamiltonian
ˆH(t)
ℏ=ωoˆa†ˆa+X
m≥3gm
m(ˆa+ ˆa†)m
−iΩd(ˆa−ˆa†) cosωdt.(71)
In accordance with the standard quantum optics conven-
tion, here and in the following text, we take ˆ aand ˆa†to
be the usual annihilation and creation ladder operators;
in other words, we take their commutator to be 1. In
this case, all the diagrammatic rules in Section IV re-
main valid but with three modifications: (1) the effective
Hamiltonian diagram
 is associated with ˆK/ℏinsteadofˆK, (2) each ℏfactor in ›is replaced by a factor of 1,
and (3) each quantum bond is associated with a factor of
1 instead of ℏ(c.f. Eq. (34)). Moreover, when analyzing
a Josephson circuit, we take φzpsin lieu of qzpsas the
perturbative parameter underlying the diagrams. Here
φzps≪1 is the zero point spread of the phase φacross
the Josephson junction, which is the source of the native
nonlinearity. In the Hamiltonian Eq. (71), this perturba-
tive structure is manifested as gm/ωo=O(φm−2
zps).
The three-legged Schr¨ odinger cat states are obtained
when the drive frequency ωdis chosen to be in the vicin-
ity of 3 ωo/2. Provided that the nonlinearities gm’s are
correctly engineered, in a semiclassical picture, the 2 /3rd
ultra-subharmonic of the drive, at frequency 2 ωd/3≈ωo,
can consequently be resonantly stablized through the os-
cillator. We refer to this process as the (3 : 2) ultra-
subharmonic bifurcation, the general class of which will
be discussed in more detail in Section VI E. In the quan-
tum regime, this bifurcation manifests when the sys-
tem adopts the three-legged Schr¨ odinger cat states as
its ground states. We capture this bifurcation process by
transforming H(t) in Eq. (71) to a new frame amount-
ing to ˆ a→ˆae−iω′
ot+ξe−iωdt, where ξ=iΩdωd
ω2
d−ω2oand
ω′
o= 2ωd/3. The transformed Hamiltonian reads
ˆH(t)
ℏ=δˆa†ˆa+X
m≥3
m∈Ngm
m(ˆae−iω′
ot+ ˆa†eiω′
ot
+ξe−iωdt+ξ∗eiωdt)m(72)
with δ=ωo−ω′
o. Now we can use the diagrammatic
method to directly write down the effective Hamiltonian
associated with Eq. (72).
The most important effective Hamiltonian terms are
those associated with the diagrams of 5-wave compos-
ite mixers with two incoming drive excitations and three
outgoing resonant excitations. Such diagrams, in alge-
braic form, read Ω 3,2ξ2ˆA†3+ h.c.with some prefactor
Ω3,2=O(φ3
zps) to be determined. These terms obey
three-fold rotational symmetry in phase space and are
directly responsible for the bifurcation. We are inter-
ested in finding the leading order contribution of Ω 3,2
diagrammatically. To this end, we first follow Step 1 in
Section IV and write down the forest of unrooted trees
involving 5 leaves as
. (73)
Following Steps 2-4, for the five external edges in each
tree above, we assign two incoming drive excitations and
three outgoing dressed resonant excitations, and for each
internal edge we assign a dressed off-resonant excitation
traveling in either direction. The first tree in Eq. (73)27
consequently yields 2 unique diagrams
, (74a)
the second tree yields 14 unique diagrams
,
(74b)
and the third tree yields 40 unique diagrams, whose ex-
plicit can be form written down in a straightforward way.
Each diagram above is to be further transformed fol-
lowing Steps 5-7, which we concretely illustrate with the
last diagram in Eq. (74b) as an example. First, at Step 5,
we convert a
 traveling away from a mixer to a
 .
This yields three diagrams each a rooted tree:
(75)
These diagrams are at the level of Hamiltonian
(˜K/ℏ) and, to evaluate them at Step 7 (we dis-
cuss Step 6 later), they are further converted to the level
of
 by removing
 :
, (76)
where we have re-orientated the diagrams in a way similar
to those in Section III. The three diagrams in Eq. (76) to
leading order (i.e. considering only the bare propagator
contribution of
 and the bare resonant excitation of
) correspond to
g3ξ›g4
∆−ωd/3ξ›˜A∗›˜A∗
e−i2
3ωdt
+g4g3
∆−ωd/3ξ›˜A∗
›ξ›˜A∗e−i2
3ωdt
+g4˜A∗›g3
∆−ωd/3ξ›˜A∗
›ξe−i2
3ωdt
=−3g3g4
ωdξ2˜A∗2e−i2
3ωdt,(77)
where ∆ −ωd/3=−1
3ωd−2
3ωdis the bare detuning be-
tween the off-resonant excitation at −ωd/3 and the res-
onant excitation at ω′
o= 2ωd/3. The leading order
effective Hamiltonian terms associated with Eq. (75)
are computed by integrating Eq. (77) over ˜A∗ei2
3ωdt.
This results in −g3g4ξ2˜A∗3/ωd−g3g4ξ∗2˜A3/ωd, which in
the Hilbert space representation reads −g3g4ξ2ˆA†3/ωd−
g3g4ξ∗2ˆA3/ωd.
With the assistance of a computer program [19], we
construct all the bare diagrams derived from Eq. (73)
and evaluate them as
(2g5−165g3g4
8ωd+195g3
3
4ω2
d)ξ2ˆA3+ h.c., (78)
which are just the terms displayed in the second line of
Eq. (4). These terms are directly responsible for the
three-legged cat formation as they endorse a 3-fold rota-
tional symmetry in phase space. Since the sought-after
terms are already captured, we truncate our perturba-
tive expansion at this order, i.e. φ3
zps, while higher order
terms will only perturbatively correct the effective dy-
namics captured at this order.
Within order φ3
zps, a different type of diagrams con-
tributing to the effective Hamiltonian are those contain-
ing equal number of incoming and outgoing waves for
each type of excitation. Following Steps 1-4 in Sec-
tion IV, one constructs 21 such diagrams as
|{z}
Type I
| {z }
Type II
| {z }
Type III···
(79)
where the diagrams not explicitly displayed are those
similar to the displayed ones with the external edges
permuted or the internal edges inverted. Note that in
Eq. (79), we represent the resonant excitations in each
diagram in their bare form, with the exception of the
first one. This is because the dressed resonant excita-
tion includes corrections to the bare one at order O(φ2
zps)
(see Eq. (54)). Consequently, only the first diagram in
Eq. (79) with these corrections is O(φ3
zps), while the oth-
ers are O(φ4
zps), which is beyond the perturbative order
of interest. The off-resonant excitations in Eq. (79) are28
depicted in their dressed form, as they involve O(φzps)
corrections beyond the bare ones (see Eq. (42)) and are
thus relevant in these diagrams. In addition, based on the
leaf vertices, the diagrams in Eq. (79) are further cate-
gorized into three types as indicated by the explicit label
in Eq. (79) containing both the displayed diagrams and
undisplayed diagrams similar to the displayed ones. We
will discuss the role of each type in the effective Hamil-
tonian soon.
Each diagram in Eq. (79) is evaluated following Step 5-
8. Specifically, the bare diagram contribution to Eq. (79)
should be evaluated first following Step 5 and 7, in a man-
ner similar to evaluating the diagrams in Eq. (74). We
refrain from detailing these steps once more for the sake
of brevity. Furthermore, since the diagrams in Eq. (79)
involve dressed oscillator and dressed off-resonant exci-
tations, the relevant Steps 6 and 8, which were omitted
in the evaluations of Eq. (74), should also be performed.
We now illustrate the procedures of evaluating these di-
agrams involving dressed components.
We first consider diagrams involving dressed propaga-
tor of the off-resonant excitation by taking the third di-
agram in Eq. (79) as an example. Following Steps 5 & 8,
we can convert this diagram to the level of
 as
=
 +
 +
 +O(φ4
zps),
(80)
where we have expanded the dressed off-resonant excita-
tion in the left-hand side following Eq. (42). In algebraic
form, the series in the right-hand side of Eq. (80) reads
g3ξ›g3
∆5ωd/3ξ›˜A
e−i2
3ωdt
+g3ξ› 
δg3
∆2
5ωd/3ξ›˜A!
e−i2
3ωdt
+g3ξ›1
∆5ωd/3{ {δ˜A∗˜A,g3
∆5ωd/3ξ›˜A} }
e−i2
3ωdt+O(φ4
zps)
=g2
3
ωdξ2˜Ae−i2
3ωdt+O(φ4
zps) (81)
where ∆ 5ωd/3=5
3ωd−2
3ωdis the bare detuning between
the off-resonant excitation at 5 ωd/3 and the resonant ex-
citation at ω′
o= 2ωd/3. Integrating Eq. (81) over ˜A∗, one
then obtains the leading order contribution of the third
diagram Eq. (79) in to the effective Hamiltonian.
To evaluate the first diagram in Eq. (79), which in-
volves the dressed resonant excitation, we follow Step 5
and 8 in Section IV and convert this diagram to the levelof
 as
=
 +
(1)(1) +O(φ4
zps), (82)
where we have expanded the dressed resonant excita-
tion in the left-hand side following Eq. (54). Evaluating
Eq. (82) to order φ3
zpsrequires plugging in the leading
order contribution of the off-resonant excitation
 .
Following Step 6 in Section IV, we collect all the off-
resonant excitations present in the diagrams in Eqs. (74)
and (79). This yields:
=
 +
 +
 +
 +
 +
 +···,
(83)
where we have explicitly displayed some representational
terms at order φ1
zps. By plugging Eq. (83) into Eq. (82),
we obtain
=
 +
 +
 +···,
(84)
where each diagram can be readily evaluated follow-
ing the rules introduced in Sections III E and III F. For
brevity, we only explicate the evaluation of the second
diagram in the right-hand side of Eq. (82) as follows:
δ
2!{ {{ {˜Ae−iω′
ot,Z
d˜A∗g3
∆4ωd/3˜A›˜Ae−i2ω′
ot} },
Z
d˜A∗g3
∆0˜A›˜A∗} }
=−9δg2
3
4ω2
d˜A∗˜A2e−iω′
ot−27δg2
3
8ω2
d˜Ae−iω′
ot,
where ∆ 4ωd/3=4
3ωd−3
2ωdis the detuning between the
off-resonant excitation at 4 ωd/2 and the resonant excita-
tion at ω′
o= 2ωd/3 and ∆ 0= 0−3
2ωdis the detuning
between the off-resonant excitation at 0 frequency and
the resonant excitation.
Each diagram in Eq. (84) is constructed at the level
of
 . To compute its corresponding contribution to the29
effective Hamiltonian
 (˜K/ℏ), we perform an “inte-
gration” over
 , as defined by the series in Eq. (57).
This operation, to leading order, corresponds to an inte-
gration over
 (˜A∗eiω′
ot), with higher-order corrections
being at order O(φ2
zps). When computing the Hamilto-
nian term up to φ3
zps, these corrections should be taken
into account for the first diagram in the right-hand side
of Eq. (84), which itself is at order φ1
zps. In particular,
the Hamiltonian term associated with this diagram can
be expanded as:
=
 +
 −
 +··· (85)
=
 +
 +
 +···,
(86)
where Eq. (85) is just Eq. (57) with
 specified as the
first diagram in the right-hand side of Eq. (84), and in
Eq. (86) we have further plugged in Eq. (54) for
 and
Eq. (83) for
 . The first diagram in Eq. (86) is sim-
ply evaluated asR
d˜A∗δ˜A=δ˜A∗˜A, and other diagrams
can be evaluated similar to those in Eq. (84). For exam-
ple, the algebraic expression associated with the second
diagram in Eq. (86) reads
Z
d˜A∗eiω′
ot
× { {δ˜A∗˜A,1
2!{ {{ {˜Ae−iω′
ot,Z
d˜A∗g3
∆4ωd/3˜A›˜Ae−iω′
ot} },
Z
d˜A∗g3
∆0˜A›˜A∗eiω′
ot} }} }
=9δg2
3
8ωd˜A∗2˜A2+27δg2
3
8ωd˜A∗˜A
Up to now, we have demonstrated all the diagrammatic
procedures required for computing the effective Hamilto-
nian of the three-legged Schr¨ odinger cats in a driven su-
perconducting circuit. To obtain such effective Hamilto-
nian to order φ3
zps, which is 2 order beyond rotating wave
approximation, we have utilized all of the diagrammatic
elements and rules established in Section III. Computing
higher-order Hamiltonian terms in this example, as wellas in other examples covered later, involves more com-
plex expansions using the same set of the diagrammatic
ingredients. In the remainder of this section, rather than
manually performing these intricate diagrammatic cal-
culations, we will employ a computer program [19] that
implements all of the diagrammatic rules we have devel-
oped.
With the assistance of the computer program, we com-
pute the algebraic expressions associated with all dia-
grams in Eq. (79) and, up to order φ3
zps, display it below:
detuning
↑
δ+ac-Stark shiftz }| {
 
6g4−180g2
3
7ωd+1494δg2
3
49ω2
d
|ξ|2
+ 3g4−10g2
3
ωd+5δg2
3
ω2
d| {z }
Lamb shift
ˆA†ˆA+3
2g4−5g2
3
ωd+5δg2
3
2ω2
d
| {z }
Kerr nonlinearityˆA†2ˆA2.
(87)
There exist four different type of terms in Eq. (87) and
they are related to the three types of diagrams in Eq. (79)
as follows: the Type I diagram in Eq. (79) is associated
with the detuning term and any other term involving δ
in Eq. (87), Type II diagrams are associated with the
ac-Stark shift terms, and Type III diagrams with the
the Lamb shift terms and the Kerr nonlinearity terms —
the latter correspond to the Type III diagrams with one
quantum bond when represented in the expanded form.
We note that the Kerr nonlinearity, at order φ2
zps, van-
ishes for g3/ωd=p
3g4/10ωd(org3/ω′
o=p
9g4/20ω′o).
This is also known as the Kerr-free point in a SNAIL
circuit [6], where the value of g3andg4are tunable with
external magnetic flux threaded in the circuit.
Adding together the effective Hamiltonian terms from
Eqs. (78) and (87), we obtain the full effective Hamilto-
nian up to the order of φ3
zpsas
ˆK
ℏ=X
n=1,2KnˆA†nˆAn+ Ω 3,2ξ2ˆA†3+ h.c.+O(φ4
zps),
(88)
where the coefficients of K1, K2and Ω 3,2are defined by
the corresponding ones in Eqs. (78) and (87). The emer-
gence of three-legged cat states from Eq. (88) is intri-
cately controlled by the effective Hamiltonian coefficients
and its precise description is left for future work. Qualita-
tively, three-legged cat states are stabilized in the regime
K2<∼Ω3,2ξ2, which is similar to the Kerr-cat states that
has been intensively studied recently [10, 13, 44, 45]. For
the parameters chosen in Fig. 1 (b), we indeed choose g3
andg4near the Kerr-free point to find this regime.30
(a) (b)
FIG. 2. Schematic of the circuits of interest. (a) A transmon
(in turquoise color) capacitively coupled to a cavity (in brown
color). (b) A transmon capacitively coupled to a transmission
line with a periodic drive at frequency ωd.
B. Modeling the energy renormalization effects of
a driven superconducting circuit and comparison
with experimental results
Having provided an illustrative example in the last sec-
tion, we consider in this section a system of interest in
cQED experiments, a transmon coupled to a high-Q cav-
ity as shown in Fig. 2 (a). Our goal is to find the en-
ergy renormalization effects on both of the transmon on
the cavity modes when the latter is prepared in a co-
herent state with large photon occupation. This system
has been employed to engineer GKP states in a recent
experiment [46] and modeling its dynamics is essential
to achieve high-fidelity quantum control. We also use
this example to demonstrate the diagrammatic method
in multi-mode systems, the general procedure of which
has been introduced in Section V B.
Specifically, we write the Hamiltonian of the system in
normal modes (see Appendix H) as
ˆH
ℏ=ωaˆa†ˆa+ωcˆc†ˆc−EJ
ℏ
cos ˆφ+ˆφ2
2
, (89)
where ˆ aand ˆcdenote annihilation operators associated
with the qubit-like and cavity-like modes and ωaandωc
denote their respective natural frequencies. The operator
ˆφ=φzps,a(ˆa+ ˆa†) +φzps,c(ˆc+ ˆc†) is the phase operator
across the Josephson junction, where φzps,a, φzps,crepre-
sent the participation of the corresponding modes in the
zero point spread of the junction phase. These parame-
ters are determined as φ2
zps,i=Piℏωi/2EJfori=a, c,
where Pirepresents the ratio between the inductive en-
ergy stored in the Josephson junction and the total in-
ductive energy stored in mode iand is a circuit design
parameter (see [39] and Appendix H). The Josephson
energy is denoted EJand the function cos( ˆ φ) + ˆφ2/2,
up to constants, contains the anharmonic part of the
Josephson potential under a Taylor series expansion. Go-
ing into a rotating frame induced by the Hamiltonian
ℏωaˆa†ˆa+ℏωcˆc†ˆcand with cos ˆ φexpanded as a Taylor se-
ries around its potential minimum at zero, ˆHin Eq. (89)transforms to
ˆH
ℏ=∞X
m=4gm
m(λa(ˆae−iωat+ ˆa†eiωat)
+λc(ˆce−iωct+ ˆc†eiωct))m,(90)
where gm= (−1)1+m/2ωaφm−2
zps/2(m−1)! for even mand
0 for odd m, with φzps=p
ℏωa/2EJandλ2
i=Piωi/ωa
fori=a, c. In the dispersive regime [47] we consider in
this section, λa∼1 and λc≪1.
Equation (90) is in the form of Eq. (60), and the di-
agrammatic prescription for multi-mode problem intro-
duced in Section V B can be readily employed. In particu-
lar, the 2-mode diagrams are similar to single-mode ones,
but with two types of resonant excitations participating.
For example, to leading order the diagrams emerged from
Eq. (90) are
···
(91)
where the straight arrows of turquoise and brown color
respectively correspond to resonant excitations of the
transmon and cavity. As annotated in the equa-
tion above, each straight arrow is associated with an
algebraic expression λa˜Ae−iωat, λa˜A∗eiωat, λq˜Ceiωqtor
λq˜Ceiωct, where ( ˜A,˜A∗) and ( ˜C,˜C∗) are respectively the
bosonic coordinates of the transmon and the cavity
modes in the frame of the effective Hamiltonian. Note
that the Husimi Q product ›in Eq. (91) is now de-
fined over the 2-dimensional phase space as ˜f›˜g=
˜fexp
ℏ← −∂˜A− →∂˜A∗+ℏ← −∂˜C− →∂˜C∗
˜g. The algebraic expres-
sion associated with the first order diagrams in Eq. (91)
reads
3g4(λ2
a+λ2
c)λ2
a˜A∗˜A+3g4
2λ4
a˜A∗2˜A2
+ 3g4(λ2
a+λ2
c)λ2
c˜C∗˜C+3g4
2λ4
c˜C∗2˜C2
+ 6g4λ2
aλ2
c˜A∗˜A˜C∗˜C.(92)
We remark that the first term in Eq. (92) corresponds to
two types of diagrams in the expanded form:
, (93)
where each type, which also contains those diagrams
look similar to the displayed diagram but with the ex-
citations permuted, is associated with 3 g4λ4
a˜A∗˜Aand
3g4λ2
aλ2
c˜A∗˜A, respectively. In addition, since λc≪λa∼
1, the contribution of the second type diagram is much
smaller than that of the first type. In general, due to the31
FIG. 3. Parameter-free model of the ac-Stark shift data of
the qubit mode in a transmon-cavity superconducting circuit
as a function of cavity occupation number ¯ n. Open black
circles represent experimental data taken from Fig. S2 in
[21]. Dashed lines represent the theoretical prediction from
the diagrammatic method for different orders of φzps. Theory
prediction converges to the experimental data at sufficiently
high order of expansion.
smallness of λc,18diagrams involving a quantum bond
between cavity excitations are much smaller than those
containing the same set of external excitations but not
involving such a quantum bond.
At the next order, diagrams involving off-resonant ex-
citations start to emerge, which are evaluated in a way
different from the single-mode case and we discuss it now.
We consider a specific term
=
 +
(94)
as an example here. Each diagram above contains an
off-resonant excitation at frequency ωout=−ωcoutput
by the 4-wave mixer in the right of the diagram. Ac-
cording to the rules discussed in Section V B, the prop-
agator of the off-resonant excitation in the first diagram
is evaluated as
 =λ2
a/(ωout−ωa) +λ2
c/(ωout−ωc).
This expression motivates expanding the diagram in the
left-hand side of Eq. (94) as the two diagrams in the
right-hand side — the two colored off-resonant excita-
tions are associated with the propagator λ2
a/(ωout−ωa)
andλ2
c/(ωout−ωc) and we interpret them as the prop-
agation of off-resonant excitation through the cavity
mode and the transmon mode, respectively. Similar to
18We note that λcis independent of the perturbative parameter
φzpsand usually much smaller than the latter when the cavity
has a small participation in the nonlinear mode. This is often
the case of a cavity dispersively coupled to the transmon. In the
particular system we treat here λc= 0.0073 and φzps= 0.33.Eq. (93), the propagation through cavity mode is much
smaller than the transmon one due to the smallness of
λc≪φzps≪λa∼1. For the sake of simplifying
the diagrammatic computation, in the rest of analysis
in this section we ignore the diagrams involving cavity-
mode quantum bonds or off-resonant excitation propa-
gating through cavity mode.
With the diagrammatic construction in the 2-mode
system illustrated above, we compute the effective Hamil-
tonian of Eq. (90) to the order of φ10
zpsas
ˆK
ℏ=X
m,n≥0,
m+n≤6Km,nˆA†mˆAmˆC†nˆCn+O 
φ12
zps
,(95)
where each Km,nis a function of φzps, λa, λc, ωa, ωc, and
we have explicitly suppressed the functional form for
brevity. We note that here we assume that ωaandωc
are incommensurable, and thus, Eq. (95) only contains
energy renormalization terms.
We test our model by comparing the measured effective
Hamiltonian parameters found in a recent experiment
[46] consisting of a transmon qubit coupled to a high-
Q superconducting cavity.19The coefficients of Eq. (90)
are fully determined by the following independently cal-
ibrated parameters measured experimentally in the ab-
sence of drives:
ω01,exp
2π=ωa+K1,0,exp
2π= 6.657 GHz ,
ωc,exp
2π= 5.261 GHz ,
χexp
2π=K1,1,exp
2π=−31.2 kHz ,
αexp
2π=2K2,0,exp
2π=−193.29 MHz ,(96)
where ω01,exp, χexpandαexprespectively correspond to
the measured qubit frequency, qubit-cavity cross-Kerr co-
efficient, and the qubit anharmonicity, and the subscript
“exp” indicates an experimentally measurable quantity;
see Supplement of [46] for characterization details. By a
numerical diagonalization of Eq. (89), we map Eq. (96)
toEJ/2π= 32 .33 GHz, ωa/2π= 6.843 GHz, ωc/2π=
5.261 GHz, λa=−0.99996 and λc= 0.0073. Here, we re-
fer two different measurements detailed in [46] and show
agreement between the experimental data and the per-
turbative results.
The first is a measurement of the transmon ac-Stark
shift, the photon-number dependent frequency renor-
malization, as a function of the mean photon number
¯n=|α|2for a coherent state |α⟩prepared in the cavity. In
the effective Hamiltonian ˆKin Eq. (95), the measurement
represents ⟨1, α|ˆK|1, α⟩−⟨0, α|ˆK|0, α⟩=P6
n=0K1,n¯nn/ℏ
19Note that in a previous work [21] we developed a different per-
turbation method to explain the same set of experimental data.32
(a)
(b)
FIG. 4. Parameter-free model of the cavity frequency data as
a function of cavity photon number ¯ nwith the qubit prepared
in (a) |0⟩and (b) |1⟩. Open black circles represent experi-
mentally measured data taken from Fig. S1 in [46]. Dashed
lines represent theoretical prediction from the diagrammatic
method with zero fit parameters. Theory prediction converges
to the measured data at sufficiently high order in the pertur-
bative parameter φzps.
as a function of ¯ n=|α|2, where |i, α⟩denotes a state with
the transmon mode in the i-th state and the cavity mode
in a coherent state of size α. Open black circles in Fig. 3
represent experimentally measured data. Dashed lines
represent the theoretical prediction, with different colors
representing the perturbative results to different orders.
They converge to the experimental data as the expansion
is performed to higher orders.
The second is a measurement of the cavity frequency
as a function of the cavity photon number ¯ nwith the
qubit prepared in (a) |0⟩and (b) |1⟩. In the effective
Hamiltonian ˆKin Eq. (95), we model this measurement
as the renormalized cross-Kerr coefficient with the cavity
in a Fock state |n⟩, i.e.,⟨i, n+1|ˆK|i, n+1⟩−⟨i, n|ˆK|i, n⟩
versus ¯ n=nwhere in (a) |i⟩=|0⟩and (b) |i⟩=|1⟩. The
expectation value taken over the Fock state |n⟩serves
as a faithful proxy to the measurement performed over
the coherent state |α⟩with|α|2= ¯n, because the mea-
sured frequency is independent of the phase of the cavity
field. Open black circles in Fig. 4 are the measured data.
Again, dashed lines represent the theoretical prediction,
with different colors representing the perturbative result
to different orders. They converge to the measured data
as the order becomes higher.
With these two experiments, we have demonstrated
the accuracy and convergence of the effective Hamilto-
nian description constructed through diagrams by com-paring with the experimental data. Note that, for this
experimental system consisting of a strongly anharmonic
transmon, the perturbative parameter20φzps= 0.33 is
only moderately small and thus the perturbation expan-
sion has to be carried out to high order to explain the
experiments with large cavity photon occupation. More-
over, we remark that the starting point Eq. (89) of this
example is an undriven time-independent system. Yet
with proper transformation, we obtain a time-dependent
Hamiltonian Eq. (90) that is suitable for the diagram-
matic analysis.
Lastly, we note that in a previous work [21], we
have analyzed the same experimental system using a
Schrieffer-Wolff-like expansion, which is a Floquet per-
turbation method. Here, we confirm that the analytical
results obtained from this method and our diagrammatic
method are the same for the two measurement schemes
discussed above. This equivalence of results in this spe-
cific system supports the claim made in Section V E that
our diagrammatic method is equivalent to the Floquet
perturbation method.
C. Multiphoton resonances in a driven
superconducting circuit
As discussed in Section V A, when the drive frequency
is in the vicinity of pωo/qfor some integers p, q, the ef-
fective Hamiltonian of a driven nonlinear oscillator is of
the form
ˆK
ℏ=X
n>0KnˆA†nˆAn+X
l>0Ωlq′,lp′ξlp′ˆA†lq′+ h.c.(97)
where p′/q′equals to p/qin its factored form; in other
words, q′andp′are coprime. From the Hamiltonian
in Eq. (97) a variety of nonlinear processes emerge —
we have demonstrated in Section VI A the three-legged
Schr¨ odinger cat states in the case of ( q:p) = (3 : 2), and
in Section VI B the energy renormalization of the oscilla-
tor states when the coupling terms Ω lq′,lp′ξlp′ˆA†lq′+ h.c.
are absent in Eq. (97). In this section, we discuss an-
other class of processes, multiphoton resonances, due to
the coupling terms.
In a nutshell, a multiphoton resonance labeled ( q:p) is
the coherent coupling between the i-th state and ( i+q)-th
state when they are (near-)resonant in the effective frame
that ˆKlives in. The uncoupled energies of the states are
determined by the terms KnˆA†nˆAnin Eq. (97) and the
coupling, to leading order, is created by Ω q,pξpˆA†q+h.c..
In the lab frame, the resonance condition of such a multi-
photon resonance translates to ˜Ei+q−˜Ei=pℏωd, where
˜Eiis the renormalized energy of the i-th state under the
20Because the system contains no odd rank nonlinearity, the actual
perturbative parameter is actually φ2
zps.33
drive. The coupling between the i-th and ( i+q)-th state
can also be understood as a Raman transition between
the states mediated by pdrive photons. We also note
that the ( q:p) multiphoton resonances associated with
the same simplified fraction p′/q′form a family of pro-
cesses sharing the same form of the effective Hamiltonian
Eq. (97). Yet these processes each happens at a different
resonance condition controlled by KnˆA†nˆAn, which are
determined by the drive parameters.
Multiphoton resonances have been observed in driven
nonlinear systems for several decades. In Josephson cir-
cuits, recent works have shown experimental [48, 49] and
numerical evidence [48–50] that multiphoton resonances
are responsible for anamolous state transitions. It has
been demonstrated that these resonances play a major
role in qubit readout limiting fidelities and constrain-
ing the regime of operation [47, 51]. However, a gen-
eral analytical description of these processes is missing so
far. In this section, we employ the diagrammatic method
to characterize multiphoton resonances in Josephson cir-
cuits and discuss design principles for their mitigation.
1. Example: (5 : 3) multiphoton resonance in a transmon
For the sake of concreteness, in this section we consider
a transmon periodically driven through its charge degree
of freedom as shown in Fig. 2 (b). The Hamiltonian of
the system reads
ˆH(t) = 4 EC(ˆN−Ng)2−EJcos ˆφ+EdˆNcosωdt,(98)
where the canonically conjugate operators ˆ φand ˆNare
the phase and charge operators across the junction in
the unit of magnetic flux quantum and Cooper pair re-
spectively, and they satisfy the commutation relation
[ ˆφ,ˆN] =i. The transmon is characterized by the tun-
neling energy of the Josephson junction EJ, the effective
charging energy of the shunting capacitance EC, and the
charge offset across the junction Ng. The drive is char-
acterized by its energy Edand frequency ωd. In the rest
of this work, we take Ng= 0 for simplicity.
Expanding the cosine Josephson potential around its
minimum at ˆ φ= 0, the Hamiltonian in Eq. (98) can be
re-expressed in the form describing a driven nonlinear
oscillator
ˆH(t)
ℏ=ωoˆa†ˆa+X
m≥4
m∈2Zgm
m(ˆa+ ˆa†)m
−iΩd(ˆa−ˆa†) cosωdt,(99)
where ωo=√8EJECis the natural frequency of the
oscillator and gm= (−1)(m−2)/2ωoφm−2
zps/2(m−1)! are
the even-rank nonlinearities while the odd-rank ones are
zero due to the symmetry of the cosine potential. Here
ˆa= ( ˆφ/φ zps+iˆN/N zps)/2 is the annihilation operator
andφzps= (2 EC/EJ)1/4andNzps= 1/2φzpsare re-
spectively the zero-point spreads of the phase and charge
/gid00422/gid00473/gid00423/gid00001/gid00014/gid00009/gid00053
--11
0
-FIG. 5. Energy spectrum of a driven transmon. The trans-
mon ( EJ/h= 30 GHz, EC/h= 0.15 GHz, Ng= 0) and
drive parameters ( ωd/2π= 8.97 GHz) are chosen to be typ-
ical ones in cQED experiments. (a) Quasienegies of Floquet
states in the 1st Brillouin zone of the driven transmon de-
fined by Eq. (98) as a function of drive strength |ξ|2. Un-
der the periodic drive, quasi-energies live in Brillouin zones
with width of ℏωd, where ωd/2π= 8.97 GHz. States with
large energy difference in lab frame can have near-degenerate
quasi-energies and interact with each other, indicated as the
anti-crossing in the plot. Solid color lines and transparent
lines are intra-well states and running states respectively. The
running states interacting weakly with intra-well states are
not shown. (b) A zoom-in of (a) which shows an anti-crossing
of size 2ΩR
0↔5,3= 1.2 MHz between |˜0⟩and|˜5⟩bridged by 3
drive photons, where ΩR
0↔5,3is the Rabi rate between them.
(c) The undriven spectrum of the transmon with the shape of
the each wavefunctions depicted and plotted over the Joseph-
son potential U(φ) =−EJcos(φ). The first 13 states are
intra-well and others are running states.
across the junction. The parameter Ω d=NzpsEdis the
drive amplitude.
We first analyze a particular multiphoton resonance
(5 : 3) that is manifested when the drive frequency ωdis
in the vicinity of 5 ωo/3. Similar to the previous exam-
ples, we perform the frame transformation on Eq. (99)
amounting to ˆ a→ˆae−iω′
ot+ξe−iωdt, where ξ=iΩdωd
ω2
d−ω2o
andω′
o= 3ωd/5. The transformed Hamiltonian is of the34
form
ˆH(t)
ℏ=δˆa†ˆa+X
m≥4
m∈2Zgm
m(ˆae−iω′
ot+ ˆa†eiω′
ot
+ξe−iωdt+ξ∗eiωdt)m,(100)
with δ=ωo−ω′
o.
In the effective Hamiltonian computed from Eq. (100),
the coupling terms to leading order are born from the
bare diagrams
···,
(101)
where we suppress the diagrams similar to the displayed
ones but with the external edges permuted or with the
internal ones inverted. These terms are associated with
effective Hamiltonian terms Ω 5,3ξ3ˆA†5+ h.c., with
Ω(6)
5,3= 7g8−1745g4g6
18ωd+21275 g3
4
72ω2
d, (102)
where the superscript (6) indicates the order of φzpsthe
coupling term is computed to. The three terms in the
right-hand side of Eq. (102) correspond to diagrams com-
prising of an 8-wave mixer, a cascade of a 4-wave mixer
and a 6-wave mixer, and a cascade of three 4-wave mix-
ers, respectively. We remark that even though these three
terms are of the same order ( φ6
zps), their prefactors form
an ordered list ranging from 7 to 21275 /72, resulting in
a ratio of 40.21) This is because the prefactor of an
effective Hamiltonian term is related to the number of
diagrams associated with it. For the same set of exter-
nal excitations, the cascaded mixing diagrams contain
more permutation-generated configurations than a sim-
ple mixer. This makes 7 g8, an RWA term from Eq. (100),
a poor approximation for the full coupling term and ren-
ders the high order description, and thus our diagram-
matic method, necessary for even a qualitative descrip-
tion of the multiphoton resonance process.
Eq. (101) corresponds to the particular coupling be-
tween the ground state of the transmon and the 5th
excited state when they are near-resonant with 3 drive
photons. The relevant dynamics, to leading order, is cap-
tured by the effective Hamiltonian Eq. (97) reduced to
the submanifold spanned by 0th and 5th Fock states as
ˆK
ℏ=E0Ω∗
0↔5,3
Ω0↔5,3E5
. (103)
21If one also considers the 1 /(m−1)! factor in the definition of gm
(c.f. Eq. (99)), the strength of the g3
4term is 985 times larger
than that of the g8term!HereE0,E5are the renormalized energy of the two Fock
states and determined by the energy renormalizing terms
in Eq. (97) as Ei=⟨i|P
nKnˆA†nˆAn|i⟩, where Kn’s are
functions of ωdandξ. The off-diagonal term Ω 0↔5,3=
⟨5|ˆA†5|0⟩ξ3Ω5,3is the multiphoton Rabi rate between the
two states when resonant, i.e. E0=E5= 0, and Ω 5,3to
leading order is given by Eq. (102).
To verify the effective description given by Eq. (103) of
the (5 : 3) resonance, we compare it with an exact calcu-
lation, which we find by solving Eq. (98) via Floquet nu-
merical diagonalization (see [49] and Appendix J). Specif-
ically, we fix ωdto be a particular value near 5 ωo/3 and,
in Fig. 5, we plot the Floquet quasienergy spectrum of
the transmon as a function of |ξ|2. In the regime where
the dominant nonlinear processes are multiphoton reso-
nances, the quasienergies ϵF
nof the Floquet states |˜nF⟩
can be understood as ϵF
n=˜Enmodℏωd, where ˜Enis
the Stark-shifted energy of the n-th state of the trans-
mon in lab frame. For this reason, the quasienergies of
the lower lying excited states (those with small non-zero
index n) in Fig. 5 (a) decrease as |ξ|2increases, and to
leading order the Stark-shift is 6 g4|ξ|2n! (c.f. Eq. (87)).
In this example, the drive frequency ωdis chosen in a
way that ϵF
5is slightly larger than ϵF
0atξ= 0 (or, in
the lab frame, the undriven energy of the 5th excited
state E5is slightly larger than E0+ 3ℏωd). As |ξ|2in-
creases to 0.568, the quasienergy of 5th Floquet state
Stark-shifts into resonance with the 0th Floquet state,
and one observes an 1.2 MHz anti-crossing predicting a
Rabi coupling between the states with strength given by
Ω0↔5,3/2π= 0.6 MHz. By comparing this value with the
analytical Rabi coupling prediction of 0.67 MHz given by
Eq. (103), we find excellent agreement between Floquet
numerics and our analytics, which we obtained via our
diagrammatic perturbation method.
2. Characterization of general multiphoton resonance in
transmons
In general, for a transmon with Ng= 0, the ground
state can couple to the q-th excited state if the resonance
condition ˜Eq−˜E0=pℏωdis met and q+phas even par-
ity. This leads to a dense and complicated landscape of
multiphoton resonances in the drive and oscillator pa-
rameter space, which we characterize now. Specifically,
we will analyze the lowest order processes ( q:p) with
q+p≤16 and those occurring inside an experimentally
relevant window ωd∈[1.1ωo,2ωo]. The methods dis-
cussed below can be applied to treat processes outside
this window.
First, in Fig. 6 (a), we consider the same transmon
as the one in Fig. 5 and plot the Rabi strength of dif-
ferent processes as a function of drive strength |ξ|2in a
range where anomalous transitions are observed in ex-
periments [48, 52]. Each dot in the plot, corresponding
to a resonance occurring at a particular configuration of
drive frequency and amplitude, is obtained from the ex-35
(a)
(b)
FIG. 6. Rabi strength ΩR
0↔q,pbetween the ground state and
q-th excited state of a transmon in a ( q:p) multiphoton reso-
nance process. In (a), the transmon is of the same parameters
(φ2
zps= 0.1, ω01/2π= 5.85 GHz) as the one in Fig. 5 and the
drive strength |ξ|2is varied and plotted in log scale. In (b),
the transmon frequency ω01is fixed to be the same as that
in (a), the drive strength is fixed to be |ξ|2= 0.5, and the
zero-point spread φ2
zpsis varied and plotted in log scale. The
anharmonicities of the transmons αare labeled on the top
xaxis; to leading order α=−ωoφ2
zps/4. The solid lines in
both plots are obtained from the diagrammatic method (c.f.
Appendix I). For each ( q:p) process the perturbative result
is computed to φq+p
zpsexcept for (10 : 6) and (11 : 5) processes,
for which the results are only computed to the leading order,
i.e.φq+p−2
zps , for numerical efficiency. The solid dots are ob-
tained by Floquet simulation in the same way as Fig. 5 where
ΩR
0↔5,3at|ξ|2= 0.568 is given as an example.
act Floquet analysis similar to the one in Fig. 5 (a). The
solid lines correspond to the Rabi strengths that are ob-
tained from the diagrammatically constructed effective
Hamiltonian and they quantitatively agree with the ex-
act values from Floquet simulation.
To compute the Rabi strength from an effective Hamil-
tonian, different resonance processes require different
treatments. Specifically, similar to Eq. (103), for ( q:
p) = (4 : 2) ,(5 : 3) ,(6 : 4) ,(7 : 3) ,or (7 : 5) the effective
Hamiltonian Eq. (97) can be reduced to the submani-
fold spanned by 0th and q-th Fock state. The resultingHamiltonian reads
ˆK
ℏ=E0Ω∗
0↔q,p
Ω0↔q,p Eq
, (104)
where
Ei=⟨i|X
nKnˆA†nˆAn|i⟩
Ωi↔i+q,p=⟨i+q|ˆA†q|i⟩ξpΩq,p(105)
are the dressed energy of the i-th Fock state and the
direct coupling term between i-th and ( i+q)-th states,
respectively, and Knand Ω q,pare the parameters in the
effective Hamiltonian Eq. (97). In these cases where the
relevant states only involve the coupled two, the Rabi
strength is simply the off-diagonal term in Eq. (104)
ΩR
0↔q,p=|Ω0↔q,p|.
For the processes ( q:p) = (8 : 4) and (10 : 6), their
effective Hamiltonians in the form of Eq. (97) involve
not only the coupling term of interest Ω q,pξpˆA†q+ h.c.
but also Ω q/2,p/2ξp/2ˆA†q/2+ h.c.while the latter is of
lower order in φzpsthan the former. As a result, the
reduced effective Hamiltonian, to leading order, involves
three states and reads
ˆK
ℏ=
E0 Ω∗
0↔q/2,p/2Ω∗
0↔q,p
Ω0↔q/2,p/2Eq/2 Ω∗
q/2↔q,p/2
Ω0↔q,p Ωq/2↔q,p/2 E0
.(106)
The resonant condition for the ( q:p) process is E0≈
E0, under which Eq/2is detuned from both E0andE0
due to the anharmonicity. For these processes, the
Rabi strength between ground and q-th excited states
is computed by performing numerical diagonalization of
Eq. (106), which we discuss in more detail in Appendix I.
Lastly, we note that in the transmon of the particular
design parameters we choose in this example, the reso-
nant processes ( q:p) = (10 : 4) ,(9 : 5), and (11 : 5)
each coexists with some other lower-order processes. To
compute the Rabi strength, it is necessary to construct
a slow-varying effective Hamiltonian , instead of a static
one, that captures different classes of multiphoton res-
onances simultaneously . The principle behind this pro-
cedure has been discussed in Section V D. Here we take
the (10 : 4) process as an example and leave the de-
tail analysis in Appendix I. When the drive strength fre-
quency are chosen so that the ground state is coupled
to 10th excited state mediated by 4 drive photons, two
other resonant processes are near-resonant: the 10th and
7th excited states are coupled through a (3 : 1) process,
and the ground state and the 7th excited state are cou-
pled through a (7 : 3) processes. While each of these
two processes is hundreds of megahertz detuned from
the resonance condition, the coupling strength between
the 7th and 10th state is comparable to the detuning
(when |ξ|2= 0.2, the coupling is ∼590 MHz; see foot-36
note22) and renders it necessary to include the dynamics
of the 7th excited state in the effective description as
well. To capture all three processes (10 : 4) ,(3 : 1) ,and
(7 : 3), we construct diagrams in the rotating frame at
ω′
o= 2ωd/5 so that the diagrams associated with the
coupling term ξ4ˆA†10is static. In addition, we consider
the diagrams associated with ξˆA†3exp[i(3ω′
o−ωd)t]+h.c.
andξ3ˆA†7exp[i(7ω′
o−3ωd)t]+h.c. to be slow-varying and
absorb them to the effective Hamiltonian as well. Noting
that±(3ω′
o−ωd) =∓(7ω′
o−3ωd) =±ωd/5, the effective
Hamiltonian to leading order reads
ˆK
ℏ=X
n>0KnˆA†nˆAn+ Ω 10,4ξ4ˆA†10+ Ω 3,1ξˆA†3eiωd
5t
+ Ω 7,3ξ3ˆA†7e−iωd
5t+ h.c.,
(107)where each Hamiltonian parameter above is associated
with the diagrams constructed following the ordinary
rules but excluding those containing near-resonant off-
resonant excitations, i.e. those of frequency ( −2ω′
o+ωd)
or (−6ω′
o+ 3ωd). This effective Hamiltonian can be re-
duced to the subspace of relevant oscillator states, i.e.
0th, 3rd, 7th, and 10th Fock states, and reads
ˆK
ℏ=
E0 Ω∗
0↔3,1e−iωd
5tΩ∗
0↔7,3eiωd
5tΩ∗
0↔10,4
Ω0↔3,1eiωd
5tE3 0 Ω∗
3↔10,3eiωd
5t
Ω0↔7,3e−iωd
5t0 E7 Ω∗
7↔10,1e−iωd
5t
Ω0↔10,4 Ω3↔10,3e−iωd
5tΩ7↔10,1eiωd
5tE10
, (108)
where each entry is related to the parameters in Eq. (107)
by the relation in Eq. (105). We further transform the
slow-varying effective Hamiltonian Eq. (108) into a static
one by the unitary transformation ˆU= exp[ iωd
5(|3⟩⟨3| −
|7⟩⟨7|)t]. The resulting effective Hamiltonian reads
ˆK′
ℏ=
E0 Ω∗
0↔3,1 Ω∗
0↔7,3Ω∗
0↔10,4
Ω0↔3,1E3+ωd/5 0 Ω∗
3↔10,3
Ω0↔7,3 0 E7−ωd/5 Ω∗
7↔10,1
Ω0↔10,4Ω3↔10,3Ω7↔10,1E10
,
(109)
and the Rabi strength between the 0th and 10th states
ΩR
0↔10,4is found by diagonalizing Eq. (109). We note
that, for the interested range of |ξ|2in Fig. 6 (a),
Eq. (109) is in the domain where |E10−(E7−ωd/5)| ∼
|Ω7↔10,1|. This implies that the 7th and 10th Fock states
are strongly hybridized through the (3 : 1) process when
the latter is coupled to the ground state through (10 : 4).
Due to such a hybridization, the (10 : 4) process, which
22This coupling strength is much larger than those characterized in
Fig. 6 because (1) the (3 : 1) process is of lower order in φzpsand
(2) for the same coupling Hamiltonian terms, the matrix element
between the excited Fock states is larger than the one between
ground state and the corresponding excited state.are of higher order in φzps, appears stronger than some
of its lower-order counterparts in Fig. 6 (a). This is also
the case for the (9 : 5) and (11 : 5) processes, in which
the 9th and 11th states are strongly hybridized with 5th
and 8th excited states, respectively. We discuss this in
more detail in Appendix I.
We also remark that in the log-log plot Fig. 6 (a), most
of the Rabi strengths ΩR
0↔q,pof different ( q:p) processes
appear as straight lines with different slopes. This re-
flects the relation ΩR
0↔q,p∝ |ξ|pto leading order and the
slope is proportional to the number of drive photons p
involved in the multiphoton resonance. An important
implication is that the strengths of processes involving
more drive photons, which are usually of higher order
inφzps, increase faster than that of processes involving
fewer drive photons. Therefore when ξis sufficiently
large, some higher-order processes are as strong as the
lower orders.
Besides the drive strength, the coupling strengths of
the multiphoton resonances also depend on the nonlin-
earities of the oscillator, which in the case of a transmon
is controlled by a single parameter φzps. In Fig. 6 (b),
we plot the Rabi strength as a function of φ2
zpsand, for
simplicity, we assume a resonant process does not coexist
with others. In this plot, most of the predicted strengths
also appear as straight lines in the log-log plot. This
reflects the relationship ΩR
0↔q,p=O(φp+q−2
zps ) and the
slope is thus proportional to p+q−2. We remark that37
(a)
(b)
0.00.10.20.30.40.5
0.010.11.010
(4:2)
(11:5)(8:4)(7:3)(10:4)(9:5)(5:3)(10:6)
(6:4)(7:5)
(6:4)
(5:3)(9:5)
(4:2) (11:5)(7:3)(10:4)(7:5)
(8:4)(14:6)(19:9)(18:8)(12:6)
(10:6)(21:9)(16:6)
(24:10)
(13:5)(20:10)(22:10)(19:7)(25:11)(22:8)(23:9)
(26:10)(18:6) (14:8)
FIG. 7. Landscape of ( q:p) multiphoton resonances in a driven transmon in the drive parameter space ( ωd,|ξ|2). The
transmon’s parameters are identical to those in Figs. 5 and 6, with qubit frequency ω01/2π= 5.85 GHz and anharmoncity
α/2π=−160 MHz. (a) Analytical result from our diagrammatic method. Each line marks a ( q:p) process with the color
matching that in Fig. 6. The center of each line corresponds to the location of each resonance process in ( ωd,|ξ|2) space and
the width corresponds to the Rabi strength ΩR
0↔q,pbetween the ground state and q-th excited state. (b) Numerical result
from Floquet simulation. The excitation possibility out of the ground state P0→(see Appendix K for detail) is plotted in the
same drive parameter space as in (a). Each line emerging in the plot is labeled as a ( q:p) process, which is inferred from the
quasienergy spectrum like Fig. 5.
for the chosen drive strength |ξ|2= 0.5, all the exam-
ined processes independent of their perturbative order
are∼10 MHz in Rabi strength when φ2
zps= 0.17. It
implies that in a transmon of ω01/2π= 5.85 GHz and
anharmonicity α/2π= 290 MHz, a design choice close to
many experimental implementations [48, 53], the notion
of “higher order process” breaks down as these processes,
conventionally believed to be weak, are as strong as the
lower order ones.
It is worth noting that, in Fig. 6 (b), the predicted Rabi
strengths of (7 : 5) ,(8 : 4) and (10 : 6) are completely
suppressed at φ2
zps= 0.113,0.107, and 0.176, respec-
tively. This is because propagators of some off-resonant
excitations involved in these processes sensitively depend
on the drive and oscillator frequencies, which vary for
different choices of φzps. At certain value of φzps, the di-
agrams containing different off-resonant excitations per-
fectly cancel out each other. For the (7 : 5) process, the
Floquet simulation gives the actual suppression point at
φ2
zps= 0.172 which is close to the predicted one, a re-
markable agreement considering the high order of the
(7 : 5) process in φzps. For the (8 : 4) and (10 : 6) pro-
cesses, the 8th and 10th states are already running states
at the suppression points and thus a Floquet numerical
characterization is difficult. Yet one can still observe the
precursor of the suppression for both processes around
φ2
zps= 1.35, which are also close to the diagrammaticprediction.
We also remark that, to the best of our knowledge, the
existing high-frequency perturbation methods, such as
Schrieffer-Wolff expansion, cannot compute the analyti-
cal expression for the higher order processes ( q+p >12).
Even with the knowledge of our previous result [21] which
provides symbolic software to compute the correction re-
cursively, the enormous number of terms involved in the
full effective Hamiltonian would cause memory overflow.
In contrast, the diagram method book-keeps different
types of terms in the effective Hamiltonian, allowing for
the construction of only the relevant terms and greatly
simplifying computations. For example, for the (11 : 5)
process, the full Hamiltonian including energy renormal-
ization terms comprises approximately 200 million un-
ordered diagrams up to the order of φ14
zps, while the rel-
evant coupling term only constitutes approximately 0.7
million of these diagrams. This bookkeeping feature also
enables more involved operations in constructing the ef-
fective Hamiltonian, for example, as in Eq. (107), identi-
fying the slow-varying dynamics that contain particular
off-resonant excitations and capturing them in a slow-
varying effective Hamiltonian.38
3. Landscape of multiphoton resonances in a transmon
In addition to the Rabi strength, it is also of experi-
mental interest to characterize the location of multipho-
ton resonances in the drive parameter space ( ωd,|ξ|2).
We recall that for a ( q:p) process coupling the ground
state and q-th excited state, the resonance condition in
lab frame is ˜Eq−˜E0=pℏωd, where ˜Enis the Stark-
shifted energy of the n-th state of the oscillator. The
Stark-shifted spectrum in the lab frame can be obtained
from the spectrum of the effective Hamiltonian, i.e. En’s
in Eq. (105), by undoing the rotating frame transforma-
tion, i.e. ˜En=En+nω′
o. With this, in Fig. 7 (a) we
consider the same transmon as the one in Fig. 5 and plot
the landscape of multiphoton resonances involving the
ground state in the drive parameter space. In this plot
each colored line represents a multiphoton process dis-
cussed in Fig. 6 (a): the center of each line23represents
the location, i.e. ωd= (˜Eq−˜E0)/pℏ, of the correspond-
ing ( q:p) process and its width represents the Rabi
strength. Here we choose to show the multiphoton reso-
nance only when its strength is greater than 0.01 MHz,
which is experimentally relevant in a transmon with typ-
ical coherence lifetime T1= 100 µs.
We remark that due to the ac-Stark shift term
(2α|ξ|2ˆA†ˆA+O(φ4
zps)) in the effective Hamiltonian, most
of the processes in Fig. 7 (a) appear as straight lines tilt-
ing to the left — they become resonant at a smaller drive
frequency with increasing drive strength. Due to this fea-
ture, for any fixed drive frequency ωd, some multiphoton
resonance process will come into resonance as |ξ|2in-
creases. In this particular transmon ( ω01/2π= 5.85 GHz,
α/2π=−160 MHz), for most values of drive frequency
ωdone encounters a strong enough resonance process
when |ξ|2<1. This is in agreement with experimen-
tal observations [47, 48, 52] on transmons with similar
parameters, where “anomalous state transitions” occur
when the ac-Stark shift (∆ ac= 2|ξ|2α) is of the same
order of the transmon anharmonicity α.
To verify the phase diagram of Fig. 7 (a), in Fig. 7 (b)
we plot the numerically computed the weight of the Flo-
quet ground state out of the displaced transmon ground
state. This quantity, which we denote as P0→, is ob-
tained from the exact Floquet numerical diagonalization
and serves as a proxy to measure the excitation proba-
bility out of the ground state. Its definition amounts to
P0→= 1− |⟨˜0F|˜0t⟩|2, where |˜0F⟩is the Floquet ground
state and |˜0t⟩is the 0th transmon state with a displace-
ment induced by the drive (see Appendix K for detail).
When away from any resonance process we therefore
have|˜0F⟩=|˜0t⟩andP0→= 0, and when a ( q:p)
multiphoton resonance occurs (c.f. Fig. 5), we have
|˜0⟩= (|˜0t⟩+|˜qt⟩)/√
2 and P0→= 0.5.24Under this defini-
23For the processes that coexist with others, we obtain the resonant
line by diagonalizing the effective Hamiltonian such as Eq. (109).
24In the presence of multiple simultaneous multiphoton resonances,
(a)
(b)0.0 0.1 0.2 0.3 0.4 0.5
(4:2)
(4:2)(11:5)120 MHz
(21:9)
100 MHz
(11:5)(17:7)
FIG. 8. Landscape of multiphoton resonances in a transmon
in the drive parameter space larger than that in Fig. 7. The
excitation possibility out of the ground state P0→is plotted
in (a) and that out of the first excited state P1→is plotted in
(b). Note that the normalization of the color map is different
from Fig. 7 for visual compatibility. The tuples ( q:p) in black
text label the processes the selected resonant lines correspond
to. The red arrow and text labels the anti-crossing between
relevant resonant lines. When |ξ|2<1, most of the resonances
involving the qubit manifold are isolated from each other and
we call the transmon in the multiphoton resonance regime.
When |ξ|2>1, there are more and more anticrossings among
resonance lines, indicating simultaneous existence of multiple
resonance processes; we call the transmon gradually phase
into quantum diffusion regime as |ξ|2increases.
tion, each colored line in the heat map of Fig. 5 (b) indi-
cates the hybridization between the driven ground state
and an excited state and the width of the line is associ-
ated with the Rabi strength of the corresponding process.
Besides the ten ( q:p) processes with q+p≤16 captured
in Fig. 5 (a), in (b) one also observes higher order pro-
cesses with q+p >16 when the drive is sufficiently strong.
Indeed, since the rational number {q/p|q, p∈Z+}forms
a dense set, the number of ( q, p) resonance processes is
also dense in parameter space. We also note that for
(q:p) processes involving highly excited states such as
q= 10 and 11, the perturbative results in (a) does does
not give the precise location of the process. This is re-
as discussed in the example of Eq. (109), P0→may exceed 0.5
due to the hybridization of the ground state and multiple excited
states.39
lated to general difficulty of perturbatively computing
the (dressed) energy of large Fock state where the per-
turbative condition of Eq. (9) breaks down.
For the sake of completeness, in Fig. 8 we survey a
larger drive parameter space and plot the landscape of
multiphoton resonances involving both the ground and
first excited state in the subplots (a) and (b), respec-
tively. In most experiments a multiphoton resonance is
consequential if it involves any state in the qubit mani-
fold. We observe that the landscapes of the resonances in-
volving the ground state and the first excited state share
a similar structure but with a frequency offset. For ex-
ample, for a fixed value of |ξ|2the (4 : 2) process in (a),
which becomes resonant at ωd= (˜E4−˜E0)/2ℏ, occurs at
a higher frequency than the same process in (b), which
becomes resonant when ωd= (˜E5−˜E1)/2ℏ. This fre-
quency offset is due to the anharmonicity of the transmon
and makes the landscape of the multiphoton resonances
involving the qubit manifold twice as dense as that in-
volving only the ground state. In addition, processes
involving the first excited state are stronger than their
counterparts involving the ground state in (a). This is
due to the difference in the matrix element between the
relevant states as ⟨1|ˆAq|q+ 1⟩=√q+ 1⟨0|ˆAq|q⟩.
Another important feature in the landscape of mul-
tiphoton resonance Fig. 8 is the anti-crossing between
the resonant lines. For example, as labeled in Fig. 8
(a), the ( q1:p1) = (11 : 5) resonant line anti-crosses
with the ( q2:p2) = (17 : 7) line with an energy gap
of 100 MHz and with the ( q3:p3) = (21 : 9) line with
an energy gap of 120 MHz. We recall that each reso-
nant line indexed ( q:p) in Fig. 8 (a) corresponds to
the hybridization between the driven ground and the q-
th excited state (c.f. Fig. 5). Therefore an anti-crossing
between two resonant lines indicates the hybridization
between two excited states coupled through some multi-
photon resonance process, while each state also couples
to the ground state of the transmon and thus is perceiv-
able in the P0→heat map. In the aforementioned two
examples, the anti-crossings respectively imply the cou-
pling between the 11th excited state and 17st excited
state through the ( q2−q1:p2−p1) = (6 : 2) process and
between the 11th excited state and 21st excited state
through the ( q3−q1:p3−p1) = (10 : 4) process. The
energy gaps in the two anti-crossings only give a proxy
that is correlated to the coupling strength in the corre-
sponding multiphoton resonance. From the quasienergy
spectrum like the one in Fig. 5, we found that, at |ξ|2= 1,
the actual coupling strength between the 11th and 17th
excited state is 500 MHz, and, at |ξ|2= 1, the cou-
pling strength between the 11th and 21st excited states
is 600 MHz.
With a coupling as strong as 500 MHz, the 11th and
17th excited states are significantly hybridized even if
the drive is a few GHz detuned from the resonant con-
dition. As a result, even though two resonant lines in
Fig. 8 (a) are separately labeled as (17 : 7) and (11 : 5)
processes, for strong drive |ξ|2>∼1, each of the two res-onant lines actually implies the concurrence of (17 : 7),
(11 : 5) and (6 : 2) processes in the system; as the drive
becomes stronger, the (21 : 9) and (10 : 4) processes also
become concurrent. From Fig. 7 and Appendix I, we
also know that 11th state is strongly hybridized with 8th
state through a (3 : 1) process. Therefore in this region
of the drive parameter space, the 8th, 11th, 17th, and
21st states form a “hybridized island” comprised of the
Fock states isolated in the undriven system.
As the drive becomes stronger, in Fig. 8 one observes
more anti-crossings among the resonant lines implying
more states forming more and larger “hybridized islands”
in the Fock state space.25We therefore refer to the weak
drive regime (in this case |ξ|2<∼1) in Fig. 8 as mul-
tiphoton resonance regime and the strong drive one as
thequantum diffusion regime. The latter is named so
because, when the excited states in the transmon are
sufficiently hybridized, the population in a transmon can
efficiently diffuse to all the excited states in the presence
of dissipation (see Section V C) or with non-zero tem-
perature.26We remark these two regimes are similarly
identified in the driven Rydberg atom [56]. In classi-
cal systems, they respectively correspond to the ultra-
subharmonic bifurcation regime (Section VI E) and the
chaos regime.
We foresee that this regime of extremely strong driving
will be reached in search for faster gates, larger bosonic
codes and more efficient readout schemes. Accounting for
these drive-induced effects is critical for the development
of quantum control in superconducting circuits or other
platforms modeled by driven nonlinear oscillators.
4. Design principles to mitigate multiphoton resonances
We have so far characterized the multiphoton reso-
nances in a transmon of typical design parameters and
charted their dense landscape in the drive parameter
space. These processes, which are inevitable in a trans-
mon when the drive is sufficiently strong, induce anoma-
lous state transitions or ionization and limit the state-of-
art readout scheme and parametric gates. In the follow-
ing text we comment on a few design principles implied
from the discussion above to mitigate multiphoton reso-
nances in driven Josephson circuits. The application of
25Note that the coupling between two excited states are perceivable
in Fig. 8 only if each state is also coupled to the ground or the
excited state. Therefore the actual number of coupling among
excited states in a transmon is more dense than shown in Fig. 8.
26In the multiphoton resonance regime if the qubit manifold is di-
rectly coupled to a running state outside the transmon cosine
potential (e.g. through the (13 : 5) process in Fig. 7 (b)), the
transmon will “ionize” [51, 54]. This process is extensively inves-
tigated in recent works [50, 55] through numerical simulation. In
the quantum diffusion regime, however, ionization can happen in
the absence of such a direct coupling.40
these principles should be examined with specific exper-
imental goals and constraints.
1. Choosing the drive frequency informedly. Since the
distribution of multiphoton resonances in the drive pa-
rameter space is dense but not uniform, one apparent
strategy is to get informed about their landscape as in
Fig. 8 and design the drive to be at a frequency with a
larger range in strength that is resonance free.27In the
specific case of Fig. 8, for example, choosing the drive
frequency ωd/ω01∈[1.2,1.3] would be a more favorable
operational regime than [1 .8,1.9].
Yet, it should be noted that the two plots in Fig. 8
assume zero offset charge between the superconducting
island in a transmon, i.e. Ng= 0 in Eq. (98). In this
case the circuit only contain even order of nonlinearity gm
thus a ( q:p) process occurs only if q+phas even parity.
This selection rule does not apply to a transmons without
control on Ng, where the odd order process could be as
strong as the even order ones while the resonance condi-
tion involving highly excited states significantly disperse
with Ng. These make the actual landscape of multipho-
ton resonances in an ordinary transmon with Ng̸= 0
more dense and complicated than depicted in Fig. 8.
2. Engineering selection rules. Another strategy that
naturally follows from the discussion above is to impose
selection rules, such as q+p∈2Z, to a Josephson circuit.
In a transmon this can be achieved by adding an offset
charge gate to enforce Ng= 0 or shunting the super-
conducting islands across the junction with an inductive
element such that no offset charge accumulates across the
junction. We discuss the latter implementation in more
detail in Section VI D. Other selection rules can be engi-
neered with more sophisticated circuit designs and driv-
ing schemes. For example, a recent work [57] develops of
a scheme of pumping a novel Josephson circuit by mod-
ulating the magnetic flux threaded in the circuit. With
this, different selection rules, such as both q, pbeing even
number for a ( q:p) process, can be achieved.
3. Suppressing ac-Stark shift. In Figs. 7 and 8, most of
the resonant lines, whose location corresponds to the res-
onant condition of the ( q:p) process ωp= (˜Eq+i−˜Ei)/pℏ
fori= 0,1, tilt to the left due to ac-Stark shift. It
is clear that if each resonant line has a smaller slope,
the resonance-free range of the drive strength for a given
drive frequency is larger. Therefore suppressing the ac-
Stark shift is another strategy to mitigate multiphoton
resonance. This can be achieved in a SNAIL circuit [12]
by operating with the external magnetic flux near a sweet
spot. Specifically, with the diagrammatic method we
compute the leading order ac-Stark shift term in the ef-
fective Hamiltonian of a driven SNAIL as
 
6g4−4g2
3
2ωa−ωd−4g2
3
2ωa+ωd−8g2
3
2ωa
|ξ|2ˆA†ˆA,(110)
27This strategy, along with the strategy of engineering selection
rules, are also identified in a recent work [55].where the nonlinearity g3,g4is controlled by the exter-
nal magnetic flux (see ref [12]), and drive frequency is
assumed to be away from 2 ωa. For any ωdthere exists a
magnetic flux, such that g3, g4are tuned to fully suppress
Eq. (110). This sweet spot is experimentally illustrated
in [58].
4. Reducing φzps.To engineering parametric processes
in Josephson circuits a central task is to exploit the de-
sired process, e.g. the coupling term in Kerr-cat and
three-legged cat Hamiltonian Eqs. (2) and (4), and curb
the spurious ones, e.g. the multiphoton resonance pro-
cesses. Importantly, both the desired and undesired pro-
cesses are controlled by the circuit design parameter φzps
and the drive parameter ξbut with different dependen-
cies. In most driving schemes, on one hand, the exploited
parametric process are 3-wave or 4-wave mixing with one
or two drive photons involved; the parametric strength
is therefore usually of the form Ω para∝φm
zpsξnwith
m= 1,2, n= 1,2. For an undesired ( q:p) multipho-
ton resonance, on the other hand, the coupling strength
is of the form Ω q,p∝φq+p−2
zps ξp. The goal of curbing the
multiphoton resonance without compromising the para-
metric strength then translates to suppressing the ratio
Ωq,p
Ωpara∝φq+p−2−m
zps ξp−n. (111)
With the configuration of k, q, p, m, n in experiments, a
strategy that usually works is to lower φzpswhile increase
ξ— this will lead to suppression of Ω q,p/Ωparaat the
same time the parametric strength Ω parais kept constant.
For example, in the Kerr-cat system described by
Eq. (2) the interested term is g3ξˆA2where g3∝φzps. Un-
der the constraint of the squeezing strength Ω sqz=g3ξ
being constant, the drive strength ξ= Ω sqz/g3∝φ−1
zps
is then inversely related to φzps. In this case, Eq. (111)
becomes Ω q,p/Ωsqz∝φq−2
zps, which implies that with the
squeezing strength kept constant, lowering φzpsby a fac-
tor of mwill suppress the ( q:p) process by a factor of
mq−2.
D. Mitigating nonlinear resonance with
inductively-shunted transmon
Based on the design principles discussed above, in this
section we introduce a circuit design, the inductively-
shunted transmon (IST) [60], to mitigate multiphoton
resonances when the circuit is driven. As shown in Fig. 9
(a), an IST is an ordinary transmon of tunneling energy
EJand charging energy ECshunted by a linear induc-
tance of inductive energy EL. The Hamiltonian of an IST
is just that of a transmon (the static part in Eq. (98))
with an additional inductive term
ˆHIST= 4ECˆN2+ˆUIST( ˆφ)
ˆUIST( ˆφ) =−EJcos ˆφ+1
2EL( ˆφ−φext)2(112)41
(a) (b)
(d)(c)
(e) (f)
(g) (h)
IST
tran.
arr-IST
FIG. 9. (a) - (c) Circuit diagrams of an inductively shunted
transmon (IST), transmon, and array IST. In (a) and (c), the
offset charge represented by Vgin (b) is nulled by the inductor
or the array. (d) - (f) Potentials of the corresponding circuits
with selected wavefunctions overlaying on the top. The pa-
rameters of each circuits are chosen such that the qubit fre-
quency ω01= 5.85 GHz and anharmonicity α/2π=−70 MHz
are the same across all circuits. The extra knob rin the IST
and array-IST allows tunability on φzps— in this case we
choose r= 3, the resulting φzps= 0.446 for IST and arr-IST
is different from φzps= 0.215 for the transmon in (e). This
can be inferred from the larger spread of ground state in (d)
and (f) comparing with (e). (g) transition frequency ωn,n+1
between the nth and ( n+1)-th state as a function of state in-
dex. (f) Higher-order nonlinearity αn=ωn+1,n+2−ωn,n+1as
a function of state index. For an IST and array-IST, ωn,n+1
andαnbehaves like a Bessel function [59]. Importantly, αn
start to oscillate around 0 when the spread of state |n >20⟩
over φis greater than 2 π, the width of the nonlinear part
−EJcosφinUIST. This saturation behavior of nonlinearity
is unique to ISTs.
with ˆNand ˆφbeing the Cooper-pair number operator
and phase operator across the junction. The function
ˆUIST( ˆφ) is the nonlinear potential specified by the junc-
tion and the inductive shunt, and φextis the reduced
magnetic flux threaded in the inductive loop. To imi-
tate the symmetric potential of the transmon, an IST
is designed to operate at zero flux bias φext= 0. We
also demand the ratio between the shunting inductive en-
ergy and the junction tunneling energy to be sufficiently
large, i.e. r=EL/EJ>0.22; in this regime the poten-
tialUIST(φ) is single-welled and confining such that the
wavefunctions are localized around the single minimumof the potential at φ= 0.
Expanding the potential ˆUISTas a Taylor series, the
Hamiltonian Eq. (112) can be rewritten in the bosonic
basis as
ˆHIST
ℏ=ωoˆa†ˆa+X
m≥4
m∈2Zgm
m(ˆa+ ˆa†)m,(113a)
where
ωo=p
8ECEJ(1 +r)/ℏ, gm=(−1)m
2+1ωo
2(m−1)!(1 + r)φm−2
zps,
φzps=2EC
EJ(1 +r)1
4,ˆa=1
2ˆφ
φzps+ 2iφzpsˆN
.(113b)
We note that an IST deforms to an ordinary transmon
when EL→0; similarly, the parameters in Eq. (113b)
defining the nonlinear oscillator become those corre-
sponding to a transmon in Eq. (99) when r→0.
In addition, we remark that fabricating a lossless lin-
ear inductance with ELin the range of interest is diffi-
cult despite a few recent pioneering works achieving it
with granular aluminum [61, 62]. An IST can be alter-
natively realized by shunting a transmon with an array
ofMJosephson junctions each with Josephson energy
E′
J, as shown in Fig. 9 (c). This array-IST design is de-
scribed by the same Hamiltonian as Eq. (112) but with
a modified potential energy ˆUIST→ˆUarray-IST as
ˆUarray-IST ( ˆφ) =−EJcos ˆφ−ME′
Jcosˆφ−φext
M(114a)
=−EJcos ˆφ+E′
J
2Mˆφ2+O(ˆφ4
M3),(114b)
where in Eq. (114b) we expand the last term in Eq. (114a)
as a Taylor series. As written it is clear that ˆUarray-IST ( ˆφ)
approximates ˆUIST( ˆφ) in Eq. (112) to leading order with
the effective shunting inductive energy as E′
J/M. This
can also be observed in the close resemblance of the spec-
trum of an IST and an array-IST shown in Fig. 9 (d), (f),
(e), and (h).
The inductive shunt in an IST modifies an ordinary
transmon in a few important ways which we now discuss.
Firstly, the shunt connects the superconducting islands
in a transmon and no charge can accumulate across them.
The offset charge Ngin Eq. (98) is thus warranted to be
zero in the IST Hamiltonian ˆHISTin Eq. (112). As a
result, ˆHISTby construction is an even function that en-
dorses the selection rule q+p∈2Zfor (q, p) multiphoton
resonance processes — this reduces the density of the
resonances in the drive parameter space, which is only
the case for Ng= 0 in an ordinary transmon. Also due
to the suppression of Ngdependence, the energy spec-
trum of an IST does not disperse as the static charge
fluctuates in the environment the circuit lives in; in the
context of multiphoton resonance, the location of each
process in the drive parameter space (c.f. Fig. 7) is in-
variant under the static charge fluctuation and provides
more experimental controllability.42
FIG. 10. Coupling strength Ω 0↔q,pbetween the 0th state and
q-th Fock state as a function of r=EL/EJfor (q:p) = (4 :
2) and (5 : 3) processes in ISTs with ω01/2π= 5.85 GHz,
α/2π=−70 MHz. For better visual comparability, (4 : 2)
is computed for the drive strength at |ξ|2= 0.5, and (5:3) is
at|ξ|2= 3. For r= 0 and 3, the circuits correspond to the
transmon and the IST with the same parameters as shown
in Fig. 9 (b) and (a), respectively. Dots correspond to the
value inferred from the exact numerical Floquet simulations
(c.f. Fig. 5 and Eq. (104)). Dashed curves are extracted from
the leading order result of Ω q,pin Eqs. (115) and (116). Solid
lines are extracted from the analytical results when computed
to order φq+p+4
zps . For increasing r, the discrepancy between
the numerical and perturbative description arises since φzps
is no longer small.
Secondly, besides the circuit parameters ECandEJ
of a transmon, an IST involves an extra parameter r=
EL/EJthat also controls the configuration, specifically
ωo,φzps, and gm’s, of the nonlinear oscillator the circuit
corresponds to. As evident in Eq. (113b), through tuning
EJandECan IST can then be constructed such that its
ωo=p
8ECEJ(1 +r)/ℏandg4=−EC/3(1 + r) match
those of any given transmon (with r= 0), while ris left as
a free knob to tune φzps=p
−12(1 + r)g4/ωo. Here we
choose to match g4the lowest order nonlinearity since it
usually generates the interested parametric processes and
determines the gate and readout speed in experiments.
To illustrate the tunability on φzps, in Fig. 9 (d)-(h), we
plot the spectrum of an IST, a transmon, and an array-
IST with circuit parameters that have the same qubit
frequency28ω01≈ωo−αand anharmonicity α≈3g4
but different φzps.
The independent knob rthat revises φzpsis an asset to
control particular multiphoton resonance processes. This
is already evident in Fig. 6 (b) where the (7 : 5) process
in a transmon is fully suppressed at φ2
zps= 0.176 (yet
in this case φzpsis fixed by specifying g4). Another ex-
ample is the (5 : 3) process which we have extensively
analyzed for a transmon in Section VI C 1. In an IST,
the corresponding coupling amplitude can be obtained
28Here the qubit parameters ω01andαare chosen over Hamil-
tonian parameters ωoandg4since the former pair is directly
measurable in experiments.by plugging Eq. (113b) into Eq. (102), which yields
Ω5,3=(240r2−6500r+ 14535) g3
4
72ω2
d+O(φ8
zps).(115)
To leading order φ6
zps, the coupling amplitude Ω 5,3is a
quadratic function in rand is fully suppressed at r= 2.46
and 26.42. When the ground and 5th excited states are
resonant under this process, it yields a coupling strength
between the two states of strength Ω 0↔5,3=⟨5|ˆA†5|0⟩ξ3.
In Fig. 10, we plot the coupling strength Ω 0↔5,3as a
function of r; the Floquet numerical simulation gives a
suppression point at r= 1.79, which is in good agreement
with the analytical result when computed to φ12
zps. In the
same figure we also plot the coupling strength of (4 : 2)
process, stems from
Ω4,2=(6r−27)g2
4
2ωd+O(φ6
zps). (116)
We note that the suppression point of Ω 4,2to leading or-
der is at r= 4.5 (and at order φ10
zpsis atr= 3.45), which
is different from that of the (5 : 3) process. In general,
different parametric processes have different suppression
points due to the different off-resonant excitations con-
stituting their effective Hamiltonians. Therefore an IST
can only be designed to suppress one particular multi-
photon resonance. Yet this could still be a valuable tool
for experiments that require special drive configurations
where some specific multiphoton resonance is inevitable.
Another benefit stemming from the inductive shunt in
an IST is the confinement of the potential. As shown in
Fig. 9, a transmon with a cosine potential only contains
∼p
EJ/ECnumber of states inside the potential well
while all other states are “running-states” [63]. When
directly coupled to the latter through some multiphoton
resonance process, a transmon in the qubit manifold will
“ionize” [50] and, in the presence of dissipation, heat up
to some highly mixed states [59]. In an IST (array-IST),
however, the potential is (largely) confined and all states
(a large number of states) are inside the potential well.
Consequently, when the drive strength |ξ|is sufficiently
small such that the qubit is within the multiphoton res-
onance regime (c.f. Fig. 8), the ionization of an IST is
fully suppressed.
We remark that, similar to the transmon discussed in
Section VI C 3, an IST in general can still diffuse to all
driven states through “quantum diffusion” when |ξ|2is
sufficiently large, which also leads to heating up to highly
mixed states. Yet [59] has shown numerical evidence sug-
gesting that this instability in an IST can be fully sup-
pressed when ris sufficiently large. This observation is
further supported by a recent work [64], which proves
that when r >1.89, a driven IST in the classical limit
cannot undergo “period-doubling cascading”, a process
believed to be necessary for entering chaotic regime (the
classical counterpart of quantum diffusion). While the
deep quantum diffusion regime is beyond the perturba-
tive analysis concerned in this work, it is useful to com-
ment on this suppression in the context of multiphoton43
FIG. 11. Rabi strength between the ground and 7th excited
states under a (7 : 3) resonance as a function of drive strength.
Green and orange dots correspond to the resonance in the
transmon and IST with parameters the same as Fig. 9 (d) and
(e), respectively. Each data point is obtained from Floquet
simulation similar to those in Figs. 6 and 10. In the transmon,
the Rabi strength increases monotonically in |ξ|2. In the IST,
however, the Rabi strength saturates around |ξ|2= 12 and
then oscillate around 0 like a Bessel function for a stronger
drive.
resonance and relate it to the diagrammatic language,
which we briefly discuss on now.
In an IST, the cosine part −EJcos ˆφof the poten-
tialˆUISTin Eq. (112) is responsible for the nonlinearity,
which is diluted by the linear part ELˆφ2/2. The ratio
1/(1+r) =EJ/(EJ+EL) can be viewed as a dimension-
less measure of the available nonlinearity in the system.
Heuristically, when a wavefunction explores a larger do-
main of ( −π, π], the more nonlinearity it inherits from
the potential. For example, for the IST with smaller
φzps, the span of wavefunctions over φis smaller and so
is the nonlinearity gm’s in Eq. (113b). In the presence of
drive, the oscillator gains energy since it is displaced by
∼2φzps|ξ|away from the potential minimum at φ= 0.
This lets the oscillator states explore a larger range of
the nonlinear potential and thus the strength of the rele-
vant nonlinear processes increases. Moreover, in an IST,
the amount of nonlinearity, measured by 1 /(1 + r), is
limited and it is expected that the nonlinearity inherited
by a state is also finite29. Phenomenologically, this corre-
sponds to an observation that when a state explores more
than one period of the cosine potential, the strengths of
associated nonlinear processes are bounded.
This boundedness can be already observed in
Fig. 9 (h), where the higher order anharmonicity dimin-
ishes and has a Bessel-function-like behavior for highly
excited states30that span over one period of cosine poten-
tial. In the case of multiphoton resonance, we illustrate
29One can intuit is in the limiting case r→ ∞ , in which in cosine
nonlinear potential is infinitely diluted by the linear one. In this
case, the IST becomes an harmonic oscillator and no nonlinear
phenomena should be expected.
30In this case, the energy is inserted through exciting the transmon
to its high-energy eigenstates instead of through displacing thethis boundedness in Fig. 11, where we compare the Rabi
strength of (7 : 3) process in a transmon and an IST of
r= 3 and with frequency and anharmonicity of the two
circuits matched. While the Rabi strength of this process
monotonically increase with |ξ|in the transmon, in the
IST it is bounded to 0 .2 MHz and has a Bessel-function-
like behavior. Phenomenologically, the saturation drive
strength corresponds to the driven ground state being
displaced by 2 φzps|ξ| ≈πinφcoordinate. When all mul-
tiphoton resonances are sufficiently bounded with large
enough r, the size of “hybridized islands”, which are
formed by coexistence of many strong multiphoton res-
onances, will remain finite in the Fock state space and
connect to the qubit manifold in a confined region in the
drive parameter space. This confinement leads to the
suppression of quantum diffusion.
In the context of the diagrammatic method, this
boundedness can be understood as the cancellation be-
tween the lower order process and higher order processes.
Specifically, as discussed in Eq. (59), the leading order
diagram responsible for a nonlinear process is perturba-
tively corrected by some more complicated mixing dia-
gram of higher order in φzpsand involving more pairs
of drive or resonant excitations. Diagrams at differ-
ent order in general have different signs and could (par-
tially) cancel out each other (e,g. the (7 : 5) process
in Fig. 6 (b)), while contribution of the higher order di-
agrams become larger as |ξ|and⟨ˆA†ˆA⟩increase. In an
IST, the perturbative parameter of the diagrammatic ex-
pansion is φzps=p
−12(1 + r)g4/ωo, implying that a
larger ryields a larger φzpswhen g4/ωo(orα/ω 01) is
kept constant.31Consequently, when rbecomes larger,
the contribution of diagrams of higher order in φzpswill
become more comparable with the lower order ones and
lead to saturation of the strength of the nonlinear effects
as observed in Fig. 11. In general, the larger ris, the
earlier such saturation point will be reached in the drive
strength |ξ|. We note that the discussion here is only
meant to provide a heuristic account on the suppression
of quantum diffusion in ISTs, while a systematic study is
left to a future work.
E. Ultrasubharmonic bifurcation in classical driven
nonlinear oscillator
In this last example, we apply the diagrammatic
method to a classical driven Duffing oscillator and char-
acterize the ultra-subharmonic (USH) bifurcation, a gen-
transmon via drive. Both of these ways can be seen as exploiting
the nonlinearity of the system through letting the wavefunction
interacting with a larger range of nonlinear potential.
31We insist on keeping g4/ωoorα/ω01constant instead of keep-
ingEC,EJ, orφzpsconstant. In the latter cases, increasing
r=EL/EJleads to trivial decreasing of all gm’s, and thus all
nonlinear processes, including the desired parametric process,
will be suppressed.44
eral bifurcation class exhibited in this system. These
processes beyond having attracted intense theoretical in-
terest in the nonlinear dynamics community for their
intricate topological structure and close relationship to
chaos, also constitute the essential physics underlying
many quantum devices, such as parametric amplifiers
[3, 12, 58, 65], which are Josephson circuits operating
in the weakly-nonlinear and strongly-dissipative regime.
Also, importantly, treating this classical example show-
cases that our diagrammatic method provides a unified
framework to analyze both classical and quantum driven
dynamics, allowing intuition from the former to be ap-
plied to the latter.
Specifically, we consider a Duffing equation
d2
t˜x+γdt˜x+ ˜x+c3˜x2+c4˜x3=e−iνt+eiνt,(117)
where ˜ xis the position coordinate32of a Duffing oscilla-
tor,c3andc4are its third- and fourth-rank nonlinear-
ities, γis the damping rate, and νis the dimensionless
frequency of a drive coupled to the oscillator. Here we
take the drive to have unit amplitude (i.e. the prefactor
ofe±iνtto be one), yet for a general drive amplitude one
can recover Eq. (117) by re-scaling x,c3andc4(see Ap-
pendix L). In the following analysis we also assume the
perturbative structure c2
3∼c4≪1 and γ≪1.
1. Example: (5 : 3) USH bifurcation
As shown in Fig. 12 (a) and (c), a Duffing equation usu-
ally admits a trivial harmonic solution where ˜ x(t) has the
same periodicity 2 π/νas the drive and contains a main
response at frequency νand small ones at the overtones.
The main response is approximately
xlin(t) =ξe−iνt+ξ∗eiνt, (118)
which is the solution of the linearized Duffing equation
d2
t˜x+γdt˜x+ ˜x= cos νtwith ξ= 1/(1−ν2−iγν), and the
perturbative correction to it at the overtones are due to
the mixing of the linear response through the oscillator
nonlinearity.
Besides the harmonic solution, when νis in the vicin-
ity of q/pwith q, pbeing coprimes, the Duffing equation
Eq. (117) could admit a set of q-fold degenerate solutions
that are of period 2 qπ/v and evenly spaced in phase. As
shown in Fig. 12 (a) and (d), where we take the partic-
ular case ( q:p) = (5 : 3) as an example, these solutions
contain a major response at frequency pν/q in addition
to the one at ν. Physically it can be understood as the
p/q-th ultra-subharmonic of the drive is generated and
32Here we use tilded symbol ˜ xto denote that it is a variable in
phase space and contrast it with the Hilbert space operator such
as ˆx. This is consistent with the notation in Eq. (15) and onward.
(b) (a)
3/5 7/59/5 1 11/5
 13/5 3 1/5 1 3(c)
2 0-0.5 0.5 00
-2 2 02
-20
100
10-2
10-4(d)
-0.50.5
.33.34
-0.35
-0.36
FIG. 12. (5 : 3) ultra-subharmonic bifurcation in a driven
Duffing oscillator. Panel (a) phase portrait of the steady state
of Eq. (117) with γ= 10−5, c3= 0, c4=−0.03. The black line
corresponds to the trivial harmonic solution of period 2 π/ν
and the colored lines corresponds to 5-degenerate bifurcated
solution of period 10 π/νand equally spaced in phase. Panel
(b) Phase portrait of the dynamics governed by the effective
EOM Eq. (124). Black dots marks the nodes (steady states)
of the EOM and crosses marks the saddles. Each colored
region labels the initial states that will evolve to the node
enclosed by the region. Grey color corresponds to the region
where different types of initial states densely interleaved, as
illustrated in the inset. Panel (c), (d) Fourier components of
the steady state solution, with the harmonic solution plotted
in (c) and the bifurcated solutions in (d). Black and red
bars are obtained by Fourier decomposition of the numerical
solution, as shown in (a), to the Duffing equation. Grey bars
are predicted from the diagrammatic method (c.f. Eq. (125)).
resonantly stabilized by the nonlinear oscillator. There-
fore we call this process ( q:p) ultra-subharmonic bifur-
cation.
We want to apply the diagrammatic method to analyt-
ically characterize the general class of ultra-subharmonic
bifurcation. To this end, we first apply a two-step frame
transformation to Eq. (117) similar to those applied to
Eq. (7) to arrive at Eq. (8) — the first step is to a dis-
placed frame ˜ x→˜x+xlin(t) and the second is to a rotat-
ing frame ˜ x→˜xcos(pνt/q ) +dt˜xsin(pνt/q ). In the new
frame, Eq. (117) transforms to
dt˜a=−i(δ−iγ
2)˜a−ieip
qνtX
m=3,4gm
˜ae−ip
qνt+ ˜a∗eip
qνt
+ξe−iνt+ξ∗eiνtm−1
,
(119)
where ˜ a= (˜x+idt˜x)/2 is the complex coordinate
satisfying the canonical relation {˜a,˜a∗}˜a,˜a∗= 1, and
{˜f,˜g}˜a,˜a∗=−i∂˜a˜f∂˜a∗˜g+i∂˜a˜f∂˜a∗˜gis the Poisson bracket45
(also the ℏ0order of Husimi bracket in Eq. (16)) defined
over the phase space (˜ a,˜a∗). The parameter δ= 1−pν/q
is the detuning between the natural frequency of the os-
cillator and p/q-th ultra-subharmonic of the drive and
gm=cm/2 is the rescaled nonlinearity. Here we also
symmetrized the damping to both the position and mo-
mentum coordinate, which is a valid approximation for
γ≪1.
Written as it is, Eq. (119) can be identified as a Hamil-
ton equation of motion dt˜a=−{˜H,˜a}˜a,˜a∗with the cor-
responding Hamiltonian being
˜H(t) = (δ−iγ
2)˜a∗˜a+X
m=3,4gm
m
˜ae−ip
qνt+ ˜a∗eip
qνt
+ξe−iωdt+ξ∗eiωdtm
.
(120)
Equation (120) is just the classical counterpart of Eq. (8),
the starting point of the quantum harmonic balance
(QHB) detailed in Section III, but with the modifica-
tionδ→δ+iγ/2 incorporating the damping in a com-
plex Hamiltonian description. We note that the Husimi
Q phase-space, in which QHB operates, deforms to the
phase space of classical mechanics when ℏ→0. Conse-
quently, Eq. (120) can be described by an effective Hamil-
tonian whose diagrammatic representation is just the ℏ0
order contribution of the diagrams, i.e. those without
any quantum bond, born from Eq. (8).
For example, for the (5 : 3) USH bifurcation shown in
Fig. 12, the Duffing equation to leading orders can be
described by an effective Hamiltonian
˜K=X
nKn˜A∗n˜An+ Ω 5,3ξ3˜A∗5+ c.c. (121)
where ( ˜A,˜A∗) are the complex coordinates of the trans-
formed frame that ˜Klives in. In this specific example, we
takeg3= 0 for simplicity and, from the diagram, get the
coefficient K1= (δ−iγ/2 + 6 g4|ξ|2) +O(g2
4). Note that
K1here contains the ac-Stark shift term 6 g4|ξ|2but not
the Lamb shift term as that in Eq. (87) does. In the di-
agrammatic representation, these two terms correspond
expanded diagrams like
|{z}
ac-Stark shift
|{z}
Lamb shift (absent in Eq. (121))(122)
and it is clear that the Lamb shift, due to its quantum
nature, is absent in the classical Duffing system. For the
coupling term Ω 5,3, the corresponding diagrams are of
the type
···(123)These diagrams are also present in the (5 : 3) multi-
photon process in a transmon as shown in Eq. (101).
Therefore to leading order the coupling amplitude Ω 5,3=
21275 g3
4/72ν2+O(g4
4) in the Duffing system has the same
prefactor as those involving g3
4in Eq. (102). For other co-
efficients in Eq. (121) one can be similarly compute them
through the diagrammatic method and for simplicity we
do not display them here explicitly.
With the effective Hamiltonian ˜Kgoverning the (5 :
3) USH bifurcation computed as in Eq. (121), we can
numerically solve its equation of motion
dt˜A=−{˜K,˜A} (124)
and obtain the time evolution of any classical state with a
given initial condition. This leads to Fig. 12 (b), in which
we plot the phase portrait of the (5 : 3) USH bifurcation
in the ( ˜A,˜A∗) phase space. The stationary oscillatory
states, corresponding to those withd˜A
dt= 0, are labeled as
the black dots and crosses. In particular, the dots, on the
one hand, are the nodes of the effective EOM, and all the
initial states in a colored (or white) region will evolve to a
node enclosed by the corresponding region. In this sense,
each node represents a steady state, which is also called
an attractor, of the driven Duffing oscillator. The crosses
in Fig. 12 (b), on the other hand, are the saddles of the
effective EOM lying on the separatrix of the phase space
regions of different colors. They are unstable stationary
points in phase space, and the slightest deviation from
them results in attraction to a node instead. There are
six nodes in total, with one at the origin and the other
five evenly spaced in a circle centered around the origin.
Since the phase space ( ˜A,˜A∗) is in a rotating frame at
frequency 3 ν/5, the node at the origin, denoting ˜A= 0,
corresponds to the harmonic steady state (the black lines
in Fig. 12 (a) and (c)) that has no response at the 3 /5-
th USH of the drive. Accordingly, the other five nodes
correspond to the set of 5-fold degenerate USH steady
states (the colored lines in Fig. 12 (a) and (d)).
In Fig. 12 (c) and (d), we have also computed the
Fourier components for the steady states of ˜ xusing
the diagrammatic method and represented them in grey
color. To obtain these, we first observe that the trans-
formed bosonic coordinate ( ˜A,˜A∗) in the effective frame,
where ˜Klives in, is related to ˜ xin the lab frame, where
the Duffing equation Eq. (117) lives in, by the successive
frame transformations:
˜x=˜Ae−i3
5νt+˜A∗ei3
5νt+ξe−iνt+ξ∗eiνt
+ (˜σ+ ˜µ)e−i3
5νt+ (˜σ∗+ ˜µ∗)ei3
5νt,(125a)
=˜Be−i3
5νt+˜B∗ei3
5νt+ξe−iνt+ξ∗eiνt
+ ˜µe−i3
5νt+ ˜µ∗ei3
5νt,(125b)
where ˜ xis the position coordinate in the lab frame, ξ
is the linear response of the oscillator to the drive (c.f.
Eq. (118)), and ˜ σ= ˜σ(˜A,˜A∗) and ˜ µ= ˜µ(˜A,˜A∗, t) are the
static and oscillating parts of the frame constructed by46
the QHB expansion in Section III. In Eq. (125b), we fur-
ther introduce the change of variable ˜B=˜A+ ˜σas done
in Eq. (20). With this, each pair of conjugate terms in
the right-hand side of Eq. (125b) diagrammatically cor-
responds to the dressed resonant excitations, the drive
excitations, and the dressed off-resonant excitations, re-
spectively. Remarkably, different type of excitations in
the diagrammatic method, which were constructed to fa-
cilitate the perturbation expansion, now can be mapped
to physical observables, i.e. the Fourier components of
the steady state of ˜ xshown in Fig. 12 (c). For example,
the Fourier component at 3 ν/5 corresponds to
···(126)
where each diagram above has a rotating phase of
e±i3νt/5. Likewise, the Fourier component at frequency
7ν/5 correspond to the diagrams
··· (127)
Each Fourier component in ˜ xcan be expressed as a se-
ries of diagrams similar to those in Eqs. (126) and (127).
By summing their algebraic expressions, which are func-
tions of ˜A,˜A∗, and t, and plugging in the steady states
for˜Aand ˜A∗obtained from Eq. (124), we can obtain
the perturbatively computed steady states of ˜ x. These
steady states are shown as grey bars in Fig. 12 (c) and
(d) and are in good agreement with the exact values ob-
tained from numerical integration. Such agreement pro-
vides compelling evidence that our diagrammatic method
accurately captures classical bifurcation processes.
While the discussion above suffices for computing the
steady state of the oscillator’s position ˜ x, we further note
that the steady state can be obtained only from the bare
diagrams. This simplification will shed light on the con-
nection between the diagrammatic method and the clas-
sical harmonic balance method. To derive this, we make
two observations. First, we note that for any diagram
evaluated with the bosonic coordinate ˜Ain the steady
state, the dressed propagator in it, formally defined by
Eq. (43) in the quantum case, can be simplified by omit-
ting the Poisson (Husimi) bracket term corresponding to
i{˜K,
}in the classical case. This can be seen from the
definition of the Poisson bracket
{˜K,˜f}˜A,˜A∗=−i(∂˜A˜K∂ ˜A∗˜f−∂˜A∗˜K∂ ˜A˜f) (128)
for some generic function ˜f. In a steady state with dt˜A=
i∂˜A∗˜K= 0, the Poisson bracket i{˜K,
}in Eq. (43)
therefore vanishes. As a result, the dressed propagator,
which is evaluated as a infinite series Eq. (42) for the fullHamiltonian, can be directly evaluated as 1 /(ωout−1 +
iγ/2) for steady states, where ωoutis the frequency of the
off-resonant excitation associated with the propagator.
Our second observation is that the resonant excita-
tions in diagrams representing the steady states of ˜ x(e.g.,
those in Eqs. (126) and (127)) take the dressed form
(˜Be−i3
5νt) rather than the bare form
 (˜Ae−i3
5νt). By
directly computing the steady state of ˜B, we can avoid
the cumbersome process of expanding ˜Bin terms of ˜A
and ˜A∗(see Eq. (54)) and then plugging in the steady
state of ˜A. From Eq. (56), we know that the equation of
motion for
 (˜Be−i3
5νt) is simply
dt
=∂t
−i
.
Thus, to find the steady state of
 , we need only find
its corresponding value that solves
 = 0.
Based on our two observations, we can conclude that
computing the steady states of ˜ xdoes not require knowl-
edge of the dressing of the resonant and off-resonant
excitations through the infinite series in Eq. (54) and
Eq. (42). Rather, the dressed resonant excitation can be
treated as a standalone quantity, and the dressed propa-
gator can be evaluated in its bare form 1 /(ωout−1+iγ/2).
In this sense, the bare diagrams contain all the informa-
tion of the steady states of a classical driven nonlinear os-
cillator. Indeed, the classical harmonic balance method,
which focuses only on the steady states of the oscillator,
can be seen as solving the equation of motion Eq. (18)
subject to the constraint that dt˜A=−i∂˜A∗˜K= 0,
{˜K,˜η}= 0, and ˜ σ= 0. Solving this modified equation
of motion diagrammatically yields the bare diagrams in-
troduced in Sections III B to III D.
2. Structure of general (q:p)USH bifurcation
In the preceding text, we have so far assumed to find
the steady states in the phase space ( ˜A,˜A∗) by numer-
ically solving the effective EOM Eq. (124) for dt˜A= 0.
Now we discuss the analytical structure of the steady
state solutions in the parameter space of the driven Duff-
ing oscillator. For a ( q:p) USH bifurcation process, the
steady states of the EOM Eq. (124) satisfies
(∆−iγ
2)˜A+ 2K2˜A∗˜A2+O(g2
4) =−qΩq,pξpA∗q−1,
(129)
where we have plugged the effective Hamiltonian of the
general form
˜K=X
nKn˜A∗n˜An+ Ωp,qξ∗p˜Aq+ c.c., (130)
and the renormalized detuning ∆ = δ+ 6g4|ξ|2+
4g2
3|ξ|2/(ν−2)−4g2
3|ξ|2/(ν+ 2) + 8 g2
3|ξ|2+O(g2
4) and47
(a) (d) (b) (c) (1:1) (2:1) (3:1) (4:2)
L
R L
R L
R
R L L L L L L L
FIG. 13. Geometric illustration and bifurcation domain diagrams for lowest order USH processes in classical driven Duffing
oscillator, specifically ( q:p) = (a) (1 : 1), (b) (2 : 1), (c) (3 : 1), and (d) (4 : 2) processes. (a)-(d) top row: the left- and
right-hand side of Eq. (132) are represented by the two curves L, a parabola, and R, aq−2 degree curve, in ρ. Blue, yellow
and orange parabolas represents different choice of δsuch that there exist zero, one, or two bifurcation solutions, i.e. ρ >0
points that the two curves intersect. The green parabola in (3 : 1) represents a special case that two bifurcation solutions both
locate on the right half of the parabola, in contrast with the orange parabola that the two solutions locate on different halves.
(a)-(d) bottom row: Domain diagrams for the corresponding process in the δ-g4plane with the axes rescaled by γto pertinent
power. For the sake of concrete comparison, we take |ξ|= 1 for the processes other than (1 : 1) and g3=p
|g4|for (2 : 1)
and 0 otherwise. Distinct domains are marked by different colors, each corresponding to a parabola location in the top row
plots. Also plotted within each domain is its characteristic non-dissipative phase diagram governed by Eq. (129) with γ= 0.
The blue domain marks the absence of bifurcation and the corresponding phase diagram has a single trivial node at the origin,
marked in red, representing the trivial harmonic response solution. Stationary orbits are marked around the node, with arrows
indicating direction of motion. In the orange domain, other than the trivial node emerge two additional q-fold multiplicities
of nontrivial nodes and saddles, marked in red and green respectively. The positions of the nodes and saddles are obtained by
solving analytically Eq. (131). Another nontrivial domain colored in yellow, where the q-saddle points coalesce at the origin,
occurs only in lower-order processes such as in (b) where it is a 2-D area in parameter space and is further reduced to a line
in (c) if γ= 0. Another nontrivial domain colored in green is unique to (c), or q= 3 cases in general, where the each saddle
shares the same phase θas a bifurcation node. Any higher-order process contains only the blue and orange domains like in (d).
the second order renormalization coefficient K2=3g4
2−
10g2
3
3+O(g2
4) are computed through diagrams.
To find the steady state ˜A=Assatisfying Eq. (129),
we further express the equation in the polar coordinate
As=reiθand it reads
2K2r3+ ∆r−iγ
2r+O(g2
4) =−qΩq,pξprq−1e−iqθ.
(131)
This equation always admits a trivial solution r= 0 cor-
responding to the harmonic response of the oscillator to
the drive. We note that the phase factor in the right-
hand side of Eq. (131) satisfies e−iqθ=e−iq(θ+2kπ/q )for
k∈Z. Therefore, each nontrivial solution in r̸= 0 has a
q-fold multiplicity in phase θ; these nontrivial solutions,
if they exist, represent the q-fold degenerate bifurcated
steady states that are equispaced by an angle 2 π/q.
To solve for these nontrivial solutions, we further mul-
tiply Eq. (131) with its complex-conjugate and introduce
ρ=r2to arrive at
(2K2ρ+ ∆)2+γ2
4+O(g2
4) =q2Ω2
q,p|ξ|2pρq−2.(132)
Geometrically, solving Eq. (132) is to find the intersec-
tion between two curves LandR, corresponding to the
left- and right-hand side of the equation, with ρ > 0.To leading order, L= (2K2ρ+ ∆)2+γ2/4 represents
a parabola and R=q2Ω2
q,p|ξ|2pρq−2represents a q−2
degree curve. In the top row of Fig. 13, we illustrate
this geometric picture for the representational cases of
(1 : 1) ,(2 : 1) ,(3 : 1) ,(4 : 2) USH processes33. They re-
spectively correspond to the intersection of the parabola
with a hyperbola R∝ρ−1, a constant line R∝ρ0, a
straight line R∝ρ1, and a parabola R∝ρ2. The in-
tersection between the two curves is controlled on three
types of perturbative parameters: the damping rate γ,
the nonlinearity strengths g3=O(g1
2
4) and g4, and the
bare detuning δ= 1−pν/q. We now discuss this depen-
dence in more detail.
First, the damping rate γdetermines the bottom of
the parabola Land the bifurcation strength Ω q,p=
O(gp+q
2−1
4 ) determines the height of the curve R. As we
are interested in finding the solution within the perturba-
tive regime, i.e. ρ=O(g0
4) (c.f. Eq. (9)), γneeds to be of
the same order as or smaller than the bifurcation strength
33We note that the (1 : 1) instability, which is well known as Duff-
ing bifurcation [20, 65], is analyzed using a modified USH method
that we review in Appendix L. Yet it follows the same structure
as Eq. (132) and for the sake of completeness we compare it with
other USH processes together.48
Ωq,p. This condition34translates to g4>∼γ2/(p+q−2)for
p+q̸= 2, which brings the two different perturbative
parameters γandg4on equal footing.
In addition, the detuning δcontrols the center of the
parabola Rand, when the damping is sufficiently weak, it
determines the number of nontrivial solutions in ρ. Dif-
ferent solutions, based on their stability properties, can
be classified as either nodes or saddles (c.f. Fig. 12).
With this, in the bottom row of Fig. 13 we plot the
domain diagram for different USH processes in the pa-
rameter space ( δ, g4) while each axis is rescaled by γto
some pertinent order. Different colors represent different
configuration of solutions and the insets give the repre-
sentational phase diagram of each of these regimes.
We remark that the domain diagrams of some lower-
order USH processes, such as the (1 : 1) and the (2 : 1)
USH process have been computed in previous works [9].
However, the perturbative structure among the USH pro-
cesses and an accurate domain diagram taking into ac-
count all the frequency-renormalizing terms for higher
order processes has not been constructed in previous lit-
erature to the best of our knowledge. This is partially be-
cause with increasing q, pthe complexity of the analysis
increases exponentially. Moreover, historically there was
no practical incentive to construct domain diagrams for
higher-order USH processes: the regime of weak-damping
was practically inaccessible. But this has changed with
the advent of technologies that can simultaneously access
the parameter regimes of weak damping and finite nonlin-
earity, for instance with the superconducting Josephson
junction element. Here, we have constructed the domain
diagrams of some novel USH processes in Fig. 13 and for
processes higher than the (4 : 2) process, with the help
of the diagrammatic method, one can use the computer
programs to analytically or numerically compute the do-
main diagrams.
3. Unification of USH bifurcation, multiphoton resonance,
and Schr¨ odinger cat states in a semiclassical picture
Lastly, we remark that the effective Hamiltonian
Eq. (130) governing classical USH bifurcations has the
same form as Eq. (97), from which two drastically dif-
ferent quantum processes could emerge: Schr¨ odinger cat
state and multiphoton resonance. In the rest of this sec-
tion we discuss the unification of these two processes in
a semiclassical picture.
For illustrative purpose, we consider a simple example
of a (2 : 1) process taking place in a driven quantum
nonlinear oscillator described by Eq. (1). With the dia-
grammatic method, the (2 : 1) process to order O(φ2
zps)
34For (1 : 1) process this condition is g4>∼γ3, which we derive in
Appendix L.can be described by a quantum effective Hamiltonian
ˆK/ℏ= (∆ cl+ 2K2)ˆA†ˆA+K2ˆA†2ˆA2+ Ω sqzˆA†2+ h.c.,
(133)
where ∆ cl=ωo−ωd/2 + 6 g4|ξ|2−18g2
3|ξ|2/ωdis the
renormalized detuning due to the classical diagrams,
K2= 3g4/2−20g2
3/3ωd, Ωsqz=2iΩdg3
ωdis the squeez-
ing strength, and the 2 K2term in the above equation is
the Lamb shift resulting from the quantum diagrams (c.f.
Eq. (122)). We note that Eq. (133) is just Eq. (2) with
beyond RWA terms explicitly computed.
In Fig. 14 (a), we plot the eigenspectrum of ˆKwith
parameters K2<0 (to resemble the negative anhar-
monicity of a usual Josephson circuit), ∆ cl=−3K2and
Ωsqzvarying. The parameters are chosen so that the
Fock states |0⟩and|2⟩are degenerate eigenstates of ˆK
at Ω sqz= 0. With moderately non-zero Ω sqz,|0⟩and
|2⟩are thus resonantly coupled by the squeezing term
ΩsqzˆA†2+h.c., a process we refer as the multiphoton reso-
nance and has been extensively examined in Section VI C.
In Fig. 14 (a) this resonance is characterized by the en-
ergy repulsion between the eigenstates |˜0⟩,|˜2⟩ ≈ |0⟩ ± |2⟩
in the yellow-color resonance domain and the energy
gap corresponds to twice the Rabi rate between the two
Fock states. When Ω sqzbecomes larger, Eq. (133) enters
the Schr¨ odinger cat domain and admits a two-fold near-
degenerate ground state comprising Schr¨ odinger cat-like
states (c.f. Fig. 1 (a) for a ∆ cl≈ −2K2case). This is
characterized by the “pairwise kissing” [44] in the spec-
trum Fig. 14 (a), specifically the closing of the eigenener-
gies of |˜0⟩,|˜1⟩and those of |˜2⟩,|˜3⟩in the tourquoise-color
regime.
To shed light on the continuous transition between res-
onance and cat domains, we introduce a semicalssical ob-
ject, metapotential , which is the energy surface defined by
˜K/ℏ= ∆ cl˜A∗˜A+K2˜A∗2˜A2+ Ω sqzˆA∗2+ c.c..(134)
Note that Eq. (134) is just the classical counterpart of
Eq. (133); in the diagrammatic representation, the for-
mer comprises of the subset of classical diagrams that
constituting the latter.
In Fig. 14 (b) - (d), we plot the metapotential Eq. (134)
in the phase space ( ˜Q,˜P), where ˜Q,˜Pare the reduced
position and momentum coordinates and related to the
complex coordinate by ˜A= (˜Q+i˜P)/√
2. Three partic-
ular values of Ω sqzare chosen with each corresponding
to the system in the resonance regime, early in the cat
regime, and deep in the cat regime. An equi-energy line
in the metapotential corresponds to an orbit of the clas-
sical state and a local extreme, or node, corresponds to a
stationary state of the classical nonlinear oscillator gov-
erned by Eq. (134). All three metapotentials in Fig. 14
contain two nodes away from the origin, each sitting at
the top of a hill whose footprint grows as Ω sqzincreas-
ing. We denote the area of the footprint by Amaxand it
measures the maximum action enclosed by each hill. In
Fig. 14 (b) and (c), the origin is another node sitting at49
FIG. 14. Demonstration of the (2 : 1) process with two quan-
tum manifestations: multiphoton resonance and Schr¨ odinger
cat states. (a) Eigenenergy spectrum of Eq. (133) with ∆ cl=
−3K2as a function of reduced squeezing strength |Ωsqz|/K2
in square root scale. Eigenstate |˜n⟩is indexed by the Fock
state|n⟩that it adiabatically connects to at Ω sqz= 0. The
topx-axis measures the number of action quanta enclosed by
each metapotential well away from the origin, as illustrated in
(b) - (d). Resonance and Cat domains, colored as yellow and
turquoise, correspond to regions that live in the two quantum
manifestations. (b) - (d) semiclassical configurations of quan-
tum states at |Ωsqz/K2|= 0.09,0.36,1.96. The metapotential
surface is given by Eq. (134) with states shown as quantized
orbits enclosing k+ 1/2 action quanta (with k∈N). Shaded
areas represent Amax.
the bottom of a valley, while in (d) the origin becomes
a saddle point. One can immediately identify that the
metapotential in (b) and (c) corresponds to the orange
domain of the (2 : 1) bifurcation domain diagram Fig. 13
(b) where there are three nodes and two saddles while
metapotential in Fig. 14 (d) corresponds to the yellow
domain that contains two nodes and one saddle.
In the semiclassical picture, a metapotential can
accommodate quantized orbits satisfying the Ein-
stein–Brillouin–Keller (EBK) quantization condition —
the action function enclosed by a quantize orbit is half-
integer action quanta, for any integer n. Written mathe-
matically, this well-known quantization condition reads
I
d˜P˜Q= (n+1
2)2π, (135)
where 2 πis the action quantum35in the phase space
(˜Q,˜P). With this, the resonance and cat domains in
35For an unscaled phase space with the canonical commutation
relation [ˆ q,ˆp] =iℏ, the action quantum is the Planck constant
h. For the phase space with the canonical commutation relation
[ˆQ,ˆP] =ithe reduced action quantum is h/ℏ= 2π.Fig. 14 become clear. In particular, subplot (b) exem-
plifies the resonance domain with Amax/2π <0.5, where
|0⟩,|2⟩are resonantly coupled by Ω sqzˆA†2+ h.c.. Semi-
classically, eigenstates |˜0⟩,|˜2⟩ ≈ | 0⟩ ± |2⟩are superposi-
tions of two orbits that enclose 0.5 and 2.5 action quanta,
which live in the inside and outside metapotential wells
respectively and correspond to the Fock state |0⟩,|2⟩.
Fig. 14 (c) exemplifies the emergence of cat domain with
0.5< A max<1.5 such that each metapotential hill away
from the origin is big enough to host one quantized orbit.
Eigenstates |˜0⟩,|˜1⟩are Schr¨ odinger cat-like states consti-
tuted by the two orbits living equidistant to the origin
with opposite phase. With Ω sqzincreasing, the energy
barrier separated the two orbits increases and suppresses
the tunneling between the two orbits as characterized by
the closing of energy gap between the two. Lastly, the
subplot (d) exemplifies a region deep in the cat domain
with Amax>1.5 so that more than one orbits live in
each metapotential hill away from the origin and thus
exist multiple pairs of cat-like states.
Remarkably, here we have identified a shared object,
the metapotential, that governs both the classical USH
bifurcation and the quantum processes, i.e. the multipho-
ton resonance and stabilization of general Schr¨ odinger
cat-like states, in driven nonlinear oscillators. The shape
of metapotential determines the configurations of clas-
sical stationary states (or steady states in presence of
damping) and is characterized by the domain diagrams
in Fig. 13. In the quantum regime, the characteristic area
Amaxof the metapotential relative to the action quan-
tum further determines configuration of the quantized
orbits and thus the quantum processes. The metapoten-
tial, together with the diagrammatic method transcend-
ing classical and quantum regimes, unifies these nonlin-
ear dynamical processes that were seemingly unrelated.
Finally, the semiclassical picture in Fig. 14 has been suc-
cessful in explaining the squeeze-driven Kerr oscillator
spectrum and the well-flip lifetime of the Kerr-cat qubit
measured in recent experiments [44, 45], which showcases
its potential in developing future qubit encodings.
VII. CONCLUSION
In this work, we have developed a novel diagrammatic
method to compute the effective Hamiltonian of a non-
linear oscillator driven by an oscillatory force. The core
principle of our method involves constructing perturba-
tively a canonical frame transformation that decouples
the near-resonant dynamics of the oscillator from the off-
resonant one. In a rotating frame at a frequency near-
resonant with the oscillator, the effective Hamiltonian is
then captured through mixing products of zero net fre-
quency. The cascade of these mixing products is repre-
sented by a diagram, a special graph where the inter-
nal vertices represent frequency-mixing factors, the ex-
ternal edges correspond to dressed resonant excitations
or drive excitations, and the internal edges correspond50
to dressed propagators associated with off-resonant exci-
tations. Similar to Feynman diagrams, mixing diagrams
are evaluated by multiplying the algebraic expressions
associated with each component in the diagram. The
diagram’s pictorial structure serves to organize the asso-
ciated Hamiltonian term according to perturbative order
and the types of excitations involved. This bookkeeping
feature allows for the computation of specific types of
effective Hamiltonian terms directly at arbitrary orders.
This feature is also parallel computation friendly.
At the foundation of these diagrams lies a novel self-
consistent perturbation expansion which we called Quan-
tum Harmonic Balance (QHB). This expansion is based
on the phase-space formulation of quantum mechanics,
a choice justified by the natural connection between di-
agram counting rules and the Husimi product, which in-
volves taking partial derivative of phase-space variables.
Additionally, the phase-space formulation establishes a
correspondence between the space of quantum Hilbert
space operators and the space of the classical phase-space
functions, enabling the treatment of quantum and clas-
sical nonlinear dynamics on equal footing. In developing
QHB, we have also devised a new procedure to ensure the
canonicity of the frame transformation underlying the di-
agrammatic method. This rigorous procedure is applica-
ble to the family of averaging methods whose canonicity
is often not ensured, further enhancing its utility.
In the field of quantum computing, our diagrammatic
method provides three valuable features. First, it fa-
cilitates the analytical description of effective dynamics
for driven nonlinear oscillators, which model numerous
quantum computing devices and their control schemes,
arbitrarily to high order. Second, it captures and re-
veals the structure of nonlinear processes through the
intricate design of the diagrams. Lastly, it treats quan-
tum and classical driven processes on equal footing, al-
lowing knowledge from classical nonlinear dynamics to
be applied to quantum systems. These features are es-
sential for characterizing beyond-RWA phenomena that
constrain many state-of-the-art technologies, for achiev-
ing precise control of quantum systems via parametric
drives, and for designing innovative qubit encoding, read-
out, and control schemes through Floquet engineering.
To demonstrate the power of our diagrammatic method,
we have explored several pertinent examples in the su-
perconducting circuits platform, such as a proposal to
realize a three-legged Schr¨ odinger cat state, modeling
energy-renormalization effects in a recent superconduct-
ing experiment in the strongly driven regime, a compre-
hensive characterization of multiphoton resonances in a
driven transmon, a proposal for an innovative inductively
shunted transmon circuit, and a characterization of clas-
sical ultra-subharmonic bifurcation in driven oscillators.
Our method can be applied and extended to various other
relevant systems, including those involving multiple drive
tones and quantum modes, open quantum systems cou-
pled to a dissipative bath, or superconducting circuits
driven through magnetic flux. In summary, the resultspresented in this article provide the groundwork for a sys-
tematic perturbation theory of the control of non-linear
bosonic quantum systems through an oscillating force of
variable frequency and strength.
ACKNOWLEDGEMENTS
XX and JV thank Yaxing Zhang for the tutoring on
the Schrieffer-Wolff expansion and on his pioneering anal-
ysis of multiphoton resonance using effective Hamilto-
nian theory during the initial stages of this work. RGC
thanks Brice Ravon for bringing to his attention Groe-
newold’s theorem. The authors thank Steven M. Girvin,
Alexandru Petrescu, Leonid Glazeman and Shruti Puri
for the valuable discussions and Alec Eickbusch for the
useful discussion on the experimental data presented in
Section VI B. This research was sponsored by the Air
Force Office of Scientific Research under award number
FA9550-19-1-0399, and by the National Science Founda-
tion (NSF) under award numbers 1941583 and 2124511.
The views and conclusions contained in this document
belong to the authors and should not be interpreted as
representing the official policies, either expressed or im-
plied, of the grant agencies, or the U.S. Government.
The U.S. Government is authorized to reproduce and dis-
tribute reprints for Government purposes notwithstand-
ing any copyright notation herein.
Appendix A: Glossary
Graph theory
loop: a closed sequence of connected vertices that starts
and ends at the same vertex without revisiting any
vertex in the sequence.
tree: an undirected graph in which any two vertices are
connected by exactly one path; i.e. a tree has no loop.
leaf vertex : a vertex with degree one, i.e. only
connecting to one other vertex.
external edge : an edge connecting to a leaf vertex.
internal edge : an edge not connecting to any leaf
vertex.
rooted tree : a tree in which one leaf vertex has been
designated the root.
forest : an undirected graph in which any two vertices
are connected by at most one path; in other words, the
graph consists of a disjoint union of trees.
Diagrammatic method
diagram : a special graph in which vertices correspond
to interactions, internal edges correspond to propagators,
and external edges correspond to excitations.51
resonant excitation : an excitation at the oscillator
frequency represented by a straight edge.
drive excitation : an excitation at the drive frequency
represented by a wiggly edge.
off-resonant excitation : an excitation off resonant
from the oscillator frequency represented by a diagram
whose output is a double-line edge.
bare diagram : a diagram in which the excitations and
propagators are in the bare form.
dressed diagram : a diagram in which the excitations
and propagators are in the dressed form.
unexpanded diagram : a diagram in which each
internal vertex is a
 and the dressed excitations
involve
 . The operations underlying the algebraic
expressions associated with unexpanded diagrams are
Husimi product ›and Husimi bracket { {
,
} }. See
Eqs. (28), (39) and (42) for examples. One could say
that the unexpanded diagram has dressed vertices.
expanded diagram : a fully evaluated representation
of the unexpanded diagram in which
 and
 are
algebraically evaluated and represented in diagrammatic
form. See Eqs. (40) and (51) for examples. The product
underlying the algebraic expressions associated with ex-
panded diagrams is the ordinary commutative product.
quantum bond : an edge in an expanded diagram
linking two bare resonant excitation. The algebraic
expression associated with a quantum bond is ℏ. A
quantum bond is colored in orange.
classical diagram : an expanded diagram in which
there is no quantum bond.
quantum diagram : an expanded diagram in which
there is one or more quantum bonds.
ordered diagram : a diagram where the subdiagrams
of each vertex has a definite order around that vertex.
unordered diagram : the equivalence class of topologi-
cally equivalent ordered diagrams.
Appendix B: List of Symbols
Driven nonlinear oscillator
ωo natural oscillator frequency
ω01 transition frequency between ground and first
excited state
gm m-th rank nonlinearity
ωd drive frequency
Ωd drive amplitude
ξ dimensionless drive amplitudeω′
o frequency of the rotating frame
δ bare detuning (= ωo−ω′
o)
ˆq position operator
ˆp momentum operator
qzps, pzps zero-point spread of the position and momen-
tum coordinates
ˆU potential operator
cm m-th rank coefficient of the potential ˆU
ˆa,ˆa†bosonic operators
ˆH Hamiltonian in lab frame
Phase space representation of quantum mechanics
H Husimi Q map
˜O phase space variable/function corresponding
to some operator ˆOin Hilbert space
› Huisimi Q product
⋆ Groenewold/Moyal product
˜f˜g ordinary product between ˜fand ˜g
{ {,} } Husimi bracket, based on the Husimi Q
product
{,} Poisson bracket
(˜f+ ˜g)m
› polynomial expansion of ˜fand ˜gwith ›as
the underlying product
Quantum harmonic balance in phase space representation
˜A,˜A∗bosonic variables in the transformed frame
˜µ off-resonant part of the micromotion cap-
tured by additive map (˜ a=˜A+ ˜σ+ ˜µ)
˜σ resonant part of the micromotion captured by
additive map (˜ a=˜A+ ˜σ+ ˜µ)
˜B,˜B∗dressed bosonic variables in the transformed
frame (= ˜A+ ˜σ)
˜K effective Hamiltonian
˜Kω′oeffective Hamiltonian in the rotating frame at
frequency ω′
o
ωout output frequency of a diagram producing off-
resonant excitation
˜ωout renormalized output frequency of a diagram
producing off-resonant excitation
∆ detuning between the oscillator renormal-
ized frequency and the natural oscillator
frequency
∆cl classical contribution of ∆
∆ω detuning between the off-resonant excitation
at frequency ωand the resonant excitation
(q:p) characterizes a process involving conversion
between pdrive excitations and qresonant
excitations
Kn n-th order coefficient of Kerr-like term in the
effective Hamiltonian
Ωq,p coupling strength in a ( q:p) process52
Ω(k)
q,p coupling strength in a ( q:p) process under
perturbative expansion to k-th order
Ωsqz squeezing strength (= Ω 2,1)
Amax maximum action enclosed by an energy well
in the semiclasscial metapotential
Z a general variable in the additive map of
frame transformation
Z, ζ slow and fast dynamics of the variable Z
ˆS generator of an exponential map of frame
transformation
L˜S={ {˜S,·} }Lie derivative with respective to phase-space
function ˜S
Multi-tone, multi-mode system
ωk natural frequency of mode k
ω′
k frequency of rotating frame for mode k
δk bare detuning for mode k(=ωk−ω′
k)
λk phase participation ratio of kmode k
pk energy participation ratio of mode k
ξl effective drive amplitude of drive tone l
ωd,l frequency of drive tone l
φk zero-point spread of phase contributed by
mode k
ˆc,ˆc†bosonic operators of cavity-like mode
ˆC,ˆC bosonic operators of cavity-like mode in the
transformed frame
Km,n energy renormalization coefficient of the
ˆAnˆA†nˆCmˆC†mterm in a 2-mode problem
χ cross-Kerr between qubit-like and cavity-like
mode in a 2-mode problem
α coherent state complex amplitude in Sec-
tion VI B
¯n coherent state photon number (= |α|2)
Dissipative dynamics
ˆHtot Hamiltonian of the driven oscillator and the
thermal bath
ˆHs Hamiltonian of the driven oscillator
ˆHb Hamiltonian of the thermal bath
ˆHsb Hamiltonian of the oscillator-bath coupling
ˆbω,ˆb†
ω bosonic operators for frequency- ωbath mode
ˆρs density matrix operator of the oscillator
ˆKtot effective Hamiltonian of the oscillator and
thermal bath
ˆKs effective Hamiltonian of the oscillator
ˆKsb effective oscillator-bath coupling
hω oscillator-bath coupling strength
ˆC(t) effective oscillator coupling operator
ˆCωj Fourier component of ˆC(t) at frequency ωj
¯nωj thermal photon number at ωjD[ˆO] Lindblad superoperator over loss operator ˆO
Josephson circuits
EC charging energy
EJ Josephson energy
EL inductive energy
Ng gate offset charge
φext reduced external flux
E′
J Josephson energy of each junction in an array
shunt
M junction number in an array shunt
R ratio between ELandEJ
α anharmonicity in Sections VI C and VI D
ˆN Cooper pair number operator
ˆφ phase operator
Nzps, φzps zero-point spread of ˆNand ˆφ
Ed drive energy
ˆUIST potential operator of an IST circuit
Floquet analysis of multiphoton resonance
|i⟩ i-th Fock state
Ei energy of i-th Fock state dressed by the renor-
malization term
ϵi eigenenergy of i-th state in the effective
Hamiltonian
|˜i⟩ the eigenstate of the effective Hamiltonian
that is associated with the i-th Fock state
˜Ei renormalized energy of i-th driven state in lab
frame
|˜iF⟩ Floquet state associated with the i-th Fock
state
ϵF
i quasienergy of i-th Floquet state
Ωk↔k+q,p Hamiltonian coupling strength between k-
th and k+q-th states mediated by qdrive
photons
ΩR
k↔k+q,p Rabi rate between k-th and k+q-th states
mediated by qdrive photons
Ωpara strength of some parametric process
Pi→ weight of leaving i-th Fock state
Classical Duffing oscillator
ν dimensionless drive frequency
γ damping rate
xlin linear response of the position coordinate to
the drive
xs steady state of position coordinate ˜ x
˙xs steady state of the velocity dt˜x
As steady state of complex coordinate ˜A
(r, θ) polar coordinate of steady state in phase
space53
ρ=r2square of the amplitude of the steady state
coordinate
L, R left- and right-hand side of the steady state
equation
Appendix C: Frame Transformation
To prepare the Hamiltonian Eq. (7) for the perturba-
tive analysis, we perform two-step frame transformations.
The first one is a displacement transformation generated
byˆUD= exp( α∗
linˆa−αlinˆa†) where
αlin(t) =Ωd
21
ωd−ωoe−iωdt−1
ωd+ωoeiωdt
(C1)
is the linear response of the oscillator to the drive. Under
this transformation, the Hamiltonian transforms to
ˆH′=ˆUDˆHˆU†
D−iℏˆUD∂tˆU†
D (C2)
=ωoˆa†ˆa+X
m≥3
m∈Ngm
m(ˆa+ ˆa†+ξe−iωdt+ξ∗eiωdt)m,
(C3)
where ξ=Ωdωa
ω2o−ω2
d. If we focus on the nonlinear terms in
Eq. (C3), this transformation, which is defined as ˆ a→
ˆa+αlin(t), amounts to ˆ a→ˆa+ξe−iωdt. Note that, in
the case that the oscillator is driven through momentum
degree of freedom by −iΩd(ˆa−ˆa†) cosωdt, such as in
Eq. (99), the linear response should be modified as
αlin(t) =iΩd
21
ωd−ωoe−iωdt+1
ωd+ωoeiωdt
,(C4)
and the Hamiltonian in the displaced frame has the same
form as Eq. (C3) but with modified ξ=iΩdωd
ω2
d−ω2o. In ad-
dition to the displaced frame transformation, we further
perform a rotating frame transformation to Eq. (C3) gen-
erated by ˆUR= exp( −iω′
oˆa†ˆa) and the resulting Hamil-
tonian is Eq. (8).
We also note that the displacement transformation
can alternatively be absorbed into the quantum har-
monic balance (QHB) procedure developed in Section III.
Specifically, we consider the Hamiltonian Eq. (7) underthe rotating frame transformation generated by ˆUR:
ˆH′′=δˆa†ˆa+X
m≥3
m∈Ngm
m(ˆae−iω′
ot+ ˆa†eiω′
ot)m
+ Ωd(ˆae−iω′
ot+ ˆa†eiω′
ot) cos( ωdt),(C5)
where δ=ωo−ω′
o. Instead of starting with Eq. (8), we
can perform QHB over Eq. (C5) directly. In particular,
in the Husimi Q phase space, we seek for a frame trans-
formation ˜ a=˜A+ ˜σ+ ˜µand the equation of motion
dt˜a=−{ {˜a,˜H′′} }correspondingly reads
∂˜A∗˜K+i∂t˜µ=X
m≥3gmeiωot
(˜A+ ˜σ+ ˜µ)e−iωot
+ (˜A∗+ ˜σ∗+ ˜µ∗)eiωotm−1
›
+eiω′
otΩd
2(e−iωdt+eiωdt)
+δ(˜A+ ˜σ+ ˜µ) +i{ {˜K,˜σ+ ˜µ} }˜A,˜A∗.
(C6)
The QHB is to find ∂˜A∗˜K,˜σand ˜µorder by order in the
perturbative parameter qzps. Here we assume ˜ µto be
nonzero at order q0
zps, in stead of being zero in Eq. (18),
and assign order q0
zpsto Ω d. As a result, Eq. (C6) to
leading order reads
∂˜A∗˜K(0)+i∂t˜µ(0)=eiω′
otΩd
2(e−iωdt+eiωdt).(C7)
By construction ∂˜A∗˜Kis time-independent and ˜ ηis time-
dependent, and therefore at this order we have
∂˜A∗˜K= 0, (C8a)
e−iω′
ot˜µ(0)=Ωd/2
ωd−ω′oe−iωdt+Ωd/2
−ωd−ω′oeiωdt.(C8b)
We recall that, according to Eq. (24), the diagrammatic
representation of e−iω′
ot˜µis the off-resonant excitation
. Therefore Eq. (C8b) is just two off-resonant exic-
tations at order q0
zps: both are of strength Ω d/2, and each
is at frequency ±ωdand with propagator 1 /(±ωd−ω′
o),
respectively. It should be noted that the linear response
αlinin Eq. (C1) is the just e−iω′
ot˜η(0)but with dressed
propagator 1 /(±ωd−ωo) defined by Eq. (42). At next or-
der, both of these two dressed off-resonant excitations can
travel into or away from a mixer (c.f. Eq. (24)). In this
sense, ξe−iωdtin Eq. (C3) is just the combination of the
off-resonant excitation at ωdtraveling into the mixer and
the one at −ωdtraveling away (whose algebraic expres-
sion is the conjugate of the second term in Eq. (C8b)),
which two have the same effect of adding frequency ωd
to the mixing process.54
Appendix D: Proof of ∂˜a∗(˜a+ ˜a∗)m
›=m(˜a+ ˜a∗)m−1
›
Our goal is to prove that chain rule applies to the expression (˜ a+ ˜a∗)m
›, i.e.
∂˜a∗(˜a+ ˜a∗)m
›=m(˜a+ ˜a∗)m−1
›. (D1)
To show this, we first invoke the following identity:
(α˜a+β˜a∗)m
›=mX
k=0m
k
αm−kβkmin ( k,m−k)X
j=01
2jj!k
jm−k
j
ℏj˜a∗k−j˜am−k−j(D2)
From Eq. (D2), we have
∂˜a∗(˜a+ ˜a∗)m
›
=mX
k=1m!
k!(m−k)!min ( k−1,m−k)X
j=0j!
2jk!
j!(k−j−1)!(m−k)!
(m−k−j)!j!ℏj˜a∗k−j−1˜am−k−j.(D3)
Redefining the index kasl=k−1, we arrive at
∂˜a∗(˜a+ ˜a∗)m
›
=mm−1X
l=0(m−1)!
K!(m−1−l)!min ( l,m−1−l)X
j=01
2jj!l!
j!(l−j)!(m−1−l)!
(m−1−l−j)!j!
ℏj˜a∗l−j˜am−1−l−j
=mm−1X
l=0m−1
lmin ( l,m−1−l)X
j=01
2jj!l
jm−1−l
j
ℏj˜a∗l−j˜am−1−l−j
=m(˜a+ ˜a∗)m−1
›.(D4)
Q.E.D.
Appendix E: Quantum Harmonic Balance as a
Refined Averaging Method
The quantum harmonic balance (QHB) expansion de-
veloped in Section III is inspired by a general class of
perturbative theory known as averaging methods, but it
also includes important improvement to such approach.
In this section, we discuss the relationship between them
in more detail.
Firstly, we note that the shared theme of the aver-
aging methods is to decompose the dynamics of some
physical object Z=Z+ζ(Z,cZ, t) associated with a
driven system into some slow dynamics captured by Z
and micromotion captured by ζ(Z,cZ, t), wherecZis the
conjugate variables to Z[21]. To achieve this separation
of time-scales, these methods follow an iterative proce-
dure operating on the EOM over Zsimilar to that in
the specific case of the QHB operating on the Heisenberg
EOM Eq. (15) over Z= ˜a. Other examples of averaging
methods include the well-established Krylov-Bogoliubov
(KB) method [23–26], which analyzes the Hamilton EOM
over the classical position coordinate Z= ˜q; the secular
averaging theory [66], which analyzes the Liouville EOMover the density matrix Z= ˆρ; and the higher-order RWA
method [27], which analyzes the Schr¨ odinger EOM over
the wave function Z=|ψ⟩.
It is important to recognize that the QHB expan-
sion provides a novel perspective for treating Z=Z+
ζ(Z,cZ, t) as a frame transformation, whereas conven-
tional averaging methods merely treat it as an ansatz for
the EOM. This modification is crucial in developing a
simple diagrammatic description as well as eliminating
errors in the QHB. To demonstrate this, we note that
when taking the time derivative of the specific function
ζ(Z,cZ, t) = ˜σ(˜A,˜A∗) + ˜µ(˜A,˜A∗, t) associated with the
QHB, a conventional averaging method, such as the KB
method, will simply apply the chain rule and obtain:
dt(˜σ+ ˜µ) =∂t˜µ+∂˜A(˜σ+ ˜µ)dt˜A+∂˜A∗(˜σ+ ˜µ)dt˜A∗.
(E1)
Although this treatment appears proper and is indeed
correct for the classical system, it is incorrect for the
quantum phase-space functions ˜ σ(˜A,˜A∗) and ˜ µ(˜A,˜A∗, t)
in which the bosonic coordinates ˜A,˜A∗are related by
non-commutative Husimi bracket. To correctly derive
the time-derivative of ˜ σ+ ˜µand, more importantly, to55
make such an expression diagram-compatible, it is crucial
to treat ˜ a=˜A+ ˜σ+ ˜µas a canonical frame transforma-
tion. The Heisenberg EOM over ˜ η(˜A,˜A∗, t) consequently
reads
dt(˜σ+ ˜µ) =∂t˜µ− { {˜K,˜σ+ ˜µ} }, (E2)
where ˜Kis the effective Hamiltonian governing ˜A. Not-
ing that −{ {˜K,˜σ+˜µ} }=∂˜A(˜σ+˜µ)dt˜A+∂˜A∗(˜σ+˜µ)dt˜A∗+
O(ℏ), we observe that Eq. (E1) obtained from conven-
tional averaging methods introduces an error at order
O(ℏ) and will result in an erroneous EOM, which differs
from Eq. (15), the EOM that QHB aims to solve.
In addition, the conventional averaging procedure does
not always leads to a canonical transformation. In par-
ticular, the averaging procedure solving the EOM over
Zinvolves iteratively constructing ζfrom ∂tζ, which
leaves the time-independent part Sta( ζ) unconstrained.
While Sta( ζ) seems to be a gauge free to vary, a generic
Sta(ζ) does not necessarily ensure that the transforma-
tion Z→ Z +ζis canonical. Most averaging meth-
ods do not address this potential issue on canonicity di-
rectly, as their iterative procedures are self-consistent by
design. Consequently, some methods, such as the Krylov-
Bogoliubov (KB) method [23–26] and the secular averag-
ing method [66], are canonical without explicit enforce-
ment. In contrast, methods like the higher-order Rotat-
ing Wave Approximation (RWA) [27] and a modified KB
method [28] are not canonical.
The QHB method goes a step further by carefully con-
structing ˜ σ, which corresponds to Sta( ζ) in the generic
averaging method, to ensure that the resulting frame
transformation ˜ a→˜A+ ˜σ+ ˜µis canonical. This is
achieved by demanding the frame transformation ˜ a→
˜A+ ˜σ+ ˜µin the additive form to be re-expressed as an
exponential map ˜ a→eL˜S˜Agenerated by a real function
˜S(c.f. Eq. (13)). In Appendix F we will formally prove
the equivalence between the additive and exponential
forms of the frame transformation underlying the USH
method. This enforcement on canonicity also constitutes
as an improvement to the general averaging method. In
Appendix G, we will also adopt this procedure to mod-
ify the Brillouin-Wigner perturbation method to make it
canonical.
Appendix F: Equivalence between the additive and
exponential forms of the frame transformation
underlying USH
To ensure the canonicity of the USH method, we
have assumed that the additive frame transformation
˜a→˜A+ ˜σ(˜A,˜A∗) + ˜µ(˜A,˜A∗, t) can be equivalently
expressed as an exponential map ˜ a→eL˜S˜A, where
L˜S˜f={ {˜S,˜f} }is the Lie derivative with respective to
˜S. In this section, we rigorously prove the equivalence
of the frame transformation in these two representations.
For the ease of understanding, we choose to prove suchequivalence in the more widely-used Hilbert space asso-
ciated with the Lie derivative is LˆSˆf= [ˆS,ˆf]/iℏ. These
two formulations are isomorphic to each other and the
following proof will only rely on the properties of their
shared Lie algebraic structure [21]. Moreover, we define
˜η(˜A,˜A∗, t) = ˜σ(˜A,˜A∗) + ˜µ(˜A,˜A∗, t) for the sake of con-
ciseness.
In Hilbert space, the first representation of the frame
transformation is the additive form ˆ a→ˆA+ ˆη. This
frame transformation is constructed by solving the equa-
tion of motion Eq. (14), which we can rewrite as follows:
1
iℏ[ˆK,ˆA]−∂tˆη+1
iℏ[ˆK,ˆη]
=1
iℏ[ˆH(ˆA+ ˆη,ˆA†+ ˆη†, t),ˆA+ ˆη].(F1)
Here ˆH(ˆa,ˆa†, t) is the time-dependent Hamiltonian de-
scribing the driven system of interest and ˆK(ˆA,ˆA†) is
the time-independent effective Hamiltonian we solve for.
The second representation of the frame transformation in
Hilbert space is an exponential map ˆ a→e−ˆS/iℏˆAeˆS/iℏ.
With the conventional Schrieffer-Wolff expansion[21, 30],
it is known that one can find a time-independent Hamil-
tonian
ˆK′=eˆS/iℏ(ˆH(ˆA,ˆA†, t) +iℏ∂t)e−ˆS/iℏ(F2)
with a generator ˆSthat is hermitian and purely rotating.
To prove the equivalence of these two representations, it
is sufficient to prove the equivalence of ˆKthat solves
Eq. (F1) and ˆK′defined by Eq. (F2) provided that ˆ η
andˆSare related by
ˆA+ ˆη(ˆA,ˆA†, t) =eˆS/iℏˆAe−ˆS/iℏ, (F3)
which is just Eq. (19).
Proof :
To prove the equivalence of ˆKand ˆK′, we rewrite
Eq. (F1) as follows:
1
iℏ[ˆK,ˆA]−∂tˆη+1
iℏ[ˆK,ˆη]
=1
iℏ[ˆH(ˆA+ ˆη,ˆA†+ ˆη†, t),ˆA+ ˆη],(F4)
⇕Eq. (F3)
1
iℏ[ˆK,ˆA]−∂tˆη+1
iℏ[ˆK,ˆη]
=1
iℏ[eˆS/iℏˆH(ˆA,ˆA†, t)e−ˆS/iℏ,ˆA+ ˆη],
(F5)
⇕Eq. (F2)
1
iℏ[ˆK,ˆA+ ˆη]−∂tˆη=1
iℏ[ˆK′−iℏeˆS/iℏ∂te−ˆS/iℏ,ˆA+ ˆη],
(F6)56
Note that in writing the right-hand side of Eq. (F5), we
have also employed the identity of unitary transformation
ˆf(eˆS/iℏˆAe−ˆS/iℏ, eˆS/iℏˆA†e−ˆS/iℏ) =eˆS/iℏˆf(ˆA,ˆA†)e−ˆS/iℏ.
Now we can express the task of proving ˆK=ˆK′as prov-
ing the equation:
∂tη= [eˆS/iℏ∂te−ˆS/iℏ,ˆA+ ˆη], (F7)
which becomes apparent from Eq. (F6).
To prove this equation, we begin by writing:
∂tη=∂t(eˆS/iℏˆAe−ˆS/iℏ−ˆA)
=∂t(eˆS/iℏˆAe−ˆS/iℏ)
= (∂teˆS/iℏ)ˆAe−ˆS/iℏ+eˆS/iℏˆA(∂te−ˆS/iℏ)
= (∂teˆS/iℏ)e−ˆS/iℏeˆS/iℏˆAe−ˆS/iℏ
+eˆS/iℏˆAe−ˆS/iℏeˆS/iℏ(∂te−ˆS/iℏ)
= (∂teˆS/iℏ)e−ˆS/iℏ(ˆA+ ˆη)
+ (ˆA+ ˆη)eˆS/iℏ(∂te−ˆS/iℏ)
=−eˆS/iℏ(∂te−ˆS/iℏ)(ˆA+ ˆη)
+ (ˆA+ ˆη)eˆS/iℏ(∂te−ˆS/iℏ), (F8)
where we used the product rule and the fact that
∂t(eˆS/iℏe−ˆS/iℏ) = (∂teˆS/iℏ)e−ˆS/iℏ+eˆS/iℏ∂te−ˆS/iℏ= 0.
Equation Eq. (F8) can be further simplified to:
∂tη= [eˆS/iℏ∂te−ˆS/iℏ,ˆA+ ˆη],
which is equivalent to Eq. (F7). This completes the proof.
Lastly, having demonstrated that the frame trans-
formation constructed using QHB constitutes a unitary
transformation in the Hilbert space, we can conclude that
the effective Hamiltonian ˜Kis a real function. Therefore,
we have established the validity of all the assumptions
made in Section III when formulating the QHB expan-
sion.
Appendix G: A self-consistent reformulation of
Rayleigh-Schr¨ odinger perturbative expansion
In this section, we reformulate the well-established
Rayleigh-Schr¨ odinger (RS) non-degenerate perturbative
expansion in a self-consistent form inspired by the USH
method developed in Section III. Such reformulation will
(1) allow for a more intuitive interpretation of the RS
expansion, (2) bridge the RS expansion to another well-
established perturbative method, the Brillouin-Wigner
expansion, (3) lead to a diagrammatic method to carry
out the RS expansion, and (4) lead to a conjecture on
the equivalence between the RS expansion and the char-
acteristic equation of a Hamiltonian matrix.1 A brief review on the Rayleigh-Schr¨ odinger
non-degenerate perturbation theory
For the Hamiltonian
ˆH=ˆH0+ϵˆV (G1)
where ϵ= 1 is there only to keep track of the expan-
sion, the Rayleigh-Schr¨ odinger perturbation theory seeks
to find the perturbative effect of ˆVon the eigen-spectrum
and eigenstates of ˆHrelative to those of ˆH0. To achieve
this, it assumes that the eigenstate |n⟩ofˆHcan be ex-
pressed as
|n⟩=|n(0)⟩+ϵ|n(1)⟩+ϵ2|n(2)⟩+··· (G2)
where |n(0)⟩is the eigenstate of ˆH0, i.e.
ˆH0|n(0)⟩=E(0)
n|n(0)⟩. (G3)
Similarly, the eigenenergy Enassociated with |n⟩is as-
sumed to be
En=E(0)
n+ϵE(1)
n+ϵ2E(2)
n+··· (G4)
With this, the time-independent Schro¨ odinger equation
associated with Eq. (G1) is
(ˆH0+ϵˆV)(|n(0)⟩+ϵ|n(1)⟩+···)
= (E(0)
n+ϵE(1)
n+···)(|n(0)⟩+ϵ|n(1)⟩+···)
(G5)
One then can solve Eq. (G5) iteratively at each order
with the constraint
⟨n|n⟩= 1, (G6)
which ensures the proper normalization of the perturbed
states.
As a result, the leading order corrections of the
eigenenergy and eigenstates respectively read
E(1)
n=⟨n|V|n⟩, (G7)
E(2)
n=X
k̸=n
k(0)Vn(0)2
E(0)
n−E(0)
k, (G8)
|n(1)⟩=X
k̸=nk(0)E
k(0)Vn(0)
E(0)
n−E(0)
k, (G9)
|n(2)⟩=X
k̸=nX
ℓ̸=nk(0)E
k(0)Vℓ(0)
ℓ(0)Vn(0)

E(0)
n−E(0)
k
E(0)
n−E(0)
ℓ
−X
k̸=nk(0)E
k(0)Vn(0)
n(0)Vn(0)

E(0)
n−E(0)
k2
−1
2n(0)EX
k̸=n|
k(0)Vn(0)
|2

E(0)
n−E(0)
k2
(G10)
2 R-S method as an operator perturbation
theory57
a. Problem setup
We now reformulate the RS expansion in the language
of the operator perturbation method. We first remark
that, in the eigenbasis of ˆH0, the Hamiltonian ˆHis a
matrix whose off-diagonal entries only perturbatively cor-
rect the diagonal ones, which are E(0)
0, E(0)
1, .... In this
language, the goal of RS expansion can be thought as
seeking for a frame transformation
|ψ⟩ → | φ⟩ (G11)
such that the transformed Hamiltonian
ˆH→ˆK (G12)
is a diagonal matrix. Similar to Eq. (12), we can relate
the transformed quantities to their counterparts in the
original frame as
|ψ⟩=|φ⟩+ ˆσ|φ⟩+ ˆµ|φ⟩, (G13)
ˆK=ˆH0+ˆKI, (G14)
where ˆ σis assumed to be a diagonal matrix, ˆ µis a purely
off-diagonal matrix, and ˆKI— the rationale for this nota-
tion will become apparent shortly – is a diagonal matrix
that perturbatively corrects ˆH0. We note that Eqs. (G13)
and (G14) are just a matrix representation of Eqs. (G2)
and (G4). Moreover, to ensure the proper normalization
of the transformed state, which in turn guarantees the
canonicity of the sought-after transformation, Eq. (G6)
translates to the constraint as
(1 + ˆσ†+ ˆµ†)(1 + ˆ σ+ ˆµ) = 1 . (G15)
In other words, the change of basis matrix 1 + ˆ σ+ ˆµis
unitary.
To find the the transformation, i.e. ˆ σ,ˆµ, and ˆKI, and
relate the ordinary perturbation theory to the operator-
valued one, it is convenient, yet not necessary36, to go to
the interaction picture37generate by ˆH0. In such picture,
Eqs. (G13) and (G14) translates to
|ψ(t)⟩ → | ψI⟩=|φI⟩+ ˆσ|φI⟩+ ˆµI(t)|φI⟩, (G16)
ˆK→ˆKI. (G17)
Note that, in Eq. (G16), the diagonal matrix ˆ σis left
unchanged in the interaction picture while the purely
off-diagonal matrix ˆ µgains time-dependence. This is
36One can derive the results below without going to the interaction
picture. Yet such derivation involves inverse operation of commu-
tator, which could be obscure to readers not familiar with such
operation. Going into the interaction translates such operation
to time-integration.
37Here we assume that ˆVis purely off-diagonal. For the case that
ˆVcontains non-zero diagonal terms, they can be absorbed into
ˆH0.because the generator of the interaction picture ˆH0is
diagonal. Indeed, in the interaction picture, all the di-
agonal entries in a matrix, such as those in ˆ σIand ˆKI,
remains time-independent while the off-diagonal entries
transforms as
ˆOmn→ˆOmne(E(0)
n−E(0)
m)t/iℏ(G18)
where ˆOmnis the entry at row mand column nof an
operator ˆOin the lab frame.
b. A self-consistent representation
In the interaction picture, the system of interest be-
haves like a time-dependent driven system. We are now
ready to carry out the averaging procedure associated
with the operator perturbation theory over the time-
dependent Schr¨ odinger equation governing |ψI⟩and|φI⟩
iℏ∂t|ψI⟩=ϵˆVI|ψI⟩, (G19)
iℏ∂t|φI⟩=ˆKI|φI⟩. (G20)
Plugging Eq. (G16) into Eq. (G19), we get
(1 + ˆσ)iℏ∂t|φI⟩+iℏ(∂tˆµI(t))|φI⟩+iℏˆµI(t)∂t|φI⟩
=ϵˆVI(t)(1 + ˆ σ+ ˆµI(t))|φI⟩.
(G21)
By further plugging in Eq. (G20), we get
(1+ˆσ)ˆKI+iℏ∂tˆµI(t) + ˆµI(t)ˆKI=ϵˆVI(t)(1+ˆ σ+ˆµI(t)).
(G22)
Therefore, the goal of the perturbation treatment now
translates to solving Eq. (G22) under the constraints that
ˆKIand ˆσbeing diagonal (time-independent), ˆ µI(t) be-
ing purely off-diagonal (time-dependent), and that the
transformation is canonical, i.e.
(1 + ˆσ†+ ˆµ†
I(t))(1 + ˆ σ+ ˆµI(t)) = 1 . (G23)
Eq. (G22) is tedious to solve as it is. To better il-
lustrate its structure and physical significance, we in-
troduce two composite variables, which allow to break
down Eq. (G22) into a few simpler self-consistent equa-
tions. This is similar to the change of variables in the
QHB method discussed in Eq. (G24). Specifically, we
introduce
ˆµ′
I(t) = ˆµI(t)(1 + ˆ σ)−1, (G24a)
ˆM′
I(t) =iℏ∂tˆµ′
I(t) + ˆµ′
I(t)ˆKI (G24b)
With these new variables, Eq. (G22) can be rewritten
as
ˆKI+ˆM′
I=ϵˆVI(t) +ϵˆVI(t)ˆµ′
I(t) (G25a)
ˆµ′
I(t) =1
iℏZ
dt
ˆM′
I(t)−ˆµ′
I(t)ˆKI
(G25b)58
with the constrain that ˆKI,ˆσbeing diagonal while ˆM′
I(t)
and ˆµI(t) being purely off-diagonal. Note that by writing
Eqs. (G25a) and (G25b) we have used the fact that ˆKI
and 1 + ˆ σ, which are both diagonal matrices, commute.
This is a special properties for the ordinary perturbation
problem where the transformed Hamiltonian ˆKis diag-
onal, while, for more general cases of applying averaging
procedure over driven systems, such simplification is not
always possible.
Besides Eqs. (G25a) and (G25b), the canonicity con-
straint Eq. (G23) can also be rewritten in the new vari-
ables in Eq. (G24). With a few lines of algebra, we can
get a simple expression
1 + ˆσ=
1 + Sta
ˆµ′†
I(t)ˆµ′
I(t)−1
2(G25c)
where Sta( ˆO) here means taking the static, thus the di-
agonal, part of a given matrix ˆO. Similarly, another no-
tation that will be used shortly is Rot( ˆO), which takes
the rotating, thus off-diagonal, part of a given matrix ˆO.
Eqs. (G25a) and (G25b) are two simple self-consistent
equations that express ˆKI,ˆM′
I(t),and ˆµ′
I(t) on the left-
hand side of the equations as a function of themselves
or other quantities on the right-hand side. In addition,
Eq. (G25c) expresses ˆ σin terms of ˆ µ′. By iteratively sub-
stituting these equations into the right-hand side of them-
selves, we can obtain the expressions for ˆKI,ˆM′
I(t),ˆµ′
I(t)
and ˆσat each order of the perturbative parameter ϵ. For
example, to leading order we have
ˆK(1)
I= Sta
ϵˆVI(t)
= 0,
ˆM′(1)
I(t) = Rot
ϵˆVI(t)
,
ˆµ′(1)
I(t) =1
iℏZ
dtˆM′(1)
I(t),
ˆσ(1)= 0,
and at order 2 we have
ˆK(2)
I= Sta( ϵˆVI(t)ˆµ′(1)
I(t)),
ˆM′(2)
I(t) = Rot( ϵˆVI(t)ˆµ′(1)
I(t)),
ˆµ′(2)
I(t) =1
iℏZ
dt
ˆM′(2)
I(t)−ˆµ′(1)
I(t)ˆK(1)
I
=1
iℏZ
dtˆM′(2)
I(t),
ˆσ(2)=−1
2Sta
ˆµ′†(1)
I(t)ˆµ′(1)
I(t)
.
c. Physical significance
The self-consistent equations in Eq. (G25) are not only
simple but also allow for meaningful physical interpreta-
tion, which we now discuss.We first comment on Eq. (G25b):
ˆµ′
I(t) =1
iℏZ
dt
ˆM′
I(t)−ˆµ′
I(t)ˆKI
which defines the relationship between the off-diagonal
matrices ˆM′
I(t) and ˆ µ′
I(t). As discussed in Eq. (G18), we
denote the m-th row and n-th column entry in ˆM′
I(t) as
ˆM′
I,mn =M′
I,mne(E(0)
n−E(0)
m)t/iℏ. (G26)
Noting that ˆKIis diagonal by definition, we can write
each entry in ˆ µ′
I(t) as
ˆµ′
I,mn =M′
I,mn
E(0)
n−E(0)
me(E(0)
n−E(0)
m)t/iℏ−1
iℏZ
dtˆµ′
I,mnˆKI,nn
(G27a)
=M′
I,mn
E(0)
n−E(0)
m−M′
I,mnKI,nn
(E(0)
n−E(0)
m)2+M′
I,mnK2
I,nn
(E(0)
n−E(0)
m)3
−M′
I,mnKI,nn
(E(0)
n−E(0)
m)2+···)e(E(0)
n−E(0)
m)t/iℏ(G27b)
=M′
I,mn
E(0)
n+KI,nn−E(0)
me(E(0)
n−E(0)
m)t/iℏ(G27c)
=1
En−E(0)
mˆM′
I,mn (G27d)
In writing Eq. (G27b), we have iteratively substituted
ˆµ′
I,mnon the right-hand side of Eq. (G27a) by Eq. (G27a)
itself. Then, by identifying that Eq. (G27b) is a Taylor
series of a/(1 + x) type of function, in Eq. (G27c) we
resum the series to it original form. Finally, in writing
Eq. (G27d), we have used the identity that En=E(0)
n+
KI,nn, where Enis the exact eigenenergy of ˆH(orˆK
defined in Eq. (G14)) associated with state indexed n.
For convenience, we can also introduce a matrix ˆPH
defined as
ˆPH,mn =

1
En−E(0)
mforn̸=m
0 for n=m(G28)
and thus Eq. (G27) can be rewritte as
ˆµ′
I=ˆPH◦ˆM′
I, (G29)
where ◦is the Hadamard product (element-wise multi-
plication) between matrices. Note that the subscript in
ˆPHdenotes that the specific construction of ˆPHis deter-
mined by ˆH.
Eq. (G29) gives a very simple relation between ˆM′
I(t)
and ˆµ′
I(t), where each entry ( m, n) in the latter dif-
fers from its counterpart by a fraction, which can be
interpreted as a “propagator” associated with a de-
tuned coupling. The denominator of the propagator is
the “dressed” energy difference between the responding59
states — specifically, the difference between the perturbed
energy associated with state mand the unperturbed en-
ergy associated with state n.
Now we move to discuss Eq. (G25a)
ˆKI+ˆM′
I(t) =ϵˆVI(t) +ϵˆVI(t)ˆµ′
I(t).
With Eq. (G29) that gives a simple relation between
ˆM′
I(t) and ˆ µ′
I(t), the above equation should be under-
stood as a self-consistent expression for ˆKIand ˆM′
I(t)
(or ˆµ′
I(t)) under the constraint that the former is diago-
nal and the latter is purely off-diagonal. In other words,
ˆKIcorresponds to the diagonal (time-independent) com-
ponents of the right-hand-side of Eq. (G25a), while ˆM′
I(t)
corresponds to the off-diagonal (time-dependent). There-
fore, we have
ˆM′
I=ϵˆVI+ Rot
ϵˆVIˆµ′
I
(G30)
Plugging in Eq. (G29), we get the simple self-consistent
expression for ˆ µ′
Ias
ˆµ′
I=ˆPH◦ϵˆVI+ˆPH◦
ϵˆVIˆµ′
I
(G31a)
=ϵˆPH◦ˆVI+ϵ2ˆPH◦
ˆVI
ˆPH◦ˆVI
+ϵ3ˆPH◦
ˆVI
ˆPH◦
ˆVI
ˆPH◦ˆVI
+···(G31b)
where Eq. (G31b) is obtained from Eq. (G31a) by it-
eratively substituting the ˆ µ′
Ion the right-hand side by
Eq. (G31a) itself. Also note that in these expressions
we have dropped Rot because the definition of ˆPHin
Eq. (G28) ensures that the static (i.e. diagonal) term is
zero in the Hadmard product of ˆPHand another matrix.
Likewise, ˆKIcan be expressed as
ˆKI= Sta
ϵˆVIˆµ′
I
(G32a)
=ϵ2Sta
ˆVI
ˆPH◦ˆVI
+ϵ3Sta
ˆVI
ˆPH◦
ˆVI
ˆPH◦ˆVI
+···
(G32b)
One can compare Eqs. (G31) and (G32) with the
Brillouin-Wigner (BW) perturbative expansion and eas-
ily see that they are equivalent to those in the latter.
Therefore, we have shown the equivalence between the
RS expansion and the BW expansion. Moreover, a prob-
lem associate with BW expansion is that the frame un-
derlying it, which corresponds to |ψ⟩ → (1 + ˆ µ′)|φ⟩, is
not canonical [67]. This is evident from the fact that
|ψ⟩ → (1 + ˆ σ)(1 + ˆ µ′)|φ⟩constitutes a canonical trans-
formation for non-zero ˆ σin Eq. (G25c). In other words,
in the derivation above, we have also found a transfor-
mation (1 + ˆ σ) defined by Eq. (G25c) that will make the
BW expansion canonical.
FIG. 15. An example of ˆHand the paths representing con-
tributions to ˆKIand ˆµ′
I. There are two red paths ( e0→e2
ande1→e4→e3) and two blue paths ( e0→e1→e0and
e0→e3→e2→e4→e1→e0).
In addition, the expressions for ˆ µ′
Iand ˆKIin
Eqs. (G31b) and (G32b) allows them to be represented
diagrammatically as the “paths” in ˆH. Intuitively speak-
ing, they can be thought as paths containing multiple
segments each stemming from a ˆVfactor and associated
with some propagator stemming from ˆPH.
We take a ˆHshown in Fig. 15 as an example, where the
diagonal entries en’s are unperturbed eigenenergy and
off-diagonal terms Vmnare the perturbation. On top of
the matrix we draw blue and red paths to represent con-
tributions to ˆKIand ˆµ′
Iin Eq. (G32b) and Eq. (G31b),
respectively. Each path has a starting point, denoted by
an open circle, and one or multiple stops, denoted by solid
circles. Both the starting point and the stops are in the
diagonal entries. A starting point, or a stop, is connected
to another stop by a counter-clockwise directional edge
that travels only horizontally or vertically and takes one
left turn at the off-diagonal entry that directly couples
the diagonal entries associated with the two ends of the
edge. This off-diagonal entry is the one associated with
the edge while other entries that the edge traverses are
not relevant here. Moreover, while a path can terminate
at any stop, it has to terminate when reaching a stop
at the same entry as the starting point. We color those
paths returning to the starting point by blue color and
others by red color.
Structurally, each path in Fig. 15, which constitutes of
one or more directional edges associated with some off-
diagonal entries cascaded together, resembles a term in
ˆµ′
Iand ˆKIdefined by Eqs. (G31b) and (G32b), which
constitutes of one or more ˆPHand ˆVIfactors cascaded
together. Algebraically, a path starting from the n-th
diagonal entry and end at m-th diagonal entry can be60
evaluated in a simple way so that it represents a term
contributing to entry ( m, n) in ˆµ′
I, when m̸=nin the
red paths, or in ˆKI, when m=nin the blue paths.
Specifically, a directional edge connecting the k-th di-
agonal entry to the l-th diagonal entry is evaluated as
Vlk, a stop at k’s diagonal entry for k̸=nis evaluated
as 1/(En−E(0)
k), and the path, evaluated in the inter-
action picture, is also associated with an overall phase
eE(0)
n−E(0)
mt/iℏ.
For example, the red path e0→e2in Fig. 15 is evalu-
ated as
V20
e′
0−e2e(e0−e2)t/iℏ, (G33)
where e′
mis taken as the perturbed eigenenergy associ-
ated with state m. This path corresponds to the lead-
ing order contribution the ˆ µ′
I,20. The longer red path in
Fig. 15 correspondingly contributes to ˆ µ′
I,41and is eval-
uated as
V41V34
(e′
1−e4)(e′
1−e3)e(e1−e3)t/iℏ. (G34)
Recalling the relation Eq. (G13), we recognize that the
two terms above are associated with the perturbative cor-
rection to the eigenstate of 0 and 1, each of which gains
a small contribution of the unperturbed state 2 and 3,
respectively. We will discuss this in more detail shortly.
Like the red paths, the short blue path in Fig. 15 is
evaluated as
|V10|2
e′
0−e1(G35)
and the long blue path is evaluated as
V30V23V42V14V01
(e′
0−e3)(e′
0−e2)(e′
0−e4)(e′
0−e1). (G36)
Both of the two terms above contribute to KI,00, which
represents the perturbative correction to the unperturbed
eigenenergy e0.
3 Examples
a. tridiagonal 3×3matrix
To illustrate and verify the results above and to draw
more implications from them, we first investigate a simple
example of a 3 ×3 matrix
ˆH=
e0V010
V10e1V12
0V21e2
(G37)
and compute the eigenvalue of it. From the diagram-
matic representation, the exact eigenenergy e′
0associated
(a)
(b)FIG. 16. Diagrammatic representation for the perturbed
eigenenergy associated with (a) state 0 and (b) state 1.
with state 0 can be represented by the infinite number
of paths shown in Fig. 16 (a). This series corresponds to
the algebraic expression:
e′
0=e0+|V01|2
e′
0−e1+|V01|2|V12|2
(e′
0−e1)2(e′
0−e2)
+|V01|2|V12|4
(e′
0−e1)3(e′
0−e2)2+|V01|2|V12|6
(e′
0−e1)4(e′
0−e2)3+···
(G38)
=e0+|V01|2
e′
0−e1−|V12|2
e′
0−e2, (G39)
where in writing Eq. (G39) we have resummed the series
in Eq. (G38) as a a/(1−x) type of function under the
assumption that |V12|2/(e′
0−e2)<1. Note that the pole
in Eq. (G39) is at e′
0=e1+|V12|2/(e′
0+e2). Here the
bare energy e1still gets dressed in a way but different
from its exact energy, i.e. e1+|V12|2/(e′
0+e2)̸=e′
1. The
physical significance and implications of this difference
are to be further investigated.
For the perturbed energy e′
2associated with state 2,
we can write the perturbed energy of the state 2 in the
same form as Eq. (G39):
e′
2=e2+|V12|2
e′
2−e1−|V01|2
e′
2−e0. (G40)
For the perturbed energy e′
1of the state 1, it diagram-
matically corresponds to the three paths in Fig. 16 (b),61
whose algebraic expression is
e′
1=e1+|V01|2
e′
1−e0+|V12|2
e′
1−e2. (G41)
There are two remarks to be made about this exam-
ple. First, Eqs. (G39) to (G41) are three uncoupled self-
consistent equations each only contain one unknown, e′
0,
e′
1,e′
2, respectively. If we denote the unknown of each
equation as a generic unknown, say λ, one can easily
verify that these three equations are equivalent to each
other. Indeed, they are just the re-expression of the char-
acteristic equation det( ˆH−λˆI) = 0 for ˆH, i.e.:
(λ−e0)(λ−e1)(λ−e2)− |V01|2(λ−e2)
− |V12|2(λ−e0) = 0(G42)
Interestingly, the expansion of each eigenvalue when car-
ried out to all orders contain the information of all other
eigenvalues. It can be understood as a reorganization of
the characteristic function, which is usually hard to in-
terpret and solve, to a self-consistent form that favors
one particular state.
Secondly, we remark that the expression for e′
0defined
by Eq. (G38) contains infinite number of terms, which
correspond to infinite number of paths in Fig. 16 (a),
each containing repetitive features (loops traversing e1
ande2). With resummation of these terms/paths, we
arrive at Eq. (G39) that only contains finite number of
terms. By slightly modifying the diagrammatic rules,
Eq. (G39) can similarly be represented by finite number
of paths (e.g. only the first two paths in Fig. 16). This
feature is startling from the perspective of a perturbative
theory, yet it is trivial considering the observation that
the expression for e′
0in Eq. (G39) is equivalent to the
characteristic equation of ˆH.
b. generic 3×3matrix
With the tridiagonal 3 ×3 matrix treated, we now con-
sider the generic 3 ×3 matrix
ˆH=
e0V01V02
V10e1V12
V20V21e2
(G43)
From perturbative method and the diagrammtic com-putation, we have
e′
0=e0+|V01|2
e′
0−e1−|V12|2
e′
0−e2+|V02|2
e′
0−e1−|V12|2
e′
0−e2
+V10V21V02
(e′
0−e1)(e′
0−e2)+V20V12V01
(e′
0−e2)(e′
0−e1)(G44)
e′
1=e1+|V01|2
e′
1−e0−|V02|2
e′
1−e2+|V12|2
e′
1−e2−|V02|2
e′
1−e0
+V21V02V10
(e′
1−e2)(e′
1−e0)+V01V20V12
(e′
1−e0)(e′
0−e2)(G45)
e′
2=e2+|V12|2
e′
2−e1−|V01|2
e′
2−e0+|V02|2
e′
2−e0−|V01|2
e′
2−e1
+V12V01V20
(e′
2−e1)(e′
2−e0)+V02V10V21
(e′
2−e0)(e′
2−e1)(G46)
Multiplied by the first two denominators appearing of
the the right-hand side of each equation and with some
rearrangement, the three equations above can be written
as
f(e′
0)−|V12|2
(e′
0−e1)(e′
0−e2)f(e′
0) = 0 (G47)
f(e′
1)−|V20|2
(e′
1−e0)(e′
1−e2)f(e′
1) = 0 (G48)
f(e′
2)−|V01|2
(e′
2−e0)(e′
2−e1)f(e′
2) = 0 (G49)
where
f(λ) =(λ−e0)(λ−e1)(λ−e2)−(λ−e0)|V12|2
−(λ−e1)|V02|2−(λ−e2)|V01|2
+V01V12V20+V10V21V02(G50)
Therefore, e′
0, e′
1, e′
2are the solutions for f(λ) = 0. More-
over, one can also easily verify that det( ˆH−λˆI) =f(λ)
and thus e′
0, e′
1, e′
2are the exact eigenvalues of ˆH. In
other words, Eqs. (G44) to (G46) are three self-consistent
forms of the characteristic equation det( ˆH−λˆI) = 0 for
a generic 3 ×3 matrix.
With the example of the 3 ×3 matrix treated, it is very
tempting to generalize our observations to any hermitian
Hamiltonian. Here we generalize them as conjunctures
without providing a rigorous proof.
Conjecture: The perturbative expression for the
eigenenergy of a state can be expressed as a self-
consistent equation. When carried out to all-orders, this
equation can be resummed in a ways such that it is equiv-
alent to the characteristic equation of the Hamiltonian.
Appendix H: Hamiltonian of Multimode Nonlinear
Oscillator in Normal Modes
In this section, we derive the Hamiltonian for multi-
mode systems where a nonlinear oscillator is coupled to62
FIG. 17. Schematic of a transmon (in turquoise color) capac-
itively coupled to a cavity (in brown color).
several linear oscillators. For the sake of concreteness,
we consider the system treated in Section VI B where
a transmon is capacitively coupled to a cavity mode as
shown in Fig. 17, and the procedure below apply to gen-
eral multi-mode problem in general.
The Lagrangian of the transmon-cavity system reads
L=1
2(Ca+Cg)˙Φ2
a+EJcos(φa)
+1
2(Cc+Cg)˙Φ2
a−1
2LcΦ2
c−Cg˙Φa˙Φc(H1)
=Llin+EJcos(φa) +1
2LJΦ2
a (H2)
with
Llin=1
2(Ca+Cg)˙Φ2
a−1
2LJΦ2
a
+1
2(Cc+Cg)˙Φ2
a−1
2LcΦ2
c−Cg˙Φa˙Φc,(H3)
where Φ ifori=a, cis the flux across the inductive el-
ement in the transmon and cavity modes, respectively,
φi= 2eΦi/ℏis the reduced flux, LJ=ℏ2EJ/e2is the ef-
fective linear inductance of the Josephson junction, and
each capacitance is related to the its capacitive energy,
a notion used in Figs. 2 and 9, by Ci=e2/2EC,i. In
Eq. (H2), we further separate the Lagrangian into the
linear part Llin, defined in Eq. (H3), and the nonlinear
part, i.e. the last two terms in Eq. (H2). Note that Llin
describes two LC-oscillators that are capacitively cou-
pled. Our goal now is to find the normal modes of it
following the standard procedure [22]. To do this, we
first write the equation of motion generated by Llinas
"¨Φa
¨Φc#
=C−1L"
Φa
Φc#
(H4)
where
C="
Ca+Cg−Cg
−CgCc+Cg#
,L="
1
LJ0
01
Lc#
(H5)
are the capacitance and inductance matrix. We then can
find matrix Pthat diagonalize C−1Land thus Eq. (H4)can be rewritten as
P−1"¨Φa
¨Φc#
=P−1C−1LPP−1"
Φa
Φc#
,P="
β1β2
β3β4#
,
(H6)
whereP−1C−1LPis a diagonal matrix. Written as it
is, it is easy to see that the normal modes of Llinare
"
ΦA
ΦC#
=P−1"
Φa
Φc#
. (H7)
Plugging Eq. (H7) into Eq. (H3), we get a decoupled
linear Lagrangian
Llin=1
2CA˙Φ2
A−1
2LAΦ2
A+1
2CC˙Φ2
C−1
2LCΦ2
C,(H8)
with
CA= (Ca+Cg)β2
1+ (Cc+Cg)β2
3−2Cgβ1β3
CC= (Ca+Cg)β2
2+ (Cc+Cg)β2
4−2Cgβ2β4
1
LA=β2
1
LJ+β2
3
Lc,1
LC=β2
2
LJ+β2
4
Lc.(H9)
The coupling between normal modes Φ Aand Φ Care
then completely absorbed into the nonlinear terms
EJcos(φa) +1
2LJΦ2
ainLin Eq. (H2) with Φ a=β1ΦA+
β2ΦC. With this, we write the Hamiltonian associated
withLin normal modes and get Eq. (89) as38
ˆH
ℏ=ωAˆa†
AˆaA+ωCˆa†
CˆaC−EJ
ℏ
cos ˆφa+ˆφ2
a
2
,
(H10)
where ωi=p
1/CiLiand the phase operator of each
mode is related to the bosonic ladder operators by ˆΦi=
(ℏ2Li/2Ci)1/4(ˆai+ ˆa†
i) for i=A, C. The bare phase
operator ˆ φacan be written as ˆ φa=φzps,A(ˆaA+ ˆa†
A) +
φzps,C(ˆaC+ ˆa†
C) where φzps,A=β1(4LA/CA)1/4p
e2/ℏ,
φzps,C=β2(4LC/CC)1/4p
e2/ℏare the participation of
the corresponding modes in the zero point spread of the
junction phase. We note that, for Josephson circuits,
φzps,Aandφzps,Ccan be alternatively computed [39] as
φ2
zps,i=Piℏωi/2EJ, where Pi, a design parameter of the
circuit, is the energy participation ratio of normal mode i
in the Josephson junction. The two notations are related
to each other by PA=β2
1LA/LJandPC=β2
2LC/LJ.
38For notational simplicity, in Eq. (89), we use ˆ aand ˆc, in stead of
ˆaAand ˆaC, to represent the bosonic operators in normal modes,
use lower cases a, c, instead of A, C, in the subscripts to denote
the corresponding normal modes, and use ˆ φ, instead of ˆ φa, to
denote the phase across the junction.63
Expanding the nonlinear terms in Eq. (H10), we get
the expression of the nonlinear oscillator
ˆH
ℏ=ωAˆa†
AˆaA+ωCˆa†
CˆaC+X
m>2gm
m
λA(ˆaA+ ˆa†
A)
+λA(ˆaA+ ˆa†
A)
(H11)
where gm= (−1)1+m/2ωAφm−2
zps/2(m−1)! for even mand
0 for odd m, with φzps=p
ℏωA/2EJandλ2
i=Piωi/ωA
fori=A, C.
When the circuit is capacitively driven with
drives of different frequencies, additional terms
−P
lP
i=A,CiΩi,l(ˆai−ˆa†
i) cosωd,i,ltshould be added
to Eq. (H11). Following the frame transformations in
Appendix C for each mode and each drive tone, one
will then obtain the Hamiltonian in form of Eq. (60),
which is the starting point of diagrammatic analysis on
multimode and multitone problems.
Appendix I: Computing Coupling Strength Through
the Effective Hamiltonian
In this section, we detail the analysis on the cases that
several multiphoton resonances coexist. In particular,
we consider the transmon in Fig. 5 and examine the cou-
pling between the ground and 10th excited states through
a (10 : 4) process. As discussed in Section VI C, when
this process is on resonance, nearly resonant are the cou-
pling between the ground and 7th excited state through
a (7 : 3) process and the coupling between the 7th and
10th excited state through a (3 : 1) process. Specifically,
as we will show, the coupling between the 7th and 10th
state could be comparable with the energy difference be-
tween the two state in the effective frame. Therefore,
when (10 : 4) process is on resonance, both 7th and 10th
excited states are effectively hybridized with the ground
state. This renders it insufficient to compute the effective
Hamiltonian only capturing (10 : 4) process in the effec-
tive dynamics and leaving those involving the 7th excited
state to the micromotion.
To capture all the relevant effective dynamics, we con-
struct the diagrams in the rotating frame at ω′
o= 2ωd/5
so that the diagrams associated with the coupling term
ξ4ˆA†10is static. Moreover, we also consider the diagrams
responsible for (3 : 1) and (7 : 3) process to be part of the
effective dynamics. For example, when carrying out thequantum harmonic balance, there exists two diagrams
=g4ξ˜A∗2ei(2ω′
o−ωd)t=g4ξ˜A∗2e−iωdt/5
=g10ξ3˜A∗6ei(6ω′
o−3ωd)t=g10ξ3˜A∗6e−i3ωdt/5.
(I1)
In the ordinary USH procedure discussed in Section III,
these two terms contribute to
 (˜M) in Eq. (24), i.e.
the micromotion, since they are time-dependent. Yet,
in the modified treatment here, we consider these two
terms slow-varying and pertinent to the effective dynam-
ics. Therefore, we collect these terms to
 (˜Γ) and
thus the latter becomes slow-varying. Upon integra-
tion over ˜A∗eiω′
ot, the two terms in Eq. (I1) contribute
1
3g4ξ˜A∗3eiωdt/5+ c.c.and1
7g10ξ3˜A∗7e−iωdt/5+ c.c.to
the effective Hamiltonian, which are responsible for the
(3 : 1) and (7 : 3) process, respectively. We also note
that, porvided that in the rotating frame ω′
o= 2ωd/5
the (10 : 4) process is captured by some static effective
Hamiltonian terms, if we consider the (3 : 1) process
as slow-varying, then the (7 : 3) process simultaneously
becomes slow-varying. This is because the Hamiltonian
terms responsible for the latter two process are of oppo-
site frequency and can cascade together to yield a static
process, i.e. (3 + 7 : 1 + 3) = (10 : 4).
Moreover, since terms like those in Eq. (I1) no longer
contribute to
 (˜M), they do not create off-resonant
excitations contributing to
 (˜µe−iω′
ot) that partici-
pates in higher order mixing process, either. When con-
structing diagrams at higher order, one should should
eliminate those diagrams involving such off-resonant ex-
citations. For example, in the ordinary treatment, a term
reading
=g6g8
−ωd/5−ω′o˜A∗9ξ3e−iω′
ot(I2)
will contribute to
 (˜Γ) and resulting the coupling term
in the (10 : 4) process. In the treatment that includes
(3 : 1) and (7 : 3) processes in the effective dynamics,
however, the term in Eq. (I2) does not exist either in
or
 because the off-resonant excitation involved in
Eq. (I2) is created by the second term in Eq. (I1) and
thus spurious.
Following the modified diagrams rules stated above, we64
obtain the effective Hamiltonian in Hilbert space as:
ˆK
ℏ=X
n>0KnˆA†nˆAn+ Ω 10,4ξ4ˆA†10+ Ω 3,1ξˆA†3eiωd
5t
+ Ω 7,3ξ3ˆA†7e−iωd
5t+ h.c.,
(I3)
where the exact expression of each Hamiltonian param-
eter above is obtained from the computer program [19]
with the modified procedure. This effective Hamiltonian
can be further reduced to the subspace of relevant oscil-
lator states, i.e. 0th, 3rd, 7th, and 10th Fock states, and
reads
ˆK
ℏ=
E0 Ω∗
0↔3,1e−iωd
5tΩ∗
0↔7,3eiωd
5tΩ∗
0↔10,4
Ω0↔3,1eiωd
5tE3 0 Ω∗
7↔10,3eiωd
5t
Ω0↔7,3e−iωd
5t0 E7 Ω∗
7↔10,1e−iωd
5t
Ω0↔10,4 Ω7↔10,3e−iωd
5tΩ7↔10,1eiωd
5tE10
, (I4)
where each entry is related to the parameters in Eq. (I3)
by the relation in Eq. (105). We note that, even though
the 3rd excited state is not involved in any near-resonant
process here, it should still be included in Eq. (I4) for con-
sistency. Specifically, one should understand the 3rd ex-
cited state, which is off-resonantly coupled to the ground
state and 10th excited state through the (3 : 1) and (7 : 3)
processes, respectively, as an intermediate state in the
coupling between ground and 10th excited state. This is
similar to the 7th excited state, which is off-resonantly
couple to the ground state through the (7 : 3) process
and near-resonantly couple to the 10th state through the
(3 : 1) process.
Remarkably, the slow-varying effective Hamiltonian
Eq. (I4) can be further transformed into a static one
under the unitary transformation ˆU= exp[ iωd
5(|3⟩⟨3| −
|7⟩⟨7|)t]. The resulting effective Hamiltonian reads
ˆK′
ℏ=
E0 Ω∗
0↔3,1 Ω∗
0↔7,3Ω∗
0↔10,4
Ω0↔3,1E3+ωd/5 0 Ω∗
3↔10,3
Ω0↔7,3 0 E7−ωd/5 Ω∗
7↔10,1
Ω0↔10,4Ω3↔10,3Ω7↔10,1E10
.(I5)
We find the Rabi strength between the 0th and 10th
states by numerically diagonalizing Eq. (I5). In Fig. 18,
we plot the eigenenergies of Eq. (I5) as a function of drive
frequency ωdfor two choices of drive strength, specifi-
cally|ξ|2= 0.01 in panel (a) and |ξ|2= 0.2 in panel
(b). Besides the ground state, the eigenenegies of otherstates, to leading order, linearly depend on the drive
frequency because En=nδ+O(φ2
zps) (c.f. Eq. (105)),
where δ=ωo−2ωd/5. When two states are resonant,
the off-diagonal terms in Eq. (I5) couples them and re-
sult in anti-crossing features. The Rabi strength between
the two states, which equals to half of size of the anti-
crossing, can then be read off from the plot directly.
Note that when the ground and 10th excited states are
resonant, the coupling between the 7th and 10th ex-
cited states through the (3 : 1) process is 0.135 GHz
for|ξ|2= 0.01. This coupling strength is comparable to
the energy difference between the 7th and 10th excited
states and thus the two states are strongly hybridized.
When the drive strength increases to |ξ|2= 0.2, as shown
in Fig. 18 (b), the coupling between the 7th and 10th
excited states is 0.59 GHz, which is comparable to the
energy difference between the two states in the drive fre-
quency window ωd/2π∈[11.5 GHz ,13.5 GHz] consid-
ered here. We therefore can interpret that, in this region
of the drive parameter space, the 7th and 10th excited
states form a hydribized island in the state space, which
is the onset of quantum confusion.
In Fig. 19, we compare the Floquet numerical re-
sults with the analytical results from Eq. (I5) (same
as Eq. (109)), the effective Hamiltonian that captures
(3 : 1) ,(7 : 3) ,(10 : 4) processes simultaneously, and
from Eq. (104), the effective Hamiltonian from the or-
dinary treatment that only captures (10 : 4) or (7 : 3)
process one at a time. Specifically, panel (a) plots the
Rabi strength as a function of drive strength, and panel
(b) plots the locations of the multiphoton resonances.65
-2
-4x10  -5
x10  -6
+12.540901x10  -6
+12.410173.57
kHz
0.27 GHz
1 2 3
x10  -4
+12.5460 1 5 10 2.5 5
x10  -4
+12.188-101.14
kHzx10  -3
0.17
MHz0.32
MHz(a) (b)
1.18 GHz
FIG. 18. Spectrum of Eq. (I5) as a function drive frequency
ωdfor drive strength |ξ|2= 0.01 in panel (a) and |ξ|2= 0.2
in panel (b). The drive frequency is notrescaled by ω01as
in other plots for easier comparison with the y-axis. Lines of
different color corresponds to the eigenenergy ϵnof the eigen-
state|˜n⟩, where the eigenstate is index by the corresponding
Fock state it has the biggest overlap with. Each pair of oppo-
site arrows marks an anti-crossing between two eigenstates.
Specifically, the left inset in each panel plots the anticross-
ing between the ground and 7th excited state through the
(7 : 3) process, the right inset plots the anticrossing between
the ground and 10th excited state through the (10 : 4) pro-
cess, and the arrows in the main plot of each panel marks the
anticrossing between the 7th and 10th excited states through
the (3 : 1) process. The Rabi strength ΩR
n↔q,pbetween the
corresponding Fock states resulting from the ( q:p) process is
half of the anti-crossing size.
For the (10 : 4) resonance (in yellow), Eq. (I5) gives re-
sults closer to the exact Floquet result on both the Rabi
strength and the resonance location. For the (7 : 3) reso-
nance (in purple), Eq. (I5) only marginally modifies the
Rabi strength predicted by Eq. (104). This is because
that, on top of the direct coupling between the ground
and 7th excited state induced by Ω 0↔7,3∼ O (φ8
zps),
Eq. (I5) modifies Eq. (104) by including only a higher
order process — a cascaded coupling the ground and 7th
excited state through the coupling between the ground
and 10th excited state, induced by Ω 0↔10,4∼ O(φ12
zps)
in Eq. (I5), and that between the 10th and 7th excited
states, induced by Ω 7↔10,1∼ O(φ2
zps) in Eq. (I5). We
further note that, in Fig. 19 (b), the locations of the
(7 : 3) resonance predicted from Eqs. (104) and (I5) both
deviate considerably from the Floquet result when |ξ|2in-
creases. This is because, at large drive strength, the 7th
excited states also near-resonantly couple to the 13th ex-
cited state through a (6 : 2) process. We expect to find
better agreement on the resonance location of the (7 : 3)
(a)
(b)Floquet numerics
Eq. E5
Eq. 80
(7:3)
(10:4)
(10:4) (7:3) (13:5)
0.0 0.1 0.2 0.3 0.4 0.5
FIG. 19. Comparison between the exact Floquet numerics
with Eq. (I5) (same as Eq. (109)), the effective Hamiltonian
that captures (3 : 1) ,(7 : 3) ,(10 : 4) processes simultaneously,
and Eq. (104), the effective Hamiltonian from the ordinary
treatment that only captures (10 : 4) or (7 : 3) process one
at a time. Panle (a): the Rabi strength for the (7 : 3) and
(10 : 4) process as a function of drive strength |ξ|2. The
dots are obtained from the Floquet numerics similar to the
one shown in Fig. 5. The solid line is obtained from numer-
ical diagonalization of Eq. (I5) similar to the one shown in
Fig. 18. The dash line corresponds to the value of Ω 0↔q,p
in Eq. (104). The dots and solid lines are the same as those
in Fig. 6. Panel (b): the location of the resonances in the
drive parameter space. The heat map, which is a subsection
of Fig. 7 (b), plots the excitation possibility out of the ground
state P0→. Each excitation line in the heat map corresponds
to a resonance process labeled by ( q:p) next to it. The solid
lines are obtained from numerical diagonalization of Eq. (I5)
like shown in Fig. 18, in which two particular drive strengths
are analyzed. The solid lines correspond to the center of the
corresponding resonance lines in Fig. 7 (a). The dashed lines
are obtained from Eq. (104), where the resonance condition
corresponds to the drive parameters that give E0=E0.
process if Eq. (I5) is expanded to include the 13th excited
states and its associated interaction with other pertinent
states.
Lastly, we note that, in Figs. 6 and 7, the (9 : 5) and
(11 : 5) resonances also coexist with other resonances.
Specifically, the (9 : 5) resonance coexists with two other
resonances — the (5 : 3) resonance, through which the
ground and 5th excited state are coupled, and the (4 : 2)
resonance, through which the 5th and 9th excited states
are coupled. The (11 : 5) resonance coexists with four
other resonances — the (8 : 4) resonance, through which
the ground and 8th excited state are coupled, the (3 : 1)
resonance, through which the 8th and 11th excited states
are coupled, the (4 : 2) resonance, through which the66
ground and 4th excited state are coupled, and the (7 : 3)
resonance, through which the 4th and 11th excited states
are coupled. In the results shown in Figs. 6 and 7, the
(9 : 5) and (11 : 5) resonances are treated in a similar way
as the (10 : 4) process illustrated above. Moreover, this
general procedure of constructing slow-varying effective
Hamiltonian can be employed to include more resonances
at the same time and thus extend the applicability of
the diagrammatic method to deeper quantum diffusion
regime.
Appendix J: Floquet Numerical Diagonalization
In this section, we briefly review the Floquet for-
malism [68–70], which we have used to numerically
compute dynamics of driven Josephson circuits in Sec-
tions VI C and VI D. According to Floquet theory,
the time-dependent Schr¨ odinger equation ˆH(t)Ψ(t) =
iℏ∂
∂tΨ(t) is satisfied by Floquet states
Ψm(t) =e−iϵF
mt/ℏΦm(t) (J1)
where ϵF
mis called quasienergy, and Φ m(t) = Φ m(t+T) is
called Floquet mode, which is periodic in time with the
same periodicity as ˆH(t). With this relation, the time-
dependent Schr¨ odinger equation reduces to an eigenvalue
equation:
(ˆH(t)−iℏ∂t)Φm(t) =ϵmΦm(t) (J2)
It can be seen that, at any time t, the above equa-
tion holds and the quasienergy structure of the system
is invariant. In this sense, Floquet theorem tranforms
a time-dependent problem to a quasi-stationary one, i.e.
the quasienergies are time-independent while the Floquet
modes are oscillating with period T. Moreover, Floquet
states form a complete basis of the Hilbert space of the
driven system, while each Floquet state Ψ m(t) can be
mapped from a set of Floquet modes
Φm,k(t) = Φ m(t)eikωdt, k∈Z (J3)
namely, Ψ m(t) = e−iϵF
mt/ℏΦm(t) = e−iϵF
m,kt/ℏΦm,k(t)
where ϵm,k=ϵm+kℏωdis the corresponding quasienergy.
A Floquet state is analogous to a Bloch state [71],
which sees a periodic potential in space and whose quasi-
momentum lives in a Brillouin zone. Analogously, a Flo-
quet state sees a periodic potential in time, in whose
conjugate space the quasienergy ϵF
m,klives in a Brillouin
zone with width of ℏωd, where kdenotes the index of the
Brillouin zone. To capture the interaction between dif-
ferent Floquet states, it is sufficient to study the states
in the reduced Brillouin zone , in which the quasienergy
is defined modulo ℏωd, i.e. ϵF
m=ϵF
m,kmodℏωd.
Floquet modes and quasienergies are related to the
propagator by the relation:
ˆU(0, T)Φm(0) = e−iϵF
mT/ℏΦm(0) (J4)where ˆU(0, t) is the propagator of ˆH(t). This relation
gives a numerical recipe to implement Floquet theo-
rem by numerically diagonalizing ˆU(0, T) to find ϵF
mand
Φm(0). This is saying that, by diagonalizing the propaga-
tor at one particular time T, it is sufficient to obtain the
energy structure of the system. If needed, one can fur-
ther calculate Floquet mode at an arbitrary time twith
the relation Φ m(t) =eiϵF
mt/ℏˆU(0, t)Φm(0). We use the
python package Quantum Toolbox in Python (QuTiP)
to implement the above procedures.
Appendix K: Estimated Transmon States Under
Displacement and Excitation Possibility
In Section VI C, we analyzed multiphoton resonances
in a driven transmon. To characterize the landscape of
the resonances in the drive parameter space, Figs. 7 and 8
have plotted the excitation probability from the ground
and first excited states respectively defined as
P0→= 1− |⟨˜0F|˜0t⟩|, P 1→= 1− |⟨˜1F|˜1t⟩|, (K1)
where |˜0F⟩,|˜1F⟩are the Floquet modes associated with
the transmon driven ground and first excited state, and
|˜0t⟩,|˜1t⟩are the approximate driven ground and first ex-
cited state of the transmon. In this section, we detail the
computation of |˜0t⟩,|˜1t⟩and the state index assignment
of|˜0F⟩,|˜1F⟩.
To properly define |˜0t⟩,|˜1t⟩and thus P0→, P1→, we as-
sume that the qubit manifold of the transmon is not
highly hybridized with other states for most of the in-
terested region in the drive parameter space — in other
words, the driven transmon is not deep in the quan-
tum diffusion regime. Under this assumption, the driven
ground state, to leading order, is a displaced ground state
with αlin(t) =iΩd
2[e−iωdt/(ωd−ωo) +eiωdt/(ωd+ωo)]
as defined by Eq. (C4), where drive strength ξis re-
lated to Ω dbyξ=iΩdωd
ω2
d−ω2o. To verify this assumption,
in Fig. 20, we plot the wavefunction of |˜0F⟩inφas a
function of drive strength. For now, |˜0F⟩at a partic-
ular set of drive parameters can be understood as the
Floquet mode Φ m(t= 0) (c.f. Eq. (J2)) of the Hamilto-
nian Eq. (98) that has the largest overlap with the un-
driven transmon ground state |0t⟩; its formal definition
will be discussed soon. The drive frequency in Fig. 20 is
chosen to be ωd/2π= 8.97 GHz and the drive strength
to be |ξ|2∈[0,1], which are the same as those chosen
in Fig. 5. As shown in Fig. 20 (a), for most choices of
|ξ|2, the ground Floquet mode ⟨˜0F|φ⟩is centered around
φ= 0 with a Gaussian-like distribution, where |φ⟩is the
phase state. In particular, as shown in Fig. 20 (d), when
the drive strength is |ξ|2= 0,|˜0F⟩is just the undriven
ground state |0t⟩. With the drive strength increasing, as
examplified in Fig. 20 (e) and (f) for |ξ|2= 0.5,1.0, the
Floquet mode ⟨˜0F|φ⟩is still centered around φ= 0 but
has increasing imaginary component. This indicates that
|˜0F⟩is displaced in the charge degree of momentum ˆN,67
(b) (c)
(a)
(d) (e) (f)
(g) (h) (i)
(j) (k) (l)abs Im Re
FIG. 20. Wave function of Floquet mode |˜0F⟩, as defined in Eq. (K3), for a driven transmon governed by Eq. (98). The
transmon and drive are of the same parameters as those in Fig. 5, specifically EJ/h= 30 GHz, EC/h= 0.15 GHz, Ng= 0,
ωd/2π= 8.97 GHz, and |ξ|2∈[0,1]. Panel (a)-(c): wave function of |˜0F⟩inφcoordinate as a function of |ξ|2. Panel (b) and
(c) are zoom-ins of (a) around the (9 : 5) and (5 : 3) multiphoton resonances, respectively. Blue lines, labeled by the y-axis
on the right, are P0→the transition probability out of ground state as defined in Eq. (K1). Panel (d)-(l): wave function at
specific choices of |ξ|2as marked by the arrows in (a)-(c). Orange, green, and red lines are respectively the absolute value, real
part, and imaginary part of the wave function. Panel (d)-(f) correspond to the three blue arrows in (a) at |ξ|= 0,0.5, and 1.
The wave functions are Gaussian-like functions and representational for most choices of |ξ|2in (a). With |ξ|2increasing, the
imaginary parts of these wave functions increase, which correspond to a displacement in the charge coordinate that is conjugate
toφ. Panel (g)-(i) plot the wave function of |ξ|2= 0.4103,0.4107, and 0.411 as indicated by the red arrows in (b). These wave
functions correspond to hybridization of the ground and 9th excited states due to the (9 : 5) multiphoton resonance. Panel
(j)-(l) plot the wave function of |ξ|2= 0.566,0.5679, and 0.57 as indicated by the red arrows in (c). These wave functions
correspond to hybridization of the ground and 5th excited states due to the (5 : 3) multiphoton resonance.
which is consistent with the phase of the linear response
αlin(t) that is purely imaginary at t= 0.
Our goal is to construct an approximate state |˜0t⟩that
captures the displacing effect on the transmon ground
state due to the drive but ignore other effects such as
multiphoton-resonance. To do this, similar to Fig. 20
(a), we perform Floquet numerical diagonalization at
other 125 drive frequencies evenly spaced in ωd/2π∈
[6.9 GHz ,13 GHz], and for each drive frequency we sam-
ple 100 drive strength points in |ξ|2∈[0,1]. This range is
the same as that in Fig. 7. Afterwards, we obtain |˜0F⟩, at
each given set of drive parameters, by finding the Floquet
mode with largest overlap with |0t⟩. For those Floquetmode with |⟨˜0F|0t⟩|>0.8, we fit them with an approxi-
mate state |˜0t⟩, which can be understood as a displaced
transmon ground state as a function of drive frequency
ωdand drive strength ξ. In particular, we decompose |˜0t⟩
in the undriven transmon eigenbasis and fit each compo-
nent as a function of ωd, ξ:
⟨˜0t(ωd, ξ)|kt⟩=X
j≥0,l≥0Ck,j,lωj
dξl, (K2)
where |kt⟩is the k-th state of the undriven transmon and
Ck,j,l’s are the fitted parameters.
In Fig. 21, we compare the fitted state |˜0t⟩with the
actual Floquet mode |˜0F⟩. In particular, in panels (a)-(f),68
(a)
(b)
(c)
(d)
(e)
(f )(g)
(h)
(i)
(j)
(k)
(l)
FIG. 21. Decomposition of the driven ground states of
the transmon analyzed in Fig. 20 in the basis of eigenstates
{|kt⟩|t≥0}of the undriven transmon described by Hamil-
tonian Eq. (98) with Ed= 0. The contribution from k≥6
states are not shown here as they are negligible. Blue dots cor-
respond to the Floquet modes |˜0F⟩, as defined by Eq. (K3),
associated with the transmon ground state. Here only the
Floquet modes with ⟨˜0F|00⟩are shown. The orange lines cor-
respond to the approximate driven ground state |˜0t⟩as de-
fined in Eq. (K2), which fits the blue dots in the ( ωd, ξ) drive
parameter space. Panel (a)-(f): decomposition of the ground
state for ωd/2π= 8.97 GHz and varying |ξ|2. The drive pa-
rameters are the same as those in Figs. 5 and 20. The dashed
lines, from left to right, mark the center of (9 : 5) and (5 : 3)
multiphoton resonances. Panel (g)-(l):decomposition of the
ground state for |ξ|2= 0.5 and varying ωd. The dashed lines,
from left to right, mark the center of (5 : 3) ,(4 : 2), and (7 : 3)
multiphoton resonances.
we choose drive parameters ωd/2π= 8.97 GHz and |ξ|2∈
[0,1], which are the same as those in Figs. 5 and 20, and
plot the overlap between |˜0t⟩and the first six eigenstates
of the undriven transmon. The fitted state |˜0t⟩agrees
well with the Floquet modes |˜0F⟩for most drive strengths
except around the two dashed lines. These two dashed
lines corresponds to the (9 : 5) resonances and (5 : 3)
resonances as shown in Figs. 5 and 20 (b), and (g)-(i). We
comment on them later. In panel (g)-(l), we choose drive
parameters ωd/2π∈[6.9 GHz ,13 GHz] and |ξ|2= 0.5.
The fitted state |˜0t⟩agrees well with the Floquet modes
|˜0F⟩for most drive strengths except around the three
dashed lines. These lines, from left to right, correspond
to the (5 : 3) ,(4 : 2) and (7 : 3) resonances (see Fig. 7).
With the approximate ground state |˜0t⟩computed, we
formally define |˜0F⟩, at a specific choice of drive param-
eters, as
|˜0F⟩= arg max
|Φm(t=0)⟩|⟨Φm(t= 0)|˜0t⟩|, (K3)where |Φm(t)⟩is the Floquet mode of the Hamiltonian
Eq. (98). The excitation probability from the ground
state P0→= 1− |⟨˜0F|˜0t⟩|2is then inferred by how much
the Floquet mode |˜0F⟩is hybridized with states outside
the displaced transmon ground state. For instances, in
Fig. 20 (b) and (c), we plot |⟨˜0F|φ⟩|in the window of |ξ|2
that the ground state is on resonance with the 9th excited
state through a (9 : 5) process and with the 5th excited
state through a (5 : 3) process, respectively. In stead
of a Gaussian-like function, the Floquet mode |⟨˜0F|φ⟩|
shows more nodes and indicates the hybridization with
the higher excited states. The blue lines in Fig. 20 (b)
and (c) shows P0→as a function of |ξ|2. It can be seen
that, when away from the resonances, the Floquet mode
|˜0F⟩is approximately a displaced ground state and thus
P0→is around zero. When the ground state is exactly on
resonances with the 9th or the 5th excited states, P0→=
0.5 indicates the maximum hybridization of the ground
state and the corresponding excited state.
In Fig. 8 (a), we also plot P0→in the extended drive
parameter space with |ξ|2larger than those considered
in Figs. 20 and 21. This requires to compute |˜0t⟩in this
extended parameter space in an iterative manner. In
particular, as in Fig. 21, we first identify a set of Floquet
modes |˜0F⟩associated with the transmon ground state in
the smaller range of |ξ|2by selecting those Floquet modes
having overlap with undriven transmon state |0t⟩larger
than 0.8. By fitting these Floquet modes as Eq. (K2),
we obtain |˜0t⟩at the first iteration. Then we consider
the|ξ|2with larger value and, following Eq. (K3), iden-
tify a larger set of Floquet modes |˜0F⟩associated with
the transmon ground state to be fitted. This iterative
procedure allows to compute |˜0t⟩to large drive strength
until the driven ground state enters the quantum diffu-
sion regime. The approximate first excited state |˜1t⟩,
which is used to obtained P0→= 1− |⟨˜1F|˜1t⟩|2in Fig. 8
(b), is computed in a similar manner and for brevity we
suppress its detail calculation here.
Appendix L: Duffing Equation and Duffing
Bifurcation
The most general form of Duffing equation containing
the 3rd and 4th rank nonlinearities is
d2
t˜x′+γdt˜x′+ ˜x′+c′
3˜x′2+c′
4˜x′3=f(e−iνt+eiνt),
(L1)
where ˜ x′is the position coordinate of the Duffing oscilla-
tor,c′
3, c′
4are the 3rd and 4th rank nonlinearities, γis the
damping rate, and fthe drive amplitude. These parame-
ters specifying a Duffing oscillator can be further reduced
by introducing ˜ x= ˜x′/f,c3=fc′
3, and c3→f2c′
4. With
these rescaled quantities, Eq. (L1) transforms to
d2
t˜x+γdt˜x+ ˜x+c3˜x2+c4˜x3=e−iνt+eiνt,(L2)
which is just Eq. (117), the Duffing equation we analyzed
in Section VI E. In other words, the drive amplitude fin69
Eq. (L1) is effectively an extra knob to control the non-
linearities in the Duffing oscillator and can be absorbed
into the latter.
In Section VI E, we have discussed the general ultra-
subharmonic bifurcation process when the drive is in the
vicinity of q/p. However, for the specific case of ( q:
p) = (1 : 1), or the Duffing bifurcation [20, 65], we use a
modified quantum harmonic balance method, which we
outline in this section.
Similar to the treatment in Appendix C, we first trans-
form Eq. (L2) into a rotating frame by ˜ x→˜xcos(νt) +
dt˜xsin(νt). In the new frame, Eq. (L2) can be re-
expressed in the bosonic coordinate as
dt˜a=−i(δ−iγ
2)˜a−ieiνtX
m=3,4gm
˜ae−iνt+ ˜a∗eiνtm−1
−i
2eiνt(e−iνt+eiνt), (L3)
where ˜ a= (˜x+idt˜x)/2 is the complex coordinate
satisfying the canonical relation {˜a,˜a∗}˜a,˜a∗= 1, and
{˜f,˜g}˜a,˜a∗=−i∂˜a˜f∂˜a∗˜g+i∂˜a˜f∂˜a∗˜gis the Poisson bracket
defined over the phase space (˜ a,˜a∗). The parameter
δ= 1−νis the detuning between the natural frequency
of the oscillator and the drive frequency, and gm=cm/2
is the rescaled nonlinearity. Here we also symmetrzied
the damping to both the position and momentum coor-
dinate, which is a valid approximation for γ≪1.
Written as it is, Eq. (L3) can be identified as a Hamil-
ton equation of motion ˙˜a=−{˜H,˜a}˜a,˜a∗with the corre-sponding Hamiltonian being
˜H(t) =(δ−iγ
2)˜a∗˜a+X
m=3,4gm
m 
˜ae−iνt+ ˜a∗eiνtm
+1
2 
˜ae−iνt+ ˜a∗eiνt 
e−iνt+eiνt
. (L4)
In the general case of ( q:p)̸= (1 : 1), as discussed
in Appendix C, we often further transform Eq. (L4) to
the linear response of the oscillator to the drive and ar-
rive at Eq. (120). In the case of (1 : 1) bifurcation here,
however, the drive term1
2 
˜ae−iνt+ ˜a∗eiνt 
e−iνt+eiνt
itself contains static component, this transformation
should be modified as ˜ a→˜a−1
2(ν+1)eiνtand the trans-
formed Hamiltonian reads
˜H(t) = (δ−iγ
2)˜a∗˜a+X
m=3,4gm
m
˜ae−iνt+ ˜a∗eiνt
+ξe−iνt+ξ∗eiνtm
+1
2(˜a+ ˜a∗),
(L5)
where ξ=−1
2(ν+1)e−iνt. Eq. (L5) is of the same form of
Eq. (120) but with an additional term (˜ a+˜a∗)/2. Taking
this equation as the starting point of our diagrammatic
analysis, we follow the same treatment discussed in Sec-
tion VI E and obtain the equation governing the steady
state of (1 : 1) bifurcation as:
(2K2ρ+ ∆)2+γ2
4+O(g2
4) =ρ−1, (L6)
where ρ=|As|2,|As|is the steady state of the bosonic
coordinate in the effective frame, and K2is the energy
dressing coefficient defined in Eq. (130). We note that
Eq. (L6) shares the same form as Eq. (132), which gov-
erns the steady state of general ultra-subharmonic bifur-
cation process ( q:p)̸= (1 : 1). The domain diagram in
Fig. 13 (a) is also generated by Eq. (L6).
[1] M. Dykman, Fluctuating Nonlinear Oscillators: From
Nanomechanics to Quantum Superconducting Circuits
(Oxford University Press, 2012).
[2] J. Guckenheimer and P. Holmes, Nonlinear oscillations,
dynamical systems, and bifurcations of vector fields ,
Vol. 42 (Springer Science & Business Media, 2013).
[3] I. Siddiqi, R. Vijay, F. Pierre, C. M. Wilson, M. Met-
calfe, C. Rigetti, L. Frunzio, and M. H. Devoret, RF-
driven Josephson bifurcation amplifier for quantum mea-
surement, Phys. Rev. Lett. 93, 207002 (2004).
[4] V. E. Manucharyan, E. Boaknin, M. Metcalfe, R. Vi-
jay, I. Siddiqi, and M. Devoret, Microwave bifurcation of
a Josephson junction: Embedding-circuit requirements,
Phys. Rev. B 76, 014524 (2007).
[5] A. A. Clerk, M. H. Devoret, S. M. Girvin, F. Marquardt,
and R. J. Schoelkopf, Introduction to quantum noise,
measurement, and amplification, Rev. Mod. Phys. 82,1155 (2010).
[6] N. E. Frattini, V. V. Sivak, A. Lingenfelter, S. Shankar,
and M. H. Devoret, Optimizing the nonlinearity and dis-
sipation of a SNAIL parametric amplifier for dynamic
range, Phys. Rev. Appl. 10, 054020 (2018).
[7] P. Krantz, A. Bengtsson, M. Simoen, S. Gustavsson,
V. Shumeiko, W. D. Oliver, C. M. Wilson, P. Delsing,
and J. Bylander, Single-shot read-out of a superconduct-
ing qubit using a Josephson parametric oscillator, Nature
Communications 7, 11417 (2016).
[8] Y. Y. Gao, B. J. Lester, Y. Zhang, C. Wang, S. Rosen-
blum, L. Frunzio, L. Jiang, S. M. Girvin, and R. J.
Schoelkopf, Programmable interference between two mi-
crowave quantum memories, Phys. Rev. X 8, 021073
(2018).
[9] W. Wustmann and V. Shumeiko, Parametric effects
in circuit quantum electrodynamics, Low Temperature70
Physics 45, 848 (2019).
[10] A. Grimm, N. E. Frattini, S. Puri, S. O. Mundhada,
S. Touzard, M. Mirrahimi, S. M. Girvin, S. Shankar, and
M. H. Devoret, Stabilization and operation of a Kerr-cat
qubit, Nature 584, 205 (2020).
[11] P. Campagne-Ibarcq, A. Eickbusch, S. Touzard, E. Zalys-
Geller, N. E. Frattini, V. V. Sivak, P. Reinhold, S. Puri,
S. Shankar, R. J. Schoelkopf, L. Frunzio, M. Mirrahimi,
and M. H. Devoret, Quantum error correction of a qubit
encoded in grid states of an oscillator, Nature 584, 368
(2020).
[12] N. E. Frattini, U. Vool, S. Shankar, A. Narla, K. M.
Sliwa, and M. H. Devoret, 3-wave mixing Josephson
dipole element, Applied Physics Letters 110, 222603
(2017).
[13] S. Puri, S. Boutin, and A. Blais, Engineering the quan-
tum states of light in a Kerr-nonlinear resonator by two-
photon driving, npj Quantum Information 3, 1 (2017).
[14] S. O. Mundhada, A. Grimm, S. Touzard, U. Vool,
S. Shankar, M. H. Devoret, and M. Mirrahimi, Gener-
ating higher-order quantum dissipation from lower-order
parametric processes, Quantum Science and Technology
2, 024005 (2017).
[15] T. Hillmann and F. Quijandr´ ıa, Designing Kerr inter-
actions for quantum information processing via counter-
rotating terms of asymmetric Josephson-junction loops,
Phys. Rev. Applied 17, 064018 (2022).
[16] Y. Zhang, J. Gosner, S. M. Girvin, J. Ankerhold, and
M. I. Dykman, Time-translation-symmetry breaking in
a driven oscillator: From the quantum coherent to the
incoherent regime, Phys. Rev. A 96, 052124 (2017).
[17] N. L¨ orch, Y. Zhang, C. Bruder, and M. I. Dykman, Quan-
tum state preparation for coupled period tripling oscilla-
tors, Phys. Rev. Res. 1, 023023 (2019).
[18] Y. Zhang and M. I. Dykman, Nonlocal random walk over
Floquet states of a dissipative nonlinear oscillator, Phys.
Rev. E 100, 052148 (2019).
[19] https://github.com/xiaoxuisaac/Bosonic_diagram_
canonical (2023).
[20] A. H. Nayfeh and D. T. Mook, Nonlinear Oscillators
(John Wiley & Sons, 2008).
[21] J. Venkatraman, X. Xiao, R. G. Corti˜ nas, A. Eickbusch,
and M. H. Devoret, Static effective hamiltonian of a
rapidly driven nonlinear system, Phys. Rev. Lett. 129,
100601 (2022).
[22] H. Goldstein, C. Poole, and J. Safko, Classical mechanics
(2002).
[23] N. M. Krylov and N. N. Bogoliubov, Introduction to non-
linear mechanics (In Russian) (Ac. of Sci. Ukr. SSR,
1937) [English translation by Princeton University Press,
Princeton, 1947].
[24] N. N. Bogoliubov and Y. A. Mitropolsky, Asymptotic
methods in the theory of non-linear oscillations (In Rus-
sian) (1961) [English translation by Hindustan Pub.,
Delhi, 1961; Gordon and Breach, New York, 1961].
[25] L. Landau and E. Lifshitz, Mechanics: Volume 1 , Course
of theoretical physics (Elsevier Science, 1976).
[26] S. Rahav, I. Gilary, and S. Fishman, Time independent
description of rapidly oscillating potentials, Phys. Rev.
Lett. 91, 110404 (2003).
[27] M. Mirrahimi and P. Rouchon, Dynamics and control of
open quantum systems (2015).
[28] T. P. Grozdanov and M. J. Rakovi´ c, Quantum system
driven by rapidly varying periodic perturbation, Phys.Rev. A 38, 1739 (1988).
[29] P. A. Kuchment, Floquet theory for partial differential
equations , Vol. 60 (Springer Science & Business Media,
1993).
[30] A. Eckardt and E. Anisimovas, High-frequency approxi-
mation for periodically driven quantum systems from a
Floquet-space perspective, New Journal of Physics 17,
093039 (2015).
[31] F. Casas, J. A. Oteo, and J. Ros, Floquet theory: ex-
ponential perturbative treatment, Journal of Physics A:
Mathematical and General 34, 3379 (2001).
[32] T. Curtright, D. Fairlie, and C. Zachos, A Concise Trea-
tise On Quantum Mechanics In Phase Space (World Sci-
entific Publishing Company, 2013).
[33] M. Hillery, R. O’Connell, M. Scully, and E. Wigner, Dis-
tribution functions in physics: Fundamentals, Physics
Reports 106, 121 (1984).
[34] R. R. Puri et al. ,Mathematical methods of quantum op-
tics, Vol. 79 (Springer, 2001).
[35] F. J. Dyson, The smatrix in quantum electrodynamics,
Phys. Rev. 75, 1736 (1949).
[36] S. Weinberg, Historical introduction, in The Quantum
Theory of Fields (Cambridge University Press, 1995) p.
1–48.
[37] J. E. Moyal, Quantum mechanics as a statistical theory,
inMathematical Proceedings of the Cambridge Philosoph-
ical Society , Vol. 45 (Cambridge University Press, 1949)
pp. 99–124.
[38] C. Zachos, D. Fairlie, and T. Curtright, Quantum Me-
chanics in Phase Space: An Overview with Selected
Papers , World Scientific series in 20th century physics
(World Scientific, 2005).
[39] Z. K. Minev, Z. Leghtas, S. O. Mundhada, L. Chris-
takis, I. M. Pop, and M. H. Devoret, Energy-participation
quantization of Josephson circuits, npj Quantum Infor-
mation 7, 131 (2021).
[40] S. Mundhada, A. Grimm, S. Touzard, U. Vool,
S. Shankar, M. Devoret, and M. Mirrahimi, Generat-
ing higher order quantum dissipation from lower order
parametric processes, Quantum Science and Technology
2(2016).
[41] Z. Leghtas, S. Touzard, I. M. Pop, A. Kou, B. Vlas-
takis, A. Petrenko, K. M. Sliwa, A. Narla, S. Shankar,
M. J. Hatridge, M. Reagor, L. Frunzio, R. J. Schoelkopf,
M. Mirrahimi, and M. H. Devoret, Confining the state of
light to a quantum manifold by engineered two-photon
loss, Science 347, 853 (2015).
[42] A. Petrescu, M. Malekakhlagh, and H. E. T¨ ureci, Life-
time renormalization of driven weakly anharmonic super-
conducting qubits. II. the readout problem, Phys. Rev.
B101, 134510 (2020).
[43] J. Venkatraman, X. Xiao, R. G. Corti˜ nas, and M. H. De-
voret, On the static effective lindbladian of the squeezed
Kerr oscillator (2022).
[44] N. E. Frattini, R. G. Corti˜ nas, J. Venkatraman, X. Xiao,
Q. Su, C. U. Lei, B. J. Chapman, V. R. Joshi, S. M.
Girvin, R. J. Schoelkopf, S. Puri, and M. H. Devoret,
The squeezed Kerr oscillator: spectral kissing and phase-
flip robustness (2022).
[45] J. Venkatraman, R. G. Cortinas, N. E. Frattini, X. Xiao,
and M. H. Devoret, Quantum interference of tunneling
paths under a double-well barrier (2022).
[46] A. Eickbusch, V. Sivak, A. Z. Ding, S. S. Elder, S. R. Jha,
J. Venkatraman, B. Royer, S. M. Girvin, R. J. Schoelkopf,71
and M. H. Devoret, Fast universal control of an oscillator
with weak dispersive coupling to a qubit, Nature Physics
18, 1464 (2022).
[47] A. Blais, A. L. Grimsmo, S. M. Girvin, and A. Wallraff,
Circuit quantum electrodynamics, Rev. Mod. Phys. 93,
025005 (2021).
[48] D. Sank, Z. Chen, M. Khezri, J. Kelly, R. Barends,
B. Campbell, Y. Chen, B. Chiaro, A. Dunsworth,
A. Fowler, E. Jeffrey, E. Lucero, A. Megrant, J. Mu-
tus, M. Neeley, C. Neill, P. J. J. O’Malley, C. Quin-
tana, P. Roushan, A. Vainsencher, T. White, J. Wen-
ner, A. N. Korotkov, and J. M. Martinis, Measurement-
induced state transitions in a superconducting qubit: Be-
yond the rotating wave approximation, Phys. Rev. Lett.
117, 190503 (2016).
[49] Y. Zhang, B. J. Lester, Y. Y. Gao, L. Jiang, R. J.
Schoelkopf, and S. M. Girvin, Engineering bilinear mode
coupling in circuit QED: Theory and experiment, Phys.
Rev. A 99, 012314 (2019).
[50] R. Shillito, A. Petrescu, J. Cohen, J. Beall, M. Hauru,
M. Ganahl, A. G. Lewis, G. Vidal, and A. Blais, Dynam-
ics of transmon ionization, Phys. Rev. Appl. 18, 034031
(2022).
[51] M. D. Reed, L. DiCarlo, B. R. Johnson, L. Sun, D. I.
Schuster, L. Frunzio, and R. J. Schoelkopf, High-fidelity
readout in circuit quantum electrodynamics using the
Jaynes-Cummings nonlinearity, Phys. Rev. Lett. 105,
173601 (2010).
[52] Z. K. Minev, S. O. Mundhada, S. Shankar, P. Rein-
hold, R. Guti´ errez-J´ auregui, R. J. Schoelkopf, M. Mir-
rahimi, H. J. Carmichael, and M. H. Devoret, To catch
and reverse a quantum jump mid-flight, Nature 570, 200
(2019).
[53] A. Eickbusch, V. Sivak, A. Z. Ding, S. S. Elder, S. R. Jha,
J. Venkatraman, B. Royer, S. M. Girvin, R. J. Schoelkopf,
and M. H. Devoret, Fast universal control of an oscillator
with weak dispersive coupling to a qubit, Nature Physics
18, 1464 (2022).
[54] R. Lescanne, L. Verney, Q. Ficheux, M. H. Devoret,
B. Huard, M. Mirrahimi, and Z. Leghtas, Escape of a
driven quantum Josephson circuit into unconfined states,
Phys. Rev. Appl. 11, 014030 (2019).
[55] J. Cohen, A. Petrescu, R. Shillito, and A. Blais, Reminis-
cence of classical chaos in driven transmons, PRX Quan-
tum4, 020312 (2023).
[56] K. Wang and S.-I. Chu, Dynamics of multiphoton exci-
tation and quantum diffusion in Rydberg atoms, Phys.
Rev. A 39, 1800 (1989).
[57] Y. Lu, A. Maiti, J. W. O. Garmon, S. Ganjam, Y. Zhang,
J. Claes, L. Frunzio, S. M. Girvin, and R. J. Schoelkopf,
A high-fidelity microwave beamsplitter with a parity-
protected converter (2023).
[58] V. Sivak, N. Frattini, V. Joshi, A. Lingenfelter,
S. Shankar, and M. Devoret, Kerr-free three-wave mixingin superconducting quantum circuits, Phys. Rev. Applied
11, 054060 (2019).
[59] L. Verney, R. Lescanne, M. H. Devoret, Z. Leghtas, and
M. Mirrahimi, Structural instability of driven josephson
circuits prevented by an inductive shunt, Phys. Rev. Ap-
plied 11, 024003 (2019).
[60] W. C. Smith, J. Venkatraman, X. Xiao, L. Verney,
L. Frunzio, S. Shankar, M. Mirrahimi, and M. Devoret,
Inductively-shunted transmon qubit for superconducting
circuits (2022), uS Patent 11,223,355.
[61] L. Gr¨ unhaupt, N. Maleeva, S. T. Skacel, M. Calvo,
F. Levy-Bertrand, A. V. Ustinov, H. Rotzinger, A. Mon-
fardini, G. Catelani, and I. M. Pop, Loss mechanisms and
quasiparticle dynamics in superconducting microwave
resonators made of thin-film granular aluminum, Phys.
Rev. Lett. 121, 117001 (2018).
[62] P. Winkel, K. Borisov, L. Gr¨ unhaupt, D. Rieger,
M. Spiecker, F. Valenti, A. V. Ustinov, W. Wernsdor-
fer, and I. M. Pop, Implementation of a transmon qubit
using superconducting granular aluminum, Phys. Rev. X
10, 031032 (2020).
[63] J. Koch, T. M. Yu, J. Gambetta, A. A. Houck, D. I.
Schuster, J. Majer, A. Blais, M. H. Devoret, S. M. Girvin,
and R. J. Schoelkopf, Charge-insensitive qubit design de-
rived from the Cooper pair box, Phys. Rev. A 76, 042319
(2007).
[64] M. Burgelman, P. Rouchon, A. Sarlette, and M. Mir-
rahimi, Structurally stable subharmonic regime of a
driven quantum Josephson circuit (2022).
[65] R. Vijay, M. H. Devoret, and I. Siddiqi, Invited review
article: The Josephson bifurcation amplifier, Review of
Scientific Instruments 80, 111101 (2009).
[66] L. L. Buishvili and M. G. Menabde, Use of averag-
ing method in problems of high-resolution nuclear mag-
netic resonance in solids, Theoretical and Mathematical
Physics 50, 2435 (1979).
[67] T. Mikami, S. Kitamura, K. Yasuda, N. Tsuji, T. Oka,
and H. Aoki, Brillouin-Wigner theory for high-frequency
expansion in periodically driven systems: Application
to floquet topological insulators, Physical Review B 93,
144307 (2016).
[68] J. H. Shirley, Solution of the Schr¨ odinger equation with
a Hamiltonian periodic in time, Phys. Rev. 138, B979
(1965).
[69] G. Floquet, Sur les ´ equations diff´ erentielles lin´ eaires ` a
coefficients p´ eriodiques, Annales scientifiques de l’ ´Ecole
Normale Sup´ erieure 2e s´ erie, 12 , 47 (1883).
[70] M. Grifoni and P. H¨ anggi, Driven quantum tunneling,
Physics Reports 304, 229 (1998).
[71] F. Bloch, ¨Uber die Quantenmechanik der Elektronen in
Kristallgittern, Zeitschrift fur Physik 52, 555 (1929).