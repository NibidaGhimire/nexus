arXiv:2303.14622v2  [quant-ph]  28 Mar 2023Experimental quantum secret sharing based on phase encodin g of coherent states
Ao Shen,1,∗Xiao-Yu Cao,1,∗Yang Wang,1,2,∗Yao Fu,3,∗Jie Gu,1
Wen-Bo Liu,1Chen-Xun Weng,1Hua-Lei Yin,1,†and Zeng-Bing Chen1,‡
1National Laboratory of Solid State Microstructures and Sch ool of Physics,
Collaborative Innovation Center of Advanced Microstructu res, Nanjing University, Nanjing 210093, China
2Henan Key Laboratory of Quantum Information and Cryptograp hy, SSF IEU, Zhengzhou, China
3Beijing National Laboratory for Condensed Matter Physics a nd Institute of Physics,
Chinese Academy of Sciences, Beijing 100190, China
Quantum secret sharing (QSS) is one of the basic communicati on primitives in future quantum
networks which addresses part of the basic cryptographic ta sks of multiparty communication and
computation. Nevertheless, it is a challenge to provide a pr actical QSS protocol with security
against general attacks. A QSS protocol that balances secur ity and practicality is still lacking.
Here, we propose a QSS protocol with simple phase encoding of coherent states among three
parties. Removing the requirement of impractical entangle d resources and the need for phase
randomization, our protocol can be implemented with access ible technology. We provide the
ﬁnite-key analysis against coherent attacks and implement a proof-of-principle experiment to
demonstrate our scheme’s feasibility. Our scheme achieves a key rate of 85.3 bps under a 35
dB channel loss. Combined with security against general att acks and accessible technology, our
protocol is a promising candidate for practical multiparty quantum communication networks.
Keywords: quantum secret sharing, coherent state, phase encoding, co herent attack, ﬁnite-size
I. INTRODUCTION
Quantum communication has attracted much atten-
tion [1–9] due to its unconditional security during the
communication process. Quantum communication has
many branches, such as quantum key distribution [ 10–
21], digital signatures [ 22–24], quantum secret sharing
(QSS) [25,26] and so on. As an important branch of
quantum communication, QSS is the quantum general-
ization of secret sharing. Secret sharing is an important
primitive in quantum classical cryptography and was in-
dependently introduced by Shamir [ 27] and Blakley [ 28].
In a secret sharing scheme, a dealer splits a message into
severalparts and distributes each part to the correspond-
ing player. In secret sharing, any unauthorized subset of
players cannot reconstruct the message and the message
can be reconstructed only when the authorized players
cooperate. Since the security of classical secret shar-
ing depends heavily on computational complexity, which
has been proven vulnerable to future quantum comput-
ers, QSS is proposed to provide unconditional security
based on the laws of quantum mechanics. The ﬁrst QSS
protocol was proposed by Hillery [ 25] in 1999 by us-
ing the Greenberger-Horne-Zeilinger(GHZ) states. Since
then, many QSS protocols have been proposed theoret-
ically [29–40] and demonstrated experimentally [ 41–47].
Although QSS has been studied extensively, it is still a
challenge to provide a practical QSS protocol with secu-
rity against general attacks. The ﬁrst QSS protocol us-
ing GHZ states is not secure with a malicious player [ 36].
∗These authors contributed equally to this work
†hlyin@nju.edu.cn
‡zbchen@nju.edu.cnIn addition, due to its insuﬃcient transmission distance
and a lack of eﬃcient multiphoton sources, this QSS is
highly impractical. To remove the requirement of the
GHZ states, several single-qubit QSS schemes have been
proposed[ 42,48,49]. However,single-qubitschemeshave
drawbacks in their security [ 50,51] and are vulnerable to
Trojan horse attacks [ 52]. In recent years, diﬀerential
phase shift (DPS) QSS schemes [ 53–55] and round-robin
(RR) QSS [ 56,57] have been proposed. Using weak co-
herent states, DPS QSS schemes further simplify the ex-
perimental setup. Nevertheless, DPS QSS schemes [ 53–
55] can defend against only individual attacks, such as
photon number splitting and beam splitting attacks. RR
QSS [56,57] provides unconditional security against co-
herent attacks and removes the monitoring signal distur-
bance. However, implementation of the RR QSS lies in
the realizationofa variable-delayMach-Zehnderinterfer-
ometer, which improvesthe complexityofthe experimen-
tal setup and constrains the practical application of this
scheme. To date, a QSS protocol that balances security
and practicality is still lacking.
Here, we present a QSS protocol that is secure against
coherentattacks. Byencodinglogicbitswith phasemod-
ulation on coherent states, our protocol removes the re-
quirements for intensity modulation and phase random-
ization, which simpliﬁes the experimental setup. Our
protocol adopts the same remote single-photon interfer-
ence method as twin-ﬁeld quantum key distribution to
resist the Trojan horse attack in single-qubit QSS. Using
the concentration inequality [ 58,59] to consider statisti-
calﬂuctuations, weprovidetheﬁnite-keyanalysisagainst
coherent attacks. In addition, we implement a proof-of-
principle experiment of our protocol to demonstrate its
feasibility in a plug-and-play system. We successfully
generate secure key over various channel losses, up to2
35 dB, under which a key rate of 85.3 bps can be ob-
tained. Our protocol can be implemented by existing
devices [60–66] while achieving security against coherent
attacks, which provides a possible solution for the ap-
plication of QSS. Furthermore, as dishonest participants
are allowed in QSS schemes, our protocol can be directly
used for eﬃcient quantum digital signatures [ 24]. Ad-
dressing the bottleneck problems of QSS in both security
and practicality, our QSS protocol pavesthe wayto prac-
tical QSS networks.
II. PROTOCOL DESCRIPTION
The schematic diagram of our protocol is shown in
Fig.1. In our protocol, two symmetric distant players
Alice and Bob send two weak coherent pulses, which are
phase-encoded with logic bits and selected bases, to cen-
tral dealer Charlie. After adding phase modulation to
the optical pulse sent by Bob, Charlie performs an in-
terference measurement on the two optical pulses sent
by Alice and Bob and obtains the phase diﬀerence of the
twopulsesaccordingto the clickinginformationofhis de-
tectors. Based on the measurement results and the basis
choices of Alice, Bob and Charlie, each of the three par-
ties in our protocol generates their own raw keys. Em-
ploying the same setup as the twin-ﬁeld quantum key
distribution, the key rate of our protocol scales with the
square root of the total channel transmittance (between
Alice and Bob) with single-photon interference. The de-
tailed process of this QSS is as follows.
1. Preparation. In each turn, Alice (Bob) prepares a
weak coherent pulse with intensity µand selects Xand
Ybases with probabilities pxandpy= 1−px, respec-
tively. In the Xbasis, Alice (Bob) randomly modulates
thephaseofthepulseby {0,π}andrecordsher(his)logic
bit as 0 (1) when the modulated phase is 0 ( π). In the Y
basis, Alice (Bob) randomly modulates the phase of the
pulse by {π/2,3π/2}and records her (his) logic bit as 1
(0)when themodulatedphaseis π/2(3π/2). Then, Alice
and Bob send their pulses to the central dealer Charlie.
2. Measurement. Charlie imparts a phase 0 on the
pulse sent by Bob with probability pxand imparts a
phaseπ/2 with probability py= 1−px. When the phase
is 0 (π/2), Charlie records his basis as X(Y). Then
Charlieperformsaninterferencemeasurementonthetwo
received pulses with a beam splitter. When the measure-
ment is completed, Charlie records which detector clicks.
If D1 (D2) clicks, then Charlie records his logic bit as
0 (1). If both detectors click, then Charlie randomly
records his logic bit out of 0 or 1.
3. Sifting. Aftersuﬃcientturnsoftheabovetwosteps,
Alice, Bob and Charlie announce their basis choices. We
denote the basis choice as Zi(Z∈ {X,Y},i∈ {a,b,c}),
where the subscript denotes who chooses the basis. If
the basis choice of Alice, Bob and Charlie is one of
{Xa,Xb,Xc},{Xa,Yb,Yc}and{Ya,Yb,Xc}, their logic
bits are sifted to form their raw key bits. If the basis
Laser PM Att Alice 
Laser PM Att 
Bob PM Charlie 
BS D1 
D2 
FIG. 1. Setup of our quantum secret sharing protocol. Alice
and Bob utilize lasers to emit optics pulses. They modu-
late the phase of their pulses with the phase modulator (PM)
according to their basis choices and logic bits. After being
dimmed by attenuators (Att), the pulses emitted byAlice and
Bob are sent to Charlie. After adding a phase shift {0,π/2}
on pulses sent by Bob, Charlie lets the two pulses interfere
with each other with a beam splitter (BS) and measures their
phase diﬀerence with two single-photon detectors D1 and D2.
choice of Alice, Bob and Charlie is {Ya,Xb,Yc}, Alice
and Bob sift their logic bits as their raw key bits, Charlie
ﬂips his corresponding logic bits to form his raw key bits.
Otherwise, they discard their logic bits.
4. Parameter estimation. When the basis choice is
one of{Xa,Xb,Xc}and{Xa,Yb,Yc}, the raw key bits
are used to form secure key bits and part of them are
consumed to analyze the bit error rate EX
b. When the
basis choice is one of {Ya,Xb,Yc}and{Ya,Yb,Xc}, Alice,
Bob and Charlie disclose their raw key bits to bound the
phase error rate Ep.
5. Post-processing. Alice, Bob and Charlie conduct
classical error correction and privacy ampliﬁcation on
the raw key bits, whose corresponding basis choice is
{Xa,Xb,Xc}or{Xa,Yb,Yc}, to distill the ﬁnal keys.
To introduce our QSS protocol more explicitly, we
demonstrate the bit correlation among Alice, Bob and
Charlie. We denote Si∈ {0,1}(i∈a,b,c) as a
classical bit, whose subscript denotes who holds this
bit. In Step 1, the weak coherent states prepared by
Alice (Bob) under the X basis can be expressed as
|eiSaπ√µ/an}bracketri}ht/parenleftbig
|eiSbπ√µ/an}bracketri}ht/parenrightbig
; the weak coherent states pre-
pared by Alice (Bob) under the Y basis can be expressed
as|ei(−Sa+3
2)π√µ/an}bracketri}ht/parenleftBig
|ei(−Sb+3
2)π√µ/an}bracketri}ht/parenrightBig
. Since the period
of the coherent state is 2 π, the weak coherent states pre-
pared by Alice (Bob) under the Y basis can be equiv-
alently expressed as |ei(Sa−1
2)π√µ/an}bracketri}ht/parenleftBig
|ei(Sb−1
2)π√µ/an}bracketri}ht/parenrightBig
af-
ter being imparted the phase 2( Sa−1)π(2(Sb−1)π).
In Step 2, the phase modulation added by Charlie is 0
(π/2) under the X (Y) basis. After Charlie modulates
the phase of the pulse sent by Bob, we determine the
phase diﬀerence between the two pulses sent by Alice
and Bob. When the basis choice of Alice, Bob and Char-
lie is one of {Xa,Xb,Xc},{Xa,Yb,Yc}and{Ya,Yb,Xc},
the phase diﬀerence can be written as ∆Φ = ( Sb−Sa)π,
based on which we can calculate the bit correlation as
Sc=Sa⊕Sb. When the basis choice of Alice, Bob and
Charlie is {Ya,Xb,Yc}, the phase diﬀerence can be writ-3
FIG. 2. Experimental setup of our QSS protocol. Cir, circula tor; PC, polarization controller; D1/D2, single-photon de tector;
BSi (i∈ {1.2.3.4.5}), beam splitter ; PM1/PM2/PM3/PM4, phase modulator; VOA, v ariable optical attenuator; DWDM, dense
wavelength division multiplexing. Note that the component s including DWDMs and Di (i ∈ {3,4,5,6}) are not experimentally
implemented due to resource limitations.
ten as ∆Φ = ( Sb−Sa+1)π. Note that Charlie ﬂips his
bits when the basis choice of Alice, Bob and Charlie is
{Ya,Xb,Yc}; therefore, the bits of the three participants
satisfy the same relationship that Sc=Sa⊕Sb. In other
words, Charlie’s raw key bits are exclusive ORs of Alice’s
and Bob’s raw key bits.
III. EXPERIMENTAL DEMONSTRATION
Fig.2shows the experimental setup of our QSS proto-
col. Thisisaplug-and-playsystemconsistingofaSagnac
interferometer. The frequency of the whole system is 100
MHz. The radio frequency signals provided for all PMs
and synchronizationsignals of the whole system are from
a high-speed arbitrary waveform generator with a sam-
pling rate of 2.5 Gs/s (Tabor Electronics, P2588B).
Optical pulses are generated by a pulsed laser held by
Charlie, with an extinction ratio greaterthan 30 dB. The
temperatureofthe DFB laseris modulatedappropriately
to provide optical pulses with a wavelength of 1550.12
nm. Charlie sends the optical pulses with a pulse width
of 150 ps to Alice and Bob. The pulses go through a cir-
culator (Cir) and are then separated by a 50:50 beam
splitter (BS) into two identical pulses before entering
the Sagnac loop. The Sagnac loop is used to stabilize
the phase ﬂuctuation of the channel automatically. The
counterclockwise (clockwise) pulses are only modulated
by Alice (Bob) without any other modulations. Since the
pulses are generated by a third party, dense wavelength
division multiplexings (DWDM), BSs and single-photon
detectors should be added in the system, which are used
for ﬁltering and intensity monitoring, to prevent attacks
from the injected pulses. Alice and Bob both select X
and Y bases with probabilities px= 80% and py= 20%.
Speciﬁcally, for the Xbasis, a 0 or πphase will be ran-
domly added, while for the Ybasis, aπ/2 or 3π/2 phase
will be added.
Alice (Bob) sends pulses after phase modulation to
Charlie. Alice’s pulses interfere with Bob’s pulses atCharlie’s BS after passing through a variable optical at-
tenuator (VOA) and a PM. The loss of communication
channels is simulated with the VOA between Alice (Bob)
and Charlie. Charlie adds only a phase 0 ( π/2) on Bob’s
pulses with a probability 80% (20%) while adding an un-
modulated phase 0 on Alice’s pulses. Since the detection
eﬃciencies of the two detectors are diﬀerent, even if we
randomlyencodethe pulse signalswith logicbits0/1, the
number of 0/1 bits in the two detectors’ detection results
are diﬀerent. To avoid the eﬀect of such a diﬀerence on
the ﬁnal results, we added an extra 0 ( π) phase to PM1,
with a probability of 50% (50%), to balance the 0/1 bits
of the two detectors’ detection results. Two outputs of
this BS are detected by two superconducting nanowire
single photon detectors, D1 and D2. The time windows
of D1 and D2 are 1.7 ns and 2.1 ns, respectively, which
are selected according to detection data. For D1, the
detection eﬃciency η1is 86.5% and the dark count rate
p1
d= 2.5×10−8. ForD2, η2= 93.4%andp2
d= 3.5×10−8.
Detailed experimental data during implementation can
be seen in Appendix. A. Random numbers used in im-
plementation are generated by Python’s module random.
IV. SECURITY ANALYSIS
In this section, we present the security proof of our
protocol. For simplicity, we assume that the source used
in our protocol is perfect and only consider an internal
eavesdropper when considering the security of the proto-
col. Since the information leaked to inside eavesdroppers
ismorethan the informationleakedtooutsideeavesdrop-
pers, such an approximationdoes not compromisethe se-
curity of our protocol. Then, we show that the security
of our protocol against an inside eavesdropper is equiv-
alent to the security of phase-encoded QKD. Based on
the equivalence, the security of our QSS protocol can be
demonstrated by utilizing the security analysis of phase-
encoded QKD [ 67,68]. Furthermore, we present the
ﬁnite-key analysis of our QSS protocol in Appendix. B4
a.
b.
c.
Laser PM 
Att 
PM Alice Bob 
BS BS 
D1 
BS BS 
Laser PM Att Alice 
Laser Att PM Bob 
BS 
D1 
D2 
Eve 
Laser PM Att Alice 
Laser Att PM Charlie 
BS 
D1 
D2 
Bob PM 
D2 
FIG. 3. Conﬁguration of phase-encoded QKD and our QSS
protocol. (a) Wepresentatypical schematic of phase-encod ed
QKD. In one period, Alice prepares a signal pulse (red) and
a reference pulse (blue). After modulating the phase of the
signal pulse, Alice sends the signal pulse and the reference
pulse to Bob. Bob modulates the phase of the reference pulse
and then makes the two pulses interfere to obtain their phase
diﬀerence. (b) An equivalent scheme of phase-encoded QKD,
in which eavesdropper Eve sends the reference pulses. (c) To
build an equivalence between the security of phase-encoded
QKD and our QSS protocol, we show the setup of our QSS
protocol.
and prove the security against coherent attacks in the
ﬁnite-key regime.
A. Security equivalence
In Fig.3, we show the setup of phase-encoded QKD
and our protocol. Fig. 3a shows the setup of phase-
encoded QKD. The laser source at Alice’s site generates
two pulses in one period, referring to one pulse as the
signal pulse and the other pulse as the reference pulse.
Alice modulates only the phase of the signal pulse and
does not modulate the phase of the reference pulse. For
the signal pulse, Alice selects one basis from X and Y. In
the X basis, Alice phase modulates the signal pulse with
{0,π}. In the Y basis, Alice phase modulates the signal
pulse with {π/2,3π/2}. When the pulses reach Bob’s
site, Bob selects one basis from X and Y for each pulse.
Under the X(Y) basis, Bob imparts a phase 0 ( π/2) to
the reference pulse. Then, Bob makes the two pulses in-
terfere and measures them with two detectors D1 andD2.
As an intermediate step, we consider an equivalent
scheme (Fig. 3b) of phase-encoded QKD (Fig. 3a). In
this scheme, Alice sends signal pulses in the same way as
phase-encoded QKD, while the eavesdropper Eve sends
the reference pulses. Since the security of phase-encoded
QKD can be proven even if the eavesdropper knows the
phase of the reference pulse [ 67], the two schemes are
equivalent from a security perspective. To build the
equivalence of security between phase-encoded QKD and
our QSS protocol, we present the setup of our protocol
in Fig.3c. We consider the case with an inside eaves-
dropper and assume that Bob is the inside eavesdropper.
Comparing Fig. 3b and Fig. 3c, we ﬁnd that the diﬀer-
ence between the two schemes is that Eve, the eavesdrop-
per in phase-encoded QKD, sends reference pulses, while
Bob, the eavesdropper in our QSS scheme, sends phase-
encoded pulses. Since the phase information imparted
on the pulse sent by the eavesdropper has no inﬂuence
on the security of phase-encoded QKD, the security of
phase-encoded QKD can be proven to be equivalent to
the security against an inside eavesdropper of our QSS
protocol.
B. Inside eavesdropper
Without loss of generality, let us assume that Bob is
an internal eavesdropper. We introduce the concept of
“quantum coin” to bound the information leakage of the
signal sent by Alice. The imbalance ∆ of the “quantum
coin” is related to the basis dependence of the signal of
Alice. Alice’s basis-dependent entangled states can be
expressed as
|Ψx/an}bracketri}ht= (|0X/an}bracketri}ht⊗|α/an}bracketri}ht+|1X/an}bracketri}ht⊗|−α/an}bracketri}ht)/√
2,
|Ψy/an}bracketri}ht= (|1Y/an}bracketri}ht⊗|iα/an}bracketri}ht+|0Y/an}bracketri}ht⊗|−iα/an}bracketri}ht)/√
2,(1)
where|0X/an}bracketri}ht,|1X/an}bracketri}htare eigenstates of the Pauli operator
σxand|0Y/an}bracketri}ht,|1Y/an}bracketri}htare eigenstates of the Pauli operator
σy. To quantify the basis dependence of Alice’s signal
pulses, we can relate the basis dependence with the “bal-
ance” of a “quantum coin” in an equivalent protocol [ 67].
In this equivalent protocol, Alice measures the quantum
coin in the basis |0Z/an}bracketri}ht,|1Z/an}bracketri}htto determine whether Alice
sends state |Ψx/an}bracketri}htor state |Ψy/an}bracketri}ht. The joint state of the
quantum coin state and Alice source state can be taken
to be
|Φ/an}bracketri}ht=√px|0Z/an}bracketri}ht⊗|Ψx/an}bracketri}ht+√py|1Z/an}bracketri}ht⊗|Ψy/an}bracketri}ht,(2)
wherepxandpyare the probability with which Alice en-
codes her signal in the X basis and in the Y basis, respec-
tively. Furthermore, we assume that the measurement of
the coin is delayed until after the eavesdropperis ﬁnished
eavesdropping on the signals. In our QSS protocol, when
Alice, Bob and Charlie’s basis choice is {Ya,Xb,Yc}or
{Ya,Yb,Xc}, their logical bits are used to calculate phase5
errors. The phase error rate Epcan be bounded by a
function of EY
band ∆ and expressed as
Ep=EY
b+4∆(1−∆)(1−2EY
b)
+4(1−2∆)/radicalBig
∆(1−∆)EY
b(1−EY
b),(3)
whereEY
bis the bit error rate, which is calculated by us-
ingthekeybitscorrespondingtobasischoice {Ya,Xb,Yc}
or{Ya,Yb,Xc}, and ∆ quantiﬁes the basis dependence of
Alice’s signals. ∆ can be calculated by
1−2Qµ∆ =/an}bracketle{tΨy|Ψx/an}bracketri}ht, (4)
whereQµis the total gain of the protocol.
In the asymptotic case, the ﬁnal key rate of our QSS
protocol can be expressed as
R=Qµ[1−feH(EX
b)−H(Ep)], (5)
wherefeis the error-correction eﬃciency; EX
bis the
bite error rate of the raw key bits whose correspond-
ing basis choice is {Xa,Yb,Yc}or{Xa,Xb,Xc};H(x) =
−xlog2x−(1−x)log2(1−x) is Shannon entropy. For
Charlie’s two detectors, we assume that the dark count
rate of both is pd.Qµis the gain corresponding to
the basis choice {Xa,Yb,Yc}and{Xa,Xb,Xc}. With a
light intensity µof weak coherent states, Qµis given by
Qµ= (1−pd)[1−(1−2pd)e−2µη]. The bit error rate EX
b
is given by EX
bQµ=ed(1−pd)[1−(1−pd)e−2µη]+(1−
ed)pd(1−pd)e−2µη, whereedis the misalignment error
rate of the detectors.
V. RESULTS
Here, to evaluate the performance of our protocol, we
conduct the ﬁnite key rate of our QSS protocol. In the
above section, we obtain the information leakage to ma-
licious Bob. Since the information leakage to malicious
Bob is greater than that to external Eve, we can con-
sider the information leakage in our protocol to be the
information leakage to malicious Bob. Alice and Bob are
two symmetric participants in our protocol, so we take
the total distance between Alice and Bob as Lin the
simulation. Based on such a conﬁguration, the channel
transmittance ηbecomes ηd×10−αL/20, whereηdis the
detection eﬃciency of Charlie’s detectors and αis the
attenuation coeﬃcient of the ultra-low ﬁber.
A. Simulation results
The ﬁnite key rate of our QSS protocol can be given
by
l=nx/bracketleftbigg
1−H(Ep)−leakEC
−1
nxlog22
ǫc−1
nxlog21
4ǫ2
PA/bracketrightbigg
,(6)0 50 100 150 200 250
Total fiber transmission distance(km)10-810-710-610-510-410-3key rate (bit / pulse)
FIG. 4. Simulation key rate with variant misalignment rates .
Simulation results for ﬁnite ﬁnal key rate as a function of
ﬁber transmission length with a ﬁxed key length N= 1010
and misalignment rate ed= 2%,4%,6%.
ǫcandǫPArepresent the probability of failure in error
correction and privacy ampliﬁcation, respectively. nx
denotes the number of raw key bits used to generate
the secret key bits whose corresponding basis choice is
{Xa,Xb,Xc}or{Xa,Yb,Yc}. leakEC=feH(EX
b) repre-
sents the fraction of bits consumed for error correction,
wherefeis the error-correction eﬃciency and EX
brepre-
sents the bit error rate of the raw key bits whose cor-
responding basis choice is {Xa,Xb,Xc}or{Xa,Yb,Yc}.
Epis the upper bound of the phase error rate, whose
detailed formulas are given in Appendix. B.
Assuming the size of the ﬁnite key is N= 1010, we
utilize the genetic algorithm to optimize the ﬁnite key
rate under a certain distance with the misalignment rate
ed= 2%,4%,6%. Other simulation parameters are sum-
marized as follows: ηd= 56%,pd= 10−8,α= 0.167, and
fe= 1.16. We show our simulation result in Fig. 4. As
shown in Fig. 4, our QSS protocol achieves a transmis-
sion distance of more than 230 km when the misalign-
ment rate ed= 2%. Furthermore, our protocols show
tolerance for high misalignment error rates. With an er-
ror rate of 6 %, a transmission distance of 150 km can
still be obtained.
B. Experimental results
We implement our protocol in the ﬁnite-key regime
over various losses of 20, 30, and 35 dB. Under various
losses, we performed this protocol with optimized inten-
sity and a ﬁxed ratio of X basis to Y basis (4:1).
The experimental results we obtained are listed in Ta-
bleIand shown in Fig. 5. Given the 100-MHz repetition
rate, our protocol can achieve a secure key rate of 85.3
bps with a channel loss of over 35 dB, allowing it to be6
TABLE I. Experimental data. We demonstrate the feasibility of our protocol under diﬀerent channel losses. N is the numbe r
of pulses sent, µis the higher intensity of the pulses sent by Alice and Bob, EX
bandEY
bare the experimental quantum bit
error rates in the Xbasis and Ybasis,nxandnyare the number of clicks in the Xbasis and Ybasis,Ris the key rate.
Loss N µ EX
bEY
bnx ny R
20 dB 10105.8×10−30.16% 0.09% 2776599 315364 7.51 ×10−5
30 dB 10101.6×10−30.19% 0.09% 239619 27474 4.67 ×10−6
35 dB 10108.6×10−40.30% 0.30% 73954 8346 8.53 ×10−7
0 10 20 30 40
Channel loss (dB)10-710-610-510-410-310-210-1Key rate (bit / pulse)
FIG. 5. Secure key rate of our QSS scheme. The secure key
rates are plotted against the total loss from Alice to Bob wit h
thetotalnumberofpulsessentbyAliceorBob N= 1010. The
triangular-type dots correspond to the experimental resul ts
with ﬁber transmitting losses of 20 dB, 30 dB, and 35 dB.
deployed over 175 km with available technologies. A se-
cure key rate of 7.51 kbps was generated at 20 dB ( ∼100
km) while at 30 dB ( ∼150 km), it was 467 bps. Note
that the intensities of pulses sent by Alice and Bob are
diﬀerent due to the diﬀerent insertion losses of Charlie’s
PMs and the diﬀerence has little inﬂuence on results. We
used the larger value of the pulse intensity to calculate
the ﬁnal result, which results in a lower key rate.
As a tradeoﬀ for automatic phase stabilization, long-
distance optical ﬁbers were not used in the system and
the twouserswereconnectedwith aone-meter-longﬁber.
Two users in the plug-and-play system are unable to re-
sist Trojan horseattacks. Additionally, due to the lackof
DWDMs and photodiodes, we did not actually monitor
the intensity and ﬁlter pulses, which should be addressed
to prevent potential attacks. However, instead of estab-
lishing a complete system with all necessaryelements, we
concentrateondemonstratingthe feasibilityofourproto-
col. The lacking devices can be directly added to our sys-
tem without invalidating the obtained experimental re-
sults. Employing the developed technology in twin-ﬁeld
QKD, such as phase-locking and phase-tracking [ 60–66],
a scheme with two independent users and long-distance
ﬁbers can be realized.VI. CONCLUSION
In summary, we proposea quantum secret sharingpro-
tocol that balances security and practicality. The use
of weak coherent states in our protocol removes the re-
quirements for impractical entangled sources. Our pro-
tocol removes the requirements for intensity modulation
and phase randomization, which avoids pattern eﬀects
in experimental implementation and enables commercial
applications of our protocol. In addition, our protocol
uses the same device as twin-ﬁeld QKD [ 60–66] and can
therefore be implemented with existing devices. Further-
more, our QSS protocol can be directly used for eﬃcient
quantum digital signatures [ 24]. Using the concentration
inequality [ 58,59] to consider statistical ﬂuctuations, we
provide a ﬁnite-key analysis against coherent attacks for
our QSS protocol. In the ﬁnite-key regime, our QSS pro-
tocol achieves a theoretical transmission distance over
230kmunderasmallmisalignmenterrorratewhileshow-
ing tolerance for high misalignment rates, which makes
ﬁeld tests possible.
Furthermore, we experimentally demonstrate our pro-
tocol in a plug-and-play system. Our protocol can be
demonstrated over 35 dB with the ability to resist co-
herent attacks. Without intensity modulation and phase
randomization, our protocol can still achieve a key rate
of 85.3 bps under a 35 dB channel loss, which outper-
forms other experimental implementations of QSS proto-
cols. In addition, we also achieve key rates of 7.51 kbps
and 0.467 kbps at 20 dB and 30 dB, respectively. Com-
bined with high security and simple apparatus require-
ments, our protocol paves the way for secure multiparty
communication in future quantum networks.
ACKNOWLEDGMENTS
This study was supported by the National Natu-
ral Science Foundation of China (No. 12274223), the
Natural Science Foundation of Jiangsu Province (No.
BK20211145), the Fundamental Research Funds for the
Central Universities (No. 020414380182), the Key Re-
search and Development Program of Nanjing Jiangbei
New Aera (No. ZDYD20210101), the Program for Inno-
vative Talents and Entrepreneurs in Jiangsu (No. JSS-
CRC2021484), and the Program of Song Shan Lab-
oratory (Included in the management of Major Sci-
ence and Technology Program of Henan Province) (No.7
221100210800-02).
Appendix A: Detailed experimental data
Detailed experimental data are presented in Table III,
including the number of all detection events n and the
number of detection events under diﬀerent added phases.
The number of detection events under diﬀerent phases
added is named as “Detected ABC”, where “A” (“B” or
“C”) means an A(B or C) phase was added on the pulses
by Alice (Bob or Charlie) . The pre-calibrated losses are
depictedinTable II.TheelementsincludePMs,PCs,Cir,
and BSs. The results are given for each output (D1/D2)
as appropriate.
TABLE II. Eﬃciencies of the elements of the measurement
station.
Optical devices Insertion loss
Cir 2→3 0.62 dB
BS-A 0.69 dB
BS-B 0.70 dB
PM-A 1.93 dB
PM-B 2.01 dB
PC1 0.18 dB
PC2 0.16 dB
Appendix B: Finite-key analysis
Here, weprovidethe ﬁnite-keyanalysisofourprotocol.
Using the concentration inequality [ 59] in Ref. [ 58], we
provide security against coherent attacks. The formula
of the ﬁnite key rate can be expressed as
l=nx/bracketleftbigg
1−H(Ep)−leakEC
−1
nxlog22
ǫc−1
nxlog21
4ǫ2
PA/bracketrightbigg
,(B1)
which is proven to be ǫc-correct and ǫs-secure, with
ǫs=√ǫ+ǫPA.ǫis the failure probability associated
with the estimation of the phase error rate. ǫcand
ǫPArepresent the probability of failure in error correc-
tion and privacy ampliﬁcation, respectively. nxdenotes
the number of raw key bits used to generate the secret
keybits whosecorrespondingbasischoiceis {Xa,Xb,Xc}
or{Xa,Yb,Yc}. leakEC=feH(EX
b) represents the frac-
tion of bits consumed for error correction, where feis
the error-correction eﬃciency and EX
brepresents the bit
error rate of the raw key bits whose corresponding ba-
sis choice is {Xa,Xb,Xc}or{Xa,Yb,Yc}. In addition,
we apply statistical ﬂuctuations to calculate the upper
bound of the observed phase error rate Ep. When con-
sidering statistical ﬂuctuations, we use the concentrationinequality [ 58,59] to estimate the upper bound of the
deviation between a sum of correlated random variables
and its expected value. The concentration inequality is
tighterthan the widely employedAzuma’s inequality [ 69]
and proves the security against coherent attacks.
We deﬁne ξ1,...,ξnto be a sequence of Bernoulli ran-
dom variables and deﬁne Λ jto be the sum of these ran-
dom variables, i.e. Λ j=/summationtextj
u=1ξu. LetFjdenote the
σ-algebra generated by {ξ1,...,ξn}that is the natural ﬁl-
tration of those Bernoulli random variables. Let ǫade-
note the failure probabilities for the concentration bound
for sums of dependent random variables. Using the re-
sults in Refs. [ 58,59], we ﬁnd that for any b >0
Pr/bracketleftBigg
Λn−n/summationdisplay
u=1Pr(ξu= 1|Fu−1)≥b√n/bracketrightBigg
≤exp[−2b2],
Pr/bracketleftBiggn/summationdisplay
u=1Pr(ξu= 1|Fu−1)−Λn≥b√n/bracketrightBigg
≤exp[−2b2].
(B2)
Equating the right-hand sides of eq. ( B2) toǫaand solv-
ing forb, we ﬁnd a simple bound of concentration in-
equality, which can be expressed as
n/summationdisplay
u=1Pr(ξu= 1|ξ1,...,ξu−1)≤Λn+∆c,
Λn≤n/summationdisplay
u=1Pr(ξu= 1|ξ1,...,ξu−1)+∆c,(B3)
where ∆ c=/radicalBig
1
2nlnǫ−1aandǫais the maximum of failure
probability in each of the bounds in eq. ( B3). Without
loss of generation, we set ǫc=ǫPA=ǫ=ǫa= 10−10.
With the concentration inequalities, we can estimate
the upper bound of the phase error rate Ep. Assuming
that Bob is the internal eavesdropper, the raw key bits
aredividedintotwopartsbasedonAlice’sbasis. Theraw
key bits in the X basis are used to form secure key bits
andestimatethe bit errorrateand therawkeybits in the
Y basis are used to bound the phase error rate. First, we
oﬀerthenumberofbiterrorsandthenumberofdetection
events in the Y basis and then record them as myand
ny. In addition, the number of detection events in the X
basis is also oﬀered and recorded as nx. Then, we use the
concentration inequality to obtain the upper bound m′
y
on the expected number of bit errors in the Y basis, with
which we ﬁnd the upper bound EY
b′=m′
y/nyon the
expected bit error rate in the Y basis. Based on eq. ( 3),
the expected phase error rate in the X basis E′
pcan be
bounded by EY
b′. Then we ﬁnd the expected number of
phase errorsin the X basis m′
p=nxE′
P. Next, we use the
concentrationinequalitytocalculatetheupperbound mp
on the observed number of phase errors in the X basis.
Then we can derive Epwith the formula Ep=mp/nx.8
TABLE III. Detailed experimental data under diﬀerent chann el losses.
Channel loss 20 dB 30 dB 35 dB
n 5135663 442749 136412
Detector D1 D2 D1 D2 D1 D2
Detected 000 567134 1426 48972 127 15129 74
Detected 0 π0 1085 762615 104 66325 48 20236
Detected π00 725 718749 92 61975 39 19103
Detected ππ0 581843 1002 49848 111 15535 51
Detected 0π
2π
229 36425 4 3085 2 964
Detected 03π
2π
233149 87 2785 9 886 4
Detected ππ
2π
231191 41 2648 5 817 4
Detected π3π
2π
221 41077 5 3524 2 1060
Detectedπ
2π
20 37300 30 3261 0 1032 1
Detectedπ
23π
20 22 40704 0 3515 1 1065
Detected3π
2π
20 42 44354 4 3864 4 1222
Detected3π
23π
20 39512 50 3462 6 1055 6
Detectedπ
20π
237565 45 3231 5 975 2
Detectedπ
2ππ
238 37342 3 3199 6 959
Detected3π
20π
228 38821 5 3412 3 987
Detected3π
2ππ
239469 42 3505 2 1026 2
[1]N. Gisin and R. Thew, Quantum communication, Nat.
Photonics 1, 165 (2007).
[2]H. J. Kimble, The quantum internet, Nature 453, 1023
(2008).
[3]W. J. Munro, A. M. Stephens, S. J. Devitt, K. A. Harri-
son, and K. Nemoto, Quantum communication without
the necessity of quantum memories, Nat. Photonics 6,
777 (2012).
[4]W. Zhang, D.-S. Ding, Y.-B. Sheng, L. Zhou, B.-S. Shi,
and G.-C. Guo, Quantum secure direct communication
with quantum memory, Phys. Rev. Lett. 118, 220501
(2017).
[5]X. Liu, Z. Li, D. Luo, C. Huang, D. Ma, M. Geng,
J. Wang, Z. Zhang, and K. Wei, Practical decoy-state
quantum secure direct communication, Sci. China-Phys.
Mech. Astron. 64, 120311 (2021).
[6]X.-P. Zhang, L.-T. Shen, Y. Zhang, L. Sun, H. Wu, Z.-B.
Yang, and Z.-Q. Yin, External control of qubit-photon
interaction and multi-qubit reset in a dissipative quan-
tum network, Sci. China-Phys. Mech. Astron. 64, 250311
(2021).
[7]X. Liu, D. Luo, G. Lin, Z. Chen, C. Huang, S. Li,
C. Zhang, Z. Zhang, and K. Wei, Fiber-based quan-
tum secure direct communication without active polar-
ization compensation, Sci. China-Phys. Mech. Astron.
65, 120311 (2022).
[8]Y.-B.Sheng, L.Zhou,andG.-L.Long,One-stepquantum
secure direct communication, Sci. Bull. 67, 367 (2022).
[9]L. Zhou and Y.-B. Sheng, One-step device-independent
quantum secure direct communication, Sci. China-Phys.
Mech. Astron. 65, 250311 (2022).
[10]C. H. Bennett and G. Brassard, Quantum cryp-
tography: Public key distribution and coin tossing,
Theor. Comput. Sci. 560, 7 (2014) .
[11]M. Lucamarini, Z. L. Yuan, J. F. Dynes, and A. J.
Shields, Overcoming the rate–distance limit of quantum
keydistribution withoutquantumrepeaters, Nature 557,
400 (2018).[12]W.-B. Liu, C.-L. Li, Y.-M. Xie, C.-X. Weng, J. Gu,
X.-Y. Cao, Y.-S. Lu, B.-H. Li, H.-L. Yin, and Z.-B.
Chen,Homodynedetectionquadraturephaseshiftkeying
continuous-variable quantum key distribution with high
excess noise tolerance, PRX Quantum 2, 040334 (2021).
[13]C. Zhou, X.Wang, Z.Zhang, S.Yu, Z.Chen,andH.Guo,
Rate compatible reconciliation for continuous-variable
quantum key distribution using raptor-like ldpc codes,
Sci. China-Phys. Mech. Astron. 64, 260311 (2021).
[14]Y.-A. Chen, Q. Zhang, T.-Y. Chen, W.-Q. Cai, S.-K.
Liao, J. Zhang, K. Chen, J. Yin, J.-G. Ren, Z. Chen,
et al., An integrated space-to-ground quantum commu-
nication network over 4,600 kilometres, Nature 589, 214
(2021).
[15]H. Liu, C. Jiang, H.-T. Zhu, M. Zou, Z.-W. Yu, X.-L.
Hu, H. Xu, S. Ma, Z. Han, J.-P. Chen, et al., Field test
of twin-ﬁeld quantum key distribution through sending-
or-not-sendingover428km,Phys.Rev.Lett. 126, 250502
(2021).
[16]B. Liu, S. Xia, D. Xiao, W. Huang, B. Xu, and Y. Li,
Decoy-state method for quantum-key-distribution-based
quantum private query, Sci. China-Phys. Mech. Astron.
65, 240312 (2022).
[17]Y.-M. Xie, Y.-S. Lu, C.-X. Weng, X.-Y. Cao, Z.-Y. Jia,
Y. Bao, Y. Wang, Y. Fu, H.-L. Yin, and Z.-B. Chen,
Breakingtherate-loss boundofquantumkeydistribution
with asynchronous two-photon interference, PRX Quan-
tum3, 020315 (2022).
[18]Y. Zhang, S. Liu, B. Jing, Q. He, and S. Luo, Reveal-
ingnonclassicality vias-orderedphase-spacedistributi on,
Sci. China-Phys. Mech. Astron. 65, 110311 (2022).
[19]J.-P. Chen, C. Zhang, Y. Liu, C. Jiang, D.-F. Zhao, W.-
J. Zhang, F.-X. Chen, H. Li, L.-X. You, Z. Wang, et al.,
Quantum key distribution over 658 km ﬁber with dis-
tributed vibration sensing, Phys. Rev. Lett. 128, 180502
(2022).
[20]J. Gu, X.-Y. Cao, Y. Fu, Z.-W. He, Z.-J. Yin, H.-L.
Yin, and Z.-B. Chen, Experimental measurement-device-9
independent type quantum key distribution with ﬂawed
and correlated sources, Sci. Bull. 67, 2167 (2022) .
[21]F. Xu, Y.-Z. Zhang, Q. Zhang, and J.-W. Pan, Device-
independent quantum key distribution with random
postselection, Phys. Rev. Lett. 128, 110506 (2022) .
[22]H.-L. Yin, Y. Fu, and Z.-B. Chen, Practical quantum
digital signature, Phys. Rev. A 93, 032316 (2016) .
[23]G. L. Roberts, M. Lucamarini, Z. L. Yuan, J. F.
Dynes, L. C. Comandar, A. W. Sharpe, A. J. Shields,
M.Curty,I.V.Puthoor,andE.Andersson,Experimental
measurement-device-independent quantum digital signa-
tures,Nat. Commun. 8, 1098 (2017) .
[24]H.-L. Yin, Y. Fu, C.-L. Li, C.-X. Weng, B.-H. Li, J. Gu,
Y.-S. Lu, S. Huang, and Z.-B. Chen, Experimental quan-
tum secure network with digital signatures and encryp-
tion,Natl. Sci. Rev. 10, nwac228 (2023) .
[25]M. Hillery, V. Buˇ zek, and A. Berthiaume, Quantum se-
cret sharing, Phys. Rev. A 59, 1829 (1999).
[26]R. Cleve, D. Gottesman, and H.-K. Lo, How to share a
quantum secret, Phys. Rev. Lett. 83, 648 (1999) .
[27]A. Shamir, How to share a secret, Commun. ACM 22,
612 (1979).
[28]G. R. Blakley, Safeguarding cryptographic keys (1979).
[29]C. H. Bennett, Quantum cryptography using any two
nonorthogonal states, Phys. Rev. Lett. 68, 3121 (1992) .
[30]G.-P. Guo and G.-C. Guo, Quantum secret sharing with-
out entanglement, Phys. Lett. A 310, 247 (2003).
[31]A. M. Lance, T. Symul, W. P. Bowen, B. C. Sanders,
and P. K. Lam, Tripartite quantum state sharing,
Phys. Rev. Lett. 92, 177903 (2004) .
[32]L. Xiao, G. L. Long, F.-G. Deng, andJ.-W. Pan, Eﬃcient
multiparty quantum-secret-sharing schemes, Phys. Rev.
A69, 052307 (2004).
[33]Z.-J. Zhang, Y. Li, and Z.-X. Man, Multiparty quantum
secret sharing, Phys. Rev. A 71, 044301 (2005) .
[34]F.-L. Yan and T. Gao, Quantum secret sharing between
multiparty and multiparty without entanglement, Phys.
Rev. A72, 012304 (2005).
[35]F.-G. Deng, H.-Y. Zhou, and G. L. Long, Circular quan-
tum secret sharing, J. Phys. A: Math. Gen. 39, 14089
(2006).
[36]S.-J. Qin, F. Gao, Q.-Y. Wen, and F.-C. Zhu, Crypt-
analysis of the hillery-buˇ zek-berthiaume quantum secret -
sharing protocol, Phys. Rev. A 76, 062324 (2007).
[37]D. Markham and B. C. Sanders, Graph states for quan-
tum secret sharing, Phys. Rev. A 78, 042309 (2008).
[38]Y. Zhou, J. Yu, Z. Yan, X. Jia, J. Zhang, C. Xie, and
K. Peng, Quantum secret sharing among four players us-
ing multipartite bound entanglement of an optical ﬁeld,
Phys. Rev. Lett. 121, 150502 (2018) .
[39]Z. Gao, T. Li, and Z. Li, Deterministic measurement-
device-independent quantum secret sharing, Sci. China-
Phys. Mech. Astron. 63, 120311 (2020).
[40]Y.-G. Yang, Y.-C. Wang, Y.-L. Yang, X.-B. Chen, D. Li,
Y.-H. Zhou, and W.-M. Shi, Participant attack on the
deterministic measurement-device-independent quantum
secret sharing protocol, Sci. China-Phys. Mech. Astron.
64, 260321 (2021).
[41]Y.-A. Chen, A.-N. Zhang, Z. Zhao, X.-Q. Zhou, C.-Y.
Lu, C.-Z. Peng, T. Yang, and J.-W. Pan, Experimental
quantumsecret sharing and third-man quantumcryptog-
raphy,Phys. Rev. Lett. 95, 200502 (2005) .
[42]C. Schmid, P. Trojek, M. Bourennane, C. Kurt-siefer, M. ˙Zukowski, and H. Weinfurter, Ex-
perimental single qubit quantum secret sharing,
Phys. Rev. Lett. 95, 230505 (2005) .
[43]S. Gaertner, C. Kurtsiefer, M. Bourennane, and H. Wein-
furter, Experimental demonstration of four-party quan-
tum secret sharing, Phys. Rev. Lett. 98, 020503 (2007) .
[44]J. Bogdanski, N. Raﬁei, and M. Bourennane, Experi-
mental quantum secret sharing using telecommunication
ﬁber, Phys. Rev. A 78, 062307 (2008).
[45]K.-J. Wei, H.-Q. Ma, and J.-H. Yang, Experimental cir-
cular quantum secret sharing over telecom ﬁber network,
Opt. Express 21, 16663 (2013).
[46]B. Bell, D. Markham, D. Herrera-Mart´ ı, A. Marin,
W. Wadsworth, J. Rarity, and M. Tame, Experimen-
tal demonstration of graph-state quantum secret sharing,
Nat. Commun. 5, 5480 (2014).
[47]H.Lu, Z.Zhang, L.-K.Chen, Z.-D.Li, C.Liu, L.Li, N.-L.
Liu, X. Ma, Y.-A.Chen, and J.-W. Pan, Secret sharing of
a quantum state, Phys. Rev. Lett. 117, 030501 (2016) .
[48]A. Tavakoli, I. Herbauts, M. ˙Zukowski, and M. Bouren-
nane, Secret sharing with a single d-level quantum sys-
tem, Phys. Rev. A 92, 030302 (2015).
[49]M. Hai-Qiang, W.Ke-Jin,andY.Jian-Hui,Experimental
single qubit quantum secret sharing in a ﬁber network
conﬁguration, Opt. Lett. 38, 4494 (2013).
[50]G. P. He, Comment on “experimental single qubit quan-
tumsecretsharing”, Phys. Rev. Lett. 98, 028901 (2007) .
[51]C. Schmid, P. Trojek, M. Bourennane, C. Kurtsiefer,
M.˙Zukowski, and H. Weinfurter, Schmid et al. reply:,
Phys. Rev. Lett. 98, 028902 (2007) .
[52]F. Xu, X. Ma, Q. Zhang, H.-K. Lo, and J.-W. Pan,
Secure quantum key distribution with realistic devices,
Rev. Mod. Phys. 92, 025002 (2020) .
[53]K. Inoue, T. Ohashi, T. Kukita, K. Watan-
abe, S. Hayashi, T. Honjo, and H. Takesue,
Diﬀerential-phase-shift quantum secret sharing,
Opt. Express 16, 15469 (2008) .
[54]Z.-Y. Jia, J. Gu, B.-H. Li, H.-L. Yin, and Z.-B. Chen,
Diﬀerential phase shift quantum secret sharing using a
twin ﬁeld with asymmetric source intensities, Entropy
23, 716 (2021).
[55]J. Gu, X.-Y. Cao, H.-L. Yin, and Z.-B. Chen, Diﬀerential
phase shift quantum secret sharing using a twin ﬁeld,
Opt. Express 29, 9165 (2021) .
[56]K. Wei, X. Yang, C. Zhu, and Z.-Q. Yin, Quantum secret
sharing without monitoring signal disturbance, Quantum
Inf. Process. 17, 1 (2018).
[57]J. Gu, Y.-M. Xie, W.-B. Liu, Y. Fu, H.-L. Yin, and Z.-
B. Chen, Secure quantum secret sharing without signal
disturbance monitoring, Opt. Express 29, 32244 (2021) .
[58]G. Curr´ as-Lorenzo, ´A. Navarrete, K. Azuma, G. Kato,
M. Curty, and M. Razavi, Tight ﬁnite-key security for
twin-ﬁeld quantum key distribution, npj Quantum Inf.
7, 22 (2021).
[59]G. Kato, Concentration inequality using unconﬁrmed
knowledge, arXiv preprint arXiv:2002.04357 (2020).
[60]X. Zhong, J. Hu, M. Curty, L. Qian, and H.-
K. Lo, Proof-of-principle experimental demonstra-
tion of twin-ﬁeld type quantum key distribution,
Phys. Rev. Lett. 123, 100506 (2019) .
[61]X.-T. Fang, P. Zeng, H. Liu, M. Zou, W. Wu,
Y.-L. Tang, Y.-J. Sheng, Y. Xiang, W. Zhang,
H. Li,et al., Implementation of quantum key distri-10
bution surpassing the linear rate-transmittance bound,
Nat. Photonics 14, 422 (2020) .
[62]M. Pittaluga, M. Minder, M. Lucamarini, M. Sanzaro,
R. I. Woodward, M.-J. Li, Z. Yuan, and A. J. Shields,
600-km repeater-like quantum communications with
dual-band stabilization, Nat. Photonics 15, 530 (2021) .
[63]J.-P. Chen, C. Zhang, Y. Liu, C. Jiang, W.-J. Zhang, Z.-
Y.Han,S.-Z.Ma, X.-L.Hu, Y.-H.Li, H.Liu, et al.,Twin-
ﬁeld quantumkeydistribution overa 511 km optical ﬁbre
linking two distant metropolitan areas, Nat. Photonics
15, 570 (2021).
[64]S. Wang, Z.-Q. Yin, D.-Y. He, W. Chen, R.-Q. Wang,
P. Ye, Y. Zhou, G.-J. Fan-Yuan, F.-X. Wang, Y.-G. Zhu,
et al., Twin-ﬁeld quantum key distribution over 830-km
ﬁbre, Nat. Photonics 16, 154 (2022).
[65]L. Zhou, J. Lin, Y. Jing, and Z. Yuan, Twin-ﬁeld quan-tum key distribution without optical frequency dissemi-
nation, Nat. Commun. 14, 928 (2023).
[66]C. Clivati, A. Meda, S. Donadello, S. Virz` ı, M. Genovese,
F. Levi, A. Mura, M. Pittaluga, Z. Yuan, A. J. Shields,
et al., Coherent phase transfer for real-world twin-ﬁeld
quantumkeydistribution, Nat. Commun. 13, 157(2022).
[67]H.-K. Lo and J. Preskill, Security of quantum key dis-
tribution using weak coherent states with nonrandom
phases, Quantum Inf. Comput. 7, 431 (2007).
[68]M. Koashi, Simple security proof of quan-
tum key distribution based on complementarity,
New J. Phys. 11, 045018 (2009) .
[69]K. Azuma, Weighted sums of certain dependent random
variables, Tohoku Math. J. 19, 357 (1967) .