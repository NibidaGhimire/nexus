Wireless Networks manuscript No.
(will be inserted by the editor)
Matched-Filter Design to Improve Self-Interference
Cancellation in Full-Duplex Communication Systems
Mohammad Lari
the date of receipt and acceptance should be inserted later
Received: date / Accepted: date
Abstract A new method for capacity and spectral eciency increases is a full-
duplex (FD) communication, where sending and receiving are done simultane-
ously. Hence, severe interference leaked from the transmitter to the receiver,
which can disrupt the system's operation completely. For interference reduc-
tion, the transceiver tries to estimate the interfering symbols to remove their
eects. A typical method is to use the Hammerstein model. In this method,
nonlinear power amplier (PA) and multipath channel are modeled with a suc-
cessive nonlinear system and a nite impulse response (FIR) lter. Then, the
model parameters are adjusted, and interference symbols are estimated from
the transmitted symbols. In the Hammerstein method, the interference sym-
bols are estimated directly from the transmitted symbols. But practically, the
transmitted symbols rst pass through the pulse-shaping lter and become a
signal. Then, this signal passes through the nonlinear PA and communication
channel. Finally, the received signal is ltered by the matched lter (MF) at
the receiver and converted to the symbols again. In this procedure, the ampli-
er and the communication channel aect the transmitted signal directly and
distort transmitted symbols indirectly. Therefore, in the practical situation,
when we consider the transmitter's pulse-shaping lter and the receiver's MF,
the estimated symbols with the Hammerstein method are erroneous. To solve
this problem, a new MF at the receiver is proposed and adjusted according to
the interfering signal. We have shown that this method is far better than the
Hammerstein method.
Keywords Full-duplexHammersteinMatched-lterPulse-shaping lter 
Self-interference cancellation
M. Lari
Electrical and Computer Engineering Faculty, Semnan University, Semnan, Iran
E-mail: m lari@semnan.ac.irarXiv:2305.12101v1  [cs.IT]  20 May 20232 Mohammad Lari
1 Introduction
With the increasing number of telecommunication subscribers and their need
for higher data rates, service providers use new and various methods to re-
spond to these requests. One promising method is the use of full-duplex (FD)
instead of the familiar half-duplex (HD) communication systems [1]. In most
communication systems, such as mobile cellular networks, the number of nodes
(transceivers) is more than one. These nodes sometimes send data in the
role of transmitter and sometimes receive data in the role of receiver. These
transceivers with HD function send and receive at dierent time slots or dier-
ent frequency slots. Since send and receive are separate in time or frequency,
the transmitted signal does not interfere with the received signal. Therefore,
each transceiver needs two time slots or two frequency slots for its operation,
which is not an ecient use of network resources. If this number of time or
frequency slots reduce to one, the spectral eciency of each user will increase.
At the same time, it is possible to give the released time or frequency slot to
a new one and increase the number of users. If only one time-frequency slot
assigns to nodes, each transceiver has an FD function. Then, due to sending
and receiving at the same time and at the same frequency, severe interfer-
ence is introduced to the receiver from the transmitter. If there is not enough
attention paid to this self-interference (SI), the receiver will be completely
disturbed by its transmitter, then, an outage occurs. So, the FD node can't
receive the signal of interest (SoI) from the other side. For this reason, despite
their great advantage, FD systems have not been widely implemented yet [2].
FD systems have other advantages [3], such as reduction of end-to-end delay
in delay-sensitive applications [4].
To achieve the advantages of the FD system, it is necessary to reduce the
input interference impressively. However, the transmitted power is much higher
than the typical received power. Therefore, the power of SI is much stronger
than the received SoI power. This interference power may even be 100 dB
higher than the noise oor [5]. Therefore, its reduction is made in several
stages and in three dierent points of receiver [6]. To prevent the saturation of
radio frequency (RF) circuits, at the rst stage, proper design and arrangement
of the transmitter and receiver antennas reduce the input interference to some
extent. In the next step and to use the maximum dynamic range of the analog
to digital converter (ADC), the second part of the interference cancellation is
done in the analog part of the receiver. Here, part of the transmitted signal is
injected into the receiver and subtracted from the received signal. With this
method, the main component (direct path component) of the interference is
removed. The residual interference after these two steps is digitally removed
in the baseband section of the receiver. Due to the high processing capability
of digital processors, cancellation in this section is of particular importance.
The RF transmitter and receiver chains are not ideal and cause distor-
tions in the transmitted and received signal. One of the severe problem is
the nonlinearity of the transmitter power amplier (PA). The output signal
of the amplier contains linear and nonlinear components of the input signal.Matched-Filter Design to Improve 3
In addition, there are usually obstacles around the transmitter that cause the
transmitted signal enters the receiver from dierent angles and paths. Accord-
ingly, the interference signal includes the linear and nonlinear components of
the transmitted signal that enter the receiver through the multipath commu-
nication channel. The most signicant linear component of the interference
signal is often removed in the analog domain, and the rest of the components
are eliminated as much as possible in the baseband [7]. For this purpose, rst,
the nonlinear behavior of the PA along with multipath channel coecients
is modeled. Then, the model parameters are estimated using pilot data. Us-
ing this model, a symbol similar to the residual interference is created and
subtracted from it in the digital domain. If the appropriate model is used
and its parameters are accurately estimated, the residual interference will be
signicantly reduced [7].
In practical systems, the input of the PA is not symbols. The PA captures
and amplies the output signal from the pulse-shaping lter. So, the nonlinear
PA distorts the pulse-shaping output signal instead of the transmitted symbols
(please pay attention to the dierence between symbol and signal well). This
issue causes the interference symbol not to be reconstructed correctly from the
transmitted symbol.
When the PA is linear, the pulse-shaping lter eect is completely reversed
by a similar lter in the receiver called matched-lter (MF) [8]. In addition,
since we have downsampling at the MF output, the data rate at the output
of MF is much less than the data rate in the input. Therefore, it is more
convenient to ignore both pulse-shaping lter and MF in simulation and anal-
ysis and investigate the simple baseband transceiver in the symbol domain.
However, with the nonlinear PA, the eect of the pulse-shaping lter is not
entirely removed by MF in the receiver. This issue, which has been ignored in
most previous SI cancellation research, will be considered here. First, we show
that the SI is not entirely removed, even in the perfect situation, by consider-
ing the interference in the symbol space. This problem arises because the MF
does not match the pulse-shaping lter in the presence of the nonlinear PA,
leading to dierent errors. Then, we propose a method to reduce this error
with a new MF, which diers from the pulse-shaping lter. We will see that
the performance of this new lter is better than the standard method for SI
cancellation.
In Section 2, we will have a brief review of previous research on SI can-
cellation in the digital domain. Then the model of the discussed system will
examine in Section 3 and the cancellation of SI in Section 4. The weakness of
the common method that does not consider the eect of the pulse-shaping lter
and the MF will also explain in Section 4. In Section 5, our proposed method
is presented. In Section 6, various simulations are given to show the better
performance of the proposed method. Finally, in Section 7, the conclusions of
the research are stated.
Since the number of parameters used is relatively large, for convenience,
the most important parameters are given in Table 1 along with their brief
explanation. In addition, for standard writing, numerical variables are written4 Mohammad Lari
Table 1 The most important parameters with a short explanation
Parameter Explanation
s[n] Transmitted symbol from the rst node (node 1)
x[k] Transmitted signal from the rst node (node 1)
M Upsampling factor in the pulse-shaping lter or downsampling factor in the MF
gT[k] Pulse-shaping lter coecients
gR[k] MF coecients in the regular method
N Total number of transmitted symbols
Lg Pulse-shaping lter and MF span in the terms of symbols
h[k] Multipath channel impulse response
y[k] Received interference signal at the rst node
r[n] Received interference symbol at the rst node
w[k] Received noise signal at the rst node
![n] Received noise symbol at the rst node
u[n] Transmitted symbol from the second node to the rst node
z[k] Received signal from the second node at the rst node
v[n] Received symbol from the second node at the rst node
[k] Total received signal at the rst node
[n] Total received symbol at the rst node
q Model's parameters, (8)
Lq Hammerstein FIR lter length in the terms of symbols
P Hammerstein polynomial maximum degree
g1[k] MF coecients in the proposed method
with small italic letters, vectors are written with lower case and bold letters,
and matrices are written with bold capital letters.
Please note the dierence between symbol and signal. The output of the
digital modulator before the pulse-shaping lter at the transmitter is a symbol.
In addition, the output of the MF before the digital demodulator at the receiver
is a symbol. But, the output of the pulse-shaping lter and the input of the MF
is a signal. We also have a signal in the communication channel. Therefore, here
nshows the discrete-time of the symbols, and krepresents the discrete-time
of the signal.
2 Related Work
FD communication systems have been receiving specic attention for several
years, and various research studies have been conducted [9]. The proper op-
eration of the FD system depends on eliminating SI from the receiver. To
remove the interference suciently, this work is usually done in several sec-
tions, including the antenna, the RF and analog, and the digital section of the
receiver [6]. Due to the availability of more processing capability in the digital
domain, many researchers have considered the issue of eliminating SI in the
digital section. Some of these references, which are more closely related to the
current article, have been briey reviewed in this section.
The received SI has passed through the nonlinear PA and the multipath
channel. So, to remove it better, we need to model the amplier along withMatched-Filter Design to Improve 5
the multipath channel. The Hammerstein model is a relatively simple and ap-
propriate method to do this, and this model has used in many studies. For
example, in [10], the nonlinear model for the PA is derived using the general-
ized Fourier expansion with orthogonal Laguerre bases. Then the interference
symbols are estimated using the Hammerstein model and subtracted from the
received symbols in the receiver. In [11], all transmitter and receiver RF im-
pairments have modeled with the help of the Hammerstein method. Then, the
interference has removed in the receiver. In the article [12], the time-varying
communication channel and the changes that occur in the PA over time have
investigated. The Hammerstein with the state space model, along with the
Kalman lter, are used to detect these changes. The Hammerstein model de-
velops in [13] using several nonlinear operators. Therefore, the nonlinear eect
of the low noise amplier (LNA) in the receiver is also considered. According to
the author's claim, LNA impairment cannot model in the usual Hammerstein
method. In order to reduce the complexity and the possibility of implement-
ing the model on a eld programming gate array (FPGA), the interpolation
technique is used along with the Hammerstein model in [14]. Finally, the FD
system has been implemented and tested in real conditions. Several articles,
such as [15{17] have made modeling and interference cancellation using neu-
ral networks. But for data generation and network training, they have used
the Hammerstein method to model the adverse eects of the transmitter and
receiver RF chain.
Some research studies such as [18, 19] have considered the eect of the
pulse-shaping lter and the MF along with the nonlinear PA. For example,
in [18], the pulse-shaping lter is assumed, and an exact analytical expression
of the spectral regrowth at the output of a nonlinear PA is derived. In [19],
the authors analytically provide statistical results on how a nonlinear amplier
aects the quality of transmitted signals. Then, describe the nonlinear distor-
tion as a function of the input signal's average and instantaneous power and
captures the pulse-shaping and MF eects. Such research is not numerous,
and their review has been done in general HD communication systems. To the
best of our knowledge, the eects of the pulse-shaping lter and the MF in
the FD systems do not take into account yet.
3 System Model
The main parts of the transmitter and receiver of a communication node are
drawn in Fig. 1. We consider this node as the rst node (node 1), which intends
to send and receive data as FD to other nodes. Since our discussion here is
the cancellation of SI, the other node and its details are not shown in Fig. 1.
However, its main blocks are completely similar to Fig. 1.
In the baseband part of the transmitter, all necessary processes such as cod-
ing, digital modulation, or orthogonal frequency division multiplexing (OFDM)
modulation are performed, and the symbol s[n] leaves from it. We consider
Tsymas the duration of each symbol. The symbol s[n] is upsampled and l-6 Mohammad Lari
Fig. 1 Block diagram of transmitter and receiver of an FD communication node.
tered in the pulse-shaping lter. If the upsampling rate is Mand the lter
coecients are gT[k], the output signal of the lter is
x[k] =N 1X
n=0s[n]gT[k nM] (1)
whereNis the total number of transmitted symbols, Tg=LgTsymis the pulse-
shaping lter span, which is equal to the Lgsymbols duration. According to
the upsampling rate, the number of coecients of this lter will be MLg. The
discrete time signal x[k] passes through the digital to analog converter (DAC)
and produces the continuous time signal x(t). Then, this signal is transferred
to the passband and passes through the PA. The amplier output xRF(t) is a
nonlinear function of the input and can be written as
xRF(t) =F 
x(t)ej2fct
: (2)
In this equation, F(:) is the nonlinear function between the output and input
of the PA. Note that all symbols and signals are complex. However, this is not
shown explicitly in Fig. 1. Due to the nonlinearity of F(:), a part of the PA
output signal is placed in-band and around the carrier frequency fc. Some parts
are also located in out-of-band region around the frequency fc; = 2;3;:::
[18,20]. To show this, we can rewrite (2) as
xRF(t) =F1(x(t))ej2fct+1X
=2F(x(t))ej2f ct(3)
whereF1(:) is a nonlinear function of the PA at the baseband, located around
fc. In the same way, F(:) presents a nonlinear function of the PA at the
baseband whose output components are placed around the frequency fc.
The amplied signal xRF(t) is transmitted from the rst node. But at
the same time, it leaks to its receiver through the multipath channel. TheMatched-Filter Design to Improve 7
interference signal at the receiver is yRF(t). For simplicity, the signal received
from the other node is not considered here. The signal is amplied in the LNA
of the receiver. We assume the LNA has a linear function and completely
removes the out-of-band interference. Therefore, the interference signal after
passing through the mixer is
y(t) =F1(x(t))h(t) (4)
whereh(t) represents the impulse response of the interference channel at the
baseband andis the convolution operator. The continuous time interference
signaly(t) is sampled at the analog to digital converter (ADC) with rate
Fs=1
MTsymand converted into the discrete time signal y[k] =F1(x[k])h[k].
Finally, the discrete signal is ltered and downsampled at the MF with gR[k]
coecients. The output of MF is
r[n] =MN 1P
m=0y[m]gR[nM m]
=MN 1P
m=0(F1(x[m])h[m])gR[nM m]:(5)
In addition, the input noise to the receiver is wRF(t), and it is converted to
w(t) after the mixer, w[k] after the ADC and ![n] after the MF.
On the other hand, node 2 wants to communicate with node 1. Therefore,
the transmitter of node 2 rst converts the u[n] symbol into a discrete-time
signal and then into a continuous-time signal. Then the signal is transferred
to the passband around the carrier frequency fcand amplied. Finally, this
signal is sent to node 1 through the multipath channel. The received signal
passes through the RF chain of node 1 and presents after the mixer, the ADC,
and the MF as z(t),z[k], andv[n]. According to the FD function of node
1, interference, desired signal, and noise enter the receiver at the same time.
Therefore, the input signal to the MF is [k] =y[k] +z[k] +w[k], and the
output symbol will be [n] =r[n] +v[n] +![n].
4 Self-Interference Cancellation
4.1 Conventional Method Based on Hammerstein Model
In the conventional method, to eliminate the interference, the interference
regenerator tries to estimate the SI symbol r[n] with minimum error and in
the form of ^ r[n]. This block, shown with a dashed line in Fig. 1, usually uses the
Hammerstein method to model the nonlinear PA and the multipath channel
simultaneously [21]. According to Fig. 2, the Hammerstein model is made of
a nonlinear system and a nite impulse response (FIR) lter sequentially [21].
The nonlinear part is often modeled with a polynomial of degree P. So, the
output of this part is equal to
[n] =PX
p=1;p=2`+1aps[n]js[n]jp 1: (6)8 Mohammad Lari
Fig. 2 Block diagram of Hammerstein model.
Pis an odd number and fa1;a3;:::;aPgrepresents the polynomial coecients.
Note that the PA is often modeled with odd degree polynomials. Therefore,
fa0;a2;:::;aP 1gcoecients are not seen in (6). The coecients of the FIR
lter
q0;q1;:::;qLq 1	
withLqunknown parameters are also considered as
parameters of the model.
To adjust the parameters of the Hammerstein model, the transmitter of
node 2 does not send a signal for a certain duration. Instead, the rst node
transmitsN(p)pilot symbols s(p)[n]; n= 0;1;:::;N(p) 1 and these symbols
are received as (p)[n] =r(p)[n]+!(p)[n]; n= 0;1;:::;N(p) 1, including inter-
ference symbols and noise [16]. Therefore, the relationship between the input
symbols, model parameters, and the output of the interference regenerator will
be in the form
(p)=S(p)q (7)
where model parameters and received symbols are given in (8). The input
symbols matrix is also written in (9).
q=0
BBBBBBBBBBBBBBBBBB@q0a1
...
q0aP
q1a1
...
q1aP
...
qLq 1a1
...
qLq 1aP1
CCCCCCCCCCCCCCCCCCA; (p)=0
BBB@(p)[0]
(p)[1]
...
(p)[N(p) 1]1
CCCA(8)
S(p)=0
BBBBBBBBBB@s(p)[0] s(p)[0]s(p)[0]2::: s(p)[0]s(p)[0]P 10 0 ::: 0 0
...........................
s(p)[Lq 1]s(p)[Lq 1]s(p)[Lq 1]2::: s(p)[Lq 1]s(p)[Lq 1]P 1::: s(p)[0] s(p)[0]s(p)[0]2::: s(p)[0]s(p)[0]P 1
s(p)[Lq]s(p)[Lq]s(p)[Lq]2::: s(p)[Lq]s(p)[Lq]P 1::: s(p)[1] s(p)[1]s(p)[1]2::: s(p)[1]s(p)[1]P 1
...........................
s(p)[N(p) 1]s(p)[N(p) 1]s(p)[N(p) 1]2:::s(p)[N(p) 1]s(p)[N(p) 1]P 1::: s(p)[N(p) Lq+ 1]s(p)[N(p) Lq+ 1]s(p)[N(p) Lq+ 1]2:::s(p)[N(p) Lq+ 1]s(p)[N(p) Lq+ 1]P 11
CCCCCCCCCCA
(9)
According to the fact that the transmitted and received pilot symbols are
known, the parameters of the Hammerstein model are estimated with leastMatched-Filter Design to Improve 9
square (LS) estimation as
q=
S(p)yS(p) 1
S(p)(p)(10)
After this, transmitters of node 1 and node 2 start sending their data as FD.
In addition to receiving the symbols from node 2, the rst node also receives
its transmitted symbols along with noise. Therefore, the symbols received at
the receiver of node 1 are [n] =r[n] +v[n] +![n]; n= 0;1;:::;N 1. The SI
regenerator also estimates the interference symbol as ^ r[n]; n= 0;1;:::;N 1.
Then,[n] and ^r[n] enter the baseband section to eliminate interference. If
the estimated symbol is similar to the interference symbol, [n] =r[n] ^r[n]
will have a small value and the detection and demodulation of the SoI sent by
node 2 will be done well using [n] =v[n] + ([n] +![n]).
4.2 Weakness of Hammerstein Model
According to Fig. 1, we can rewrite (5) as
r[n] =DMfgR[k]h[k]F1(gT[k]UMfs[n]g)g (11)
whereUMf:gandDMfgrepresent the upsampling and downsampling opera-
tions with order M. Therefore,UMfs[n]gis equal toUMfs[n]g=s[n/M] =s[k]
andDMfr[k]gis equal to DMfr[k]g=r[kM] =r[n]. Note that nrepresents
discrete time with sampling frequency1
Tsymandkrepresents discrete time with
the sampling frequencyM
Tsym. Because the convolution operator has commuta-
tive property, we can write (11) as
r[n] =DMfh[k]gR[k]F1(gT[k]UMfs[n]g)g
=DMfh[k]gR[k]F1(gT[k]s[k])g:(12)
Now, assuming the nonlinear PA, we can simplify (12) in the form of [22]
r[n] =DMfh[k]gR[k]F1(gT[k]s[k])g
=M 1P
m=0(DMfh[k m]g DMfgR[k+m]F1(gT[k+m]s[k+m])g):
(13)
Because the length of the pulse-shaping lter is longer than one symbol,
Lg>1, the term gT[k+m]s[k+m] in (13) is a linear combination of
a number of symbols sent by the transmitter. When this expression passes
through the nonlinear function F1(:), some symbols are generated which can-
not be regenerated using the Hammerstein model in Fig. 2. Therefore, the use
of Hammerstein's model in typical communication systems is inaccurate and is
only approximate. Although this approximation is relatively suitable, we will
show in the following that our proposed method can make this approximation
better and more accurate.10 Mohammad Lari
For example, suppose the linear combination of transmitted symbols is as
simple ass[0]+s[1]. We also consider the PA nonlinear function as F1(x) =x3.
In this way,F1(s[0] +s[1]) becomes equal to
F1(s[0] +s[1]) =s3[0] +s3[1] + 3s2[0]s[1] + 3s[0]s2[1]|{z}
multiplicative terms:(14)
If the relation (14) is placed in (13) and simplied, the interference symbol r[n]
will also depend on the multiplicative symbols such as s2[0]s[1] ands[0]s2[1].
Regarding Fig. 2 and equation (6), it is clear that the Hammerstein model is
incapable of generating these multiplicative terms. Therefore, it is not able to
estimate the SI symbol without error. This problem is not solved by increasing
the degree of Hammerstein's nonlinear model. In the following, we will consider
this issue dierently and try to solve the problem as much as possible.
5 Proposed Method for Self-Interference Cancellation
5.1 New Matched Filter
The proposed method is simple but ecient. In this method, the MF coe-
cients are changed and the new coecients do not match the pulse-shaping
ltergT[k]. That's why we call it g1[k]. The length of this lter is similar to
the length of gR[k] and equals Lgsymbols. The coecients of the new lter
are determined so that for the interfering input signal y[k], the output of the
lter is equal to the SI symbol s[n]. Because the SI symbol s[n] is known to
the receiver, the baseband part of the receiver easily removes the interfering
symbol. In this method, the Hammerstein model or its similar structure is
not needed between the baseband part of the transmitter and receiver. So,
the dashed line block in Fig. 1 can remove. In the new method, the MF acts
like a fractionally spaced equalizer (FSE) and tries to convert the transmitted
symbols, which have passed through the nonlinear PA and multipath channel,
back into the same transmitted symbol again [23]. If this is done correctly, the
SI will be canceled quickly. In [17], without mentioning the reason, a structure
similar to FSE is used with a neural network for SI cancellation. However, the
eects and performance improvement of FSE have not been investigated.
In order to adjust the coecients g1[k], the transmitter of node 2 does
not send a signal in a certain period of time, but, the transmitter of node 1
sendsN(p)pilot symbols s(p)[n]; n= 0;1;:::;N(p) 1. These symbols pass the
transmitter RF chain, the multipath channel and the receiver RF chain and
receive by the MF as (p)[k] =y(p)[k]+w(p)[k]; k= 0;1;:::;MN(p) 1. Like the
equalizer, the MF tries to x the SI symbols (p)[k]; k= 0;1;:::;MN(p) 1 and
regenerates(p)[n]; n= 0;1;:::;N(p) 1. Because the MF has downsampling,
the relation between the input signal and the output symbol of the MF will
be as
s(p)=E(p)g1: (15)Matched-Filter Design to Improve 11
According to (15), the vector s(p)includesN(p)pilot symbols, g1is the pro-
posed MF coecients and E(p)is given as
E(p)=0
BBB@(p)[0] (p)[1] ::: (p)[MLg 1]
(p)[M] (p)[M+ 1]::: (p)[M+MLg 1]
............
(p)[(N(p) 1)M](p)[(N(p) 1)M+ 1]::: (p)[(N(p) 1)M+MLg 1]1
CCCA:
(16)
It should note that the downsampling action of the MF is also considered in
relation (15). In this way, the coecients of the proposed MF can be estimated
with LS as
g1=
E(p)yE(p) 1
E(p)ys(p): (17)
After this, node 1 informs node 2 and sends the new coecients g1[k]; k=
0;1;:::;MLg 1 for the second node and node 2 uses these coecients as a new
pulse-shaping lter. More details are explained in the Use Case subsection.
When two nodes start transmission, the rst transmitter sends s[n]; n=
0;1;:::;N 1 and the second transmitter sends u[n]; n= 0;1;:::;N 1 symbols
to the other party. In addition to receiving the SoI sent by node 2, the rst node
also receives the SI symbols along with noise. Therefore, the received symbols
of the rst node are [n] =r[n] +v[n] +![n]; n= 0;1;:::;N 1. In the new
proposed method, the estimation of received SI symbols is as r[n] = ^s[n]; n=
0;1;:::;N 1. Then[n] enters the baseband section and s[n] is subtracted
from it. Ifr[n] ands[n] are similar with a good accuracy, [n] =r[n] s[n] will
have a small value and the detection and demodulation of the SoI will be done
well using the symbol [n] =v[n] + ([n] +![n]).
5.2 Use Case
Since in the new proposed method, the receiver's MF is changed, so for the cor-
rect functionality, the transmitter's pulse-shaping lter must also be changed.
Therefore, one suitable structure for implementing this new technique is a
cellular communication system with an FD base station and two HD users.
This can be seen in Fig. 3 where the base station or node 1 transmits in the
downlink channel while receives from node 2 in the uplink channel simultane-
ously. For simplicity, two users are HD and transmit or receive in time division
duplexing (TDD) mode. In the new proposed method, node 1 uses the con-
ventional pulse-shaping lter such as root-raised cosine with coecients gT[k]
and transmits in the downlink channel for node 3. This user is matched with
the transmitter and uses gT[k] in the receiver's MF. However, this node is not
important in our new proposed scenario. On the other hand, node 1 is FD and
receives severe SI from its transmitter. So, node 1 calculates the new MF coef-
cientsg1[k] and uses this lter in its receiver. As we explained, this new MF
can reduce the interference more eciently. In addition, node 1 informs node
2 about the new coecients. Therefore, node 2 uses the new coecients g1[k]12 Mohammad Lari
Fig. 3 An FD base station with two HD users in uplink and downlink in TDD mode.
in its transmitter's pulse-shaping lter. Since node 2 is in transmit mode, it
does not require the MF in this mode. Pulse-shaping and MF coecients of all
transmitters and receivers are also depicted in Fig. 3. After a while, the roles
of node 2 and node 3 are changed and node 2 receives signal on the downlink
channel and node 3 transmits in the uplink channel. Then, the same process
will start and the pulse-shaping and MF of all nodes are determined again.
5.3 Computational Complexity
The comparison of the computational complexity of the newly proposed method
with the Hammerstein method can check in two parts, during training and es-
timation of model parameters, as well as after training and when executing the
algorithm. When training the model and estimating the parameters, the com-
putational complexity of the Hammerstein model and the proposed method are
almost the same, though the computational complexity of the Hammerstein
may be lower. However, the parameter setting is usually done once, and then
several tens or hundreds of data packets are sent. Therefore, the computational
complexity of the algorithms during the training is negligible compared to the
computational complexity during the algorithm's execution. So, the computa-
tional complexity of the two methods during the training has been calculated
and compared in the appendix. Here, we compare the complexity during the
regular system operation. The number of real multiplications indicates the
complexity of each method.
In the Hammerstein model, the MF at the receiver rst performs a matrix-
vector multiplication. The matrix has NMLgrows andNMLgcolumns
and the vector has NMLgrows and its computational complexity is 2 N(MLg+Matched-Filter Design to Improve 13
Table 2 Simulation parameters
Parameter Value
N=N(p)128
M 8
Lg 4
Lq 4
P 3
1). The coecient of 2 is required; because the input signal to the MF is com-
plex, but the lter coecients are real. Therefore, a real complex multiplication
is equivalent to two real multiplications. Then, to remove the interference, the
SI regenerator must create a matrix of (9) and, after multiplying it by q, regen-
erate the SI symbols. According to the number of multiplications to build the
matrix S, its computational complexity is 2 NP+1
2Lq. Also, the complexity of
Sqis 4NP+1
2Lq. Finally, the computational complexity of the Hammerstein
method is equal to
OHammerstein = 2N(MLg+ 1) + 6NP+ 1
2Lq: (18)
But, with the new proposed MF, we only need to do a NMLgsquare matrix
multiplication to a MLg1 vector. Therefore, the computational complexity
of this new method is equal to
O1= 2N(MLg+ 1): (19)
6 Simulation Results
To simulate and numerically check the proposed method, the system param-
eters are set according to Table 2. If any parameter changes, its new value is
mentioned in the appropriate place.
To better excite the nonlinear PA, symbols similar to OFDM are produced
and used as transmitted symbols. The peak to average power ratio (PAPR)
is about 13dB. The pulse-shaping lter is a root-raised cosine lter with a
roll-o factor of 0.35. In the Hammerstein model, the MF is matched to the
pulse-shaping lter. But in the proposed method, the MF is calculated with
appropriate coecients. For a fair comparison, Lgfor the proposed method is
adjusted for the equal computational complexity with the Hammerstein. The
communication channel is multipath and has a length of 4 symbols. Since our
purpose here is to compare the amount of SI cancellation and calculate resid-
ual SI power, therefore, the transmitted symbols of node 2 is only considered
in Fig. 10. The signal to noise power ratio (SNR) also shows the amount of
SI power to noise power before the receiver MF. The nonlinear PA is mod-
eled as Rapp with a smoothness factor of 2 [10]. The input back-o (IBO)
is 5dB which means that the PA input power has retreated 5dB from 3dB
saturation point. To make a better comparison, the number of 10,000 packets14 Mohammad Lari
Fig. 4 Residual SI power in dierent iterations in the Hammerstein and proposed methods
with new MF.
includingN(p)+Nsymbols passed through 10,000 independent channel in-
stances, then the average residual power in the Hammerstein method and the
proposed method is compared. Each transmitted packet contains N(p)pilot
symbols followed by Ndata symbols. When sending pilot symbols, the receiver
estimates the parameters of the desired model to eliminate interference. Then,
when it receives the leakage data symbols from its own transmitter, it removes
the interference as much as possible and compares the remaining SI power of
dierent methods.
The performance of the Hammerstein method and the proposed method
are compared in Fig. 4. SNR value is 0dB. It is clear that in some iterations, the
performance of the Hammerstein method is better, and its residual interference
is less than the proposed method. However, it is often not the case, and the
performance of the proposed method is better than the Hammerstein. It is also
clear that, on average, the performance of the proposed method is much better
than the Hammerstein method, and the residual SI power variation (variance)
are also less in this method.
After removing the interference by the Hammerstein method and proposed
methods, the average residual SI power compares in terms of SNR in Fig. 5.
We can see that the performance of the proposed method is better than the
performance of the Hammerstein in all SNRs. Also, with the increased SNR,
naturally, the model parameters are estimated with less error, and the inter-
ference is reduced with more accuracy. Therefore, the remaining interference
power in both graphs of Fig. 5 decreases with the increase of SNR.
For a better comparison, we assume the ratio of the residual SI power in
the Hammerstein method to the residual SI power in the proposed method
as the cancellation gain and plot it in Fig. 6. The curve is convex, and the
benet of SI cancellation is high at rst and decreases with the increase of
SNR. When the gain becomes lower, the performance of Hammerstein and
new methods approach each other. The lowest gain is obtained around SNR
of 3dB, where the gain reaches about 16dB. With a further increase of SNR,Matched-Filter Design to Improve 15
Fig. 5 The average residual SI power in terms of SNR, in the Hammerstein and proposed
method with new MF.
Fig. 6 The SI cancellation gain, in the Hammerstein and proposed method with new MF.
the gain increases again, and the curve ascends. At high SNR, SI is strong.
Therefore, the weakness of the Hammerstein method, which we mentioned in
section 4.2, shows itself more, and the better performance of the presented
method will be more specic. But even at low SNR, the proposed method has
a high benet. The reason for this good performance is the change of MF in
the proposed way. In fact, the lter is more compatible with the SI signal and
can reduce the noise better.
In Fig. 7, the average residual SI power at SNR value of 0dB is plotted
versusLg. This parameter shows the length of the pulse-shaping lter and the
length of the MF in the Hammerstein model in terms of the number of symbols.
The performance of the Hammerstein method is almost not dependent on Lg.
As we explained, when the pulse-shaping lter and the MF consider, the
Hammerstein method is not a powerful method. So, the amount of interference
power removed by this method is reduced. On the other hand, the proposed
method performs better than the Hammerstein, and the residual SI power of
this method does not change much in the shared values between 1 to 8. But16 Mohammad Lari
Fig. 7 The average residual SI power in terms of Lg, in the Hammerstein and proposed
method with new MF.
in larger values, the new MF suers from over-tting, and the performance of
this method also decreases. It means that the too-long length MF memorizes
the pilot symbols instead of learning them. Therefore, it can not generalize,
and after the training phase, can not remove the interference properly. The
Hammerstein MF is the root-raised cosine and is the same as the pulse-shaping
lter. The coecients of this lter move quickly to zero. So, the increase of
Lgdoes not have much eect on the performance of this method. Therefore,
it should note that increasing the length of MF in the presented way does not
improve the performance.
Another comparison between the average residual SI power is made in Fig.
8 versusM, in SNR of 0dB. As expected, the performance of the Hammerstein
method decreases with the increase of M; Because when Mis increased, the
eect of the pulse-shaping lter increases, and the weakness of the Hammer-
stein method becomes more apparent. But because the presented new method
considers this eect of lters, it has almost the same performance in all values
ofM. It should be noted that too much increasing of Mis not appropriate, and
as shown in Fig. 7, we may suer from over-tting. But the more interesting
point is the same performance of both methods in M= 1. In this case, there
is practically no pulse-shaping lter and MF, and sending and receiving are
done in the form of consecutive symbols. Therefore, the Hammerstein method
does not suer from the problem we examined in Section 4.2. Consequently,
the performance of the Hammerstein and the proposed method will be the
same. In summary, this brief explanation shows and proves the main idea of
this article.
Again, the average residual interference power is plotted versus IBO in Fig.
9 and compared for two methods. The larger the IBO, the small part of the
input signal enters the nonlinear region of the PA. Therefore, the nonlinear
distortion of the amplier is less. As you can see, the proposed method has
almost constant performance in all IBO values. But, the dependency of the
Hammerstein method on the IBO and the amount of nonlinear distortionMatched-Filter Design to Improve 17
Fig. 8 The average residual SI power in terms of M, in the Hammerstein and proposed
method with new MF.
Fig. 9 The average residual SI power in terms of IBO, in the Hammerstein and proposed
method with new MF.
is much higher. At high IBO values, the amplier is nearly linear. But the
Hammerstein method still tries to regenerate interference symbols nonlinearly.
This issue causes the performance of this method to drop. In other words,
similar to the emphasis made in [10], in the Hammerstein method,
The PA degree of nonlinearity should know, and the model's parameters
should adjust accordingly. On the other hand, the presented new method is rel-
atively resistant to this issue. Therefore, in addition to the better performance,
the proposed method is also suggested when previous information about the
amplier nonlinearity is insucient.
Finally, to evaluate the overall performance of the system, the bit error rate
(BER) curve is plotted in Fig. 10. According to Fig. 3, the simulated system
includes an FD base station and two HD users. In addition to receiving the
desired signal from node 2, node 1 also receives interference from its own
transmitter. The SoI and the SI power at the input of node 1 are assumed
equal to one. At node 1, the receiver rst removes the interference using the18 Mohammad Lari
0 2 4 6 8 10 12 14 16 18 2010-410-310-210-1
Fig. 10 BER Comparison with the Hammerstein and proposed new MF.
Hammerstein method and detects the desired signal. Once again, the receiver
removes the interference using the new MF and detects the SoI. The BER
curves for these two modes and BPSK modulation is plotted in Fig. 10 versus
SNR. Here, SNR shows the ratio of the desired signal power to the noise power
at the input of node 1 receiver. As it is known, with the increase of SNR, the
estimation of the Hammerstein model parameters and the new MF becomes
better. Therefore, more SI is removed and the BER is reduced. Meanwhile,
the lower BER in the proposed method indicates the better performance of
this method compared to the conventional Hasmmerstein method.
7 Conclusion
The problem of digital SI cancellation in the FD communication system has
been studied here. The transmitter PA is nonlinear. Then, to eliminate the
interference, we need to estimate the interference by considering the nonlinear
eect of the amplier. The Hammerstein model is an excellent way to do this.
However, we showed that in practical systems, when the pulse-shaping lter
is considered in the transmitter and the MF in the receiver, the Hammerstein
method can not estimate the SI symbols accurately. To solve this weakness,
we did not consider the regular MF, which matches the transmitter pulse-
shaping lter. Instead, we presented a new lter that acts like an equalizer
and tries to regenerate the interference symbol sent by the transmitter from
the distorted signal received from the communication channel. The eect of
the pulse-shaping lter considers in our new method. Therefore, the weakness
of the Hammerstein method can be solved using this new method. Various sim-
ulations have been done to show this performance improvement. In addition,
there is no need for previous information about the amount of nonlinearity of
the PA.
Since the interference has nonlinear distortion, it will probably be more
ecient to use a lter which takes this nonlinearity into account. Therefore,Matched-Filter Design to Improve 19
considering the optimal nonlinear MF will be regarded as our future research
study.
A Computational Complexity of the Hammerstein and Proposed
Method During the Training
The computational complexity of the two methods during the training calculate here. In
the Hammerstein method, rst in the MR, there is a NMLgrows andNMLg
columns matrix multiplication into a MLg1 vector. So, its computational complexity
is 2N(MLg+ 1). Then, to construct the matrix S(p)in (9), 2N~PLgreal multiplication is
required. ~Pis equal to ~P=P+1
2. Matrix multiplication S(p)yS(p)has 4N
~PLg2
real mul-
tiplications. The matrix inversion 
S(p)yS(p) 1requires 4( ~PLg)3real multiplications in the
simple inversion method. In the same way, the matrix operations 
S(p)yS(p) 1S(p)yand 
S(p)yS(p) 1S(p)(p)require 4N(~PLg)2and 4N~PLgreal multiplications respectively.
If we assume N(p)=N, the total number of real multiplications and the computational
complexity associated with it in the Hammerstein method is equal to
OHammerstein = 2N(MLg+ 1) + 2N~PLg
4~PLg+ 3
+ 4
~PLg3
: (A-1)
In the proposed new method according to equation (17), matrix multiplication by ma-
trix, matrix inversion, inverse matrix multiplication by matrix and nally matrix to vector
multiplication have 4 N(MLg)2, 4(MLg)3, 4N(MLg)2and 4N(MLg) real multiplications,
respectively. Therefore, the total number of real multiplications and related computational
complexity in the presented method is
O1= 4N
2(MLg)2+MLg
+ 4(MLg)3: (A-2)
If we assume that M,Lgand ~Phave an equal order or almost similar to MandNM,
then the computational complexity of both methods is of the same order of NM2. However,
the number of multiplications in the Hammerstein method may be less than the proposed
method.
References
1. Mohammad Lari and Sina Asaeian. Multi-objective antenna selection in a full duplex
base station. Wireless Personal Communications , 110(2):781{793, 2020.
2. Nimrod Ginzberg, Dror Regev, Rani Keren, Shimi Shilo, Doron Ezri, and Emanuel Co-
hen. A four-element 5{6-ghz cmos quadrature balanced full-duplex mimo transmitter
with wideband digital interference cancellation. IEEE Microwave and Wireless Com-
ponents Letters , 32(2):173{176, 2021.
3. Mohammad Lari. Transmission delay minimization in wireless powered communication
systems. Wireless Networks , 25(3):1415{1430, 2019.
4. Mohammad Lari and Zahra Keshavarz Gandomani. Eective capacity maximization of
two-way full-duplex and half-duplex relays with nite block length packets transmission.
Wireless Networks , 28(3):1079{1096, 2022.
5. Ahmed Hamza, Aravind Nagulu, Alfred Festus Davidson, Jonathan Tao, Cameron Hill,
Hussam AlShammary, Harish Krishnaswamy, and James Buckwalter. A code-domain,
in-band, full-duplex wireless communication link with greater than 100-db rejection.
IEEE Transactions on Microwave Theory and Techniques , 69(1):955{968, 2020.
6. Mikail Yilan, Ozgur Gurbuz, and Huseyin Ozkan. Integrated linear and nonlinear digital
cancellation for full duplex communication. IEEE Wireless Communications , 28(1):20{
27, 2021.20 Mohammad Lari
7. Yann Kurzo, Andreas Toftegaard Kristensen, Andreas Burg, and Alexios Balatsoukas-
Stimming. Hardware implementation of neural self-interference cancellation. IEEE
Journal on Emerging and Selected Topics in Circuits and Systems , 10(2):204{216, 2020.
8. John G Proakis and Masoud Salehi. Fundamentals of communication systems . Pearson
Education India, 2007.
9. Shree Krishna Sharma, Tadilo Endeshaw Bogale, Long Bao Le, Symeon Chatzinotas,
Xianbin Wang, and Bj orn Ottersten. Dynamic spectrum sharing in 5g wireless networks
with full-duplex technology: Recent advances and research challenges. IEEE Commu-
nications Surveys & Tutorials , 20(1):674{707, 2017.
10. Kazuki Komatsu, Yuichi Miyaji, and Hideyuki Uehara. Theoretical analysis of in-
band full-duplex radios with parallel hammerstein self-interference cancellers. IEEE
Transactions on Wireless Communications , 20(10):6772{6786, 2021.
11. Md Atiqul Islam and Besma Smida. A comprehensive self-interference model for single-
antenna full-duplex communication systems. In ICC 2019-2019 IEEE International
Conference on Communications (ICC) , pages 1{7. IEEE, 2019.
12. Hendrik Vogt, Gerald Enzner, and Aydin Sezgin. State-space adaptive nonlinear self-
interference cancellation for full-duplex communication. IEEE Transactions on Signal
Processing , 67(11):2810{2825, 2019.
13. Kazuki Komatsu, Yuichi Miyaji, and Hideyuki Uehara. Iterative nonlinear self-
interference cancellation for in-band full-duplex wireless communications under mixer
imbalance and amplier nonlinearity. IEEE Transactions on Wireless Communications ,
19(7):4424{4438, 2020.
14. Lauri Anttila, Vesa Lampu, Seyed Ali Hassani, Pablo Pascual Campo, Dani Korpi,
Matias Turunen, Soe Pollin, and Mikko Valkama. Full-duplexing with sdr devices:
Algorithms, fpga implementation, and real-time results. IEEE Transactions on Wireless
Communications , 20(4):2205{2220, 2020.
15. Mohamed Elsayed, Ahmad A Aziz El-Banna, Octavia A Dobre, Wanyi Shiu, and Peiwei
Wang. Low complexity neural network structures for self-interference cancellation in
full-duplex radio. IEEE Communications Letters , 25(1):181{185, 2020.
16. Dong Hyun Kong, Yong-Sung Kil, and Sang-Hyo Kim. Neural network aided digital
self-interference cancellation for full-duplex communication over time-varying channels.
IEEE Transactions on Vehicular Technology , 2022.
17. Konstantin Muranov, Md Atiqul Islam, Besma Smida, and Natasha Devroye. On deep
learning assisted self-interference estimation in a full-duplex relay link. IEEE Wireless
Communications Letters , 10(12):2762{2766, 2021.
18. Mahdi Majidi, Abbas Mohammadi, and Abdolali Abdipour. Accurate analysis of spec-
tral regrowth of nonlinear power amplier driven by cyclostationary modulated signals.
Analog Integrated Circuits and Signal Processing , 74(2):425{437, 2013.
19. Mohammad Hossein Moghaddam, Sina Rezaei Aghdam, Nicol o Mazzali, and Thomas
Eriksson. Statistical modeling and analysis of power amplier nonlinearities in commu-
nication systems. IEEE Transactions on Communications , 70(2):822{835, 2022.
20. Mahdi Majidi, Abbas Mohammadi, Abdolali Abdipour, and Mikko Valkama. Character-
ization and performance improvement of cooperative wireless networks with nonlinear
power amplier at relay. IEEE Transactions on Vehicular Technology , 69(3):3244{3255,
2020.
21. Visa Tapio and Markku Juntti. Non-linear self-interference cancelation for full-duplex
transceivers based on hammerstein-wiener model. IEEE Communications Letters ,
25(11):3684{3688, 2021.
22. Alan V Oppenheim, John R Buck, and Ronald W Schafer. Discrete-time signal pro-
cessing. Vol. 2 . Upper Saddle River, NJ: Prentice Hall, 2001.
23. Ghassem Narimani, Philippa A Martin, and Desmond P Taylor. Spectral analysis of
fractionally-spaced mmse equalizers and stability of the lms algorithm. IEEE Transac-
tions on Communications , 66(4):1675{1688, 2017.