arXiv:2303.16440v3  [math.LO]  26 Jul 2024MEASURABLE VIZING’S THEOREM
JAN GREB ´IK
Abstract. We prove a fullmeasurable version of Vizing’s theorem for bounded degree
Borel graphs, that is, we show that every Borel graph Gof degree uniformly bounded
by∆∈Ndeﬁned on a standard probability space ( X,µ) admits a µ-measurable proper
edge coloring with ( ∆+ 1)-many colors. This answers a question of Marks [Question
4.9, J. Amer. Math. Soc. 29 (2016)] also stated in Kechris and Marks as a part of
[Problem 6.13, survey (2020)] , and extends the result of the author and Pikhurko [Adv.
Math. 374, (2020)] who derived the same conclusion under the additional assumption
that the measure µisG-invariant.
1.Introduction
Vizing’s theorem is a fundamental result in graph theory that relates the number of
colors needed to properly color edges of a given graph G, the so-called chromatic index
χ′(G)ofG, with its maximum degree; it states that if the maximum degree of Gis
∆∈N, thenχ′(G)/lessorequalslant∆+ 1. Together with K¨ onig’s line coloring theorem (that states
thatχ′(G) =∆under the additional assumption that Gis bipartite), these classical
results laid the foundation of edge-colouring, an important and act ive area of graph
theory; see, for example, the recent book on edge-colouring by S tiebitz, Scheide, Toft
and Favrholdt [SSTF12].
In this paper we study Vizing’s theorem from the perspective of measurable graph
combinatorics , a subﬁeld of descriptive set theory that lies at the intersection of measure
theory, random processes, dynamics, group theory, combinato rics and distributed com-
puting; a (non-exhaustive) sample of results related to the ﬁeld (a nd to our investigation)
includes [Lac90, MU17, GMP17, DF92, MU16, Gab00, KST99, Mar16, CM17, CJM+23,
CGM+17, GP20, Ber23,BCG+24]. Initsmost abstract form, measurable graphcombina-
torics systematically studies the existence of measurable ordeﬁnable solutions to various
graph coloring problems deﬁned on so-called Borel graphs , graphs where the vertex set
(V,B) is astandard Borel space , for example the unit interval, and the edge relation Eis
a Borel subset of [ V]2, where [ V]2denotes the set of unordered pairs endowed with the
canonical Borel structure coming from V. This study originated in the seminal paper
of Kechris, Solecki and Todorˇ cevi´ c [KST99] and since then foun d many applications in
various areas of central mathematics, see the surveys of Kechr is and Marks [KM20] and
Pikhurko [Pik21].
BasicquestionsaboutvertexcoloringsofboundeddegreeBorelg raphsarewell-understood.
Recall that the Borel chromatic number χB(G) of a Borel graph G= (V,B,E) is the
smallest k∈Nsuch that there is a decomposition V=V1⊔···⊔Vk, whereViis a Borel
subset of Vthat does not span any edge of Gfor every i∈[k]. In the paper [KST99]
Kechris, Solecki and Todorˇ cevi´ c showed that there is a Borel measurable version of the
classical greedy algorithm for proper vertex coloring, thus prove d thatχB(G)/lessorequalslant∆+ 1
for every Borel graph G= (V,B,E) of maximum degree ∆∈N. In the groundbreaking
12 JAN GREB ´IK
paper [Mar16], Marks found an example of acylic ∆-regular Borel graph Gsuch that
χB(G) =∆+1 for every ∆∈N, thus concluding that there is no Borel analogue of the
classical Brooks’ theorem from ﬁnite combinatorics. On the other hand, Conley, Marks
and Tucker-Drob [CMTD16] proved that Brooks’ theorem holds on ceBorel measurability
is relaxed either in the sense of measure theory or topology. For ex ample, if G= (V,B,E)
is a Borel graph of degree bounded by ∆/greaterorequalslant3 that does not contain a clique on ∆+ 1
vertices and µis aBorel probability measure on (V,B), then there is a µ-null Borel set
Ysuch that χB(G↾(V\Y)) =∆. Recently these results were reﬁned by Bernshteyn
[Ber23] and Brandt, Chang, the author, Grunau, Rozhoˇ n, and V idny´ anszky [BCG+24]
using ideas from the theory of distributed computing.
In contrast, similar questions about edge colorings are not yet fully understood. A
Borel matching of a Borel graph G= (V,B,E) is a Borel subset M⊆Ethat is a
matching, i.e., every two edges e,f∈Mare either equal (as unordered pairs) or do not
share a vertex. The Borel chromatic index χ′
B(G) is deﬁned to be the smallest k∈Nsuch
that there is a decomposition E=E1⊔···⊔Ek, whereEiis a Borel matching for every
i∈[k]. Equivalently, this can be stated in the language of edge colorings as ﬁnding the
smallest k∈Nsuch that there is a Borel map c:E→[k] that is a proper edge coloring ,
i.e.,c(e)/\e}a⊔io\slash=c(f) whenever e/\e}a⊔io\slash=f∈Eshare a vertex. The greedy upper bound [KST99]
implies that χ′
B(G)/lessorequalslant2∆−1 for every Borel graph Gof maximum degree bounded by
∆∈N. In the same paper [Mar16], Marks found an example of acylic ∆-regular Borel
graphGsuch that χ′
B(G) = 2∆−1 for every ∆∈N. This shows that Borel analogue of
Vizing’s theorem does not hold. Similarly as in the case of vertex colorin gs, it is natural
to ask if Vizing’s theorem hold once Borel measurability is relaxed eithe r in the sense of
measure theory or topology. This question (for both measure and topology) is explicitly
stated in the survey of Kechris and Marks [KM20, Problem 6.13]. Mar ks asked about the
measurable relaxation for regular graphs [Mar16, Question 4.9], and , in fact, the same
question for invariant measures, so-called graphings , was raised earlier by Ab´ ert [Abe10].
In this paper we completely resolve the measurable case, see Theor em 1.1. Before we
state the result we formalize the deﬁnitions and discuss relevant re sults from recent years.
Recall that we always assume that the Borel graph G= (V,B,E) in question has degree
uniformly bounded by ∆∈N. Given a Borel probability measure µon (V,B), we deﬁne
theµ-chromatic index of G,χ′
µ(G),to be the minimal k∈Nsuch that there is a Borel
mapc:E→[k] that satisﬁes
µ({v∈V:cis not proper at v}) = 0,
wherecis not proper at v∈Vif there are edges e/\e}a⊔io\slash=f∈Ethat are adjacent to v
andc(e) =c(f). In another words, cis a proper edge coloring at µ-almost every vertex
v∈V. We say that µisG-invariant , ifµ(g(C)) =µ(C) for every C∈ Band every Borel
injection g:C→Vthat satisﬁes that xandg(x) are in the same connected component
ofGfor every x∈C. In that case the quadruple G= (V,B,µ,E) is called a graphing.
Cs´ oka, Lippner and Pikhurko [CLP16] showed that χ′
µ(G)/lessorequalslant∆+1 for a graphing G=
(V,B,µ,E) that does not contain odd cycles and proved an upper bound of ∆+O(√
∆)
colors for graphings in general. In a related result, Bernshteyn [Be r19, Theorem 1.3]
proved that ∆+o(∆) colors are enough (even for the so-called list-colouring version)
provided that the graphing factors to the shift action Γ/archrightdown[0,1]Γof a ﬁnitely generated
groupΓ. Answering the question of Ab´ ert, the author and Pikhurko [GP20 ] proved a
measurable version of Vizing’s theorem for graphings, that is, χ′
µ(G)/lessorequalslant∆+ 1 for anyMEASURABLE VIZING’S THEOREM 3
graphing G= (V,B,µ,E). Interestingly, the technique developed in [GP20] was greatly
extended by Bernshteyn [Ber22] who found striking applications to the LOCAL model
of distributed computing, see [Ber22, Chr23, BD23] for a current development in that
direction.
Bernshteyn [Ber19], the author and Pikhurko [GP20], T´ oth [T ´21] and the author
[Gre22] investigated weaker notion of approximate edge colorings. In this setting, we
require to ﬁnd for each probability measure µandǫ >0 a coloring of edges that is not
correct or undeﬁned for at most ǫfraction of all edges. Here, the analogues of Vizing’s
theorem as well as K¨ onig’s line coloring theorem hold, see [GP20] and [G re22].
Bowen and Weilacher [BW23] investigated Vizing’s theorem in the conte xt of (Borel)
asymptotic dimension introduced in [CJM+23]. As anapplication they derived that ∆+1
colors are enough for edge colorings of bipartite graphs in the topo logical relaxation sense
and for measures that are hyperﬁnite. Stronger results in the sp ecial case of free Borel
Zd-actions, that is, Borel edge coloring with 2 dcolors which is the analogue of K¨ onig’s
line coloring theorem in this setting, were obtained independently aro und the same time
in [BHT24, CU22, GR23, Wei21].
Recently, Qian and Weilacher [QW22] found connections of the topolo gical relaxation
tocomputablecombinatorics whichallowed themtoderive anupper bo undof∆+2colors
for the Baire measurable analogue of Vizing’s theorem, the full topo logical analogue, that
is∆+1 colors only, remains an interesting open problem.
Next, we state our main result, which is the full analogue of Vizing’s th eorem in the
measurable setting.
Theorem 1.1. Let(V,B)be a standard Borel space, ∆∈N,G= (V,B,E)be a Borel
graph of uniformly bounded degree by ∆∈Nandµbe a Borel probability measure on
(V,B). Thenχ′
µ(G)/lessorequalslant∆+1, i.e., there is a Borel map c:E→[∆+1]that is a proper
edge coloring at µ-almost every vertex v∈V.
In the proof we combine the technique of augmenting iterated Vizing chains introduced
by the author and Pikhurko in [GP20] together with the following resu lt, Theorem 1.2,
that is interesting in its own right and might be useful for other applic ations as well.1
Before we state the result, we need several deﬁnitions. Let G= (V,B,E) be a Borel
graph and µbe a Borel probability measure on ( V,B). Recall that µis called G-quasi-
invariant if µ([A]G) = 0, whenever µ(A) = 0, where [ A]Gis the union of all connected
component of Gthat have non-empty intersection with A. It is a standard fact, see eg
[KM04, Chapter II, Section 8], that if µisG-quasi-invariant, then there is a function
ρµ, called the Radon–Nikodym cocycle of G, that takes values in (0 ,+∞), is deﬁned for
every ordered pair of points x,y∈Vthat are in the same connected component of Gand
satisﬁes the following mass transport principle :
µ(g(C)) =/integraldisplay
Cρµ(x,g(x))dµ
for every C⊆Vand an injective Borel map g:C→Xthat satisﬁes for every x∈C
thatg(x) is in the same connected component of Gasx. While in general ρµcan behave
chaotically, the next result shows that one can always pass to an eq uivalent measure ν
such that ρνis bounded on edges of G.
1After the ﬁrst version of this paper appeared on arXiv, we were inf ormed by G´ abor Elek that Gabriella
Kuhn [Kuh94, Lemma 1] proved the same result in the context of gro up actions, see Remark 1.3.4 JAN GREB ´IK
Theorem 1.2 (see also [Kuh94] Lemma 1) .Let(V,B)be a standard Borel space, ∆∈N,
G= (V,B,E)be a Borel graph of uniformly bounded degree by ∆∈Nandµbe a Borel
probability measure on (V,B)that isG-quasi-invariant. Then there is an equivalent Borel
probability measure νon(V,B)such that
1
4∆/lessorequalslantρν(x,y)/lessorequalslant4∆
for every edge (x,y)∈E.
In particular, if distG(x,y) =k∈N, thenρν(x,y)/lessorequalslant(4∆)k, wheredistGis the graph
distance on G.
Remark 1.3. Kuhn[Kuh94, Lemma 1] showed that if a countable group Γacts in a
quasi-invariant fashion on a standard probability space (X,µ), then there is an equivalent
measure νsuch that the cocycle ρν(−,γ·−)(as a function X→(0,∞)) is bounded for
every ﬁxed γ∈Γ. This result combined with the fact that every Borel graph Gof degree
bounded by ∆(G)<+∞can be generated by 2∆(G)−1involutions (which follows from
the Lusin–Novikov uniformization theorem [Kec95, Theorem 18.10] ) implies Theorem 1.2
possibly with a constant larger than 4∆.
Similar, stronger conditions on the cocycle was used by Conley and Ta muz [CT21].
They designed a procedure for solving the unfriendly coloring problem on graphs of
degree bounded by ∆, and showed that this procedure terminates oﬀ of a µ-null set for
every quasi-invariant Borel probability measure µunder the assumption that 1 −1/∆/lessorequalslant
ρµ(x,y)/lessorequalslant1 + 1/∆for every edge {x,y}(this includes for example the case when µ
is invariant). Finding a measurable unfriendly coloring for a general B orel probability
measure remains an interesting open problem. In general, it would be nice to investigate
if our condition has another applications in the context of local grap h coloring problems.
The paper is structured as follows: in Section 2 we set the notation a nd recall basic
results, in Section 3 we deﬁne the augmenting chains that we conside r in this paper,
so-called 3-step Vizing chains, and estimate how many of them can be attached to an
uncolored edge, in Section 4 we describe an inﬁnite procedure that im proves a given
coloring so that it does not contain augmenting chains of small weight , in Section 5 we
prove Theorem 1.2, that is, we show how to modify a given quasi-invar iant measure to
an equivalent measure that has bounded cocycle on edges, in Sectio n 6 we describe the
double counting argument that estimates the number of uncolored edges, and ﬁnally in
Section 7 we combine all the results to prove Theorem 1.1.
Acknowledgements. I would like to thank Oleg Pikhurko for many insightful discus-
sions and constant support, to G´ abor Elek for pointing out the re ference [Kuh94], and to
the anonymous referee for valuable comments. The author was su pported by Leverhulme
Research Project Grant RPG-2018-424.
2.Preliminaries
Our basic descriptive set theory reference is [Kec95], see also [KM20 , Pik21]. We
mostly follow the notation developed in [GP20]. Let us point out that Ncontains 0. If
k∈N\{0}, then we write [ k] ={1,2,...,k}. IfSis a set, then we write [ S]kfor the set
ofk-element subsets of S. In particular, [ S]2is the set of unordered pairs of S. We follow
a standard graph theoretic notation, i.e., a graph is a pair G= (V,E), where V⊆[E]2,
degG(x) is the number of neighbors of xinG, distG(x,y) denotes the graph distance ofMEASURABLE VIZING’S THEOREM 5
x,y∈VinG, andNG(x) denotes the set of all edges of Gthat are adjacent to x, i.e.,
NG(x) ={e∈E:x∈e}.
Borel graphs ABorel graph is a triplet G= (V,B,E), where ( V,B) is a standard
Borel space, ( V,E) is a graph and Eis a Borel subset of [ V]2(endowed with the natural
σ-algebra inherited from the product σ-algebra B ×BonV×V). We say that Gis of
bounded maximum degree if there is ∆∈Nsuch that degG(x)/lessorequalslant∆for every x∈V.
We write ∆(G) for smallest such ∆. We denote the connectedness relation of GasFG.
That is, FGis an equivalence relation on X, and we write [ x]Gfor theG-connectivity
component of x∈V. If∆(G)<∞, thenFGis a Borel subset of V×Vand|[x]G|is at
most countable. Recall that an equivalence relation Fon a standard Borel space ( X,D)
that is Borel as a subset of X×Xand each F-equivalence class is at most countable is
called acountable Borel equvialence relation (CBER) onX, see [Kec24]. In particular, if
∆(G)<∞, thenFGis a CBER on V. GivenA⊆X, we write [ A]Ffor theF-saturation
ofAinF, i.e., the smallest F-invariant subset of Xthat contains A. If [A]F=A, then
we say that AisF-invariant . In case F=FGwe write simply [ A]G, and say that Ais
G-invariant if it is FG-invariant. Observe that if Ais a Borel set, then so is [ A]F.
Theline graph of a Borel graph G= (V,B,E) is the Borel graph E= (E,C,IG), where
Cis theσ-algebra on Einherited form [ V]2and (E,IG) is the line graph of ( V,E), i.e.,
{e,f} ∈IGif and only if eandfshare exactly one vertex. Observe that if ∆(G)<∞,
then∆(E)/lessorequalslant2∆(G)−2. Similarly as above, FEis the CBER on Einduced by the
connectivity components of E.
ABorel chromatic number χB(G) of a Borel graph Gis the minimal k∈Nsuch that
there is a Borel proper vertex coloring d:V→[k] ofG. Note that the subscript χBrefers
to the corresponding σ-algebra. A Borel chromatic index χ′
B(G) is deﬁned as χC(E). That
isχ′
B(G) =kif there is a Borel proper vertex coloring c:E→[k] ofE.
Measures The set of all Borel probability measures on a standard Borel space ( X,B)
is denoted as P(X). LetFbe a CBER on Xandµ∈ P(X). We say that µisF-quasi
invariant ifµ([A]F) = 0, whenever µ(A) = 0. If G= (V,B,E) is a Borel graph then we
say that µ∈ P(V) isG-quasi-invariant if it isFG-quasi-invariant
Proposition 2.1 (Proposition 3.1 and 3.2 in [GP20]) .LetG= (V,B,E)be a Borel
graph such that ∆(G)<∞,E= (E,C,IG)be its line graph and µ∈ P(V). Then there is
ˆµ∈ P(E)that isE-quasi-invariant and satisﬁes
µ({x∈V:∃e∈A x∈e}) = 0
for every A⊆Ethat satisfy ˆµ(A) = 0.
Proof.By [GP20, Proposition 3.2], we ﬁnd ˜ µ∈ P(V) that is G-quasi invariant and
satisﬁesµ([A]G) = ˜µ([A]G) for every A⊆V. By [GP20, Proposition 3.1], we ﬁnd ˆ µ∈
P(E) that is E-quasi invariant and satisﬁes
˜µ({x∈V:∃e∈A x∈e})< ∆(G)ǫ
for every A⊆Ethat satisﬁes ˆ µ(A)< ǫ. In particular, if ˆ µ(A) = 0, then
µ({x∈V:∃e∈A x∈e})/lessorequalslantµ/parenleftbig
[{x∈V:∃e∈A x∈e}]G/parenrightbig
= ˜µ/parenleftbig
[{x∈V:∃e∈A x∈e}]G/parenrightbig
= 06 JAN GREB ´IK
as ˜µ({x∈V:∃e∈A x∈e}) = 0. /square
A fundamental tool in the study of quasi-invariant measures is the Radon-Nikodym
cocycle. Let ( X,B) be a standard Borel space, Fbe a CBER on Xandµ∈ P(X) be
F-quasi-invariant. Then the Radon–Nikodym cocycle (of µwith respect to F)is a Borel
function ρµ,F:F→R>0with the property that
µ(g(C)) =/integraldisplay
Cρµ,F(x,g(x))dµ(x)
for every C∈ Band injective Borel map g:C→Xsuch that ( x,g(x))∈F. It is a
standard fact that the Radon–Nikodym cocycle exists and it is uniqu e up to null-sets,
that is, if ρandρ′are two Radon–Nikodym cocycles of µwith respect to F, then there
is aµ-conullF-invariant set A⊆Xsuch that
ρ↾(F∩(A×A)) =ρ′↾(F∩(A×A)),
see [KM04]. The following statement summarizes the properties of co cycles that we need.
Proposition 2.2 (ChapterII,Section8in[KM04]) .Let(X,B)be a standard Borel space,
Fbe a CBER on Xandµ∈ P(X)beF-quasi-invariant. Then the Radon–Nikodym
cocycleρµ,F:F→R>0satisﬁes:
(1) there isa µ-conullF-invariantset A∈ Bsuch that ρµ,F(x,y)ρµ,F(y,z) =ρµ,F(x,z)
for anyx,y,z∈Asuch that y,z∈[x]F,
(2) (mass transport) we have
/integraldisplay
X/summationdisplay
x∈[y]FF(x,y)dµ(y) =/integraldisplay
X/summationdisplay
y∈[x]FF(x,y)ρµ,F(x,y)dµ(x)
for any function F:F→[0,∞].
In case that F=FG, we write ρµ,Ginstead of ρµ,FG. IfFis clear from context, then we
write simply ρµ.
Deﬁnition 2.3. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞andµ∈ P(V)
beG-quasi-invariant. We say that µisG-bounded if
1
4∆/lessorequalslantρµ(x,y)/lessorequalslant4∆
for every {x,y} ∈E.
We show in Theorem 5.1 that every G-quasi-invariant µ∈ P(V) is equivalent with a
G-bounded measure ν∈ P(V).
3.Edge colorings
LetG= (V,B,E) be a Borel graph such that ∆(G)<∞. Apartial (Borel proper
edge) coloring ofGis a partial Borel (with respect to the σ-algebraConE, in particular,
dom(c)∈ C) mapc;E→[∆(G)+1] that assigns diﬀerent colors to diﬀerent edges that
share a vertex. Usually we use lower case Greek letters for colors, e.g.α,β∈[∆(G)+1].
Given a partial coloring c, we deﬁne mc(x) to be the set of missing colors at x∈V, i.e.,
mc(x) = [∆(G)+1]\{c(e) :e∈NG(x)}. We also write Ucfor the set of uncolored edges,
i.e.,Uc=E\dom(c).MEASURABLE VIZING’S THEOREM 7
In order to improve a given partial coloring c, we utilize an idea from the proof of
Vizing’s theorem, so called Vizing chains . In general, given an uncolored edge e∈Uc, we
want to ﬁnd an injective augmenting sequence of edges Wc(e) = (ei)i/lessorequalslantksuch that e0=e,
ei∩ei+1/\e}a⊔io\slash=∅fori/lessorequalslantkandei/\e}a⊔io\slash∈Ucfor every 1 /lessorequalslanti/lessorequalslantkwith the property that keeping the
colors outside of Wc(e) intact but shifting the colors from ei+1toeiproduces a diﬀerent
partial (proper) coloring c′such that mc′(z0)∩mc′(z1)/\e}a⊔io\slash=∅, where{z0,z1}=ekis the
last edge of Wc(e). Extending c′by assigning any color from mc′(z0)∩mc′(z1) toekthen
improves cas we decreased the number of uncolored edges. Observe that th e diﬀerence
between candc′is contained in Wc(e).
Various types of sequences Wc(e) have been used in the literature. In order to prove
classical Vizing’s theorem, one chooses Wc(e) to be a concatenation of a so-called fan
and analternating path , also known as a Vizing chain . To prove an analogue of Vizing’s
theorem for graphings, the author and Pikhurko [GP20] iterated t his process two times.
Namely, ﬁrst we ﬁx a Vizing chain, then truncate it at any edge on the alternating
path, and then grow a second Vizing chain from that place; such a se quence is called an
iterated Vizing chain . In order to devise eﬃcient (both deterministic and randomized)
local algorithms that produce a proper edge colorings with ∆+1 colors on ﬁnite graphs,
Bernshteyn [Ber22] iterated this process log( n) times, where nisthe number ofvertices of
the graph. Bernshteyn called the produced injective sequence a multi-step Vizing chain .
In this paper, being ideologically more closer to [GP20], we iterate the p rocess 3 times.
We follow the terminology of Bernshteyn and call this augmenting cha in a 3-step Vizing
chain. The estimate for the number of 3-step Vizing chains that can be as signed to a
given uncolored edge follows the computation from [GP20]. It seems p lausible that one
can get similar estimate by adapting the results from ﬁnite graphs, b ut we decided to
follow the more direct path of generalizing [GP20].
3.1. 3-step Vizing chains. We recall the notation from [GP20, Section 2] and refer the
reader there for basic results about this notation. Fix a Borel gra phG= (V,B,E) such
that∆(G)<∞and a partial edge coloring c;E→[∆(G)+1]. Set ∆=∆(G) and ﬁx an
ordering of the set of colours [ ∆+1].
Achainis a sequence P= (e0,...) of edges of Gsuch that for every index i∈N
withei,ei+1being in Pwe haveei∩ei+1/\e}a⊔io\slash=∅, that is, every two consecutive edges in P
intersect. Let l(P) =|P|denote the lengthof the chain P, i.e., the number of edges in
P. Note that a chain can be ﬁnite (possibly empty) or inﬁnite; thus l(P)∈N∪ {∞}
and, ifPis ﬁnite, then P= (e0,...,e l(P)−1). The convention of labeling the ﬁrst edge as
e0allows us to write P= (ei)i<l(P), regardless of whether Pis ﬁnite or not. If l(P) =∞,
then we deﬁne l(P)−1 =∞in order to avoid case by case statements in several places.
We callei−1thei-thedge ofP. For an edge fthat occurs exactly once in P, let its
indexi(f) bei/greaterorequalslant1 such that f=ei−1, that is, the index of the i-th edge is i. Also, for
i/lessorequalslantl(P), letPi= (ej)j<idenote the i-th preﬁx ofP(which consists of the ﬁrst iedges
fromP). We have, for example, that Pl(P)=P. For chains PandQ, we write P⊑Qif
P=Ql(P), that is, Pis a preﬁx of Q. IfPis a ﬁnite chain with the last edge eandQis
a chain with the ﬁrst edge fande∩f/\e}a⊔io\slash=∅, then we write P⌢Qfor the chain that is the
concatenation of PandQ.
Let us call a chain P= (ei)i<l(P)apathifPis empty, or if every vertex z∈Vbelongs
to at most 2 edges from Pand there is a vertex that belongs only to e0. (In other words,
Pis a ﬁnite path with a ﬁxed direction on edges or an inﬁnite one-sided ra y, where no8 JAN GREB ´IK
self-intersections are allowed.) Also, a chain Pis called a cycleifPis non-empty and
every vertex belongs to 0 or 2 edges of P. (These are just ﬁnite cycles, having some edge
and direction ﬁxed.)
Deﬁnition 3.1 (Deﬁnition 2.2 in [GP20]) .We say that a chain P= (ei)i<l(P)is
(1)edge injective if every edge appears at most once in P, that is, for every 0/lessorequalslanti <
j < l(P)we have that ei/\e}a⊔io\slash=ej,
(2)c-shiftable ifl(P)/greaterorequalslant1,Pis edge injective, e0∈Ucandej∈dom(c)for every
1/lessorequalslantj < l(P)(that is, if Pis non-empty with no edge repeated and e0is the unique
uncoloured edge of P);
(3)c-proper-shiftable ifPisc-shiftable and cP;E→[∆+ 1]is a partial coloring,
wherecPisthe shift of calongP(orP-shift ofcfor short) which is deﬁned as
•dom(cP) = dom( c)∪{e0}\{el(P)−1}where we put {el(P)−1}=∅ifl(P) =∞,
•cP(ei) =c(ei+1)for every i+1< l(P),
•cP(f) =c(f)for every f∈dom(c)\P;
(4)c-augmenting ifPisc-proper-shiftable and either l(P) =∞orPis ﬁnite with
mcP(x)∩mcP(y)/\e}a⊔io\slash=∅wherex/\e}a⊔io\slash=yare the vertices of the last edge el(P)−1ofP.
Next we describe the building blocks that will be used to build 3-step Viz ing chains:
Alternating path . Letx∈Vandα,β∈[∆+ 1] be diﬀerent colours such that
β∈mc(x). Then there is a unique maximal chain P= (ei)i<l(P)such that x∈e0if
l(P)>0,x/\e}a⊔io\slash∈e1ifl(P)>1, andc(ei) =α(resp.c(ei) =β) for every i < l(P) that is
even (resp. odd). We call this unique maximal chain the (alternating) α/β-path starting
atx∈Vand denote it as Pc(x,α/β). IfPc(x,α/β) is ﬁnite and non-empty, then we call
the unique y∈Vsuch that |{f∈Pc(x,α/β) :y∈f}|= 1 and y/\e}a⊔io\slash=xthelast vertex of
Pc(x,α/β). IfPc(x,α/β) is empty (which happens exactly when α∈mc(x)), then the
last vertex isx. Whenever we write Pc(x,α/β) we always assume that the condition that
β∈mc(x) is satisﬁed. Observe that the colors on the chain alternate betwe enαandβ
(starting with α) and we never return to a vertex we have previously visited (and th us
the edges in Pform a path).
Fan. Lete∈Ucandx∈e. We deﬁne the maximal fan around xstarting at e, in
symbols Fc(x,e), as a (ﬁnite) chain P= (e0,e1,...,e k) such that x∈eifor every i/lessorequalslantk
and if we denote the other vertex in eibyvithen the following statements are satisﬁed
(1)e0=e,
(2)Pis edge injective,
(3)c(ei+1)∈mc(vi) for every i < kandc(ei+1) is the minimal color available in the
i-th step, where we say that a color αisavailable in the i-th stepifα∈mc(vi),
(4) (e0,...,e k) is maximal with these properties.
Conditional fan . We generalize, but only formally, the following deﬁnition from
[GP20, Section 2.5]. Take Pc(x,α/β) for some x∈V. Letf∈Pc(x,α/β) be a an edge
that is not ﬁrst nor last in Pc(x,α/β) andy∈Vbe the last vertex of Pc(x,e)i(f). We
deﬁnethe maximal α/β-conditional fan starting at f, denoted as Fc(x,α/β,y), as a chain
P= (g0,...,g m) such that y∈gifor every i/lessorequalslantmand, if we denote the other vertex of
gibyui, then the following is satisﬁed
(1)g0=f,MEASURABLE VIZING’S THEOREM 9
(2)Pis edge injective,
(3)c(gi+1)∈mc(ui) and it is the minimal available color,
(4)α,β/\e}a⊔io\slash∈mc(ui) for every i < m,
(5) ifα,β/\e}a⊔io\slash∈mc(um), then (g0,...,g m) is maximal with the properties above.
Note that we should rather write uf
i,gf
iandyfto stress that those objects depend on
the choice of f. This will be however omitted in the cases when we work with only one
f.
Now we are ready to for the main deﬁnition.
Deﬁnition 3.2 (3-step Vizing chain) .LetG= (V,B,E)be a Borel graph such that
∆(G)<∞,c;E→[∆(G) + 1]be a partial edge coloring and e∈Uc. We say that a
c-augmenting chain Wc(e) = (ei)i<l(Wc(e)), wherel(Wc(e))∈N∪{∞}, is a3-step Vizing
chain (at e)if there are pairwise diﬀerent vertices y1,y2,y3,z1,z2,z3∈V, and colors
αi,βi∈[∆(G)+1]fori∈ {1,2,3}such that
Wc(e) =/parenleftbig
F1
c/parenrightbig⌢/parenleftbig
P1
c/parenrightbig⌢/parenleftbig
F2
c/parenrightbig⌢/parenleftbig
P2
c/parenrightbig⌢/parenleftbig
F3
c/parenrightbig⌢/parenleftbig
P3
c/parenrightbig
,
where
(1)F1
c⊑Fc(y1,e),F2
c⊑Fc(z1,α1/β1,y2)andF3
c⊑Fc(z2,α2/β2,y3),
(2)Pi
c⊑Pc(zi,αi/βi)for every i∈ {1,2,3},
(3) ifT∈ {Fi
c}3
i=1∪{Pi
c}3
i=1satisﬁesT=∅, then every Sto the right from Tin the
deﬁnition of Wc(e)is empty as well, i.e., Wc(e)is built by at mostthree iterations
of the “Vizing Chain” construction,
3.2.Construction of 3-step Vizing chains. Lete∈Ucandx∈ebe ﬁxed. First, we
describe a process that produces many chains of the form
Wc(e) =/parenleftbig
F1
c/parenrightbig⌢/parenleftbig
P1
c/parenrightbig⌢/parenleftbig
F2
c/parenrightbig⌢/parenleftbig
P2
c/parenrightbig⌢/parenleftbig
F3
c/parenrightbig⌢/parenleftbig
P3
c/parenrightbig
that satisﬁes (1)–(3) in Deﬁnition 3.2, then we investigate how many of these chains are
3-step Vizing chains, i.e., which ones are c-augmenting. We handle each iteration sepa-
rately.
Iteration I . We start with [GP20, Section 2.4]. Recall that the Vizing chain Vc(x,e)
either consists of the fan Fc(x,e), in case it is augmenting, or we have
Vc(x,e) =Fc(x,e)i+1⌢Pc(vi,α/β),
wherei < l(Fc(x,e)) (so-called ﬁrst critical index) and {x,vi}is the last edge of the
truncated fan Fc(x,e)i1+1.
Claim 1 (Proposition 2.9 in [GP20]) .IfFc(x,e)is notc-augmenting, then there is i <
l(Fc(x,e))such that Fc(x,e)i+1⌢Pc(vi,α/β)isc-augmenting, where (x,vi)is the last edge
of the truncated fan Fc(x,e)i+1andβis the smallest missing color at vi. In particular,
the Vizing chain Vc(x,e)is a3-step Vizing chain.
Moreover, if nonempty, then Pc(vi,α/β)does not use the vertex x.
Suppose that Pc(vi,α/β) is non-empty. Deﬁne F1
c=Fc(x,e)i1+1,y1=x,z1=viand
α1=α,β1=β. This concludes the ﬁrst iteration of the construction.10 JAN GREB ´IK
Iteration II . Recall that f1∈Pc(z1,α1/β1) issuitable[GP20, Deﬁnition 2.10] if it is
of graph distance /greaterorequalslant3 fromF1
c, it is not the last edge of Pc(z1,α1/β1) andc(f1) =α1(we
remark that the last condition only helps with the notation and is othe rwise irrelevant).
Lety2be the last vertex of Pc(z1,α1/β1)i(f1)and setFc(x,e❀f1) =Fc(z1,α1/β1,y2),
whereFc(z1,α1/β1,y2) is the maximal α1/β1-conditional fan starting at f1.
Claim 2 (Proposition 2.12 in [GP20]) .Letf1∈Pc(z1,α/β)be suitable. Then
P=Vc(x,e)i(f1)−1⌢Fc(x,e❀f1)
isc-proper-shiftable.
According to the typeoff1, as deﬁned in [GP20, Section 2.5], it is possible to assign
an injective sequence of edges Qsuch that either Q=Fc(x,e❀f1), or
Q=Fc(x,e❀f1)m+1⌢Pc(um,γ/δ),
wherem < l(Fc(x,e❀f1)) (the so called second critical index), {y2,um}is the last
edge of the truncated fan Fc(x,e❀f1)m+1and{γ,δ}is either equal to or disjoint from
{α1,β1}. Using the technical notion of superbedges, the following, again adapted to our
terminology, is shown in [GP20].
Claim 3 (Proposition 2.15 and 2.17 in [GP20]) .Letf1∈Pc(z1,α1/β1)be suitable and
superb. The chain
(F1
c)⌢(Pc(z1,α1/β1)i(f1)−1)⌢Q
is a3-step Vizing chain.
Supposethat Pc(um,γ/δ)isnon-empty. Deﬁne P1
c=Pc(z1,α1/β1)i(f1)−1,F2
c=Fc(x,e❀
f1)m+1,z2=umandα2=γ,β2=δ. This concludes the second iteration of the con-
struction.
Iteration III . We say that f2∈Pc(z2,α2/β2) is 2-suitable if
•the graph distance of fandf2is at least 3 for every f∈(F1
c)⌢(P1
c)⌢(F2
c),
•it is not the last edge of Pc(z2,α2/β2)
•c(f2) =α2.
Lety3be the last vertex of Pc(z2,α2/β2)i(f2)and set
Fc(x,e❀f1❀f2) =Fc(z2,α2/β2,y3),
whereFc(z2,α2/β2,y3) is the maximal α2/β2-conditional fan starting at f2.
Proposition 3.3. Letf2∈Pc(z2,α2/β2)be2-suitable. Then
P= (F1
c)⌢(P1
c)⌢(F2
c)⌢(Pc(z2,α2/β2)i(f2)−1)⌢Fc(x,e❀f1❀f2)
isc-proper-shiftable.
Proof.Suppose that cPis not a partial coloring. By the deﬁnition, we ﬁnd a vertex
v∈Vsuch that cP↾NG(v) is not proper. By the fact that f2is 2-suitable together with
[GP20, Proposition 2.12], we see that v/\e}a⊔io\slash∈ffor anyf∈(F1
c)⌢(P1
c)⌢(F2
c). Moreover, we
must have v∈ffor some f∈Fc(x,e❀f1❀f2) as the colors used around vertices that
lie only on the path Pc(z2,α2/β2)i(f2)−1do not change. Now the deﬁnition of Fc(x,e❀
f1❀f2), as the maximal α2/β2-conditional fan starting at f2, shows that no such v∈V
can exist, the argument is literally the same as in [GP20, Proposition 2 .12]. /squareMEASURABLE VIZING’S THEOREM 11
Suppose that f2is 2-suitable and set P2
c=Pc(z2,α2/β2)i(f2)−1. Next we deﬁne various
types of 2-suitable edges and the notion of an amazing edge. This is in spired by similar
notions in [GP20, Section 2.5].
We say that a 2-suitable edge f2∈Pc(z2,α2/β2) is oftype (a)if
P= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢Fc(x,e❀f1❀f2)
isc-augmenting. Every edge of type (a) is said to be amazing. Deﬁne F3
c=Fc(x,e❀
f1❀f2) and set
Wc(e,f1,f2) = (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c).
Then the following is immediate from the deﬁnitions.
Proposition 3.4. Letf2be of type (a). Then Wc(e,f1,f2)is a3-step Vizing chain.
We say that a 2-suitable edge f2∈Pc(z2,α2/β2) is oftype (b)if it is not of type (a)
and in the construction of the conditional fan Fc(x,e❀f1❀f2) we encountered α2or
β2. Observe that as f2is not of type (a), we must have β2∈mc(wn), where {y3,wn}is
the last edge in Fc(x,e❀f1❀f2). Following the previous notation we say that nis
thethird critical index . DeﬁneF3
c=Fc(x,e❀f1❀f2),y3=wn,α3=α2,β3=β2and
P3
c=Pc(z3,α3/β3). We say that f2of type (b) is amazing, if
•PcQ(z3,α3/β3) =Pc(z3,α3/β3), where Q= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c).
Proposition 3.5. Letf2be of type (b) and amazing. Then
Wc(e,f1,f2) = (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c)⌢(P3
c)
is a3-step Vizing chain.
Proof.It follows directly from the deﬁnitions that Wc(e,f1,f2) satisﬁes (1)–(3) in
Deﬁnition 3.2. It remains to show that Wc(e,f1,f2) isc-augmenting. This can be done
by the same argument as in [GP20, Proposition 2.15]. Namely, ﬁrst obs erve that cQ,
where
Q= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c),
is a proper coloring by the same reasoning as in Proposition 3.3. Moreo ver, by the deﬁ-
nition of 2-suitable edge, we must have α2∈mcQ(y3). AsPcQ(z3,α3/β3) =Pc(z3,α3/β3),
we have that Wc(e,f1,f2) isedge injective and β2∈mcQ(z3). This shows that {y3,z3}⌢P3
c
iscQ-augmenting as y3cannot be the last vertex of P3
c(if it were, then PcQ(z3,α3/β3)/\e}a⊔io\slash=
Pc(z3,α3/β3) asα2,β2/\e}a⊔io\slash∈mc(y3)). Hence Wc(e,f1,f2) isc-augmenting as desired. /square
We say that a 2-suitable edge f2∈Pc(z2,α2/β2) is oftype (c) if it is not of type
(a), or (b). Let γbe the smallest colour in mc(y3). The reason why we cannot extend
Fc(x,e❀f1❀f2) is the same as when we build the standard Vizing chain, see [GP20,
Proposition 2.8], or [GP20, Section2.5: Type II edge]. Namely there is a colourδand
index
j < n=l(Fc(x,e❀f1❀f2))−1
such that δis the minimal colour available in both mc(wj) andmc(wn). It is clear that
γ/\e}a⊔io\slash=δbecausef2is not of Type (a) and {α2,β2}∩{γ,δ}=∅becausefis not of Type
(b).12 JAN GREB ´IK
Consider now the alternating γ/δ-pathsPc(wj,γ/δ) andPc(wn,γ/δ). Our aim is to
choose one of them, call it Q, and then deﬁne
Wc(e,f1,f2) = (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(Fc(x,e❀f1❀f2)ℓ+1)⌢Q,
whereℓ∈ {i,m}, depending onthechoiceof Q, issuchthat Wc(x,f1,f2)isc-augmenting.
As in the case of type (b), we need to rule out some edges. We say th at a 2-suitable
f2∈Pc(z2,α2/β2) of type (c) is amazing if, in the above notation, both of the following
equalities hold
•Pc(wj,γ/δ) =PcR(wj,γ/δ),
•Pc(wn,γ/δ) =PcR(wj,γ/δ),
whereR= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c).
Letf2∈Pc(z2,α2/β2) be of type (c) and amazing. We take ℓ∈ {j,n}to be the index
for which there is no h∈Pc(uj,δ/ǫ) such that y3∈h, see [GP20, Proposition 2.9]. If
both indices jandnsatisfy this, then we put ℓ=jfor deﬁniteness. We call this index ℓ
thethird critical index . We deﬁne F3
c=Fc(x,e❀f1❀f2)ℓ+1,z3=wℓ,α3=γ,β3=δ
andP3
c=Pc(wℓ,α3/β3).
Proposition 3.6. Letf2be of type (c) and amazing. Then
Wc(e,f1,f2) = (P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c)⌢(P3
c)
is a3-step Vizing chain.
Proof.It follows directly from the deﬁnitions that Wc(e,f1,f2) satisﬁes (1)–(3) in
Deﬁnition 3.2. It remains to show that Wc(e,f1,f2) isc-augmenting. This can be done
by the same argument as in [GP20, Proposition 2.17]. Namely, ﬁrst obs erve that cQ,
where
Q= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c),
isc-proper shiftable by the same reasoning as in Proposition 3.3. In par ticular,Qis
edge injective. As y3/\e}a⊔io\slash∈ffor anyf∈P3
cby the deﬁnition of the third critical index
andPcR(z3,α3/β3) =Pc(z3,α3/β3), we infer that Wc(e,f1,f2) is edge injective. Similar
argument shows that PcQ(z3,α3/β3) =PcR(z3,α3/β3) =Pc(z3,α3/β3). Moreover, by the
deﬁnition of 2-suitable edge, we must have α3∈mcQ(y3). This shows that {y3,z3}⌢P3
c
iscQ-augmenting. Hence Wc(e,f1,f2) isc-augmenting as desired. /square
Altogether, we just proved the following statement.
Theorem 3.7. Lete∈Uc,x∈e,f1be superb and f2be amazing as deﬁned above.
ThenWc(e,f1,f2)is a3-step Vizing chain.
3.3.How many 3-step Vizing chains are there. Lete∈Ucandx∈e. We say
thateisK-bad for c, whereK∈N, if every 3-step Vizing chain Wc(e) atesatisﬁes
l(Wc(e)))/greaterorequalslant2K+2∆. In the following claims we use the notation from previous section.
Proposition 3.8. LetK∈N,e∈UcbeK-bad forcandx∈e. Then
•l(Pc(vi,α/β))/greaterorequalslantK, wherePc(vi,α/β)is the alternating path from the ﬁrst itera-
tion,
•l(Pc(um,γ/δ))/greaterorequalslantK
2for everysuperb edge f1such that i(f1)/lessorequalslantK
2, wherePc(um,γ/δ)
is the alternating path in the second iteration that corresp onds tof1.MEASURABLE VIZING’S THEOREM 13
Proof.Both chains from Claim 1 and Claim 3 are 3-step Vizing chains. As eisK-bad
forcand both chains contain at most two fans that each contain at most ∆edges, we
conclude that l(Pc(vi,α/β))/greaterorequalslantKandl(Pc(um,γ/δ))/greaterorequalslantK
2under the assumption that f1
is superb and satisﬁes i(f1)/lessorequalslantK
2. /square
Claim 4 (Proposition 2.20 in [GP20]) .LetK∈N,e∈UcbeK-bad for candx∈e.
Then there are colors {γ,δ} ⊆[∆+1]and at least
1
3(∆+1)2/parenleftbiggK
4−∆5−1/parenrightbigg
−2∆3
many superb edges f1∈Pc(vi,α/β)such that i(f1)/lessorequalslantK
2and the alternating path in the
second iteration that corresponds to f1is aγ/δ-path.
Deﬁnition 3.9. LetK∈N,e∈UcbeK-bad forc,x∈eand{γ,δ} ⊆[∆+1]be as in
Claim 4. Deﬁne Vc(e)to be the set of pairs (f1,f2)such that f1∈Pc(vi,α/β)is superb
and satisﬁes i(f1)/lessorequalslantK
2andf2∈Pc(um,γ/δ)is amazing and satisﬁes i(f2)/lessorequalslantK
2(where
the index i(f2)is taken with respect to Pc(um,γ/δ)), wherePc(um,γ/δ)is the alternating
path in the second iteration that corresponds to f1.
Our aim is to estimate the cardinality of Vc(e) as this gives a lower bound on the
cardinality of the set of all 3-step Vizing chains at e. In fact, we bound the cardinality
of the projection of Vc(e) to the second coordinate as this clearly gives a lower bound for
the cardinality of Vc(e).
The following proposition gives a suﬃcient condition for an edge to be a mazing.
Proposition 3.10. LetK∈N,e∈UcbeK-bad for c,x∈eand{γ,δ} ⊆[∆+ 1]be
as in Claim 4. Suppose that f1∈Pc(vi,α/β)is superb, i(f1)/lessorequalslantK
2and pick f2on the
the alternating path Pc(um,γ/δ)(that corresponds to f1in the second iteration). Assume
that
(1)f2is2-suitable,
(2) there is no alternating path Pc(w,ι/κ)such that, simultaneously, w∈Vis ofG-
distance1fromy3∈f2andPc(w,ι/κ)is ofdistance atmost 3from(F1
c)⌢(P1
c)⌢(F2
c),
wheref1is the ﬁrst edge of F2
c.
Thenf2is amazing. In particular, (f1,f2)∈ Vc(e).
Proof.Suppose that the conditions are satisﬁed. If f2is of type (a), then it is amazing.
Iff2is of type (b), then we need to verify that PcQ(z3,α3/β3) =Pc(z3,α3/β3), where
Q= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c). As dist G(y3,z3) = 1, we have that Pc(z3,α3/β3)
avoids (F1
c)⌢(P1
c)⌢(F2
c). Hence if PcQ(z3,α3/β3)/\e}a⊔io\slash=Pc(z3,α3/β3) it must be the case that
y3is covered by Pc(z3,α3/β3). This can only happen if Pc(z3,α3/β3) contains P2
casα3=
α2andβ3=β2. But that is not possible as P2
cis of distance 1 from ( F1
c)⌢(P1
c)⌢(F2
c).
Iff2is of type (c), then we need to verify that Pc(wj,γ/δ) =PcR(wj,γ/δ) and
Pc(wn,γ/δ) =PcR(wj,γ/δ). This follows easily as {γ,δ} ∩ {α2,β2}=∅and both
Pc(wj,γ/δ),Pc(wn,γ/δ) avoid (F1
c)⌢(P1
c)⌢(F2
c). /square
Proposition 3.11. LetK∈N,e∈UcbeK-bad forc,x∈eand{γ,δ} ⊆[∆+1]be as
in Claim 4. Deﬁne f2∈ Sc(e)ifc(f2) =γand there is f1∈Pc(vi,α/β)such that f1is
superb,i(f1)/lessorequalslantK
2,f2∈Pc(um,γ/δ)andi(f2)/lessorequalslantK
2(the index is taken with respect to14 JAN GREB ´IK
Pc(um,γ/δ)andPc(um,γ/δ)corresponds to f1in the second iteration), and at least one
of the items from Proposition 3.10 is not satisﬁed. Then we ha ve
|Sc(e)|/lessorequalslant4(∆+1)44/summationdisplay
r=0(2∆)r/parenleftbiggK
2+∆/parenrightbigg
Proof.Letf1andf2are as above and assume that item (1) from Proposition 3.10 is not
satisﬁed. As c(f2) =γ, we know that either f2is the last edge on Pc(um,γ/δ) or it is
of distance at most 4 from ( F1
c)⌢Pc(vi,α/β)K
2+1. There are at mostK
2many edges that
satisfy the former condition, and we have
/vextendsingle/vextendsingle/vextendsingle/braceleftBig
f∈E: distE(f,(F1
c)⌢Pc(vi,α/β)K
2+1)/lessorequalslant4/bracerightBig/vextendsingle/vextendsingle/vextendsingle/lessorequalslant4/summationdisplay
r=0(2∆)r/parenleftbiggK
2+∆/parenrightbigg
(1)
which gives upper bound on the latter condition.
Suppose that (2) from Proposition 3.10 is not satisﬁed. That means that there is a
pathPc(w,ι/κ), where wis of distance one from y3, that intersect
B=/braceleftBig
f∈E: distE(f,(F1
c)⌢Pc(vi,α/β)K
2+1)/lessorequalslant4/bracerightBig
.
Every edge from Bis an element of 2( ∆+1)2many such paths. Together with (1), we
conclude that there are at most
2(∆+1)44/summationdisplay
r=0(2∆)r/parenleftbiggK
2+∆/parenrightbigg
edgesf2that do not satisfy (2) from Proposition 3.10.
Summing these three bounds gives the desired estimate. /square
Proposition 3.12. LetK∈N,e∈UcbeK-bad forc,x∈eand{γ,δ} ⊆[∆+1]be as
in Claim 4. Deﬁne f2∈ Tc(e)ifc(f2) =γand there is f1∈Pc(vi,α/β)such that f1is
superb,i(f1)/lessorequalslantK
2,f2∈Pc(um,γ/δ)andi(f2)/lessorequalslantK
2(the index is taken with respect to
Pc(um,γ/δ)andPc(um,γ/δ)corresponds to f1in the second iteration). Then we have
|Tc(e)|/greaterorequalslantK
4∆2/parenleftbigg1
3(∆+1)2/parenleftbiggK
4−∆5−1/parenrightbigg
−2∆3/parenrightbigg
Proof.By Claim 4, there is {γ,δ} ⊆[∆+1] and at least
1
3(∆+1)2/parenleftbiggK
4−∆5−1/parenrightbigg
−2∆3
many superb edges f1∈Pc(vi,α/β) such that i(f1)/lessorequalslantK
2and the alternating path in the
second iteration that corresponds to f1is aγ/δ-path. For each such f1, there are at least
K
4edges of the corresponding Pc(um,γ/δ) that have color γ. This shows that there are
at least
K
4/parenleftbigg1
3(∆+1)2/parenleftbiggK
4−∆5−1/parenrightbigg
−2∆3/parenrightbigg
pairs (f1,f2) that satisfy the conditions above. To estimate the size of Tc(e) we need to
compute the number of pairs ( f1,f2) to which a given edge f2contributes.MEASURABLE VIZING’S THEOREM 15
Everyf2can reach f1by following the γ/δpath in one of its two directions, and then
there are ∆2many choices for f1. Altogether,
|Tc(e)|/greaterorequalslantK
4∆2/parenleftbigg1
3(∆+1)2/parenleftbiggK
4−∆5−1/parenrightbigg
−2∆3/parenrightbigg
as needed. /square
Finally observe that the projection of Vc(e) to the second coordinate contains Tc(e)\
Sc(e)byProposition 3.10. Hence, thecombinationofPropositions 3.11an d3.12,together
with a trivial modiﬁcation gives the main estimate.
Theorem 3.13. LetK∈N,e∈UcbeK-bad forcandx∈e. Then we have
|Vc(e)|/greaterorequalslantK2
(8∆)4−(16∆)5K.
Inparticular, for every e∈Ucthat isK-bad and x∈ethere are atleast/parenleftBig
K2
(8∆)4−(16∆)5K/parenrightBig
many pairs (f1,f2)such that Wc(e,f1,f2)is a three step Vizing chain.
4.Improving colorings
In this section we describe one step of the algorithm that will, in Sectio n 7 produce
the desired ∆(G) + 1 edge coloring µ-almost everywhere. The step, and therefore the
whole algorithm, can be run on any Borel graph G= (V,B,E) of degree bounded by
∆(G)<∞endowed with an E-quasi-invariant Borel probability measure ν∈ P(E),
whereE= (E,C,IG) is the corresponding line graph. However, in order to show that
the algorithm terminates ν-almost everywhere, we need to assume additionally that νis
G-bounded, see Section 5.
FixGandνas above, and a Radon-Nikodym cocycle ρνofνwith respect to E.
Deﬁnition 4.1. We say that a partial coloring c;E→[∆(G) + 1] does not admit an
improvement of weight L∈Nif
ν


e∈Uc:∃3-step Vizing chain Wc(e) s.t./summationdisplay
f∈Wc(e)ρν(e,f)/lessorequalslantL


= 0.
If this condition is not satisﬁed, then we say that cadmits an improvement of weight
L.
Theorem 4.2. Letc;E→[∆(G)+1]be a partial coloring and L∈N. Then there is a
partial coloring c′;E→[∆(G)+1]that does not admit improvement of weight Lwith the
property that ν(dom(c)\dom(c′)) = 0and
ν({e∈E:c(e)/\e}a⊔io\slash=c′(e)})/lessorequalslantLν(Uc),
wherec(e)/\e}a⊔io\slash=c′(e)also includes the situation when e∈dom(c′)\dom(c).
Proof.The strategy of the proof follows closely [GP20, Proof of Proposit ion 5.4]. For a
partial coloring d;E→[∆(G)+1] deﬁne Adto be the set of those e∈Udfor which there
exists a 3-step Vizing chain Wd(e) such that
/summationdisplay
f∈Wd(e)ρν(e,f)/lessorequalslantL.16 JAN GREB ´IK
Clearly,ν(Ad) = 0 if and only if ddoes not admit improvement of weight L. Setc0=c.
We use induction to build a transﬁnite sequence of partial colorings ( cα)α<ℵ1that satisfy
the following:
(1) for every α < β < ℵ1, we have ν(dom(cα)\dom(cβ)) = 0,
(2) for every α <ℵ1, ifν(Acα)/\e}a⊔io\slash= 0, then ν(Ucα+1)< ν(Ucα),
(3) for every α < β < ℵ1, ifcα/\e}a⊔io\slash=cβ, thenν(Ucβ)< ν(Ucα),
(4) ifcα=cα+1for some α <ℵ1, thencα=cβfor every α/lessorequalslantβ <ℵ1,
(5) for every α < β < ℵ1,
ν({e∈E:cα(e)/\e}a⊔io\slash=cβ(e)})/lessorequalslantL/summationdisplay
α/lessorequalslantα′<βν(Sα′) =Lν/parenleftBigg/uniondisplay
α/lessorequalslantα′<βSα′/parenrightBigg
/lessorequalslantLν(Uc),
whereSα′=Ucα′\Ucα′+1.
Once we build such a sequence then we are done. Indeed, conditions (3) and (4) guar-
antee the existence of α <ℵ1such that cα=cβfor every α/lessorequalslantβ <ℵ1as there are
no strictly decreasing sequences of real numbers of length ℵ1. Deﬁne c′=cα0, where
α0is the minimal ordinal with this propery. Then (1) (with the choice 0 < α0) implies
ν(dom(c)\dom(c′)) = 0, (2) implies that c′=cα0does not admit improvement of weight
Land (5) (with the choice 0 < α0) implies that ν({e∈E:c(e)/\e}a⊔io\slash=c′(e)})/lessorequalslantLν(Uc).
Successor stage α/ma√s⊔o→α+1.Suppose that we have constructed a sequence of partial
colorings ( cβ)β/lessorequalslantαsuch that the property (1)–(5) hold for every (pair of) ordinal(s ) less
or equal than α. Ifν(Acα) = 0, then setting cα+1=cαclearly works. Suppose that
ν(Acα)>0 and pick any Borel assignemnt e∈Acα/ma√s⊔o→Wcα(e) with the property Wcα(e)
is a 3-step Vizing chain and/summationtext
f∈Wc(e)ρν(e,f)/lessorequalslantLfor eveye∈Acα.
Case I. There is k∈Nsuch that
ν({e∈Acα:|Wcα(e)|=k})>0.
By [KST99, Proposition 4.6] (applied on the 2 k+2 power graph of Ethat is of bounded
degree), there is a set Sα⊆Acαwith the property that
(a)ν(Sα)>0,
(b)e/\e}a⊔io\slash=e′∈Sαare at least 2 k+2 far apart in the graph distance of E,
(c)|Wcα(e)|=kfor every e∈Sα.
SetTα=/uniontext
e∈SαWcα(e) and observe that
ν(Tα) =/integraldisplay
e∈Sα/summationdisplay
f∈Wcα(e)ρν(e,f)dν/lessorequalslantLν(Sα) (*)
by item (2) in Proposition 2.2. As {Wcα(e)}e∈Sαare pairwise of positive distance from
each other by (b) and (c), and each Wcα(e) is augmenting, there is a partial coloring cα+1
with the property that
(i)Tα⊆dom(cα+1),
(ii)cα↾(dom(cα)\Tα) =cα+1↾(dom(cα)\Tα).
We claim that cα+1works as required, namely, let α′< α+1, then
(1)ν(dom(cα′)\dom(cα+1)) = 0 as ν(dom(cα′)\dom(cα)) = 0 and dom( cα+1) =
dom(cα)∪Sαby (i) and (ii),
(2) follows from dom( cα+1) = dom( cα)∪Sαtogether with (a),MEASURABLE VIZING’S THEOREM 17
(3) follows from (2) combined with inductive assumption (3),
(4) ifcα′=cα′+1for some α′< α, thenν(Acα) = 0 by the inductive assumption (4)
and (2),
(5) observe that ν(Sα∩Sβ) = 0 for every β < αby the inductive assumption (1),
consequently when combined with the inductive assumption (5) and ( *), we have
ν({e∈E:cα′(e)/\e}a⊔io\slash=cα+1(e)})/lessorequalslantν({e∈E:cα′(e)/\e}a⊔io\slash=cα(e)})
+ν({e∈E:cα(e)/\e}a⊔io\slash=cα+1(e)})
/lessorequalslantL/summationdisplay
α′/lessorequalslantβ<αν(Sβ)+ν(Tα)
/lessorequalslantL/summationdisplay
α′/lessorequalslantβ<α+1ν(Sβ)
=Lν/parenleftBigg/uniondisplay
α′/lessorequalslantβ<α+1Sα′/parenrightBigg
/lessorequalslantLν(Uc).
Case II. There is no k∈Nsuch that
ν({e∈Acα:|Wcα(e)|=k})>0.
In another words, ν-almost every 3-step Vizing chain is inﬁnite. Observe that this can
happen if and only if there is an assignment (deﬁned for ν-almost every e∈Acα)
e∈Acα/ma√s⊔o→(xe,αe,βe), where xe∈Vandαe,βe∈[∆+ 1], such that Wcα(e) =
M(e)⌢Pcα(xe,αe/βe). Using ﬁnite additivity of νand [KST99, Proposition 4.6], we ﬁnd
10< k∈N,α,β∈[∆+1] and Rα⊆Acαsuch that
(a)ν(Rα)>0,
(b)|M(e)|=k,αe=αandβe=βfor every e∈Rα,
(c)e/\e}a⊔io\slash=e′∈Rαare at least 5 kfar apart in the graph distance of E.
Note that this implies that if e/\e}a⊔io\slash=e′∈Rα, then
•xe/\e}a⊔io\slash=xe′and consequently Pcα(xe,α/β) andPcα(xe′,α/β) are vertex disjoint,
•M(e) andM(e′) are at least 2 kapart in the graph distance of E.
However, it can happen that M(e)∩Pcα(xe′,α/β)/\e}a⊔io\slash=∅.
We address this issue as follows. Deﬁne anauxiliary directed graph HonRαasfollows.
Fore/\e}a⊔io\slash=e′∈Rα, let (e,e′) be an oriented edge if Pcα(xe′,α/β) intersect BE(e,2k), the
ball of radius 2 karounde. Note that as |BE(e,2k)|/lessorequalslant(2∆)2kfor every e∈Rα, the
graphHhas uniformly bounded outdegree. By [KST99, Proposition 4.5], we ca n write
Rα=/uniontext
n∈NRα,n, where each Rα,nisH-independent. By σ-additivity of νwe ﬁndn∈N
such that ν(Rα,n)>0 and set Sα=Rα,n.
Lete/\e}a⊔io\slash=e′∈Sα. By the deﬁnition we have that Wcα(e) andWcα(e′) are vertex
disjoint. Moreover, ( cα)eextendscαase∈dom((cα)e) and dom( cα)⊆dom((cα)e). Set
Tα=/uniontext
e∈SαWcα(e) and deﬁne
cα+1(f) =/braceleftBigg
cα(f) iff/\e}a⊔io\slash∈Tα
(cα)e(f) iff∈Wcα(e), where e∈Sαis the unique such edge .
It follows immediately that
(i)Tα⊆dom(cα+1),
(ii)cα↾(dom(cα)\Tα) =cα+1↾(dom(cα)\Tα).18 JAN GREB ´IK
Observe that cα+1is a partial coloring. Indeed, if x∈Vis not covered by any edge of
distance k+2 to some e∈Sα, thencα+1↾NG(x) =cα↾NG(x) (as the only modiﬁcation
is a shift of some of the inﬁnite α/β-paths). On the other hand if x∈Vis of distance
at mostk+2 to some e∈Sα, thencα+1↾NG(x) = (cα)e↾NG(x), hencecα+1is a partial
coloring. Same reasoning as above shows that
ν(Tα) =/integraldisplay
e∈Sα/summationdisplay
f∈Wcα(e)ρν(e,f)dν/lessorequalslantLν(Sα) (**)
by item (2) in Proposition 2.2. Verifying the conditions (1)–(5) can be done mutatis
mutandis as in the Case (I).
Limit stage βրα.Suppose that α <ℵ1is a limit ordinal and we have constructed
(cβ)β<αsuch that the property (1)–(5) hold for every (pair of) ordinal(s ) strictly less than
α. We claim that cα(e) := lim β→αcβ(e) is deﬁned ν-almost everywhere, i.e., the sequence
of colors ( cβ(e))β<αeventually stabilizes (in fact the colors in the sequence are changed
only ﬁnitely many times) for ν-almost every e∈E. This follows from the Borel-Cantelli
lemma as, by the previous paragraph, the sequence ( Tβ)β<α, whereTβis the set of edges
that changed their color in the βth step, satisﬁes
/summationdisplay
β<αν(Tβ)/lessorequalslant/summationdisplay
β<αLν(Sβ)/lessorequalslantLν(Uc)<∞.
Hence the set of edges e∈Efor which {β < α:e∈Tβ}is coﬁnal in αhas to be ν-null.
It remains to show that (1)–(5) continuous to hold with α. Letα′< α, then
(1) by the fact that α <ℵ1, the inductive assumption and construction of cα, we have
ν({e∈dom(cα′) :∃α′< β′< α e/\e}a⊔io\slash∈dom(cβ′) or lim
β→αcβ(e) not deﬁned }) = 0,
consequently, ν(dom(cα′)\dom(cα)) = 0,
(2) is not relevant in limit stages,
(3) ifcα′/\e}a⊔io\slash=cα, thencα′/\e}a⊔io\slash=cα′+1(see (4)), this implies that
ν(Ucα′)> ν(Ucα′+1)/greaterorequalslantν(Ucα)
asν(dom(cα′+1)\dom(cα)) = 0 by (1) (where the strict inequality follows from
the inductive assumption (3)),
(4) ifcβ′=cβ′′for some β′< αand every β′/lessorequalslantβ′′< α, thencα(e) = lim β→αcβ(e)=
cβ′(e), hencecα=cβ′,
(5) ifcα′(e)/\e}a⊔io\slash=cα(e), then there must be α′/lessorequalslantβ < αsuch that e∈Tβas otherwise
cα(e) = lim β→αcβ(e) =cα′(e), consequently, we have
ν({e∈E:cα′(e)/\e}a⊔io\slash=cα(e)})/lessorequalslant/summationdisplay
α′/lessorequalslantβ<αν(Tβ)/lessorequalslant/summationdisplay
α′/lessorequalslantβ<αLν(Sβ)
=L/summationdisplay
α′/lessorequalslantβ<αν(Sβ) =Lν/parenleftBigg/uniondisplay
α′/lessorequalslantβ<αSβ/parenrightBigg
/lessorequalslantLν/parenleftBigg/uniondisplay
β<αSβ/parenrightBigg
/lessorequalslantLν(Uc)
by the deﬁnition of TβandSβcombined with the fact that ν(Sβ∩Sβ′) = 0 for
everyβ < β′< αwhich follows by the inductive assumption (1).MEASURABLE VIZING’S THEOREM 19
This ﬁnishes the proof. /square
5.Cocycle bounded on edges
Recall that two Borel probablity measures µ,ν∈ P(V) are equivalent if µ(A) = 0 if
and only if ν(A) = 0 for every A∈ B. We restate Theorem 1.2 in a compact form for the
convenience of the reader.
Theorem 5.1. Let∆∈N,G= (V,B,E)be a Borel graph such that ∆(G)<∞and
µ∈ P(V)be aG-quasi-invariant. Then there is an equivalent G-bounded Borel probability
measure ν∈ P(V).
Proof.LetG[k]denote the Borel graph on V, where ( x,y) form an edge if and only if
distG(x,y) =k. ThenG[1]=GandG[k]has degree bounded by ∆k. Use repeatedly
[KST99, Proposition 4.6] to ﬁnd a Borel proper edge coloring {Ak
i}2∆k
i=1ofG[k]for each
k∈N\ {0}. Using any Borel linear order on V, vertices covered by Ak
ican be split
into two disjoint Borel sets Ak
i,0⊆VandAk
i,1⊆Vtogether with Borel isomorphisms
fk
i,0:Ak
i,0→Ak
i,1andfk
i,1:Ak
i,1→Ak
i,0such that {x,fk
i,0(x)},{y,fk
i,1(y)} ∈Ak
ifor every
x∈Ak
i,0andy∈Ak
i,1. We also set A0
0,0=Vandf0
0,0= idV. Observe that for every
(x,y)∈FGthere is exactly one triplet ( k,i,j), where k= dist G(x,y),i∈2∆distG(x,y)and
j∈ {0,1}, such that fk
i,j(x) =y.
Denote as µk
i,jthe push-forward of µ↾Ak
i,1−jvia/parenleftbig
fk
i,j/parenrightbig−1, wherej∈ {0,1}. We have
µk
i,j(B) =µ(fk
i,j(B∩Ak
i,j)) =/integraldisplay
B1Ak
i,j(x)ρµ(x,fk
i,j(x))dµ (2)
for every B∈ B, whereρµis the Radon-Nikodym cocycle with respect to µ. In particular,
µk
i,j(V)/lessorequalslant1. Deﬁne
˜ν=µ+/summationdisplay
k∈N\{0}1
2k
1
2∆k2∆k/summationdisplay
i=1µk
i,0+1
2∆k2∆k/summationdisplay
i=1µk
i,1
. (3)
Claim 5. ˜νis a ﬁnite Borel measure on Vthat is equivalent with µ. The Radon–Nikodym
derivative Ω=d˜ν
dµcan be explicitly written as
Ω(x) = 1+/summationdisplay
k∈N\{0}1
2k
1
2∆k2∆k/summationdisplay
i=11Ak
i,0(x)ρµ(x,fk
i,0(x))+1
2∆k2∆k/summationdisplay
i=11Ak
i,1(x)ρµ(x,fk
i,1(x))

forµ(and˜ν) almost every x∈V. In particular,1
Ω=dµ
d˜ν.
Proof.Letn∈Nand deﬁne
˜νn=µ+n/summationdisplay
k=11
2k
1
2∆k2∆k/summationdisplay
i=1µk
i,0+1
2∆k2∆k/summationdisplay
i=1µk
i,1
.
Asµk
i,j(V)/lessorequalslant1, we see that ˜ νnis a ﬁnite Borel measure on Vthat is equivalent with µ.
Indeed, if µ(A) = 0, then by the deﬁnition of G-quasi-invariance we have that ˜ νn(A) = 0,20 JAN GREB ´IK
and if ˜νn(A) = 0, then µ(A) = 0 as µ(A)/lessorequalslant˜νn(A) for every A∈ B. Moreover, it is easy
to see that the Radon–Nikodym derivative Ωn=d˜νn
dµsatisﬁes
Ωn(x) = 1+n/summationdisplay
k=11
2k
1
2∆k2∆k/summationdisplay
i=11Ak
i,0(x)ρµ(x,fk
i,0(x))+1
2∆k2∆k/summationdisplay
i=11Ak
i,1(x)ρµ(x,fk
i,1(x))

by (2).
Observe that the limit Ω(x) = lim n→∞Ωn(x) is deﬁned for every x∈Vas{Ωn(x)}n∈N
is increasing, and we have
lim
n→∞/integraldisplay
AΩn(x)dµ=/integraldisplay
AΩ(x)dµ
for every A∈ Bby the Monotone Convergence Theorem. Note that by the deﬁnitio n of
Ωnwe have
lim
n→∞˜νn(A) =/integraldisplay
AΩ(x)dµ (4)
for every A∈ B.
The sequence {˜νn}n∈Nis a Cauchy sequence in the total variation distance /bardbl./bardblTV.
Indeed, we have
/bardbl˜νm−˜νn/bardblTV= (˜νm−˜νn)(V) =
m/summationdisplay
k=n1
2k
1
2∆k2∆k/summationdisplay
i=1µk
i,0+1
2∆k2∆k/summationdisplay
i=1µk
i,1

(V)/lessorequalslant1
2n−1
as ˜νm−˜νnis a ﬁnite Borel (positive) measure for every m > n > 1. Consequently,
there is a ﬁnite Borel measure ˜ νon (V,B) such that ˜ νnTV− − →˜ν. In particular, we have
˜νn(A)→˜ν(A)<∞for every A∈ B. Combined with (4), we see that Ω=d˜ν
dµas desired.
Itremainstoshowthat µand ˜νareequivalent. If µ(A) = 0,then ˜ ν(A) = lim n→∞˜νn(A) =
0 as in that case ˜ νn(A) = 0 for every n∈N. On the other hand, if ˜ ν(A) = 0, then/integraltext
AΩ(x)dµ= 0 asΩ=d˜ν
dµ. This can only happen if µ(A) = 0 asΩ/greaterorequalslant1. /square
Letνbe a normalization of ˜ ν, i.e.,ν=K˜νfor some 0 < K <∞. It is easy to see that
νand ˜ν, hence also νandµ, are equivalent. Consequently, νisG-quasi-invariant. Write
ρνfor the Radon–Nikodym cocycle of νwith respect to G.
Claim 6. There is a µ-conullG-invariant set A⊆Vsuch that
ρν(x,y) =ρµ(x,y)Ω(y)
Ω(x)(5)
for every x,y∈Asuch that (x,y)∈FG.
Proof.Letg:C→Vbe a Borel injection such that ( x,g(x))∈FGfor every x∈C. Set
g(C) =D, theng:C→Dis a Borel bijection. As µandνare equivalent,Ω
K=ν
µand
ρµ(x,g(x))Ω(g(x))
Ω(x)are non-negative. We have
/integraldisplay
Cρµ(x,g(x))Ω(g(x))
Ω(x)dν(x) =/integraldisplay
Cρµ(x,g(x))Ω(g(x))
Ω(x)Ω(x)
Kdµ(x)
=/integraldisplay
Cρµ(x,g(x))1
KΩ(g(x))dµ(x).MEASURABLE VIZING’S THEOREM 21
By (2) Proposition 2.2 applied to f(x,y) that is deﬁned as1
KΩ(y) whenever g(x) =y
and 0 otherwise, we have
/integraldisplay
Cρµ(x,g(x))1
KΩ(g(x))dµ(x) =/integraldisplay
D1
KΩ(y)dµ(y)
=ν(D) =ν(g(C))
=/integraldisplay
Cρν(x,g(x))dν(x)
and the claim follows from the uniqueness of the Radon-Nikodym cocy cle. /square
It remains to show that ρµ(x,y)Ω(y)/lessorequalslant4∆Ω(x) for every ( x,y)∈E, as this clearly
impliesρν(x,y) =ρµ(x,y)Ω(y)
Ω(x)/lessorequalslant4∆. Let (x,y)∈E. Suppose that y∈Ak
i,j, i.e.,
z=fk
i,j(y) is well-deﬁned and satisﬁes dist G(y,z) =k. We already observed that the
triplet (k,i,j) is unique. As ( x,y)∈FG, there is exactly one triplet ( k′,i′,j′) such that
x∈Ak′
i′,j′andfk′
i′,j′(x) =z. Moreover, as ( x,y)∈Ewe have that k′/lessorequalslantk+ 1. Indeed,
we have dist G(x,z) =k′/lessorequalslantdistG(x,y) + dist G(y,z) =k+ 1. The same reasoning with
the roles of yandxinterchanged implies that the assignment ( k,i,j)/ma√s⊔o→(k′,i′,j′) is a
bijection. Observe that
1
2k+1(2∆k+1)1Ak
i,j(y)ρµ(x,fk
i,j(y))/lessorequalslant1
2k′(2∆k′)1Ak′
i′,j′(x)ρµ(x,fk′
i′,j′(x)) (6)22 JAN GREB ´IK
holds whenever y∈Ak
i,j. We have
ρµ(x,y)Ω(y) =ρµ(x,y)/parenleftBigg
1+/summationdisplay
k∈N\{0}1
2k/parenleftBigg
1
2∆k2∆k/summationdisplay
i=11Ak
i,0(y)ρµ(y,fk
i,0(y))
+1
2∆k2∆k/summationdisplay
i=11Ak
i,1(y)ρµ(y,fk
i,1(y))/parenrightBigg/parenrightBigg
=ρµ(x,y)+/summationdisplay
k∈N\{0}1
2k/parenleftBigg
1
2∆k2∆k/summationdisplay
i=11Ak
i,0(y)ρµ(x,fk
i,0(y))
+1
2∆k2∆k/summationdisplay
i=11Ak
i,1(y)ρµ(x,fk
i,1(y))/parenrightBigg
/lessorequalslant4∆/parenleftBigg
1
4∆ρµ(x,f0
0,0(y))+/summationdisplay
k∈N\{0}1
2k+1/parenleftBigg
1
2∆k+12∆k/summationdisplay
i=11Ak
i,0(y)ρµ(x,fk
i,0(y))
+1
2∆k+12∆k/summationdisplay
i=11Ak
i,1(y)ρµ(x,fk
i,1(y))/parenrightBigg/parenrightBigg
/lessorequalslant4∆/parenleftBigg
1+/summationdisplay
k′∈N\{0}1
2k′/parenleftBigg
1
2∆k′2∆k′/summationdisplay
i=11Ak′
i′,0(x)ρµ(x,fk′
i′,0(x))
+1
2∆k′2∆k′/summationdisplay
i=11Ak′
i′,1(x)ρµ(x,fk′
i′,1(x))/parenrightBigg/parenrightBigg
= 4∆Ω(x),
where we used (1) Proposition 2.2 to get the second equality and (6) together with the
fact that ( k,i,j)/ma√s⊔o→(k′,i′,j′) is a bijection to get the second inequality. /square
6.Double counting argument
In this section we show that if a partial edge coloring cdoes not admit improvement
of weight L, then the measure of uncolored edges has to be O/parenleftBig
1
log2(L)L/parenrightBig
under the as-
sumption that νisG-bounded.
Theorem 6.1. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞,E= (E,C,IG)
be the corresponding line graph, ν∈ P(E)beE-bounded, i.e., νsatisfyρν(e,f)/lessorequalslant8∆for
everye,f∈Esuch that (e,f)∈IG, andc;E→[∆(G)+1]be a partial coloring that does
not admit improvement of weight L∈N, wherelog8∆(L)/greaterorequalslant(8∆)20. Then
ν(Uc)/lessorequalslant64(4∆)7(∆!)14
log2
8∆(L)L.
Proposition 6.2. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞,E= (E,C,IG)
be the corresponding line graph and ν∈ P(E)beE-bounded. Suppose that c;E→[∆(G)+MEASURABLE VIZING’S THEOREM 23
1]is a partial coloring that does not admit improvement of weig htL∈N, wherelog8∆(L)
2−
1/greaterorequalslant2∆. Thenν-almost every e∈Ucislog8∆(L)
4-bad forc.
Proof.LetWc(e) be a 3-step Vizing chain at e. We have
L/lessorequalslant/summationdisplay
f∈Wc(e)ρν(e,f)/lessorequalslant/summationdisplay
k/lessorequalslant|Wc(e)|(8∆)k/lessorequalslant(8∆)|Wc(e)|+1.
Consequently, |Wc(e)|/greaterorequalslantlog8∆(L)−1/greaterorequalslantlog8∆(L)
2+2∆. /square
We get an immediate corollary of Theorem 3.13.
Proposition 6.3. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞,E=
(E,C,IG)be the corresponding line graph and ν∈ P(E)beE-bounded. Suppose that
c;E→[∆(G)+1]is a partial coloring that does not admit improvement of weig htL∈N,
wherelog8∆(L)/greaterorequalslant(8∆)20. Then we have
|Vc(e)|/greaterorequalslant1
(4∆)7log2
8∆(L)
forν-almost every e∈Uc.
Proposition 6.4. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞,E=
(E,C,IG)be the corresponding line graph and ν∈ P(E)beE-bounded. Suppose that
c;E→[∆(G)+1]is a partial coloring that does not admit improvement of weig htL∈N,
wherelog8∆(L)/greaterorequalslant(8∆)20. Then for ν-almost every e∈Ucand every (f1,f2)∈ Vc(e)we
have/summationdisplay
f∈P3cρν(e,f)/greaterorequalslantL
2,
whereWc(e,f1,f2) = (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c)⌢(P3
c).
Proof.SetP= (F1
c)⌢(P1
c)⌢(F2
c)⌢(P2
c)⌢(F3
c). It follows from the deﬁnition of Vc(e)
thats=l(P)/lessorequalslant3∆+log8∆(L)
2. We have
L/lessorequalslant/summationdisplay
f∈Wc(e,f1,f2)ρν(e,f) =/summationdisplay
f∈Pρν(e,f)+/summationdisplay
f∈P3cρν(e,f)
/lessorequalslant(8∆)3∆+log8∆(L)
2+2+/summationdisplay
f∈P3cρν(e,f).
Consequently,L
2/lessorequalslantL−(8∆)3∆+2L1
2/lessorequalslant/summationtext
f∈P3cρν(e,f) as needed. /square
Deﬁne an auxiliary Borel oriented bipartite multi-graph Hcwith vertex set Uc⊔dom(c)
such that ( e,f) is an edge if f∈P3
cfor some
Wc(e,f1,f2) =/parenleftbig
F1
c/parenrightbig⌢/parenleftbig
P1
c/parenrightbig⌢/parenleftbig
F2
c/parenrightbig⌢/parenleftbig
P2
c/parenrightbig⌢/parenleftbig
F3
c/parenrightbig⌢/parenleftbig
P3
c/parenrightbig
,
where (f1,f2)∈ Vc(e). Note that Hcis in general a multi-graph as there might be
diﬀerent 3-step Vizing chains at the same edge efor which ( e,f)∈ Hcfor the same
f∈dom(c). The following is the crucial observation for the double counting ar gument,
note that the right-hand side of the inequality does not depend on L.
Proposition 6.5. degHc(f)/lessorequalslant32(∆!)14for every f∈dom(c).24 JAN GREB ´IK
Proof.There are at most 2 ∆choices for α3,β3andz3such that f∈P3
c=Pc(z3,α3/β3).
There are at most ∆choices for y3, and at most ∆!∆choices for a fan F3
catx3. For
P2
cwe deduce that there are at most 4( ∆+1)2choices for z2andα2,β2as the last edge
ofP2
chas to intersect the ﬁrst edge of F3
c. Similar estimates hold for F2
c,P1
candF1
c.
Altogether we get that
degHc(f)/lessorequalslant2∆(∆!∆2)3(4(∆+1)2)2/lessorequalslant32(∆!)14
as desired. /square
Proof of Theorem 6.1 Deﬁne a function F(e,f) that counts the number of oriented edges
frometofinHc. By (2) Proposition 2.2, we have/integraldisplay
E/summationdisplay
f∈[e]EF(e,f)ρν(e,f)dν(e) =/integraldisplay
E/summationdisplay
e∈[f]EF(e,f)dν(f). (DC)
Using Proposition 6.5, we get an upper bound for the right-hand side of (DC) as/integraldisplay
E/summationdisplay
e∈[f]EF(e,f)dν(f)/lessorequalslant/integraldisplay
dom(c)degHc(f)dν(f)/lessorequalslant32(∆!)14.
Using the deﬁnition of Vc(e) fore∈Uc, Proposition 6.4 and Proposition 6.3, we get an
lower bound for the left-hand side of (DC) as/integraldisplay
E/summationdisplay
f∈[e]EF(e,f)ρν(e,f)dν(e) =/integraldisplay
Uc/summationdisplay
(f1,f2)∈Vc(e)/summationdisplay
f∈P3cρν(e,f)dν(e)
/greaterorequalslant/integraldisplay
Uc/summationdisplay
(f1,f2)∈Vc(e)L
2dν(e)
/greaterorequalslant/integraldisplay
Uc1
(4∆)7log2
8∆(L)L
2dν(e) =1
2(4∆)7log2
8∆(L)Lν(Uc).
Altogether, we infer that
ν(Uc)/lessorequalslant64(4∆)7(∆!)14
log2
8∆(L)L
as desired. /square
7.Proof of the main result
We restate Theorem 1.1, in a compact form, for the convenience of the reader.
Theorem 7.1. LetG= (V,B,E)be a Borel graph such that ∆(G)<∞andµ∈ P(V).
Then there is a Borel map c:E→[∆(G) + 1]that is a proper edge coloring µ-almost
everywhere.
Proof.Apply Proposition 2.1 to Gto get ˆµ, then apply Theorem 5.1 to E= (E,C,IG)
and ˆµto getν∈ P(E) with the property that ρν(e,f)/lessorequalslant8∆for every e,f∈Esuch that
(e,f)∈IG, andµ({x∈V:∃e∈A x∈e}) = 0 for every A∈ Csuch that ν(A) = 0.
SetLn=A·(8∆)n, whereA∈Nis such that log8∆(Ln)/greaterorequalslant(8∆)20for every n∈N, and
deﬁne inductively, using Theorem 4.2, a sequence {cn}n∈Nsuch that cndoes not admit
improvement of weight Lnfor every n∈Nand
ν({e∈E:cn(e)/\e}a⊔io\slash=cn+1(e)})/lessorequalslantLn+1ν(Uc)MEASURABLE VIZING’S THEOREM 25
for every n∈N.
The Borel–Cantelli Lemma implies that c(e) = lim n→∞cn(e) is deﬁned ν-almost ev-
erywhere as
/summationdisplay
n∈NLn+1ν(Ucn)/lessorequalslant/summationdisplay
n∈N64(4∆)7(∆!)14Ln+1
log2
8∆(Ln)Ln
=/summationdisplay
n∈N64(4∆)7(∆!)14(8∆)n+1
n2(8∆)n=/summationdisplay
n∈N128(4∆)8(∆!)14
n2<∞
by Theorem 6.1. Altogether, this shows that cis correct at µ-almost every vertex by the
deﬁnition of ν. /square
References
[Abe10] Miklos Abert. Some questions, 2010.
[BCG+24] Sebastian Brandt, Yi-Jun Chang, Jan Greb´ ık, Christoph Grun au, V´ aclav Rozhoˇ n, and Zolt´ an
Vidny´ anszky. On homomorphism graphs. Forum of Mathematics, Pi , 12:e10, 2024.
[BD23] A. Bernshteyn and A. Dhawan. Fast algorithms for Vizing’s th eorem on bounded degree
graphs.arXiv:2303.05408 , 2023.
[Ber19] Anton Bernshteyn. Measurable versions of the lov´ asz loc al lemma and measurable graph
colorings. Advances in Mathematics , 353:153–223, 2019.
[Ber22] Anton Bernshteyn. A fast distributed algorithm for ( ∆+ 1)-edge-coloring. Journal of Com-
binatorial Theory, Series B , 152:319–352, 2022.
[Ber23] Anton Bernshteyn. Distributed algorithms, the Lov´ asz L ocal Lemma, and descriptive com-
binatorics. Invent. math. , 233:495–542, 2023.
[BHT24] Ferenc Bencs, Aranka Hruˇ skov´ a, and L´ aszl´ o M´ arto n T´ oth. Factor-of-iid schreier decorations
of lattices in euclidean spaces. Discrete Mathematics , 347(9):114056, 2024.
[BW23] Matt Bowen and Felix Weilacher. Deﬁnable K¨ onig theorems. Proc. Amer. Math. Soc. ,
151:4991–4996, 2023.
[CGM+17] Endre Cs´ oka, /suppress Lukasz Grabowski, Andr´ as M´ ath´ e, Oleg Pik hurko, and Konstantinos Tyros.
Borel version of the Local Lemma. arXiv:1605.04877 , 2017.
[Chr23] Aleksander Bjørn Grodt Christiansen. The power of multi-s tep vizing chains. In Proceedings
of the 55th Annual ACM Symposium on Theory of Computing , STOC 2023, page 1013–1026,
New York, NY, USA, 2023. Association for Computing Machinery.
[CJM+23] Clinton T. Conley, Steve Jackson, Andrew S. Marks, Brandon S eward, and Robin Tucker-
Drob. Borel asymptotic dimension and hyperﬁnite equivalence relat ions.Duke Math. J. ,
172(16):3175–3226, 2023.
[CLP16] Endre Cs´ oka, Gabor Lippner, and Oleg Pikhurko. Invarian t gaussian processes and indepen-
dent sets on regular graphs of large girth. Forum of Math., Sigma , 4, 2016.
[CM17] Clinton T. Conley and Benjamin D. Miller. Measure reducibility of c ountable Borel equiva-
lence relations. Ann. of Math. (2) , 185(2):347–402, 2017.
[CMTD16] Clinton T. Conley, Andrew S. Marks, and Robin D. Tucker-D rob. Brooks’ theorem for mea-
surable colorings. Forum Math. Sigma , e16(4):23pp, 2016.
[CT21] Clinton T. Conley and Omer Tamuz. Unfriendly colorings of grap hs with ﬁnite average
degree.Proc. Lond. Math. Soc. , 3, 2021.
[CU22] Nishant Chandgotia and Spencer Unger. Borel factors and embeddings of systems in sub-
shifts.arxiv:2203.09359 , 2022.
[DF92] Randall Dougherty and Matthew Foreman. Banach-Tarski paradox using pieces with the
property of Baire. Proc. Nat. Acad. Sci. U.S.A. , 89(22):10726–10728, 1992.
[Gab00] Damien Gaboriau. Coˆ ut des relations d’´ equivalence et des groupes. Invent. Math. , 139(1):41–
98, 2000.
[GMP17] /suppress Lukasz Grabowski, Andr´ as M´ ath´ e, and Oleg Pikhurko. Measurable circle squaring. Ann. of
Math. (2) , 185(2):671–710, 2017.26 JAN GREB ´IK
[GP20] Jan Greb´ ık and Oleg Pikhurko. Measurable versions of vizing’s theorem. Advances in Math-
ematics , 374:107378, 2020.
[GR23] Jan Greb´ ık and V´ aclav Rozhoˇ n. Local problems on grids fr om the perspective of dis-
tributed algorithms, ﬁnitary factors, and descriptive combinator ics.Advances in Mathemat-
ics, 431:109241, 2023.
[Gre22] Jan Greb´ ık. Approximate Schreier decorations and appro ximate K¨ onig’s line coloring Theo-
rem.Annales Henri Lebesgue , 5:303–315, 2022.
[Kec95] Alexander S. Kechris. Classical descriptive set theory , volume 156 of Graduate Texts in Math-
ematics . Springer-Verlag, New York, 1995.
[Kec24] Alexander S. Kechris. The theory of countable Borel equivalence relations. to appear in Cam-
bridge Tracts in Mathematics. Cambridge University Press, 2024.
[KM04] Alexander S. Kechris and Benjamin D. Miller. Topics in orbit equivalence , volume 1852 of
Lecture Notes in Mathematics . Springer-Verlag, Berlin, 2004.
[KM20] Alexander S. Kechris and Andrew S. Marks. Descriptive grap h combinatorics.
http://www.math.caltech.edu/ ~kechris/papers/combinatorics20book.pdf , 2020.
[KST99] Alexander S. Kechris, S/suppress lawomir Solecki, and Stevo Todorˇ c evi´ c. Borel chromatic numbers.
Adv. Math. , 141(1):1–44, 1999.
[Kuh94] Gabriella Kuhn. Amenable actions and weak containment of ce rtain representations of dis-
crete groups. Proc. Amer. Math. Soc. , 122(3):751–757, 1994.
[Lac90] Mikl´ os Laczkovich. Equidecomposability and discrepancy; a solution of Tarski’s circle-
squaring problem. J. Reine Angew. Math. , 404:77–117, 1990.
[Mar16] Andrew S. Marks. A determinacy approach to Borel combin atorics.J. Amer. Math. Soc. ,
29(2):579–600, 2016.
[MU16] Andrew Marks and Spencer Unger. Baire measurable parado xical decompositions via match-
ings.Advances in Mathematics , 289:397–410, 2016.
[MU17] Andrew S. Marks and Spencer T. Unger. Borel circle squarin g.Ann. of Math. (2) , 186(2):581–
605, 2017.
[Pik21] Oleg Pikhurko. Borel combinatorics of locally ﬁnite graphs. Surveys in Combinatorics 2021,
the 28th British Combinatorial Conference , pages 267–319, 2021.
[QW22] Long Qian and Felix Weilacher. Descriptive combinatorics, comp utable combinatorics, and
asi algorithms. arXiv:2206.08426 , 2022.
[SSTF12] M. Stiebitz, D. Scheide, B. Toft, and L. M. Favrholdt. Graph edge coloring . Wiley Series in
Discrete Mathematics and Optimization. John Wiley & Sons, Inc., Hobo ken, NJ, 2012.
[T´21] L´ azlo M. T´ oth. Invariant schreier decorations of unimodular random networks. Annales Henri
Lebesgue , 4:1705–1726, 2021.
[Wei21] Felix Weilacher. Borel edge colorings for ﬁnite dimensional gro ups.arXiv:2104.14646 , 2021.
University of Warwick Mathematics Institute, Coventry CV4 7AL, UK.
Email address :jan.grebik@warwick.ac.uk