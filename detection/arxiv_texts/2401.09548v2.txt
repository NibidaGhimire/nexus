Universal contributions to charge fluctuations in spin chains at finite temperature
Kang-Le Cai1and Meng Cheng1
1Department of Physics, Yale University, New Haven, Connecticut 06511-8499, USA
At finite temperature, conserved charges undergo thermal fluctuations in a quantum many-body
system in the grand canonical ensemble. The full structure of the fluctuations of the total U(1)
charge Qcan be succinctly captured by the generating function G(θ) =⟨eiθQ⟩. For a 1D translation-
invariant spin chain, in the thermodynamic limit the magnitude |G(θ)|scales with the system size
Las ln|G(θ)|=−α(θ)L+γ(θ), where γ(θ) is the scale-invariant contribution and may encode
universal information about the underlying system. In this work we investigate the behavior and
physical meaning of γ(θ) when the system is periodic. We find that γ(θ) only takes non-zero values
at isolated points of θ, which is θ=πfor all our examples. In two exemplary lattice systems we
show that γ(π) takes quantized values when the U(1) symmetry exhibits a specific type of ’t Hooft
anomaly with other symmetries. In other cases, we investigate how γ(θ) depends on microscopic
conditions (such as the filling factor) in field theory and exactly solvable lattice models.
I. INTRODUCTION
At finite temperature, the state of a quantum many-
body system with U(1) symmetry is conveniently de-
scribed by the thermal density matrix ρ=1
Ze−β(H−µQ)
in the grand canonical ensemble, where βis the inverse
temperature and µis the chemical potential. It is well-
known that even though the total charge Qis not con-
served in the ensemble, it has a well-defined average
with fluctuations suppressed in the thermodynamic limit.
Higher moments of Qare also suppressed as the distribu-
tion approaches a Gaussian one. Our main objective in
this work is to show that the charge fluctuations may
contain universal information about the system, espe-
cially when the U(1) charge-conservation symmetry ex-
hibits certain types of ’t Hooft anomaly (usually a mixed
anomaly with other global symmetries). To extract this
information, it is most useful to consider the follow-
ing generating function (also known as the full counting
statistics [1–4])
G(θ) =⟨eiθQ⟩= Tr eiθQρ. (1)
In (1+1)d, for a system of size L, it is expected that G(θ)
takes the following form
ln|G(θ)|=−α(θ)L+γ(θ) +···, (2)
for large L, and the phase factor is defined as
ω(θ) =G(θ)
|G(θ)|. (3)
In general, the value of α(θ) is sensitive to microscopic
details and is thus non-universal. On the other hand,
γ(θ) and ω(θ) are expected to encode universal informa-
tion about many-body states.
Another motivation to study G(θ) comes from its
connection with the disorder parameter in the (2+1)d
ground state of a gapped Hamiltonian [5–8]. Suppose A
is a subregion of the (2+1)d system, and denote by QA
the total charge inside A. We define the disorder param-
eter as ⟨eiθQA⟩, where the expectation value now is takenwith respect to the ground state. When the ground state
is gapped and preserves the U(1) symmetry, one expects
for a region Aof size LA
ln⟨eiθQA⟩=−α1(θ)LA+γ(θ) +O(1/LA).(4)
To make connections to the (1+1)d discussion more ex-
plicit, we notice that in many cases the reduced den-
sity matrix can be well-approximated by a thermal state
of a (quasi-)local Hamiltonian acting on degrees of free-
dom localized at the boundary of A, which is effectively
a (1+1)d system. If the (2+1)d bulk is a nontrivial
symmetry-protected topological (SPT) state, the sym-
metries should act anomalously in the effective boundary
theory. Thus the computation of ⟨eiθQA⟩is reduced to
G(θ) in an effective (1+1)d system.
In this work, we study the behavior and the physi-
cal interpretations of γ(θ) and ω(θ). A key question to
address is to what extent the values of γ(θ) are truly
universal, i.e. unaffected by small changes to the Hamil-
tonian. Additionally, we explore the physical significance
of these universal, quantized values.
First, we present a general computation of G(θ) when
the (1+1)d system can be described by a conformal field
theory (CFT), possibly with a topological defect. In the
absence of such a defect, we find that γ(θ) effectively
counts the degeneracy of the defect operator of the cor-
responding U(1) symmetry transformation. It only takes
non-zero values at isolated values of θ, as some of the de-
generacies are enforced by the mixed anomaly between
U(1) and other global symmetries.
We then compute γ(θ) and ω(θ) in the presence of a
U(1) topological defect for a c= 1 free boson CFT. It
turns out that both γ(θ) and ω(θ) are now sensitive to the
U(1) defect, which can be understood as a consequence
of the ’t Hooft anomaly of the U(1) ×U(1) symmetry of
the free boson CFT.
Next we turn to γ(θ) and ω(θ) in lattice models, to un-
derstand how γ(θ) and ω(θ) behave at high temperature
beyond the CFT description. We also address the ques-
tion as to whether the value of γ(θ) is quantized or not.
Our main finding is that in the presence of certain typesarXiv:2401.09548v2  [cond-mat.str-el]  3 Mar 20242
of mixed anomaly between U(1) and other global sym-
metry, γ(π) takes quantized values for a general thermal
state of any symmetric local Hamiltonian. We establish
this result for two types of systems:
1. A translation-invariant spin-1/2 chain with on-
site O(2) symmetry, where the O(2) and the lat-
tice translation have Lieb-Schultz-Mattis (LSM)
anomaly. We show that γ(π) = ln 2 (for even sys-
tem size).
2. A translation-invariant spin-1/2 chain with an
anomalous O(2) ×Z2symmetry group, where the
U(1) symmetry is non-on-site. We show that
γ(π) = ln2 cosπN
4=(
ln 2 N≡0 (mod 4)
1
2ln 2 N≡1,3 (mod 4).(5)
While the ’t Hooft anomalies in these two systems appear
quite different, they share a common feature: a πflux
of the U(1) symmetry carries a projective representation
protected by the other symmetries. This type of ’t Hooft
anomaly is often referred to as the “type-III” anomaly
in literature [9]. The type-III structure of the anomaly
turns out to be crucial for the quantization of γ(π).
We compute G(θ) in two spin chain lattice models at
finite temperature: 1. the spin-1/2 XX chain, which has
the O(2) LSM anomaly, and 2.the Levin-Gu spin chain
with the O(2) ×Z2mixed anomaly. Both models can be
solved exactly using Jordan-Wigner transformations, and
the results for γ(π) indeed agree with the expectations.
We also match the full results for G(θ) with the CFT pre-
dictions at low energy, which requires the understanding
of the continuum limit as the CFT with insertions of em-
anant symmetry defects. We also show explicitly in these
examples that if the symmetry is reduced so the anomaly
is no longer of type-III, γ(π) is not quantized anymore
and can change continuously depending on microscopic
parameters, such as the filling factor.
More generally, we provide arguments for the quantiza-
tion of γ(π) based on the matrix product representation
of the density matrix for both cases mentioned above,
generalizing an argument in [10]. As a by-product, we
find that in both cases the U(1) symmetry can be re-
duced to the Z2subgroup without affecting the results,
since the type-III anomaly structure is preserved.
II. CHARGE FLUCTUATIONS IN A CFT
We first consider the case when the (1+1)d system
is described by a CFT, at least at the energy scale of
interest to us. More precisely, we assume that at low
energy, the Hamiltonian Hcan be approximated by
H≈2πv
LHCFT+E0(L), (6)
where Lis the length of the system, HCFT=L0+L0is
the dimensionless CFT Hamiltonian on a unit circle S1,andvis the velocity. E0(L) is the ground state energy.
We define a rescaled temperature ˜β=2πvβ
L.
In this case, we will show below that the γ(θ) can be
related to vacuum degeneracy in the defect sector. To
show this, recall that we need to evaluate
G(˜β, θ) =⟨eiθQ⟩=Tr eiθQe−˜βHCFT
Tr e−˜βHCFT=Z(˜β, θ)
Z(˜β,0).(7)
Modular invariance of the CFT implies
Z(˜β,0) = Z(1/˜β,0). (8)
For the numerator, however, under modular transforma-
tion it becomes the partition function of the theory with
a defect:
Z(˜β, θ) =Zθ(1/˜β). (9)
Here we define
Zθ(˜β) = Tr θe−˜βHCFT, (10)
where Tr θmeans that we perform the trace in the Hilbert
space of the CFT with a eiθQdefect. Therefore,
G(θ) =Zθ(1/˜β)
Z0(1/˜β). (11)
In the limit of large Land thus small ˜β, the modular
transformed theory is then at low temperature, and the
partition function can be approximated by keeping just
the contribution from the ground state. We thus find
G(θ)≈dθe−hθ
˜β=dθe−hθ
2πvβL. (12)
Here dθis the ground state degeneracy in the defect sec-
tor.hθis the scaling dimension of the U(1) defect. For a
rational CFT, the presence of a U(1) symmetry implies
that the CFT has U(1) k×U(1)−kKac-Moody algebra,
with kbeing the level, and for θ∈[0, π],hθis given by
the charged Cardy formula [11–13]:
hθ=kθ2. (13)
Therefore,
γ(θ) = ln dθ. (14)
Now we recall that quite generally, anomaly in the U(1)
symmetry implies that certain quantum number of the
topological defect must change as θcontinuously goes
from 0 to 2 π. This is essentially equivalent to Laughlin’s
flux-insertion argument. As a consequence, the ground
state must become degenerate at some value of θwhere
levels cross. Thus, the generic behavior of γ(θ) is that it
remains 0 except for a few isolated points where it jumps
to a finite value.
We note that the argument can be easily generalized
to other symmetries. In fact, Eq. (12) holds without any3
modification, except that hθshould be replaced by the
conformal weight of the corresponding defect operator.
Essentially equivalent result was found in the context of
topological disorder parameter in a (2+1)d gapped state
in [7].
A useful generalization is when the CFT is equipped
with a topological defect. For this purpose, instead of
a general CFT, we specialize to the example of a c= 1
Luttinger liquid (or free compact boson CFT), arguably
the simplest CFT with U(1) symmetry, which will be
most relevant for our lattice model examples below. In
general, such a CFT has two U(1) symmetries, generated
by charges QmandQw, respectively. The Hamiltonian
has two parts: HCFT =H0+Hosc, where Hoscis the
energy of the oscillator modes, which do not contribute to
the global charge fluctuations. The “zero mode” energy
H0takes the following form:
H0=1
2Q2
m
R2+R2Q2
w
. (15)
Here Ris the radius of the compact boson. In addition to
the U(1) m×U(1) wsymmetry, at a generic radius the CFT
also has a charge-conjugation symmetry which acts as
Qm→ −Qm, Qw→ −Qm, so together the full symmetry
is [U(1) m×U(1) w]⋊Z2.
Consider the CFT with a defect corresponding to
e2πiηmQme2πiηwQw, with ηm, ηw∈[0,1). The effect of
the defect is to change the quantization conditions of the
charges. The energy levels (the zero mode contributions)
become
H0(ηm, ηw) =1
2R2(Qm+ηw)2+R2
2(Qw+ηm)2.(16)
Here let us consider the case ηm= 0, and compute
⟨eiθQm⟩. Details of the derivation can be found in Ap-
pendix B. Evaluating the partition functions, we find that
α(θ) =R2
4πvβ[θ]2
π, (17)
where we define
[θ]π=(
θ 0≤θ≤π
θ−2π π < θ ≤2π. (18)
As expected on general grounds, α(θ) is “local” and in-
sensitive to global boundary condition. Notice that α(θ)
exhibits a cusp at θ=π, which appears to be a general
feature of CFTs with a U(1) symmetry. A similar cusp
was found in the coefficient of the leading term in the
U(1) disorder parameter in a (1+1)d Luttinger liquid or
a (2+1)d Fermi liquid [14–16].
The full expression of G(θ) is found to be
G(θ) =(
e−iηw[θ]πe−α(θ)Lθ̸=π
2 cos( ηwπ) e−α(π)Lθ=π. (19)The “universal” contribution γ(θ) is given by:
γ(θ) =(
0 θ̸=π
ln|2 cosηwπ|θ=π. (20)
Notice that in general |2 cosηwπ|is not an integer. For
ηw=1
2, one finds that γ(π) diverges, and G(π) = 0.
Unlike α(θ), the prefactor in G(θ) (i.e. γ(θ) and the
phase factor ω(θ)) only depends on the defect parameter
ηw, and has no dependence on other quantities that are
sensitive to microscopic details, such as vandR2. In
other words, γ(θ) and ω(θ) appear to be robust against
small changes to the theory.
However, an important caveat in this argument for the
robustness of γ(θ) and ω(θ) is the dependence of ηwon
the microscopic physics. It has been understood now
that certain microscopic conditions, such as the filling
factor, enter the low-energy theory as background topo-
logical defects required by anomaly matching [17–20]. As
an example, consider a c= 1 Luttinger liquid in a lat-
tice system with U(1) filling factor ν(i.e. the average
charge per unit cell is ν). The low-energy physics of a
system with periodic boundary condition of Nunit cells
should be described by the Luttinger liquid with a defect
ηw=−Nν[18, 21, 22]. Since the filling can be continu-
ously tuned by applying a chemical potential, the defect
parameter and thus γ(π) can also be changed continu-
ously.
It also happens in some cases that the filling is fixed
by additional global symmetries (such as charge conju-
gation), in which case γ(π) becomes quantized. Typi-
cally, in these cases there is an exact LSM-type ’t Hooft
anomaly associated with the symmetries. For later ref-
erences, we write down the expressions for G(θ) with the
filling factor ν:
G(θ) =(
eiNν[θ]πe−α(θ)Nθ̸=π
2 cos( πNν) e−α(π)Nθ=π. (21)
The results derived in this section assume that the
spectrum is described by a CFT. For lattice models, CFT
only describes the spectrum up to a certain energy scale
(e.g. of the order of the bandwidth). One may wonder
whether the results still hold when the temperature is
comparable (or even higher) to the cut-off scale. In the
next sections we turn to G(θ) in lattice models.
III. SPIN-1/2 CHAIN WITH LSM ANOMALY
We now consider a familiar system, the spin-1 /2 chain
with O(2) = U(1) ⋊Z2internal symmetry. The U(1)
charge is given by:
Q=1
2NX
n=1σz
n, (22)4
and the ZC
2charge-conjugation symmetry generated by
X=NY
n=1σx
n (23)
Here Nis the number of sites. We will only consider spin
chains with periodic boundary condition throughout this
work.
Notice that the O(2) symmetry is on-site, so it is not
anomalous on its own. However, because each spin-1/2
site carries a projective representation of the O(2) sym-
metry, the system exhibits a LSM anomaly between the
O(2) and the lattice translation [17, 18, 20, 23].
Without the Z2symmetry, there is no ’t Hooft
anomaly between the U(1) and lattice translation sym-
metry. However, if the total filling is fixed, e.g. Q= 0
(corresponding to half filling in the hard-core boson ba-
sis), the system exhibits the “filling anomaly” for U(1)
and lattice translation [17, 19–21, 24], forbidding the ex-
istence of a symmetric trivial state. However, unlike
the O(2) LSM anomaly, the filling anomaly only ap-
pears in the subspace constrained to have a fixed filling.
Therefore, in a grand canonical ensemble, where the to-
tal charge is allowed to fluctuate, the filling anomaly is
absent.
A prototypical model in this system is the XX Hamil-
tonian:
H=−NX
n=1(σx
nσx
n+1+σy
nσy
n+1). (24)
For this model, G(θ) can be computed with Jordan-
Wigner transformation. We will sketch the key ingredi-
ents for the extraction of γ(θ), and leave the full details
to Appendix D. As it turns out, one needs to distinguish
the case of µ= 0 (i.e. half filling) and µ̸= 0.
µ= 0: half filling
First we consider the model with the full O(2) symme-
try. Equivalently, the chemical potential is set to 0 in the
partition function. We will express G(θ) in terms of the
following quantities:
Zss′(θ) =N−1+s′
2Y
j=s′
2
1 + (−1)seiθe4βcos2πj
N
,(25)
where sands′take value in 0 ,1. We have
Tr eiθQe−βH=
1
2[Z00(θ)−Z10(θ) +Z01(θ) +Z11(θ)].(26)
To evaluate Zss′, we use the Euler-MacLaurin formula
to convert ln Zss′into integrals. For example, for θ̸=π:
Z00(θ)≈eN
2πI(θ,β), (27)where the integral I(θ, β) is defined in (C2). Here ≈
means that there are O(N−1) corrections in the expo-
nential.
However, if the terms in the product (25) get close
to 0, e.g. Zs=1,s′(θ= 0), there are additional constant
prefactor. For example we find that for N≡0 (mod 4):
Z11(0) =N−1
2Y
j=1
2(1−e4βcos2πj
N)≈4 eN
2πℜI(π,β).(28)
The factor of 4 is crucial for the calculation of γ.
Let us present the results. In the limit of large N,
G(θ) takes the form given in Eq. (21) with ν= 1/2. In
particular, for Neven we have
γ(θ) =(
0 θ̸=π
ln 2 θ=π. (29)
It is worth noting that these results are valid for any
temperature β̸= 0. For β= 0, we instead get G(θ) = 
cosθ
2N, which still gives γ(θ) = 0 for any θ̸=π, but
G(π) = 0, so γ(π) is not well-defined.
To understand the physical meaning of γ(θ) and ω(θ),
let us consider the low-temperature limit β→ ∞ . At low
energy the system is described by a c= 1 Luttinger liquid
(see e.g. [21]). The U(1) charge Qis identified with Qm
in the low energy theory. The γ(π) = ln 2 value for N≡
0 (mod 2) can be easily understood from our general CFT
result: in the presence of a θ=πdefect, corresponding
toηm=1
2, ηw= 0, the zero mode Hamiltonian becomes
H0=Q2
m+1
4
Qw+1
22
, (30)
and the ground states are two-fold degenerate: Qm= 0
andQw= 0,−1. This degeneracy is guaranteed by the
LSM anomaly, as shown directly in the lattice model in
Appendix A.
More generally, we need to first consider the trans-
lation symmetry. Importantly, the lattice unit transla-
tion leads to an emanant Z2symmetry in the low-energy
CFT. Namely, the lattice translation Thas the following
representation in the low-energy theory:
T= e−iπ(Qm+Qw)e2πi
LP, (31)
where Pis the CFT momentum. The lattice system with
Nsites in the continuum limit becomes the CFT with
ηw=ηm=−1
2N, which then leads to Eq. (21) with
ν= 1/2.
While the results can be understood within the low-
energy theory, we emphasize that our derivation in fact
applies to any temperature β̸= 0, even at high temper-
ature when the system is presumably not described by a
CFT.5
FIG. 1.1
Nargω(θ) for ν=1
10. At low temperature, the
numerical results agree with the CFT value, while at high
temperture, they approach1
2[θ]π. For ν=1
2, all the lines
collapse.
µ̸= 0
It is instructive to consider turning on a nonzero chem-
ical potential µ(or a nonzero Zeeman field in the spin
language), which results in a different ground state fill-
ing factor (or magnetization plateau) in the XX model:
ν=1
πarccos
−µ
4
. (32)
Note that we choose the convention that ν= 1/2 for
µ= 0.
For the XX model, we find that for any finite β̸= 0
andθ̸=π(mod 2 π)
|G(θ)| ≈e−α(θ)N, (33)
soγ(θ) = 0. We plot α(θ) for several different temper-
atures in Fig. 2. They agree very well with the CFT
result, and exhibit a cusp at θ=πfor all temperatures.
The cusp becomes sharper as the temperature increases.
The phase factor ω(θ) now depends on βandνin a
complicated way. This is expected, since for small θ, one
has
ω(θ)≈eiNν(β)θ, (34)
where ν(β) is the average filling at temperature β. Only
when βis large (i.e. low temperature), the phase factor
approaches the CFT form eiNν[θ]π. We plot arg( ω) for
theν=1
10case in Fig 1.
Forθ=π, we are able to determine the phase factor
as well:
G(π)≈2 cos( νNπ) e−α(π)N. (35)
Notably, these results hold for any finite temperature, as
long as β >0.
From the perspective of low-energy theory, the em-
anant symmetry from translation becomes e−2πiνQw. A
FIG. 2. α(θ) for ν=2
3at different β.
lattice system of Nsites flows to a U(1) free boson CFT
with a defect ηw=−Nν. Eq. (35) then immediately
follows from Eq. (20).
This example suggests that γ(π) is not quantized in
general in a lattice system, as it varies smoothly with
the chemical potential (or filling factor). However, in the
presence of additional symmetry, such as charge conju-
gation symmetry that fixes the filling, then γ(π) takes
quantized value ln 2 (for even N). A spin-1/2 chain with
O(2) symmetry has the LSM anomaly, which is a true
’t Hooft anomaly that holds for the entire Hilbert space.
For this reason we expect that the quantization of γ(π)
holds more generally. We show in the next subsection
that this is indeed the case, and γ(π) = ln 2 for even N
is a direct consequence of the LSM anomaly.
A. Quantization of γ(π)
We now show that γ(π) = ln 2 holds for any thermal
state of a local Hamiltonian (i.e. with short-range inter-
actions), as long as the O(2) = U(1) ⋊ZC
2symmetry is
preserved. In fact, as will become clear all we need is
theZ2×Z2subgroup, generated by UZ=Q
nσz
nand
UX=Q
nσx
n. We define
GZ= Tr UZρ. (36)
Note that G(π) = iNGZ.
To proceed we follow the argument presented in [10].
First we represent a translation-invariant density matrix
as a matrix product operator (MPO) [25–28]:
ρ=X
{s},{s′}Trh
···ˆMsjs′
jˆMsj+1s′
j+1···i
× |. . . s jsj+1, . . .⟩⟨. . . s′
js′
j+1. . .|
= M M M(37)6
It is known that such an approximation is always pos-
sible for thermal states of local Hamiltonians [29–32].
Furthermore, since there is no long-range order at finite
temperature in 1D, we expect that the MPO is injec-
tive [26, 28], i.e. the corresponding transfer matrix has a
non-degenerate leading eigenvalue.
Using the MPO representation, we write
GZ= Tr ρY
nσz
n= M M MZ Z Z
=: Tr 
MZN
.(38)
Here we denote Z≡σz, and define the “symmetry-
twisted” transfer matrix MZas
MZ:= MZ
=X
ss′Zs′s·Mss′. (39)
Crucially, the density matrix also commutes with the
Xsymmetry: UXρUX=ρ. Via the fundamental theo-
rem of matrix product vectors, there must exist an in-
vertible matrix WXsuch that
M = MX
XWX W−1
X. (40)
Applying this virtual symmetry to MZ, it follows from
the relation XZX =−Zthat
WXMZW−1
X=−MZ. (41)
In other words, WXandMZanticommute. Therefore, all
eigenvalues of MZmust come in pairs ±λ, including those
with the largest magnitude. In principle, it is possible
that|λ|has degeneracy more than 2. However, given
that the leading eigenvalue of Mis non-degenerate, we
expect that MZhas no more degeneracy in the leading
|λ|than what is required by the symmetry condition in
Eq. (41). That is, the leading eigenvalues of MZshould
be±λmax [33]. With this assumption,
GZ≈
1 + (−1)N
λN
max=(
2λN
max Nis even
0 Nis odd.(42)
From this result we immediately see that γ(π) = ln 2.
Notice that the result applies to any system with Z2×
Z2LSM anomaly [17, 34–36], since the only symmetry
property used here is XnZn=−ZnXn. In fact, the only
assumptions needed on ρare translation invariance and
theXsymmetry.
Naturally one may wonder whether a similar argument
can explain the ( −1)N/2factor in G(π) of the XX spin
chain. We now make a further assumption that Mis
hermitian (within a certain gauge), and Zis real (i.e.has real matrix elements). In this case, we can easily
show that MZis also hermitian:
[MZ]ba=X
ss′Zs′sMss′
ba (43)
=X
ss′Zs′s
Mss′
ab∗
(44)
= X
ss′Zs′sMss′
ab!∗
(45)
= [MZ]∗
ab. (46)
As a result, the eigenvalues of MZcome in pairs ±|λ|,
and for even Nwe have
GZ≈2|λmax|N. (47)
While generally a transfer matrix may not be hermi-
tian, it is known that e.g. the transfer matrix of the XXZ
model
HXXZ=NX
n=1(σx
nσx
n+1+σy
nσy
n+1+ ∆σz
nσz
n+1) (48)
can be made hermitian for ∆ ≥0 [37]. Thus Eq. (47)
applies to HXXZas well.
We note that the translation invariance is crucial for
this argument, otherwise Eq. (37) would not hold. In
fact, if the translation symmetry is broken (e.g. the unit
cell is doubled) but the O(2) symmetry is preserved, one
can easily construct examples with γ(θ) = 0 for all θ.
IV. SPIN CHAIN WITH MIXED O(2)×Z2
ANOMALY
In this section, we consider a spin chain with anoma-
lous O(2) ×ZX
2symmetry. Unlike the previous example,
here the U(1) symmetry is non-on-site, and importantly
there is a type-III ’t Hooft anomaly between ZX
2and
O(2).
More specifically, the system is made of qubits, with
the U(1) charge defined as
Q=1
4X
n(1−σz
nσz
n+1). (49)
In the σzeigenbasis, 2 Qcounts the number of domain
walls, so with periodic boundary conditions, Qtakes in-
teger values. Interestingly, Qis manifestly non-on-site,
but still anomaly-free. The constant term (equal to N/4)
is included in Qto ensure that Qtakes integer values for
any system size N.
The charge-conjugation symmetry ZC
2in the O(2)
group is generated by
Xeven=N/2Y
i=1σx
2i. (50)7
One can readily see that
XevenQX−1
even=1
4X
n(1 +σz
nσz
n+1) =−Q+N
2.(51)
Thus to preserve the O(2) symmetry the filling factor
ν=Q/N must be 1 /4. We can similarly define Xodd,
which has the same action on Q.
Lastly, the on-site ZX
2symmetry is generated by
X=Y
nσx
n=XevenXodd. (52)
Now we discuss the ’t Hooft anomaly of the inter-
nalZX
2×O(2) symmetry. As alluded to above, there
is a mixed anomaly between ZX
2and O(2). In fact,
the same kind of anomaly is already present when re-
stricted to Z2⊂U(1). The Z2×ZC
2×ZX
2symmetry
has an anomaly associated with the so-called “type-III”
3-cocycle [9]. Physically, it is characterized by the Z2
defect transforming projectively under ZC
2×ZX
2.
Moreover, even the ZC
2symmetry is ignored, the re-
maining U(1) ×ZX
2symmetry is still anomalous. The
system can be viewed as a lattice model for the edge of
a bosonic SPT state protected by the U(1) ×Z2sym-
metry [38–41]. Turning on a non-zero chemical potential
breaks ZC
2but preserves ZX
2.
Below we will study the following Levin-Gu Hamilto-
nian preserving ZX
2×O(2):
HLG=−NX
n=1(σx
n−σz
n−1σx
nσz
n+1), (53)
which was first considered in [42] as an edge model of
the nontrivial (2+1)d Z2SPT state. The model is ex-
actly solvable, and can be mapped to a gauged XX spin
chain as follows. Introduce a dual representation of the
system [42]:
σx
n=τx
n−1τx
nµz
n−1,n
σy
n=−τx
n−1τx
nµy
n−1,n
σz
n=µx
n−1,n(54)
where τcan be understood as domain wall variables and
µrepresent Z2gauge fields. They are subject to the
Gauss’s law constraint:
τz
n=µx
n−1,nµx
n,n+1. (55)
In this representation, Qcan be written as
Q=1
4X
n(1−τz
n). (56)
And similarly X=Q
nµx
n,n+1. The LG Hamiltonian
becomes
HLG=−NX
n=1(τx
nτx
n+1+τy
nτy
n+1)µz
n,n+1, (57)namely a XX spin chain coupled to a Z2gauge field. Q
is the total spin z component and Xis the Wilson loop
for the gauge field.
The partition function can be exactly evaluated by
mapping to free fermions. We find that for any β≥0,
G(θ) is given precisely by Eq. (21) with ν= 1/4. In
particular, γis given by:
γ(θ) = 0 , θ̸=π(mod 2 π)
γ(π) = ln2 cosNπ
4
=(
ln 2 N≡0 (mod 4)
1
2ln 2 N≡ ±1 (mod 4).(58)
Details of the calculations can be found in Appendix C.
Lastly, when N≡2 (mod 4), one can show on general
grounds that G(π) = 0: Because N≡2 (mod 4), N/2 is
an odd integer. It then follows that
Tr eiπQe−βH= Tr X2
eveneiπQe−βH(59)
= (−1)N/2Tr e−iπQe−βH(60)
=−Tr eiπQe−βH. (61)
Thus, we conclude that G(π) = 0. Essentially, the system
forms a nontrivial projective representation of O(2).
To understand the physical meaning of γandω, let us
consider two limits. First, at low temperature β→ ∞ ,
the system is described by a c= 1 Luttinger liquid with
R=1√
2[21]. The U(1) charge Qis identified with Qm
in the low energy theory, and Xbecomes eiπQw. In ad-
dition, the lattice unit translation leads to an emanant
Z4symmetry e−iπ
2Qw[21]. Namely, the lattice transla-
tionThas the following representation in the low-energy
theory:
T= e−iπ
2Qwe2πi
LP, (62)
where Pis the CFT momentum. As a result of the non-
trivial emanant symmetry, a chain of size Nshould flow
to a CFT with a ηw=−N
4defect. Therefore in this limit
G(θ) takes the form of Eq. (21) with ν= 1/4.
When N≡0 (mod 4) (so ηw= 0), γ(π) = ln 2 is also
expected from the mixed anomaly between U(1) and Z2,
as there must be level crossing between states with op-
posite Z2quantum numbers, so the degeneracy at that
point must be at least 2. With the ZC
2symmetry, the
crossing must happen at θ=π. Alternatively, the de-
generacy at θ=πfollows from the type-III anomaly for
theZ2×ZC
2×ZX
2symmetry as shown explicitly in Ap-
pendix A.
We note in passing that adding a chemical potential
(thus reducing O(2) to U(1)) changes the ground state
filling factor, and thus similar to the case of the XX
model, the value of γ(π) also changes continuously with
the chemical potential.
The other limit is β→0, i.e. high temperature. In
this case, we can neglect the Hamiltonian and compute8
the trace of the operator eiθQ. This computation will be
discussed in the next subsection.
In both limits, one finds that γ(π) takes the quantized
values given in as long as the ZX
2×ZC
2symmetry is
preserved, which suggests that the quantization is inde-
pendent of the details of the Hamiltonian. This will be
established in Sec. IV B.
A. High temperature limit
It is instructive to consider the infinite-temperature
state ρ=1
2N1first. Then
G(θ) = 2−NTr eiθQ(63)
= 2−Neiθ
4NTr e−iθ
4P
nσz
nσz
n+1. (64)
Note that the trace is precisely the 1d Ising Hamiltonian
with imaginary coupling. Generally we can write
Tr exp 
KNX
n=1σz
nσz
n+1!
=zN
++zN
−, (65)
where z±= eK±e−Kare eigenvalues of the transfer
matrix. In our case K=−1
4iθ, so we have
2−NTr e−1
4iθP
nσz
nσz
n+1= cosNθ
4+ (−i)NsinNθ
4.(66)
First, let us look at the special case θ=π. We have
G(π) = e1
4iπN[1 + (−i)N]2−N/2(67)
= 2 cosπN
4
2−N/2. (68)
For general θ∈(0,2π),
ln|G(θ)|= lncosNθ
4+ (−i)NsinNθ
4. (69)
Ifθ < π , then cosθ
4>sinθ
4, ln|G(θ)| ≈Nln cosθ
4for
Nlarge. If π < θ < 2π, then sinθ
4>cosθ
4, ln|G(θ)| ≈
Nln sinθ
4forNlarge. In both cases, we have γ= 0 as
claimed.
We now consider a slightly deformed state, adding a
chemical potential: ρ∝eλQ. Notice that λ̸= 0 breaks
theZC
2symmetry, but the ZX
2symmetry is preserved.
It is straightforward to generalize the calculations above,
and here we will just present the θ=πresult:
G(π) = 2−N
2
(1−i tanh λ)N+ (−i)N(1 + i tanh λ)N
,
(70)
from which we can extract
γ(π) = ln2 cosN
φ−π
4, (71)
where φ(λ) = arctan(tanh λ). One can also easily show
that γ(θ) = 0 for θ̸=π. Notice that in this state ρ,
the U(1) charge density is given by1
4(1−tanhλ). This
simple example shows that γ(π) changes with the filling
and is not quantized with just U(1) ×ZX
2.B. Quantization of γ(π)
In this section, we present arguments for the quantiza-
tion of γ(π) in this system. Before going to the details,
it is important to clarify the role of translation invari-
ance. According to Eq. (51), with full translation sym-
metry, the filling factor of the system is fixed at 1 /4,
which is already a strong hint that γ(π) should be uni-
versal. Even with a doubled unit cell, the filling factor
is 1/2 and one would expect that γ(π) is quantized to
ln 2 just like the O(2) LSM case discussed in Sec. III A
(even though the U(1) charge is not on-site, an important
difference). However, we will find that the quantization
γ(π) = ln 2 does not really rely on LSM-type anomaly
and is instead enforced by the anomalous internal sym-
metry. More specifically, we will show that the quantiza-
tion holds with a four-site unit cell for which the filling
factor is an integer. On the other hand, if the state has
the full translation symmetry, γ(π) exhibits interesting
dependence on Nmod 4, which we will provide general
arguments for.
First, because the symmetry operator eiπQis non-on-
site, it is represented as a MPO with the following tensor
with bond dimension D= 2 (up to an overall phase):
ss′
α β U=δαsiα+β(−1)αβ. (72)
Here α, β= 0,1 are the bond indices.
It is straightforward to check that the tensor satisfies
the following two conditions:
U = UX
XX X (73)
U =− U Z Y. (74)
The first condition guarantees that eiπQcommutes with
X. The second condition can be understood as a kind of
“gauge symmetry” of the Utensor.
G(π) can be written as
G(π) = Tr MN
U, (75)
where the tensor MUis defined by the following diagram:
MU:=U
M. (76)9
Now we consider the Csymmetry. To this end, it is
convenient to group two neighboring sites into a doubled
unit cell. By our assumption, the density matrix com-
mutes with C, and we must have
M M = M MX
XVX V−1
X. (77)
Here VXis an invertible matrix.
We now prove the following key relation:
(Z⊗VX)M2
U=−M2
U(Z⊗VX). (78)
It can be established by the following steps:
U
MU
M= iU
MU
MZ YX
(79)
= iU
MU
MZ YX
X
XVX V−1
X(80)
=−U
MU
MZ Z
VX V−1
X(81)
Here in the first step we apply the gauge symmetry con-
dition to both Utensors. From the first to the second
line, we use the Csymmetry of the M2tensor given in
Eq. (77). For the next step, we apply the ZX
2symmetry
of the Utensor on the right, and eliminate the remaining
Xon the physical indices.
Therefore, all eigenvalues of M2
Umust come in pairs
±λ, including the largest one. Thus we have
G(π)≈h
1 + (−1)N/2i
λN
max (82)
=(
2λN
max N≡0 (mod 4)
0 N≡2 (mod 4). (83)
From this result we immediately see that γ(π) = ln 2.
Now if the largest eigenvalues of M2
Uare±λmax, then
forMUthey must be λ′
maxand±iλ′
max, where the ±sign
can not be directly fixed by this argument. However, this
sign ambiguity does not affect |G(π)|and one finds that
γ(π) = ln 2cosNπ
4. (84)
In particular, γ(π) = ln√
2 for odd N.We note that for the N≡0 (mod 4) case, the argument
so far only relies on the MPO invariant under T2. With
a doubled unit cell, the filling factor of the U(1) charge
is 1/2 and the value of γ(π) is the same as that of the
O(2) LSM case.
Let us now show that the same holds assuming only T4,
which is beyond the LSM case. Denote by Sthe transfer
operator with four-site unit cells. Diagrammatically, S
can be represented as
S=U U U U
M′. (85)
Here M′is the tensor of the MPO representation of ρ
with four sites in a unit cell. In the fully translation in-
variant case, we have S=M4
U. Since ρis invariant under
Xeven(Xodd), the action Xeven(Xodd) can be pushed to
the virtual space, which will be denoted by Veven(Vodd).
Importantly, VevenandVoddmust commute, otherwise
the transfer matrix obtained by contracting the physical
indices of M′would have degenerate spectrum, contra-
dicting the short-range nature of ρ.
Following steps very similar to those in Eq. (81), one
can prove
(Z⊗Veven)S=S(Z⊗Veven),
(Y⊗Vodd)S=S(Y⊗Vodd).(86)
Basically, Sis invariant under the virtual Z2×Z2sym-
metry generated by Z⊗VevenandY⊗Vodd. Because Veven
andVoddcommute, the virtual states of Sform a projec-
tive representation of Z2×Z2symmetry, and thus the
eigenvalues of Sare at least two-fold degenerate. Again,
generically we expect there is no further degeneracy in
the spectrum of S, and with this assumption we obtain
γ(π) = ln 2.
Heuristically, the result follows from the fact that the
unitary eiπQis aZ2×Z2SPT entangler.
V. CONCLUSIONS AND DISCUSSIONS
In this work we study the constant correction γ(θ) in
the thermal expectation value G(θ) of eiθQ, for a (1+1)d
periodic lattice system with U(1) symmetry. We show
that γ(π) becomes quantized in two systems where the
U(1) symmetry has a type-III mixed anomaly with other
global symmetry of the system. The value of γ(π) is
closely linked to the symmetry-protected degeneracy of
U(1) symmetry defect. Without such type of anomaly,
γ(π) can depend on microscopic parameters, such as the
filling factor. We also provide field-theoretical under-
standings of these results when the system can be de-
scribed by a CFT.10
An important question left for future work is to more
systematically study the relation between the quantiza-
tion of γand type-III ’t Hooft anomaly, beyond the spe-
cific example considered in this work. From the CFT
perspective, the universal contribution γfor a given sym-
metry operator gis given by ln dg, where dgis the degen-
eracy of the gdefect. If ghas a type-III mixed anomaly,
it means that the gdefect transforms projectively under
the remaining symmetry Zg(the centralizer of g). The
projective class is determined by the anomaly 3-cocycle,
as explained in Appendix A. We conjecture that generi-
cally dgis the minimal dimension of the irreducible rep-
resentation in the same projective class.
Following this line of thought, one expects that similar
results should hold for fermionic systems. For example,
in a (1+1)d fermionic system with Z2×ZF
2symmetry
(ZF
2stands for the fermion parity conservation), the ’t
Hooft anomaly is classified by Z8. The generator of the
Z8is characterized by the Z2symmetry defect carrying
a Majorana zero mode. Thus we expect that if one mea-
sures the expectation value of the total Z2charge in a
thermal state, γshould take a universal value γ= ln√
2.
Another system with a mathematically similar anomaly
is a translation-invariant chain of Majorana modes [43],
where the lattice translation has a mixed anomaly with
fermion parity. In this case, we expect that the thermalexpectation value of the translation operator contains a
universal correction ln√
2.
An obvious direction for future works is to generalize
the results to higher dimensions. It is not difficult to see
that the MPO argument for γ(π) = ln 2 can be general-
ized to two dimensions, assuming a PEPO representation
of the thermal density matrix. It will be worth investi-
gating other classes of systems, such as Fermi liquid or
quantum critical points, or systems with other types of
’t Hooft anomalies.
VI. ACKNOWLEDGEMENTS
We thank Yingfei Gu, Shenghan Jiang and Pengfei
Zhang for helpful conversations and communications on
their unpublished works. M.C. is particularly grateful
for Hong-Hao Tu for collaboration on a previous related
project and many enlightening discussions on tensor net-
works. M.C. would like to acknowledge NSF for support
under award number DMR-1846109.
Note added: During the finalization of the manuscript,
we became aware of closely related works [10] and [44],
which study the universal feature in α(θ). In particular,
[10] showed that the O(2) LSM anomaly leads to the cusp
atθ=πinα(θ).
[1] W. Belzig and Y. V. Nazarov, Full current statistics in
diffusive normal-superconductor structures, Phys. Rev.
Lett. 87, 067006 (2001).
[2] L. S. Levitov and M. Reznikov, Counting statistics of
tunneling current, Phys. Rev. B 70, 115305 (2004).
[3] H. F. Song, S. Rachel, C. Flindt, I. Klich, N. Laflorencie,
and K. Le Hur, Bipartite fluctuations as a probe of many-
body entanglement, Phys. Rev. B 85, 035409 (2012).
[4] H. F. Song, S. Rachel, and K. Le Hur, General relation
between entanglement and fluctuations in one dimension,
Phys. Rev. B 82, 012405 (2010).
[5] Y.-C. Wang, M. Cheng, and Z. Y. Meng, Scaling of the
disorder operator at (2 + 1) du(1) quantum criticality,
Phys. Rev. B 104, L081109 (2021).
[6] X.-C. Wu, C.-M. Jian, and C. Xu, Universal features
of higher-form symmetries at phase transitions, SciPost
Phys. 11, 033 (2021).
[7] B.-B. Chen, H.-H. Tu, Z. Y. Meng, and M. Cheng, Topo-
logical disorder parameter: A many-body invariant to
characterize gapped quantum phases, Phys. Rev. B 106,
094415 (2022), arXiv:2203.08847 [cond-mat.str-el].
[8] G. Cuomo, Z. Komargodski, and A. Raviv-Moshe, Renor-
malization group flows on line defects, Phys. Rev. Lett.
128, 021603 (2022).
[9] M. D. F. de Wild Propitius, Topological interactions
in broken gauge theories , Ph.D. thesis, Amsterdam U.
(1995), arXiv:hep-th/9511195.
[10] Y. Zang, Y. Gu, and S. Jiang, Detecting quantum anoma-
lies in open systems, arXiv:2312.11188.
[11] E. Dyer, A. L. Fitzpatrick, and Y. Xin, Constraints on
Flavored 2d CFT Partition Functions, JHEP 02, 148,arXiv:1709.01533 [hep-th].
[12] S. M. Hosseini, K. Hristov, Y. Tachikawa, and A. Zaf-
faroni, Anomalies, Black strings and the charged Cardy
formula, JHEP 09, 167, arXiv:2006.08629 [hep-th].
[13] R. Fan, R. Sahay, and A. Vishwanath, Extracting the
quantum hall conductance from a single bulk wave func-
tion, Phys. Rev. Lett. 131, 186301 (2023).
[14] M. T. Tan and S. Ryu, Particle number fluctuations,
R´ enyi entropy, and symmetry-resolved entanglement en-
tropy in a two-dimensional Fermi gas from multidimen-
sional bosonization, Phys. Rev. B 101, 235169 (2020),
arXiv:1911.01451 [cond-mat.stat-mech].
[15] W. Jiang, B.-B. Chen, Z. H. Liu, J. Rong, F. F. As-
saad, M. Cheng, K. Sun, and Z. Y. Meng, Many versus
one: The disorder operator and entanglement entropy in
fermionic quantum matter, SciPost Phys. 15, 082 (2023),
arXiv:2209.07103 [cond-mat.str-el].
[16] K.-L. Cai and M. Cheng, Disorder parameter in a (2+1)d
fermi liquid, in preparation.
[17] M. Cheng, M. Zaletel, M. Barkeshli, A. Vishwanath, and
P. Bonderson, Translational symmetry and microscopic
constraints on symmetry-enriched topological phases: A
view from the surface, Phys. Rev. X 6, 041068 (2016),
arXiv:1511.02263.
[18] M. A. Metlitski and R. Thorngren, Intrinsic and emer-
gent anomalies at deconfined critical points, Phys. Rev.
B98, 085140 (2018).
[19] G. Y. Cho, C.-T. Hsieh, and S. Ryu, Anomaly mani-
festation of Lieb-Schultz-Mattis theorem and topological
phases, Phys. Rev. B 96, 195105 (2017).
[20] C.-M. Jian, Z. Bi, and C. Xu, Lieb-Schultz-Mattis the-11
orem and its generalizations from the perspective of the
symmetry-protected topological phase, Phys. Rev. B 97,
054412 (2018).
[21] M. Cheng and N. Seiberg, Lieb-Schultz-Mattis, Lut-
tinger, and ’t Hooft - anomaly matching in lattice sys-
tems, SciPost Phys. 15, 051 (2023), arXiv:2211.12543
[cond-mat.str-el].
[22] D. V. Else, R. Thorngren, and T. Senthil, Non-Fermi
liquids as ersatz Fermi liquids: general constraints on
compressible metals, Phys. Rev. X 11, 021005 (2021),
arXiv:2007.07896 [cond-mat.str-el].
[23] D. V. Else and R. Thorngren, Topological theory of Lieb-
Schultz-Mattis theorems in quantum spin systems, Phys.
Rev. B 101, 224437 (2020), arXiv:1907.08204 [cond-
mat.str-el].
[24] M. Oshikawa, Topological approach to Luttinger’s theo-
rem and the Fermi surface of a Kondo lattice, Phys. Rev.
Lett. 84, 1535 (2000), cond-mat/0002392.
[25] F. Verstraete, J. J. Garc´ ıa-Ripoll, and J. I. Cirac, Ma-
trix Product Density Operators: Simulation of Finite-
Temperature and Dissipative Systems, Phys. Rev. Lett.
93, 207204 (2004).
[26] D. Perez-Garcia, F. Verstraete, M. M. Wolf, and J. I.
Cirac, Matrix product state representations (2007),
arXiv:quant-ph/0608197 [quant-ph].
[27] J. Cirac, D. P´ erez-Garc´ ıa, N. Schuch, and F. Verstraete,
Matrix product density operators: Renormalization fixed
points and boundary theories, Ann. Phys. 378, 100
(2017).
[28] J. I. Cirac, D. P´ erez-Garc´ ıa, N. Schuch, and F. Ver-
straete, Matrix product states and projected entangled
pair states: Concepts, symmetries, theorems, Rev. Mod.
Phys. 93, 045003 (2021).
[29] M. B. Hastings, Solving gapped hamiltonians locally,
Phys. Rev. B 73, 085115 (2006).
[30] A. Molnar, N. Schuch, F. Verstraete, and J. I. Cirac, Ap-
proximating gibbs states of local hamiltonians efficiently
with projected entangled pair states, Phys. Rev. B 91,
045138 (2015).
[31] T. Kuwahara, A. M. Alhambra, and A. Anshu, Improved
thermal area law and quasilinear time algorithm for
quantum gibbs states, Phys. Rev. X 11, 011047 (2021).
[32] Y. Huang, Locally accurate matrix product approxima-tion to thermal states, Science Bulletin 66, 2456 (2021).
[33] It is possible that λmax= 0, in which case γbecomes
meaningless. This is what happens at β= 0.
[34] H. C. Po, H. Watanabe, C.-M. Jian, and M. P. Zale-
tel, Lattice homotopy constraints on phases of quan-
tum magnets, Phys. Rev. Lett. 119, 127202 (2017),
https://arxiv.org/abs/1703.06882.
[35] Y. Ogata and H. Tasaki, Lieb–schultz–mattis type theo-
rems for quantum spin chains without continuous sym-
metry, Communications in Mathematical Physics 372,
951 (2019).
[36] Y. Ogata, Y. Tachikawa, and H. Tasaki, General
lieb–schultz–mattis type theorems for quantum spin
chains, Communications in Mathematical Physics 385,
79 (2021).
[37] W. Tang, H.-H. Tu, and L. Wang, Continuous matrix
product operator approach to finite temperature quan-
tum states, Phys. Rev. Lett. 125, 170604 (2020).
[38] X. Chen, Z.-C. Gu, Z.-X. Liu, and X.-G. Wen, Symmetry
protected topological orders and the group cohomology of
their symmetry group, Phys. Rev. B 87, 155114 (2013).
[39] M. A. Metlitski, A 1d lattice model for the
boundary of the quantum spin-hall insulator (2019),
arXiv:1908.08958.
[40] J. H. Son and J. Alicea, Commuting-projector hamilto-
nians for two-dimensional topological insulators: Edge
physics and many-body invariants, Phys. Rev. B 100,
155107 (2019).
[41] Y. Horinouchi, Solvable lattice model for (2+1)d bosonic
topological insulator (2020), arXiv:2002.01639 [cond-
mat.mes-hall].
[42] M. Levin and Z.-C. Gu, Braiding statistics approach to
symmetry-protected topological phases, Phys. Rev. B 86,
115109 (2012).
[43] M. Cheng, Fermionic lieb-schultz-mattis theorems and
weak symmetry-protected phases, Phys. Rev. B 99,
075143 (2019).
[44] C.-Y. Wang, T.-G. Zhou, and a. P. Z. Yi-Neng Zhou, Dis-
tinguishing quantum phases through cusps in full count-
ing statistics, arXiv:2312.11191.
[45] E. T. Whittaker and G. N. Watson, A Course of Modern
Analysis , 4th ed. (Cambridge University Press, 1996).
Appendix A: Typology of ’t Hooft anomaly in (1+1)d
In (1+1)d bosonic/spin systems, ’t Hooft anomaly for a global symmetry Gis classified by H3(G,U(1)). Namely,
each anomaly is uniquely associated with a group cohomology class [ ω]∈ H3(G,U(1)).
Anomalies can be partially characterized by symmetry transformation properties of a symmetry defect. More
concretely, given g∈G, one considers the system with a gdefect, which can be viewed as a (0+1)d quantum-
mechanical system with Zgsymmetry, where Zg={h∈G|hg=gh}is the centralizer of g. The Zgsymmetry action
may be projective, characterized by a 2-cocycle ωg=igωinH2(Zg,U(1)), where igis the slant product. The explicit
expression for igωis given by
(igω)(h, k) =ω(g, h, k )ω(h, k, g )
ω(h, g, k ). (A1)
Ifωgis nontrivial for some g∈G, the anomaly ωis said to be type-III. To give an example, consider G=Z3
2. Label
the group elements by a≡(a1, a2, a3) where a1, a2, a3∈ {0,1}, and the group multiplication is defined as addition
mod 2. The type-III cocycle is given by
ω(a, b, c ) = (−1)a1b2c3. (A2)12
To see that it is indeed type-III, we compute i(1,0,0):
(i(1,0,0)ω)(b, c) = (−1)b2c3. (A3)
This is the 2-cocycle for the projective representation of the Z2
2subgroup generated by (0 ,1,0) and (0 ,0,1).
Let us show that the two examples discussed in the main text have type-III anomaly.
We start with the XX spin chain. The Hamiltonian can be modified to have a θ=πdefect at the link N,1:
H(π) =−N−1X
n=1(σx
nσx
n+1+σy
nσy
n+1) +σx
Nσx
1+σy
Nσy
1. (A4)
It is clear that Xremains a symmetry of H(π), but the lattice translation needs to be modified:
T(π) = eiπ
2σz
1T= iσz
1T. (A5)
Therefore T(π)X=−XT(π), implying that the system with a Z2⊂U(1) defect transforms projectively under the
ZC
2and lattice translation.
Next we consider the Levin-Gu model, introducing a θ=πdefect [21]:
HLG(π) =−N−1X
n=1µz
n,n+1(τ+
nτ−
n+1+ h.c.) + µz
N,1(−iτ+
Nτ−
1+ h.c.) . (A6)
Apparently, X=Q
nµz
n,n+1remains a symmetry for HLG(π). However, the last term changes sign under Xeven.
Therefore we need to redefine Xevenas
X′
even=µx
N,1Xeven, (A7)
which then implies X′
evenX=−XX′
even.
Appendix B: G(θ)of the c= 1free boson CFT
Suppose the total charge Q=tmQm+twQw, then
G(θ) = Tr eiθQe−βH0(ηm,ηw)=Gm(θm)Gw(θw). (B1)
Here we have defined θm=tmθandθw=twθ. We have factorized the sum over QmandQw, so in the following we
only consider Gm(θm). More explicitly:
Gm(θm) =P
Qm∈ZeiθmQme−β
2R2(Qm+ηw)2
P
Qm∈Ze−β
2R2(Qm+ηw)2=ϑ
θm
2π+iβηw
2πR2,iβ
2πR2
ϑ
iβηw
2πR2,iβ
2πR2. (B2)
The theta function is defined as
ϑ(z, τ) =X
n∈Zeiπτn2+2πizn. (B3)
Using the S transformation
ϑ(z, τ) =1√−iτe−iπz2
τϑz
τ,−1
τ
, (B4)
we find
ϑ
θm
2π+iβηw
2πR2,iβ
2πR2
ϑ
iβηw
2πR2,iβ
2πR2 = e−iθmηwe−R2θ2
m
2βP
nexp
−2π2R2
β(n2−θm
πn) + 2πiηwn
P
nexp
−2π2R2
βn2+ 2πiηwn (B5)
≈e−iθmηwe−R2θ2
m
2βX
nexp
−2π2R2
β(n2−θm
πn) + 2πiηwn
(B6)13
In the second line, we consider the β→0 limit and keep only the leading terms in the sum.
For 0≤θm< π, we have
X
nexp
−2π2R2
β(n2−θm
πn) + 2πiηwn
≈1, (B7)
and for π < θ m<2π
X
nexp
−2π2R2
β(n2−θm
πn) + 2πiηwn
≈e2πiηwexp2πR2(θm−π)
˜β
, (B8)
and for θm=π
X
nexp
−2π2R2
β(n2−n) + 2πiηwn
≈1 + e2πiηw= 2 eiπηwcosπηw. (B9)
Therefore, we find (for ηm̸= 1/2 mod 1):
G(θm)≈e−i[θm]πηwe−1
2βR2[θm]2, θm̸=π
G(π)≈2 cos( ηwπ) e−1
2βπ2R2, θm=π.(B10)
Appendix C: G(θ)of the Levin-Gu model
First we define a few quantities that appear frequently in the calculations below. Zss′(ϕ, β) is defined as
Zss′(ϕ, β) =N−1+s′
2Y
j=s′
2
1 + (−1)seiϕe4βcos2πj
N
. (C1)
Essentially, Zss′is the partition function of free fermions with periodic ( s′= 0) or anti-periodic ( s′= 1) boundary
conditions, projected to the fermion parity ( −1)ssector.
We will approximate the discrete products in Zss′by integrals. Define
I(ϕ, β) =Z2π
0dxln 
1 + eiϕe4βcosx
. (C2)
A crucial property of I(ϕ, β) for our derivations is that for −π < ϕ ≤π,
ℑI(ϕ, β) =πϕ. (C3)
We show below in Appendix E that for ϕ̸=π, we have
N−1+s′
2X
j=s′
2ln
1 + eiϕeαcos2πj
N
=N
2πZ2π
0dxln(1 + eiϕeαcosx) +O(N−1). (C4)
As a result,
Z0s′(ϕ, β)≈expN
2πI(ϕ, β)
= e1
2i[ϕ]πNexpN
2πℜI(ϕ, β)
. (C5)
Forϕ=πandN≡0 (mod 4), we instead have
N
4−1
2X
j=1
2ln( eαcos2πj
N−1) =N
2πZπ
2
0dxln( eαcosx−1) + ln√
2 +O(N−2). (C6)
We also need the following inequality between the integrals. Note that
1 + eiϕe4βcosx2= 1 + e8βcosx+ 2 cos ϕe4βcosx≤(1 + e4βcosx)2, (C7)
which implies I(0, β)>ℜI(ϕ, β) for 0 < ϕ < 2π.14
1. N even
ForNeven, the Levin-Gu model can be mapped to a free fermion system with even number of fermions and periodic
or anti-periodic boundary condition, we have
Tr eiθQe−βH=e1
2iθN
2[Z00(−θ/2, β) +Z10(−θ/2, β) +Z01(−θ/2, β) +Z11(−θ/2, β)]. (C8)
First we consider 0 < θ < π . As shown in Eq. (C5),
Tr eiθQe−βH≈expN
2πI
−θ
2, β
+1
2iθN
+ expN
2πI
−θ
2+π, β
+1
2iθN
(C9)
≈expN
2πI
−θ
2, β
+1
2iθN
(C10)
= exp1
4iθN
expN
2πℜIθ
2, β
. (C11)
The second line follows from1 + e−iθ
2e4βcosx>1−e−iθ
2e4βcosxfor any 0 < θ < π . From this result we
immediately see ω(θ) = exp 1
4iθN
for 0 < θ < π .
Forθ=π, from (C5) we have
Z0s′(±π/2, β) =Z1s′(∓π/2, β) = expN
2πI
±π
2, β
. (C12)
Crucially, the integrals satisfy ℜI(π
2, β) =ℜI(−π
2, β). Therefore we have
Tr eiπQe−βH≈2 cosπN
4
expN
2πℜI(π
2, β)
. (C13)
For the partition function
Tr e−βH=1
2[Z00(0, β) +Z10(0, β) +Z01(0, β) +Z11(0, β)], (C14)
we need to consider N≡0 or 2 (mod 4) separately. For N≡0 (mod 4), we have
Z10(0, β) =N−1Y
j=0(1−e4βcos2πj
N) = 0 , (C15)
and by Eq. (C6)
Z11(0, β) =N−1
2Y
j=1
2(1−e4βcos2πj
N) =
N
4−1
2Y
j=1
2( e4βcos2πj
N−1)
2
N
2−1
2Y
j=N
4+1
2(1−e4βcos2πj
N)
2
(C16)
≈4 expN
2πℜI(π, β)
. (C17)
When N≡2 (mod 4), we have the opposite: Z11(0, β) = 0 and Z10≈ −4 expN
2πℜI(π, β)
.
Putting everything together, we have found that for 0 < θ < π ,
G(θ)≈exp 1
4iθN
expN
2πℜI θ
2, β
expN
2πI(0, β)
+ 2(−1)N
2expN
2πℜI(π, β)≈e1
4iθNe−N
2π[I(0,β)−ℜI(θ
2,β)], (C18)
and for θ=π,
G(π)≈2 cos πN
4
expN
2πℜI(π
2, β)
expN
2πI(0, β)
+ 2(−1)N
2expN
2πℜI(π, β)≈2 cosπN
4
e−N
2π[I(0,β)−ℜI(π
2,β)]. (C19)15
2. N odd
When Nis odd, the Levin-Gu model corresponds to a free fermion system with odd number of fermions, and we
can write
Tr eiθQe−βH=e1
2iθN
2[Z00(−θ/2, β)−Z10(−θ/2, β) +Z01(−θ/2, β)−Z11(−θ/2, β)]. (C20)
For 0 < θ < π , we have
Tr eiθQe−βH≈expN
2πI
−θ
2, β
+1
2iθN
−expN
2πI
−θ
2+π, β
+1
2iθN
(C21)
≈expN
2πI
−θ
2, β
+1
2iθN
(C22)
= exp1
4iθN
expN
2πℜIθ
2, β
, (C23)
while for θ=π, we have
Tr eiπQe−βH≈
expiπN
4
−exp3iπN
4
expN
2πℜI(π
2, β)
(C24)
=2(−1)N−1
2sinπN
4
expN
2πℜI(π
2, β)
. (C25)
The large Nbehavior of the partition function is still governed by I(0, β) asI(0, β)>ℜI(π, β). Moreover, the two
terms Z10(0, β) and Z11(0, β) have opposite sign for Nodd and they cancel each other. Write N= 4m+rwhere
r= 1,3, then sinπN
4= sin( mπ+rπ
4) = (−1)msinrπ
4=1√
2(−1)m. We conclude that for 0 < θ < π ,
G(θ)≈exp 1
4iθN
expN
2πℜI θ
2, β
expN
2πI(0, β) = e1
4iθNe−N
2π[I(0,β)−ℜI(θ
2,β)], (C26)
and for θ=π,
G(π)≈(−1)m+r−1
2√
2 expN
2πℜI(π
2, β)
expN
2πI(0, β) = (−1)m+r−1
2√
2 e−N
2π[I(0,β)−ℜI(π
2,β)]. (C27)
Notice that cosπN
4= cos( mπ+πr
4) = (−1)mcosπr
4= (−1)m(−1)r−1
21√
2. So the phase factor ( −1)m+r−1
2is equal
to sgn(cosπN
4) in the main text.
Appendix D: G(θ)for XX spin chain
1. Half filling
We can write Tr eiθQe−βHas
Tr eiθQe−βH=1
2[Z00(θ, β)−Z10(θ, β) +Z01(θ, β) +Z11(θ, β)]. (D1)
For 0 < θ < π , we have
Tr eiθQe−βH≈expN
2πI(θ, β)
= exp1
2iθN
expN
2πℜI(θ, β)
. (D2)
Forθ=π,
Tr eiπQe−βH=1
2[−Z00(0, β) +Z10(0, β) +Z01(0, β) +Z11(0, β)]. (D3)16
We have proved that Tr eiπQe−βH= 0 for Nodd, so we only need to consider Neven case. Z00(0, β) and Z01(0, β) can
be approximated by Eq. (C5), and they cancel each other. The other two terms are already considered in Appendix
C, and we have Tr eiπQe−βH= 2(−1)N
2expN
2πℜI(π, β)
. Note the prefactor 2, which arises from O 1
N
correction
to approximating the sum by an integral, is key to the topological correction γin XX spin chain.
The partition function Tr e−βHcontains the same terms that appear in Tr eiπQe−βHwith different signs.
In conclusion, for 0 < θ < π , we have
G(θ)≈e1
2iθNe−N
2π[I(0,β)−ℜI(θ,β)]. (D4)
While for θ=π,
G(π)≈2 cosNπ
2
e−N
2π[I(0,β)−ℜI(π,β)]. (D5)
2. Away from half filling
With a nonzero chemical potential µ, the partition function of XX spin chain can be written as
Tr eiθQe−βH=1
2
N−1Y
j=0
1 + e4βcos2πj
N−4βcos(πν)+iθ
−N−1Y
j=0
1−e4βcos2πj
N−4βcos(πν)+iθ
+
1
2
N−1
2Y
j=1
2
1 + e4βcos2πj
N−4βcos(πν)+iθ
+N−1
2Y
j=1
2
1−e4βcos2πj
N−4βcos(πν)+iθ
, (D6)
where ν=1
πarccos 
−µ
4
is the filling fraction at zero temperature.
We can approximate the products by integrals as
Tr e−βH≈expN
2πI(0, β, ν)
, (D7)
where
I(ϕ, β, ν ) =Z2π
0ln
1 + eiϕe4βcosx−4βcos(πν)
dx. (D8)
For 0 < θ < π , we have
Tr eiθQe−βH≈expN
2πℜI(θ, β, ν )
. (D9)
The phase factor now depends on all the parameters θ, βandν. For θ=π, we show in Appendix E that the
constant correction relating I(π, β, ν ) and lnQ
1−e4βcos2πj
N−4βcos(πν)
is now 2 ln [2 sin( πδ)], where δ(or 1−δ) is
the minimal distance between jand the singular point x=Nν
2. For jtaking integer values, we can take δ=Nν
2
,
which is the decimal part ofNν
2. For jtaking half-integer values, we can take δ=Nν
2
−1
2. Thus,
Tr eiπQe−βH≈ −2 sin2Nν
2
π
exp [ℜI(π, β, ν )] + 2 sin2Nν
2
π−1
2π
exp [ℜI(π, β, ν )] (D10)
= 2 cos ( νNπ) expN
2πℜI(π, β, ν )
. (D11)
In conclusion, for 0 < θ < π , we have
|G(θ)| ≈e−N
2π[I(0,β,ν)−ℜI(θ,β,ν )]. (D12)
While for θ=π,
G(π)≈2 cos( νNπ) e−N
2π[I(0,β,ν)−ℜI(π,β,ν )]. (D13)17
Appendix E: Evaluation of the product
The Euler-MacLaurin formula for a continuously differentiable function f(x) reads
bX
i=af(i) =Zb
af(x) dx+f(a) +f(b)
2+Rm. (E1)
The remainder term Rmis given by
Rm=mX
k=1B2k
(2k)![f(2k−1)(b)−f(2k−1)(a)] +Zb
adx P2m+1(x)f(2m+1)(x), m∈N. (E2)
Here Bkare the Bernoulli numbers, and the periodized Bernoulli functions Pk(x) is defined as Pk(x) =Bk(x−[x]),
where Bk(x) is the Bernoulli polynomial.
A particularly useful result is that when |f′(x)|is bounded on [ a, b]:
|R0|=Zb
adx P1(x)f′(x)≤Zb
adx|P1(x)f′(x)| ≤Zb
adx|f′(x)| ≤(b−a) max
x∈[a,b]|f′(x)|. (E3)
Here we have used |P1(x)|=x−[x]−1
2≤1.
We now use the Euler-MacLaurin formula to study the sum
N−1X
j=0ln
eiθeαcos2πj
N+ 1
. (E4)
Applying Eq. (E1) with f(x) = ln
eiθeαcos2πx
N+ 1
we obtain
N−1X
j=0ln
eiθeαcos2πj
N+ 1
=ZN−1
0ln( eαcos2π
Nx+ 1) d x+1
2[ln( eiθeα+ 1) + ln( eiθeαcos2π
N+ 1)] + R (E5)
≈N
2πZ2π−2π
N
0ln( eiθeαcosx+ 1) d x+ ln( eiθeα+ 1) + O(N−2) +R (E6)
=N
2π Z2π
0−Z2π
2π−2π
N!
dxln( eiθeαcosx+ 1) + ln( eiθeα+ 1) + R+O(N−2) (E7)
=N
2πZ2π
0dxln( eiθeαcosx+ 1) + R+O(N−2). (E8)
Now we estimate the remainder term R. We observe that (with y=2π
Nx)
|f′(x)|=2πα
Neαcosy
eiθeαcosy+ 1siny
≤2πα
Neαcosy
|eαcosy+ e−iθ|.(E9)
When the imaginary part of eiθis nonzero, i.e. sin θ̸= 0, then the denominator is lower-bounded by |sinθ|and the
numerator is upper-bounded by eα, which imply
|R0|=O(N−1). (E10)
Let us now consider sin θ= 0, i.e. θ= 0 or π. For θ= 0, we have
|f′(x)| ≤2πα
Neαcosy
eαcosy+ 1≤2πα
N. (E11)18
Therefore Eq. (E10) still holds. Thus for any θ̸=πmod 2 πwe have shown that
N−1X
j=0ln
eiθeαcos2πj
N+ 1
=N
2πZ2π
0dxln( eiθeαcosx+ 1) + O(N−1). (E12)
It is straightforward to extend the proof to the case where the sum is over half-integer values.
Next we deal with the special θ=πcase, where the derivative f′(x) diverges at x=π/2. In fact, the same is true
for any f(2m+1)(x) atx=π/2, so the formula is not particularly useful for any finite m. Thus we formally extend
the formula to m=∞:
R∞≡Rm=∞=∞X
k=1B2k
(2k)![f(2k−1)(b)−f(2k−1)(a)]. (E13)
It should be understood as an asymptotic series expansion of the remainder term. To get a finite result, we will need
to resum the series.
First let us assume N≡0 (mod 4). We will consider the sum
N
4−1
2X
j=1
2ln( eαcos2πj
N−1). (E14)
Letf(x) = ln( eαcos2π
Nx−1), then we have
N
4−1
2X
j=1
2ln( eαcos2πj
N−1) =ZN
4−1
2
1
2ln( eαcos2π
Nx−1) dx+1
2[ln( eαcosπ
N−1) + ln( eαsinπ
N−1)] + R∞ (E15)
=N
2πZπ
2−π
N
π
Nln( eαcosx−1) dx+1
2h
ln( eα−1) + lnαπ
Ni
+O(N−2) +R∞ (E16)
=N
2πZπ
2
0ln( eαcosx−1) dx+1
2+R∞+O(N−2). (E17)
Now we consider the remainder term. It is not difficult to show that
f(2k−1)N
4−1
2
=2π
N2k−1(2k−2)!
(−π/N)2k−1=−22k−1(2k−2)!. (E18)
And f(2k−1)(1
2) isO(N−2k−2), so it can be ignored. Therefore
R∞=−∞X
k=1B2k
2k(2k−1)22k−1. (E19)
Here we can see that the correction does not depend on α, neither does it depend on the specific form of the spectrum
considered. This explains why CFT results agree with results derived from lattice models at any finite temperature.
To resum the asymtotic series, we use the following integral representation of Bernouli numbers:
B2k= 4k(−1)k+1Z∞
0t2k−1
e2πt−1dt. (E20)
Then we find
R∞=−2Z∞
0dt1
e2πt−1∞X
k=1(−1)k+1(2t)2k−1
2k−1=−2Z∞
0dtarctan 2 t
e2πt−1=−1
2−ln√
2
. (E21)
The last integral is given by Binet’s second formula for the logarithm of the Gamma function [45]:
2Z∞
0dt1
e2πt−1arctant
z=z−
z−1
2
lnz+ ln Γ ( z)−ln√
2π. (E22)19
Setting z=1
2gives the desired result.
So putting together we have shown that
N
4−1
2X
j=1
2ln( eαcos2πj
N−1) =N
2πZπ
2
0dxln( eαcosx−1) + ln√
2 +O(N−2). (E23)
Similarly,
N
2−1
2X
j=N
4+1
2ln(1−eαcos2πj
N) =N
2−1
2X
j=N
4+1
2ln eαcos2πj
N( e−αcos2πj
N−1)
=αN
2−1
2X
j=N
4+1
2cos2πj
N+N
2−1
2X
j=N
4+1
2ln( e−αcos2πj
N−1)
=−α
2 sinπ
N+N
4−1
2X
j=1
2ln( e−αcos2πj
N−1)
=−α
2 sinπ
N+N
2πZπ
2
0dxln( eαcosx−1) + ln√
2 +O(N−2)
=N
2πZπ
π
2dxln(1−eαcosx) + ln√
2 +O(N−2).(E24)
A straightforward generalization is to consider f(x) = ln
eαcos2π
Nx−αcos(πν)−1
and the summation
N−1+1
2s′X
j=1
2s′f(j), (E25)
where ν∈(0,1) and s′∈ {0,1}. Now the singular points are at x1=Nν
2andx2=N−Nν
2. Assume the largest
j < x 1in the summation is j1=x1−δ. Then, we have
x1−δX
j=1
2s′f(j) =Zx1−δ
1
2s′f(x) dx+1
2
f(1
2s′) +f(x1−δ)
+R∞+O(N−2) (E26)
=Zx1
0f(x) dx+1
2−δ
ln
αsin(πν)2πδ
N
+δ+R∞+O(N−2). (E27)
The remainder term R∞is
R∞=−∞X
k=1B2k
2k(2k−1)1
δ2k−1
=−δ+
δ−1
2
lnδ+ ln√
2π
Γ(δ). (E28)
Thus,
x1−δX
j=1
2s′f(j) =Zx1
0f(x) dx+1
2−δ
ln
αsin(πν)2πδ
N
+
δ−1
2
lnδ+ ln√
2π
Γ(δ). (E29)
If we add up the constant corrections from four segments, we will find
N−1+1
2s′X
j=1
2s′lneαcos2π
Nj−αcos(πν)−1=N
2πZ2π
0lneαcosx−αcos(πν)−1dx+ 2 ln [2 sin( πδ)]. (E30)