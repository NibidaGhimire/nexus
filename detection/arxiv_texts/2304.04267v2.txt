1
From Data-driven Learning to Physics-inspired
Inferring: A Novel Mobile MIMO Channel
Prediction Scheme Based on Neural ODE
Zhuoran Xiao, Student Member, IEEE, Zhaoyang Zhang, Senior Member, IEEE,
Zirui Chen, Student Member, IEEE, Zhaohui Yang, Member, IEEE,
Chongwen Huang, Member, IEEE, and Xiaoming Chen, Senior Member, IEEE
Abstract —In this paper, we propose an innovative learning-
based channel prediction scheme so as to achieve higher predic-
tion accuracy and reduce the requirements of huge amounts and
strict sequential format of channel data. Inspired by the idea
of the neural ordinary differential equation (Neural ODE), we
first prove that the channel prediction problem can be modeled
as an ODE problem with a known initial value by analyzing
the physical process of electromagnetic wave propagation within
a mobile environment. Then, we design a novel physics-inspired
spatial channel gradient network (SCGnet), which represents the
derivative process of channel varying as a special neural network
and can obtain the gradients at any relative displacement needed
for the ODE solving. With the SCGnet, the static channel at
any location served by the base station is accurately inferred
through consecutive propagation and integration. Finally, we
design an efficient recurrent positioning algorithm based on some
prior knowledge of user mobility to obtain the velocity vector
and propose an approximate Doppler compensation method
to make up the instantaneous angular-delay domain channel.
Only discrete historical channel data is needed for the training,
whereas only a few fresh channel measurements are needed
for the prediction, which ensures the scheme’s practicability.
Comprehensive evaluations show that the proposed scheme is
most efficient in representing, learning, and predicting mobile
wireless channels.
Index Terms —MIMO, Machine learning, Channel prediction,
Neural ODE, Physics-inspired learning
I. I NTRODUCTION
A. Motivation
Obtaining accurate channel state information (CSI) so as
to achieve optimal system design and deployment is crucial
in the future wireless communication systems [1]. However,
accurate CSI acquisition is challenging, especially in mobile
communication, due to the multi-path coupling caused by the
complicated scattering environment and Doppler effect [2].
In the existing wireless communication system, CSI is
estimated at the receiver and then feedback to the base station
This work was supported in part by National Key R&D Program of China
under Grant 2020YFB1807101 and 2018YFB1801104, National Natural
Science Foundation of China under Grant U20A20158 and 61725104, and
Provincial Key R&D Program of Zhejiang under Grant 2023C01021.
Z. Xiao, Z. Zhang (Corresponding Author), Z. Chen, Z. Yang, C. Huang,
and X. Chen are with College of Information Science and Electronic Engi-
neering, Zhejiang University, Hangzhou 310027, China, and with International
Joint Innovation Center, Zhejiang University, Haining 314400, China, and
also with Zhejiang Provincial Key Laboratory of Info. Proc., Commun. &
Netw. (IPCAN), Hangzhou 310007, China. (e-mail: {zhuoranxiao, ning ming,
ziruichen, yang zhaohui, chongwenhuang, chen xiaoming }@zju.edu.cn)(BS). This scheme has at least two potential drawbacks.
On the one hand, the estimated channel’s accuracy is hard
to guarantee if the channel parameters to be estimated are
strictly limited. Meanwhile, if we increase the number of
parameters to be estimated, the communication delay and
signaling overhead will undoubtedly grow [3]. On the other
hand, there exists a nonnegligible transmission delay for
CSI data feedback. Therefore, the instantaneous channel had
already changed when the BS received the feedback CSI data,
which will inevitably cause a loss of accuracy. Deterministic
channel synthesis, such as the ray-tracing method, is another
approach for obtaining CSI. This approach is based on the
specific electromagnetic (EM) wave propagation within a
natural environment. Owing to the analytical framework rooted
in electromagnetic theory, this method considers the field
properties of the antennas and the propagation paths. Although
it can achieve favorable accuracy with excellent cost-and-
time efficiency, it is usually hard to be applied in practice
since it needs to know the complete knowledge of the natural
environment.
In a specific communication scenario, a base station always
serves a certain fixed area in which the number and locations
of the scatterers are also fixed. The wireless channel is then
mainly determined by the scatterers distributed therein and the
corresponding multi-path propagation behavior of EM waves,
including specular reflection, diffusion, diffraction, and block-
ing. Although there are inevitable variations in channel char-
acteristics due to the small-scale perturbation of transmission
media, the long-term multi-path components of a channel can
still be regarded as quasi-static given that the scatterers within
that area do not change [4]–[7]. Moreover, when considering
the mobile scene, the wireless channel can be calculated by
compensating the Doppler shift to the static channel. So, it is
reasonable that with the velocity vector and a set of randomly
measured static CSI samples, we can predict the CSI of a user
equipment (UE) moving at a certain point within the served
area. Moreover, there are always a large number of channel
measurements with corresponding locations produced by the
communication processes occurring in the served area of the
BS. These data can be potentially made use of, and thus the
signaling overhead and measurement cost can be significantly
reduced. This inspires us to study the prediction of the mobile
channel within a specific communication environment.
Due to the complexity characteristic of multi-path chan-arXiv:2304.04267v2  [eess.SP]  29 Nov 20232
nels, we resort to learning-based methods for solving this
prediction problem for the higher representing ability due
to larger parameter space. Basically, our goal is to design
a learning system that can automatically learn the fixed
scattering environment and implicitly represent the physics
process of the wireless channel changing within space. The
whole learning system can be trained at the training stage
with only a few discrete static channel samples randomly
recorded in the historical communication process. Our goal
is to significantly reduce the difficulty of data acquisition and
the demand for data volume. At the inferring stage, only a
sequence of channels obtained in a past period of time is
needed. All the other key factors, such as the UE’s motion
vector and the UE’s position, are automatically learned. The
mobile channel frequency response (CFR) is the output target
of the whole system.
B. Related Works
In the past few years, comprehensive works have been
done in CSI prediction. In [8], [9], the noise from the mea-
sured channel impulse response (CIR) is removed by neural
networks, and the principal component analysis (PCA) was
utilized to exploit the features and structures of the channel.
In [10], based on received signal strength measurements and
a 3-D map of the propagation environment, the support vector
machine (SVM) was used to predict the path loss for smart
metering applications. Taking the receiver (RX) and trans-
mitter (TX) heights, TX-RX distance, carrier frequency, and
intercede range as the inputs, the path loss is predicted using
the radial basis function neural network (RBF-NN) in [11].
In [12], the fully connected neural network (FNN) and RBF-
NN were combined with ray launching in complex indoor
environments for predicting the intermediate points in the ray
launching algorithm and further decreasing the computation
complexity. The authors in [13] take TX-RX distance and
diffraction loss as the inputs, and the multi-layer perceptron
(MLP) was applied to predict the received signal strength.
Most existing works on channel prediction incline to treat
it as a sequence prediction problem. Two conventional pre-
diction approaches, namely parametric model [14] and auto-
regressive model [15] have been proposed through statistical
modeling of a wireless channel as a set of radio propagation
parameters. Since there is a nonnegligible gap between the
model and the real wireless channel, the potential achievable
prediction accuracy is generally unfavorable, which highly
limits their actual application. Motivated by the success of
machine learning algorithms in time-series prediction, some
recent works have attempted to apply learning-based methods
for channel prediction. In [16], [17], the recurrent neural
network (RNN) is applied to predict narrow-band single-
antenna channels. In [18], RNN is further replaced by the
gated recurrent unit (GRU) and a long short-term memory
(LSTM). Through viewing the sequential CSI as an image,
CNN+LSTM structure is used for channel prediction in [19].
In [20], a generative periodic activator-enabled Auto-Encoder
LSTM network is proposed as an improved method of normal
LSTM. The learning structure CNN+AR is proposed as asubstitution of LSTM in [21]. In [22], the Seq2Seq network
is applied. Besides, the ODE-RNN structure is introduced in
[23]. It is worth mentioning that the basic idea behind [23] is
quite different from this paper since therein the ODE-RNN is
proposed as an upgrade of normal RNN for solving sequence
prediction problems while here we attempt to predict channel
with only discrete CSI samples employing an entirely newly
designed network structure.
Although the existing learning-based methods for chan-
nel prediction can achieve better prediction accuracy than
traditional methods, they are still insufficient for practical
application. First of all, all the methods, including [23],
require a dataset composed of a series of channel sequences.
However, it should be emphasized that storing large quantities
of sequence data is not compatible with the existing wireless
communication protocols and will cause huge challenges to
storage capabilities for the BS and potential data transmission
overhead if there exists a cloud server for model training.
All the above facts make the state-of-the-art infeasible in
practice. In fact, in real scenarios, only the discrete CSI
recorded at a certain position rather than a data sequence
is available since this kind of data can be easily obtained
from historical records of those service vendors, such as the
communication operators. The proposed methods in this paper
are designed to deal with the setting that the BS only stores
some discrete CSI data sampled randomly in the served area.
Thus, the difficulty in obtaining and storing training data
can be greatly reduced and can be much more practical and
flexible at the deployment stage. Secondly, the accuracy of
sequence prediction by a purely data-driven learning network
highly relies on the numerical correlation and smoothness
of the data sequence. Therefore, when the interval of data
sequence increases, the prediction accuracy of those methods
significantly degrades. The main reason is that the network
structures used therein mainly focus on the common data
correlation between the discrete elements of all sequences
while overlooking the fact that the actual channel changing is
a unique physical continuous process with specific properties.
Therefore, no additional prior information is integrated into
the learning network, which limits the prediction accuracy.
C. Contributions
In fact, the change of CSI comes from the position change,
which causes the change of propagation paths. The changing of
CSI is essentially a physics process driven by the propagation
characteristics of electromagnetic waves in space and users’
movement characteristics, which contains a lot of implicit prior
knowledge. Thus, rather than predict the channel in the orig-
inal high dimension and unsmooth data space by learning the
correlation between discrete sampling points, we propose to
learn the implicit ordinary differential equations representing
the complete physics process of continuous channel changing.
Thus, we come up with a novel channel prediction scheme
that is composed of three segments. Firstly, we propose a
specially designed physics-inspired SCGnet to represent the
gradients of the derivative process of channel varying with
respect to space. Further, the output of which is then integrated3
to obtain the targeted output in the way of Neural ODE.
Discrete channel pairs with their position coordinates are used
to train the network through the adjoint method [24]. Then, we
propose an iterative algorithm for user positioning and motion
vector extraction based on a novel-designed positioning neural
network. Based on this, we transfer the original prediction
problem from a high and unsmooth data space to a low and
smooth one, significantly reducing learning difficulty. Thirdly,
an approximating Doppler compensation method making use
of the characteristic of the angular-delay domain channel is
proposed. Then, the targeted mobile channel can be obtained
by compensating the Doppler phase shift on the predicted
static channel.
To summarize, our main contributions are as follows:
•We prove that the gradient of CSI with respect to space
is only decided by the CSI itself and spatial direction.
So, we propose to model channel prediction as an ODE
problem with a known initial value. The Neural ODE
learning structure is proposed to solve the problem,
and a physics-inspired SCGnet is designed to implicitly
represent the ODE function. Only discrete samples are
needed to train the network, which can be easily obtained
from the historical communication data.
•An iterative algorithm for user positioning and motion
vector extraction is proposed based on a specially de-
signed positioning neural network. By making use of the
prior knowledge of the user’s mobility and the ODE-
guided change of its underlying scattering environment,
the positioning accuracy can far exceed that of the
positioning methods with a single discrete point. With the
predicted user’s velocity vector, an approximate Doppler
compensation algorithm is proposed for calculating the
mobile channel.
•Key performance measures, including network scale, pre-
diction accuracy, and dependence on training data, are
comprehensively evaluated and compared with the state-
of-the-art results, which shows that our proposed scheme
is much more efficient in learning, representing, and
predicting wireless channels in a given communication
environment.
The remainder of this paper is organized as follows. The
channel model and the problem formulation of channel predic-
tion are introduced in section II. The reason why we introduce
Neural ODE for channel prediction is given in section III.
Section IV introduces the whole channel prediction scheme
proposed by us, which is composed of three parts. Numerical
evaluation from different perspectives is provided in section
V. Section VI draws the conclusion.
II. P ROBLEM FORMULATION
A. Channel Model
Without losing generality, we assume that the base sta-
tion (BS) is equipped with a uniform linear array (ULA)
with half-wavelength spacing between two adjacent anten-
nas. Besides that, orthogonal frequency-division multiplexing
(OFDM) modulation is adopted. The UE has a single omnidi-
rectional antenna. The BS has Ntantennas, and there are Ncsubcarriers for OFDM signals. The static channel frequency
response (CFR) for each subcarrier can be formulated as
h[l] =NpathX
p=1αpe(θp)e−j2πdp
λl, (1)
and if the UE’s mobility is considered, the mobile CFR for
each subcarrier can be formulated as
hmobile [l] =NpathX
p=1αpe(θp)e−j2π[dp+vucos(θv−θp)τp
λl], (2)
where ldenotes the subcarrier index, Npath is the total number
of propagation paths, αpis the path loss of pth path, θpis
the angle of arrival, dpis the length of propagation path,
vudenotes the velocity of user, θvis the direction angle of
the velocity vector, τpis the propagation delay and λlis the
wavelength of corresponding subcarrier. In equation (1) and
(2),e(θ)denotes the array response vector of the ULA given
by
e(θ) = [1 , e−j2πdcos(θ)
λ, ..., e−j2π(Nt−1)dcos(θ)
λ ]T, (3)
where dis the interval between two adjacent antennas and λis
the wavelength. Thus, the overall CFR matrix of the channel
between the BS and the user can be expressed as
H= [h[1],h[2], ...,h[Nc]]. (4)
B. Angular-Delay Domain Channel Representation
Angular-Delay domain channel matrix is a transformation of
the CSI computed by multiplying it with two discrete Fourier
transform (DFT) matrices [25]. Defining the DFT matrix V∈
CNt×Ntas
[V]z,q≜1√Nte−j2π(z(q−Nt
2))
Nt, (5)
andF∈CNc×Ncas
[F]z,q≜1√Nce−j2πzq
Nc. (6)
Then, the Angular-Delay domain channel matrix Gis defined
as
G=VHHF (7)
The matrix Gcan be considered as a uniform grid of NtAoAs
over[0, π]andNcdelay points over [0,Nc
B], where Bdenotes
the carrier bandwidth. Thus, In this matrix, the (z, q)element
represents the response of the propagation path with zthAOA
andqthdelay, which can be written as
eθz= arccos2
Nt(z−Nt−1
2
)
, z= 0, . . . , N t−1,(8)
eτq=q
B, q= 0, . . . , N c−1. (9)
In practice, the true AoAs and delay points usually do not
always lie exactly on the grid points. In this case, there will be
mismatches between the true AoAs, delay points, and the near-
est grid point. Thus, the angular-delay channel response can
be regarded as being composed of Nt×Ncequivalent paths.4
Due to the sparsity of the matrix G, most equivalent paths’
responses are close to zero. For each equivalent propagation
path with θAOA and τdelay, the complex path response is
coupled by multiple subcarrier coupling, which can be written
as
gz,q=αθ,τNcX
k=1e−j2πfkτ, (10)
C. Problem Formulation of Channel Prediction
The goal of channel prediction is to forecast the CSI at the
current and future time slots by taking full use of CSI sequence
information obtained in the previous time period [26]. Assume
that the BS stores the CSI estimated in the past ntime slots,
which can be denoted by {H[1],H[2], ...,H[n]}. The CSI in
the next time slot should be predicted, denoted by∧
H[n+ 1].
Thus, the CSI prediction problem can be presented as
{H[1],H[2], ...,H[n]} →∧
H[n+ 1]. (11)
III. T HEODE R EPRESENTATION OF SPATIAL GRADIENT
OFSTATIC CHANNEL
A. Overview of Neural ODE
Neural ODE is a specially designed learning structure that
has been proven to have a strong ability to represent dynamic
progress, which can be originally described mathematically by
ordinary differential equations [27]. In a typical Neural ODE,
the state of the hidden layer is defined by the solution of the
following equation,
dy(x)
dx=f(y(x), x,I(x),θ), (12)
where y(x)∈RDdenotes the hidden layer, Dis the dimension
of variables in the hidden layer, I(x)is the input, xdenotes
the independent variable, f(·)denotes a neural network with
parameter θ. Therefore, after the network completes training,
the forward calculation becomes an ordinary differential equa-
tion problem with known initial values. Thus, the forward
calculation can be solved with constant or adaptive steps by
numerical methods called ODE Solver. The process of ODE
Solver can be written as
y(x0) =y0, (13)
youtput =ODE Solver (fθ, y0, x0, xend), (14)
Where youtput is the output of the Neural ODE, y0is the initial
value, x0is the integral starting point, and xendis the integral
endpoint.
The Euler method is one of the most commonly used ODE
Solvers among all the numerical methods. The procedure of
the Euler method can be presented by
yx+∆x=yx+ ∆x×f(yx,θ), (15)
where ∆xis the step length used to adjust the accuracy and
computation cost. In addition to the Euler method, there are
some high-order solvers with adaptive step sizes. Choosing a
proper ODE Solver is determined by the computational cost
and accuracy trade-offs.
濉澹澔 濉澹澔 濉澹澔 Fig. 1. When UE’s position change continuously in space, the changing
process of propagation paths are also continuous and highly smooth.
In order to ensure high calculation accuracy, the ODE
Solver’s step size is set as a small value, which indicates that
directly using the gradient back propagation algorithm to cal-
culate the gradient of parameters will introduce an enormous
calculation cost. To solve this problem, the adjoint method
is proposed in [24] to transform the gradient calculation into
another ODE problem, which can be solved by the ODE solver
with a low computational cost. The adaptive checkpoint adjoint
method is further proposed in [28] by adding a small amount
of storage cost to handle the calculation error introduced in
the adjoint method.
B. The Limitation of Conventional Network for Channel Pre-
diction
As shown in (1), the CSI matrix is determined by multipath
response components interwinding. For a wireless channel, the
variation mainly comes from two parts, i.e., the change of
electromagnetic wave propagation paths caused by the chang-
ing spatial position and frequency selective fading caused by
the Doppler effect. Due to the apparent magnitude difference
of electromagnetic wavelength scale relative to the spatial
changing scale of mobile users, the phase changing of channel
response is fast across space. Thus, the path response shows
prominent non-smooth characteristics on the spatial coordinate
axis. Considering the interwinding of multiple path responses
and the high-dimensional characteristics of channel matrix
caused by multi-carriers and multi-antennas, from the perspec-
tive of data characteristics, the channel prediction problem is
essentially a prediction problem dealing with high-dimensional
and extremely non-smooth data.
For those general sequential networks such as RNN and
LSTM, the dimension of data space and the data smoothness
directly decide the performance of the prediction. In existing
works, solving such a complex problem requires not only a
high level of network learning ability but also a large amount
of training data. Apparently, those requirements are hard to
meet in a practical system. However, as shown in Fig. 1,
from the perspective of the physics process of electromagnetic
wave propagation, the changing of the channel is a pure
physics driving process. Besides that, the propagation of
the electromagnetic wave in space has some fixed physical
characteristics. Thus, some unique prior information can be
used by designing targeted learning architecture to improve
prediction accuracy, save training data, and improve system
flexibility.5
C. Represent The Process of Channel Change with ODE
In order to better explain the advantages of the proposed
learning architecture, we provide the following proposition to
show the theoretical basis of the network design proposed for
CSI prediction.
Proposition 1. For a quasi-static scattering environment, if the
bidirectional mapping between of CSI Huand UE’s position
xuexists, the derivative of the mobile channel with respect to
space is only related to the CSI at a certain point and UE’s
motion direction.
Proof .According to (1), the real and imaginary parts of
channel response of the uth subcarrier and vth antenna can
be respectively written as
hreal
u,v=NpathX
p=1αpcos(−2πdp
λu−π(v−1) cos θp), (16)
and
himag
u,v=NpathX
p=1αpsin(−2πdp
λu−π(v−1) cos θp), (17)
where Npath is the total amounts of propagation paths, dp
is the propagation length of path p,αpis the path loss and
λuis the wavelength of the uth subcarrier. In particular, αp
is an inverse proportional function of dp. Thus, we denote
αp=ξp
dp, where ξpis only related to the characteristics of
electromagnetic materials. Also, we denote −2πdp
λu=ρdp
and−π(v−1) cos θp=b. Taking the real part of channel
response for illustration, its derivative with respect to spatial
displacement is
∂hreal
u,v
∂m=∂hreal
u,v
∂dp∂dp
∂m
= [NpX
p=1ξp
dpsin(ρdp+b)ρ−NpX
p=1ξp
dpcos(ρdp+b)1
dp]∂dp
∂m
=NpX
p=1ξp
dp(sin(ρdp+b)ρ−cos(ρdp+b)1
dp)∂dp
∂m,
(18)
∂dp
∂m= cos( θm−θp), (19)
where θmdenotes the motion direction.
Similarly, the derivative of the imaginary part can be given
by
∂himag
u,v
∂m=−NpX
p=1ξp
dp(cos(ρdp+b)ρ+ sin( ρdp+b)1
dp)∂dp
∂m.
(20)
It is obvious that all the variables in the above equations, such
asdp,ξpandρare decided by the UE’s position xuwith
the quasi-static scattering environment. Besides, the position
is determined by the UE’s CSI Hu, based on the bidirectional
mapping assumption of {Hu} → { xu}. Thus, the whole
formula only has two variable Huandθm. Therefore, this
proposition is proved.It should be noted that, in practical wireless communication
environments, the bidirectional mapping between Huandxu
holds with high probability due to the rich scattering and
the large-scale antenna arrays deployed therein [29]. Conse-
quently, with the above proposition, it is reasonable that we
use an ordinary differential equation to represent the changing
process of the wireless channel with respect to space
∂H
∂m=f(H, θm). (21)
Thus, the under-predicted channel can be calculated by for-
ward integration, and any known static channel at a certain
position obtained in a historical communication process can
be used as the initial value
Hpredict =H0+Zs
0f(H, θm)dm, (22)
where Hpredict is the static channel to be predicted, H0is
the known channel and sis the distance between the two
points. Since the function f(·)is not explicitly known, a
neural network is needed to represent it implicitly. Further, the
complete integration process can be represented by a neural
ODE.
IV. T HEPHYSICS -INSPIRED MOBILE CHANNEL
PREDICTION SCHEME
A. The Overall Process of Mobile Channel Prediction based
on Neural ODE
As shown in Fig. 2, the whole mobile channel prediction
system consists of three parts. We first obtain the UE’s
position and velocity vector through the iteration algorithm,
which will be introduced in the following text. Then, we
feed the position coordination to the Neural ODE structure
trained with the historical static channel. Finally, the mobile
channel is obtained through Doppler compensation with a
known velocity vector. In principle, the Neural ODE module is
used to learn the implicit information related to the scattering
environment and further generate CSI. The other parts are
used to learn the implicit information related to the mobile
UE. Compared with those purely data-driven schemes, we
design networks separately for different functions required in
the whole process, which reduces the difficulty of network
learning and the dependence on data volume.
B. The Learning Structure of Spatial Channel Gradient Net-
work
For each matrix element with θAOA and τdelay in the
angular-delay domain channel, the real and imaginary parts
can be written as
greal
τ,θ=ατ,θNcX
k=1cos(−2πdp
λk). (23)
gimag
τ,θ=ατ,θNcX
k=1sin(−2πdp
λk). (24)
Here, dpis indeed decided by τandθ. As mentioned above,
ατ,θis an inverse proportional function of dp. We denote6
濇澷澻濂濙濨 1[ ]nt+x
v
1'[ ]nt+ G1[ ]nt+GPositioning Network Training Historical CSI 
Neural ODE 
Doppler Compensation 
Fig. 2. The whole process of mobile channel prediction based on Neural
ODE.
ατ,θ=ξp
dp, where ξpis only related to the characteristics of
electromagnetic materials. Also, we denote −2πdp
λk=ρkdp.
Since in a practical system, wavelengths of different subcar-
riers can be considered approximately equal. So, we have
ρkdp≈ρdp. Then, the gradient of the channel relative to
space can be written as
∂greal
τ,θ
∂m=∂greal
τ,θ
∂dp∂dp
∂m
= [NcX
k=1ξp
dpsin(ρdp)ρ−NcX
k=1ξp
dpcos(ρdp)1
dp]∂dp
∂m
= (−1
dpgreal
τ,θ+ρgimag
τ,θ)∂dp
∂m,(25)
∂gimag
τ,θ
∂m=∂gimag
τ,θ
∂dp∂dp
∂m
= [−NcX
k=1ξp
dpcos(ρdp)ρ−NcX
k=1ξp
dpsin(ρdp)1
dp]∂dp
∂m
= (−1
dpgreal
τ,θ−ρgimag
τ,θ)∂dp
∂m.(26)
We take (25) as an example to demonstrate our ideas behind
the network design. After we transfer the CSI in the angular-
delay domain and calculate its gradient of space in such a
way, it can be found that such a mathematical expression has
some clear natural advantages for us to design the representing
networks. First of all, in existing works, the original complex
channel matrix must be split into real and imaginary parts.
Then, we need to concatenate them together due to the con-
straint that the neural network can only handle real numbers.
However, such an operation significantly destroys the internal
correlation of input data. On the contrary, in (25) and (26),
the expression on the right side is directly composed of the
weighted sum of the real and the imaginary parts, respectively.
Therefore, dividing the original complex number into real
and imaginary parts does not destroy the internal correlation
of data but also facilitates network learning. Secondly, as
mentioned above, the original channel is high-dimensional
complex data. However, in the equation, only1
dp, which
denotes the reciprocal of propagation path lengths, needs to belearned. Unlike existing works whose networks need to recover
high-dimensional complex data (channel matrix) as the output,
our network only needs to learn a simple mapping from high-
dimensional complex data to low-dimensional simple data.
Thus, the requirements for network parameters scale and com-
plexity cost are significantly reduced. It is worth mentioning
that the changes in the delay and angle of propagation of
paths are negligible for a propagation path since the sampling
interval is usually not long enough. Therefore, in the process
of channel changing between two points, the indices of the
matrix element representing a certain propagation path are
fixed, ensuring our methods’ robustness.
The overall network design is shown in Fig. 3. The whole
structure is composed of two networks. The first network,
called the scattering learning network, adopts the fully con-
nected structure that takes the reshaped CSI matrix G∈
Na×Nc×2as input, where Nadenotes the number of antennas
andNcdenotes the number of subcarriers, and intends to
obtain the matrix P∈Na×Nccomposed of propagation
length −1
dp. The other network, called the direction embedding
network, takes the direction vector θdirection ∼[−π, π]as
input to obtain the matrix∂P
∂m∈Na×Nccomposed of∂dp
∂m
as we have proved that∂dp
∂mis only decided by the integration
direction. Rather than using the angle value as input, we
use the sine and cosine values. It can also be viewed as a
special case of position encoding, which is commonly used
in state-of-the-art such as the transformer. Moreover, since
the output of this network, which represents the gradient
of channel relative to spatial displacement, is a vector of
dimension Na×Nc×2, we extend the input dimension of
Na×2by simple duplicating to balance the dimension of
input and output for better learning efficiency. Then, the final
output can be directly obtained through simple addition and
subtraction with two times Hadamard production. Since the
forward propagation strictly obeys the calculation process of
expression (25) - (26), we achieve fusing the channel prior to
the network design.
Algorithm 1: Static Channel Prediction with Neural
ODE (Euler method)
Input: Position coordinates xuof UE to be predicted.
Output: predicted static channel G(xu)
1Train the SCGnet with the historical channel dataset.
2Search for the nearest point in the database. Get the Position
coordinates x′and channel in the angular-delay domain
G(x′)of the nearest point in the database. Get the interval
s.
3Obtain the integration direction θmwithx′andxu.
4s′←0.
5while s′≤sdo
6 InputG(x′)andθmto the SCGnet and get the output
∂G(x′)
∂m.
7 G(x′)←G(x′) +∂G(x′)
∂m×∆s.
8 s′←s′+ ∆s.
9end
The overall training and inferring process of the proposed
SCGnet are based on the Neural ODE scheme. In the training
stage, the method for building a training dataset contains7
·
_
漒·
Reshape Output 
Output 
··
Concatenate Direction Vector 
Fig. 3. The network structure of physics-inspired SCGnet.
the following steps. Firstly, for each recorded CSI sample,
find its znearest neighbor points and build zdata pairs.
Then, calculate the vector’s length and angle with the selected
sample’s position as the starting point and its neighbor as the
ending point. Thus, the CSI of the selected CSI sample and
the vector’s angle are set as the input of the SCGnet. The
length of the vector is set as the integral length, and the CSI
of its neighbor points as the targeted output of the Neural
ODE. It is worth mentioning that zis selected according to
the sampling density of historical data. More specifically, the
value of zneeds to be smaller when the sampling density
is relatively low since a larger integral will lead to greater
error and influence the convergence of learning. As shown
in Fig. 4, in the inferring stage, we find the point closest to
the position of the channel to be predicted in the historical
database and then set its value as the initial value. Then, the
channel to be predicted can be obtained by forward integration.
Supposing that the ODE Solver adopts the Euler method, the
whole process of static channel prediction is summarized in
Algorithm 1.
C. Algorithm for Elimination and Compensation of the
Doppler Shift with Angular-Delay Domain Channel
Doppler shift compensation is the key step for obtaining
the target mobile CSI with the static channel predicted by
Neural ODE. Doppler compensation in existing works relies
澶濇 澼濝濧濨濣濦濝濗濕濠澔濘濕濨濕 
澽濢濝濨濝濕濠澔濪濕濠濩濙 
澺濣濦濫濕濦濘澔濝濢濨濙濛濦濕濨濝濣濢 
澸濝濧濨濕濢濗濙 
濉澹 
Fig. 4. The process for obtaining static channel with forward integration
through Neural ODE.on AOA separation, which is quite complex and requires a
lot of computational costs. However, since we already know
the velocity vector, the Doppler compensation could be much
easier, especially with the angular-delay domain channel.
As shown in Fig. 5, the Doppler phase shift is only related to
the velocity vector of the moving UE and the angle of arrival
of the certain propagation path. Conveniently, as we have
mentioned above, each element in the angular-delay domain
channel matrix can be viewed approximately as an equivalent
propagation path response gz,qwith known AOA and time
delay shown in Equation (8), (9). Thus, the channel with
Doppler shift Gmobile can be calculated
Gmobile =G◦D, (27)
where ◦denotes the Hadamard product and D∈Nt×Ncis
the Doppler compensation matrix
D(z, q)=−j2πvu
λcos(θv−θz+φ)τq. (28)
Dually, for Doppler elimination, we have
G=Gmobile◦E, (29)
where E∈Nt×Ncis the Doppler elimination matrix
E(z, q) =ej2πvu
λcos(θv−θz+φ)τq, (30)
D. The Iteration Algorithm for Sequential Motion Information
Obtaining and Positioning
In order to obtain the position and velocity of the UE so as
to further obtain the CSI to be predicted, we propose a novel
learning-based positioning network and an iterative motion
extraction method. The overall target is to make use of the
channel sequence estimated in a past time period and predict
the position of the UE in the next time slot with its velocity
vector.
Positioning through a learning-based method is essentially
a feature extraction process, and existing works widely adopt
convolution structures [30]–[33]. However, the positioning
accuracy of those works is highly limited. The main reason is
that there are several essential differences between CSI matrix
elements and pixels in an image, which cause mismatches
between the CSI matrix and convolution algorithm. First of all,8
1 1 
12path vtb p lD = 
2 2 
22path vtb p lD = 
濁濣濪濝濢濛澔濉澹 澶濇 
濇濗濕濨濨濙濦濙濦 
Fig. 5. Schematic diagram of Doppler phase shift.
激濇濈濁澔澷濙濠濠 激濇濈濁 Cell 激濇濈濁 Cell濁激濄 
σσTanh σ2灅灅 +
灅 灅Tanh FC LeakyReLu FC 
FC LeakyReLu 
[1]h[2]h [ ]Kh [ ]cNh
Fig. 6. The LSTM structure for channel positioning network.
it is the relationship between pixels rather than the coordinates
of the pixels that really contain the critical information of
images. This property makes the convolution and pooling
operators fit the image data well due to the translational
invariance. In contrast, the position index in the CSI matrix has
clear correspondence with the index of antennas and carriers
and is neither swappable nor translational. Thus, lots of crucial
information losses when it flows through the convolutional
neural network. On the other hand, images have a high
smoothness characteristic since the values of adjacent pixels
are usually similar. In contrast, the adjacent elements of the
CSI matrix are generally quite numerically different. Such
high frequency and unsmooth features make the convolution
operator’s inherent smoothing effect which is suitable for
images, however, become the bottleneck of the MIMO channel
data representation.
As proven in [34], considering that the interval of adjacent
subcarriers is strictly equal, the MIMO channel frequency
response matrix has some uniform sequential characteristics
in the spatial domain. Thus, the CSI can be viewed as an
information sequence, and the sequential learning structure is
more suitable for feature extraction. As shown in Fig. 6, the
network is composed of Ncstandard LSTM cells. The channel
response vector of different sub-carriers are inputted into those
cells respectively, and the targeted position is outputted in the
last cell. Since it is not the whole channel matrix but one
single column inputted to each cell, the parameters scale for
each cell can be highly limited and ensure network robustness.
Since the positioning network is trained with historic static
channel data at the training state while the input is the
measured channel under movement at the inferring stage, the
output result will carry some inherent errors. So, we propose
Least squares regression 
Iterate until     converge  Iteration 
Doppler elimination 
Positioning network 
瀖
濰Fig. 7. The iteration process for motion vector obtaining and positioning.
an iterative method to eliminate the Doppler effect in the
estimated mobile channel sequence. Practically, the channel
sampling interval is in the time scale of milliseconds, which
is negligible compared with the time scale of user speed
change. So, we can approximately assume that the user is
moving uniformly in a straight line during this period of
time. This assumption provides strong prior knowledge and
further clarifies the iteration goal for the algorithm. Algorithm
2 describes the detailed flow, and the key designing ideas
can be summarized as follows. With the channel sequence
{H[t1],H[t2],···,H[tn]}, we can obtain a series of UE’s po-
sition{x[t1],x[tn],···,x[t3]}through the channel positioning
network. Since all the time points {t1, t1,· · ·, tn}are known,
the least squares regression algorithm can be adopted to find
a linear equation to fit the sequence
x=vit+σ, (31)
where viis the velocity vector calculated at the ith iteration
andσis a constant vector. Then, the Doppler elimination
algorithm introduced above can be used to obtain the targeted
static channel {Hi[t1],Hi[t2],· · ·,Hi[tn]}. Furthur, predicted
position {xi[t1],xi[t2],· · ·,xi[t3]}as well as the velocity
vector vican be obtained. Repeat the above process until
|vi+1−vi|< η and finally the position xi+1[tn+1]to be
predicted can be obtained. It should be noticed that since the
positioning accuracy of the positioning network is relatively
high, even with a mobile channel as input, the convergence of
the iteration algorithm can be highly ensured.
V. E XPERIMENTAL RESULTS AND ANALYSIS
A. Scene Setup and Datasets Generation
As has been proven to be one of the most realistic determin-
istic channel models, the ray-tracing model is used to generate
our dataset. Ray-tracing is a method for approximating the
propagation of a wave in an environment using discrete rays
[35]–[38]. The discrete rays are traced by determining all9
Algorithm 2: Positioning and Motion Information
Extraction
Input: Channel sequence obtained in a past period of time
{H[t1],H[t2],· · ·,H[tn]}; The channel sampling
time point {t1, t2,· · ·, tn}.
Output: The UE’s position in the next time slot xi[tn+1];
The UE’s velocity vector vi.
1Train positioning network with historical static CSI data
2Input{H[t1],H[t2],· · ·,H[tn]}to the positioning network
separately and get {x[t1],x[t2],· · ·,x[tn]}.
3Using the least squares regression algorithm to find the
equation x=vt+σ.
4v0←v;|v1| ←0;i←1
5while|vi−vi−1| ≥ηdo
6 Obtain {Hi[t1],Hi[t2],· · ·,Hi[tn]}through Doppler
elimination with vi−1and
{Hi−1[t1],Hi−1[t2],· · ·,Hi−1[tn]}.
7 Input{Hi[t1],Hi[t2],· · ·,Hi[tn]}to the positioning
network separately and get {xi[t1],xi[t2],· · ·,xi[tn]}.
8 Using the least squares regression algorithm to find the
equation xi=vit+σ.
9 i←i+ 1.
10end
11Substitute tn+1into the equation xi=vit+σto get
x[tn+1].
possible specular images of TX/RX or by launching rays
in different directions. The possible pathways and their cor-
responding interactions, such as reflections, diffraction, and
diffuse scattering, are determined in both cases.
As shown in Fig. 8, A practical outdoor scenario is chosen
for setting up our 3D model. Here, we use Wireless Insight
software from Remcom company to do the ray-tracing calcu-
lation. In Fig. 8, the height of Building 1 is 25m, Building 2
is 35m, Building 3, and Building 4 is 8m. The material for all
the buildings is set as cement. Area 5 is a forest. Users are
distributed in a 120m × 60m area. The central frequency is set
as 3.5GHz. The BS is equipped with a ULA and is located 10m
higher above building 2. The OFDM bandwidth is 100MHz,
and the maximum number of paths is 25. Due to the fact
that the channel sampling time interval is relatively small in
a practical system, it can be assumed that the UE moves in a
uniform linear way in any direction within the sequence time.
Moreover, we calculate and apply the corresponding Doppler
phase shift to each propagation path.
Fig. 8. The 3D model of the Ray-tracing scene.B. Comparison Benchmarks
Two state-of-the-art methods are selected as comparison
benchmarks for comprehensively evaluating our proposed
scheme. The performance measures include prediction accu-
racy, dataset size, and dependence on training data.
First, we compare our scheme with the static channel
database method in [39]. It is convenient to directly compare
our proposed method with it since they share the same
historical static CSI database setting. In the comparing method,
the author proposes that since the BS and main scatterers are
static, certain wireless channel parameters mainly affected by
static scatterers can also be assumed static, e.g., path loss,
shadow fading, DOA, the number of paths, and time delay
of main paths. Besides that, the velocity of BS is a dynamic
parameter that can be obtained through the Global Positioning
System (GPS) or other speed testing tools. Multiple Signal
Classification (MUSIC) algorithm is used to extract channel
parameters, and clustering methods are used assuming that the
points in a cluster share the same static parameters. And then,
other parameters, such as the path loss, are obtained through
channel estimation. Here, for a more intuitive comparison, we
relax the requirement of the comparing method and replace
all parameters that need to be estimated with the ground truth.
Then, we use the nearest neighbor interpolation to replace the
original clustering method. With all the settings above, the
predicted channel is supposed to be more accurate than the
original comparing method.
Then, we compare our scheme with the LSTM network,
which is widely used as the benchmark in existing works
adopting learning-based channel prediction methods [40]–[42].
The LSTM network requires sequential data for training, while
our proposed method only requires CSI of discrete points. So,
to better illustrate the advantages of our proposed method
in training data scale, we propose comparing our methods
with the LSTM network while keeping the number of training
data pieces equal in both methods where a sequence of data
is defined as one piece of data. So, assuming the length of
the sampling sequence is z, the scale of the data size of
the comparing method is ztimes larger than our proposed
method. Because storing large amounts of data puts forward
higher requirements for the base stations in future wireless
communication systems, we want to show that our proposed
method can achieve higher prediction accuracy with less
training data through this comparison.
C. Model Settings and Complexity Analysing
The detailed model settings of SCGnet are shown in Tabel I.
The number of neurons of each hidden layer is selected from
trial and error. Since the scattering learning network needs
to learn the implicit scattering information, we design a rel-
atively deep network with 256-768-512-256 hidden numbers
for higher learning ability. The input and output dimension is
Nt×Nc×2. The direction embedding network serves an easier
function. Thus, we only use an MLP with two hidden layers to
reduce the network size and save computing costs. We adopt
a two-layer LSTM structure for the positioning network with10
TABLE I
MAINPARAMETERS AND VALUES FOR SCGN ET.
(a) Scattering learning network
Parameters Value
Input dimension 64×64×2
Output dimension 64×64×2
Activation function Tanh
Number of neurons in hidden 256-768-512-256
layer
Performance metric Mean square error (MSE)
Optimizer Adam
Training steps 2×105
Batch size 20
Training samples 80% of the whole datasets
(b) Direction embedding network
Parameters Value
Input dimension 64×2
Output dimension 64×64
Activation function Tanh
Number of neurons in hidden 512-256
layer
Performance metric Mean square error (MSE)
Optimizer Adam
Training steps 2×105
Batch size 20
Training samples 80% of the whole datasets
hidden numbers of 256-128. Tabel II shows the detailed model
settings.
For the SCGnet, the total number of parameters can be
calculated as: (64×64×2×256 + 256 + 256 ×768 + 768 +
768×512 + 512 + 512 ×256 + 256 + 256 ×64×64×2 +
64×64×2) + (64 ×2×512 + 512 + 512 ×256 + 256 +
256×64×64 + 64 ×64) = 6175232 . For the positioning
network, the total number of parameters can be calculated as
[(256+64 ×64×2)×256+256+(256+128) ×128+128] ×4+
128×3+3 = 8849283 . Thus, the overall number of parameters
is6175232 + 8849283 = 15024515 . For the compared LSTM
network, which adopts the structure of one hidden layer with
384 neurons, the total number of parameters can be calculated
as(64×64×2 + 384) ×384 + 384 + 384 ×64×64×
2 = 16328192 . Thus, the model complexity of our proposed
network is approximately the same as the benchmark, which
guarantees fairness in comparison.
Mean square error (MSE) is chosen as the loss function,
which can be written as
MSE =1
iiX
w=1(yw−∧yw)2
, (32)
where yis the training label,∧yis the prediction value and i
is the dimension of output. It represents the average distance
between the target value and the prediction value of all the
output dimensions.
Normalized MSE (NMSE), which is an expectation value
calculated across the testing dataset, is used to evaluate the
prediction accuracy of the testing datasets since it is more
convenient for comparison crossing different datasets. It canTABLE II
MAINPARAMETERS AND VALUES FOR POSITIONING NETWORK
Parameters Value
Input dimension 64×64×2
Output dimension 3
Activation function Tanh
Number of neurons in hidden layer 256-128
Performance metric Mean square error (MSE)
Optimizer Adam
Training steps 2×105
Batch size 20
Training samples 80% of the whole datasets
be mathematically written as
NMSE =E
iP
w=1|yw−∧
yw|2
iP
w=1|yw|2
. (33)
For learning tasks, the performance is usually highly af-
fected by the training dataset size. As we have mentioned
above, the training dataset is generated by making use of the
history records stored in the BS. So, we want to achieve fa-
vorable prediction performance while spending as little storage
capacity of the BS as possible. Here, sampling density, defined
as the average number of data samples in a unit area ( 1m2),
is used to evaluate the size of the training datasets. Three
data sampling densities of 25,50, and 100 are considered in
our experiment setting, and all the data are generated through
a random process. We choose these three sampling densities
because the experiment results will help better illustrate some
essential characteristics of the network. It is noteworthy that
the sampling density is much lower compared with other works
in the field of AI-aided wireless communication with ray-
tracing datasets. For example, 100000 channel samples are
used in [43] for a 40m×60marea, 121000 channel samples
are used in [44] for a 10m×10mscenery, and 50000 samples
are used in [45] for a 20m×30mscenery.
D. Experimental Results and Analysis
Since CSI changes dramatically in space, positioning accu-
racy directly influences the final prediction accuracy. With the
setting of sampling density of 100, two start-of-the-arts are
compared with our proposed network under different velocity
settings. We keep the amounts parameters of the comparing
network approximately the same to ensure the fairness of
the comparison. As shown in Fig. 9, the positioning network
with CNN can achieve better performance with the angular-
delay domain channel owing to the reason that channel in the
angular-delay domain has some features similar to images.
However, our proposed network can achieve higher accuracy.
The reason is that we divide the channel matrix in the
carrier, reducing the input dimension of each LSTM cell.
Besides that, the network can extract channel features from the
sequence perspective and reduce each individual cell’s learning
difficulty.11
LSTM with 
 CFR ChannelCNN with 
 AD Domain ChannelCNN with 
 CFR Channel00.010.020.030.040.050.060.070.080.090.1Averaged Positioning Error (m)Static
Velocity = 10m/s
Velocity = 40m/s
Fig. 9. Single point positioning accuracy of our proposed network and two
comparing methods.
2 4 6 8 10 12 14 16
Steps0.020.030.040.050.06Averaged Positioning Error (m) (V = 10m/s)Sampling density = 100
Sampling density = 50
Sampling density = 25
Fig. 10. Curves of positioning accuracy varies with the sequence length under
different settings of settings of sampling density.
Fig. 10 shows the performance of our proposed iterative
positioning method under three settings of sampling density.
Here, we set the velocity of the UE as 40m/s to show
that our algorithm can handle positioning at high moving
speed. It is obvious that using sequence CSI can achieve
far higher accuracy than single CSI positioning. All three
curves converge at steps = 10, which means we only need the
measured channel in the past 10time slots to reach the highest
positioning accuracy. Results show that When the training data
is sufficient, the error can be controlled to about one-fifth of
the electromagnetic wavelength. Thus, the iterative algorithm
ensures that the input of the following Neural ODE is close
to the ground truth. We believe two factors lead to the results.
One is that more information is taken used. The other more
important factor is that the prior information of UE’s motion
mode is well combined with the positioning algorithm.
Fig. 11 illustrates two kinds of comparison. The first is the
comparison between the Neural ODE-based method with the
state-of-the-art channel static method we mentioned above,
and the other is the comparison between SCGnet and normal
MLP. Also, the prediction NMSE under three sampling densi-
ties is compared to show the dependence of different methods
on data volume. Here, we set the velocity of UE to 10m/s,
which is common in actual scenarios. It is worth mentioning
that the comparing method of Neural ODE with MLP is simply
done by replacing the SCGnet of the proposed method withnormal MLP and keeping the total number of parameters
approximately the same. Results show that adopting the Neural
ODE learning structure can lead to excellent performance
gain compared with the traditional method. One interesting
result is that in the comparing method, the prediction accuracy
suffers a great decrease when the sampling density switches
from 50to25. However, in the Neural ODE based methods,
the accuracy will not decrease significantly even at a lower
sampling density, proving our proposed method’s feasibility.
Switching from normal MLP to the proposed SCGnet, the
prediction accuracy is obviously improved under all three
sampling density settings. This result is natural since instead of
directly learning the complex mapping from CSI the gradient,
our proposed network integrates the physics prior information
into the network design and dramatically reduces the learning
complexity of the network.
Neural ODE 
 with SCGNetNeural ODE 
 with MLPStatic Channel Databsae00.10.20.30.40.50.60.7NMSE (Velocity = 10m/s)sampling density = 100
sampling density = 50
sampling density = 25
Fig. 11. Prediction NMSE under different sampling density of three compar-
ing methods.
In order to make a more comprehensive comparison be-
tween our proposed method and the LSTM network, three
different lengths are adopted. Besides that, different UE’s
velocities and sampling densities are tested. The sequence
interval of the training dataset for LSTM is 1ms, and both
methods output channel matrix in the angular-delay domain.
Since the LSTM network with a small training dataset is
difficult to converge, we only make the comparison with the
sampling density of 50and100. The overall results are shown
in Fig. 12. It can be seen that with the increase in sequence
length, the prediction accuracy can be improved for the LSTM
network. However, the prediction accuracy of length = 7
and length = 5are very close, especially in the low-speed
scenario. So, we believe the prediction accuracy is close to
optimal when the length = 7. It can be seen that, benefiting
from the targeted design for unique physics processes, our
proposed method can achieve much higher accuracy than the
benchmark in any scenario. Besides that, it can be seen from
the results that the sequence-based network is quite sensitive
to the velocity of UE, and the performance will decrease
tremendously when the speed increases. The main reason
behind this is that the performance of these kinds of networks
highly relies on the correlation between sequential data. With
the increase of UE’s moving speed, the spatial spacing between
sequence sampling points will also increase, weakening spatial12
Proposed LSTM (n=7) LSTM (n=5) LSTM (n=3)00.10.20.30.40.50.60.70.8NMSEvelocity = 10m/s
velocity = 40m/s
velocity = 60m/s
(a) Sampling density = 50
Proposed LSTM(n=7) LSTM(n=5) LSTM(n=3)00.10.20.30.40.50.60.7NMSEvelocity = 10m/s
velocity = 40m/s
velocity = 60m/s
(b) Sampling density = 100
Fig. 12. Prediction NMSE comparison between proposed method and LSTM
of different lenghths under different settings of UE’s velocity.
1 2 3 4 5 6 7 8
Sampling Interval (ms)00.10.20.30.40.50.60.70.8NMSE (V = 10m/s)Proposed Method
LSTM (n=7)
LSTM (n=5)
LSTM (n=3)
AR (n=7)
Fig. 13. Prediction NMSE under different sampling intervals of the three
comparing methods.
correlation between sequences. On the contrary, our proposed
method can maintain high prediction accuracy even with UE’s
fast movement.
In order to better illustrate the advantage of our proposed
methods over sequential learning structure, Fig. 13 compares
the prediction performance of the two kinds of learning-based
approaches with greater spatial spacing between adjacent
sampling points by increasing the sampling time interval.
Besides that, the traditional AR model with length = 7is added
as a benchmark. It is worth noting that such an experiment
is of practical significance since reducing sampling intervals
can help save pilots needed in channel estimation. As canbe seen from the results, although still better than the AR
model, the prediction of LSTM networks dropped sharply with
the increasing sampling interval. For the case of length = 3
and length = 5, the networks are even harder to converge
with longer intervals. However, the sampling interval has no
influence on the prediction accuracy of our method in an ideal
scenario where no velocity of UE changes happened in this
period. Therefore, our scheme is more feasible in practical
application.
VI. CONCLUSION
In this paper, we addressed the practical challenge of
efficiently and accurately mobile MIMO channel prediction
with only a set of channel instances obtained within a certain
wireless communication environment. We proved that the
spatial channel gradient is only decided by the CSI itself and
the spatial direction. Therefore, the channel prediction problem
was modeled as an ordinary differential equation problem with
a known initial value. Innovatively, we proposed a physics-
inspired SCGnet to implicitly represent the channel gradient
with respect to spatial displacement at any location and adopt
the Neural ODE learning structure to update the parameters
and do the forward calculation. Further, to obtain the integral
length and direction of the Neural ODE, we proposed a novel
positioning network and an iterative algorithm for sequential
positioning. Experiments have shown the effectiveness of our
proposed learning scheme. The values predicted through our
method were very close to the ground truth generated through
the Ray-Tracing model.
It is an encouraging achievement for us to open a new
prospect of switching from the past way of adopting a purely
data-driven universal learning architecture to design a physics-
inspired learning structure aimed at unique data characteristics
or tasks in wireless communication. In fact, different from
many other machine learning tasks, there is a lot of unique
prior knowledge in wireless communication that has not been
fully used in existing works. Our work is a good example
to illustrate the detailed thoughts of fusing prior information
into the design of a network structure or learning scheme. We
believe that our work has the potential to guide the learning
system design of sensing wireless communication scenes and
intelligent wireless communication in the future.
REFERENCES
[1] C. Wu, X. Yi, Y . Zhu, W. Wang, L. You, and X. Gao, “Channel prediction
in high-mobility massive MIMO: From spatio-temporal autoregression
to deep learning,” IEEE Journal on Selected Areas in Communications ,
vol. 39, no. 7, pp. 1915–1930, 2021.
[2] W. Li, H. Yin, and M. Debbah, “A super-resolution channel prediction
approach based on extended matrix pencil method,” in ICC 2022 - IEEE
International Conference on Communications , 2022, pp. 1355–1360.
[3] C. Luo, J. Ji, Q. Wang, X. Chen, and P. Li, “Channel state information
prediction for 5G wireless communications: A deep learning approach,”
IEEE Transactions on Network Science and Engineering , vol. 7, no. 1,
pp. 227–236, 2020.
[4] Z. Xiao, Z. Zhang, C. Huang, Q. Yang, and X. Chen, “Channel pre-
diction based on a novel physics-inspired generative learning structure,”
in2021 IEEE 94th Vehicular Technology Conference (VTC2021-Fall) ,
2021, pp. 01–06.13
[5] Y . Zhang, S. Liu, Y . Rui, S. Zhou, and J. Wang, “Channel prediction
assisted by radio propagation environments information,” in 2008 4th
IEEE International Conference on Circuits and Systems for Communi-
cations , 2008, pp. 733–736.
[6] Z. Xiao, Z. Zhang, C. Huang, X. Chen, C. Zhong, and M. Debbah,
“C-GRBFnet: A physics-inspired generative deep neural network for
channel representation and prediction,” IEEE Journal on Selected Areas
in Communications , vol. 40, no. 8, pp. 2282–2299, 2022.
[7] Y . Zhang, S. Liu, Y . Rui, S. Zhou, and J. Wang, “Wideband wireless
channel predictor relying on environment information,” in 2008 8th
International Symposium on Antennas, Propagation and EM Theory ,
2008, pp. 945–948.
[8] X. Ma, J. Zhang, Y . Zhang, and Z. Ma, “Data scheme-based wireless
channel modeling method: Motivation, principle and performance,”
Journal of Communications and Information Networks , vol. 2, no. 3,
pp. 41–51, 2017.
[9] X. Ma, J. Zhang, Y . Zhang, Z. Ma, and Y . Zhang, “A PCA-based mod-
eling method for wireless MIMO channel,” in 2017 IEEE Conference
on Computer Communications Workshops (INFOCOM WKSHPS) , 2017,
pp. 874–879.
[10] M. Uccellari, F. Facchini, M. Sola, E. Sirignano, and S. Tondelli, “On the
application of support vector machines to the prediction of propagation
losses at 169 mhz for smart metering applications,” IET Microwaves
Antennas and Propagation , vol. 12, no. 3, 2016.
[11] P.-R. Chang and W.-H. Yang, “Environment-adaptation mobile radio
propagation prediction using radial basis function neural networks,”
IEEE Transactions on Vehicular Technology , vol. 46, no. 1, pp. 155–160,
1997.
[12] L. Azpilicueta, M. Rawat, K. Rawat, F. M. Ghannouchi, and F. Falcone,
“A ray launching-neural network approach for radio wave propagation
analysis in complex indoor environments,” IEEE Transactions on An-
tennas and Propagation , vol. 62, no. 5, pp. 2777–2786, 2014.
[13] G. P. Ferreira, L. J. Matos, and J. M. M. Silva, “Improvement of outdoor
signal strength prediction in UHF band by artificial neural network,”
IEEE Transactions on Antennas and Propagation , vol. 64, no. 12, pp.
5404–5410, 2016.
[14] R. O. Adeogun, P. D. Teal, and P. A. Dmochowski, “Extrapolation
of MIMO mobile-to-mobile wireless channels using parametric-model-
based prediction,” IEEE Transactions on Vehicular Technology , vol. 64,
no. 10, pp. 4487–4498, 2015.
[15] A. Duel-Hallen, S. Hu, and H. Hallen, “Long-range prediction of fading
signals,” IEEE Signal Processing Magazine , vol. 17, no. 3, pp. 62–75,
2000.
[16] J. T. Connor, R. D. Martin, and L. E. Atlas, “Recurrent neural net-
works and robust time series prediction,” IEEE Transactions on Neural
Networks , vol. 5, no. 2, pp. 240–254, 2002.
[17] T. Ding and A. Hirose, “Fading channel prediction based on combina-
tion of complex-valued neural networks and chirp Z-transform,” IEEE
Transactions on Neural Networks and Learning Systems , vol. 25, no. 9,
pp. 1686–1695, 2014.
[18] W. Jiang and H. D. Schotten, “Recurrent neural networks with long
short-term memory for fading channel prediction,” in 2020 IEEE 91st
Vehicular Technology Conference (VTC2020-Spring) , 2020, pp. 1–5.
[19] Y . Yang, F. Gao, C. Xing, J. An, and A. Alkhateeb, “Deep multimodal
learning: Merging sensory data for massive MIMO channel prediction,”
IEEE Journal on Selected Areas in Communications , pp. 1–1, 2020.
[20] Z. Xiao, Z. Zhang, C. Huang, C. Zhong, and X. Chen, “GPAE-LSTMnet:
A novel learning structure for mobile mimo channel prediction,” in 2021
IEEE 32nd Annual International Symposium on Personal, Indoor and
Mobile Radio Communications (PIMRC) , 2021, pp. 1–6.
[21] J. Yuan, H. Q. Ngo, and M. Matthaiou, “Machine learning-based channel
prediction in massive MIMO with channel aging,” IEEE Transactions
on Wireless Communications , vol. 19, no. 5, pp. 2960–2973, 2020.
[22] Y . Huangfu, J. Wang, R. Li, C. Xu, X. Wang, H. Zhang, and J. Wang,
“Predicting the mumble of wireless channel with sequence-to-sequence
models,” in 2019 IEEE 30th Annual International Symposium on Per-
sonal, Indoor and Mobile Radio Communications (PIMRC) , 2019, pp.
1–7.
[23] Z. Xiao, Z. Zhang, Z. Chen, Z. Yang, and R. Jin, “Mobile MIMO channel
prediction with ODE-RNN: a physics-inspired adaptive approach,” in
2022 IEEE 33rd Annual International Symposium on Personal, Indoor
and Mobile Radio Communications (PIMRC) , 2022, pp. 1301–1307.
[24] P. Stapor, F. Frhlich, and J. Hasenauer, “Optimization and uncertainty
analysis of ode models using 2nd order adjoint sensitivity analysis,”
2018.
[25] X. Sun, C. Wu, X. Gao, and G. Y . Li, “Fingerprint-based localization
for massive MIMO-OFDM system with deep convolutional neuralnetworks,” IEEE Transactions on Vehicular Technology , vol. PP, no. 99,
pp. 1–1, 2019.
[26] J. Wei and H. D. Schotten, “Recurrent neural networks with long
short-term memory for fading channel prediction,” in 2020 IEEE 91st
Vehicular Technology Conference (VTC2020-Spring) , 2020.
[27] R. T. Q. Chen, Y . Rubanova, J. Bettencourt, and D. K. Duvenaud, “Neu-
ral ordinary differential equations,” in Advances in Neural Information
Processing Systems , S. Bengio, H. Wallach, H. Larochelle, K. Grauman,
N. Cesa-Bianchi, and R. Garnett, Eds., vol. 31. Curran Associates, Inc.,
2018.
[28] J. Zhuang, N. Dvornek, X. Li, S. Tatikonda, X. Papademetris, and
J. Duncan, “Adaptive checkpoint adjoint method for gradient estimation
in neural ODE,” arXiv e-prints , 2020.
[29] J. Vieira, E. Leitinger, M. Sarajlic, X. Li, and F. Tufvesson, “Deep
convolutional neural networks for massive MIMO fingerprint-based
positioning,” in 2017 IEEE 28th Annual International Symposium on
Personal, Indoor, and Mobile Radio Communications (PIMRC) , 2017,
pp. 1–6.
[30] M. Arnold, J. Hoydis, and S. t. Brink, “Novel massive MIMO channel
sounding data applied to deep learning-based indoor positioning,” in
SCC 2019; 12th International ITG Conference on Systems, Communi-
cations and Coding , 2019, pp. 1–6.
[31] J. Vieira, E. Leitinger, M. Sarajlic, X. Li, and F. Tufvesson, “Deep
convolutional neural networks for massive MIMO fingerprint-based
positioning,” in 2017 IEEE 28th Annual International Symposium on
Personal, Indoor, and Mobile Radio Communications (PIMRC) , 2017,
pp. 1–6.
[32] X. Sun, C. Wu, X. Gao, and G. Y . Li, “Deep convolutional neural
networks enabled fingerprint localization for massive MIMO-OFDM
system,” in 2019 IEEE Global Communications Conference (GLOBE-
COM) , 2019, pp. 1–6.
[33] C. Wu, X. Yi, W. Wang, Q. Huang, and X. Gao, “3D CNN-enabled
positioning in 3D massive MIMO-OFDM systems,” in ICC 2020 - 2020
IEEE International Conference on Communications (ICC) , 2020, pp.
1–6.
[34] Z. Chen, Z. Zhang, Z. Xiao, Z. Yang, and K.-K. Wong, “Viewing
channel as sequence rather than image: A 2-D Seq2Seq approach for
efficient MIMO-OFDM CSI feedback,” IEEE Transactions on Wireless
Communications , vol. 22, no. 11, pp. 7393–7407, 2023.
[35] G. Liang and H. Bertoni, “A new approach to 3-D ray tracing for
propagation prediction in cities,” IEEE Transactions on Antennas and
Propagation , vol. 46, no. 6, pp. 853–863, 1998.
[36] K. Schuler, D. Becker, and W. Wiesbeck, “Extraction of virtual scattering
centers of vehicles by ray-tracing simulations,” IEEE Transactions on
Antennas and Propagation , vol. 56, no. 11, pp. 3543–3551, 2008.
[37] M. Lawton and J. McGeehan, “The application of a deterministic ray
launching algorithm for the prediction of radio channel characteristics in
small-cell environments,” IEEE Transactions on Vehicular Technology ,
vol. 43, no. 4, pp. 955–969, 1994.
[38] D. He, B. Ai, K. Guan, L. Wang, Z. Zhong, and T. K ¨urner, “The
design and applications of high-performance ray-tracing simulation
platform for 5G and beyond wireless communications: A tutorial,” IEEE
Communications Surveys and Tutorials , vol. 21, no. 1, pp. 10–27, 2019.
[39] H. Li, Y . Li, and S. Zhou, “Static CSI extraction and application in the
tomographic channel model,” China Communications , vol. 16, no. 12,
pp. 132–144, 2019.
[40] W.-S. Son and D. S. Han, “Analysis on the channel prediction accuracy
of deep learning-based approach,” in 2021 International Conference
on Artificial Intelligence in Information and Communication (ICAIIC) ,
2021, pp. 140–143.
[41] T. Peng, R. Zhang, X. Cheng, and L. Yang, “LSTM-based channel
prediction for secure massive MIMO communications under imperfect
CSI,” in ICC 2020 - 2020 IEEE International Conference on Commu-
nications (ICC) , 2020, pp. 1–6.
[42] D. Madhubabu and A. Thakre, “Long-short term memory based channel
prediction for SISO system,” in 2019 International Conference on
Communication and Electronics Systems (ICCES) , 2019, pp. 1–5.
[43] A. Alkhateeb, S. Alex, P. Varkey, Y . Li, Q. Qu, and D. Tujkovic, “Deep
learning coordinated beamforming for highly-mobile millimeter wave
systems,” IEEE Access , vol. 6, pp. 37 328–37 348, 2018.
[44] M. Alrabeiah and A. Alkhateeb, “Deep learning for TDD and FDD
massive MIMO: Mapping channels in space and frequency,” in 2019
53rd Asilomar Conference on Signals, Systems, and Computers , 2019,
pp. 1465–1470.
[45] X. Li, A. Alkhateeb, and C. Tepedelenlio ˘glu, “Generative adversarial
estimation of channel covariance in vehicular millimeter wave systems,”14
in2018 52nd Asilomar Conference on Signals, Systems, and Computers ,
2018, pp. 1572–1576.
Zhuoran Xiao (Student Member, IEEE) received
the B.S. degree in information engineering from
Huazhong University of Science and Technology,
Wuhan, China, in 2018, and the Ph.D. degree in
information and communication engineering from
Zhejiang University, Hangzhou, China in 2023, un-
der the supervision of Prof. Zhaoyang Zhang. He is
currently the Research Scientist with the Nokia Bell
Labs China. His current research interests include
AI/ML for next-gen communication and massive
MIMO.
Zhaoyang Zhang (Senior Member, IEEE) re-
ceived his Ph.D. degree from Zhejiang Univer-
sity, Hangzhou, China, in 1998, where he is cur-
rently a Qiushi Distinguished Professor. His research
interests are mainly focused on the fundamental
aspects of wireless communications and network-
ing, such as information theory and coding the-
ory, networked signal processing and distributed
learning, AI-empowered communications and net-
working, and integrated communication, sensing and
computing, etc. He has co-authored more than 400
peer-reviewed international journal and conference papers, including 8 con-
ference best papers from IEEE ICC 2019 and IEEE Globecom 2020, etc.
He was awarded the National Natural Science Fund for Distinguished Young
Scholars by NSFC in 2017, and was a co-recipient of the First Grade State-
level Teaching Award for Graduate Education in 2023.
Dr. Zhang is serving or has served as Editor for IEEE T RANSACTIONS
ONWIRELESS COMMUNICATIONS and IEEE T RANSACTIONS ON COMMU -
NICATIONS , etc., as Lead Guest Editor for IEEE W IRELESS COMMUNICA -
TIONS Special Issue on Sustainable Big AI Model for Wireless Networks,
and as General Chair, TPC Co-Chair or Symposium Co-Chair for WCSP
2023/2018/2013, PIMRC 2021 Workshop on Native AI Empowered Wireless
Networks, VTC-Spring 2017 Workshop on HMWC, Globecom 2014 Wireless
Communications Symposium, etc. He was also a keynote speaker for IEEE
Globecom 2021 Workshop on Native-AI Wireless, APCC 2018 and VTC-Fall
2017 Workshop on NOMA, etc.
Zirui Chen (Student Member, IEEE) received the
B.S.Eng. degree in information engineering from
Zhejiang University, Hangzhou, China, in 2021. He
is currently pursuing the Ph.D. degree in informa-
tion and communication engineering with Zhejiang
University under the supervision of Prof. Zhaoyang
Zhang. His current research interests include AI-
empowered communications and massive MIMO.
Zhaohui Yang (Member, IEEE) received the Ph.D.
degree from Southeast University, Nanjing, China, in
2018. From 2018 to 2020, he was a Post-Doctoral
Research Associate at the Center for Telecommuni-
cations Research, Department of Informatics, King’s
College London, U.K. From 2020 to 2022, he was a
Research Fellow at the Department of Electronic and
Electrical Engineering, University College London,
U.K. He is currently a ZJU Young Professor with
the Zhejiang Key Laboratory of Information Pro-
cessing Communication and Networking, College of
Information Science and Electronic Engineering, Zhejiang University, and
also a Research Scientist with Zhejiang Laboratory. His research interests
include joint communication, sensing, and computation, federated learning,
and semantic communication. He received the 2023 IEEE Marconi Prize Paper
Award, 2023 IEEE Katherine Johnson Young Author Paper Award, 2023 IEEE
ICCCN best paper award, and the first prize in Invention and Entrepreneurship
Award of the China Association of Inventions. He was the Co-Chair for
international workshops with more than ten times including IEEE ICC, IEEE
GLOBECOM, IEEE WCNC, IEEE PIMRC, and IEEE INFOCOM. He is an
Associate Editor for the IEEE Communications Letters, IET Communications,
and EURASIP Journal on Wireless Communications and Networking. He
has served as a Guest Editor for several journals including IEEE Journal
on Selected Areas in Communications.
Chongwen Huang (Member, IEEE) obtained his
B. Sc. degree in 2010 from Nankai University, and
the M.Sc degree from the University of Electronic
Science and Technology of China in 2013, and PhD
degree from Singapore University of Technology
and Design (SUTD) in 2019. From Oct. 2019 to
Sep. 2020, he is a Postdoc in SUTD. Since Sep.
2020, he joined into Zhejiang University as a tenure-
track young professor. Dr. Huang is the recipient
of 2021 IEEE Marconi Prize Paper Award, 2023
IEEE Fred W. Ellersick Prize Paper Award and
2021 IEEE ComSoc Asia-Pacific Outstanding Young Researcher Award. He
has served as an Editor of IEEE Communications Letter, Elsevier Signal
Processing, EURASIP Journal on Wireless Communications and Networking
and Physical Communication since 2021. His main research interests are
focused on Holographic MIMO Surface/Reconfigurable Intelligent Surface,
B5G/6G Wireless Communications, mmWave/THz Communications, Deep
Learning technologies for Wireless communications, etc.
Xiaoming Chen (Senior Member, IEEE) received
the B.Sc. degree from Hohai University in 2005, the
M.Sc. degree from Nanjing University of Science
and Technology in 2007 and the Ph. D. degree
from Zhejiang University in 2011, all in electronic
engineering. He is currently a Professor with the
College of Information Science and Electronic En-
gineering, Zhejiang University, Hangzhou, China.
From March 2011 to October 2016, He was with
Nanjing University of Aeronautics and Astronautics,
Nanjing, China. From February 2015 to June 2016,
he was a Humboldt Research Fellow at the Institute for Digital Communi-
cations, Friedrich-Alexander-University Erlangen-N ¨urnberg (FAU), Germany.
His research interests mainly focus on LEO satellite constellation, Internet of
Things, and smart communications.
Dr. Chen served as an Editor for the IEEE T RANSACTIONS ON COMMUNI -
CATIONS and the IEEE C OMMUNICATIONS LETTERS , and a Guest Editor for
the IEEE J OURNAL ON SELECTED AREAS IN COMMUNICATIONS “Massive
Access for 5G and Beyond” and the IEEE W IRELESS COMMUNICATIONS
“Massive Machine-Type Communications for IoT”. He received the Best
Paper Awards at the IEEE Global Communications Conference (GLOBE-
COM) 2020, the International Conference on Wireless Communications and
Signal Processing (WCSP) 2020, the IEEE International Conference on
Communications (ICC) 2019, and the IEEE/CIC International Conference on
Communications in China (ICCC) 2018.