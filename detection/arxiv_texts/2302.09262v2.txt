OPTIMAL ERROR BOUNDS ON THE EXPONENTIAL WAVE
INTEGRATOR FOR THE NONLINEAR SCHR ¨ODINGER EQUATION
WITH LOW REGULARITY POTENTIAL AND NONLINEARITY∗
WEIZHU BAO†AND CHUSHAN WANG‡
Abstract. We establish optimal error bounds for the exponential wave integrator (EWI) applied
to the nonlinear Schr¨ odinger equation (NLSE) with L∞-potential and/or locally Lipschitz nonlin-
earity under the assumption of H2-solution of the NLSE. For the semi-discretization in time by the
first-order Gautschi-type EWI, we prove an optimal L2-error bound at O(τ) with τ >0 being the
time step size, together with a uniform H2-bound of the numerical solution. For the full-discretization
scheme obtained by using the Fourier spectral method in space, we prove an optimal L2-error bound
atO(τ+h2) without any coupling condition between τandh, where h > 0 is the mesh size. In
addition, for W1,4-potential and a little stronger regularity of the nonlinearity, under the assumption
ofH3-solution, we obtain an optimal H1-error bound. Furthermore, when the potential is of low
regularity but the nonlinearity is sufficiently smooth, we propose an extended Fourier pseudospectral
method which has the same error bound as the Fourier spectral method while its computational cost
is similar to the standard Fourier pseudospectral method. Our new error bounds greatly improve the
existing results for the NLSE with low regularity potential and/or nonlinearity. Extensive numerical
results are reported to confirm our error estimates and to demonstrate that they are sharp.
Key words. nonlinear Schr¨ odinger equation, exponential integrator, semi-smooth nonlinearity,
bounded potential, error estimate, Fourier spectral method, extended Fourier pseudospectral method
MSC codes. 35Q55, 65M15, 65M70, 81Q05
1. Introduction. In this paper, we consider the following nonlinear Schr¨ odinger
equation (NLSE)
(1.1)(
i∂tψ(x, t) =−∆ψ(x, t) +V(x)ψ(x, t) +f(|ψ(x, t)|2)ψ(x, t),x∈Ω, t > 0,
ψ(x,0) = ψ0(x),x∈Ω,
where tis time, x= (x1,···, xd)T∈Rd(d= 1,2,3) is the spatial coordinate, ψ=
ψ(x, t) is a complex-valued wave function, and Ω = Πd
i=1(ai, bi)⊂Rdis a bounded
domain equipped with periodic boundary condition. Here, V=V(x) : Ω →Ris
a real-valued potential and f=f(ρ) : [0 ,∞)→Rwith ρ=|ψ|2being the density
describes the nonlinear interaction. We assume that V∈L∞(Ω) and f(|z|2)z:C→C
is locally Lipschitz continuous, and thus both Vandfmay be of low regularity.
When V(x) =|x|2/2 and f(ρ) =ρ, the NLSE (1.1) collapses to the nonlinear
Schr¨ odinger equation with harmonic potential and cubic nonlinearity (or smooth po-
tential and nonlinearity) or the Gross-Pitaevskii equation (GPE), which has been
widely adopted for modeling and simulation in quantum mechanics, nonlinear op-
tics and Bose-Einstein condensation (BEC) [8, 28, 51]. For the smooth NLSE with
sufficiently smooth initial data ψ0, many accurate and efficient numerical methods
have been proposed and analyzed in last two decades, including the finite difference
method [1, 9, 8, 6], the exponential wave integrator [10, 33, 25], the time-splitting
∗Submitted to the editors DATE.
Funding: This research is supported by the Ministry of Education, Singapore, under its Aca-
demic Research Fund MOE-T2EP20122-0002 (A-8000962-00-00).
†Department of Mathematics, National University of Singapore, Singapore 119076 (mat-
baowz@nus.edu.sg, https://blog.nus.edu.sg/matbwz/).
‡Department of Mathematics, National University of Singapore, Singapore 119076
(e0546091@u.nus.edu).
1arXiv:2302.09262v2  [math.NA]  26 Aug 20232 W. BAO, AND C. WANG
method [16, 20, 39, 27, 8, 6, 11], the finite element method [2, 49, 52, 53, 32],
etc. Recently, many works are done to analyze and design numerical methods for
the cubic NLSE with low regularity initial data ψ0and with/without potential (see
[27, 40, 42, 37, 41, 47, 44, 43, 5, 4] and references therein for other dispersive partial
differential equations).
Arising from different physics applications, both Vandfin (1.1) may be of
low regularity. Typical examples of the low regularity L∞-potential include, in many
physical contexts, the square-well potential or step potential, which are discontinuous;
in the study of BEC in different trapping shape, the power law potential V(x) =
|x|γ(γ >0) [46, 19], and in the analysis of Josephson effect and Anderson localization,
some disorder potential [54, 48]. Low regularity nonlinearity such as f(ρ) =ρσ(σ >0)
orf(ρ) =ρlnρare considered in, e.g., the Schr¨ odinger-Poisson-X αmodel [17, 21],
the Lee-Huang-Yang correction [38] which is adopted to model and simulate quantum
droplets [35, 22, 7, 45], and the mean-field model for Bose-Fermi mixture [31, 23].
Most numerical methods for the cubic NLSE with smooth potential can be ex-
tended straightforwardly to solve the NLSE (1.1) with L∞-potential and/or locally
Lipschitz nonlinearity (different from the singular nonlinearity in [12, 13, 14, 15]).
However, the performance of these methods are quite different from the smooth case
and the error analysis of them is a very subtle and challenging question. For (1.1) with
power-type nonlinearity f(ρ) =ρσand sufficiently smooth potential, the Lie-Trotter
time-splitting method is analyzed in [18, 26, 34] with reduced convergence order in
L2-norm when σ < 1/2 and in H1-norm when σ < 1. The analysis of (1.1) with
smooth nonlinearity and L∞-potential seems more challenging and the only known
convergence result is the one obtained in [32] for the Crank-Nicolson Galerkin scheme,
where first order convergence in time and less than second order convergence in space
inL2-norm are shown under strong assumptions on the exact solution (among others
∂tψ∈H2), and a coupling condition between the time step size τand the mesh size
h. Some low regularity integrators or resonance-based Fourier integrators are also
proposed to reduce the regularity requirements on both Vandψ, while the regularity
assumption on Vis still stronger than H1[55, 4, 3], which still excludes the popular
well potential and step potential widely adopted in physics literatures. The main dif-
ficulty comes from the low regularity of solution of the NLSE with L∞-potential and
locally Lipschitz nonlinearity, where only H2well-posedness is guaranteed [36, 24],
and the low regularity of the potential and the nonlinearity which causes order reduc-
tion in local truncation errors and prevent us from obtaining stability estimates in
high order Sobolev spaces Hα(α > d/ 2) (see [18, 55, 32] for more detailed discussion).
Besides, for the NLSE (1.1) with purely L∞-potential, how to estimate the spatial
discretization is also a challenging problem and it turns out that it is very subtle and
challenging to estimate the classical methods including the finite difference method,
the pseudospectral method and the finite element method [32].
The main aim of this paper is to establish optimal error bounds for a first or-
der Gautschi-type exponential wave integrator (EWI), also known as the exponential
Euler scheme in the literature [33], applied to the NLSE with L∞-potential and/or
locally Lipschitz nonlinearity. Our main results are as follows:
(i) For the semi-discretization in time (EWI (2.2)), we prove an optimal L2-error
bound at O(τ) with τ >0 being the time step size, and a uniform H2-bound of
the numerical solution, under the assumption of H2-solution of the NLSE (see
(3.2) in Theorem 3.1).
(ii) For the full discretization of the EWI by using the Fourier spectral method for
spatial derivatives (EWI-FS (2.11)), we prove an optimal L2-error bound atERROR ESTIMATES OF EWI FOR NLSE 3
O(τ+h2) without any coupling condition between τand the mesh size h(see
(4.1) in Theorem 4.1).
(iii) For W1,4-potential and a little more regular nonlinearity, under the assump-
tion of H3-solution, we obtain optimal H1-error bounds for EWI and EWI-FS
schemes. (see (3.3) in Theorem 3.1 and (4.2) in Theorem 4.1).
(iv) When the potential is of low regularity but the nonlinearity is sufficiently
smooth, we propose an extended Fourier pseudospectral method for spatial dis-
cretization of the EWI, leading to EWI-EFP scheme (2.13). For the EWI-EFP,
we establish optimal error bounds in L2- and H1-norm under the same assump-
tion on the potential and exact solution as the EWI-FS (see Corollary 4.4).
However, the computational cost of EWI-EFP is similar to the standard Fourier
pseudospectral discretization of the EWI.
Our error bounds greatly improve the previous results for the NLSE with low
regularity potential and/or nonlinearity. In general, compared with the error estimates
of classical exponential wave integrators [4] and time-splitting methods [18] in the
literature, to obtain optimal error bounds, we reduce the differentiability requirement
on the potential by two orders and on the nonlinearity by one order. Moreover, when
V∈L∞andfis smooth as considered in [32], compared with their results for the
Crank-Nicolson Galerkin scheme, we improve the convergence order in L2-norm to the
optimal first order in time and the optimal second order in space, remove the coupling
condition requirement between τandhin [32], relax the regularity assumption on the
exact solution such that it is theoretically guaranteed, and reduce the computational
cost in practical implementation.
Here, we briefly explain why we can obtain the improved error bounds. In general,
time-splitting methods and EWIs require weaker regularity on the exact solution to
obtain the same order of convergence, compared with finite difference methods. In
practical computation, time-splitting methods tend to outperform EWIs when the
solution is smooth, which requires the potential and nonlinearity as well as the ini-
tial data are all smooth. The main reason is that time-splitting methods are usually
structure-preserving scheme, i.e. they preserve mass conservation, time symmetry,
time-transverse invariance, and dispersion relation at the discretized level [6, 8]. On
the contrary, when the NLSE (1.1) involves low regularity potential and/or nonlinear-
ity, leading to a solution with low regularity, we find that the first-order Gautschi-type
EWI offers two major advantages in obtaining optimal error bounds: (i) in obtaining
local truncation errors, time-splitting methods need to apply the Laplacian ∆ to the
equation while the EWI only needs to apply ∂tto the equation, and thus the EWI
needs weaker regularity requirement on both potential and nonlinearity; and (ii) a
smoothing operator is adopted in the EWI scheme to control the dispersion of high
frequencies and thus it helps to keep the numerical solution in H2at each time step,
which makes it possible to obtain the stability estimates in high order Sobolev spa-
ces, while it is a challenging and subtle task to establish H2-bounds of the numerical
solution by using the time-splitting methods.
The rest of the paper is organized as follows. In Section 2, we present a semi-
discretization in time by the first-order Gautschi-type EWI and then a full discretiza-
tion in space by the Fourier spectral/extended pseudospectral methods. Sections 3
and 4 are devoted to the error estimates of the semi-discretization scheme and the
full-discretization scheme, respectively. Numerical results are reported in Section 5
to confirm the error estimates. Finally, some conclusions are drawn in Section 6.
Throughout the paper, we adopt the standard Sobolev spaces as well as their cor-
responding norms, and denote by Ca generic positive constant independent of the4 W. BAO, AND C. WANG
mesh size hand time step size τ, and by C(α) a generic positive constant depending
only on the parameter α. The notation A≲Bis used to represent that there exists
a generic constant C >0, such that |A| ≤CB.
2. The exponential wave integrator Fourier spectral method. In this
secton, we introduce an exponential wave integrator and its spatial discretization to
solve the NLSE with low regularity potential and nonlinearity. For simplicity of the
presentation and to avoid heavy notations, we only carry out the analysis in 1D and
take Ω = ( a, b). The only dimension sensitive estimates are the Sobolev embedding
intoL∞and the inverse inequalities to control L∞-norm by L2-norm. In our analysis,
we only use the embedding H2(Ω),→L∞(Ω) which holds for 1D, 2D and 3D, and
for the inverse inequalities, we clearly show how it depends on the space dimension.
Thus, generalizations to 2D and 3D are straightforward, and the main results remain
unchanged.
We define periodic Sobolev spaces as (see, e.g. [29] for the equivalent definition)
Hm
per(Ω) := {ϕ∈Hm(Ω) : ϕ(k)(a) =ϕ(k)(b), k= 0,···, m−1}, m≥1.
2.1. Semi-discretization in time by an exponential wave integrator.
Choose a time step size τ >0 and denote time steps as tn=nτforn= 0,1,···. By
Duhamel’s formula, the exact solution of the NLSE (1.1) is given as
ψ(tn+1) =ψ(tn+τ) =eiτ∆ψ(tn)
−iZτ
0ei(τ−s)∆
V ψ(tn+s) +f(|ψ(tn+s)|2)ψ(tn+s)
ds, n ≥0, (2.1)
where we abbreviate ψ(x, t) byψ(t) for simplicity of notations when there is no con-
fusion. Let ψ[n]:=ψ[n](x) be the approximation of ψ(x, tn) for n≥0. Applying
the approximation ψ(tn+s)≈ψ(tn) for the integrand in (2.1) and integrating out
ei(τ−s)∆exactly, we get a semi-discretization in time by the first-order Gautschi-type
EWI as
(2.2)ψ[n+1]= Φτ(ψ[n]) :=eiτ∆ψ[n]−iτφ1(iτ∆)
V ψ[n]+f(|ψ[n]|2)ψ[n]
, n≥0,
ψ[0]=ψ0,
where φ1is an entire function defined as
φ1(z) =ez−1
z, z ∈C.
The operator φ1(iτ∆) is defined through its action in the Fourier space as
(φ1(iτ∆)v) (x)=X
l∈Zφ1(−iτµ2
l)bvleiµl(x−a)
=bv0+X
l∈Z\{0}1−e−iτµ2
l
iτµ2
lbvleiµl(x−a), x∈Ω, (2.3)
where µl=2πl
b−aforl∈Z, andbvl(l∈Z) are the Fourier coefficients of the function
v∈L2(Ω) defined as
(2.4) bvl=1
b−aZb
av(x)e−iµl(x−a)dx, l∈Z.ERROR ESTIMATES OF EWI FOR NLSE 5
From (2.3), noting that |1−e−iθ| ≤2 for θ∈R, we see that
(2.5)\(φ1(iτ∆)v)l≤

2
τ|bvl|
µ2
l, l∈Z\ {0},
|bv0|, l = 0,
which implies φ1(iτ∆)v∈H2
per(Ω) for all v∈L2(Ω). Hence, Φτis indeed a flow in
H2
per(Ω) for any V∈L∞(Ω), making it possible to obtain uniform H2-bound of the
semi-discrete solution with some new analysis techniques we will introduce later.
In fact, the introduction of the smoothing function φ1(iτ∆) in (2.2) is one of
the major advantages of the EWI (2.2) over the time-splitting methods in terms
of controlling the dispersion of high frequencies or resonance. With this smoothing
function, one can show that the numerical solution is in H2at every time step. For
comparison, based on the results in [18] for time-splitting methods applied to the
NLSE with semi-sooth nonlinearity, the numerical solution of the semi-discretization
is not in H2in general! The situation is even worse if there is purely L∞-potential.
2.2. Full discretization by the Fourier spectral method. Then we further
discretize the semi-discretization (2.2) in space by the Fourier spectral method to
obtain a full-discretization scheme. Choose a mesh size h= (b−a)/Nwith Nbeing
a positive integer and denote grid points as
xj=a+jh, j = 0,1,···, N.
Define the index sets
TN=
−N
2,···,N
2−1
,T0
N={0,1,···, N},
and denote
XN= spann
eiµl(x−a):l∈ TNo
, (2.6)
YN=
v= (v0, v1,···, vN)T∈CN+1:v0=vN	
. (2.7)
LetPN:L2(Ω)→XNbe the standard L2-projection onto XNandIN:YN→XN
be the standard Fourier interpolation operator as
(PNu)(x) =X
l∈TNbuleiµl(x−a), (2.8)
(INv)(x) =X
l∈TNevleiµl(x−a), x∈Ω = [ a, b], (2.9)
where u∈L2(Ω),v∈YN,bul(l∈Z) are the Fourier coefficients of udefined in (2.4)
andevl(l∈ TN) are the discrete Fourier transform coefficients defined as
(2.10) evl=1
NN−1X
j=0vje−iµl(xj−a), l∈ TN.
Letψn:=ψn(x) be the approximation of ψ(x, tn) for n≥0. Then an exponential
wave integrator-Fourier spectral method (EWI-FS) for the NLSE (1.1) is given as
(2.11)ψn+1= Φτ
h(ψn) :=eiτ∆ψn−iτφ1(iτ∆)PN 
V ψn+f(|ψn|2)ψn
, n≥0,
ψ0=PNψ0.6 W. BAO, AND C. WANG
Note that ψn∈XNforn≥0 and we have
(2.12)\(ψn+1)l=e−iτµ2
l[(ψn)l−iτφ1(−iτµ2
l)
\(V ψn)l+\G(ψn)l
, n≥0,
d(ψ0)l=d(ψ0)l, l∈ TN,
where G(ψn)(x) =G(ψn(x)) := f(|ψn(x)|2)ψn(x) for x∈Ω. We remark here that
the EWI-FS is usually implemented by the Fourier pseudospectral method (see, e.g.,
[10, 29]) in practical computations. Of course, due to the low regularity of the potential
and/or nonlinearity, it is very hard to establish error bounds for the full-discretization
by the Fourier pseudospectral method.
2.3. Full discretization by an extended Fourier pseudospectral method.
In practice, the Fourier spectral method cannot be efficiently implemented. Here,
we propose an extended Fourier pseudospectral method when the potential is of low
regularity but the nonlinearity is sufficiently smooth, i.e., we adopt the Fourier spectral
method to discretize the linear potential and use the Fourier pseudospectral method
to discretize the nonlinearity. This full discretization has two advantages: (i) we can
establish its optimal error bounds, and (ii) the computational cost of this discretization
is similar to the standard Fourier pseudospectral method.
Letψ⟨n⟩
jbe the numerical approximation of ψ(xj, tn) for j∈ T0
Nandn≥0, and
denote ψ⟨n⟩:= (ψ⟨n⟩
0, ψ⟨n⟩
1,···, ψ⟨n⟩
N)T∈YN. Then an exponential wave integrator-
extended Fourier pseudospectral (EWI-EFP) method for the NLSE (1.1) reads
(2.13)ψ⟨n+1⟩
j =X
l∈TNe−iτµ2
l^(ψ⟨n⟩)leiµl(xj−a)
−iτX
l∈TNφ1(−iτµ2
l)
\ 
V INψ⟨n⟩
l+^G(ψ⟨n⟩)l
eiµl(xj−a), n≥0,
ψ⟨0⟩
j=ψ0(xj), j∈ T0
N,
where G(ψ⟨n⟩)j=f(|ψ⟨n⟩
j|2)ψ⟨n⟩
jforj∈ T0
N. To compute the Fourier projection
coefficients\ 
V INψ⟨n⟩
l, we use an extended FFT as shown below. Note that INψ⟨n⟩∈
XNfor all n≥0, and thus we have
(2.14) PN(V INψ⟨n⟩) =PN
P2N(V)INψ⟨n⟩
, n≥0.
Moreover, since P2N(V)INψ⟨n⟩∈X4NandI4Nis an identity on X4N, we have
P2N(V)INψ⟨n⟩=I4N
P2N(V)INψ⟨n⟩
, n≥0,
which plugged into (2.14) yields
(2.15) PN
V INψ⟨n⟩
=PNI4N
P2N(V)INψ⟨n⟩
, n≥0,
where P2N(V) can be precomputed numerically or analytically, and thus the right
hand side of (2.15) can be computed exactly and efficiently using the extended FFT:
using FFT for P2N(V)INψ⟨n⟩with length 4 Ninstead of N. As a result, the memoryERROR ESTIMATES OF EWI FOR NLSE 7
cost is O(4N) and the computational cost per time step is O(4Nlog(4N)). Note that
ψ⟨n⟩(n≥0) obtained by (2.13) satisfies
(2.16)INψ⟨n+1⟩=eiτ∆INψ⟨n⟩−iτφ1(iτ∆)
PN
V INψ⟨n⟩
+ING(ψ⟨n⟩)
,
INψ⟨0⟩=INψ0, n ≥0.
3. Optimal error bounds for the semi-discretization (2.2).In this section,
we establish optimal error bounds in L2-norm and H1-norm for the semi-discretization
(2.2) of the NLSE (1.1).
3.1. Main results. For the optimal L2-norm error bound, we assume that the
nonlinearity is locally Lipschitz continuous, i.e., there exists a fixed function CLip(·) :
R+→R+such that
(A)|f(|z1|2)z1−f(|z2|2)z2| ≤CLip(M0)|z1−z2|, z j∈C,|zj| ≤M0, j = 1,2.
Assumption (A) is satisfied by f∈C1((0,∞)) satisfying
|f(ρ)|+|ρf′(ρ)| ≤L(M0),0< ρ≤M0
with CLip(M0)∼L(M0) for M0>0. In particular, (A) allows
(i)f(ρ) =λ1ρσ1+λ2ρσ2for any 0 < σ1< σ2andλ1, λ2∈Rwith CLip(M0)∼
|λ1|Mσ1
0+|λ2|Mσ2
0;
(ii)f(ρ) = λρσlnρfor any σ > 0 and λ∈Rwith CLip(M0)∼1 +Mσ
0+
Mσ
0|lnM0|.
For the optimal H1-norm error bound, we assume
(B)∥f(|v|2)v−f(|w|2)w∥H1≤C(∥v∥H3,∥w∥H2)∥v−w∥H1, v∈H3(Ω), w∈H2(Ω).
Assumption (B) is satisfied by
(i)f(ρ) =λ1ρσ1+λ2ρσ2forσ2> σ1≥1/2 and λ1, λ2∈Rwith C(·,·) depending
on∥v∥H3and∥w∥H2;
(ii)f(ρ) =λρσlnρfor any σ >1/2 and λ∈Rwith C(·,·) depending on ∥v∥H3
and∥w∥H2.
We remark here that (B) implies (A) by taking v(x)≡z1andw(x)≡z2in (B).
Nonlinearity satisfying (B) occurs in physical applications including Lee-Huang-Yang
correction [38, 35, 22, 7, 45] and Bose-Fermi mixture [31, 23] in 1D, 2D and 3D, and
Schrodinger-Poisson-X αmodel [17, 21] in 2D. Assumption (A) covers, in addition to
all those mentioned before, the case of Schrodinger-Poisson-X αmodel in 3D.
LetTmaxbe the maximal existing time of the solution of the NLSE (1.1) and take
0< T < T maxbe a fixed time. Define
(3.1) M:= max
∥ψ∥L∞([0,T];H2),∥ψ∥L∞([0,T];L∞),∥∂tψ∥L∞([0,T];L2),∥V∥L∞	
.
Letψ[n]be the numerical approximation obtained by the EWI (2.2), then we have
Theorem 3.1.Under the assumptions that V∈L∞(Ω),fsatisfies Assumption
(A)and the exact solution ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)), there exists
τ0>0depending on MandTand sufficiently small such that for any 0< τ < τ 0,
we have ψ[n]∈H2
per(Ω)for0≤n≤T/τ and
(3.2)∥ψ(·, tn)−ψ[n]∥L2≲τ,∥ψ[n]∥H2≤C(M),
∥ψ(·, tn)−ψ[n]∥H1≲√τ, 0≤n≤T/τ.8 W. BAO, AND C. WANG
Moreover, if V∈W1,4(Ω)∩H1
per(Ω),fsatisfies (B)andψ∈C([0, T];H3
per(Ω))∩
C1([0, T];H1(Ω)), we have, for 0< τ < τ 0,
(3.3) ∥ψ(·, tn)−ψ[n]∥H1≲τ, 0≤n≤T/τ.
Remark 3.2. According to the known regularity results (see, e.g. Corollary 4.8.6
in [24]), under the assumptions that V∈L∞(Ω) and (A), it can be expected that
ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)) for some 0 < T < T maxifψ0∈H2
per(Ω).
Remark 3.3. Recall that, for the time-splitting methods analyzed in [18] with
f(ρ) =ρσ, the optimal L2-norm error bound in time is obtained for V∈H2(Ω) and
σ≥1/2, and the optimal H1-norm error bound in time is obtained for V∈H3(Ω)
andσ≥1. Hence, our results greatly relax the regularity requirements on both the
potential and nonlinearity.
In the following, we shall prove Theorem 3.1. We start with the proof of (3.2), and
the proof of (3.3) can be obtained by the standard Lady Windermere’s fan argument
with the established uniform H2-bound of the semi-discretization solution in (3.2).
In the rest of this section, we assume that V∈L∞(Ω), fsatisfies Assumption
(A) and ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)).
3.2. Local truncation error. We define an operator B:L∞(Ω)→L∞(Ω) as
(3.4) B(v) =V v+f(|v|2)v, v ∈L∞(Ω).
and define a constant CL(·) :=∥V∥L∞+CLip(·) with CLip(·) given by Assumption
(A). For the operator B, we have
Lemma 3.4.Letv, w∈L∞(Ω)satisfying ∥v∥L∞≤M0and∥w∥L∞≤M0, then
(3.5) ∥B(v)−B(w)∥L2≤CL(M0)∥v−w∥L2.
Proof. Recalling (3.4) and (A), we have
∥B(v)−B(w)∥L2=∥V(v−w) +f(|v|2)v−f(|w|2)w∥L2
≤ ∥V∥L∞∥v−w∥L2+CLip(M0)∥v−w∥L2
=CL(M0)∥v−w∥L2,
which completes the proof.
Lemma 3.5.For0≤n≤T/τ−1, define
(3.6) gn(t) :=B(ψ(tn+t))−B(ψ(tn)), 0≤t≤τ.
Then gn∈C([0, τ];L2(Ω))∩W1,∞([0, τ];L2(Ω)) satisfies
∥gn∥L∞([0,τ];L2)≤CL(M)Mτ, (3.7)
∥∂tgn∥L∞([0,τ];L2)≤CL(M)M. (3.8)
Proof. Using Lemma 3.4, we have, for 0 ≤s < t≤τ,
∥gn(t)−gn(s)∥L2=∥B(ψ(tn+t))−B(ψ(tn+s))∥L2
≤CL(M)∥ψ(tn+t)−ψ(tn+s)∥L2
≤CL(M)Zt
s∥∂tψ(tn+σ)∥L2dσ. (3.9)ERROR ESTIMATES OF EWI FOR NLSE 9
From (3.9), recalling (A), one has gn∈C([0, τ];L2(Ω)), and, by using Lemma 3.4
again, one has
∥gn(t)∥L2=∥B(ψ(tn+t))−B(ψ(tn))∥L2≤CL(M)∥ψ(tn+t)−ψ(tn)∥L2
≤τCL(M)∥∂tψ∥L∞([tn,tn+τ];L2)≤CL(M)Mτ,
which proves (3.7). Noting (3.9), from the standard theory of Sobolev spaces (see,
e.g., Proposition 1.3.12 in [24]), we have gn∈W1,∞([0, T];L2(Ω)) and, by letting
φ(σ) =CL(M)∥∂tψ(tn+σ)∥L2for 0≤σ≤τ,
∥∂tgn∥L∞([0,τ];L2)≤ ∥φ∥L∞([0,τ])≤CL(M)M,
which concludes the proof.
Similar to Lemma 4.8.5 in [24], we have
Lemma 3.6.Assume τ >0andg∈C([0, τ];L2(Ω))∩W1,1([0, τ];L2(Ω)). If
(3.10) w(t) =−iZt
0ei(t−s)∆g(s)ds, t∈[0, τ],
then we have
(3.11) ∥∆w∥L∞([0,τ];L2)≤ ∥g∥L∞([0,τ];L2)+∥g(0)∥L2+∥∂tg∥L1([0,τ];L2).
Proof. Taking the time derivative on both sides of (3.10) and noting that g∈
W1,1([0, τ];L2(Ω)), we have for 0 ≤t≤τ
∂tw(t) =−id
dtZt
0eis∆g(t−s)ds=−ieit∆g(0)−iZt
0eis∆∂tg(t−s)ds
=−ieit∆g(0)−iZt
0ei(t−s)∆∂tg(s)ds. (3.12)
From (3.12), using the isometry property of eit∆, we have
(3.13) ∥∂tw(t)∥L2≤ ∥g(0)∥L2+∥∂tg∥L1([0,τ];L2),0≤t≤τ.
Note that wdefined in (3.10) satisfies the equation
i∂tw=−∆w+g,0≤t≤τ,
which implies, by using (3.13),
(3.14) ∥∆w(t)∥L2≤ ∥∂tw(t)∥L2+∥g(t)∥L2≤ ∥g(0)∥L2+∥∂tg∥L1([0,τ];L2)+∥g(t)∥L2,
and the conclusion follows from taking supremum of ton both sides.
Now we can obtain the following local truncation error estimates.
Proposition 3.7 (local truncation error). For0≤n≤T/τ−1, we have
(3.15) ∥ψ(tn+1)−Φτ(ψ(tn))∥Hα≤C(M)τ2−α/2,0≤α≤2,
where C(M)∼CL(M)M.10 W. BAO, AND C. WANG
Proof. Recalling (2.1) and (3.4), we have
(3.16) ψ(tn+1) =eiτ∆ψ(tn)−iZτ
0ei(τ−s)∆B(ψ(tn+s))ds,0≤n≤T/τ−1.
By the construction of the EWI (2.2) and (3.4), we have
(3.17) Φτ(ψ(tn)) =eiτ∆ψ(tn)−iZτ
0ei(τ−s)∆B(ψ(tn))ds,0≤n≤T/τ−1.
Subtracting (3.17) from (3.16) and recalling (3.6), we have
ψ(tn+1)−Φτ(ψ(tn))=−iZτ
0ei(τ−s)∆(B(ψ(tn+s))−B(ψ(tn)))ds
=−iZτ
0ei(τ−s)∆gn(s)ds,0≤n≤T/τ−1. (3.18)
From (3.18), using (3.7), one gets
(3.19) ∥ψ(tn+1)−Φτ(ψ(tn))∥L2≤Zτ
0∥gn(s)∥L2ds≤CL(M)Mτ2,
which proves (3.15) for α= 0. Then we shall establish (3.15) with α= 2, and (3.15)
with 0 < α < 2 will follow from the Gagliardo-Nirenberg interpolation inequalities.
Applying Lemma 3.6 to (3.18), using (3.8) and noting gn(0) = 0, we have
∥∆(ψ(tn+1)−Φτ(ψ(tn)))∥L2
≤ ∥gn∥L∞([0,τ];L2)+∥gn(0)∥L2+∥∂tgn∥L1([0,τ];L2)
≤CL(M)Mτ+τ∥∂tgn∥L∞([0,τ];L2)≤2CL(M)Mτ, (3.20)
which combined with (3.19) implies
(3.21) ∥ψ(tn+1)−Φτ(ψ(tn))∥H2≤C(M)τ,0≤n≤T/τ−1,
where C(M)∼CL(M)M. The conclusion follows from (3.19) and (3.21) and the
Gagliardo-Nirenberg interpolation inequalities.
Remark 3.8. In (3.19), the optimal local truncation error in L2-norm is obtained
with the boundedness of ∥∂tB(ψ(t))∥L2(recalling Lemma 3.5) instead of ∥∆B(ψ(t))∥L2
in the time-splitting methods [18].
3.3. L∞-conditional stability estimate of (2.2).Then we shall establish the
L∞-conditional stability estimate of the numerical flow (2.2). The key is the following
lemma, which can be understood as the smoothing effect of the operator φ1(iτ∆),
which is another major advantage of the EWI (2.2).
Lemma 3.9.Letv, w∈L2(Ω)and0< τ < 1. Then we have
∥φ1(iτ∆)v−φ1(iτ∆)w∥Hα≤C(α)τ−α/2∥v−w∥L2,0≤α≤2,
where C(α) = 2α
2(1 +µ−2
1)α
2.
Proof. It suffices to show that for any v∈L2(Ω),
(3.22) ∥φ1(iτ∆)v∥Hα≤C(α)τ−α/2∥v∥L2,0≤α≤2.ERROR ESTIMATES OF EWI FOR NLSE 11
Note that
(3.23) |eiθ−1| ≤2γθ1−γ, θ∈R,0≤γ≤1.
By Parseval’s identity, using (3.23) with γ=α/2 and recalling (2.3), we have
1
b−a∥φ1(iτ∆)v∥2
Hα=X
l∈Z(1 +µ2
l)α|φ1(−iτµ2
l)|2|bvl|2
=|bv0|2+X
l∈Z\{0}(1 +µ2
l)αeiτµ2
l−1
τµ2
l2
|bvl|2
≤ |bv0|2+ 2αX
l∈Z\{0}(1 +µ2
l)α 
τµ2
l−α|bvl|2
=|bv0|2+ 2ατ−αX
l∈Z\{0}1 +µ2
l
µ2
lα
|bvl|2
≤ |bv0|2+C(α)2τ−αX
l∈Z\{0}|bvl|2
≤C(α)2τ−αX
l∈Z|bvl|2=C(α)2τ−α1
b−a∥v∥2
L2,
which proves (3.22) and concludes the proof.
With Lemma 3.9, we are able to obtain the stability estimate of the numerical
flow (2.2) up to H2without additional regularity on the potential and nonlinearity.
Proposition 3.10 (stability estimate). Letv, w∈H2
per(Ω)such that ∥v∥L∞≤
M0and∥w∥L∞≤M0and let 0< τ < 1. Then we have, for 0≤α≤2,
∥Φτ(v)−Φτ(w)∥Hα≤ ∥v−w∥Hα+C(M0)τ1−α/2∥v−w∥L2.
Proof. Recalling (2.2) and (3.4), we have
(3.24) Φτ(u) =eiτ∆u−iτφ1(iτ∆)B(u), u ∈H2
per(Ω).
Taking u=vandu=win (3.24), subtracting one from the other and using the
isometry property of eit∆, Lemma 3.9 and Lemma 3.4, we have
∥Φτ(v)−Φτ(w)∥Hα≤ ∥eiτ∆v−eiτ∆w∥Hα+τ∥φ1(iτ∆)(B(v)−B(w))∥Hα
≤ ∥v−w∥Hα+C(α)τ1−α/2∥B(v)−B(w)∥L2
≤ ∥v−w∥Hα+C(α)τ1−α/2CL(M0)∥v−w∥L2.
The conclusion follows from letting C(M0) =C(α)CL(M0) with α= 2.
3.4. Proof of the optimal L2-error bound (3.2). With the local trunca-
tion error estimate in Proposition 3.7 and the L∞-conditional stability estimate in
Proposition 3.10, we can prove (3.2) by mathematical induction.
Proof of (3.2) in Theorem 3.1.Define the error function e[n]:=ψ(tn)−ψ[n]for
0≤n≤T/τ. For 0 ≤n≤T/τ−1 and 0 ≤α≤2, we have
∥e[n+1]∥Hα=∥ψ(tn+1)−ψ[n+1]∥Hα=∥ψ(tn+1)−Φτ(ψ[n])∥Hα
≤ ∥ψ(tn+1)−Φτ(ψ(tn))∥Hα+∥Φτ(ψ(tn))−Φτ(ψ[n])∥Hα. (3.25)12 W. BAO, AND C. WANG
In the following, we first establish the error bounds in L2-norm and H7
4-norm together
by the mathematical induction, which, in particular, yield the uniform L∞-bound of
ψ[n]. With the uniform L∞-bound, we can obtain the uniform H2-bound of ψ[n]. The
error bound in H1-norm will follow from the error bound in L2-norm and the uniform
H2-bound by using the standard interpolation inequalities.
LetC0:= max {C(1 + M), M,1} ≥ 1 with Mgiven in (3.1) and C(·) defined
in Proposition 3.10, and C1:=C(M) with C(·) defined in Proposition 3.7. Let
0< τ0<1 be chosen such that
(3.26) 2 C0TeC0TC1τ1
8
0≤1/c,
where cis the constant given by the Sobolev embedding H7
4,→L∞. We are going to
prove that when 0 < τ < τ 0, we have, for 0 ≤n≤T/τ,
(3.27) ∥e[n]∥L2≤eC0TC1τ,∥e[n]∥H7
4≤2C0TeC0TC1τ1
8.
We shall prove (3.27) by mathematical induction. When n= 0,e[n]=ψ[0]−ψ0= 0,
and (3.27) holds trivially. We assume that (3.27) holds for 0 ≤n≤m≤T/τ−1.
Under this assumption, we have, by Sobolev embedding, τ < τ 0and (3.26),
(3.28) ∥ψ[n]∥L∞≤ ∥ψ(tn)∥L∞+∥e[n]∥L∞≤M+c∥e[n]∥H7
4≤M+ 1,0≤n≤m.
Taking α= 0 and α= 7/4 in (3.25), we have for 0 ≤n≤T/τ−1,
∥e[n+1]∥L2≤ ∥ψ(tn+1)−Φτ(ψ(tn))∥L2+∥Φτ(ψ(tn))−Φτ(ψ[n])∥L2, (3.29)
∥e[n+1]∥H7
4≤ ∥ψ(tn+1)−Φτ(ψ(tn))∥H7
4+∥Φτ(ψ(tn))−Φτ(ψ[n])∥H7
4. (3.30)
Using Propositions 3.7 and 3.10 with α= 0 and α= 7/4 for (3.29) and (3.30),
respectively, and noting (3.28), we have for 0 ≤n≤m,
∥e[n+1]∥L2≤(1 +C0τ)∥e[n]∥L2+C1τ2, (3.31)
∥e[n+1]∥H7
4≤ ∥e[n]∥H7
4+C0τ1
8∥e[n]∥L2+C1τ1+1
8. (3.32)
From (3.31), using the standard discrete Gronwall’s inequality, we have
(3.33) ∥e[m+1]∥L2≤eC0TC1τ.
From (3.32), using the assumption that (3.27) holds for 0 ≤n≤m, we have
(3.34) ∥e[n+1]∥H7
4≤ ∥e[n]∥H7
4+C0τ1
8eC0TC1τ+C1τ1+1
8,0≤n≤m.
Summing over nfrom 0 to min (3.34), noting that e[0]= 0 and C0≥1, we obtain
∥e[m+1]∥H7
4≤C0τ1
8eC0TC1mτ+C1mτ1+1
8
≤C0TeC0TC1τ1
8+C1Tτ1
8
≤2C0TeC0TC1τ1
8. (3.35)
Combing (3.33) and (3.35), we prove (3.27) for n=m+1, and thus for all 0 ≤n≤T/τ
by mathematical induction.ERROR ESTIMATES OF EWI FOR NLSE 13
Then we prove the uniform H2bound of ψ[n]. We first note that (3.28) now holds
for any 0 ≤n≤T/τ. Taking α= 2 in (3.25), using Propositions 3.7 and 3.10 with
α= 2 and (3.27), we have for 0 ≤n≤T/τ−1,
∥e[n+1]∥H2≤ ∥Ψτ(ψ(tn))−Φτ(ψ(tn))∥H2+∥Φτ(ψ(tn))−Φτ(ψ[n])∥H2
≤ ∥e[n]∥H2+C0∥e[n]∥L2+C1τ
≤ ∥e[n]∥H2+C0eC0TC1τ+C1τ. (3.36)
Summing (3.36) from 0 to n−1, we obtain
(3.37) ∥e[n]∥H2≤C0eC0TC1nτ+C1nτ≤2C0eC0TC1T,0≤n≤T/τ.
Finally, combining (3.27) and (3.37), and using the interpolation inequality for
theH1-error bound, we prove (3.2).
3.5. Proof of the optimal H1-error bound (3.3). To prove (3.3), we assume
that V∈W1,4(Ω)∩H1
per(Ω), fsatisfies Assumption (B), ψ∈C([0, T];H3
per(Ω))∩
C1([0, T];H1(Ω)) and 0 < τ < τ 0with τ0given in (3.26). Under the assumptions
above, B:H1
per(Ω)→H1
per(Ω) satisfies
(3.38) ∥B(v)−B(w)∥H1≤C(∥v∥H3,∥w∥H2,∥V∥W1,4(Ω))∥v−w∥H1, v, w ∈H2(Ω).
Proof of (3.3) in Theorem 3.1.From (3.18), using (3.38) and the isometry prop-
erty of eit∆, and noting that ψ∈C1([0, T];H1(Ω)), we have, for 0 ≤n≤T/τ−1,
(3.39) ∥ψ(tn+1)−Φτ(ψ(tn))∥H1≤Zτ
0∥B(ψ(tn+s))−B(ψ(tn))∥H1ds≲τ2.
Noting that |φ1(iθ)| ≤1 for θ∈R, we have
(3.40) ∥φ1(iτ∆)v∥H1≤ ∥v∥H1, v∈H1
per(Ω),
which implies, by recalling (3.24) and using (3.38) again,
∥Φτ(ψ(tn))−Φτ(ψ[n])∥H1≤ ∥ψ(tn)−ψ[n]∥H1+τ∥B(ψ(tn))−B(ψ[n])∥H1
≤(1 +Cτ)∥ψ(tn)−ψ[n]∥H1,0≤n≤T/τ−1, (3.41)
where Cdepends on ∥V∥W1,4,∥ψ(tn)∥H3and∥ψ[n]∥H2, which are uniformly bounded.
Then (3.3) follows from (3.39) and (3.41) by the standard Lady Windermere’s fan
argument.
4. Optimal error bounds for the full discretization (2.11) .In this section,
we establish optimal error bounds in L2- and H1-norm for the full-discretization
scheme EWI-FS (2.11), and generalize them to the EWI-EFP scheme (2.13).
4.1. Main results. Forψn(0≤n≤T/τ) obtained by the EWI-FS scheme
(2.11), we have
Theorem 4.1.Assume that V∈L∞(Ω),fsatisfies Assumption (A)and the
exact solution ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)), there exists τ0>0and
h0>0depending on MandTand sufficiently small such that for any 0< τ < τ 0
and0< h < h 0, we have
(4.1)∥ψ(·, tn)−ψn∥L2≲τ+h2,∥ψn∥H2≤C(M),
∥ψ(·, tn)−ψn∥H1≲√τ+h, 0≤n≤T/τ.14 W. BAO, AND C. WANG
Moreover, if V∈W1,4(Ω)∩H1
per(Ω),fsatisfies (B)andψ∈C([0, T];H3
per(Ω))∩
C1([0, T];H1(Ω)), we have, for 0< τ < τ 0and0< h < h 0,
(4.2) ∥ψ(·, tn)−ψn∥L2≲τ+h3,∥ψ(·, tn)−ψn∥H1≲τ+h2, 0≤n≤T/τ.
Remark 4.2. Thanks to the strong H2-control of the semi-discretization solution
in (3.2), there is no coupling condition between τandhfor all 1 ≤d≤3 in Theo-
rem 4.1.
In the following, we shall prove Theorem 4.1. We use different methods to prove
(4.1) and (4.2). For the L2-norm error bound (4.1), we compare the full-discretization
solution ψnwith the semi-discretization solution ψ[n]to avoid the coupling condition
between τandhwhen using the inverse inequalities. Then, for the H1-norm error
bound (4.2), we can directly compare the full-discretization solution with the exact
solution since we already have control of the full-discretization solution in H2-norm.
In the rest of this section, we assume that V∈L∞(Ω), fsatisfies Assumption
(A) and ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)).
4.2. Proof of the optimal L2-error bound (4.1). We start with the error
estimates between the semi-discretization solution ψ[n]and the full-discretization so-
lution ψn.
Proposition 4.3.Let0< τ < τ 0with τ0given in Theorem 3.1. Then there
exists h0depending on MandTand small enough such that for 0< h < h 0, we have
∥PNψ[n]−ψn∥L2≤C(M, T )h2,0≤n≤T/τ.
Proof. Define the error function en:=PNψ[n]−ψnfor 0≤n≤T/τ. Then
e0=PNψ[0]−ψ0= 0. Applying PNon both sides of (2.2), noting that PNcommutes
with eiτ∆andφ1(iτ∆) and recalling (3.4), we have
(4.3) PNψ[n+1]=eiτ∆PNψ[n]−iτφ1(iτ∆)PNB(ψ[n]),0≤n≤T/τ−1.
Recalling (2.11) and (3.4), we have
(4.4) ψn+1=eiτ∆ψn−iτφ1(iτ∆)PNB(ψn),0≤n≤T/τ−1.
Subtracting (4.4) from (4.3), we have, for 0 ≤n≤T/τ−1,
(4.5) en+1=eiτ∆en−iτφ1(iτ∆)PN(B(ψ[n])−B(ψn)).
From (4.5), using the isometry property of eit∆, the L2-projection property of PN
and Lemma 3.9 with α= 0, we have, for 0 ≤n≤T/τ−1,
∥en+1∥L2≤ ∥en∥L2+τ∥φ1(iτ∆)PN((B(ψ[n])−B(ψn))∥L2
≤ ∥en∥L2+τ∥(B(ψ[n])−B(ψn)∥L2
≤ ∥en∥L2+τ∥(B(ψ[n])−B(PNψ[n])∥L2+τ∥(B(PNψ[n])−B(ψn)∥L2. (4.6)
By (3.2), using Sobolev embedding and the boundedness of PN, we have
(4.7) ∥PNψ[n]∥L∞≤˜c∥PNψ[n]∥H2≤˜c∥ψ[n]∥H2≤˜cC(M) =:M0,0≤n≤T/τ,
where ˜ cis given by the Sobolev embedding H2,→L∞. Similarly, ∥ψ[n]∥L∞≤M0.
From (4.6), noting (4.7), using Lemma 3.4, the uniform H2-bound in (3.2), and theERROR ESTIMATES OF EWI FOR NLSE 15
standard projection error estimate ∥ϕ−PNϕ∥L2≲h2|ϕ|H2∀ϕ∈H2
per(Ω), we have,
for 0≤n≤T/τ−1,
(4.8) ∥en+1∥L2≤ ∥en∥L2+CL(max{M0,∥ψn∥L∞})τ∥en∥L2+˜C1τh2,
where ˜C1depends exclusively on M. The conclusion then follows from the discrete
Gronwall’s inequality and the standard induction argument by using the inverse in-
equality [50]
(4.9) ∥ϕ∥L∞≤Cinvh−d
2∥ϕ∥L2, ϕ∈XN,
where dis the dimension of the space, i.e. d= 1 in the current case. For the
convenience of the reader, we present this process in the following.
Let˜C0:=CL(1 + M0) with CL(·) given in Lemma 3.4 and recall ˜C1given by
(4.8). Let 0 < h0<1 be chosen such that
(4.10) Cinve˜C0T˜C1h2−d/2
0≤1.
We shall show that, when 0 < h < h 0, for 0 ≤n≤T/τ,
(4.11) ∥en∥L2≤e˜C0T˜C1h2,∥ψn∥L∞≤1 +M0.
Recall that e0= 0, and by (4.7), ∥ψ0∥L∞=∥PNψ0∥L∞=∥PNψ[0]∥L∞≤M0. Then
(4.11) holds for n= 0. Assume that (4.11) holds for 0 ≤n≤m≤T/τ−1, which
implies, from (4.8),
(4.12) ∥en+1∥L2≤(1 + ˜C0τ)∥en∥L2+˜C1τh2,0≤n≤m,
which further implies, by using discrete Gronwall’s inequality,
(4.13) ∥em+1∥L2≤e˜C0T˜C1h2.
From (4.13), using (4.9), recalling (4.7) and (4.10), we have, by triangle inequality,
(4.14)∥ψm+1∥L∞≤ ∥em+1∥L∞+∥PNψ[m+1]∥L∞≤Cinvh2−d/2∥em+1∥L2+M0
≤Cinve˜C0T˜C1h2−d/2+M0≤1 +M0.
Combing (4.13) and (4.14) proves (4.11) for n=m+ 1, and thus for all 0 ≤n≤T/τ
by mathematical induction, which completes the proof.
Proof of (4.1) in Theorem 4.1.By triangle inequality, for 0 ≤α≤2,
(4.15) ∥ψ(tn)−ψn∥Hα≤ ∥ψ(tn)−ψ[n]∥Hα+∥ψ[n]−PNψ[n]∥Hα+∥PNψ[n]−ψn∥Hα.
From (3.2), using the interpolation inequalities, we have
(4.16) ∥ψ(tn)−ψ[n]∥Hα≲τ1−α/2,0≤α≤2.
From (4.15), using (4.16) and the standard Fourier projection error estimates
(4.17) ∥ϕ−PNϕ∥Hα≲h2−α|ϕ|H2,0≤α≤2, ϕ∈H2
per(Ω),
and noting (3.2), we have
(4.18) ∥ψ(tn)−ψn∥Hα≲τ1−α/2+h2−α+∥PNψ[n]−ψn∥Hα.
From (4.18), using the inverse estimate ∥ϕ∥Hα≲h−α∥ϕ∥L2∀ϕ∈XN[30, 50] and
Proposition 4.3, we have
(4.19) ∥ψn−ψ(tn)∥Hα≲τ1−α/2+h2−α+h−αh2≲τ1−α/2+h2−α,0≤α≤2,
which proves (4.1) by taking α= 0,1,2.16 W. BAO, AND C. WANG
4.3. Proof of the optimal H1-error bound (4.2).To prove (4.2), we assume
that V∈W1,4(Ω)∩H1
per(Ω), fsatisfies Assumption (B), ψ∈C([0, T];H3
per(Ω))∩
C1([0, T];H1(Ω)) and 0 < τ < τ 0, 0< h < h 0. Since we already have the uniform
control of ψninH2-norm, (4.2) can be proved similarly to (3.3), and we just sketch
the outline here.
Proof of (4.2) in Theorem 4.1.Recalling (2.11) and (3.16), we have
PNψ(tn+1)−Φτ
h(PNψ(tn))
=−iZτ
0ei(τ−s)∆PN(B(ψ(tn+s))−B(PNψ(tn))) ds,0≤n≤T
τ−1, (4.20)
which implies, by the property of eit∆andPN, forX=L2orH1, that
∥PNψ(tn+1)−Φτ
h(PNψ(tn))∥X
≤Zτ
0(∥B(ψ(tn+s))−B(ψ(tn))∥X+∥B(ψ(tn))−B(PNψ(tn))∥X) ds. (4.21)
From (4.21), using Lemma 3.4 and (3.38), we have, for 0 ≤n≤T/τ−1,
(4.22)∥PNψ(tn+1)−Φτ
h(PNψ(tn))∥L2≲τ2+τh3,
∥PNψ(tn+1)−Φτ
h(PNψ(tn))∥H1≲τ2+τh2.
Besides, recalling (2.11), using Lemmas 3.4 and 3.9, (3.22) and (3.38), we have
(4.23)∥Φτ
h(PNψ(tn))−Φτ
h(ψn)∥L2≤(1 +C1τ)∥PNψ(tn)−ψn∥L2,
∥Φτ
h(PNψ(tn))−Φτ
h(ψn)∥H1≤(1 +C2τ)∥PNψ(tn)−ψn∥H1,
where C1depends on ∥PNψ(tn)∥L∞and∥ψn∥L∞, and C2depends on ∥PNψ(tn)∥H3
and∥ψn∥H2for 0≤n≤T/τ−1. Thus, both C1andC2are under control. Then the
proof can be completed by the Lady Windermere’s fan argument and the standard
projection error estimates of PN.
4.4. Extension to the EWI-EFP (2.13). ForINψ⟨n⟩(0≤n≤T/τ) obtained
from the EWI-EFP scheme (2.13), it satisfies the same error bounds as ψn(0≤n≤
T/τ) in Theorem 4.1, under the same assumptions on potential and the exact solution,
but with a little more regular nonlineairty. To be precise, we introduce another
assumption on the nonlinearity as
(C) f(|v|2)v∈Hα
per(Ω),∀v∈Hα
per(Ω).
For the optimal L2-norm error bound, we assume that fsatisfies Assumptions
(A) and (C) with α= 2. Two typical examples of finclude (i) f(ρ) =λ1ρσ1+λ2ρσ2
with σ2> σ1≥1/2 and λ1, λ2∈R, and (ii) f(ρ) =λρσlnρwith σ >1/2 and λ∈R.
For the optimal H1-norm error bound, we assume, in addition to Assumption
(B),fsatisfies (C) with α= 3 and the discrete counterpart of Assumption (B)
(B’) ∥IN(f(|v|2)v−f(|w|2)w)∥H1≤C(∥v∥H3,∥w∥H2)∥v−w∥H1, v, w ∈XN,
with two typical examples of f: (i) f(ρ) =λ1ρσ1+λ2ρσ2with σ2> σ 1≥1 and
λ1, λ2∈R, and (ii) f(ρ) =λρσlnρwith σ > 1 and λ∈R(see, e.g., [18] for the
proof).
Then we have the following error bounds for the EWI-EFP scheme (2.13).ERROR ESTIMATES OF EWI FOR NLSE 17
Corollary 4.4.Assume that V∈L∞(Ω),fsatisfies Assumptions (A)and(C)
with α= 2and the exact solution ψ∈C([0, T];H2
per(Ω))∩C1([0, T];L2(Ω)). There
exists τ0>0andh0>0depending on MandTand sufficiently small such that for
any0< τ < τ 0and0< h < h 0, we have
(4.24)∥ψ(·, tn)−INψ⟨n⟩∥L2≲τ+h2,∥INψ⟨n⟩∥H2≤C(M),
∥ψ(·, tn)−INψ⟨n⟩∥H1≲√τ+h, 0≤n≤T/τ.
Moreover, if V∈W1,4(Ω)∩H1
per(Ω),fsatisfies Assumptions (B),(B’)and(C)with
α= 3andψ∈C([0, T];H3
per(Ω))∩C1([0, T];H1(Ω)), we have, for 0< τ < τ 0and
0< h < h 0,
(4.25) ∥ψ(·, tn)−INψ⟨n⟩∥L2≲τ+h3,∥ψ(·, tn)−INψ⟨n⟩∥H1≲τ+h2,0≤n≤T/τ.
For notational simplicity, we define BN:C(Ω)→XNas
(4.26) BN(ϕ) :=PN(V ϕ) +ING(ϕ), ϕ∈C(Ω),
where G(ϕ)(x) =f(|ϕ(x)|2)ϕ(x) for x∈Ω. Then we have
Lemma 4.5.Letv, w∈XN. Assume that V∈L∞(Ω)andfsatisfies (A)and
(C)withα= 2. If∥v∥H2≤M0and∥w∥L∞≤M1, we have
(4.27) ∥PNB(v)−BN(w)∥L2≤C(∥V∥L∞, M0, M1)∥v−w∥L2+C(M0)h2.
Moreover, if V∈W1,4(Ω)∩H1
per(Ω),fsatisfies Assumptions (B’) and (C)with
α= 3, and∥v∥H3≤M2, and∥w∥H2≤M3, we have
(4.28) ∥PNB(v)−BN(w)∥H1≤C(∥V∥W1,4, M2, M3)∥v−w∥H1+C(M2)h2.
Proof. Recalling (3.4) and (4.26), we have
PNB(v)−BN(w) =PN(V(v−w)) +PNG(v)−ING(w)
=PN(V(v−w)) + ( PN−IN)G(v) +ING(v)−ING(w). (4.29)
From (4.29), using assumption (C) with α= 2, we have
∥PNB(v)−BN(w)∥L2≲∥V∥L∞∥v−w∥L2+C(M0)h2+∥ING(v)−ING(w)∥L2
≤ ∥V∥L∞∥v−w∥L2+C(M0)h2+C(M0, M1)∥v−w∥L2, (4.30)
where we use ∥ING(ϕ)∥2
L2=hP
j∈T0
N|G(ϕ(xj))|2andINis an identity on XNin the
last line, and we prove (4.27).
To prove (4.28), using (C) with α= 3 and (B’), from (4.29), we have
∥PNB(v)−BN(w)∥H1≲∥V∥W1,4∥v−w∥H1+C(M2)h2+C(M2, M3)∥v−w∥H1,
which proves (4.28), and completes the proof.
Proof of Corollary 4.4.The proof is similar to the proof of Theorem 4.1, and
we sketch it here for the convenience of the reader. We start with the proof of
(4.24). Define the error function e⟨n⟩:=PNψ[n]−INψ⟨n⟩for 0≤n≤T/τ. Then
e⟨0⟩=PNψ0−INψ0satisfies ∥e⟨0⟩∥L2≤C(M)h2. Recalling (2.16), (4.3), and (4.26),
we obtain, for 0 ≤n≤T/τ−1,
(4.31) e⟨n+1⟩=eiτ∆e⟨n⟩−iτφ1(iτ∆)(PNB(ψ[n])−BN(INψ⟨n⟩)).18 W. BAO, AND C. WANG
From (4.31), by the boundedness of eiτ∆,PNandφ1(iτ∆), Lemma 3.4, triangle
inequality, the uniform H2-bound of ψ[n]in (3.2), and (4.27), we get
∥e⟨n+1⟩∥L2≤ ∥e⟨n⟩∥L2+τ
∥PNB(ψ[n])−PNB(PNψ[n])∥L2
+∥PNB(PNψ[n])−BN(INψ⟨n⟩)∥L2
≤ ∥e⟨n⟩∥L2+C(M)τh2+ (1 + C(M,∥INψ⟨n⟩∥L∞)τ)∥e⟨n⟩∥L2. (4.32)
From (4.32), by discrete Gronwall’s inequality and the same induction process as in
the proof of Proposition 4.3, noting first step error ∥e⟨0⟩∥L2≤C(M)h2, we obtain
(4.33) ∥e⟨n⟩∥L2≤C(M, T )h2,0≤n≤T/τ.
The rest of the proof of (4.24) can be completed by following the proof of (4.1).
Then we outline the proof of (4.25). Define the numerical flow Φ⟨τ⟩
h:XN→XN
associated with the EWI-EFP scheme (2.13) as
(4.34) Φ⟨τ⟩
h(v) =eiτ∆v−iτφ1(iτ∆)BN(v), v∈XN.
Recalling (2.16), we have INψ⟨n+1⟩= Φ⟨τ⟩
h(INψ⟨n⟩) for n≥0. Recalling (3.16) and
(4.34), the local truncation error can be decomposed as
PNψ(tn+1)−Φ⟨τ⟩
h(PNψ(tn)) =−iZτ
0ei(τ−s)∆ 
PNB(ψ(tn+s))−PNB(ψ(tn))+
PNB(ψ(tn))−PNB(PNψ(tn)) +PNB(PNψ(tn))−BN(PNψ(tn))
ds, (4.35)
which implies, by the boundedness of eit∆andPN, and using (3.38) and (4.28),
(4.36) ∥PNψ(tn+1)−Φ⟨τ⟩
h(PNψ(tn))∥H1≲τ2+τh2.
Besides, recalling (4.34) and using (B’), we have H1-stability estimate
(4.37) ∥Φ⟨τ⟩
h(PNψ(tn))−Φ⟨τ⟩
h(INψ⟨n⟩)∥H1≤(1 +C3τ)∥PNψ(tn)−INψ⟨n⟩∥H1,
where C3depends on ∥V∥W1,4,∥ψ(tn)∥H3and∥INψ⟨n⟩∥H2, and thus is under control.
The proof of the H1-error bound in (4.25) can be completed by applying standard
Lady Windermere’s fan argument with (4.36) and (4.37). The proof of the L2-error
bound in (4.25) can be obtained similarly. Then the proof is completed.
5. Numerical results. In this section, we present some numerical examples for
the NLSE with either low regularity potential or nonlinearity. In the following, we
fix Ω = ( −16,16),T= 1, d= 1 and consider the power-type nonlinearity f(ρ) =
−ρσ(σ >0).
Letψn(0≤n≤T/τ) be the numerical solution obtained by the EWI-FS method
(2.11) or the EWI-EFP method (2.13), which will be made clear in each case. Define
the error functions
ek
L2=∥ψ(tk)−INψk∥L2, ek
H1=∥ψ(tk)−INψk∥H1,0≤k≤n:=T/τ.ERROR ESTIMATES OF EWI FOR NLSE 19
5.1. For the NLSE with locally Lipschitz nonlinearity. In this subsection,
we only consider the NLSE with the power-type nonlinearity and without potential:
(5.1) i∂tψ(x, t) =−∆ψ(x, t)− |ψ(x, t)|2σψ(x, t), x∈Ω, t > 0,
where σ >0. Recall that Assumption (A) is satisfied for any σ >0 and Assumption
(B) is satisfied for any σ≥1/2. Note that when there is no potential, the ex-
tended Fourier pseudospectral method collapses to the standard Fourier pseudospec-
tral method.
Two types of initial data are considered:
(i) Type I. The H2initial datum
(5.2) ψ0(x) =x|x|0.51e−x2
2, x∈Ω.
(ii) Type II. The smooth initial datum
(5.3) ψ0(x) =xe−x2
2, x∈Ω.
The two initial data are specially chosen to demonstrate the influence of the low
regularity of faround the origin. Since both Type I and II initial data are odd
functions, the corresponding solutions of the NLSE will satisfy ψ(0, t)≡0 for all
t≥0. The difference of these two initial data lies in the regularity.
We shall test the convergence order in both time and space for Type I and II initial
data. For each initial datum, we choose σ= 0.1,0.2,0.3,0.4. The ’exact’ solutions are
computed by the Strang splitting Fourier pseudospectral method with τ=τe:= 10−6
andh=he:= 2−9. When test the spatial errors, we fix the time step size τ=τe,
and when test the temporal errors, we fix the mesh size h=he.
We start with the Type I H2initial datum (5.2). Figure 5.1 exhibits the spatial
error in L2- and H1-norm of the EWI-FS (solid lines) and the EWI-EFP (dotted
lines) method for σ= 0.1 with the Type I initial datum. We can observe that the
EWI-FS method is second order convergent in L2-norm and first order convergent in
H1-norm. Moreover, we see that there is almost no difference between the spatial
error of the EWI-FS method and the EWI-EFP method, which suggests that the
Fourier pseudospectral method seems also suitable to discretize the low regularity
nonlinearity.
Figure 5.2 plots the temporal error in L2- and H1-norm of the EWI for different
0< σ < 1/2 with Type I initial datum. Figure 5.2 (a) shows that the temporal
convergence is first order in L2-norm for all the four σand Figure 5.2 (b) shows the
temporal convergence is half order in H1-norm for all the four σ.
The results in Figures 5.1 and 5.2 confirm our optimal L2-norm error bound for
the NLSE with locally Lipschitz nonlinearity, and demonstrate that it is sharp.
Then we consider the Type II smooth initial datum (5.3). Figure 5.3 shows the
spatial error in L2- and H1-norm of the EWI-FS (solid lines) and the EWI-EFP
(dotted lines) method for σ= 0.1 with the Type II initial datum. We can observe
that the convergence orders in H1-norm of the EWI-FS (solid lines) and the EWI-
EFP (dashed lines) are almost the same (roughly 2.5), though the value of the error
of the EWI-FS is smaller than the EWI-EFP. While the convergence order in L2-
norm of the EWI-FS method is roughly 3.5, which is almost one order higher than
that of the EWI-EFP method. This observation suggests that when the solution has
better regularity, the Fourier spectral method outperforms the Fourier pseudospectral
method for discretizing the low regularity nonlinearity.20 W. BAO, AND C. WANG
0.1 0.410-310-1
Fig. 5.1 .Comparison of the Fourier spectral and pseudospectral discretization of the nonlinear
term in (5.1) withσ= 0.1and Type I initial datum (5.2).
10-410-310-210-110-410-2
10-410-310-210-110-310-1
Fig. 5.2 .Temporal errors of the EWI for the NLSE (5.1) with Type I initial datum (5.2): (a)
L2-norm errors, and (b) H1-norm errors.
Figure 5.4 displays the temporal error in L2- and H1-norm of the EWI for dif-
ferent 0 < σ < 1 with the Type II initial datum. Figure 5.4 (a) and (b) show that
the temporal convergence is first order in both L2- and H1-norm for all the four σ.
However, currently, we can only prove the first order H1-convergence in time un-
der Assumption (B) which holds only when σ≥1/2. Besides, as shown in Figure
5.3 in [18], for the time-splitting methods, we can observe first order convergence in
H1-norm only when σ≥1/2, which suggests that the EWI may be better than the
time-splitting methods when the nonlinearity is of low regularity.
The results in Figures 5.3 and 5.4 confirm our optimal H1-norm error bound for
the NLSE with low regularity nonlinearity, but also indicates that Assumption (B)
may be relaxed.
5.2. For the NLSE with low regularity potential. In this subsection, we
only consider the cubic NLSE with low regularity potential as
(5.4) i∂tψ(x, t) =−∆ψ(x, t) +V(x)ψ(x, t)− |ψ(x, t)|2ψ(x, t),x∈Ω, t > 0,
where Vis chosen as either V1∈L∞(Ω) or V2∈W1,4(Ω) defined as
(5.5) V1(x) =(
−4, x∈(−2,2)
0, otherwise, V 2(x) =|x|0.76, x ∈Ω.ERROR ESTIMATES OF EWI FOR NLSE 21
0.1 0.410-610-3
Fig. 5.3 .Comparison of the Fourier spectral and pseudospectral discretizations of the nonlinear
term in (5.1) withσ= 0.1and Type II initial datum (5.3).
10-410-310-210-110-410-2
10-410-310-210-110-410-2
Fig. 5.4 .Temporal errors of the EWI for the NLSE (5.1) with Type II initial datum (5.3): (a)
L2-norm errors, and (b) H1-norm errors.
We shall test the convergence orders for the NLSE (5.4) with V=V1andψ0∈
H2(Ω), and V=V2andψ0∈H3(Ω), respectively. The ’exact’ solutions are computed
by the EWI-EFP method with τ=τe:= 10−6andh=he:= 2−9. When test the
spatial errors, we fix the time step size τ=τe, and when test the temporal errors, we
fix the mesh size h=he.
We start with the spatial error and compare the performance of the extended
Fourier pseudospectral method and the standard Fourier pseudospectral (FP) method
which can be obtained by replacing\(V INψ⟨n⟩)lwith^(V ψ⟨n⟩)lin (2.13). We remark
here that, since the nonlinearity is smooth in (5.4), the results of the EWI-FS method
are almost the same as those of the EWI-EFP method.
Figure 5.5 (a) shows the spatial error in L2- and H1-norm of the EWI-EFP
method (solid lines) and the EWI-FP method (dotted lines) with V=V1∈L∞(Ω)
given in (5.5) and ψ0∈H2(Ω) given in (5.2). We can observe that the EWI-EFP is
second order convergent in L2-norm and first order convergent in H1-norm in space.
However, the spatial convergence order of the EWI-FP method is only first order in
both L2- and H1-norm, and the value of the error is much larger. This implies that
when discretizing purely L∞-potential, the extended Fourier pseudospectral method is
much better than the standard Fourier pseudospectral method. Figure 5.5 (b) plots
the temporal convergence of the EWI in L2- and H1-norm with the Type I initial22 W. BAO, AND C. WANG
datum. We can observe that the EWI is first order convergent in L2-norm and half
order convergent in H1-norm in time.
The results in Figure 5.5 validate our optimal L2-norm error bound for the NLSE
with L∞-potential and demonstrate that it is sharp.
10-210-110-510-1
10-410-210-410-1
Fig. 5.5 .Convergence tests of the EWI for (5.4) withV=V1∈L∞(Ω)andψ0∈H2(Ω): (a)
spatial errors of the Fourier spectral and pseudospectral discretizations for the linear potential, and
(b) temporal errors in L2-norm and H1-norm.
0.02 0.210-610-410-2
10-410-210-410-1
Fig. 5.6 .Convergence tests of the EWI for (5.4) with V=V2∈W1,4(Ω)andψ0∈H3(Ω):
(a) spatial errors of the Fourier spectral and pseudospectral discretizations for the linear potential,
and (b) temporal errors in L2-norm and H1-norm.
Figure 5.6 (a) shows the spatial error in L2- and H1-norm of the EWI-EFP method
(solid lines) and the EWI-FP method (dotted lines) with V=V2∈W1,4(Ω) given in
(5.5) and ψ0∈H3(Ω) given by ψ0(x) = (1 + |x|2.51)e−x2/2. We can observe that the
EWI-EFP is third order convergent in L2-norm and second order convergent in H1-
norm in space. However, the spatial convergence order of the EWI-FP method is only
1.7 order in both L2- and H1-norm, and the value of the error is much larger. This
implies again that the extended Fourier pseudospectral method is much better than
the standard Fourier pseudospectral method when the potential is of low regularity.
Figure 5.6 (b) plots the temporal convergence of the EWI in L2- and H1-norm with
theH3initial datum. We can observe that the EWI is first order convergent in
H1-norm in time for V∈W1,4(Ω).
The results in Figure 5.6 validate our optimal H1-norm error bound for the NLSE
with W1,4-potential and demonstrate that it is sharp.ERROR ESTIMATES OF EWI FOR NLSE 23
5.3. Comparison with the time-splitting method. In this subsection, we
present some numerical results to compare the performance of the EWI and the time-
splitting method applied to the NLSE with low regularity potential and nonlinearity.
To be precise, we compare the EWI with the first-order Lie-Trotter time-splitting
method with standard Fourier pseudospectral method for spatial discretization (ab-
breviated as TSFP in the following). Here, we fix h=heand compare the temporal
errors, roughly speaking, this is equivalent to do comparison for semi-discretization
in time by different time integrators.
First, we consider the NLSE (5.1) with low regularity nonlinearity σ= 0.1 and
the smooth initial datum (5.3). In Figure 5.7, we can observe that both the EWI and
the TSFP are first order convergent in L2-norm, although the value of the error of the
TSFP method is smaller than the EWI. However, when measured in H1-norm, the
EWI is still first order convergent (although this is not covered by our error estimates
as already mentioned in the discussion of Figure 5.4), but the error of the TSFP
method fluctuates a lot, and leads to order reduction.
10-410-210-510-2
EWI
TSFP
10-410-210-510-3
EWI
TSFP
Fig. 5.7 .comparison of EWI and LTFP for the NLSE (5.1) withσ= 0.1: (a) temporal errors
inL2-norm and (b) temporal errors in H1-norm.
Then we consider the NLSE (5.4) with low regularity potential V=V1∈L∞(Ω)
in (5.5) and an H2-initial data given in (5.2). In Figure 5.8, we can observe that
the EWI is first order and half order convergent in L2- and H1-norm, respectively.
However, both the L2- and H1-error of the TSFP method fluctuates drastically and
suffer from sever order reduction.
Based on the discussion above, we can conclude that in general, the EWI is
better than the TSFP method when approximating the NLSE with low regularity
potential and nonlinearity. However, the numerical results also necessitate the design
and analysis of higher order and structure-preserving (e.g. time symmetric) EWIs for
better error constant. This will be considered in our future work.
6. Conclusions. We established optimal error bounds for the first-order Gautschi-
type exponential wave integrator (EWI) applied to the nonlinear Schr¨ odinger equation
(NLSE) with L∞-potential and/or locally Lipschitz nonlinearity under the assump-
tion of H2-solution. For the semi-discretization in time by the first-order Gautschi-
type EWI, we proved an optimal L2-norm error bound at O(τ) and a uniform H2-
bound of the numerical solution. For the full discretization obtained from the semi-
discretization by using the Fourier spectral method in space, we proved an optimal
L2-norm error bound at O(τ+h2) without any coupling condition between τand
h. For W1,4-potential and a little more regular nonlinearity, under the assumption24 W. BAO, AND C. WANG
10-310-110-210-1
TSFP
EWI
10-310-110-2100
TSFP
EWI
Fig. 5.8 .comparison of EWI and LTFP for the NLSE (5.4) withV=V1∈L∞(Ω)in(5.5):
(a) temporal errors in L2-norm and (b) temporal errors in H1-norm.
ofH3-solution of the NLSE, we proved optimal H1-norm error bounds for both the
semi-discrete and fully discrete schemes. As a by-product, we proposed an extended
Fourier pseudospectral method to implement the full discretization when the potential
is of low regularity and the nonlinearity is smooth, in which the potential and nonlin-
earity were discretized by the Fourier spectral method and the Fourier pseudospectral
method, respectively. The proposed numerical implementation has similar compu-
tational cost as the standard Fourier pseudospectral method, but we can establish
rigorous error bounds for this method. On the contrary, one cannot establish optimal
error bounds for the standard Fourier pseudospectral method for the NLSE when the
potential is of low regularity, e.g. V∈L∞. In the future, we will consider even weaker
potential, e.g. V∈L1, including Coulomb potential and/or spatial/temporal Dirac
delta potential.
REFERENCES
[1]G. D. Akrivis ,Finite difference discretization of the cubic Schr¨ odinger equation , IMA J.
Numer. Anal., 13 (1993), pp. 115–124.
[2]G. D. Akrivis, V. A. Dougalis, and O. A. Karakashian ,On fully discrete Galerkin methods
of second-order temporal accuracy for the nonlinear Schr¨ odinger equation , Numer. Math.,
59 (1991), pp. 31–53.
[3]Y. Alama Bronsard ,Error analysis of a class of semi-discrete schemes for solving the Gross-
Pitaevskii equation at low regularity , J. Comput. Appl. Math., 418 (2023), p. 114632.
[4]Y. Alama Bronsard, Y. Bruned, and K. Schratz ,Low regularity integrators via decorated
trees, 2022, arXiv:2211.09402.
[5]Y. Bruned and K. Schratz ,Resonance-based schemes for dispersive equations via decorated
trees, Forum Math. Pi, 10, e2 (2022), pp. 1-76.
[6]X. Antoine, W. Bao, and C. Besse ,Computational methods for the dynamics of the nonlinear
Schr¨ odinger/Gross-Pitaevskii equations , Comput. Phys. Commun., 184 (2013), pp. 2621–
2633.
[7]G. E. Astrakharchik and B. A. Malomed ,Dynamics of one-dimensional quantum droplets ,
Phys. Rev. A, 98 (2018), p. 013631.
[8]W. Bao and Y. Cai ,Mathematical theory and numerical methods for Bose-Einstein conden-
sation , Kinet. Relat. Models, 6 (2013), pp. 1–135.
[9]W. Bao and Y. Cai ,Optimal error estimates of finite difference methods for the Gross-
Pitaevskii equation with angular momentum rotation , Math. Comp., 82 (2013), pp. 99–128.
[10]W. Bao and Y. Cai ,Uniform and optimal error estimates of an exponential wave integrator
sine pseudospectral method for the nonlinear Schr¨ odinger equation with wave operator ,
SIAM J. Numer. Anal., 52 (2014), pp. 1103–1127.
[11]W. Bao, Y. Cai and Y. Feng ,Improved uniform error bounds of the time-splitting methods forERROR ESTIMATES OF EWI FOR NLSE 25
the long-time (nonlinear) Schr¨ odinger equation , Math. Comp., 92 (2023), pp. 1109–1139.
[12]W. Bao, R. Carles, C. Su, and Q. Tang ,Error estimates of a regularized finite differ-
ence method for the logarithmic Schr¨ odinger equation , SIAM J. Numer. Anal., 57 (2019),
pp. 657–680.
[13]W. Bao, R. Carles, C. Su, and Q. Tang ,Regularized numerical methods for the logarithmic
Schr¨ odinger equation , Numer. Math., 143 (2019), pp. 461–487.
[14]W. Bao, R. Carles, C. Su, and Q. Tang ,Error estimates of local energy regularization
for the logarithmic Schr¨ odinger equation , Math. Models Methods Appl. Sci., 32 (2022),
pp. 101–136.
[15]W. Bao, Y. Feng, and Y. Ma ,Regularized numerical methods for the nonlinear Schr¨ odinger
equation with singular nonlinearity , East Asian J. Appl. Math., 13 (2023), pp. 646-670.
[16]W. Bao, D. Jaksch, and P. A. Markowich ,Numerical solution of the Gross-Pitaevskii
equation for Bose-Einstein condensation , J. Comput. Phys., 187 (2003), pp. 318–342.
[17]W. Bao, N. J. Mauser, and H. P. Stimming ,Effective one particle quantum dynamics of
electrons: a numerical study of the Schr¨ odinger-Poisson- Xαmodel , Commun. Math. Sci.,
1 (2003), pp. 809–828.
[18]W. Bao and C. Wang ,Error estimates of the time-splitting methods for the nonlinear
Schr¨ odinger equation with semi-smooth nonlinearity , 2023, arXiv:2301.02992.
[19]M. Bayindir, B. Tanatar, and Z. Gedik ,Bose-Einstein condensation in a one-dimensional
interacting system due to power-law trapping potentials , Phys. Rev. A, 59 (1999), pp. 1468–
1472.
[20]C. Besse, B. Bid ´egaray, and S. Descombes ,Order estimates in time of splitting methods
for the nonlinear Schr¨ odinger equation , SIAM J. Numer. Anal., 40 (2002), pp. 26–40.
[21]O. Bokanowski and N. J. Mauser ,Local approximation for the Hartree-Fock exchange po-
tential: a deformation approach , Math. Models Methods Appl. Sci., 9 (1999), pp. 941–961.
[22]C. R. Cabrera, L. Tanzi, J. Sanz, B. Naylor, P. Thomas, P. Cheiney, and L. Tarruell ,
Quantum liquid droplets in a mixture of Bose-Einstein condensates , Science, 359 (2018),
pp. 301–304.
[23]Y. Cai and H. Wang ,Analysis and computation for ground state solutions of Bose-Fermi
mixtures at zero temperature , SIAM J. Appl. Math., 73 (2013), pp. 757–779.
[24]T. Cazenave ,Semilinear Schr¨ odinger Equations , vol. 10 of Courant Lecture Notes in Math-
ematics, New York University, Courant Institute of Mathematical Sciences, New York;
American Mathematical Society, Providence, RI, 2003.
[25]E. Celledoni, D. Cohen, and B. Owren ,Symmetric exponential integrators with an appli-
cation to the cubic Schr¨ odinger equation , Found. Comput. Math., 8 (2008), pp. 303–317.
[26]W. Choi and Y. Koh ,On the splitting method for the nonlinear Schr¨ odinger equation with
initial data in H1, Discrete Contin. Dyn. Syst., 41 (2021), pp. 3837–3867.
[27]J. Eilinghoff, R. Schnaubelt, and K. Schratz ,Fractional error estimates of splitting
schemes for the nonlinear Schr¨ odinger equation , J. Math. Anal. Appl., 442 (2016), pp. 740–
760.
[28]L. Erd ˝os, B. Schlein, and H.-T. Yau ,Derivation of the cubic non-linear Schr¨ odinger equation
from quantum dynamics of many-body systems , Invent. Math., 167 (2007), pp. 515–614.
[29]Y. Feng and K. Schratz ,Improved uniform error bounds on a Lawson-type exponential
integrator for the long-time dynamics of sine-Gordon equation , 2022, arXiv:2211.09402.
[30]B.-Y. Guo ,Spectral methods and their applications , World Scientific Publishing Co., Inc., River
Edge, NJ, 1998.
[31]Z. Hadzibabic, C. A. Stan, K. Dieckmann, S. Gupta, M. W. Zwierlein, A. G ¨orlitz, and
W. Ketterle ,Two-species mixture of quantum degenerate Bose and Fermi gases , Phys.
Rev. Lett., 88 (2002), p. 160401.
[32]P. Henning and D. Peterseim ,Crank-Nicolson Galerkin approximations to nonlinear
Schr¨ odinger equations with rough potentials , Math. Models Methods Appl. Sci., 27 (2017),
pp. 2147–2184.
[33]M. Hochbruck and A. Ostermann ,Exponential integrators , Acta Numer., 19 (2010), pp. 209–
286.
[34]L. I. Ignat ,A splitting method for the nonlinear Schr¨ odinger equation , J. Differential Equa-
tions, 250 (2011), pp. 3022–3046.
[35]H. Kadau, M. Schmitt, M. Wenzel, C. Wink, T. Maier, I. Ferrier-Barbut, and T. Pfau ,
Observing the rosensweig instability of a quantum ferrofluid , Nature, 530 (2016), pp. 194–
197.
[36]T. Kato ,On nonlinear Schr¨ odinger equations , Ann. Inst. H. Poincar´ e Phys. Th´ eor., 46 (1987),
pp. 113–129.
[37]M. Kn ¨oller, A. Ostermann, and K. Schratz ,A Fourier integrator for the cubic nonlinear26 W. BAO, AND C. WANG
Schr¨ odinger equation with rough initial data , SIAM J. Numer. Anal., 57 (2019), pp. 1967–
1986.
[38]T. D. Lee, K. Huang, and C. N. Yang ,Eigenvalues and eigenfunctions of a Bose system of
hard spheres and its low-temperature properties , Phys. Rev., 106 (1957), pp. 1135–1145.
[39]C. Lubich ,On splitting methods for Schr¨ odinger-Poisson and cubic nonlinear Schr¨ odinger
equations , Math. Comp., 77 (2008), pp. 2141–2153.
[40]A. Ostermann, F. Rousset, and K. Schratz ,Error estimates at low regularity of splitting
schemes for NLS , Math. Comp., 91 (2021), pp. 169–182.
[41]A. Ostermann, F. Rousset, and K. Schratz ,Error estimates of a Fourier integrator for the
cubic Schr¨ odinger equation at low regularity , Found. Comput. Math., 21 (2021), pp. 725–
765.
[42]A. Ostermann and K. Schratz ,Low regularity exponential-type integrators for semilinear
Schr¨ odinger equations , Found. Comput. Math., 18 (2018), pp. 731–755.
[43]A. Ostermann, Y. Wu, and F. Yao ,A second-order low-regularity integrator for the nonlinear
Schr¨ odinger equation , Adv. Contin. Discrete Models, (2022), pp. Paper No. 23, 14.
[44]A. Ostermann and F. Yao ,A fully discrete low-regularity integrator for the nonlinear
Schr¨ odinger equation , J. Sci. Comput., 91 (2022), pp. Paper No. 9, 14.
[45]D. S. Petrov and G. E. Astrakharchik ,Ultradilute low-dimensional liquids , Phys. Rev.
Lett., 117 (2016), p. 100401.
[46]P. W. H. Pinkse, A. Mosk, M. Weidem ¨uller, M. W. Reynolds, T. W. Hijmans, and
J. T. M. Walraven ,Adiabatically changing the phase-space density of a trapped Bose
gas, Phys. Rev. Lett., 78 (1997), pp. 990–993.
[47]F. Rousset and K. Schratz ,A general framework of low regularity integrators , SIAM J.
Numer. Anal., 59 (2021), pp. 1735–1768.
[48]L. Sanchez-Palencia, D. Cl ´ement, P. Lugan, P. Bouyer, G. V. Shlyapnikov, and A. As-
pect ,Anderson localization of expanding Bose-Einstein condensates in random potentials ,
Phys. Rev. Lett., 98 (2007), p. 210401.
[49]J. M. Sanz-Serna ,Methods for the numerical solution of the nonlinear Schr¨ odinger equation ,
Math. Comp., 43 (1984), pp. 21–27.
[50]J. Shen, T. Tang, and L.-L. Wang ,Spectral Methods: Algorithms, Analysis and Applications ,
vol. 41 of Springer Series in Computational Mathematics, Springer, Heidelberg, 2011.
[51]C. Sulem and P.-L. Sulem ,The Nonlinear Schr¨ odinger Equation: Self-Focusing and Wave
Collapse , Applied Mathematical Sciences, Springer New York, NY, 1999.
[52]Y. Tourigny ,Optimal H1estimates for two time-discrete Galerkin approximations of a non-
linear Schr¨ odinger equation , IMA J. Numer. Anal., 11 (1991), pp. 509–523.
[53]J. Wang ,A new error analysis of Crank-Nicolson Galerkin FEMs for a generalized nonlinear
Schr¨ odinger equation , J. Sci. Comput., 60 (2014), pp. 390–407.
[54]I. Zapata, F. Sols, and A. J. Leggett ,Josephson effect between trapped Bose-Einstein
condensates , Phys. Rev. A, 57 (1998), pp. R28–R31.
[55]X. Zhao ,Numerical integrators for continuous disordered nonlinear Schr¨ odinger equation , J.
Sci. Comput., 89 (2021), pp. Paper No. 40, 27.