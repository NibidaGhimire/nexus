arXiv:2302.09058v2  [math.CO]  7 Nov 2024Unit and distinct distances in typical norms
Noga Alon∗Matija Bucić†Lisa Sauermann‡
Abstract
Erdős’ unit distance problem and Erdős’ distinct distances problem are among the most classical and
well-known open problems in discrete mathematics. They ask for the maximum number of unit distances,
or the minimum number of distinct distances, respectively, determined by npoints in the Euclidean plane.
The question of what happens in these problems if one conside rs normed spaces other than the Euclidean
plane has been raised in the 1980s by Ulam and Erdős and attrac ted a lot of attention over the years. We
give an essentially tight answer to both questions for almos t all norms on Rd, in a certain Baire categoric
sense.
For the unit distance problem we prove that for almost all nor ms/⌊ar⌈⌊l./⌊ar⌈⌊lonRd, any set of npoints deﬁnes
at most1
2d·nlog2nunit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l. We also show that this is essentially tight, by proving
that for every norm/⌊ar⌈⌊l./⌊ar⌈⌊lonRd, for any large n, we can ﬁnd npoints deﬁning at least1
2(d−1−o(1))·nlog2n
unit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l.
For the distinct distances problem, we prove that for almost all norms /⌊ar⌈⌊l./⌊ar⌈⌊lonRdany set of npoints
deﬁnes at least (1−o(1))ndistinct distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l. This is clearly tight up to the o(1)term.
We also answer the famous Hadwiger–Nelson problem for almos t all norms on R2, showing that their
unit distance graph has chromatic number 4.
Our results settle, in a strong and somewhat surprising form , problems and conjectures of Brass, Ma-
toušek, Brass–Moser–Pach, Chilakamarri, and Robertson. T he proofs combine combinatorial and geometric
ideas with tools from Linear Algebra, Topology and Algebrai c Geometry.
1 Introduction
1.1 Unit distances
Erdős’ unit distance problem raised in 1946 in [20] (see also [8, Chapter 5]) is among the best-known open
problems in combinatorics. The problem asks about estimati ng the maximum possible number U/bardbl./bardbl2(n)of unit
distances determined by ndistinct points in the Euclidean plane R2according to the Euclidean norm /⌊ar⌈⌊l./⌊ar⌈⌊l2.
The best bounds to date are
n1+Ω(1/loglogn)≤U/bardbl./bardbl2(n)≤O(n4/3).
The lower bound appeared in the initial paper of Erdős [20], a nd the upper bound was ﬁrst proved by Spencer,
Szemerédi and Trotter [41] in 1984, see also [45] for a short a nd elegant proof based on the Crossing Lemma.
More on the rich history of this problem can be found in the sur veys [8, 46].
An interesting variant of the problem deals with the same que stion in general real normed spaces. This was
ﬁrst suggested by Ulam and described explicitly by Erdős in t he early 1980s [19]. We call a norm /⌊ar⌈⌊l./⌊ar⌈⌊lonRda
∗Department of Mathematics, Princeton University, Princet on, USA. Research supported in part by NSF grant DMS-2154082
and by USA-Israel BSF grant 2018267. Email: nalon@math.princeton.edu .
†Department of Mathematics, Princeton University, Princet on, USA. Research supported in part by NSF grants CCF-190046 0
and DMS-2349013. Email: matija.bucic@ias.edu .
‡Institute for Applied Mathematics, University of Bonn, Bon n, Germany. Part of this work was completed while this author
was aﬃliated with Massachusetts Insitute of Technology. Re search supported in part by NSF Award DMS-2100157 and a Sloan
Research Fellowship. Email: sauermann@iam.uni-bonn.de .
1d-norm and denote by U/bardbl./bardbl(n)the maximum possible number of unit distances determined by a set ofndistinct
points in Rd. The unit distance graph of a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊lis the graph whose vertices are all points of Rd, where
two points are adjacent if and only if the distance between th em is one. Thus, U/bardbl./bardbl(n)is the maximum number
of edges in an n-vertex subgraph of the unit distance graph of /⌊ar⌈⌊l./⌊ar⌈⌊l. An initial, simple observation is that if the
boundary of the unit ball of a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊lcontains a straight-line segment then U/bardbl./bardbl(n)is quadratic in n, as
in this case there are two inﬁnite subsets A,BofRdso that the distance between any a∈Aandb∈Bis
one. On the other hand, if /⌊ar⌈⌊l./⌊ar⌈⌊lis a2-norm which is strictly convex (meaning that the boundary of the unit ball
contains no straight line segment), then one can extend the k nown proofs from the Euclidean case to show that
U/bardbl./bardbl(n)≤O(n4/3). Valtr [48] constructed a strictly convex 2-norm in which for every nthere exist n-element
point sets with at least Ω(n4/3)unit distances. See also [39] for a much more general family o f norms with the
same property. This shows that the upper bound cannot be impr oved in general. See [8] for more details about
the history of the problem of estimating U/bardbl./bardbl(n)for general norms.
It is not diﬃcult to see that for any 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, we have U/bardbl./bardbl(n)≥(1
2−o(1))nlog2n. Indeed, the graph of the
k-dimensional hypercube is a subgraph of the unit distance gr aph of any 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊las shown by choosing k
random unit vectors u1,u2,...,uk∈R2and deﬁning vS=/summationtext
i∈Suifor every subset S⊆ {1,2,...,k}. If two
subsetsS,S′⊆ {1,2,...,k}diﬀer in a single element, then the distance according to /⌊ar⌈⌊l./⌊ar⌈⌊lbetween vSandvS′
is one, as desired.
A remarkable, often repeated (see e.g. [8, 30, 33, 38, 43, 46] ), result of Matoušek [34] from 2011 shows that
formost norms, in a Baire Categoric sense (that will be described in de tail in Section 3), this is not far from
optimal. Namely for a typical 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊l,U/bardbl./bardbl(n)≤O(nlognloglogn). This suggests the obvious problem of
deciding whether or not the loglognterm is necessary. The question of how small U/bardbl./bardbl(n)can be has already
been considered by Brass [6] in 1996, who in particular asked i f there exists a 2-norm with U/bardbl./bardbl(n)≤O(nlogn).
The corresponding problem in higher dimensions has been con sidered as well. In particular, Brass, Moser and
Pach [8, Chapter 5, Problems 4 and 5, p. 195] conjectured that for every d≥3and every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l,U/bardbl./bardbl(n)
is asymptotically larger than Ω(nlogn)and asked whether or not for d≥4there is a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊lso that
U/bardbl./bardbl(n) =o(n2). Note that for the d-dimensional Euclidean norm /⌊ar⌈⌊l./⌊ar⌈⌊l2it is easy to see that U/bardbl./bardbl(n)≥Ω(n2)
for every d≥4(and in fact, the precise constant is known as well, see [18]) , showing that for the Euclidean
norms, the problem is simple in all dimensions d≥4, despite being wide open in dimensions 2and3.
In the present paper, we settle the above-mentioned questio ns of Brass, of Matoušek and of Brass, Moser and
Pach in all dimensions in the following strong form.
Theorem 1.1. For any d≥2, for most d-norms/⌊ar⌈⌊l./⌊ar⌈⌊l, we have
U/bardbl./bardbl(n)≤d
2·nlog2n
for alln. More precisely, for all d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lbesides a meagre set, the following holds: For every n≥1and
every set of npoints in Rd, there are at mostd
2·nlog2nunit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊lamong the npoints.
Theorem 1.2. Letd≥2be ﬁxed. Then for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, we have
U/bardbl./bardbl(n)≥d−1−o(1)
2·nlog2n.
for all large n. That is, for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊land every n, there exists a set of npoints in Rdsuch that the
number of unit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊lamong the npoints is at leastd−1−o(1)
2·nlog2n, where the o(1)-term
tends to zero as n→ ∞.
21.2 Distinct distances
The equally famous Erdős distinct distances problem is conc erned with estimating the minimum possible
numberD/bardbl./bardbl2(n)of distinct distances determined by npoints in the Euclidean plane R2. See for example the
book [26] focusing on this question, its history, generalis ations and connections to other areas. The Erdős
distinct distances problem also traces its origins to the 19 46 paper [20] of Erdős. In this paper, he considered
the same problem for higher-dimensional Euclidean spaces a s well. For the planar case, Erdős proved an upper
bound of O(n/√logn)and conjectured this is tight. After a long sequence of impro vements of the lower bound,
Guth and Katz established in [29] a nearly tight lower bound o fΩ(n/logn). For higher-dimensional Euclidean
spaces even the correct exponent of nis not known, see [40] for the best known bounds.
The Erdős distinct distances problem has a long history in th e case of general d-norms as well, see [43] for a
recent survey on what is known in this direction. Given a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊llet us denote by D/bardbl./bardbl(n)the minimum
possible number of distinct distances, according to /⌊ar⌈⌊l./⌊ar⌈⌊l, determined by npoints in Rd. For every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊land
everyn, we clearly have D/bardbl./bardbl(n)≤n−1by considering any set of npoints along an arithmetic progression on a
line. Brass conjectured that D/bardbl./bardbl(n) =o(n)for anyd≥2and any d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l(see [8, Chapter 5.4, Conjecture
5, p. 211]). Here we refute his conjecture in a strong form. Fo r mostd-norms/⌊ar⌈⌊l./⌊ar⌈⌊l, we show that D/bardbl./bardbl(n)is not
only linear in n, but is in fact of the form (1−o(1))n.
Theorem 1.3. For any ﬁxed d≥2, for most d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lwe have
D/bardbl./bardbl(n) = (1−o(1))n
for alln. More precisely, for all d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lbesides a meagre set, the following holds: For every n, among
anynpoints in Rdthere are at least (1−o(1))ndistinct distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l, where the o(1)-term tends
to zero as n→ ∞.
1.3 Hadwiger–Nelson Problem
The question of determining the chromatic number of the unit distance graph of the Euclidean norm in the
plane is yet another famous open problem in discrete geometr y, known as the Hadwiger–Nelson problem. In
other words, this question asks how many colours are needed i n order to colour all points in the plane such
that any two points with Euclidean distance one receive diﬀe rent colours. This problem dates back to 1950,
and it has been known for a long time that the answer is at least 4and at most 7. In a recent computational
breakthrough [11, 22], the lower bound has been improved to 5, sparking a collaborative Polymath project [37]
focusing on the problem. See also [8, 43] for more details on t he history of the Hadwiger–Nelson problem.
The analogue of this problem for other planar norms was studi ed by Chilakamarri [9] in 1991, who showed
that the unit distance graph of every 2-norm has chromatic number at least 4and at most 7. In addition, [9,
Problem 5], attributed to Robertson, asks for the chromatic number of the unit distance graph of at least one
strictly convex 2-norm to be evaluated. We prove that the chromatic number of t he unit distance graph of
most2-norms equals 4.
Theorem 1.4. For all2-norms/⌊ar⌈⌊l./⌊ar⌈⌊lbesides a meagre set, the unit distance graph of /⌊ar⌈⌊l./⌊ar⌈⌊lhas chromatic number
equal to4.
In contrast, as mentioned above, it was recently shown [11, 2 2] that for the Euclidean 2-norm the chromatic
number of the unit distance graph is at least 5. Thus, the behaviour for most 2-norms is diﬀerent from the
Euclidean 2-norm, which in particular disproves a conjecture of Chilak amarri [9, p. 355].
3In dimension d, our arguments give an upper bound of 2dfor the chromatic number of the unit distance graph
of mostd-norms. It is known that the chromatic number of the unit dist ance graph of any d-norm is at most
exponential in d(see [25, 32]), but the exponential base in these known bound s is much larger than 2. See also
[43] for a more detailed survey on what is known surrounding t his problem. We furthermore note that results
of Frankl and Wilson [23] give an exponential lower bound for the chromatic number of the unit distance graph
of alld-norms which are invariant under coordinate permutations.
Our upper bound of 2dfor most d-norms actually also holds for the chromatic number of the od d distance
graph (i.e. the graph whose edges correspond to pairs of poin ts inRdwhose distance is an odd integer), which
is a stronger result as the unit distance graph is a subgraph o f the odd distance graph. This is very diﬀerent
from the Euclidean case, where by a recent result of Davies [1 0] already in the plane the chromatic number of
the odd distance graph is inﬁnite.
2 Proof overview
The proofs of our theorems use arguments from combinatorics , polyhedral and discrete geometry, topology and
algebra. In this section, we give a high-level proof overvie w. We note that this overview is simplifying numerous
parts and omitting certain important points, since the goal of this section is to present just the general ideas
and how they come together. We begin with Theorem 1.1.
The proof of Theorem 1.1 splits into two parts. The ﬁrst, more combinatorial part shows that for a norm with
a lot of unit distances among some set of npoints there must be a lot of rational linear dependencies be tween
the corresponding unit vectors. More precisely, if the boun d in Theorem 1.1 fails for some d-norm||.||, namely
if we can ﬁnd npoints with more than (d/2)·nlog2nunit distances, then there is some set of unit vectors
whoseQ-linear span contains a lot of other unit vectors. The second , more geometric part consists of showing
that for most norms, this situation cannot happen. In other w ords, for most norms, there cannot be a collection
of unit vectors from which a lot of other unit vectors can be ob tained as rational linear combinations.
In the ﬁrst part, we ﬁx npoints with more than (d/2)·nlog2nunit distances according to some some d-
norm||.||. Our goal is to show that there must be a lot of rational linear dependencies between the vectors
u1,...,ukwith||u1||=···=||uk||= 1describing these unit distances. If there are not so many rat ional linear
dependencies (more precisely, if for every ℓ, theQ-linear span of any ℓof the vectors u1,...,ukcontains at
mostd·ℓof the vectors u1,...,uk), then we can ﬁnd a subset of these unit vectors that is linear ly independent
overQand accounts for a relatively large number of unit distances among the nﬁxed points (namely, for more
than(1/2)·nlog2nunit distances). On the other hand, for nﬁxed points, we can analyse for how many pairs
of points their diﬀerence can be among a given list of Q-linearly independent vectors, and it turns out that this
can happen for at most (1/2)·nlog2npairs of points (this follows from an isoperimetric inequal ity for grids
due to Bollobás and Leader [5], but we also give a self-contain ed proof). This contradiction means that our
original set of unit vectors u1,...,ukmust have many rational linear dependencies, as desired.
For the second part, we need to show that there are only “few” s peciald-norms with the property that for
some collection of unit vectors, a lot of other unit vectors c an be obtained as rational linear combinations. So
we need to show that the set of d-norms with this property can be covered by countably many no where-dense
subsets in the space of d-norms (with a certain natural topology, see Section 3 for mo re details). Roughly
speaking, our countably many subsets correspond to the diﬀe rent possibilities for the size of the collection of
unit vectors and the rational coeﬃcients in the relevant rat ional linear combinations, as well as a lower bound
for the separation angle between any two of these unit vector s. To prove that each of these subsets is nowhere
dense in the space of all d-norms, we show that for any d-norm whose unit ball is a convex polytope with
suﬃciently small facets, there is a slight perturbation (ob tained by slightly translating each facet hyperplane)
4that does not appear as the unit ball of an accumulation point of the subset. Heuristically speaking, if such
a perturbation appears as the unit ball of a norm from this sub set, then certain linear equations need to be
satisﬁed for the translation lengths for the facets contain ing the unit vectors appearing in the above property
(as a consequence of the linear relations between the unit ve ctors themselves). A generic perturbation does
not satisfy these linear equations and therefore cannot cor respond to an accumulation point of norms from
this subset. This establishes that each of these subsets is i ndeed nowhere dense, and concludes the proof of
Theorem 1.1.
The proof of Theorem 1.3 follows a similar overall approach, but various steps become more involved and
signiﬁcant new ideas are required. In the ﬁrst part, for ngiven points with few distinct distances according to
somed-norm, we work over the ﬁeld extension of Qgenerated by the distinct distances between these npoints
(so we consider linear relations with coeﬃcients in this ext ension ﬁeld). We also need to establish stronger
quantitative bounds for the number of unit vectors that we ﬁn d in the span of some collection of unit vectors.
Overall, the ﬁrst part of the proof of Theorem 1.3 is much more involved than for Theorem 1.1. For example,
one cannot use the Bollobás–Leader edge-isoperimetric ineq uality anymore in this setting, since here we need a
more general statement (see Lemma 4.3) compared to the setti ng of Theorem 1.1 (we prove this more general
statement via combinatorial arguments). The second part of the proof of Theorem 1.3 is relatively similar to
Theorem 1.1, but requires some basic tools from algebraic ge ometry instead of the linear algebraic arguments
in the proof of Theorem 1.1.
For our result on the Hadwiger–Nelson problem for typical no rms in Theorem 1.4, we combine the second part
of the proof of Theorem 1.1 with a modiﬁed version of the ﬁrst p art. In particular, we make crucial use of the
Edmonds Matroid Partitioning Theorem [14].
We note that the general idea of trying to control the number o f linear dependencies between unit vectors in a
typical norm is due to Matoušek [34], and his proof of the uppe r bound U/bardbl./bardbl(n)≤O(nlognloglogn)for most
2-norms||.||similarly splits into two parts as our proof of Theorem 1.1. F or the second part, showing that
for most norms there cannot be many linear dependencies betw een unit vectors, our approach is inspired by
his arguments. However, he uses hands-on geometric argumen ts in dimension 2about “bulging” line segments
or decomposing into trapezoids, that do not seem to easily ex tend to higher dimensions. Therefore, to obtain
our results in any dimension, we introduced several new idea s, in particular making the proof more algebraic.
On the other hand, the ﬁrst part of our proof is radically diﬀe rent from Matoušek’s. His proof is based on
graph theoretic “expansion” arguments via probabilistic m ethods, leading to his weaker bound. We develop a
completely new strategy for the ﬁrst part of the proof instea d, resulting in an essentially tight bound.
To prove our new lower bound on U/bardbl./bardbl(n)for anyd-norm||.||in Theorem 1.2, we consider Minkowski sums of
certain carefully chosen small point sets, such that in a gri d-like fashion we obtain many unit distances. To
ensure that we can ﬁnd suitable small point conﬁgurations se rving as the base sets of our construction, we use
a result from dimension theory: the Hurewicz dimension lowe ring theorem.
Organisation. The next section contains some background and preliminary l emmas. The ﬁrst part of the
proofs of Theorems 1.1 and 1.3 can be found in Section 4, and th e second part in Section 5. Theorem 1.4 is
then proved in Section 6, relying on the previous sections. F inally, we prove Theorem 1.2 in Section 7 and
ﬁnish with some concluding remarks and open problems in Sect ion 8.
53 Geometric preliminaries
3.1 Background
We begin by setting up some notation and introducing the noti ons we will work with. We note that all our
logarithms are in base 2unless speciﬁed otherwise.
Ford≥1, a norm on Rdis a mapping ||.||that assigns a non-negative real number ||x||to each x∈Rdsuch
that the following three conditions hold:
• For every x∈Rd, we have ||x||= 0if and only if x=0.
• We have ||αx||=|α|·||x||for allα∈Randx∈Rd.
• The triangle inequality holds, meaning that ||x+y|| ≤ ||x||+||y||for all x,y∈Rd.
Each norm ||.||onRdis uniquely speciﬁed by its unit ball , deﬁned as the set of all x∈Rdfor which ||x|| ≤1. A
unit ball of any norm is a closed, bounded, 0-symmetric convex body containing 0in its interior. Furthermore,
any such body appears as the unit ball of a unique norm. Let Bddenote the set of all unit balls of norms in
Rdor equivalently the set of all closed, bounded, 0-symmetric convex bodies in Rdcontaining 0in the interior.
As discussed below, it is known that Bdendowed with the so-called Hausdorﬀ metric dHforms a Baire space.
The Hausdorﬀ distance dH(A,B)of two sets A,B⊆Rdis deﬁned as
dH(A,B) := max/braceleftbigg
sup
a∈Ainf
b∈B||a−b||2,sup
b∈Binf
a∈A||a−b||2/bracerightbigg
,
where||.||2denotes the Euclidean distance in Rd. IfA,B⊆Rdare closed and bounded, then one can replace
the suprema and inﬁma in the above deﬁnition with maxima and m inima. So in this case the Hausdorﬀ distance
dH(A,B)is simply the “maximum distance” of a point in Afrom the set Bor of a point in Bfrom the set A.
Note that the Hausdorﬀ distance satisﬁes the triangle inequ ality.
A setSin a metric (or topological) space Xis nowhere dense if every non-empty open set U⊆Xcontains a
nonempty open set VwithV∩S=∅. A meagre set in Xis a countable union of nowhere dense sets. Note
that a subset of any meagre set is also meagre. The space Xis called a Baire space if the complement of each
meagre set in Xis dense. It is known that Bdendowed with the Hausdorﬀ metric dHforms a Baire space (this
follows for example from [28, Theorem 6.4] together with the Baire Category Theorem).
The diameter of a non-empty bounded closed subset S⊆Rd(with respect to the Euclidean distance) is deﬁned
as
diam(S) = max
a,b∈S||a−b||2
(note that this maximum is indeed well-deﬁned since Sis closed and bounded).
A half-space in Rdis the closed subset of Rdgiven by the solutions x∈Rdto some linear inequality of the
forma·x≤bfor some a∈Rdand some b∈R(geometrically, this is the set of points on one side of the aﬃ ne
hyperplane given by a·x=b, including the hyperplane itself). A polytope P⊆Rdis an intersection of ﬁnitely
many half-spaces in Rd. Note that every polytope Pis convex. Every bounded polytope P⊆Rdcan also be
described as a convex hull of ﬁnitely many points in Rd.
Every 0-symmetric polytope Pcontaining 0in its interior can be written in the form
P={x∈Rd:|oi·x| ≤tifori= 1,...,h}
with non-zero vectors o1,...,oh∈Rdand positive real numbers t1,...,th. The facets of such a polytope are the
intersections of the form P∩Hfor some hyperplane Hsuch that the intersection P∩His(d−1)-dimensional
6andPis contained in one of the closed half-spaces bounded by H. IfPis0-symmetric, then the facets appear
in pairs of opposite facets (which are parallel to each other ).
A setB⊆Rdis strictly convex, if for all distinct a,b∈Band all0< α <1the point αa+(1−α)bis in the
interior of B. For a strictly convex set B⊆Rd, for every point bon the boundary of Bthere exists a hyperplane
HwithH∩B={b}such that Bis contained in one of the half-spaces bounded by H. The unit ball Bof a
norm||.||onRdis strictly convex if the triangle inequality is a strict ine quality||x+y||<||x||+||y||for all
non-zero vectors x,y∈Rdthat are not multiples of each other. Indeed, in this case for non-zero a,b∈Bwith
spanR(a)/\⌉}atio\slash= spanR(b)and0< α <1, we have ||αa+(1−α)b||<||αa||+||(1−α)b||=α||a||+(1−α)||b|| ≤
α+(1−α) = 1. For distinct vectors a,b∈BwithspanR(a) = spanR(b)we always have ||αa+(1−α)b||<1
since we either have max{||a||,||b||}<1ora=−b. And for a,b∈Bwitha=0orb=0we also trivially
have||αa+(1−α)b||<1. Thus the triangle inequality for ||.||being strict for all non-zero vectors x,y∈Rd
withspanR(x)/\⌉}atio\slash= spanR(y)indeed implies that Bis strictly convex.
Finally, we record the following simple algebraic fact, whi ch we will use in our proof of Theorem 1.3.
Fact 3.1. For any positive integer m, givenm+1rational functions f1,...,fm+1∈R(x1,...,x m)inmvariables
with real coeﬃcients, there exists a nonzero polynomial P∈R[y1,...,ym+1]such that P(f1,...,fm+1) = 0.
This follows immediately from the well-known fact that the t ranscendence degree of the function ﬁeld
R(x1,...,x m)overRis equal to m. Indeed, since m+ 1is larger than this transcendence degree, there
must be an algebraic relationship between f1,...,fm+1.
3.2 Geometric lemmas
This section contains some basic geometric lemmas. Althoug h most of the content of this section is well-known,
we include some of the proofs for the reader’s convenience.
The ﬁrst two lemmas below are only needed to prove the third le mma in this section.
Lemma 3.2. LetT⊆Rdbe a bounded subset and let ε >0. Then there exists a ﬁnite subset S⊆Tsuch that
for every point t∈Tthere exists a point s∈Swith||s−t||2≤ε.
We remark that such a subset Sis called an ε-net ofT.
Proof. SinceTis bounded, it is contained in the Euclidean ball of radius Raround 0for some R >0. Let
us consider the family of all subsets S⊆Twith the property that ||s−s′||2> εfor all distinct s,s′∈S. We
claim that each such subset Shas size|S| ≤(2R/ε+1)d. Indeed, the Euclidean balls of radius ε/2around the
points in Sare mutually disjoint and contained in the Euclidean ball of radiusR+ε/2around 0. Hence, for
volume reasons, the set Scan consist of at most (2R/ε+1)dpoints.
Note that S=∅vacuously satisﬁes the property that ||s−s′||2> εfor all distinct s,s′∈S. Hence, the family
of subsets S⊆Twith this property is non-empty, and as all its members satis fy|S| ≤(2R/ε+1)d, there must
be a maximal subset S⊆Tin this family. So let S⊆Tbe a maximal subset with the property that we have
||s−s′||2> εfor all distinct s,s′∈S.
Now, let us check that for every point t∈Tthere exists a point s∈Swith||s−t||2≤ε. Ift∈S, we can
choose s=t. Ift/\⌉}atio\slash∈S, then by the maximality of our chosen set Swe cannot add tto the set. This means
that we must have ||s−t||2≤εfor some s∈S, as desired.
7The following lemma states that close to any B∈ Bdwe can ﬁnd some strictly convex B′. This lemma can also
be deduced from a classical result of Klee [31] from 1959 whic h says that almost all norms on Rdare strictly
convex.
Lemma 3.3. For every B∈ Bdand every µ >0, there exists a strictly convex B′∈ Bdsuch that dH(B,B′)≤µ.
Proof. Let us denote by ||.||the norm with unit ball B. ThenB={x∈Rd:||x|| ≤1}. SinceBis bounded,
we can choose some c >0such that ||x||2≤cfor all b∈B. Letε=µ/c2.
Let us deﬁne a norm ||.||′by||x||′:=||x||+ε||x||2for all x∈Rd. To check that ||.||′is indeed a norm, note
that the triangle inequalities for ||.||and||.||2imply that
||x+y||′=||x+y||+ε||x+y||2≤ ||x||+||y||+ε||x||2+ε||y||2=||x||′+||y||′,
for all x,y∈Rd, so the triangle inequality also holds for ||.||′. Note in addition that we can have equality only
if||x+y||2=||x||2+||y||2and since the triangle inequality is strict for ||.||2for any non-zero vectors x,y∈Rd
which are not multiples of each other, the same also holds for ||.||′. Thus, the unit ball B′of the norm ||.||′is
strictly convex.
Note that B′⊆B, so for any point b′∈B′we have a point b=b′∈Bat Euclidean distance 0≤µfromb′.
On the other hand, we claim that for any point b∈Bwe can also ﬁnd a point b′∈B′with Euclidean distance
at mostµfromb. If||b||2≤µ, we can simply take b′=0∈B′. If||b||2> µ, we have
/vextenddouble/vextenddouble/vextenddouble/vextenddouble/parenleftbigg
1−µ
||b||2/parenrightbigg
b/vextenddouble/vextenddouble/vextenddouble/vextenddouble′
=/parenleftbigg
1−µ
||b||2/parenrightbigg
||b||′=/parenleftbigg
1−µ
||b||2/parenrightbigg
(||b||+ε||b||2)≤(1−ε||b||2)(1+ε||b||2)<1,
usingε=µ/c2≤µ/(||b||2)2and||b|| ≤1. So we can take b′:=/parenleftBig
1−µ
||b||2/parenrightBig
b∈B′and have ||b′−b||2=
µ
||b||2·||b||2=µ. This shows that dH(B,B′)≤µ, as desired.
We will need the following lemma which tells us that we can app roximate any B∈ Bdwith a polytope in Bd
with small facets. We note there is plenty of research concer ned with similar polytope approximation problems,
see e.g. [4] and references therein, mostly concerned with m inimising the number of facets needed to obtain a
good approximation. Here, we are not concerned with the numb er of facets of the approximating polytope,
but we need all of the facets to have small diameter.
Lemma 3.4. For every B∈ Bdand every µ >0, there exists a bounded 0-symmetric polytope B′∈ Bd
containing 0in its interior such that dH(B,B′)< µand all facets of B′have diameter less than µ(with respect
to the Euclidean distance).
Note that we can endow the set of all (d−1)-dimensional hyperplanes in Rdwith the natural topology induced
byRd+1when identifying a hyperplane described by an equation of th e form a·x=bwith||a||2= 1with the
point(a,b). More precisely, such a hyperplane with an equation of the fo rma·x=bcorresponds to a point
in the quotient space (a,b)∈(Sd−1×R)/{±1}(hereSd−1is the(d−1)-dimensional unit sphere in Rdand we
consider the quotient by the action of {±1}on(a,b)∈Sd−1×R, where−1acts by sending (a,b)/ma√sto→(−a,−b)).
We denote by dist2(p,H)the (Euclidean) distance from a point p∈Rdto a hyperplane H⊆Rd.
Proof. By Lemma 3.3, there exists a strictly convex B′′∈ BdwithdH(B′′,B)< µ/2. It is now suﬃcient
to show that there exists a bounded 0-symmetric polytope B′∈ Bdcontaining 0in its interior such that
dH(B′,B′′)< µ/2and all facets of B′have diameter less than µ
8LetHbe the set of all (d−1)-dimensional hyperplanes HinRdsuch that H∩B′′has diameter at least µ.
Note that His a closed and bounded subset of the set of all (d−1)-dimensional hyperplanes in Rd(to see that
His closed, note that diam(H∩B′′)is a continuous function on the set of all (d−1)-dimensional hyperplanes
H⊆Rd). Thus, His compact in the induced topology.
Every hyperplane H∈ Hcuts the strictly convex set B′′into two parts B′′
1(H)andB′′
2(H)(strictly speaking
these are the intersections of B′′with the two closed half-spaces bounded by H), neither of which is contained
inH, by the strict convexity assumption on B′′. For every hyperplane H∈ H, deﬁne
f(H) = min/braceleftbigg
max
b∈B′′
1(H)dist2(b,H),max
b∈B′′
2(H)dist2(b,H)/bracerightbigg
,
and note that f(H)>0for every H∈ H. Nowfis a continuous function on a compact space and so it attains
a minimum. So let η >0be this minimum, then f(H)≥ηfor allH∈ H.
Now, let us apply Lemma 3.2 to the set B′′andε= min{µ,η}/2, i.e. let us choose an ε-netS⊆B′′ofB′′. By
adding up to d+1additional points to S, we may assume that 0is in the interior of the convex hull of S.
We may furthermore assume that Sis0-symmetric, meaning that −S=S(indeed, for every point s∈Swe
may add the point −stoSif it is not already contained in S).
Now, for every hyperplane H∈ Hthere exist points in Son both sides of H(more precisely, the two open
half-spaces bounded by Hboth contain at least one point in S). Indeed, since f(H)≥η, there exist points
b1∈B′′
1(H)⊆B′′andb2∈B′′
2(H)⊆B′′withdist2(b1,H)≥ηanddist2(b2,H)≥η. Note that b1andb2
are on opposite sides of the hyperplane H(and not on Hitself). Now, we can choose points s1,s2∈Swith
||s1−b1|| ≤ε≤η/2and||s2−b2|| ≤ε≤η/2. Then s1must be on the same side of Hasb2(and not on H
itself), and similar for s2. Thus, s1ands2lie on opposite sides of Hin the two open half-spaces bounded by
H. So indeed for every H∈ Hthe two open half-spaces bounded by Hboth contain at least one point in S.
Finally, let us deﬁne B′= conv(S)to be the convex hull of S. By our assumptions on S, the set B′is a
bounded 0-symmetric polytope containing 0in its interior. In particular, B′isd-dimensional
To check that dH(B′′,B′)≤µ/2, ﬁrst note that B′= conv(S)⊆conv(B′′) =B′′(asB′′is a convex set). So
we havesupb′∈B′infb∈B′′||b−b′||2= 0< µ. Furthermore, for every b∈B′′there is a point b′∈S⊆B′with
||b−b′||2≤ε≤µ/2and hence supb∈B′′infb′∈B′||b−b′||2≤µ/2. This shows that indeed dH(B′′,B′)≤µ/2.
Finally, it remains to check that the facets of B′all have diameter less than µ. So suppose that B′had a facet of
diameter at least µ. Then for the (d−1)-dimensional hyperplane Hthrough this facet, the set H∩B′′(which
contains this facet) has diameter at least µ. Hence H∈ H, but this means that the two open half-spaces
bounded by Hboth contain at least one point in S⊆B′. This is a contradiction to the fact that His a
hyperplane through a facet of B′. Hence the facets of B′indeed all have diameter less than µ.
Lemma 3.5. Letδ >0and letB,B′∈ Bdbe such that dH(B,B′)≤δ. Then for every point xon the boundary
ofBthere exists a point yon the boundary of B′with||x−y||2≤δ.
Proof. We distinguish three cases depending on the position of xin relation to B′. First, if xis on the
boundary of B′, we can take y=xto satisfy the statement in the lemma.
Next, assume that x/\⌉}atio\slash∈B′. Then, as dH(B,B′)≤δ, we have miny′∈B′||x−y′||2= inf y′∈B′||x−y′||2≤δ,
and so there exists a point y′∈B′with||x−y′||2≤δ. Now, consider the straight line segment from y′∈B′
tox/\⌉}atio\slash∈B′. This straight line segment must contain some point yon the boundary of B′, and we have
||x−y||2≤ ||x−y′||2≤δ.
Finally, assume that xis in the interior of B′. Recalling that xis on the boundary of B, letHbe a supporting
hyperplane of Bthrough x(this means that Bis contained in one of the closed half-spaces bounded by H
9andxis onH). Now consider the ray orthogonal to H, starting at x, pointing away from B. This ray needs
to contain a point yon the boundary of B′(since the start of the ray at xis in the interior of B′andB′is
bounded). If ||x−y||2> δ, then the closed Euclidean ball of radius δaround yis disjoint from the half-space
bounded by Hcontaining B. Henceinfb∈B||b−y||2= min b∈B||b−y||2> δ, which contradicts our assumption
dH(B,B′)≤δ. So we must have ||x−y||2≤δ.
4 Point sets with many special diﬀerences
The following two lemmas encapsulate the ﬁrst part of our pro ofs of Theorems 1.1 and 1.3, respectively (see
also the proof overview in Section 2). The ﬁrst of these lemma s states, roughly speaking, that for a list of
vectorsu1,...,ukin some vector space VoverQand any subset of Vwhere many diﬀerences are in the set
{±u1,...,±uk}, there must be a lot of linear dependencies among the vectors u1,...,uk. More precisely, the
span of some small subset of the vectors u1,...,ukmust contain many other vectors among u1,...,uk.
When we apply Lemma 4.1 in the next section to complete the pro of of Theorem 1.1, we will take u1,...,uk
to be the unit vectors appearing as unit distances according to some norm in a point set in Rd. If there are
many such unit distances, then the lemma implies that the spa n of some small subset of the vectors u1,...,uk
must contain many other vectors among u1,...,uk. In Section 5 we show (as the second part of our proof)
that this is a “special” property, meaning that most norms ca nnot have this property (more precisely, the set
of norms with this property is a meagre set).
Lemma 4.1. LetVbe a vector space over Q, and let u1,...,uk∈Vbe non-zero vectors in V. Letp1,...,pn∈
Vbe distinct vectors, and let us consider the graph with verte x set{1,...,n}, where for any x,y∈ {1,...,n}
we draw an edge between the vertices xandyif and only if px−py∈ {±u1,...,±uk}. For some positive
integerd, suppose that this graph has more thand
2·nlognedges. Then there exists a subset I⊆ {1,...,k},
such that we have uℓ∈spanQ(ui:i∈I)for at least d·|I|+1indicesℓ∈ {1,...,k}.
We will prove Lemma 4.1 later in this section, and then use it i n the next section to prove Theorem 1.1. The
following lemma will in a similar fashion be used to prove The orem 1.3. When applying this lemma, we will
takeFto be the ﬁeld extension of Qgenerated by all the distinct distances appearing in a given set ofnpoints
according to some given norm.
Lemma 4.2. Letd≥1be an integer and let 0< µ <1. Suppose that nis suﬃciently large with respect to
dandµ. LetF⊆Rbe a subﬁeld of R, and let Vbe a vector space over R. Letu1,...,uk∈Vbe non-zero
vectors in V, and let p1,...,pn∈Vbe distinct vectors such that not all of p1,...,pnare lying on a common
aﬃne line in V(as a vector space over R). Suppose that for all x,y∈ {1,...,n}we havepx−py∈spanF(ui)
for some i∈ {1,...,k}. Then there exists a subset I⊆ {1,...,k}, such that we have uℓ∈spanF(ui:i∈I)
for at least d·|I|+(1−µ)·n+1indicesℓ∈ {1,...,k}.
The proofs of Lemmas 4.1 and 4.2 rely on the following lemma, w hich we prove ﬁrst.
Lemma 4.3. LetVbe a vector space over a ﬁeld F, and let u1,...,uk∈Vbe linearly independent vectors
inV. For some n≥1, letp1,...,pn∈Vbe distinct vectors, and let Gbe a graph with vertex set {1,...,n}
satisfying the following two conditions
•For every edge xyof the graph G, we have px−py∈spanF(ui)for some i∈ {1,...,k}.
•For each i∈ {1,...,k}, the subgraph of Gconsisting of all edges xywithpx−py∈spanF(ui)is a forest.
Then the graph Ghas at most1
2·nlognedges.
10In the proof of this lemma, we will use the following simple in equality.
Lemma 4.4. For any positive integers n1≥n2≥ ··· ≥nℓ≥1withn=n1+···+nℓ(andℓ≥1), we have
n1−1
2ℓ/summationdisplay
i=1nilogni≥n−1
2·nlogn.
Proof. Recall that the binary entropy function given by H(t) =−tlogt−(1−t)log(1−t)fort∈(0,1)and
H(0) =H(1) = 0 is a concave function on the interval [0,1]. It intersects the line given by 2−2tatt=1
2and
t= 1, and so for1
2≤t≤1we have H(t)≥2−2tand therefore t+1
2H(t)≥1.
Let us now prove the desired statement by induction on ℓ. Forℓ= 1, we have n1=nand the statement is
trivially true. So let us assume that ℓ≥2and that we already proved the lemma for ℓ−1. Now, setting
n′
1=n1+nℓ≤2n1, we have1
2≤n1/n′
1≤1and therefore
n1−1
2·n1logn1−1
2·nℓlognℓ=n1−1
2·n′
1·logn′
1−1
2·n1·log(n1/n′
1)−1
2·nℓ·log(nℓ/n′
1)
=−1
2·n′
1·logn′
1+n′
1·/parenleftbiggn1
n′
1−1
2·n1
n′
1·log(n1/n′
1)−1
2·nℓ
n′
1·log(nℓ/n′
1)/parenrightbigg
=−1
2·n′
1·logn′
1+n′
1·/parenleftbiggn1
n′
1+1
2·H(n1/n′
1)/parenrightbigg
≥ −1
2·n′
1·logn′
1+n′
1.
Thus,
n1−1
2ℓ/summationdisplay
i=1nilogni≥n′
1−1
2·n′
1logn′
1−ℓ−1/summationdisplay
i=2nilogni≥n−1
2·nlogn,
where the last inequality follows from the induction hypoth esis applied to n′
1≥n2≥ ··· ≥nℓ−1(noting that
n′
1+n2+···+nℓ−1= (n1+nℓ)+n2+···+nℓ−1=n).
Now, we are ready to prove Lemma 4.3.
Proof of Lemma 4.3. We will prove the lemma by induction on n. Ifn= 1, then the graph has 0 =
(1/2)·1·log1edges.
So let us now assume that n≥2, and that we have already proved the lemma for all smaller val ues ofn. Let
Gbe a graph as in the statement of the lemma.
If the graph Gis not connected, then we can divide it into two disconnected parts with n1≥1andn2≥1
vertices (where n1+n2=n). By the induction assumption these parts have at most (1/2)·n1logn1and
(1/2)·n2logn2edges, respectively. Hence, the total number of edges in Gis at most
1
2·n1logn1+1
2·n2logn2≤1
2·(n1+n2)logn=1
2·nlogn,
as desired. So let us from now on assume that Gis connected.
IfGhas no edges, the desired conclusion trivially holds, so let us assume that Ghas at least one edge xy.
Then there exists some index i∈ {1,...,k}withpx−py∈spanF(ui). Upon relabelling, we may assume that
i=k, i.e. we may assume that there exists at least one edge xyinGwithpx−py∈spanF(uk).
Let us now colour any edge xyinGred if we have px−py∈spanF(uk). Then there is at least one red edge
inG. We remark that by the second condition on the graph Gin the statement of Lemma 4.3 the red edges
form a forest.
11Let us ﬁx an arbitrary vertex z∈ {1,...,n}. Since Gis connected, every vertex w∈ {1,...,n}can be
reached by some path in Gstarting at z. For every edge xyalong this path, we have px−py∈spanF(ui)
for some i∈ {1,...,k}. Adding up px−pyfor all edges xyalong the path now gives a representation
pw=pz+a1u1+···+akukwith coeﬃcients a1,...,a k∈F. As the vectors u1,...,uk∈Vare linearly
independent over F, for every given w∈ {1,...,n}there is a unique such representation. In particular, for
everyw∈ {1,...,n}, the vector pwlies in exactly one of the sets pz+auk+Fu1+···+Fuk−1fora∈F.
This gives a partition of the vertices w∈ {1,...,n}into subsets Wafora∈F, where for each a∈Fthe
setWaconsists of those vertices w∈ {1,...,n}such that pw∈pz+auk+Fu1+···+Fuk−1. Note that/summationtext
a∈F|Wa|=n.
Ifxyis an edge in Gwhich is not red, then xandymust belong to the same set Wa. Indeed, we have
px−py∈spanF(ui)for some i∈ {1,...,k}and so if px∈pz+auk+Fu1+···+Fuk−1, then we have
py∈pz+auk+Fu1+···+Fuk−1as well. Hence, every non-red edge of Gis inside one of the induced
subgraphs G[Wa]fora∈FwithWa/\⌉}atio\slash=∅.
Recall that the red edges of Gform a forest. We claim that for every a∈Fthe vertices in the set Wa
must all be in distinct connected components of the red fores t. Indeed, suppose towards a contradiction
that for some a∈Fthere are two distinct vertices w,w′∈Wabelonging to the same component of the
red forest. Then wandw′can be connected by a path of red edges, and for all edges xyon this path we
havepx−py∈spanF(uk). Adding this up over all edges on the path between wandw′, we conclude that
pw−pw′∈spanF(uk). On the other hand, since w,w′∈Wa, we have pw,pw′∈pz+auk+Fu1+···+Fuk−1
and hence pw−pw′∈spanF(u1,...,uk−1). Since the vectors u1,...,uk∈Vare linearly independent over F,
this implies that pw−pw′=0, which is a contradiction (as the points p1,...,pnare distinct). So indeed, for
eacha∈F, the vertices in Wabelong to distinct connected components of the red forest.
Recalling that there is at least one red edge in G, the two endvertices of this edge must be in diﬀerent sets
WaandWa′. Thus, at least two of the sets Wafora∈Fare non-empty, and since/summationtext
a∈F|Wa|=n, we have
|Wa|< nfor alla∈F.
We can now apply the induction hypothesis to each of the graph sG[Wa]fora∈FwithWa/\⌉}atio\slash=∅, and obtain
thate(G[Wa])≤1
2·|Wa|·log|Wa|whenever Wa/\⌉}atio\slash=∅. Hence, the number of non-red edges in Gis at most
/summationdisplay
a∈F
Wa/negationslash=∅1
2·|Wa|·log|Wa|=1
2/summationdisplay
a∈F
Wa/negationslash=∅|Wa|·log|Wa|.
Leta∗∈Fbe such that |Wa∗|is of maximal size among the sets |Wa|fora∈F. Then we have |Wa| ≤ |Wa∗|
for alla∈F.
We claim that the number of red edges in Gis at most n−|Wa∗|. Indeed, the vertices in Wa∗are all in distinct
components of the forest formed by the red edges. Hence, this forest has at least |Wa∗|components and can
therefore have at most n−|Wa∗|edges.
Thus, the total number of edges in G(both red edges and non-red edges) is bounded by
e(G)≤n−|Wa∗|+1
2/summationdisplay
a∈F
Wa/negationslash=∅|Wa|·log|Wa| ≤n−/parenleftbigg
n−1
2·nlogn/parenrightbigg
=1
2·nlogn,
where the second inequality follows from Lemma 4.4.
Remark. The assertion of Lemma 4.3 is tight for every nwhich is a power of two, as shown by a generic em-
bedding of the graph of the k-dimensional hypercube. Indeed, for any linearly independ ent vectors u1,...,uk,
12we can take p1,...,pnwithn= 2kto be all subset sums of {u1,...,uk}. Now letting Gbe thek-dimensional
hypercube graph (with1
2·2kk=1
2·nlognedges), all conditions in Lemma 4.3 are satisﬁed (each of the forests
in the second condition is a perfect matching). For the proof of Theorem 1.1 we only need a special case of
Lemma 4.3 in which Gconsists only of edges xyfor which px−py∈ {±u1,...,±uk}(then each of the forests
in the second condition in the lemma is a collection of vertex -disjoint paths). In this case, it is easy to see that
the graph Gis a subgraph of the inﬁnite graph of all integer sequences in which two sequences are adjacent if
and only if they are equal in all coordinates but one, and in th is coordinate they diﬀer by one. The precise
maximum possible number of edges of a subgraph of nvertices of this graph is known by the isoperimetric
inequality of Bollobás and Leader [5, Theorem 15]. It implies the assertion of the lemma for this special case,
and supplies also the tight best possible value for all value s ofnand not only for powers of two.
The second ingredient for the proof of Lemmas 4.1 and 4.2 is th e following.
Lemma 4.5. LetVbe a vector space over a ﬁeld F, and let u1,...,uk∈Vbe non-zero vectors in V. Let
d≥1andm≥0be integers, and suppose that for every subset I⊆ {1,...,k}, we have uℓ∈spanF(ui:i∈I)
for at most d·|I|+mindicesℓ∈ {1,...,k}. For some real number M >0, letλ1,...,λ kbe real numbers in
the interval [0,M]. Then there exists a subset J⊆ {1,...,k}such that the vectors ujforj∈Jare linearly
independent (over F) and such that
/summationdisplay
j∈Jλj≥λ1+···+λk−m·M
d.
Proof. Upon relabelling, we may assume without loss of generality t hatλ1≥λ2≥ ··· ≥ λk. Let us now
construct a sequence of distinct indices j1,...,jr∈ {1,...,k}as follows. For any s≥1, having already chosen
the indices j1,...,js−1, choose jsto be the minimum index such that ujs/\⌉}atio\slash∈spanF(uj1,...,ujs−1)if such an
index exists. If such an index does not exist, i.e. if u1,...,uk∈spanF(uj1,...,ujs−1), let us terminate the
sequence j1,...,js−1without choosing any further terms by setting r=s−1. Note that when the sequence
terminates we have u1,...,uk∈spanF(uj1,...,ujr). By our assumption applied to I={j1,...,jr}, this
implies that k≤d·|I|+m=d·r+m.
Since we have uji/\⌉}atio\slash∈spanF(uj1,...,uji−1)fori= 1,...,m , the vectors uj1,...,ujmare linearly independent.
Now, we claim that for s= 1,...,r , we have js≤(s−1)d+m+1. Indeed, suppose that for some 1≤s≤m, we
hadjs>(s−1)d+m+1. By the choice of js, this would mean that u1,...,u(s−1)d+m+1∈spanF(uj1,...,ujs−1).
But this contradicts our assumption for the set I={j1,...,js−1}. Hence, we must indeed have js≤(s−1)d+
m+1fors= 1,...,r .
Let us now deﬁne J={j1,...,jr}. Then the vectors ujforj∈J, i.e. the vectors uj1,...,ujr, are linearly
independent. Furthermore, deﬁning 0 =λk+1=λk+2=...for notational convenience, we have
d·/summationdisplay
j∈Jλj=d·r/summationdisplay
s=1λjs≥d·r/summationdisplay
s=1λ(s−1)d+m+1≥r/summationdisplay
s=1(λ(s−1)d+1+m+···+λsd+m) =λm+1+λm+2+···+λrd+m
Here, we used that λ1≥λ2≥...andjs≤(s−1)d+m+ 1fors= 1,...,r . Recalling k≤rd+mand
0 =λk+1=λk+2=..., we can conclude that
d·/summationdisplay
j∈Jλj≥λm+1+λm+2+···+λrd+m=λ1+···+λk−(λ1+···+λm)≥λ1+···+λk−m·M.
Rearranging now gives/summationtext
j∈Jλj≥(λ1+···+λk−mM)/d, as desired.
Remark. The assertion of the Lemma 4.5 can also be established in a sho rter way by applying the matroid
partition theorem of Edmonds and Fulkerson [15]. To do so, de ﬁned+1matroids M1,...,M d+1on the set of
13vectors{u1,...,uk}. Each of the ﬁrst dmatroids M1,...,M dis the usual linear independence matroid: a set
of vectors is independent if and only if it is linearly indepe ndent. In the last matroid Md+1, a set is independent
if and only if it contains at most mvectors. If every subset Iof the vectors spans at most d· |I|+mof the
vectors, then for every set of vectors Jthe sum of ranks of Jaccording to the d+1matroids M1,...,M d+1
is at least |J|. By the Edmonds–Fulkerson Theorem this implies that the set {u1,...,uk}can be partitioned
intod+1subsets, where one of the subsets is of size at most mand all others are linearly independent sets of
vectors. This clearly supplies the conclusion of the lemma.
Now, let us prove Lemma 4.1, using Lemmas 4.3 and 4.5.
Proof of Lemma 4.1. Suppose towards a contradiction that the desired subset I⊆ {1,...,k}does not exist.
Then for every subset I⊆ {1,...,k}, we have uℓ∈spanQ(ui:i∈I)for at most d·|I|indicesℓ∈ {1,...,k}.
LetG′be the graph with vertex set {1,...,n}as in the statement of Lemma 4.1 (where for any x,y∈ {1,...,n}
we draw an edge between the vertices xandyif and only if px−py∈ {±u1,...,±uk}). Furthermore, for
i= 1,...,k , letλibe the number of edges xyofG′withpx−py∈ {±ui}. Thenλ1+···+λk≥e(G′)>d
2·nlogn
by our assumption on the number of edges of G′.
Now, by Lemma 4.5 applied with F=Qandm= 0there exists a subset J⊆ {1,...,k}such that the vectors
ujforj∈Jare linearly independent over Qand such that/summationtext
j∈Jλj≥(λ1+···+λk)/d. We may assume
without loss of generality that J={1,...,k′}for some k′∈ {1,...,k}(otherwise, relabel the indices). Then
the vectors u1,...,uk′are linearly independent and we have λ1+···+λk′≥(λ1+···+λk)/d >1
2·nlogn.
Let us now apply Lemma 4.3 to F=Q, the linearly independent vectors u1,...,uk′∈V, the same p1,...,pn∈
Vas before, and the graph Gobtained from G′by only taking the edges xywithpx−py∈ {±u1,...,±uk′}.
Note that this graph Gsatisﬁes the two conditions in Lemma 4.3. Indeed, for every e dgexyofGwe have
px−py∈ {±ui} ⊆spanQ(ui)for some i∈ {1,...,k′}. Furthermore, for every i∈ {1,...,k′}, the edges xy
withpx−py∈spanQ(ui)are precisely the edges with px−py∈ {±ui}(asu1,...,uk′are linearly independent,
we cannot have px−py∈spanQ(ui)ifpx−py∈ {±uj}forj/\⌉}atio\slash=i), and these edges form a vertex-disjoint
collection of paths and hence a forest. Thus, by Lemma 4.3 the graphGhas at most1
2·nlognedges. On the
other hand, the number of edges of Gisλ1+···+λk′>1
2·nlogn, since for every i= 1,...,k′there are λi
edgesxyinGwithpx−py∈ {±ui}. This is a contradiction, ﬁnishing the proof of Lemma 4.1.
For the proof of Lemma 4.2, we also use the following result, p roved by Ungar [47] which states that for any n
distinct points in Rt, not all on a common line, the pairs of points deﬁne at least n−1diﬀerent line directions.
Theorem 4.6 ([47]).Givenndistinct points p1,...,pn∈Rt, not all on one common line, there are at least
n−1diﬀerent one-dimensional linear subspaces of Rtthat are of the form spanR(px−py)with1≤x < y≤n.
We remark that Ungar’s result is actually slightly stronger , namely in the case of even nhe proved that there
are at least n(and not only n−1) diﬀerent line directions (and in this stronger version, hi s bounds are tight).
Finally, let us prove Lemma 4.2, using Lemmas 4.3 and 4.5 and T heorem 4.6.
Proof of Lemma 4.2. Settingm=⌈(1−µ)·n⌉ ≤n, we want to prove that there is a subset I⊆ {1,...,k}
withuℓ∈spanF(ui:i∈I)for at least d·|I|+m+1indicesℓ∈ {1,...,k}. Suppose towards a contradiction
that the desired subset I⊆ {1,...,k}does not exist. Then for every subset I⊆ {1,...,k}, we have uℓ∈
spanF(ui:i∈I)for at most d·|I|+mindicesℓ∈ {1,...,k}.
We may assume that for every i∈ {1,...,k}there exist distinct x,y∈ {1,...,n}withpx−py∈spanF(ui)
since otherwise, we can just omit all indices ifor which this is not the case, and relabel the remaining indi ces.
14By Theorem 4.6, there are at least n−1diﬀerent line directions in spanR(p1,...,pn)⊆Vappearing among
the diﬀerences px−pywith1≤x < y≤n. For each of these diﬀerences we have px−py∈spanF(ui)for
somei∈ {1,...,k}. Hence, there must be at least n−1diﬀerent vectors ui, sok≥n−1.
Let us now construct a sequence of distinct indices j1,...,jr∈ {1,...,k}recursively as follows. Let s≥1,
and assume that we have already chosen the indices j1,...,js−1. Let us now look at the image of the point
set{p1,...,pn} ⊆Vunder the projection map V→V/spanF(uj1,...,ujs−1). For every point in this image,
let us pick a preimage phand letHs−1⊆ {1,...,n}be the resulting set of indices h∈ {1,...,n}for these
preimages. Then |Hs−1|is precisely the size of the image of {p1,...,pn}inV/spanF(uj1,...,ujs−1)and for
everyx∈ {1,...,n}there is exactly one h∈Hs−1withpx−ph∈spanF(uj1,...,ujs−1). If there exists an
indexi∈ {1,...,k}for which there is a forest on the vertex set Hs−1with at least3d
µedges such that for every
edgexyof the forest we have px−py∈spanF(ui), then let us pick such an index iand deﬁne js=i. If there
is no such index i∈ {1,...,k}, let us terminate the sequence j1,...,js−1without choosing any further terms
by setting r=s−1.
Recall that for s= 0,...,r , we deﬁned Hs⊆ {1,...,n}such that |Hs|is the size of the image of the point set
{p1,...,pn} ⊆Vunder the projection map V→V/spanF(uj1,...,ujs), and such that for every x∈ {1,...,n}
there is exactly one h∈Hswithpx−ph∈spanF(uj1,...,ujs). In particular, we have n=|H0| ≥ |H1| ≥
··· ≥ |Hr| ≥1. The following claim gives an upper bound on the length of our sequence j1,...,jr.
Claim 1: We have r≤µ
3d·n.
Proof. In order to show the claim, it suﬃces to prove that |Hs| ≤ |Hs−1|−3d
µfors= 1,...,r . Indeed, then
we have 1≤ |Hr| ≤ |H0|−r·3d
µ=n−r·3d
µ, which implies r≤µ
3d·n.
So lets∈ {1,...,r}, and consider the set Hs−1⊆ {1,...,n}. The image of the point set {p1,...,pn}in the
quotient space V′=V/spanF(uj1,...,ujs−1)is the same as the image of the point set {ph:h∈Hs−1}in this
quotient space V′.
Now,|Hs|is the size of this image under the additional projection giv en byV′→V′/spanF(ujs)
=V/spanF(uj1,...,ujs). Recall that by the deﬁnition of js, there is a forest on the vertex set Hs−1with
at least3d/µedges such that for every edge xyof the forest we have px−py∈spanF(ujs). For every such
edgexy, the points pxandpyhave the same image in V′/spanF(ujs). So for every connected component
of this forest, the corresponding points pxare mapped to the same point in V′/spanF(ujs). Since the forest
has at least3d
µedges, it has at most |Hs−1| −3d
µconnected components. Hence, the image of the point set
{ph:h∈Hs−1}inV′/spanF(ujs)has size at most |Hs−1|−3d
µ, meaning that indeed |Hs| ≤ |Hs−1|−3d
µ.
Claim 2: We have |Hr|>µ
3d·n.
Proof. Suppose towards a contradiction that |Hr| ≤µ
3d·n. Let us ﬁx some index h∗∈Hr. Then for every
h∈Hrby the assumption in Lemma 4.2 we can choose an index i(h)∈ {1,...,k}withph−ph∗∈spanF(ui(h)).
Now, deﬁning I={j1,...,jr}∪{i(h) :h∈Hr}, we have |I| ≤r+|Hr| ≤2·µ
3d·nusing Claim 1.
Note that now we have ph−ph∗∈spanF(ui:i∈I)for allh∈Hr. Furthermore, for every x∈ {1,...,n}
there is some h∈Hrwithpx−ph∈spanF(uj1,...,ujr)⊆spanF(ui:i∈I). This implies that px−ph∗=
px−ph+ph−ph∗∈spanF(ui:i∈I)for allx∈ {1,...,n}. Thus, we obtain px−py=px−ph∗−(py−ph∗)∈
spanF(ui:i∈I)for allx,y∈ {1,...,n}.
Now, we claim that we have uℓ∈spanF(ui:i∈I)for allℓ∈ {1,...,k}. Indeed, for each ℓ∈ {1,...,k}, we
assumed that there exist two distinct indices x,y∈ {1,...,k}withpx−py∈spanF(uℓ). Sincepx/\⌉}atio\slash=py, this
means that px−py=tuℓfor some t∈F\{0}. But now we have tuℓ=px−py∈spanF(ui:i∈I), implying
thatuℓ∈spanF(ui:i∈I)as claimed.
15Thus, the number of indices ℓ∈ {1,...,k}withuℓ∈spanF(ui:i∈I)is
k≥n−1≥2µ
3·n+⌈(1−µ)·n⌉+1 =d·2µ
3d·n+m+1≥d·|I|+m+1,
ifnis suﬃciently large with respect to µ. This contradicts our assumption that such a set Idoes not exist.
Now, for each i= 1,...,k , let us choose a forest Gion the vertex set Hrwith the maximum possible number
of edges such that for every edge xyof the forest we have px−py∈spanF(ui). Letλibe the number of edges
of this forest, and note that λi≤3d
µby our construction of the sequence j1,...,jr(more precisely, by the fact
that the sequence terminates at jr). In particular, the forest Gihas at most 2λinon-isolated vertices.
Recall that for any pair (x,y)∈Hr×Hrwithx/\⌉}atio\slash=y, we have px−py∈spanF(ui)for some i∈ {1,...,k}.
We claim that for each i∈ {1,...,k}there are at most (2λi)2pairs(x,y)∈Hr×Hrwithx/\⌉}atio\slash=ysuch that
px−py∈spanF(ui). Indeed, for any such pair (x,y)the vertices xandymust lie in the same component of
the forest Gi(since otherwise we could add the edge xyto the forest Gi, which would be a contradiction to our
choice of the forest Gi). Since x/\⌉}atio\slash=y, this means that xandyare both non-isolated vertices in Gi, meaning
that there are at most 2λichoices for xand at most 2λichoices for y. So for each i∈ {1,...,k}, there are
indeed at most (2λi)2pairs(x,y)∈Hr×Hrwithx/\⌉}atio\slash=ysatisfying px−py∈spanF(ui).
Since for each of the |Hr| ·(|Hr| −1)pairs(x,y)∈Hr×Hrwithx/\⌉}atio\slash=ythere exists an index i∈ {1,...,k}
withpx−py∈spanF(ui), we can conclude that
|Hr|2
2≤ |Hr|·(|Hr|−1)≤k/summationdisplay
i=1(2λi)2= 4·k/summationdisplay
i=1λ2
i≤12d
µk/summationdisplay
i=1λi.
Here we used that |Hr|>µ
3d·n≥2, which holds by Claim 2, and that λi≤3d
µfori= 1,...,k . Rearranging
yieldsλ1+···+λk≥µ
24d·|Hr|2.
Let us now apply Lemma 4.5 with M=3d
µ, recalling our assumption that for every subset I⊆ {1,...,k}, we
haveuℓ∈spanF(ui:i∈I)for at most d· |I|+mindicesℓ∈ {1,...,k}. By Lemma 4.5, there is a subset
J⊆ {1,...,k}such that the vectors ujforj∈Jare linearly independent over Fand such that
/summationdisplay
j∈Jλj≥λ1+···+λk−m·3d
µ
d≥µ
24d·|Hr|2−n·3d
µ
d.
By Claim 2 we have n·3d
µ≤/parenleftBig
3d
µ/parenrightBig2
·|Hr| ≤µ
48d·|Hr|2ifn(and therefore also |Hr| ≥µ
3d·n) is suﬃciently large
with respect to dandµ. So we can conclude that
/summationdisplay
j∈Jλj≥µ
24d·|Hr|2−n·3d
µ
d≥µ
48d·|Hr|2
d=µ
48d2·|Hr|2.
Finally, let Gbe the graph obtained by taking all edges of the forests Gjforj∈J. As the vectors ujfor
j∈Jare linearly independent over F, the edge sets of these forests are pairwise disjoint, and he nceGhas/summationtext
j∈Jλj≥µ
48d2· |Hr|2edges. On the other hand, Gsatisﬁes the assumptions in Lemma 4.3, and so Lemma
4.3 implies that Ghas at most1
2·|Hr|log|Hr|edges. Thus,
µ
48d2·|Hr|2≤e(G)≤1
2·|Hr|log|Hr|,
which is a contradiction if n(and hence also |Hr| ≥µ
3d·n) is suﬃciently large with respect to dandµ.
165 Proofs of Theorems 1.1 and 1.3: most norms have few special d istances
Fixd≥2. Recall that Bdis the collection of all closed, bounded, 0-symmetric convex bodies in Rdwith0in
the interior. The sets B∈ Bdare in direct correspondence with the norms ||.||onRd(where to every norm ||.||
onRdwe associate the set B∈ Bdarising as the unit ball of ||.||).
LetA ⊆ B dbe the set of all B∈ Bdarising as the unit ball of a norm ||.||onRdsuch that for some n≥1there
existnpoints in Rdwith more thand
2·nlognunit distances according to the norm ||.||. In order to prove
Theorem 1.1 we need to show that A ⊆ B dis a meagre set.
For Theorem 1.3, let µ >0and letn0(d,µ)>1/µbe such that the statement in Lemma 4.2 holds for all
n≥n0(d,µ). Now, let A∗
µ⊆ Bdbe the set of all B∈ Bdarising as the unit ball of a norm ||.||onRdsuch that
for some n≥n0(d,µ)there exist npoints in Rdwith at most (1−µ)·ndistinct distances according to the
norm||.||. In order to prove Theorem 1.3 it suﬃces to show that A∗
µ⊆ Bdis a meagre set. Indeed, then for
most norms on Rdit is true that for all n≥n0(d,µ)any set of npoints in Rdhas at least (1−µ)·ndistinct
distances appearing. This means that the number of distinct distances is of the form (1−o(1))·n.
Let us deﬁne m= 0in the setting of Theorem 1.1 and m=⌈(1−µ)n⌉in the setting of Theorem 1.3.
To show that AandA∗
µare meagre sets, we need to show that AandA∗
µcan be covered by a countable
union of nowhere dense subsets of Bd. We will consider suitably deﬁned subsets AA,η⊆ Bd, indexed by a
(dℓ+m+ 1)×ℓmatrixA(for a positive integer ℓ) and some rational number 0< η < π/ 2. In the setting
of Theorem 1.1, i.e. to cover the set A, we will consider rational matrices A∈Q(dℓ+m+1)×ℓ. In the setting of
Theorem 1.3, i.e. to cover the set A∗
µ, our matrices Awill have entries in the function ﬁeld Q(x1,...,x m)(i.e.
in the ﬁeld of rational functions in mvariables with rational coeﬃcients). In either case, the en tries ofAare
chosen from a countable ﬁeld, and so there are only countably many choices for such Aandη. Thus, it suﬃces
to show that A ⊆/uniontext
A,ηAA,ηorA∗
µ⊆/uniontext
A,ηAA,η, respectively, and that each of the sets AA,η⊆ Bdis nowhere
dense in Bd.
Let us now deﬁne our sets AA,η⊆ Bd, starting with the setting of Theorem 1.1 (recall that then m= 0). Given
a rational (dℓ+1)×ℓmatrixA= (aji)and given a rational 0< η < π/ 2, letAA,η⊆ Bdconsist of the unit
ballsB∈ Bdof all norms ||.||onRdfor which there exist unit vectors u1,...,udℓ+1∈Rd(i.e. vectors with
endpoints on the boundary of B) satisfying the following two conditions:
•uj=/summationtextℓ
i=1ajiuiforj= 1,...,dℓ+1.
• For all 1≤i < j≤dℓ+1, the angle between the two lines spanR(ui)andspanR(uj)is larger than η.
In the setting of Theorem 1.3, given a (dℓ+m+ 1)×ℓmatrixA= (aji)with entries in Q(x1,...,x m)and
given a rational 0< η < π/ 2, letAA,η⊆ Bdconsist of the unit balls B∈ Bdof all norms ||.||onRdfor which
there exist z1,...,zm∈Rand unit vectors u1,...,udℓ+m+1∈Rd(i.e. vectors with endpoints on the boundary
ofB) satisfying the following three conditions:
• For every entry aji∈Q(x1,...,x m)of the matrix A, the evaluation aji(z1,...,zm)∈Ris well-deﬁned
(i.e. the polynomial in the denominator of ajidoes not evaluate to zero at (z1,...,zm)).
•uj=/summationtextℓ
i=1aji(z1,...,zm)uiforj= 1,...,dℓ+m+1.
• For all 1≤i < j≤dℓ+m+1, the angle between the two lines spanR(ui)andspanR(uj)is larger than η.
In order to prove Theorems 1.1 and 1.3, it suﬃces to show that e ach of the sets AA,ηis nowhere dense and
thatA ⊆/uniontext
A,ηAA,ηandA∗
µ⊆/uniontext
A,ηAA,η, respectively. These statements will be the content of the f ollowing
lemmas.
Lemma 5.1. In the setting of Theorem 1.1, we have A ⊆/uniontext
A,ηAA,η, where the union is over all rational
(dℓ+1)×ℓmatrices A∈Q(dℓ+1)×ℓfor all positive integers ℓ, and all rational numbers 0< η < π/ 2.
17Proof. LetB∈ A. ThenBis the unit ball of a norm ||.||onRdwith the property that there exist distinct
pointsp1,...,pn∈Rdsuch that there are more thand
2·nlognunit distances according to the norm ||.||
between the points p1,...,pn. Now, let u1,...,uk∈Rdwith||u1||=···=||uk||= 1be the unit vectors
(signed arbitrarily) corresponding to the unit distances b etween the points p1,...,pn. Note that u1,...,uk
are non-zero vectors in distinct directions (i.e. the lines spanR(ui)fori= 1,...,k are all distinct).
Let us now consider Rdas an (inﬁnite-dimensional) vector space over Q, and let us apply Lemma 4.1. As in the
lemma statement, consider the graph with vertex set {1,...,n}, where for any x,y∈ {1,...,n}we draw an
edge between the vertices xandyif and only if px−py∈ {±u1,...,±uk}. Then the edges correspond precisely
to the unit distances according to ||.||among the points p1,...,pn, and so the graph has more thand
2·nlogn
edges. Thus, by Lemma 4.1, there exists a subset I⊆ {1,...,k}, such that we have uj∈spanQ(ui:i∈I)for
at leastd·|I|+1indicesj∈ {1,...,k}. Note that we must have I/\⌉}atio\slash=∅, since u1,...,ukare non-zero vectors.
Upon relabelling the indices, we may assume that I={1,...,ℓ}for some integer ℓ≥1, and that u1,...,udℓ+1∈
spanQ(ui:i∈I) = spanQ(u1,...,uℓ). Then we can ﬁnd coeﬃcients aji∈Qforj= 1,...,dℓ+1andi= 1,...,ℓ
such that uj=/summationtextℓ
i=1ajiuifor allj= 1,...,dℓ+1.
We can now take Ato be the (dℓ+ 1)×ℓmatrix with entries ajiforj= 1,...,dℓ+ 1andi= 1,...,ℓ .
Furthermore, consider the dℓ+1linesspanR(ui)fori= 1,...,dℓ+1and choose 0< η < π/ 2to be rational
and smaller than the angle between any two of these lines. The nu1,...,udℓ+1are unit vectors according to
the norm ||.||, such that uj=/summationtextℓ
i=1ajiuifor allj= 1,...,dℓ+1and such that for all 1≤i < j≤dℓ+1the
angle between the lines spanR(ui)andspanR(uj)is larger than η. This means that the unit ball Bof the norm
||.||belongs to AA,η, as desired.
Lemma 5.2. In the setting of Theorem 1.3, we have A∗
µ⊆/uniontext
A,ηAA,η, where the union is over all (dℓ+m+1)×ℓ
matrices A∈Q(x1,...,x m)(dℓ+m+1)×ℓfor all positive integers ℓ, and all rational numbers 0< η < π/ 2.
Proof. LetB∈ A∗
µ. ThenBis the unit ball of a norm ||.||onRdwith the property that for some n≥n0(d,µ)
there exist distinct points p1,...,pn∈Rdsuch that there are at most (1−µ)·n≤mdistinct distances according
to the norm ||.||between the points p1,...,pn. Now, let u1,...,uk∈Rdwith||u1||=···=||uk||= 1be the
unit vectors (signed arbitrarily) in the directions of all t he diﬀerences between the points p1,...,pn, and let
z1,...,zm>0be positive real numbers such that ||px−py|| ∈ {z1,...,zm}for all distinct x,y∈ {1,...,n}.
Note that then for all distinct x,y∈ {1,...,n}we have px−py=±zjuifor some j∈ {1,...,m}and
i∈ {1,...,k}. Deﬁning F=Q(z1,...,zm)⊆Rto be the ﬁeld extension of Qgenerated by z1,...,zm, we
obtain that for all distinct x,y∈ {1,...,n}we havepx−py∈spanF(ui)for some i∈ {1,...,k}. Furthermore,
note that u1,...,ukare non-zero vectors in distinct directions (i.e. the lines through u1,...,ukare distinct).
If all of the points p1,...,pnare on a common (aﬃne) line in Rd, then there are at least n−1distinct distances
among these points according to the norm ||.||. However we have n−1>(1−µ)·n(sincen≥n0(d,µ)>1/µ),
so this would be a contradiction. Hence, the points p1,...,pndo not all lie on a common line in Rd.
By Lemma 4.2 applied to V=RdandF=Q(z1,...,zm)⊆R, there exists a subset I⊆ {1,...,k}, such that
we haveuj∈spanF(ui:i∈I)for at least d·|I|+(1−µ)·n+1indicesj∈ {1,...,k}. As the number of such
indices is an integer, and m=⌈(1−µ)n⌉, we have uj∈spanF(ui:i∈I)for at least d·|I|+m+1indices
j∈ {1,...,k}. Note that we must have I/\⌉}atio\slash=∅, since u1,...,ukare non-zero vectors.
Upon relabelling the indices if necessary, we may assume tha tI={1,...,ℓ}for some integer ℓ≥1, and
thatu1,...,udℓ+m+1∈spanF(ui:i∈I) = spanF(u1,...,uℓ). Then we can ﬁnd coeﬃcients a∗
ji∈F=
Q(z1,...,zm)forj= 1,...,dℓ+m+1andi= 1,...,ℓ such that uj=/summationtextℓ
i=1a∗
jiuifor allj= 1,...,dℓ+m+1.
For each of these coeﬃcients a∗
ji∈Q(z1,...,zm), we can choose a rational function aji∈Q(x1,...,x m)
such that aji(z1,...,zm) =a∗
ji(i.e.ajievaluates to a∗
jiwhen plugging in z1,...,zmfor the abstract variables
18x1,...,x min the function ﬁeld Q(x1,...,x m)). Note that in particular, all the evaluations aji(z1,...,zm)for
j= 1,...,dℓ+m+1andi= 1,...,ℓ are well-deﬁned.
We can now take Ato be the (dℓ+m+1)×ℓmatrix with entries ajiforj= 1,...,dℓ+m+1andi= 1,...,ℓ .
Furthermore, consider the dℓ+m+ 1linesspanR(ui)fori= 1,...,dℓ+m+ 1and choose 0< η < π/ 2to
be rational and smaller than the angle between any two of thes e lines. Then u1,...,udℓ+m+1are unit vectors
according to the norm ||.||, such that uj=/summationtextℓ
i=1a∗
jiui=/summationtextℓ
i=1aji(z1,...,zm)uifor allj= 1,...,dℓ+m+1
and such that for all 1≤i < j≤dℓ+m+ 1the angle between the lines spanR(ui)andspanR(uj)is larger
thanη. This means that the unit ball Bof the norm ||.||belongs to AA,η, as desired.
It remains to show that each of the sets AA,ηis nowhere dense in Bd. This is the content of the following
lemma.
Lemma 5.3. Letℓ >0be an integer, let 0< η < π/ 2be a rational number, and let Abe a(dℓ+m+1)×ℓ
matrix with entries in Qor inQ(x1,...,x m). ThenAA,ηis nowhere dense in Bd.
Proof. As in the lemma statement, let the matrix A= (aji)and0< η < π/ 2be ﬁxed. To show that AA,ηis
nowhere dense in Bd, we need to show that for every B0∈ Bdand every ε >0there exist B∈ Bdandδ >0
withdH(B,B0)< εsuch that no B′∈ BdwithdH(B,B′)< δbelongs to AA,η. So let us ﬁx B0∈ Bd. It suﬃces
to show the desired statement for small ε >0(note that if the statement holds for some ε >0, then it holds
for any larger εas well).
Recall that B0⊆Rdis a closed, bounded, 0-symmetric convex body containing 0in its interior. Due to the
latter condition, there exists some s >0such that ||b||2≥2sfor all bon the boundary of B0. By making ε
smaller if needed, we may assume that ε < s.
By Lemma 3.4, applied with µ= min{ε/2,s·sin(η/3)}, we can approximate B0with a bounded 0-symmetric
polytope B1containing 0in its interior such that dH(B0,B1)< ε/2and all facets of B1have diameter at most
s·sin(η/3)(with respect to the Euclidean distance). By Lemma 3.5 every p ointbon the boundary of B1has
Euclidean distance at most ε/2< sto some point on the boundary of B0. In particular, we have ||b||2≥sfor
allbon the boundary of B1(soB1contains the Euclidean ball with radius saround the origin).
Let us now choose a system of linear inequalities of the form |oi·x| ≤sifori= 1,...,h describing the polytope
B1(with non-zero vectors o1,...,oh∈Rdand real numbers s1,...,sh>0). More formally, B1is the set of
allx∈Rdsuch that |oi·x| ≤sifori= 1,...,h . By rescaling the inequalities, we may choose the vectors
o1,...,oh∈Rdsuch that ||o1||2=···=||oh||2= 1. AsB1contains the Euclidean ball of radius saround the
origin, we have si≥sfori= 1,...,h .
Note that geometrically, one can think of o1,...,ohas the (Euclidean) unit vectors orthogonal to the (parallel
pairs of) facets of B1. Furthermore, note that every point bon the boundary of B1satisﬁes|oi·b|=sifor
somei∈ {1,...,h}.
In the setting of Theorem 1.1 (where m= 0andAhas entries in Q), let us say that an h-tuple(t1,...,th)∈Rh
isachievable if there exist distinct indices ϕ(1),...,ϕ(dℓ+ 1)∈ {1,...,h}and vectors u1,...,udℓ+1∈Rd
satisfying the following two conditions:
(a)uj=/summationtextℓ
i=1ajiuiforj= 1,...,dℓ+1, and
(b)|oϕ(j)·uj|=tϕ(j)forj= 1,...,dℓ+1.
Intuitively, an h-tuple(t1,...,th)is achievable if there is a solution (u1,...,udℓ+1)to the linear equations
prescribed by the matrix A, such that when plugging in the dℓ+1vectors u1,...,udℓ+1into some choice of
dℓ+1diﬀerent expressions |oi·x|fori∈ {1,...,h}, one obtains the corresponding entries of (t1,...,th). This
19will be relevant in our arguments in the following way: We wil l consider the polytope {x∈Rd:|oi·x| ≤
tifori= 1,...,h}(note that for (t1,...,th)close to(s1,...,sh), this can be viewed as a perturbation of the
polytope B1={x∈Rd:|oi·x| ≤sifori= 1,...,h}). Whenever there is a solution (u1,...,udℓ+1)to the
linear equations prescribed by Asuch that u1,...,udℓ+1lie on distinct facets of this polytope, then the h-tuple
(t1,...,th)must be achievable (indeed, each ujsatisﬁes |oi·uj|=tifor the index icorresponding to the
facet containing uj). Heuristically speaking, we will show that there are only f ew achievable h-tuples and that
therefore this situation can be avoided.
In the setting of Theorem 1.3 (where m=⌈(1−µ)n⌉andAhas entries in Q(x1,...,x m)), let us say that an
h-tuple(t1,...,th)∈Rhisachievable if there exist distinct indices ϕ(1),...,ϕ(dℓ+m+1)∈ {1,...,h}, real
numbers z1,...,zm∈Rand vectors u1,...,udℓ+m+1∈Rdsatisfying the following three conditions:
(o) For every entry aji∈Q(x1,...,x m)of the matrix A, the evaluation aji(z1,...,zm)∈Ris well-deﬁned.
(a)uj=/summationtextℓ
i=1aji(z1,...,zm)uiforj= 1,...,dℓ+m+1, and
(b)|oϕ(j)·uj|=tϕ(j)forj= 1,...,dℓ+m+1.
Again, intuitively, an h-tuple(t1,...,th)is achievable if there is a solution (u1,...,udℓ+m+1)to the lin-
ear equations prescribed by the matrix Awith the entries evaluated at (z1,...,zm), such that the vectors
u1,...,udℓ+m+1satisfy|oi·uj|=tifor distinct choices of indices i. This will be relevant in the same way as
indicated above in the setting of Theorem 1.1.
For an injective function ϕ:{1,...,dℓ+m+1} → {1,...,h}, let us say that (t1,...,th)∈Rhisϕ-achievable
if there are vectors u1,...,udℓ+1∈Rd(and real numbers z1,...,zm∈R) satisfying the conditions above (more
precisely, satisfying the conditions (a) to (b) in the setti ng of Theorem 1.1 and satisfying the conditions (o)
to (b) in the setting of Theorem 1.3). Then (t1,...,th)is achievable if and only if it is ϕ-achievable for some
injective function ϕ:{1,...,dℓ+m+1} → {1,...,h}.
Intuitively speaking, the following two claims show that in both of our two settings only very few h-tuples
(t1,...,th)∈Rhare achievable.
Claim 1: In the setting of Theorem 1.1, the set of all achievable h-tuples(t1,...,th)∈Rhcan be covered by
ﬁnitely many (h−1)-dimensional linear hyperplanes in Rh.
Proof. Since there are only ﬁnitely many possibilities to choose an injective function ϕ:{1,...,dℓ+ 1} →
{1,...,h}, it suﬃces to show that for every such function ϕthe set of all ϕ-achievable h-tuples(t1,...,th)∈Rh
can be covered by ﬁnitely many (h−1)-dimensional linear hyperplanes in Rh. So let us ﬁx some injective function
ϕ:{1,...,dℓ+1} → {1,...,h}.
If(t1,...,th)∈Rhisϕ-achievable, there exist vectors u1,...,udℓ+1∈Rdsatisfying conditions (a) and (b)
above. By (b), for every j= 1,...,dℓ+ 1, we have oϕ(j)·uj=tϕ(j)oroϕ(j)·uj=−tϕ(j). Note that
there are 2dℓ+1possibilities to make these sign choices. Fixing the sign ch oices, we can express each tϕ(j)for
j= 1,...,dℓ+1as a linear function of the entries of uj(with coeﬃcients given by the entries of the ﬁxed vector
oϕ(j)). However, by (a) the entries of each vector ujforj= 1,...,dℓ+1can be expressed as linear functions
of the entries of u1,...,uℓ(with coeﬃcients given by the entries of the ﬁxed matrix A= (aji)). Hence we can
express each tϕ(j)forj= 1,...,dℓ+1as a linear function of the entries of u1,...,uℓ∈Rd. Theseℓvectors
havedℓentries in total, and so each tϕ(j)forj= 1,...,dℓ+1is a linear function of the same dℓreal variables.
Since the space of all linear functions in dℓvariables only has dimension dℓ, there must be a linear dependence
between the dℓ+ 1linear functions expressing tϕ(j)forj= 1,...,dℓ+1. In other words, we obtain a linear
relationship between the values of tϕ(j)forj= 1,...,dℓ+1for each of the 2dℓ+1sign choices in condition (b).
Each such linear relationship gives rise to an (h−1)-dimensional linear hyperplane in Rh. Hence the set of
ϕ-achievable h-tuples(t1,...,th)∈Rhcan be covered by 2dℓ+1linear hyperplanes in Rh.
20Claim 2: In the setting of Theorem 1.3, the set of all achievable h-tuples(t1,...,th)∈Rhcan be covered by the
vanishing sets {(y1,...,yh)∈Rh:P(y1,...,yh) = 0}of ﬁnitely many non-zero polynomials P∈R[y1,...,yh].
Proof. Again, there are only ﬁnitely many possibilities to choose a n injective function ϕ:{1,...,dℓ+m+1} →
{1,...,h}, and so it suﬃces to show that for every such injective functi on the set of all ϕ-achievable h-tuples
(t1,...,th)∈Rhcan be covered by the vanishing sets of ﬁnitely many non-zero polynomials. So let us ﬁx some
injective function ϕ:{1,...,dℓ+m+1} → {1,...,h}.
If(t1,...,th)∈Rhisϕ-achievable, there exist vectors u1,...,udℓ+1∈Rdsatisfying conditions (o) to (b)
above. By (b), for every j= 1,...,dℓ+m+ 1, we have oϕ(j)·uj=tϕ(j)oroϕ(j)·uj=−tϕ(j). Note that
there are 2dℓ+m+1possibilities to make these sign choices. Fixing the sign ch oices, we can express each tϕ(j)for
j= 1,...,dℓ+m+1as a linear function (with real coeﬃcients) of the entries of uj(with coeﬃcients given by
the entries of the ﬁxed vector oϕ(j)). However, by (a) the entries of each vector ujforj= 1,...,dℓ+m+1can
be expressed as rational functions of z1,...,zmand the entries of u1,...,uℓ(where these rational functions are
determined by the entries of the ﬁxed matrix A= (aji)). Hence we can express each tϕ(j)forj= 1,...,dℓ+m+1
as a rational function (with real coeﬃcients) of z1,...,zmand the entries of u1,...,uℓ∈Rd. The variables
z1,...,zmand thedℓentries of the ℓvectors u1,...,uℓ∈Rdtogether are dℓ+mvariables in total, and each
tϕ(j)forj= 1,...,dℓ+m+1is a rational function (with real coeﬃcients) of these dℓ+mvariables (where
the coeﬃcients of the rational function are all determined b y the ﬁxed vectors o1,...,ohand the ﬁxed matrix
A∈Q(x1,...,x m)(dℓ+m+1)×ℓ). By Fact 3.1 there exists a non-zero real polynomial Pindℓ+m+1variables,
such that when plugging the rational functions describing tϕ(1),...,tϕ(dℓ+m+1)intoPthe resulting expression
is zero. This polynomial Pis entirely determined by o1,...,ohand the A∈Q(x1,...,x m)(dℓ+m+1)×ℓ(and
the sign choices we made above), and we have P(tϕ(1),...,tϕ(dℓ+m+1)) = 0 . Thus, for each of the 2dℓ+m+1
sign choices in condition (b), we obtain a non-zero polynomi alP∈R[y1,...,yh]such that P(t1,...,th) = 0
for every (t1,...,th)∈Rhwhich is ϕ-achievable with these sign choices in condition (b). Hence the set of
ϕ-achievable h-tuples(t1,...,th)∈Rhcan be covered by the vanishing sets of 2dℓ+m+1non-zero polynomials
P∈R[y1,...,yh].
SinceB1is bounded, there exists some c >0such that ||b||2≤cfor all b∈B1. For any (t1,...,th)∈Rh
>0,
we can consider the polytope {x∈Rd:|oi·x| ≤tifori= 1,...,h}. The maximum (Euclidean) diameter
of the facets of this polytope depends continuously on (t1,...,th)(indeed, for each j= 1,...,h , the diameter
of the subset of those x∈ {x∈Rd:|oi·x| ≤tifori= 1,...,h}maximizing oj·xdepends continuously on
(t1,...,th)). Note that for (t1,...,th) = (s1,...,sh)this polytope is precisely B1and so all of its facets have
diameter at most s·sin(η/3)(with respect to the Euclidean distance). Hence we can choos e some0< ε′<εs
2c
such that for every (t1,...,th)∈Rh
>0withsi≤ti≤si+ε′fori= 1,...,h , all facets of the polytope
{x∈Rd:|oi·x| ≤tifori= 1,...,h}have diameter at most s·sin(η/2)(with respect to the Euclidean
distance).
By Claim 1 or Claim 2, respectively, the set of achievable h-tuples(t1,...,th)∈Rhcan be covered by a ﬁnite
collection of (h−1)-dimensional linear hyperplanes in Rhor by a ﬁnite collection of vanishing sets of non-zero
polynomials in Rh. LetHbe the union of these hyperplanes or of the vanishing sets of t hese polynomials. In
either case, H⊆Rdis a closed set and Hcannot contain the entire box [s1,s1+ε′]×···×[sh,sh+ε′]. Thus,
there exists an h-tuple(t1,...,th)/\⌉}atio\slash∈Hwithsi≤ti≤si+ε′fori= 1,...,h .
Since(t1,...,th)/\⌉}atio\slash∈HandHis closed, there exists some 0< δ′< ε′/2such that we also have (t′
1,...,t′
h)/\⌉}atio\slash∈H
for all(t′
1,...,t′
h)∈Rhsatisfying |t′
i−ti| ≤δ′fori= 1,...,h (geometrically, δ′is the radius of some ball in
theℓ∞-norm around (t1,...,th)that is disjoint from H). This means that there is no achievable (t′
1,...,t′
h)
with|t′
i−ti| ≤δ′fori= 1,...,h .
21Let us now deﬁne
B={x∈Rd:|oi·x| ≤tifori= 1,...,h}
to be the convex 0-symmetric polytope described by the system of linear inequ alities|oi·x| ≤tifori= 1,...,h .
Asti≥si≥s >0fori= 1,...,h , the polytope Bcontains the Euclidean ball of radius saround the
origin, and in particular Bcontains 0in its interior. Furthermore, Bis bounded, since it is contained within
max{t1/s1,...,th/sh}B1(which is bounded). Thus, we have B∈ Bd.
Sincesi≤ti≤si+ε′fori= 1,...,h , by the choice of ε′we know that all facets of the polytope Bhave
diameter at most s·sin(η/2)(with respect to the Euclidean distance).
We claim that dH(B,B1)≤ε/2. First, note that
B1={x∈Rd:|oi·x| ≤sifori= 1,...,h} ⊆ {x∈Rd:|oi·x| ≤tifori= 1,...,h}=B,
sincesi≤tifori= 1,...,t . Thus, for every b′∈B1we have infb∈B||b′−b||2= 0. Furthermore, for every
b∈B, we have/vextendsingle/vextendsingle/vextendsingle/vextendsingleoi·s
s+ε′b/vextendsingle/vextendsingle/vextendsingle/vextendsingle=s
s+ε′·|oi·b| ≤s
s+ε′·ti≤s
s+ε′·(si+ε′)≤si
fori= 1,...,h . Hence, letting b′=s
s+ε′b, we have b′∈B1and||b−b′||2=ε′
s·||b′||2≤ε′c
s< ε/2, using that
||b′||2≤c(asb′∈B1) and that ε′<εs
2c. This shows that infb′∈B1||b′−b||2< ε/2for all b∈B. Thus, we
indeed have dH(B,B1)≤ε/2.
Now, since dH(B,B1)≤ε/2anddH(B0,B1)< ε/2, we have dH(B,B0)< εby the triangle inequality. In
order to ﬁnish the proof of Lemma 5.3, let us now show that ther e is some δ >0such that no B′∈ Bdwith
dH(B,B′)< δbelongs to AA,η.
Let us take δsuch that 0< δ < δ′and small enough such that (s·sin(η/2) +2δ)/(s−δ)≤sinη. We claim
that then for any two points b,b′∈Rdwith Euclidean distance at most δfrom the same facet of B, the angle
between the lines spanR(b)andspanR(b′)is at most η. Indeed, recalling that each facet of Bhas diameter at
mosts·sin(η/2), by the triangle inequality we have ||b−b′||2≤2δ+s·sin(η/2). Hence the sine of the angle
between the lines spanR(b)andspanR(b′)is at most ||b−b′||2/||b||2≤(s·sin(η/2)+2δ)/(s−δ)≤sinη(noting
that||b||2≥s−δ, sinceBcontains the Euclidean ball of radius saround the origin and bhas distance at
mostδto the boundary of B). So this indeed shows that the angle between the lines spanR(b)andspanR(b′)
is at most η.
It remains to show that there is no B′∈ BdwithdH(B,B′)< δbelonging to AA,η. Suppose towards a
contradiction that there exists some B′∈ AA,ηsuch that dH(B,B′)< δ. By the deﬁnition of AA,η, this
means that there are vectors u1,...,udℓ+m+1∈Rdwith endpoints on the boundary of B′, such that for all
1≤i < j≤dℓ+m+1, the angle between the two lines spanR(ui)andspanR(uj)is larger than η. Furthermore,
in the setting of Theorem 1.1 (where m= 0), we have uj=/summationtextℓ
i=1ajiuiforj= 1,...,dℓ+1. In the setting of
Theorem 1.3 we also have z1,...,zm∈Rsuch that aji(z1,...,zm)is well-deﬁned for all entries ajiofAand
such that uj=/summationtextℓ
i=1aji(z1,...,,z m)uiforj= 1,...,dℓ+m+1. Note that this means that condition (a) is
satisﬁed in the setting of Theorem 1.1 and conditions (o) and (a) are satisﬁed in the setting of Theorem 1.3.
Interpreting u1,...,udℓ+m+1as points in Rd, on the boundary of B′, by Lemma 3.5 there exist points
b1,...,bdℓ+m+1∈Rdon the boundary of Bwith||uj−bj||2< δforj= 1,...,dℓ+m+ 1(recall that
dH(B′,B)< δ). We claim that no two of the points b1,...,bdℓ+m+1can lie on the same facet or on opposite
facets of the polytope B. Indeed, if two of these points bjandbj′withj/\⌉}atio\slash=j′were on the same facet, then
by the choice of δthe angle between the lines spanR(ui)andspanR(uj)would be at most η. Similarly, if bj
andbj′withj/\⌉}atio\slash=j′were on opposite facets, then bjand−bj′would be on the same facet and so the angle
between the lines spanR(ui)andspanR(−uj) = spanR(uj)would also be at most η. In either case, this is a
22contradiction to the conditions for the vectors u1,...,udℓ+m+1. Thus, no two of the points b1,...,bdℓ+m+1
can lie on the same facet or on opposite facets of the polytope B.
Sinceb1,...,bdℓ+m+1are on the boundary of B={x∈Rd:|oi·x| ≤tifori= 1,...,h}, for every j=
1,...,dℓ+m+1we can ﬁnd some ϕ(j)∈ {1,...,h}such that |oϕ(j)·bj|=tϕ(j). Since no two of the points
b1,...,bdℓ+m+1are on the same facet or on opposite facets of B, the indices ϕ(1),...,ϕ(dℓ+m+1)∈ {1,...,h}
must be distinct, and so they deﬁne an injective function ϕ:{1,...,dℓ+m+1} → {1,...,h}.
Forj= 1,...,dℓ+m+ 1, let us deﬁne t′
ϕ(j)=|oϕ(j)·uj|. Since||uj−bj||2< δ < δ′and||oϕ(j)||2= 1, we
have|t′
ϕ(j)−tϕ(j)| ≤ |oϕ(j)·uj−oϕ(j)·bj| ≤ ||oϕ(j)||2·||uj−bj||2< δ′forj= 1,...,dℓ+m+1. For every
i∈ {1,...,h}\{ϕ(1),...,ϕ(dℓ+m+1)}, let us deﬁne t′
i=ti. Then(t′
1,...,t′
h)∈Rhsatisﬁes|t′
i−ti|< δ′for
i= 1,...,h , and so by our choice of δ′, theh-tuple(t′
1,...,t′
h)is not achievable.
On the other hand, the vectors u1,...,udℓ+m+1∈Rdsatisfy|oϕ(j)·uj|=t′
ϕ(j)forj= 1,...,dℓ+m+1, meaning
that condition (b) is satisﬁed in both the setting of Theorem 1.1 and the setting of Theorem 1.3. Since we
already saw that (a) is satisﬁed (and also (o) in the setting o f Theorem 1.3), this means that (t′
1,...,t′
h)is
ϕ-achievable and in particular achievable. This contradict ion shows that indeed there is no B′∈ Bdwith
dH(B,B′)< δbelonging to AA,η. This ﬁnishes the proof of Lemma 5.3, and hence of Theorems 1. 1 and
1.3.
6 Proof of Theorem 1.4: upper bounding the chromatic number
In this section, we prove Theorem 1.4. As mentioned in the int roduction, we will actually prove a more general
result giving an upper bound for the chromatic number of the o dd distance graph of most d-norms, in any
dimension d. The odd distance graph of a d-norm||.||is the graph whose vertices are the points in Rd, where
two points are adjacent if and only if the distance between th em according to the norm ||.||is an odd integer.
Theorem 6.1. For any d≥1, for all d-norms||.||besides a meagre set, the odd distance graph of ||.||has
chromatic number at most 2d.
Since the unit distance graph is a subgraph of the odd distanc e graph, Theorem 6.1 implies that for all 2-norms
besides a meagre set, the unit distance graph has chromatic n umber at most 4. Combined with the fact that
this chromatic number is at least 4for any2-norm [9, Theorem 3], this shows Theorem 1.4.
Proof of Theorem 6.1. Our goal is to show that every d-norm||.||for which the odd distance graph has
chromatic number larger than 2dhas the property that there exist vectors u1,...,uk∈Rdin distinct directions
with||u1||=···=||uk||= 1and a subset I⊆ {1,...,k}, such that we have uj∈spanQ(ui:i∈I)for at least
d·|I|+1indicesj∈ {1,...,k}. This would be suﬃcient, as the arguments in the previous sec tion show that
the set of d-norms with this property is a meagre set (indeed, by the seco nd half of the proof of Lemma 5.1
the unit ball of the norm ||.||is contained in the union/uniontext
A,ηAA,ηconsidered in the statement of Lemma 5.1,
and this union is a meagre set, as each of the sets AA,ηis nowhere dense by Lemma 5.3).
So let||.||be ad-norm whose odd distance graph has chromatic number larger t han2d, and suppose towards a
contradiction that it does not satisfy the property above. By the De Bruijn–Erdős Theorem, the odd distance
graph of ||.||must contain a ﬁnite subgraph Gwith chromatic number χ(G)>2d. Let p1,...,pn∈Rd
correspond to the vertices of the subgraph G. Furthermore, let u1,...,uk∈Rdbe the unit vectors (signed
arbitrarily) whose odd multiples give rise to edges of G. More precisely, u1,...,uk∈Rdis a list of non-zero
vectors in distinct directions (i.e. the lines spanR(ui)fori= 1,...,k are all distinct) with ||u1||=···=||uk||=
231such that for every edge pxpyofG(withx,y∈ {1,...,n}), there exists an index i∈ {1,...,k}and an odd
integermwithpx−py=mui.
Recall that by our assumption about the norm ||.||, for any subset I⊆ {1,...,k}we haveuj∈spanQ(ui:i∈I)
for at most d·|I|indicesj∈ {1,...,k}. By the Edmonds Matroid Decomposition Theorem [14], this imp lies
that there is a partition {1,...,k}=J1∪···∪Jdsuch that for each ℓ= 1,...,d the set vectors {ui:i∈Jℓ}is
linearly independent over Q. This gives rise to a partition of the edges of the graph Ginto subgraphs G1,...,G d,
where for any ℓ= 1,...,d , an edge pxpyofGbelongs to the subgraph Gℓif we have px−py=muifor some
indexi∈Jℓand an odd integer m.
We claim that each of the subgraphs Gℓforℓ= 1,...,d is bipartite. Indeed, suppose that for some ℓ∈ {1,...,d}
the subgraph Gℓcontains an odd cycle. Walking along the cycle and summing up the corresponding terms
px−py=muifor the edges along the cycle gives an integer linear relatio n between the vectors uifori∈Jℓ.
As the cycle is odd, there must be an index i∈Jℓsuch that an odd number of edges on the cycle contribute
a term of the form px−py=mui(with an odd integer m). For this index i, the resulting coeﬃcient of ui
in this integer linear relation is odd, and is therefore in pa rticular non-zero. Hence we obtained a non-trivial
integer linear relation between the vectors uifori∈Jℓ, contradicting the fact that these vectors are linearly
independent over Q.
Thus, for ℓ= 1,...,d , the graph Gℓmust indeed bipartite, meaning that χ(Gi)≤2. This implies χ(G) =
χ(G1∪...∪Gd)≤χ(G1)···χ(Gd)≤2d, giving the desired ﬁnal contradiction.
7 Proof of Theorem 1.2: point sets with many unit distances
This section is concerned with lower bounds for U||.||(n). Before turning to the proofs, let us introduce a
standard piece of notation that we will use throughout the se ction. Given a collection of sets S1,...,S k∈Rd
theirMinkowski sum S1+···+Skis deﬁned as the set of all points of the form x1+···+xkwithxi∈Sifor
i= 1,...,k .
7.1 Planar norms
Before proving our lower bound for U||.||(n)in Theorem 1.2 in arbitrary dimension, we begin by showing a
slightly stronger lower bound in dimension 2. We note that, as we will explain in Section 8, it is possible t o
obtain a further slight improvement.
Proposition 7.1. For every 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, we have
U/bardbl./bardbl(n)≥/parenleftbigg1
log3−o(1)/parenrightbigg
·nlogn
for alln. In other words, for every 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊land every n, there exists a set of npoints in R2such that
the number of unit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊lamong the npoints is at least/parenleftBig
1
log3−o(1)/parenrightBig
nlogn, where the
o(1)-term tends to zero as n→ ∞.
If the norm /⌊ar⌈⌊l./⌊ar⌈⌊lis not strictly convex (i.e. if the boundary of the unit ball o f the norm contains a line segment),
then we can ﬁnd npoints with at least ⌊n2/4⌋unit distances. Indeed, in this case, the corresponding uni t
distance graph contains the complete bipartite graph Km,mfor every m. So to prove Proposition 7.1, we may
assume that the norm is strictly convex.
24The main ingredient in the proof is to show that any power of a t riangle is a subgraph of the unit distance
graph of any strictly convex norm on R2. More concretely, for any k, we ﬁnd a collection of ktriangles with all
sides having unit length according to the given norm, and tak e the Minkowski sum of the vertex sets of these
triangles. This yields 3kpoints and the corresponding unit distance graph is a k-fold product of the triangle K3
(in the usual graph theoretic sense of graph products). To ﬁn d these triangles, we prove the following simple
lemma.
Lemma 7.2. Let/⌊ar⌈⌊l./⌊ar⌈⌊lbe a strictly convex 2-norm. Then for any integer kthere exist subsets S1,S2,...,S k⊆R2
of size|S1|=···=|Sk|= 3with|S1+···+Sk|= 3kand such that for each i= 1,...,k any two distinct points
inSihave unit distance according to ||.||.
Note that the condition |S1+···+Sk|= 3kmeans precisely that all the 3kpoints of the form x1+x2+···+xk
withxi∈Sifori= 1,...,k are distinct. Furthermore, note that the second condition m eans that for each
i= 1,...,k , the three points in Sidetermine a triangle with all three side lengths equal to one according to
the norm ||.||.
Proof. We construct the sets S1,S2,...one by one, maintaining the property that after S1,S2,...,S ihave
been determined, we have |S1+···+Si|= 3i. We need the simple fact (see, for example, [6, Lemma 2]) that
for any two distinct points a1anda2in a strictly convex 2-dimensional real normed space (R2,||.||)there are
at most two points b∈R2satisfying both ||b−a1||= 1and||b−a2||= 1(i.e. having unit distance from both
a1anda2).
AssumeS1,S2,...,S i−1have already been constructed, and let us now choose Si. For any point x∈R2with
||x||= 1(i.e. for any point xon the boundary of the unit ball of the norm ||.||), let us imagine that we move
a point yalong the boundary of the unit ball of ||.||fromxto the antipodal point −x. By continuity of the
distance ||y−x||asymoves, at some point in this process we must have ||y−x||= 1. In other words, for any
pointx∈R2with||x||= 1, there must be a point y(x)∈R2with||y(x)||= 1and||y(x)−x||= 1. We will
choose the set Sito consist of 0,xandy=y(x), for an appropriate choice of xwith||x||= 1. Note that then
any two distinct points in Sihave unit distance according to ||.||.
In order to ensure that |S1+···+Si|= 3i, we need to to ensure that the sets {u+0,u+x,u+y}are pairwise
disjoint for all u∈S1+S2+...+Si−1. If the sets {u+0,u+x,u+y}and{v+0,v+x,v+y}intersect
for two distinct elements u,v∈S1+S2+...+Si−1, then one of the diﬀerences x−0,y−0,x−ymust be
of the form ±(u−v). We claim that for any two distinct u,v∈S1+S2+...+Si−1, there are at most six
choices for x(with||x||= 1) such that this happens. Indeed, there are clearly at most tw o choices for xwith
x=x−0∈ {±(u−v)}. Note that xhas unit distance from both yandx−y(since||y−x||= 1and
||y||= 1). So if y=y−0∈ {±(u−v)}orx−y∈ {±(u−v)}, then xmust have unit distance from u−v
or from−(u−v). But by the above-mentioned fact, there can be at most two choi ces for xwith||x||= 1and
||x−(u−v)||= 1and at most two choices for xwith||x||= 1and||x+(u−v)||= 1. Thus, there are indeed
at most six choices for x(with||x||= 1) such that the sets {u+0,u+x,u+y}and{v+0,v+x,v+y}
intersect.
Since there are only ﬁnitely many choices for distinct u,v∈S1+S2+...+Si−1, this means that there are only
ﬁnitely many choices for xfor which the desired condition |S1+···+Si|= 3ifails. Since there are inﬁnitely
many points x∈R2with||x||= 1, we can indeed take Si={0,x,y(x)}for some suitably chosen x∈R2(with
||x||= 1) such that |S1+···+Si|= 3i.
Proposition 7.1 is an easy consequence of the last lemma.
25Proof of Proposition 7.1. As discussed previously we may assume that the norm /⌊ar⌈⌊l./⌊ar⌈⌊lis strictly convex. Now
for anyk, we can take sets S1,...,S kas in Lemma 7.2 and consider the Minkowski sum S=S1+S2+...+Sk.
This gives a set S⊆R2of size|S|= 3k, such that every point in Shas unit distance according to /⌊ar⌈⌊l./⌊ar⌈⌊lfrom
at least2kother points in S(namely, all the points in Sobtained by changing exactly one summand in the
representation x1+···+xkwithxi∈Sifori= 1,...,k ). This gives us a set of 3kpoints in R2withk·3k
unit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l, which in particular shows that the claimed bound holds with out theo(1)-term
whennis a power of three.
To obtain the asymptotic bound for every n, let us write nin base three, so n=ak·3k+ak−1·3k−1+...+a0,
wherek=⌊log3n⌋andak,...,a 0∈ {0,1,2}. For each i= 0,...,k , we now use the construction above to ﬁnd
aisets of size 3i, translated if necessary to ensure that all the points in all of these sets are distinct. In total
we obtain ak·3k+ak−1·3k−1+...+a0=npoints, and among these npoints there are at least
ak·k·3k+ak−1·(k−1)·3k−1+...+a1·1·3 =kn−3k·k/summationdisplay
i=1ak−i·i·3−i≥kn−2·3k·k/summationdisplay
i=1i·3−i≥kn−3
2n
unit distances. Since k−3
2=/parenleftBig
1
log3−o(1)/parenrightBig
logn, this completes the proof.
7.2 Higher dimension
In this section, we prove Theorem 1.2. We start by showing tha t the unit distance graph of any d-norm contains
a complete bipartite graph with one vertex class of size d−1and the other vertex class of inﬁnite size. To do so,
we need the following result, known as the Hurewicz Dimensio n Lowering Theorem (see [17, Theorem 3.3.10,
p. 200]). The notion of dimension in this theorem is the usual Lebesgue covering dimension, as described in
[17].
Theorem 7.3 (Hurewicz Dimension Lowering Theorem) .LetXandYbe metric spaces, and assume that X
is compact. Let f:X→Ybe a continuous map, such that all ﬁbers f−1(y)fory∈Yhave dimension at most
k. Then we have dim(X)≤k+dim(Y).
The following lemma is the key ingredient for our lower bound result in Theorem 1.2.
Lemma 7.4. Let||.||be ad-norm, and let ∂B={x∈Rd:||x||= 1}be the boundary of the corresponding
unit ball. Furthermore, consider distinct points y1,y2...,yd−1∈∂B, and let ε >0be a real number. Then
there exist points x1,x2...,xd−1∈Rdsatisfying /⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2≤εfori= 1,...,d−1, such that the intersection/intersectiontextd−1
i=1(xi+∂B)is inﬁnite.
Proof. Deﬁne a subset UofRd×(Rd)d−1by
U:={(x,x1,...,xd−1) :xi−x∈∂Bfori= 1,...,d−1}.
Note that Uis homeomorphic to Rd×(∂B)d−1, with a homeomorpism u:U→Rd×(∂B)d−1given by
u(x,x1,...,xd−1) = (x,x1−x,...,xd−1−x). Now, let us deﬁne
U′:={(x,x1,...,xd−1)∈U:/⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2≤εfori= 1,...,d−1}.
Observe that the image of U′under the homeomorpism u:U→Rd×(∂B)d−1deﬁned above contains the
closed set
{x∈Rd:||x||2≤ε/2}×{z1∈∂B:||z1−y1||2≤ε/2}×···×{ zd−1∈∂B:||zd−1−yd−1||2≤ε/2},(1)
26Indeed, given (x,z1,...,zd−1)in this set, we have u(x,x1,...,xd−1) = (x,z1,...,zd−1)for(x,x1,...,xd−1)∈
U′given by xi=zi+xfori= 1,...,d−1(thenxi−x∈∂Band/⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2=/⌊ar⌈⌊lx+zi−yi/⌊ar⌈⌊l2≤ /⌊ar⌈⌊lx/⌊ar⌈⌊l2+/⌊ar⌈⌊lzi−yi/⌊ar⌈⌊l2≤
ε).
Fori= 1,...,d−1, we have yi∈∂Band hence the set {zi∈∂B:||zi−yi||2≤ε/2}contains a closed subset
that is homeomorphic to [0,1]d−1(indeed, the map z/ma√sto→z/||z||2deﬁnes a homeomorphism from this set to a
subset of the (d−1)-dimensional unit sphere in Rdcontaining some spherical cap of positive radius). Thus,
the set in (1) has a closed subset that is homeomorphic to [0,1]d+(d−1)2. Therefore the dimension of the closed
set in (1) is at least d+(d−1)2, and consequently dim(U′)≥d+(d−1)2.
Furthermore, the set U′is closed and bounded (for boundedness, note that /⌊ar⌈⌊lx/⌊ar⌈⌊l ≤ /⌊ar⌈⌊lx1/⌊ar⌈⌊l+1and/⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2≤ε
fori= 1,...,d−1for all(x,x1,...,xd−1)∈U′). Thus, U′is compact. Now, let us consider the continuous
projection map f:U′→(Rd)d−1given by f(x,x1,x2,...,xd−1) = (x1,x2,...,xd−1).
Sincedim((Rd)d−1) =d(d−1)<dim(U′), by the Hurewicz Dimension Lowering Theorem applied to the p ro-
jection map f:U′→(Rd)d−1, there exist points x1,x2,...,xd−1∈Rdsuch that the ﬁber f−1(x1,x2,...,xd−1)
has dimension at least one. Then this ﬁber must be inﬁnite, so there are inﬁnitely many points x∈Rdwith
(x,x1,x2,...,xd−1)∈U′. By the deﬁnition of U′, this implies /⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2≤εfori= 1,...,d−1. Furthermore,
each of the inﬁnitely many points xwith(x,x1,x2,...,xd−1)∈U′⊆Usatisﬁes xi−x∈∂Bfori= 1,...,d−1,
meaning that x−xi∈∂Bandx∈xi+∂B. Thus, each of these points xlies in the intersection/intersectiontextd−1
i=1(xi+∂B),
so this intersection is inﬁnite.
An easy consequence of the last lemma is the following.
Lemma 7.5. Letkbe a positive integer and let /⌊ar⌈⌊l./⌊ar⌈⌊lbe ad-norm. Then there exist points x1,...,xd−1∈Rd
with|{x1,2x1,...,kx1}+···+{xd−1,2xd−1,...,kxd−1}|=kd−1and an inﬁnite set S⊆Rdsuch that every
pointz∈Ssatisﬁes/⌊ar⌈⌊lz−xi/⌊ar⌈⌊l= 1fori= 1,...,d−1.
Proof. Let∂Bbe the boundary of the unit ball of the norm /⌊ar⌈⌊l./⌊ar⌈⌊l. Let us choose points y1,...,yd−1∈∂Bsuch
that|{y1,2y1,...,ky1}+···+{yd−1,2yd−1,...,kyd−1}|=kd−1(we can choose the points y1,...,yd−1one
at a time, maintaining the condition |{y1,2y1,...,ky1}+···+{yi,2yi,...,kyi}|=kifori= 1,...,d−1,
by observing that after choosing y1,...,yi−1each potential equality between two diﬀerent sums of the for m
a1y1+...+aiyiwitha1,...,ai∈ {1,...,k}forbids only a single choice for yi). Letε >0be suﬃciently
small, such that any two distinct points in {y1,2y1,...,ky1}+···+{yd−1,2yd−1,...,kyd−1}have Euclidean
distance larger than 2k(d−1)ε. Now, by applying Lemma 7.4 with y1,...,yd−1andε, we obtain points
x1,x2...,xd−1with/⌊ar⌈⌊lxi−yi/⌊ar⌈⌊l2≤εfori= 1,...,d−1, such that the intersection/intersectiontextd−1
i=1(xi+∂B)is inﬁnite.
Now, each point in {x1,2x1,...,kx1}+···+{xd−1,2xd−1,...,kxd−1}is of the form a1x1+...+ad−1xd−1with
a1,...,a d−1∈ {1,...,k}and has distance at most k(d−1)εfrom the corresponding point a1y1+...+ad−1yd−1.
By our choice of ε, this means that the points a1x1+...+ad−1xd−1witha1,...,a d−1∈ {1,...,k}must all
be distinct and hence |{x1,2x1,...,kx1}+···+{xd−1,2xd−1,...,kxd−1}|=kd−1. Furthermore, deﬁning
S=/intersectiontextd−1
i=1(xi+∂B), the set Sis inﬁnite and every point z∈Ssatisﬁes/⌊ar⌈⌊lz−xi/⌊ar⌈⌊l= 1fori= 1,...,d−1.
We are now ready to prove Theorem 1.2.
Proof of Theorem 1.2. Throughout the argument, we treat das a ﬁxed constant and all the asymptotics are
with respect to large n. Let us choose m:=/ceilingleftBig
log/parenleftBig
n
logn/parenrightBig/ceilingrightBig
=o(n)andk=/floorleftbig
(n/2m)1/(d−1)/floorrightbig
= Θ((log n)1/(d−1)),
so that when writing n′=kd−1·2m, we have n≥n′≥kd−1/(k+1)d−1·n= (1−o(1))n. Let/⌊ar⌈⌊l./⌊ar⌈⌊lbe ad-norm.
By Lemma 7.5 there exist points x1,...,xd−1∈Rdwith|{x1,2x1,...,kx1}+···+{xd−1,2x1,...,kxd−1}|=
kd−1and an inﬁnite subset S⊆Rdsuch that /⌊ar⌈⌊lz−xi/⌊ar⌈⌊l= 1for allz∈Sandi= 1,...,d−1. Now, let us choose
27points z1,...,zm∈Ssuch that the set
{x1,2x1,...kx1}+···+{xd−1,2xd−1,...,kxd−1}+{0,z1}+···+{0,zm} (2)
has sizekd−1·2m=n′(this is possible by once again choosing the points z1,...,zm∈Sone by one, observing
that at each step every potential equality between two diﬀer ent sums of the form a1x1+...+ad−1xd−1+b1z1+
...+bjzjwitha1,...,ad−1∈ {1,...,k}andb1,...,bj∈ {0,1}forbids at most one choice for zj).
Now, note that every vector of the form zj−xiwithi∈ {1,...,d−1}andj∈ {1,...,m}occurrs as the
diﬀerence of at least (k−1)·kd−2·2m−1pairs of points in the set in (2). Since /⌊ar⌈⌊lzj−xi/⌊ar⌈⌊l= 1for alli∈ {1,...,d−1}
andj∈ {1,...,m}, this means that among the n′points in the set in (2), there are at least
(d−1)m·(k−1)kd−2·2m−1=d−1
2·/parenleftbigg
1−1
k/parenrightbigg
·(logn′−(d−1)logk)·n′=d−1−o(1)
2·n′logn′
unit distances. Since n′logn′= (1−o(1))nlognandn′≤n, this shows there exists a set of at most npoints
inRdwith at leastd−1−o(1)
2·nlognunit distances according to the norm ||.||(by adding more points we can
form such a set with exactly npoints).
8 Concluding remarks and open problems
We have shown in Theorem 1.2 that for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, we have U/bardbl./bardbl(n)≥1
2(d−1−o(1))·nlogn. In other
words,Rdcontains npoints that determine at least1
2(d−1−o(1))·nlognunit distances according to /⌊ar⌈⌊l./⌊ar⌈⌊l,
where the o(1)-term tends to zero as n→ ∞. This is nearly tight, as we have proved in Theorem 1.1 that
there are d-norms in which no set of npoints determines more than1
2d·nlognunit distances. In fact, almost
alld-norms satisfy this property. For d= 2this settles a problem raised by Brass in [6] and by Matoušek
in [34], shaving a loglognfactor from Matoušek’s upper bound. For general dimension d≥2, this provides
an essentially tight estimate, up to a (1−1/d−o(1))constant factor, and settles, in a strong and somewhat
surprising form, Problems 4 and 5 in [8, p. 195].
Ford= 2we have shown in Proposition 7.1 that U/bardbl./bardbl(n)≥(1
log3−o(1))·nlognfor every 2-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, improving
upon a well-known and often repeated lower bound of1
2·nlogncoming from the embedding of the hypercube
described in the introduction. Our upper bound in Theorem 1. 1 for most 2-norms/⌊ar⌈⌊l./⌊ar⌈⌊lisU/bardbl./bardbl(n)≤nlogn, so
there is still a gap between the constant factors in the lower and upper bound. In fact, the constant factor
1
log3in our new lower bound can be slightly improved. To do so, note that the construction in the proof of
Proposition 7.1 is a Minkowski sum of sets Si={0,xi,yi}. When choosing these sets, the choices of the
points xiare essentially arbitrary, and it is thus possible to choose them so that for every i≥1, the points
x4i−3+x4i−2andx4i−1+x4ihave unit distance according to /⌊ar⌈⌊l./⌊ar⌈⌊l. Similarly, an additional (tiny) improvement
can be obtained by repeating this argument recursively. As t his still leaves a gap between the upper and lower
bounds, we omit the detailed computation. It may be interest ing to close the gap between our upper and lower
bounds for all dimensions, although our bounds in Theorems 1 .1 and 1.2 are already quite close (in particular,
the bounds get closer as the dimension increases). It seems t hat this will require some new ideas.
The proof of Theorem 1.1 applies the fact, established in Sec tion 5, that for most d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lthere cannot be
too many linear dependencies over the rationals between the unit vectors (more precisely, for a given number
of unit vectors, their linear span over the rationals cannot contain too many other unit vectors). It is worth
noting, however, that some such linear dependencies always exist. In particular, the triangles constructed in the
proof of Lemma 7.2 show that in every strictly convex 2-norm there are inﬁnitely many triples of unit vectors
whose sum is 0. Similarly, a simple application of the Hurewicz Dimension Lowering Theorem (Theorem 7.3)
implies that for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l, there are inﬁnitely many (d−1)-tuples(x1,...,xd−1)of points of unit norm
28according to /⌊ar⌈⌊l./⌊ar⌈⌊lsuch that the (d−2)-tuple of diﬀerences (x2−x1,...,xd−1−x1)is the same for all these
(d−1)-tuples(x1,...,xd−1). In particular, this means that for any ℓ≥d−1, we can ﬁnd a set of ℓunit vectors
inRdwhose linear span over the rationals contains at least (d−1)·(ℓ−d+2)unit vectors according to /⌊ar⌈⌊l./⌊ar⌈⌊l(in
comparison, the arguments in Section 5 show that for a typica ld-norm such a span can contain at most d·ℓ
unit vectors).
Theorem 1.3 provides nearly tight bounds for the largest pos sible value of D/bardbl./bardbl(n)for ad-norm/⌊ar⌈⌊l./⌊ar⌈⌊lwhenn
is suﬃciently large as a function of d. As far as we know it may be true that an even stronger bound hol ds,
namely that for every ﬁxed d, ifnis suﬃciently large as a function of d, then there is a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊lso that
D/bardbl./bardbl(n) =n−1. This might even hold for most norms. A proof of this, if true, would require some additional
arguments. A careful inspection of the computation in our ex isting proof shows that it implies that for any d
andn, we have D/bardbl./bardbl(n)≥n−O(dn3/4)for most d-norms/⌊ar⌈⌊l./⌊ar⌈⌊l. When nis not large as a function of d, then
the determination of the largest possible value of D/bardbl./bardbl(n)among all d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lis a diﬃcult problem. In
particular, the determination of the largest value of nso thatD/bardbl./bardbl(n) = 1 for alld-norms/⌊ar⌈⌊l./⌊ar⌈⌊lis equivalent to
a well-known conjecture of Petty, as we describe next.
The number of vertices in the largest clique that can be embed ded in the unit distance graph of /⌊ar⌈⌊l./⌊ar⌈⌊lis called
the equilateral number of /⌊ar⌈⌊l./⌊ar⌈⌊l, which we denote here by e/bardbl./bardbl(equilateral numbers have also been considered
in other types of spaces, see e.g. [16]). A conjecture of Pett y raised in 1971 ([36], see also [8]) asserts that
e/bardbl./bardbl≥d+1for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊l. Note that an equivalent formulation of this conjecture is t hatD/bardbl./bardbl(n) = 1
for every d-norm/⌊ar⌈⌊l./⌊ar⌈⌊land every n≤d+1(or equivalently, for n=d+1).
This is known in dimension d≤3([36]), and is also known for norms that are suﬃciently close to thed-
dimensional Euclidean norm ([7], [12]), or more generally t o thed-dimensional ℓp-normℓd
pfor any1< p≤ ∞
([44]). Combining this with a result of [2] asserting that ev eryd-dimensional normed space contains a subspace
of dimension r=eΩ(√logd)which is either close to ℓr
2or toℓr
∞, it was proved by Swanepoel and Villa [44]
that the equilateral number e/bardbl./bardblof anyd-norm/⌊ar⌈⌊l./⌊ar⌈⌊lis at least eb√logdfor some absolute constant b >0. It
is interesting to note that the exact value of the equilatera l number e/bardbl./bardblis not known even for some simple
d-norms like ℓd
1, where it is conjectured to be 2d. See [3], [42], [43] for more information.
Petty’s problem as well as the constructions in Section 7 sug gest the investigation of graphs that appear as
subgraphs in the unit distance graph of any d-norm for some given d≥2. Any hypercube graph (of any
dimension) is an example of such a graph, and a clique of size eb√logdis another such example (for the absolute
constant b >0in the above-mentioned result of Swanepoel and Villa [44]). The complete bipartite graph
Kd−1,m, for any m, is also an example, as proved in Lemma 7.5. Yet another examp le that appears as a
subgraph of the unit distance graph of any strictly convex 2-norm is the k-th power of a triangle (for any
k≥1), as shown in Lemma 7.2. A characterization of all graphs tha t are subgraphs of the unit distance graph
of anyd-norm appears to be diﬃcult.
A related problem is to determine the smallest possible chro matic number of the unit distance graph of a
d-norm. In dimension d= 2, the answer is 2and in fact we showed in Theorem 1.4 that for most 2-norms the
chromatic number is equal to 4. By the known results about Petty’s conjecture, the chromati c number of the
unit distance graph of any d-norm is always at least eΩ(√logd). On the other hand, it is not diﬃcult to show
that the chromatic number of the unit distance graph of any d-norm is at most exponential in d(see e.g. [25],
[32]). Theorem 6.1 implies an upper bound of 2dfor most d-norms (which gives a better exponential base than
the known bounds for all norms). It would be interesting to de termine whether the chromatic number of the
unit distance graph of a typical d-norm is exponential or sub-exponential in d. By our results here these graphs
are rather sparse, hence one may suspect that the chromatic n umber might be smaller than exponential.
Let us note that the book of Brass, Moser and Pach [8] serves as a remarkable repository of interesting open
problems in discrete geometry, many of which have natural ex tensions to general normed spaces. At least some
29of the ideas and tools developed in this paper may be helpful i n attacking these questions.
Many of these questions can naturally be posed for typical no rms, which in some sense play an analogous
role as random graphs do in extremal graph theory. Similarly , as with random graphs, our results showcase
that considering typical norms can provide answers to extre mal questions for general norms. They also show
that the Euclidean norm is very special in many regards, and e xhibits a diﬀerent behaviour with respect to
many of these problems than most other norms. In particular, by the known bounds for D/bardbl./bardbl2(n)andU/bardbl./bardbl2(n)
mentioned in the introduction, our results show that the beh aviour for the Euclidean 2-norm with respect to
the unit distance problem and the distinct distances proble m is very diﬀerent from the behaviour for a typical
2-norm, and this diﬀerence only becomes more pronounced in hi gher dimensions. While this might be natural
in view of the symmetry of the Euclidean norm, we ﬁnd it surpri sing that in comparison, for a typical d-norm
/⌊ar⌈⌊l./⌊ar⌈⌊l,U/bardbl./bardbl(n)is so small and D/bardbl./bardbl(n)is so large.
An intriguing open question is to describe explicitly a d-norm/⌊ar⌈⌊l./⌊ar⌈⌊lfor which U/bardbl./bardbl(n) =O(dnlogn)or for which
D/bardbl./bardbl(n)≥(1−o(1))n(for large n). Note that a formal statement of this question requires a de ﬁnition of the
notion “explicit” here, a natural one is a norm /⌊ar⌈⌊l./⌊ar⌈⌊lfor which there is an eﬃcient algorithm (in any standard
model of computation over the reals) for computing the norm /⌊ar⌈⌊lx/⌊ar⌈⌊lof any given vector x∈Rd. Note also that
it is not even obvious that there exists an explicit d-norm as above.
As another application of our methods, we can resolve an anal ogue of a classical question of Erdős and Moser [21]
for typical norms. In 1959, Erdős and Moser asked about the ma ximum possible number of unit distances
amongnpoints in (strictly) convex position in the Euclidean plane, and conjectured that the an swer isO(n).
Füredi [24] proved an upper bound of the form O(nlogn), and the current best bound is still of this form
(Aggarwal [1] improved Füredi’s bound by a constant factor) . The best-known lower bound of 2n−7is due to
Edelsbrunner and Hajnal [13].
Our arguments show that the conjecture of Erdős and Moser is t rue for most planar norms. More concretely,
they imply that for most norms the maximum number of unit dist ances among npoints in a strictly convex
position in the plane is at most 4n. Indeed, the arguments in Section 5 imply that for most plana r norms,
for a list of unit vectors u1,...,uℓ, the span spanQ(u1,...,uℓ)contains a total of at most 2ℓunit vectors in
diﬀerent directions (where we consider two unit vectors to h ave the same direction if they agree up to sign).
For anynpoints in a strictly convex position in the plane, we can cons ider the graph corresponding to the unit
distances between these points and choose a maximal spannin g forest in this graph (i.e. we choose a spanning
tree for each component of the graph). Let u1,...,uℓbe the unit vectors corresponding to the edges of this
spanning forest, and note that ℓ≤n−1. Now, any unit vector appearing as a distance between two of t hen
points can be written as a sum of some of the vectors u1,...,uℓor their negatives (since the two endpoints of
the corresponding edge of the graph can be connected by a path in the spanning forest). Hence any unit vector
appearing as a distance between the npoints must be in spanQ(u1,...,uℓ), and so for a typical norm there
can be at most 2ℓ≤2n−2diﬀerent directions of such unit vectors. On the other hand, since the npoints are
in a strictly convex position, for any unit vector u, there can be at most two pairs of points with distance ±u.
Hence, for a typical planar norm, there can be a total of at mos t4n−4unit distances among npoints in a
strictly convex position.
Another interesting open problem we suggest is the possible existence of a zero-one law for typical d-norms: Is
it true that for every ﬁxed d≥2and every ﬁxed graph H, exactly one of the following two options holds?
• For all d-norms||.||besides a meagre set, the unit distance graph of ||.||contains Has a subgraph.
• For all d-norms||.||besides a meagre set, the unit distance graph of ||.||does not contain Has a subgraph.
Finally, we mention that we have another approach for upper- bounding U/bardbl./bardbl(n)for typical d-norms/⌊ar⌈⌊l./⌊ar⌈⌊lyielding
a somewhat weaker upper bound than in Theorem 1.1, namely of t he formO(d2nlogn). This approach is more
similar to Matoušek’s proof [34] showing U/bardbl./bardbl(n)≤O(nlognloglogn)for most 2-norms/⌊ar⌈⌊l./⌊ar⌈⌊l. In particular,
30by a probabilistic argument using a careful multiple exposu re process, we manage to improve the graph-
theoretic statement in [34, Proposition 2.1], removing the loglognfactor in this proposition (which causes
theloglognfactor in Matoušek’s result). While the resulting bound O(d2nlogn)is weaker (in terms of the
d-dependence) than the bound in Theorem 1.1, we plan to write t he proof of this improved graph theoretic
lemma in a companion note to this paper, since we believe that the argument might be useful in other settings.
In particular, a somewhat stronger variant of this lemma wou ld yield an asymptotic answer to the so-called
discrete X-Ray reconstruction problem, see [35] for more de tails.
Remark. While our paper was under review, Greilhuber, Schildkraut, and Tidor [27] found constructions
improving the lower bound for the function U||.||(n)from Theorem 1.2 to (d/2−o(1))·nlog2n. This shows
that our Theorem 1.1 is asymptotically tight.
Acknowledgments. We thank Karim Adiprasito, Pankaj Agarwal, Xiaoyu He, Bo 'az Klartag, Mehtaab
Sawhney, József Solymosi, Terence Tao and Or Zamir for usefu l conversations, and János Kollár and Assaf
Naor for leading us to reference [17]. The second author grat efully acknowledges the support of the Institute
fo Advanced Study in Princeton and the Oswald Veblen fund. We are also very grateful to the anonymous
referees for carefully reading the paper and for their helpf ul comments and suggestions.
References
[1] A. Aggarwal, On unit distances in a convex polygon , Discrete Math. 338, (2015), no. 3, 88–92.
[2] N. Alon and V. D. Milman, Embedding of ℓk
∞in ﬁnite-dimensional Banach spaces , Israel J. Math. 45
(1983), no. 4, 265–280.
[3] N. Alon and P. Pudlák, Equilateral sets in ln
p, Geom. Funct. Anal. 13(2003), no. 3, 467–482.
[4] A. Barvinok, Thrifty approximations of convex bodies by polytopes , Int. Math. Res. Not. IMRN (2014),
no. 16, 4341–4356.
[5] B. Bollobás and I. Leader, Edge-isoperimetric inequalities in the grid , Combinatorica 11(1991), no. 4,
299–314.
[6] P. Brass, Erdős distance problems in normed spaces , Comput. Geom. 6(1996), no. 4, 195–214.
[7] P. Brass, On equilateral simplices in normed spaces , Beiträge Algebra Geom. 40(1999), no. 2, 303–307.
[8] P. Brass, W. Moser, and J. Pach, Research problems in discrete geometry , Springer, New York, 2005.
[9] K. B. Chilakamarri, Unit-distance graphs in Minkowski metric spaces , Geom. Dedicata 37(1991), no. 3,
345–356.
[10] J. Davies, Odd distances in colourings of the plane , Geom. Funct. Anal. 34(2024), 19–31.
[11] A. D. N. J. de Grey, The chromatic number of the plane is at least 5 , Geombinatorics 28(2018), no. 1,
18–31.
[12] B. V. Dekster, Simplexes with prescribed edge lengths in Minkowski and Ban ach spaces , Acta Math. Hungar.
86(2000), no. 4, 343–358.
[13] H. Edelsbrunner and P. Hajnal, A lower bound on the number of unit distances between the vert ices of a
convex polygon , J. Combin. Theory Ser. A 56(1991), no. 2, 312–316.
[14] J. Edmonds, Minimum partition of a matroid into independent subsets , J. Res. Nat. Bur. Standards Sect.
B69B(1965), 67–72.
[15] J. Edmonds and D. R. Fulkerson, Transversals and matroid partition , J. Res. Nat. Bur. Standards Sect.
B69B(1965), 147–153.
[16] C. Elsholtz and W. Klotz, Maximal dimension of unit simplices , Discrete Comput. Geom. 34(2005), no. 1,
167–177.
31[17] R. Engelking, Theory of dimensions ﬁnite and inﬁnite , Sigma Series in Pure Mathematics, vol. 10, Hel-
dermann Verlag, Lemgo, 1995.
[18] P. Erdős, On some applications of graph theory to geometry , Canadian J. Math. 19(1967), 968–971.
[19] P. Erdős, Problems and results in combinatorial geometry , Discrete geometry and convexity (New York,
1982), Ann. New York Acad. Sci., vol. 440, New York Acad. Sci. , New York, 1985, pp. 1–11.
[20] P. Erdős, On sets of distances of npoints , Amer. Math. Monthly 53(1946), 248–250.
[21] P. Erdős and L. Moser, Problem 11 , Canad. Math. Bull. 2(1959), 43.
[22] G. Exoo and D. Ismailescu, The chromatic number of the plane is at least 5: a new proof , Discrete Comput.
Geom. 64(2020), no. 1, 216–226.
[23] P. Frankl and R. M. Wilson, Intersection theorems with geometric consequences , Combinatorica 1(1981),
no. 4, 357–368.
[24] Z. Füredi, The maximum number of unit distances in a convex n-gon, J. Combin. Theory Ser. A 55(1990),
316–320.
[25] Z. Füredi and J.-H. Kang, Covering the n-space by convex bodies and its chromatic number , Discrete Math.
308(2008), no. 19, 4495–4500.
[26] J. Garibaldi, A. Iosevich, and S. Senger, The Erdős distance problem , Student Mathematical Library,
vol. 56, American Mathematical Society, Providence, RI, 20 11.
[27] J. Greilhuber, C. Schildkraut, and J. Tidor, More unit distances in arbitrary norms , preprint
arXiv:2410.07557 (2024).
[28] P. M. Gruber, Convex and discrete geometry , Grundlehren der mathematischen Wissenschaften [Funda-
mental Principles of Mathematical Sciences], vol. 336, Spr inger, Berlin, 2007.
[29] L. Guth and N. H. Katz, On the Erdős distinct distances problem in the plane , Ann. of Math. (2) 181
(2015), no. 1, 155–190.
[30] G. Kalai, Some old and new problems in combinatorial geometry I: aroun d Borsuk’s problem , Surveys in
combinatorics, London Math. Soc. Lecture Note Ser., vol. 42 4, Cambridge Univ. Press, 2015, pp. 147–174.
[31] V. Klee, Some new results on smoothness and rotundity in normed linea r spaces , Math. Ann. 139(1959),
51–63 (1959).
[32] A. Kupavskiy, On the chromatic number of Rnwith an arbitrary norm , Discrete Math. 311(2011), no. 6,
437–440.
[33] J. Matoušek, The dawn of an algebraic era in discrete geometry? , Proceedings of the 27th European
Workshop on Computational Geometry, 2011.
[34] J. Matoušek, The number of unit distances is almost linear for most norms , Adv. Math. 226(2011), no. 3,
2618–2628.
[35] J. Matoušek, A. Přívětivý, and P. Škovroň, How many points can be reconstructed from kprojections? ,
SIAM J. Discrete Math. 22(2008), no. 4, 1605–1623.
[36] C. M. Petty, Equilateral sets in Minkowski spaces , Proc. Amer. Math. Soc. 29(1971), 369–374.
[37] D. H. J. Polymath, Polymath16 ,web.archive.org/web/20220216001534/https://asone.ai /polymath/
index.php?title=Hadwiger-Nelson_problem .
[38] A. Sheﬀer, Polynomial methods and incidence theory , Cambridge Studies in Advanced Mathematics, vol.
197, Cambridge University Press, Cambridge, 2022.
[39] J. Solymosi and E. Szabó, Arrangements of translates of a curve , preprint arXiv:2208.05525 (2022).
[40] J. Solymosi and V. H. Vu, Near optimal bounds for the Erdős distinct distances proble m in high dimensions ,
Combinatorica 28(2008), no. 1, 113–125.
[41] J. Spencer, E. Szemerédi, and W. Trotter, Jr., Unit distances in the Euclidean plane , Graph Theory and
Combinatorics (Cambridge, 1983), Academic Press, London, 1984, pp. 293–303.
[42] K. J. Swanepoel, A problem of Kusner on equilateral sets , Arch. Math. (Basel) 83(2004), no. 2, 164–170.
32[43] K. J. Swanepoel, Combinatorial distance geometry in normed spaces , New trends in intuitive geometry,
Bolyai Soc. Math. Stud., vol. 27, János Bolyai Math. Soc., Budap est, 2018, pp. 407–458.
[44] K. J. Swanepoel and R. Villa, A lower bound for the equilateral number of normed spaces , Proc. Amer.
Math. Soc. 136(2008), no. 1, 127–131.
[45] L. A. Székely, Crossing numbers and hard Erdős problems in discrete geomet ry, Combin. Probab. Comput.
6(1997), no. 3, 353–358.
[46] E. Szemerédi, Erdős’ unit distance problem , Open problems in mathematics, Springer, 2016, pp. 459–477 .
[47] P. Ungar, 2Nnoncollinear points determine at least 2Ndirections , J. Combin. Theory Ser. A 33(1982),
no. 3, 343–347.
[48] P. Valtr, Strictly convex norms allowing many unit distances and rela ted touching questions , Manuscript
(2005).
33