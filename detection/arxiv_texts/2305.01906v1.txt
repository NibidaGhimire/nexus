A Bayesian approach to identify changepoints in
spatio-temporal ordered categorical data: An
application to COVID-19 data
Siddharth Rawat1, Abe Durrant2, Adam Simpson2, Grant Nielson2, Candace
Berrett2and Soudeep Deb1,
1Indian Institute of Management Bangalore
Bannerghatta Main Rd, Bangalore, KA 560076, India.
Corresponding author: S. Rawat, Email: e-mail: siddharth.rawat19@iimb.ac.in
2Department of Statistics, Brigham Young University, Provo, UT, USA
Abstract: Although there is substantial literature on identifying structural changes for continuous
spatio-temporal processes, the same is not true for categorical spatio-temporal data. This work bridges
that gap and proposes a novel spatio-temporal model to identify changepoints in ordered categorical
data. The model leverages an additive mean structure with separable Gaussian space-time processes
for the latent variable. Our proposed methodology can detect signicant changes in the mean structure
as well as in the spatio-temporal covariance structures. We implement the model through a Bayesian
framework that gives a computational edge over conventional approaches. From an application per-
spective, our approach's capability to handle ordinal categorical data provides an added advantage
in real applications. This is illustrated using county-wise COVID-19 data (converted to categories
according to CDC guidelines) from the state of New York in the USA. Our model identies three
changepoints in the transmission levels of COVID-19, which are indeed aligned with the \waves" due
to specic variants encountered during the pandemic. The ndings also provide interesting insights
into the eects of vaccination and the extent of spatial and temporal dependence in dierent phases
of the pandemic.
Keywords and phrases: Pandemic modeling, Gibbs Sampling, Slice Sampling, Coronavirus, Process
Change, MCMC.
1. Introduction
The changepoint problem has rich existing literature. The earliest work by Cherno and Zacks (1964) ana-
lyzed a change in the mean structure for an independent and identically distributed (i.i.d.) Gaussian distribu-
tion. Ensuing work examined changepoints in the variance and structural changes for the non-Gaussian case
(see, for example, Zacks, 1983; Krishnaiah and Miao, 1988). Moving away from the i.i.d. Gaussian setting,
changepoints are most often modeled or tested in time series data. In this case, the concept of a changepoint
implies a change in the temporal dependence after a specic point in time. The simplest case to account
for a changepoint in time is to account for a change in the mean structure after the changepoint, while the
autoregressive or dependence structure remains the same (see Brockwell and Davis, 1991). Taylor (1994)
implemented a new class of models to account for stochastic volatility, and Kim, Shephard and Chib (1998)
analyzed similar research topics in the autoregressive conditional heteroskedasticity (ARCH) framework.
In fact, changepoint detection methods in time series data are abounding in extant literature. Our focus
in this work is on spatio-temporal data sets; therefore, we provide a brief review of this literature here.
Majumdar, Gelfand and Banerjee (2005) proposed a model-based approach under a Bayesian framework
and estimated a single changepoint in both the mean and dependence structures. Yu et al. (2008) and Xu
et al. (2012) developed multi-level spatio-temporal dual changepoint models using conditional autoregres-
sive (CAR) structure. They applied the model to examine the eect of alcohol outlets' control policy on
assaultive violence rates. Altieri et al. (2015) proposed a Bayesian changepoint model for spatio-temporal
point processes and t the model with the help of Integrated Nested Laplace Approximation (INLA) to
detect multiple changepoints. Altieri et al. (2016) extended the previous work to a Bayesian P-splines frame-
work for examining earthquake point processes. Fiedler et al. (2018) studied a multiple-changepoints model
in spatio-temporal seismic data, and implemented it through a Bayesian approach. More recently, Berrett
1arXiv:2305.01906v1  [stat.ME]  3 May 2023Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 2
et al. (2023) used a model selection framework for selecting the number of changes at any given location for
Gaussian spatio-temporal data.
Although modeling changepoints for continuous data is most commonly encountered in practical problems,
response variables are sometimes recorded as ordinal categories. A typical example is the case of survey
responses. Moreover, even if the response variable is continuous, it often makes sense to convert it to an
ordinal categorical variable due to the error in data collection and possible diculty in count data modeling
(see Taylor, 1961; Mullahy, 1997). It is particularly important in the context of this paper, i.e., for COVID-19
case count data. It has been demonstrated that these case counts are noisy, generally under-reported, and
often unreliable, primarily due to local test collection and upstream reporting errors (Dubrow, 2022). Hence,
modeling it as an ordinal categorical response variable is more appropriate. In this work, we dene the
category of \transmission level" of COVID-19 from the county-level weekly new number of cases, following
the guidelines from CDC (Centers for Disease Control and Prevention, 2022). The transmission of such a
disease depends on many non-measurable or imprecise quantities { for example, the development of dierent
virus variants and at-home testing availability { creating changes in how true COVID-19 cases relate to
measured quantities. We plan to examine the changing relationship of the transmission levels accounting for
suitable covariates, including the important aspect of vaccination.
One particular challenge in analyzing COVID-19 transmission is the spatial and temporal dependence
patterns, as shown in Rawat and Deb (2021). This phenomenon complicates the covariance structure for
the count data of the number of cases. For further challenges in this context, see Bertozzi et al. (2020).
Interestingly, although there is a loss of precision with the aforementioned formulation of the ordinal response
variable, the spatio-temporal dependence remains, as we show through the exploratory analysis in Section 2.
Thus, accounting for spatio-temporal dependence in the ordinal response variable is necessary.
There is extensive literature for multinomial regression models of ordinal response variables, which are
an extension of logistic and probit regression (e.g., Campbell and Donner, 1989; Benoit, 2012; Liang, Bi
and Zhan, 2020). Bayesian models using a probit link use a latent variable to facilitate Gibbs sampling as
shown by Albert and Chib (1993). Bayesian estimation methodology and computational developments are
also explored by Tanner and Wong (1987), who examined the calculation of posterior distribution using an
approximate sampling method for inference. Cowles (1996) discussed Markov chain Monte Carlo (MCMC)
approximation with an updated Gibbs sampling step to accelerate the convergence of the Bayesian estimation
process (see also, Imai and van Dyk, 2005; Berrett and Calder, 2012; Heiner et al., 2022). Additionally,
Nandram and Chen (1996) proposed the reparameterization of generalized linear models (GLM) to speed
up the convergence of the Gibbs sampler. For the same purpose, Liu and Wu (1999) proposed a parameter
expanded data augmentation (PX-DA), which uses auxiliary variables to accelerate the convergence. Chen
and Dey (2000) tackled the problem of estimating a GLM for correlated ordinal data with a scale mixture
of a multivariate normal link function using a Bayesian framework with informative prior distributions.
Roy and Hobert (2007) compared the performance and convergence rate of PX-DA and the Bayesian data
augmentation methodology proposed by Albert and Chib (1993).
Although these methods are valuable, they have not proposed how to detect any changes in mean, variance,
or correlation patterns in a categorical spatio-temporal data set. Thus, there is a dire need to develop
a changepoint detection method that combines and expands on these modeling approaches to quantify
relationships when there is spatial and temporal dependence. This is where we aim to ll the gap in the
extant literature. Specically, we propose a novel method to model changepoint(s) for spatio-temporal ordered
categorical data using a Bayesian methodology. In the proposed model, a latent variable is used to model
the categorical observations with both mean and variance-covariance structure shift after the changepoint,
allowing the spatial and temporal associations to change. The model is implemented through a Bayesian
framework, which gives it computational advantages over a classical approach. In this regard, we use the
concepts of Gibbs sampling (Geman and Geman, 1984) and single variable slice sampling algorithm (Neal,
2003).
Our methodology contributes to the literature in three exciting aspects. First, to the best of our knowledge,
this is the rst attempt to develop a method to detect changepoints in ordered categorical spatio-temporal
data. Second, we provide a statistical way to identify the presence of a changepoint, and we extend the
proposed approach in combination with a binary segmentation technique to a method that can detect multiple
changepoints in the data. Third, our model employs an ecient estimation algorithm for all parameters in the
model and alleviates some computational burden prevalent in similar spatio-temporal models for continuousRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 3
response variables. We elaborate on this in Section 3.2 below.
The rest of the paper is organized as follows. Section 2 gives a brief description and outline of the
data, along with the motivation of considering a spatio-temporal model. Our proposed method and related
discussions are given in Section 3. Application to the COVID-19 data from New York state, United States
of America (USA), is presented in Section 4. We nish with a discussion and remarks in Section 5. Some
additional exploratory analyses are provided in Appendix A, while thorough mathematical derivations of the
Bayesian steps used in the method are provided in Appendix B.
2. Data
The data used for the analysis are obtained from the GitHub repository maintained by JHU-CSSE (2020).
The data is available at a county level. For this study, we concentrate on the data for all the counties from
the state of New York. We look at the data at a weekly granularity, from 20th January 2020 to the week of
16th May 2022. This covers most of the COVID-19 \waves" in New York. Note that the data is prepared at
a weekly level for two main reasons. First, this takes care of the problems with data reporting over weekends
(see, Ricon-Becker et al., 2020). Second, the reduction in the size of the data from daily to weekly provides a
signicant computational advantage while not losing too much information on the data collection front. Thus,
the data set has a total of 7564 observations from 62 counties and 122 weeks. As mentioned in Section 1, the
weekly numbers are rst converted into categorical data that reect dierent transmission levels. We follow
the CDC guidelines to dene these levels, as provided in Table 1.
Table 1
CDC guidelines used to dene the ordered categories of COVID-19 transmission levels.
New cases per 100,000 persons in a week Category
0 to 9.99 1
10 to 49.99 2
50 to 99.99 3
>100 4
As a rst step of exploratory analysis, Figure 1 shows the transmission level categories of COVID-19
in New York at four dierent weeks across the entire time period of the data set. At each point in time,
there is clear spatial dependence for these categories. The maps show that counties with the same COVID-19
transmission levels tend to cluster, providing evidence of a need to account for or quantify spatial dependence
in any modeling technique.
We see similar dependence in the counties' transmission levels across time. Because of the categorical
nature of the response variable, it is easier to examine the similarities between counties in a smoother,
less noisy plot. Specically, Figure 2 shows the average transmission level for 30-week windows across the
observed time period. Each line represents a dierent county, with four counties { Albany (red), Niagara
(green), Queens (blue), and Suolk (purple) { highlighted in color for illustrative purposes. It is evident that
the transmission levels are similar across counties for the entire time period.
We also account for two covariates in our model: the number of deaths that occurred in the county in
the previous week (which reects the severity of the virus) and the proportion of vaccinated people with the
rst dose (which reects the extent of preventive measures). The rationale behind using these covariates is
discussed in more detail in Section 3.3. For the rst one, in a similar line as Rawat and Deb (2021), we take
the logarithmic transformation for the previous week's new death data and denote it by log d(si;t 1) for
theithcounty at the tthweek. For the vaccination covariate, we dene the vaccination prevalence x(si;t) as
x(si;t) =vcsi;t
psi;t; (1)
wherevcsi;tis the cumulative number of rst doses of the COVID-19 vaccine administered in the ithcounty
until thetthweek, and psi;tis the corresponding population. In our model, for both covariates, we use
standardized values such that the mean is 0 and the standard deviation is 1.
To understand how the covariate values change over time, we look at Figure 3. Again, each line represents a
unique county, with four illustrative counties highlighted in color. Like the transmission levels, the covariates
display generally similar patterns in all counties, but there is quite a bit of variation in the values. TheRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 4
category
1
2
3
429 Jun, 2020
category
1
2
3
42 Nov, 2020
category
1
2
3
431 May, 2021
category
1
2
3
47 Mar, 2022
Fig 1 . COVID-19 transmission level category at four dierent time points for New York state counties.
Fig 2 . Average transmission level for 30-week windows for all counties (gray) with four counties from across the state highlighted
in the four colors.
trend that the covariate values follow across time is dierent from the trend of the transmission levels; for
example, vaccinations are non-decreasing, but the transmission levels both increase and decrease across the
time period. For this reason, a model that accounts for a changing relationship with the covariates across
time is imperative. Because of the introduction of changepoints in the model, our methodology can account
for this changing relationship in an apt manner.
It is worth mentioning that we experimented with linear and quadratic trend functions as well, but since
COVID-19 data shows \wave" like patterns, they were not found to be suitable for the study. Furthermore,
the prevalence of the second dose of the COVID-19 vaccine was explored as an additional covariate. It wasRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 5
(a)
(b)
Fig 3 . Plots showing the values of vaccine prevalence (top) and log of the previous week's new deaths (bottom) across time.
The dierent lines represent the dierent counties, with four counties highlighted in color.
found to have a similar relationship as the rst dose, thereby deemed not to be required in the model.
In the USA, responses to and policies for the COVID-19 pandemic varied widely from state to state,
county to county, and even city to city. Thus, while the goal of our analysis was to examine all of New York
state transmission levels together, we rst explored whether analyses on individual counties would be more
appropriate. In the interest of space, our analysis on this note is deferred to Appendix A. Interestingly, we
found that the data for individual counties was insucient for estimation. For example, we found, rst, that
models for some counties (approximately half) did not converge even for a very large number of posterior
samples. Additionally, the lack of data for a single county meant that we could also only t these models
to estimate a single changepoint, as there would not be enough information to estimate many (if any)
changepoints beyond one. Third, we found that for counties that did converge, estimates for changepoints
and coecients had very large uncertainty ranges and large overlap with other counties. For these reasons,
a spatio-temporal model that allows for borrowing information from neighbors is absolutely necessary.
3. Methodology
3.1. Model development
Consider a categorical response variable y(si;t) for locations si2S R2; i= 1;:::;n and for time-points
t2 . While we primarily work with the regularly spaced set   = f1;:::;Tg, we emphasize that the
methodology would work for irregular spaced data as well. Likewise, although the COVID-19 data is notRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 6
point-level, we nd that the methodology works well for aggregate areal data, following similar works by
other researchers (Jin, Carlin and Banerjee, 2005; Bradley, Holan and Wikle, 2015).
For the response variable, let the total number of possible categories be represented by m. For convenience,
we denote these categories as 1 ;2;:::;m . Considering that the response is an ordered variable, we adopt the
structure of ordinal probit models. See Daykin and Moatt (2002) for a review of such models in the standard
setting. To dene the model in our case, let (si;t) be a latent random variable such that for j= 1;2;:::;m ,
y(si;t) =jifj 1<(si;t)6j; (2)
where 1 =0<1= 0<2<:::< m 1<m=1are the cut points determining the distribution of
the categorical response.
Next, letting t0be the changepoint, the model for the latent variable is dened as
(si;t) =(
(si;t) +u(si;t) +(si;t); fort6t0;
(si;t) +u(si;t) +v(si;t) +(si;t);fort>t 0:(3)
In this model, () and() constitute the mean structure before and after the changepoint, respectively.
The covariance structure in each of the two periods is written as a sum of the spatiotemporally dependent
process(es) and a white noise process. The term u(si;t) denotes the spatio-temporal eect before the change-
point, while v(si;t) is the deviation in that eect following the structural break. Both processes are assumed
to be Gaussian in nature. Finally, the white noise processes of the latent variables are dened by (si;t) and
(si;t), and we assume them to be i.i.d. zero-mean Gaussian random variables with standard deviations 
and, respectively. Hereafter, we shall use the notation Nr(;) to denote r-variate Gaussian distributions.
In the model, both () and() are considered to be linear functions of the covariates, the eects of some
of which can be spatially varying. To describe it mathematically, let xg(si;t) be thegthcovariate (1 6g6G)
whose eect is xed for all locations, that is, the eect is not spatially varying. Similarly, for 1 6h6H, let
xg+h(si;t) correspond to a covariate whose eect is considered to be spatially varying. Then, we write the
mean functions as
(si;t) =0+GX
g=1gxg(si;t) +HX
h=1h(si)xg+h(si;t);fort6t0;
(si;t) =
0+GX
g=1
gxg(si;t) +HX
h=10
h(si)xg+h(si;t);fort>t 0;(4)
wheregand
grepresent the coecients for the xed eect covariate before and after the change point, and
h(si) and
h(si) are location-specic coecients in the two segments. In other words, h= (h(s1);:::;h(sn))0
represents the coecient vector accounting for spatial variation in the eect of the corresponding regressor.
The vector
hhas an identical interpretation as well. We assume these eects to be spatially correlated, fol-
lowing exponentially decaying covariance structure in a Gaussian setting. Specically, for estimating the eect
sizes in the Bayesian algorithm (to be discussed in detail in Section 3.2), we consider that hNn(0;k
h
s),
and
hNn(0;k
h
s). It is worth mentioning that the vectors 1;2;:::;Hare taken to be independent
of one another. Now, the dispersion matrices 
h
sand 
h
sare dened as
(
h
s)ij= expf !h
sjjsi sjjjg;(
h
s)ij= expf !h
sjjsi sjjjg; (5)
where!h
sand!h
sare the decay parameters before and after the changepoint, respectively. Note that this is
a special case of Mat ern class of covariance functions, where the parameters reect the extent of the decay
in the correlation. For computation, the term jjsi sjjjis calculated by the great circle distance between
two locations siandsj.
For the spatio-temporal processes, akin to other studies in related applications (see, e.g., Rawat and Deb,
2021), we assume separability for the correlation functions. Then, the spatial correlation function and the
temporal correlation function are both considered to follow exponentially decaying structures. For the spatial
correlation, we again use the great circle distance, whereas in the temporal correlation, the time dierenceRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 7
jt1 t2jis calculated by the lag between the time-points. In other words, with decay parameters us,ut,
vs,vt, one may write
Corr (u(si;t1);u(sj;t2)) = expf usksi sjkg expf utjt1 t2jg;
Corr (v(si;t1);v(sj;t2)) = expf vsksi sjkg expf vtjt1 t2jg:(6)
Throughout this article, we use M=nTfor the total number of observations. Let Ybe theM-dimensional
vector ofy(si;t) observations, rst arranged by time-point and then by the index of the location. The vectors
,U,V,,are also created in the same fashion. The design matrix of regressor values is expressed as X.
The aforementioned model using vector-matrix notation is then written as follows:
=(
X+U+; fort6t0;
X+U+V+;fort>t 0;(7)
whereis thek-dimensional coecient vector obtained by combining ( 0;1;:::;G)0and the parameter
vectors (0
1;0
2;:::;0
H)0.is similarly dened.
Furthermore, from the above discussions, one may write UNM(0;2
uut
us)), such that ( ut)ij=
expf utjti tjjgand (us)ij= expf vsjjsi sjjjg. Similarly, we can dene covariance matrices  vt,
vsand writeVNM(0;2
v(vt
vs)). For the white noise vectors, we know that NM(0;2
I) and
NM(0;2
I), where Istands for an identity matrix of appropriate order.
3.2. Bayesian estimation
We use a complete Bayesian framework to estimate the model parameters. To do that, suitable prior speci-
cations are necessary. It should be noted that to avoid identiability issues in the computations, following
Higgs and Hoeting (2010), we set the variance parameters 2
u,2
v,2
, and2
equal to 1. We adopt the
principles of Gibbs sampling for the posterior computation of the other parameters. Recall that it is a type
of Markov chain Monte Carlo (MCMC) technique where each parameter is updated iteratively, following the
full conditional posterior distribution given the values of the other parameters from the previous iteration.
Interested readers may refer to Gelfand (2000) for relevant details on the origin and implementation of Gibbs
sampling. To set up the steps of the sampler, we use the symbol Fto indicate the information contained by
all the parameters from the previous iteration except the parameter for which the full conditional posterior
is calculated.
First, consider the latent vector and letidenote the ithelement of it, while  irepresents the vector
with all elements but the ithone. In the same spirit, uiandviare dened for vectors UandVwhereas
x0
irepresents the ithrow of the matrix Xdened in eq. (7). Let t(i) be the time point corresponding to the
same observation. Then, the full conditional distribution for iis found by marginalizing over (si;t(i)) and
(si;t(i)). Following the earlier notations, if Fstands for (Y;U;V;;;;t0;2
;2
; i), then it can be
shown that
ijF(
TN(x0
i+ui;2
;j 1;j); ift(i)6t0; yi=j;
TN(x0
i+ui+vi;2
;j 1;j);ift(i)>t0; yi=j;(8)
whereTN(a;b;c;d) denotes the univariate truncated normal distribution, obtained by truncating a normal
distribution with mean aand variance bin the interval ( c;d).
For each component in and, we assume the uniform at innite-support prior distribution. Thus,
posteriors for these parameters are dominated by the data, and no information is assumed in the prior
distribution. The full conditional posterior distribution for these parameter vectors can then be written as
jFNk 
"
X 0(  U )
2#
;!
;
jFNk 
"
X+0(+ U+ V+)
2#
;!
:(9)Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 8
In this equation,  and+represent the vector before and after the changepoint, respectively. U ,
U+,V ,V+,Y ,Y+,T ,T+,X , andX+are similarly dened. The dispersion matrices  and 
are dened as
="
X 0X 
2+	 1
k# 1
;="
X+0X+
2
+	 1
k# 1
; (10)
where 	 and 	are block diagonal matrices with entries in the order ( IG;
s1;
s2;:::; 
sH) and ( IG;

s1;

s2;:::; 

sH),
respectively. It is worth noting that the above conditional posteriors would be Gaussian (with dierent pa-
rameter values) even if one considers Gaussian priors for and, instead of the aforementioned at
distributions.
Next, for calculating the posterior distributions of the cut points 2;3;:::;m 1we use the single variable
slice sampling algorithm as used for other parameterizations of the cut points by Heiner et al. (2022). The R
package \diversitree" developed by FitzJohn (2012) is used to implement the algorithm. A brief description
of the single variable slice sampling algorithm is warranted here. The algorithm follows three main steps.
First, a random number zis drawn from the vertical slice of (0 ;g(r0)), wherer0is the starting point for the
random variable Randg(r0) is its probability density function. Second, an interval of width wis randomly
positioned around r0and expanded until both ends are outside the horizontal slice where all values are equal
toz. Third, a new point r1is randomly sampled from the interval obtained in the previous step of width w.
For further details, please refer to Neal (2003).
For the prior distribution of j, the support must be between j 1andj+1since we are working with
ordinal categorical data as discussed in Section 3.1. We use the uniform distribution between those two
bounds as the prior distribution for j. Now, let 
jand 
j+1be the vectors that represent only those values
from the vector  where the corresponding categories for the vector Y arejandj+ 1, respectively.
Similarly,X 
j,U 
j,X 
j+1, andU 
j+1are dened. In an identical manner, let +
jand+
j+1be the vectors
representing only those values from +where the corresponding categories for the vector Y+arejandj+1,
respectively. Similarly, X+
j,U+
j,V+
j,X+
j+1,U+
j+1, andV+
j+1are dened. Then, the full conditional posterior
forjcan be written as
f(jjF)/I(j 1<j<j+1)jZ
j 1exp 1
22 
j X 
j U 
j2
d 
j
j+1Z
jexp 1
22 
j+1 X 
j+1 U 
j+12
d 
j+1
jZ
j 1exp 1
22
+
j X+
j U+
j V+
j2
d+
j
j+1Z
jexp 1
22
+
j+1 X+
j+1 U+
j+1 V+
j+12
d+
j+1:(11)
It is easy to observe that the posterior distribution of jdoes not have a closed form. To implement the
slice sampling procedure, we simplify the above integral by making appropriate substitutions. It is worth
mentioning that the multivariate slice sampling algorithm was also explored in this context, but it was
computationally more expensive and less ecient for our algorithm compared to the single variable slice
sampling procedure.
We turn our attention to the space-time process vectors UandV. Recall that the M1 vectorYdenotes
the entire data and that UandVare the concatenated forms (by column) of the matrices
UTn=0
BBB@us1;1us1;2::: us1;T
us2;1us2;2::: us2;T
............
usn;1usn;2::: usn;T1
CCCA;VTn=0
BBB@vs1;1vs1;2::: vs1;T
vs2;1vs2;2::: vs2;T
............
vsn;1vsn;2::: vsn;T1
CCCA: (12)Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 9
It is critical to point out that the conventional posterior distributions for the entire vectors UandV
would entail the inversion of MMdimensional matrices in every iteration for every Markov chain during
the Gibbs sampling procedure. This is computationally demanding, and to circumvent the problem, we
follow a less expensive procedure by taking advantage of the separability of the spatio-temporal structure.
DivideVintoV1;V2;:::;VTwithVtbeing thetthcolumn of the Vmatrix in eq. (12), and let V t=
(V2;:::Vt 1;V1;Vt+1;:::;VT). Consider the partitioned structure
vt=1112
2122
for the temporal correlation matrix, with subscript 1 denoting the correlation part corresponding to the
tthtime point and subscript 2 denoting the same for the rest of the time points. Then, letting vc=
(12
vs)( 1
22
 1
vs)V tand vc= ( 11 12 1
2221)
vs, multivariate normal distribution theory
indicates that
VtjV t;2
vNn(vc;2
vvc): (13)
Following the same idea for Uas well, the full conditional posterior distributions are
VtjF8
<
:Nn(vc;2
vvc); fort6t0;
Nn
Vt
 1
vcvc
2v+t Xt Ut
2

;Vt
;fort>t 0;(14)
UtjF8
>><
>>:Nn
Ut
 1
ucuc
2u+t Xt
2
;Ut
; fort6t0;
Nn
Ut
 1
ucuc
2u+t Xt Vt
2
;Ut
;fort>t 0;(15)
where Vtand Utare dened to be
Vt= 1
vc
2v+In
2
 1
;Ut= 1
uc
2u+In
2
 1
: (16)
Next, we look at the four decay parameters in the spatio-temporal covariance functions. One can calculate
the posterior distributions of vt,vs,ut, andus, and show that they do not adhere to any known
probability distribution. Thus, we use the single variable slice sampling algorithm as applied for jbefore.
It is particularly of note here that we estimate the decay parameters on a continuous scale, which is in stark
contrast to the conventional cross-validation approach used by many other researchers. The problem with
using a cross-validation method is that if there are more than two decay parameters being estimated, then
only a small set of possible values for the parameters can be considered to handle the computational burden.
For example, we look at the work of Sahu, Gelfand and Holland (2006), who used two spatio-temporal
processes in their model for analyzing air pollution levels. However, in their study, they had to nd the
optimal values of the decay parameters from a set of only ve values for the spatial decay parameters and
only three values for the temporal decay parameters. Clearly, this limits the algorithm's ability to explore
all possible values for the decay parameters and runs the risk of not exploring the actual sample space (a
four-dimensional cube for our model). We take advantage of the aforementioned slice sampling procedure to
alleviate this computational burden in estimating the decay parameters. For the priors, we choose uniform
distributions between 0 and 3 to obtain the full conditional posterior distributions as follows
vtjF/j vtj n=2exp(
 V0( 1
vt
 1
vs)V
22v)
I(0<vt<3);
vsjF/j vsj T=2exp(
 V0( 1
vt
 1
vs)V
22v)
I(0<vs<3);
utjF/j utj n=2exp(
 U0( 1
ut
 1
us)U
22u)
I(0<ut<3);
usjF/j usj T=2exp(
 U0( 1
ut
 1
us)U
22u)
I(0<us<3):(17)Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 10
In an exactly similar fashion, we can also show that for the decay parameters of the spatially-varying
coecients,
!h
sjF/j 
h
sj 1=2exp(
 0
h(
h
s) 1h
2k)
I(0<!h
s<3);
!h
sjF/j 
h
sj 1=2exp(
 0
h(
h
s) 1
h
2k)
I(0<!h
s<3):(18)
Finally, for calculating the full conditional posterior distribution of the changepoint t0, we consider the
setST=f0;1;2;:::;Tgand use a discrete uniform prior distribution. Let fST(t0) denote this prior. Note
that the endpoints are included in the sample space so as to enable the algorithm to converge to any of the
endpoints, which would eectively suggest no changepoint. Then, the Gibbs sampling step corresponding to
the parameter t0requires the conditional posterior distribution, which is described by the probability mass
function as
f(t0jF)/I(t02ST)(22
) nT 
2exp 1
22  (X +U )2
(22
) nT+
2exp 1
22
+ (X++U++V+)2
:(19)
3.3. Multiple changepoint detection in COVID-19 Data
In the previous two subsections, we discussed the Bayesian estimation of the proposed model of changepoint
detection in a general sense. Here, we explain how the model is applied to the COVID-19 data described in
Section 2. For this application, as mentioned already, we use the logarithmic transformation of the number of
new deaths in the previous week as a non-spatially varying covariate. On the other hand, the prevalence of the
rst COVID-19 vaccine dose is used as a spatially-varying coecient in the model. Let us use log d(si;t 1) to
denote the rst covariate at time tand location si, whereasx(t) = (x(s1;t);:::;x (sn;t))0is then-dimensional
vector of the vaccination prevalence in the set of locations. Then, the mean structure of the latent variable
can be written as
(si;t) =0+1logd(si;t 1) +(si)x(si;t);fort6t0;
(si;t) =
0+
1logd(si;t 1) +(si)x(si;t);fort>t 0:(20)
For the covariate related to the previous week's death, it is expected that it contributes positively to
the spreading of the disease. It is connected to the idea that death by COVID-19 corresponds to a higher
viral count, which increases the chance of spreading the disease to another human (Pujadas et al., 2020).
However, as more people are vaccinated, we expect this eect to be negligible, as there will be fewer deaths
after vaccination. Regarding the second covariate, we expect a signicantly negative coecient in the rst
phase of the vaccination, which would provide evidence of the eectiveness of COVID-19 vaccines in decreas-
ing the spread of the pandemic. As the vaccination picks up, herd immunity is likely to be acquired. For
example, MacIntyre, Costantino and Trent (2022) demonstrated in their research that Australia achieved
herd immunity with the vaccination coverage of around 66% population. Once that status is reached, the
eect of vaccines should not be prominent in explaining the spread of the disease. Furthermore, taking inspi-
ration from Utazi et al. (2018) who studied the spatially-varying impact of measles vaccination in dierent
countries, we hypothesize that dierent counties in New York state may have experienced unequal eects of
vaccines in its relationship with the spread of the disease. This is, in fact, the primary motivation behind
using the spatially-varying coecients for the rst-dose vaccination.
Another crucial aspect of our proposed methodology is the ability to assess whether the estimated change-
point is indeed signicant. Following the convention in Bayesian literature, we make use of the Bayes factor.
The Bayes factor allows us to compare a model that does not have any changepoint in the structure to the
model with a changepoint. Let M1denote our proposed model with a changepoint (see eq. (2) and eq. (3))Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 11
andM2be the other model obtained by tting the model with no changepoint (i.e., the rst line before the
changepoint in eq. (3) for the entire data). The likelihood of the data given a particular model is then
f(YjMi) =Z
f(Y;;;U;VjMi)dddUdV
=Z
f(Yj;;U;V;Mi)f(;;U;VjMi)dddUdV
=E;;U;V[f(Yj;;U;V;Mi)]
1
mmX
j=1f
Yj(j);(j);U(j);V(j);Mi
;
where(j)f(jMi)),(j)f(jMi)),U(j)f(UjMi)),V(j)f(VjMi)) are realizations from
the model-specic distributions. Interestingly, often the likelihood values are intractable if one uses non-
informative priors, as in this case. As suggested by Newton and Raftery (1994) and Risser et al. (2019),
in such cases, one can leverage the posterior distributions of the parameters to nd the likelihood with the
help of the harmonic mean. Specically, if (j)
postdenotes the realization of the parameter vector from the jth
posterior sample (similarly for other parameters), then the likelihood is obtained as
f(YjMi)"
1
mmX
j=11
f(Yj(j)
post;(j)
post;U(j)
post;V(j)
post;Mi)# 1
: (21)
Once the likelihood values are computed, we use the Bayes factor to decide if the estimated changepoint
is signicant in our problem. Following Kass and Raftery (1995), we use the cuto of 100 for the Bayes factor
to deduce whether there is decisive evidence in favor of the changepoint model. Recall that the Bayes factor
for the modelM1with respect toM2is given by
BF12=f(YjM1)
f(YjM2): (22)
The above procedure is not only useful in nding whether there is a single signicant changepoint, but
it is also useful for nding if there are multiple changepoints in the ordered categorical spatio-temporal
data. To that end, we propose a binary segmentation-type algorithm. This technique has been used in
the literature to detect multiple changepoints in dierent problems (Fryzlewicz, 2014; Cho and Fryzlewicz,
2015). To implement the algorithm in our context, rst, we run the aforementioned procedure to nd a
changepoint, if any, in the entire time period. In all instances of Gibbs samplers in this work, we monitor the
convergence through the Gelman-Rubin diagnostic (Gelman and Rubin (1992)), running three Markov chains
simultaneously. Now, if the Bayes factor approach provides decisive evidence in favor of the changepoint, we
divide the data into two segments with respect to the temporal domain. Then, the same algorithm is run
on each of the two segments, and we proceed recursively until no signicant changepoint is left in the data.
From a pragmatic standpoint, as an additional stopping rule, we impose the restriction that any segment
identied by the changepoint(s) must be at least three months (equivalently, 12 weeks) long. Thus, if there
are no more than 24 weeks of data for a particular segment, we do not run the algorithm further. Also, if a
changepoint is found to be too close to either of the endpoints, it is ignored based on the same restriction.
We present the pseudo-code of the entire procedure of multiple changepoint detection in ordered categorical
spatio-temporal data in Algorithm 1. Note that the stopping criteria Cimplies that either the Bayes factor
approach does not support the existence of a changepoint or that every segment has no more than the
required amount of data. We emphasize that this is a subjective choice and can be easily adjusted under
other considerations.
4. Results
As mentioned in Section 2, our objective is to utilize the proposed model to detect the changepoints in the
spatio-temporal spread of COVID-19 by considering its ordered categorical nature. Recall that the data usedRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 12
Algorithm 1: Multiple changepoint detection in spatio-temporal categorical data.
Input : Data vectorY, design matrix X, and stopping criteria C.
Output : Posterior distribution for all the parameters and changepoints.
Initialization: SetU= 0 andV= 0, take random feasible values for us,ut,vs,vt,!s,!
s,,,2,3,t0for
three Markov chains.
1whileCnot true do
2 (a) Implement model M1(with changepoint) as described above, nd the posterior samples, estimate the
parameters and compute the estimated likelihood for the model. ;
3 (b) Implement model M2(without the changepoint) as described above, nd the posterior samples, estimate the
parameters and compute the estimated likelihood for the model.;
4 (c) Compute the Bayes factor of M1with respect toM2. ;
5 (d) Divide the dataset into two segments based on the estimated changepoint in M1. ;
6 (e)ifBayes factor >100 & sucient data are available for one or both segments. then
7 Use the data from the segment(s) where enough data are available; and go to step (a).;
8 else
9 break;
10 end
11end
in this study comprise 122 weeks of information (20thJanuary 2020 to 16thMay 2022) from 62 counties
in the state of New York. In this section, we rst discuss the changepoints identied by the algorithm and
discuss their implications. We then provide an in-depth look at the relationship between the covariates and
the spread of the pandemic. Finally, we examine the extent of spatial and temporal dependence in the
propagation of the disease across dierent time periods.
In this application, using the steps in Algorithm 1, the proposed methodology detects three changepoints.
Table 2 shows the estimated changepoints with the corresponding Bayes factors in all stages of the analysis,
including those that were not found to be signicant according to the criteria. The rst changepoint is
estimated at the 57thweek, and the corresponding Bayes factor is above the cuto, indicating evidence for
a changepoint. In the second stage, the data set is divided into two time periods, and the proposed model
is applied to each separate time period. For the rst time period, i.e., for the 1stto 57thweeks of the data,
because the vaccination started only at the end of the time period (approximately week 50), we had to remove
it as a covariate. The Bayes factor here again supports the presence of changepoint, which is obtained at the
36thweek. Likewise, for the second time period, i.e., the 58thto 122ndweeks, the 96thweek is found to be a
signicant changepoint. Subsequently, in the third stage of the binary segmentation algorithm, when we t
the model again on the data from 1stto 36thweek, the detected changepoint is towards the beginning of the
time period with a logarithmic Bayes factor of  72, suggesting no changepoint in the structure. A similar
conclusion is reached when the model is run on the data from the 58thto 96thweek. Meanwhile, in the time
period from 97thto 122ndweek, the changepoint is found to be too close to the beginning of the time period
and is ignored based on our restriction. Finally, note that we do not run the algorithm for the remaining
time period because there is insucient data according to our assumption mentioned earlier. Thus, there
are three changepoints in this data set, and they are on 21stSeptember 2020, 15thFebruary 2021, and 15th
November 2021.
Table 2
Changepoints and respective Bayes factors for the proposed algorithm. The rst column indicates the stages of binary
segmentation. Bolded changepoints indicate that it was identied as present/signicant in the data.
Stage Time horizon Changepoint Date Log Bayes Factor
1 1stto 122ndweek 57thweek 15thFeb 2021 44
2 1stto 57thweek 36thweek 21stSep 2020 64
58thto 122ndweek 96thweek 15thNov 2021 1118
3 1stto 36thweek 8thweek 9thMar 2020  72
37thto 57thweek Insucient data
58thto 96thweek 79thweek 19thJul 2021  102
97thto 122ndweek Not found
To put this into context, Figure 4 shows the three changepoints (represented by black dots) with the total
number of new cases in the state. This gure shows that the changepoint on 15thFebruary 2021 is towardsRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 13
the end of the winter alpha wave of COVID-19 in the USA. It is also the time when vaccinations picked up
rapidly in the country, and around 11% of the New York state population received the rst dose. In contrast,
the changepoint on 21stSeptember 2020 coincides with the period when the same wave was about to start
in the state. It was undoubtedly one of the most challenging times for the state, and that is well reected by
the two changepoints. Subsequently, we notice that the period of the delta variant did not experience any
signicant change in the way the disease spread, but the beginning of the wave of the Omicron variant that
peaked around the end of January aligns perfectly well with the third changepoint, 15thNovember 2021.
This clearly demonstrates strong support for the proposed model to correctly detect the dierent types of
COVID-19 waves in New York.
alpha delta omicron
0200400600
2020âˆ’01 2020âˆ’07 2021âˆ’01 2021âˆ’07 2022âˆ’01
WeekTotal New Cases(per 1000)
Fig 4 . COVID-19 waves corresponding to new cases for New York State. The graph's black dots denote the proposed model's
estimated changepoint.
Next, we discuss the eect sizes of the covariates, obtained from tting the proposed model to the dierent
time periods. We report the posterior means and the 95% credible intervals in Table 3. The spatially-varying
coecients for vaccinations are shown in Figure 3 and discussed in a later paragraph. These values are
obtained based on the time periods formed by the changepoints, as discussed before. Notably, for both the
intercept and the coecient for log d(si;t 1), there are quite dierent estimates in the four segments. The
intercept for the rst phase, when the pandemic was gradually picking up, is much lower. This makes sense,
given the relatively lower number of reported COVID-19 cases in this period. Then, the alpha wave started
running wild during the 37thto 57thweek period. As vaccines did not provide much intervention until then,
the intercept's estimated value is found to be relatively high. In the following segment, with more people
getting vaccinated, the number of new cases decreased, thereby justifying a lower value for the estimated
intercept. Contrary to that, in the last period, a generally higher average in the latent variable is observed.
It can be substantiated by the rise in the new COVID-19 cases, with the omicron variant escaping the
vaccination-induced immunity to take over the entire country. Interested readers may refer to Tian et al.
(2021) and Ao et al. (2022) for some related discussions in this regard.
For the coecient of log d(si;t 1), initially, when there was no available vaccine, the variable was
signicantly related to a rise in the new cases of COVID-19 infections. In fact, for the period of 1stto 36th
week, the coecient for the previous week's number of deaths is the highest among all periods, indicating
a strong positive relationship to the transmission level of COVID-19. During this phase, the state of New
York reported around 6000 deaths on a weekly basis. In the next segment, the state was experiencing the
alpha wave. The number of deaths came down in this stage, which points to less severity of the disease, and
naturally explains the lower value of the estimated coecient. Furthermore, once a considerable proportion
of the population was vaccinated in the third time period, we see the coecient estimates for the deathRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 14
Table 3
Parameter estimates and corresponding credible intervals when the proposed model is tted in dierent segments.
Variable Week Range Posterior mean 95% credible interval
Intercept 1-36 1 :079 (0 :467;1:615)
37-57 7 :713 (5 :483;9:525)
58-96 6 :279 (5 :124;7:406)
97-122 7 :978 (6 :520;9:321)
log(Previous week's death) 1-36 1 :101 (0 :679;1:497)
37-57 0 :296 (0 :071;0:533)
58-96 0 :273 (0 :157;0:389)
97-122 0:146 ( 0:357;0:061)
Spatial decay parameter 1-57 0.0108 (0.0081,0.0129)
58-122 0.0021 (0.0016,0.0026)
Temporal decay parameter 1-57 0.264 (0.206,0.315)
58-122 0.203 (0.165,0.245)
numbers going down signicantly. This may be perceived as the eectiveness of the vaccines. Finally, for the
period between 97thand 122ndweek, the coecient for the death numbers is found to be insignicant as
the omicron variant was milder in terms of causing severe illness but was highly infectious (explaining the
large intercept term in this segment). Thus, in addition to capturing changepoints, the proposed model has
appropriately captured this eect as well.
Let us now focus on the eect of the prevalence of vaccination. It is known that the vaccine was oered only
to hospital workers and older people in the initial days. In that light, relevant data are unavailable before the
57thweek, and this covariate has to be omitted from the model. Therefore, we present the spatially varying
eect of the vaccination in the other two segments in Figure 5. The plots show the parameters' posterior
means, and stripes indicate that the credible interval is suciently away from zero.
Between 58th and 96th week Between 97th and 122nd week
Significant
Yes
No
âˆ’101Posterior means
Fig 5 . Spatially varying coecients (posterior means) for the vaccination prevalence in the last two segments obtained via the
changepoints. Signicance is equivalent to the credible interval being suciently away from zero.
When vaccination rates picked up in the period of 58thto 96thweek, it was signicantly related to a
decrease in the transmission level of COVID-19 for all counties in New York. For 33 of the 62 counties, this
coecient is found to be signicant. It includes almost all counties in the eastern part of the state, which
are typically more populous than the rest. One can thus argue that the vaccination was more eective in
the initial phase in more populated counties. In contrast, for the period of 97thto 122ndweek, we see that
vaccination is generally not signicant. One possible justication is the aspect of herd immunity. By 22nd
November 2021, 75% of the state population received their rst dose, and by 16thMay 2022, it was more than
85% of the population. As discussed in Section 3.3, around two-thirds of population coverage is required to
achieve herd immunity. According to World Health Organization (2021) too, 70% of the population should
be vaccinated to ensure herd immunity against COVID-19. Therefore, after achieving this much population
coverage, the eect of the vaccination became irrelevant, until there was no resistance for the omicron variant
(Ao et al., 2022).
As a last piece of the discussion, we look at the spatio-temporal dependence in the four segments createdRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 15
by the changepoints. To this end, heatmaps of the estimated spatio-temporal correlation for the latent process
(si;t) for dierent periods are displayed in Figure 6. The correlations are computed based on the posterior
means of the spatial and temporal decay parameters and are presented as functions of distance and time-lag.
051015
0 50 100 150 200
Spatial distance(km)Week differenceBetween 1st to 36th week
051015
0 50 100 150 200
Spatial distance(km)Week differenceBetween 37th to 57th week
051015
0 50 100 150 200
Spatial distance(km)Week differenceBetween 58th to 96th week
051015
0 50 100 150 200
Spatial distance(km)Week differenceBetween 97th to 122nd week
0.20.40.6Correlation
Fig 6 . Estimated correlation for the latent process (si;t)in four segments. The contour lines represent the points that have
the same correlation values.
The correlation is estimated to be the lowest in the rst time period compared to all other time periods.
A probable reason is that lockdowns were enforced in New York very early when the COVID-19 prevalence
was quite low. After that, restrictions were relaxed slowly in a four-phase technique (Husch Blackwell, 2021).
Thus, as the pandemic progressed and the prevalence kept increasing during the alpha wave (37thto 57th
weeks), we see that there is a strong spatio-temporal dependence. It was, in fact, the largest correlation
among all time periods. Afterward, between 58thand 96thweek, it can be seen from the plots that there
is a drop in spatial and temporal dependence. This can be attributed to the fact that during this time
period, vaccination rates started picking up everywhere, as many vaccines were made available to all adults
of dierent age groups. Finally, we see a further drop in the spatial and temporal dependence pattern for
the last time period. As pointed out before, the omicron variant prevailing in this phase was milder than
the previous counterparts and did not cause severe illness. The population had also arguably reached herd
immunity. It can be the reason behind the drop in spatial dependence, whereas the drop in the temporal
correlation can be connected to the fact that illness due to the omicron variant persisted for a shorter
duration than the delta variant, as explicated by Menni et al. (2022) and Vitiello et al. (2022).
5. Conclusion
In this work, we have developed a novel methodology to detect changepoints in an ordinal categorical spatio-
temporal data set. We also provided complete estimation details and considerations for the various model
parameters. The model is applied to COVID-19 data from the state of New York, by converting weekly new
cases for every county into ordered categories (following CDC guidelines), signifying the transmission levels
of COVID-19. Our model is dened through an appropriately structured latent process that can quantify
the spatial and temporal dependence in the spread of the disease. It is implemented through a complete
Bayesian framework. Our analysis identies interesting changes in the spatial and temporal patterns of the
pandemic, which are closely aligned with the infectivity of specic virus variants. Taking advantage of ourRawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 16
proposed model, we also illustrate how vaccination is related to the transmission levels in dierent counties
over the time period.
One interesting nding is the evidence of varying spatial dependence in various time segments, which may
be attributed to the movement of people and the vaccination rate. Due to the unavailability of movement
data across dierent counties of New York state, this is beyond the scope of the paper. Nonetheless, this
could be a valuable extension of our work to understand the infection dynamics better. In a similar vein,
restrictions, and lockdowns imposed by the government are expected to impact the spread of COVID-19.
Such covariates related to policy implementation have not been incorporated into our analysis, once again,
because of the lack of relevant data at an appropriate granularity. Naturally, it poses another idea of an
extension to the current approach.
It is imperative to point out that not only the application of our methodology to COVID-19 data was
useful for providing additional insights into a world-changing event, but the proposed model would also
be helpful in other applications. For example, it can be utilized in epidemiological (e.g., other infectious
disease transmission levels), environmental (e.g., precipitation levels or soil organic carbon concentration
levels), education (e.g., school grades over time), social network (e.g., level of connectedness of individuals
or companies) studies, and more.
Finally, we note that the proposed methodology in this article has limitations in terms of computational
burden in the case of a bigger data set, e.g., if one wants to look at all counties of the USA in a single model.
Particularly, it would be an intriguing exercise to estimate the changepoints for dierent regions across the
country and assess how similar or dierent the spread of COVID-19 was in dierent periods. Although
our approach works in theory, in such cases, applying a model at this scale would require a signicant
approximation in the Bayesian algorithm.
References
Albert, J. H. andChib, S. (1993). Bayesian analysis of binary and polychotomous response data. Journal
of the American statistical Association 88669{679.
Altieri, L. ,Scott, E. M. ,Cocchi, D. andIllian, J. B. (2015). A changepoint analysis of spatio-
temporal point processes. Spatial Statistics 14197{207.
Altieri, L. ,Cocchi, D. ,Greco, F. ,Illian, J. B. andScott, E. (2016). Bayesian P-splines and ad-
vanced computing in R for a changepoint analysis on spatio-temporal point processes. Journal of Statistical
Computation and Simulation 862531{2545.
Ao, D. ,Lan, T. ,He, X. ,Liu, J. ,Chen, L. ,Baptista-Hon, D. T. ,Zhang, K. andWei, X. (2022).
SARS-CoV-2 Omicron variant: Immune escape and vaccine development. MedComm 3e126.
Benoit, K. (2012). Multinomial and ordinal logistic regression. Retrieved on December 102017.
Berrett, C. andCalder, C. A. (2012). Data augmentation strategies for the Bayesian spatial probit
regression model. Computational Statistics & Data Analysis 56478{490.
Berrett, C. ,Gurney, B. ,Arthur, D. ,Moon, T. andWilliams, G. P. (2023). A Bayesian change
point modeling approach to identify local temperature changes related to urbanization. Environmetrics
34e2794.
Bertozzi, A. L. ,Franco, E. ,Mohler, G. ,Short, M. B. andSledge, D. (2020). The challenges of
modeling and forecasting the spread of COVID-19. Proceedings of the National Academy of Sciences 117
16732{16738.
Husch Blackwell (2021). New York: State-by-State COVID-19 Guidance. https://www.
huschblackwell.com/new-york-state-by-state-covid-19-guidance . Date accessed: March 2023.
Bradley, J. R. ,Holan, S. H. andWikle, C. K. (2015). Multivariate spatio-temporal models for high-
dimensional areal data with application to Longitudinal Employer-Household Dynamics. The Annals of
Applied Statistics 91761 { 1791.
Brockwell, P. J. . andDavis, R. A. (1991). Time series: theory and methods . Springer-Verlag.
Campbell, M. K. andDonner, A. (1989). Classication eciency of multinomial logistic regression rela-
tive to ordinal logistic regression. Journal of the American Statistical Association 84587{591.
Chen, M.-H. andDey, D. K. (2000). A unied Bayesian approach for analyzing correlated ordinal response
data. Brazilian Journal of probability and Statistics 87{111.Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 17
Chernoff, H. andZacks, S. (1964). Estimating the current mean of a normal distribution which is
subjected to changes in time. The Annals of Mathematical Statistics 35999{1018.
Cho, H. andFryzlewicz, P. (2015). Multiple-change-point detection for high dimensional time series via
sparsied binary segmentation. Journal of the Royal Statistical Society: Series B: Statistical Methodology
475{507.
Cowles, M. K. (1996). Accelerating Monte Carlo Markov chain convergence for cumulative-link generalized
linear models. Statistics and Computing 6101{111.
Daykin, A. R. andMoffatt, P. G. (2002). Analyzing ordered responses: A review of the ordered probit
model. Understanding Statistics: Statistical Issues in Psychology, Education, and the Social Sciences 1
157{166.
Dubrow, J. K. (2022). Local data and upstream reporting as sources of error in the administrative data
undercount of Covid 19. International Journal of Social Research Methodology 25471{476.
Fiedler, B. ,Zoller, G. ,Holschneider, M. andHainzl, S. (2018). Multiple Change-Point Detection
in Spatiotemporal Seismicity DataMultiple Change-Point Detection in Spatiotemporal Seismicity Data.
Bulletin of the Seismological Society of America 1081147{1159.
FitzJohn, R. G. (2012). Diversitree: Comparative Phylogenetic Analyses of Diversication in R. Methods
in Ecology and Evolution 31084-{1092.
Centers for Disease Control and Prevention (2022). Indicators for Monitoring COVID-
19 Community Levels and COVID-19 and Implementing COVID-19 Prevention Strategies.
https://www.cdc.gov/coronavirus/2019-ncov/downloads/science/Scientific-Rationale-
summary_COVID-19-Community-Levels_2022.02.23.pptx . Date accessed: February 2022.
Fryzlewicz, P. (2014). Wild binary segmentation for multiple change-point detection.
Gelfand, A. E. (2000). Gibbs sampling. Journal of the American statistical Association 951300{1304.
Gelman, A. andRubin, D. B. (1992). Inference from iterative simulation using multiple sequences. Sta-
tistical science 457{472.
Geman, S. andGeman, D. (1984). Stochastic relaxation, Gibbs distributions, and the Bayesian restoration
of images. IEEE Transactions on pattern analysis and machine intelligence 6721{741.
Heiner, M. ,Heaton, M. J. ,Abbot, B. ,White, P. ,Minaudo, C. andDupas, R. (2022). Model-Based
Clustering of Trends and Cycles of Nitrate Concentrations in Rivers Across France. Journal of Agricultural,
Biological, and Environmental Statistics .
Higgs, M. D. andHoeting, J. A. (2010). A clipped latent variable model for spatially correlated ordered
categorical data. Computational Statistics & Data Analysis 541999{2011.
Imai, K. andvan Dyk, D. A. (2005). A Bayesian Analysis of the Multinomial Probit Model Using Marginal
Data Augmentation. Journal of Econometrics 124311{334.
JHU-CSSE, D. (2020). 2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns Hopkins
CSSE. Last accessed on 16th May, 2022.
Jin, X. ,Carlin, B. P. andBanerjee, S. (2005). Generalized hierarchical multivariate CAR models for
areal data. Biometrics 61950{961.
Kass, R. E. andRaftery, A. E. (1995). Bayes factors. Journal of the american statistical association 90
773{795.
Kim, S. ,Shephard, N. andChib, S. (1998). Stochastic volatility: likelihood inference and comparison with
ARCH models. The review of economic studies 65361{393.
Krishnaiah, P. andMiao, B. (1988). 19 Review about estimation of change points. Handbook of statistics
7375{402.
Liang, J. ,Bi, G. andZhan, C. (2020). Multinomial and ordinal Logistic regression analyses with multi-
categorical variables using R. Annals of translational medicine 8.
Liu, J. S. andWu, Y. N. (1999). Parameter expansion for data augmentation. Journal of the American
Statistical Association 941264{1274.
MacIntyre, C. R. ,Costantino, V. andTrent, M. (2022). Modelling of COVID-19 vaccination strategies
and herd immunity, in scenarios of limited and full vaccine supply in NSW, Australia. Vaccine 402506{
2513.
Majumdar, A. ,Gelfand, A. E. andBanerjee, S. (2005). Spatio-temporal change-point modeling. Jour-
nal of Statistical Planning and Inference 130149{166.
Menni, C. ,Valdes, A. M. ,Polidori, L. ,Antonelli, M. ,Penamakuri, S. ,Nogal, A. ,Louca, P. ,Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 18
May, A. ,Figueiredo, J. C. ,Hu, C. et al. (2022). Symptom prevalence, duration, and risk of hospital
admission in individuals infected with SARS-CoV-2 during periods of omicron and delta variant dominance:
a prospective observational study from the ZOE COVID Study. The Lancet 3991618{1624.
Mullahy, J. (1997). Heterogeneity, excess zeros, and the structure of count data models. Journal of applied
econometrics 12337{350.
Nandram, B. andChen, M.-H. (1996). Reparameterizing the generalized linear model to accelerate Gibbs
sampler convergence. Journal of Statistical Computation and simulation 54129{144.
Neal, R. M. (2003). Slice sampling. The annals of statistics 31705{767.
Newton, M. A. andRaftery, A. E. (1994). Approximate Bayesian inference with the weighted likelihood
bootstrap. Journal of the Royal Statistical Society: Series B (Methodological) 563{26.
World Health Organization (2021). Achieving 70% COVID-19 Immunization Coverage by Mid-2022.
https://www.who.int/news/item/23-12-2021-achieving-70-COVID-19-immunization-coverage-
by-mid-2022 . Date accessed: March 2023.
Pujadas, E. ,Chaudhry, F. ,McBride, R. ,Richter, F. ,Zhao, S. ,Wajnberg, A. ,Nadkarni, G. ,
Glicksberg, B. ,Houldsworth, J. andCordon-Cardo, C. (2020). SARS-CoV-2 viral load predicts
COVID-19 mortality. medRxiv .
Rawat, S. andDeb, S. (2021). A spatio-temporal statistical model to analyze COVID-19 spread in the
USA. Journal of Applied Statistics 1{20.
Ricon-Becker, I. ,Tarrasch, R. ,Blinder, P. andBen-Eliyahu, S. (2020). A seven-day cycle in
COVID-19 infection, hospitalization, and mortality rates: Do weekend social interactions kill susceptible
people? medRxiv .
Risser, M. D. ,Calder, C. A. ,Berrocal, V. J. andBerrett, C. (2019). Nonstationary spatial pre-
diction of soil organic carbon. The Annals of Applied Statistics 13165{188.
Roy, V. andHobert, J. P. (2007). Convergence rates and asymptotic standard errors for Markov chain
Monte Carlo algorithms for Bayesian probit regression. Journal of the Royal Statistical Society: Series B
(Statistical Methodology) 69607{623.
Sahu, S. K. ,Gelfand, A. E. andHolland, D. M. (2006). Spatio-temporal modeling of ne particulate
matter. Journal of Agricultural, Biological, and Environmental Statistics 1161{86.
Tanner, M. A. andWong, W. H. (1987). The calculation of posterior distributions by data augmentation.
Journal of the American statistical Association 82528{540.
Taylor, L. R. (1961). Aggregation, variance and the mean. Nature 189732{735.
Taylor, S. J. (1994). Modeling stochastic volatility: A review and comparative study. Mathematical nance
4183{204.
Tian, D. ,Sun, Y. ,Zhou, J. andYe, Q. (2021). The global epidemic of the SARS-CoV-2 delta variant,
key spike mutations and immune escape. Frontiers in immunology 12.
Utazi, C. E. ,Thorley, J. ,Alegana, V. A. ,Ferrari, M. J. ,Takahashi, S. ,Metcalf, C. J. E. ,
Lessler, J. andTatem, A. J. (2018). High resolution age-structured mapping of childhood vaccination
coverage in low and middle income countries. Vaccine 361583{1591.
Vitiello, A. ,Ferrara, F. ,Auti, A. M. ,Di Domenico, M. andBoccellino, M. (2022). Advances in
the Omicron variant development. Journal of internal medicine 29281{90.
Xu, Y. ,Yu, Q. ,Scribner, R. ,Theall, K. ,Scribner, S. andSimonsen, N. (2012). Multilevel spa-
tiotemporal change-point models for evaluating the eect of an alcohol outlet control policy on changes in
neighborhood assaultive violence rates. Spatial and spatio-temporal epidemiology 3121{128.
Yu, Q. ,Scribner, R. ,Carlin, B. ,Theall, K. ,Simonsen, N. ,Ghosh-Dastidar, B. ,Cohen, D.
andMason, K. (2008). Multilevel spatio-temporal dual changepoint models for relating alcohol outlet
destruction and changes in neighbourhood rates of assaultive violence. Geospatial health 2161.
Zacks, S. (1983). Survey of classical and Bayesian approaches to the change-point problem: xed sample
and sequential procedures of testing and estimation. In Recent advances in statistics 245{269. Elsevier.Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 19
Appendix A: Exploratory Analysis for Individual Counties
In the United States, responses to and policies for the COVID-19 pandemic varied widely from state to state,
county to county, and even city to city. Thus, while the goal of our analysis was to examine all of New York
state transmission levels together, we rst explored whether analyses on individual counties would be more
appropriate.
To approach this, we t the proposed model to each county, removing spatial dependence (or, xing
us= 1). Specically, UN(0;2
U(ut
us)) was simplied to UN(0;2
Uut), and similarly for V.
We found, rst, that models for some counties (approximately half) did not converge in the pre-dened
time allotted. For this reason, the spatio-temporal model proposed in this paper that allowed for borrowing
information from neighbors is important. Additionally, because models for a single county struggled to con-
verge, we also only t these models to estimate a single change point; there would not be enough information
to estimate very many (if any) change points beyond one.
Second, we found that for counties that did converge, estimates for change points and coecients had
very large uncertainty ranges and large overlap with other counties further illustrating a need to combine
the analysis for all counties. We provide a more detailed examination into four counties here.
We explore four counties from across the state and with diering populations. Specically, Allegany County
(southwest, rural, population 46091), Kings County (southeast, urban, population 2559903), Niagara County
(northwest, urban/suburban, population 209281), and Rensselaer County (northeast, urban/suburban, pop-
ulation 158714). The posterior mean change point for the four counties is listed in Table A.1. Figure A.1
provides a plot of the smoothed (30-week averages) transmission levels for the four counties with vertical
lines representing the mean change point. Notice that all four of these estimated change points are before
any counties were administered vaccinations (which began around week 50 in New York, or December 28,
2020). This makes sense that models would identify a change in relationships at this time; however, it's not
useful in identifying and quantifying more practical changes. Specically, consider the coecient estimates
for vaccinations before the change point, 2, in Table A.1. The coecients are very large both positively
and negatively, particularly relative to the probit link. This is because before the change point there are no
vaccinations so the posterior is simply returning the prior1. However, after the change point, once vaccines
have started to be administered, the coecients 
2are much smaller, but uncertainty ranges still overlap
with one another and include 0. We see a similar behavior with the coecients for previous weeks deaths, but
there isn't a common time when this covariate remains constant for all counties. These challenges indicate
that a model that allows for borrowing information from neighbors is needed.
Table A.1
Posterior mean (and 95% credible interval) for: the week of the change point, the corresponding date of the change point, and
coecients before (without ) and after (with ) the change point for four counties when the model was t to the single
county data.
Change Prev Week Death Vaccination
County Point Date 1 
1 2 
2
Allegany 38 Sep 28 0.743 0.404 7715.6 -2.97
(35, 38) 2020 (-0.11, 1.75) (-0.02, 0.89) (-1714, 17610) (-9.65, 2.90)
Kings 28 Jul 27 37.686 0.369 2507.52 0.55
(15, 43) 2020 (0.62, 60.63) (-0.29, 0.98) (-23402, 45493) (-3.73, 4.43)
Niagara 41 Oct 26 0.9 0.575 -2028.81 -5.137
(40, 42) 2020 (0.14, 2.07) (0.08, 1.13) (-11313, 7616) (-12.92, 0.23)
Rensselaer 37 Sep 21 678.57 0.266 -1395.54 -1.833
(11, 44) 2020 (-6053, 15661) (-0.11, 0.69) (-12352, 7351) (-8.52, 4.60)
1Note that to avoid singularity in the Xmatrix before the change point, we added a small amount of noise to the values of
the covariates.Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 20
Fig A.1 . 30-week average transmission levels for four counties in New York. The vertical line in the corresponding color
represents the posterior mean change point estimated when the model was t to the single county data.
Appendix B: Posterior calculation
This section presents the detailed calculations for the posterior distributions needed in the Gibbs sampler.
The full joint posterior distribution can be written as
f(;;U;V;;;;t0jY)/f(Yj;;U;V;;;;t0)f(jU;V;;;;;t0)f(Vjv)
f(Uju)f(j!s)f(j!
s)f(t0)f()f(!s)f(!
s)f()
/f(Yj;;U;V;;;t0)f( jU ;;;t0)
f(+jU+;V+;;t0)f(Vjv)f(Uju)f(j!s)
f(j!
s)f(t0)f()f(!s)f(!
s)f();
where= (u;v)0,u= (us;ut)0, andv= (vs;vt)0.
In order to calculate the conditional posterior distribution of , we need to take only the terms involving
. On simplication, that yields
f(jF)/f( jU ;;;t0)f(j!s)
/exp(
 1
2 
0"
X 0X 
2#
 20"
X 0(  U )
2#!)
exp 1
2
0	 1
k

/exp(
 1
2 
0"
X 0X 
2+	 1
k#
 20"
X 0(  U )
2#!)
;
where 	 are block diagonal matrices with entries in the order ( IG;
s1;
s2;:::; 
sH).
Comparing the above with multivariate normal distribution, we get,
jFNk 
"
X 0(  U )
2#
;!
; (B.1)
where dispersion matrices  is dened as
="
X 0X 
2+	 1
k# 1
:Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 21
Similarly, we obtain the conditional posterior for .
For the conditional posterior of the vector , we consider the ithelement of it (denoted by i, as mentioned
before) and similarly for vectors U,VandY. Since all the elements of vector will be independent of each
other conditional on UandVvectors, we can write
f(ijF)/(
f(ijui;)I(j 1<i<j); fort(i)6t0;yi=j;
f(ijui;vi;)I(j 1<i<j);fort(i)>t0;yi=j:
Thus we can write the conditional posterior for ias
ijF(
TN(x0
i+ui;2
;j 1;j); fort(i)6t0;yi=j;
TN(x0
i+ui+vi;2
;j 1;j);fort(i)>t0;yi=j;(B.2)
whereTN(a;b;c;d) denotes the univariate truncated normal distribution, obtained by truncating a normal
distribution with mean aand variance bin the interval ( c;d).
Next, since jshould be between j 1andj+1, the conditional posterior distribution for jis written as
f(jjF)/f(Yj;;U;V;;;;t0)f()
/I(j 1<j<j+1)Z
Aj
exp 1
22  X  U 2
d 
Z
Bjexp 1
22
+ X+ U+ V+2
d+;
whereAjandBjdenote the integration for all the observations in the jthcategory with bounds for integration
arej 1andjand (j+ 1)thcategory with bounds for integration are jandj+1before and after the
changepoint t0, respectively.
Now, let 
jand 
j+1be the vector that represents only those values from vector  where the corre-
sponding categories for the vector Y arejandj+ 1, respectively. Similarly, X 
j,U 
j,X 
j+1, andU 
j+1
are dened. Also, let +
jand+
j+1be the vector that represents only those values from vector +where
the corresponding categories for the vector Y+arejandj+ 1, respectively. Similarly, X+
j,U+
j,V+
j,X+
j+1,
U+
j+1, andV+
j+1are dened.
f(jjF)/I(j 1<j<j+1)jZ
j 1exp 1
22 
j X 
j U 
j2
d 
j
j+1Z
jexp 1
22 
j+1 X 
j+1 U 
j+12
d 
j+1
jZ
j 1exp 1
22
+
j X+
j U+
j V+
j2
d+
j
j+1Z
jexp 1
22
+
j+1 X+
j+1 U+
j+1 V+
j+12
d+
j+1;(B.3)
Now, we calculate the conditional posterior for the decay parameter vt, for other decay parameters one
can similarly compute the conditional posterior. The decay parameter values are assumed to be between 0
and 3 as mentioned in the main paper. This comes from the relationship that for unit distance in space or
time, the decay parameter being 3 or more translates to the correlation being negligible. Using this prior,Rawat et al. / Identifying changepoints in spatio-temporal ordered categorical data 22
the conditional posterior of vtcan be written as
f(vtjF)/f(Vjvt)f(vt)
/jvtj n=2exp(
 V0( 1
vt
 1
vs)V
22v)
I(0<vt<3):(B.4)
As discussed in Section 3.2 of the main paper, we divide the vector VintoV1;V2;:::;VnwithVtbeing
thetthcolumn of the Vmatrix in eq. (3.4) of the main paper. Hence,
VtjV tNT(vc;2
vvc);
wherevc= ( 12 1
22
In)V tand vc= ( 11 12 1
2221)
vs. Then, for the conditional posterior
distribution of Vt, iftthtime point is greater than t0, we note that
f(VtjF)/f(+jU+;V+;;t0)f(VtjV t);
thereby implying that
f(VtjF)/exp
 1
22
+ X+ U+ V+2
exp
 1
22v(Vt vc)0 1
vc(Vt vc)
:
Taking only the terms involving Vi, the above can be shown to be proportional to
f(VtjF)/exp
 1
22
(V0
tVt 2V0
i(t Xt Ut)) 1
22v(V0
t 1
vcVt 2V0
t 1
vcvc)
/exp
 1
2
V0
t 1
vc
2v+In
2

Vt 2V0
t 1
vcvc
2v+t Xt Ut
2

Straightforward calculation through multivariate normal theory and considering the other case when ith
time point is less than or equal to t0and doing similar computations for Ugives
VtjF8
<
:Nn(vc;2
vvc); fort6t0;
Nn
Vt
 1
vcvc
2v+t Xt Ut
2

;Vt
;fort>t 0;(B.5)
UtjF8
>><
>>:Nn
Ut
 1
ucuc
2u+t Xi
2
;Ut
; fort6t0;
Nn
Ut
 1
ucuc
2u+t Xt Vt
2
;Ut
;fort>t 0;(B.6)
where Vtand Utare dened as
Vt= 1
vc
2v+In
2
 1
;Ut= 1
uc
2u+In
2
 1
:
Finally, considering the set ST=f0;1;2;:::;Tg, following the steps described in the main manuscript,
we obtain the conditional posterior for t0as
f(t0jF)/f( jU ;;;t0)f(+jU+;V+;;t0)f(t0)
/I(t02ST)(22
) nT 
t0
2exp 1
22  (X +U )2
(22
) nT+
t0
2exp 1
22
+ (X++U++V+)2
:(B.7)