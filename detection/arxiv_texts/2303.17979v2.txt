1
Robust Detection for Mills Cross Sonar
Olivier Lerda1, Ammar Mian2, Guillaume Ginolhac2,Senior Member, IEEE , Jean-Philippe
Ovarlez3,4,Member, IEEE , Didier Charlot1
Abstract
Multi-array systems are widely used in sonar and radar applications. They can improve communication
speeds, target discrimination, and imaging. In the case of a multibeam sonar system that can operate two
receiving arrays, we derive new adaptive tests to improve detection capabilities compared to traditional
sonar detection approaches. To do so, we more specifically consider correlated arrays, whose covariance
matrices are estimated up to scale factors, and an impulsive clutter. In a partially homogeneous environment,
the 2-step Generalized Likelihood ratio Test (GLRT) and Rao approach lead to a generalization of the
Adaptive Normalized Matched Filter (ANMF) test and an equivalent numerically simpler detector with
a well-established texture Constant False Alarm Rate (CFAR) behavior. Performances are discussed and
illustrated with theoretical examples, numerous simulations, and insights into experimental data. Results
show that these detectors outperform their competitors and have stronger robustness to environmental
unknowns.
Index Terms
Adaptive Normalized Matched Filter, Complex Elliptically Symmetric distributions, Multiple-Input
Multiple-Output, Robustness, Sonar target detection, Tyler’s M-estimator.
I. Introduction
A. Background and motivations
Forward-Looking sonars are solutions for perceiving the underwater environment. In the context of a
growing need for decision-making autonomy and navigation safety, they have become fundamental tools for
understanding, anticipating obstacles and potential dangers, analyzing and identifying threats. They offer
efficient results, allowing detection, tracking, and classification of surface [1], water column [2], or bottom
targets [3], in civil [4] or military applications such as mine warfare [5].
At the detection level, monovariate statistical tests under the Gaussian or non-Gaussian interference
assumption, defined a priori, remain the prevalent approaches [6]–[8]. Nevertheless, many works on multi-
variate statistics have shown great interest compared to algorithms developed from monovariate statistics in
1Exail Sonar Systems division, La Ciotat, France.
2LISTIC, University Savoie Mont-Blanc, Annecy, France.
3ONERA - DEMR, University Paris-Saclay, Palaiseau, France.
4CentraleSupelec - SONDRA, University Paris-Saclay, Gif-sur-Yvette, France.
DRAFTarXiv:2303.17979v2  [stat.AP]  27 Feb 20242
a large number of application fields. Indeed, multivariate statistics allow advanced modeling of propagation
environments. By following these precepts, [9] gets a central detector with the total unknown of the noise
parameters, [10] first derives a detector under the assumption of a known covariance then substitutes it,
through a two-step procedure, by an appropriate estimator, finally, [11] and [12] have shown the relevance
of subspace data models in consideration of mismatched signals for which, as an example, the target echo
would not come precisely from the center of the main beam. These seminal works are now references in
remote sensing, and ground or air surveillance but mainly for radar systems.
Moreover, in the radar field, phenomenal progress has also been made in recent decades, guided by
increasingly complex systems that required profound changes in concepts and processing. This is especially
the case of Space-Time Adaptive Processing (STAP) for airborne radars [13], which bring considerable
improvements in the ability to discriminate moving targets at very low speeds, or Multiple-Input Multiple-
Output (MIMO) systems that advance detection performance [14], [15] and resolution [16], [17] by exploiting
spatial, frequency or waveform diversities. In underwater acoustics, the use of multi-ping processing is made
more complicated due to the low speed of propagation of acoustic waves in the marine environment which does
not allow to respect the assumption of non-moving targets. The use of multivariate multi-ping approaches
then requires more elaborate migration compensation processing that is only possible if the level of coherence
is sufficient between the different pings, which is not always the case (environmental fluctuation and spatial
decorrelation). Thus, although some preliminary work has emerged in recent years [18]–[24], these methods
remain little used in sonar systems.
This paper focuses on the adaptive detection of a point target by a correlated orthogonal arrays sonar
system. Inspired by these previous works, we will first show that multibeam systems are perfectly adapted
to multivariate formalism. We will then propose two new detectors following the GLRT, and Rao two-step
approaches [25]–[27], assuming heterogeneous or partially homogeneous clutter [28], [29]. The performance
in a Gaussian environment will first be evaluated. We will show that considering a sonar system with Mills
cross arrays [30] leads to a better detectability of targets by reducing the clutter ridge.
Nevertheless, complex multi-normality can sometimes be a poor approximation of physics. This is the
case for fitting high-resolution clutter, impulsive noise, outliers, and interference. The Complex Elliptic
Symmetric (CES) distributions [31] including the well-known compound Gaussian subclass are then natural
extensions allowing the modeling of distributions with heavy or light tails in radar [32]–[35] as in sonar
[36]. Mixtures of Scaled Gaussian (MSG) distributions [37] are derived and easily tractable approaches. In
this context, particular covariance matrix estimators are recommended for adaptive processing such as the
Tyler estimator [38] or Huber’s M-estimator [39]. Their uses lead to very substantial performance gains in
[40], [41], and [35]. In our application, these considerations will allow us to design a new covariance matrix
estimator. The performance of the detectors in a non-Gaussian impulsive environment can then be studied.
On this occasion, we will show on experimental data, this estimator’s interest in the robustness to corruption
of training data.
DRAFT3
B. Paper organization and contributions
We use a Mills cross sonar with two receiving arrays for point-like target detection in heterogeneous
(non-)Gaussian environment. The main contributions are summarized below:
•We propose a new covariance matrix estimator generalizing the usual Tyler’s estimator in a context of
dual and correlated arrays.
•On these assumptions, two adaptive coherent detectors are derived based on the two-step GLRT and
Rao’s test.
•The performance of these detectors, in terms of false alarm and probability of detection, is evaluated
and compared. We highlight the constant false alarm rate property with respect to the power variation
and the speckle covariance matrix.
•The contribution of a sonar architecture with orthogonal arrays in the spatial reduction of the clutter
ridge is shown.
•Experimental results demonstrate the usefulness of the proposed models and detection schemes on real
sonar data.
This paper is organized as follows: Section II presents a dual array sonar system and the experimental
acquisition conditions on which this work is based. In Section III, the signal model and detection problem are
formalized. According to the two-step GLRT and Rao test design, coherent adaptive detectors are derived
in Section IV. The performances are evaluated, compared, and analyzed in Sections V and VI. Conclusions
are given in Section VII. Proofs and complementary results are provided in the Appendices.
Notations : Matrices are in bold and capital, vectors in bold. Re( .) and Im(.) stand respectively for real and
imaginary part operators. For any matrix Aor vector, ATis the transpose of AandAHis the Hermitian
transpose of A.Iis the identity matrix and CN(µ,Γ) is the circular complex Normal distribution of mean
µand covariance matrix Γ.⊗denotes the Kronecker product.
II. Seapix system
A. Generalities
The SEAPIX system is a three-dimensional multibeam echosounder developed by the sonar systems
division of Exail (formerly iXblue) [42]. It is traditionally used by fishing professionals as a tool to assist in
the selection of catches and the respect of quotas [43], by hydro-acousticians for the monitoring of stocks
and morphological studies of fish shoals [44], by hydrographers for the establishment of bathymetric and
sedimentary marine charts [45], [46].
Two uniform linear arrays of 64 elements, arranged in Mills cross, are entirely symmetric, reversible in
transmission/reception, and electronically steerable. They generate transverse (i.e. across-track) or longitu-
dinal (along-track) acoustic swaths of 120◦by 1.8◦, tiltable on +/-60◦, providing a volumic coverage of the
water column.
DRAFT4
Fig. 1. Multiswath capabilities seen from a schematic representation (left): transverse swath footprint is blue, a 60◦steered
transverse swath is displayed in red, the longitudinal swath is green, and a 45◦steered longitudinal swath is orange. Illustration
from the operator software (right): An across-track, an along-track, and a tilted along-track swath are observed, as well as an
aggregation of fishes and an already constructed bathymetric map.
B. FLS experiment
The SEAPIX system is experimented in Forward-Looking Sonar configuration for predictive target detec-
tion and identification. In this context of use, the active face is oriented in the “forward” direction rather
than toward the seabed.
In our study, the sensor is installed on the DriX Uncrewed Surface Vehicle (USV) and inclined by 20◦
according to the pitch angle to the sea surface (Figure 2 left). In transmission, the vertical antenna (formerly
longitudinal) generates an enlarged beam of 9◦in elevation by 120◦in azimuth. A motion stabilized, and
electronically tilted firing angle allows the upper limit of the -3 dB transmit beamwidth to graze the sea
surface and the lower limit to reach a 50 m depth bottom at about 300 m range. In receive, the horizontal
antenna (formerly transverse) generates beams of 2◦in azimuth by 120◦in elevation and the vertical antenna
(which is used again) of 2◦in elevation by 120◦in azimuth. A rigid sphere of 71 cm diameter (Figure 2
right) is also immersed at 25 m depth in the middle of the water column.
So after each transmission of 20 ms Linear Frequency Modulation pulses centered at 150 KHz with a
10 KHz bandwidth and a Pulse Repetition Interval of 0.5 s, the sensor signals from the two antennas
are simultaneously recorded, allowing an azimuth and elevation representation of the acoustic environment
(Figure 3).
C. Pre-processing and data format
The signals from the 128 sensors provided by the sonar’s embedded software are demodulated in baseband
(In-Phase and Quadrature components) and decimated at 43 KHz. During reception pre-processing, the
digitized samples are compensated for the time-varying gain, filtered to the bandwidth of the waveform,
pulse compressed, and then decimated again to bandwidth. Finally, a ping dataset is a matrix of about 6000
range bins from 15 m to 400 m, by 64 sensors, by two arrays.
DRAFT5
Fig. 2. Exail’s DriX USV (left): The cross-shaped linear arrays are visible in the gondola. The real target in open water (right):
a metallic sphere of target strength TS=−15 dB.
III. Detection Schemes
A. Data model for a single array
At each time, we have two digitized synchronized complex data vectors of m= 64 elements, called
“snapshots”, which can be written as (by omitting the temporal parameterization):
xi= [xi,1,xi,2,···,xi,m]T, (1)
wherei= 1,2 is the array identifier (respectively horizontal and vertical). After the pre-processing steps, a
point-like target observed on the antenna iis simply:
xi=αipi+zi, (2)
where xi∈Cmis the received signal, αiis an unknown complex target amplitude, pi∈Cmstands for the
known deterministic angular steering vector, zi∈Cmis a mixture of scaled Gaussian (MSG) random vector
admitting the stochastic representation:
zid=√τici. (3)
The textureτiis an unknown positive deterministic scalar parameter, presumably different for each range
bin (i.e. for all time samples). The speckle ci∼CN (0,σ2
iMii)∈Cmis a complex circular Gaussian random
vector whose covariance matrix Miiis known up to a scaling factor σ2
i. The term speckle should be understood
in the sense of CES statistics rather than as the result of a sum of contributions from reflections in a
DRAFT6
Fig. 3. Azimuth (top) and elevation (bottom) view from a single ping, in 50 m depth in La Ciotat bay.
resolution cell. This model is strongly related to the class of compound Gaussian distributions [31], which
assumes a speckle-independent random texture with a given density pτ. Considering deterministic texture
allows building estimators and detectors which are completely independent of the knowledge of the texture
PDF. In this way, detectors are no longer specific to a single and unique distribution, which can be seen as
an additional source of robustness. Furthermore, the MSG distribution is more robust than the Gaussian
one because the relative scaling between samples allows flexibility in the presence of heterogeneities, such as
impulsive noise, outliers, and inconsistent data. This model explicitly allows considering the power fluctuation
across range bins, especially for heavy-tailed clutter distributions.
The detection problem is written as a binary hypothesis test:


H0:xi=zi ;xi,k=zi,kk= 1...K,
H1:xi=αipi+zi;xi,k=zi,kk= 1...K.(4)
In (4) it is assumed that K≥mindependent and identically distributed (i.i.d.) signal-free secondary
dataxi,k∈Cmare available under both hypotheses for background parameters estimation. We recall that
zi,kd=√τi,kci,k,ci,k∼CN (0,Mii).
DRAFT7
Conditionally to the unknown deterministic texture, the densities of xiunderH0andH1are Gaussian:
pxi(xi;H0) =1
πm˜σ2m
i|Mii|exp
−xH
iM−1
iixi
˜σ2
i
,
pxi(xi;H1) =
1
πm˜σ2m
i|Mii|exp
−(xi−αipi)HM−1
ii(xi−αipi)
˜σ2
i
,(5)
where ˜σi=σi√τi.
B. Data model for the two arrays
If we consider the two antennas, this model can be written more appropriately:


H0:x=z ;xk=zkk= 1...K,
H1:x=Pα+z;xk=zkk= 1...K,(6)
where x=
x1
x2
∈C2mis the concatenation of the two received signals, α=
α1
α2
∈C2is the vector of
the target amplitudes and z=
z1
z2
∈C2mis the additive clutter. The matrix P=
p10
0 p 2
∈C2m×2
contains the steering vectors.

xk=
x1,k
x2,k



k∈[1,K]∈C2mforK≥2mare i.i.d. signal-free secondary
data.
This formulation allows considering the correlation between sensors of arrays. The covariance is M= 
M11M12
M21M22
, with Miithe block-covariance matrix of array i, and Mij=MH
jithe cross-correlation block
of arrayiandj. The partitioned inverse covariance will be denoted as M−1=
M−1
11M−1
12
M−1
21M−1
22
.
We further assume that the covariance is known, or estimated, up to two scalars, possibly different on
each array. These scalars are conditioning the Miiblock-covariance, but also all the cross-correlations blocks
associated with the array i. We can therefore write:
/tildewideC=/tildewideΣ M/tildewideΣ, (7)
with/tildewideΣ=
˜σ1Im 0
0 ˜σ2Im
=
˜σ10
0 ˜σ2
⊗Imthe unknown diagonal matrix of scalars σiandτi. We recap
that theσiparameter drives the partial homogeneity of the data (i.e. the difference in scale factor between
the covariance matrices of the primary and secondary data) and τidrives the non-Gaussianity of the data
(i.e. the power variation of the observations over time).
In this model, each array, although correlated, has a possibly distinct texture and an unknown scaling
factor on the covariance matrix which may also be dissimilar. It would therefore become entirely possible
to model, as an example, a first array whose observations would be Gaussian ( τ1= 1) and homogeneous
DRAFT8
(σ1= 1), and a second array whose observations would be K-distributed (for which τ2is a realization of a
Gamma distribution) and non-homogeneous ( σ2̸= 1). The PDFs under each hypothesis can be rewritten as:
px(x;H0) =1
π2m|/tildewideC|exp/parenleftig
−xH/tildewideC−1x/parenrightig
,
px(x;H1) =1
π2m|/tildewideC|exp/parenleftig
−(x−Pα)H/tildewideC−1(x−Pα)/parenrightig
.(8)
IV. ROBUST DETECTORS
We discuss the derivation of detectors using the GLRT and Rao procedures. Following a two-step approach,
the covariance matrix Mwill first be assumed known, and then replaced by an appropriate estimator.
A. Detectors’ derivation with Mknown (step-1)
1) Generalized Likelihood Ratio Test: The Generalized Likelihood Ratio Test (GLRT) design methodology
proposes to solve the detection problem from the ratio of the probability densities function under H1and
H0, substituting the unknown parameters with their maximum likelihood estimates:
LG(x) =max
αmax
/tildewideΣpx/parenleftig
x;α,/tildewideΣ,H1/parenrightig
max
/tildewideΣpx/parenleftig
x;/tildewideΣ,H0/parenrightig. (9)
Proposition IV.1. The GLRT for the hypothesis test (6)is given by:
LG(x) =ˆ˜σ10ˆ˜σ20
ˆ˜σ11ˆ˜σ21, (10)
where
/parenleftbigˆ˜σ10ˆ˜σ20/parenrightbig2=Re/parenleftbig
xH
1M−1
12x2/parenrightbig
m+/radicaltp/radicalvertex/radicalvertex/radicalbtxH
1M−1
11x1
mxH
2M−1
22x2
m,
and
/parenleftbigˆ˜σ11ˆ˜σ21/parenrightbig2=Re/bracketleftbig
xH
1/parenleftbig
M−1
12−D−1
12/parenrightbig
x2/bracketrightbig
m+/radicaltp/radicalvertex/radicalvertex/radicalbtxH
1/parenleftbig
M−1
11−D−1
11/parenrightbig
x1
mxH
2/parenleftbig
M−1
22−D−1
22/parenrightbig
x2
m
withD−1=M−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1.
Proof. See Appendix A for a step-by-step derivation and Appendix B for some interesting equivalences.
Asxi=√τiciunderH0, it is easily shown that this detector is texture independent (i.e. it has the
texture-CFAR property). This detection test will be called M-NMF-G in the following.
2) Rao test: The Rao test is obtained by exploiting the asymptotic efficiency of the ML estimate and
expanding the likelihood ratio in the neighborhood of the estimated parameters [47]. A traditional approach
for complex unknown parameters is to form a corresponding real-valued parameter vector and then use the
real Rao test [48], [49]. Specifically, rewriting the detection problem (6) as:
DRAFT9


H0:ξR=0,ξS
H1:ξR̸=0,ξS,(11)
where ξR=/bracketleftig
Re (α)TIm (α)T/bracketrightigT
is a 4×1 parameter vector and ξS= [˜σ1˜σ2]Tis a 2×1 vector of nuisance
parameters, the Rao test for the problem (11) is:
LR(x) =∂lnpx(x;ξR,ξS)
∂ξR/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleT
ξR=ˆξR0
ξS=ˆξS0/bracketleftig
I−1(ˆξR0,ˆξS0)/bracketrightig
ξRξR∂lnpx(x;ξR,ξS)
∂ξR/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleξR=ˆξR0
ξS=ˆξS0. (12)
The PDFpx(x;ξR,ξS) is given in (8) and parametrized by ξRandξS.ˆξR0andˆξS0are the ML estimates
ofξRandξSunderH0.I(ξR,ξS) is the Fisher Information Matrix that can be partitioned as:
I(ξR,ξS) =
IξRξR(ξR,ξS)IξRξS(ξR,ξS)
IξSξR(ξR,ξS)IξSξS(ξR,ξS)
,
and we have:
/bracketleftbig
I−1(ξR,ξS)/bracketrightbig
ξRξR=/parenleftig
IξRξR(ξR,ξS)−IξRξS(ξR,ξS)I−1
ξSξS(ξR,ξS)IξSξR(ξR,ξS)/parenrightig−1
. (13)
The following proposition can be finally stated:
Proposition IV.2. The Rao test is given by:
LR(x) = 2xHˆ/tildewideC−1
0P/parenleftbigg
PHˆ/tildewideC−1
0P/parenrightbigg−1
PHˆ/tildewideC−1
0x, (14)
whereˆ/tildewideC0=ˆ/tildewideΣ0Mˆ/tildewideΣ0andˆ/tildewideΣ0is defined in Appendix A.
Proof. See Appendix C.
As for the GLRT, (14) is texture-CFAR . This detector will be referred to as M-NMF-R in the sequel.
B. Covariance estimation and adaptive detectors (step-2)
In practice, the noise covariance matrix is unknown and estimated using the Kavailable i.i.d. signal-free
secondary data.
In Gaussian environment, in which PDFs are given by (8) with σi= 1 andτi= 1, the MLE of Mis the
well-known Sample Covariance Matrix (SCM):
/hatwiderMSCM =1
KK/summationdisplay
k=1xkxH
k, (15)
which is an unbiased and minimum variance estimator.
In the presence of outliers or a heavy-tailed distribution (as modeled by a mixture of scaled Gaussian),
this estimator is no longer optimal or robust. This leads to a strong performance degradation.
DRAFT10
Proposition IV.3. In MSG environment the MLE of Mis given by:
/hatwiderM2TYL =1
KK/summationdisplay
k=1/hatwideT−1
kxkxH
k/hatwideT−1
k, (16)
where/hatwideTk=
/radicalbig
ˆτ1k 0
0/radicalbig
ˆτ2k
⊗Im,ˆτ1k=t1+/radicaltp/radicalvertex/radicalvertex/radicalbtt1
t2t12,ˆτ2k=t2+/radicaltp/radicalvertex/radicalvertex/radicalbtt2
t1t12andt1=xH
1,k/hatwiderM−1
11x1,k
m,t2=
xH
2,k/hatwiderM−1
22x2,k
m,t12=Re/parenleftig
xH
1,k/hatwiderM−1
12x2,k/parenrightig
m.
Proof. The demonstration is provided in Appendix D.
A key point is that this estimator is independent of the textures, i.e. the power variations, on each array.
It can be thought of as a multi-texture generalization of [38].
From a practical point of view /hatwiderM2TYL is the solution of the recursive algorithm:
/hatwideT(n)
k=
/radicalig
ˆτ(n)
1k0
0/radicalig
ˆτ(n)
2k
⊗Im, (17)
/hatwiderM(n)
2TYL =1
KK/summationdisplay
k=1/parenleftig
/hatwideT(n−1)
k/parenrightig−1
xkxH
k/parenleftig
/hatwideT(n−1)
k/parenrightig−1
, (18)
wheren∈Nis the iteration number, whatever the initialization /hatwiderM(0)
2TYL . The convergence of recursive
equations (17) and (18) in the estimation of /hatwiderM2TYL is illustrated in Figure 4 where we plot the relative
error between two successive estimates of the covariance matrix as a function of the iteration number for
500 steps and /hatwiderM(0)
2TYL =I2m. The relative error is given by/vextenddouble/vextenddouble/vextenddouble/hatwiderM(n)
2TYL−/hatwiderM(n−1)
2TYL/vextenddouble/vextenddouble/vextenddouble//vextenddouble/vextenddouble/vextenddouble/hatwiderM(n−1)
2TYL/vextenddouble/vextenddouble/vextenddoublewhere∥.∥is the
Frobenius norm. The relative difference between estimates decreases with the number of iterations. From
iteration 60, the accuracy becomes limited by the simulation environment. In practice, it is not necessary
to go to this limit, and we notice that from iteration 20 the relative deviation becomes lower than 10−6.
At last, the adaptive versions of the tests (10) and (14) will be simply obtained by replacing the covariance
matrix Mby an appropriate estimate: (15) or (16) according to the environment. Those detectors will be
referred as M-ANMF-G SCM,M-ANMF-R SCM,M-ANMF-G TYL, and M-ANMF-R TYL.
V. Numerical results on simulated data
A. Performance assessment
Two correlation coefficients ρ1andρ2(0<ρ1,ρ2<1), are used in the construction of a speckle covariance
matrix model defined as:
[M]jl=βρ|j1−l1|
1×ρ|j2−l2|
2,
wherej,l∈[1,2m] are sensor numbers of coordinates ( j1,j2) and (l1,l2) respectively and βis a scale
factor. Thus, denoting M=
M11M12
M21M22
,M11andM22are the covariance matrices of array 1 and 2
andM12=MH
21is a cross-correlation block. In the FLS context, the block M11is weakly correlated and
DRAFT11
100101102
iteration10-1510-1010-5100
Fig. 4. Relative estimation error of /hatwideM2TYL versus the number of iterations n(/hatwideM(0)
2TYL=I2m).
Toeplitz structured (close to the identity matrix). M22is also Toeplitz but more strongly correlated (due to
the wider transmission beam). The cross-correlation blocks could be considered null under the uncorrelated
arrays assumption. In our case, these will be different from zero because the arrays cross each other in their
central part. This results in the general structure displayed in Figure 5, where we visually show the adequacy
of this model with the SCM covariance estimator established on real data.
We choose σi= 1.τi= 1 for Gaussian clutter and τi∼Gam(ν,1/ν) withν= 0.5 for impulsive non-
Gaussian K-distributed data (that is, the texture variables follow a gamma distribution with shape parameter
0.5 and scale parameter 2). The PFA-threshold curves are established on the basis of 1000 realizations of
random vectors. The detection probabilities are statistically estimated by adding a synthetic narrow band
far field point target with identical amplitudes on the arrays ( α1=α2). 10000 Monte Carlo iterations are
performed and 150 target amplitudes are evaluated.
DRAFT12
20 40 60 80 100 12020
40
60
80
100
120
-60-55-50-45-40
20 40 60 80 100 12020
40
60
80
100
120
-55-50-45-40-35
Fig. 5. Sonar arrays (left): two uniform linear arrays intersect in their centers. Empirical covariance matrix on real sonar data
shown in dB (center): The SCM is estimated on a homogeneous area between 265 m and 328 m. Cross-correlation blocks are
non-zero. The covariance matrix model used for the data simulation is shown in dB (right): β= 3×10−4,ρ1= 0.4,ρ2= 0.9.
B. Benchmark tests
The GLRT for a single array in a partially homogeneous Gaussian environment, when Miiis known, is
theNormalized Matched Filter [11]:
NMFi(xi) =|pH
iM−1
iixi|2
/parenleftbig
pH
iM−1
iipi/parenrightbig/parenleftbig
xH
iM−1
iixi/parenrightbig. (19)
Adaptive versions are obtained by substituting the covariance matrix by a suitable estimate [35] and will be
referred to as ANMF SCMiin Gaussian case, or ANMF TYLifor the non-Gaussian case.
When the two arrays are considered, in the very favorable case of a Gaussian homogeneous environment
where the covariance matrix Cis perfectly known, the GLRT is:
MIMO-MF( x) =xHC−1P/parenleftbig
PHC−1P/parenrightbig−1PHC−1x. (20)
This is the MIMO Optimum Gaussian Detector (R-MIMO OGD) in [50], which is a multi-array generalization
of the Matched Filter test. One can note the very strong similarity with (14). Its adaptive version is
MIMO-AMF SCM. It seems useful to specify that this detector is relevant only in a Gaussian and perfectly
homogeneous environment. Especially, exactly as in the single-array case [31], the covariance estimator (16)
is defined up to a constant scalar. Detectors (10) and (14) are invariant when the covariance is changed by
a scale factor. This is a direct result of the partial homogeneity assumption. This is not the case for (20),
thus the adaptive MIMO-AMF TYL version is not relevant and will not be used in the following.
These tests will be considered as performance bounds for the proposed detectors: M-NMF-G and M-NMF-
R when Mis known, M-ANMF-G SCM, M-ANMF-R SCM, M-ANMF-G TYL and M-ANMF-R TYL otherwise.
C. Performance in Gaussian clutter
We have shown that all developed detectors are texture-CFAR. Unfortunately, the matrix CFAR property
(distribution of the test remains identical whatever the true covariance matrix) is much more difficult to
DRAFT13
show. Therefore, we propose to perform a study on simulated data to check this matrix CFAR property.
Figure 6 experimentally demonstrates the CFAR behavior of the detectors concerning the covariance matrix
in a Gaussian environment. On the left-hand side, we represent the false alarm probability of Rao’s detector
(for known and estimated M) as a function of the detection threshold. On the right, these curves are plotted
for the GLRT detector.
10-110010110210-410-310-210-1100PFA
MIMO-MF
M-NMF-R
M-ANMF-RSCM
1 1.05 1.1 1.15 1.2 1.2510-410-310-210-1100
M-NMF-G
M-ANMF-GSCM
Fig. 6. Pfa-threshold curves of the M-(A)NMF-R SCM and M-(A)NMF-G SCM detectors in Gaussian environment. Left: the
Rao detector for known M(blue), for Mestimated from 2 ×2msecondary data (red), the OGD detector or Matched Filter
(black). Right: The GLRT detector for known M(blue), and estimated based on 2 ×2msecondary data (red).
The deviation of the adaptive detectors comes from the covariance estimation process: the red curve
converges to the blue one when the number of secondary data used for the estimation of Mincreases. The
markers represent curves for different covariances. In solid line β= 3×10−4,ρ1= 0.4,ρ2= 0.9. The
cross markers are established from β= 1,ρ1= 0.95,ρ2= 0.95. Circular markers are for β= 100,ρ1= 0.1,
ρ2= 0.1 and null anti-diagonal blocks. For very distinct covariances, the superposition of curves and markers
underlines the matrix-CFAR property of the detectors.
Figure 7 illustrates the value of merging arrays with a cross-shaped geometry. The detection probabilities
DRAFT14
-60 -40 -20 0 20 40
1 (in °)-60-40-20020402 (in °)
00.10.20.30.40.50.60.70.80.91
-60 -40 -20 0 20 40
1 (in °)-60-40-20020402 (in °)
00.10.20.30.40.50.60.70.80.91
-60 -40 -20 0 20 40
1 (in °)-60-40-20020402 (in °)
00.10.20.30.40.50.60.70.80.91
Fig. 7. Probability of detection in Gaussian environment for known covariance matrix Mas a function of θ1andθ2(β= 3×10−4,
ρ1= 0.4,ρ2= 0.9,SNR =−12 dB andPFA = 10−2). Top left: NMF 1. Top right: NMF 2. Bottom left: M-NMF-R.
of NMF 1, NMF 2, and M-NMF-R are plotted as a function of azimuth ( θ1) and elevation ( θ2) angles at
fixed SNR. In the first angular dimension, which depends on the array considered, each ULA has a zone
of least detectability close to 0◦. This is due to the correlated nature of clutter. The decrease in detection
probabilities from +/-60◦to 0◦is a function of the correlation level ( ρ1orρ2). In the second dimension, the
detection performances are invariant. Thus, the poor detection performance near 0◦propagates in a whole
direction of space: “vertically” for NMF 1 and “horizontally” for NMF 2. As an illustration, the probability
of detection of NMF 1 in θ1= 0◦whateverθ2isPD= 0.17, and the probability of detection of NMF 2 in
θ2= 0◦for allθ1is 0.03. The M-NMF-R detector spatially minimizes this area of least detectability. In this
case, the probability of detection at θ1= 0◦becomes greater than 0 .8 for|θ2|>10.5◦and greater than 0 .5
forθ2= 0◦and|θ1|>24◦. The Rigde clutter is minimized.
The probability of detection (PD) is plotted as a function of the signal-to-noise ratio (SNR) in Figure 8
when Mis known. The MIMO-MF detector (shown in black), which requires a perfect knowledge of the
DRAFT15
covariance, is logically the most efficient. The single array NMF detectors (NMF 1 and 2, in purple and
green) have comparable and the lowest performance. The M-NMF-I detector (in blue) between these curves
assumes antenna independence. The proposed M-NMF-G (red) and M-NMF-R (yellow) detectors are both
equivalent and superior to the M-NMF-I (0.2 dB at PD= 0.8) and much more efficient than NMF 1 (2.5 dB)
and NMF 2 tests (2 dB). The difference with MIMO-MF is slight, around 0.2 dB at PD= 0.8. Detection
performances by the Rao approach are slightly superior to those obtained by the GLRT.
-30 -25 -20 -15 -10 -5
SNR (in dB) 00.10.20.30.40.50.60.70.80.91PD 
MIMO MF 
MIMO AMF SCM 
M-ANMF-G SCM 
M-ANMF-R SCM 
ANMF 1SCM 
ANMF 2SCM 
-30 -25 -20 -15 -10 -5
SNR (in dB) 00.10.20.30.40.50.60.70.80.91PD 
MIMO MF 
M-NMF-I 
M-NMF-G 
M-NMF-R 
NMF 1
NMF 2
-15 -14 -13 -12 -11 -10 0.50.60.70.80.9
-17 -16 -15 -14 -13 -12 -110.50.60.70.80.9
Fig. 8. Probability of detection in Gaussian environment for known M(β= 3×10−4,ρ1= 0.4,ρ2= 0.9 andPFA = 10−2).
Figure 9 compares the performance of the tests in their adaptive versions. The MIMO-MF curve is shown
in black dotted lines for illustrative purposes only (as it assumes the covariance known). It can be seen that
when the SCM is evaluated on 2 ×2m= 256 secondary data, the covariance estimation leads to a loss of
3 dB between the performances of the MIMO-MF test and its adaptive version MIMO-AMF, as expected
from the Reed-Mallett-Brennan’s rule [51]. In their adaptive versions, the proposed detectors offer equivalent
performances to the MIMO-AMF detectors while offering additional robustness and flexibility conditions on
DRAFT16
a possible lack of knowledge of the covariance (estimated to be within two scale factors). The gain compared
to single array detectors, although reduced compared to the case where Mis known, remains favorable and
of the order of 0.5 to 1 dB at PD= 0.8. In other words, for an SNR of -11 dB, PD= 0.75 for ANMF 1
and 0.85 for M-ANMF-G SCM (or M-ANMF-R SCM).
-30 -25 -20 -15 -10 -5
SNR (in dB) 00.10.20.30.40.50.60.70.80.91PD 
MIMO MF 
MIMO AMF SCM 
M-ANMF-G SCM 
M-ANMF-R SCM 
ANMF 1SCM 
ANMF 2SCM 
-15 -14 -13 -12 -11 -10 0.50.60.70.80.9
Fig. 9. Probability of detection in Gaussian environment for unknown M(PFA = 10−2, SCMs are estimated based on 2 ×2m
secondary data).
D. Performance in impulsive non-Gaussian clutter
PFA-threshold curves in K-distributed environment are displayed in Figure 10 to characterize the matrix-
CFAR behavior. The detectors based on the new covariance matrix estimator systematically have lower
detection thresholds than those obtained with the SCM. While optimal for a Gaussian clutter, the MIMO-
MF detector is no longer suitable. The marker overlays highlight the matrix-CFAR behavior of the Rao
detector in a non-Gaussian environment. The case of the GLRT detector is much less obvious: at this stage,
it seems complicated to consider that the false alarm curves are strictly independent of the covariance matrix.
DRAFT17
10-110010110210-410-310-210-1100PFA
MIMO-MF
M-NMF-R
M-ANMF-RSCM
M-ANMF-RTYL
M-ANMF-RTYL 
(real data)
1 1.05 1.1 1.15 1.2 1.2510-410-310-210-1100
M-NMF-G
M-ANMF-GSCM
M-ANMF-GTYL
M-ANMF-GTYL 
(real data)
Fig. 10. Pfa-threshold curves for Rao (left) and GLRT (right) detectors in non-Gaussian K-distributed environment ( ν= 0.5).
In blue Mis known, in red Mis estimated with the SCM, in yellow Mis estimated with the new estimator /hatwideM2TYL , the OGD
orMatched Filter detector is black. In magenta the curves are obtained on real data between 300 m and 315 m (see VI-A).
The detection performances are compared in Figure 11. For the Rao and GLRT detectors, using the
estimator (16) in an impulsive non-Gaussian environment induces a gain in detection performance of the
order of 1.2 dB at PD= 0.8 with the SCM. Compared to the best competitors the improvement is 3 dB at
PD= 0.8.
VI. Experimental data with real target
The sonar measurements were collected during an acquisition campaign in May 2022 in La Ciotat Bay,
Mediterranean Sea. The experimental conditions are described in II-B, and the dataset of interest is shown
in Figure 3. Echoes from the true target (right in Figure 2) are observed at the 2040th range cell.
A. Overview of real data statistics
1000 real data 2 m-samples are selected from the range bin 1000 to 1999 (i.e. from 78 m to 140 m in
Figure 3). If the samples are complex Gaussian x∼ CN (0,M)∈C2mthe Hermitian form is Gamma
DRAFT18
-30 -25 -20 -15 -10 -5
SNR (in dB) 00.10.20.30.40.50.60.70.80.91PD 
MIMO MF 
MIMO AMF SCM 
M-ANMF-G SCM 
M-ANMF-R SCM 
ANMF 1SCM 
ANMF 2SCM 
-50 -40 -30 -20 -10 0 
SNR (in dB) 00.10.20.30.40.50.60.70.80.91PD 
MIMO AMF SCM 
M-ANMF-G SCM 
M-ANMF-R SCM 
M-ANMF-G TYL 
M-ANMF-R TYL 
ANMF TYL  1 
ANMF TYL  2 
-15 -14 -13 -12 -11 -10 0.50.60.70.80.9
-20 -19 -18 -17 -16 -15 -14 -13 -12 -11 -100.50.60.70.80.9
Fig. 11. Probability of detection in K-distributed environment for unknown M(ν= 0.5,PFA = 10−2, 2×2msecondary data).
In solid lines, the detectors are built with the SCM estimate. In dotted-lines, the detectors are built with Tyler’s (single array)
or the new (dual arrays) estimator.
distributed xH/hatwiderM−1x∼Gam (2m,1). The modulus (or amplitude) of a standardized univariate marginal
follows a Rayleigh distribution:
px(x) = 2xexp/parenleftbig
−x2/parenrightbig
. (21)
Note that the PDF of the amplitude of a standardized univariate K-distribution is given by [31]:
px(x) =2√ν
2ν−1Γ (ν)/parenleftbig
2√νx/parenrightbigνKν−1/parenleftbig
2√νx/parenrightbig
, (22)
whereν >0 is the shape parameter and Kl(.) denotes the modified Bessel function of the second kind of
orderl.
Figure 12 (left) shows the quantile-quantile diagram of the quadratic form xH/hatwiderM−1xversus a Gamma
distribution. Quantile-quantile diagrams depict the scatter-plot of empirical quantiles versus the theoretical
DRAFT19
quantiles of a presupposed distribution. If the quantiles are similar, the plot looks like a straight line, and we
can conclude that the empirical and theoretical distributions are identical. In Figure 12 the curve deviates
from a straight line as we move away from the central abscissa. The plot is not linear. The empirical and
reference distributions are not the same and the real data is not complex Gaussian. On the right side of Figure
12 the empirical amplitude distribution of the first marginal is plotted as a histogram, Rayleigh’s PDF is blue,
the PDF of the amplitude of a standardized univariate K-distribution is red. While the Rayleigh distribution
gives a very poor fit, the agreement with a K-distribution is very good. The analysis of these simple statistical
indicators shows that empirical data are not distributed according to a Gaussian distribution and are rather
close to a K-distribution.
80 100 120 140 160 180
Gam(2m,1) quantiles-50050100150200250300350400ML-standardized empirical quantiles 
0 0.5 1 1.5 2 2.5 3 3.5 4
 00.10.20.30.40.50.60.70.80.91
empirical pdf
Rayleigh pdf
K pdf (=3)
Fig. 12. Quantile-quantile diagram (left) and empirical distribution (right) on real data.
Figure 10 also shows the Pfa-threshold curves of the Rao and GLRT detectors obtained on real experimen-
tal data (from 300 m to 315 m on Figure 3), with magenta markers. The markers appear to be superimposed
on the simulated data. This good agreement validates our modeling of the environment and the ability
to predefine the detection threshold. Note that since the SCM estimator is not texture-independent, the
corresponding Pfa-threshold curves are not shown.
B. Illustrations of detection test outputs
Figure 13 provides examples of real data outputs from conventional ANMF detectors based on a single
array. The real target is observed in range bin 2040 (143 m away from the sonar), at angular bin θ1= 26
(−12.4◦azimuth), and angular bin θ2= 37 (8.6◦elevation).
Figure 14 shows the outputs of the Rao and GLRT detectors applied simultaneously to both arrays at
the specific range bin 2040. These subfigures are not directly comparable with each other or with Figure 13.
The target is perfectly located in azimuth and elevation.
DRAFT20
Fig. 13. ANMF SCM detector outputs on real sonar data. A target is observed on array 1 (left) at coordinates (26 ,2040) and
on array 2 (right) at coordinates (37 ,2040). The SCM is built from 256 secondary data.
10
20
30
40
50
60210
20
30
40
50
601050
010203040506070
10
20
30
40
50
60210
20
30
40
50
60111.522.5
11.522.5
Fig. 14. Outputs of the M-ANMF-R SCM (left) and M-ANMF-G SCM (right) detectors. The real target is at coordinates (37,
26). The SCM is built from 256 secondary data.
C. Robustness to training data corruption
Previously, we assumed the availability of a set of K≥2mi.i.d. secondary data, supposed free of signal
components and sharing statistic properties with the noise in the cell under test. In practice, such data can
be obtained by processing samples in spatial proximity to the range bin being evaluated, and the absence of
signals is not always verified or checkable. In particular, this assumption is no longer valid if another target
is present in these secondary data.
Figure 15 illustrates the robustness of the covariance matrix estimators to data corruption. A synthetic
target is added 100 samples away from the real target and contaminates the secondary dataset. On the left-
hand side, the output of M-ANMF-R SCM is strongly degraded. The SCM is not robust to the presence of
outliers. The target is hardly discernible, and the maximum is wrongly located. Under the same conditions,
DRAFT21
the response of the M-ANMF-R TYL detector is visualized in the right part. Although degraded compared to
Figure 14, the behavior is still largely usable. The target presence is easily identified, and the new estimator
(16) is much more resistant to data contamination.
10
20
30
40
50
60210
20
30
40
50
601050
0102030405060
10
20
30
40
50
60210
20
30
40
50
601050
0102030405060
Fig. 15. Rao detector outputs based on the SCM (left) or Tyler (right) with secondary data corruption. The covariance matrix
estimators are based on 256 secondary data.
VII. Conclusions
In this paper, we considered the problem of adaptive point target detection by a correlated multi-arrays
Mills Cross sonar system. Using a 2-step approach, we first derived two new detectors that are robust to
differences in target amplitudes and to unknown scaling factors on the covariances. Subsequently, we have
introduced an innovative estimator of the covariance matrix suitable to any non-Gaussian MSG environment.
By these very general assumptions, the framework of the study can therefore concern systems with co-located
or remote arrays.
Experimental results show that the detection performance is up to 3 dB better than conventional ap-
proaches. The detectors cover a larger detection area and are particularly robust to spikes, impulsive noise,
and data contamination.
Future work will focus on establishing a theoretical demonstration of the matrix-CFAR behavior of these
detectors, and on generalizing solutions for different numbers and geometries of arrays.
Acknowledgments
This work has been done thanks to the facilities offered by the Univ. Savoie Mont Blanc - CNRS/IN2P3
MUST computing center.
Appendix A
GLRT’s derivation
For the following, and for ease of reading, the punctuation mark “tilde” will be omitted. Thus /tildewideΣand ˜σi
will simply be denoted as Σandσi. The same is true for their respective estimates.
DRAFT22
A. Maximum Likelihood Estimator of ΣunderH0
The MLE ˆΣ0is derived from the log-likelihood function:
lnpx(x;Σ,H0) =−mLlnπ+ 2 ln|Σ−1|−ln|M|−/parenleftbig
xHΣ−1M−1Σ−1x/parenrightbig
,
whose derivative relative to Σ−1is:
∂lnpx(x;Σ,H0)
∂Σ−1= 2∂ln|Σ−1|
∂Σ−1−∂xHΣ−1M−1Σ−1x
∂Σ−1.
Knowing that ([52] (57))∂ln|Σ−1|
∂Σ−1=Σ, and ([52] (82))∂xHΣ−1M−1Σ−1x
∂Σ−1= 2Re/parenleftbig
M−1Σ−1x xH/parenrightbig
we
have:
∂lnpx(x;Σ,H0)
∂Σ−1= 2Σ−2Re/parenleftbig
M−1Σ−1x xH/parenrightbig
,
which leads to:
ˆΣ0= Re/parenleftig
M−1ˆΣ−1
0x xH/parenrightig
. (23)
Expanding this matrix product with ˆΣ0=
ˆσ10Im 0
0 ˆσ20Im
, we have:
ˆσ10Im= Re
M−1
11x1xH
1
ˆσ10+M−1
12x2xH
1
ˆσ20
,
where M−1
11andM−1
12are the 11th and 12th block of M−1respectively. Using the trace operator:
mˆσ10= tr
Re
M−1
11x1xH
1
ˆσ10+M−1
12x2xH
1
ˆσ20

,
=xH
1M−1
11x1
ˆσ10+ Re
xH
1M−1
12x2
ˆσ20
.
We then have:
ˆσ10=1
ˆσ10xH
1M−1
11x1
m+1
ˆσ20Re/parenleftbig
xH
1M−1
12x2/parenrightbig
m, (24)
and
ˆσ20=1
ˆσ10Re/parenleftbig
xH
2M−1
21x1/parenrightbig
m+1
ˆσ20xH
2M−1
22x2
m. (25)
Denotinga1=xH
1M−1
11x1
m,a12=Re/parenleftbig
xH
1M−1
12x2/parenrightbig
m,
a2=xH
2M−1
22x2
mand using (24) and (25):


ˆσ2
10=a1+ˆσ10
ˆσ20a12
ˆσ2
20=ˆσ20
ˆσ10a12+a2,(26)
DRAFT23
or: 

ˆσ2
10=a1+ˆσ10
ˆσ20a12
ˆσ2
10=ˆσ10
ˆσ20a12+ˆσ2
10
ˆσ2
20a2.
By equalization of right-hand terms:
a1=ˆσ2
10
ˆσ2
20a2,
and keeping the positive solution:ˆσ10
ˆσ20=/radicaltp/radicalvertex/radicalvertex/radicalbta1
a2, we obtain from (26):


ˆσ2
10=a1+/radicaltp/radicalvertex/radicalvertex/radicalbta1
a2a12
ˆσ2
20=a2+/radicaltp/radicalvertex/radicalvertex/radicalbta2
a1a12,(27)
and
ˆσ2
10ˆσ2
20= (√a1a2+a12)2. (28)
B. Maximum Likelihood Estimator of αunderH1
The ML estimates ˆα= [ˆα1ˆα2]Tis found minimizing ( x−Pα)HC−1(x−Pα) with respect to αas ([53]
(15.50)):
ˆα=/parenleftbig
PHC−1P/parenrightbig−1PHC−1x,
=/parenleftbig
PHΣ−1M−1Σ−1P/parenrightbig−1PHΣ−1M−1Σ−1x.(29)
C. Maximum Likelihood Estimator of ΣunderH1
The derivative of the log-likelihood function under H1with respect to Σ−1is:
∂lnpx(x;ˆα,Σ,H1)
∂Σ−1= 2∂ln|Σ−1|
∂Σ−1−∂(x−Pˆα)HΣ−1M−1Σ−1(x−Pˆα)
∂Σ−1.
Furthermore:
(x−Pˆα)HΣ−1M−1Σ−1(x−Pˆα)
=xHΣ−1M−1Σ−1x−ˆαHPHΣ−1M−1Σ−1x
=xHΣ−1M−1Σ−1x−xHΣ−1M−1Σ−1P/parenleftbig
PHΣ−1M−1Σ−1P/parenrightbig−1
PHΣ−1M−1Σ−1x.
DRAFT24
IfZ=
σ10
0σ2
, we then notice that Σ−1P=PZ−1andPHΣ−1=Z−1PH. Thus:
xHΣ−1M−1Σ−1P/parenleftbig
PHΣ−1M−1Σ−1P/parenrightbig−1PHΣ−1M−1Σ−1x
=xHΣ−1M−1PZ−1/parenleftbig
Z−1PHM−1PZ−1/parenrightbig−1Z−1PHM−1Σ−1x
=xHΣ−1M−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1Σ−1x.
By denoting D−1=M−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1:
(x−Pˆα)HΣ−1M−1Σ−1(x−Pˆα) =xHΣ−1M−1Σ−1x−xHΣ−1D−1Σ−1x.
So:
∂(x−Pˆα)HΣ−1M−1Σ−1(x−Pˆα)
∂Σ−1= 2Re/bracketleftbig/parenleftbig
M−1−D−1/parenrightbig
Σ−1x xH/bracketrightbig
.
Finally:
∂lnpx(x;ˆα,Σ,H1)
∂Σ−1= 2Σ−2Re/bracketleftbig/parenleftbig
M−1−D−1/parenrightbig
Σ−1x xH/bracketrightbig
.
The minimum is given by:
ˆΣ1= Re/bracketleftig/parenleftbig
M−1−D−1/parenrightbigˆΣ−1
1x xH/bracketrightig
. (30)
The rest is identical to paragraph A-A.
D. Expression of the GLRT
AsxHˆΣ−1
0M−1ˆΣ−1
0xis a real positive scalar, we have:
xHˆΣ−1
0M−1ˆΣ−1
0x= Re/bracketleftig
tr/parenleftig
ˆΣ−1
0M−1ˆΣ−1
0x xH/parenrightig/bracketrightig
,
= tr/bracketleftig
ˆΣ−1
0Re/parenleftig
M−1ˆΣ−1
0x xH/parenrightig/bracketrightig
,
=mL.
So the two PDF take the form:
px(x;ˆΣ0,H0) =1
πmL|ˆΣ0|2|M|exp (−mL),
px(x;ˆα,ˆΣ1,H1) =1
πmL|ˆΣ1|2|M|exp (−mL).
The GLRT is expressed as:
LG(x) =1
|ˆΣ1|2
1
|ˆΣ0|2=|ˆΣ0|2
|ˆΣ1|2, (31)
which can be thought of as a generalized variance ratio. As ˆΣ0and ˆΣ1are diagonal matrices, |ˆΣ0|=2/productdisplay
i=1ˆσm
i0
and|ˆΣ1|=2/productdisplay
i=1ˆσm
i1which leads to (10).
DRAFT25
Appendix B
Special cases of the GLRT detector
The detector (10) can be declined in already-known cases.
A. Single array case
For a single array, we have ˆ σ2
10=xH
1M−1
11x1
mand ˆσ2
11=1
m
xH
1M−1
11x1−|pH
1M−1
11x1|2
pH
1M−1
11p1
.
Replacing into the likelihood LG(x) =|ˆΣ0|2
|ˆΣ1|2=ˆσ2m
10
ˆσ2m
11leads to:
LG(x)1/m=ˆσ2
10
ˆσ2
11=xH
1M−1
11x1
m
1
m
xH
1M−1
11x1−|pH
1M−1
11x1|2
pH
1M−1
11p1
,
=
1−|pH
1M−1
11x1|2
/parenleftbig
pH
1M−1
11p1/parenrightbig/parenleftbig
xH
1M−1
11x1/parenrightbig
−1
.
DefininglG(x) =LG(x)1/m−1
LG(x)1/m= 1−LG(x)−1/m, we obtain the well-known NMF detector [11]:
lG(x) =|pH
1M−1
11x1|2
/parenleftbig
pH
1M−1
11p1/parenrightbig/parenleftbig
xH
1M−1
11x1/parenrightbig. (32)
B. Uncorrelated arrays case
When the two arrays are fully uncorrelated, we have ˆ σ2
i0=xH
iM−1
iixi
mand ˆσ2
i1=1
m
xH
iM−1
iixi−|pH
iM−1
iixi|2
pH
iM−1
iipi
.
We obtain:
LG(x) =|ˆΣ0|2
|ˆΣ1|2=2/productdisplay
i=1ˆσ2m
i0
2/productdisplay
i=1ˆσ2m
i1=2/productdisplay
i=1
ˆσ2
i0
ˆσ2
i1
m
, (33)
=2/productdisplay
i=1
1−|pH
iM−1
iixi|2
/parenleftbig
pH
iM−1
iipi/parenrightbig/parenleftbig
xH
iM−1
iixi/parenrightbig
−m
. (34)
This corresponds to the MIMO ANMF detector on independent arrays presented in [40].
DRAFT26
C.Σ=σI2mcase
When Σis the identity matrix up to a scalar factor, σ1=σ2, whose estimators are renamed ˆ σ0underH0
and ˆσ1underH1.
LG(x) =|ˆΣ0|2
|ˆΣ1|2, with ˆΣ0= ˆσ0ImLand ˆΣ1= ˆσ1ImL,
=ˆσ2mL
0
ˆσ2mL
1.
From ˆΣ0= Re/parenleftig
M−1ˆΣ−1
0x xH/parenrightig
, we have the following relations:
tr/parenleftig
ˆΣ0/parenrightig
= tr/bracketleftig
Re/parenleftig
M−1ˆΣ−1
0x xH/parenrightig/bracketrightig
,
ˆσ0tr (ImL) =1
ˆσ0Re/bracketleftbig
tr/parenleftbig
M−1x xH/parenrightbig/bracketrightbig
,
ˆσ2
0=xHM−1x
mL, asM−1is positive definite .
Identically, we have:
ˆσ2
1=(x−Pα)HM−1(x−Pα)
mL,
=xHM−1x−xHM−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1x
mL.
LG(x)1/mL=ˆσ2
0
ˆσ2
1,
=xHM−1x
xHM−1x−xHM−1P(PHM−1P)−1PHM−1x,
=
1−xHM−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1x
xHM−1x
−1
.
By defining lG(x) =LG(x)1/mL−1
LG(x)1/mLorLG(x)1/mL= [1−lG(x)]−1, we obtain an equivalent test:
lG(x) =xHM−1P/parenleftbig
PHM−1P/parenrightbig−1PHM−1x
xHM−1x, (35)
which corresponds to the subspace version of the ACE test presented in [54].
Appendix C
Rao’s detector derivation
The partial derivative of the log-likelihood function is defined as:
∂lnpx(x;ξR,ξS)
∂ξR=
∂lnpx(x;ξR,ξS)
∂Re (α)
∂lnpx(x;ξR,ξS)
∂Im (α)
.
DRAFT27
From [53] (15.60), we obtain:
∂lnpx(x;ξR,ξS)
∂ξR=
2 Re/bracketleftbig
PHC−1(ξS) (x−Pα)/bracketrightbig
2 Im/bracketleftbig
PHC−1(ξS) (x−Pα)/bracketrightbig
.
Thus:
∂lnpx(x;ξR,ξS)
∂ξR/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleξR=0
ξS=ˆξS0=
2 Re/bracketleftig
PHC−1(ˆξS0)x/bracketrightig
2 Im/bracketleftig
PHC−1(ˆξS0)x/bracketrightig
. (36)
Using [53] (15.52) IξSξR(ξR,ξS) =IξRξS(ξR,ξS) =0, thus/bracketleftbig
I−1(ξR,ξS)/bracketrightbig
ξRξR=I−1
ξRξR(ξR,ξS). The elements
ofIξRξR(ξR,ξS) are given by:
/bracketleftbig
IξRξR(ξR,ξS)/bracketrightbig
11= 2 PHC−1(ξS)P,
/bracketleftbig
IξRξR(ξR,ξS)/bracketrightbig
22= 2 PHC−1(ξS)P,
/bracketleftbig
IξRξR(ξR,ξS)/bracketrightbig
12= 2 Re/bracketleftbig
iPHC−1(ξS)P/bracketrightbig
=0,
/bracketleftbig
IξRξR(ξR,ξS)/bracketrightbig
21= 2 Re/bracketleftbig
−iPHC−1(ξS)P/bracketrightbig
=0.
We have therefore:
IξRξR(ξR,ξS) =
2PHC−1(ξS)P 0
0 2PHC−1(ξS)P
. (37)
Finally, by replacing (36) and (37) into (12) leads to:
LR(x) =/bracketleftig
2 Re/parenleftbig
xHC−1(ˆξS0)P/parenrightbig
−2 Im/parenleftbig
xHC−1(ˆξS0)P/parenrightbig/bracketrightig
/parenleftbig
PHC−1(ˆξS0)P/parenrightbig−1
20
0/parenleftbig
PHC−1(ˆξS0)P/parenrightbig−1
2
/bracketleftigg
2 Re/parenleftbig
PHC−1(ˆξS0)x/parenrightbig
2 Im/parenleftbig
PHC−1(ˆξS0)x/parenrightbig/bracketrightigg
,
which simplifies to:
LR(x) = 2/bracketleftbigg
Re/parenleftig
xHC−1(ˆξS0)P/parenrightig/parenleftig
PHC−1(ˆξS0)P/parenrightig−1
Re/parenleftig
PHC−1(ˆξS0)x/parenrightig
−Im/parenleftig
xHC−1(ˆξS0)P/parenrightig/parenleftig
PHC−1(ˆξS0)P/parenrightig−1
Im/parenleftig
PHC−1(ˆξS0)x/parenrightig/bracketrightig
.
Knowing that PHC−1(ˆξS0)Pis real and positive definite, it can be factorized and incorporated into the
real and imaginary parts. After some algebraic manipulation, we obtain (14).
Appendix D
Maximum likelihood estimator of the covariance matrix in Compound-Gaussian clutter
The likelihood of {xk}k∈[1,K]underH0can be rewritten as:
px/parenleftig
{xk}k∈[1,K];M,Tk,H0/parenrightig
=K/productdisplay
k=11
π2m|/tildewideC|exp/parenleftig
−xH
k/tildewideC−1xk/parenrightig
,
=1
π2mK|M|KK/productdisplay
k=11
|Tk|2exp/parenleftbig
−xH
kT−1
kM−1T−1
kxk/parenrightbig
,
DRAFT28
where/tildewideC=TkMTk, and Tk=
√τ1k 0
0√τ2k
⊗Im.
The log-likelihood can be written as:
lnpx/parenleftig
{xk}k∈[1,K];M,Tk,H0/parenrightig
=−2mK lnπ−Kln|M|
+ 2K/summationdisplay
k=1ln|T−1
k|−K/summationdisplay
k=1xH
kT−1
kM−1T−1
kxk.(38)
According to [52] (82), the derivative with respect to T−1
kis:
∂lnpx({xk}k∈[1,K];M,Tk,H0)
∂T−1
k= 2Tk−2 Re/parenleftbig
M−1T−1
kxkxH
k/parenrightbig
. (39)
Following the same approach as in Appendix A, we obtain the minimum for Tkfor a fixed M:
/hatwideTk= Re/parenleftig
M−1/hatwideT−1
kxkxH
k/parenrightig
, (40)
where
/hatwideTk=
/radicalbig
ˆτ1k 0
0/radicalbig
ˆτ2k
⊗Im, (41)
and
ˆτ1k=t1+/radicaltp/radicalvertex/radicalvertex/radicalbtt1
t2t12, (42)
ˆτ2k=t2+/radicaltp/radicalvertex/radicalvertex/radicalbtt2
t1t12, (43)
with
t1=1
mxH
1,kM−1
11x1,k, (44)
t2=1
mxH
2,kM−1
22x2,k, (45)
t12=1
mRe/parenleftbig
xH
1,kM−1
12x2,k/parenrightbig
. (46)
Replacing Tkby/hatwideTkin (38) and deriving with respect to M−1lead to:
∂lnpx({xk}k∈[1,K];M,/hatwideTk,H0)
∂M−1=KM−K/summationdisplay
k=1/parenleftig
/hatwideT−1
kxk/parenrightig/parenleftig
/hatwideT−1
kxk/parenrightigH
, (47)
and the minimum in Mis given by:
/hatwiderM=1
KK/summationdisplay
k=1/parenleftig
/hatwideT−1
kxk/parenrightig/parenleftig
/hatwideT−1
kxk/parenrightigH
, (48)
=1
KK/summationdisplay
k=1/hatwideT−1
kxkxH
k/hatwideT−1
k. (49)
DRAFT29
The estimator (49) is independent of the textures. This could be shown by substituting xk=
x1,k
x2,k
by

√τ1kc1,k
√τ2kc2,k
in (41) and (49).
References
[1] I. Karoui, I. Quidu, and M. Legris, “Automatic sea-surface obstacle detection and tracking in forward-looking sonar image
sequences,” IEEE Transactions on Geoscience and Remote Sensing , vol. 53, no. 8, pp. 4661–4669, 2015.
[2] I. Quidu, L. Jaulin, A. Bertholom, and Y. Dupas, “Robust multitarget tracking in forward-looking sonar image sequences
using navigational data,” IEEE Journal of Oceanic Engineering , vol. 37, no. 3, pp. 417–430, 2012.
[3] I. Quidu, A. Bertholom, and Y. Dupas, “Ground obstacle tracking on forward looking sonar images,” in Proceedings of
ECUA’10 , July 2010.
[4] Y. Petillot, I. Tena Ruiz, and D. M. Lane, “Underwater vehicle obstacle avoidance and path planning using a multi-beam
forward-looking sonar,” IEEE Journal of Oceanic Engineering , vol. 26, no. 2, pp. 240–251, 2001.
[5] B. Braginsky and H. Guterman, “Obstacle avoidance approaches for autonomous underwater vehicle: Simulation and
experimental results,” IEEE Journal of Oceanic Engineering , vol. 41, no. 4, pp. 882–892, 2016.
[6] D. A. Abraham and P. K. Willett, “Active sonar detection in shallow water using the page test,” IEEE Journal of Oceanic
Engineering , vol. 27, no. 1, pp. 35–46, 2002.
[7] D. A. Abraham, “Detection-threshold approximation for non-Gaussian backgrounds,” IEEE Journal of Oceanic
Engineering , vol. 35, no. 2, pp. 355–365, 2010.
[8] D. A. Abraham, “Distributed active sonar detection in dependent K-distributed clutter,” IEEE Journal of Oceanic
Engineering , vol. 34, no. 3, pp. 343–357, 2009.
[9] E. J. Kelly, “An adaptive detection algorithm,” IEEE Transactions on Aerospace and Electronic Systems , vol. AES-22,
no. 2, pp. 115–127, 1986.
[10] F. C. Robey, D. R. Fuhrmann, E. J. Kelly, and R. Nitzberg, “A CFAR adaptive matched filter detector,” IEEE Transactions
on Aerospace and Electronic Systems , vol. 28, no. 1, pp. 208–216, 1992.
[11] L. L. Scharf and B. Friedlander, “Matched subspace detectors,” IEEE Transactions on Signal Processing , vol. 42, no. 8,
pp. 2146–2157, 1994.
[12] S. Kraut, L. L. Scharf, and L. T. McWhorter, “Adaptive subspace detectors,” IEEE Transactions on Signal Processing ,
vol. 49, no. 1, pp. 1–16, 2001.
[13] J. Ward, “Space-Time Adaptive Processing for airborne radar,” Tech. Rep., Lincoln Lab., MIT, Lexington, Mass., USA,
December 1994.
[14] E. Fishler, A. Haimovich, R. S. Blum, L. J. Cimini, D. Chizhik, and R. A. Valenzuela, “Spatial diversity in radars—models
and detection performance,” IEEE Transactions on Signal Processing , vol. 54, no. 3, pp. 823–838, 2006.
[15] E. Fishler, A. Haimovich, R. Blum, R. Cimini, D. Chizhik, and R. Valenzuela, “Performance of MIMO radar systems:
advantages of angular diversity,” in Conference Record of the Thirty-Eighth Asilomar Conference on Signals, Systems and
Computers, 2004. , 2004, vol. 1, pp. 305–309 Vol.1.
[16] N. H. Lehmann, A. M. Haimovich, R. S. Blum, and L. Cimini, “High resolution capabilities of MIMO radar,” in 2006
Fortieth Asilomar Conference on Signals, Systems and Computers , 2006, pp. 25–30.
[17] J. Li and P. Stoica, “MIMO radar with colocated antennas,” IEEE Signal Processing Magazine , vol. 24, no. 5, pp. 106–114,
2007.
[18] L. Wei, W. Zhijie, L. Jianchen, W. Mingzhou, H. Qiao, and Y. Baomin, “Application of improved space-time adaptive
processing in sonar,” 2012 International Conference on Computer Science and Electronics Engineering , vol. 3, pp. 344–348,
2012.
[19] W. Li, G. Chen, E. Blasch, and R. Lynch, “Cognitive MIMO sonar based robust target detection for harbor and maritime
surveillance applications,” in 2009 IEEE Aerospace conference , 2009, pp. 1–9.
[20] N. M. Sasi, P. S. Sathidevi, R. Pradeepa, and S. Gopi, “A low complexity STAP for reverberation cancellation in active
sonar detection,” in 2010 IEEE Sensor Array and Multichannel Signal Processing Workshop , 2010, pp. 245–248.
DRAFT30
[21] S. U. Pillai, J. R. Guerci, and S. R. Pillai, “Wideband STAP (WB-STAP) for passive sonar,” in Oceans 2003. Celebrating
the Past ... Teaming Toward the Future (IEEE Cat. No.03CH37492) , 2003, vol. 5, pp. 2814–2818.
[22] X. Pan, Z. Liu, P. Zhang, Y. Shen, and J. Qiu, “Distributed MIMO sonar for detection of moving targets in shallow sea
environments,” Applied Acoustics , vol. 185, pp. 108366, 2022.
[23] X. Liu, T. Wei, C. Sun, Y. Yang, and J. Zhuo, “High-resolution two-dimensional imaging using MIMO sonar with limited
physical size,” Applied Acoustics , vol. 182, pp. 108280, 2021.
[24] J. D. Tucker and M. R. Azimi-Sadjadi, “Coherence-based underwater target detection from multiple disparate sonar
platforms,” IEEE Journal of Oceanic Engineering , vol. 36, no. 1, pp. 37–51, 2011.
[25] J. Xue, M. Ma, J. Liu, M. Pan, S. Xu, and J. Fang, “Wald- and Rao-based detection for maritime radar targets in sea
clutter with lognormal texture,” IEEE Transactions on Geoscience and Remote Sensing , vol. 60, pp. 1–9, 2022.
[26] D. Ciuonzo, V. Carotenuto, and A. De Maio, “On multiple covariance equality testing with application to SAR change
detection,” IEEE Transactions on Signal Processing , vol. 65, no. 19, pp. 5078–5091, 2017.
[27] M. Sun, W. Liu, J. Liu, and C. Hao, “Complex parameter Rao, Wald, Gradient, and Durbin tests for multichannel signal
detection,” IEEE Transactions on Signal Processing , vol. 70, pp. 117–131, 2022.
[28] P. Wang, H. Li, and B. Himed, “A parametric moving target detector for distributed MIMO radar in non-homogeneous
environment,” IEEE Transactions on Signal Processing , vol. 61, no. 9, pp. 2282–2294, 2013.
[29] W. Liu, W. Xie, J. Liu, and Y. Wang, “Adaptive double subspace signal detection in Gaussian background—part I:
Homogeneous environments,” IEEE Transactions on Signal Processing , vol. 62, no. 9, pp. 2345–2357, 2014.
[30] B. Y. Mills and A. G. Little, “A high-resolution aerial system of a new type,” Australian Journal of Physics , vol. 6, no. 3,
pp. 272–278, 1953.
[31] E. Ollila, D. E. Tyler, V. Koivunen, and H. V. Poor, “Complex elliptically symmetric distributions: Survey, new results
and applications,” IEEE Transactions on Signal Processing , vol. 60, no. 11, pp. 5597–5625, 2012.
[32] A. Farina, F. Gini, M.V. Greco, and L. Verrazzani, “High resolution sea clutter data: statistical analysis of recorded live
data,” IEE Proceedings - Radar, Sonar and Navigation , vol. 144, pp. 121–130(9), June 1997.
[33] J. B. Billingsley, A. Farina, F. Gini, M. V. Greco, and L. Verrazzani, “Statistical analyses of measured radar ground clutter
data,” IEEE Transactions on Aerospace and Electronic Systems , vol. 35, no. 2, pp. 579–593, 1999.
[34] M. Greco, F. Bordoni, and F. Gini, “X-band sea-clutter nonstationarity: influence of long waves,” IEEE Journal of Oceanic
Engineering , vol. 29, no. 2, pp. 269–283, 2004.
[35] J.-P. Ovarlez, F. Pascal, and P. Forster, “Covariance Matrix Estimation in SIRV and Elliptical Processes and Their
Applications in Radar Detection,” in Modern Radar Detection Theory , IET A. De Maio and M. S. Greco, Eds., number
chapter 8, pp. 295–332. Scitech Publishing, 2015.
[36] A.-A. Saucan, T. Chonavel, C. Sintes, and J.-M. Le Caillec, “CPHD-DOA tracking of multiple extended sonar targets in
impulsive environments,” IEEE Transactions on Signal Processing , vol. 64, no. 5, pp. 1147–1160, 2016.
[37] A. Hippert-Ferrer, M.N. El Korso, A. Breloy, and G. Ginolhac, “Robust low-rank covariance matrix estimation with a
general pattern of missing values,” Signal Processing , vol. 195, pp. 108460, 2022.
[38] F. Pascal, Y. Chitour, J.-P. Ovarlez, P. Forster, and P. Larzabal, “Covariance structure maximum-likelihood estimates in
compound Gaussian noise: Existence and algorithm analysis,” IEEE Transactions on Signal Processing , vol. 56, no. 1, pp.
34–48, 2008.
[39] M. Mahot, F. Pascal, P. Forster, and J.-P. Ovarlez, “Asymptotic properties of robust complex covariance matrix estimates,”
IEEE Transactions on Signal Processing , vol. 61, no. 13, pp. 3348–3356, 2013.
[40] C. Y. Chong, F. Pascal, J.-P. Ovarlez, and M. Lesturgie, “MIMO radar detection in non-Gaussian and heterogeneous
clutter,” IEEE Journal of Selected Topics in Signal Processing , vol. 4, pp. 115 – 126, March 2010.
[41] N. Petrov, F. Le Chevalier, and A. G. Yarovoy, “Detection of range migrating targets in compound-Gaussian clutter,”
IEEE Transactions on Aerospace and Electronic Systems , vol. 54, no. 1, pp. 37–50, 2018.
[42] F. Mosca, G. Matte, O. Lerda, F. Naud, D. Charlot, M. Rioblanc, and C. Corbi` eres, “Scientific potential of a new 3D
multibeam echosounder in fisheries and ecosystem research,” Fisheries Research , vol. 178, pp. 130–141, 2016.
[43] C. Corbi` eres and F. Mosca, “Real-time acoustic fishing selectivity for sustainable practices,” in OCEANS 2017 - Anchorage ,
2017, pp. 1–8.
DRAFT31
[44] B. Tallon, P. Roux, G. Matte, J. Guillard, J. H. Page, and E. Skipetrov, “Ultra slow acoustic energy transport in dense
fish aggregates,” Scientific Reports , vol. 11, no. 17541, September 2021.
[45] G. Matte, D. Charlot, O. Lerda, T.-K. N’Guyen, V. Giovanini, M. Rioblanc, and F. Mosca, “Seapix: an innovative multibeam
multiswath echosounder for water column and seabed analysis,” in Hydro17 , 2017.
[46] T.-K. Nguyen, D. Charlot, J.-M. Boucher, G. Le Chenadec, and R. Fablet, “Seabed classification using a steerable
multibeam echo sounder,” in OCEANS 2016 MTS/IEEE Monterey , 2016, pp. 1–4.
[47] A. Aubry, J. Carretero-Moya, A. De Maio, A. Pauciullo, J. Gismero-Menoyo, and A. Asensio-Lopez, “Detection of Extended
Target in Compound-Gaussian Clutter,” in Modern Radar Detection Theory , IET A. De Maio and M. S. Greco, Eds.,
number chapter 9, pp. 333–374. Scitech Publishing, 2016.
[48] S. M. Kay, Fundamentals of Statistical Signal Processing: Detection theory , Prentice-Hall PTR, 1998.
[49] S. Kay and Z. Zhu, “The complex parameter Rao test,” IEEE Transactions on Signal Processing , vol. 64, no. 24, pp.
6580–6588, 2016.
[50] C. Y. Chong, F. Pascal, J.-P. Ovarlez, and M. Lesturgie, “Robust MIMO radar detection for correlated subarrays,” in
IEEE International Conference on Acoustic, Speech and Signal Processing (ICASSP) , April 2010, pp. 2786 – 2789.
[51] I. S. Reed, J. D. Mallett, and L. E. Brennan, “Rapid convergence rate in adaptive arrays,” IEEE Transactions on Aerospace
and Electronic Systems , vol. AES-10, no. 6, pp. 853–863, 1974.
[52] K. B. Petersen and M. S. Pedersen, The Matrix Cookbook , Technical University of Denmark, nov 2012.
[53] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory , Prentice-Hall PTR, 1993.
[54] R. Raghavan, S. Kraut, and C. Richmond, Subspace Detection for Adaptive Radar: Detectors and Performance Analysis ,
pp. 43–83, Institution of Engineering and Technology, 2016.
DRAFT