Deep Learning Closure of the Navierâ€“Stokes Equations for
Transition-Continuum Flows
Ashish S. Nairâˆ—
University of Notre Dame, Notre Dame, Indiana 46556, USA
Justin Sirignanoâ€ 
University of Oxford, Oxford OX2 6GG, UK
Marco Panesiâ€¡
University of Illinois at Urbanaâ€“Champaign, Urbana, Illinois 61801, USA
Jonathan F. MacArtÂ§
University of Notre Dame, Notre Dame, Indiana 46556, USA
ThepredictiveaccuracyoftheNavierâ€“Stokesequationsisknowntodegradeatthelimits
of the continuum assumption, thereby necessitating expensive and approximate solutions to
theBoltzmannequation. Whiletractableinonespatialdimension,theirhighdimensionality
increasesthecomputationalchallengeofmulti-dimensional,multi-physicalBoltzmanncalcu-
lations. ItisthereforedesirabletoaugmenttheNavierâ€“Stokesequationsforaccuracyunder
these conditions. We present an application of a deep learning method to extend the validity of
the Navierâ€“Stokes equations to transition-continuum flows. The technique encodes the missing
physicsviaaneuralnetwork,whichistrainedtoreducetheerrorbetweentheNavierâ€“Stokesand
Boltzmann solutions. While standard DL methods can be considered ad hocdue to the absence
of underlying physical laws, at least in the sense that the systems are not governed by known
partialdifferentialequations,theDLframeworkleveragesthe a prioriknownBoltzmannphysics
whileensuringthatthetrainedmodelisconsistentwiththeNavierâ€“Stokesequations. Theonline
trainingproceduresolvesadjointequations,constructedusingalgorithmicdifferentiation,which
efficiently provide the gradient of the loss function with respect to the learnable parameters.
The model is trained and applied to predict stationary, one-dimensional shock thickness in
low-pressure argon.
I. Nomenclature
U = dependent variables
Ë†u = adjoint variables
ğœƒ = model parameters
ğ‘“(Uğ‘¥,ğœƒ)= neural network closure model
II. Introduction
Computationally efficient and accurate models for flows in translational nonequilibrium are essential for designing,
operating, and developing hypersonic flight vehicles and their advanced propulsion systems. The Knudsen number
(Kn=ğœ†/ğ¿,whereğœ†isthemolecularmeanfreepathand ğ¿isacharacteristiclengthscale)indicatestheflowregime,
spanning continuum to free-molecule flow. Increasing Knindicates an increasing departure from local thermodynamic
AspectsofthisworkwerepresentedasPaper2023-1796atthe2023AIAASciTechForum,NationalHarbor,MD,January23â€“27,2023,and
Paper 2022-1703 at the 2022 AIAA SciTech Forum, San Diego, CA, January 3â€“7, 2022.
âˆ—Graduate Student, Department of Aerospace and Mechanical Engineering
â€ Associate Professor, Mathematical Institute
â€¡Professor, Department of Aerospace Engineering; Director, Center for Hypersonic and Entry Systems Studies. Associate Fellow AIAA.
Â§Assistant Professor, Department of Aerospace and Mechanical Engineering; jmacart@nd.edu. Member AIAA.
1arXiv:2303.12114v2  [physics.flu-dyn]  24 Jul 2023equilibrium, which affects the applicability of various flow models [ 1]. For Knâ‰¤10âˆ’3, the continuum Navierâ€“Stokes
equationsareanappropriatefluidmodel. However,existingcomputationallyefficienthydrodynamicmodels,perturbative
innature[ 1],becomeunreliableas Knrisesduetoeitherlowdensitiesorregionsofhighlocalgradients(asinhypersonic
flows), which cause deviations from the linear Newtonian and Fourier laws. The high-Knudsen-number regime can be
further divided into the transition-continuum regime ( 0.01â‰¤Knâ‰¤1) and the free-molecule flow regime ( Knâ‰¥1).
From a theoretical standpoint, the kinetic description of interacting particles via the solution of the Boltzmann
equation allows for the most accurate description of nonequilibrium hypersonic flows. Because of the difficulties
associatedwiththesolutionoftheBoltzmannequation,approximatephysics-basedmethodsâ€”atdifferentspatialand
time scalesâ€”have been developed over the years by the scientific community. This section aims to provide a brief
overviewandacriticalanalysisoftheapproachescurrentlyusedintheliteraturetoalleviatethecomputationalchallenges
of solving the Boltzmann equation.
These methods can be classified into two broad categories: Direct Simulation Monte Carlo (DSMC) and extended-
hydrodynamicsmethods. DSMCinvolvesthesimulationofcollisionsbetweenmanyâ€œcomputationalmoleculesâ€that
statistically describe the physical dynamics and interactions among fluid molecules [ 2,3]. While popular, DSMC
remainschallengingformixedtransition-continuumandcontinuumflows,thoughmodernDSMCcansolvecomplicated,
multiphysical flows given sufficient computing power [ 4,5]. The computational cost of DSMC can be alleviated by
extended-hydrodynamics methods, which use the fluid equations in conjunction with higher-order constitutive models
for the viscous stress and heat flux terms to extend their validity beyond the continuum regime. Many of these methods
usetheChapmanâ€“Enskogexpansion,whichuses Kn-seriesapproximations(ofvaryingorder)totheBoltzmannequation.
Retainingthezero-ordertermsgivestheEulerequations,first-ordertermstheNavierâ€“Stokesequations,andsecond-order
terms the Burnett equations [ 6]. The Navierâ€“Stokes equations are valid in the continuum limit ( Knâ†’0) of small
mean free paths [ 6,7]. However, large perturbations of the velocity distribution from equilibrium render the continuum
assumption invalid. Nonperturbative moment methods [ 8] mitigate the problem of the breakdown away from moderate
nonequilibrium by predicting values for momentum and energy fluxes that are consistent with the nonnegativity of
theparticledensity. Thesemethods,however,arestorage-intensiveandcomputationallyimpracticalduetothelarge
number of independent variables required to evaluate integral terms. Several variants of the Burnett equations have
been proposed including the BGKâ€“Burnett (Bhatnagarâ€“Grossâ€“Krook) equations [ 9], Woods equations [ 10], Gradâ€™s
13-momentequations[ 11,12],regularizedBurnett[ 13],andregularizedGradâ€™s13-momentequations[ 14]. Amajor
drawback of most is their mathematical ill-posedness in their original formulations, which leads to physical and
numerical instabilities. Thermodynamic consistency is also not an intrinsic property of these equations; this limits
their general applicability, despite their computational cost being comparable to the Navierâ€“Stokes equations. The
advantagesofDSMCâ€™sdetailedkineticinformationandthecontinuum-likemethodsâ€™computationaltractabilitycan
be obtained by hybrid schemes [ 15â€“24], which solve the Navierâ€“Stokes equations in continuum regions of the flow
andemploytheDSMCtechniqueelsewhere. Althoughthesemethodsareattractiveformultiscaleflows,identifying
thecontinuumandDSMC(molecular)regionsisoftendonefromthecontinuumperspective,numericallyinterfacing
theseregions ischallenging, andthespeedup obtainedisoften insufficientto renderitan attractivealternative topure
DSMC.Deterministic numericalmethods thatdirectly solvethe Boltzmannequation [ 25]havebeen testedfor simple
flow configurations, though their extension to practical problems is yet to be explored.
This paper describes the construction of a physics-based reduced-order model, able to capture the fundamental
physical processes that occur in hypersonic flows, yet computationally efficient, by leveraging fundamental physics,
computational science, and applied mathematics. The proposed model compensates for the deficiencies of the
Navierâ€“Stokes model in the transition-continuum regime by introducing additional terms into the continuum equations.
By estimating the parameters of these terms (we use neural networks) while converging the Navierâ€“Stokes solutions to
Boltzmann solutions, the model attempts to encode the unrepresented physics that are missing from the continuum
descriptionofthegas. Wealsoproposealgebraicconstraintstothemodeloutputstoensureconsistencywiththesecond
law of thermodynamics.
Applications of deep learning (DL) for closure modeling are widespread in incompressible fluid mechanics [ 26â€“30]
but are much less common for compressible flows and hypersonics. Most previously employed machine learning
methods for flows attempt to estimate unclosed terms (e.g., the Reynolds stress or the subgrid stress) by minimizing the
directmismatchbetweenthesetermsandâ€œtrustedâ€data, whichareoftenobtainedfromhighlyresolveddirectnumerical
simulations (DNS) [ 31â€“33]. This approach, which we call a prioritraining, decouples the parameter estimation
(optimization)stepfromthesolutionofthegoverningpartialdifferentialequations(PDEs),whichismathematically
inconsistent due to the noncommutativity of nonlinear operations [ 34]. In our view, this approach has two primary
deficiencies for compressible flows. First, the nonlinear coupling of dependent variables inherent to compressible flows
2intensifies the inconsistency of a prioritraining. Second, and more importantly, when the discrepancy is due to a
fundamental deficiency in the PDE modelâ€”for example, for transition-continuum flows, approximations to the viscous
stress and heat flux from kinetic theoryâ€”the functional form of the discrepancy is often unknown; thus, even defining
the loss function for the direct mismatch is challenging.
Ourdeeplearningapproachisconceptuallysimpleyetavoidsthesechallenges. Ratherthandecoupletheoptimization
step from the PDE solution, we use an embedded optimization method that substitutes the untrained model into the
PDEandestimatesitsparameters insitu[28,34,35]. Themodelthusrespectsitseffectsonthenonlinearlycoupled
PDEsolution. Additionally,thisapproachcandirectlycomputethelossfunctionfromthedependentvariables(mass,
momentum,andenergy)orderivedquantities(e.g.,temperature)ratherthanfromhigher-orderunclosedtermsappearing
in the PDEs. This allows us to obtain target data from Boltzmann solutions and, in theory, enables straightforward
incorporation of experimental data. We present an embedded optimization approach that optimizes over the PDE
solutionbysolvingtheadjointNavierâ€“Stokesequations,whichareobtainedusingalgorithmicdifferentiation(AD)ofthe
forwardequationsandaresolvedefficientlyusinggraphicsprocessingunit (GPU)acceleration. Similarmethodshave
beensuccessfullyappliedtoturbulencemodelingforincompressiblelarge-eddysimulation(LES)[ 34,36,37],Reynolds-
averaged Navierâ€“Stokes (RANS) simulation [ 35,38] and sensitivity analysis of chaotic dynamical systems [ 39,40].
Given the code-intrusive nature of adjoint-based optimization, many efforts to avoid this difficulty have used less-
complete couplings of the optimization step and the PDE solution [ 41â€“43], though these methods typically require
trusted data for the exact term being modeled, which is not always possible.
This work presents an example application to the prediction of the shock structure in rarefied argon flows, compares
the augmentedNavierâ€“Stokes predictions tothe unmodified predictions, assesses theMach number interpolationand
extrapolation capability of the DL model, and provides a physical interpretation of the modifications to the continuum
transport terms. The governing equations and transport models from kinetic theory are briefly reviewed in Section III.
The embedded deep learning framework and constraints to enforce the second law of thermodynamics are introduced in
Section IV. An application to transition-continuum argon shock predictions is presented in Section V. A summary and
discussion of future work are provided in Section VI.
III. Continuum Equations and Closure Models
Letğ‘”(ğ‘¡,x,v)be the solution to the Boltzmann equation (the distribution function) for ğ‘¡âˆˆ[0,âˆ)andx,vâˆˆR3,
and define the mass density ğœŒ(ğ‘¡,x)=âŸ¨ğ‘š,ğ‘”(ğ‘¡,x,Â·)âŸ©and fluid-dynamic momentum ğœŒu(ğ‘¡,x)=âŸ¨ğ‘šğ‘”(ğ‘¡,x,Â·),vâŸ©, where
ğ‘šis the mass of a particle, and integrals of the distribution function over the velocity space are obtained from
âŸ¨â„(Â·),ğ‘”(ğ‘¡,x,Â·)âŸ©=âˆ«
R3â„(v)ğ‘”(ğ‘¡,x,v)ğ‘‘v. In this manner, all continuum quantities of interest U={ğœŒ,u,ğ‘,ğ‘‡,...}may
be obtained, where ğ‘is the pressure, and ğ‘‡is the temperature, among other possibilities.
ThecompressibleNavierâ€“Stokesequationsforasingle-componentgas,asderivedfromtheBoltzmannequation,are
ğœ•ğœŒ
ğœ•ğ‘¡+âˆ‡Â·(ğœŒu)=0
ğœ•ğœŒu
ğœ•ğ‘¡+âˆ‡Â·h
ğœŒuâŠ—uâˆ’ğœ(u,v,ğ‘”)i
=0 (1)
ğœ•ğœŒğ¸
ğœ•ğ‘¡+âˆ‡Â·h
ğœŒğ¸uâˆ’ğœ(u,v,ğ‘”):u+q(u,v,ğ‘”)i
=0,
whereğ¸=ğ‘’+uâŠ¤u/2is the total energy and ğ‘’is the internal energy. The thermal momentum flux
ğœ(u,v,ğ‘”)=D
ğ‘švâŠ—vâˆ’ğœŒuâŠ—u,ğ‘”(ğ‘¡,x,Â·)E
(2)
and the heat flux q(u,v,ğ‘”)require integration over the Boltzmann phase space; thus, they are unclosed under the
continuumvariables. Closureof (2)iscommonlyachievedbyassumingproportionalitytothestrain-ratetensorand
defining the pressure, yielding ğœ=ğœâˆ’ğ‘I, whereğœ=ğœ‡(âˆ‡u+âˆ‡uâŠ¤)âˆ’2
3ğœ‡(âˆ‡Â·u)I,ğœ‡is the viscosity, and the pressure
satisfies the ideal-gas equation of state ğ‘=(ğ›¾âˆ’1)(ğœŒğ¸âˆ’ğœŒuâŠ¤u/2), whereğ›¾is the (constant) ratio of specific heats.
Similarly, the heat flux is typically closed using q=âˆ’ğœ†âˆ‡ğ‘‡, whereğœ†is the thermal conductivity, ğ‘‡=ğ‘/(ğœŒğ‘…), andğ‘…is
thespecificgasconstant. However,theseclosuresâ€”andtheuseoftheNavierâ€“Stokesequationsmoregenerallyâ€”require
the continuum approximation to hold, which can inaccurately represent the physics of nonequilibrium flows in the
transition-continuum regime.
3A. Neural-Network Closures
We introduce three approaches for the closure of (1)using neural networks. First, the transport coefficients ğœ‡and
ğœ†may becorrected using neural networks (Approach A),
ğœ‡(U;ğœƒ)=ğœ‡0(1+ğ‘“1(Uğ‘¥;ğœƒ)),
ğœ†(U;ğœƒ)=ğœ†0(1+ğ‘“2(Uğ‘¥;ğœƒ)),(3)
whereğ‘“1(Uğ‘¥;ğœƒ)andğ‘“2(Uğ‘¥;ğœƒ)are the outputs of a neural network ğ‘“(Uğ‘¥;ğœƒ), which takes the point-wise derivatives of
Uas its input and has parameters ğœƒ. The resulting viscous stress and heat flux are
ğœ(U;ğœƒ)=ğœ‡(U;ğœƒ) âˆ‡u+(âˆ‡u)âŠ¤âˆ’2
3(âˆ‡Â·u)I
and
q(U;ğœƒ)=âˆ’ğœ†(U;ğœƒ)âˆ‡ğ‘‡.(4)
Second, the continuum viscous-stress and heat-flux models may be augmented by linearly superimposing neural
networks (Approach B). This results in augmented viscous-stress and heat-flux terms,
ğœ(U;ğœƒ)=ğœ‡ âˆ‡u+(âˆ‡u)âŠ¤âˆ’2
3(âˆ‡Â·u)I
âˆ’ğ‘“1(Uğ‘¥;ğœƒ)
q(U;ğœƒ)=âˆ’ğœ†âˆ‡ğ‘‡âˆ’ğ‘“2(Uğ‘¥;ğœƒ),(5)
whereğ‘“1(Uğ‘¥;ğœƒ)andğ‘“2(Uğ‘¥;ğœƒ)are again neural-network outputs, though they need not be the same networks as in (3).
Finally, the continuum models ğœ(U)andq(U)may bedirectly modeled using neural networks (Approach C),
ğœ(U;ğœƒ)=ğ‘“1(Uğ‘¥;ğœƒ)and q(U;ğœƒ)=ğ‘“2(Uğ‘¥;ğœƒ). (6)
WepursueonlyApproachesAandBhere. ThesehavemorelimitedpotentialthanApproachC,beingconstrainedby
thealgebraicmodelsfor ğœandq,butaremorestraightforwardtoimplementandanalyze. Ratherthandirectlymodel
the transport terms, our goal is to select ğœƒsuch that the new models account only for deviations of the classical relations
from kinetic theory. The neural network ğ‘“(Uğ‘¥;ğœƒ)structure and optimization are discussed further in Section IV.
An important uncertainty in the physical modeling of the shock structure, especially at high Mach numbers, is
the temperature dependence of the transport coefficients ğœ‡andğœ†. We use a power-law dependence of the baseline
continuum transport coefficients on temperature,
ğœ‡(ğ‘‡)=ğœ‡0ğ‘‡
ğ‘‡0ğ‘ 
andğœ†(ğ‘‡)=ğœ†0ğ‘‡
ğ‘‡0ğ‘ 
, (7)
whereğ‘‡0=273.15 K, is typically used for argon. Several previous efforts have aimed to adjust the value of ğ‘ to
reproduceexperimentalshockprofiles[ 3,44â€“46]. Followingthese,weuse ğ‘ =0.74tomatchtheviscositylawexponent
used in our DSMC simulations.
B. Application to 1D Shocks
We consider an application to a 1D stationary shock in argon at ğ‘âˆ=6.667Pa andğ‘‡âˆ=300K. This is a
common shock-structure problem for extended hydrodynamics models [ 45â€“51] that has been extensively studied
experimentally[ 44,52â€“55]. Theflowhasatransition-continuumKnudsennumber Kn=0.2âˆ¼0.3withintheshock,
which Navierâ€“Stokes equations do not accurately model. A monatomic gas such as argon is generally chosen to study
theshockstructureduetothelackofvibrationalorrotationalnonequilibrium. Weassumeaconstantratioofspecific
heatsğ›¾=5/3with gas constant ğ‘…=208.12 kJ/kgÂ·K. The 1D stationary solution of (1) satisfies
ğœ•U
ğœ•ğ‘¡=âˆ’ğœ•Fğ‘
ğœ•ğ‘¥+ğœ•Fğ‘‘
ğœ•ğ‘¥=0, (8)
where
U=ï£®ï£¯ï£¯ï£¯ï£¯ï£¯ï£°ğœŒ
ğœŒğ‘¢
ğœŒğ¸ï£¹ï£ºï£ºï£ºï£ºï£ºï£», Fğ‘=ï£®ï£¯ï£¯ï£¯ï£¯ï£¯ï£°ğœŒğ‘¢
ğœŒğ‘¢2+ğ‘
ğœŒğ‘¢ğ»ï£¹ï£ºï£ºï£ºï£ºï£ºï£», Fğ‘‘=ï£®ï£¯ï£¯ï£¯ï£¯ï£¯ï£°0
ğœ(U;ğœƒ)
ğœ(U;ğœƒ)ğ‘¢âˆ’ğ‘(U;ğœƒ)ï£¹ï£ºï£ºï£ºï£ºï£ºï£»,
4whereğ»=ğ‘’+ğ‘/ğœŒ+1/2ğ‘¢2is the total enthalpy, and ğœ(U;ğœƒ)andğ‘(U;ğœƒ)are the 1D versions of the viscous-stress
tensor and heat-flux vector with embedded neural networks. Usatisfies Dirichlet (supersonic freestream) boundary
conditions at ğ‘¥=âˆ’âˆand subsonic nonreflective characteristic boundary conditions at ğ‘¥=+âˆ[56].
The 1D equations are solved on a domain ğ¿ğ‘¥âˆˆ[âˆ’20 mm,10 mm]with the shock positioned at ğ‘¥=0. Inviscid
shocksolutionsprovidetheinitialconditionsandDirichletboundaryconditions. Theequationsarediscretizedover
ğ‘›ğ‘¥=256uniformlyspacedmeshcellswiththeEulerfluxesdiscretizedusingacharacteristic-basedscheme[ 57];all
otherterms arediscretizedusing second-ordercentereddifferences. Theequationsare converged totheirsteady-state
solution using a damped Newton method; details are provided in Section III.C
Target data are obtained from DSMC solutions of the Boltzmann equation at freestream Mach numbers ğ‘€âˆ=
2,3,5,6,8,9, and 10. The DSMC simulations used a VHS collision model and were initialized using the same pre- and
post-shock conditions as the Navierâ€“Stokes simulations. The viscosity law exponent ğ‘ =0.74was found to best match
experimental data [ 44]. For further details about the DSMC simulations, readers are directed to [ 58,59]. We denote the
target data as ğœŒ,ğ‘¢andğ‘‡.
C. Damped Newton Method
Fully converging the forward solution is necessary to ensure well-posedness of the embedded optimization problem.
ThisisachievedusingadampedNewtonmethod,whichisabletoconvergethesolutiontonearmachineprecision(using
64-bit floating-point precision). By comparison, pseudo-time-stepping methods require taking prohibitively many steps
to achieve comparable convergence. For the present shock cases with moderately high Mach numbers (e.g., ğ‘€=5)
converging the relative loss to ğ‘‚(10âˆ’2)requires approximately 1200 pseudo-time iterations but only approximately 20
damped Newton iterations. Even with the higher cost of the Newton solver, the lower number of iterations reduces the
training time by approximately a factor of ten.
Considerthesteadysolutionof (8),ğœ•(Fğ‘‘âˆ’Fğ‘)/ğœ•ğ‘¥=ğœ•Fğ‘¥/ğœ•ğ‘¥=0. Theğ‘›thNewtoniterationsolves Î”Ufromthe
linearized system
ğ‘‘Fğ‘¥
ğ‘‘Uğ‘›
Î”U=âˆ’Fğ‘¥(Uğ‘›) (9)
and advances the solution as Uğ‘›+1=Uğ‘›+Î”UuntilÎ”Ufalls below a specified tolerance. Given the low dimensionality
of the 1D problem, we solve (9)using Gaussâ€“Jordan elimination, though 2D and 3D problems would require more
sophisticated sparse or iterative solution methods. Since the embedded optimization procedure currently uses the
Jacobianğœ•Fğ‘¥/ğœ•U, the Jacobian can be reused for the Newton solver, though both could be posed in a Jacobian-free
manner.
A practical difficulty with Newton iteration is the lack of physical constraints on Î”U. Large values of Î”Uobtained
bysolving (9)canresultinnonphysicalvaluesof U(e.g.,negativedensityorpressure). Weavoidtheseproblemsby
bracketingÎ”Usuch that it does not exceed a specified fraction of the local solution. The bracketing operation is
Î”Uğ‘=min
ğ‘“ğ‘âˆ¥Uâˆâˆ¥2Ã—Î”U
âˆ¥Î”Uâˆ¥2,Î”U
, (10)
whereğ‘“ğ‘=0.1is the bracketing factor, âˆ¥Uâˆâˆ¥2is theğ¿2norm of the freestream U, andÎ”U/âˆ¥Î”Uâˆ¥2is the unit vector in
the direction of Î”U. To further ensure physical solutions, Î”Uğ‘is recursively damped, Î”Uğ‘‘=ğ‘“ğ‘‘Î”Uğ‘, whereğ‘“ğ‘‘=0.2
is a damping factor, until Uğ‘›+1is physically consistent (e.g., the density and pressure are positive). The solution is then
advanced as
Uğ‘›+1=Uğ‘›+Î”Uğ‘›
ğ‘‘. (11)
Using the Newton method along with bracketing and damping stabilizes the solution before taking an optimization step
to update the neural network parameters.
IV. Machine Learning Closure
This section is organized as follows: IV.A outlines the architecture of the embedded neural network and its inputs,
IV.B details the standard a priorioptimization approach and the adjoint-based optimization approach used in this paper,
and IV.C presents a brief derivation of the entropy constraints introduced to enforce the second law of thermodynamics.
5A. Model Architecture
The inputs to the embedded neural network are the first-order spatial derivatives of the computed scalar flow
quantities and velocity at a mesh point ğ‘¥ğ‘–:Ë†ğ‘§ğ‘–={ğœŒğ‘¥(ğ‘¥ğ‘–),ğ‘ğ‘¥(ğ‘¥ğ‘–),ğ‘‡ğ‘¥(ğ‘¥ğ‘–),ğ‘¢ğ‘¥(ğ‘¥ğ‘–)}. These inputs are invariant to Galilean
transformations(constantrelativemotion),beingspatialderivativesofscalarandvectorquantities,whichalsoguarantees
that the network output quantities are invariant to Galilean transformations [ 31,60]. We do not consider rotational
invariance, which isa separate issue that hasbeen assessed elsewhere [ 31]. The model inputs areexpanded to include
data at the two neighboring mesh points: ğ‘§ğ‘–={Ë†ğ‘§ğ‘–âˆ’1,Ë†ğ‘§ğ‘–,Ë†ğ‘§ğ‘–+1}. This expanded set of inputs serves to enable the model to
compute higherderivatives, though itintroduces adegree of meshdependence, which couldreduce generalizabilityto
out-of-samplemeshes. Addressingtheissuesof rotationalinvariance andmeshdependenceis thesubjectofongoing
applications to two- and three-dimensional flows.
The neural network has a four-layer structure with one gate layer. For inputs ğ‘§âˆˆR18Ã—ğ‘›ğ‘¥, the model architecture is
ğ»1=ğœ1(ğ‘Š1ğ‘§+ğ‘1)
ğ»2=ğœ1(ğ‘Š2ğ»1+ğ‘2)
ğ»3=ğºâŠ™ğ»2withğº=ğœ2(ğ‘Š3ğ‘§+ğ‘3)
Ë†ğ‘“(ğ‘§;ğœƒ)=ğ‘Š4ğ»3+ğ‘4
with output dimensions Ë†ğ‘“(ğ‘§;ğœƒ)âˆˆR2Ã—ğ‘›ğ‘¥. In these,
ğœ1(ğ‘¥)=(
ğ›¼(exp(ğ‘¥)âˆ’1), ğ‘¥â‰¤0
ğ‘¥, ğ‘¥ > 0
is the exponential linear unit (ELU) activation function with hyperparameter ğ›¼=1,ğœ2(ğ‘¥)=1/(1+ğ‘’âˆ’ğ‘¥)is the sigmoid
activationfunction, âŠ™signifieselement-wisemultiplication,andtheparametersare ğœƒ={ğ‘Š1,ğ‘Š2,ğ‘Š3,ğ‘Š4,ğ‘1,ğ‘2,ğ‘3,ğ‘4}.
We useğ‘ğ»=1200hidden units per layer, which balances training accuracy and computational efficiency.
For Approach B (augmented continuum viscous-stress and heat-flux models; (5)), the output layer is chosen to
enforcetheentropyconditionsintroducedinSectionIV.C.ForApproachA(correctedtransportcoefficients; (3)),the
raw neural network outputs Ë†ğ‘“(ğ‘§;ğœƒ)are passed through a final ELU layer,
ğ‘“(ğ‘§;ğœƒ)=ğœ1(Ë†ğ‘“(ğ‘§;ğœƒ))+0.1,
which is a simpler constraint to ensure positivity of ğœ‡0(1+ğ‘“1(ğ‘§;ğœƒ))andğœ†0(1+ğ‘“2(ğ‘§;ğœƒ))for allğ‘§andğœƒ.
B. Online Optimization Approach
Optimization of standard a prioriDL closures is constrained to use objective (loss) functions that are explicit
functions of the neural network. For example, if one wished to model the viscosity ğœ‡with a neural network ğ‘“(ğ‘§;ğœƒ),
then it would be sufficient to minimize the objective function
ğ½(ğœƒ)=1
2âˆ«âˆ
âˆ’âˆ
ğ‘“(ğ‘§(ğ‘¥);ğœƒ)âˆ’ğœ‡ğ‘’2
ğ‘‘ğ‘¥, (12)
whereğœ‡ğ‘’istrusteddata(usuallyobtainedfromDNS),and ğ‘§(ğ‘¥)aretheinputvariables. Toselect ğœƒusinggradient-descent
optimization, one needs to compute the gradient
âˆ‡ğœƒğ½=âˆ«âˆ
âˆ’âˆ
ğ‘“(ğ‘§;ğœƒ)âˆ’ğœ‡ğ‘’
âˆ‡ğœƒğ‘“(ğ‘§(ğ‘¥);ğœƒ)ğ‘‘ğ‘¥,
whereâˆ‡ğœƒğ‘“(ğ‘§(ğ‘¥);ğœƒ)may be evaluated using AD over the neural network, which is standard functionality in DL
softwarelibraries. However,optimizationusing (12)isproblematicwhendatafortheexactclosureterm( ğœ‡ğ‘’)arenot
availableâ€”forexample,whenusingexperimentalorhigher-ordersimulationdata(e.g.,DSMC)â€”orwhenthetarget
quantityisnotknownoraccuratelyestimablefromtheavailabledata. Furthermore,thisoptimizationtakesplaceoffline,
without solving the governing PDEs, so at best is only indirectly PDE-constrained by the target data.
TheembeddedDLapproachaddressestheseshortcomingsbyintroducinganonlineoptimizationalgorithm[ 38,61],
which enables arbitrarily defined objective functions. For the application to nonequilibrium flows, we construct an
6Known Physics +
Unclosed PhysicsU/n.sc/r.sc/e.sc/p.sc/r.sc/e.sc/s.sc/e.sc/n.sc/t.sc/e.sc/d.sc /o.sc/r.sc
U/n.sc/k.sc/n.sc/o.sc/w.sc/n.sc P/h.sc/y.sc/s.sc/i.sc/c.sc/s.sc
PDE forU
+
NN Closure f(U;Î¸)PDE M/o.sc/d.sc/e.sc/l.sc
NN
Backprop.Î¸
NN
Backprop.Î¸TargetÂµe DNS
Âµ(Î¸)Closure
Prediction
Mismatchâˆ‡Î¸J(Î¸)
A /p.sc/r.sc/i.sc/o.sc/r.sc/i.sc O/p.sc/t.sc/i.sc/m.sc/i.sc/z.sc/a.sc/t.sc/i.sc/o.sc/n.sc
(O/f.sc/f.sc/l.sc/i.sc/n.sc/e.sc)Target uDNSExperiments,
DSMC, etc.
Adjoint
PDEMismatchuTraining
Prediction
âˆ‡Î¸J(u(Î¸))Auto
grad
E/m.sc/b.sc/e.sc/d.sc/d.sc/e.sc/d.sc O/p.sc/t.sc/i.sc/m.sc/i.sc/z.sc/a.sc/t.sc/i.sc/o.sc/n.sc
Prediction U
Out-of-sampleFig.1 TwomethodstooptimizeaNNclosure ğ‘“(u;ğœƒ)inaPDEmodeltorepresentunclosedphysics. A priori
optimizationselectsthemodelparameters ğœƒoffline(withoutsolvingthePDEmodel). Embeddedoptimization
instead minimizes the error with respect to the PDE solution U(or derived quantities u) by solving adjoint PDEs,
which enables efficient computation of the gradient âˆ‡ğœƒğ½(u(ğœƒ)).
objective function using the mismatch between the computed primitive variables uğ‘=[ğœŒ,ğ‘¢,ğ‘‡]âŠ¤and target data
obtained from DSMC solutions of the distribution function. Using an objective function constructed of primitive
variables uğ‘ratherthatconservedvariables Uresultedinbetterconvergenceandlowerlosses. Ingeneral,thetargetdata
maybeknownfromDNS,experiments,and/orhigher-ordersimulations. Thelossfunctionintermsoftheprimitive
variables is
ğ½(uğ‘(ğœƒ))=1
2âˆ«âˆ
âˆ’âˆ1
ğœŒ2âˆ(ğœŒ(ğ‘¡,ğ‘¥;ğœƒ)âˆ’ğœŒ)2+1
ğ‘¢2âˆ(ğ‘¢(ğ‘¡,ğ‘¥;ğœƒ)âˆ’ğ‘¢)2+1
ğ‘‡2âˆ
ğ‘‡(ğ‘¡,ğ‘¥;ğœƒ)âˆ’ğ‘‡2
ğ‘‘ğ‘¥, (13)
whereğœŒâˆ,ğ‘¢âˆ, andğ‘‡âˆare the reference freestream values used for normalization, and where we emphasize the
dependence of the flow quantities on ğœƒ. The objective function depends on ğœƒimplicitly through uğ‘.
Figure 1 illustrates the conceptual differences between a prioriand embedded optimization. Notably, a priori
optimization requires high-fidelity (e.g., DNS) target data for the closure term, which may not be available or accurately
known. (This would be the case, for example, for DNS solutions of the Navierâ€“Stokes equations in the transition-
continuum regime.) A priorioptimization cannot target the flow variables (or derived quantities), thus it cannot
straightforwardly incorporate experimental and/or higher-order simulation data. In the same vein, the embedded
optimization approach does not necessarily need DNS data.
We now consider the optimization of the discretized versions of (8) and (13); all variables in the remainder of
thissectionwillthereforebefinite-dimensional. Thisoptimizationproblemischallenging,foritrequirescomputing
thegradientsofdependentvariablesandderivedquantitieswithrespecttotheneuralnetworkparameters ğœƒ. AnaÃ¯ve
approach would attempt to evaluate
âˆ‡ğœƒğ½=ğœ•ğœŒ
ğœ•ğœƒâŠ¤ğœ•ğ½
ğœ•ğœŒ+ğœ•ğ‘¢
ğœ•ğœƒâŠ¤ğœ•ğ½
ğœ•ğ‘¢+ğœ•ğ‘‡
ğœ•ğœƒâŠ¤ğœ•ğ½
ğœ•ğ‘‡=ğœ•uğ‘
ğœ•ğœƒâŠ¤ğœ•ğ½
ğœ•uğ‘(14)
on the discrete computational mesh. The partial derivatives ğœ•uğ‘/ğœ•ğœƒâˆˆR3ğ‘›ğ‘¥Ã—ğ‘›ğœƒcould be evaluated by deriving and
solving PDEs for each ğœ•u/ğœ•ğœƒğ‘–, whereğ‘–=1,...,ğ‘›ğœƒ, or by introducing finite-difference perturbations ğœƒğ‘–+ğœƒâ€²
ğ‘–. However,
the number of neural network parameters ğ‘›ğœƒis often large (e.g.,âˆ¼105parameters), such that both of these approaches
would require an intractable number of calculations.
Instead,forğ‘›forwardequations, ğ‘›adjointequationsmaybesolvedtoprovidethenecessarygradients. Thusthe
overallcostwillnotbesignificantlyhigherforoptimizationthanforprediction. Toderivetheadjointequationsfora
7steady problem, note that
âˆ‡ğœƒFğ‘¥=ğœ•Fğ‘¥
ğœ•uğ‘ğœ•uğ‘
ğœ•ğœƒ+ğœ•Fğ‘¥
ğœ•ğœƒ=0, (15)
where Fğ‘¥is the discrete representation of the right-hand side (RHS)ğœ•
ğœ•ğ‘¥(Fğ‘‘âˆ’Fğ‘).
Let us now introduce the adjoint variables Ë†u=[Ë†ğœŒ,Ë†ğ‘¢,Ë†ğ‘‡]âŠ¤, which satisfy the adjoint equation
ğœ•ğ½
ğœ•uğ‘+ğœ•Fğ‘¥
ğœ•uğ‘âŠ¤
Ë†u=0, (16)
with Dirichlet boundary conditions (Ë†ğœŒ,Ë†ğ‘¢,Ë†ğ‘‡)=0atğ‘¥=Â±âˆ. Multiplying (15) by Ë†uâŠ¤produces
0=Ë†uâŠ¤ğœ•Fğ‘¥
ğœ•uğ‘ğœ•uğ‘
ğœ•ğœƒ+Ë†uâŠ¤ğœ•Fğ‘¥
ğœ•ğœƒ. (17)
From (16), we have that Ë†uâŠ¤ğœ•Fğ‘¥
ğœ•uğ‘=âˆ’ğœ•ğ½
ğœ•uğ‘âŠ¤which, when substituted into (17), yields
ğœ•ğ½
ğœ•uğ‘âŠ¤ğœ•uğ‘
ğœ•ğœƒ=Ë†uâŠ¤ğœ•Fğ‘¥
ğœ•ğœƒ. (18)
The relationship (18) combined with (14) provides a formula for the gradient in terms of the adjoint solution:
âˆ‡ğœƒğ½=ğœ•Fğ‘¥
ğœ•ğœƒâŠ¤
Ë†u. (19)
Therefore, we can solve the adjoint equation (16) for Ë†uand use its solution to evaluate the gradient of the loss function
with respect to the model parameters ( âˆ‡ğœƒğ½) using(19). The dimension of (16)is equal to the dimension of the forward
equations (8), so the overall optimization is not significantly greater than the cost of solving the forward equations. It is
important to note that the validity of (19)is contingent on the right-hand side of (15)being zero. In turn, this requires
that the discrete residual of the forward equations is close to zero before taking an optimization step.
Thediscreteadjointequationsaresolvedasalinearsystem. ThisrequiresthecomputationoftheJacobian ğœ•Fğ‘¥/ğœ•uğ‘,
which is calculated using algorithmic differentiation as provided by the PyTorchlibrary [62]. After converging the
forward and adjoint equations, gradient-descent steps are taken for parameters ğœƒ(ğ‘˜)according to
ğœƒ(ğ‘˜+1)=ğœƒ(ğ‘˜)âˆ’ğ›¼(ğ‘˜)âˆ‡ğœƒğ½(ğœƒ(ğ‘˜)), (20)
whereğ›¼(ğ‘˜)isthelearningrateattheiteration ğ‘˜âˆˆ{0,1,...,ğ‘ iter},whereğ‘iteristhemaximumnumberofoptimization
iterations. The learning-rate schedule and other model-training hyperparameters are described in Section IV.D.
C. Entropy Constraints
UsingDLclosuresunconstrainedforthesecondlawofthermodynamicscanresultinunphysicalflowquantities.
WeconstraintheoutputsoftheneuralnetworkstosatisfythesecondlawofthermodynamicsusingtheClausiusâ€“Duhem
inequality [63],
Â¤I=âˆ’1
ğ‘‡2q(U;ğœƒ)âˆ‡ğ‘‡+1
ğ‘‡ğœ(U;ğœƒ):âˆ‡uğ‘‡â‰¥0, (21)
whereÂ¤Iistherateofirreversibleentropyproduction. Aâ€œstrongâ€formoftheentropyconstraintwouldimposeconditions
onthemodeloutputssuchthat(21)isnonnegative. ForApproachA(transport-coefficientcorrections),ensuringthe
positivity of ğœ‡(U;ğœƒ)andğœ†(U;ğœƒ)is sufficient; this is done using an ELU output layer as described in Section IV. A
â€œweakâ€constraintfortheentropyinequalitywouldincorporate Â¤Iasapenaltyterminthetraininglossfunction (13). The
application of strong and weak constraints for Approach B (transport-term augmentation) is now discussed separately.
1. Strong Entropy Constraint
The Clausiusâ€“Duhem inequality (21) can be rearranged to give
1
ğ‘‡ğœ(U;ğœƒ):âˆ‡uğ‘‡â‰¥âˆ’1
ğ‘‡2q(U;ğœƒ)âˆ‡ğ‘‡, (22)
8from which a constraint on the viscous stress may be obtained:
ğœ(U;ğœƒ)â‰¥1
ğ‘‡q(U;ğœƒ)âˆ‡ğ‘‡
âˆ‡uğ‘‡. (23)
A constrained viscous-stress model is therefore
Ëœğœ(U;ğœƒ)=max(ğœ(U;ğœƒ),N), (24)
where
N=1
ğ‘‡q(U;ğœƒ)âˆ‡ğ‘‡
âˆ‡uğ‘‡, (25)
andthemax()functionin (24)isappliedinapointwisemanner. Afterapplying (24),theconstrainedclosureterms q(ğœƒ)
andËœğœ(ğœƒ)are substituted into the governing equations. This enforcement of the strong entropy condition makes no
assumptions about the signs of âˆ‡ğ‘‡andâˆ‡ğ‘¢.
For 1D flows, the Approach B closures (5) can be simplified to
ğœ(U;ğœƒ)=4
3ğœ‡ğœ•ğ‘¢
ğœ•ğ‘¥âˆ’ğ‘“1(Uğ‘¥;ğœƒ)
q(U;ğœƒ)=âˆ’ğœ†ğœ•ğ‘‡
ğœ•ğ‘¥âˆ’ğ‘“2(Uğ‘¥;ğœƒ),(26)
and the Clausius-Duhem inequality (21) reduces to
Â¤I=âˆ’1
ğ‘‡2q(U;ğœƒ)ğœ•ğ‘‡
ğœ•ğ‘¥+1
ğ‘‡ğœ(U;ğœƒ)ğœ•ğ‘¢
ğœ•ğ‘¥â‰¥0. (27)
The term N(25) reduces to
N=1
ğ‘‡q(U;ğœƒ)ğœ•ğ‘‡
ğœ•ğ‘¥
ğœ•ğ‘¢
ğœ•ğ‘¥, (28)
and the strong entropy constraint can be enforced according to (24).
2. Weak Entropy Constraint
A weak entropy constraint would penalize the violation of the entropy inequality (21)during the constrained
optimization process by adding an extra term to the training loss function (13),
ğ½ğ‘ (ğœƒ)=ğ‘Šğ‘ âˆ«âˆ
âˆ’âˆ[min(0, ğ‘“1(Uğ‘¥;ğœƒ))+min(0, ğ‘“2(Uğ‘¥;ğœƒ))]ğ‘‘x, (29)
whereğ‘Šğ‘ is a scalar weight. The net training loss for the weak entropy constraint is thus
ğ½ğ‘¤(uğ‘;ğœƒ)=ğ½(uğ‘(ğœƒ))+ğ½ğ‘ (uğ‘(ğœƒ)). (30)
Therequirementtosimultaneouslyminimizebothcomponentsof ğ½ğ‘¤preventedweak-constraintcasesfrommatching
the testing and training accuracy of equivalent strong-constraint cases. This could be improved by dynamic selection of
ğ‘Šğ‘ , for example, to enforce the ğ½ğ‘ term more strongly in regions of high entropy production.
D. Model Training
Adistributedtrainingapproachwasimplementedtoperformtheonlineadjointoptimization. ForeachofApproaches
A and B, models were trained for four different training regimens: three models targeted only a single freestream
Mach number ( ğ‘€train=2,ğ‘€train=5, andğ‘€train=8), and one model targeted three Mach numbers simultaneously:
ğ‘€train=(2,5,8). Training this combined model utilized message-passing interface (MPI) parallelization to average the
loss-function gradients âˆ‡ğœƒğ½between the component simulations before optimizing.
Table 1 provides the training/testing regimenmatrix. Freestream Mach numbers ğ‘€âˆ=2,5,8were out-of-sample
whennotincludedinamodelâ€™strainingregimen. FreestreamMachnumbers ğ‘€âˆ=3,6,9,10wereout-of-samplefor
9Training ğ‘€âˆ=2ğ‘€âˆ=3ğ‘€âˆ=5ğ‘€âˆ=6ğ‘€âˆ=8ğ‘€âˆ=9ğ‘€âˆ=10
ğ‘€train=2â€¢
ğ‘€train=5 â€¢
ğ‘€train=8 â€¢
ğ‘€train=(2,5,8) â€¢ â€¢ â€¢
Testingâ—¦ â€¢ â—¦ â€¢ â—¦ â€¢ â€¢
Table 1 Model training and testing matrix. ğ‘€âˆ=2,5,8(â—¦) were out-of-sample when not used for training.
ğ‘€âˆ=3,6,9,10(â€¢) were out-of-sample for all models.
all trained models. This testing arrangement is designed to evaluate the stability and accuracy of the trained models for
interpolation ( ğ‘€train=(2,5,8)only) and extrapolation to lower and higher Mach numbers.
Initial Navierâ€“Stokes viscous-shock solutions for each freestream Mach number listed in Table 1 were obtained
by converging from the corresponding inviscid-shock profile. Training and testing cases were initialized from the
convergedNavierâ€“Stokessolutions. Formodeltraining, theparametersofrandomly-initializedneuralnetworkswere
selectedusing (20)withinitiallearningrate ğ›¼(0)=2.5Ã—10âˆ’6. Toensureconvergence,thelearningratewasreduced
using an adaptive schedule:
ğ›¼=(
ğ›¼, ğœ– rel>ğœ–ğ‘‡
0.75ğ›¼, ğœ– relâ‰¤ğœ–ğ‘‡, ğœ–ğ‘‡=(
ğœ–ğ‘‡, ğœ– rel>ğœ–ğ‘‡
0.75ğœ–ğ‘‡, ğœ– relâ‰¤ğœ–ğ‘‡,
whereğœ–rel=ğ½(ğœƒ)/ğ½0is the objective-function relative error, ğ½0is the initial value of the objective function (i.e., for the
initial, unmodified Navierâ€“Stokes solution), and the starting target error is ğœ–ğ‘‡=0.9. For models trained simultaneously
forğ‘€train=(2,5,8), the minimum ğ›¼andğœ–ğ‘‡were synchronized between training cases. The training process was
stopped forchange inrelative error ğœ–relless than 1Ã—10âˆ’5between successiveiterations. Algorithm 1summarizes the
training process used for all training regimens.
Algorithm 1 Training process
1:Restart Ufrom unmodified Navierâ€“Stokes solution
2:Randomly initialize DL network parameters ğœƒ0
3:Calculate loss of unmodified solution ğ½0
4:Setğœ–0
rel=1.0
5:whileÎ”ğœ–ğ‘›
relâ‰¥10âˆ’5do
6:Converge solution to steady-state using damped Newton solver III.C
7:Solve adjoint equation (16) for Ë†u
8:Computeâˆ‡ğœƒğ½(uğ‘(ğœƒğ‘›))using (19)
9:Update parameters ğœƒusing gradient descent (20)
10:Calculateğœ–ğ‘›+1
rel
11:ComputeÎ”ğœ–ğ‘›+1
rel=ğœ–ğ‘›+1
relâˆ’ğœ–ğ‘›
rel
12:end while
Table 2 shows the total number of optimization iterations and the average number of Newton iterations per
optimization iteration for all models. For all training cases, the relative tolerance of the forward Newton solver was
1Ã—10âˆ’15beforeproceedingtooptimization. ForbothApproachAandApproachB,thehigherMachnumbercases
required more Newton iterations per optimization iteration. Approach A resulted in better training accuracy (lower ğœ–rel)
for most training cases.
10Training ğ‘opt
iterğ‘Newt
iterğœ–rel
Approach A
ğ‘€train=2 21 8 5.333Ã—10âˆ’2
ğ‘€train=5 19 20 1.774Ã—10âˆ’2
ğ‘€train=8 21 35 1.069Ã—10âˆ’2
ğ‘€train=(2,5,8)(100, 100, 100) (9, 36, 17) ( 6.715Ã—10âˆ’1,9.487Ã—10âˆ’2,6.099Ã—10âˆ’2)
Approach B
ğ‘€train=2 46 9 2.876Ã—10âˆ’2
ğ‘€train=5 37 19 4.855Ã—10âˆ’2
ğ‘€train=8 22 41 7.334Ã—10âˆ’2
ğ‘€train=(2,5,8)(100, 100, 100) (6, 22, 33) ( 4.264Ã—10âˆ’1,7.516Ã—10âˆ’2,5.397Ã—10âˆ’2)
Table2 Numberofoptimizationiterations, ğ‘opt
iter,averagenumberofNewtoniterationsperoptimizationiteration
ğ‘Newt
iter, and training loss (objective-function relative error ğœ–rel) for Approaches A and B. For ğ‘€train=(2,5,8), the
training loss is listed separately for the three target Mach numbers.
V. Results and Analysis
A. Shock Predictions
Out-of-sampleresultswereobtainedforthetestingcaseslistedinTable1. Withoutaclosuremodel,theNavierâ€“Stokes
equations give qualitatively incorrect predictions for all training and testing cases. Figures 2 and 3 (Approaches A and
B, respectively) show the computed density from the unmodified Navierâ€“Stokes equations, the Navierâ€“Stokes solutions
with the trained neural networks, and the target DSMC solutions for ğ‘€âˆâˆˆ[2,10]. The neural network-augmented
Navierâ€“Stokes solutions more closely match the target data for all cases and models. As could be anticipated from the
training loss (Table 2), the DL-augmented Navierâ€“Stokes agreement with the DSMC data is qualitatively better for
lowerMachnumbersandforMachnumbersclosertoeachmodelâ€™strainingconditions. Itisalsonoteworthythat,for
both approaches, the models trained on higher Mach numbers extrapolate better to lower Mach numbers. Similar trends
were obtained for the pressure, temperature, and velocity fields.
B. Prediction Accuracy
Figure 4 shows the relative loss-function error as a function of the testing Mach number. This represents the
integrated error of the primitive variables over the entire domain and can be interpreted as a worst-case assessment of a
modelâ€™s performance. All models trained for a single Mach number using Approach A perform better (lower ğœ–rel) than
thecorrespondingmodelsusingtheApproachB.ForApproachB,themodeltrainedfor ğ‘€train=2isgenerallymore
accurate at lower than higher testing Mach numbers, and the model trained for ğ‘€train=8is generally more accurate at
higherthanlowertestingMachnumbers,ascouldbeanticipated. TheApproachBmodeltrainedsimultaneouslyfor
ğ‘€train=(2,5,8)is reasonably accurate across the range of testing Mach numbers, with comparable accuracy to the
in-sample Mach 2, 5, and 8 models, though its extrapolation accuracy diminishes at ğ‘€âˆ=9,10. Interestingly, the
single-caseğ‘€train=8modelreachedthebestin-samplelocalminimumandgavethelowestrelativeerrorsforlower
testing Mach numbers. This model is also reasonably accurate for higher testing Mach numbers.
The extrapolation trends of Approach A are similar to those of Approach B. The model trained for ğ‘€train=8
extrapolateswelltolowerMachnumbercases,withcomparableaccuracytothe ğ‘€train=2case. However,themodel
trainedsimultaneouslyfor ğ‘€train=(2,5,8)performspoorlyforthiscasewitherrorshigherthanallothermodelsfor
almostallMachnumbers. Themodeltrainedsimultaneouslyforfor ğ‘€train=(2,5,8)isreasonablyaccuratefor ğ‘€âˆ=2
through 8 but has increased errors when extrapolating to the higher ğ‘€âˆ=9and 10.
11âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.001.251.501.752.002.252.50DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 2Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 3Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.5DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 5Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 6Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 8Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 10Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMCFig.2 ApproachA:In-andout-of-samplefreestreamdensitypredictions. Resultsareshownfortheunmodified
Navierâ€“Stokes equations, the Navierâ€“Stokes equations with DL models for Approach A trained for ğ‘€=2,ğ‘€=5,
ğ‘€=8, andğ‘€=(2,5,8), and the DSMC target data. The ğ‘€=3,ğ‘€=6, andğ‘€=10cases are out-of-sample for
all trained DL models.
12âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.001.251.501.752.002.252.50DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 2Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 3Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.5DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 5Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 6Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 8Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)1.01.52.02.53.03.54.0DensityÏ(kg/m3)Ã—10âˆ’4
Mâˆ= 10Navierâ€“Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMCFig.3 ApproachB:In-andout-of-samplefreestreamdensitypredictions. Resultsareshownfortheunmodified
Navierâ€“Stokes equations, the Navierâ€“Stokes equations with DL models for Approach B trained for ğ‘€=2,ğ‘€=5,
ğ‘€=8, andğ‘€=(2,5,8), and the DSMC target data. The ğ‘€=3,ğ‘€=6, andğ‘€=10cases are out-of-sample for
all trained DL models.
132 4 6 8 10
TestMâˆ0.000.050.100.150.200.250.30/epsilon1rel
Approach AMtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
2 4 6 8 10
TestMâˆ0.000.050.100.150.200.250.30/epsilon1rel
Approach BFig. 4 In- and out-of-sample objective-function relative error for the four DL models trained for Approach
A(left)andApproachB(right). In-samplecasesforeachmodelareindicatedbyredcircles. Theunmodified
Navierâ€“Stokes solution has ğœ–rel=1.0.
C. Shock Thickness
The shock thickness is evaluated using the maximum density gradient,
ğ›¿=max(ğœŒ)âˆ’min(ğœŒ)
max(ğœ•ğœŒ/ğœ•ğ‘¥). (31)
Figure 5 plots the inverse shock thickness normalized by the mean free path [44],
ğœ†âˆ=16
5ğ›¾
2ğœ‹1
2ğœ‡0
ğœŒâˆğ‘âˆ, (32)
whereğ‘âˆis the freestream speed of sound and ğœ†âˆ=1.098mm for the temperature and pressure conditions considered
here[44]. AsshowninFig.5,alloftheDLmodelsimprovetheNavierâ€“Stokespredictionsâ€™accuracyovertheunmodified
continuumsolutions, whichoverpredicttheshock thicknessforallfreestreamMachnumbersatthisverylow freestream
density. ThemodelstrainedforApproachAaregenerallymoreaccuratethanthosetrainedforApproachB,whichis
counterintuitive, as one would expect the greater modeling flexibility of Approach B to result in higher overall accuracy,
though this is generally consistent with the ğœ–reltrends (Fig. 4). The accuracy reduction for Approach B is likely due to
inconsistencies in the Clausiusâ€“Duhem inequality when applied as a constraint for subcontinuum flows. Conversely, for
ApproachA,thesimplepositivityconstrainton ğœ‡andğ‘˜isastricterrequirementbutdoesnotnecessarilyrequirethe
validity of the Chapmanâ€“Enskog expansion of the Boltzmann equation. For both Approaches A and B, the models
trainedsimultaneouslyfor ğ‘€train=(2,5,8)isreasonablyaccurateforshock-thicknesspredictions,especiallyattheir
in-sampleconditions. TheApproachAmodeltrainedfor ğ‘€train=8givesthemostaccurateinverseshockthickness
predictions over the entire range of testing Mach numbers and is used for subsequent comparisons.
Figure 6 compares the shock-thickness predictions of the Approach A, ğ‘€train=8model to the DSMC targets
andexperimentaldata[ 44,52â€“55]. TheDLmodelfollowstheDSMCtrendstowithintheexperimentaluncertainty.
Additionally,Fig.6extendsthetestingrangebelow ğ‘€âˆ=2,atwhichconditionstheDL-augmentedNavierâ€“Stokes,
unmodified Navierâ€“Stokes, DSMC, and experimental data converge.
D. Shock Profile Asymmetry
Asecondderivedquantity,whichprovidesabetterassessmentoftheoverallshape,isthedensityasymmetryquotient
ğ‘„ğ‘=âˆ«0
âˆ’âˆğœŒâˆ—ğ‘‘ğ‘¥
âˆ«âˆ
0[1âˆ’ğœŒâˆ—]ğ‘‘ğ‘¥, (33)
whereğœŒâˆ—is the normalized density, the maximum gradient of which is centered at ğ‘¥=0. The asymmetry quotient
measures the skewness of a shock density profile relative to its midpoint; a perfectly symmetric profile has ğ‘„ğ‘=1.
142 4 6 8 10
TestMâˆ0.00.10.20.30.40.50.60.7Î»âˆ/Î´
Approach AMtrain= 2
Mtrain= 5
Mtrain= 8Mtrain= 2,5,8
DSMC
N-S (no model)
2 4 6 8 10
TestMâˆ0.00.10.20.30.40.50.60.7Î»âˆ/Î´
Approach BFig.5 Predictedinverseshockthicknessfromtheunmodified(no-model)Navierâ€“Stokesequations,theaugmented
NS equations for the four DL models, and the DSMC target data for Approach A (left) and Approach B (right).
2 4 6 8 10
TestMâˆ0.00.10.20.30.40.50.60.7Î»âˆ/Î´
Mtrain= 8
DSMCN-S (no model)
Experimental
Fig. 6 Experimental data from [ 44,52â€“55] compared to predicted inverse shock thickness from the unmodified
(no-model)Navierâ€“Stokesequations,theaugmentedNSequationsfor ğ‘€train=(2,5,8)usingApproachA,and
the DSMC target data.
152 4 6 8 10
TestMâˆ0.91.01.11.21.31.4Qp
N-S (no model)
Mtrain= 8
DSMC
ExperimentalFig. 7 Predicted density asymmetry quotient for the unmodified (no-model) Navierâ€“Stokes equations, the
augmentedNavierâ€“StokesequationswiththeApproachAclosuretrainedfor ğ‘€train=8,theDSMCtargetdata,
and experimental data [44].
Testingğ‘€âˆ
2 3 4 5 6 7 8 9 10
ğ‘opt
iter=1000.026 0.071 0.117 0.148 0.156 0.199 0.199 0.205 0.250
ğ‘opt
iter=3000.037 0.066 0.115 0.137 0.135 0.180 0.231 0.266 0.297
Table3 Objective-functionrelativeerror ğœ–relforğ‘opt
iter=40andğ‘opt
iter=300. ShownfortheApproachAmodel
trained forğ‘€train=(2,5,8).
Figure 7 compares the computed ğ‘„ğ‘using the unmodified Navierâ€“Stokes equations, the Approach A model
trained forğ‘€train=8, the DSMC target data, and published experimental data [ 44]. The experimental data shows
downstream-skewedshocks( ğ‘„ğ‘<1)forfreestreamMachnumberslessthan2.5andupstream-skewedshocks( ğ‘„ğ‘>1)
for higher Mach numbers, while the unmodified Navierâ€“Stokes equations predict upstream-skewed shocks for all Mach
numbers. The DSMC target profiles capture the overall experimental trends but lie between the experimental and
unmodified Navierâ€“Stokes profiles; this is consistent with other DSMC results using the VHS model [ 64â€“67]. The DL
model leads to skewnesses reasonably close to the target DSMC profiles near the training ğ‘€train=8condition, though
these are still qualitatively different from the experimental measurements at higher Mach numbers.
E. Training Convergence
The convergence of ğœ–relwith the number of optimization iterations is shown in Fig. 8 for the Approach A model
trained simultaneously for ğ‘€train=(2,5,8). A model trained for ğ‘opt
iter=100iterations was used for the preceding tests,
as it had the lowest total ğœ–relbetween the three training Mach numbers. It can be seen that, as the model was trained for
more iterations, its predictions became more accurate for the intermediate ğ‘€âˆ=5and less accurate for ğ‘€âˆ=2and 8.
The testing errors of this model for all testing Mach numbers are listed in Table 3 for ğ‘opt
iter=100andğ‘opt
iter=300. It
is evident that the prediction error for the longer-trained model is significantly higher for Mach numbers away from
ğ‘€âˆ=5, while interpolation to Mach numbers close to it are marginally lower. This is possibly evidence of the model
overfitting to ğ‘€âˆ=5.
16101102
Nopt
iter10âˆ’210âˆ’1100/epsilon1rel
Mâˆ=2
Mâˆ=5
Mâˆ=8
101102
Nopt
iter10âˆ’210âˆ’1100Î£/epsilon1relFig. 8 Convergence of ğœ–rel(left) and the sum of ğœ–relfor the three training Mach numbers (right) as a function of
the number of optimization iterations ğ‘opt
iterusing Approach A, for the training regimen ğ‘€train=(2,5,8). The
trained model at ğ‘opt
iter=100() is used for in- and out-of-sample prediction.
F. Physical Interpretation of the Closure
Figures9and10forApproachesAandB,respectively,comparetheDLclosuremodelstotheunmodifiedcontinuum
closures and the corresponding closures integrated from the DSMC data [ 68]. Approaches A and B modify the viscous
stressand heatflux tosimilarextents relativeto thestandardcontinuum modelsinthe vicinityof theshockand arein
excellentagreementwiththeDSMCprofiles,particularlyupstreamandinthevicinityoftheshock. Overall,thestandard
modelsunderpredictmoleculartransportatthesenonequilibriumconditions,especiallythepost-shockmagnitudeof
thetransporttermsathigherfreestreamMachnumbers. Neartheshock,theDLclosuremodelsandDSMCprofiles
haveclosemagnitudesandarespatiallymorediffusethanthestandardcontinuummodels. Thisisconsistentwiththe
resulting steeper shock profiles (Fig. 6).
Fig. 9, for ApproachA, shows that the modified heat-fluxand viscous-stress terms have the same slopeaway from
theshock astheDSMCterms, unlikeforApproachB. Thisisnotsurprising, asApproachBaugments thecontinuum
closureswithnonlineartermswhich,arefunctionsofthe(nearlyzero)flowgradientsawayfromtheshock. Significantly,
theDL-predictedprofilesfor ğœandqdiffer,whichreflectsthefactthatviscosityandthermalconductivityarecontinuum
manifestations of different sub-continuum processes. Conversely, the temperature-dependent models have the same
functional form (7)with only slightly different coefficients. (Indeed, a common approximation for ğœ†(ğ‘‡)is based upon
multiplyingğœ‡(ğ‘‡)by a constant Prandtl number.) This modeling choice renders the standard models unable to account
for the differing degrees of momentum and thermal diffusion at transition-continuum conditions. The Approach A
and B models have comparable maxima to the DSMC profiles, but the Approach B models generally underpredict
ğœandqdownstream of the shock, which is consistent with their relatively inaccurate shock-thickness predictions.
Furthermore, for both Approaches A and B, the modeled ğœandqare more asymmetric (upstream-skewed) than the
DSMC, particularly for high Mach numbers, which leads to asymmetry quotients ğ‘„ğ‘>1(see Fig. 7).
ApproachA (4)modifiestheviscosityandthermalconductivity;itisthereforeinstructivetoconsidertheformof
the model. Fig. 11 compares the Approach A closures for ğœ‡(U;ğœƒ)andğœ†(U;ğœƒ)(3), evaluated using the neural network
trainedforğ‘€train=(2,5,8),tothestandard,temperature-dependentmodels (7)fortherangeofin-andout-of-sample
testing Mach numbers. The differences between the two models are pronounced at higher ğ‘€âˆand both models predict
significantly higher maximum values than the temperature-dependent models. It is also evident that downstream of
theshock,theDLmodelpredictedtransportcoefficientsalmostexactlymatchtemperaturedependentmodels,thusit
accurately recovers continuum behavior away from the shock.
ThegeneraltrendscapturedbytheDLmodelscouldbeincorporatedintoalgebraicmodelssimilarto (7),which
would enable computationally efficient predictions on a wide range of out-of-sample Mach numbers and geometric
configurations,evenwithhigherdimensionalitythanthepresentshockconfigurations. Thisismoreprobableforsimpler
models, such as our Approach A, that interact only with a scalar coefficient, and so could be more portable to different
dimensionalities, flowgeometries, and/oralignments ofkeyfeatures (e.g.,shocks) withthe computationalmesh. The
more complicatedmodels thatintroduce vector/tensormodifications, suchas ApproachB, aremore likelyto trainin a
17âˆ’6âˆ’4âˆ’2 0 2 4 6
x(mm)10âˆ’210âˆ’1100101102|Ïƒ| Mâˆ= 3
Mâˆ= 5
Mâˆ= 9
DL Model
Unmodiï¬ed
DSMC
âˆ’6âˆ’4âˆ’2 0 2 4 6
x(mm)100101102103104105106|q| Mâˆ= 3
Mâˆ= 5
Mâˆ= 9
DL Model
Unmodiï¬ed
DSMCFig.9 DL-modeledviscousstressandheatflux( )forApproachAversusthestandardcontinuummodels
(). Shown for the Approach A DL model trained for ğ‘€train=8.
âˆ’6âˆ’4âˆ’2 0 2 4 6
x(mm)10âˆ’210âˆ’1100101102|Ïƒ| Mâˆ= 3
Mâˆ= 5
Mâˆ= 9
DL Model
Unmodiï¬ed
DSMC
âˆ’6âˆ’4âˆ’2 0 2 4 6
x(mm)100101102103104105106|q| Mâˆ= 3
Mâˆ= 5
Mâˆ= 9
DL Model
Unmodiï¬ed
DSMC
Fig.10 DL-modeledviscousstressandheatflux( )forApproachBversusthestandardcontinuummodels
(). Shown for the Approach B DL model trained for ğ‘€train=8.
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)0.00.51.01.52.0Âµ/Âµ 0Ã—101
Mâˆ=2
Mâˆ=3
Mâˆ=5
Mâˆ=8
Mâˆ=9
DL Model
Âµ=Âµ(T)
Âµ=Âµ0
âˆ’20âˆ’15âˆ’10âˆ’5 0 5 10
x(mm)0.00.51.01.52.02.53.0Î»/Î» 0Ã—101
Mâˆ=2
Mâˆ=3
Mâˆ=5
Mâˆ=8
Mâˆ=9
DL Model
Î»=Î»(T)
Î»=Î»0
Fig.11 DL-modeledviscosityandthermal conductivity( ; Eq.3)versusstandardtemperature-dependent
models ( ; Eq. 7). Shown for the Approach A (4)DL model trained for ğ‘€train=8.
18geometry-specific manner and likely require re-training for new geometries. The development and validity of more
generally applicable models, as well as the extrapolability of trained models to different freestream thermodynamic
conditions and gas compositions, will be the subject of future work.
VI. Conclusion
Thispaperpresentsanadjoint-baseddeeplearningaugmentationmethodtoextendthevalidityofthecontinuum
flow equations to the transition-continuum regime. Two modeling approaches are compared: Approach A modifies
onlytheviscosityandthermalconductivity,whileApproachBdirectlyaugmentsthecontinuumdiffusivefluxeswith
corrective neural networks. These modeling approaches have less flexibility than outright replacement of the fluxes but
weremorestableduringoptimization. ModeltrainingisperformedbyoptimizingovertheNavierâ€“Stokesequations
while targeting trusted flow data from DSMC solutions of the Boltzmann equation.
An online adjoint optimization method enables this PDE-constrained optimization to be performed efficiently. The
trainedmodelsimprovetheaccuracyofNavierâ€“Stokespredictionsinthisregimeandexhibitstabilityandextrapolability
forMachnumbershigherandlowerthanthoseusedfortraining,withconcomitantreductionofaccuracywhenused
far out-of-sample (although still not of lower accuracy than that of the unmodified Navierâ€“Stokes equations). Models
trained using Approach A have marginally better accuracy compared to models trained using Approach B, and part
ofApproachAâ€™ssuccessmaybeattributedtothedistinctionsitidentifiesbetweenthedifferenttransport-coefficient
profilesandtheirdifferentgrowthtrendswithrespecttotheupstreamMachnumber. Thisresultsindifferentprofiles for
the DL-predicted viscous-stress and heat-flux closures.
Entropyconstraintsensurethatthelearnedclosuremodelssatisfythesecondlawofthermodynamics. Thestrong
entropy constraint, which poses an algebraic constraint on the output of the DL model, resulted in stable, accurate
predictions over the range of testing Mach numbers. The weak entropy constraint, which penalizes the violation of the
entropyinequalityintheoptimizationlossfunction,isattractiveforitsflexibilitybutwaslessstableextrapolatingto
higherMachnumbers. Furtherstudyoftheweightingfactorfortheentropyviolationtermisnecessarytorealizethe
full potential of the weak entropy condition.
Notably,thelossfunctionfortheonlineadjointoptimizationcanbearbitrarilydefined,canincludeflowvariables
(thePDEsolutionorderivedquantities),anddoesnotneedtoexplicitlyincludetheunclosedterm(s). Thisisincontrast
toa prioritraining, which conforms the model directly to the unclosed terms. The success of the online adjoint method
with â€œthird-partyâ€ DSMC target data (i.e., not directly obtained from the flow PDEs) is striking, though not unexpected,
given the success of adjoint-based methods for aerodynamic shape design and turbulence modeling, among others. One
hope is that this method will enable model development against experimental target data with comparable stability and
accuracy, though this remains to be tested. Alternatively, or in addition, the loss function for the flow model can target
derived orintegral quantities thatare functionsof the flowvariables, such asthe shock thicknessor, for wall-bounded
flows, the boundary layer thickness and drag coefficient.
Futureworkwillfocusonextendingthecurrentmodeltomore-complexgeometricscenarios(2Dobliqueandcurved
shocks, 3D shocks) and flows with additional physical complexity (nonmonatomic gases, reacting flows). Particularly
useful for cases with additional physical complexity, the adjoint-based DL approach can account for multiple, coupled
constitutive models simultaneously, which would enable, for example, coupling the transport coefficients with the
chemical kinetics.
Acknowledgments
The authors would like to thank Prof. Iain Boyd for sharing his DSMC solver. This work was supported by the
OfficeofNavalResearchunderawardN00014-22-1-2441. TheresearchofM.P.issupportedbytheVannevarBush
FacultyFellowship. TheauthorsacknowledgecomputationaltimeonresourcessupportedbytheUniversityofNotre
Dame Center for Research Computing (CRC).
References
[1]Paolucci, S., and Paolucci, C., â€œA second-order continuum theory of fluids,â€ Journal of Fluid Mechanics , Vol. 846, No. 22,
2018, p. 686â€“710. https://doi.org/10.1017/jfm.2018.291.
[2]Bird, G. A., â€œApproach to translational equilibrium in a rigid sphere gas,â€ Physics of Fluids , Vol. 6, 1963, p. 1518.
https://doi.org/10.1063/1.1710976.
19[3]Bird, G. A., â€œDirect simulation of the Boltzmann equation,â€ Physics of Fluids , Vol. 13, 1970, p. 2676â€“2681. https:
//doi.org/10.1063/1.1692849.
[4]Boyd, I. D., â€œModeling of associative ionization reactions in hypersonic rarefied flows,â€ Physics of Fluids , Vol. 19, No. 9, 2007,
p. 096102. https://doi.org/10.1063/1.2771662.
[5]Boyd, I. D., â€œComputation of Hypersonic Flows Using the Direct Simulation Monte Carlo Method,â€ Journal of Spacecraft and
Rockets, Vol. 52, No. 1, 2015, pp. 38â€“53. https://doi.org/10.2514/1.A32767.
[6] Chapman, S., and Cowling, T. G., The Mathematical Theory of Non-Uniform Gases , Cambridge University Press, 1970.
[7] Ferziger, J. H., and Kaper, H. G., Mathematical Theory of Transport Processes in Gases , Elsevier Science Publishing, 1976.
[8]Levermore, C. D., â€œMoment closure hierarchies for kinetic theories,â€ Journal of Statistical Physics , Vol. 83, No. 5-6, 1996, pp.
1021â€“1065. https://doi.org/10.1007/BF02179552.
[9]Agarwal, R. K., Yun, K.-Y., and Balakrishnan, R., â€œBeyond Navierâ€“Stokes: Burnett equations for flows in the continuum
transition regime,â€ Physics of Fluids , Vol. 13, 2001, p. 3061â€“3085. https://doi.org/10.1063/1.1397256.
[10] Woods, L. C., An introduction to the kinetic theory of gases and magnetoplasmas , Oxford University Press, 1993.
[11]Grad, H., â€œOn the kinetic theory of rarefied gases,â€ Communications on Pure and Applied Mathematics , Vol. 2, No. 4, 1949, p.
331â€“407. https://doi.org/10.1002/cpa.3160020403.
[12]Grad, H., â€œThe profile of a steady plane shock wave,â€ Communications on Pure and Applied Mathematics , Vol. 5, No. 3, 1952,
p. 257â€“300. https://doi.org/10.1002/cpa.3160050304.
[13]Jin, S., and Slemrod, M., â€œRegularization of the Burnett equations via relaxation,â€ Journal of Statistical Physics , Vol. 103, No.
5-6, 2001, p. 1009â€“1033. https://doi.org/10.1023/A:1010365123288.
[14]Struchtrup, H., and Torrilhin, M., â€œRegularization of Gradâ€™s 13 moment equations: derivation and linear analysis,â€ Physics of
Fluids, Vol. 15, No. 9, 2003, p. 2668â€“2680. https://doi.org/10.1063/1.1597472.
[15]Hash, D. B., and Hassan, H. A., â€œAssessment of schemes for coupling Monte Carlo and Navier-Stokes solution methods,â€
Journal of Thermophysics and Heat Transfer , Vol. 10, No. 2, 1996, pp. 242â€“249. https://doi.org/10.2514/3.781.
[16]Aktas, O., and Aluru, N., â€œA Combined Continuum/DSMC Technique for Multiscale Analysis of Microfluidic Filters,â€ Journal
of Computational Physics , Vol. 178, No. 2, 2002, pp. 342â€“372. https://doi.org/10.1006/jcph.2002.7030.
[17]Panesi, M., Magin, T. E., Bourdon, A., Bultel, A., and Chazot, O., â€œElectronic Excitation of Atoms and Molecules
for the FIRE II Flight Experiment,â€ Journal of Thermophysics and Heat Transfer , Vol. 25, No. 3, 2011, pp. 361â€“374.
https://doi.org/10.2514/1.50033.
[18]Stephani, K., Goldstein, D., and Varghese, P., â€œConsistent treatment of transport properties for five-species air direct simulation
MonteCarlo/Navier-Stokesapplications,â€ PhysicsofFluids ,Vol.24,No.7,2012,p.077101. https://doi.org/10.1063/1.4729610.
[19]Stephani, K., Goldstein, D., and Varghese, P., â€œA non-equilibrium surface reservoir approach for hybrid DSMC/Navierâ€“Stokes
particle generation,â€ Journal of Computational Physics , Vol. 232, No. 1, 2013, pp. 468â€“481. https://doi.org/10.1016/j.jcp.2012.
08.017.
[20]Schwartzentruber, T. E., and Boyd, I. D., â€œA hybrid particle-continuum method applied to shock waves,â€ Journal of
Computational Physics , Vol. 215, No. 2, 2006, pp. 402â€“416. https://doi.org/10.1016/j.jcp.2005.10.023.
[21]Schwartzentruber, T. E., Scalabrin, L. C., and Boyd, I. D., â€œHybrid particle-continuum simulations of nonequilibrium
hypersonic blunt-body flowfields,â€ Journal of Thermophysics and Heat Transfer , Vol. 22, No. 1, 2008, pp. 29â€“37.
https://doi.org/10.2514/1.30216.
[22]Schwartzentruber,T.E.,Scalabrin,L.C.,andBoyd,I.D.,â€œHybridparticle-continuumsimulationsofhypersonicflowovera
hollow-cylinder-flare geometry,â€ AIAA Journal , Vol. 46, No. 8, 2008, pp. 2086â€“2095. https://doi.org/10.2514/1.36681.
[23]Schwartzentruber,T.E.,Scalabrin,L.C.,andBoyd,I.D.,â€œAmodularparticleâ€“continuumnumericalmethodforhypersonic
non-equilibriumgasflows,â€ JournalofComputationalPhysics ,Vol.225,No.1,2007,pp.1159â€“1174. https://doi.org/10.1016/j.
jcp.2007.01.022.
20[24]Burt,J.M.,andBoyd,I.D.,â€œAhybridparticleapproachforcontinuumandrarefiedflowsimulation,â€ JournalofComputational
Physics, Vol. 228, No. 2, 2009, pp. 460â€“475. https://doi.org/10.1016/j.jcp.2008.09.022.
[25]MunafÃ³, A., Torres, E., Haack, J., Gamba, I., and Magin, T., â€œInvestigation of nonequilibrium effects across normal
shock waves by means of a spectral-Lagrangian Boltzmann solver,â€ 51st AIAA Aerospace Sciences Meeting , 2013, p. 0305.
https://doi.org/10.2514/6.2013-305.
[26]Brenner, M.P.,Eldredge, J.D., andFreund, J.B., â€œPerspectiveon machinelearning foradvancingfluid mechanics,â€ Physical
Review Fluids , Vol. 4, No. 10, 2019, p. 100501. https://doi.org/10.1103/PhysRevFluids.4.100501.
[27]Duraisamy, K., Iaccarino, G., and Xiao, H., â€œTurbulence modeling in the age of data,â€ Annual Review of Fluid Mechanics ,
Vol. 51, 2019, pp. 357â€“377. https://doi.org/10.1146/annurev-fluid-010518-040547.
[28]Duraisamy, K., â€œPerspectives on machine learning-augmented Reynolds-averaged and large eddy simulation models of
turbulence,â€ Physical Review Fluids , Vol. 6, No. 5, 2021, p. 050504. https://doi.org/10.1103/physrevfluids.6.050504.
[29]Karniadakis, G. E., Kevrekidis, I. G., Lu, L., Perdikaris, P., Wang, S., and Yang, L., â€œPhysics-informed machine learning,â€
Nature Reviews Physics , 2021, pp. 1â€“19. https://doi.org/10.1038/s42254-021-00314-5.
[30]Kochkov, D., Smith, J., Alieva, A., Wang, Q., Brenner, M., and Hoyer, S., â€œMachine learning-accelerated computational
fluid dynamics,â€ Proceedings of the National Academy of Sciences , Vol. 118, No. 21, 2021, p. 2101784118. https:
//doi.org/10.1073/pnas.2101784118.
[31]Ling, J., Jones, R., and Templeton, J., â€œMachine learning strategies for systems with invariance properties,â€ Journal of
Computational Physics , Vol. 318, 2016, pp. 22â€“35. https://doi.org/10.1016/j.jcp.2016.05.003.
[32]Wu, J.-L., Xiao, H., and Paterson, E., â€œPhysics-informed machine learning approach for augmenting turbulence models: A
comprehensive framework,â€ Physical Review Fluids , Vol. 3, No. 7, 2018, p. 074602. https://doi.org/10.1103/PhysRevFluids.3.
074602.
[33]Beetham, S., Fox, R. O., and Capecelatro, J., â€œSparse identification of multiphase turbulence closures for coupled fluidâ€“particle
flows,â€Journal of Fluid Mechanics , Vol. 914, 2021, p. A11. https://doi.org/10.1017/jfm.2021.53.
[34]Sirignano,J.,MacArt,J.F.,andFreund,J.B.,â€œDPM:AdeeplearningPDEaugmentationmethodwithapplicationtolarge-eddy
simulation,â€ Journal of Computational Physics , Vol. 423, 2020, p. 109811. https://doi.org/10.1016/j.jcp.2020.109811.
[35]Holland, J. R., Baeder, J. D., and Duraisamy, K., â€œTowards integrated field inversion and machine learning with embedded
neural networks for RANS modeling,â€ AIAA Scitech 2019 Forum , 2019, p. 1884. https://doi.org/10.2514/6.2019-1884.
[36]MacArt, J. F., Sirignano, J., and Freund, J. B., â€œEmbedded training of neural-network subgrid-scale turbulence models,â€
Physical Review Fluids , Vol. 6, 2021, p. 050502. https://doi.org/10.1103/physrevfluids.6.050502.
[37]Sirignano, J., and MacArt, J. F., â€œDeep Learning Closure Models for Large-Eddy Simulation of Flows Around Bluff Bodies,â€
Journal of Fluid Mechanics , 2023 (accepted). https://doi.org/10.48550/arXiv.2208.03498.
[38]Sirignano, J., MacArt, J. F., and Spiliopoulos, K., â€œPDE-constrained models with neural network terms: Optimization and
global convergence,â€ Journal of Computational Physics , 2023, p. 112016. https://doi.org/10.1016/j.jcp.2023.112016.
[39]Blonigan, P. J., and Wang, Q., â€œMultiple shooting shadowing for sensitivity analysis of chaotic dynamical systems,â€ Journal of
Computational Physics , Vol. 354, 2018, pp. 447â€“475. https://doi.org/10.1016/j.jcp.2017.10.032.
[40]Ni, A., Wang, Q., Fernandez, P., and Talnikar, C., â€œSensitivity analysis on chaotic dynamical systems by finite difference
non-intrusive least squares shadowing (FD-NILSS),â€ Journal of Computational Physics , Vol. 394, 2019, pp. 615â€“631.
https://doi.org/10.1016/j.jcp.2019.06.004.
[41]Taghizadeh, S., Witherden, F. D., and Girimaji, S. S., â€œTurbulence closure modeling with data-driven techniques: physical
compatibilityandconsistencyconsiderations,â€ NewJournalofPhysics ,Vol.22,No.9,2020, p.093023. https://doi.org/10.
1088/1367-2630/abadb3.
[42]Zhao,Y.,Akolekar,H.D.,Weatheritt,J.,Michelassi,V.,andSandberg,R.D.,â€œRANSturbulencemodeldevelopmentusing
CFD-drivenmachinelearning,â€ JournalofComputationalPhysics ,Vol.411,2020,p.109413. https://doi.org/10.1016/j.jcp.
2020.109413.
21[43]Liu, W., Fang, J., Rolfo, S., Moulinec, C., and Emerson, D. R., â€œAn iterative machine-learning framework for RANS turbulence
modeling,â€ International Journal of Heat and Fluid Flow , Vol. 90, 2021, p. 108822. https://doi.org/10.1016/j.Ä³heatfluidflow.
2021.108822.
[44]Alsmeyer,H.,â€œDensityprofilesinargonandnitrogenshockwavesmeasuredbytheabsorptionofanelectronbeam,â€ Journalof
Fluid Mechanics , Vol. 74, No. 3, 1976, pp. 497â€“513. https://doi.org/10.1017/S0022112076001912.
[45]Reese, J. M., Woods, L. C., Thivet, F. J. P., and Candel, S. M., â€œA second-order description of shock structure,â€ Journal of
Computational Physics , Vol. 117, No. 2, 1995, pp. 240â€“250. https://doi.org/10.1006/jcph.1995.1062.
[46]Lumpkin, F. E., and Chapman, D. R., â€œAccuracy of the Burnett equations for hypersonic real gas flows,â€ AIAA Journal , Vol. 6,
No. 3, 1992, pp. 419â€“425. https://doi.org/10.2514/3.377.
[47]Muckenfuss, C., â€œSome aspects of shock structure according to the bimodal mode,â€ Physics of Fluids , Vol. 5, No. 9, 1962, pp.
1325â€“1336. https://doi.org/10.1063/1.1706528.
[48]Levermore,C.D.,andMorokoff,W.J.,â€œTheGaussianmomentclosureforgasdynamics,â€ JournalofAppliedMathematics ,
Vol. 59, No. 1, 1998, pp. 72â€“96. https://doi.org/10.1137/S0036139996299236.
[49]Cercignani,C.,Frezzotti,A.,andGrosfils,P.,â€œThestructureofaninfinitelystrongshockwave,â€ PhysicsofFluids ,Vol.11,
No. 9, 1994, pp. 2757â€“2764. https://doi.org/10.1063/1.870134.
[50]Myong,R.,â€œAComputationalMethodforEuâ€™sGeneralizedHydrodynamicEquationsofRarefiedandMicroscaleGasdynamics,â€
Journal of Computational Physics , Vol. 168, No. 1, 2001, pp. 47â€“72. https://doi.org/10.1006/jcph.2000.6678.
[51]Xu,K.,andTang,L.,â€œNonequilibriumBhatnagarâ€“Grossâ€“Krookmodelfornitrogenshockstructure,â€ PhysicsofFluids ,Vol.16,
No. 10, 2004, pp. 3824â€“3827. https://doi.org/10.1063/1.1783372.
[52]Linzer, M., and Hornig, D. F., â€œStructure of Shock Fronts in Argon and Nitrogen,â€ Physics of Fluids , Vol. 6, No. 12, 1963, pp.
1661â€“1668. https://doi.org/10.1063/1.1711007.
[53]Camac, M., â€œArgon and nitrogen shock thicknesses,â€ Proceedings of the Fourth International Symposium on Rarefied Gas
Dynamics , Vol. 1, 1965, p. 240. https://doi.org/10.2514/6.1964-35.
[54]Schmidt,B.,â€œElectronbeamdensitymeasurementsinshockwavesinargon,â€ JournalofFluidMechanics ,Vol.39,No.2,1969,
pp. 361â€“373. https://doi.org/10.1017/S0022112069002229.
[55]Garen, W., Synofzik, R., and Frohn, A., â€œShock Tube for Generating Weak Shock Waves,â€ AIAA Journal , Vol. 12, No. 8, 1974,
pp. 1132â€“1134. https://doi.org/10.2514/3.49425.
[56]Poinsot, T. J., and Lele, S. K., â€œBoundary conditions for direct simulations of compressible viscous flows,â€ Journal of
Computational Physics , Vol. 101, No. 1, 1992, pp. 104â€“129. https://doi.org/10.1016/0021-9991(92)90046-2.
[57]Roe,P.L.,â€œCharacteristic-basedschemesfortheEulerequations,â€ AnnualReviewofFluidMechanics ,Vol.18,No.1,1986,pp.
337â€“365. https://doi.org/10.1146/annurev.fluid.18.1.337.
[58]Boyd,I.D.,andSchwartzentruber,T.E., NonequilibriumGasDynamicsandMolecularSimulation ,CambridgeAerospace
Series, Cambridge University Press, 2017. https://doi.org/10.1017/9781139683494.
[59]Valentini,P.,andSchwartzentruber,T.E.,â€œLarge-scalemoleculardynamicssimulationsofnormalshockwavesindiluteargon,â€
Physics of Fluids , Vol. 21, No. 6, 2009, p. 066101. https://doi.org/10.1063/1.3149866.
[60]Wang, S., â€œExtensions to the Navierâ€“Stokes equations,â€ Physics of Fluids , Vol. 34, No. 5, 2022, p. 053106. https:
//doi.org/10.1063/5.0087550.
[61]Sirignano,J.,andSpiliopoulos,K.,â€œOnlineAdjointMethodsforOptimizationofPDEs,â€ AppliedMathematicsandOptimization ,
2022, p. 18. https://doi.org/10.1007/s00245-022-09852-5.
[62]Steiner, B., DeVito, Z.,Chintala, S., Gross, S., Paszke, A., Massa, F., Lerer, A., Chanan, G., Lin, Z., Yang, E., Desmaison, A.,
Tejani, A., Kopf,A., Bradbury, J., Antiga, L., Raison,M., Gimelshein, N., Chilamkurthy, S., Killeen, T., Fang, L., and Bai, J.,
â€œPyTorch: An imperative style, high-performance deep learning library,â€ NeurIPS, 2019.
[63] Powers, J. M., Combustion Thermodynamics and Dynamics , Cambridge University Press, 2016.
22[64]Torrilhon, M., and Struchtrup, H., â€œRegularized 13-moment equations: shock structure calculations and comparison to Burnett
models,â€ Journal of Fluid Mechanics , Vol. 513, 2004, pp. 171â€“198. https://doi.org/10.1017/S0022112004009917.
[65]Bentley, B. I., â€œAn Investigation of Shock Wave Physics via Hybrid CFD-BGK Solution Methods for Nonequilibrium Flows,â€
Tech. rep., Air Force Inst. Tech., 2009.
[66]Bentley, B. I., and Greendyke, R., â€œUsing the Unified Flow Solver to Investigate the Normal Shock Wave Structure,â€
47th AIAA Aerospace Sciences Meeting including The New Horizons Forum and Aerospace Exposition , 2009, p. 1541.
https://doi.org/10.2514/6.2009-1541.
[67]Bentley, B. I., and Greendyke, R. B., â€œShock Structure Solution by Hybrid Flowfield Methods,â€ Journal of Spacecraft and
Rockets, Vol. 49, No. 6, 2012, pp. 1058â€“1068. https://doi.org/10.2514/1.A32179.
[68] Vincenti, W. G., and Kruger, C. H., Introduction to Physical Gas Dynamics , New York, Wiley, 1965.
23