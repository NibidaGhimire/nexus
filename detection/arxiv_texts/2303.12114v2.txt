Deep Learning Closure of the Navier–Stokes Equations for
Transition-Continuum Flows
Ashish S. Nair∗
University of Notre Dame, Notre Dame, Indiana 46556, USA
Justin Sirignano†
University of Oxford, Oxford OX2 6GG, UK
Marco Panesi‡
University of Illinois at Urbana–Champaign, Urbana, Illinois 61801, USA
Jonathan F. MacArt§
University of Notre Dame, Notre Dame, Indiana 46556, USA
ThepredictiveaccuracyoftheNavier–Stokesequationsisknowntodegradeatthelimits
of the continuum assumption, thereby necessitating expensive and approximate solutions to
theBoltzmannequation. Whiletractableinonespatialdimension,theirhighdimensionality
increasesthecomputationalchallengeofmulti-dimensional,multi-physicalBoltzmanncalcu-
lations. ItisthereforedesirabletoaugmenttheNavier–Stokesequationsforaccuracyunder
these conditions. We present an application of a deep learning method to extend the validity of
the Navier–Stokes equations to transition-continuum flows. The technique encodes the missing
physicsviaaneuralnetwork,whichistrainedtoreducetheerrorbetweentheNavier–Stokesand
Boltzmann solutions. While standard DL methods can be considered ad hocdue to the absence
of underlying physical laws, at least in the sense that the systems are not governed by known
partialdifferentialequations,theDLframeworkleveragesthe a prioriknownBoltzmannphysics
whileensuringthatthetrainedmodelisconsistentwiththeNavier–Stokesequations. Theonline
trainingproceduresolvesadjointequations,constructedusingalgorithmicdifferentiation,which
efficiently provide the gradient of the loss function with respect to the learnable parameters.
The model is trained and applied to predict stationary, one-dimensional shock thickness in
low-pressure argon.
I. Nomenclature
U = dependent variables
ˆu = adjoint variables
𝜃 = model parameters
𝑓(U𝑥,𝜃)= neural network closure model
II. Introduction
Computationally efficient and accurate models for flows in translational nonequilibrium are essential for designing,
operating, and developing hypersonic flight vehicles and their advanced propulsion systems. The Knudsen number
(Kn=𝜆/𝐿,where𝜆isthemolecularmeanfreepathand 𝐿isacharacteristiclengthscale)indicatestheflowregime,
spanning continuum to free-molecule flow. Increasing Knindicates an increasing departure from local thermodynamic
AspectsofthisworkwerepresentedasPaper2023-1796atthe2023AIAASciTechForum,NationalHarbor,MD,January23–27,2023,and
Paper 2022-1703 at the 2022 AIAA SciTech Forum, San Diego, CA, January 3–7, 2022.
∗Graduate Student, Department of Aerospace and Mechanical Engineering
†Associate Professor, Mathematical Institute
‡Professor, Department of Aerospace Engineering; Director, Center for Hypersonic and Entry Systems Studies. Associate Fellow AIAA.
§Assistant Professor, Department of Aerospace and Mechanical Engineering; jmacart@nd.edu. Member AIAA.
1arXiv:2303.12114v2  [physics.flu-dyn]  24 Jul 2023equilibrium, which affects the applicability of various flow models [ 1]. For Kn≤10−3, the continuum Navier–Stokes
equationsareanappropriatefluidmodel. However,existingcomputationallyefficienthydrodynamicmodels,perturbative
innature[ 1],becomeunreliableas Knrisesduetoeitherlowdensitiesorregionsofhighlocalgradients(asinhypersonic
flows), which cause deviations from the linear Newtonian and Fourier laws. The high-Knudsen-number regime can be
further divided into the transition-continuum regime ( 0.01≤Kn≤1) and the free-molecule flow regime ( Kn≥1).
From a theoretical standpoint, the kinetic description of interacting particles via the solution of the Boltzmann
equation allows for the most accurate description of nonequilibrium hypersonic flows. Because of the difficulties
associatedwiththesolutionoftheBoltzmannequation,approximatephysics-basedmethods—atdifferentspatialand
time scales—have been developed over the years by the scientific community. This section aims to provide a brief
overviewandacriticalanalysisoftheapproachescurrentlyusedintheliteraturetoalleviatethecomputationalchallenges
of solving the Boltzmann equation.
These methods can be classified into two broad categories: Direct Simulation Monte Carlo (DSMC) and extended-
hydrodynamicsmethods. DSMCinvolvesthesimulationofcollisionsbetweenmany“computationalmolecules”that
statistically describe the physical dynamics and interactions among fluid molecules [ 2,3]. While popular, DSMC
remainschallengingformixedtransition-continuumandcontinuumflows,thoughmodernDSMCcansolvecomplicated,
multiphysical flows given sufficient computing power [ 4,5]. The computational cost of DSMC can be alleviated by
extended-hydrodynamics methods, which use the fluid equations in conjunction with higher-order constitutive models
for the viscous stress and heat flux terms to extend their validity beyond the continuum regime. Many of these methods
usetheChapman–Enskogexpansion,whichuses Kn-seriesapproximations(ofvaryingorder)totheBoltzmannequation.
Retainingthezero-ordertermsgivestheEulerequations,first-ordertermstheNavier–Stokesequations,andsecond-order
terms the Burnett equations [ 6]. The Navier–Stokes equations are valid in the continuum limit ( Kn→0) of small
mean free paths [ 6,7]. However, large perturbations of the velocity distribution from equilibrium render the continuum
assumption invalid. Nonperturbative moment methods [ 8] mitigate the problem of the breakdown away from moderate
nonequilibrium by predicting values for momentum and energy fluxes that are consistent with the nonnegativity of
theparticledensity. Thesemethods,however,arestorage-intensiveandcomputationallyimpracticalduetothelarge
number of independent variables required to evaluate integral terms. Several variants of the Burnett equations have
been proposed including the BGK–Burnett (Bhatnagar–Gross–Krook) equations [ 9], Woods equations [ 10], Grad’s
13-momentequations[ 11,12],regularizedBurnett[ 13],andregularizedGrad’s13-momentequations[ 14]. Amajor
drawback of most is their mathematical ill-posedness in their original formulations, which leads to physical and
numerical instabilities. Thermodynamic consistency is also not an intrinsic property of these equations; this limits
their general applicability, despite their computational cost being comparable to the Navier–Stokes equations. The
advantagesofDSMC’sdetailedkineticinformationandthecontinuum-likemethods’computationaltractabilitycan
be obtained by hybrid schemes [ 15–24], which solve the Navier–Stokes equations in continuum regions of the flow
andemploytheDSMCtechniqueelsewhere. Althoughthesemethodsareattractiveformultiscaleflows,identifying
thecontinuumandDSMC(molecular)regionsisoftendonefromthecontinuumperspective,numericallyinterfacing
theseregions ischallenging, andthespeedup obtainedisoften insufficientto renderitan attractivealternative topure
DSMC.Deterministic numericalmethods thatdirectly solvethe Boltzmannequation [ 25]havebeen testedfor simple
flow configurations, though their extension to practical problems is yet to be explored.
This paper describes the construction of a physics-based reduced-order model, able to capture the fundamental
physical processes that occur in hypersonic flows, yet computationally efficient, by leveraging fundamental physics,
computational science, and applied mathematics. The proposed model compensates for the deficiencies of the
Navier–Stokes model in the transition-continuum regime by introducing additional terms into the continuum equations.
By estimating the parameters of these terms (we use neural networks) while converging the Navier–Stokes solutions to
Boltzmann solutions, the model attempts to encode the unrepresented physics that are missing from the continuum
descriptionofthegas. Wealsoproposealgebraicconstraintstothemodeloutputstoensureconsistencywiththesecond
law of thermodynamics.
Applications of deep learning (DL) for closure modeling are widespread in incompressible fluid mechanics [ 26–30]
but are much less common for compressible flows and hypersonics. Most previously employed machine learning
methods for flows attempt to estimate unclosed terms (e.g., the Reynolds stress or the subgrid stress) by minimizing the
directmismatchbetweenthesetermsand“trusted”data, whichareoftenobtainedfromhighlyresolveddirectnumerical
simulations (DNS) [ 31–33]. This approach, which we call a prioritraining, decouples the parameter estimation
(optimization)stepfromthesolutionofthegoverningpartialdifferentialequations(PDEs),whichismathematically
inconsistent due to the noncommutativity of nonlinear operations [ 34]. In our view, this approach has two primary
deficiencies for compressible flows. First, the nonlinear coupling of dependent variables inherent to compressible flows
2intensifies the inconsistency of a prioritraining. Second, and more importantly, when the discrepancy is due to a
fundamental deficiency in the PDE model—for example, for transition-continuum flows, approximations to the viscous
stress and heat flux from kinetic theory—the functional form of the discrepancy is often unknown; thus, even defining
the loss function for the direct mismatch is challenging.
Ourdeeplearningapproachisconceptuallysimpleyetavoidsthesechallenges. Ratherthandecoupletheoptimization
step from the PDE solution, we use an embedded optimization method that substitutes the untrained model into the
PDEandestimatesitsparameters insitu[28,34,35]. Themodelthusrespectsitseffectsonthenonlinearlycoupled
PDEsolution. Additionally,thisapproachcandirectlycomputethelossfunctionfromthedependentvariables(mass,
momentum,andenergy)orderivedquantities(e.g.,temperature)ratherthanfromhigher-orderunclosedtermsappearing
in the PDEs. This allows us to obtain target data from Boltzmann solutions and, in theory, enables straightforward
incorporation of experimental data. We present an embedded optimization approach that optimizes over the PDE
solutionbysolvingtheadjointNavier–Stokesequations,whichareobtainedusingalgorithmicdifferentiation(AD)ofthe
forwardequationsandaresolvedefficientlyusinggraphicsprocessingunit (GPU)acceleration. Similarmethodshave
beensuccessfullyappliedtoturbulencemodelingforincompressiblelarge-eddysimulation(LES)[ 34,36,37],Reynolds-
averaged Navier–Stokes (RANS) simulation [ 35,38] and sensitivity analysis of chaotic dynamical systems [ 39,40].
Given the code-intrusive nature of adjoint-based optimization, many efforts to avoid this difficulty have used less-
complete couplings of the optimization step and the PDE solution [ 41–43], though these methods typically require
trusted data for the exact term being modeled, which is not always possible.
This work presents an example application to the prediction of the shock structure in rarefied argon flows, compares
the augmentedNavier–Stokes predictions tothe unmodified predictions, assesses theMach number interpolationand
extrapolation capability of the DL model, and provides a physical interpretation of the modifications to the continuum
transport terms. The governing equations and transport models from kinetic theory are briefly reviewed in Section III.
The embedded deep learning framework and constraints to enforce the second law of thermodynamics are introduced in
Section IV. An application to transition-continuum argon shock predictions is presented in Section V. A summary and
discussion of future work are provided in Section VI.
III. Continuum Equations and Closure Models
Let𝑔(𝑡,x,v)be the solution to the Boltzmann equation (the distribution function) for 𝑡∈[0,∞)andx,v∈R3,
and define the mass density 𝜌(𝑡,x)=⟨𝑚,𝑔(𝑡,x,·)⟩and fluid-dynamic momentum 𝜌u(𝑡,x)=⟨𝑚𝑔(𝑡,x,·),v⟩, where
𝑚is the mass of a particle, and integrals of the distribution function over the velocity space are obtained from
⟨ℎ(·),𝑔(𝑡,x,·)⟩=∫
R3ℎ(v)𝑔(𝑡,x,v)𝑑v. In this manner, all continuum quantities of interest U={𝜌,u,𝑝,𝑇,...}may
be obtained, where 𝑝is the pressure, and 𝑇is the temperature, among other possibilities.
ThecompressibleNavier–Stokesequationsforasingle-componentgas,asderivedfromtheBoltzmannequation,are
𝜕𝜌
𝜕𝑡+∇·(𝜌u)=0
𝜕𝜌u
𝜕𝑡+∇·h
𝜌u⊗u−𝜏(u,v,𝑔)i
=0 (1)
𝜕𝜌𝐸
𝜕𝑡+∇·h
𝜌𝐸u−𝜏(u,v,𝑔):u+q(u,v,𝑔)i
=0,
where𝐸=𝑒+u⊤u/2is the total energy and 𝑒is the internal energy. The thermal momentum flux
𝜏(u,v,𝑔)=D
𝑚v⊗v−𝜌u⊗u,𝑔(𝑡,x,·)E
(2)
and the heat flux q(u,v,𝑔)require integration over the Boltzmann phase space; thus, they are unclosed under the
continuumvariables. Closureof (2)iscommonlyachievedbyassumingproportionalitytothestrain-ratetensorand
defining the pressure, yielding 𝜏=𝜎−𝑝I, where𝜎=𝜇(∇u+∇u⊤)−2
3𝜇(∇·u)I,𝜇is the viscosity, and the pressure
satisfies the ideal-gas equation of state 𝑝=(𝛾−1)(𝜌𝐸−𝜌u⊤u/2), where𝛾is the (constant) ratio of specific heats.
Similarly, the heat flux is typically closed using q=−𝜆∇𝑇, where𝜆is the thermal conductivity, 𝑇=𝑝/(𝜌𝑅), and𝑅is
thespecificgasconstant. However,theseclosures—andtheuseoftheNavier–Stokesequationsmoregenerally—require
the continuum approximation to hold, which can inaccurately represent the physics of nonequilibrium flows in the
transition-continuum regime.
3A. Neural-Network Closures
We introduce three approaches for the closure of (1)using neural networks. First, the transport coefficients 𝜇and
𝜆may becorrected using neural networks (Approach A),
𝜇(U;𝜃)=𝜇0(1+𝑓1(U𝑥;𝜃)),
𝜆(U;𝜃)=𝜆0(1+𝑓2(U𝑥;𝜃)),(3)
where𝑓1(U𝑥;𝜃)and𝑓2(U𝑥;𝜃)are the outputs of a neural network 𝑓(U𝑥;𝜃), which takes the point-wise derivatives of
Uas its input and has parameters 𝜃. The resulting viscous stress and heat flux are
𝜎(U;𝜃)=𝜇(U;𝜃) ∇u+(∇u)⊤−2
3(∇·u)I
and
q(U;𝜃)=−𝜆(U;𝜃)∇𝑇.(4)
Second, the continuum viscous-stress and heat-flux models may be augmented by linearly superimposing neural
networks (Approach B). This results in augmented viscous-stress and heat-flux terms,
𝜎(U;𝜃)=𝜇 ∇u+(∇u)⊤−2
3(∇·u)I
−𝑓1(U𝑥;𝜃)
q(U;𝜃)=−𝜆∇𝑇−𝑓2(U𝑥;𝜃),(5)
where𝑓1(U𝑥;𝜃)and𝑓2(U𝑥;𝜃)are again neural-network outputs, though they need not be the same networks as in (3).
Finally, the continuum models 𝜎(U)andq(U)may bedirectly modeled using neural networks (Approach C),
𝜎(U;𝜃)=𝑓1(U𝑥;𝜃)and q(U;𝜃)=𝑓2(U𝑥;𝜃). (6)
WepursueonlyApproachesAandBhere. ThesehavemorelimitedpotentialthanApproachC,beingconstrainedby
thealgebraicmodelsfor 𝜎andq,butaremorestraightforwardtoimplementandanalyze. Ratherthandirectlymodel
the transport terms, our goal is to select 𝜃such that the new models account only for deviations of the classical relations
from kinetic theory. The neural network 𝑓(U𝑥;𝜃)structure and optimization are discussed further in Section IV.
An important uncertainty in the physical modeling of the shock structure, especially at high Mach numbers, is
the temperature dependence of the transport coefficients 𝜇and𝜆. We use a power-law dependence of the baseline
continuum transport coefficients on temperature,
𝜇(𝑇)=𝜇0𝑇
𝑇0𝑠
and𝜆(𝑇)=𝜆0𝑇
𝑇0𝑠
, (7)
where𝑇0=273.15 K, is typically used for argon. Several previous efforts have aimed to adjust the value of 𝑠to
reproduceexperimentalshockprofiles[ 3,44–46]. Followingthese,weuse 𝑠=0.74tomatchtheviscositylawexponent
used in our DSMC simulations.
B. Application to 1D Shocks
We consider an application to a 1D stationary shock in argon at 𝑝∞=6.667Pa and𝑇∞=300K. This is a
common shock-structure problem for extended hydrodynamics models [ 45–51] that has been extensively studied
experimentally[ 44,52–55]. Theflowhasatransition-continuumKnudsennumber Kn=0.2∼0.3withintheshock,
which Navier–Stokes equations do not accurately model. A monatomic gas such as argon is generally chosen to study
theshockstructureduetothelackofvibrationalorrotationalnonequilibrium. Weassumeaconstantratioofspecific
heats𝛾=5/3with gas constant 𝑅=208.12 kJ/kg·K. The 1D stationary solution of (1) satisfies
𝜕U
𝜕𝑡=−𝜕F𝑐
𝜕𝑥+𝜕F𝑑
𝜕𝑥=0, (8)
where
U=𝜌
𝜌𝑢
𝜌𝐸, F𝑐=𝜌𝑢
𝜌𝑢2+𝑝
𝜌𝑢𝐻, F𝑑=0
𝜎(U;𝜃)
𝜎(U;𝜃)𝑢−𝑞(U;𝜃),
4where𝐻=𝑒+𝑝/𝜌+1/2𝑢2is the total enthalpy, and 𝜎(U;𝜃)and𝑞(U;𝜃)are the 1D versions of the viscous-stress
tensor and heat-flux vector with embedded neural networks. Usatisfies Dirichlet (supersonic freestream) boundary
conditions at 𝑥=−∞and subsonic nonreflective characteristic boundary conditions at 𝑥=+∞[56].
The 1D equations are solved on a domain 𝐿𝑥∈[−20 mm,10 mm]with the shock positioned at 𝑥=0. Inviscid
shocksolutionsprovidetheinitialconditionsandDirichletboundaryconditions. Theequationsarediscretizedover
𝑛𝑥=256uniformlyspacedmeshcellswiththeEulerfluxesdiscretizedusingacharacteristic-basedscheme[ 57];all
otherterms arediscretizedusing second-ordercentereddifferences. Theequationsare converged totheirsteady-state
solution using a damped Newton method; details are provided in Section III.C
Target data are obtained from DSMC solutions of the Boltzmann equation at freestream Mach numbers 𝑀∞=
2,3,5,6,8,9, and 10. The DSMC simulations used a VHS collision model and were initialized using the same pre- and
post-shock conditions as the Navier–Stokes simulations. The viscosity law exponent 𝑠=0.74was found to best match
experimental data [ 44]. For further details about the DSMC simulations, readers are directed to [ 58,59]. We denote the
target data as 𝜌,𝑢and𝑇.
C. Damped Newton Method
Fully converging the forward solution is necessary to ensure well-posedness of the embedded optimization problem.
ThisisachievedusingadampedNewtonmethod,whichisabletoconvergethesolutiontonearmachineprecision(using
64-bit floating-point precision). By comparison, pseudo-time-stepping methods require taking prohibitively many steps
to achieve comparable convergence. For the present shock cases with moderately high Mach numbers (e.g., 𝑀=5)
converging the relative loss to 𝑂(10−2)requires approximately 1200 pseudo-time iterations but only approximately 20
damped Newton iterations. Even with the higher cost of the Newton solver, the lower number of iterations reduces the
training time by approximately a factor of ten.
Considerthesteadysolutionof (8),𝜕(F𝑑−F𝑐)/𝜕𝑥=𝜕F𝑥/𝜕𝑥=0. The𝑛thNewtoniterationsolves ΔUfromthe
linearized system
𝑑F𝑥
𝑑U𝑛
ΔU=−F𝑥(U𝑛) (9)
and advances the solution as U𝑛+1=U𝑛+ΔUuntilΔUfalls below a specified tolerance. Given the low dimensionality
of the 1D problem, we solve (9)using Gauss–Jordan elimination, though 2D and 3D problems would require more
sophisticated sparse or iterative solution methods. Since the embedded optimization procedure currently uses the
Jacobian𝜕F𝑥/𝜕U, the Jacobian can be reused for the Newton solver, though both could be posed in a Jacobian-free
manner.
A practical difficulty with Newton iteration is the lack of physical constraints on ΔU. Large values of ΔUobtained
bysolving (9)canresultinnonphysicalvaluesof U(e.g.,negativedensityorpressure). Weavoidtheseproblemsby
bracketingΔUsuch that it does not exceed a specified fraction of the local solution. The bracketing operation is
ΔU𝑏=min
𝑓𝑏∥U∞∥2×ΔU
∥ΔU∥2,ΔU
, (10)
where𝑓𝑏=0.1is the bracketing factor, ∥U∞∥2is the𝐿2norm of the freestream U, andΔU/∥ΔU∥2is the unit vector in
the direction of ΔU. To further ensure physical solutions, ΔU𝑏is recursively damped, ΔU𝑑=𝑓𝑑ΔU𝑏, where𝑓𝑑=0.2
is a damping factor, until U𝑛+1is physically consistent (e.g., the density and pressure are positive). The solution is then
advanced as
U𝑛+1=U𝑛+ΔU𝑛
𝑑. (11)
Using the Newton method along with bracketing and damping stabilizes the solution before taking an optimization step
to update the neural network parameters.
IV. Machine Learning Closure
This section is organized as follows: IV.A outlines the architecture of the embedded neural network and its inputs,
IV.B details the standard a priorioptimization approach and the adjoint-based optimization approach used in this paper,
and IV.C presents a brief derivation of the entropy constraints introduced to enforce the second law of thermodynamics.
5A. Model Architecture
The inputs to the embedded neural network are the first-order spatial derivatives of the computed scalar flow
quantities and velocity at a mesh point 𝑥𝑖:ˆ𝑧𝑖={𝜌𝑥(𝑥𝑖),𝑝𝑥(𝑥𝑖),𝑇𝑥(𝑥𝑖),𝑢𝑥(𝑥𝑖)}. These inputs are invariant to Galilean
transformations(constantrelativemotion),beingspatialderivativesofscalarandvectorquantities,whichalsoguarantees
that the network output quantities are invariant to Galilean transformations [ 31,60]. We do not consider rotational
invariance, which isa separate issue that hasbeen assessed elsewhere [ 31]. The model inputs areexpanded to include
data at the two neighboring mesh points: 𝑧𝑖={ˆ𝑧𝑖−1,ˆ𝑧𝑖,ˆ𝑧𝑖+1}. This expanded set of inputs serves to enable the model to
compute higherderivatives, though itintroduces adegree of meshdependence, which couldreduce generalizabilityto
out-of-samplemeshes. Addressingtheissuesof rotationalinvariance andmeshdependenceis thesubjectofongoing
applications to two- and three-dimensional flows.
The neural network has a four-layer structure with one gate layer. For inputs 𝑧∈R18×𝑛𝑥, the model architecture is
𝐻1=𝜎1(𝑊1𝑧+𝑏1)
𝐻2=𝜎1(𝑊2𝐻1+𝑏2)
𝐻3=𝐺⊙𝐻2with𝐺=𝜎2(𝑊3𝑧+𝑏3)
ˆ𝑓(𝑧;𝜃)=𝑊4𝐻3+𝑏4
with output dimensions ˆ𝑓(𝑧;𝜃)∈R2×𝑛𝑥. In these,
𝜎1(𝑥)=(
𝛼(exp(𝑥)−1), 𝑥≤0
𝑥, 𝑥 > 0
is the exponential linear unit (ELU) activation function with hyperparameter 𝛼=1,𝜎2(𝑥)=1/(1+𝑒−𝑥)is the sigmoid
activationfunction, ⊙signifieselement-wisemultiplication,andtheparametersare 𝜃={𝑊1,𝑊2,𝑊3,𝑊4,𝑏1,𝑏2,𝑏3,𝑏4}.
We use𝑁𝐻=1200hidden units per layer, which balances training accuracy and computational efficiency.
For Approach B (augmented continuum viscous-stress and heat-flux models; (5)), the output layer is chosen to
enforcetheentropyconditionsintroducedinSectionIV.C.ForApproachA(correctedtransportcoefficients; (3)),the
raw neural network outputs ˆ𝑓(𝑧;𝜃)are passed through a final ELU layer,
𝑓(𝑧;𝜃)=𝜎1(ˆ𝑓(𝑧;𝜃))+0.1,
which is a simpler constraint to ensure positivity of 𝜇0(1+𝑓1(𝑧;𝜃))and𝜆0(1+𝑓2(𝑧;𝜃))for all𝑧and𝜃.
B. Online Optimization Approach
Optimization of standard a prioriDL closures is constrained to use objective (loss) functions that are explicit
functions of the neural network. For example, if one wished to model the viscosity 𝜇with a neural network 𝑓(𝑧;𝜃),
then it would be sufficient to minimize the objective function
𝐽(𝜃)=1
2∫∞
−∞
𝑓(𝑧(𝑥);𝜃)−𝜇𝑒2
𝑑𝑥, (12)
where𝜇𝑒istrusteddata(usuallyobtainedfromDNS),and 𝑧(𝑥)aretheinputvariables. Toselect 𝜃usinggradient-descent
optimization, one needs to compute the gradient
∇𝜃𝐽=∫∞
−∞
𝑓(𝑧;𝜃)−𝜇𝑒
∇𝜃𝑓(𝑧(𝑥);𝜃)𝑑𝑥,
where∇𝜃𝑓(𝑧(𝑥);𝜃)may be evaluated using AD over the neural network, which is standard functionality in DL
softwarelibraries. However,optimizationusing (12)isproblematicwhendatafortheexactclosureterm( 𝜇𝑒)arenot
available—forexample,whenusingexperimentalorhigher-ordersimulationdata(e.g.,DSMC)—orwhenthetarget
quantityisnotknownoraccuratelyestimablefromtheavailabledata. Furthermore,thisoptimizationtakesplaceoffline,
without solving the governing PDEs, so at best is only indirectly PDE-constrained by the target data.
TheembeddedDLapproachaddressestheseshortcomingsbyintroducinganonlineoptimizationalgorithm[ 38,61],
which enables arbitrarily defined objective functions. For the application to nonequilibrium flows, we construct an
6Known Physics +
Unclosed PhysicsU/n.sc/r.sc/e.sc/p.sc/r.sc/e.sc/s.sc/e.sc/n.sc/t.sc/e.sc/d.sc /o.sc/r.sc
U/n.sc/k.sc/n.sc/o.sc/w.sc/n.sc P/h.sc/y.sc/s.sc/i.sc/c.sc/s.sc
PDE forU
+
NN Closure f(U;θ)PDE M/o.sc/d.sc/e.sc/l.sc
NN
Backprop.θ
NN
Backprop.θTargetµe DNS
µ(θ)Closure
Prediction
Mismatch∇θJ(θ)
A /p.sc/r.sc/i.sc/o.sc/r.sc/i.sc O/p.sc/t.sc/i.sc/m.sc/i.sc/z.sc/a.sc/t.sc/i.sc/o.sc/n.sc
(O/f.sc/f.sc/l.sc/i.sc/n.sc/e.sc)Target uDNSExperiments,
DSMC, etc.
Adjoint
PDEMismatchuTraining
Prediction
∇θJ(u(θ))Auto
grad
E/m.sc/b.sc/e.sc/d.sc/d.sc/e.sc/d.sc O/p.sc/t.sc/i.sc/m.sc/i.sc/z.sc/a.sc/t.sc/i.sc/o.sc/n.sc
Prediction U
Out-of-sampleFig.1 TwomethodstooptimizeaNNclosure 𝑓(u;𝜃)inaPDEmodeltorepresentunclosedphysics. A priori
optimizationselectsthemodelparameters 𝜃offline(withoutsolvingthePDEmodel). Embeddedoptimization
instead minimizes the error with respect to the PDE solution U(or derived quantities u) by solving adjoint PDEs,
which enables efficient computation of the gradient ∇𝜃𝐽(u(𝜃)).
objective function using the mismatch between the computed primitive variables u𝑝=[𝜌,𝑢,𝑇]⊤and target data
obtained from DSMC solutions of the distribution function. Using an objective function constructed of primitive
variables u𝑝ratherthatconservedvariables Uresultedinbetterconvergenceandlowerlosses. Ingeneral,thetargetdata
maybeknownfromDNS,experiments,and/orhigher-ordersimulations. Thelossfunctionintermsoftheprimitive
variables is
𝐽(u𝑝(𝜃))=1
2∫∞
−∞1
𝜌2∞(𝜌(𝑡,𝑥;𝜃)−𝜌)2+1
𝑢2∞(𝑢(𝑡,𝑥;𝜃)−𝑢)2+1
𝑇2∞
𝑇(𝑡,𝑥;𝜃)−𝑇2
𝑑𝑥, (13)
where𝜌∞,𝑢∞, and𝑇∞are the reference freestream values used for normalization, and where we emphasize the
dependence of the flow quantities on 𝜃. The objective function depends on 𝜃implicitly through u𝑝.
Figure 1 illustrates the conceptual differences between a prioriand embedded optimization. Notably, a priori
optimization requires high-fidelity (e.g., DNS) target data for the closure term, which may not be available or accurately
known. (This would be the case, for example, for DNS solutions of the Navier–Stokes equations in the transition-
continuum regime.) A priorioptimization cannot target the flow variables (or derived quantities), thus it cannot
straightforwardly incorporate experimental and/or higher-order simulation data. In the same vein, the embedded
optimization approach does not necessarily need DNS data.
We now consider the optimization of the discretized versions of (8) and (13); all variables in the remainder of
thissectionwillthereforebefinite-dimensional. Thisoptimizationproblemischallenging,foritrequirescomputing
thegradientsofdependentvariablesandderivedquantitieswithrespecttotheneuralnetworkparameters 𝜃. Anaïve
approach would attempt to evaluate
∇𝜃𝐽=𝜕𝜌
𝜕𝜃⊤𝜕𝐽
𝜕𝜌+𝜕𝑢
𝜕𝜃⊤𝜕𝐽
𝜕𝑢+𝜕𝑇
𝜕𝜃⊤𝜕𝐽
𝜕𝑇=𝜕u𝑝
𝜕𝜃⊤𝜕𝐽
𝜕u𝑝(14)
on the discrete computational mesh. The partial derivatives 𝜕u𝑝/𝜕𝜃∈R3𝑛𝑥×𝑛𝜃could be evaluated by deriving and
solving PDEs for each 𝜕u/𝜕𝜃𝑖, where𝑖=1,...,𝑛𝜃, or by introducing finite-difference perturbations 𝜃𝑖+𝜃′
𝑖. However,
the number of neural network parameters 𝑛𝜃is often large (e.g.,∼105parameters), such that both of these approaches
would require an intractable number of calculations.
Instead,for𝑛forwardequations, 𝑛adjointequationsmaybesolvedtoprovidethenecessarygradients. Thusthe
overallcostwillnotbesignificantlyhigherforoptimizationthanforprediction. Toderivetheadjointequationsfora
7steady problem, note that
∇𝜃F𝑥=𝜕F𝑥
𝜕u𝑝𝜕u𝑝
𝜕𝜃+𝜕F𝑥
𝜕𝜃=0, (15)
where F𝑥is the discrete representation of the right-hand side (RHS)𝜕
𝜕𝑥(F𝑑−F𝑐).
Let us now introduce the adjoint variables ˆu=[ˆ𝜌,ˆ𝑢,ˆ𝑇]⊤, which satisfy the adjoint equation
𝜕𝐽
𝜕u𝑝+𝜕F𝑥
𝜕u𝑝⊤
ˆu=0, (16)
with Dirichlet boundary conditions (ˆ𝜌,ˆ𝑢,ˆ𝑇)=0at𝑥=±∞. Multiplying (15) by ˆu⊤produces
0=ˆu⊤𝜕F𝑥
𝜕u𝑝𝜕u𝑝
𝜕𝜃+ˆu⊤𝜕F𝑥
𝜕𝜃. (17)
From (16), we have that ˆu⊤𝜕F𝑥
𝜕u𝑝=−𝜕𝐽
𝜕u𝑝⊤which, when substituted into (17), yields
𝜕𝐽
𝜕u𝑝⊤𝜕u𝑝
𝜕𝜃=ˆu⊤𝜕F𝑥
𝜕𝜃. (18)
The relationship (18) combined with (14) provides a formula for the gradient in terms of the adjoint solution:
∇𝜃𝐽=𝜕F𝑥
𝜕𝜃⊤
ˆu. (19)
Therefore, we can solve the adjoint equation (16) for ˆuand use its solution to evaluate the gradient of the loss function
with respect to the model parameters ( ∇𝜃𝐽) using(19). The dimension of (16)is equal to the dimension of the forward
equations (8), so the overall optimization is not significantly greater than the cost of solving the forward equations. It is
important to note that the validity of (19)is contingent on the right-hand side of (15)being zero. In turn, this requires
that the discrete residual of the forward equations is close to zero before taking an optimization step.
Thediscreteadjointequationsaresolvedasalinearsystem. ThisrequiresthecomputationoftheJacobian 𝜕F𝑥/𝜕u𝑝,
which is calculated using algorithmic differentiation as provided by the PyTorchlibrary [62]. After converging the
forward and adjoint equations, gradient-descent steps are taken for parameters 𝜃(𝑘)according to
𝜃(𝑘+1)=𝜃(𝑘)−𝛼(𝑘)∇𝜃𝐽(𝜃(𝑘)), (20)
where𝛼(𝑘)isthelearningrateattheiteration 𝑘∈{0,1,...,𝑁 iter},where𝑁iteristhemaximumnumberofoptimization
iterations. The learning-rate schedule and other model-training hyperparameters are described in Section IV.D.
C. Entropy Constraints
UsingDLclosuresunconstrainedforthesecondlawofthermodynamicscanresultinunphysicalflowquantities.
WeconstraintheoutputsoftheneuralnetworkstosatisfythesecondlawofthermodynamicsusingtheClausius–Duhem
inequality [63],
¤I=−1
𝑇2q(U;𝜃)∇𝑇+1
𝑇𝜎(U;𝜃):∇u𝑇≥0, (21)
where¤Iistherateofirreversibleentropyproduction. A“strong”formoftheentropyconstraintwouldimposeconditions
onthemodeloutputssuchthat(21)isnonnegative. ForApproachA(transport-coefficientcorrections),ensuringthe
positivity of 𝜇(U;𝜃)and𝜆(U;𝜃)is sufficient; this is done using an ELU output layer as described in Section IV. A
“weak”constraintfortheentropyinequalitywouldincorporate ¤Iasapenaltyterminthetraininglossfunction (13). The
application of strong and weak constraints for Approach B (transport-term augmentation) is now discussed separately.
1. Strong Entropy Constraint
The Clausius–Duhem inequality (21) can be rearranged to give
1
𝑇𝜎(U;𝜃):∇u𝑇≥−1
𝑇2q(U;𝜃)∇𝑇, (22)
8from which a constraint on the viscous stress may be obtained:
𝜎(U;𝜃)≥1
𝑇q(U;𝜃)∇𝑇
∇u𝑇. (23)
A constrained viscous-stress model is therefore
˜𝜎(U;𝜃)=max(𝜎(U;𝜃),N), (24)
where
N=1
𝑇q(U;𝜃)∇𝑇
∇u𝑇, (25)
andthemax()functionin (24)isappliedinapointwisemanner. Afterapplying (24),theconstrainedclosureterms q(𝜃)
and˜𝜎(𝜃)are substituted into the governing equations. This enforcement of the strong entropy condition makes no
assumptions about the signs of ∇𝑇and∇𝑢.
For 1D flows, the Approach B closures (5) can be simplified to
𝜎(U;𝜃)=4
3𝜇𝜕𝑢
𝜕𝑥−𝑓1(U𝑥;𝜃)
q(U;𝜃)=−𝜆𝜕𝑇
𝜕𝑥−𝑓2(U𝑥;𝜃),(26)
and the Clausius-Duhem inequality (21) reduces to
¤I=−1
𝑇2q(U;𝜃)𝜕𝑇
𝜕𝑥+1
𝑇𝜎(U;𝜃)𝜕𝑢
𝜕𝑥≥0. (27)
The term N(25) reduces to
N=1
𝑇q(U;𝜃)𝜕𝑇
𝜕𝑥
𝜕𝑢
𝜕𝑥, (28)
and the strong entropy constraint can be enforced according to (24).
2. Weak Entropy Constraint
A weak entropy constraint would penalize the violation of the entropy inequality (21)during the constrained
optimization process by adding an extra term to the training loss function (13),
𝐽𝑠(𝜃)=𝑊𝑠∫∞
−∞[min(0, 𝑓1(U𝑥;𝜃))+min(0, 𝑓2(U𝑥;𝜃))]𝑑x, (29)
where𝑊𝑠is a scalar weight. The net training loss for the weak entropy constraint is thus
𝐽𝑤(u𝑝;𝜃)=𝐽(u𝑝(𝜃))+𝐽𝑠(u𝑝(𝜃)). (30)
Therequirementtosimultaneouslyminimizebothcomponentsof 𝐽𝑤preventedweak-constraintcasesfrommatching
the testing and training accuracy of equivalent strong-constraint cases. This could be improved by dynamic selection of
𝑊𝑠, for example, to enforce the 𝐽𝑠term more strongly in regions of high entropy production.
D. Model Training
Adistributedtrainingapproachwasimplementedtoperformtheonlineadjointoptimization. ForeachofApproaches
A and B, models were trained for four different training regimens: three models targeted only a single freestream
Mach number ( 𝑀train=2,𝑀train=5, and𝑀train=8), and one model targeted three Mach numbers simultaneously:
𝑀train=(2,5,8). Training this combined model utilized message-passing interface (MPI) parallelization to average the
loss-function gradients ∇𝜃𝐽between the component simulations before optimizing.
Table 1 provides the training/testing regimenmatrix. Freestream Mach numbers 𝑀∞=2,5,8were out-of-sample
whennotincludedinamodel’strainingregimen. FreestreamMachnumbers 𝑀∞=3,6,9,10wereout-of-samplefor
9Training 𝑀∞=2𝑀∞=3𝑀∞=5𝑀∞=6𝑀∞=8𝑀∞=9𝑀∞=10
𝑀train=2•
𝑀train=5 •
𝑀train=8 •
𝑀train=(2,5,8) • • •
Testing◦ • ◦ • ◦ • •
Table 1 Model training and testing matrix. 𝑀∞=2,5,8(◦) were out-of-sample when not used for training.
𝑀∞=3,6,9,10(•) were out-of-sample for all models.
all trained models. This testing arrangement is designed to evaluate the stability and accuracy of the trained models for
interpolation ( 𝑀train=(2,5,8)only) and extrapolation to lower and higher Mach numbers.
Initial Navier–Stokes viscous-shock solutions for each freestream Mach number listed in Table 1 were obtained
by converging from the corresponding inviscid-shock profile. Training and testing cases were initialized from the
convergedNavier–Stokessolutions. Formodeltraining, theparametersofrandomly-initializedneuralnetworkswere
selectedusing (20)withinitiallearningrate 𝛼(0)=2.5×10−6. Toensureconvergence,thelearningratewasreduced
using an adaptive schedule:
𝛼=(
𝛼, 𝜖 rel>𝜖𝑇
0.75𝛼, 𝜖 rel≤𝜖𝑇, 𝜖𝑇=(
𝜖𝑇, 𝜖 rel>𝜖𝑇
0.75𝜖𝑇, 𝜖 rel≤𝜖𝑇,
where𝜖rel=𝐽(𝜃)/𝐽0is the objective-function relative error, 𝐽0is the initial value of the objective function (i.e., for the
initial, unmodified Navier–Stokes solution), and the starting target error is 𝜖𝑇=0.9. For models trained simultaneously
for𝑀train=(2,5,8), the minimum 𝛼and𝜖𝑇were synchronized between training cases. The training process was
stopped forchange inrelative error 𝜖relless than 1×10−5between successiveiterations. Algorithm 1summarizes the
training process used for all training regimens.
Algorithm 1 Training process
1:Restart Ufrom unmodified Navier–Stokes solution
2:Randomly initialize DL network parameters 𝜃0
3:Calculate loss of unmodified solution 𝐽0
4:Set𝜖0
rel=1.0
5:whileΔ𝜖𝑛
rel≥10−5do
6:Converge solution to steady-state using damped Newton solver III.C
7:Solve adjoint equation (16) for ˆu
8:Compute∇𝜃𝐽(u𝑝(𝜃𝑛))using (19)
9:Update parameters 𝜃using gradient descent (20)
10:Calculate𝜖𝑛+1
rel
11:ComputeΔ𝜖𝑛+1
rel=𝜖𝑛+1
rel−𝜖𝑛
rel
12:end while
Table 2 shows the total number of optimization iterations and the average number of Newton iterations per
optimization iteration for all models. For all training cases, the relative tolerance of the forward Newton solver was
1×10−15beforeproceedingtooptimization. ForbothApproachAandApproachB,thehigherMachnumbercases
required more Newton iterations per optimization iteration. Approach A resulted in better training accuracy (lower 𝜖rel)
for most training cases.
10Training 𝑁opt
iter𝑁Newt
iter𝜖rel
Approach A
𝑀train=2 21 8 5.333×10−2
𝑀train=5 19 20 1.774×10−2
𝑀train=8 21 35 1.069×10−2
𝑀train=(2,5,8)(100, 100, 100) (9, 36, 17) ( 6.715×10−1,9.487×10−2,6.099×10−2)
Approach B
𝑀train=2 46 9 2.876×10−2
𝑀train=5 37 19 4.855×10−2
𝑀train=8 22 41 7.334×10−2
𝑀train=(2,5,8)(100, 100, 100) (6, 22, 33) ( 4.264×10−1,7.516×10−2,5.397×10−2)
Table2 Numberofoptimizationiterations, 𝑁opt
iter,averagenumberofNewtoniterationsperoptimizationiteration
𝑁Newt
iter, and training loss (objective-function relative error 𝜖rel) for Approaches A and B. For 𝑀train=(2,5,8), the
training loss is listed separately for the three target Mach numbers.
V. Results and Analysis
A. Shock Predictions
Out-of-sampleresultswereobtainedforthetestingcaseslistedinTable1. Withoutaclosuremodel,theNavier–Stokes
equations give qualitatively incorrect predictions for all training and testing cases. Figures 2 and 3 (Approaches A and
B, respectively) show the computed density from the unmodified Navier–Stokes equations, the Navier–Stokes solutions
with the trained neural networks, and the target DSMC solutions for 𝑀∞∈[2,10]. The neural network-augmented
Navier–Stokes solutions more closely match the target data for all cases and models. As could be anticipated from the
training loss (Table 2), the DL-augmented Navier–Stokes agreement with the DSMC data is qualitatively better for
lowerMachnumbersandforMachnumbersclosertoeachmodel’strainingconditions. Itisalsonoteworthythat,for
both approaches, the models trained on higher Mach numbers extrapolate better to lower Mach numbers. Similar trends
were obtained for the pressure, temperature, and velocity fields.
B. Prediction Accuracy
Figure 4 shows the relative loss-function error as a function of the testing Mach number. This represents the
integrated error of the primitive variables over the entire domain and can be interpreted as a worst-case assessment of a
model’s performance. All models trained for a single Mach number using Approach A perform better (lower 𝜖rel) than
thecorrespondingmodelsusingtheApproachB.ForApproachB,themodeltrainedfor 𝑀train=2isgenerallymore
accurate at lower than higher testing Mach numbers, and the model trained for 𝑀train=8is generally more accurate at
higherthanlowertestingMachnumbers,ascouldbeanticipated. TheApproachBmodeltrainedsimultaneouslyfor
𝑀train=(2,5,8)is reasonably accurate across the range of testing Mach numbers, with comparable accuracy to the
in-sample Mach 2, 5, and 8 models, though its extrapolation accuracy diminishes at 𝑀∞=9,10. Interestingly, the
single-case𝑀train=8modelreachedthebestin-samplelocalminimumandgavethelowestrelativeerrorsforlower
testing Mach numbers. This model is also reasonably accurate for higher testing Mach numbers.
The extrapolation trends of Approach A are similar to those of Approach B. The model trained for 𝑀train=8
extrapolateswelltolowerMachnumbercases,withcomparableaccuracytothe 𝑀train=2case. However,themodel
trainedsimultaneouslyfor 𝑀train=(2,5,8)performspoorlyforthiscasewitherrorshigherthanallothermodelsfor
almostallMachnumbers. Themodeltrainedsimultaneouslyforfor 𝑀train=(2,5,8)isreasonablyaccuratefor 𝑀∞=2
through 8 but has increased errors when extrapolating to the higher 𝑀∞=9and 10.
11−20−15−10−5 0 5 10
x(mm)1.001.251.501.752.002.252.50Densityρ(kg/m3)×10−4
M∞= 2Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.0Densityρ(kg/m3)×10−4
M∞= 3Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.5Densityρ(kg/m3)×10−4
M∞= 5Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 6Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 8Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 10Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMCFig.2 ApproachA:In-andout-of-samplefreestreamdensitypredictions. Resultsareshownfortheunmodified
Navier–Stokes equations, the Navier–Stokes equations with DL models for Approach A trained for 𝑀=2,𝑀=5,
𝑀=8, and𝑀=(2,5,8), and the DSMC target data. The 𝑀=3,𝑀=6, and𝑀=10cases are out-of-sample for
all trained DL models.
12−20−15−10−5 0 5 10
x(mm)1.001.251.501.752.002.252.50Densityρ(kg/m3)×10−4
M∞= 2Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.0Densityρ(kg/m3)×10−4
M∞= 3Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.5Densityρ(kg/m3)×10−4
M∞= 5Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 6Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 8Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMC
−20−15−10−5 0 5 10
x(mm)1.01.52.02.53.03.54.0Densityρ(kg/m3)×10−4
M∞= 10Navier–Stokes
Mtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
DSMCFig.3 ApproachB:In-andout-of-samplefreestreamdensitypredictions. Resultsareshownfortheunmodified
Navier–Stokes equations, the Navier–Stokes equations with DL models for Approach B trained for 𝑀=2,𝑀=5,
𝑀=8, and𝑀=(2,5,8), and the DSMC target data. The 𝑀=3,𝑀=6, and𝑀=10cases are out-of-sample for
all trained DL models.
132 4 6 8 10
TestM∞0.000.050.100.150.200.250.30/epsilon1rel
Approach AMtrain= 2
Mtrain= 5
Mtrain= 8
Mtrain= 2,5,8
2 4 6 8 10
TestM∞0.000.050.100.150.200.250.30/epsilon1rel
Approach BFig. 4 In- and out-of-sample objective-function relative error for the four DL models trained for Approach
A(left)andApproachB(right). In-samplecasesforeachmodelareindicatedbyredcircles. Theunmodified
Navier–Stokes solution has 𝜖rel=1.0.
C. Shock Thickness
The shock thickness is evaluated using the maximum density gradient,
𝛿=max(𝜌)−min(𝜌)
max(𝜕𝜌/𝜕𝑥). (31)
Figure 5 plots the inverse shock thickness normalized by the mean free path [44],
𝜆∞=16
5𝛾
2𝜋1
2𝜇0
𝜌∞𝑎∞, (32)
where𝑎∞is the freestream speed of sound and 𝜆∞=1.098mm for the temperature and pressure conditions considered
here[44]. AsshowninFig.5,alloftheDLmodelsimprovetheNavier–Stokespredictions’accuracyovertheunmodified
continuumsolutions, whichoverpredicttheshock thicknessforallfreestreamMachnumbersatthisverylow freestream
density. ThemodelstrainedforApproachAaregenerallymoreaccuratethanthosetrainedforApproachB,whichis
counterintuitive, as one would expect the greater modeling flexibility of Approach B to result in higher overall accuracy,
though this is generally consistent with the 𝜖reltrends (Fig. 4). The accuracy reduction for Approach B is likely due to
inconsistencies in the Clausius–Duhem inequality when applied as a constraint for subcontinuum flows. Conversely, for
ApproachA,thesimplepositivityconstrainton 𝜇and𝑘isastricterrequirementbutdoesnotnecessarilyrequirethe
validity of the Chapman–Enskog expansion of the Boltzmann equation. For both Approaches A and B, the models
trainedsimultaneouslyfor 𝑀train=(2,5,8)isreasonablyaccurateforshock-thicknesspredictions,especiallyattheir
in-sampleconditions. TheApproachAmodeltrainedfor 𝑀train=8givesthemostaccurateinverseshockthickness
predictions over the entire range of testing Mach numbers and is used for subsequent comparisons.
Figure 6 compares the shock-thickness predictions of the Approach A, 𝑀train=8model to the DSMC targets
andexperimentaldata[ 44,52–55]. TheDLmodelfollowstheDSMCtrendstowithintheexperimentaluncertainty.
Additionally,Fig.6extendsthetestingrangebelow 𝑀∞=2,atwhichconditionstheDL-augmentedNavier–Stokes,
unmodified Navier–Stokes, DSMC, and experimental data converge.
D. Shock Profile Asymmetry
Asecondderivedquantity,whichprovidesabetterassessmentoftheoverallshape,isthedensityasymmetryquotient
𝑄𝑝=∫0
−∞𝜌∗𝑑𝑥
∫∞
0[1−𝜌∗]𝑑𝑥, (33)
where𝜌∗is the normalized density, the maximum gradient of which is centered at 𝑥=0. The asymmetry quotient
measures the skewness of a shock density profile relative to its midpoint; a perfectly symmetric profile has 𝑄𝑝=1.
142 4 6 8 10
TestM∞0.00.10.20.30.40.50.60.7λ∞/δ
Approach AMtrain= 2
Mtrain= 5
Mtrain= 8Mtrain= 2,5,8
DSMC
N-S (no model)
2 4 6 8 10
TestM∞0.00.10.20.30.40.50.60.7λ∞/δ
Approach BFig.5 Predictedinverseshockthicknessfromtheunmodified(no-model)Navier–Stokesequations,theaugmented
NS equations for the four DL models, and the DSMC target data for Approach A (left) and Approach B (right).
2 4 6 8 10
TestM∞0.00.10.20.30.40.50.60.7λ∞/δ
Mtrain= 8
DSMCN-S (no model)
Experimental
Fig. 6 Experimental data from [ 44,52–55] compared to predicted inverse shock thickness from the unmodified
(no-model)Navier–Stokesequations,theaugmentedNSequationsfor 𝑀train=(2,5,8)usingApproachA,and
the DSMC target data.
152 4 6 8 10
TestM∞0.91.01.11.21.31.4Qp
N-S (no model)
Mtrain= 8
DSMC
ExperimentalFig. 7 Predicted density asymmetry quotient for the unmodified (no-model) Navier–Stokes equations, the
augmentedNavier–StokesequationswiththeApproachAclosuretrainedfor 𝑀train=8,theDSMCtargetdata,
and experimental data [44].
Testing𝑀∞
2 3 4 5 6 7 8 9 10
𝑁opt
iter=1000.026 0.071 0.117 0.148 0.156 0.199 0.199 0.205 0.250
𝑁opt
iter=3000.037 0.066 0.115 0.137 0.135 0.180 0.231 0.266 0.297
Table3 Objective-functionrelativeerror 𝜖relfor𝑁opt
iter=40and𝑁opt
iter=300. ShownfortheApproachAmodel
trained for𝑀train=(2,5,8).
Figure 7 compares the computed 𝑄𝑝using the unmodified Navier–Stokes equations, the Approach A model
trained for𝑀train=8, the DSMC target data, and published experimental data [ 44]. The experimental data shows
downstream-skewedshocks( 𝑄𝑝<1)forfreestreamMachnumberslessthan2.5andupstream-skewedshocks( 𝑄𝑝>1)
for higher Mach numbers, while the unmodified Navier–Stokes equations predict upstream-skewed shocks for all Mach
numbers. The DSMC target profiles capture the overall experimental trends but lie between the experimental and
unmodified Navier–Stokes profiles; this is consistent with other DSMC results using the VHS model [ 64–67]. The DL
model leads to skewnesses reasonably close to the target DSMC profiles near the training 𝑀train=8condition, though
these are still qualitatively different from the experimental measurements at higher Mach numbers.
E. Training Convergence
The convergence of 𝜖relwith the number of optimization iterations is shown in Fig. 8 for the Approach A model
trained simultaneously for 𝑀train=(2,5,8). A model trained for 𝑁opt
iter=100iterations was used for the preceding tests,
as it had the lowest total 𝜖relbetween the three training Mach numbers. It can be seen that, as the model was trained for
more iterations, its predictions became more accurate for the intermediate 𝑀∞=5and less accurate for 𝑀∞=2and 8.
The testing errors of this model for all testing Mach numbers are listed in Table 3 for 𝑁opt
iter=100and𝑁opt
iter=300. It
is evident that the prediction error for the longer-trained model is significantly higher for Mach numbers away from
𝑀∞=5, while interpolation to Mach numbers close to it are marginally lower. This is possibly evidence of the model
overfitting to 𝑀∞=5.
16101102
Nopt
iter10−210−1100/epsilon1rel
M∞=2
M∞=5
M∞=8
101102
Nopt
iter10−210−1100Σ/epsilon1relFig. 8 Convergence of 𝜖rel(left) and the sum of 𝜖relfor the three training Mach numbers (right) as a function of
the number of optimization iterations 𝑁opt
iterusing Approach A, for the training regimen 𝑀train=(2,5,8). The
trained model at 𝑁opt
iter=100() is used for in- and out-of-sample prediction.
F. Physical Interpretation of the Closure
Figures9and10forApproachesAandB,respectively,comparetheDLclosuremodelstotheunmodifiedcontinuum
closures and the corresponding closures integrated from the DSMC data [ 68]. Approaches A and B modify the viscous
stressand heatflux tosimilarextents relativeto thestandardcontinuum modelsinthe vicinityof theshockand arein
excellentagreementwiththeDSMCprofiles,particularlyupstreamandinthevicinityoftheshock. Overall,thestandard
modelsunderpredictmoleculartransportatthesenonequilibriumconditions,especiallythepost-shockmagnitudeof
thetransporttermsathigherfreestreamMachnumbers. Neartheshock,theDLclosuremodelsandDSMCprofiles
haveclosemagnitudesandarespatiallymorediffusethanthestandardcontinuummodels. Thisisconsistentwiththe
resulting steeper shock profiles (Fig. 6).
Fig. 9, for ApproachA, shows that the modified heat-fluxand viscous-stress terms have the same slopeaway from
theshock astheDSMCterms, unlikeforApproachB. Thisisnotsurprising, asApproachBaugments thecontinuum
closureswithnonlineartermswhich,arefunctionsofthe(nearlyzero)flowgradientsawayfromtheshock. Significantly,
theDL-predictedprofilesfor 𝜎andqdiffer,whichreflectsthefactthatviscosityandthermalconductivityarecontinuum
manifestations of different sub-continuum processes. Conversely, the temperature-dependent models have the same
functional form (7)with only slightly different coefficients. (Indeed, a common approximation for 𝜆(𝑇)is based upon
multiplying𝜇(𝑇)by a constant Prandtl number.) This modeling choice renders the standard models unable to account
for the differing degrees of momentum and thermal diffusion at transition-continuum conditions. The Approach A
and B models have comparable maxima to the DSMC profiles, but the Approach B models generally underpredict
𝜎andqdownstream of the shock, which is consistent with their relatively inaccurate shock-thickness predictions.
Furthermore, for both Approaches A and B, the modeled 𝜏andqare more asymmetric (upstream-skewed) than the
DSMC, particularly for high Mach numbers, which leads to asymmetry quotients 𝑄𝑝>1(see Fig. 7).
ApproachA (4)modifiestheviscosityandthermalconductivity;itisthereforeinstructivetoconsidertheformof
the model. Fig. 11 compares the Approach A closures for 𝜇(U;𝜃)and𝜆(U;𝜃)(3), evaluated using the neural network
trainedfor𝑀train=(2,5,8),tothestandard,temperature-dependentmodels (7)fortherangeofin-andout-of-sample
testing Mach numbers. The differences between the two models are pronounced at higher 𝑀∞and both models predict
significantly higher maximum values than the temperature-dependent models. It is also evident that downstream of
theshock,theDLmodelpredictedtransportcoefficientsalmostexactlymatchtemperaturedependentmodels,thusit
accurately recovers continuum behavior away from the shock.
ThegeneraltrendscapturedbytheDLmodelscouldbeincorporatedintoalgebraicmodelssimilarto (7),which
would enable computationally efficient predictions on a wide range of out-of-sample Mach numbers and geometric
configurations,evenwithhigherdimensionalitythanthepresentshockconfigurations. Thisismoreprobableforsimpler
models, such as our Approach A, that interact only with a scalar coefficient, and so could be more portable to different
dimensionalities, flowgeometries, and/oralignments ofkeyfeatures (e.g.,shocks) withthe computationalmesh. The
more complicatedmodels thatintroduce vector/tensormodifications, suchas ApproachB, aremore likelyto trainin a
17−6−4−2 0 2 4 6
x(mm)10−210−1100101102|σ| M∞= 3
M∞= 5
M∞= 9
DL Model
Unmodiﬁed
DSMC
−6−4−2 0 2 4 6
x(mm)100101102103104105106|q| M∞= 3
M∞= 5
M∞= 9
DL Model
Unmodiﬁed
DSMCFig.9 DL-modeledviscousstressandheatflux( )forApproachAversusthestandardcontinuummodels
(). Shown for the Approach A DL model trained for 𝑀train=8.
−6−4−2 0 2 4 6
x(mm)10−210−1100101102|σ| M∞= 3
M∞= 5
M∞= 9
DL Model
Unmodiﬁed
DSMC
−6−4−2 0 2 4 6
x(mm)100101102103104105106|q| M∞= 3
M∞= 5
M∞= 9
DL Model
Unmodiﬁed
DSMC
Fig.10 DL-modeledviscousstressandheatflux( )forApproachBversusthestandardcontinuummodels
(). Shown for the Approach B DL model trained for 𝑀train=8.
−20−15−10−5 0 5 10
x(mm)0.00.51.01.52.0µ/µ 0×101
M∞=2
M∞=3
M∞=5
M∞=8
M∞=9
DL Model
µ=µ(T)
µ=µ0
−20−15−10−5 0 5 10
x(mm)0.00.51.01.52.02.53.0λ/λ 0×101
M∞=2
M∞=3
M∞=5
M∞=8
M∞=9
DL Model
λ=λ(T)
λ=λ0
Fig.11 DL-modeledviscosityandthermal conductivity( ; Eq.3)versusstandardtemperature-dependent
models ( ; Eq. 7). Shown for the Approach A (4)DL model trained for 𝑀train=8.
18geometry-specific manner and likely require re-training for new geometries. The development and validity of more
generally applicable models, as well as the extrapolability of trained models to different freestream thermodynamic
conditions and gas compositions, will be the subject of future work.
VI. Conclusion
Thispaperpresentsanadjoint-baseddeeplearningaugmentationmethodtoextendthevalidityofthecontinuum
flow equations to the transition-continuum regime. Two modeling approaches are compared: Approach A modifies
onlytheviscosityandthermalconductivity,whileApproachBdirectlyaugmentsthecontinuumdiffusivefluxeswith
corrective neural networks. These modeling approaches have less flexibility than outright replacement of the fluxes but
weremorestableduringoptimization. ModeltrainingisperformedbyoptimizingovertheNavier–Stokesequations
while targeting trusted flow data from DSMC solutions of the Boltzmann equation.
An online adjoint optimization method enables this PDE-constrained optimization to be performed efficiently. The
trainedmodelsimprovetheaccuracyofNavier–Stokespredictionsinthisregimeandexhibitstabilityandextrapolability
forMachnumbershigherandlowerthanthoseusedfortraining,withconcomitantreductionofaccuracywhenused
far out-of-sample (although still not of lower accuracy than that of the unmodified Navier–Stokes equations). Models
trained using Approach A have marginally better accuracy compared to models trained using Approach B, and part
ofApproachA’ssuccessmaybeattributedtothedistinctionsitidentifiesbetweenthedifferenttransport-coefficient
profilesandtheirdifferentgrowthtrendswithrespecttotheupstreamMachnumber. Thisresultsindifferentprofiles for
the DL-predicted viscous-stress and heat-flux closures.
Entropyconstraintsensurethatthelearnedclosuremodelssatisfythesecondlawofthermodynamics. Thestrong
entropy constraint, which poses an algebraic constraint on the output of the DL model, resulted in stable, accurate
predictions over the range of testing Mach numbers. The weak entropy constraint, which penalizes the violation of the
entropyinequalityintheoptimizationlossfunction,isattractiveforitsflexibilitybutwaslessstableextrapolatingto
higherMachnumbers. Furtherstudyoftheweightingfactorfortheentropyviolationtermisnecessarytorealizethe
full potential of the weak entropy condition.
Notably,thelossfunctionfortheonlineadjointoptimizationcanbearbitrarilydefined,canincludeflowvariables
(thePDEsolutionorderivedquantities),anddoesnotneedtoexplicitlyincludetheunclosedterm(s). Thisisincontrast
toa prioritraining, which conforms the model directly to the unclosed terms. The success of the online adjoint method
with “third-party” DSMC target data (i.e., not directly obtained from the flow PDEs) is striking, though not unexpected,
given the success of adjoint-based methods for aerodynamic shape design and turbulence modeling, among others. One
hope is that this method will enable model development against experimental target data with comparable stability and
accuracy, though this remains to be tested. Alternatively, or in addition, the loss function for the flow model can target
derived orintegral quantities thatare functionsof the flowvariables, such asthe shock thicknessor, for wall-bounded
flows, the boundary layer thickness and drag coefficient.
Futureworkwillfocusonextendingthecurrentmodeltomore-complexgeometricscenarios(2Dobliqueandcurved
shocks, 3D shocks) and flows with additional physical complexity (nonmonatomic gases, reacting flows). Particularly
useful for cases with additional physical complexity, the adjoint-based DL approach can account for multiple, coupled
constitutive models simultaneously, which would enable, for example, coupling the transport coefficients with the
chemical kinetics.
Acknowledgments
The authors would like to thank Prof. Iain Boyd for sharing his DSMC solver. This work was supported by the
OfficeofNavalResearchunderawardN00014-22-1-2441. TheresearchofM.P.issupportedbytheVannevarBush
FacultyFellowship. TheauthorsacknowledgecomputationaltimeonresourcessupportedbytheUniversityofNotre
Dame Center for Research Computing (CRC).
References
[1]Paolucci, S., and Paolucci, C., “A second-order continuum theory of fluids,” Journal of Fluid Mechanics , Vol. 846, No. 22,
2018, p. 686–710. https://doi.org/10.1017/jfm.2018.291.
[2]Bird, G. A., “Approach to translational equilibrium in a rigid sphere gas,” Physics of Fluids , Vol. 6, 1963, p. 1518.
https://doi.org/10.1063/1.1710976.
19[3]Bird, G. A., “Direct simulation of the Boltzmann equation,” Physics of Fluids , Vol. 13, 1970, p. 2676–2681. https:
//doi.org/10.1063/1.1692849.
[4]Boyd, I. D., “Modeling of associative ionization reactions in hypersonic rarefied flows,” Physics of Fluids , Vol. 19, No. 9, 2007,
p. 096102. https://doi.org/10.1063/1.2771662.
[5]Boyd, I. D., “Computation of Hypersonic Flows Using the Direct Simulation Monte Carlo Method,” Journal of Spacecraft and
Rockets, Vol. 52, No. 1, 2015, pp. 38–53. https://doi.org/10.2514/1.A32767.
[6] Chapman, S., and Cowling, T. G., The Mathematical Theory of Non-Uniform Gases , Cambridge University Press, 1970.
[7] Ferziger, J. H., and Kaper, H. G., Mathematical Theory of Transport Processes in Gases , Elsevier Science Publishing, 1976.
[8]Levermore, C. D., “Moment closure hierarchies for kinetic theories,” Journal of Statistical Physics , Vol. 83, No. 5-6, 1996, pp.
1021–1065. https://doi.org/10.1007/BF02179552.
[9]Agarwal, R. K., Yun, K.-Y., and Balakrishnan, R., “Beyond Navier–Stokes: Burnett equations for flows in the continuum
transition regime,” Physics of Fluids , Vol. 13, 2001, p. 3061–3085. https://doi.org/10.1063/1.1397256.
[10] Woods, L. C., An introduction to the kinetic theory of gases and magnetoplasmas , Oxford University Press, 1993.
[11]Grad, H., “On the kinetic theory of rarefied gases,” Communications on Pure and Applied Mathematics , Vol. 2, No. 4, 1949, p.
331–407. https://doi.org/10.1002/cpa.3160020403.
[12]Grad, H., “The profile of a steady plane shock wave,” Communications on Pure and Applied Mathematics , Vol. 5, No. 3, 1952,
p. 257–300. https://doi.org/10.1002/cpa.3160050304.
[13]Jin, S., and Slemrod, M., “Regularization of the Burnett equations via relaxation,” Journal of Statistical Physics , Vol. 103, No.
5-6, 2001, p. 1009–1033. https://doi.org/10.1023/A:1010365123288.
[14]Struchtrup, H., and Torrilhin, M., “Regularization of Grad’s 13 moment equations: derivation and linear analysis,” Physics of
Fluids, Vol. 15, No. 9, 2003, p. 2668–2680. https://doi.org/10.1063/1.1597472.
[15]Hash, D. B., and Hassan, H. A., “Assessment of schemes for coupling Monte Carlo and Navier-Stokes solution methods,”
Journal of Thermophysics and Heat Transfer , Vol. 10, No. 2, 1996, pp. 242–249. https://doi.org/10.2514/3.781.
[16]Aktas, O., and Aluru, N., “A Combined Continuum/DSMC Technique for Multiscale Analysis of Microfluidic Filters,” Journal
of Computational Physics , Vol. 178, No. 2, 2002, pp. 342–372. https://doi.org/10.1006/jcph.2002.7030.
[17]Panesi, M., Magin, T. E., Bourdon, A., Bultel, A., and Chazot, O., “Electronic Excitation of Atoms and Molecules
for the FIRE II Flight Experiment,” Journal of Thermophysics and Heat Transfer , Vol. 25, No. 3, 2011, pp. 361–374.
https://doi.org/10.2514/1.50033.
[18]Stephani, K., Goldstein, D., and Varghese, P., “Consistent treatment of transport properties for five-species air direct simulation
MonteCarlo/Navier-Stokesapplications,” PhysicsofFluids ,Vol.24,No.7,2012,p.077101. https://doi.org/10.1063/1.4729610.
[19]Stephani, K., Goldstein, D., and Varghese, P., “A non-equilibrium surface reservoir approach for hybrid DSMC/Navier–Stokes
particle generation,” Journal of Computational Physics , Vol. 232, No. 1, 2013, pp. 468–481. https://doi.org/10.1016/j.jcp.2012.
08.017.
[20]Schwartzentruber, T. E., and Boyd, I. D., “A hybrid particle-continuum method applied to shock waves,” Journal of
Computational Physics , Vol. 215, No. 2, 2006, pp. 402–416. https://doi.org/10.1016/j.jcp.2005.10.023.
[21]Schwartzentruber, T. E., Scalabrin, L. C., and Boyd, I. D., “Hybrid particle-continuum simulations of nonequilibrium
hypersonic blunt-body flowfields,” Journal of Thermophysics and Heat Transfer , Vol. 22, No. 1, 2008, pp. 29–37.
https://doi.org/10.2514/1.30216.
[22]Schwartzentruber,T.E.,Scalabrin,L.C.,andBoyd,I.D.,“Hybridparticle-continuumsimulationsofhypersonicflowovera
hollow-cylinder-flare geometry,” AIAA Journal , Vol. 46, No. 8, 2008, pp. 2086–2095. https://doi.org/10.2514/1.36681.
[23]Schwartzentruber,T.E.,Scalabrin,L.C.,andBoyd,I.D.,“Amodularparticle–continuumnumericalmethodforhypersonic
non-equilibriumgasflows,” JournalofComputationalPhysics ,Vol.225,No.1,2007,pp.1159–1174. https://doi.org/10.1016/j.
jcp.2007.01.022.
20[24]Burt,J.M.,andBoyd,I.D.,“Ahybridparticleapproachforcontinuumandrarefiedflowsimulation,” JournalofComputational
Physics, Vol. 228, No. 2, 2009, pp. 460–475. https://doi.org/10.1016/j.jcp.2008.09.022.
[25]Munafó, A., Torres, E., Haack, J., Gamba, I., and Magin, T., “Investigation of nonequilibrium effects across normal
shock waves by means of a spectral-Lagrangian Boltzmann solver,” 51st AIAA Aerospace Sciences Meeting , 2013, p. 0305.
https://doi.org/10.2514/6.2013-305.
[26]Brenner, M.P.,Eldredge, J.D., andFreund, J.B., “Perspectiveon machinelearning foradvancingfluid mechanics,” Physical
Review Fluids , Vol. 4, No. 10, 2019, p. 100501. https://doi.org/10.1103/PhysRevFluids.4.100501.
[27]Duraisamy, K., Iaccarino, G., and Xiao, H., “Turbulence modeling in the age of data,” Annual Review of Fluid Mechanics ,
Vol. 51, 2019, pp. 357–377. https://doi.org/10.1146/annurev-fluid-010518-040547.
[28]Duraisamy, K., “Perspectives on machine learning-augmented Reynolds-averaged and large eddy simulation models of
turbulence,” Physical Review Fluids , Vol. 6, No. 5, 2021, p. 050504. https://doi.org/10.1103/physrevfluids.6.050504.
[29]Karniadakis, G. E., Kevrekidis, I. G., Lu, L., Perdikaris, P., Wang, S., and Yang, L., “Physics-informed machine learning,”
Nature Reviews Physics , 2021, pp. 1–19. https://doi.org/10.1038/s42254-021-00314-5.
[30]Kochkov, D., Smith, J., Alieva, A., Wang, Q., Brenner, M., and Hoyer, S., “Machine learning-accelerated computational
fluid dynamics,” Proceedings of the National Academy of Sciences , Vol. 118, No. 21, 2021, p. 2101784118. https:
//doi.org/10.1073/pnas.2101784118.
[31]Ling, J., Jones, R., and Templeton, J., “Machine learning strategies for systems with invariance properties,” Journal of
Computational Physics , Vol. 318, 2016, pp. 22–35. https://doi.org/10.1016/j.jcp.2016.05.003.
[32]Wu, J.-L., Xiao, H., and Paterson, E., “Physics-informed machine learning approach for augmenting turbulence models: A
comprehensive framework,” Physical Review Fluids , Vol. 3, No. 7, 2018, p. 074602. https://doi.org/10.1103/PhysRevFluids.3.
074602.
[33]Beetham, S., Fox, R. O., and Capecelatro, J., “Sparse identification of multiphase turbulence closures for coupled fluid–particle
flows,”Journal of Fluid Mechanics , Vol. 914, 2021, p. A11. https://doi.org/10.1017/jfm.2021.53.
[34]Sirignano,J.,MacArt,J.F.,andFreund,J.B.,“DPM:AdeeplearningPDEaugmentationmethodwithapplicationtolarge-eddy
simulation,” Journal of Computational Physics , Vol. 423, 2020, p. 109811. https://doi.org/10.1016/j.jcp.2020.109811.
[35]Holland, J. R., Baeder, J. D., and Duraisamy, K., “Towards integrated field inversion and machine learning with embedded
neural networks for RANS modeling,” AIAA Scitech 2019 Forum , 2019, p. 1884. https://doi.org/10.2514/6.2019-1884.
[36]MacArt, J. F., Sirignano, J., and Freund, J. B., “Embedded training of neural-network subgrid-scale turbulence models,”
Physical Review Fluids , Vol. 6, 2021, p. 050502. https://doi.org/10.1103/physrevfluids.6.050502.
[37]Sirignano, J., and MacArt, J. F., “Deep Learning Closure Models for Large-Eddy Simulation of Flows Around Bluff Bodies,”
Journal of Fluid Mechanics , 2023 (accepted). https://doi.org/10.48550/arXiv.2208.03498.
[38]Sirignano, J., MacArt, J. F., and Spiliopoulos, K., “PDE-constrained models with neural network terms: Optimization and
global convergence,” Journal of Computational Physics , 2023, p. 112016. https://doi.org/10.1016/j.jcp.2023.112016.
[39]Blonigan, P. J., and Wang, Q., “Multiple shooting shadowing for sensitivity analysis of chaotic dynamical systems,” Journal of
Computational Physics , Vol. 354, 2018, pp. 447–475. https://doi.org/10.1016/j.jcp.2017.10.032.
[40]Ni, A., Wang, Q., Fernandez, P., and Talnikar, C., “Sensitivity analysis on chaotic dynamical systems by finite difference
non-intrusive least squares shadowing (FD-NILSS),” Journal of Computational Physics , Vol. 394, 2019, pp. 615–631.
https://doi.org/10.1016/j.jcp.2019.06.004.
[41]Taghizadeh, S., Witherden, F. D., and Girimaji, S. S., “Turbulence closure modeling with data-driven techniques: physical
compatibilityandconsistencyconsiderations,” NewJournalofPhysics ,Vol.22,No.9,2020, p.093023. https://doi.org/10.
1088/1367-2630/abadb3.
[42]Zhao,Y.,Akolekar,H.D.,Weatheritt,J.,Michelassi,V.,andSandberg,R.D.,“RANSturbulencemodeldevelopmentusing
CFD-drivenmachinelearning,” JournalofComputationalPhysics ,Vol.411,2020,p.109413. https://doi.org/10.1016/j.jcp.
2020.109413.
21[43]Liu, W., Fang, J., Rolfo, S., Moulinec, C., and Emerson, D. R., “An iterative machine-learning framework for RANS turbulence
modeling,” International Journal of Heat and Fluid Flow , Vol. 90, 2021, p. 108822. https://doi.org/10.1016/j.ĳheatfluidflow.
2021.108822.
[44]Alsmeyer,H.,“Densityprofilesinargonandnitrogenshockwavesmeasuredbytheabsorptionofanelectronbeam,” Journalof
Fluid Mechanics , Vol. 74, No. 3, 1976, pp. 497–513. https://doi.org/10.1017/S0022112076001912.
[45]Reese, J. M., Woods, L. C., Thivet, F. J. P., and Candel, S. M., “A second-order description of shock structure,” Journal of
Computational Physics , Vol. 117, No. 2, 1995, pp. 240–250. https://doi.org/10.1006/jcph.1995.1062.
[46]Lumpkin, F. E., and Chapman, D. R., “Accuracy of the Burnett equations for hypersonic real gas flows,” AIAA Journal , Vol. 6,
No. 3, 1992, pp. 419–425. https://doi.org/10.2514/3.377.
[47]Muckenfuss, C., “Some aspects of shock structure according to the bimodal mode,” Physics of Fluids , Vol. 5, No. 9, 1962, pp.
1325–1336. https://doi.org/10.1063/1.1706528.
[48]Levermore,C.D.,andMorokoff,W.J.,“TheGaussianmomentclosureforgasdynamics,” JournalofAppliedMathematics ,
Vol. 59, No. 1, 1998, pp. 72–96. https://doi.org/10.1137/S0036139996299236.
[49]Cercignani,C.,Frezzotti,A.,andGrosfils,P.,“Thestructureofaninfinitelystrongshockwave,” PhysicsofFluids ,Vol.11,
No. 9, 1994, pp. 2757–2764. https://doi.org/10.1063/1.870134.
[50]Myong,R.,“AComputationalMethodforEu’sGeneralizedHydrodynamicEquationsofRarefiedandMicroscaleGasdynamics,”
Journal of Computational Physics , Vol. 168, No. 1, 2001, pp. 47–72. https://doi.org/10.1006/jcph.2000.6678.
[51]Xu,K.,andTang,L.,“NonequilibriumBhatnagar–Gross–Krookmodelfornitrogenshockstructure,” PhysicsofFluids ,Vol.16,
No. 10, 2004, pp. 3824–3827. https://doi.org/10.1063/1.1783372.
[52]Linzer, M., and Hornig, D. F., “Structure of Shock Fronts in Argon and Nitrogen,” Physics of Fluids , Vol. 6, No. 12, 1963, pp.
1661–1668. https://doi.org/10.1063/1.1711007.
[53]Camac, M., “Argon and nitrogen shock thicknesses,” Proceedings of the Fourth International Symposium on Rarefied Gas
Dynamics , Vol. 1, 1965, p. 240. https://doi.org/10.2514/6.1964-35.
[54]Schmidt,B.,“Electronbeamdensitymeasurementsinshockwavesinargon,” JournalofFluidMechanics ,Vol.39,No.2,1969,
pp. 361–373. https://doi.org/10.1017/S0022112069002229.
[55]Garen, W., Synofzik, R., and Frohn, A., “Shock Tube for Generating Weak Shock Waves,” AIAA Journal , Vol. 12, No. 8, 1974,
pp. 1132–1134. https://doi.org/10.2514/3.49425.
[56]Poinsot, T. J., and Lele, S. K., “Boundary conditions for direct simulations of compressible viscous flows,” Journal of
Computational Physics , Vol. 101, No. 1, 1992, pp. 104–129. https://doi.org/10.1016/0021-9991(92)90046-2.
[57]Roe,P.L.,“Characteristic-basedschemesfortheEulerequations,” AnnualReviewofFluidMechanics ,Vol.18,No.1,1986,pp.
337–365. https://doi.org/10.1146/annurev.fluid.18.1.337.
[58]Boyd,I.D.,andSchwartzentruber,T.E., NonequilibriumGasDynamicsandMolecularSimulation ,CambridgeAerospace
Series, Cambridge University Press, 2017. https://doi.org/10.1017/9781139683494.
[59]Valentini,P.,andSchwartzentruber,T.E.,“Large-scalemoleculardynamicssimulationsofnormalshockwavesindiluteargon,”
Physics of Fluids , Vol. 21, No. 6, 2009, p. 066101. https://doi.org/10.1063/1.3149866.
[60]Wang, S., “Extensions to the Navier–Stokes equations,” Physics of Fluids , Vol. 34, No. 5, 2022, p. 053106. https:
//doi.org/10.1063/5.0087550.
[61]Sirignano,J.,andSpiliopoulos,K.,“OnlineAdjointMethodsforOptimizationofPDEs,” AppliedMathematicsandOptimization ,
2022, p. 18. https://doi.org/10.1007/s00245-022-09852-5.
[62]Steiner, B., DeVito, Z.,Chintala, S., Gross, S., Paszke, A., Massa, F., Lerer, A., Chanan, G., Lin, Z., Yang, E., Desmaison, A.,
Tejani, A., Kopf,A., Bradbury, J., Antiga, L., Raison,M., Gimelshein, N., Chilamkurthy, S., Killeen, T., Fang, L., and Bai, J.,
“PyTorch: An imperative style, high-performance deep learning library,” NeurIPS, 2019.
[63] Powers, J. M., Combustion Thermodynamics and Dynamics , Cambridge University Press, 2016.
22[64]Torrilhon, M., and Struchtrup, H., “Regularized 13-moment equations: shock structure calculations and comparison to Burnett
models,” Journal of Fluid Mechanics , Vol. 513, 2004, pp. 171–198. https://doi.org/10.1017/S0022112004009917.
[65]Bentley, B. I., “An Investigation of Shock Wave Physics via Hybrid CFD-BGK Solution Methods for Nonequilibrium Flows,”
Tech. rep., Air Force Inst. Tech., 2009.
[66]Bentley, B. I., and Greendyke, R., “Using the Unified Flow Solver to Investigate the Normal Shock Wave Structure,”
47th AIAA Aerospace Sciences Meeting including The New Horizons Forum and Aerospace Exposition , 2009, p. 1541.
https://doi.org/10.2514/6.2009-1541.
[67]Bentley, B. I., and Greendyke, R. B., “Shock Structure Solution by Hybrid Flowfield Methods,” Journal of Spacecraft and
Rockets, Vol. 49, No. 6, 2012, pp. 1058–1068. https://doi.org/10.2514/1.A32179.
[68] Vincenti, W. G., and Kruger, C. H., Introduction to Physical Gas Dynamics , New York, Wiley, 1965.
23