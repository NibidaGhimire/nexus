arXiv:2305.07776v1  [stat.AP]  12 May 2023Identifying World Events in Dynamic International
Relations Data Using a Latent Space Model
Yunran Chen and Alexander V olfovsky*
Department of Statistical Science, Duke University, USA
May 16, 2023
Abstract
Dynamic network data have become ubiquitous in social netwo rk analysis, with new infor-
mation becoming available that captures when friendships f orm, when corporate transactions
happen and when countries interact with each other. Flexibl e and interpretable models are
needed in order to properly capture the behavior of individu als in such networks. In this pa-
per, we focus on study the underlying latent space that descr ibes the social properties of a
dynamic and directed international relations network of co untries. We extend the directed
additive and multiplicative effects network model to the co ntinuous time setting by treating
the time-evolution of model parameters using Gaussian proc esses. Importantly we incorpo-
rate both time-varying covariates and node-level additive random effects that aid in increasing
model realism. We demonstrate the usefulness and ﬂexibilit y of this model on a longitudi-
nal dataset of formal state visits between the world’s 18 lar gest economies. Not only does
the model offer high quality predictive accuracy, but the la tent parameters naturally map onto
world events that are not directly measured in the data.
Keywords: Additive and multiplicative model; Directed dynamic netwo rk; Gaussian process; La-
tent space model
*This research was partially supported by grants from the Nat ional Science Foundation (CAREER DMS-2046880);
the Army Research Institute (W911NF-18-1-0233). Correspo nding author; alexander.volfovsky@duke.edu
1DEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
JPN
CHE
DEU
INDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITAFRA
CHEJPN
NLDESPDEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN
DEU
INDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
JPN
NLDCHEDEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN
DEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
JPN
CHEDEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN
DEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPNDEU
INDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN
NLD
DEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPNDEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN
DEU
IND
NLDCAN
KORTUR
RUS
GBRBRA
IDN
AUSMEX
USAITA
ESPFRA
CHEJPN2011Q3 2011Q4 2012Q1 2012Q2 2012Q3 2012Q42010Q1 2010Q2 2010Q3 2010Q4 2011Q1 2011Q2
Figure 1: Observed networks for selected time windows. Each edge represents at least one visit
within a quarter. We highlight Japan’s visiting activities as a visitor and a host using red and
blue color respectively. Temporal reciprocity, nodal hete rogeneity and dynamic evolution of the
directed network can be found in the dynamic networks.
1 Introduction
Encoding relationship information between individuals, ﬁ rms or countries, can be invaluable to
understanding disease transmission ( Bu et al. ,2020 ), ﬁnancial transactions ( Durante and Dunson ,
2014a ), and international relations ( Hoff and Ward ,2004 ). The actors in these relationships can be
represented as nodes or vertices in a graph and the interacti ons between them as edges. While early
data on networks was static ( Sampson ,1968 ;Zachary ,1977 ;Harris et al. ,2019 ), modern health,
international relations and social science applications f eature evolving, or dynamic, network infor-
mation. These rich new data require the extension of previou sly static models and computational
tools to include dynamics( Butts et al. ,2023 ). In this work we extend a dynamic latent space model
for directed networks that generalizes the class of latent s pace models for static directed networks.
Static latent space network models have been successful at c apturing important social processes
(Hoff,2005 ,2008 ,2009 ): (i) popularity – a node is more likely to be nominated as a co nnection
than other nodes; (ii) sociability – a node is more likely to n ominate a large number of connections;
(iii) homophily and stochastic equivalence – nodes that are similar on some observed or unobserved
attributes have similar network connections; and (iv) reci procity – the presence of a directed edge
between two individuals means there is more likely to be a rec iprocal directed edge between them.
It is natural to develop dynamic models that can also capture these, and possibly to allow for these
concepts to adapt or change over time.
To motivate this desiderata we plot the ofﬁcial visits acros s the world’s top 18 largest economies,
excluding China and Saudi Arabia, from 2010 to 2012 in Fig. 11. Each directed edge represents at
least one ofﬁcial visit from one country to another within a s peciﬁed quarter.
We can observe all four aforementioned social properties: R ussia visits many other countries
1Data are from the Integrated Crisis Early Warning System(IC EWS) dataverse and described in detail in Section 3
2(suggesting high sociability) but is not visited by many (su ggesting low popularity). The United
States and the United Kingdom share many global goals and hen ce exhibit similar behavior (sug-
gesting homophily and stochastic equivalence). Reciproci ty is a bit more complex: for example
there are many simultaneous edges between the United States and Japan, but it is likely that visits
trigger reciprocity in future time points. As such, we argue that temporal reciprocity is a more
meaningful concept: a visit by Japan in Q1 2010 to Turkey, the United Kingdom and Australia
appears to be reciprocated by these countries to Japan in Q2 2 010. We will return to discussing
Japan in our detailed data analysis in Section 3.
Beyond explaining observed behaviors, statistical models are frequently tasked with establish-
ing connections between collected data and unobserved info rmation. It is evident that international
relations are driven by a myriad of events, including natura l disasters, in-country political positions,
ﬁnancial crises, among others. We will demonstrate that the dynamically changing latent variables
in our model are correlated with, that is predictive of or can predict, real-world events that are not
included in the data that the model is based. This provides an invaluable resource for researchers
attempting to answer “what if?” questions as some interacti ons between network events and world
events may remain unnoticed without a detailed analysis of t he network. This can be illustrated by
interactions between Japan and France (that we study in deta il in Section 3): After the Fukushima
disaster, the probability of ofﬁcial visits to Japan decrea sed for all countries, except for France and
the USA, where the probability of visits increased. This unp redicted behavior both demonstrates
France’s long-term support for Japan and hints at speciﬁc in teractions between France and Japan
on nuclear development (even though the plant used American made reactors). This highlights the
signiﬁcance of dynamic network analysis in uncovering unex pected trends and relationships.
The most direct approach to dynamic network modeling is to co nsider snapshots at different
time points and model those separately, potentially ignori ng the temporal information ( Ward and Hoff ,
2007 ;Ward et al. ,2007 ). By assuming a ﬁrst order Markovian property, which indica tes net-
works only depend on the information at prior time points, th ese models can be extended to in-
clude generalized autoregressive terms such as a lag one res ponse variable or a lag one latent fac-
tor (Ward et al. ,2013 ;Minhas et al. ,2016 ;Hoff,015b ;He and Hoff ,2019 ). Another commonly
used models for dynamic networks are the temporal exponenti al random graph model (TERGM)
(Hanneke et al. ,2010 ;Krivitsky and Handcock ,2014 ;Lee et al. ,2020 ) and the stochastic actor-
oriented model (SAOM) ( Snijders ,1996 ,2001 ,2005 ;Snijders et al. ,2010 ;Uzaheta et al. ,2023 )
which largely model changes to network summary statistics o r require an actor-driving mecha-
nism. Other work incorporates a transition matrix or a state space model of latent factors or nodal
characteristics into static network models ( Xing et al. ,2010 ;Ho et al. ,2011 ;Yang et al. ,2011 ;
Xu and Hero ,2013 ;Sewell and Chen ,2015 ). These models require imposing strong assumptions
about how information is shared between nodes and across tim e-scales, but modern data streams
require greater ﬂexibility.
For undirected networks, the greatest modeling ﬂexibility is provided by Durante and Dunson
(2014b ) and Kim et al. (2018 ). Both propose versions of Gaussian Process priors for a lat ent space
representation of the network. In this article we describe t he extension of this modeling approach
to directed networks that are additionally able to account f or nodal heterogeneity. Importantly,
the only prior dependence that the models for undirected net works accounted for was temporal
dependence, but in directed networks the actions of individ uals as senders and receivers of connec-
tions are likely correlated, which is also incorporated int o our priors. We provide a short primer
for dynamic latent space models in Section 2(that adapts a Gibbs sampler with Pòlya-Gamma
3augmentation ( Polson et al. ,2013 ) to directed networks) and then turn our attention in Sectio n3
to the analysis of the ofﬁcial visits networks of Fig. 1with an in-depth case study of Japan. We
identify how various model parameters capture meaningful a nd relevant behaviors in international
relations and map those onto world events (such as economic d ownturns and natural disasters) that
are not directly measured in the data. We relegate model vali dation, sensitivity to misspeciﬁcation
and sensitivity to prior choice simulation studies to Secti on4. We conclude with a discussion of
future direction of both methods and international relatio ns data in Section 5.
2 Dynamic Latent Space Model
Our model extends the directed additive and multiplicative model of Hoff (2015 ) to the dynamic
case. Throughout we consider a network between nunits or nodes. We let yij(t)be a binary indi-
cator of an interaction between unit iand unitjat time point t∈ T andπij(t) = Pr(yij(t) = 1)
be the probability of that interaction. The collection of in teractions at time point tis frequently
referred to as the adjacency matrix at time tand is denoted by Y(t) ={yij(t),i/ne}ationslash=j}where the
diagonal entries are not deﬁned by convention. Note that sin ce we are considering asymmetric re-
lationships, it is not necessarily the case that yij(t) =yji(t)(or thatπij(t) =πji(t)). In addition to
observing the interactions among units we can observe tempo rally changing unit and dyad speciﬁc
covariates (in the dataset we discuss this covariate is the G DP of each country) that are collectively
denoted by Zij,t. We can deﬁne the full dynamic network model as follows:
yij(t)|πij(t)∼Bernoulli {πij(t)} (1)
πij(t) ={1+e−Sij(t)}−1(2)
Sij(t) =µ(t)+ZT
ij,tβ(t)+xs
iT(t)xr
j(t)+ai(t)+bj(t). (3)
This proposed dynamic model is a generalized version of the u ndirected models proposed by
Durante and Dunson (2014a ,b).
In our model β(t)is a vector of time-varying coefﬁcients associated with the observed covari-
ates. The remaining elements in Eq. ( 3) are latent additive and multiplicative effects ( Hoff,2015 ):
The dynamic additive effects ai(t)andbj(t)capture the “sociability” of unit iat timetand “pop-
ularity” of unit jat timetrespectively, and the H-dimensional multiplicative effects xs
i(t)and
xr
j(t)capture temporal third order dependence in directed relati onships from unit ito unitjat time
t. In general these higher order effects capture notions of ho mophily and stochastic equivalence
which are frequently observed in network data, while their t emporal structure allows for the levels
of homophily and stochastic equivalence among units to chan ge over time. We note that as the
node-speciﬁc effects ai(t),bj(t)go to zero, and sender latent effect Xs(t)and receiver latent ef-
fectXr(t)become identical, our proposed model would degenerate to th at of Durante and Dunson
(2014a ,b).
We specify independent Gaussian process priors for µandβ:
µ(·)∼GP(0,cµ), cµ(t,t′) =exp{−kµ(t−t′)2}
βp(·)∼GP(0,cp), cp(t,t′) =exp{−kp(t−t′)2}
The prior on the latent effects includes temporal dependenc e and within-unit dependence, but
4assumes independence across units. That is, for the additiv e “sociability” and “popularity” latent
effects we assume that (ai(t1),...,a i(tN),bi(t1),...,b i(tN))jointly follows a Gaussian process
{ai(t1),...,a i(tN),bi(t1),...,b i(tN)}T∼N2N(0,(caρabcabρabcabcb))
For the multiplicative latent effects, we also assume Gauss ian process but include a shrinkage
parameter τproposed by Durante and Dunson (2014b ), allowing for learning the dimension of the
latent space. As the dimension of the latent space h∈ {1,...,H∗}increases, τ−1
hwill decay to
zero,
τh=h/productdisplay
l=1νl, νl∼Ga(a,1), (4)
limiting the effects of the corresponding latent factors (xs
·h,xr
·h):
{xs
ih(t1),...,xs
ih(tN),xr
ih(t1),...,xr
ih(tN)}T∼N2N(0,τ−1
h(cxsρxcxsxr
ρxcxsxrcxr)) (5)
For ﬂexibility, we allow for different time-invariant corr elation,ρab, between “sociability” and
“popularity” and a time-invariant correlation ρxbetween the latent positions of an individual as a
sender and a receiver. ρabmay be relatively large, since an individual willing to make friends may
also attract friends while ρxmay not have such a pattern. With larger correlations ρabandρx, we
expect a more “symmetric” socio-matrix due to the similar be havior of individual ias a sender
and a receiver. Finally the model naturally captures tempor al reciprocity via the Gaussian Process
speciﬁcation, alleviating the need for specifying an addit ional reciprocity parameter (as is done in
Hoff (2015 ), for example, which is often difﬁcult to learn).
For simplicity, we assume common characteristics length-s cale for additive and multiplicative
effects respectively:
ca(t,t′) =cb(t,t′) =cab(t,t′) =exp{−kab(t−t′)2}
cxs(t,t′) =cxr(t,t′) =cxsxr(t,t′) =exp{−kx(t−t′)2}
Letθbe the collection of all unknown parameters and latent posit ions. Sampling from the pos-
teriorp(θ|Y(1),...,Y(tN))proceeds via Gibbs sampling with Pólya-gamma data augmenta tion
(Polson et al. ,2013 ). Updating schemes for µ,βp,yijand the Pólya-gamma augmented variable
wijare natural extensions of Durante and Dunson (2014a ,b)’s sampling scheme. However, the
multiplicative and additive latent effects and shrinkage p arameter νrequire a new approach. We
update them jointly with respect to the unit level due to the w ithin-unit dependence that exists
because of the directed nature of the data. See the Appendix f or the complete derivation of the
sampler.
3 Analysis of Ofﬁcial Visitation Networks
We analyzed the quarterly visiting activities among the 18 l argest economies in the world, exclud-
ing China and Saudi Arabia, from 2007 to 2016. Speciﬁcally, w e constructed a dynamic directed
network{Yij(t) :t∈ {1,...,40},i,j∈ {1,...,18},i/ne}ationslash=j}based on “make a visit” events
from Integrated Crisis Early Warning System (ICEWS) Datave rse (Boschee et al. ,2018 ). Here,
5−3−2−101
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeµ(t)(a)
−0.50.00.5
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeβ1(t)(b)
−0.50.0
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeβ2(t)(c)
quantile 2.5% 5% 95% 97.5% mean
Figure 2: Inference based on our model. (a)-(c) indicate gra phical summaries of trajectories of
posterior samples ˆµ,ˆβ1andˆβ2. The solid line represents the posterior mean. The grey ribb on
represents 95% highest posterior density interval.
Yij(t) = 1 indicates that country ivisited country jat least once during quarter t, whileYij(t) = 0
indicates that no visit occurred. We model these visits usin g a variation on the gravity model
ofIsard (1954 ) by including the logarithms of the gross domestic product ( GDP) of both coun-
tries in the previous quarter as predictors of quarter tvisits.2The complete model speciﬁcation is
presented below.
Sij(t) =µ(t)+log GDPi,t−1β1(t)+log GDPj,t−1β2(t)+xs
iT(t)xr
j(t)+ai(t)+bj(t)(6)
In the presented analysis we set the dimension of the latent s paceH∗to be 10, the length scales
of Gaussian processes kµ,kx,kβ1,kabto be 0.1, the correlation between the latent effects ρx=ρab
to be 0.5, and the shrinkage hyper-parameters ato be 2. To obtain posterior samples, we ran the
MCMC sampler for 50,000 iterations, discarding the ﬁrst 5,0 00 samples as burn-in, and saving
samples every 10 iterations. This resulted in a ﬁnal sample s ize of 4,500. The effective sample
sizes ofπij(t)were mostly around 4,500, indicating good mixing. The poste rior mean ˆτ−1
hwas
0.3987 for h= 1, decreasing to 0.2774 for h= 5, and further to 0.0424 for h= 10 . The AUCs for
estimation and prediction were 0.88 and 0.77, respectively , indicating good model performance.
Furthermore, we performed extensive sensitivity analyses to assess the impact of several hyper-
parameter choices on the model’s performance. The results i ndicate that the model’s performance
(both in sample and out of sample) is not signiﬁcantly inﬂuen ced by hyper-parameter choice (see
Table 7in the appendix).
2We considered quarterly GDP estimated using the expenditur e approach (B1_GE) and under the CQRSA mea-
surement (National currency, current prices, quarterly le vels, seasonally adjusted) from OECD dataset ( OECD ,2014 ).
We calculated real GDP in dollars using the deﬂator and excha nge rate datasets from the International Monetary
Fund (IMF) database ( Fund ,2019 ). For Brazil, India, Indonesia, Russia, and Turkey, we used the deﬂators without
seasonable adjustments.
62007Q3 2008Q3 2011Q3 2014Q3pi yUnited StatesUnited KingdomTurkeySwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoJapanItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
United StatesUnited KingdomTurkeySwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoJapanItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
0.000.250.500.751.00value
Figure 3: Model performance at selected time points. The top panel indicates posterior mean ˆπ(t)
and the bottom panel indicates the true relation data. From l eft to right, each panel indicates a
matrix at the different time quarters.
3.1 Discussion of results
Fig.2illustrates the baseline trend µ(t)and the effect of previous quarter’s gross domestic product
of the sending and receiving country ( logGDPi,t−1,logGDPj,t−1). The ﬂat µ(t)line indicates
that visits between the 18 countries remained relatively st able, without any signiﬁcant trends or
sudden changes. The posterior mean estimates of ˆβ1(t)andˆβ2(t)possess opposite signs but similar
absolute values, suggesting that countries with a higher GD P tend to prefer making visits over
hosting visits, and larger economic disparities between th e visiting and hosting countries result in
increased probability of connections. This demonstrates t hat countries with greater resources are
generally more popular and attractive to those with fewer re sources. In addition, the V-shaped
trend ofˆβ1(t)(or inverse V-shaped of ˆβ2(t)) from 2009Q2 to 2012Q1 implies that the inﬂuence of
economics on visitation decreased from 2009 to 2010 and then rebounded, likely corresponding to
the global ﬁnancial crisis that began in 2008.
Fig.3displays the relational matrices between 18 countries at se lected time points, with darker
colors indicating a higher probability of an edge. The greys cale patterns in both the top and bottom
panels are very similar, suggesting that our model accurate ly captures the visiting activity pattern.
However, our model fails to capture the pattern for Russia, a s Russia frequently visited other
countries but was rarely visited by others. This poor ﬁtting performance for Russia may be due to
the enforced strong correlation between sociability and po pularity of a country ( ρab), which may
not be suitable for Russia.
Fig. 4summarizes the popularity and sociability parameters, pro viding a measure of a coun-
try’s diplomatic role. The United States appears to have pla yed the most active role, followed by
Russia, the United Kingdom, France, and Japan, as indicated by high sociability and popularity
7a(sender) b(receiver)
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q12007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1United StatesUnited KingdomTurkeySwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoJapanItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
−202value
Figure 4: Parameter estimation for aandb. The left and right panels indicate posterior means for a
andbrespectively. The rows of each matrix represent different c ountries while columns represent
different time points.
−3−2−101
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeµ(t)(a)
−0.50.00.5
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeβ1(t)(b)
−0.50.0
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeβ2(t)(c)
quantile 2.5% 5% 95% 97.5% mean
Figure 5: Parameter estimation for aandbof Japan. The left and right panels indicate the summary
of trajectories for aandbrespectively. The solid line represent the posterior mean. The grey ribbon
represents 95% highest posterior density intervals.
throughout. In contrast, the Netherlands seems to have play ed the role of a visitor or host much
less frequently than other nations. Fig. 14in the Appendix is a colored version of this plot that
captures information about the 95% credible intervals for t he elements of Fig. 4.
Some shifts in the geopolitical roles of certain countries c an also be identiﬁed. For instance,
since Prime Minister Narendra Modi came to power and the econ omy grew, India has been involved
in more diplomatic relationships since 2014Q2. Switzerlan d became more popular during 2008Q3
compared to other time, which may be attributed to the ﬁnanci al crisis in 2008, as other countries
sought Switzerland’s ﬁnancial stability. Figure 13showcases our model’s capability to capture
temporal reciprocity by displaying the credible intervals for the correlation between Sij(tj)and
Sji(tj−1). The pairs (i,j)are ordered according to their posterior mean, and the top 20 country
pairs are listed in Table 8.
83.2 In depth case study: Japan
Fig.5illustrates that Japan’s sociability, which corresponds t o their propensity to visit other coun-
tries, dropped following the ﬁnancial crisis in the second q uarter of 2008. The number of countries
Japan visited oscillated with various regime changes from 2 009 to 2011 (Taro Aso (2008Q3),
Yukio Hatoyama(2009Q3), Naoto Kan(2010Q2)). In the second quarter of 2011, Japan reduced its
activity signiﬁcantly, likely due to the Fukushima Daiichi nuclear disaster that occurred in March
of the same year. With Prime Minister Abe’s return to power an d the resulting economic recovery,
Japan’s sociability has steadily increased since 2012Q2, u ntil a second economic downturn hit in
2014Q2, which was the most substantial decline since the Mar ch 2011 earthquake and tsunami.
The measure of popularity showcases a similar trend. Howeve r, the popularity appears to be
more responsive to Japan’s economic status, as reﬂected by l arger amplitudes, and less affected by
regime alternation, as seen in the relatively stable period from 2009 to 2010. The falls and rises in
the popularity curve correspond to recessions (such as ﬁnan cial crisis and disaster) and subsequent
recoveries, respectively.
sender receiver
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q12007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1United StatesUnited KingdomTurkeySwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
0.250.500.75value
Figure 6: Parameter estimation of πij(t)for Japan. The left and right panels indicate posterior
means of πij(t)with Japan as a sender (making visits to other countries) and a receiver (hosting
visits from other countries) respectively. The rows for eac h matrix represent different countries
while columns represent different time points.
To delve deeper into the dynamic bilateral relations, we pre sent theπij(t)matrices for Japan.
Fig. 6shows the probability of the existence of bilateral relatio ns, enabling us to identify the
countries maintaining a close relationship with Japan and h ow these relationship have evolved over
time. The United States, Russia, and South Korea emerged as J apan’s closest partners, while India
and Australia appeared as trade partners due to their highly correlated economic trends with Japan.
The ﬁnancial crisis in 2008 and the Fukushima disaster in 201 1 led to a systematic decrease in the
interactions between Japan and all other countries, while A be’s return and economic recovery
brought an increase in these interactions. It is worth notin g that after the Fukushima nuclear
disaster, France, a close collaborator of Japan in nuclear e nergy generation, provided long-term
assistance to Japan, as indicated by the dark areas from 2011 to 2014 shown in Fig. 6(b). A detailed
trajectory plot shown in Fig. 7unveils the details of the bilateral relation between Japan and France.
Following the Fukushima disaster in March 2011, Japan visit ed France immediately, and France
reciprocated by providing long-term support to Japan, poss ibly highlighting their willingness to
90.000.250.500.751.00
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeπ(t)(a)
0.000.250.500.751.00
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1
timeπ(t)(b)
quantile 2.5% 5% 95% 97.5% mean
Figure 7: Parameter estimation for πij(t)of bilateral relation between Japan and France. The left
panel indicates the summary of trajectories for probabilit y of making a visit from Japan to France
and vice versa for the right panel. The solid lines represent the posterior mean. The grey ribbons
represent 95% highest posterior density intervals. The bla ck points represent the true relation data.
assist Japan’s recovery, given their own dependence on nucl ear power. Fig. 15in the Appendix
provides a colored version of this plot that captures inform ation about the 95% credible intervals
for the elements of Fig. 6.
A similar analysis can be performed for other countries. Gen erally, the patterns of the param-
eters are closely tied to various events, such as natural dis asters (e.g., ﬂoods and earthquakes),
ﬁnancial crises, changes in political leadership, contest s, terrorism, and other major events like the
Olympics. Our proposed model effectively captures the unde rlying patterns of bilateral relations,
detects the relevant social events, and demonstrates a sign iﬁcant advantages in interpreting the
corresponding parameters.
4 Simulation
4.1 Validation
We follow Durante and Dunson (2014b )’s simulation to conduct a numerical experiment to check
whether the model can accurately recover the true data gener ating process when hyperparameters
are mis-speciﬁed. We generated data according to the model i n Eq. ( 1)–(3), with 15 nodes and 40
time points. We generated observed covariates Z1from a Gaussian process GP(0.5,cz1), where
cz1(t,t′) =exp{−kz1(t−t′)2}. The remaining parameters were set as follows:
intercept: µ∼GP(0,cµ), cµ(t,t′) =exp{−kµ(t−t′)2}
coefﬁcient: β1∼GP(0,c1), c1(t,t′) =exp{−k1(t−t′)2}
(sociability, popularity): (ai,bi)∼N(0,(cabρabcabρabcabcab)), cab(t,t′) =exp{−kab(t,t′)2}
multiplicative effects: (xs
ih,xr
ih)∼N(0,(cxρxcxρxcxcx)), cx(t,t′) =exp{−kx(t,t′)2}
For this data generating process, we set the same length scal ek·= 0.01for all Gaussian
process priors, the same correlation ρ·= 0.5for both additive and multiplicative effects, and a
10low true dimension of the multiplicative effect H= 2. We excluded the entire matrix Y(40) to
evaluate the performance of model prediction. For the prior s, we considered a larger length scale
k·= 0.05, a higher dimension of multiplicative latent effects H∗= 10 , and a relatively small
shrinkage parameter a= 2for the latent space.
10 20 30 40difference estimate true
0.250.500.75value
Figure 8: Model performance at selected time. From top to bot tom, each panel indicates the
absolute difference |π(t)−ˆπ(t)|, estimate values ˆπ(t)and true values π(t)respectively. From left
to right, each panel indicate matrices at the different time pointt= 10,20,30,40. Dark grey scale
indicates high probability of the existence of an edge. Noti ce theY(40) is held out for prediction.
We ran 5000 iterations of the MCMC sampler discarding the ﬁrs t 1000 draws as burn-in. The
effective sample size of πij(t)is approximately 1500, indicating relatively good mixing. Fig. 8
suggests good performance in model ﬁtting and prediction, w ith the light color in the ﬁrst row pan-
els indicating that the estimator recovers the true structu re well even for the prediction. The AUCs
(Area Under the ROC Curve) for estimation and prediction are 0.9254 and 0.7801, respectively.
The shrinkage parameter ˆτmaintains the main effects of the ﬁrst two latent factors whi le restrict-
ing effects of other factors. As suggested by Eq. ( 5), smaller τ−1
hleads to greater shrinkage of the
latent factors at the hth dimension (xs
·h,xr
·h)towards0. As shown in Table 2in the Appendix,
the shrinkage estimator ˆτ−1
his relatively large for the ﬁrst two dimensions ( ˆτ−1
1,ˆτ−1
2≈0.91) and
decreases from 0.27 towards 0 for higher dimension ˆτ−1
3:10. Based on our model, the true parameters
lie between 95% highest posterior density (HPD) intervals a nd almost overlap with the posterior
mean (Fig. 9, Fig. 11and Fig. 12). Furthermore, we compared our model to the model without
network structure (simply letting Sij(t) =µ(t)+ZT
ij,tβ(t)) in terms of the estimation performance
ofˆβ(t)andˆπ5,8(t). Fig. 9shows ignorance of the network structure results in a biased estimator
ofβ(t)and a large uncertainty of estimation of π5,8(t). Similar patterns are observed for other πij.
11−0.50.00.51.01.52.0
0 10 20 30 40
timeβ(t)(a)
0.000.250.500.751.00
0 10 20 30 40
timeπ5, 8(t)(b)
−0.50.00.51.01.5
0 10 20 30 40
timeβ(t)(c)
0.000.250.500.751.00
0 10 20 30 40
timeπ5, 8(t)(d)
Figure 9: Model comparison between the model with network st ructure and without network struc-
ture. (a) and (b) indicate graphical summary of trajectorie s of sampled ˆβandˆπ5,8based on the
network structured model, while (c) and (d) indicate those b ased on the model without network
structure. The solid line and dash line represent true and es timated values. The grey ribbon repre-
sents 95% highest posterior density intervals.
4.2 Prior sensitivity
We conducted simulations with the same settings as before bu t on larger networks and with more
time points. The results for (N,T)∈ {(30,20),(30,30),(40,20)}showcase that the approach
continues to perform well for estimation and prediction (se e Table 6in the Appendix). We also
conducted extensive sensitivity analysis, considering di fferent values for the dimension of the latent
spaceH∗, the correlations between variables ρx,ρab, and the length scales of Gaussian process
priorskµ,kx,kβ1,kab(see Table 3, Table 4and Table 5in the Appendix). Generally, a larger H∗
brings more ﬂexibility to the model and leads to a better mode l ﬁtting and prediction (also indicated
by Theorem 5.1and Corollary 5.1.1 ). In contrast, underestimating Hcan cause bias. Therefore,
setting a conservative H∗can be a better choice, although it should be balanced agains t additional
computational cost. The simulation results suggest that th e model’s performance is not overly
sensitive to other hyperparameter choices (see Table 4and Table 5in the Appendix).
12DLSN Random Effect Naive LSMDN
DLSN w/ covariates 0.9257 0.9209 0.7104 0.7450
DLSN w/o covariates 0.9177 0.9253 0.4943 0.7820
LSMDN 0.9850 0.9835 0.4795 0.9726
Table 1: Comparison between DLSN and LSMND based on AUCs. Row names and column names
represent data generating process and modeling process res pectively.
4.3 Model Misspeciﬁcation
We compare our directed latent space model for networks (DLS N) with the latent space model for
directed network (LSMDN) proposed by Sewell and Chen (2015 ). Instead of adopting an additive
and multiplicative latent factors shown in Eq. ( 3),Sewell and Chen (2015 ) introduce radii ri,rj
around an individual to represent “sociability" and “popul arity", and utilize Euclidean distance to
depict the difference between latent factors, where dijt=||Xit−Xjt||, andXitis the latent factor.
Instead of using Gaussian process to model the latent factor ,Sewell and Chen (2015 ) consider a
Markov process. Besides the aforementioned two main differ ence, the LSMDN model does not
allow for effects of covariates.
LSMDN: Sij(t) =βIN(1−dijt
rj)+βOUT(1−dijt
ri) (7)
DLSN:Sij(t) =µ(t)+ZT
ij,tβ(t)+xs
iT(t)xr
j(t)+ai(t)+bj(t) (8)
Naive:Sij(t) =µ(t)+ZT
ij,tβ(t) (9)
Random Effect: Sij(t) =µ(t)+ZT
ij,tβ(t)+ǫij(t) (10)
We generated three datasets based on the DLSN model with cova riates, the DLSN model with-
out covariates, and LSMDN model. We model each of these datas ets using four models listed
in equations ( 8)-(10) : the DLSN model, DLSN model without the network structure ( labeled as
naive), DLSN model with independent and identically distri buted random effects replacing net-
work structure (labeled as random effect) and LSMDN model. T he resulting AUCs are shown
in Table 1and ROC curves are shown in Fig. 10. Our model exhibits strong performance even
when the data are generated from the LSMDN model, and surpass es other models when correctly
specifying the true generating process. While our model sha res the same level of ﬂexibility as
the random effect model, it provides greater interpretabil ity by further decomposing the random
effects into meaningful additive and multiplicative laten t processes.
5 Discussion
We extended the nonparametric Bayes dynamic undirected net work model of Durante and Dunson
(2014b ) and Kim et al. (2018 ) to the general setting of dynamic additive and multiplicat ive network
(AMEN) models ( Hoff,2015 ). Each effect is modeled using a ﬂexible Gaussian process wi th a
ﬂexible covariance structure, allowing for homogeneity an d heterogeneity of sender and receiver
effects. As shown in the application of international ofﬁci al visitation networks, our model inherits
130.000.250.500.751.00
0.00 0.25 0.50 0.75 1.00
1 − specificitysensitivity(a)DLSN w/ covariates
0.000.250.500.751.00
0.00 0.25 0.50 0.75 1.00
1 − specificitysensitivity(b)DLSN w/o covariates
0.000.250.500.751.00
0.00 0.25 0.50 0.75 1.00
1 − specificitysensitivity(c)LSMDN
model DLSN LSMDN naive random effect
Figure 10: ROC curves for model comparison. Different color s represent different data generating
processes. Different panels represent different models.
the advantages in capturing dynamic patterns of dyadic data and shows excellent interpretability.
Also, our model is ﬂexible in terms of the capability of model ing both directed and undirected
networks (degenerate case) evolving in continuous time and speciﬁcation of the hyperparameters.
An important direction for future work is accounting for the dynamic evolution of multiple
related directed networks. In addition to ofﬁcial visitati on dynamic networks, various other types
of dynamic networks are observed among the same countries (e .g. expressing intent to cooperate,
consulting, engaging in diplomatic or material cooperatio n, or providing aid). These networks are
naturally related, as countries may exhibit similar social behavior across different diplomatic con-
texts. A natural, albeit simplistic, approach is to assume a shared latent space across different net-
works, where countries are expected to occupy similar posit ions in the latent space across networks.
Drawing from the concept of Group Factor Analysis ( Virtanen et al. ,2012 ;Klami et al. ,2014 ), we
can decompose the latent factors in Equation 3into two parts: common latent factors shared across
multiple networks, and distinct group-speciﬁc factors for each network. Modeling multiple net-
works jointly could further facilitate integration of info rmation from multiple networks, enhance
our understanding of countries’ distinct roles across diff erent relations, and evaluate the impact of
worldwide events on social interactions among countries.
The ﬂexibility inherent in the Guassian Process (GP) modeli ng framework comes at the price of
computational complexity. As we employ GPs for both additiv e and multiplicative latent factors,
we are unable to scale to substantially larger networks (tho ugh we can scale to larger time-frames).
There is a growing literature on developing scalable Gaussi an process methods (see Liu et al.
(2020 ) for a recent review). These methods include estimating the Gaussian process covariance
matrix based on a subset of data, using a sparsity matrix or a s parse approximation, and employing
the divide-and-conquer approach to obtain local approxima tion based on partitioned subsets of
data. Studying how to implement such improvements for our sp eciﬁc model framework (with the
complex dependencies that are necessarily present in netwo rk problems) is important future work.
Lastly, we conclude with statements of a theorem and a coroll ary that demonstrates the suit-
ability and ﬂexibility of our model speciﬁcation. Theorem 5.1and Corollary 5.1.1 show that our
model speciﬁcation can capture any true underlying probabi lity matrices of a dynamic directed
network.
14Theorem 5.1 Given a positive semi-deﬁnite matrix S(t), for every t∈ T, there exist
{Xs(t),Xr(t),µ(t),a(t),b(t)} ∈ XXs×XXr×Xµ×Xa×Xbsuch that
S(t) =µ(t)1V1T
V+ZT(t)β(t)+Xs(t)XrT(t)+a(t)1T
V+1Vb(t)T.(t∈ T)
Corollary 5.1.1 Given a asymmetric link probability matrix π(t), for every t∈ T, here exist
{Xs(t),Xr(t),µ(t),a(t),b(t)} ∈ XXs×XXr×Xµ×Xa×Xbsuch that
πij(t) ={1+e−(µ(t)+ZT
ij(t)β(t)+xs
iT(t)xr
j(t)+ai(t)+bj(t))}−1(i,j= 1,...,V;i/ne}ationslash=j)
Funding
This research was partially supported by grants from the Nat ional Science Foundation (CAREER
DMS-2046880); the Army Research Institute (W911NF-18-1-0 233).
Data availability
Data are available directly from ICEWS ( OECD ,2014 ). Code is available on the ﬁrst author’s
GitHub.
15References
Boschee, E., J. Lautenschlager, S. O’Brien, S. Shellman, J. Starz, and M. Ward (2018). Icews
coded event data. data retrieved from https://doi.org/10. 7910/DVN/28075.
Bu, F., A. E. Aiello, J. Xu, and A. V olfovsky (2020). Likeliho od-based inference for partially
observed epidemics on dynamic networks. Journal of the American Statistical Association ,
1–17.
Butts, C. T., A. Lomi, T. A. B. Snijders, and C. Stadtfeld (202 3). Relational event models in
network science. Network Science , 1–9.
Durante, D. and D. B. Dunson (2014a). Bayesian dynamic ﬁnanc ial networks with time-varying
predictors. Statistics & Probability Letters 93 , 19–26.
Durante, D. and D. B. Dunson (2014b). Nonparametric bayes dy namic modelling of relational
data. Biometrika 101 (4), 883–898.
Fund, I. M. (2019). International ﬁnancial statistics.
Hanneke, S., W. Fu, E. P. Xing, et al. (2010). Discrete tempor al models of social networks. Elec-
tronic Journal of Statistics 4 , 585–605.
Harris, K. M., C. T. Halpern, E. A. Whitsel, J. M. Hussey, L. A. Killeya-Jones, J. Tabor, and S. C.
Dean (2019). Cohort proﬁle: The national longitudinal stud y of adolescent to adult health (add
health). International Journal of Epidemiology 48 (5), 1415–1415k.
He, Y . and P. D. Hoff (2019). Multiplicative coevolution reg ression models for longitudinal net-
works and nodal attributes. Social Networks 57 , 54–62.
Ho, Q., L. Song, and E. Xing (2011). Evolving cluster mixed-m embership blockmodel for time-
evolving networks. In Proceedings of the Fourteenth International Conference on Artiﬁcial
Intelligence and Statistics , pp. 342–350.
Hoff, P. (2008). Modeling homophily and stochastic equival ence in symmetric relational data. In
Advances in neural information processing systems , pp. 657–664.
Hoff, P. D. (2005). Bilinear mixed-effects models for dyadi c data. Journal of the american Statis-
tical association 100 (469), 286–295.
Hoff, P. D. (2009). Multiplicative latent factor models for description and prediction of social
networks. Computational and mathematical organization theory 15 (4), 261.
Hoff, P. D. (2015). Dyadic data analysis with amen. arXiv preprint arXiv:1506.08237 .
Hoff, P. D. (2015b). Multilinear tensor regression for long itudinal relational data. The annals of
applied statistics 9 (3), 1169.
16Hoff, P. D. and M. D. Ward (2004). Modeling dependencies in in ternational relations networks.
Political Analysis 12 (2), 160–175.
Isard, W. (1954). Location theory and trade theory: short-r un analysis. The Quarterly Journal of
Economics , 305–320.
Kim, B., X. Niu, D. R. Hunter, and X. Cao (2018). A dynamic addi tive and multiplicative effects
model with application to the united nations voting behavio rs.arXiv preprint arXiv:1803.06711 .
Klami, A., S. Virtanen, E. Leppäaho, and S. Kaski (2014). Gro up factor analysis. IEEE transac-
tions on neural networks and learning systems 26 (9), 2136–2147.
Krivitsky, P. N. and M. S. Handcock (2014). A separable model for dynamic networks. Journal of
the Royal Statistical Society: Series B (Statistical Metho dology) 76 (1), 29–46.
Lee, K. H., L. Xue, and D. R. Hunter (2020). Model-based clust ering of time-evolving networks
through temporal exponential-family random graph models. Journal of Multivariate Analy-
sis 175 , 104540.
Liu, H., Y .-S. Ong, X. Shen, and J. Cai (2020). When gaussian p rocess meets big data: A review of
scalable gps. IEEE transactions on neural networks and learning systems 3 1(11), 4405–4423.
Minhas, S., P. D. Hoff, and M. D. Ward (2016). A new approach to analyzing coevolving longitu-
dinal networks in international relations. Journal of Peace Research 53 (3), 491–505.
OECD (2014). Quarterly national accounts. data retrieved f rom https://www.oecd-
ilibrary.org/content/data/data-00017-en.
Polson, N. G., J. G. Scott, and J. Windle (2013). Bayesian inf erence for logistic models using
pólya–gamma latent variables. Journal of the American statistical Association 108 (504), 1339–
1349.
Sampson, S. F. (1968). A novitiate in a period of change: An experimental and case st udy of social
relationships . Cornell University.
Sewell, D. K. and Y . Chen (2015). Latent space models for dyna mic networks. Journal of the
American Statistical Association 110 (512), 1646–1657.
Snijders, T. A. (1996). Stochastic actor-oriented models f or network change. Journal of mathe-
matical sociology 21 (1-2), 149–172.
Snijders, T. A. (2001). The statistical evaluation of socia l network dynamics. Sociological method-
ology 31 (1), 361–395.
Snijders, T. A. (2005). Models for longitudinal network dat a.Models and methods in social
network analysis 1 , 215–247.
Snijders, T. A., G. G. Van de Bunt, and C. E. Steglich (2010). I ntroduction to stochastic actor-based
models for network dynamics. Social networks 32 (1), 44–60.
17Uzaheta, A., V . Amati, and C. Stadtfeld (2023). Random effec ts in dynamic network actor models.
Network Science , 1–18.
Virtanen, S., A. Klami, S. Khan, and S. Kaski (2012). Bayesia n group factor analysis. In Artiﬁcial
Intelligence and Statistics , pp. 1269–1277. PMLR.
Ward, M. D., J. S. Ahlquist, and A. Rozenas (2013). Gravity’s rainbow: A dynamic latent space
model for the world trade network. Network Science 1 (1), 95–118.
Ward, M. D. and P. D. Hoff (2007). Persistent patterns of inte rnational commerce. Journal of
Peace Research 44 (2), 157–175.
Ward, M. D., R. M. Siverson, and X. Cao (2007). Disputes, demo cracies, and dependencies: A
reexamination of the kantian peace. American Journal of Political Science 51 (3), 583–601.
Xing, E. P., W. Fu, L. Song, et al. (2010). A state-space mixed membership blockmodel for
dynamic network tomography. The Annals of Applied Statistics 4 (2), 535–566.
Xu, K. S. and A. O. Hero (2013). Dynamic stochastic blockmode ls: Statistical models for time-
evolving networks. In International conference on social computing, behavioral -cultural mod-
eling, and prediction , pp. 201–210. Springer.
Yang, T., Y . Chi, S. Zhu, Y . Gong, and R. Jin (2011). Detecting communities and their evolutions
in dynamic social networks—a bayesian approach. Machine learning 82 (2), 157–189.
Zachary, W. W. (1977). An information ﬂow model for conﬂict a nd ﬁssion in small groups. Journal
of anthropological research 33 (4), 452–473.
18Supplementary Materials
A Gibbs sampling scheme
Here we describe the full conditional needed for the Gibbs sa mpler deﬁned in the main text. For
i,j= 1,...,V;i/ne}ationslash=j;h= 1,...,H∗;p= 1,...,P , the algorithm is as follows:
Step 1: Updatewij(t)from its full conditional:
wij(t)|− ∼PG{1,µ(t)+H∗/summationdisplay
h=1xsT
ihxr
jh+ZT
ij,tβ(t)+ai(t)+bj(t)}
Step 2: Updateµfrom its full conditional:
µ|− ∼N(µµ,Σµ),
where
Σµ={diag(/summationdisplay
i/summationdisplay
j/negationslash=iwij(t1),...,/summationdisplay
i/summationdisplay
j/negationslash=iwij(tN))+K−1
µ}−1
fµ
ij(t) =yij(t)−0.5−wij(t)(xsT
i(t)xr
j(t)+Zij(t)Tβ(t)+ai(t)+bj(t))
µµ= Σµ
/summationtext
i/summationtext
j/negationslash=ifµ
ij(t1)
.../summationtext
i/summationtext
j/negationslash=ifµ
ij(tN)
.
Step 3: Updateβfrom its full conditional:
βp|− ∼N(µβp,Σβp),
where
Σβp={diag(/summationdisplay
i/summationdisplay
j/negationslash=iZ2
ij,p(t1)wij(t1),...,/summationdisplay
i/summationdisplay
j/negationslash=iZ2
ij,p(tN)wij(tN))+K−1
p}−1
fβp(t)ij=Zij,p(t)(yij(t)−0.5−wij(t)(µ(t1)+xsT
i(t)xr
j(t)
+Zij(−p)(t)Tβ(−p)(t)+ai(t)+bj(t)))
µβp= Σβp
/summationtext
i/summationtext
j/negationslash=ifβp(t1)ij
.../summationtext
i/summationtext
j/negationslash=ifβp(tN)ij

Step 4: UpdateX(v)from its full conditional: Let
X(v)={xs
v1(t1),...,xs
v1(tN),...,xs
vH∗(t1),...,xs
vH∗(tN),
xr
v1(t1),...,xr
v1(tN),...,xr
vH∗(t1),...,xr
vH∗(tN)}T,
19then we have
X(v)|− ∼N(µX(v),ΣX(v)),
where
ΣX(v)={˜X(−v)TΩ(v)˜X(−v)+K−1
X(v)}−1
µX(v)= ΣX(v)[˜X(−v)T{y(v)−12N(V−1)0.5−Ω(v)(12(V−1)⊗µ+(Zβ)(v)+a(v)+b(v))}]
The components of the distribution are as follows:
˜X(−v)=
xr
11(t1)xr
12(t1)... xr
1H∗(t1)
............
xr
11(tN)xr
12(tN)... xr
1H∗(tN)
............
xr
V1(t1)xr
V2(t1)... xr
VH∗(t1)
............
xr
V1(tN)xr
V1(tN)... xr
VH∗(tN)
xs
11(t1)xs
12(t1)... xs
1H∗(t1)
............
xs
11(tN)xs
12(tN)... xs
1H∗(tN)
............
xs
V1(t1)xs
V2(t1)... xs
VH∗(t1)
............
xs
V1(tN)xs
V2(tN)... xs
VH∗(tN)

captures the sender and receiver multiplicative latent pos itions for all units other than v, and
Ω(v)=diag({wv1(t1),...,w v1(tN),...,w vV(t1),...,w vV(tN),
w1v(t1),...,w 1v(tN),...,w Vv(t1),...,w Vv(tN)}T),
y(v)={yv1(t1),...,y v1(tN),...,y vV(t1),...,y vV(tN),
y1v(t1),...,y 1v(tN),...,y Vv(t1),...,y Vv(tN)}T,
(Zβ)(v)={Zv1(t1),...,Z v1(tN),...,Z vV(t1),...,Z vV(tN),
Z1v(t1),...,Z 1v(tN),...,Z Vv(t1),...,Z Vv(tN)}T×(12(V−1)⊗β),
a(v)={av(t1),...,a v(tN),...,a v(t1),...,a v(tN),
a1(t1),...,a 1(tN),...,a V(t1),...,a V(tN)}T,
b(v)={b1(t1),...,b 1(tN),...,b V(t1),...,b V(tN),
bv(t1),...,b v(tN),...,b v(t1),...,b v(tN)}T
contain the weights, observed outcomes, expected outcomes and additive sender and receiver ef-
fects for unit v. Lastly,
20K−1
X(v)={/parenleftbig1ρ
ρ1/parenrightbig
⊗[diag(τ−1
1,...,τ−1
H∗)⊗Kx]}−1
={1
1−ρ2/parenleftbig1−ρ
−ρ1/parenrightbig
⊗[diag(τ1,...,τ H∗)⊗K−1
x]}
is a computationally tractable formulation of the inverse o f the covariance matrix.
Step 5: Updateτfrom its full conditional:
νl|− ∼Ga(a+N×V×(H∗−l+1),1+1
2H∗/summationdisplay
h=l(h/productdisplay
t=1
t/negationslash=lνt)V/summationdisplay
i=1X∗T
il/parenleftbigΣxρxΣx
ρxΣxΣx/parenrightbig−1X∗
il)
τh=h/productdisplay
l=1νlwhereX∗
il={xs
il(t1),...,xs
il(tN),xr
il(t1),...,xr
il(tN)}T
Step 6: Update(a(v),andb(v))from their full conditionals:
Writing(a(v),b(v)) ={av(t1),...,a v(tN),bv(t1),...,b v(tN)}T, we have
(a(v),b(v))|− ∼N(µab(v),Σab(v))
where
Σab(v)={diag(/summationdisplay
j/negationslash=vwvj(t1),...,/summationdisplay
j/negationslash=vwvj(tN),/summationdisplay
i/negationslash=vwiv(t1),...,/summationdisplay
i/negationslash=vwiv(tN))+K−1
ab(v)}−1
K−1
ab(v)={/parenleftbig1ρab
ρab1/parenrightbig
⊗Σab}−1=/parenleftbig1ρab
ρab1/parenrightbig−1⊗Σ−1
ab
and
µab(v)= Σab(v)
/summationtext
j/negationslash=vfµab
b(t1)vj
.../summationtext
j/negationslash=vfµab
b(tN)vj/summationtext
i/negationslash=vfµaba(t1)iv
.../summationtext
i/negationslash=vfµaba(tN)iv
where
fµab
b(t)ij=yij(t)−0.5−wij(t)[(µ(t)+xsT
i(t)xr
j(t)+Zij(t)Tβ(t)+bj(t))
fµab
a(t)ij=yij(t)−0.5−wij(t)[(µ(t)+xsT
i(t)xr
j(t)+Zij(t)Tβ(t)+ai(t))
Step 7: If there are any missing values we can sample them from their f ull conditionals as well,
via:
yij(t)|− ∼Ber[{1+e−(µ(t)+ZT
ij,tβ(t)+xs
i(t)Txr
j(t)+ai(t)+bj(t))}−1]
21B Proofs of Theorems in Discussion
Proof of Theorem 5.1
Without loss of generality, we assume that µ(t) =β(t) =a(t) =b(t) = 0 . For any matrix
S(t)at any time t∈ T can be expressed as
S(t) =UDVT=UD1/2D1/2VT
DenoteXs=UD1/2,Xr=VD1/2. Then we have S(t) =XsXrT, for anyt∈ T
Proof of Theorem 5.1.1
Notice the logistic function is one-to-one continuous incr easing function, together with Theo-
rem5.1, the proof is straightforward.
22C Additional ﬁgures and tables
C.1 Simulations
We include several additional tables and ﬁgures that depict simulation results. Table 2depicts
values for the shrinkage estimator ˆτ−1
hfor several choices of H∗, demonstrating the ﬂexibility of
the model in adapting to different dimensional problems.
τ−11 2 3 4 5 6 7 8 9 10
H∗= 10 0.915 0.910 0.272 0.08 0.025 0.008 0.002 0.001 0 0
H∗= 5 0.930 0.233 0.182 0.83 0.204
H∗= 2 0.952 0.866
Table 2: Parameter estimation. Posterior mean of τ−1based on different H∗(TrueH= 2)
Figures 11provides visual validation of the ability of the model to dec ompose the signal into
additive sender and receiver effects. Figure 12showcases the 95% credible intervals for individual
aandb.
C.2 Sensitivity analysis
This section includes Tables 3-7that describe the sensitivity of the proposed approach to ch oices
of latent dimension (versus true latent dimension), choice of prior correlation parameter, choice of
scale of the Gaussian process prior, dimension of the proble m and hyperparameter choice in the
analysis of the international relations data-set.
H H∗auc(ﬁtting) auc(prediction)
2 2 0.9220 0.7912
2 5 0.9270 0.6959
2 10 0.9254 0.7800
5 2 0.9216 0.8327
5 5 0.9532 0.8125
5 10 0.9535 0.8658
Table 3: Sensitivity analysis of the dimention of latent spa ceH∗.
C.3 Data analysis
This section includes additional tables and ﬁgures support ing the analysis of the international rela-
tions data set in Section 3.
Figures 14and15present the estimates of model parameters whenever the 95% c redible inter-
vals for those entries do not include 0.
23estimate truea b
timenode
−2−1012value
Figure 11: Parameter estimation for a,b. Top and bottom panels indicate matrices for aandb
respectively. Left and right panels indicate estimate and t rue values respectively. The rows for
each matrix represent different nodes while columns repres ent different time point.
−3−2−101
0 10 20 30 40
timea5(t)(a)
−202
0 10 20 30 40
timeb11(t)(b)
Figure 12: Parameter estimation for a5(t)andb11(t). (a) and (b) indicate graphical summarise of
trajectories of sampled a5(t)andb11(t)respectively. The solid line and dash line represent true an d
estimated values. The grey ribbon represents 95% highest po sterior density intervals.
24ρx(DGT)ρx0(ﬁt)ρab(DGT)ρab0(ﬁt) auc(ﬁtting) auc(prediction)
0.5 0.5 0.5 0.5 0.9254 0.7801
0.8 0 0.5 0.5 0.9254 0.7801
0 0.5 0.5 0.5 0.9284 0.8242
0.5 0.5 0.8 0 0.9264 0.8626
0.5 0.5 0 0.5 0.9262 0.8290
0.8 0 0.8 0 0.9299 0.8033
0 0.5 0 0.5 0.9260 0.8240
0.8 0 0 0.5 0.9291 0.7650
0 0.5 0.8 0 0.9331 0.8676
Table 4: Sensitivity analysis of the correlation between se nder effect and receiver effect ρx,ρab.
DGT represents data generating process.
k auc(ﬁtting) auc(prediction)
0.001 0.8979 0.8761
0.01(true) 0.9117 0.8468
0.05 0.9254 0.7801
0.1 0.9345 0.8087
Table 5: Sensitivity analysis of the length scales of Gaussi an process priors k.
V N AUC(ﬁtting) AUC(prediction)
15 40 0.8512 0.9270
30 20 0.8027 0.9043
40 20 0.8242 0.9112
30 30 0.8257 0.8956
Table 6: Sensitivity analysis of different nodes and time po ints settings.
H∗a k AUC(ﬁtting) AUC(prediction)
5 2 0.1 0.8792 0.7685
10 2 0.1 0.8865 0.7688
5 10 0.1 0.8680 0.7666
5 2 0.01 0.8748 0.8405
Table 7: Sensitivity analysis of the hyperparameter settin g for real data analysis.
25sender receiver mean lower (5%) upper (95%)
Russia Spain 0.570 0.215 0.824
Mexico Spain 0.570 0.187 0.836
Spain Mexico 0.555 0.174 0.835
Spain Russia 0.536 0.162 0.817
Brazil Spain 0.526 0.143 0.807
Spain Turkey 0.513 0.118 0.811
Spain Brazil 0.509 0.141 0.791
Japan Australia 0.495 0.112 0.782
Turkey Spain 0.484 0.082 0.800
Switzerland Spain 0.465 0.013 0.832
Germany India 0.463 0.079 0.751
France Spain 0.456 0.064 0.761
Spain United Kingdom 0.455 0.031 0.769
India Germany 0.452 0.065 0.756
Russia Brazil 0.449 0.054 0.753
Turkey Switzerland 0.440 0.001 0.763
Spain Germany 0.435 0.006 0.775
Japan India 0.427 0.029 0.751
Mexico Brazil 0.422 0.041 0.748
Germany Spain 0.417 0.003 0.752
Brazil Mexico 0.408 0.012 0.734
France India 0.401 0.017 0.722
Table 8: Top 20 countries pairs with highest temporal recipr ocity, represented by posterior mean
and credible intervals for the correlation between Sij(tj)andSji(tj−1).
26−0.50.00.5
0 100 200 300
countries pairslag1−correlation
Figure 13: Parameter estimation for temporal reciprocity. we plot the credible intervals for the
correlation between Sij(tj)andSji(tj−1). The pairs (i,j)are ordered by their posterior mean and
we list the top 20 country pairs in Table 8.
a(sender) b(receiver)
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q12007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1United StatesUnited KingdomTurkeySwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoJapanItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
−202value
Figure 14: Parameter estimation for aandb(plots of values for which the 95% credible interval
does not include 0). The left and right panels indicate poste rior means for aandbrespectively. The
rows of each matrix represent different countries while col umns represent different time points.
27sender receiver
2007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q12007Q12008Q12009Q12010Q12011Q12012Q12013Q12014Q12015Q12016Q1United StatesUnited KingdomSwitzerlandSpainSouth KoreaRussiaNetherlandsMexicoItalyIndonesiaIndiaGermanyFranceCanadaBrazilAustralia
0.250.500.75value
Figure 15: Parameter estimation of πij(t)for Japan (plots of values for which the 95% credible
interval does not include 0). The left and right panels indic ate posterior means of πij(t)with Japan
as a sender (making visits to other countries) and a receiver (hosting visits from other countries)
respectively. The rows for each matrix represent different countries while columns represent dif-
ferent time points.
28