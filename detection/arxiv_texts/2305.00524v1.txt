arXiv:2305.00524v1  [math.AG]  30 Apr 2023MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS
OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Abstract. In this article we deﬁne generalized pairs ( X,B+β) whereX
is an analytic variety and βis a b-(1,1) current. We then prove that almost
all standard results of the MMP hold in this generality for compact K¨ ahler
varieties of dim X≤3. More speciﬁcally, we prove the cone theorem,
existence of ﬂips, existence of log terminal models, log canonical mo dels
and Mori ﬁber spaces, geography of log canonical and log terminal models,
etc.
Contents
1. Introduction 2
2. Preliminaries 4
2.1. Generalized Pairs 6
2.2. Generalized Models 8
2.3. Existence of Flips for Generalized Pairs 13
2.4. Generalized Surface MMP 16
2.5. Relative MMP for 3-Folds 21
3. Threefold generalized MMP 21
3.1. Running the MMP for R-Cartier Divisors 21
3.2. Existence of Log Terminal Models 23
3.3. Existence of Mori Fiber Space 36
3.4. Cone Theorem 40
3.5. Geography of Minimal Models 42
3.6. Minimal Models are Connected by Flops 44
Appendix A. Boucksom-Zariski Decomposition 46
References 50
Omprokash Das was partially supported by the Start–Up Research Grant(SRG), Grant
No. # SRG/2020/000348 of the Science and Engineering Research B oard (SERB), Govt.
Of India.
Christopher Hacon and Jos´ e Ignacio Y´ a˜ nez were partially suppo rted by NSF research
grantsno: DMS-1952522,DMS-1801851andbyagrantfromthe S imonsFoundation; Award
Number: 256202.
12 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
1.Introduction
In this article we will develop the minimal model program for generalize d
K¨ ahler surfaces and threefolds. Generalized pairs naturally arise in the con-
text of Kawamata’s canonical bundle formula and adjunction to lc ce nters,
and have been playing an increasingly important role in the birational g eom-
etry of complex projective varieties (see [ Kaw98], [FM00], [BZ16], [Bir21] and
references therein). It is natural to hope that these results ca rry over to the
context of K¨ ahler manifolds, especially for surfaces and threefo lds where the
usual minimal model program is known to hold (see [ HP16,HP15,CHP16],
[DO23], [DH20]andreferences therein). WeintroducegeneralizedK¨ ahler pairs
(Deﬁnition 2.7), in a context which is more general than the usual deﬁnition of
generalized pairs from projective geometry. Roughly speaking, a g eneralized
pair (X/S,B+β) consists of a proper morphism X→Sof normal K¨ ahler
varieties, a pair ( X,B), and a closed positive (1,1) current β∈H1,1
BC(X) which
is (bimeromorphically) nef over S(we refer the reader to Deﬁnition 2.7for
the technical nuances; we will denote the corresponding closed po sitive b-(1,1)
current by β, but for the purposes of this introduction, we will sometimes
abuse notation and just refer to β=βX, the trace of βonX). Note that
in the case of projective varieties one requires the more restrictiv e condition
thatβis aR-divisor (birationally nef over S). Thus, if H2(X,OX)/\e}atio\slash= 0 (and
hence NS(X)R/\e}atio\slash=H1,1
BC(X)), this allows us more ﬂexibility even in the projec-
tive case. This is particularly important in the K¨ ahler case as there m ay be
very few R-divisors whilst H1,1
BC(X) may contain many interesting classes. For
example, working in this generality allows us to:
(1) Prove the ﬁniteness of certain 3-fold minimal models (see Theor em
3.26).
(2) Show that diﬀerent 3-fold minimal models are connected by ﬂops (see
Theorems 3.26and3.29).
(3) Run the minimal model program with scaling of a K¨ ahler form ω(see
Theorems 3.21and3.23).
It is then possible to consider the various ﬂavors of singularities of t he minimal
model program for generalized pairs (klt, lc, dlt etc.) and to show se veral
natural properties (in all dimensions), such as the fact that gene ralized klt
singularities are rational, and if Xis Stein, then a generalized klt pair ( X,B+
β) is equivalent to a usual klt pair ( X,B+ ∆) and in particular it admits a
Q-factorization (see Theorem 2.19). In Section 2.4we give a treatment of the
generalized surface MMP including the cone theorem, theexistence of minimal
models and Mori ﬁber spaces, and the existence of log canonical mo dels when
KX+B+βis big. In Section 3.1we then develop the minimal model program
for 3-fold generalized klt pairs. We show that 3-fold klt ﬂips exist:MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 3
Theorem 1.1. Let(X,B+β)be a compact K¨ ahler Q-factorial 3-fold gener-
alized klt pair, and f:X→Za ﬂipping contraction, then the ﬂip X+→Z
exists.
Provingtheterminationofﬂipsinthisgeneralityhowever turnsoutt obetoo
diﬃcult. Instead, following the approach of [ BCHM10 ], we show that certain
generalized minimal model programs with scaling terminate. For exam ple, if
(X,B+β) is a compact K¨ ahler Q-factorial 3-fold generalized klt pair and
β=βXis K¨ ahler, then KX+B+tβis K¨ ahler for t≫0, and aKX+B+β
mmp with scaling of ( t−1)βis also aKX+Bmmp with scaling of tβand so,
in this case, termination follows from standard results on the termin ation of
ﬂips for the usual klt 3-fold pair ( X,B). This allows us to prove the existence
of minimal and canonical models.
Theorem 1.2. Let(X,B+β)be a generalized compact klt K¨ ahler 3-fold pair.
(1) IfKX+B+βXis big, then (X,B+β)has a log terminal model
f:X/axisshort/axisshort/arrowaxisrightXmand a unique log canonical model g:Xm→Xc.
(2) IfKX+B+βXis pseudo-eﬀective and βXis big, then KX+B+βX
has a log terminal model f:X/axisshort/axisshort/arrowaxisrightXmand there is a contraction
g:Xm→Zsuch thatf∗(KX+B+βX)≡g∗ωZwhereωZis a K¨ ahler
form onZ.
For more general minimal model programs with scaling, termination o f ﬂips
is achieved by studying Shokurov polytopes and the geography of m inimal
models. In particular we show the following (please see Theorems 3.19and
3.26for a more comprehensive statement).
Theorem 1.3. LetXbe a smooth compact K¨ ahler 3-fold, Ba simple normal
crossings divisor, and Ωa compact convex polyhedral set of closed positive
(1,1)-currents such that [β]is nef and [KX+B+β]is big for all β∈Ω.
Then there exist a ﬁnite polyhedral decomposition Ω =∪Ωiand ﬁnitely many
bimeromorphic maps ψi,j:X/axisshort/axisshort/arrowaxisrightXi,jsuch that if ψ:X/axisshort/axisshort/arrowaxisrightYis a weak log
canonical model for some β∈Ω, thenψ=ψi,jfor somei,j.
Building on this result, we are able to show that good minimal models are
connected by ﬂops (andin general minimal models are connected by ﬂips, ﬂops
and anti-ﬂips).
Theorem 1.4. Let(Xi,Bi+βXi)be compact Q-factorial generalized klt K¨ ahler
3-folds, where KXi+Bi+βXiis nef (resp. (Xi,Bi+βXi)are good minimal
models) for i= 1,2andφ:X1/axisshort/axisshort/arrowaxisrightX2a bimeromorphic map which is an
isomorphism in codimension 1. Then φcan be decomposed as ﬂips, ﬂops and
inverse ﬂips, see Deﬁnition 3.28(resp.φcan be decomposed as a sequence of
ﬂips).4 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
WhenKX+B+βXis not pseudo-eﬀective, we show the existence of Mori
ﬁber space, see Theorem 3.23.
Theorem 1.5. Let(X,B+β)be a generalized klt K¨ ahler 3-fold such that
KX+B+βXis not pseudo-eﬀective. Then we can run a KX+B+βX-MMP
X/axisshort/axisshort/arrowaxisrightX′ending with a Mori ﬁber space X′→Z.
We also establish the following cone theorem.
Theorem 1.6. Let(X,B+βX)be aQ-factorial generalized klt pair, where X
is a compact K¨ ahler 3-fold. Then there are at most countably many rational
curves{Γi}i∈Isuch that
NA(X) =NA(X)KX+B+βX≥0+/summationdisplay
i∈IR+[Γi],
and−(KX+B+βX)·Γi≤6. Moreover, if βXis big, then Iis ﬁnite.
We believe that the added ﬂexibility aﬀorded by working with nef classe s in
H1,1
BCwillbeusefulinavarietyofcontexts. Forexample, weusethiswhen show-
ing that bimeromorphic Calabi-Yau threefolds are connected by ﬂop s (Theo-
rem3.29), and we expect that it will be important in the proof of the minimal
model program for klt pseudo-eﬀective K¨ ahler 4-folds [ DH23]. Note that the
case of eﬀective klt K¨ ahler 4-folds was addressed in [ DHP22].
This article is organized in the following manner: In Section 2 we deﬁne
generalized pairs, generalized models and establish the generalized M MP for
K¨ ahler surfaces. We also the prove Theorem 1.1in this section. Section 3 is
the heart of our article, Theorem 1.2is proved in Subsection 3.2, Theorem
1.5is proved in Subsection 3.3, Theorem 1.6is proved in Subsection 3.4, and
Theorem 1.4is proved in Subsection 3.6.
Acknowledgement We would like to thank Mihai P˘ aun for answering our
questions.
2.Preliminaries
Ananalytic variety or simply a varietyXis a reduced and irreducible com-
plex space. A holomorphic map f:X→Ybetween two complex spaces is
called amorphism . Asmall bimeromorphic map or asmall map is a bimero-
morphic map φ:X/axisshort/axisshort/arrowaxisrightX′between two normal analytic varieties such that
φis an isomorphism in codimension 1, i.e. there are closed analytic subset s
Z⊂XandZ′⊂X′such that codim XZ≥2 and codim X′Z′≥2 and
φ|X\Z:X\Z→X′\Z′is an isomorphism. A (1 ,1) classα∈H1,1
BC(X) is
calledgeneral(resp.very general ) ifαis not contained in any ﬁnite union
(resp. countable union) of analytic subvarieties of H1,1
BC(X).MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 5
Deﬁnition 2.1. LetXbe a normal analytic variety. The canonical sheaf
ωXis deﬁned as ωX:= (∧dimXΩ1
X)∗∗. Note that unlike the case of algebraic
varieties,ωXhere does not necessarily correspond to a Weil divisor KXsuch
thatωX∼=OX(KX). However, by abuse of notation we will say that KXis a
canonical divisor when we actually mean the canonical sheaf ωX. This doesn’t
create any problem in general as running the minimal model program involves
intersecting subvarieties with ωX.
AQ-divisor (resp. an R-divisor) on a normal analytic variety (non necessarily
compact) is a ﬁnite sum of prime Weil divisor with Q-coeﬃcients (resp. R-
coeﬃcients). A compact normal analytic variety Xis called Q-factorial if for
every prime Weil divisor D⊂Xthere is am∈Z+such thatmDis Cartier
and there is a k∈Z+such that (ω⊗k
X)∗∗is a line bundle on X.
For a normal analytic variety Xand aR-divisorBwe say that KX+Bis
R-Cartier, if locally around any point x∈Xwe can choose a divisor KX
such that OX(KX)∼=ωXandKX+BisR-Cartier. In this case, we deﬁne
the singularities of the pair ( X,B) as in [KM98]. Note that throughout this
article, by a pair ( X,B), we will always mean that Xis normal,B≥0 is an
eﬀectiveR-divisor. If Bis not eﬀective, then we will refer to the corresponding
singularities of ( X,B) as sub-klt, sub-dlt, etc.
Deﬁnition 2.2. An analytic variety XisK¨ ahleror aK¨ ahler space if there
exists a positive closed real (1 ,1) formω∈ A1,1
R(X) such that the following
holds: for every point x∈Xthere exists an open neighborhood x∈Uand
a closed embedding ιU:U ֒→Vinto an open set V⊂CN, and a strictly
plurisubharmonic C∞functionf:V→Rsuch thatω|U∩Xsm= (i∂¯∂f)|U∩Xsm.
HereXsmis the smooth locus of X.
(1) On a normal compact analytic variety Xwe replace the use of N´ eron-
Severi group NS( X)RbyH1,1
BC(X), the Bott-Chern cohomology of real
closed (1,1) forms with local potentials or equivalently, the closed bi-
degree (1,1) currents with local potentials. See [ HP16, Deﬁnition 3.1
and 3.6] for more details. More speciﬁcally, we deﬁne
N1(X) :=H1,1
BC(X).
(2) IfXis in Fujiki’s class Cand has rational singularities , then from
[HP16, Eqn. (3)] we know that N1(X) =H1,1
BC(X)⊂H2(X,R). In
particular, the intersection product can be deﬁned in N1(X) via the
cup product of H2(X,R).
(3) For the deﬁnitions of nef, pseudo-eﬀective class, etc. see [ DH20, Deﬁ-
nition 2.2].
(4) We deﬁne NA(X)⊂N1(X) to be the closed cone generated by the
classes of positive closed currents of bi-dimension (1 ,1), see [HP16,
Deﬁntion 3.8]. The Mori cone NE(X)⊂NA(X) is deﬁned as the6 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
closure of the cone of currents of integration TC, whereC⊂Xis an
irreducible curve.
Deﬁnition 2.3. IfXis a normal K¨ ahler variety and ω∈H1,1
BC(X), then
we say that ωis modiﬁed K¨ ahler if there exists a bimeromorphic morphism
ν:X′→Xand K¨ ahler form ω′onX′such thatν∗ω′=ω. By [Bou04,
Proposition 2.3], if Xis compact, then this is equivalent to requiring that ω
contains a K¨ ahler current Twith Lelong number ν(T,D) = 0 for all prime
divisorsDinX.
Deﬁnition 2.4. Letπ:X→Sbe a proper morphism of normal K¨ ahler
varietiessuch that Sisrelatively compact. Let βbeaclosed (1 ,1)current with
local potentials, i.e. a locally ∂¯∂-exact current on X. We say that the class
[β]∈H1,1
BC(X) is relatively K¨ ahler (or K¨ ahler over S) if [β+π∗ωS]∈H1,1
BC(X)
is a K¨ ahler class for some K¨ ahler form ωSonS, and we say that the class [ β]
is relatively nef if [ β+ω] is relatively K¨ ahler for every relatively K¨ ahler class
[ω] onX. Similarly, we say that βis relatively modiﬁed K¨ ahler if β+π∗ωSis
modiﬁed K¨ ahler for some K¨ ahler form ωSonS.
It is well known that if a class [ β]∈H1,1
BC(X) is relatively K¨ ahler (resp.
relatively nef), then its restriction to each ﬁber is K¨ ahler (resp. n ef). By
abuse of notation we will say that a closed bi-degree (1 ,1) current Twith
local potentials is relatively K¨ ahler or relatively nef over Sif so is its class
[T]∈H1,1
BC(X).
2.1.Generalized Pairs. LetXbeanormalanalyticvariety. A closed b-(1,1)
currentβis a collection of closed bi-degree (1,1) currents βX′on all proper
bimeromorphic models X′→Xsuch that if p:X1→X2is a bimeromorphic
morphism of proper models of X, thenp∗βX1=βX2.
Supposethat βisaclosedpositive(1,1)-currenton Xwithlocal(psh)poten-
tials, thenwemaydeﬁneab-(1,1)current ¯βasfollows. Foranybimeromorphic
morphismν:X′→Xwe let¯βX′:=ν∗β. Explicitly, if X=∪Uiis an open
cover andγiare psh functions on Uisuch thatβ=∂¯∂γi, thenν∗βis deﬁned
by lettingU′
i=ν−1Ui,γ′
i=γi◦ν|U′
i, andν∗β=∂¯∂γ′
ionU′
i. Ifµ:X′→X′′is
another proper bimeromorphic morphism, then we let ¯βX′′=µ∗βX′. We note
that
Claim2.5.The closed b-(1,1) current ¯βX′′is well deﬁned.
Proof.Suppose that ˜ ν:˜X→Xand ˜µ:˜X→X′′are also proper bimeromor-
phic morphisms of normal complex varieties. By a standard argumen t, passing
to a common resolution, we may in fact assume that there is a bimerom orphic
morphismρ:˜X→X′such that ˜ν=ν◦ρand ˜µ:µ◦ρ. Then by the projection
formula we have
˜µ∗(˜ν∗β) =µ∗ρ∗(ρ∗ν∗β) =µ∗(ν∗β).MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 7
/square
Ifβ=¯βfor some closed positive (1,1)-current βonXthen we say that β
is a positive closed b-(1,1) current that descends to X. Note that in this case
for any bimeromorphic morphism ν:X′→Xwe also have that β=βX′i.e.
βalso descends to X′.
Remark2.6.We make the following observations:
(i) Note that if γ∈H1,1
BC(X′) is nef, then it is pseudo-eﬀective and so
we may choose a positive closed (1,1) form β′onX′with psh local
potentials such that [ β′] =γand we may then set β:=¯β′. Diﬀerent
choices ofβ′give rise to diﬀerent (non-equivalent) generalized pairs.
(ii) Notethatif βisapositiveclosedb-(1,1)currentthatdescendsto Xand
X/axisshort/axisshort/arrowaxisrightX′is bimeromorphic (and X′is normal), then βX′may not have
local potentials, but if it does, then it has psh local potentials. To se e
this, ﬁrst note that in this case [ βX′]∈H1,1
BC(X′). Letp:X′′→Xand
q:X′′→X′be a common resolution and U′:=X′\(X′
sing∪q(Ex(q)))
so thatU′′:=q−1U′→U′is an isomorphism. Then βX′|U′=βX′′|U′′,
and since βX′′is a positive current, from [ BG13, Proposition 4.6.3(i)]
it follows that βX′|U′has a unique extension /hatwiderβX′|U′to a closed positive
(1,1) current on X′such that/bracketleftBig
/hatwiderβX′|U′/bracketrightBig
= [βX′].
Deﬁnition 2.7. Letf:X→Sbe a proper morphism of normal K¨ ahler
varieties, where Sis relatively compact, ν:X′→Xa resolution, B′anR-
divisor onX′with simple normal crossings support such that B:=ν∗B′≥0,
andβa closed b-(1,1) current. We say that ( X,B+β) is ageneralized pair if
(1)βis a positive closed b-(1,1) current that descends to X′,
(2) [βX′]∈H1,1
BC(X′) is nef over S, and
(3) [KX′+B′+βX′] =ν∗γfor someγ∈H1,1
BC(X).
Note that we are abusing notation as we are implicitly assuming the exis -
tenceof(X′,B′)asabove. Wewill saythat ν: (X′,B′)→(X,B)isastructure
morphism or alog resolution of (X,B+β).
Remark2.8.We make the following observations:
(i) Given (X,B+β) andβ′=βX′with the above properties, then B′is
uniquely determined (by the negativity lemma applied to ν:X′→X).
(ii) IfSis a point so that Xis compact, then we drop Sand say that
(X,B+β) is a compact generalized pair.
(iii) IfU⊂Xis a relatively compact subset, then ( U/U,B|U+β|U) is a
generalized pair over U.8 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
(iv) IfS=Xandπ:X→Sis the identity (and in particular Xis
relatively compact), then we also drop Sand we often abuse notation
and say that ( X,B+β) is a generalized pair.
Deﬁnition 2.9. (1) LetPbe a prime Weil divisor over X. We deﬁne the
generalized discrepancy a(P,X,B+β) as follows: Let ν:X′→Xbe
a log resolution of ( X,B+β) such that P⊂X′is prime Weil divisor
onX′. Thena(P,X,B+β) :=−multP(B′). Note that these can be
computed locally over Xand henceSplays no role here (and hence we
drop it from the notation).
(2) We say that ( X,B+β) isgeneralized klt or gklt or generalized Kawa-
mata log terminal (resp. generalized lc or glc or generalized log canon-
ical) if for some log resolution ν′:X′→X, we have ⌊B′⌋ ≤0, i.e.
a(P,X,B+β)>−1 for all prime divisors P⊂X′(resp.a(P,X,B+
β)≥ −1 for all prime divisors P⊂X′).
(3) We say that ( X,B+β) isgeneralized dlt or gdlt or generalized di-
visorially log terminal if there is an open subset U⊂Xsuch that
(U,(B+β)|U)isalogresolution(ofitself) and −1≤a(P,X,B+β)≤0
for any prime divisor PonUand−1< a(P,X,B+β)≤0 for any
prime divisor PoverXwith center contained in X\U.
Remark 2.10.By abuse of notation we will often say βis a (1,1) class in
H1,1
BC(X) when we actually mean βis a closed positive bi-degree (1 ,1) current
onXwith local (psh) potentials. Especially, we will often add a K¨ ahler for m
ωto a generalized pair ( X,B+β) while calling it a K¨ ahler class; however, this
doesn’t create any problem as a K¨ ahler form ωonXdeﬁnes a b-(1,1) current
asω:= ¯ωwhich descends to Xand [ωX]∈H1,1
BC(X) is nef (in fact K¨ ahler), so
the singularities of ( X,B+β+ω) are the same as those of ( X,B+β).
2.2.Generalized Models.
Deﬁnition 2.11. If (X/S,B+β) is a generalized dlt pair over S, then we
say that a bimeromorphic map φ:X/axisshort/axisshort/arrowaxisrightXm(proper over S) is alog minimal
model over S(resp. a log terminal model overS) if (1-3) below hold (resp.
(1-4) below hold).
(1) (Xm,Bm+β) isQ-factorial generalized dlt pair, where Bm=φ∗B+E,
andEis the reduced sum of all φ−1-exceptional divisors,
(2)KXm+Bm+βXmis nef overS,
(3)a(P,X,B,β)<a(P,Xm,Bm,β)foreveryφ-exceptional divisor P, and
(4) there are no φ−1-exceptional divisors i.e. E= 0.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 9
If (X/S,B+β) is a generalized dlt pair over S, then we say that a bimero-
morphic map φ:X/axisshort/axisshort/arrowaxisrightXm(proper over S) is aweak log canonical model over
S(resp. alog canonical model over S) if (1-3) below hold (resp. (1-4) below
hold).
(1) (Xm,Bm+β) is generalized lc pair, where Bm=φ∗B+E, andEis
the reduced sum of all φ−1-exceptional divisors,
(2)KXm+Bm+βXmis nef overS,
(3)a(P,X,B,β)≤a(P,Xm,Bm,β)foreveryφ-exceptional divisor P, and
(4) [KX′m+Bm+βXm]∈H1,1
BC(Xm) is a K¨ ahler class.
IfXis proper and Sis a point, then we drop “over S” and simply say that
we have a log minimal model, log terminal model etc.
Lemma 2.12. Suppose that (X/S,B+β)is generalized dlt over S.
(1) Ifφ:X/axisshort/axisshort/arrowaxisrightXmis aweaklog canonicalmodelover S, thena(P,X,B,β)≤
a(P,Xm,Bm,β)for everydivisor PoverXanda(P,X,B,β) =a(P,Xm,Bm,β)
for every divisor PonXm.
(2) IfX/axisshort/axisshort/arrowaxisrightXmandX/axisshort/axisshort/arrowaxisrightXware weaklogcanonicalmodelsof (X/S,B+
β)overS, then(Xm,Bm+β)and(Xw,Bw+β)are crepant equivalent,
i.e. ifp:Z→Xmandq:Z→Xwis a resolution of the induced map
Xm/axisshort/axisshort/arrowaxisrightXw, thenp∗(KXm+Bm+βXm)≡Sq∗(KXw+Bw+βXw).
(3) IfX/axisshort/axisshort/arrowaxisrightXmandX/axisshort/axisshort/arrowaxisrightXware log canonical models of (X/S,B+β)
overS, then(Xm,Bm)and(Xw,Bw)are isomorphic.
(4) If(X,B+β)is generalized klt, then every log minimal model over S
is a log terminal model over S.
(5) Iff:X′→Xis a log resolution of (X/S,B+β)andKX′+B∗+βX′=
f∗(KX+B+βX) +F, whereB∗≥0,f∗B∗=BandF≥0isf-
exceptional such that for every f-exceptional divisor Pwitha(P,X,B+
β)>0we haveP⊂Supp(F). Then any log minimal model (resp.
(weak) log canonical model) of (X′/S,B∗+β′)overSis a log minimal
model (resp. (weak) log canonical model) of (X/S,B+β)overS.
Proof.(1) Letp:Z→Xandq:Z→Xmbe a resolution of φ. Then we can
writeF=/summationtext(a(P,Xm,Bm,β)−a(P,X,B,β))P, where the sum runs over all
prime divisors P⊂Z. Then from the deﬁnition above it follows that p∗F≥0.
Note thatF≡Sp∗(KX+B+βX)−q∗(KXm+Bm+βXm), and hence F≥0 by
the negativity lemma, as KXm+Bm+βXmis nef overS. We also claim that
q∗F= 0. Observe that, here Bm=φ∗B+E, whereEis the reduced sum of
φ−1-exceptional divisors on Xm. Thus it is enough to show that mult P(F) = 0
for any prime divisor Pin the support of E(i.e. anyp-exceptional divisor
which is not q-exceptional). We have
−1 =a(P,Xm,Bm+β)≥a(P,X,B+β)≥ −1,10 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
where the second inequality holds because F≥0. In particular, we have
a(P,X,B+β) =a(P,Xm,Bm+β)
for all prime Weil divisors PonXm.
(2) Follows easily by what we have seen in (1).
(3) LetWbe the normalization of the graph of Xm/axisshort/axisshort/arrowaxisrightXw, andp:W→
Xm,q:W→Xwtheinduced morphisms. Thenbypart(2)wehave p∗(KXm+
Bm+βXm)≡q∗(KXw+Bw+βXw). Sincep,qare bimeromorphic, and hence
Moishezon morphisms, if Xm/axisshort/axisshort/arrowaxisrightXwis not an isomorphism, we may assume
that there is a curve C⊂Wsuch thatp∗C= 0 andq∗C/\e}atio\slash= 0 (orp∗C/\e}atio\slash= 0 and
q∗C= 0). But then
0 =p∗C·(KXm+Bm+βXm) =C·p∗(KXm+Bm+βXm)
=C·q∗(KXw+Bw+βXw)
=q∗C·(KXw+Bw+βXw)>0,
which is a contradiction.
(4) Suppose that φ:X/axisshort/axisshort/arrowaxisrightXmis a log minimal model and Pis aφ−1
exceptional divisor. Then as ( X,B) is klt and Pis contained in the support
ofBmwith multiplicity 1 (as Bm=φ∗B+Ex(φ−1)), from Part (1) we have
−1<a(P,X,B) =a(P,Xm,Bm) =−1,
which is impossible, and so there are no φ−1-exceptional divisors, i.e. φis a
log terminal model.
(5) See the proof of [ HL21, Lemma 3.10]. /square
Lemma 2.13. Let(X,B+β)be a generalized klt (resp. dlt) pair. If KX+B
isQ-Cartier, then (X,B)is klt (resp. dlt).
Proof.Since the statement is local on X, we may assume that Xis Stein and
relatively compact. Let f:X′→Xbe a log resolution and KX′+B′+βX′=
f∗(KX+B+βX), where ⌊B′⌋ ≤0, as (X,B+β) is generalized klt. Let
KX′+B♯:=f∗(KX+B). Then
f∗βX−βX′≡KX′+B′−f∗(KX+B) =:E,
whereE≥0 by the negativity lemma. But then
B′=E+f∗(KX+B)−KX′=B♯+EMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 11
and so⌊B♯⌋ ≤0, i.e. (X,B) is klt. The statement about dlt singularities
follows similarly. /square
Lemma 2.14. Letφ:X/axisshort/axisshort/arrowaxisrightYbe a bimeromorphic map of normal compact
K¨ ahler3-folds with Q-factorial klt singularities that extracts no divisors. Th en
the linear map φ∗:H1,1
BC(X)→H1,1
BC(Y)is well deﬁned and surjective.
Proof.From [DH20, Corollary 2.28] it follows that φ∗is well deﬁned. So it
only remains to show that φ∗is surjective. To that end, let p:W→X
andq:W→Ybe a resolution of the graph of φ. Replacing Wby a higher
resolution if necessary and then using the relative Chow lemma of Hiro naka
we may assume that p:W→Xis a projective morphism. Choose β∈
H1,1
BC(Y); then by [ DH20, Lemma 2.27] there is an R-divisorEsupported on
the exceptional locus of psuch thatq∗β+ [E] = 0 inH1,1
BC(W)/p∗H1,1
BC(X).
In particular, there is a α∈H1,1
BC(X) such that q∗β+ [E] =p∗αfor some
α∈H1,1
BC(X). Sinceφdoes not extract any divisor, Eis alsoq-exceptional.
Thereforeφ∗α=q∗p∗α=q∗(q∗β+[E]) =β, and hence φ∗is surjective. /square
Lemma 2.15. Letf:X′→Xbe a proper bimeromorphic morphism of nor-
mal compact K¨ ahler varieties. Assume further that XhasQ-factorial klt sin-
gularities and X′has rational singularities. Then Ex(f)is a pure codimension
1subset ofX′.
Proof.We claim that we can apply [ DH20, Lemma 2.27] here to show that
Ex(φ) has pure codimension 1. Indeed, if we assume this lemma in our case,
then for any K¨ ahler class ωXonX, we can write −ωX≡φ∗αX′+Ffor some
αX′∈H1,1
BC(X′) andFaφ-exceptional R-divisor. Then the negativity lemma
implies that Fis eﬀective and Supp( F) = Ex(φ), and we are done.
Now observe that in [ DH20, Lemma 2.27] it is assumed that the morphism φ
is projective and dimension of the varieties are 3, however, the pro jectivity of
φwas never used in the proof and the dimension argument was only nec essary
to run the relative MMP which can be achieved in arbitrary dimension by
[DHP22, Theorem 1.4]. /square
Lemma 2.16. Letφ:X/axisshort/axisshort/arrowaxisrightX′be a small bimeromorphic map over Yof
normal compact K¨ ahler varieties such that XandX′both have klt singularities
andX′isQ-factorial. Let ω∈H1,1
BC(X)be nefoverYsuch thatφ∗ω∈H1,1
BC(X′)
is K¨ ahler over Y. Thenφis an isomorphism.
Proof.LetWbe the normalization of the graph of φandp:W→Xand
q:W→X′aretheinduced bimeromorphic morphisms. Write p∗ω=q∗ω′+E,12 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
whereEis anR-divisor. Since φis small, from the negativity lemma it follows
thatE= 0, i.e.p∗ω=q∗ω′. Ifφis a not a morphism, then there is a curve
C⊂Wsuch thatp∗(C) = 0 but q∗(C)/\e}atio\slash= 0 and (f′◦q)∗(C) = 0, where
f′:X′→Yis the induced morphism. In particular, 0 = p∗ω·C=q∗ω′·C=
ω′·q∗(C)>0, a contraction. Thus φis a morphism. Then we arrive at a
contradiction by Lemma 2.15unlessφis an isomorphism.
/square
Deﬁnition 2.17. [Fuj22, Page 3] Let Xbe a normal analytic variety and
W⊂Xa ﬁxed compact subset. We say that W⊂XsatisﬁesProperty Pif
the following hold:
(P1)Xis a Stein space.
(P2)Wis a Stein compact subset of X.
(P3) Γ(W,OX) is noetherian (or equivalently, for any open subset U⊂X
and any analytic subset ZofU,W∩Zhas ﬁnitely many connected
components).
A projective morphism g:S→Tbetween analytic varieties is said to satisfy
Property QifSandTare both compact.
Remark 2.18.LetXbe a normal analytic variety and for each point x∈X,
letx∈Ube a Stein open neighborhood. Since Uis locally compact, there
is a compact neighborhood x∈K⊂Uofx. Then by [ Fuj22, Lemma 2.5],
its holomorphically convex hull /hatwideKinUis Stein compact. Note that from
[Fuj22, Theorem 2.10] it follows that /hatwideK⊂Usatisﬁes Property Pif and only if
Γ(/hatwideK,OU) = lim− →/hatwideK⊂VΓ(V,OV), whereVis an open subset of U, is a noetherian
ring. But then from [ Fuj22, Lemma 2.16] we see that there is a Stein compact
subsetLsuch thatx∈/hatwideK⊂L⊂Usuch that Γ( L,OU) is noetharian. In
particular, every point x∈Xhas a Stein open neighborhood Uand a Stein
compact subset x∈L⊂Usuch thatUsatisﬁes Property P.
Theorem 2.19. Let(X,B+β)be a generalized klt pair, where Xrelatively
compact analytic variety. Then the following hold locally o verX:
(1)Xhas rational singularities,
(2) there exists a small bimeromorphic morphism µ:X♯→Xsuch that
X♯isQ-factorial,
(3) ifKX♯+B♯+βX♯=µ∗(KX+B+βX), thenβX♯≡X∆♯so that
(X♯,B♯+∆♯)is klt, and
(4) if∆ =µ∗∆♯, then(X,B+∆)is klt.
Proof.(1) immediately follows from (4) and [ Kol97, Corollary 11.14].MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 13
(2-3) From Remark 2.18, it follows that for any x∈Xthere is a Stein
compact subset x∈W⊂Xsuch thatXsatisﬁes Property P. In what follows
we work locally around Wi.e. we repeatedly shrink Xto a neighborhood of
W(without further mention). Let ν:X′→Xbe a projective log resolution
of (X,B+β) and write KX′+B′+βX′=ν∗(KX+B+βX). LetE= Ex(ν),
and for 0< ǫ≪1 deﬁneB∗:= (B′)>0+ǫEandF:= (B′)<0+ǫE. Then
KX′+B∗+βX′≡ν∗(KX+B+βX) +F, where the support of Fequals
the set of all ν-exceptional divisors, and ( X′,B∗+βX′) is generalized klt. In
particular, βX′≡XF−(KX′+B∗) whereF−(KX′+B∗) is anR-divisor, nef
overX. Asνis projective and Xis Stein, we may assume that F−(KX′+B∗)
is big and nef (over X). But then βX′≡X∆′, where ∆′≥0 is an eﬀective
R-divisor such that ( X′,B∗+∆′) is klt.
We may therefore run the relative KX′+B∗+∆′-MMP (see [ DHP22, The-
orem 1.4] and [ Fuj22, Theorem 1.8]) and hence we may assume that we have
a bimeromorphic map ψ:X′/axisshort/axisshort/arrowaxisrightX♯such that if F♯=ψ∗F,B♯=ψ∗B∗,
βX♯=ψ∗βX′and ∆♯=ψ∗∆′, then
F♯≡XKX♯+B♯+βX♯≡XKX♯+B♯+∆♯
is nef over Xso thatF♯= 0 by the negativity lemma. Therefore µ:X♯→
Xis a small bimeromorphic morphism, B♯=µ−1
∗BandX♯isQ-factorial.
Clearly (X♯,B♯+∆♯) is klt. Note that each step of the above MMP preserves
the numerical equivalence βX♯≡X∆♯, and in particular KX♯+B♯+βX♯=
µ−1
∗(KX+B+βX).
(4) By the Base-point free theorem [ Fuj22, Theorem 8.1], we have (locally
overX) thatKX♯+B♯+∆♯∼Q,X0 and the claim follows.
/square
We have following immediate corollary.
Lemma 2.20. Let(X,B+β)be a generalized klt (resp. dlt) pair, where X
is compact analytic surface. Then XisQ-factorial with rational singularities,
and(X,B)is klt (resp. dlt).
Proof.By Theorem 2.19,Xhas rational singularities. Then from [ Fuj21,
Lemma 3.10] it follows that XisQ-factorial. /square
2.3.Existence of Flips for Generalized Pairs. Inthissubsection weprove
the existence of ﬂips for generalized klt pairs in dimension 3.
Theorem 2.21. Let(X/S,B+β)be a generalized klt K¨ ahler 3-fold pair,
such thatKX+BisR-Cartier, and f:X→Zis aKX+B+βX-negative
small bimeromorphic morphism over S. Thenfis locally projective, the log14 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
canonical model f+:X+→Zfor(X,B+β)overZexists and there is an
f-exceptional rational curve Csuch that 0>(KX+B+βX)·C≥ −6.
Proof.LetC=∪Cibethesetofcurvescontractedby f. Assumeforsimplicity
thatCis connected. It suﬃces to construct the ﬂip locally around z=f(C)⊂
Z. Letz∈W⊂Zbe a relatively compact Stein open subset. Shrinking
W, we may assume that for every curve Ci, there is a Cartier divisor Dion
XW:=f−1Wthat intersects Citransversely and does not intersect Cjfor
j/\e}atio\slash=i. To construct Di, pick a general point xionCiand a suﬃciently small
neighborhood xi∈Ui⊂X. We identify xi∈Uiwith a locally closed analytic
subvarietyof CNandtakethedivisor Digivenbyageneralhyperplanethrough
xi. Shrinking Wand intersecting DiwithXW, we may assume that each Diis
a subvariety of XW. It then follows that if D=/summationtextdiDi, wheredi= [βX]·Ci,
thenD≡WβX.
Now letν:X′→Xbe a log resolution of the generalized pair ( X,B+β).
SinceKX+BisR-Cartier, we have [ βX]∈H1,1
BC(X), and so by Remark 2.8
we may write −E≡βX′−ν∗βXfor someν-exceptional R-divisorEonX′.
LetD′:=ν∗D−E|X′
W≡WβX′|X′
W. We may assume that ν:X′
W→Wis
projective (via Hironaka’s Chow lemma [ Hir75, Corollary 2]). Since D′is nef
and big over XW, replacing D′by anR-linearly equivalent divisor, we may
assume that ( X′
W,B′
W+D′) is sub-klt and hence ( XW,BW+D) is klt, since
KX′
W+B′
W+D′≡ν∗(KXW+BW+D). But then the required log canonical
modelX+
Wexists(see[ CHP16,Theorem4.3]). Inparticular, −(KXW+BW+D)
is ample over Wand sofis locally projective. The existence of f-exceptional
rational curve C⊂XWsuch that 0 >(KX+B+βX)·C= (KXW+BW+
D)·C≥ −6 now follows from [ DO23, Theorem 4.2]. /square
As an easy corollary, we will prove the existence of ﬂips. Recall that if
(X/S,B+β) is aQ-factorial compact K¨ ahler generalized klt 3-fold pair, then
aKX+B+βX-ﬂipping contraction over Sis a small bimeromorphic morphism
f:X→ZoverSsuch thatρ(X/Z) = 1, and −(KX+B+βX) is K¨ ahler over
Z. By deﬁnition, the ﬂip of f:X→Z, if it exists, is a small bimeromorphic
morphismf+:X+→ZoverSsuch thatX+is K¨ ahler over S, andKX++
B++βX+is K¨ ahler over Z. We need the following lemma ﬁrst.
Lemma 2.22. LetXbe a normal Q-factorial compact K¨ ahler variety, f:
X→Za 3-foldKX+B+βX-ﬂipping contraction of a generalized klt pair
overS, andf+:X+→Zthe corresponding ﬂip, then
(1)f+:X+→Zis uniquely determined,
(2)X+isQ-factorial, and
(3)ρ(X+/Z) = 1.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 15
Proof.Suppose that f′:X′→Zisanother ﬂipof f:X→Z, thenX+/axisshort/axisshort/arrowaxisrightX′
is a small bimeromorphic map over Z. LetYbe the normalization of the
graph and p:Y→X+andq:Y→X′are the induced morphisms, then
from the negativity lemma it follows easily that q∗(KX++B++βX+) =
p∗(KX′+B′+βX′). LetC⊂Ybe ap-exceptional curve. Then q∗C/\e}atio\slash= 0
and (f′◦q)∗C= 0. Thus we have
0<C·q∗(KX++B++βX+) =C·p∗(KX′+B′+βX′) = 0
whichisacontradiction. Therefore, therearenosuchcurvesand henceX+/axisshort/axisshort/arrowaxisright
X′is a morphism. Similarly, it follows that X′/axisshort/axisshort/arrowaxisrightX+is a morphism and
henceX+∼=X′; in particular, (1) holds.
LetG+be a prime Weil divisor on X+andGits strict transform on X.
ThenGisQ-Cartier, as XisQ-factorial. For any point p∈X+we must show
that there is a neighborhood of pon whichG+isQ-Cartier. This is clear if pis
not contained in the ﬂipped locus Ex( f+), so assume that p∈Ex(f+) and let
q=f+(p). Working locally over a neighborhood q∈W⊂Zas in the proof of
Theorem 2.21, we may assume that KXW+BW+Dis klt for some R-divisorD
onXWsuch thatD≡WβX|XWandthatX+→Wistherelative logcanonical
model forKXW+BW+D. Since−(KXW+BW+D) is ample over W, we may
pick aneﬀective R-divisor 0 ≤H∼R,WǫGW−1
2(KXW+BW+D)for 0<ǫ≪1
suchthat(XW,BW+D+H)iskltand −(KXW+BW+D+H)isampleover W.
ThenX+→Wis also the relative log canonical model for KXW+BW+D+H
overWand soKX+
W+B+
W+D++H+∼R,W1
2(KX+
W+B+
W+D+)+ǫG+
Wis
R-Cartier for 0 <ǫ≪1, and hence G+
WisQ-Cartier and (2) is proven.
(3) now follows from [ DH20, Lemma 2.27].
/square
Corollary 2.23. Let(X/S,B+β)be aQ-factorial compact K¨ ahler generalized
klt 3-fold pair, and f:X→Zis aKX+B+βX-ﬂipping contraction over S.
Thenfis locally projective, the ﬂip f+:X→ZforKX+B+βXoverZ
exists (and unique), and there is an f-exceptional rational curve Csuch that
0>(KX+B+βX)·C≥ −6.
Proof.Follows immediate from Theorem 2.21and Lemma 2.22. /square
Proof of Theorem 1.1.This follows from Corollary 2.23. /square
Lemma 2.24. Letπ:X→Sbe a proper morphism of compact complex
varieties such that Xis K¨ ahler. If (X,B+β)is a generalized dlt pair and φ:
X/axisshort/axisshort/arrowaxisrightX′is aKX+B+βXﬂip, ﬂipping contraction or divisorial contraction,
thenX′is K¨ ahler.16 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Proof.Letωbe a K¨ ahler form such that γ=KX+B+βX+ωis a supporting
hyperplane for the KX+B+βX-negative extremal ray. If f:X→Zis the
correspondingcontraction, then γZ=KZ+BZ+βZ+ωZ=f∗(KX+B+βX+ω)
isgeneralizeddltandhence Zhasrationalsingularities. Butthen, bytheproof
of [CHP16, Corollary3.8], γZisK¨ ahler (over S). Suppose nowthat f:X→Z
is a ﬂipping contraction and let f+:X+→Zbe the ﬂip, then −ω+=−φ∗ω
is K¨ ahler over Zand so, for any 0 <ǫ≪1,
KX++BX++βX++(1−ǫ)ω+≡f+∗γZ−ǫω+
is K¨ ahler on X+. /square
2.4.Generalized Surface MMP. We begin by recalling the following well
known fact.
Lemma 2.25. Ifα∈H1,1
BC(X)is pseudo-eﬀective but not nef on a normal
compact K¨ ahler surface X, then/integraltext
Cα<0for some curve C⊂X.
Proof.Follows immediately from [ DHP22, Theorem 2.36]. /square
Lemma 2.26. Letf:X→Ybe a proper bimeromorphic morphism of normal
compact K¨ ahler surfaces with rational singularities. If α∈H1,1
BC(X)is nef and
αY:=f∗α, thenαY∈H1,1
BC(Y)is nef.
Proof.Passing to a resolution of singularities of Xwe may assume that Xis
smooth. Now recall that by the Hodge index theorem the intersect ion matrix
of the set of all f-exceptional curves is a negative deﬁnite matrix. Therefore
there is an f-exceptional R-divisorEonXsuch thatα+E≡Y0. By [HP16,
Lemma 3.3], α+E=f∗αYforsomeαY∈H1,1
BC(Y), andthus αY=f∗(f∗αY) =
f∗(α+E) =f∗α. From the the negativity lemma it follows that E≥0. Thus
αYis pseudo-eﬀective, and so by Lemma 2.25, it suﬃces to check that αY|Cis
pseudo-eﬀective, i.e. that/integraltext
CαY≥0 for all curves C⊂Y. IfC′=f−1
∗C, then
we have /integraldisplay
CαY=/integraldisplay
C′α+(E·C′)≥0,
sinceC′is not contained in the support of Eandαis nef. /square
An immediate corollary of this lemma is the following.
Corollary 2.27. If(X,B+β)is a compact generalized lc pair such that Xis a
compact K¨ ahler surface with rational singularities, then βXhas local potentials
onXand[βX]∈H1,1
BC(X)is nef.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 17
Deﬁnition 2.28. LetXbe a compact analytic variety. The Neron-Severi
R-vector space of Xis deﬁned as:
NS(X)R:= Im(Pic(X)→H2(X,R)).
Lemma 2.29. LetXbe a normal compact K¨ ahler variety with rational sin-
gularities. If H2(X,OX) = 0, thenXis projective and NS(X)R=H1,1
BC(X).
Proof.SinceH2(X,OX) = 0, from the usual exponential sequence it follows
that Pic(X)։H2(X,Z) is surjective. Since Xis compact, all singular ho-
mology groups of Xare ﬁnitely generated Z-modules, and thus by the Uni-
versal Coeﬃcient Theorem we have H2(X,Z)⊗ZR=H2(X,R). Therefore
NS(X)R=H2(X,R). Now consider the following short exact sequence (see
[HP16, page 223])
(2.1) 0/d47/d47R/d47/d47OX/d47/d47HX/d47/d470.
The associated long exact sequence of cohomology yields
(2.2)
0/d47/d47H1(X,R)/d47/d47H1(X,OX)/d47/d47H1(X,HX)/d47/d47H2(X,R)/d47/d47H2(X,OX)/d47/d47···.
Letπ:ˆX→Xbe a resolution of singularities of X. SinceXhas rational
singularities, H1(ˆX,R)∼=H1(X,R) andH1(ˆX,OˆX)∼=H1(X,OX). Since ˆX
is a compact K¨ ahler manifold, from the Hodge decomposition it follows that
H1(ˆX,R)→H1(ˆX,OˆX)isanisomorphism, andthus H1(X,R)→H1(X,OX)
is an isomorphism. In particular, from the sequence ( 2.2) and the fact that
H2(X,OX) = 0, it follows that H2(X,R)∼=H1(X,HX) :=H1,1
BC(X). This
completes our proof.
/square
In the next few results we will establish the cone theorem and existe nce of
minimal models (and Mori ﬁber spaces) for generalized pairs in dimens ion 2
which will be used in rest of the articles in without reference.
Lemma 2.30. Let(X,B)be a dlt pair, where Xis a compact K¨ ahler sur-
face. Then there exists countably many rational curves {Γi}i∈Isuch that
0<−(KX+B)·Γi≤4and
NA(X) =NA(X)(KX+B)≥0+/summationdisplay
i∈IR+·[Γi].
Proof.From Lemma 2.20it follows that XhasQ-factorial rational singulari-
ties. First assume that KX+Bis pseudo-eﬀective. Then from Lemma 2.25
it follows that KX+Bis nef if and only if ( KX+B)·C≥0 for every curve
C⊂X. LetKX+B≡/summationtext
i∈IλiCi+βbe the Boucksom-Zariski decomposition
as in [Bou04], whereλi≥0 for alli∈I⊂N(a ﬁnite subset) and β·C≥0 for18 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
every curve C⊂X. Now ifKX+Bis not nef, then there is a curve Γ ⊂X
such that (KX+B)·Γ<0. This implies that (/summationtext
i∈IλiCi)·Γ<0, in particular,
Γ =Cifor somei∈Iand Γ2<0. Then the rest of proof works similarly as in
the proof of [ DO23, Theorem 6.1]. The length bound 0 >(KX+B)·Γ≥ −4
follows from [ DO23, Theorem 4.2].
Now assume that KX+Bis not pseudo-eﬀective. Then KXis not pseudo-
eﬀective. Let ν:/tildewideX→Xbe the minimal resolution of singularities of X.
Then from [ DH20, Lemma 2.40] it follows that /tildewideXis an uniruled projective
surface. In particular, Xis Moishezon. Since Xis also a compact K¨ ahler
variety with rational singularities, from [ Nam02, Theorem 1.6] it follows that
Xis (uniruled) projective. Let π:X→Ybe the MRC(C) ﬁbration of X,
where dimY≤1. Then from the argument of [ DH20, Lemma 2.39] it fol-
lows thatH2(X,OX) = 0. In particular, from Lemma 2.29it follows that
NS(X)R=H2(X,R) =H1,1
BC(X), and hence NE(X) =NA(X) and the cone
theorem is well known in this case.
/square
Lemma 2.31. Let(X,B+β)be a generalized klt (resp. dlt) pair, where X
is a compact K¨ ahler surface. Then we can run the KX+B+βX-MMP
X=X0→X1→...→Xn
so that:
(1) each (Xi,Bi+βXi)is a generalized klt (resp. dlt) surface with Q-
factorial rational singularities (where Biis deﬁned by pushforward),
(2) ifKX+B+βXis pseudo-eﬀective, then KXn+Bn+βXnis nef, and
(3) ifKX+B+βXis not pseudo-eﬀective, then there is a KXn+Bn+βXn-
Mori ﬁber space f:Xn→Z.
Proof.By Lemma 2.20,XhasQ-factorial rational singularities. Then by
Lemma2.13, (X,B) is klt (resp. dlt). If KX+Bis nef, then KX+B+βXnef
by Corollary 2.27andwe are done. So assume that KX+Bis not nef. Suppose
that there is a KX+B-negative extremal ray Rwhich is also KX+B+βX-
negative (cf. Lemma 2.30). Then, by the usual MMP, there are two cases.
IfRdeﬁnes a Mori ﬁber space, then we are done. Otherwise, Rdeﬁnes a
divisorial contraction g:X→X′so that (X′,B′=g∗B) is klt (resp. dlt)
and in particular Q-factorial with rational singularities. From Corollary 2.27
it follows that βX′:=g∗βXhas local potentials and [ βX′]∈H1,1
BC(X′) is nef.
We may replace ( X,B+β) by (X′,B′+β=g∗(B+β)). The K¨ ahler condition
is preserved by Lemma 2.24. Repeating this procedure ﬁnitely many times we
may assume that either it terminates with a Mori ﬁber space or ever yKX+B-
negative extremal ray RisKX+B+βX-non-negative. In the latter case sinceMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 19
βXis nef (see Corollary 2.27), it then follows that KX+B+βXis non-negative
onNA(X) and hence nef. This concludes our proof. /square
Corollary 2.32. Let(X,B+β)be a generalized dlt pair, where Xis a compact
K¨ ahler surface. Then the following holds:
(1) There are at most countably many curves {Γi}i∈Isuch that 0>(KX+
B+βX)·Γi≥ −4and
NA(X) =NA(X)KX+B+βX≥0+/summationdisplay
i∈IR[Γi].
(2) IfFis a face spanned by a set of KX+B+βX-negative extremal
rays, then there is a contraction f:X→Ycontracting curves Cwith
[C]∈Fand either Yis a point, or a smooth projective curve or a
normalQ-factorial surface with rational singularities.
(3) If(X,B+β)is a generalized klt and B+βXorKX+B+βXis big,
thenIis ﬁnite.
Proof.(1) By Lemma 2.13, (X,B) is dlt with rational Q-factorial singularities.
By Corollary 2.27,βXis nef and so NA(X)KX+B≥0⊂NA(X)KX+B+βX≥0.
Thus by Lemma 2.30we have
NA(X) =NA(X)KX+B≥0+/summationdisplay
i∈IR[Γi] =NA(X)KX+B+βX≥0+/summationdisplay
i∈IR[Γi].
(2) Clearly Fis alsoKX+B-negative and hence the contraction exists by
the usual contraction theorem. Since we are unable to ﬁnd a refer ence for this
fact we recall an easy proof. Let γbe the supporting hyperplane so that γ
is nef andγ⊥∩NA(X) =F. Pick an extremal ray of F, sayR. By [Fuj19]
or [DO23, Theorem 6.2], we may contract Rto obtain another generalized dlt
K¨ ahler surface ( X′,B′+βX′) with rational Q-factorial singularities (see also
Lemma2.24). SinceX′has rational singularities and hence γ=ν∗(γ′), where
γ′∈H1,1
BC(X) is nef. Repeating this procedure, after ﬁnitely many steps we
may assume that γ′∈H1,1
BC(X) is K¨ ahler, and thus we have contracted the
faceF.
(3) We claim that if ψ∈H1,1
BC(X) is a big class, then there are at most
ﬁnitely many curves C⊂Xsuch that/integraltext
Cψ <0. To see this, note that for
some K¨ ahler form ω, the class [ ψ−ω] is still big. Let ψ−ω≡Z+Pbe
a Boucksom-Zariski decomposition such that Z≥0 is an eﬀective R-divisor
andPis a nef class (see [ Bou04, Proposition 2.4] and Lemma 2.25). But then
one sees that if/integraltext
Cψ <0, thenCis contained in the support of Z. Thus, if
KX+B+βXis big, then the claim immediately holds.20 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Suppose now that B+βXis big, then we may write B+βX≡Z+ω+P
as above. Thus
B+βX≡((1−ǫ)B+ǫZ)+((1−ǫ)βX+ǫ(ω+P))
where (X,(1−ǫ)B+ǫZ) is klt and (1 −ǫ)βX+ǫ(ω+P) is K¨ ahler for all
0<ǫ≪1. The ﬁniteness of KX+B+βXnegative extremal rays now follows
from the usual cone theorem. /square
Theorem 2.33. Let(X,B+β)be a generalized klt pair, where Xis a compact
K¨ ahler surface. If KX+B+βXis big, then (X,B+β)has a log canonical
model.
Proof.Byrunninga KX+B+βX-MMP,wemayassumethat α=KX+B+βX
is nef and big (Lemma 2.31). We claim that Null( α) consists of ﬁnitely many
curves. To see this, choose a K¨ ahler form ωsuch thatKX+B+βX−ωis also
a big class. Then, by the Boucksom-Zariski decomposition [ Bou04], we can
writeKX+B+βX−ω≡D+γ, whereDis an eﬀective R-divisor and γis a
modiﬁed nef class (and hence a nef class by Lemma 2.25). Choose 0 <ε≪1
such that (X,B+εD) is klt. Then
(1+ε)α= (KX+B+εD+βX)+ε(γ+ω).
Now ifC⊂Null(α) is a curve, then α·C= 0 implies that ( KX+B+εD+
βX)·C <0. SinceKX+B+εD+βXis big, by a similar argument as in the
proof of Corollary 2.32(3) it follows that there are ﬁnitely many such curves.
This proves our claim. Moreover, from the above equation it also follo ws that
ifC⊂Null(α) is a curve, then ( KX+B+εD)·C <0, and thus this curve
can be contracted. Repeating this process ﬁnitely many times (sinc e Null(α)
containsﬁnitelymanycurves) weobtainaprojectivebimeromorphic morphism
f:X→Zto a normal compact surface Zwith rational singularities such that
α=f∗αZand Null(αZ) =∅, whereαZ:=f∗(KX+B+βX) =:KZ+BZ+βZ.
Then from [ DHP22, Theorem 2.30] it follows that αZis a K¨ ahler class. Thus
(Z,BZ+βZ) is the log canonical model of ( X,B+βX).
/square
Remark 2.34.Note that by [ LP20, Example 6.2], it is not the case that all
generalized pairs have a good minimal model, however it is known that if βis
anR-divisor and KX+Bis pseudo-eﬀective, then good minimal models exist
[LP20, Corollary C]. It would be interesting to know if good minimal models
exist for generalized klt K¨ ahler surface pairs ( X,B+β) such that KX+Bis
pseudo-eﬀective and [ βX]∈H1,1
BC(X).MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 21
2.5.Relative MMP for 3-Folds.Using [DHP22, Theorem 5.2] we will show
thatwecanrunarelativeMMPfor propermorphismbetween K¨ ahlervarieties.
Theorem 2.35. Let(X,B)be aQ-factorial dlt pair, where Xis a compact
K¨ ahler3-fold. Letf:X→Zbe a proper morphism to a normal compact
K¨ ahler variety. Then we can run a KX+B-MMP over Zwhich terminates
with either a log terminal model over Zor a Mori ﬁber space over Z.
Proof.LetωZbe a K¨ ahler class on Z. We may assume that KX+Bis not nef
overZ. ThenKX+B+tf∗ωZis not nef on Xfor anyt≥0. From the cone
theorem [ DHP22, Theorem 5.2] we know that there are at most countably
many rational curves {Ci}i∈Isuch that 0 >(KX+B)·Ci≥ −6 for alli∈I
and
NA(X) =NA(X)(KX+B)≥0+/summationdisplay
i∈IR+·[Ci].
We claim that there is an i∈Isuch thatf∗Ci= 0. If not, then f∗ωZ·Ci=
ωZ·f∗Ci>0 for alli∈I, sinceωZis a K¨ ahler class on Z. Since the classes
[Ci] are contained in a discrete lattice of H4(X,Z), it follows that there is an
ǫ >0 such that ωZ·f∗Ci≥ǫfor alli∈I. Then for some t0≫0 we may
assume that t0f∗ωZ·Ci≥7 for alli∈I. Thus (KX+B+t0f∗ωZ)·Ci>0
for alli∈I, and hence KX+B+t0f∗ωZis nef onX, a contradiction. Now
we contract an extremal ray R=R+·[Ci] such that f∗Ci= 0 using [ DH20,
Theorem 1.7] and obtain a morphism g:X→Yto a normal K¨ ahler variety
Y. Then from the rigidity lemma it follows that there is a unique morphism
h:Y→Zsuch thatf=h◦g. Repeating this process we construct a MMP
overZ. Termination of ﬂips follow from [ DO23, Theorem 3.3].
/square
3.Threefold generalized MMP
3.1.Running the MMP for R-Cartier Divisors. Throughout this section
we will repeatedly use the results of [ DH20] on the 3-fold MMP for Q-factorial
compact K¨ ahler klt pairs ( X,B). Note that in this reference, the results are
stated for the case that KX+BisQ-Cartier, however, they also hold when
KX+Bis anR-Cartier divisor. This is because if KX+Bis anR-Cartier
divisor, then it can be approximated by a sequence of klt Q-Cartier divisors
KX+Bn(forexample, if XisQ-factorial, let Bn=1
n⌊nB⌋). The conetheorem
forKX+Biseasilyseentofollowfromtheconetheorem(cf. [ DH20, Theorems
2.17, 4.6]) applied to the sequence of Q-Cartier divisors KX+Bn. If Γ is a
KX+B-negative extremal ray, then it is also a KX+Bn-negative extremal
ray for any n≫0 and so the contraction of Γ, cΓ:X→Yexists by [ DH20,22 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Theorems 1.5 and 2.18]. Similarly, if X→Yis aKX+B-ﬂipping contraction,
then it is also a KX+Bn-ﬂipping contraction and hence the ﬂip X+→Y
exists [CHP16, Theorem 4.3]. The termination of ﬂips follows by the usual
arguments (see [ DO23, Theorem 3.3]).
Lemma 3.1. Let(X,B+β)be a compact generalized 3-fold pair with Q-
factorial rational singularities. If βXis not nef, then βX·C <0for some
curveC⊂Xcontained in the indeterminacy locus of f−1, wheref:X′→X
is a structure morphism of the generalized pair.
Proof.SinceKX+BisQ-Cartier, the current βXhas local potentials. Let
E:=KX′+B′−f∗(KX+B) =f∗βX−βX′,
whereEis exceptional, and so E≥0 is eﬀective by the negativity lemma
asβX′isf-nef. IfβXis not nef, then βX|Vis not pseudo-eﬀective for some
subvarietyV⊂X, by [DHP22, Theorem 2.36]. Since βX′is nef, it is pseudo-
eﬀective and hence so is β=f∗βX′, and hence dim V <3. If dimV= 2, let
V′=f−1
∗V; then (βX′+E)|V′=f∗βX|V′is pseudo-eﬀective and hence so is
βX|V. Thus dim V= 1 and it is easy to see that Vis contained in the image
ofEand hence in the indeterminacy locus of f−1. /square
Lemma 3.2. LetXbe a normal compact K¨ ahler 3-fold andωis a modiﬁed
K¨ ahler classon X. Thenfor anycountable collectionof non-numericallyequi v-
alent curves {Ci}i∈I, there is a positive real number b>0such thatω·Ci≥b
for all but ﬁnitely many curves. Moreover, if (X,B)is a log canonical pair for
someR-divisorB≥0and{Ci}i∈Iare all the rational curves generating the
KX+B-negative extremal rays of NA(X), then there are only ﬁnitely many
curves{Cj}j∈J,J⊂I, such that (KX+B+ω)·Cj<0for allj∈J.
Proof.Letf:X′→Xbe a resolution of singularities of Xandω′a K¨ ahler
class onX′such thatf∗ω′=ω. Thenf∗ω=ω′+E, whereEis af-
exceptional divisor. From the negativity lemma it follows that Eis eﬀective.
Since dimX= 3 andEisf-exceptional, dim f(SuppE)≤1. Therefore there
can be at most ﬁnitely many curves {Cj}j∈J,J⊂I, contained in f(SuppE).
In particular, ω·Ci=f∗ω·C′
i= (ω′+E)·C′
i>0 for alli∈I\J, where
C′
iis the strict transform of Ci. Note that these C′
iare also not numerically
equivalent. Moreover, since ω′is a K¨ ahler class, there is a positive real number
b>0 such that ω′·C′
i≥bfor alli∈I\J. In particular, ω·Ci≥ω′·C′
i≥b
for alli∈I\J.
If{Ci}i∈Iaregeneratorsof KX+B-negative extremal rays, then from[ DHP22,
Corollary 5.3] it follows that ( KX+B)·Ci≥ −6 for alli∈I. Therefore if
(KX+B+ω)·Ci<0 for somei∈I, thenω′·C′
i≤ω·Ci<−(KX+B)·Ci≤
6. Sinceω′is a K¨ ahler class, it follows that there are only ﬁnitely many
KX+B+ω-negative extremal rays. /squareMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 23
3.2.Existence of Log Terminal Models. In this subsection we will estab-
lish the existence of log terminal models and log canonical models, and prove
Theorem 1.2.
In the following two results we will show that we can run a MMP with scalin g
(which terminates after ﬁnitely many steps) when KX+B+βXis pseudo-
eﬀective and βXis a modiﬁed K¨ ahler class.
Proposition 3.3. Let(X,B)be aQ-factorial compact K¨ ahler 3-fold klt pair.
Letω∈H1,1
BC(X)be a modiﬁed K¨ ahler class, KX+B+ωis pseudo-eﬀective and
KX+B+(1+t)ωis nef for some t≥0. Then we can run a KX+B+ω-MMP
with scaling of tωwhich terminates with a log terminal model.
Proof.Letλ:= inf{t≥0 :KX+B+(1+t)ωis nef}.
Claim3.4.There exists a KX+B-negative extremal ray R+[C] such that
(KX+B+(1+λ)ω)·C= 0.
Proof.By [DHP22, Theorem 5.2], there are countably many KX+B-negative
extremal rays generated by curves {Ci}i∈Isuch that 0 >(KX+B)·Ci≥ −6.
Sinceωis a modiﬁed K¨ ahler class, by Lemma 3.2there is a ﬁnite subset I′⊂I
such that (KX+B+ω)·Ci≥0 if and only if i∈I\I′. LetI0⊂I′be the set
ofi∈I0such that (KX+B+(1+λ)ω)·Ci= 0.
We claim that I0/\e}atio\slash=∅. To see this, suppose that I0=∅, then there is a
positive real number b >0 such that ( KX+B+ (1 +λ)ω)·Ci> bfor any
i∈I′, and there is a positive real number c >0 such that ω·Ci≤cfor all
i∈I′. Recall that ( KX+B)·Ci≥ −6 for alli∈I. Choose a positive real
number 0<δ <min{λ, b/c}, then
(3.1) (KX+B+(1+λ−δ)ω)·Ci≥b−δc>0 for alli∈I′.
Since
KX+B+(1+λ−δ)ω=δ
λ(KX+B+ω)+(1−δ
λ)(KX+B+(1+λ)ω),
then (KX+B+(1+λ−δ)ω)·Ci≥0 for alli∈I\I′. Observe that
KX+B+(1+λ−δ)ω=δ
1+λ(KX+B)+/parenleftbigg
1−δ
1+λ/parenrightbigg
(KX+B+(1+λ)ω)
and soKX+B+ (1 +λ−δ)ωis non-negative on NA(X)KX+B≥0. Since by
[DHP22, Theorem 5.2],
NA(X) =NA(X)KX+B≥0+/summationdisplay
i∈IR+·[Ci],
thenKX+B+(1+λ−δ)ωisnon-negativeon NA(X)andsoKX+B+(1+λ−δ)ω
is nef, which is a contradiction to the deﬁnition of λ.
/square24 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Now, letR=R+·[C]beaKX+B-negativeextremalraysuchthat( KX+B+
(1+λ)ω)·C= 0; in particular, ω·C >0. Then, by [ DH20, Theorem 1.7], we
can contract this ray and obtain a morphism f:X→Yto a normal compact
K¨ ahler variety Ywith rational singularities. Note that fis bimeromorphic,
since it is also a contraction of a ( KX+B+ω)-negative extremal ray and KX+
B+ωis pseudo-eﬀective. If fis a ﬂipping contraction then let f′:X′→Ybe
the associated ﬂip (and if fis a divisorial contraction, let X′=Y), andB′,ω′
thepushforwards of BandωonX′. Notethat KX′+B′+(1+λ)ω′isnef andω′
is modiﬁed K¨ ahler. We now let λ′:= inf{t≥0 :KX′+B′+(1+t)ω′is nef}
and repeat the process. Note that 0 ≤λ′≤λand the process terminates
as there is no inﬁnite sequence of steps for any ( KX+B)-MMP by [ DO23,
Theorem 3.3]. /square
Corollary 3.5. Let(X,B)be aQ-factorial compact K¨ ahler 3-fold klt pair and
π:X→Sa proper surjective morphism to a K¨ ahler variety. Let ω∈H1,1
BC(X)
be a modiﬁed K¨ ahler class over S,KX+B+ωis pseudo-eﬀective over Sand
KX+B+(1+t)ωis nef overSfor somet≥0. Then we can run a KX+B+ω-
MMP over Swith scaling of tωwhich terminates with a log terminal model
overS.
Proof.Replacingωbyω+π∗ωSfor some K¨ ahler class ωSonS, we may assume
thatω∈H1,1
BC(X)isamodiﬁedK¨ ahlerclass, KX+B+ωispseudo-eﬀective, and
KX+B+(1+t)ωis nef. Let {Ci}i∈Ibetheset ofcurves generating all KX+B-
negative extremal rays of NA(X). Then from [ DHP22, Theorem 5.2] it follows
that0<−(KX+B)·Ci≤6foralli∈I. SinceKX+B+(1+t)ωisnef,itfollows
thatω·Ci>0 foralli∈I. Inparticular, wehave ( KX+B+(1+λ)ω)·Ci≥ −6
for any 0 ≤λ≤tand for all i∈I. Pick a K¨ ahler class ηSonSsuch that
C·ηS>6 for any curve ConS. Letω′:=ω+π∗ηS, thenω′is modiﬁed
K¨ ahler onX,KX+B+ω′is pseudo-eﬀective, and KX+B+(1+t)ω′is nef.
By Proposition 3.3, we may run the KX+B+ω′-MMP with scaling of tω′.
Let
λ:= inf{s≥0 :KX+B+ω′+s(tω′) is nef}.
Then by Claim 3.4there is aKX+B-negative extremal ray spanned by a
curveCisuch that (KX+B+(1+λ)ω′)·Ci= 0. We claim that π∗Ci= 0. If
not, i.e. ifπ∗Ci/\e}atio\slash= 0, then we have
0 = (KX+B+(1+λ)ω)·Ci+(1+λ)π∗η·Ci>−6+(1+λ)6>0
which is a contradiction. Therefore π∗Ci= 0 and so the corresponding ﬂip or
divisorial contraction is a step of the KX+B-MMP over S. Since there is no
inﬁnite sequence of KX+B-ﬂips (see [ DO23, Theorem 3.3]), we may repeat
this procedure ﬁnitely many times until we obtain a KX+B+ωminimal
model over S. /squareMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 25
We now prove the existence of log canonical model when KX+B+βXis
big. This is result is of fundamental importance and will be used repea tedly
in the rest of the article.
Theorem 3.6. Let(X,B+β)be a generalized klt pair, where Xis a compact
K¨ ahler3-fold. Assume that KX+B+βXis big. Then
(1)(X,B+βX)has a (unique) log canonical model,
(2) there exists a log terminal model and all such models admi t a morphism
to the log canonical model, and
(3) if[KX+B+βX]∈H1,1
BC(X)is very general, then there is a unique log
terminal model coinciding with the log canonical model.
Proof.We begin with the following reduction.
Claim3.7.We may assume that ( X,B) is log smooth and βXis a K¨ ahler
class.
Proof.Letf:X′→Xbeastructuremorphismofthegeneralizedpair( X,B+
β). SinceKX+B+βXis big, by [ Bou02, Theoreme 1.4] and passing to a
higher resolution if necessary, we may assume that f∗(KX+B+βX)≡F′+ω′,
whereω′is a K¨ ahler class and F′≥0 is an eﬀective Q-divisor. Let F+ω:=
f∗(F′+ω′), thenF≥0 andωis modiﬁed K¨ ahler. For any 0 < ǫ≪1,
(X,B+ǫF+β+ǫ¯ω) is generalized klt and KX+B+ǫF+βX+ǫω≡
(1+ǫ)(KX+B+βX). Thus, replacing ( X,B+β) by (X,ǫF+β+ǫ¯ω′), we
may assume that βX′is K¨ ahler for some log resolution f:X′→Xof the
generalized pair ( X,B+β).
LetE= Ex(f). By Lemma 2.12(5) and [ BCHM10 , Lemma 3.6.9], a log
terminal model (resp. the log canonical model) of KX′+(B′)≥0+ǫE+βX′,
whereE≥0 is aneﬀective Q-divisor such that Supp( E) = Ex(f) and 0≤ǫ≪
1 is also a log terminal model (resp. the log canonical model) of KX+B+βX.
Thus replacing ( X,B+β) by (X′,(B′)≥0+ǫE+β′+ǫ¯ω′), we may assume that
(X,B) is log smooth and βXis a K¨ ahler class. Note that if [ KX+B+βX]∈
H1,1
BC(X) is very general, then by [ DH20], after possibly perturbing E, we may
assume that [ KX′+(B′)≥0+ǫE+βX′+ǫω′] is very general in H1,1
BC(X′)./square
ThenKX+B+(1+t)βXis K¨ ahler for t≫0 andKX+B+βXis pseudo-
eﬀective, and thus by Proposition 3.3, we can run the KX+B+βX-MMP
with scaling of tβX. We obtain a log terminal model φ:X/axisshort/axisshort/arrowaxisrightXmsuch that
αm:=KXm+Bm+βXm=φ∗(KX+B+βX) is nef and big, and βXmis a
modiﬁed K¨ ahler class. Moreover, we also have that KXm+Bm+(1+ǫ)βXm
is nef (and big) for all 0 ≤ǫ≪1.
Claim3.8.After a ﬁnite sequence of αm-trivial steps of the KXm+Bm-MMP
Xm/axisshort/axisshort/arrowaxisrightXn, we may assume that ( KXn+Bn)·C≥0 for anyαn-trivial curve
C⊂Xn.26 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Proof.The proof follows exactly as in the proof of [ DH20, Theorem 6.4] where
it is shown that we may ﬂip and contract all KXm+Bm-negative extremal rays
that areαm-trivial. Note that in [ DH20] it is assumed that βXmis nef and
big, but the arguments of the proof only use that βXmis modiﬁed K¨ ahler. /square
Claim3.9.Null(αn) does not contain any surface.
Proof.This also follows from the proof of [ DH20, Theorem 6.4]. /square
Claim3.10.There is a proper bimeromorphic contraction π:Xn→Zcon-
tracting Null( αn) such that µ:Xm/axisshort/axisshort/arrowaxisrightZis also a morphism.
Proof.The morphism π:Xn→Zcontracting Null( αn) exists by [ DH20,
Proposition 6.2]. Following the proof of [ DH20, Theorem 6.4], we argue that
µ:Xm→Zis also anαm-trivial morphism. /square
Recall that KXm+Bm+(1+ǫ)βXmis nef. So from
ǫβXm= (KXm+Bm+(1+ǫ)βXm)−(KXm+Bm+βXm)
= (KXm+Bm+(1+ǫ)βXm)−αm
it follows that βXm·C≥0 for all curves C⊂Xmcontracted by µ:Xm→Z.
Thus−(KXm+Bm) isµ-nef-big, as −(KXm+Bm)|Xmz≡βXm|Xmzfor allz∈Z.
Then by [ DHP22, Lemma 8.8], Zhas rational singularities. Now since Zis in
Fujiki’s class C, by [HP16, Lemma 3.3] there exists a (1 ,1) classαZ∈H1,1
BC(Z)
such thatαm≡µ∗αZ. One then easily checks that Null( αZ) =∅and soαZis
K¨ ahler by [ DH20, Lemma 6.3]. Thus KZ+BZ+βZ:=µ∗(KXm+Bm+βXm)
is a log canonical model of KX+B+βX. The uniqueness of log canonical
models follows by (3) of Lemma 2.12; this proves (1).
(2)The fact that logterminal models admit a morphism to the logcano nical
model follows from the Claim 3.10above.
(3) Finally, suppose that [ KX+B+βX] is very general in H1,1
BC(X) and
π:Xm→Zis the morphism from a log terminal model Xmto the log
canonical model Z. From Lemma 2.14it follows that the induced morphism
φ∗:H1,1
BC(X)→H1,1
BC(Xm) is surjective, where φ:X/axisshort/axisshort/arrowaxisrightXm; in particular,
the class of KXm+Bm+βXmis very general in H1,1
BC(Xm). LetCbe a curve
contracted by π, then (KXm+Bm+βXm)·C= 0, contradicting the fact that
[KX+B+βX] is very general. Therefore πis a quasi-ﬁnite proper morphism
with connected ﬁbers, and hence an isomorphism.
/square
We will also need the following relative version of Theorem 3.6.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 27
Theorem 3.11. Let(X,B+β)be a generalized compact K¨ ahler 3-fold klt pair,
whereπ:X→Sis a morphism to a compact K¨ ahler variety and KX+B+βX
is big overS. Then the following hold:
(1)(X,B+βX)has a (unique) log canonical model X/axisshort/axisshort/arrowaxisrightXcoverS.
(2) There exists a log terminal model X/axisshort/axisshort/arrowaxisrightXmoverSsuch thatKXm+
Bm+βXm+p∗ωSis nef for some K¨ ahler form ωSonS(wherep:
Xm→Sis the corresponding morphism) and there is a morphism
Xm→Xc.
(3) If(Xm,Bm+βXm)is a log terminal model over S, thenKXm+Bm+
βXm+p∗ωSis nef for some K¨ ahler form ωSonS, and there is a
morphismXm→Xc.
Proof.Adding a suﬃciently large multiple of a K¨ ahler form ωSonS, we may
assume that KX+B+βXis big. Proceeding as in the proof of Theorem 3.6,
replacingXby a higher model, we may assume that βXis K¨ ahler so that
KX+B+ (1 +t)βXis also K¨ ahler for t≫0. As in the proof of Corollary
3.5, after adding the pullback of a suﬃciently large multiple of a K¨ ahler fo rm
ωSonS, we run the KX+B+βX-MMP with scaling of tβXwhich turns out
to be a MMP over S, and we obtain a log terminal model X/axisshort/axisshort/arrowaxisrightX′overS
such thatKXm+Bm+βXmis nef and hence also nef over S. By Theorem 3.6
there is a log canonical model ψ:Xm→XcforKXm+Bm+βXm+p∗ωS,
whereωSis a K¨ ahler class on S, andp:Xm→Sis the induced morphism.
Note thatψis a bimeromorphic morphism, so its ﬁbers are covered by curves
andψ:Xm→XccontractsKXm+Bm+βXm+p∗ωS-trivial curves. Since
KXm+Bm+βXmis nef andωSis K¨ ahler, any such curve must be vertical
overSand hence by the rigidity lemma (see [ BS95, Lemma 4.1.13]), there is
a morphism Xc→Sso thatψ:Xm→Xcis the log canonical model for
KXm+Bm+βXmoverS. Thus (1) and (2) hold.
Suppose now that X/axisshort/axisshort/arrowaxisrightXmis any log terminal model of KX+B+βX
overS. We begin by showing the following.
Claim3.12.There exists a K¨ ahler form ωSonSsuch thatKXm+Bm+βXm+
p∗ωSis nef.
Proof.IfKXm+Bm+βXmis nef, then the claim is obvious. Otherwise, let
X/axisshort/axisshort/arrowaxisrightXnbe the log terminal model of KX+B+βXoverSconstructed
in (2). Then KXn+Bn+βXn+q∗ωSis nef for some K¨ ahler class ωSon
S, whereq:Xn→Sis the corresponding morphism. Now, by Theorem
A.11,Xm/axisshort/axisshort/arrowaxisrightXnis an isomorphism in codimension 1 between log terminal
models ofKX+B+βXoverS, and hence it easily follows from the negativity
lemma that if r:W→Xmands:W→Xnis a common resolution,
thenr∗(KXm+Bm+βXm+p∗ωS) =s∗(KXn+Bn+βXn+q∗ωS). Since
KXn+Bn+βXn+q∗ωSis nef, so is KXm+Bm+βXm+p∗ωS. /square28 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Arguing as above, it follows easily that Xm→Xcis a morphism and hence
(3) also holds. /square
Theorem 3.13. Let(X,B+β)be a generalized klt pair, where Xis a compact
K¨ ahler3-fold. Then the following hold:
(1)Xhas rational singularities,
(2) there exists a small bimeromorphic morphism ν:Xq→Xsuch that
XqisQ-factorial, and
(3) there exists a bimeromorphic morphism ν:Xt→Xsuch thatXtis
Q-factorial and (Xt,Bt+β)is a generalized terminal pair such that
KXt+Bt+βXt=ν∗(KX+B+βX).
Note that a local version of (2) was proven in Theorem 2.19.
Proof.(1) follows from Theorem 2.19.
(2) Letf:X′→Xbe a projective log resolution of the generalized pair
(X,B+β). Fix 0< ǫ≪1 and letφ:X′/axisshort/axisshort/arrowaxisrightXqbe a log terminal model
ofKX′+f−1
∗B+ (1−ǫ)Ex(f) overXwhich exists by Theorem 3.11. Since
KX′+f−1
∗B+(1−ǫ)Ex(f)+βX′≡XFwhereF≥0 and Supp( F) = Ex(f),
it follows that Fq=φ∗F≥0 isfq:Xq→Xexceptional and Fqis nef
overXand so by the negativity lemma, Fq= 0. Therefore fqis a small
bimeromorphic morphism and XqisQ-factorial.
The proof of (3) is also standard and similar to the proof of (2) and s o we
omit it.
/square
The following theorem is a variant of the Base-point-free theorem [ DH20,
Theorem 1.7].
Theorem 3.14. Let(X,B+β)be a generalized klt pair, where Xis a compact
K¨ ahler 3-fold. Assume that KX+B+βXis nef but not big and βX′is big.
Then there is a morphism g:X→Zto a normal K¨ ahler variety Zsuch that
KX+B+βX=g∗αZ, whereαZis a K¨ ahler class on Z.
Proof.Note that if ν:X′→Xis a bimeromorphic morphism and f′:X′→Z
apropermorphism (notnecessarily bimeromorphic) ofnormalcomp act K¨ ahler
varieties such that ν∗α=f′∗αZ, whereαZis a K¨ ahler class on Z, thenf′
contracts all ν-vertical curves and so by the rigidity lemma (see [ BS95, Lemma
4.1.13]) there is a morphism f:X→Zsuch thatf◦ν=f′andα=f∗αZ.
Therefore by passing to a small Q-factorialization using Theorem 3.13we may
assume that XisQ-factorial and ( X,B+β) is terminal. Since βX′is nef and
big, possiblyreplacing X′byahigher model, wemayassume that βX′=F+ω′
whereF≥0 is an eﬀective R-divisor and ω′is K¨ ahler [ Bou02, Theoreme 1.4].MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 29
Pickǫ >0 such that ( X′,B′+ǫF) is sub-klt. Deﬁne B∗:=f∗(B′+ǫF) and
β∗:=f∗((1−ǫ)βX′+ǫω′). Then (X,B∗+¯β∗) is a generalized pair and β∗
is a modiﬁed K¨ ahler class. Note that KX+B∗+β∗≡KX+B+βX; thus
replacing (X,B+β) by (X,B∗+¯β∗) we may assume that βXis a modiﬁed
K¨ ahler class.
Now, ifKXis pseudo-eﬀective, then KX+B+βXis big, which is a contra-
diction. Therefore KXis not pseudo-eﬀective, and hence Xis uniruled.
Claim3.15.Letπ:X/axisshort/axisshort/arrowaxisrightTbe the MRCC ﬁbration. Then we may assume
that dimT= 2.
Proof.SinceXis uniruled, dim T≤2. If dimT≤1, then from the proof of
[DH20, Lemma 2.39] it follows that H2(X,OX) = 0. Thus Xis projective
and every (1 ,1) class is represented by an R-Cartier divisor. In particular,
(X,B+βX) is numerically equivalent to a traditional generalized pair for
projective varieties, i.e. [ βX′] =c1(N′), whereN′is a nef and big R-divisor
onX′andf:X′→Xis the given log resolution of ( X,B+βX). We then
haveN′∼RA′+E, whereA′is a general ample R-divisor and Eis an eﬀective
R-divisor. Therefore
KX′+B′+N′∼RKX′+B′+ǫE+(1−ǫ)N′+ǫA′=:KX′+B′′+N′′,
whereB′′:=B′+ǫE,N′′∼R(1−ǫ)N′+ǫA′is a general ample R-divisor
and (X′,B′′+N′′) is sub klt. But then ( X,∆ :=f∗(B′′+N′′)) is klt such
that ∆≥0 is big and KX+B+βX≡KX+∆. The conclusion now follows
from the base-point free theorem for R-divisors, for example see [ BCHM10 ,
Theorem 3.9.1]. Therefore we may assume that dim T= 2. /square
Claim3.16.LetFbe a general ﬁber of π:X/axisshort/axisshort/arrowaxisrightT, thenF∼=P1and
(KX+B+βX)·F= 0.
Proof.Letg:Y→Xbe a log resolution of ( X,B+β) which also resolves
the mapπ:X/axisshort/axisshort/arrowaxisrightT. Write
KY+BY+βY=g∗(KX+B+βX)+E,
whereBY≥0,E≥0,g∗BY=B,g∗E= 0,BYandEdo not share any
component, and βYis nef.
Observe that the general ﬁbers of π◦gandπare isomorphic. Now since ( KX+
B+βX)ispseudo-eﬀective, sois KY+BY+βY,andthus(KY+BY+βY)·F≥0.
If (KX+B+βX)·F >0, then(KY+BY+βY)·F= (KX+B+βX)·F >0, and
thus (KY+BY+tβY)·F >0 for some 1 >t>0. Then by [ Gue20, Theorem],
KY+BY+tβYis pseudo-eﬀective and so KY+BY+βY+(1−t)Ex(f) is big,
sinceβXis big. In particular, KX+B+βX=g∗(KY+BY+βY+(1−t)Ex(f))
is big, a contradiction. /square30 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Now, as in the proof of [ DH20, Theorem 5.2] we will analyze the nef di-
mension of KX+B+βX. Since a dense open subset of Xis covered by
KX+B+βX-trivialcurves, wesee thatthenef dimension n(KX+B+βX)≤2.
Ifn(KX+B+βX) = 0, then KX+B+βX≡0 and we are done by choosing
Z:= Specan( C). Ifn(KX+B+βX) = 1, then there is a smooth projective
curveCand a morphism g:X→Csuch thatKX+B+βX=g∗αC, where
αC∈H1,1
BC(C), (see [BCE+02, 2.4.4] and [ HP15, Theorem 3.19]). Since the nef
dimensionn(g∗αC) = 1, it follows that αCis a K¨ ahler class and we are done.
The ﬁnal case is n(KX+B+βX) = 2. In this case, by an argument identical
to the one in [ DH20, Theorem 5.5], we ﬁnd the required morphism g:X→Z.
Note that in [ DH20],βXis assumed to be nef and big, however, in the proof
it is only used to show that a nef and big class can be written as a sum of a
modiﬁed K¨ ahler class and a suﬃciently small eﬀective divisor (see the Step 3
of the proof of [ DH20, Theorem 5.2]); in particular, βXbeing modiﬁed K¨ ahler
is enough for the proof in [ DH20].
/square
Theorem 3.17. Let(X,B+β)be aQ-factorial generalized klt pair, where
Xis a compact K¨ ahler 3-fold, such that KX+B+βXis pseudo-eﬀective but
not big and βX′is big. Then there is a log terminal model f:X/axisshort/axisshort/arrowaxisrightXmand
a morphism g:Xm→Zsuch thatKXm+Bm+βXm=g∗αZ, whereαZis a
K¨ ahler class on Z.
Proof.IfKXis pseudo-eﬀective, then KX+B+βXis big, contradicting our
assumptions. Thus, KXis not pseudo-eﬀective. In particular, Xis uniruled.
Letπ:X/axisshort/axisshort/arrowaxisrightTbe the MRCC ﬁbration of X. If dimT≤1, then from the
proof of [ DH20, Lemma 2.39] it follows that H2(X,OX) = 0. In particular, all
(1,1) classes on Xare represented by R-Cartier divisors and Xis projective.
So we may assume that ( X,B+β) is a traditional generalized pair on a
projective variety and the statement follows from known results ( see [BZ16,
Lemma 4.4]). Therefore we may assume that dim T= 2.
Letν:Y→Xbe a log resolution of ( X,B+β) so thatKY+BY+βY=
ν∗(KX+B+βX), where (Y,BY) is log smooth and βYis nef and big. Passing
to a higher model, we may assume that βY≡ω′+E, whereEis an eﬀective
R-divisor and ω′is K¨ ahler. Therefore, for 0 <ǫ≪1,
KY+BY+βY≡KY+BY+ǫE+(1−ǫ)βY+ǫω′,
where (1 −ǫ)βY+ǫω′is K¨ ahler and ( Y,BY+ǫE) is sub-klt. Let B∗:=
ν∗(BY+ǫE)andβ∗:=ν∗((1−ǫ)βY+ω′). Thenthegeneralizedpair( X,B∗+¯β∗)
is generalized klt and β∗is a modiﬁed K¨ ahler class. Moreover, KX+B∗+β∗≡
KX+B+βX; thusreplacing( X,B+β)by(X,B∗+¯β∗)wemayassumethat βXMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 31
is a modiﬁed K¨ ahler class. Then from the proof of Claim 3.16it follows that
(KX+B+βX)·F= 0 for general ﬁbers Fof the MRC ﬁbration π:X/axisshort/axisshort/arrowaxisrightT,
KX+B+(1+ǫ)βXis big for 0 <ǫ≪1, and (X,B+(1+ǫ)β) is generalized
klt.
Claim3.18.LetN:=N(KX+B+βX) andNǫ:=N(KX+B+(1+ǫ)βX)
be the negative parts of the Boucksom-Zariski decomposition of t he pseudo-
eﬀective classes KX+B+βXandKX+B+(1+ǫ)βXforǫ>0 (see §A). We
may assume that
Supp(Nǫ)⊂Supp(N),for all 0<ǫ≪1,
and in particular, Supp( Nǫ) is independent of 0 <ǫ≪1.
Proof of Claim 3.18.Note thatN(KX+B+βX) is an eﬀective R-divisor.
SinceβXis modiﬁed K¨ ahler, from Remark A.8it follows that if ǫ > ǫ′≥0,
thenNǫ≤Nǫ′. Since their support is contained in N, they must stabilize. /square
Letfǫ:X/axisshort/axisshort/arrowaxisrightXm
ǫbe a log terminal model of KX+B+(1+ǫ)βX(which
exists by Theorem 3.6asKX+B+ (1 +ǫ)βXis a big class). Then for all
0<ǫ≪1, the divisors contracted by fǫare justNǫ(see Theorem A.11) and
soXm
ǫare all isomorphic in codimension 1 for all 0 < ǫ≪1. We now ﬁx an
0< ǫ≪1 satisfying the above Claim 3.18and run the KXmǫ+BXmǫ+βXmǫ-
MMP with scaling of ǫβXmǫ. This MMP terminates with a log terminal model
ψ:Xm
ǫ/axisshort/axisshort/arrowaxisrightXmby Proposition 3.3. Let
KXm+BXm+(1+t)βXm:=ψ∗(KXmǫ+BXmǫ+(1+t)βXmǫ)
fort≥0. Then, by the properties of the MMP with scaling, there exists
0<δ <ǫsuch thatψis also aKXmǫ+BXmǫ+(1+t)βXmǫ-MMP with scaling
of (ǫ−t)βXmǫfor every 0 ≤t≤δ. In particular, KXm+BXm+(1+t)βXmis
nef for all 0 ≤t≤δ. Note that from Claim 3.18it follows that
SuppN(KXmǫ+BXmǫ+(1+t)βXmǫ) = SuppN(KXmǫ+BXmǫ+(1+ǫ)βXmǫ) = 0,
where the second equality holds because KXmǫ+BXmǫ+(1+ǫ)βXmǫis nef. Thus
fromTheorem A.11itfollowsthat ψisasmallmap. Therefore Xm/axisshort/axisshort/arrowaxisrightXm
tisa
small bimeromorphic map for every 0 <t≤δwhere, as above, ft:X/axisshort/axisshort/arrowaxisrightXm
t
is a log terminal model of KX+B+(1+t)βX. SinceKXm+BXm+(1+t)βXm
andKXm
t+BXm
t+(1+t)βXm
tare both nef, we have
a(P;Xm,BXm+(1+t)βXm) =a(P;Xm
t,BXm
t+(1+t)βXm
t)≥a(P;X,B+(1+t)β)
for any prime Weil divisor PoverX.
SinceXisQ-factorial, βXhas local potentials. In particular,
a(P,X,B+(1+t)β) =a(P,X,B+β)−t·multP(f∗βX−βX′).32 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Therefore, takingthelimitas t→0+weseethat a(P,X,B+β)≤a(P,Xm,BXm+
βXm) for every prime Weil divisor PoverX, and hence φ:X/axisshort/axisshort/arrowaxisrightXmis aQ-
factorial weak log canonical model. Let {Pi}i∈Ibe the set of all φ-exceptional
divisors on Xsuch thata(Pi,X,B+β) =a(Pi,Xm,BXm+β). To obtain a log
terminal model of ( X,B+β), we need to extract PifromXm. To that end, let
h:Y→Xmbealogresolutionof( Xm,BXm+βXm)whichextractsthedivisors
{Pi}i∈I. WriteKY+BY+βY=f∗(KXm+BXm+βXm), where (Y,BY) is log
smooth and βYis nef. Note that a(Pi,Xm,BXm+βXm) =a(Pi,X,B+β)≤0
for alli∈I, sincePi⊂Xis a divisor on X. Let{Pi}i∈I∪{Qj}j∈Jbe the set
of allh-exceptional divisors. We deﬁne
˜BY:=h−1
∗BXm−/summationdisplay
i∈Ia(Pi,Xm,BXm+βXm)Pi+/summationdisplay
j∈J(1−ǫ)Qj
for 0<ǫ≪1. Then (Y,˜BY+βY) is a klt pair such that KY+˜BY+βY≡Xm
E≥0, where Supp( E) =∪j∈JQj. We run a KY+˜BY+βY-MMP over Xm
as in Corollary 3.5. Replacing Yby the corresponding minimal model, we
may assume that Eis nef overXm, and since it is exceptional, it follows from
the negativity lemma that E= 0. We then have that KY+˜BY+βY=
h∗(KXm+BXm+βXm) is nef. Replacing ( Xm,BXm+β) by (Y,˜BY+β) we
see thatπ:X/axisshort/axisshort/arrowaxisrightXmis a log terminal model for KX+B+βX.
The existence of the morphism g:Xm→Zsuch thatKXm+BXm+βXm=
g∗αZ, whereαZis K¨ ahler on Zfollows from Theorem 3.14. /square
Proof of Theorem 1.2.It follows from combining Theorems 3.6and3.17./square
Next we will establish ananalogof [ BCHM10 , Corollary1.1.5] for logcanon-
ical models.
Theorem 3.19. LetXbe a normal Q-factorial compact K¨ ahler 3-fold and
ν:X′→Xa resolution. Let (X,B)be a pair and Ω′be a compact convex
polyhedralsetof closedpositive(1,1)currents on X′such thatfor every β′∈Ω′,
(X,B+β)is a generalized klt pair, where β=¯β′. Assume that one of the
following conditions hold:
(i)KX+B+βXis big for every β′∈Ω′(andβ=¯β′), or
(ii) there is a bimeromorphic morphism π:X→Sof normal compact
K¨ ahler3-folds.
Then there exists a ﬁnite polyhedral decomposition Ω′=∪Ω′
iand ﬁnitely many
bimeromorphic maps ψi:X/axisshort/axisshort/arrowaxisrightXi(resp. ﬁnitely many bimeromorphic maps
ψi:X/axisshort/axisshort/arrowaxisrightXioverS) such that if ψ:X/axisshort/axisshort/arrowaxisrightYis a log canonical model for
KX+B+ν∗β′(resp. a log canonical model for KX+B+ν∗β′overS) for
someβ′∈Ω′
i, thenψ=ψi.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 33
Note that a compact convex polyhedral set is a convex hull of ﬁnite ly many
vectors. Then by ﬁnite polyhedral decomposition Ω′=∪Ω′
iwe simply mean
that each Ω′
iis a subset of Ω′deﬁned by ﬁnitely many aﬃne linear equations
and inequalities such that Ω′
i∩Ω′
j=∅fori/\e}atio\slash=j.
Proof.We will prove both cases (i) and (ii) simultaneously. We will use the
convention that in case (i), S= Specan( C) and we remark that in case (ii) the
condition that KX+B+βXis big overSis automatic as πis bimeromorphic.
We will use induction on the dimension of Ω′. We will abuse notation and
denoteβXbyβ. If dimΩ′= 0, then Ω′={β′
0}for someβ′
0such that (X,B+
β0=B+ν∗β′
0) is a generalized klt pair and KX+B+β0is big (over S). In this
case the existence of the required log canonical model follows by Th eorems3.6
and3.11.
Since Ω′is compact, it is enough to prove the statement locally in a neigh-
borhood of each point β′∈Ω′. Fix a point β′
0∈Ω′and letβ0=ν∗β′
0∈Ω :=
ν∗Ω′. By Theorems 3.6and3.11, there is a KX+B+β0-log terminal model
φ:X/axisshort/axisshort/arrowaxisrightXm(overS) and a log canonical model ψ:Xm→Xc(overS).
Sincea(E,X,B+β0)< a(E,Xm,Bm+βm
0) for allφ-exceptional divisors E
ofX(whereBm+βm
0=φ∗(B+β0)), shrinking Ω′(to a smaller polytope
containingβ′
0but without changing its dimension) around β′
0we may assume
that ifβ=ν∗β′andβm=φ∗β, thena(E,X,B+β)< a(E,Xm,Bm+βm)
for allβ′∈Ω′and for all φ-exceptional divisors EofX. In particular, if
φm:Xm→¯Xmis a log canonical model for KXm+Bm+βm(overS), then
φm◦φ:X/axisshort/axisshort/arrowaxisright¯Xmis a log canonical model for KX+B+β(overS).
Now let Ωm:=φ∗Ω. Note that Ωmis a compact convex polyhedral subset of
H1,1
BC(Xm), sinceφ∗is a linear map by Lemma 2.14. Then, by induction, there
is a ﬁnite polyhedral decomposition ∂Ωm=∪k
i=1Piof the boundary ∂Ωmof
Ωmand ﬁnitely many meromorphic maps φi:Xm/axisshort/axisshort/arrowaxisrightXi(overXc) 1≤i≤ℓ
such that if f:Xm/axisshort/axisshort/arrowaxisrightYis a log canonical model of KXm+Bm+βmover
Xcfor someβm∈ Pi, thenf=φi(note that as KX+B+β0is big over
S,ψ:Xm→Xcis bimeromorphic). Recall that βm
0:=φ∗β0∈Ωm. Choose
βm
1∈∂Ωmsuch thatβm
1/\e}atio\slash=βm
0. For 0<λ≤1 we deﬁne
(3.2) βm
λ:= (1−λ)βm
0+λβm
1.
Recall that KXm+Bm+βm
0=ψ∗ω≡Xc0 for some K¨ ahler class ω(overS) on
Xc. By induction, φi:Xm/axisshort/axisshort/arrowaxisrightXiis a log canonical model of KXm+Bm+βm
1
overXcfor somei. Thus from ( 3.2) we have
(3.3) KXi+Bi+βλ,i≡(1−λ)ψ∗
iω+λ(KXi+Bi+β1,i),
whereψi:Xi→Xcis the induced bimeromorphic morphism.
Thus from [ BCHM10 , Lemma 3.6.8] and our induction hypothesis it follows
thatφiis a log canonical model of KXm+Bm+βm
λoverXcfor all 0<λ≤1.34 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Letνi:Xq
i→Xibe a small Q-factorization as in Theorem 3.13such that
(3.4) KXq
i+Bq
i+βq
i=ν∗
i(KXi+Bi+βi).
Letφq
i:Xm/axisshort/axisshort/arrowaxisrightXq
ibe the induced bimeromorphic maps.
Claim3.20.There exists a constant ¯λ >0 such that for every βm
1∈∂Ωm
there exists a φi:Xm/axisshort/axisshort/arrowaxisrightXifor somei∈ {1,2,...,ℓ}such thatφiis a log
canonical model of KXm+Bm+βm
λ(overS) for all 0<λ≤¯λ.
Proof of Claim 3.20.Letpq
i:Xq
i→Sbe the induced morphisms for all 1 ≤
i≤ℓ. Consider the following set of curves in Xq
ifor each 1 ≤i≤ℓ:
Ci:={C⊂Xq
i|pq
i,∗(C) = 0 andβq
i·C <0 for someβq
i},
whereβq
i:=φq
i,∗(βm) forβm∈Ωm.
We claim that Ciis a ﬁnite set. Indeed, since each β′∈Ω′is nef over Sand
descends to X′and the composite map φq
i◦φ◦ν:X′/axisshort/axisshort/arrowaxisrightXq
idoes not extract
any divisors, it follows that if C⊂Xq
iis a curve such that pq
i,∗(C) = 0 and
C/notsubseteqlEx((φq
i◦φ)−1), thenβq
i·C≥0. Thus Ci⊂ Di:={C⊂X|pq
i,∗(C) =
0 andC⊂Ex((φq
i◦φ)−1)}for all 1≤i≤ℓ, and clearly each Diis a ﬁnite set
as dimXq
i= 3. Observe that if C⊂Xq
iis a curve such that pq
i,∗(C) = 0 but
C /∈ Ci, thenβq
i·C≥0 for allβq
i. Suppose that KXq
i′+Bq
i′+βq
i′is not nef (over
S) for some 1 ≤i′≤ℓandβ′∈Ω′. Pick a K¨ ahler class ωq
i′onXq
i′which is
very general in H1,1
BC(Xq
i′), and consider the corresponding nef threshold µ>0
so thatKXq
i′+Bq
i′+βq
i′+µωq
i′is nef and big (over S) but not K¨ ahler (over
S). By Theorems 3.6and3.11, there is a log canonical model gi′:Xq
i′→Zi′
(overS) which is a bimeromorphic morphism and hence the exceptional locus
is covered by curves. Since ωq
i′is very general in H1,1
BC(Xq
i′), it follows that
all of the exceptional curves of gi′belong to a ﬁxed ray, say R≥0[Γi′], where
pq
i′,∗(Γi′) = 0; observe that the curve Γ i′depends on the class βq
i′. LetTbe
the collection of all such curves Γ i′asβmvaries in Ωm, whereβq
i′:=φq
i′,∗βm.
We note here that Tcould be an inﬁnite collection. We claim that there is
a positive real number M >0 (independent of indices 1 ≤i≤ℓ) such that
ifKXq
i+Bq
i+βq
iis not nef (over S) for some 1 ≤i≤ℓandβm∈Ωm, then
0>(KXq
i+Bq
i+βq
i)·Γi≥ −Mfor the corresponding Γ i∈ T. To see this,
observe that if βq
i·Γi≥0, then (KXq
i+Bq
i)·Γi<0 and so by the usual cone
theorem (see [ DHP22, Corollary 5.3]) we may assume that
0>(KXq
i+Bq
i+βq
i)·Γi≥(KXq
i+Bq
i)·Γi≥ −6.
Ifβq
i·Γi<0, then from our construction of the sets Ciabove it follows that
Γi∈ Ci. SinceCiis a ﬁnite set and the indices ialso vary in the ﬁnite set
{1,...,ℓ}, by the compactness of Ωmthe claim follows.MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 35
Recall from equation ( 3.3) thatωis a K¨ ahler class on Xc(overS) such that
KXq
i+Bq
i+βq
0= (ψq
i)∗ω, whereψq
i=ψi◦νifor all 1 ≤i≤ℓ. There exists
aδ >0 such that ω·C >δfor every curve C⊂Xcwhich is vertical over S.
Let¯λ:=δ
M+δ. IfKXq
i+Bq
i+βq
λ,iis not nef (over S) for some 0 <λ≤¯λand
for some 1 ≤i≤ℓ, then from ( 3.3) it follows that KXq
i+Bq
i+βq
1,iis not nef
(overS) for someβm
1∈∂Ωm. Then by the claim above there is a curve Γ i∈ T
such that 0 >(KXq
i+Bq
i+βq
1,i)·Γi≥ −M. Moreover, since KXq
i+Bq
i+βq
1,i
is nef overXc, Γiis not contracted by ψq
i:Xq
i→Xc. Let¯Γi:=ψq
i,∗Γi, then
ω·¯Γi>δ.
Thus from ( 3.3) we have
(KXq
i+Bq
i+βq
λ,i)·Γi= (1−λ)ω·¯Γi+λ(KXq
i+Bq
i+βq
1,i)·Γi>(1−λ)δ−λM≥0
which is a contradiction, and hence KXq
i+Bq
i+βq
λ,i=ν∗
i(KXi+Bi+βλ,i) is
nef overSand so isKXi+Bi+βλ,i.
Sinceφi:Xm/axisshort/axisshort/arrowaxisrightXiis a log canonical model of KXm+Bm+βm
1overXc,
KXi+Bi+β1,iis K¨ ahler over Xc. Recall again that KXi+Bi+β0,i=ψ∗
iω,
whereωis a K¨ ahler class over Sandψi:Xi→Xcis the induced morphism.
In the argument above we saw that KXi+Bi+βλ,iis nef over Sfor all
0≤λ≤¯λ. By contradiction assume that there is an 0 < λ≤¯λ/2 such that
KXi+Bi+βλ,iis not K¨ ahler over S. Then, by Theorem 3.11there is a proper
bimeromorphic morphism Xi→ZoverS, whereZis the log canonical model
forKXi+Bi+βλ,ioverS. So there is a curve C⊂Xi(overS) such that
(KXi+Bi+βλ,i)·C= 0. Also, note that there is a 0 <µ<1 such that
(3.5) βλ,i= (1−µ)β0,i+µβ¯λ,i.
As observed above, KXi+Bi+β0,iandKXi+Bi+β¯λ,iare both nef over S, and
thus from ( 3.5) it follows that ( KXi+Bi+β0,i)·C= (KXi+Bi+β¯λ,i)·C= 0.
Then again from ( 3.3) (withλreplaced by ¯λ) it follows that ( KXi+Bi+β1,i)·
C= 0. In particular, Cis not vertical over Xc(asKXi+Bi+β1,iis K¨ ahler
overXc). However, since KXi+Bi+β0,i=ψ∗
iωwhereωis K¨ ahler over S, it
follows that ( KXi+Bi+β0,i)·C >0; this is a contradiction to ( 3.3).
Finally replacing ¯λby¯λ/2 completes the proof of Claim 3.20.
/square
Note that as observed above, X/axisshort/axisshort/arrowaxisrightXiis a log canonical model for KX+
B+βλ(overS) for allβ1∈ Piand 0<λ≤¯λ. The decomposition ∂Ωm=∪Pi
induces a corresponding decomposition of Ωm−{βm
0}=∪Ωm
iwhere each Ωm
i
is the polytope spanned by β0andPiexcludingβm
0, and Ωm
0:={βm
0}is a 0-
dimensional polytope. We then obtain a decomposition Ω′=∪Ω′
i, where Ω iis36 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
the inverse image of Ωm
i. Finally we replace Ω′by Ω′∩{β′∈Ω′:||β′−β′
0|| ≤
¯λ}for some ﬁxed norm ||·||. This completes the proof. /square
3.3.Existence of Mori Fiber Space. In this subsection we will show that
ifKX+B+βXis not pseudo-eﬀective, then we can run an MMP which ends
with a Mori ﬁber space.
First we will show that if KX+B+βXis big, then we can run a terminating
MMP with scaling of a very general K¨ ahler class. Using this result, we will
then show that we can also obtain a Mori ﬁber in the non pseudo-eﬀe ctive
case.
Theorem 3.21. Let(X,B+β)be aQ-factorial generalized dlt pair such that
KX+B+βXis big, where Xis a compact K¨ ahler 3-fold. Letωbe a very
general K¨ ahler class in H1,1
BC(X)such thatKX+B+βX+ωis a K¨ ahler class.
Then we can run a terminating KX+B+βX-MMP with scaling of ω.
Proof.To run the KX+B+βX-MMP with scaling of ω, we will inductively
construct a sequence of bimeromorphic maps φi:Xi/axisshort/axisshort/arrowaxisrightXi+1and real num-
bersti> ti+1fori≥0 such that X0=Xandt0= 1 and the following
conditions are now satisﬁed
(1) (Xi,Bi+βXi+tiωi) is a generalized dlt pair,
(2)KXi+Bi+βXi+tiωiis nef,
(3)KXi+Bi+βXi+(ti−ǫ)ωiis K¨ ahler for 0 <ǫ≪1,
(4)KXi+Bi+βXiis big,
(5)XiisQ-factorial and ωi∈H1,1
BC(Xi) is very general.
The base of the induction is clear. Assume that we have constructe d (Xi,Bi+
βXi+tiωi) as above. Let
ti+1:= inf{s≥0|KXi+Bi+βXi+sωiis nef}.
Ifti+1= 0, then the MMP terminates and X/axisshort/axisshort/arrowaxisrightXiis a log terminal model
for (X,B+βX). Thus we may assume that ti+1>0.
Letψ:Xi→Zibethelogcanonicalmodelfor KXi+Bi+βXi+ti+1ωi(which
exists by Theorem 3.6; note that ( Xi,Bi+βXi+ti+1ωi) is generalized dlt but
not necessarily generalized klt, however if ω′=ti+1ω+ǫBifor 0<ǫ≪1, then
(Xi,(1−ǫ)Bi+βXi+ω′
i) is generalized klt and so Theorem 3.6applies).
Sinceψi:Xi→Ziis bimeromorphic, the ﬁbers of ψiare covered by curves.
Sinceωiis very general in H1,1
BC(Xi) and (KXi+Bi+βXi+ti+1ωi)·C= 0
for anyψi-exceptional curve C⊂Xi, it follows that ρ(Xi/Zi) = 1 andψiis a
contraction of a KXi+Bi+βXi-negative extremal ray Rispanned by (any)
one of these curves, i.e. Ri=R≥0[C]. Ifψiis a divisorial contraction, then weMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 37
letφi=ψiand
KXi+1+Bi+1+βXi+1+ti+1ωi+1:=ψi,∗(KXi+Bi+βXi+ti+1ωi).
Ifψiis a small contraction, then it is a KXi+Bi+βXiﬂipping contraction
(as it isωi-positive).
Claim3.22.LetX/axisshort/axisshort/arrowaxisrightXi+1be the log canonical model of KX+B+βX+
(ti+1−ǫ)ω(for any 0<ǫ≪1). Thenφi:Xi/axisshort/axisshort/arrowaxisrightXi+1is the ﬂip of ψi.
Proof.By Theorem 3.19, we may assume that there is an ǫ0>0 such that
X/axisshort/axisshort/arrowaxisrightXi+1is the log canonical model of KX+B+βX+ (ti+1−ǫ)ωfor
any 0< ǫ≤ǫ0. In particular, KXi+1+Bi+1+βXi+1+ti+1ωi+1is nef and
hence admits a morphism ψ+
i:Xi+1→¯Zto the log canonical model of
(Xi+1,Bi+1+βXi+1+ti+1ωi+1) (which exists by Theorem 3.6). SinceX/axisshort/axisshort/arrowaxisright
Xi+1isKX+B+βX+ti+1ωnon-positive, then X/axisshort/axisshort/arrowaxisright¯Zisalsothelogcanonical
model ofKX+B+βX+ti+1ωand hence ¯Z=Zi. Note that −(KXi+Bi+
βXi+(ti−ǫ)ωi) is K¨ ahler over ZiandKXi+1+Bi+1+βXi+1+(ti+1−ǫ)ωi+1
is K¨ ahler over Ziand soXi/axisshort/axisshort/arrowaxisrightXi+1is aKXi+Bi+βXi+ (ti+1−ǫ)ωi-
ﬂip. Since KXi+Bi+βXi+ti+1ωi≡Zi0, it follows that Xi/axisshort/axisshort/arrowaxisrightXi+1is a
KXi+Bi+βXi-ﬂip. /square
It is easy to check that properties (1-5) hold for ( Xi+1,Bi+1+βXi+1+
ti+1ωi+1). Repeating the above procedure we obtain a sequence of KX+B+
βX+(ti−ǫi)ωdistinct log canonical models where 0 ≤ti−ǫi≤1. By The-
orem3.19, this sequence can not be inﬁnite and so the above minimal model
program with scaling terminates and the proof is complete. /square
The next result shows that if KX+B+βXis not pseudo-eﬀective, then
we can run a terminating KX+B+βX-MMP with scaling of a very general
K¨ ahler class and end with a Mori ﬁber space.
Theorem 3.23. Let(X,B+β)be aQ-factorial generalized klt pair, where X
is a compact K¨ ahler 3-fold. Assume that KX+B+βXis not pseudo-eﬀective,
and letωbe a very general K¨ ahler class in H1,1
BC(X)such thatKX+B+βX+ω
is K¨ ahler. Then we can run the KX+B+βX-MMP with scaling of ωand
obtainφ:X/axisshort/axisshort/arrowaxisrightX′such thatKX′+B′+βX′+τω′is pseudo-eﬀective but not
big for some 0<τ <1, and there is a Mori-ﬁber space g:X′→W.
Proof.We deﬁne
τ:= inf{s≥0|KX+B+βX+sωis pseudo-eﬀective }
and
t1:= inf{s≥0 :KX+B+βX+sωis nef}.38 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
ThenKX+B+βX+τωis pseudo-eﬀective but not big. By Theorem 3.17,
there is a log terminal model φ:X/axisshort/axisshort/arrowaxisrightX′and a morphism g:X′→Zof
normal K¨ ahler varieties such that KX′+B′+βX′+τω′=g∗αZ, whereαZis
a K¨ ahler class. Since KX+B+βX+τωis not big,gis not bimeromorphic.
We begin by proving that we can run a KX+B+βX-MMP with scaling of
ωterminating with a log terminal model of KX+B+βX+τω. Indeed, if Xi
is a step of this MMP, then let ti+1:= inf{s≥0 :KXi+Bi+βXi+sωiis nef}.
Ifti+1>τ, thenKXi+Bi+βXi+ti+1ωiis big and by Theorem 3.21we can
run this MMP. Thus as long as ti>τ, we can continue running this MMP and
it will stop once we have ti=τfor somei(note that every step of this MMP
is also a step of KX+B+βX-MMP with the scaling of ω). However, it is not
clear whether this MMP will terminate after ﬁnitely many steps. Assu me by
contradiction that this MMP does not terminate. We claim that lim ti=τ.
If not, then let lim ti=τ0> τ; note that τ0= inf{ti:i≥0}. Then every
step of the above MMP is also a step of KX+B+βX+τ0ω-MMP, but since
KX+B+βX+τ0ωbig (asτ0>τ), this MMP terminates by Theorem 3.21,
a contradiction. Now from Claim 3.18we observe that
(3.6)
N(KX+B+βX+tω) =N(KX+B+βX+τω) for allt>0 s.t. 0<t−τ≪1.
Thus by Theorem A.11we may assume that Xi/axisshort/axisshort/arrowaxisrightX′is a small bimeromor-
phic map for i≫0. Then from the proof of Theorem 3.21, it follows that
KXi+Bi+βXi+tωiis K¨ ahler for any t>0 satisfying ti>t>t i+1. We may
also assume that if 0 <t0−τ≪1, thena(E,X,B+βX+t0ω)<a(E,X′,B′+
βX′+t0ω′) for allφ-exceptional divisors and that ( X′,B′+βX′+t0ω′) is gener-
alized klt. Fix t0as above. By Theorem 3.17, there is a morphism g:X′→Z
such thatKX′+B′+βX′+τω′≡g∗αZwhereαZis K¨ ahler on Z. Let
b >0 be a constant such that αZ·C > bfor any curve ConZand ﬁx
τ <t<bt0+6τ
b+6. By Theorem 3.21there is a sequence of KX′+B′+βX′+tω′-
ﬂipsX′
j/axisshort/axisshort/arrowaxisrightX′
j+1with 0≤j≤¯j−1 ending with X′/axisshort/axisshort/arrowaxisrightX′
¯j, a log terminal
model of (X′,B′+βX′+tω′). ThenX/axisshort/axisshort/arrowaxisrightX′
¯jis a log terminal model of
(X,B+βX+tω). Sinceωis very general in H1,1
BC(X), we may assume that
ti> t > t i+1for somei≫0; thenKXi+Bi+βXi+tωiis K¨ ahler as argued
above. Since X′
¯j/axisshort/axisshort/arrowaxisrightXiis a small bimeromorphic map, by Lemma 2.16it’s an
isomorphism, i.e. X′
¯j∼=Xi.
We claim that each ﬂip ψj:X′
j/axisshort/axisshort/arrowaxisrightX′
j+1for 0≤j≤¯j−1 isKX′+B′+
βX′+τω′-trivial. We prove this by induction on i. Suppose that X′
0=X′and
the claim holds for the ﬁrst k−1 ﬂips, then each ﬂip is a ﬂip over Zand so
there is a morphism g′
k:X′
k→Zsuch thatKX′
k+B′
k+βX′
k+τω′
k= (g′
k)∗αZ.
Observe that ψ0,...,ψ k−1areKX′+B′+βX′+λω′-ﬂips for any τ <λ≤t0,MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 39
as each of the them are KX′+B′+βX′+τω′-trivial. Recall that αZ·C≥bfor
every curve C⊂Z. LetX′
k/axisshort/axisshort/arrowaxisrightX′
k+1be the next KX′+B′+βX′+tω′-ﬂip and
Cka corresponding ﬂipping curve. Since KX′
k+B′
k+βX′
k+τω′
kis nef, we may
assume that this curve is also a KX′+B′+βX′+t0ω′-ﬂipping curve, and hence
by Corollary 2.23we may assume that −(KX′
k+B′
k+βX′
k+t0ω′
k)·Ck≤6.
Moreover, if( KX′
k+B′
k+βX′
k+τω′
k)·Ck>0, then(KX′
k+B′
k+βX′
k+τω′
k)·Ck≥
b. Observe that
KX′
k+B′
k+βX′
k+tω′
k=t0−t
t0−τ(KX′
k+B′
k+βX′
k+τω′
k)+t−τ
t0−τ(KX′
k+B′
k+βX′
k+t0ω′
k).
Sinceτ <t<bt0+6τ
b+6and henceb(t0−t)+6(τ−t)>0, we then have
0>(KX′
k+B′
k+βX′
k+tω′
k)·Ck≥b(t0−t)
t0−τ−6(t−τ)
t0−τ>0.
Since this is impossible, we have ( KX′
k+B′
k+βX′
k+τω′
k)·Ck= 0 and hence
ψkisKX′
k+B′
k+βX′
k+τω′
k-trivial and the induction is complete.
SinceX′
¯j∼=Xifor somei≫0, we may assume that there is a morphism
gi:Xi→Zsuch thatKXi+Bi+βXi+τωi=g∗
iαZ. But this leads to animme-
diate contradiction, since if Xi/axisshort/axisshort/arrowaxisrightXi+1is a ﬂip and Σ iis a ﬂipping curve for
theKX+B+βX-MMP withscaling of ω, then (KXi+Bi+βXi+ti+1ωi)·Σi= 0
andωi·Σi>0 so that (KXi+Bi+βXi+τωi)·Σi<0, but (KXi+Bi+τωi)·Σi=
αZ·gi,∗(Σi)≥0.
This shows that our KX+B+βX-MMP with scaling of ωterminates after
ﬁnitely many steps producing a log terminal model of KX+B+βX+τω.
Letφ:X/axisshort/axisshort/arrowaxisrightX′be the composite maps of this MMP so that KX′+B′+
βX′+τω′:=φ∗(KX+B+βX+τω) is nef, and by Theorem 3.14there is
a morphism g:X′→Zto a normal compact K¨ ahler variety Zsuch that
KX′+B′+βX′+τω=g∗αZ, whereαZis a K¨ ahler class on Z.
We will now show that we have a Mori ﬁber space. Observe that −(KX′+
B′)|Xz≡(βX′+τω′)|Xzis big for general points z∈Z; in particular Xzis
Moishezon and KX′+B′not pseudo-eﬀective over Z. Thus by Theorem 2.35,
we can run a KX′+B′-MMP over Zwhich terminates with a Mori ﬁber space
h:X′′→WoverZ. Note that each step of this MMP is KX′+B′+βX′+τω′-
trivial.
Now we will show that the induced map ψ:X′/axisshort/axisshort/arrowaxisrightX′′is an isomorphism. To
see this, let g′:X′→Ybe the ﬁrst contraction of the above MMP over Z,
and Σ is a curve contracted by g′. LetCbe a curve contained ina general ﬁber
ofg:X′→Z. Then Σ and Care linearly independent in N1(X′), however
they are both KX′+B′+βX′+τω′-trivial, contradicting the fact that ωis
very general in H1,1
BC(X). Thusψ:X′/axisshort/axisshort/arrowaxisrightX′′is an isomorphism and Z=W.
In particular, ρ(X′/Z) = 1 and −(KX′+B′) isg-ample. We will show that40 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
−(KX′+B′+βX′)isg-K¨ ahler. Tothatend, let Fbeageneralﬁberof g. Nowif
dimZ= 2, then dim F= 1, and since ω′is a modiﬁed K¨ ahler class, ω′·F >0.
This implies that −(KX′+B′+βX′)·F >0, and hence −(KX′+B′+βX′)
isg-K¨ ahler, as ρ(X′/Z) = 1. If dim Z≤1, thenω′|Fis a big class on F. Let
{Ct}t∈Tbe a covering family of curves in F. Thenω′·Ct=ω′|F·Ct>0, and
thus−(KX′+B′+βX′)·Ct=−(KX′+B′+βX′)|F·Ct>0. This shows that
−(KX′+B′+βX′) isg-K¨ ahler, since ρ(X′/Z) = 1. This completes our proof.
/square
Proof of Theorem 1.5.This follows from Theorem 3.23. /square
3.4.Cone Theorem. In this section we will prove the cone theorem for gen-
eralized pairs in dimension 3. We start with the following lemma.
Lemma 3.24. Let(X,B+β)be aQ-factorial generalizedklt pair, where Xis a
compact K¨ ahler 3-fold. Letωbe a K¨ ahler class such that α:=KX+B+βX+ω
is nef but not K¨ ahler. Then there is a rational curve C⊂Xsuch thatα·C= 0
and0>(KX+B+βX)·C≥ −6.
Proof.IfKX+B+βXis nef, then αis K¨ ahler, which is a contradiction. So
we may assume that KX+B+βXis not nef. We may write ω=η+ω′, where
ηandω′are very general K¨ ahler classes in H1,1
BC(X). Replacing βbyβ+ǫ¯η
andωbyω−ǫη≡(1−ǫ)ω+ǫω′, we may assume that KX+B+βXis not
nef,βXis big,KX+B+βXis either big or not pseudo-eﬀective, and ωis
a very general class in H1,1
BC(X). By Theorems 3.21and3.23we can run the
KX+B+βX-MMP with scaling of ω. Letf:X→Zbe the ﬁrst ﬂipping
or divisorial contraction, or ﬁber type contraction, and Cthe curve spanning
the corresponding extremal ray; then α·C= 0. Iffis a ﬂipping contraction,
then the result follows from Theorem 2.21.
So now on assume that fis either a divisorial contraction or a ﬁber type
contraction. Then there is a family of f-vertical curves {Γt}t∈TinXsuch that
either∪t∈TΓt=Eis the exceptional divisor of for∪t∈TΓt=X, respectively.
Then in the former case βX|Eis pseudo-eﬀective, since βXis modiﬁed nef (see
[Bou04, Proposition 2.4]). Therefore βX·Γt=βX|E·Γt≥0 (as{Γt}t∈Tis a
moving family of curves in E); in the latter case βX·Γt≥0, since modiﬁed nef
implies pseudo-eﬀective. In particular, βX·C≥0 for allf-exceptional curves
in either case, and so 0 >(KX+B+βX)·C≥(KX+B)·C. But then fis
aKX+B-negative contraction and −(KX+B) isf-ample (as ρ(X/Z) = 1).
Then by [ DO23, Theorem 4.2] there is a rational curve Γ such that f∗Γ = 0
and 0>(KX+B+βX)·Γ≥(KX+B)·Γ≥ −6.
/squareMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 41
Now we are ready to prove the Cone Theorem 1.6.
Proof of Theorem 1.6.By a Douady space argument (see [ Tom16, Lemma
4.4]), there are at most countably many families of curves {Γi}i∈Isuch that
(KX+B+βX)·Γi<0 and Γ i·αi= 0 for some nef class αi. LetR=R≥0[Γi]
be aKX+B+βX-negative extremal ray. We make the following claim.
Claim3.25.There is a K¨ ahler class ωsuch thatα:=KX+B+βX+ωis nef
but not K¨ ahler and α⊥∩NA(X) =R.
Proof.Fix a norm ||·||onN1(X) and let Sbe the unit sphere in N1(X), i.e.
S:={γ∈N1(X) :||γ||= 1}. LetS:=S ∩NA(X); thenSis a compact
subset of NA(X) such that for any γ∈NA(X)\{0},γ
||γ||∈S. Moreover, from
[HP16, Corollary 3.16] it follows that a class α∈H1,1
BC(X) is K¨ ahler if and only
ifα·γ >0 for allγ∈S.
There is a unique point r∈Rsuch thatR∩S={r}. Letηbe a (1,1)
nef supporting class of R; thenη⊥∩NA(X) =R. Forǫ >0, letBǫ:=
{s∈S:||s−r||< ǫ}. Choosing 0 < ǫ≪1 we may assume that Bǫ⊂
NA(X)(KX+B+βX)<0. Then clearly η−(KX+B+βX) is positive on Bǫ, i.e.
(3.7) ( η−(KX+B+βX))·s>0 for alls∈Bǫ.
Now deﬁne Sǫ:=S\Bǫ. Observe that η·s >0 for alls∈Sǫ. SinceSǫ
compact, there exist positive real numbers δ >0 andM >0 such that η·s≥δ
and−(KX+B+βX)·s≥ −Mfor alls∈Sǫ. Then for t≫0,tδ−M >0,
and thus
(3.8) (tη−(KX+B+βX))·s≥(tδ−M)>0 for alls∈Sǫ.
Sinceηis nef, from( 3.7) we have (tη−(KX+B+βX))·s>0 for alls∈Bǫand
t≥1. Recall that S=Bǫ∪Sǫ, and thus we have ( tη−(KX+B+βX))·s>0
for alls∈S, and hence tη−(KX+B+η) is K¨ ahler for t≫0. Letω:=
tη−(KX+B+βX) for somet≫0. Thenα:=tη=KX+B+βX+ωproves
our claim. /square
It then follows from Lemma 3.24that we may assume 0 >(KX+B+βX)·
Γi≥ −6 for all such Γ i.
LetV=NA(X)KX+B+βX≥0+/summationtext
i∈IR+[Γi]. By[HP16, Lemma 6.1]it suﬃces
to show that NA(X) =V(note that [ HP16, Lemma 6.1] is only stated for KX,
but the same proof works for KX+B+βX). SinceNA(X) is a closed strongly
convex cone, it is the convex hull of its extremal rays. Thus if the in clusion
¯V⊂NA(X) is strict, then there is a KX+B+βX-negative extremal ray
R∈NA(X) not contained in ¯V.
Then by Lemma 3.24and Claim 3.25it follows that there is a rational curve
C⊂Xsuch thatα·C= 0, where αis the nef supporting class of R. But
then [C]∈α⊥∩¯Vis an immediate contradiction.42 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Finally, if βXis big, then by [ Bou04, Def. 3.7 and Pro. 3.8], we may write
βX≡N+η, whereN≥0 is an eﬀective R-divisor and ηis a modiﬁed K¨ ahler
class, i.e.η=f∗η′wheref:X′→Xis bimeromorphic and η′is K¨ ahler on X′.
Letγbe a K¨ ahler class on X, thenη−ǫγis modiﬁed K¨ ahler for 0 <ǫ≪1.
Replacingηbyη−ǫγandǫγbyγwe may write βX≡N+η+γ, whereN≥0
is an eﬀective R-divisor and ηis a modiﬁed K¨ ahler class and γis K¨ ahler. We
then have
KX+B+βX=KX+(B+ǫN)+(1−ǫ)βX+ǫη+ǫγ,
where (X,(B+ǫN)+(1−ǫ)βX+ǫη+ǫγ) is generalized klt for any 0 <ǫ≪1.
LetBǫ:=B+ǫNandβǫX:= (1−ǫ)βX+ǫη. SinceβǫXis modiﬁed K¨ ahler,
by the proof of Lemma 3.2,βǫX·Γi≥0 for Γ inot contained in f(Ex(f)) and
hence for all but ﬁnitely many i. Then taking limit as ǫ→0+, we see that
βX·Γi≥0 for all but ﬁnitely many i. Therefore βǫX·Γi≥ǫη·Γi>0 for all
but ﬁnitely many i. So if (KX+B+βX)·Γi= (KX+Bǫ+βǫX+ǫγ)·Γi<0,
then arguing as above we get
ǫγ·Γi≤ −(KX+Bǫ+βǫX)·Γi≤ −(KX+Bǫ)·Γi≤6
for all but ﬁnitely many i, and hence, by a Douady space argument, such
curves belong to ﬁnitely many families.
/square
Next we will establish an analog of [ BCHM10 , Corollary 1.1.5] for log ter-
minal models.
3.5.Geography of Minimal Models.
Theorem 3.26. LetXbe a normal compact K¨ ahler 3-fold,ν:X′→Xa
log resolution of a klt pair (X,B), andΩ′a compact convex polyhedral set of
closed positive (1,1) currents on X′such that for every β′∈Ω′,(X,B+β)is a
generalized klt pair, where β=¯β′. Assume that one of the following conditions
hold:
(i)KX+B+βXis big for every β′∈Ω′(andβ=¯β′), or
(ii) there is a bimeromorphic morphism π:X→S.
Then there exists a ﬁnite polyhedral decomposition Ω′=∪Ω′
iand ﬁnitely many
bimeromorphic maps ψij:X/axisshort/axisshort/arrowaxisrightXij(resp. ﬁnitely many bimeromorphic
mapsψij:X/axisshort/axisshort/arrowaxisrightXijoverS) such that if ψ:X/axisshort/axisshort/arrowaxisrightYis a weak log canonical
model forKX+B+βX(resp. a weak log canonical model for KX+B+βX
overS) for some β′∈Ω′
i(withβ=¯β′), thenψ=ψijfor somei,j.
Proof.ArguingasintheproofofTheorem 3.19,wewillprovebothcases(i)and
(ii) simultaneously. We will use the convention that in case (i), S = Spec an(C)
and we remark that in case (ii) the condition that KX+B+βXis big overS
is automatic as πis bimeromorphic. By compactness, it suﬃces to prove theMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 43
result on a neighborhood of any β′
0∈Ω′. For simplicity of notation, from now
on we will write βonXto denote βXand so on. Notethat ν:X′→Xis a log
resolution of ( X,B+β) for anyβ∈Ω =ν∗Ω′. By [Bou02, Theorem 1.4], we
may assume that ν∗(KX+B+β0)≡ω′+Fwhereω′is K¨ ahler and F≥0 has
simple normal crossings support. Let B′:=ν−1
∗B+(1−δ)Ex(ν) for 0<δ≪1.
Thentheweak logcanonical modelsof KX′+B′+β′andKX+B+ν∗β′coincide
for everyβ′∈Ω′. Replacing ( X,B) by (X′,B′) and Ω by Ω′we may assume
that allβ∈Ω are nef and descend to X, andKX+B+β0≡ω+F, whereω
is K¨ ahler,F≥0 andB+Fhas simple normal crossings support.
Pickδ >0 such that ( X,B+δF) is klt and consider the linear map L(β) =
1
1+δ(β+δβ0). Note that L(β0) =β0andL(Ω)⊂Ω contains a neighborhood
ofβ0. Since
KX+B+δF+β+δω≡KX+B+β+δ(KX+B+β0)≡(1+δ)(KX+B+L(β)),
replacingBbyB+δFandβbyβ+δωwe may assume that β=η+γ, where
γis a ﬁxed K¨ ahler class and η:=β−γis nef for any β∈Ω. Let{γ1,...,γ ρ}
be K¨ ahler forms whose classes in H1,1
BC(X) form a basis of H1,1
BC(X). Forǫ>0
deﬁne
Ωǫ:={β+ρ/summationdisplay
i=1tiγi:β∈Ω,|ti| ≤ǫ,1≤i≤ρ}.
For 0< ǫ≪1 we may assume that KX+B+β′is generalized klt and big
(overS), andβ′is K¨ ahler for any β′∈Ωǫ. By Theorem 3.19, there exists a
ﬁnitepolyhedraldecompositionΩǫ=∪j∈JΩǫ
jandﬁnitelymanybimeromorphic
mapsψǫ
j:X/axisshort/axisshort/arrowaxisrightXǫ
j(overS) such that if ψ:X/axisshort/axisshort/arrowaxisrightZis a log canonical model
forKX+B+β′(overS) for someβ′∈Ωǫ
j, thenψ=ψǫ
j. Suppose now that
φ:X/axisshort/axisshort/arrowaxisrightYis a weak log canonical model of KX+B+β,whereβ∈Ω
and letηbe a K¨ ahler class on Y. Since{γ1,...,γ ρ}spansH1,1
BC(X) andφ∗:
H1,1
BC(X)→H1,1
BC(Y) is surjective by Lemma 2.14, we may pick t1,...,t ρsuch
thatφ∗(/summationtextρ
i=1tiγi)≡η. For any 0 <δ≪1, it follows that φis a log canonical
model forKX+B+β+/summationtextρ
i=1(δti)γiand thatβ′:=β+/summationtextρ
i=1(δti)γi∈Ωǫ. But
then, there exists j∈Jsuch thatβ′∈Ωǫ
jand henceφ=ψǫ
j.
We now let {Ωi}i∈Ibe the ﬁnite polyhedral decomposition induced by re-
ﬁning the ﬁnite polyhedral cover of Ω given by {Ωǫ
j∩Ω}j∈J. For each i∈I
we let{ψi,j}={ψǫ
j}j∈J. Suppose now that ψ:X/axisshort/axisshort/arrowaxisrightYis a weak log canon-
ical model for KX+B+βwhereβ∈Ωi, then as observed above ψis a log
canonical model for KX+B+β+/summationtextρ
i=1(δti)γiandβ′:=β+/summationtextρ
i=1(δti)γi∈Ωǫ.
Thusβ′∈Ωǫ
jfor an appropriate jand henceψ=ψǫ
j∈ {ψi,j}as required.
/square
Proof of Theorem 1.3.Immediate from Theorem 3.26. /square44 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Corollary 3.27. Let(X,B+β)be a generalized klt 3-fold and π:X→Sa
proper morphism such that either πis bi-meromorphic or S= Specan( C)and
KX+B+βis big, then (X,B+β)has ﬁnitely many minimal models.
3.6.Minimal Models are Connected by Flops. In this section we will
prove that minimal models are connected by ﬂops. Recall that if ( X,B+β)
is a compact generalized klt pair and fi:X→Xiare log terminal models
fori= 1,2, thenXiareQ-factorial,KXi+Bi+βi=fi∗(KX+B+β) is
nef andX1/axisshort/axisshort/arrowaxisrightX2is an isomorphism in codimension 1. We will show that
3-foldlog terminal models are connected by ﬂips, ﬂops and inverse ﬂ ips, and in
particular two generalized klt Calabi-Yau pairs are connected by ﬂop s, which
generalizes a result of Koll´ ar for terminal varieties, see [ Kol89, Theorem 4.9].
First we deﬁne the inverse ﬂip.
Deﬁnition 3.28. Let (X,B+β) be aQ-factorial compact K¨ ahler generalized
klt pair and φ:X/axisshort/axisshort/arrowaxisrightX′a small bimeromorphic map. If φis aKX+B+βX-
ﬂip, then we call φ−1:X′/axisshort/axisshort/arrowaxisrightXaninverse ﬂip (or anti-ﬂip) of KX+B+βX.
Theorem 3.29. Let(Xi,Bi+βXi)be compact Q-factorial generalized klt
K¨ ahler 3-folds, where KXi+Bi+βXiis nef fori= 1,2andφ:X1/axisshort/axisshort/arrowaxisrightX2
a bimeromorphic map which is an isomorphism in codimension 1 . Then the
following hold:
(1)φdecomposes as a ﬁnite sequence of ﬂips, ﬂops and inverse ﬂips .
(2) Suppose that there is a positive constant b >0such that following
holds: whenever (KX1+B1+βX1)·C >0for some curve C⊂X1,
then(KX1+B1+βX1)·C≥bholds. Then φdecomposes as a ﬁnite
sequence of ﬂops.
Remark 3.30.Note that if ( X1,B1+βX1) is a good minimal model, then
there is a morphism f:X1→Z1and a K¨ ahler form ω1onZ1such that
KX1+B1+βX1≡f∗ω1. Letb:= inf{Σ·ω1|Σ⊂Z1is a curve }. So if
(KX1+B1+βX1)·C >0 for some curve C⊂X1, then Σ = f1∗C/\e}atio\slash= 0 and
(KX1+B1+βX1)·C=ω1·Σ≥b. If instead KX1+B1isQ-Cartier (and
βi= 0), then k(KX1+B1) is Cartier for some k >0 and letb=1
k. Thus, in
both of these cases, the hypothesis of (2) are satisﬁed.
Proof.Letω2be a K¨ ahler form on X2and andω1:=φ−1
∗ω2, then by Lemma
3.31,ω1has local potentials, it is modiﬁed nef and ( X1,B1+β+ǫ0¯ω1) is
generalized klt for some 0 < ǫ0≪1. We now run a KX1+B1+βX1+ǫω1-
MMP with scaling of a suﬃciently big multiple of a very general K¨ ahler cla ss,
where 0<ǫ≤ǫ0is any ﬁxed real number.
By Theorem 3.21, this MMP terminates with a minimal model ( Xm,Bm+
βXm+ǫωm),ψ:X1/axisshort/axisshort/arrowaxisrightXm. In particular, KXm+Bm+βXm+ǫωmis nefMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 45
and big. Since ( X2,B2+βX2+ǫω2) is a generalized log canonical model of
(X1,B1+βX1+ǫω1), there is a morphism Xm→X2. Since this is a small
bimeromorphic map of Q-factorial varieties, it is in fact an isomorphism by
Lemma2.15. Now observe that from Lemma A.9it follows that N(KX1+B1+
βX1+ǫω1) = 0, and thus by Theorem A.11there are no divisorial contractions
in the above MMP. So every step of this MMP is a KX1+B1+βX1+ǫω1-
ﬂip, which are in particular either ﬂips, ﬂops or inverse ﬂips with respe ct to
KX1+B1+βX1(depending on whether the KX1+B1+βX1+ǫω1ﬂipping
contraction is KX1+B1+βX1-negative, trivial or positive respectively).
Suppose now that we are in case (2) and so there is a positive consta nt
b >0 such that ( KX1+B1+βX1)·C≥bfor all curves C⊂X1such that
(KX1+B1+βX1)·C >0. We now run a KX1+B1+βX1+ǫω1-MMP
with scaling of a suﬃciently big multiple of a very general K¨ ahler class, where
0<ǫ<bǫ 0/(b+6) is any ﬁxed real number; this MMP terminates by Theorem
3.21. Now let Kt:=KX1+B1+βX1+tω1. Suppose that C1⊂X1is aKǫ-
ﬂipping curve for t=ǫ. ThenC1·ω1<0 asKX1+B1+βX1is nef, and hence
C1is aKǫ0ﬂipping curve and so we may assume that 0 >Kǫ0·C1≥ −6 by
Lemma3.24. IfK0·C1>0, then
0>Kǫ·C1=/parenleftbigg
1−ǫ
ǫ0/parenrightbigg
K0·C1+ǫ
ǫ0Kǫ0·C1≥/parenleftbigg
1−ǫ
ǫ0/parenrightbigg
b−6ǫ
ǫ0>0
which is impossible. Therefore K0·C1= 0 and the ﬁrst ﬂip X1/axisshort/axisshort/arrowaxisrightX+
1is a
KX1+B1+βX1-ﬂop. It follows that KX+
1+B+
1+βX+
1is nef. Suppose that
C⊂X+
1is a curve such that ( KX+
1+B+
1+βX+
1)·C >0, then we claim that
in fact (KX+
1+B+
1+βX+
1)·C≥band hence we may continue the procedure
inductively. Thus we obtain a sequence of ﬂips for the ( X1,B1+βX1+ǫω1)
MMP with scaling which are also KX1+B1+βX1-ﬂops connecting X1andX2.
To see the claim, let p:Y→X1andq:Y→X+
1be a common resolution.
Then by the negativity lemma p∗(KX1+B1+βX1) =q∗(KX+
1+B+
1+βX+
1).
Since (KX+
1+B+
1+βX+
1)·C >0, thenCis not contained on the indeterminacy
locusofX+
1/axisshort/axisshort/arrowaxisrightX1(i.e. itisnotcontainedintheﬂippedlocus). Let ¯C⊂Xbe
thestrict transformof C, then(KX1+B1+βX1)·¯C= (KX+
1+B+
1+βX+
1)·C >0
and so (KX+
1+B+
1+βX+
1)·C= (KX1+B1+βX1)·¯C≥b.
/square
Lemma 3.31. Letφ:X/axisshort/axisshort/arrowaxisrightX′be a bimeromorphic map between two normal
compact K¨ ahler 3-folds. Letω′be a K¨ ahler form on X′. IfXhasQ-factorial
klt singularities, then ω:=φ∗ω′is a closed positive (1,1)current on Xwith
local potentials.
Proof.LetWbe a resolution of the graph of φ, andp:W→Xandq:
W→X′are the induced bimeromorphic morphisms such that pis projective.46 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
Thenω=φ∗ω′=p∗q∗ω′. Sincepis projective and XhasQ-factorial klt
singularitites, by [ DH20, Lemma 2.27], there is an R-divisorEand an (1,1)
classα∈H1,1
BC(X) such that [ q∗ω′+E] =p∗α. Then by the negativity lemma,
E≥0 is an eﬀective divisor; in particular, q∗ω′+Eis a positive current. Thus
from [HP16, Lemma 3.4] it follows that ω=φ∗ω′=p∗q∗ω′=p∗(q∗ω′+E) has
local potentials.
/square
Proof of Theorem 1.4.This is (1) of Theorem 3.29.
/square
Appendix A.Boucksom-Zariski Decomposition
We will use the deﬁnition of Boucksom-Zariski decomposition of a (1 ,1)
pseudo-eﬀective class α∈H1,1
BC(X) on a compact complex manifold as in
[Bou04, Deﬁnition 3.7]. We will also deﬁne the Lelong number of a pseudo-
eﬀective (1,1) classα(on a manifold) as in [ Bou04, Deﬁnition 3.1]. The main
result of this section is Theorem A.11.
We recall Boucksom’s deﬁnition of the negative part of a pseudo-eﬀ ective
(1,1) class.
Deﬁnition A.1. [Bou04,Deﬁnition3.7]Let Xbeacompactcomplexmanifold
andαis a pseudo-eﬀective (1 ,1) class onX. Then we deﬁne the negative part
N(α) ofαas follows:
N(α) :=/summationdisplay
P⊂Xν(α,P)P,
wherePis a prime Weil divisor on X.
From [Bou04, Theorem 3.12(i)] it follows that N(α) is an eﬀective R-divisor.
RemarkA.2.LetXbe a compact K¨ ahler manifold and αis a pseudo-eﬀective
(1,1) class. If N(α) is the negative part of the Boucksom-Zariski decomposi-
tion and if α=β+D, whereβis a modiﬁed nef class, and Dis an eﬀective
R-divisor, then N(α) =N(β+D)≤N(β) +N(D)≤Dby [Bou04, Pro.
3.2(ii) and Pro. 3.11(ii)]. In particular, for any prime Weil divisor QonX,
ν(α,Q)≤multQ(D).
The following result will be useful for the proof of our main theorem in this
section.
Lemma A.3. Letf:Y→Xbe a proper bimeromorphic morphism of analytic
varieties where Xis relatively compact. Let Ebe an eﬀective f-exceptional R-
Cartier divisor on Y. Then there is a component E′ofEsuch thatE′isMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 47
covered by an analytic family of curves {Ct}t∈Tsuch thatE·Ct<0and
f∗Ct= 0for allt∈T.
Proof.Letν:˜Y→Ybe a resolution of singularities and ˜E=ν∗E. We may
assume that ˜f=f◦νis a projective morphism. Let m:= dimf(SuppE).
ReplacingXby a Stein open neighborhood we may assume that Xis a Stein
space. Now we cut Xbymgeneral hyperplanes of X, and replace Yand˜Y
by the corresponding inverse images. Then f(SuppE) is a ﬁnite set of points
onX. Next since ˜fis projective, possibly shrinking Xfurther we may assume
that there is a very ample divisor on ˜Y. Thus cutting ˜Ybyn−2 hyperplanes
(n= dimY), we may assume that that ˜Yis a smooth surface. Next we
replaceXby the Stein factorization of ˜f:˜Y→Xand thus assume that
Xis a normal surface and ˜fis a projective bimeromorphic morphism from a
smooth surface to a normal surface and ˜Eis an eﬀective ˜f-exceptional divisor
onY. Let˜E=/summationtextℓ
i=1aiCi. Since the intersection matrix of the exceptional
curves of ˜fform a negative deﬁnite matrix by [ KM98, Lemma 3.40], we have
0>˜E2=/summationtextℓ
i=1ai(E·Ci), and thus ˜E·Ci<0 for some 1 ≤i≤ℓ. Note that
E·ν∗Ci=˜E·Ci<0 and hence Ciis notν-exceptional.
SinceXis relatively compact, it can be covered by ﬁnitely many Stein open
sets, and thus the lemma follows. /square
Deﬁnition A.4. LetXbe a normal analytic variety and D=/summationtextaiDiand
D′=/summationtexta′
iDiare twoR-divisors on X. Then we deﬁne the R-divisorD∧D′
as
D∧D′:=/summationdisplay
imin{ai,a′
i}Di.
Lemma A.5. Letf:Y→Xbe a proper bimeromorphic morphism from a
compact complex manifold Yto a normal compact analytic variety Xandα
is a pseudo-eﬀective (1,1)class onX. IfE≥0is an eﬀective f-exceptional
R-divisor, then ν(f∗α+E,P) =ν(f∗α,P)+mult P(E)for every prime Weil
divisorPonY. In particular, N(f∗α+E) =N(f∗α)+E.
Proof.LetE=/summationtextaiEi. By remark A.2, we haveN(f∗α+E)≤N(f∗α)+E
and soν(f∗α+E,E)≤ν(f∗α,E)+ai. To see the reverse inequality, suppose
thatf∗α+E=β+Nis the Boucksom-Zariski decomposition of f∗α+E
so thatN=/summationtextν(f∗α+E,Q)Q. We claim that E≤N. To see this, deﬁne
N′:=N−N∧EandE′:=E−N∧E, so thatf∗α+E′=β+N′. We
must show that E′= 0. If this is not the case, then, by Lemma A.3, there is a
component EiofE′which is covered by curves {Ct}t∈Tsuch thatE′·Ct<0
andf∗Ct= 0 for all t∈T. But then the family of curves {Ct}t∈Tis not
contained in the support of N′and so
0>E′·Ct= (f∗α+E′)·Ct≥N′·Ct≥0.48 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
This is a contradiction, and hence E≤N. Thenf∗α=β+N′, whereβis
modiﬁed nef and N′=N−E≥0. This implies that
ν(f∗α,Ei)≤multEi(N′) = mult Ei(N)−multEi(E) =ν(f∗α+E,Ei)−ai.
Putting all of these together, we have that ν(f∗α+E,Ei) =ν(f∗α,Ei) +ai
and henceN(f∗α+E) =N(f∗α)+E.
/square
Now we are ready to deﬁne the negative part of a pseudo-eﬀective (1,1)
class on a normal variety and prove the main result of this appendix.
Deﬁnition A.6. LetXbe a normal compact K¨ ahler variety and α∈H1,1
BC(X)
a pseudo-eﬀective class. Let f:Y→Xbe a resolution of singularities X.
Then we deﬁne the negative part N(α) as follows:
N(α) :=f∗(N(f∗α)).
The following Lemma A.7guarantees that this deﬁnition is independent of the
choice of resolution f.
Lemma A.7. LetXbe a normal compact K¨ ahler variety and α∈H1,1
BC(X)a
pseudo-eﬀective class. Let f:Y→Xandg:Z→Xbe two resolutions of
singularities of X. Then
f∗(N(f∗α)) =g∗(N(g∗α)).
Proof.ItiseasytoseefromthedeﬁnitionofLelongnumbers thatif f:Y→X
is a proper bimeromorphic map of compact K¨ ahler manifolds and Pis a prime
divisor on YandQ=f∗P/\e}atio\slash= 0, then ν(α,Q) =ν(f∗α,P) and therefore
f∗(N(f∗α)) =g∗(N(g∗α)).
Passing to the general situation, let Wbe a common resolution of YandZ,
andp:W→Yandq:W→Zare the projections. Then p∗(f∗α) =q∗(g∗α),
andthus(f◦p)∗N(p∗(f∗α)) = (g◦q)∗N(q∗(g∗α)). Thenfromwhatweobserved
above it follows that f∗N(f∗α) =g∗N(g∗α) and we are done.
/square
Remark A.8.From our deﬁnition above and Remark A.2it follows that if α
is a pseudo-eﬀective class on a normal compact analytic variety X, thenN(α)
is an eﬀective R-divisor on X. Moreover, if αandβare two pseudo-eﬀective
classes onanormalcompactanalyticvariety X, thenN(α+β)≤N(α)+N(β).
Lemma A.9. Letf:X′→Xbe a proper bimeromorphic morphism of normal
compact K¨ ahler varieties. Let α′∈H1,1
BC(X′)be a nef class such that α:=f∗α′
is contained in H1,1
BC(X). ThenN(α) = 0.
Proof.Letg:X′′→X′be a resolution of singularities of X′. Then we have
(f◦g)∗α=g∗α′+E, whereEisf◦g-exceptional R-divisor. By the negativityMMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 49
lemma it follows that Eis an eﬀective divisor. Therefore by Lemma A.5,
N((f◦g)∗α) =N(g∗α′)+E=E, sinceg∗α′is nef. Then from the deﬁnition
we haveN(α) = (f◦g)∗(E) = 0. /square
Deﬁnition A.10. Letφ:X/axisshort/axisshort/arrowaxisrightX′beabimeromorphiccontractionofnormal
compact analytic varieties. Let α∈H1,1
BC(X) and assume that α′:=φ∗α∈
H1,1
BC(X′). We say that φisα-negative, if for any common resolution p:W→
Xandq:W→X′, we may write
p∗α=q∗α′+E,
whereE≥0isaneﬀective R-divisorsuchthatitis q-exceptionalandSupp( p∗E)
consists precisely the φ-exceptional divisors on X.
The following theorem is the main result of this section.
Theorem A.11. Letφ:X/axisshort/axisshort/arrowaxisrightX′be a bimeromorphic contraction of normal
compact K¨ ahler varieties. Let (X,B+βX)and(X′,B′+βX′)be generalized
dlt pairs such that KX+B+βXis pseudo-eﬀective and B′+βX′=φ∗(B+βX).
IfφisKX+B+βX-negative, then the divisors contracted by φare contained
in the support of N(KX+B+βX). In particular, if KX′+B′+βX′is nef,
then the divisors contracted by φare precisely the divisors in the support of
N(KX+B+βX).
Proof.LetWbeacompactK¨ ahlermanifoldresolving themap φ, andp:W→
Xandq:W→Yare the projections. Since φisKX+B+βX-negative, we
have
(A.1) p∗(KX+B+βX) =q∗(KX′+B′+βX′)+E,
whereE≥0 is an eﬀective q-exceptional divisor and the support of p∗Eis the
set of divisors contracted by φ.
Then by Lemma A.5
N(p∗(KX+B+βX)) =N(q∗(KX′+B′+βX′)+E) =N(q∗(KX′+B′+βX′))+E,
and by Deﬁnition A.6,N(KX+B+βX) =p∗(N(q∗(KX′+B′+βX′))+E). In
particular, the φ-exceptional divisors are contained in the support of N(KX+
B+βX).
Moreover, if KX′+B′+βX′is nef, then N(q∗(KX′+B′+βX′)) = 0, and so
N(KX+B+βX) =p∗Eand we are done.
/square50 OMPROKASH DAS, CHRISTOPHER HACON, AND JOS ´E IGNACIO Y ´A˜NEZ
References
[BCE+02] T. Bauer, F. Campana, T. Eckl, S. Kebekus, T. Peternell, S. a. Rams, T. Szem-
berg and L. Wotzlaw, A reduction map for nef line bundles, in Complex geom-
etry (G¨ ottingen, 2000) , pages 27–36, Springer, Berlin, 2002.
[BCHM10] C. Birkar, P. Cascini, C. D. Hacon and J. McKernan, Existence of minimal
models for varieties of log general type , J. Amer. Math. Soc. 23(2), 405–468
(2010).
[BG13] S. Boucksom and V. Guedj, Regularizing properties of the K¨ ahler-Ricci ﬂow,
inAn introduction to the K¨ ahler-Ricci ﬂow , volume 2086 of Lecture Notes in
Math., pages 189–237, Springer, Cham, 2013.
[Bir21] C. Birkar, Generalised pairs in birational geometry , EMS Surv. Math. Sci.
8(1-2), 5–24 (2021).
[Bou02] S. Boucksom, On the volume of a line bundle , Internat. J. Math. 13(10),
1043–1063 (2002).
[Bou04] S. Boucksom, Divisorial Zariskidecompositions on compact complex manifolds ,
Ann. Sci. ´Ecole Norm. Sup. (4) 37(1), 45–76 (2004).
[BS95] M. C. Beltrametti and A. J. Sommese, The adjunction theory of complex
projective varieties , volume 16 of De Gruyter Expositions in Mathematics ,
Walter de Gruyter & Co., Berlin, 1995.
[BZ16] C. Birkar and D.-Q. Zhang, Eﬀectivity of Iitaka ﬁbrations and pluricanonical
systems of polarized pairs , Pub. Math. IHES. 123, 283–331 (2016).
[CHP16] F. Campana, A. H¨ oring and T. Peternell, Abundance for K¨ ahler threefolds ,
Ann. Sci. ´Ec. Norm. Sup´ er. (4) 49(4), 971–1025 (2016).
[DH20] O. Das and C. Hacon, The logminimal model programfor K¨ ahler 3-folds, arXiv
e-prints , arXiv:2009.05924 (September 2020), 2009.05924.
[DH23] O. Das and C. Hacon, The minimal model program for pseudo-eﬀective K¨ ahler
4-fold pairs , In progress (2023).
[DHP22] O. Das, C. Hacon and M. P˘ aun, On the4-dimensional minimal model program
for K¨ ahler varieties , arXiv e-prints , arXiv:2205.12205 (May 2022), 2205.12205.
[DO23] O. Das and W. Ou, On the Log Abundance for Compact K¨ ahler threefolds ,
manuscripta math. (January 2023).
[FM00] O.FujinoandS.Mori, Acanonicalbundleformula ,J.DiﬀerentialGeom. 56(1),
167–188 (2000).
[Fuj19] O. Fujino, Minimal model theory for log surfaces in Fujiki’s class C, arXiv
preprint arXiv:1908.00170 (2019).
[Fuj21] O. Fujino, Minimal model theory for log surfaces in Fujiki’s class C, Nagoya
Math. J. 244, 256–282 (2021).
[Fuj22] O. Fujino, Minimal model program for projective morphisms between complex
analytic spaces , (2022).
[Gue20] H. Guenancia, Families ofconicK¨ ahler-Einsteinmetrics , Math. Ann. 376(1-2),
1–37 (2020).
[Hir75] H. Hironaka, Flattening theoremin complex-analyticgeometry , Amer. J. Math.
97, 503–547 (1975).
[HL21] C. Hacon and J. Liu, Existence of ﬂips for generailzed lc pairs , arXiv e-prints ,
arXiv:2105.13590 (2021), 2105.13590.
[HP15] A. H¨ oring and T. Peternell, Mori ﬁbre spaces for K¨ ahler threefolds , J. Math.
Sci. Univ. Tokyo 22(1), 219–246 (2015).MMP FOR GENERALIZED PAIRS ON K ¨AHLER 3-FOLDS 51
[HP16] A. H¨ oring and T. Peternell, Minimal models for K¨ ahler threefolds , Invent.
Math.203(1), 217–264 (2016).
[Kaw98] Y. Kawamata, Subadjunction of log canonical divisors. II , Amer. J. Math.
120(5), 893–899 (1998).
[KM98] J. Koll´ ar and S. Mori, Birational geometry of algebraic varieties , volume 134
ofCambridge Tracts in Mathematics , Cambridge University Press, Cambridge,
1998, With the collaboration of C. H. Clemens and A. Corti, Translate d from
the 1998 Japanese original.
[Kol89] J. Koll´ ar, Flops, Nagoya Math. J. 113, 15–36 (1989).
[Kol97] J. Koll´ ar, Singularities of pairs, in Algebraic geometry—Santa Cruz 1995 , vol-
ume 62 of Proc. Sympos. Pure Math. , pages 221–287, Amer. Math. Soc., Prov-
idence, RI, 1997.
[LP20] V. Lazi´ c and T. Peternell, On generalised abundance, I , Publ. Res. Inst. Math.
Sci.56(2), 353–389 (2020).
[Nam02] Y. Namikawa, Projectivity criterion of Moishezon spaces and density of projec-
tive symplectic varieties , Internat. J. Math. 13(2), 125–135 (2002).
[Tom16] M. Toma, Bounded sets of sheaves on K¨ ahler manifolds , J. Reine Angew. Math.
710, 77–93 (2016).
School of Mathematics, Tata Institute of Fundamental Resea rch, Homi
Bhabha Road, Navy Nagar, Colaba, Mumbai 400005
Email address :omdas@math.tifr.res.in
Email address :omprokash@gmail.com
Department of Mathematics, University of Utah, 155 S 1400 E, Salt Lake
City, Utah 84112
Email address :hacon@math.utah.edu
Department of Mathematics, University of Utah, 155 S 1400 E, Salt Lake
City, Utah 84112
Email address :yanez@math.utah.edu