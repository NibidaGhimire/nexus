arXiv:2305.08956v4  [math.NT]  3 Jun 2024THE HARRIS–VENKATESH CONJECTURE FOR DERIVED
HECKE OPERATORS II: A UNIFIED STARK CONJECTURE
ROBIN ZHANG
Abstract. We prove a compatibility theorem between the Stark con-
jecture and the Harris–Venkatesh conjecture for imaginary dihedral
modular forms of weight 1. The key technical input is a general two-
variable PGL2Siegel–Weil formula that precisely gives the Laurent
series coeﬃcients of Eisenstein series as a dual theta lift o f Eisenstein
series. This two-variable Siegel–Weil formula is applied t o Rankin–
Selberg periods of imaginary dihedral optimal forms and a re ﬁne-
ment of Stark’s formula relating L-values with elliptic units, yielding
compatibility between derived Hecke operators and adjoint L-values
for Deligne–Serre representations. We formulate a general uniﬁed
conjecture encompassing the Stark and Harris–Venkatesh co njectures
and conceptually reinterpret the action of derived Hecke op erators as
modular Stark unit data at almost all primes.
Contents
1. Introduction 1
2. A formula for theta liftings of Eisenstein series 5
3. Stark units for imaginary quadratic ﬁelds 10
4. Global Rankin–Selberg periods 14
5. Proof of the compatibility theorem 17
References 18
1.Introduction
The Stark conjecture [Sta71, Sta75, Sta76, Sta80] relates t he leading coeﬃcient
of Artin L-functions to the existence of certain algebraic units call edStark units .
The work of Harris–Venkatesh [HV19] examines modular forms of weight- 1, which
occur in both the degree- 0and degree- 1coherent cohomology of the same weight 1
automorphic vector bundle unlike modular forms of weight ≥2, and construct de-
rived Hecke operators Tp,N:H0(X1(N)Z/(p−1)Z,ω)→H1(X1(N)Z/(p−1)Z,ω). These
degree-shifting operators are the subject of the vast conje ctures of Venkatesh [Ven19],
Prasanna–Venkatesh [PV21], and Galatius–Venkatesh [GV18 ] on the interplay be-
tween derived Hecke algebras, rational structures of motiv ic cohomology groups, and
Date: June 3, 2024.
12 ROBIN ZHANG
derived Galois deformation rings. The Harris–Venkatesh co njecture [HV19] relates
the action of derived Hecke operators on modular forms of wei ght1to algebraic
units modulo pfor almost all primes p. Inspired by a question of Gross, we prove
that the Harris–Venkatesh conjecture and the Stark conject ure actually describe the
same units in the case of imaginary dihedral modular forms of weight1and suggest
that there is a more general phenomenon.
Letf=/summationtext
nanqnbe a newform of weight 1forΓ1(N)with associated Deligne–
Serre representation ρf, a2-dimensional complex Galois representation of Gal(Q/Q).
It has a3-dimensional trace-free adjoint representation Ad(ρf)with ﬁnite projective
image that can either be dihedral or exotic (isomorphic to A4,S4, orA5). We view f
as a modular form with coeﬃcients in the ring of integers Z[f] =Z[χρf]of the number
ﬁeldQ(f) =Q(χρf)generated by the trace of ρf(or coeﬃcients of f). LetE/Qbe
a ﬁnite Galois extension such that Ad(ρf)factors through Gal(E/Q)and letMbe
the lattice in Ad(ρf)generated by elements of the form 2ρf(σ)−Tr(ρf(σ))Id2×2with
σ∈Gal(E/Q). The conjectures of Stark and Harris–Venkatesh relate inva riants of f
to elements in a (dual) space of units:
U/parenleftbig
Ad(ρf)/parenrightbig
:=HomGal(E/Q)/parenleftbig
M,O×
E⊗Z[χρf]/parenrightbig
.
This is a rank- 1Z[χρf]-module that, like M, does not depend on the choice of E(as
detailed in [HV19, Lemma 2.1], [Hor23, Corollary 2.6]). Let tingZ(p−1)be subring
ofQwith denominators coprime to p−1, there are regulator maps with values in R
andF×
pfor anyp∤6N,
RegR:U/parenleftbig
Ad(ρf)/parenrightbig
⊗Q−→R⊗Q[χρf]
RegF×
p:U/parenleftbig
Ad(ρf)/parenrightbig
⊗Z(p−1)−→F×
p⊗Z/bracketleftbigg
χρf,1
6N/bracketrightbigg
,
obtained from evaluation maps on distinguished elements xw∈Mat an archimedean
placewor a non-archimedean place wabovep(see [DHRV22, Zha23a]).
Letf∗=/summationtext
nanqnbe the complex conjugate form of fgiven by f∗(z) :=f(−z),
and letf∗be the Serre-dual of f∗given by /angbracketleftf∗,f∗/angbracketrightSD=1. The Harris–Venkatesh
conjecture predicts that there are global objects u∈ U(Ad(ρf))andm∈Nsuch
thatm·Tp,N(f) =RegF×
p(u)·f∗simultaneously for every prime p∤6N. Using the
Shimura class Sp∈Hom(S2(Γ0(p)),F×
p⊗Z[1/6])as described in [HV19, Section 3.1],
[DHRV22, Section 1.1], and [Zha23a], the prescribed equati on can be written more
explicitly as
m·Sp/parenleftBig
TrΓ0(p)∩Γ1(N)
Γ0(p)/parenleftbig
f(z)f∗(pz)/parenrightbig/parenrightBig
=RegF×
p(u).
As noted in [DHRV22, Section 1.2], both sides are independen t of the choice of a
ﬁnite place above p. For notational convenience, we will use the Harris–Venkat esh
norm deﬁned for any prime p∤6N:
||f||2
F×
p:= Sp/parenleftBig
TrΓ0(p)∩Γ1(N)
Γ0(p)(f(z)f∗(pz))/parenrightBig
∈F×
p⊗Z/bracketleftbigg
χρf,1
6N/bracketrightbigg
.
The Stark conjecture [Sta71, Sta75, Sta76, Sta80] for Ad(ρf)predicts that there
is aunique (up to multiplication by roots of unity) element uStark∈ U(Ad(ρf))⊗QTHE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 3
that describes the leading coeﬃcient of the Artin L-functions:
L′/parenleftbig
Ad(ρf),0/parenrightbig
=RegR(uStark),
and compatibly so with Galois conjugation of Ad(ρf). As observed by Stark [Sta75,
Section 6], the Petersson norm
||f||2
R=/integraldisplay
X0(N)|f|2dxdy
y∈R,
is proportional to L′(Ad(ρf),0)by a constant involving a ﬁnite product of Euler
factors only depending on f. Both the Stark regulator and the Petersson norm vary
with the choice of complex embedding (i.e. Galois conjugati on ofAd(ρf)) in the
same way.
Most newforms of weight 1are dihedral, in which case there is a quadratic number
ﬁeldKsuch that ρfis induced from a character χofGal(K/K). Whenfis imaginary
dihedral ( K/Qis imaginary quadratic), the Stark conjecture for Ad(ρf)was proved
in the fourth part of Stark’s series of papers [Sta80, Theore m 2] and the Harris–
Venkatesh conjecture was proved in the ﬁrst part of this seri es [Zha23a, Theorem
4]. We prove that these two theorems are compatible, precise ly relating the uStark
of the Stark conjecture with the uof the Harris–Venkatesh conjecture.
Theorem 1.Letfbe an imaginary dihedral newform of weight 1and level N.
There is a unique (up to multiplication by roots of unity) uf∈ U(Ad(ρf))⊗Qsuch
that,
(a)
||f||2
R=RegR(uf),
compatible with conjugations of funderAut(C);
(b) for each suﬃciently large prime p,
||f||2
F×
p=RegF×
p(uf).
Remark 2.Condition (a) of Theorem 1 is equivalent to the Stark conject ure for
Ad(ρf)because the ratio of ufanduStarkcorresponds to the proportionality of ||f||2
R
andL′(Ad(ρf),0). Without the uniqueness of uf, condition (b) is equivalent to the
Harris–Venkatesh conjecture because ucan be chosen to be any multiple of ufand
both sides vanish mod pfor primes smaller than some minimal prime p0when both
sides are multiplied by a positive integer m∈/parenleftBig/producttext
p<p0p/parenrightBig
N.
Remark 3.Horawa [Hor23, Conjecture 1.1] reformulates the Harris–Ve nkatesh
conjecture and the Stark conjecture in the motivic language of Venkatesh [Ven19]
and Prasanna–Venkatesh [PV21]. In that context, Theorem 1 g ives a strengthening
of theF=Qimaginary dihedral case of [Hor23, Conjecture 1.1 and Theor em 1.2] by
removing the ambiguity of O×
EandQ(χρf)×. Theorem 1 demonstrates the existence
of an action of U∨
fonH∗(XZ[1/N],ω)fsuch that,
(a) the(U∨
f⊗C)-action coincides with u∈U∨
f⊗Qsendingf/mapsto→ω∞
f
log|u|;
(b) the(U∨
f⊗Fp)-action coincides with the action of the derived Hecke opera tor.4 ROBIN ZHANG
The key technical input needed for the proof of Theorem 1 is a p recise two-variable
Siegel–Weil formula on PGL2. The classical Siegel–Weil formula is an identity be-
tween an integral of a theta function and a value of a classica l Eisenstein series,
dating back to the seminal works of Siegel [Sie35] and Weil [W ei64, Wei65]. It
has been extended to residues (e.g. second-term identities ), to points outside the
region of absolute convergence, and to diﬀerent groups sinc e then (e.g. [KR88a,
KR88b, KR94, Ike96, Ich01, Yam11, Yam13, Yam14, GQT14]). Th is includes a gen-
eral framework for the special orthogonal groups correspon ding to the Siegel–Weil
formula for PGL2×PGL2, but the following explicit form has not been written
down before to the author’s knowledge. Let [PGL2] :=PGL2(Q)\PGL2(A)and let
Es=/summationtext∞
n=−1Ensnbe the automorphic avatar of the classical Eisenstein serie s with
its Laurent expansion. Our two-variable Siegel–Weil formu la for the Eisenstein se-
riesEsuses the theta lifting (and its dual) from the space A2of automorphic forms
perpendicular to constant functions to the space A1of functions that decay at cusps:
A2([PGL2]×[PGL2]) A1([PGL2])
A∗
1([PGL2]) A∗
2([PGL2]×[PGL2]).Θ
Θ∗
Theorem 4.For the Eisenstein series Es,
Θ∗(Es) =Es⊗Es.
Furthermore, for any n≥−1,
Θ∗(En) =/summationdisplay
i+j=nEi·Ej.
A special case of Theorem 4 is the identity
Θ∗( /BD) = /BD⊗E0+E0⊗ /BD,
which extends the formula of Darmon–Harris–Rotger–Venkat esh [DHRV22, Theo-
rem 5.4] from the setting of higher Eisenstein series develo ped by Merel [Mer96]
and Lecouturier [Lec21] to Laurent coeﬃcients of Eisenstei n series. This identity
can be applied to explicitly calculate Rankin–Selberg conv olutions of certain theta
series, including those corresponding to the two-variable optimal forms deﬁned in
[Zha23a, Section 6]. By the theory of Rankin–Selberg periods and multiplicity-one
arguments developed in [Zha23a], these calculations then g ive rise to units satisfying
the Harris–Venkatesh conjecture. We then precisely pin dow n the unit ufusing the
Kronecker limit formula for the Laurent coeﬃcient E0and a reﬁnement of Stark’s
formula [Sta80, Lemma 7] relating L-values with the explicit elliptic unit uξdeﬁned
in [Zha23a, Equation 8.2] for ring class characters ξ. As in Stark’s conjecture [Sta80,
Conjecture 1] and Stark’s formula [Sta80, Lemma 7] for imagi nary quadratic ﬁelds
K, we focus on ring class characters of conductor c > 1 due to the non-vanishing of
ζK(0).
Proposition 5.LetKbe an imaginary quadratic number ﬁeld. If ξis a ring
class character of conductor c > 1, then its Hecke L-function satisﬁes
L′(ξ,0) = −1
6m(ξ)log(uξ).THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 5
Finally, we propose that the derived Hecke operators of Harr is–Venkatesh give the
mod-pdata of the Stark unit for allnewforms of weight 1and almost all primes p.
Conjecture 6.Letfbe a newform of weight 1and level N. There is a unique
(up to multiplication by roots of unity) uf∈ U(Ad(ρf))⊗Qsuch that,
(a)
||f||2
R=RegR(uf),
compatible with conjugations of funderAut(C);
(b) for each suﬃciently large prime p,
||f||2
F×
p=RegF×
p(uf).
Remark 7.As with Theorem 1, Conjecture 6 is a strengthening of the F=Qcase
of [Hor23, Conjecture 1.1 and Theorem 1.2]. Horawa [Hor23, C onjecture 1.1] also
considers totally real base ﬁelds F; we expect that there is a version of Conjecture 6
for totally real F.
There is numerical evidence for the Stark and Harris–Venkat esh conjectures in
the exotic cases (e.g. [Chi83, Fog98, JRS03, Mar21]), but th e Stark and Harris–
Venkatesh conjectures are still open for most exotic newfor ms. Conjecture 6 suggests
that the Stark and Harris–Venkatesh conjectures should be a t least as diﬃcult as
the other. One can speculate that in this picture, one could a pproach Stark units
by understanding ||f||2
F×
pat all but ﬁnitely many primes p.
While the construction of Stark units for exotic newforms st ill eludes current
techniques, the theory of optimal forms developed in [Zha23 a] can be extended to
a large class of exotic newforms. This is the subject of the th ird part of this series
[Zha23b], where the minimal prime p0of condition (b) of Theorem 1 and Conjecture
6 is precisely described using local data and where the local theory is extended to
locally dihedral forms (including exotic weight- 1newforms fof odd level or 2-ordinary
Deligne–Serre representation ρf).
1.1.Acknowledgements. This work would not have been possible without the
support and encouragement of Michael Harris, who advised th e thesis that this ar-
ticle extends, and Dick Gross, who asked insightful questio ns about the units in my
thesis and encouragingly described the resolution given he rein as showing that there
is "one unit to rule them all". I would also like to thank Henri Darmon, Emmanuel
Lecouturier, Yingkun Li, Loïc Merel, and Akshay Venkatesh f or illuminating conver-
sations, as well as Aleksander Horawa for pointing out the co nnections in Remark
7.
This material is based on work supported by the National Scie nce Foundation
under Grant No. DGE-1644869 and Grant No. DMS-2303280.
2.A formula for theta liftings of Eisenstein series
2.1.θlifting. LetV= (M2(Q),det)with a split quadratic form of dimension 4. Let
GO(V)denote the group of orthogonal similitudes of V, i.e. the group of elements
g∈GL(V)such that /angbracketleftgx,gy/angbracketright=ν(g)/angbracketleftx,y/angbracketrightfor some ν(g)∈Q×. Forg∈GO(V), we6 ROBIN ZHANG
denote the conjugate by g=ν(g)g−1. LetGSO(V)be the connected component of
the identity of GO(V),
GSO(V) = (GL2×GL2)/∆Gm.
With square brackets, [G]denotes the quotient G(Q)\G(A).
We have the Weil representation rofGL2(A)×GmGSO(VA)onS(VA)and a theta
kernel for each Φ∈ S(VA)(cf. [YZZ13, Section 2.1] and [Zha23a, Section 5.1]),
θ(g,h,Φ) :=/summationdisplay
x∈Vr(g,h)Φ(x).
We want to consider the theta liftings between forms on [GL2]and[GSO(V)].For
any automorphic function ϕon[GSO(V)]andΦ∈ S(VA), we have a function,
θ(g,ϕ,Φ) =/integraldisplay
[SO(V)]θ(g,hh0,Φ)ϕ(hh0)dh,
whereh0∈GSO(V)is an element with norm detgto ensure that hh0is inGSO(V)
and has the same norm as g.
Lety∈A×andh1∈GSO(V)such that ν(h1) =y. Then we have for a(y) :=/parenleftbigy 0
0 1/parenrightbig
,
θ(a(y)g,ϕ,Φ) =/integraldisplay
[SO(V)]θ(a(y)g,hh1h0,Φ)ϕ(hh1h0)dh (2.1)
=/integraldisplay
[GSO(V)]/summationdisplay
x∈Vr(g,h0)Φ/parenleftbig
h1hx/parenrightbig
|y|ϕ(hh1h0)dh.
Here we used the fact that for d(y) :=/parenleftbig1y/parenrightbig
andm(y) :=/parenleftBigy
y−1/parenrightBig
(cf. [Zha23a,
Section 5.1]),
r(a(y),h1)Φ(x) =r(m(y))r(d(y),h1)Φ(x)
=|y|2r(d(y),h1)Φ(yx)
=|y|2|y|−1Φ/parenleftBig
h−1
1yx/parenrightBig
=|y|Φ/parenleftbig
h1x/parenrightbig
.
Every term in the sum has exponential decay in y, except the term for x=0:
r(g,h0)Φ(0)/integraldisplay
[SO(V)]ϕ(hh1h0)dh.
Letωbe a character of Q×\A×. Ifϕhas central character ω−1, thenθ(g,ϕ,Φ)
has central character ω−1.
LetM([GL2],ω±1)be the space of automorphic functions on [GL2]with central
character ω±1and rapid decay at cusps, and let M([GSO(V)],ω±1)be the space of
automorphic functions ϕon[GSO(V)]with central character ω±1and rapid decay
at cusps such that/integraltext
[GSO(V)]ϕ(hh0)dh=0for allh0∈[GSO(V)]. Then we have
deﬁned a theta lifting:
θ:M/parenleftBig
[GSO(V)],ω−1/parenrightBig
⊗S(VA)−→M/parenleftBig
[GL2],ω−1/parenrightBig
.THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 7
We also have the dual theta lifting,
θ∗:M∗/parenleftBig
[GL2],ω/parenrightBig
⊗S(VA)−→M∗/parenleftBig
[GSO(V)],ω/parenrightBig
.
The main goal of this section is to compute θ∗(h,E,Φ)for the Siegel Eisenstein
series,
E(g,f,s) =/summationdisplay
γ∈P(Q)\GL2(Q)f(γg),
wherefis a function on GL2(A)×Csuch that,
f/parenleftbigg/parenleftbigg
a b
0 d/parenrightbigg
k/parenrightbigg
=µ1(a)µ2(d)/vextendsingle/vextendsingle/vextendsinglea
d/vextendsingle/vextendsingle/vextendsinglesf(k),
withµ1,µ2two characters of Q×\A×such that µ1·µ2=ω. When ℜs≫0, the
Eisenstein series E(g,f,s)is absolutely convergent. Let Hs(µ1,µ2)be the space of
such functions fonGL2(A)×C, and let πs(µ1,µ2)be the space of Eisenstein series
formsE(g,f,s)withf∈Hs(µ1,µ2).
Theorem 2.1.θ∗deﬁnes a map,
θ∗:πs/parenleftbig
µ1,µ2/parenrightbig
⊗S(VA)−→πs/parenleftbig
µ−1
1,µ−1
2/parenrightbig
⊗πs/parenleftbig
µ2,µ1/parenrightbig
.
Proof. Fix aΦ∈ S(VA)andf∈Hs(µ1,µ2). We can then write Es(g) :=E(g,f,s)
andθ∗(E) :=θ∗(E,Φ). For any ϕ∈ M([GSO(V)],ω), unfolding the integral gives,
/angbracketleftθ∗(Es),ϕ/angbracketright=/integraldisplay
[PGL2]θ(g,ϕ,Φ)Es(g)dg
=/integraldisplay
P(Q)Z(A)\GL2(A)θ(g,ϕ,Φ)f(g)dg.
Now we use the measure dg=|y|−1dxd×ydkfor the Iwasawa decomposition g=
zn(x)a(y)kwithn(x) :=/parenleftbig1 x
1/parenrightbig
andk∈K, the standard maximal compact subgroup
ofSL2(Z), to obtain,
/angbracketleftθ∗(Es),ϕ/angbracketright=/integraldisplay
P(Q)Z(A)\GL2(A)θ/parenleftbig
n(x)a(y)k,ϕ,Φ/parenrightbig
µ1(y)|y|s−1f(k)dxd×ydk.
The integration over dxamounts to replacing θ(g,ϕ,Φ)by,
I1=/integraldisplay
[SO(V)]/summationdisplay
x∈Vdet=0r/parenleftbig
g,h0/parenrightbig
Φ/parenleftbig
h−1x/parenrightbig
ϕ/parenleftbig
hh0/parenrightbig
dh.
Sinceϕ∈ M([GO(V)],ω−1), there is no contribution from the term at x=0.
Therefore we can replace Vdet=0by the subset X⊂Vof non-zero elements with
det=0. For integration over µ−1
1(y)|y|−1d×y, we use Equation 2.1 to replace I1by
/integraldisplay
[SO(V)]/summationdisplay
x∈Xr(g,h0)Φ/parenleftbig
h1hx/parenrightbig
ϕ(hh1h0)|y|dh,8 ROBIN ZHANG
whereh1∈GSO(V)so thatν(h1) =y. Finally for the integration over k, we take
a section hk:= (k,1); therefore
/angbracketleftθ∗(Es),ϕ/angbracketright=/integraldisplay
K/integraldisplay
Q×\A×/integraldisplay
[SO(V)]/summationdisplay
x∈Xr(k,hk)Φ/parenleftbig
h1hx/parenrightbig
ϕ/parenleftbig
hh1hk/parenrightbig
dhµ−1
1(y)|y|sdyf(k)dk
The inside two integrals can be calculated together as a sing le integral,
/integraldisplay
[SO(V)]/summationdisplay
x∈Xr(k,hk)Φ/parenleftbig
h1hx/parenrightbig
ϕ/parenleftbig
hh1hk/parenrightbig
dhµ−1
1(y)|y|sdy
=/integraldisplay
[GO(V)]/summationdisplay
x∈Xr/parenleftbig
k,hk/parenrightbig
Φ/parenleftbig
hx/parenrightbig
ϕ(h)µ−1
1/parenleftbig
ν(h)/parenrightbig
|ν(h)|sdh
=/integraldisplay
[GSO(V)]/summationdisplay
x∈Xr/parenleftbig
k,hk/parenrightbig
Φ/parenleftbig
hx/parenrightbig
|ν(h)|sµ−1
1/parenleftbig
ν(h)/parenrightbig
ϕ(h)dh
Deﬁne/tildewideΦ∈ S(VA)by,
/tildewideΦ:=/integraldisplay
Kf(k)r(k,hk)Φdk.
Then we have,
/angbracketleftθ∗(Es),ϕ/angbracketright=/integraldisplay
[GSO]/summationdisplay
x∈X/tildewideΦ/parenleftbig
hx/parenrightbig
|ν(h)|sµ−1
1/parenleftbig
ν(h)/parenrightbig
ϕ(h)dh.
Integrate over the center to obtain,
θ∗(Es) =µ−1
1/parenleftbig
ν(h)/parenrightbig
|ν(h)|s/integraldisplay
Q×\A×/summationdisplay
x∈X/tildewideΦ/parenleftbig
zhx/parenrightbig
µ2µ−1
1(z)|z|2sdz
=/summationdisplay
x∈X/Q×µ−1
1/parenleftbig
ν(h)/parenrightbig
|ν(h)|s/integraldisplay
A×/tildewideΦ/parenleftbig
zhx/parenrightbig
µ2µ−1
1(z)|z|2sdz.
A further change variable z/mapsto→zν(h)−1gives,
θ∗(Es) =/summationdisplay
x∈X/Q×µ−1
2/parenleftbig
ν(h)/parenrightbig
|ν(h)|−s/integraldisplay
A×/tildewideΦ/parenleftbig
zh−1x/parenrightbig
µ2µ−1
1(z)|z|2sdz.
Now we write this as an Eisenstein series. For this, we know th atX/Q×is the
orbit ofQx0withx0=/parenleftbig0 1
0 0/parenrightbig
underGSO(V) =GL2×GL2/∆(Gm)with stabilizer
P×P, wherePis the subgroup of upper triangular matrices in GL2. Thus we can
write
θ∗(Es)(h1,h2) =/summationdisplay
(γ1,γ2)∈(P\GL2)×(P\GL2)Fs(γ1h1,γ2h2),
whereFs(h1,h2)is the function on GL2(A)×GL2(A),
Fs(h1,h2) :=µ−1
2/parenleftBig
deth1h−1
2/parenrightBig/vextendsingle/vextendsingle/vextendsingledet(h1h−1
2)/vextendsingle/vextendsingle/vextendsingle−s/integraldisplay
A×/tildewideΦ/parenleftbig
zh−1
1x0h2/parenrightbig
µ2µ−1
1(z)|z|2sdz.THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 9
We want to study the behavior of Fsunder left-translation by elements in P(A)×
P(A). For the diagonal elements m1=/parenleftBig
a10
0 b1/parenrightBig
andm2=/parenleftBig
a20
0 b2/parenrightBig
,
Fs/parenleftbig
m1h1, m2h2/parenrightbig
=µ−1
2/parenleftbig
a1b1a−1
2b−1
2/parenrightbig/vextendsingle/vextendsingle/vextendsinglea1b1a−1
2b−1
2/vextendsingle/vextendsingle/vextendsingle−s
·µ2µ−1
1/parenleftbig
a1b−1
2/parenrightbig/vextendsingle/vextendsingle/vextendsinglea1b−1
2/vextendsingle/vextendsingle/vextendsingle2sFs/parenleftbig
h1,h2/parenrightbig
=µ−1
1/parenleftbig
a1/parenrightbig
µ−1
2/parenleftbig
b1/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsinglea1
b1/vextendsingle/vextendsingle/vextendsingle/vextendsingles
·µ2/parenleftbig
a2/parenrightbig
µ1/parenleftbig
b2/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsinglea2
b2/vextendsingle/vextendsingle/vextendsingle/vextendsinglesFs/parenleftbig
h1,h2/parenrightbig
.
This implies that Fs∈Hs(µ−1
1,µ−1
2)⊗Hs(µ2,µ1). Therefore, θ∗(E)∈πs(µ−1
1,µ−1
2)⊗
πs(µ2,µ1). /square
2.2.Θlifting. TakeΦ=Φ∞⊗Φ∞to be the standard Schwartz function on
V(A) =M2(A)(similar to [Zha23a, Section 5.2] and [Zha23a, Deﬁnition 5. 5] which
deﬁne standard Schwartz functions relative to a character a nd to an Eichler order O
respectively rather than maximal orders):
•Φ∞(x) =e−2π|x|2;
•Φ∞(x)is the characteristic function of M2(^Z);
and letω=1. We have a big theta lifting from A2, the space of automorphic forms
perpendicular to constant functions, to A1, the space of functions that rapidly decay
at cusps:
Θ:A2([PGL2]×[PGL2])−→A1([PGL2]).
Denote the dual lifting,
Θ∗:A∗
1([PGL2])−→A∗
2([PGL2]×[PGL2]).
We will now apply Theorem 2.1 to the standard Siegel Eisenste in series in the
case that µ1=µ2=1andfis the function with value 1onK:
Es(g) =ζ∗(2s)/summationdisplay
γ∈P(Q)\GL2(Q)f(γg),
which is the automorphic avatar of the classical Eisenstein series,
E(z,s) =ζ∗(2s)/summationdisplay
γ∈Γ∞\SL2(Z)/parenleftbig
Im(γz)/parenrightbigs.
Consider the Laurent series of Esats=0, withEs=/summationtext∞
n=−1EnsnandE−1= −1
2.
We establish the formulas of Theorem 4 for the dual theta lift ing evaluated on the
Eisenstein series and the coeﬃcients En, giving an analogue of the higher Eisenstein
series formula of [DHRV22, Theorem 5.4] and the Siegel–Weil formula.
Proof of Theorem 4. By the proof of Theorem 2.1, we know that Θ∗(Es)is the Eisen-
stein series for PGL2×PGL2deﬁned by
Fs/parenleftbig
h1,h2/parenrightbig
:=ζ∗(2s)/vextendsingle/vextendsingle/vextendsingledeth1h−1
2/vextendsingle/vextendsingle/vextendsingle−s/integraldisplay
A×Φ/parenleftbig
zh−1
1x0h2/parenrightbig
|z|2sdz.10 ROBIN ZHANG
It is clear that Fsis spherical, so it is equal to cf(h1)f(h2)for some constant c. To
compute c, we take h1=h2=1to obtain c=ζ∗(2s)2. Thus we have the ﬁrst
formula,
Θ∗(Es) =Es⊗Es.
The second formula then follows from the ﬁrst one. For any ϕ∈ A2([PGL2]×
[PGL2]), we have
/summationdisplay
n≥−1/angbracketleftΘ∗(En),ϕ/angbracketrightsn=/angbracketleftΘ∗(Es),ϕ/angbracketright
=/angbracketleftEs⊗Es,ϕ/angbracketright
=/angbracketleftBigg/summationdisplay
n≥−2
/summationdisplay
i+j=nEiEjsn
,ϕ/angbracketrightBigg
=/summationdisplay
n≥−1/angbracketleftBigg/summationdisplay
i+j=nEiEj,ϕ/angbracketrightBigg
sn.
In the last step, we have used the fact that ϕis perpendicular to constant functions.
/square
3.Stark units for imaginary quadratic fields
3.1.The unit of Stark. In the imaginary dihedral (i.e. imaginary quadratic) set-
ting, the Stark conjecture is known due to the original work o f Stark [Sta80]. There
is a decomposition Ad(ρf)∼=η⊕IndGQ
GK(ξ)of the (trace-free) adjoint representation
into the direct sum of a quadratic character ηand the induced representation of a
character ξofGK=Gal(K/K)for an imaginary quadratic number ﬁeld K. Complex
conjugation acts on Ad(ρf)with eigenvalues 1,−1,−1so the space of units U(Ad(ρf))
has rank 1by the Dirichlet unit theorem (cf. [HV19, Lemma 2.1], [DHRV2 2, Section
1]); here the rank,
r/parenleftbig
Ad(ρf)/parenrightbig
:=/summationdisplay
v|∞dim/parenleftBig
Ad(ρf)Frobv/parenrightBig
,
is also the order of vanishing of the Artin L-function L(Ad(ρf),s)ats=0(cf. [Sta75,
Section 1], [Tat81, Section 1], Proof of Proposition 3.4).
First, we recall an original result of Stark [Sta80] that pro ves a weaker but explicit
version of his conjecture for CM characters. Let cbe the conductor of ξ, i.e. the
maximal ideal of OKsuch that ξis trivial on (1+/hatwidec)×⊂/hatwiderOK×as a character on /hatwideK×.
LetE=K(c)be the corresponding ray class ﬁeld with Galois group G(c). Thus by
class ﬁeld theory, the Artin reciprocity map induces an isom orphism
K×\/hatwideK×/(1+/hatwidec)×∼− −→G(c).
Letcbe the minimal positive integer divisible by cand letw(c)be the number
of roots of unity in kwhich are congruent to 1(modc). Recall that for rational
numbers and imaginary quadratic ﬁelds K, Stark’s conjecture [Sta80, Conjecture 1]
is only stated for c > 1 due to the non-vanishing of ζK(0).THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 11
Theorem 3.1 (Stark [Sta80, Lemma 7]) .LetKbe an imaginary quadratic number
ﬁeld. Ifξis a non-trivial character of Gal(K/K)of non-trivial conductor, then there
is an element ǫ(c)∈K(c)×such that,
L′(ξ,0) = −1
6cw(c)/summationdisplay
σ∈G(c)ξ(σ)log|ǫ(c)σ|.
Remark 3.2.Our notation here deviates from [Sta80]: our c,c,σare respectively
f,f, andcin Stark’s paper.
Stark proves Theorem 3.1 using the second Kronecker limit fo rmula. For u,v∈R,
z∈ H,q:=e2πiz, andζ:=e2πi(uz+v), we have the Siegel function,
g(u,v,z) := −iq1
12/parenleftBig
ζ1
2−ζ−1
2/parenrightBig∞/productdisplay
m=1(1−qmζ)/parenleftBig
1−qmζ−1/parenrightBig
.
Again with Hcthe corresponding ring class ﬁeld to the conductor of ξ, ﬁx a decom-
position of OK(c)=Z+zZandc =c(Z+zZ)withz∈ H ∩K(c). Then by [Sta80,
Equations (9), (10), and (45)],
ǫ(c) =g/parenleftbigg
0,1
c,z/parenrightbigg
12c.
Stark described the Galois conjugates of ǫ(c)as follows. For any σ∈Grepresented
by idealaprime to c, letbbe an ideal such that ab = (α(σ))for some α(σ)∈K×and
writecb =c(σ)(Z+z(σ)Z). Thenα(σ)/c(σ) =u(σ)z(σ) +v(σ)for some rational
numbers u(σ)andv(σ), and,
ǫ(c)σ=g(u(σ),v(σ),z(σ))12c.
We can give a precise version of Stark’s theorem that is not st ated by Stark [Sta80]
nor Tate [Tat81, Tat84] but which we deduce directly from The orem 3.1. Deﬁne
ǫ(c) :=NK(c)/Hc(ǫ(c))and denote the modular discriminant by ∆=q/producttext
n≥1(1−
qn)24.
Proposition 3.3.Assume that ξis a ring class character of conductor c > 1.
Then,
L′(ξ,0) = −1
6c/summationdisplay
σ∈G(c)ξ(σ)log|ǫ(c)σ|,
and,
ǫ(c) =/productdisplay
d|c∆/parenleftBig
qd/parenrightBig
cµ(c
d)∈H×
c.
Proof. By Theorem 3.1, we only need to compute the norm ǫ(c)ofǫ(c). LetOc=
Z+cOK(c). Thenc =cOK(c)and we have,
Gal(K(c)/Hc)∼− −→K×/parenleftBig
/hatwideZ+c/hatwideOK/parenrightBig
×/K×(1+/hatwidec)×∼− −→/parenleftBig
/hatwideZ+c/hatwideOK/parenrightBig
×/(1+/hatwidec)×∼− −→(Z/cZ)×.12 ROBIN ZHANG
Thus every element in σ∈Gal(K(c)/Hc)is represented by an ideal a(σ) =nOK
withncoprime to c. We take b(σ) =mOKwithα(σ) =mn. WriteOK=Z+zZ.
Thenc(σ) =cm,u(σ) =0, andv(σ) =n/c. It follows that,
NK(c)/Hc/parenleftbig
ǫ(c)/parenrightbig
=/productdisplay
n∈(Z/cZ)×g/parenleftBig
0,n
c,z/parenrightBig
12c.
Letζc=e2πi/c. ThenNK(c)/Hc(ǫ(c))is a product,
qcφ(c)·N(1−ζc)12c∞/productdisplay
m=1/productdisplay
n∈(Z/cZ)×(1−qmζn
c)24c,
whereφis the Euler totient function.
The term m(c) :=N(1−ζc)is equal to 1unlesscis a prime, in which case it is equal
toc. The other terms can be computed by Möbius inversion, φ(c) =/summationtext
d|cd·µ(c/d),
/productdisplay
n∈(Z/cZ)×/parenleftbig
1−ζn
cT/parenrightbig
=/productdisplay
d|c/parenleftBig
1−Td/parenrightBig
µ(c
d).
Thus we obtain
ǫ(c) :=NK(c)/Hc/parenleftbig
ǫ(c)/parenrightbig
=m(c)12cqcφ(c)∞/productdisplay
m=1/productdisplay
n∈(Z/cZ)×/parenleftbig
1−ζn
cqm/parenrightbig24c
=m(c)12cqcφ(c)/productdisplay
d|c∞/productdisplay
m=1/parenleftBig
1−qdm/parenrightBig
24cµ(c
d)
=m(c)12c/productdisplay
d|c∆/parenleftbig
qd/parenrightbigcµ(c
d).
/square
3.2.The unit of Harris–Venkatesh. For a ring class character ξ, deﬁne
m(ξ) :=/braceleftBigg
vifIm(ξ)is av-group,
1otherwise.
Recall that for an auxiliary prime λ= l·lsplit inKand coprime to the conductor
ofξ, [Zha23a, Equation 8.2] deﬁnes an elliptic unit,
(3.1) uξ:=m(ξ)
1−ξ/parenleftbig
l/parenrightbiguξ,λ,
in terms of the elliptic unit uξ,λ∈H×
c⊗Z[ξ]given by Darmon–Harris–Rotger–
Venkatesh [DHRV22, Deﬁnition 5.1]. It is independent of the auxiliary prime λ
by [Zha23a, Proposition 8.4]. We prove Proposition 5, which relatesL′(ξ,0)to
−1
6m(ξ)log(uξ), by relating uξto the Siegel units from Section 3.1 and applying
Proposition 3.3.THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 13
Proof of Proposition 5. Letτ=Frobl∈Gal(Hc/K). For any d|c, letEddenote the
elliptic curve C/Odwhich is deﬁned over Hc. Then we have the isogenies Ed−→Eσ
d
with kernel E[l]. Withǫ(c)as in Proposition 3.3 and ηthe Dedekind eta function
related to ∆by a power of 24,
ǫ(c)−ǫ(c)τ=c/summationdisplay
d|cµ/parenleftBigc
d/parenrightBig
η(qd).
Takeξ-sums to obtain,
/summationdisplay
σ∈Gal(Hc/K)/parenleftbig
ξ(σ)−ξ(στ)/parenrightbig
ǫ(c) =c/summationdisplay
d|cξ(σ)η(qd)σ.
It follows that,
/summationdisplay
σ∈Gal(Hc/K)ξ(σ)ǫ(c) =c
1−ξ(τ)/summationdisplay
d|cµ/parenleftBigc
d/parenrightBig/summationdisplay
σ∈Gal(Hc/K)ξ(σ)η(qd)σ.
Sinceη(qd)is in the ring class ﬁeld Hdcorresponding to Od, the last sum has a
factor/summationtext
σ∈Gal(Hc/Hd)ξ(σ)which is zero if d/negationslash=csincecis the conductor of ξ. Thus
we have shown that,/summationdisplay
σ∈Gal(Hc/K)ξ(σ)ǫ(c) =c
m(ξ)uξ.
The desired identity follows from Proposition 3.3. /square
This allows us to give the explicit relation between the unit uξ∈H×
c⊗Z[ξ]and
the Stark (dual) unit uStark∈ U(Ad(ρf)).
Proposition 3.4.LetKbe an imaginary quadratic number ﬁeld, hKbe the class
number of K, andwKbe the number of roots of unity in K. There is a complex
archimedean place wofHcwith distinguished element xwofAd(ρf)such that
uStark(xw) =hK
6m(ξ)wK⊗uξ.
Proof. From the decomposition Ad(ρf) =η⊕IndGQ
GK(ξ)whereηis a quadratic char-
acter,
L/parenleftbig
Ad(ρf),s/parenrightbig
=L(η,s)·L(ξ,s).
Applying L(ξ,0) =0, Proposition 5, and the class number formula, we see that
Ad(ρf)has order of vanishing 1ats=0and
L′/parenleftbig
Ad(ρf),0/parenrightbig
=L(η,0)·L′(ξ,0) =hK
6m(ξ)wK·log(uξ),
where the logis with respect to a ﬁxed embedding Hc֒→C. Then there is a complex
archimedean place wfor which uStarkis the unique element such that
uStark(xw) =hK
6m(ξ)wK⊗uξ.
/square
Remark 3.5.A direct corollary of Proposition 3.4 is [DHRV22, Lemma 5.6] . It
also implies that 6m(ξ)wKuStark∈ U(Ad(ρf)), since it evaluates to hKuξ.14 ROBIN ZHANG
Furthermore for ﬁnite places vofHcoverλthat are inert in K,
uStark(xv) =hK
6m(ξ)wK⊗uξ.
This is because the conjugacy class of Frobwdoes not change if the archimedean
placewis replaced by an inert place v; ifλis inert in Kwith a unique prime l,
thenlis completely split in Hcandxv=xw. Darmon–Harris–Rotger–Venkatesh
[DHRV22, Section 1.3] observe that both sides of the Harris– Venkatesh conjecture
in the imaginary dihedral case vanish when λis split in K, so the results of [Zha23a]
can be rephrased in terms of uStarkinstead of uξ. With hK= [H1:K]for the
Hilbert class ﬁeld H1, we have the following reformulation of [Zha23a, Theorem 8]
for the Harris–Venkatesh period PHV(deﬁned in [Zha23a, Section 2]) applied to the
two-variable optimal form fopt(deﬁned in [Zha23a, Section 6]).
Corollary 3.6.Letfbe an imaginary dihedral modular form of weight 1and
levelN, and let foptbe the optimal form associated to f. For all primes p≥5
coprime to N,
PHV/parenleftbig
fopt/parenrightbig
= −[Hc:H1]wK
2[PSL2(Z) :Γ0(N)]·RegF×
p(uStark).
Proof. By [Zha23a, Theorem 8] (without taking logℓforℓ≥5since we have inverted
6) and the equality [Γ(1) :Γ0(N)]·PHV/parenleftbig
fopt/parenrightbig
= Sp/parenleftbig
fopt(z,pz)/parenrightbig
,
PHV/parenleftbig
fopt/parenrightbig
=1
[PSL2(Z) :Γ0(N)]Sp/parenleftbig
fopt(z,pz)/parenrightbig
= −[Hc:K]
12m(ξ)[PSL2(Z) :Γ0(N)]RegF×
p(uξ).
Then apply Proposition 3.4. /square
4.Global Rankin–Selberg periods
Letf1andf2be two homomorphic cusp forms of weight 1for a congruence sub-
groupΓofPSL2(Z)with central character ωandω−1respectively. Then we deﬁne
their Rankin–Selberg period (or Rankin–Selberg pairing),
PRS(f1⊗f2) :=1
[PSL2(Z) :Γ]/integraldisplay
X(Γ)f1(z)f2(−z)ydµ
wheredµ=dxdy
y2. This deﬁnition does not depend on the choice of Γand extends to
a pairing on the space S1(ω)andS1(ω−1)of forms of weight 1with central character
ω±1:
PRS:S1/parenleftbig
ω/parenrightbig
⊗S1/parenleftbig
ω−1/parenrightbig
−→C.
In [Zha23a, Equations 1.3 and 1.4], we gave the corresponden ce between auto-
morphic forms of weight 1and modular forms of weight 1. The transform z/mapsto→−z
corresponds to right-multiplication by ǫ∞(ǫ:=/parenleftbig−1 0
0 1/parenrightbig
at each archimedean place,THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 15
this is called ηin [Jac72, p. 11]). Thus for two automorphic forms ϕ1,ϕ2of weight
1with opposite central character, we can deﬁne their global R ankin–Selberg period,
PRS(ϕ1⊗ϕ2) :=1
[PSL2(Z) :Γ0(N)]/integraldisplay
[PGL2]ϕ1(g)ϕ2(gǫ∞)dg,
where we use the measure dg=|y|−1dxd×ydkfor the Iwasawa decomposition g=
zn(x)a(y)kwithk∈K, the standard maximal compact subgroup of SL2(A). The
analogous local theory is developed in [Zha23b, Section 2].
4.1.The imaginary dihedral case. LetK/Qbe an imaginary quadratic ﬁeld, χ
be a ﬁnite character of GK:=Gal(K/K), andρf=IndGQ
GK(χ). Letξbe the antinorm
χ1−Frob∞and letcbe the conductor of ξ. We have automorphic representations π(χ)
andπ(χ−1)of imaginary dihedral weight 1forms, where there is the automorphic
avatar of optimal forms of weight (1,1)as given in [Zha23a, Deﬁnition 6.1],
ϕopt(g1,g2)∈π(χ)⊗π(χ−1),
with an expression in terms of theta series (cf. Section 2.1) ,
ϕopt(g,gǫ∞) =/summationdisplay
α∈Oc/Dθ/parenleftBig
g,χ,Φopt
α/parenrightBig
θ/parenleftBig
gǫ,χ−1,Φopt
−α/parenrightBig
.
Recall from [Zha23a, Equation 5.9] that T=K××K×/∆Q×with norm map
N(t1,t2) =N(t1t−1
2)and,
θ(g, /BD⊗ξ,ΦO) =/integraldisplay
[T1]θ(g,t0t,ΦO)·( /BD⊗ξ)(t0t)dt,
wheret0∈T(A)has the same norm as g. By modifying the proof of [Zha23a,
Proposition 6.4] to use the split quaternion algebra B∼− −→M2(Q)with an optimal
embedding,
Oc(ξ)֒→O∼− −→M2(Z),
we have,
θ(g,ιT∗( /BD⊗ξ),ΦO) =ϕopt(g,gǫ∞),
for the embedding ιT: [T]֒→[GSO(V)]. The proof is the same except at the
archimedean place, where we have the decomposition B∞=K∞+K∞j∞withj2
∞=1
soΦOis the product of characteristic function of /hatwideOand the function,
Φ∞(x+yj) :=e−π(|x|2+|y|2).
Letι: [Q×\K×]֒→[PGL2]be the embedding obtained from the optimal embed-
dingK֒→M2(Q). In terms of the theta lifting Θdeﬁned by ΦO,
θ(g, /BD⊗ξ,ΦO) =Θ(ιT∗( /BD⊗ξ)),
[PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
=/angbracketleftι∗( /BD⊗ξ)T,Θ∗( /BD)/angbracketright.
Then by Theorem 4,
[PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
=/angbracketleftι∗( /BD⊗ξ)T, /BD⊗E0+E0⊗ /BD/angbracketright
=/angbracketleftιK∗( /BD), /BD/angbracketright·/angbracketleftιK∗(ξ),E0/angbracketright+/angbracketleftιK∗( /BD),E0/angbracketright·/angbracketleftιK∗(ξ), /BD/angbracketright.16 ROBIN ZHANG
Using the identities (cf. [DHRV22, Proof of Proposition 5.5 ]),
/angbracketleftιK∗( /BD), /BD/angbracketright=h(Oc),
/angbracketleftιK∗(ξ), /BD/angbracketright=0,
we have,
(4.1) [PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
=h(Oc)/angbracketleftιK∗(ξ),E0/angbracketright.
Now, we translate everything in the terms of continuous func tions on SL2(Z)\H
so that we can use the Kronecker limit formula for E0:
E0(x) =C−1
12log(||∆||(x)),
whereCis a constant and,
||∆||(x) =|y∆(τ)|,
wherexis represented by τ∈ H. As in Section 3, Hcis the ring class ﬁeld of ξ,H1
is the Hilbert class ﬁeld of K, andhK= [H1:K]is the class number of K.
Theorem 4.1.
[PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
= −[Hc:H1]wK
2RegR(uStark).
Proof. WriteOK=Z+Zτwithτ∈ H. Then for any positive integer d, we have
a CM point xdrepresenting a CM elliptic curve C/(Z+Zdτ)byOd. Sinceξis
non-trivial, we have by Equation 4.1,
(4.2)[PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
= −1
12h(Oc)/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log(||∆||(xσ
c)).
Consider the function,
ec(q) =/productdisplay
d|c∆/parenleftBig
qd/parenrightBig
cµ(c
d),
whereµis the Möbius function (cf. Proposition 3.3). Since echas weight 0, it is
easy to see that,
|ec(xc)|=/productdisplay
d|c/parenleftbig
||∆||(xd)/parenrightbigcµ(c
d).
Thus,
/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log/parenleftbig
|ec(xσ
c)|/parenrightbig
=/summationdisplay
d|ccµ/parenleftBigc
d/parenrightBig/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log/parenleftbig
||∆||(xσ
d)/parenrightbig
.
Ford < c, the second sum vanishes, as xdis deﬁned over Hdandξis non-trivial on
Gal(Hc/Hd). Therefore we only have the d=cterm,
/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log/parenleftbig
|ec(xσ
c)|/parenrightbig
=c/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log/parenleftbig
||∆||(xσ
c)/parenrightbig
.
Applying this to Equation 4.2 yields,
[PSL2(Z) :Γ0(N)]·PRS/parenleftbig
ϕopt/parenrightbig
= −1
12ch(Oc)/summationdisplay
σ∈Gal(Hc/K)ξ(σ)log/parenleftbig
|ec(xσ
c)|/parenrightbig
.THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 17
The proof is completed by applying Proposition 3.3 to the abo ve and observing
RegR(uStark) =L′/parenleftbig
Ad(ρf),0/parenrightbig
=L(η,0)·L′(ξ,0) = −hK
wKL′(ξ,0).
/square
5.Proof of the compatibility theorem
To prove Theorem 1, we use the Rankin–Selberg period from Sec tion 4 and the
Harris–Venkatesh periods from [Zha23a, Section 2], which r espectively extend the
Petersson and Harris–Venkatesh norms (with an extra factor of[PSL2(Z) :Γ0(N)]−1)
to pairings on the dual cuspidal automorphic representatio nsπfand/tildewideπf=πf∗of
GL2(A)(respectively generated by fandf∗under the action of Hecke operators):
PRS:πf⊗/tildewideπf−→R⊗Z/bracketleftbigg
χAd(ρf),1
6N/bracketrightbigg
,
PHV:πf⊗/tildewideπf−→F×
p⊗Z/bracketleftbigg
χAd(ρf),1
6N/bracketrightbigg
.
Following the multiplicity-one argument of [Zha23a, Theor em 6], there is a reformu-
lation of Conjecture 6.
Proposition 5.1.Conjecture 6 is equivalent to the existence of an element ϕ∈
πf⊗/tildewideπfwithPRS(ϕ)/negationslash=0and a unique element uϕ∈ U(Ad(ρf))⊗Qsuch that,
PRS(ϕ) =RegR(uϕ),
and such that for p≫0,
PHV(ϕ) =RegF×
p(uϕ).
Moreover, if Conjecture 6 is true then the above property hol ds for all ϕ∈πf⊗/tildewideπf
unramiﬁed away from N.
Proof. By [Zha23a, Proposition 3.1 and Section 4], there is a unique b ilinear form P
onπf⊗/tildewideπfoverZ[χAd(ρf),1/6N]that is furthermore unique modulo p. The Harris–
Venkatesh and Rankin–Selberg periods are therefore scalar multiples of PoverF×
p
andRrespectively. Hence the ratios of PHVandPRSevaluated at any two test
vectorsϕ1andϕ2are equal (cf. [Zha23a, Equation 4.1]),
αϕ1,ϕ2:= [PHV(ϕ1) :PHV(ϕ2)] = [P(ϕ1) :P(ϕ2)] = [PRS(ϕ1) :PRS(ϕ2)].
As in [Zha23a, Section 4], if PRS(ϕ1),PRS(ϕ2)/negationslash=0thenαϕ1,ϕ2is nonzero and
rational. In particular, if there is a prime p0such that for all primes p≥p0,
PRS(ϕ1) =RegR(uϕ1), PHV(ϕ1) =RegF×
p(uϕ1),
then for all primes p≥p0,
PRS(ϕ2) =αϕ1,ϕ2·RegR(uϕ1),PHV(ϕ2) =αϕ1,ϕ2·RegF×
p(uϕ1),
Scalinguϕ1byαϕ1,ϕ2gives the desired element uϕ2ofU(Ad(ρf))⊗Q. /square18 ROBIN ZHANG
Forfimaginary dihedral, the Stark conjecture for Ad(ρf)is known due to Stark
[Sta80] so we have a unique element uStarkofU(Ad(ρf))⊗Qsuch that L′(Ad(ρf),0) =
RegR(uStark). Recall from [Zha23a, Section 6] that for any imaginary dihe dral mod-
ular form fthere is a two-variable optimal form foptwith automorphic avatar ϕopt
inπf⊗/tildewideπfunramiﬁed outside of N. Again with wKthe number of roots of unity
of the imaginary quadratic number ﬁeld K,Hcthe ring class ﬁeld associated to
ξ:=χ1−Frob∞, and
m(ξ) :=/braceleftBigg
vifIm(ξ)is av-group,
1otherwise,
takeuϕopt= −[Hc:H1]wK
2[PSL2(Z):Γ0(N)]⊗uStark. This is a suitable element of U(Ad(ρf))⊗Q
that evaluates at x∞to−[Hc:K]
12m(ξ)[PSL2(Z):Γ0(N)]⊗uξby Proposition 3.4. We conclude
the proof of Theorem 1 by using our results to show that ϕoptanduϕoptsatisfy the
conditions of Proposition 5.1.
Lemma 5.2.Letfbe an imaginary dihedral form of weight 1. For its associated
optimal form ϕopt,
(a)PRS(ϕopt) =RegR(uϕopt);
(b)PHV(ϕopt) =RegF×
p(uϕopt)for all primes p∤6N.
Proof.
(a): By Theorem 4.1:
PRS/parenleftbig
ϕopt/parenrightbig
= −[Hc:H1]wK
2[PSL2(Z) :Γ0(N)]RegR(uStark) =RegR(uϕopt).
(b): By Corollary 3.6, for all primes p∤6N:
PHV/parenleftbig
fopt/parenrightbig
= −[Hc:H1]wK
2[PSL2(Z) :Γ0(N)]RegF×
p(uStark) =RegF×
p(uϕopt).
/square
References
[Chi83] T. Chinburg, Stark’s conjecture for L-functions with ﬁrst-order zeroes at s=0, Adv. in
Math. 48(1983), no. 1, 82–113. MR 697616
[DHRV22] Henri Darmon, Michael Harris, Victor Rotger, and A kshay Venkatesh, The derived
Hecke algebra for dihedral weight one forms , Michigan Math. J. 72(2022), 145–207.
MR 4460251
[Fog98] Karrolyne Elaine Fogel, Stark’s conjecture for octahedral extensions , ProQuest LLC,
Ann Arbor, MI, 1998, Thesis (Ph.D.)–The University of Texas at Austin. MR 2697688
[GQT14] Wee Teck Gan, Yannan Qiu, and Shuichiro Takeda, The regularized Siegel-Weil formula
(the second term identity) and the Rallis inner product form ula, Invent. Math. 198
(2014), no. 3, 739–831. MR 3279536
[GV18] Søren Galatius and Akshay Venkatesh, Derived Galois deformation rings , Adv. Math.
327(2018), 470–623. MR 3762000
[Hor23] Aleksander Horawa, Motivic action on coherent cohomology of Hilbert modular va rieties ,
Int. Math. Res. Not. IMRN (2023), no. 12, 10439–10531. MR 460 1628
[HV19] Michael Harris and Akshay Venkatesh, Derived Hecke algebra for weight one forms , Exp.
Math. 28(2019), no. 3, 342–361. MR 3985839THE HARRIS–VENKATESH CONJECTURE FOR DERIVED HECKE OPERATO RS II 19
[Ich01] Atsushi Ichino, On the regularized Siegel-Weil formula , J. Reine Angew. Math. 539
(2001), 201–234. MR 1863861
[Ike96] Tamotsu Ikeda, On the residue of the Eisenstein series and the Siegel-Weil f ormula ,
Compositio Math. 103(1996), no. 2, 183–218. MR 1411571
[Jac72] Hervé Jacquet, Automorphic forms on GL(2). Part II , Lecture Notes in Mathematics,
Vol. 278, Springer-Verlag, Berlin-New York, 1972. MR 05625 03
[JRS03] Arnaud Jehanne, Xavier-Francois Roblot, and Jonat han Sands, Numerical veriﬁcation of
the Stark-Chinburg conjecture for some icosahedral repres entations , Experiment. Math.
12(2003), no. 4, 419–432. MR 2043992
[KR88a] Stephen S. Kudla and Stephen Rallis, On the Weil-Siegel formula , J. Reine Angew.
Math. 387(1988), 1–68. MR 946349
[KR88b] ,On the Weil-Siegel formula. II. The isotropic convergent ca se, J. Reine Angew.
Math. 391(1988), 65–84. MR 961164
[KR94] ,A regularized Siegel-Weil formula: the ﬁrst term identity , Ann. of Math. (2)
140(1994), no. 1, 1–80. MR 1289491
[Lec21] Emmanuel Lecouturier, Higher Eisenstein elements, higher Eichler formulas and ra nk
of Hecke algebras , Invent. Math. 223(2021), no. 2, 485–595. MR 4209860
[Mar21] David Marcil, Numerical veriﬁcation of a conjecture of Harris and Venkate sh, J. Number
Theory 221(2021), 484–495. MR 4203578
[Mer96] Loïc Merel, L’accouplement de Weil entre le sous-groupe de Shimura et le sous-groupe
cuspidal de J0(p), J. Reine Angew. Math. 477(1996), 71–115. MR 1405312
[PV21] Kartik Prasanna and Akshay Venkatesh, Automorphic cohomology, motivic cohomology,
and the adjoint L-function , Astérisque (2021), no. 428, viii+132. MR 4372499
[Sie35] Carl L. Siegel, Über die analytische Theorie der quadratischen Formen , Ann. of Math.
36(1935), 572–606.
[Sta71] Harold M. Stark, Values of L-functions at s=1. I.L-functions for quadratic forms ,
Adv. Math. 7(1971), 301–343 (1971). MR 289429
[Sta75] ,L-functions at s=1. II. Artin L-functions with rational characters , Adv. Math.
17(1975), no. 1, 60–92. MR 382194
[Sta76] ,L-functions at s=1. III. Totally real ﬁelds and Hilbert’s twelfth problem , Adv.
Math. 22(1976), no. 1, 64–84. MR 437501
[Sta80] ,L-functions at s=1. IV. First derivatives at s=0, Adv. Math. 35(1980),
no. 3, 197–235. MR 563924
[Tat81] John Tate, On Stark’s conjectures on the behavior of L(s, χ)ats=0, J. Fac. Sci. Univ.
Tokyo Sect. IA Math. 28(1981), no. 3, 963–978 (1982). MR 656067
[Tat84] ,Les conjectures de Stark sur les fonctions Ld’Artin en s=0, Progress in
Mathematics, vol. 47, Birkhäuser Boston, Inc., Boston, MA, 1984, Lecture notes edited
by Dominique Bernardi and Norbert Schappacher. MR 782485
[Ven19] Akshay Venkatesh, Derived Hecke algebra and cohomology of arithmetic groups , Forum
Math. Pi 7(2019), e7, 119. MR 4061961
[Wei64] André Weil, Sur certains groupes d’opérateurs unitaires , Acta Math. 111(1964), 143–
211. MR 165033
[Wei65] ,Sur la formule de Siegel dans la théorie des groupes classiqu es, Acta Math. 113
(1965), 1–87. MR 223373
[Yam11] Shunsuke Yamana, On the Siegel-Weil formula: the case of singular forms , Compos.
Math. 147(2011), no. 4, 1003–1021. MR 2822859
[Yam13] ,On the Siegel-Weil formula for quaternionic unitary groups , Amer. J. Math.
135(2013), no. 5, 1383–1432. MR 3117309
[Yam14] ,L-functions and theta correspondence for classical groups , Invent. Math. 196
(2014), no. 3, 651–732. MR 3211043
[YZZ13] Xinyi Yuan, Shou-Wu Zhang, and Wei Zhang, The Gross-Zagier formula on Shimura
curves , Annals of Mathematics Studies, vol. 184, Princeton Univer sity Press, Princeton,
NJ, 2013. MR 323743720 ROBIN ZHANG
[Zha23a] Robin Zhang, The Harris–Venkatesh conjecture for derived Hecke operato rs I: imaginary
dihedral forms , 2023, arXiv:2301.00570.
[Zha23b] ,The Harris–Venkatesh conjecture for derived Hecke operato rs III: local con-
stants , 2023, arXiv:2301.00612.
Department of Mathematics, Columbia University
Department of Mathematics, Massachusetts Institute of Tec hnology
Email address :rzhang@math.columbia.edu, robinz@mit.edu