JOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 1
Key-Exchange Convolutional Auto-Encoder for Data Augmentation in
Early Knee Osteoarthritis Detection
Zhe Wang, Aladine Chetouani, Mohamed Jarraya, Yung Hsin Chen, Yuhua Ru, Fang Chen, Fabian Bauer, Liping
Zhang, Didier Hans∗, Rachid Jennane∗
Abstract —Knee Osteoarthritis (KOA) is a common muscu-
loskeletal condition that significantly affects mobility and quality
of life, particularly in elderly populations. However, training deep
learning models for early KOA classification is often hampered
by the limited availability of annotated medical datasets, owing
to the high costs and labour-intensive nature of data labelling.
Traditional data augmentation techniques, while useful, rely on
simple transformations and fail to introduce sufficient diversity
into the dataset. To address these challenges, we propose the
Key-Exchange Convolutional Auto-Encoder (KECAE) as an
innovative Artificial Intelligence (AI)-based data augmentation
strategy for early KOA classification. Our model employs a
convolutional autoencoder with a novel key-exchange mechanism
that generates synthetic images by selectively exchanging key
pathological features between X-ray images, which not only
diversifies the dataset but also ensures the clinical validity of
the augmented data. A hybrid loss function is introduced to
supervise feature learning and reconstruction, integrating multiple
components, including reconstruction, supervision, and feature
separation losses. Experimental results demonstrate that the
KECAE-generated data significantly improve the performance of
KOA classification models, with accuracy gains of up to 1.98 %
across various standard and state-of-the-art architectures. Fur-
thermore, a clinical validation study involving expert radiologists
confirms the anatomical plausibility and diagnostic realism of
the synthetic outputs. These findings highlight the potential of
KECAE as a robust tool for augmenting medical datasets in
early KOA detection. Our implementation is publicly available
at https://github.com/ZWang78/KECAE.
Index Terms —Knee osteoarthritis, Data augmentation, X-ray,
Auto-Encoder, Key-exchange mechanism
I. I NTRODUCTION
KNEE osteoarthritis (KOA) is a degenerative condition
characterized by the deterioration and damage of articular
Zhe Wang, Yung Hsin Chen and Mohamed Jarraya are with Department of
Radiology, Massachusetts General Hospital, Harvard Medical School, Boston,
02114, USA (e-mail: zwang78@mgh.harvard.edu; ychen4@mgh.harvard.edu;
mjarraya@mgh.harvard.edu).
Aladine Chetouani is with L2TI Laboratory, University Sorbonne Paris Nord,
Villetaneuse, 93430, France (e-mail: aladine.chetouani@univ-paris13.fr).
Yuhua Ru is with Jiangsu Institute of Hematology, The First Affili-
ated Hospital of Soochow University, Suzhou, 215006, China. (e-mail:
ruyuhua@163.com).
Fang Chen is with department of Medical School, Henan Univer-
sity of Chinese Medicine, Zhengzhou, 450046, China. (e-mail: chen-
fangyxy@hactcm.edu.cn).
Fabian Bauer is with Division of Radiology, German Cancer Research Center,
Heidelberg, 69120, Germany (e-mail: fabian.bauer@dkfz-heidelberg.de).
Liping Zhang is with Athinoula A. Martinos Centre for Biomedical Imaging,
Massachusetts General Hospital, Harvard Medical School, Boston, 02114,
USA. (e-mail: lzhang90@mgh.harvard.edu).
Didier Hans is with Nuclear Medicine Division, Geneva University Hospital,
Geneva, 1205, Switzerland. (e-mail: didier.hans@chuv.ch).
Rachid Jennane is with IDP Institute, UMR CNRS 7013, University of
Orleans, Orleans, 45067, France (e-mail: rachid.jennane@univ-orleans.fr).cartilage, alterations at joint edges, and reactive hyperplasia of
the subchondral bone [1]. The onset of KOA is influenced by
multiple factors, including age, weight, mechanical stress, and
trauma, among others [2]. Patients often endure severe pain
and restricted mobility, which can significantly diminish their
quality of life and elevate their risk for chronic conditions
such as cardiovascular disease [3]. Despite its prevalence,
the aetiology of KOA remains unclear, and there is currently
no definitive cure [4]. As such, early detection of KOA is
crucial to enable timely behavioural interventions, such as
weight loss, which can delay its onset and slow disease
progression [5]. To evaluate KOA severity, Kellgren and
Lawrence introduced the widely recognized Kellgren-Lawrence
(KL) grading system [6]. As outlined in Table I, this system
classifies KOA into five grades based on the presence and
severity of symptoms. Although the KL grading system is
extensively used, it remains a semi-quantitative approach that
relies heavily on the subjective perception and judgment of
individual medical professionals, which can result in significant
variability in the evaluation of the same knee X-ray image
across different practitioners [7].
TABLE I: Description of the KL grading system
Grade Severity Description
KL-0 none none of osteoarthritis
KL-1 doubtful potential osteophytic lipping
KL-2 minimal certain osteophytes and potential JSN
KL-3 moderate moderate multiple osteophytes, certain JSN,
and some sclerosis
KL-4 severe large osteophytes, certain JSN, and severe sclerosis
Deep learning, a cornerstone of artificial intelligence, has
emerged as a promising approach for KOA classification [8]
[9] [10] [11]. However, the scarcity of reliable and annotated
medical datasets poses a significant challenge for training robust
models, largely due to the high costs associated with data
labelling [12]. Currently, deep learning networks heavily rely
on data augmentation techniques to enhance generalization
performance [13]. Traditional data augmentation methods, such
as random rotation, are limited in their capacity to introduce
significant diversity, as they are derived directly from the
original data and do not alter its intrinsic structure, failing
to substantially increase the diversity of training samples. To
address these limitations, several approaches utilizing Auto-
Encoders (AEs) [14] and Generative Adversarial Networks
(GANs) [15] have been proposed for generating synthetic
data, providing an efficient and innovative solution to data
augmentation. For instance, Khozeimeh et al. [16] integratedarXiv:2302.13336v2  [eess.IV]  15 Jan 2025JOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 2
a Convolutional Neural Network (CNN) [17] with an AE to
predict survival outcomes for COVID-19 patients. Their study
demonstrated the potential of AEs in enhancing medical image
datasets in improving data quality for diagnosis and prognosis
tasks. Similarly, Pesteie et al. [18] trained Variational Auto-
Encoder (V AE) [19] generated synthetic images for ultrasound
spine images and brain MRI data augmentation, leading to
notable improvements in model accuracy compared to conven-
tional training approaches, demonstrating the effectiveness of
AE-based models in improving image classification and tumour
segmentation tasks. On the other hand, GAN-based methods
have also shown promise in addressing dataset limitations.
Tanaka et al. [20] demonstrated that generating artificial training
data using GANs effectively mitigates dataset imbalance. Their
GAN-based model, evaluated on benchmark datasets, showed
that a Decision Tree (DT) classifier [21] trained on GAN-
generated data performed comparably to one trained on the
original dataset. Similarly, Frid-Adar et al. [22] employed
Deep Convolutional GANs (DCGANs) [23] to synthesize lesion
plaques from liver CT scans across different categories, such as
cysts, metastases, and hemangiomas. These synthetic samples
significantly enhanced the performance of CNN classifiers
trained on augmented datasets. Despite these advances, GAN-
based models often fall short in generating high-quality images
that meet the stringent requirements of medical diagnosis. For
tasks demanding fine texture details, such as the early stage of
KOA, GAN-generated images may lack sufficient detail and
fidelity. Furthermore, the inherent challenges of GAN training,
including difficulty in achieving convergence and reaching Nash
equilibrium [24], hinder the reproducibility and reliability of
experimental results.
Inspired by the above studies, this paper proposes a novel
model based on a Convolutional Auto-Encoder (CAE) to
generate new and valid X-ray data for the early stages of KOA.
The innovation of this study lies in the model’s ability to
exchange and combine key and non-key features from different
inputs, namely, healthy and osteoarthritic knee X-ray images, to
generate diverse and effective synthetic data, thereby expanding
the dataset. Unlike traditional data augmentation techniques,
our approach fundamentally alters the underlying structure of
the data, leading to a more impactful and robust augmentation
outcome.
The primary contributions of this study are summarized as
follows:
•A Key-Exchange Convolutional Auto-Encoder (KECAE)
model is proposed to generate synthetic, clinically valid
data for KOA classification.
•The generated images capture and exchange key and
non-key features while preserving anatomical realism,
enhancing dataset diversity.
•The augmented data significantly improve the performance
of KOA classification models across various architectures.
•The clinical validity of the synthetic data is confirmed
through expert radiologist evaluations, ensuring practical
applicability.II. C LASSICAL AUTO-ENCODER NETWORK
Prior to describing the proposed architecture, we provide a
brief overview of the classical AE model. As shown in Fig. 2,
AE is a type of unsupervised learning model that comprises
an encoder and a decoder. It utilizes the input data Xas its
own supervision signal to enable the model to learn a mapping
relationship and thereby obtains a reconstructed output ˆX.
More precisely, the goal of the encoder is to convert the high-
dimensional input Xinto a lower-dimensional hidden variable
h, with the aim of enabling the neural network to learn the
most salient and informative features. The decoder restores the
hidden variable hof the hidden layer to the original dimension,
and the goal of the model is to make its output a faithful
approximate of the input (i.e., minimize (dist(ˆX, X ))).
The encoding process of the input data Xto the hidden
layers is as follows:
h=gθ1(X) =σ(We2σ(We1X+be1) +be2) (1)
where gθ1is the function of the encoder, σis an activate
function, We1,We2andbe1,be2represent weight and bias
matrices of the encoder, respectively.
The decoding process of the hidden variable hto the output
layer is as follows:
ˆX=gθ2(h) =σ(Wd2σ(Wd1h+bd1) +bd2) (2)
where gθ2is the function of the decoder, Wd1,Wd2andbd1,
bd2represent the weight and the bias matrices of the decoder,
respectively.
Usually, the AE model minimizes the reconstruction error
using the Mean Square Error (MSE) cost function, which is
defined as:
JMSE=1
NNX
i=1(ˆX−X)2,∀X∈ T (3)
where Nis the amount of input data used during each training
batch. Trepresents the training set.
III. P ROPOSED METHOD
A. Learning model
As shown in Fig. 1, our proposed model comprises three
main components: an encoder, a decoder, and a discriminator.
The encoder is based on two identical CNNs with non-shared
parameters, where each CNN has 20 layers divided into seven
blocks. Each block consists of a set of convolution layers of
the same kernel of size 3 ×3 with different depths (i.e., 32, 64,
128, 256, 512, 1024 and 2048) - a Batch Normalization (BN)
layer - Leaky Rectified Linear Unit (LeakyReLU) layer with
a predefined slope of 0.2. The structures of the encoder and
the decoder are almost symmetrical. The decoder consists of
seven DeConvolutional Neuron Network (DCNN) [27] blocks.
These blocks consist of a set of deconvolutional layers of the
same kernel size of 4 ×4 with different depths (i.e., 2048, 1024,
512, 256, 128, 64, 32, and 1) - a BN layer - a LeakyReLU
layer with a predefined slope of 0.2. In contrast to the classic
AE model, our approach incorporates dual inputs ( X1andJOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 3
Fig. 1: The flowchart of the proposed KECAE model. Black, blue, and red arrows denote the overall data flow, non-key features,
and key features, respectively. The symbol ⊕represents element-wise addition. The encoder simultaneously processes two input
images (a healthy knee X-ray and an osteoarthritic knee X-ray), generating two hidden vectors for each image: one representing
key features and the other non-key features. These pairs of vectors are first combined through element-wise addition to produce
two hidden vectors, which are then passed to the decoder to reconstruct the corresponding outputs. Simultaneously, the key
feature vector of each input is exchanged and added element-wise with the non-key feature vector of the other input. These
resultant vectors are then decoded to generate the key-exchanged outputs. To achieve this, we introduce a hybrid loss strategy
comprising several components: the classical AE reconstruction loss, the supervision loss from a discriminator, and a distance
loss implemented using the Fisher Linear Discriminant Analysis (LDA) algorithm [25] [26]. The details of this hybrid loss
strategy are discussed further in Section 8.
Fig. 2: The structure of the classical AE network.
X2) and generates four hidden vectors: hN
1,hK
1,hN
2, and
hK
2, where hNandhKrepresent the non-key and key feature
vectors, respectively. Specifically, the encoder processes two
input images ( X1andX2) simultaneously, producing two pairs
of hidden vectors: ( hK
1andhN
1) forX1, and ( hK
2andhN
2) for
X2. These vectors are then combined through element-wise
addition to form two hidden vectors ( h1andh2), which are
passed through the decoder to reconstruct the corresponding
outputs ( ˆX1and ˆX2). Concurrently, the key feature vector
hKfrom each input is exchanged and combined element-wise
with the non-key vector hNfrom the other input. This processgenerates two new vectors ( h′
1andh′
2), which are then decoded
to produce the key-exchanged outputs ( X′
1andX′
2). To extract
and distinguish key and non-key features, we employed the
pre-trained SOTA model [28], which has demonstrated the
best performance in detecting early KOA stages (i.e., KL-0
and KL-2), to supervise the key-exchanged outputs ( X′
1and
X′
2) by assessing whether their labels are correctly exchanged.
Ultimately, the proposed KECAE model produces four outputs:
ˆX1,X′
1,ˆX2, and X′
2. Among these, X′
1andX′
2are critical
for data augmentation, as they represent the key-exchanged
outputs that introduce diversity.
B. Hybrid loss strategy
As presented in Section II, MSE (Eq. 3) is usually used
as a reconstruction loss function. In this study, as there are
two reconstruction outputs ˆX1and ˆX2, two MSE losses
JMSE(X1,ˆX1)andJMSE(X2,ˆX2)are thus obtained. The JMSE
is defined as follows:
JMSE=JMSE(X1,ˆX1) +JMSE(X2,ˆX2) (4)
Two key-exchanged outputs X′
1andX′
2are supervised by
the pre-trained discriminator to assess whether their labels are
correctly exchanged. The Cross-Entropy (CE) losses, JCE(X′
1)JOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 4
andJCE(X′
2), are thus obtained, respectively. The supervision
loss function, JSUP, is defined here by:
JSUP=JCE(X′
1, Y2) +JCE(X′
2, Y1) (5)
where Y1andY2represent the real labels of X1andX2,
respectively.
In addition to JSUP, to further separate the key and non-key
features from each individual image, we employ the Fisher
Linear Discriminant Analysis (LDA) algorithm [25] [26] to
maximize these two feature vectors distance. It is computed
as follows:
JLDA=(σN)2+ (σK)2
|µN−µK|2(6)
µi=1
MMX
m=1xm,(σi)2=1
MMX
m=1(xm−µi)2(7)
where µi,(σi)2,Mdenote the mean, variance, and number of
elements ( x1, ...,xm) in the feature vector, respectively. i∈
{N, K}represents the non-key Nand key feature Kvectors.
Finally, the hybrid loss function can be formulated as:
Jhybrid=JMSE+λ1JSUP+λ2JLDA (8)
where λ1andλ2are hyper-parameters, which will be discussed
in Section V-A.
Overall, Jhybrid achieves the global functionality of the
proposed model by combining different loss functions. Specifi-
cally, JMSEserves as the foundational loss for the AE-based
architecture and thus is given a weight of 1. On the other
hand, JLDAis responsible for maximizing the distance between
two extracted feature vectors to separate key and non-key
features, while JSUPsupervises whether the exchanged-key-
feature images correspond to the new labels. Together, JLDA
andJSUPfacilitate the extraction of key and non-key features
from an image, with JLDAfocusing on feature separation and
JSUPensuring the quality of the separation. The impact of the
hyper-parameters λ1andλ2on the model’s performance will
be analyzed and discussed in Section V-A. For greater clarity,
Algorithm 1 describes the training process of the proposed
approach.
Algorithm 1: Algorithm of the proposed approach
Input: X1, X2, and all initial parameters
Output: ˆX1,ˆX2, X′
1, X′
2, and learned parameters
while not converged do
GethN
1, hK
1;hK
2, hN
2←encoder (X1, X2)▷Eq. 1
Geth1←hN
1⊕hK
1,h2←hN
2⊕hK
2
Get ˆX1,ˆX2←decoder (h1, h2) ▷Eq. 2
Exchange hK
1⇆hK
2
Geth′
1←hN
1⊕hK
2,h′
2←hN
2⊕hK
1
GetX′
1, X′
2←decoder (h′
1, h′
2) ▷Eq. 2
Compute Jhybrid ▷Eq. 8
Update Parameters of the encoder and decoder
endIV. E XPERIMENTAL SETTINGS
It is noteworthy that, in the early stages of KOA, KL-
2 signifies the presence of JSN, accompanied by visible
osteophytes on the joint surface and along the edges of the
knee bones. In contrast, KL-1 represents an earlier and subtler
stage of KOA, where the indicators of the condition are less
pronounced [6], making it more difficult to differentiate normal
knees from those exhibiting early osteoarthritic changes [29].
Such ambiguity often results in greater variability in inter-
pretation among medical professionals, leading to potentially
lower diagnostic confidence. Given these challenges, the early
detection and precise classification of KL-2 are of significant
clinical importance. As such, this study focuses on KL-0 healthy
knee joints and KL-2 osteoarthritic knee joints as the primary
research subjects denoted as X1andX2, respectively.
A. Employed knee database
The Osteoarthritis Initiative (OAI) [30] is a publicly available,
large-scale, multi-centre longitudinal study designed to improve
understanding of KOA. Established in 2002 with funding from
the National Institutes of Health (NIH) and private industry
partners, the OAI serves as a comprehensive resource for
researchers seeking to advance the diagnosis, prevention, and
treatment of KOA. The OAI includes a diverse cohort of
4,796 participants aged 45–79, with varying levels of risk for
KOA. Over an extended follow-up period, participants undergo
regular clinical assessments, imaging studies (e.g., X-rays and
MRIs), and collection of biological samples, along with detailed
surveys capturing lifestyle and health-related information.
B. Data preprocessing
The knee joint images were resized to 299 ×299 pixels, and
image intensity distribution was normalized to the range [-1, 1].
After this, a total of 3,185 and 2,126 knee X-rays corresponding
to KL-0 and KL-2, respectively, were retained. Due to the
inherent class imbalance in the original dataset, the generated
data also exhibited the same imbalance. To address this issue
and mitigate its impact on accuracy when evaluating the effects
of data augmentation across different models, bootstrapping-
based oversampling [31] was applied to the KL-2 dataset.
Moreover, since the labels of the two inputs ( X1andX2) must
differ, a global permutation strategy was employed. Specifically,
each KL-0 image was paired with every KL-2 image, creating
distinct input pairs, resulting in a total of 3,318,240 input pairs.
To simplify this, random samples of 50,000, 100,000, 500,000,
and 1,000,000 input pairs Nwere drawn from the total input
pairs for experimentation, which will be discussed in Section
V-C.
C. Experimental details
The model was initialized using the Kaiming procedure [32].
Adam optimizer [33] was employed for 1,000 epochs with a
batch size of 32 and a learning rate of 1e-04. We implemented
our approach using PyTorch v1.8.1 [34] on Nvidia TESLA
A100 with 80 GB graphic memory.JOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 5
V. R ESULTS AND DISCUSSION
A. Selection of the hyper-parameters in the hybrid loss
To evaluate the effectiveness of separating key and non-key
features, we initially fixed the input pair size Nat 50,000 to re-
duce computational costs during hyper-parameter optimization.
The classification performance of a Support Vector Machine
with a Radial Basis Function (SVM-RBF) [35] was utilized as
a metric to assess the quality of extracted key features before
applying data augmentation. The hyper-parameters λ1andλ2
in the proposed hybrid loss strategy were tuned through a
grid search over combinations of λ1, λ2∈[1e−5,1]. Fig. 3
illustrates the variation in classification accuracy of the key
feature vector hKas a function of different combinations of λ1
andλ2under this fixed input pair configuration. As can be seen,
λ2is more sensitive to accuracy compared to λ1. Specifically,
when λ2is set too large (i.e., between 1e-01 and 1), feature
separation becomes almost ineffective, regardless of the value
ofλ1. Conversely, when λ2lies within the range of 1e-05
to 1e-02, the accuracy varies with changes in λ1. Among
these combinations, the highest classification performance
was achieved with λ1= 1e−2andλ2= 1e−3, which were
subsequently adopted as the optimal hyper-parameters for the
following experiments.
Fig. 3: Classification performance obtained using SVM-RBF
with different values of λ1andλ2for key feature vector hK.
B. Visualization of the feature vectors
To provide a more intuitive understanding of the proposed
key feature exchange mechanism, we visualized the original
inputs and their key-exchanged counterparts, as shown in
Fig. 4. Specifically, X1(Fig. 4a), a KL-0 healthy knee X-
ray, is contrasted with its key-exchanged output X′
1(Fig.
4b), while X2(Fig. 4c), a KL-2 osteoarthritic knee X-ray,
is compared with X′
2(Fig. 4d). In X′
1, pathological features
associated with KL-2, JSN and osteophytes, are successfully
introduced, while in X′
2, these features are removed, restoring
the joint space to resemble a healthy knee. It is noteworthy
that, both X′
1andX′
2preserve the structural integrity and
background details of the original images, demonstrating the
model’s ability to selectively extract and modify key featureswithout compromising realism. These visual results validate
the effectiveness of our proposed global approach in separating
key and non-key features, ensuring that the generated outputs
are both diverse and valid. More details about the clinical
validation will be discussed in Section V-E.
(a) Original input X1(KL-0)
 (b) key-exchanged output X′
1(KL-2)
(c) Original input X2(KL-2)
 (d) Key-exchanged output X′
2(KL-0)
Fig. 4: Highlighted illustration of the original inputs and key-
exchanged outputs. The green and red colours represent the
absence and presence of symptoms for osteophytes and JSN,
respectively. The circles and arrows represent the possible
positions of the osteophytes and JSN modification, respectively.
C. Impact of the sampling size
As presented in Section IV-B , we randomly sampled input
pairs of sizes 50,000, 100,000, 500,000, and 1,000,000 from
all possible input pairs. The discriminator used in this study
is one of the State-Of-The-Art (SOTA) classifiers for KL-0
and KL-2 classification. Given its strong baseline performance,
we first validated the effects of data augmentation on this
classifier, as if the proposed method demonstrates significant
improvements on this high-performing classifier, it is likely to
yield even greater benefits for other models with lower initial
performance. To evaluate the impact of the sampling size N
on the performance of data augmentation, for each value of
N, five random samplings were performed. The discriminator
was initialized and trained from scratch to assess both training
and accuracy dynamics, and the average performance metrics
were calculated. Fig. 5a shows that, for N= 0 (i.e., using
the original dataset without data augmentation), the training
process required more epochs to converge, and the final
training loss remained relatively high. With the introduction
of augmented data ( N > 0), the convergence rate improved,JOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 6
and the final loss decreased significantly. This trend was most
noticeable when Nincreased from 0 to 50,000 and from
50,000 to 100,000. However, beyond N= 100 ,000, the
improvements in convergence speed and final loss became
negligible, indicating diminishing returns from increasing the
sample size further. On the other hand, Fig. 5b illustrates that,
without data augmentation, the accuracy was limited by the
inherent diversity of the original dataset. With N= 50,000,
the generated data provided additional diversity, leading to a
noticeable improvement in accuracy. Further increases in Nto
100,000 yielded additional gains, but these gains were marginal
compared to the improvements observed between N= 0 and
N= 50 ,000. However, at N= 1,000,000, the accuracy
slightly decreased, likely due to the introduction of redundant
or noisy data, which may have reduced the discriminator’s
ability to generalize.
Overall, larger sampling sizes (e.g., N= 1,000,000)
required significantly more computational resources and longer
training times. On the other hand, smaller sampling sizes
(e.g., N= 50,000) did not fully exploit the benefits of data
augmentation. The sampling size N= 100 ,000 offered a
balance between performance and computational efficiency,
achieving robust gains in accuracy and convergence without
the overhead associated with excessively large datasets. Based
on these observations, we selected 100,000 as the optimal
sample size for data augmentation in subsequent experiments.
(a)
 (b)
Fig. 5: Convergence (a) and performance (b) curves obtained
using various sample sizes Nfor 500 epochs.
D. Effects of the proposed data augmentation
In this study, we evaluated the impact of the proposed
approach as a data augmentation technique across various
models selected from the literature. The augmented data ( X′)
were combined with the original dataset ( X) to form a larger
training set T′, which was used to train several classification
models. For convenience, we selected one high-performing
model from each of the DenseNet, ResNet, and VGG series
that achieved the best performance of the KOA classification
in its group [9]. Additionally, SOTA models proposed by
Antony et al. [36], Tiulpin et al. [8], and Wang et al. [9],
[28] were included for comparison. As shown in Table II,
we evaluated two input cases: models trained solely on the
original training set ( T) and those trained on the augmentedtraining set ( T′). The validation and test sets were kept fixed
across all experiments to ensure a consistent evaluation of
model performance. The results demonstrate that the key-
exchanged outputs X′consistently improved the accuracy of
all evaluated models, highlighting the effectiveness of the
proposed augmentation strategy. Specifically, the VGG-11
model exhibited the largest accuracy improvement, achieving
an increase of +1.98 %(from 80.97 %to 82.95 %), which
can be attributed to its relatively lower baseline performance
and its sensitivity to the enriched diversity provided by the
augmented dataset. Similarly, DenseNet-201 and ResNet-18
showed accuracy gains of +1.21 %and +1.63 %, respectively,
further reinforcing the broad applicability of our approach.
Among the SOTA models, Wang et al. [28] achieved the
highest overall accuracy (89.54 %), improving upon its already
impressive baseline accuracy of 88.86 %. It is noteworthy that,
while models with higher baseline accuracies experienced
comparatively smaller improvements, this incremental gain is
still noteworthy, given that these models are already operating
near the upper limit of achievable accuracy. In addition
to accuracy, improvements were also observed in precision
and recall across most models. These findings highlight the
proposed approach as a robust and effective data augmentation
strategy, showcasing its ability to enhance model performance
across diverse architectures and baseline accuracies.
TABLE II: Performance obtained using different training sets
Model Training set Accuracy ( %) Precision ( %) Recall ( %)
DenseNet-201T 84.43±1.27 81.95 ±1.55 81.04 ±1.39
T′85.64±0.96 83.72 ±1.25 82.84 ±1.30
ResNet-18T 83.59±1.58 80.42 ±1.91 79.35 ±1.77
T′85.22±1.19 82.81 ±1.39 81.74 ±1.33
VGG-11T 80.97±2.07 77.86 ±2.33 75.76 ±2.01
T′82.95±1.54 80.12 ±1.79 78.08 ±1.68
Antony et al. [36]T 84.50±1.09 82.60 ±1.32 81.04 ±1.29
T′85.92±1.03 84.10 ±1.18 83.35 ±1.18
Tiulpin et al. [8]T 87.33±0.71 85.38 ±1.11 85.89 ±0.98
T′88.12±0.55 86.95 ±0.98 88.12 ±0.81
Wang et al. [9]T 88.38±0.44 87.69 ±0.88 88.85 ±0.91
T′89.11±0.35 89.14 ±0.77 90.22 ±0.71
Wang et al. [28]T 88.86±0.37 88.81 ±0.85 85.24 ±0.74
T′89.54±0.22 90.03 ±0.75 85.35 ±0.79
E. Clinical validation for key-exchanged outputs
To evaluate the clinical validity of the key-exchanged outputs
generated by the proposed model, we conducted a reader
study involving three board-certified radiologists. The primary
objective was to determine whether the generated outputs
accurately and clinically reflected the intended key feature
exchange, specifically whether the key-exchanged outputs
aligned with their assigned post-exchange labels. A total of
100 randomly selected X-ray pairs, including original images
(X) and their key-exchanged counterparts ( X′), were used
for the study. The evaluation was conducted in two phases.
In the first phase, radiologists were presented with the key-
exchanged outputs independently, without access to the originalJOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 7
images. They were tasked with classifying each image as
either KL-0 or KL-2 based on standard diagnostic criteria. In
the second phase, radiologists reviewed the original images
alongside their key-exchanged counterparts to assess whether
the changes observed in the outputs were consistent with the
expected key feature exchange. To quantify the outcomes, we
computed three metrics: (1) Accuracy, defined as the percentage
of key-exchanged outputs correctly classified by radiologists
according to their assigned post-exchange labels; (2) Subjective
Realism Score (SRS), where radiologists rated the anatomical
plausibility and clinical realism of each key-exchanged output
on a scale from 1 (poor) to 5 (excellent); and (3) Cohen’s
Kappa ( κ) to measure inter-rater reliability among radiologists.
TABLE III: Clinical validation for key-exchanged outputs⋆
Accuracy (%) SRS κ
Radiologist #1 85 (82 / 88) 4.0 (3.9 / 4.1) -
Radiologist #2 88 (86 / 90) 4.2 (4.0 / 4.4) -
Radiologist #3 86 (84 / 88) 4.2 (4.1 / 4.3) -
Average 86.33 4.13 0.78
⋆For the Accuracy and SRS, the first value represents the average score,
while the values in parentheses indicate the scores evaluated separately
for outputs corresponding to the KL-0 and KL-2 labels (i.e., ( X′
2/X′
1)).
As can be seen in Table III, the average accuracy across
radiologists was 86.33%, which indicates that the model
effectively captures key feature exchanges in both healthy
and osteoarthritic cases, with slightly higher accuracy for KL-2
outputs ( X′
1) compared to KL-0 outputs ( X′
2). This discrepancy
may be attributed to the more distinct pathological features
present in KL-2 cases, which are visually prominent and easier
to identify. The SRS averaged 4.13 out of 5, radiologists noted
that the changes in JSN and osteophyte presentation were
realistic and consistent with clinical expectations, highlighting
the anatomical plausibility and clinical realism of the generated
outputs. Moreover, the inter-rater reliability, as measured by
Cohen’s Kappa ( κ= 0.78), reflects substantial agreement
among the radiologists, further supporting the consistency and
reliability of the key-exchanged outputs, which suggests that
the modifications introduced by the model were interpretable
and clinically consistent across different evaluators. These
findings demonstrate the clinical utility of the proposed model
in generating augmented datasets that are both diagnostically
meaningful and realistic.
F . Discussion
In this study, we proposed the Key-Exchange Convolutional
Auto-Encoder (KECAE) as a novel data augmentation strategy
to tackle the challenges posed by limited annotated data
for KOA classification. By incorporating a key-exchange
mechanism into the convolutional autoencoder architecture, our
method enables the generation of synthetic data that not only
enhances dataset diversity but also maintains a high degree of
clinical validity. Furthermore, the experimental results demon-
strated the robustness and adaptability of the KECAE-generated
data across a wide range of classification models. The method
consistently improved performance metrics such as accuracy,
precision, and recall, regardless of the model architecture orits baseline accuracy, underscoring the effectiveness of the
proposed data augmentation strategy, making it a valuable tool
for advancing classification performance in KOA tasks. Several
points are to be discussed.
1) Key and non-key feature separation, how it works?:
Initially, the two feature vectors extracted from each input
image by dual convolutional encoders are random and do not
have clear meanings, resulting in a total of two pairs of feature
vectors ( h1
1, h2
1andh1
2, h2
2). However, as the model trains,
it progressively refines these vectors, separating them and
assigning them meaningful roles. Specifically, to enhance the
distinction between the two feature vectors ( h1
1, h2
1) extracted
from the input image X1, LDA is employed to maximize the
distance between the vectors while minimizing the variance
within each. This algorithm is also applied to the pair of
feature vectors ( h1
2, h2
2) from another input X2. Subsequently,
one vector from each pair (e.g., h1
1from X1andh1
2from
X2) is selected and exchanged, forming two new pairs of
vectors ( h1
2, h2
1andh1
1, h2
2). Each of these pairs undergoes
element-wise addition to obtain two feature-exchanged vectors
(h′
1, h′
2). Finally, an introduced discriminator supervises the
two feature-exchanged images ( X′
1, X′
2) decoded from these
vectors, ensuring that their new labels correspond to the
labels associated with the exchanged vectors. Specifically, the
discriminator supervises the key-exchanged images to enforce
that the labels of these new images correspond to the labels
associated with the exchanged key features, which means
that after exchanging the key features between images, the
resulting images should be classified according to the labels
of the key features. Through these two constraints, LDA and
the supervision from the discriminator, as the model trains,
the exchanged vectors are considered as key feature vectors
(hK
1, hK
2), while the others are considered non-key feature
vectors ( hN
1, hN
2). In this study, key features correspond to the
symptoms of KOA with KL-2 grade (JSN and osteophytes),
while the non-key features represent the overall background of
the knee joint and the parts with less informative content for
classification.
2) Strengths and limitations: Our study offers several
significant strengths. From a clinical perspective, the focus
on early KOA diagnosis is particularly valuable, as timely
identification can guide patients toward early physical inter-
ventions, potentially delaying the onset and progression of
osteoarthritis. From a technical perspective, our key-exchange
mechanism effectively captures and modifies key pathological
and non-pathological features while preserving anatomical
integrity. Therefore, our model generates augmented data that
align with the distribution of the original dataset. Moreover,
the adaptability of our data augmentation strategy across
multiple classification architectures underscores its versatility
and generalizability. Importantly, our augmentation approach
does not overcompromise the realism or clinical validity of
the images, as confirmed through clinical validation involving
expert radiologists. On the other hand, this study has several
limitations, primarily stemming from its reliance on data from
the OAI database. While the OAI provides a well-annotated
dataset, the generalizability of the proposed approach may be
constrained when applied to data from other sources. FutureJOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 8
research should leverage additional large-scale databases to
validate the method further and ensure its robustness across
diverse populations and imaging protocols. Another limitation
is the computationally intensive and time-consuming nature
of manually tuning the hyper-parameters in the hybrid loss
strategy. Incorporating advanced optimization techniques, such
as evolutionary algorithms, could streamline this process,
significantly enhancing efficiency and reducing computational
overhead.
VI. S TATEMENTS
The views and opinions presented in this manuscript, which
employs OAI data, do not necessarily represent those of the
OAI investigators, the NIH, or the private funding partners.
VII. A CKNOWLEDGMENTS
The authors gratefully acknowledge the support of the French
National Research Agency (ANR) through the ANR-20-CE45-
0013-01 project. We also extend our sincere gratitude to
the study participants, the dedicated clinical staff, and the
coordinating centre at UCSF for their invaluable contributions.
REFERENCES
[1]R. F. Loeser, S. R. Goldring, C. R. Scanzello, and M. B. Goldring,
“Osteoarthritis: a disease of the joint as an organ,” Arthritis and
rheumatism , vol. 64, no. 6, p. 1697, 2012.
[2]A. Litwic, M. H. Edwards, E. M. Dennison, and C. Cooper, “Epidemi-
ology and burden of osteoarthritis,” British Medical Bulletin , vol. 105,
no. 1, pp. 185–199, 01 2013.
[3]G. Singh, J. D. Miller, F. H. Lee, D. Pettitt, and M. W. Russell,
“Prevalence of cardiovascular disease risk factors among us adults with
self-reported osteoarthritis: data from the third national health and
nutrition examination survey.” Population , vol. 7, p. 17, 2002. [Online].
Available: http://europepmc.org/abstract/MED/12416788
[4]J. C. Mora, R. Przkora, and Y . Cruz-Almeida, “Knee osteoarthritis:
pathophysiology and current treatment modalities,” Journal of pain
research , vol. 11, p. 2189, 2018.
[5]A. E. Wluka, C. B. Lombard, and F. M. Cicuttini, “Tackling obesity
in knee osteoarthritis,” Nature Reviews Rheumatology , vol. 9, no. 4, pp.
225–235, 2013.
[6]J. H. Kellgren and J. S. Lawrence, “Radiological Assessment of Osteo-
Arthrosis,” Annals of the Rheumatic Diseases , vol. 16, no. 4, p. 494,
1957.
[7]L. Shamir, S. M. Ling, W. W. Scott, A. Bos, N. Orlov, T. J. Macura, D. M.
Eckley, L. Ferrucci, and I. G. Goldberg, “Knee x-ray image analysis
method for automated detection of osteoarthritis,” IEEE Transactions on
Biomedical Engineering , vol. 56, no. 2, pp. 407–415, 2008.
[8]A. Tiulpin, J. Thevenot, E. Rahtu, P. Lehenkari, and S. Saarakkala,
“Automatic knee osteoarthritis diagnosis from plain radiographs: A deep
learning-based approach,” Scientific Reports , 2018.
[9]Z. Wang, A. Chetouani, D. Hans, E. Lespessailles, and R. Jennane,
“Siamese-gap network for early detection of knee osteoarthritis,” in 2022
IEEE 19th International Symposium on Biomedical Imaging (ISBI) , 2022,
pp. 1–4.
[10] Z. Wang, A. Chetouani, and R. Jennane, “Transformer with selective
shuffled position embedding using roi-exchange strategy for early
detection of knee osteoarthritis,” arXiv preprint arXiv:2304.08364 , 2023.
[11] P. Chen, L. Gao, X. Shi, K. Allen, and L. Yang, “Fully automatic knee
osteoarthritis severity grading using deep neural networks with a novel
ordinal loss,” Computerized Medical Imaging and Graphics , vol. 75, pp.
84–92, 2019.
[12] J. R¨oglin, K. Ziegeler, J. Kube, F. K ¨onig, K.-G. Hermann, and S. Ortmann,
“Improving classification results on a small medical dataset using a gan;
an outlook for dealing with rare disease datasets,” Frontiers in Computer
Science , p. 102, 2022.
[13] C. Shorten and T. M. Khoshgoftaar, “A survey on image data augmen-
tation for deep learning,” Journal of big data , vol. 6, no. 1, pp. 1–48,
2019.[14] H. Bourlard and Y . Kamp, “Auto-association by multilayer perceptrons
and singular value decomposition,” Biological cybernetics , vol. 59, pp.
291–4, 02 1988.
[15] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D. Warde-Farley,
S. Ozair, A. Courville, and Y . Bengio, “Generative adversarial
nets,” Advances in neural information processing systems , vol. 27,
2014. [Online]. Available: https://proceedings.neurips.cc/paper files/
paper/2014/file/5ca3e9b122f61f8f06494c97b1afccf3-Paper.pdf
[16] F. Khozeimeh, D. Sharifrazi, N. H. Izadi, J. H. Joloudari, A. Shoeibi,
R. Alizadehsani, J. M. Gorriz, S. Hussain, Z. A. Sani, H. Moosaei et al. ,
“Combining a convolutional neural network with autoencoders to predict
the survival chance of covid-19 patients,” Scientific Reports , vol. 11,
no. 1, p. 15343, 2021.
[17] A. Krizhevsky, I. Sutskever, and G. E. Hinton, “Imagenet classification
with deep convolutional neural networks,” Advances in neural information
processing systems , vol. 25, pp. 1097–1105, 2012.
[18] M. Pesteie, P. Abolmaesumi, and R. N. Rohling, “Adaptive augmenta-
tion of medical data using independently conditional variational auto-
encoders,” IEEE transactions on medical imaging , vol. 38, no. 12, pp.
2807–2820, 2019.
[19] D. P. Kingma, “Auto-encoding variational bayes,” arXiv preprint
arXiv:1312.6114 , 2013.
[20] F. H. K. d. S. Tanaka and C. Aranha, “Data augmentation using gans,”
arXiv , 2019.
[21] A. J. Myles, R. N. Feudale, Y . Liu, N. A. Woody, and S. D. Brown,
“An introduction to decision tree modeling,” Journal of Chemometrics: A
Journal of the Chemometrics Society , vol. 18, no. 6, pp. 275–285, 2004.
[22] M. Frid-Adar, I. Diamant, E. Klang, M. Amitai, J. Goldberger, and
H. Greenspan, “Gan-based synthetic medical image augmentation for
increased cnn performance in liver lesion classification,” Neurocomputing ,
vol. 321, pp. 321–331, 2018.
[23] A. Radford, L. Metz, and S. Chintala, “Unsupervised representation
learning with deep convolutional generative adversarial networks,” arXiv ,
2015.
[24] F. Farnia and A. Ozdaglar, “Do gans always have nash equilibria?”
inInternational Conference on Machine Learning . PMLR, 2020,
pp. 3029–3039. [Online]. Available: https://proceedings.mlr.press/v119/
farnia20a.html
[25] S. Mika, G. Ratsch, J. Weston, B. Scholkopf, and K.-R. Mullers, “Fisher
discriminant analysis with kernels,” in Neural networks for signal
processing IX: Proceedings of the 1999 IEEE signal processing society
workshop (cat. no. 98th8468) . Ieee, 1999, pp. 41–48.
[26] R. A. Fisher, “The use of multiple measurements in taxonomic problems,”
Annals of eugenics , vol. 7, no. 2, pp. 179–188, 1936.
[27] M. D. Zeiler, D. Krishnan, G. W. Taylor, and R. Fergus, “Deconvolutional
networks,” in 2010 IEEE Computer Society Conference on computer
vision and pattern recognition . IEEE, 2010, pp. 2528–2535.
[28] Z. Wang, A. Chetouani, M. Jarraya, D. Hans, and R. Jennane,
“Transformer with selective shuffled position embedding and key-patch
exchange strategy for early detection of knee osteoarthritis,” Expert
Systems with Applications , vol. 255, p. 124614, 2024.
[29] D. Hart and T. Spector, “Kellgren & lawrence grade 1 osteophytes in
the knee—doubtful or definite?” Osteoarthritis and cartilage , vol. 11,
no. 2, pp. 149–150, 2003.
[30] G. Lester, “The Osteoarthritis Initiative: A NIH Public–Private Partner-
ship,” HSS Journal: The Musculoskeletal Journal of Hospital for Special
Surgery , vol. 8, no. 1, pp. 62–63, 2011.
[31] V . C. Nitesh, “Smote: synthetic minority over-sampling technique,” J
Artif Intell Res , vol. 16, no. 1, p. 321, 2002.
[32] K. He, X. Zhang, S. Ren, and J. Sun, “Delving deep into rectifiers:
Surpassing human-level performance on imagenet classification,” in
Proceedings of the IEEE international conference on computer vision ,
2015, pp. 1026–1034.
[33] D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,”
CoRR , vol. abs/1412.6980, 2015.
[34] A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan,
T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, A. Desmaison, A. K ¨opf,
E. Yang, Z. DeVito, M. Raison, A. Tejani, S. Chilamkurthy, B. Steiner,
L. Fang, J. Bai, and S. Chintala, “Pytorch: An imperative style, high-
performance deep learning library,” 2019.
[35] C. J. Burges, “A tutorial on support vector machines for pattern
recognition,” Data mining and knowledge discovery , vol. 2, no. 2, pp.
121–167, 1998.
[36] J. Antony, K. McGuinness, K. Moran, and N. E. O’Connor, “Automatic
detection of knee joints and quantification of knee osteoarthritis severity
using convolutional neural networks,” in Machine Learning and DataJOURNAL OF L ATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2021 9
Mining in Pattern Recognition , P. Perner, Ed. Cham: Springer
International Publishing, 2017, pp. 376–390.