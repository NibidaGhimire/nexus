Few-femtosecond phase -sensitive detection of 
infrared electric fields with a third -order 
nonlinearity   
HANNES  KEMPF1, PHILIPP  SULZER1, ANDREAS  LIEHL1, ALFRED  
LEITENSTORFER1, AND  RON TENNE1 * 
1Department of Physics and Center for Applied Photonics, University of Konstanz, D -78457 Konstanz, Germany  
*Corresponding author: ron.tenne@uni -konstanz.de  
 
Abstract  
Measuring an electric field waveform beyond radio frequencies is often accomplished via a second -order 
nonlinear interaction with a laser pulse shorter than half of the field‚Äôs oscillation period. However, synthesizing 
such a gate pulse is extremely challenging when sampling mid - (MIR) and near - (NIR) infrared transients. 
Here, we demonstrate an alternative approach: a third -order nonlinear interaction with a relatively long multi -
cycle pulse directly retrieves an electric -field transient whose central frequency is 156 THz. A theoretical 
model, exploring the different nonlinea r frequency mixing processes, accurately reproduces our results. 
Furthermore, we demonstrate a measurement of the real part of a sample‚Äôs dielectric function, information 
that is challenging to retrieve in time -resolved spectroscopy and is therefore often overlooked. Our method 
paves the way towards experimentally simple MIR -to-NIR time -resolved spectroscopy that simultaneously 
extracts the spectral amplitude and phase information, an important extension of optical pump -probe 
spectroscopy of, e.g., molecula r vibrations and fundamental excitations in condensed -matter physics.  
Introduction  
In optical spectroscopy, the frequency -resolved amplitude 
and phase of light waves encode valuable information about 
the probed sam ple. Nonetheless, in time -resolved 
spectroscopy, a prominent tool for biological, chemical and 
condensed -matter research, the phase information is not 
commonly obtained1,2. This results mainly from the practical 
difficulty in measuring phase with linear interferometric 
techniques over a broad spectral band and a large range of 
time delay s1,3,4. Phase information is even of greater 
significance to resolve the electric field of an optical pulse in 
the time domain. While for radio -frequency signals an 
oscilloscope readily performs this task, the equivalent ‚Äòoptical 
oscilloscope‚Äô still lacks a general solution and is therefore the 
goal of current research5,6. Extending phase -sensitive 
measurements to the mid infrared (MIR) often presents an 
additional obstacle, the lack of high -sensitivity and low -noise 
detector s7,8.  
In the few -terahertz (THz) regime, nonlinear techniques offer an alternative approach that circumvents bot h of these 
issues9,10. For example, in electro -optic sampling (EOS ), 
nonlinear  interaction with a probe pulse, shorter than the half -
cycle period of the signal, temporally samples the electric 
field11,12. Moreover, the phase information is transferred from 
the inconvenient -to-detect THz and multi -THz ranges to the 
NIR or visible spectral bands  where low -noise sensors and 
arrays are readily availabl e13,14.   
Recently, these considerations motivated a growing interest 
in the expansion of nonl inear phase -detection methods to the 
MIR and NIR5,10,15 ‚Äì19. This progress supports the  ongoing 
scientific effort in controlling solid -state systems on a few -
femtosecond time scale with precisely characterized 
ultrashort laser pulses20‚Äì24. Moreover, the addition of the 
spectral phase information promises to expand the capabilities 
of existent MIR and NIR spectroscopy and imaging 
techniques25. However, extending EOS  to field transients in 
the MIR and NIR requires the stable generation of probe 
pulses with a few -femtosecond duration, an extremely 
challenging experimental task. An alternative successful strategy that circumvents th is requirement  is to exploit a 
highly nonlinear interaction between  a strong probe pulse and 
the signal field5,17,18,26, 27. The high degree of nonlinearity 
results in a large amplification of the output at the temporal 
peak of the probe field, effectively creating a gating window 
shorter than half of the signal‚Äôs period17. Nevertheless, this 
strategy requires the generat ion of ultrashort few -cycle probe 
pulses. The necessity of very stable pulses in conjunction with 
a high peak field poses an additional experimental hurdle. 
More r ecently, a single -shot waveform measurement 
harnessing third -order nonlinearity has been demo nstrated28. 
This implementation relied on ¬µJ-scale pulse energies , 
typically limiting its application to laser amplifier s with kHz  
pulse  repetition rates . Altogether, a  simplified  and general  
scheme to directly measure the spectral amplitude and phase 
of electric -field transients in the MIR and NIR is a n ongoing 
challenge of high significance.    
In this work, we introduce a new method that strives to meet 
this challenge ‚Äì multi -cycle third -order sampling (MCTOS). 
Surprisingly, a phase -sensitive measurement is achieved 
using third -order nonlinear interacti ons alone , thus, without 
generating a sub -cycle gating duration or a carrier -envelope -
phase (CEP) -stable signal pulse.  The low -order nonlinear 
signal is realized with sub-nanojoule pulses and can be 
accurately described with a straightforward perturbative 
model. Therefore, MCTOS represents a convenient scheme 
for both pulse characterization and time -resolved phase 
sensing in the attractive MIR and NIR spectral windows.  
Results and discussion  
Experimental implementation.  In the following, we 
provide a concis e description of the experimental setup; 
further details can be found in the Methods section. Fig. 1 
depicts the schematic setup of MCTOS. The pulsed output of 
a mode -locked Er:fiber laser oscillator with a 40 MHz 
repetition rate and center frequency of 19 3 THz (wavelength 
of 1550 nm) is separated into two branches to generate the 
signal and probe pulses. A fiber -coupled electro -optic 
modulator (EOM) reduces the repetition rate in the signal 
branch to 20 MHz. Thanks to the strong mode confinement 
within a h ighly nonlinear fiber (HNF), the telecom pulse 
undergoes efficient third -order nonlinear interaction 
generating spectral components within the range from 130 to 
350 THz29. This mechanism is applied to synthesize both the 
signal and the probe pulse  in two distinct HNFs . The signal 
branch features  a center frequency of 156 THz  (wavelength 
of 1.92 ¬µm) , 1 nJ pulse energy  and a duration of roughly 40 
fs. The spectrum  of the probe  covers a full -width at half -
maximum bandwidth of Œîùêµùëä= 61 THz with a center 
frequency of ùëìùëê=246 THz (correspond ing to a wavelength 
of 1.22 ¬µm)  supporting a pulse duration of 12 fs  with a pulse 
energy of 0.2 nJ  (probe spectra an d pulse characterization are 
given in Supplementary Note 1 ).   
Fig. 1  Scheme of the experimental setup.  The signal and probe 
pulses are generated in two distinct highly nonlinear fibers (HNF S 
and HNF P). The third -order nonlinear interaction occurs in the 
detection crystal (DX; Si or GaSe) and the induced polarization 
change is analyzed by an ellipsometer. EOM: electro -optic 
modulator.  EDFA: erbium -doped fiber amplifier.  VD: variable 
optical delay stage. BC: beam combiner (500 ¬µm thick Si wafer). 
OAP: off -axis parabolic mirror. AL: achromatic lens. BPF: bandpass 
filter. QWP/HWP: quarter - or half -wave plate. WP: Wollaston 
prism. BPD: balanced photodiodes.  
A silicon wafer superimposes both beams on an off -axis 
parabolic mirror (OAP) focusing them into a galliu m selenide 
(GaSe) or silicon (Si) nonlinear detection crystal (DX). The 
time delay , ùë°ùê∑, between the pulses is controlled by a variable 
delay stage (VD). Both pulses are linearly polarized and 
orthogonal to each other before entering the DX. The 
polarizat ion change of the probe is then measured with an 
ellipsometer whose output is read by a lock -in amplifier (at 
20 MHz ). 
In EOS, the interaction between a signal waveform and a 
broadband probe pulse within a nonlinear crystal is measured 
versus the  variable  time delay between them. B ased on 
second -order nonlinearity, the bandwidth of the EOS probe is 
required to be as large as the carrier frequency of the signal 
pulse, 156  THz, supporting a pulse duration of order 3 fs30. 
In addition, EOS requires absolute CEP stability of the signal 
pulse  - a constant phase relation between the envelope of the 
pulse and the underlying  oscillations  of the field . None of 
these conditions are fulfilled in our experiment. Neverthe less, 
when scanning the time delay between the two pulses, few -fs 
oscillations emerge (see Fig. 2a). The amplitude of the Fourier 
transform (FT) of the differential current , shown in the inset , 
reveals a spectral peak centered at 156 THz, i.e., the carrier  
frequency of our signal (for the spectral phase, see 
Supplementary Note 2 ).  
This observation is surprising for several reasons. Not only 
are the abovementioned conditions for spectral bandwidth 
violated, but the signal pulses are not phase stabilized and  
these oscillations are observed even with a silicon DX whose 
symmetry precludes a second -order nonlinear interaction. In 
addition to the rapidly oscillating component, a low -
frequency constituent appears in the amplitude of the FT. The 
physical origin of these results is the focus of the following 
sections.  
  
Fig. 2. Time and frequency domain analysis of the MCTOS 
output. a  Differential photocurrent as a function of the relative time 
delay, measured with a 16 ¬µm thick silicon detection crystal in the 
QWP configuration (see Fig. 1).  Inset: Fourier spectrum of the 
detected signal (blue) plotted semi -logarithmically versus frequency 
and compared to the spectral amplitude of the signal pulse, as 
recorded with an optical spectrum analyzer (OSA, black). b Field 
component extracted from the detected signal in a by numerically 
filtering the Fourier transform (FT) (see inset) around 156 THz and 
applying the inverse FT.  
Intuitive phasor interpretation.  Similar to EOS, the 
balanced detection scheme employed in MCTOS  senses 
slight variations in the polarization of the probe pulse. These 
can be described by the generation of new photons through a 
nonlinear interaction between signal and probe. However, 
unlike EOS, our results can be explained only by invoking a 
third-order nonlinearity.  
We divide th e four-wave mixing interaction into three 
distinguishable processes  that contribute to the MCTOS 
output. These are depicted in Fig. 3b  in a standard arrow 
scheme; the leftmost arrow is the probe input whereas  the 
fourth arrow  from the left stands for the nonlinearly generated 
probe output . In the first  process , referred to as upconversion 
(UC), a low -frequency probe photon (green arrow) is 
annihilated and a higher -frequency photon (blue arrow) 
emerges. Conversely, downconversi on (DC) generates an 
output at a lower frequency. The effective gain and loss of 
energy  in UC  and DC, respectively,  are represented by black 
arrows . A third interaction route detected in MCTOS, direct 
downconversion (DDC), involves two signal photons and 
was already observed, for example, by Sell et al.31. In this case, 
one signal photon is annihilated and another one is created.   
Fig. 3 Third -order nonlinear processes contributing to MCTOS.  
a Normalized spectral intensities of the probe (turquoise color 
gradient) and signal (red) pulse s. The solid and dashed magenta lines 
represent the spectral response function of the probe pulse for 
MCTOS and EOS, respectively. b Third -order nonlinear 
interactions. The length and color of the arrows illustrate the energy 
of the participating photons. T he black arrows represent the effective 
frequency change of the initial probe photon. UC/DC: up -
/downconversion. DDC: direct downconversion.  
Within a simplified quasi -monochromatic mathematical 
description, we consider three different angular frequencies for 
the probe, ùúî,ùúî1, and ùúî+(Œ©‚àíùúî1) along with a single 
frequency for the signal, Œ©. In this case, the complex amplitude 
of UC and DDC can b e written as  
 
ùê∏ùëàùê∂(ùúî,ùë°ùê∑)‚àùùëñùúí(3)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)]  
√óùê¥ùëÜ(Œ©)exp[ùëñ(Œ©ùë°ùê∑+ùúôùëÜ‚àí2ùúôùëÉ)], (1) 
and  
ùê∏ùê∑ùê∑ùê∂(ùúî,ùë°ùê∑)‚àùùëñùúí(3)ùê¥ùëÉ(ùúî)exp[‚àíùëñùúôùëÉ]ùê¥ùë†(Œ©)2, (2) 
respectively. Here, ùê¥ùëÉ and ùê¥ùëÜrepresent  the real spectral 
amplitudes of probe and signal, respectively . ùë°ùê∑ is the 
adjustable relative time delay between the pulses and ùúí(3) is 
the third -order nonlinear susceptibility. ùúôùëÜ and ùúôùëÉ are the 
phases of the signal and probe field, respectively. A full 
treatment of th e broadband  case, including all three process es, 
is given in Supplementary Notes  3-5. 
Two significant differences between UC and DDC  emerge 
from these expressions. First, ùê∏ùëàùê∂(and ùê∏ùê∑ùê∂) oscillates with 
respect to ùë°ùê∑ at the signal frequency  whereas the DDC 
contribution is a constant.  This distinction is clear in Fig. 2a 
where an oscillating term (UC and DC) is offset by a slowly 
varying transient (DDC).  Since the DDC out put is clearly 
distinguishable from the phase -sensitive contribution in the 
Fourier domain, it can be readily filtered out  (see Methods 
section) . An inverse FT of the filtered output reveals the field 
transient of the signal pulse  (Fig. 2b ). Second, and mo re 
important for MCTOS , only the UC and DC processes 
depend on the spectral phases ùúôùëÜ and ùúôùëÉ. As shown below, 
it is thanks to t hese interaction  paths  that MCTOS can directly 
measure the spectral  phase of the signal  pulse . 
Sensing the fields  of these fo ur-wave mixing interactions  is 
accomplished through a homodyne detection scheme.  
Measuring the interference term between the probe and the 
newly generated photons , the homodyne output can be 
conveniently described with a phasor expression - the product 
of the complex amplitudes of the nonlinear output  [Eqs. (1)-
(2)] and the probe30: 
ùëÉùëàùê∂(ùë°ùê∑)‚àùùëñùúí(3)ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)]  
√óùê¥ùëÜ(Œ©)exp[ùëñ(Œ©ùë°ùê∑+ùúôùëÜ‚àíùúôùëÉ)],  (3) 
ùëÉùê∑ùê∂(ùë°ùê∑)‚àùùëñùúí(3)ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)]  
√óùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œ©ùë°ùê∑+ùúôùëÜ‚àíùúôùëÉ)], (4) 
ùëÉùê∑ùê∑ùê∂(ùë°ùê∑)‚àùùëñùúí(3)ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî)ùê¥ùëÜ(Œ©)ùê¥ùëÜ(Œ©)  
=ùëñùúí(3)|ùê¥ùëÉùê¥ùëÜ|2. (5) 
Since the polarization of the generated  photons is orthogonal 
to that of the probe, the interference  term can be divided into 
two distinct terms . A field that is  in phase with the probe wave 
results in a rotation of the  linear polarization of the probe and 
corresponds to the real part of the phasor. In contrast, a 
nonlinear field output with a œÄ/2  phase offset leads to an 
elliptically polarized interference signal and corresponds to 
the imaginary  portion of the phasor.  A balanced ellipsometer 
equipped with a quarter -wave plate (QWP) detects the 
imaginary part  (œÄ/2-phase -shifted  component)  of the phasor 
whereas one wit h a half -wave plate (HWP) obtains the real 
part (in-phase component)30. 
Fig. 4 depicts the complex phasors (left) and the 
corresponding detected waveforms (right) for the three 
interaction routes described above  [Eqs. (3)-(5)]. Since the 
DDC phasor is  not oscillating and  purely imaginary (vertical 
purple bar in Fig. 4a ), its output is constant and only 
measurable with a QWP (Fig. 4b). With an increasing time 
delay ùë°ùê∑, the UC phasor (Fig. 4 c, green arrow ) rotates 
anticlockwise  in the complex plane with an angular frequency 
Œ© [Eq. ( 3)] while the DC phasor (Fig. 4 c, orange arrow ) 
rotates with the same frequency in the opposite direction . The 
sum of both phasors (orange -green dashed arrow) constantly 
points along the imaginary axis,  with a periodically varying 
amplitude. As a result, the total signal from DC and UC is also 
detectable only in a QWP ellipsometer configuration.  
Altogether, it is t his periodic evolution of the phasor 
projection that manifests as the phase sensitive MCTOS  
signal  ‚Äì an oscillation with the carrier frequency of the signal 
(Fig. 2).   
Comparison with an analytical model.  While the quasi -
monochromatic intuitive phasor picture already explains the 
main features of MCTOS, a rigorous mathematical treatment 
is required for the case of broadband fields ( Supplementary 
Notes 3-5). In the following, we quantitatively compare the 
broadband modeling to our results.   
Fig. 4 Phasor representation of the nonlinear interaction 
processes.  Upper panel s: Upconve rsion (UC) and direct 
downconversion (DDC) process es shown separately. a Green arrow 
illustrates the phasor of the UC process for a time delay ùë°ùê∑. The blue 
and red line s indicate the imaginary and real part of the phasor and 
hence the detected output wit h a quarter - and half -wave plate (QWP 
and HWP), respectively. The purple bar represents the phasor of the 
DDC process. b Corresponding UC and DDC outputs depicted 
versus relative time delay with the same color code as in a. Lower 
panel s: The s um of UC and downconversion (DC). c Phasors of UC 
(green arrow) and DC (orange arrow) and their  sum (green -orange 
dashed arrow). d Output of the sum of UC and DC when  detect ed 
with a QWP and HWP in blue and red, respectively.  Œîùõ∑=ùõ∑ùëÜ‚àí
ùõ∑ùëÉ: relative phase difference be tween signal and probe.  
The summed differential current resulting from the UC and 
DC processes and detected by QWP or HWP configuration 
can be written as  
ŒîùêºùëÑùëäùëÉ (ùë°ùê∑)‚àù‚à´Re{[ùëÖùëàùê∂(Œ©)+ùëÖùê∑ùê∂(Œ©)]‚àû
0  
√óùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œîùúô0+ùúôùëÜ‚Ñéùëú )]√óexp(‚àíùëñŒ©ùë°ùê∑)}dŒ©,  (6) 
ŒîùêºùêªùëäùëÉ(ùë°ùê∑)‚àù‚à´Im{[ùëÖùëàùê∂(Œ©)‚àíùëÖùê∑ùê∂(Œ©)]‚àû
0  
√óùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œîùúô0+ùúôùëÜ‚Ñéùëú)]√óexp(‚àíùëñŒ©ùë°ùê∑)}dŒ©. (7) 
Since both the signal and the probe are derived from the same 
master oscillator, Œîùúô0, the CEP difference between them, 
can be treated as  a constant.  The higher -order spectral phase 
of the signal field , given by ùúôùëÜ‚Ñéùëú=ùúôùëÜ(2)‚ãÖ(Œ©‚àíŒ©0)2+
ùúôùëÜ(3)‚ãÖ(Œ©‚àíŒ©0)3+ ‚Ä¶,  where Œ©0 is the central frequency 
of the signal. This phase contain s the non -trivial information 
about the temporal form of the electric field. ùëÖùëàùê∂ and ùëÖùê∑ùê∂ 
are the spectral response functions  for UC and DC, 
respectively, which depend both on the spectrum of  the probe 
and the phase -matching of the third -order nonlinear 
interaction. These expressions confirm the intuitive picture 
presented in the previous section: The FT of the MCTOS 
output provides a direct measurement of the spectral 
amplitude and phase of t he signal pulse  within the bandwidth 
offered by the response functions, see Supplementary Note 6 .  
The spectral response functions ( ùëÖùëàùê∂ and ùëÖùê∑ùê∂) are generally 
not identical and as a consequence, a phase -sensitive output is 
expected also for the HWP c onfiguration. In particular, a 
similar output for the QWP and HWP is obtained when 
suppressing either the UC or DC contribution.  
To experimentally explore this observation, we detect the 
output with a 25 ¬µm thick GaSe DX and spectrally filter the 
probe to modify the UC and DC response functions. 
Essentially, upconverted photons gain energy and therefore 
tend to appear in the higher -frequency part of the probe 
spectrum. Inserting 50 nm wide bandpass filters with different 
center frequencies after the detecti on crystal (see Fig. 1) 
spectrally resolves the detection process.  
Sections a, c, and e of Fig. 5 depict the output of MCTOS for 
three different bandpass filters centered at 286, 214 and 250 
THz, respectively. The left -hand side shows the detected 
transien ts for the QWP (blue) and HWP (red) configurations, 
while the corresponding amplitudes of their Fourier 
transforms are presented on the right -hand side.  
Applying a BPF centered at the high -frequency edge of the 
probe (see inset of Fig. 5b), favors upconverted photons (cf. 
Fig. 3 b). Consequently, both ellipsometer configurations 
(QWP and HWP) measure an oscillating output (Fig. 5a) with 
nearly identical spectral components (Fig. 5b). This behavior 
is also predicted by the monochromatic picture (Figs.  4a and 
b). The numerically calculated spectrum for the UC 
interaction (green  dashed  line) demonstrates a high level of 
agreement with the experimental results. Thus, we are able to 
suppress the effect of the DC process by spectral filtering. 
Qualitatively similar results are obtained for a postselection of 
downconverted photons, achieved by f iltering around 214 
THz (Figs. 5c, d).  
In contrast, isolating the central part of the probe spectrum 
(around 250 THz) effectively reduces the bandwidth for the 
detection of the phase -sensitive output. As a result, the 
oscillating transients detected in MC TOS significantly reduce 
(Fig. 5e)  and their spectra are blue shifted (Fig. 5f). The finite 
DDC contribution to the output of the HWP configuration 
(Fig. 5e) is likely due to the dispersion of the detection crystal 
as further discussed in Supplementary Not e 5. 
We note that using a Si DX provides similar experimental 
observations, but their analysis and numerical modeling is 
less straightforward. The spectral overlap of the Si  bandgap 
with the probe pulse results in a more complex dispersion and 
absorption s pectrum that must be taken into account.  
  
Fig. 5 Wavelength -resolved analysis of the MCTOS output.  a, c, 
e Differential current versus time delay measured using quarter - 
(blue) and half -wave plate (red).  The insets show a zoomed -in 
version of the dat a. b, d, f  Corresponding spectral amplitudes with 
the same color coding as on the left -hand side. The numerical 
simulations for up - and downconversion are displayed in green and 
orange  dashed lines , respectively. All spectra are normalized to the 
maximum o f the measurement  in the QWP configuration in b.  The 
insets visualize the normalized probe spectrum (dotted line) with the 
transmitted spectral range of the bandpass filters (color shaded 
areas). Measurements were performed with a 25 ¬µm thick GaSe DX.  
To discuss  the spectral response of MCTOS, we first consider  
that the homodyne scheme is highly sensitive only within the 
frequency range of the probe. Thus, detection occurs only if 
the upconverted or downconverted  photon spectrally overlaps 
with the probe.  
Consequently, the sensitivity range of MCTOS is [ùëìùëê‚àí
32‚ÅÑŒîùêµùëä,ùëìùëê+32‚ÅÑŒîùêµùëä] (full magenta line, Fig. 3a), where 
ùëìùëê and Œîùêµùëä are the center frequency and bandwidth of the 
probe, respectively. In the current setup, this range extends 
from 155 to 339 THz. The frequency range of MCTOS is thus 
complementary to EOS whose response vanishes at higher 
frequencies (dashed magenta line, Fig. 3a).  
The bandwidth is noticeable when comparing the spectrum of 
our first dataset to that obtained with a commercial optical  
spectrum analyzer (OSA) (black line, inset of Fig. 2a). At 
frequencies below the sensitivity range of MCTOS, the signal 
sharply drops with respect to the reference measurement. As 
the MCTOS transient is simply a Fourier transform of the 
complex -valued spectrum, such spectral narrowing manifests 
as temporal stretching  of the oscillating component  (Fig. 2b) 
with respect to the original signal pulse.  
A second indication for the role of the response function, 
ùëÖ(Œ©), is observed of in Fig. 5. Applying a spectral  filter at 
either edge of the probe spectrum broadens the response  
function  of MCTOS  in the frequency domain , as thoroughly 
discussed in Supplementary Note  6. Filtering in detection can 
also simplify MCTOS in the case of spectral overlap between 
the signal and the probe. A filter excluding the signal pulse 
spectrum suppresses the linear interference term between the 
signal and probe pulses, which may otherwise ob scure the 
MCTOS output. As such , an optimal choice for detection  
filter reject s the signal spectrum  while transmitting only a 
fraction of the probe in either its high - or low -energy edge.   
Another factor that impact s the MCTOS response function is 
the spec tral phase of the probe pulse. Naturally, an optimal 
bandwidth is obtained for a transform -limited probe pulse 
while significant chirping results in spectral narrowing, as 
described in detail in Supplementary Note 6 . In the current 
experiment , we synthesiz e a transform -limited probe pulse, as 
indicated by the results of a frequency -resolved -optical -gating 
(FROG) measurement (see Supplementary Note 1 ). Finally, 
we note that b eyond the bandwidth covered by the current 
experimental implementation, a significan t advantage of 
MCTOS, in comparison with EOS, is its tunability. The 
central frequency of the probe branch can be readily tailored 
to cover a specific spectral region through nonlinear 
interactions in fiber29 or free -space32 optics.  
Application ‚Äì group index dispersions.  Having confirmed 
our conceptual and theoretical considerations in the  previous 
sections, we now exploit our quantitative understanding of 
MCTOS to present its first application: characterizing the 
phase response of two important optical materials in the MIR. 
Specifically, we measure the dispersion of the group index of 
refraction by recording the transients of the signal pulse with 
and without a specimen.  
The group index ùëõùëî(Œ©) is readily extracted from the 
difference of the spectral phases between the two 
measurements Œîùúô(Œ©) (see Supplementary Note  1) 
according to  
ùëõùëî(Œ©)=1+ùëê
ùëëùúïŒîùúô(Œ©)
ùúïŒ©, (8) 
where c is the speed of light and ùëë the thickness of the 
specimen.  
The extracted dispersion of the group index for germanium 
(Ge) and gallium antimonide (GaSb) are depicted in black  
circles  in Figs. 6a and b, respectively. The results for Ge show 
an excellent agreement with published experimental data33‚Äì35 
in the entire spectral range covered while providing a much 
higher spectral resolution. This confirms the phase -sensitivity 
of MCTOS as well as its high reliability for spectral phase 
measurem ent.  
For GaSb (Fig. 6b), experimental data is scarce36 and only two 
publications37,38 are available modeling absorption in the 
spectral region we analyze. While a reasonable agreement is 
obtained with the sparse experimental data, our 
measurements strongly deviate from the results of both 
numerical modeling works.   
Fig. 6 Applying MCTOS to obtain the group index of refraction.  
Group -index measurements of a germanium (Ge) and b gallium 
antimonide (GaSb). Our results (black  circles ) are compared with 
several references (colored, see legend). Data points are depicted  as 
markers  while the lines are a guide to the eye. Since Refs.  37 and 38 
are parameterizations, only a solid line is depicted.  
The use of Ge in high -speed electronic components39 and the 
potential application of GaSb for next -generation high -
electron -mobility transistors (HEMTs)40 demonstrate the 
importance of these f undamental semiconductors. Therefore, 
the sparsity of MIR refractive index measurements, close to 
the bandgap, is another indication for the lack of a simplified 
experimental approach for phase -sensitive detection in this 
spectral region.  
Conclusion  
In summary, we present here MCTOS - a new technique for 
measuring the spectral phase and amplitude of infrared 
electric -field transients. The pump -probe scheme relying on 
third-order nonlinear interaction circumvents the requirement 
for an ultrashort gating pul se altogether. A thorough 
experimental and theoretical analysis reveals that the detected 
polarization change of the probe pulses can be understood in 
the frequency domain as up - and downconversion of near -
infrared probe photons similar to the case of EOS.  As a proof -
of-principle demonstration, we measured the dispersion of the 
group index of Ge and GaSb.  
Unlike conventional EOS suited for low THz frequencies, the 
sensitivity spectrum of MCTOS is dictated by the center 
frequency of the probe and can theref ore be tailored to fit the 
spectral content of the signal. Altogether, MCTOS is an 
excellent candidate to simplify temporally and spatially 
resolved measurements of the full dielectric function (real and 
imaginary ) in a broad spectral range. As such it may  also 
become valuable for spectroscopic studies of electronic and 
vibrational transient states, for example, in chemistry and 
solid-state physics.  
 
 
 
Methods  
Laser source and optical setup   
In this work, we employ a custom -built laser system. The laser 
oscillator is entirely fiber -based and relies on polarization 
maintaining optical components. Erbium -doped fibers act as an 
active gain medium and a pigtail saturable absorber mirror (BATOP; 
SAM -1550-33-2ps) enables stable and self -starting mode locking. A 
pulse-picking EOM (Jenoptik; AM1550) based on LiNbO 3 reduces 
the repetition rate of the signal branch prior to pulse amplification. 
The output of the oscillator is split and input to two self -constructed 
erbium -doped fiber amplifiers (EDFA) that are based sole ly on fiber 
components, as well.  
Each amplified pulse is coupled into a highly nonlinear fiber, 
optimized to generate a broadband dispersive wave and a low -
frequency soliton for the probe and signal pulse, respectively41. For 
each branch, fine tuning of the output spectra is achieved with a 
silicon -prism compressor before the pulse enters the HNF. The 
signal -branch pulse is spectrally filtered with a 150  ¬µm thick 
gallium antimonide wafer set at Brewster‚Äôs angle. The filte r‚Äôs 
second -order dispersion is compensated for with fused silica 
windows. The probe branch pulse is temporally compressed with a 
pair of SF10 glass prisms. Inserting a razor blade in the Fourier plane 
of the prism pair acts as a spectral filter.  
The two b ranches are overlapped in a nonlinear crystal ( 25 Œºm thick 
GaSe or 16 Œºm thick Si) where third -order nonlinear interactions 
take place. The GaSe detection crystal is physically exfoliated from 
a bulk sample, whereas the Si crystal is polished out of a thic ker 
wafer. The output of the nonlinear interaction in the crystal is 
measured by an ellipsometer setup based on a commercially 
available balanced photodiodes module (PDB440C, Thorlabs)  with 
two InGaAs detectors . The balanced signal is read out by a radio-
frequency  lock-in amplifier (UHF, Zurich Instruments) with a 
20 MHz  reference frequency input.  
To filter out the DDC contribution (see Fig. 2), first, a FT of the 
detected output calculates the spectral amplitude and phase (Fig. 2a ). 
Thanks to their large frequency difference, t he DDC contribution (0 
to 40 THz) can be separated from the field-sensitive components - 
UC and DC  (140-170 THz). To do so, we multiply the spectral 
amplitude with a super -Gaussian function, exp [‚àí(ùëì‚àíùëì0
ùõ•ùëì)6
], with f0 
= 155 THz and Œî f = 80 THz. An inverse FT of the filtered high-
frequency component (Fig. 2b) extract s the electr ic-field transient of 
the signal .  
Acknowledgements  
The work was f unded by the Deutsche Forschungsgemeinschaft (DFG) 
‚Äì Project -ID 425217212 ‚Äì SFB 1432. R. T enne acknowledges the 
support of the Minerva foundation.  
The authors thank all reviewers for their diligent work and in particular 
anonymous reviewer number 3 for their helpful suggestions.  
Author contributions  
H. Kempf  and A. Leitenstorfer  posed the original scientific question. 
H. Kempf  designed the experimental setup with support from P. 
Sulzer  and A. L iehl. H. Kempf  performed the optical experiments 
and the simulations. R. Tenne  and H. Kempf  analyzed the data , 
refined the physical understanding  and prepared  the manuscript 
with significant contributions from all authors.  Competing interests  
The authors declare no competing interests.  
Data availability  
Data underlying the results and its analysis script may be obtained from 
the authors upon reasonable request.  
References  
1. Tamming, R. R. et al.  Ultrafast Spectrally Resolved 
Photoinduced Complex Refractive Index Changes in 
CsPbBr 3 Perovskites. ACS Photonics  6, 345 ‚Äì350 (2019).  
2. Tokunaga, E., Terasakiy, A. &  Kobayashi, T. 
Femtosecond phase spectroscopy by use of frequency -
domain interference. J. Opt. Soc. Am. B  12, 753 (1995).  
3. Tanghe, I. et al.  Broadband Optical Phase Modulation by 
Colloidal CdSe Quantum Wells. Nano Lett.  22, 58‚Äì64 
(2022).  
4. Tokunaga, E.,  Kobayashi, T. & Terasaki, A. Frequency -
domain interferometer for femtosecond time -resolved 
phase spectroscopy. Opt. Lett.  17, 1131 (1992).  
5. Bionta, M. R. et al.  On-chip sampling of optical fields 
with attosecond resolution. Nat. Photonics  15, 456 ‚Äì460 
(2021).  
6. Kim, K. T. et al.  Petahertz optical oscilloscope. Nat. 
Photonics  7, 958 ‚Äì962 (2013).  
7. Dam, J. S., Tidemand -Lichtenberg, P. & Pedersen, C. 
Room -temperature mid -infrared single -photon spectral 
imaging. Nat. Photonics  6, 788 ‚Äì793 (2012).  
8. Gordon, R. Room -temperature mid -infrared detectors. 
Science  374, 1201 ‚Äì1202 (2021).  
9. Zhang, X. -C. & Xu, J. Introduction to THz Wave 
Photonics . (Springer US, 2010).  
10. Burford, N. M. & El -Shenawee, M. O. Review of terahertz 
photoconductive antenna technol ogy. Opt. Eng.  56, 
010901 (2017).  
11. Wu, Q. & Zhang, X. C. Free -space electro -optic sampling 
of terahertz beams. Appl. Phys. Lett.  67, 3523 (1995).  
12. K√ºbler, C., Huber, R., T√ºbel, S. & Leitenstorfer, A. 
Ultrabroadband detection of multi -terahertz field transients 
with GaSe electro -optic sensors: Approaching the near 
infrared. Appl. Phys. Lett.  85, 3360 ‚Äì3362 (2004).  
13. Tidemand -Lichtenberg, P., Dam, J. S., Andersen, H. V., 
H√∏gstedt, L. & Pedersen, C. Mid -infrared upconversion 
spectroscopy. J. Opt. Soc. A m. B 33, D28 (2016).  
14. Huang, K., Fang, J., Yan, M., Wu, E. & Zeng, H. Wide -
field mid -infrared single -photon upconversion imaging. 
Nat. Commun.  13, (2022).  15. Kono, S., Tani, M., Gu, P. & Sakai, K. Detection of up to 
20 THz with a low -temperature -grown GaAs 
photoconductive antenna gated with 15 fs light pulses. 
Appl. Phys. Lett.  77, 4104 ‚Äì4106 (2000).  
16. Keiber, S. et al.  Electro -optic sampling of near -infrared 
waveforms. Nat. Photonics  10, 159 ‚Äì162 (2016).  
17. Park, S. B. et al.  Direct sampling of a ligh t wave in air. 
Optica  5, 402 (2018).  
18. Liu, Y., Beetar, J. E., Nesper, J., Gholam -Mirzaei, S. & 
Chini, M. Single -shot measurement of few -cycle optical 
waveforms on a chip. Nat. Photonics  16, 109 ‚Äì112 (2022).  
19. Herbst, A. et al.  Recent advances in petahertz electric field 
sampling. J. Phys. B At. Mol. Opt. Phys.  55, (2022).  
20. Ludwig, M. et al.  Sub-femtosecond electron transport in a 
nanoscale gap. Nat. Phys.  16, 341 ‚Äì345 (2020).  
21. Kr√ºger, M., Schenk, M. & Hommelhoff, P. Attose cond 
control of electrons emitted from a nanoscale metal tip. 
Nature  475, 78‚Äì81 (2011).  
22. Herink, G., Solli, D. R., Gulde, M. & Ropers, C. Field -
driven photoemission from nanostructures quenches the 
quiver motion. Nature  483, 190 ‚Äì193 (2012).  
23. Schiffri n, A. et al.  Optical -field-induced current in 
dielectrics. Nature  493, 70‚Äì74 (2013).  
24. Rybka, T. et al.  Sub-cycle optical phase control of 
nanotunnelling in the single -electron regime. Nat. 
Photonics  10, 667 ‚Äì671 (2016).  
25. Pupeza, I. et al.  Field -resolv ed infrared spectroscopy of 
biological systems. Nature  577, 52‚Äì59 (2020).  
26. Liu, Y. et al.  All-optical sampling of few -cycle infrared 
pulses using tunneling in a solid. Photonics Res.  9, 929 
(2021).  
27. Wyatt, A. S. et al.  Attosecond sampling of arbitrar y 
optical waveforms. Optica  3, 303 (2016).  
28. Hammond, T. et al.  Near -field imaging for single -shot 
waveform measurements. J. Phys. B At. Mol. Opt. Phys.  
51, 065603 (2018).  
29. Brida, D., Krauss, G., Sell, A. & Leitenstorfer, A. 
Ultrabroadband Er:fiber lasers. Laser Photon. Rev.  8, 409 ‚Äì
428 (2014).  
30. Sulzer, P. et al.  Determination of the electric field and its 
Hilbert transform in femtosecond electro -optic sampling. 
Phys. Rev. A 101, 033821 (2020).  
31. Sell, A., Leitenstorfer, A. & Huber, R. Phase -locked 
generation and field -resolved detection of widely tunable 
terahertz pulses with amplitudes exceeding 100 MV/cm. 
Opt. Lett.  33, 2767 (2008).  32. Cerullo, G. & De Silvestri, S. Ul trafast optical parametric 
amplifiers. Rev. Sci. Instrum.  74, 1‚Äì18 (2003).  
33. Nunley, T. N. et al.  Optical constants of germanium and 
thermally grown germanium dioxide from 0.5 to 6.6eV via 
a multisample ellipsometry investigation. J. Vac. Sci. 
Technol. B  34, 061205 (2016).  
34. Burnett, J. H., Benck, E. C., Kaplan, S. G., Stover, E. & 
Phenis, A. Index of refraction of germanium. Appl. Opt.  
59, 3985 (2020).  
35. Li, H. H. Refractive index of silicon and germanium and 
its wavelength and temperature derivatives. J. Phys. Chem. 
Ref. Data  9, 561 ‚Äì658 (1980).  
36. Ferrini, R., Patrini, M. & Franchi, S. Optical functions 
from 0.02 to 6 eV of Al xGa1-xSb/GaSb epitaxial laye rs. J. 
Appl. Phys.  84, 4517 ‚Äì4524 (1998).  
37. Djuri≈°iƒá, A. B., Li, E. H., Rakiƒá, D. & Majewski, M. L. 
Modeling the optical properties of AlSb, GaSb, and InSb. 
Appl. Phys. A Mater. Sci. Process.  70, 29‚Äì32 (2000).  
38. Adachi, S. Optical dispersion relations f or GaP, GaAs, 
GaSb, InP, InAs, InSb, Al xGa1-xAs, and In 1-xGaxAsyP1-y. J. 
Appl. Phys.  6030 , (1998).  
39. Washio, K. SiGe HBT and BiCMOS technologies for 
optical transmission and wireless communication systems. 
IEEE Trans. Electron Devices  50, 656 ‚Äì668 (2003).  
40. Bennett, B. R., Magno, R., Boos, J. B., Kruppa, W. & 
Ancona, M. G. Antimonide -based compound 
semiconductors for electronic devices: A review. Solid. 
State. Electron.  49, 1875 ‚Äì1895 (2005).  
41. Sell, A., Krauss, G., Lohss, S., Huber, R. & Leitenstorfer, 
A. 8-fs pulses from a compact Er: Fiber laser system. Opt. 
Express  17, 287 ‚Äì291 (2009).  
 
 Supplementary Information: Few-femtosecond phase -
sensitive detection of infrared electric fields with a third -
order nonlinearity  
HANNES KEMPF1, PHILIPP SULZER1, ANDREAS LIEHL1, ALFRED 
LEITENSTORFER1, AND  RON TENNE1 * 
1Department of Physics and Center for Applied Photonics, University of Konstanz, D -78457 Konstanz, Germany  
*Corresponding author: ron.tenne@uni -konstanz.de  
  2 
  
Table of contents  
# Chapter  title Page  
1 Temporal characterization of the probe pulse  3 
2 Spectrum and phase of a typical MCTOS measurement  4 
3 Solving the nonlinear wave equation for four -wave mixing  5 
4 Introduction of the three frequency -mixing processes and their complex phasors  7 
5 General expressions for the output of the nonlinear interaction routes  9 
6 Analysis of the MCTOS spectral response function  11 
7 Derivation of the expression for the group index of refraction  13 
8 Supplementary References  14 
 
 
  3 
 Supplementary Note 1: Temporal characterization of the probe  pulse   
 
 
Figure S 1. FROG characterization of the probe. a and b show the measured and reconstructed FROG 
trace, respectively. c The d educed pulse intensity envelope in the time domain. d Reconstructed 
spectrum (blue) and phase (red) . Importantly,  the phase changes only over a range of ¬±ùúã/8 (dashed 
red line) over the entire spectrum. For comparison , the spectrum measured with an optical spectrum 
analyser is shown in black.  
 
In this sectio n, we quantify the spectral phase and pulse duration of the probe  pulse . For this purpose,  we 
apply  the frequency -resolved -optical -gating (FROG)  technique1 - an extended autocorrelation measurement 
in which the two replicas of the pulse under investigation are focused  into a second -order nonlinear crystal. 
Sweeping the relative time delay between the two replicas  and de tecting the spectrum of the sum -frequency 
generation  signal  for each time step yie lds the FROG trace (Fig. S 1a). Subsequently, a retrieval  algorithm 
reconstructs the electric -field transient  in the time domain to best fit the FROG results . The  reconstruction , 
presented in Fig. S 1b, fits well to the measured FROG trace , indicating a succ essful retrieval. The 
corresponding pulse in the time domain , shown in blue in Fig. S 1c, exhibits a full -width -at-half-maximum 
(FWHM) duration of 11.4 fs. Its temporal phase (red) is nearly zero during the  main pulse. The 
corresponding spectrum (blue) is depicted in Fig. S 1d. Its spectral phase (red) varies in a range of only 
¬±ùúã/8 over the entire ~70 THz band exhibiting an almost bandwidth -limited pulse.  
To estimate the validity of the measurement and rec onstruction algorithm, the spectral intensity analyzed 
from the FROG measurement is compared the one measured with an optical spectrum analyzer  (black line, 
Fig. S 1d). While variations appear, especially in the high -frequency portion , the results are in go od 
agreement . Following this characteriza tion, our modeling for MCTOS in this work (Figs. 5 and 6 of the 
main text) considers the interaction of a Fourier -limited ultrashort probe pulse  with the signal pulse under 
inspection . 
  
4 
  
Supplementary Note 2: Spectrum and phase of a typical MCTOS measurement  
 
Figure S2. a Detected output versus time delay. b Fourier transform of a. 
Figure S2a presents  the differential current as in Fig. 2 a of the main text. Its Fourier transform is shown in 
Figure S2b. The spectral amplitude and the corresponding phase are depicted  by the blue and red lines, 
respectively. For better visualization, the amplitudes of both spectral components are normalized 
individually.  
  
5 
 Supplementary Note 3: Solving  the nonlinear wave equation for four-wave mixing   
Here, we provide a detailed derivation of the analytical model for all three interactions  routes described 
within the main text . We start by solving the nonlinear wave equation to obtain an expression for the newly 
generated field, following standard literature, e.g.,  2. In the frequency domain, the expression  of the 
nonlinear wave equation is  
d2
dùëß2ùê∏ÃÉ(ùúî,ùëß)+ùúî2
ùëê2 ùëõ2(ùúî)‚ãÖùê∏ÃÉ(ùúî,ùëß)=‚àíùúî2
ùúñ0ùëê2  ùëÉÃÉùëÅùêø, (S1) 
where ùëê is the speed of light, ùëõ is the refractive index of the detection crystal,  ùúñ0 is the vacuum permittivity, 
and ùëÉÃÉùëÅùêø is the nonlinear source term. The electric fields can be expressed as  a sum of harmonic components  
ùê∏ÃÉùëõ(ùúîùëõ,ùëß)=ùê∏ùëõ(ùúîùëõ,ùëß)ùëíùëñùëòùëõùëß, (S2) 
with ùê∏ùëõ(ùúîùëõ,ùëß)‚â°ùê¥ùëõ(ùúîùëõ,ùëß)ùëí‚àíùëñùúôùëõ(ùúîùëõ,ùëß), the wave vector ùëòùëõ=ùëõ(ùúîùëõ)‚ãÖùúîùëõ/ùëê, and the spectral phase 
ùúôùëõ(ùúîùëõ,ùëß). For three fields ùê∏ÃÉùëò(ùúîùëò,ùëß), ùê∏ÃÉùëö(ùúîùëö,ùëß), and ùê∏ÃÉùëõ‚àó(ùúîùëõ,ùëß) (two photons annihilated and one 
generated) propagating along the z-direction, the nonlinear source term is given by  
ùëÉÃÉùëÅùêø(ùúîùëù,ùëß)=4 ùúñ0ùúíeff(3)ùê∏ÃÉùëò(ùúîùëò,ùëß)ùê∏ÃÉùëö(ùúîùëö,ùëß)ùê∏ÃÉùëõ‚àó(ùúîùëõ,ùëß)  
=4 ùúñ0ùúíeff(3)ùê∏ùëòùê∏ùëöùê∏ùëõ‚àóùëíùëñ(ùëòùëò+ùëòùëö‚àíùëòùëõ)ùëß, (S3) 
with the vacuum permittivity ùúñ0. Here, ùúîùëù=ùúîùëò+ùúîùëö‚àíùúîùëõ, is the frequency of the  wave component 
produced by the four -wave mixing interaction. The effective third -order susceptibility ùúíeff(3) is assumed to 
be real -valued and identical for all processes considered in the following. Inserting these expressions [Eqs. 
(S2) and (S 3)] into the nonlinear wave equation [Eq. (S1)], we obtain a propagation equation for a general 
frequency component of the electric field ùê∏ùëù that follows the ansatz in Eq. (S2):  
 
 
[d2ùê∏ùëù
dùëß2+2ùëñùëòùëùdùê∏ùëù
dùëß‚àíùëòùëù2‚ãÖùê∏ùëù+ùúîùëù2
ùëê2 ùëõ2(ùúîùëù)ùê∏ùëù]ùëíùëñùëòùëùùëß 
=‚àí 4ùúîùëù2
ùëê2 ùúíeff(3) ùê∏ùëòùê∏ùëöùê∏ùëõ‚àóùëíùëñ(ùëòùëò+ùëòùëö‚àíùëòùëõ)ùëß. (S4) 
With the definition of the wavevector, we cancel out the third and fourth term on the left-hand side of 
Equation (S 4). Applying the slowly varying amplitude approximation , 
|d2ùê∏ùëù
dùëß2|‚â™|ùëòùëùdùê∏ùëù
dùëß|, (S5) 
we can neglect the first term of the left -hand side of Eq. (S 4). Introducing the wave -vector mismatch Œîùëò=
ùëòùëò+ùëòùëö‚àíùëòùëõ‚àíùëòùëù further simplifies Eq. (S 4) to  
dùê∏ùëù
dùëß=2ùëñùúîùëù2ùúíùëíùëìùëì(3)
ùëê2ùëòùëùùê∏ùëòùê∏ùëöùê∏ùëõ‚àóùëíùëñùõ•ùëò‚ãÖùëß. (S6) 
Under the undepleted -pump approximation ( ùê∏ùëò, ùê∏ùëö, and ùê∏ùëõ independent of z ), the integration over the 
thickness ùêø of the nonlinear crystal produces a simple express ion for the newly generated field  
ùê∏ùëù(L)=2ùëñùúîùëù2ùúíeff(3)
ùëê2ùëòpùê∏ùëòùê∏ùëöùê∏ùëõ‚àóùúâ(ùêø), (S7) 6 
 with the phase -matching factor  
ùúâ=exp[ùëñŒîùëò‚ãÖùêø]‚àí1
ùëñŒîùëò. (S8)  
  7 
 Supplementary Note 4: Introduction of the t hree frequency -mixing processes  and their  
complex phasors  
After deriving a general expression for the newly generated field through third -order nonlinear interaction, 
we now introduce  the three different processes  of MCTOS . For this,  we first provide the energy 
conservation for each  of them : 
ùúîùëàùê∂‚àí(Œ©‚àíùúî1)=ùúî, (S9) 
ùúîùê∑ùê∂‚àí(ùúî1‚àíŒ©)=ùúî, (S10) 
ùúîùê∑ùê∑ùê∂ +(Œ©1‚àíŒ©)=ùúî. (S11) 
We consider here the frequencies ùúîùëàùê∂, ùúîùê∑ùê∂ and ùúîùê∑ùê∑ùê∂ as initial input of the process (even though this 
definition is somewhat arbitrary) and use ùúî to indicate the frequency of the nonlinear source term for all  
three processes .  The frequencies  of the photons  are arranged according to the order in which they appear 
in the arrow scheme  (Fig. 3b  of the main text ). For the upconversion ( UC) process, for example, the initial 
probe photon ( ùúîùëàùê∂; leftmost  arrow in green) interacts with a signal photon ( Œ©; second arrow from the left 
in red) and another probe photon ( ùúî1; third arrow from the left in green) to generate a new photon ( ùúî; 
rightmost  arrow in blue).  
By separately inserting these frequenc y relat ions into Eq. (S 7), we obtain the expressions for three  nonlinear 
contributions to a general frequency ùúî: 
 ùê∏ùëàùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùëàùê∂ùê∏ùëÉ(ùúî1)ùê∏ùëÉ[ùúî+(Œ©‚àíùúî1)]ùê∏ùëÜ‚àó(Œ©)dùúî1dŒ©,‚àû
0(S12) 
ùê∏ùê∑ùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∂ùê∏ùëÉ‚àó(ùúî1)ùê∏ùëÉ[ùúî+(ùúî1‚àíŒ©)]ùê∏ùëÜ(Œ©)dùúî1dŒ©‚àû
0(S13) 
and 
ùê∏ùê∑ùê∑ùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∑ùê∂ùê∏ùëÉ[ùúî‚àí(Œ©1‚àíŒ©)]ùê∏ùëÜ(Œ©1)ùê∏ùëÜ‚àó(Œ©)dŒ©1dŒ©,‚àû
0 (S14) 
with the spectral field of the probe ùê∏ùëÉ and signal ùê∏ùëÜ pulse . To reduce the number  of variables, w e replaced 
the initia l frequency of each interaction, invoking the energy -conservation constrains expressed in Eqs. (S 9) 
-(S11). Since we treat broadband spectra , integration over the frequencies ùúî1 and Œ© (or Œ©1 and Œ© for DDC) 
is necessary to obtain all contributions for the  newly generated field.  The phase -matching factors ùúâùëàùê∂, ùúâùê∑ùê∂, 
and ùúâùê∑ùê∑ùê∂ are defined as:  
ùúâùëã=exp[ùëñŒîùëòùëã(ùúî,Œ©,ùúî1)ùêø]‚àí1
ùëñŒîùëòùëã(ùúî,Œ©,ùúî1), (S15) 
where ùëã is a substitute  for the three processes UC, DC , and DDC . ùêø is the thickness of the detection crystal 
and Œîùëòùëàùê∂, Œîùëòùê∑ùê∂, and Œîùëòùê∑ùê∑ùê∂ are the phase mismatches for each process:   
Œîùëòùëàùê∂=ùëò[ùúî+(Œ©‚àíùúî1)]+ùëò(ùúî1)‚àíùëò(ùúî)‚àíùëò(Œ©). (S16) 
Œîùëòùê∑ùê∂=ùëò[ùúî+(ùúî1‚àíŒ©)]‚àíùëò(ùúî1)‚àíùëò(ùúî)+ùëò(Œ©). (S17) 
Œîùëòùê∑ùê∑ùê∂ =ùëò[ùúî‚àí(Œ©1‚àíŒ©)]+ùëò(Œ©1)‚àíùëò(ùúî)‚àíùëò(Œ©). (S18) 
We express the spectral fields of the probe and signal  pulse as:  
ùê∏ùëÉ(ùúî)=ùê¥ùëÉ(ùúî)exp(‚àíùëñùúôùëÉ0), (S19) 
ùê∏ùëÜ(Œ©)=ùê¥ùëÜ(Œ©)exp[‚àíùëñ ùúôùëÜ(Œ©)]=ùê¥ùëÜ(Œ©)exp{‚àíùëñ[ùúôùëÜ0+Œ©ùë°ùê∑+ùúôùëÜ‚Ñéùëú(Œ©)]}, (S20) 8 
 with the carrier -envelope phase s (CEP) of the probe ùúôùëÉ0 and signal  ùúôùëÜ0, their spectral amplitudes ùê¥ùëÉ(œâ) and 
ùê¥ùëÜ(Œ©), and their relative time delay ùë°ùê∑. ùúôùëÜ‚Ñéùëú(Œ©)=ùúôùëÜ(2)‚ãÖ(Œ©‚àíŒ©0)2+ùúôùëÜ(3)‚ãÖ(Œ©‚àíŒ©0)3+ ‚Ä¶  denotes t he 
higher -order spectral phase  of the signal  pulse  with Œ©0 being its central frequency . Since the probe pulse is 
bandwidth -limited, its higher -order spectral phase is zero  3. Inserting both terms  of the spectral fields  into 
Eqs. (S1 2) - (S14), we obtain:  
ùê∏ùëàùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùëàùê∂‚àû
0ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)] 
√óùê¥ùëÜ(Œ©)exp[ùëñ(Œ©ùë°ùê∑+ùúôùëÜ0‚àí2ùúôùëÉ0+ùúôùëÜ‚Ñéùëú)]dùúî1dŒ©, (S21) 
ùê∏ùê∑ùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∂‚àû
0ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)] 
√óùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œ©ùë°ùê∑+ùúôùëÜ0+ùúôùëÜ‚Ñéùëú)]dùúî1dŒ©, (S22) 
ùê∏ùê∑ùê∑ùê∂(ùúî)=ùëñ‚à¨2ùúî2
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∑ùê∂ùê¥ùëÉ[ùúî‚àí(Œ©1‚àíŒ©)]‚àû
0 
                 √óùê¥ùëÜ(Œ©1)ùê¥ùëÜ(Œ©)exp{ùëñ[(Œ©‚àíŒ©1)ùë°ùê∑+ùúôùëÜ‚Ñéùëú(Œ©)‚àíùúôùëÜ‚Ñéùëú(Œ©1)‚àíùúôùëÉ0]}dŒ©1dŒ©. (S23) 
The linear polarization of these terms  is perpendicular to that of the probe field . The ellipsometer , composed 
of a waveplate followed  by a Wollaston prism and a balanced detector (Fig. 1 of the main text),  achieves 
two effects. First, it mixes the orthogonally  polarized fields,  producing an interference signal  between the 
probe and the nonlinearly generated field. Second, the ellipsomet er balances the intensities on the two 
diodes so that the difference between them yield s the interference term alone .  
The interference signal  can be divided into an in -phase and a œÄ/2-phase component  that form the real and 
imaginary parts of a complex phasor, respectively . The former results in a rotation of the polarization input 
into the ellipsometer whereas the latter induces a slight ellipticity.  To obtain the expression of the complex 
phasor, fol lowing ref  4, we multipl y the nonlinearly generated fields [Eq. (S21)-(S23)] with the complex 
conjugate of the probe field with the same frequency , ùê∏ùëÉ‚àó(ùúî). Measuring the spectrally integrated intensity 
with the photodiodes  results in an additional integration over ùúî: 
ùëÉùëàùê∂(ùë°ùê∑)=ùëñ‚à≠2ùúîùúîùëê
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùëàùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)]‚àû
0 
√óùê¥ùëÜ(Œ©)exp[ùëñ(Œ©ùë°ùê∑+Œîùúô0+ùúôùëÜ‚Ñéùëú)]dùúîdùúî1dŒ©, (S24) 
ùëÉùê∑ùê∂(ùë°ùê∑)=ùëñ‚à≠2ùúîùúîùëê
ùëê2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)]‚àû
0 
√óùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œ©ùë°ùê∑+Œîùúô0+ùúôùëÜ‚Ñéùëú)]dùúîdùúî1dŒ©, (S25) 
ùëÉùê∑ùê∑ùê∂(ùë°ùê∑)=ùëñ‚à≠2ùúîùúîùëê
c2ùëò(ùúî)ùúíeff(3)ùúâùê∑ùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ[ùúî‚àí(Œ©1‚àíŒ©)]‚àû
0 
                 √óùê¥ùëÜ(Œ©1)ùê¥ùëÜ(Œ©)exp{ùëñ[(Œ©‚àíŒ©1)ùë°ùê∑+ùúôùëÜ‚Ñéùëú(Œ©)‚àíùúôùëÜ‚Ñéùëú(Œ©1)]}dùúîdŒ©1dŒ©, (S26) 
with the CEP difference Œîùúô0=ùúôùëÜ0‚àíùúôùëÉ0, the center frequency of the probe ùúîùëê and the additional factor 
ùúîùëê/ùúî considering  the fact that the photodiodes  detect  the photon number  and not the intensity . The 
imaginary part (detected with a QWP) of the phasors represents the difference  in ellipticity, while the real 
part (determined in the  HWP  case) corresponds to the polarization rotation  change . 
  9 
 Supplementary Note 5: General expressions for the o utput of the nonlinear interactio n 
routes  
Before explicitly obtaining the results of the detected outputs, we simplify their expressions  by defining  the 
spectral response  functions  ùëÖùëàùê∂(Œ©), ùëÖùê∑ùê∂(Œ©), and ùëÖùê∑ùê∑ùê∂(Œ©) of the three interactions as:  
ùëÖùëàùê∂(Œ©)=‚à¨ùúî
ùëò‚àó(ùúî)ùúâùëàùê∂‚àóùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)]dœâ1dùúî‚àû
0, (S27) 
ùëÖùê∑ùê∂(Œ©)=‚à¨ùúî
ùëò(ùúî)ùúâùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)] dùúî1dùúî‚àû
0, (S28) 
ùëÖùê∑ùê∑ùê∂(Œ©,Œ©1)=‚à´ùúî
ùëò(ùúî)ùúâùê∑ùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ[ùúî‚àí(Œ©1‚àíŒ©)]dùúî‚àû
0. (S29) 
The phase -matching factor ùúâùëñ strongly depends on the dispersion of the detection crystal  and can 
significantly modify  the response function s. Qualitatively, the dispersion lead s to a phase shift between the 
nonlinearly gen erated fields at different axial positions inside the crystal and can thus result in  destructive 
interference. In an experiment, to obtain optimal spectral response  function s, the influence of the phase -
matching factor can be mitigated  either by using a  thin detection medium  [decrease ùêø in Eq. (S1 5) and (S 8)] 
or by harnessing a birefringent crystal  to minimize the phase  mismatch  [Eqs. (S 16) -(S18)]. 
Considering only UC and  DC, the expressions for the measured  output  are [Eqs. (6) and ( 7) in the main 
text]: 
ŒîùêºùëÑùëäùëÉ (ùë°ùê∑)‚àùIm[ùëÉùê∑ùê∂(ùë°ùê∑)+ùëÉùëàùê∂(ùë°ùê∑)]=Im[ùëÉùê∑ùê∂(ùë°ùê∑)‚àíùëÉùëàùê∂‚àó(ùë°ùê∑)]
‚àù‚à´Re{[ùëÖùê∑ùê∂ (Œ©)+ùëÖùëàùê∂ (Œ©)]‚àû
0ùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œ©ùë°ùê∑+Œîùúô0+ùúôùëÜ‚Ñéùëú )]}dŒ©, (S30) 
ùõ•ùêºùêªùëäùëÉ (ùë°ùê∑)‚àùRe[ùëÉùê∑ùê∂(ùë°ùê∑)+ùëÉùëàùê∂(ùë°ùê∑)]=Im[ùëÉùê∑ùê∂(ùë°ùê∑)+ùëÉùëàùê∂‚àó(ùë°ùê∑)]
‚àù‚à´Im{[ùëÖùê∑ùê∂ (Œ©)‚àíùëÖùëàùê∂ (Œ©)]‚àû
0ùê¥ùëÜ(Œ©)exp[‚àíùëñ(Œ©ùë°ùê∑+Œîùúô0+ùúôùëÜ‚Ñéùëú )]}dŒ©. (S31) 
To obtain the numerically calculated spectra displayed in Fig. 5 in the main text, we have to slightly modify 
the spectral response functions . In these experiments, intentionally employing spectral filtering,  only a part 
of the probe spectrum is detect ed after the interaction . This is implemented  by restricting the integration 
over the probe frequency ùúî to a lower and upper limit ùúîùëôùëúùë§ and ùúî‚Ñéùëñùëî‚Ñé, respectively:  
ùëÖÃÉùëàùê∂(Œ©)=‚à´ ‚à´ùúî
ùëò‚àó(ùúî)ùúâùëàùê∂‚àóùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(Œ©‚àíùúî1)]dœâ1dùúî‚àû
0ùúî‚Ñéùëñùëî‚Ñé
ùúîùëôùëúùë§, (S32) 
ùëÖÃÉùê∑ùê∂(Œ©)=‚à´ ‚à´ùúî
ùëò(ùúî)ùúâùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)] dùúî1dùúî‚àû
0ùúî‚Ñéùëñùëî‚Ñé
ùúîùëôùëúùë§. (S33) 
Inserting these in Eqs. (S3 0) and (S3 1) allows us to calculate the detected spectrum for different bandpass 
filters as displayed in Fig. 5 of the main text.  
 
Finally , we consider  the DDC process . The expressions for the detected differential current are obtained by 
taking the real and imaginary part of the phasor [Eq. (S2 6)] and substituting  the spe ctral response function 
[Eq. (S29 )]: 
ùõ•ùêºùê∑ùê∑ùê∂ùëÑùëäùëÉ(ùë°ùê∑)‚àù‚à¨ Re{ùëÖùê∑ùê∑ùê∂(Œ©,Œ©1)ùê¥ùëÜ(Œ©1)ùê¥ùëÜ(Œ©)ùëíùëñ[(Œ©‚àíŒ©1)ùë°ùê∑+ùúôùëÜ‚Ñéùëú(Œ©)‚àíùúôùëÜ‚Ñéùëú(Œ©1)]}‚àû
0dŒ©1dŒ©, (S34) 10 
 ùõ•ùêºùê∑ùê∑ùê∂ùêªùëäùëÉ(ùë°ùê∑)‚àù‚à¨ Im{ùëÖùê∑ùê∑ùê∂(Œ©,Œ©1)ùê¥ùëÜ(Œ©1)ùê¥ùëÜ(Œ©)ùëíùëñ[(Œ©‚àíŒ©1)ùë°ùê∑+ùúôùëÜ‚Ñéùëú(Œ©)‚àíùúôùëÜ‚Ñéùëú(Œ©1)]}‚àû
0dŒ©1dŒ©. (S35) 
Even though these outputs  depend on the spectral amplitude and phase of the signal pulse , they do not 
provide direct acce ss to it. In the intuitive phasor picture given in the main text [Eq.  (5)], a finite output  is 
only expected  for the detection with a QWP. This conclusion holds as long as  dispersion in the detection 
crystal  is neglected,  resulting  in a purely real response function  [Eq. (S 29)]. However, s ince all materials 
exhibit some dispersion,  a reduced but measurable  HWP output is present  in our experiments .  
  11 
 Supplementary Note 6: Analysis of the MCTOS spectral response function  
In this se ction, we provide numerical calculations of the spectral response function  ùëÖ(Œ©) for different 
experimental configurations . These  are based on the probe -branch spectrum as measured with an optical 
spectrum analyzer  (see Fig. S 1d). We restrict the calculations by setting  a flat dispersion  for the detection 
crystal  - simplif ying the phase mismatch to Œîùëò=0 and the phase -matching factor to ùúâ=1. We note that 
this approximation is justified when using a  thin detection crystal .  
 
Figure S 3. Absolute value of the s pectral response functions for different configurations deploying 
the probe spectrum presented in Fig. S 1d (black curve)  and a dispersion -free detection crystal. a 
ùëÖ(Œ©) for a bandwidth -limited probe detected over its entire spectrum (blue) and detected over a 
narrow band around  286 THz (red), 214 THz (yellow), and 250 THz (purple). b The s pectral 
response function assuming a bandwidth -limited probe (blue), the FROG -retrieved spectral phase 
(dashed red) shown in Fig. S 1d, and a linear ly chirp ed probe pulse  with a group -delay dispersion of 
100 fs2 (yellow).  
Fig. S 3a analyzes the influence of spectrally filtering the probe after the  nonlinear  interaction. T he absolute 
value of the sum of the UC and DC spectral response function s ùëÖ(Œ©)=ùëÖùëàùê∂(Œ©)+ùëÖùê∑ùê∂(Œ©) is shown for a 
bandwidth -limited probe considering detection  over th e full spectr al band (blue) and a bandpass filter 
limiting detection around  a center frequency of 284 THz (red), 214 THz (yellow) and 250 THz (purple). 
For a clear comparison all r esponse functions were normalized to unity at their peaks.  
Detecting only at the spectral edges of the probe broaden s ùëÖ(Œ©), whereas a bandpass filter around 250 THz 
reduces the bandwidth. Since for UC and DC the energy gain (or loss ) is large , they are suppressed (see 
Fig. 3 in the main text)  in the latter case. As a result, the effective bandwidth of the probe reduces producing 
a narrow er spectral response function. In contrast, filtering at the edges of the probe suppresses interactions 
with a low freq uency gain or loss and thus increases the bandwidth of ùëÖ(Œ©).  
In addition, we analyze t he impact of a chirped probe pulse on the spectral response function (Fig. S 3b). 
For this, the spectral field of the probe has to be extended to including a higher -order phase term ùê∏ùëÉ(ùúî)=
ùê¥ùëÉ(ùúî)exp{‚àíùëñ[ùúôùëÉ0+ùúôùëÉ‚Ñéùëú(ùúî)]}. Following the same steps as in sections  3-5, we obtain  the spectral 
response functions : 
ùëÖùëàùê∂(Œ©)=‚à¨ùúî
ùëò‚àó(ùúî)ùúâùëàùê∂‚àóùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî‚àí(ùúî1‚àíŒ©)]‚àû
0 
√óexp{‚àíùëñ[ùúôùëÉ‚Ñéùëú(ùúî)‚àíùúôùëÉ‚Ñéùëú(ùúî1)‚àíùúôùëÉ‚Ñéùëú(ùúî‚àí(ùúî1‚àíŒ©))]}dœâ1dùúî, (S36) 
ùëÖùê∑ùê∂(Œ©)=‚à¨ùúî
ùëò(ùúî)ùúâùê∑ùê∂ùê¥ùëÉ(ùúî)ùê¥ùëÉ(ùúî1)ùê¥ùëÉ[ùúî+(ùúî1‚àíŒ©)] ‚àû
0
√óexp{‚àíùëñ[‚àíùúôùëÉ‚Ñéùëú(ùúî)‚àíùúôùëÉ‚Ñéùëú(ùúî1)+ùúôùëÉ‚Ñéùëú(ùúî‚àí(ùúî1‚àíŒ©))]}dùúî1dùúî. (S37) 
12 
  
Using these equations, we calculate the spectral response functions for the same probe spectrum (black, 
Fig. S 1d), but with different spectral phases. As in Fig. S 3a, the bandwidth -limited case is shown in blue.  
Including the spectral phase retrieved from  the FROG measurement (Supplemental 1, Sec. 1) yields only 
minute changes to the spectral response function (dashed red) validating  our approximation of the probe as  
a bandwidth -limited  pulse in all calculations . According to this calculation, a dding a linear chirp with a 100 
fs2 group -delay dispersion increases the pulse duration  of the probe to  21 fs  and decreases the bandwidth 
of the spectral response function (yel low). On an intuitive level , the linear chirp effectively reduces the 
momentary bandwidth of the probe resulting in a narrower ùëÖ(Œ©).  
  13 
 Supplementary Note 7: Derivation of the expression for the group index  of refraction  
Here, we derive equation ( 8) of the main text.  The difference of the refractive index Œîùëõ(Œ©) for a time-
domain spectroscopy (TDS)  measurement is given  by (cf. 5): 
Œîùëõ(Œ©)=Œîùúô(Œ©)
ùëò0(Œ©)ùëë , (S38) 
with the phase difference Œîùúô(Œ©) between the measurements with and without sample, the wave  vector in 
vacuum ùëò0=Œ©/ùëê and the thickness of the sample ùëë. We assume a refractive index in air of 1 and therefore 
obtain the equation  for the refractive index  of the specimen  ùëõ(Œ©): 
ùëõ(Œ©)=1+ùëê
ùëëŒîùúô(Œ©)
Œ©. (S39) 
By inserting the previous equation into the definition of the group refractive index2  
ùëõùëî(Œ©)=ùëõ(Œ©)+ùõ∫ ùúïùëõ(Œ©)
ùúïŒ©, (S40) 
we obtain the final expression:  
ùëõùëî(Œ©)=1+ùëê
ùëëùúïŒîùúô(Œ©)
ùúïŒ©. (S41) 
 
 
 
 
 
 
 
    14 
 Supplementary References  
1. DeLong, K. W., Trebino, R., Hunter, J. & White, W. E. Frequency -resolved optical gating 
with the use of second -harmonic generation. J. Opt. Soc. Am. B  11, 2206 (1994).  
2. Boyd, R. W. Nonlinear Optics . vol. 3 (Academic Press, 2008).  
3. Weiner, A. M. Ultrafa st Optics . (John Wiley & Sons, Inc., 2009).  
4. Sulzer, P. et al.  Determination of the electric field and its Hilbert transform in 
femtosecond electro -optic sampling. Phys. Rev. A  101, 033821 (2020).  
5. Neu, J. & Schmuttenmaer, C. A. Tutorial: An introducti on to terahertz time domain 
spectroscopy (THz -TDS). J. Appl. Phys.  124, (2018).  
 
 