1
Channel Estimation and Signal Detection for
NLOS Ultraviolet Scattering Communication
with Space Division Multiple Access
Yubo Zhang, Yuchen Pan, Chen Gong, Beiyuan Liu and Zhengyuan Xu
Abstract
We design a receiver assembling several photomultipliers (PMTs) as an array to increase the ﬁeld of
view (FOV) of the receiver and adapt to multiuser situation over None-line-of-sight (NLOS) ultraviolet
(UV) channels. Channel estimation and signal detection have been investigated according to the space
division characteristics of the structure. Firstly, we adopt the balanced structure on the pilot matrix,
analyze the channel estimation mean square error (MSE), and optimize the structure parameters. Then,
with the estimated parameters, an analytical threshold detection rule is proposed as a preliminary work of
multiuser detection. The detection rule can be optimized by analyzing the separability of two users based
on the Gaussian approximation of Poisson weighted sum. To assess the effect of imperfect estimation, the
sensitivity analysis of channel estimation error on two-user signal detection is performed. Moreover, we
propose a successive elimination method for on-off keying (OOK) modulated multiuser symbol detection
based on the previous threshold detection rule. A closed-form upper bound on the detection error rate is
calculated, which turns out to be a good approximation of that of multiuser maximum-likelihood (ML)
detection. The proposed successive elimination method is twenty times faster than the ML detection with
negligible detection error rate degradation.
Index Terms
Channel estimation, antenna array, space division, threshold detection, multi-user interference.
This work was supported by National Natural Science Foundation of China (Grant No. 62171428), Key Research Program of
Frontier Sciences of CAS (Grant No. QYZDY-SSW-JSC003), and the Fundamental Research Funds for the Central Universities.
Yubo Zhang, Yuchen Pan, Chen Gong, and Zhengyuan Xu are with Key Laboratory of Wireless-Optical Communications,
Chinese Academy of Sciences, University of Science and Technology of China, Hefei, Anhui 230027, China. Email:
fzyb170057,ycpan g@mail.ustc.edu.cn; fcgong821,xuzy g@ustc.edu.cn.
Beiyuan Liu is with the National Engineering Laboratory for Integrated Aero-Space-Ground-Ocean Big Data Application
Technology, Northwestern Polytechnical University, Xi’an, Shaanxi 710072, China. Email: lby@nwpu.edu.cn.
April 26, 2023 DRAFTarXiv:2304.12804v1  [cs.IT]  25 Apr 20232
I. I NTRODUCTIONS
NLOS optical wireless scattering communication (OWC) is an effective supplement of conventional
wireless communication when perfect alignment and no blockage between the transmitter and receiver
cannot be guaranteed [1]. In fact, OWC is attracting more and more attention because of its potential large
bandwidth and capacity [2], [3]. An advantage of NLOS OWC is that it can adapt to the environment
requiring radio silence or with strong electromagnetic interference. Moreover, considering the large
attenuation in the atmosphere [4], it’s helpful to limit the communication in a certain area, if higher
communication security is desirable.
Due to high atmospheric attenuation of UV spectrum, a photon-counting receiver is adopted, where
the received signal arrives in the form of discrete photoelectrons, yielding a Poisson distribution. In
fact, UV communication and its channel characteristics have been demonstrated experimentally in [5]–
[8]. As a stochastic process, the transmission path of each photon is modeled by Monte-Carlo method.
The analytical approximation of Monte-Carlo method is investigated in [9], [10], and the corresponding
semi-analytical modeling has also been extensively studied [11]–[13]. Works [14], [15] have evaluated the
signal detection performance of PMT based receiver. The capacity of multiple-input single-output (MISO)
Poisson channel [16] and multiple-input multiple-output (MIMO) Poisson channel [17] are investigated.
Work in [18] analyzes the capacity region under power limitations for multiple access Poisson channel.
The achievable rates and signal detection of none-orthogonal multiple-access (NOMA) and code-division
multiple-access (CDMA) multi-user Poisson channel are analyzed in [19], while the transmission schemes
of multiple access uplink channel are illustrated in [20], [21]. For Poisson broadcast channel, [22], [23]
shows the performance of superposition coding in the downlink channel, while the degraded Poisson
broadcast channel is analyzed in [24].
Channel estimation is crucial for the subsequent signal detection and performance analysis. Works in
[14], [25] address the Poisson channel parameters estimation based on least-square (LS) criterion and
evaluate the MSE. The channel estimation based on multiple channels correlation is proposed in [26],
while blind and semi-blind estimation based on Poisson channel is studied in [27]. Moreover, existing
works have explored the signal detection of scattering communication. The detection criterion analysis
is given in [28], [29], while the works relevant to signal detection under relay transmission are shown in
[30], [31].
Up to now, works on space division ultraviolet multiuser system are in a quite limited number.
An optimal beamforming design of indoor UV power-constrained multiuser communication with space
division is proposed in [32]. Works in [33] perform a joint design of precoder and equalizer for MIMO
April 26, 2023 DRAFT3
UV systems with pulse amplitude modulation (PAM). An interference cancellation aided pulse position
modulation (PPM) scheme with spatial diversity and multiplexing over Poisson channels is proposed in
[34]. Works in [35] consider the spatial-multiplexing solution to reach high bit rate under Poisson MIMO
communication. As for signal detection, a suboptimal multiple-symbol detection method with equal
gain combined statistics under Poisson MIMO channels is constructed in [36], while [37] investigates
the detection performance of zero-forcing (ZF), MMSE and maximum-likelihood sequence estimation
(MLSE) receivers with spatial multiplexing over MIMO UV channels. To our very knowledge, none of the
previous works systematically analyze the channel estimation and signal detection under OOK-modulated
uplink-UV multiuser system.
In fact, the idea of this paper is mainly illustrated by the issue of multiuser detection and seperation
under a broad receiving FOV over UV uplink channels. PMT is selected as a detector because of its
high detection sensitivity, but the FOV of a single PMT is quite narrow. Thus, a PMT array is adopted
to meet the demand of broad FOV and its space division characteristics can be utilized. There are
two main problems for ML detection under our system model. Firstly, the complexity of detection and
performance analysis is too high with multiple users and receiving sectors. Secondly, ML detection rule
is quite sensitive to the imperfect estimation of channel gain parameters. To circumvent these problems,
a new detection method with lower complexity and tractable performance analysis is expected to be
provided. Moreover, an accurate multiuser channel estimation scheme should be proposed to facilitate
the signal detection. Under the slow fading assumption, we hope to accomplish the estimation with a
pilot matrix before signal detection.
The contributions of this work can be summarized as follows. We adopt the balanced structure on the
pilot matrix, analyze the channel estimation MSE, and optimize the structure parameters. We analyze the
separability of two users based on the Gaussian approximation of Poisson weighted sum. An analytical
threshold detection rule is proposed, and the linear weights as well as the threshold on the signal
detection are optimized. The sensitivity analysis of channel estimation error on two-user signal detection
is performed. Moreover, we propose a successive elimination method for OOK-modulated multiuser
detection under inter-user interference (IUI) based on the previous threshold detection rule. A closed-form
upper bound on the detection error probability is calculated, which turns out to be a good approximation
of that of multiuser ML detection. The proposed successive elimination method is twenty times faster
than the ML detection with negligible detection error degradation.
The remainder of this paper is organized as follows. In Section II, we introduce the space division
receiver and construct an analytical signal model with LS channel estimation. In Section III, we propose
the balanced pilot matrix design and analyze the channel estimation distortion. In Section IV , we
April 26, 2023 DRAFT4
investigate the space division of two-user case, propose the optimal threshold detection method and
analyze the sensitivity. In Section V , we propose a successive elimination signal detection approach with
unknown IUI for the general multiuser detection, and provide a closed-form upper bound on the detection
error probability. Numerical results are given in Section VI. Finally, Section VII concludes this work.
II. S YSTEM MODEL
A. Model of Multiuser Space Division Receiver
In the system, each user has one UV LED as a transmitter. Consider a UV communication network
with multiple users and a receiver with multiple PMTs forming an array, where PMT detector is adopted
due to its high detection sensitivity in the photon-counting regime. Fig. 1 shows the three-dimensional
structure of a PMT array.
Fig. 1: The 3D structure of a space division receiver.
Assume that there are Kusers and an array with MPMTs as a space division receiver. To make the
system model more comprehensible, Fig. 2 shows the planar graph of a space division multiuser uplink
system with K= 3 andM= 9.
Due to extremely large path loss of NLOS UV link, the received signal can be characterized by
discrete photoelectrons whose arrivals satisfy a Poisson random process. Denote the mean number of
arrival photons of the signal from user kto PMTmass(k;m), and that of background noise of PMT
masn(m), respectively. Assume that all users are sending OOK modulated signals. Letting Nk;m
denote the number of received photoelectrons at PMT mfrom userk, we have
P(Nk;m=njsk= 1) =(s(k;m) +n(m))n
n!e (s(k;m)+n(m));
P(Nk;m=njsk= 0) =(n(m))n
n!e n(m);
April 26, 2023 DRAFT5
Fig. 2: The system graph of a space division multiuser uplink system with K= 3 andM= 9 .
s(k;m) =mPkTs
k;mh;n(m) =n(m)Ts; (1)
wheremdenotes the quantum efﬁciency of PMT m,Pkdenotes the emitting power of user k,Tsdenotes
the symbol duration, and k;mdenotes the path loss from user kto PMTm.
The signals from multiple PMTs can be combined to improve the detection performance, expecially
under multiuser interference. Assume that (N1;:::;NM)are the photon numbers of MPMTs detected in
a symbol slot. In this work, we adopt the following linear combination,
W=MX
m=1mNm; (2)
wheref1;2;:::;Mgis the weight vector.
Based on Eq. (2), assuming independent photon arrivals at multiple receiving PMTs, the mean and
variance of Ware given as follows,
E(W) =MX
m=1mE(Nm) =MX
m=1mm;
April 26, 2023 DRAFT6
VAR (W) =E(W2) E2(W) =MX
m=12
mm: (3)
Note that weighted sum Wcan be approximated via a Gaussian dustributed variable, denoted as
WGN(E(W);VAR (W)). The accuracy of such approximation can be validated in Section VI.
B. LMMSE-based Multiuser Channel Estimation
In order to select the optimal signal detection method, channel parameters between all the users and
receiving PMTs should be accurately estimated. Suppose that KLestimation pilot matrix
X=0
BBBBBB@x1;1x1;2::: x 1;L
x2;1x2;2::: x 2;L
::: ::: ::: :::
xK;1xK;2::: xK;L1
CCCCCCA; (4)
is adopted for channel estimaiton, which is known to the receiver. It means that each user will send a
L-symbol length pilot sequence (For example, user 1sends (x1;1;x1;2;:::;x 1;L)). Assume that the channel
parameters from all users to PMT mare
sr(m) = [s(1;m);s(2;m);:::;s(K;m )]T: (5)
All the parameters shown in Eq. (5) can be estimated using the detected photon number of PMT min
Lsymbol durations, denoted as
um= [um(1);um(2);:::;um(L)]T: (6)
In fact, each element of umsatisﬁes Poisson distribution. Noting that the Poisson arrival intensity of
each symbol duration is inﬂuenced by Kusers simultaneously, we have that
P(um(l) =n) =(m(l))n
n!e (m(l));
m(l) =KX
k=1s(k;m)xk;l+n(m): (7)
Similar to [25], an unbiased channel estimator, denoted as ^sr(m), is given as follows,
^sr(m) = (XXT) 1X(um n(m)1); (8)
and the corresponding estimation MSE is given by,
Eksr(m) ^sr(m)k2=Tr((XXT) 1Xdiag(XTsr(m))XT(XXT) 1) +n(m)Tr((XXT) 1):
(9)
April 26, 2023 DRAFT7
III. C HANNEL ESTIMATION DESIGN FOR MULTIUSER SPACE DIVISION SYSTEM
A. Pilot Matrix Design Based on Balanced Structure
In the system, all the users’ signals are OOK modulated symbols. Let X= (x1;x2;:::;xL), where
eachxlis aK1colomn vector corresponding to the pilot symbols in slot l.
Balanced structure is adopted for the design of pilot matrix X, where each user sends with the same
frequency in a block. In our design, it’s expected that any Rusers selected from the whole Kusers
simultaneously appear with the same frequency for any k= 1;2;:::;K . To explain this property more
clearly, given matrix Xas shown in Eq. (4) and an index group  =f1;:::;Rg, deﬁne
X(),LX
l=1(RY
r=1x(r);l): (10)
Based on Eq. (10), for 8f1;2;:::;Kgwithkk0=Rfor any 1RK, it’s expected that X()
is only a function of R. MatrixXwill be considered to be a balanced structure if such a property is
satisﬁed.
Considering R, deﬁne matrix
X(R)= (x1;x2;:::;xCR
K); (11)
wherexiis aK1vector andkxik1=Rfor1iCR
K.CR
Kindicates the possible modes given
weightR. An example is given as follows for K= 4 andR= 2,
X(2)=0
BBBBBB@1 1 1 0 0 0
1 0 0 1 1 0
0 1 0 1 0 1
0 0 1 0 1 11
CCCCCCA: (12)
Based on the above deﬁnition, deﬁne group as the set of matrix generated via column concatenation
of matrices infX(1);X(2);:::;X(K)gwith totally 2K 1elements. Speciﬁcally, we let
=1[2[:::[K;
1=fX(1);X(2);:::;X(K)g;
2=f[X(1);X(2)];[X(1);X(3)];:::;[X(K 1);X(K)]g;
::::::
K 1=f[X(2);X(3);:::;X(K)];[X(1);X(3);:::;X(K)];:::;[X(1);X(2);:::;X(K 1)]g;
K=f[X(1);X(2);:::X(K)]g; (13)
April 26, 2023 DRAFT8
jj=KX
i=1jij=KX
i=1Ci
K= 2K 1: (14)
We have the following results on all matrices in .
Theorem 1. For8X2and8f1;2;:::;Kg, whilekk0=Rfor any 1RK,X()is only
a function of R.
Proof. For any index group =f1;:::;Sgf 1;2;:::;Kg, let
X= (X(1);X(2);:::;X(S)): (15)
EachX(s)is deﬁned by Eq. (11). Obviously, X2and the colomn number of XisM() =
PS
s=1Cs
K. Deﬁne
n
k
=8
><
>:Ck
n;0kn;
0;otherwise:
Considering any index group f1;:::;Kgwithkk0=R, according to Eq. (10), we have
X() =M()X
l=1(RY
r=1x(r);l) =SX
s=1Ci
KX
h=1j(RY
r=1xs
(r);h)j=SX
s=1K R
s R
: (16)
It can be seen that X() is only a function of Rfor8R2f1;:::;Kg.
B. Objective Function Calculation From MSE Expression
Considering the estimation of sr(m) = [s(1;m);s(2;m);:::;s(K;m )]using the detected photon
numbers of PMT m. Based on Eq. (9), assuming known background noise intensity n(m). Denote
ksr(m)k1as the element-wise ﬁrst-order norm of sr(m)as the channel gain parameters from K
users to PMT m. Considering pilot matrix Xwith balanced structure, we have the following preliminary
results refer to Theorem 1.
Proposition 1. Consider pilot matrix
X=0
BBBBBB@x1;1x1;2::: x 1;L
x2;1x2;2::: x 2;L
::: ::: ::: :::
xK;1xK;2::: xK;L1
CCCCCCA; (17)
for8i1;i2;i32f1;2;:::;Kgandi16=i26=i3. It turns out that,
PL
l=1xi;l
L,a;PL
l=1xi1;lxi2;l
L,b;PL
l=1xi1;lxi2;lxi3;l
L,c; (18)
April 26, 2023 DRAFT9
are not related to speciﬁc values of i1,i2andi3.
Moreover, based on Eq. (16), if X=X^for^=f^1;:::;^Sg, we have
a=PS
s=1 K 1
^s 1
PS
s=1 K
^s; b=PS
s=1 K 2
^s 2
PS
s=1 K
^s; c=PS
s=1 K 3
^s 3
PS
s=1 K
^s: (19)
Theorem 2. The estimation MSE of sr(m)in Eq. (9), denoted as Fm(X), is given by
Fm(X) =n(m)K(1 b
a+(K 1)b)
L(a b)
+ksr(m)k1
L(a b)2
a+ (K 1)b+(2 K)b2 2ab
(a+ (K 1)b)2(a+ 3b(K 1) +c(K 1)(K 2))
; (20)
wherea,bandcare given by Eq. (19).
Proof. See Appendix A.
The optimal pilot matrix design for the estimation of sr(m) = [s(1;m);s(2;m);:::;s(K;m )]is
formulated by solving the following problem,
min
XFm(X)
s:t:8f1;2;:::;Kg;kk0=R; X()is only a function of R: (21)
IV. A NALYSIS AND OPTIMIZATION OF THRESHOLD DETECTION : TWO-USERCASE
The multiuser signal detection will be performed after the channel estimation. Before investigating on
the general multiuser situation, we consider binary decision under two-user situation as a crucial basis.
Speciﬁcally, considering the problem of two-user separation via a PMT array, we propose signal detection
with a linear weighted sum. Threshold detection rule is adopted. An optimization problem on the weight
vector is proposed, and a tractable solution is obtained, based on which the detection threshold is derived.
Furthermore, the closed-form error analysis on the proposed method will be given. Finally, the sensitivity
analysis with respect to imperfect channel estimation is conducted.
A. Problem Formulation on Detection Error Minimization
Consider two users, user Aand userB, which are sending OOK modulated signal and each time only
one user is allowed to send. We aim to design a detection rule to help the receiver decide which user
is more likely to send signals. In this situation, the detection error rate equals the probability that the
receiver chooses a wrong user. Assume that the mean photon arrival numbers of desired signal components
from userAto theMPMTs are (s
a(1);:::;s
a(M)), the mean photon arrival numbers of desired signal
April 26, 2023 DRAFT10
components from user Bto theMPMTs are (s
b(1);:::;s
b(M)), and the mean photon arrival numbers
of background noise of MPMTs aren= (n(1);:::;n(M)). Denote that,
a(m) =s
a(m) +n(m);b(m) =s
b(m) +n(m); m= 1;:::;M: (22)
st(a) = (a(1);:::;a(M));st(b) = (b(1);:::;b(M)) (23)
Assume that the pulse numbers of all the MPMTs corresponding to user Awithin a symbol duration
are(Na;1;:::;Na;M), and those for user Bare(Nb;1;:::;Nb;M). LettingfmgM
m=1denote the weights,
the weighted sums are given by
WA=MX
m=1mNa;m; WB=MX
m=1mNb;m: (24)
Gaussian approximations of WAandWBare introduced, denoted as WAN (a;2
a)andWB
N(b;2
b), respectively. According to Eq. (3), we have
a=MX
m=1ma(m); b=MX
m=1mb(m);
2
a=MX
m=12
ma(m); 2
b=MX
m=12
mb(m): (25)
Assume prior probability p(a= 1) =p(b= 1) = 0:5. Since weight vector can be adjusted, without
loss of generality, assume that ab. Then, the detection error pobability with detection threshold th,
denoted aspe, is given by,
pe=1
2Zth
 11p
2ae (x a)2
22adx
+1
2Z+1
th1p
2be (x b)2
22
bdx
: (26)
Based on Eq. (26), the optimal detection threshold, denoted as ^th, is given by
^th=abq
(a b)2+ 2(2a 2
b) lna
b+2
ab 2
ba
2a 2
b: (27)
Based on the above threshold, the detection error based on Gaussian approximation is given as follows,
pe=1
2
Qa ^th
a
+Q^th b
b
; (28)
whereQ()denotes Gaussian Q-function. Let V(A) =a ^th
aandV(B) =^th b
b. We have the following
V(A) =b(a b)r
1 +2(2
a 2
b) lna
b
(a b)2+a(b a)
2a 2
b: (29)
Considering the scenario with large sands=n, we have
[2(2
a 2
b) lna
b
(a b)2]2=O( 2
s)1: (30)
April 26, 2023 DRAFT11
Sincep
1 +X1 +1
2XwhenX1, we have
V(A)(b a)(a b) +b(2
a 2
b) lna
b
a b
2a 2
b= a b
a+b+blna
b
a b: (31)
Similar approximation holds for V(F), given by
V(B) a b
a+b+blna
b
a b: (32)
The detection error can be approximated as follows,
peQa b
a+b
: (33)
We aim to maximizea b
a+b, which can be written as follows according to Eq. (25).
Div(;st(a);st(b)) =PM
m=1m(a(m) b(m))qPM
m=12ma(m) +qPM
m=12mb(m): (34)
Notice that Eq. (34) is a homogeneous function to . Without loss of generality, with constraint kk= 1,
an optimization problem is proposed,
max
Div(;st(a);st(b));
s:tkk= 1: (35)
B. Optimal Design Based On Objective Function
Due to complicated form of the denominator, maximizing Div(;st(a);st(b))is intractable. We
resort to maximizing a lower bound. Since
vuutMX
m=12ma(m) +vuutMX
m=12mb(m)p
2vuutMX
m=12m(a(m) +b(m)); (36)
a lower bound on Div(;st(a);st(b)), denoted as DivLB(;st(a);st(b)), is given by
DivLB(;st(a);st(b)) =PM
m=1m(a(m) b(m))qPM
m=12m(a(m) +b(m)): (37)
The optimization problem can be transformed to maximizing the following lower bound,
max
(PM
m=1m(a(m) b(m)))2
PM
m=12m(a(m) +b(m));
s:tkk= 1: (38)
Based on Cauchy-Inequality, we have that,
(DivLB(;st(a);st(b)))2=(PM
m=1m(a(m) b(m)))2
PM
m=12m(a(m) +b(m))
April 26, 2023 DRAFT12
=(PM
m=1(mp
a(m) +b(m))(a(m) b(m)p
a(m)+b(m)))2
PM
m=1(mp
a(m) +b(m))2MX
m=1(a(m) b(m))2
a(m) +b(m): (39)
The equality holds if and only if,
8m;mp
a(m) +b(m)
a(m) b(m)p
a(m)+b(m)=const; (40)
and one solution to the optimal weight coefﬁcients is given by
Km=a(m) b(m)
a(m) +b(m);^m=KmqPM
m0=1K2
m0; m= 1;:::;M: (41)
Based on Eq. (27) and Eq. (41), an optimal detection rule aiming to seperate two users can be proposed.
Denote an indicator function I, if userAis detected, I= 1, and if user Bis detected, I= 0. Assume
that the detected photon numbers are (N1;:::;NM). For certain threshold ^th, we have that,
MX
m=1^mNmI=0
7
I=1^th: (42)
C. Error Analysis Compared With ML Detection
Given the channel parameter vectors of user AandB, we can adopt Eq. (33) and Eq. (39) to obtain
the minimum detection error probability, denoted as pth
e(A;B), given by
pth
e(A;B) =pe(st(a);st(b)) =Qs
(a b)2
2(2a+2
b)
=QvuutMX
m=1(a(m) b(m))2
2(a(m) +b(m))
: (43)
Suppose that the received photon numbers of MPMTs are (N1;:::;NM). If ML detection is adopted
to two-user seperation problem, the detection rule and the error calculation are shown as follows,
QM
m=1(a(m))Nm
Nm!e a(m)
QM
m=1(b(m))Nm
Nm!e b(m)B
7
Ap(b)
p(a); (44)
pML
e(A;B) =+1X
N1;:::;NM=01
2minMY
m=1(a(m))Nm
Nm!e a(m);MY
m=1(b(m))Nm
Nm!e b(m)
: (45)
Here we assume p(a) =p(b) =1
2. It can be seen that the calculation of pML
e(A;B)is much more
complicated than that of pth
e(A;B). Moreover, the expression of pth
e(A;B)is more tractable, and the
simulation results show that pth
e(A;B)is pretty close to pML
e(A;B). Thus, we can greatly simplify the
performance evaluation procedure while maintaining the optimal behavior through threshold detection.
April 26, 2023 DRAFT13
D. Sensitivity Analysis of the Optimal Threshold Detection
The analysis of these part is based on Eq. (43). Since there exists inevitable channel estimation errors,
we aim to investigate the sensitivity of detection error probability to imperfect channel estimation. Let
Ga;b=vuutMX
m=1(a(m) b(m))2
2(a(m) +b(m)); (46)
whilepecan be expressed as follows,
pe=Z+1
Ga;b1p
2exp( x2
2)dt: (47)
Assume that the estimation bias occurs on a(m). Then, the absolute value of@pe
@a(m), which can
characterize the detection sensitivity, is shown as follows,
@pe
@a(m)=1p
2exp( Ga;b2
2)@Ga;b
@a(m)=1
2p
2Ga;bexp( Ga;b2
2)1 2
1 +a(m)
b(m)2:(48)
Denote that I1=1
2p
2Ga;bexp( Ga;b2
2)andI2=1 
2
1+a(m)
b(m)2. Lettingx=a(m)
b(m), obviously
we havex>0. Thus, we have,
f(x) = 1 2
1 +x2
; I2=jf(x)j; x> 0: (49)
Noting that f(x)is monotonically increasing with respect to x, we have
I2=jf(x)jmaxflim
x!0jf(x)j;lim
x!1jf(x)jg= 3: (50)
In this way, an upper bound IUB
2= 3 is raised up to facilitate further calculation, implying that the
detection error probability is not sensitive to imperfect estimation. Assume the following constraints on
st(a)andst(b), we have
MX
m=1(a(m) b(m))2C;
a(m)D;b(m)D;m = 1;:::;M: (51)
According to Eq. (46), a lower bound on Ga;bcan be calculated,
Ga;b=vuutMX
m=1(a(m) b(m))2
2(a(m) +b(m))sPM
m=1(a(m) b(m))2
4Dr
C
4D: (52)
Set thatGLB=q
C
4D. Assume that the detection error probabilities with and without perfect channel
estimation are p0andp1, respectively. Assume that a(m)2(0 ;0+ ) , while0is the precise
channel parameter and is the maximum estimation bias. We have the following results on the detection
sensitivity to channel estimation.
April 26, 2023 DRAFT14
Theorem 3. For any >0, there exists a constant K=3exp( C
8D)p
2C
D, such thatjp1 p0jKfor
8a(m)2(0 ;0+ ) .
Proof. Note thatp1is a function of a(m). Refer to the deﬁnition of integral, it’s apparent that,
jp1 p0j max
a(m)@pe
@a(m)
ja(m) 0j max
a(m)@pe
@a(m)
: (53)
Based on Eq. (48) and Eq. (50), the remaining work is to ﬁnd the upper bound on I1. Noting that I1
is decreasing with Ga;b, and a lower bound GLBcan be obtained based on power constraint and space
division constraint. According to Eq. (53), we have
jp1 p0j IUB
1IUB
2 =3
2p
2GLBexp( (GLB)2
2)  =3exp( C
8D)q
2C
D: (54)
Thus, letting K=3exp( C
8D)p
2C
D, the theorem is proved.
The above theorem indicates that once the constraints are satisﬁed, the system performance degradeness
caused by imperfect estimation will be bounded. Speciﬁcally, if two users are properly seperated and
obey the transmission power constraint, the system performance is not sensitive to imperfect channel
estimation.
V. S IGNAL DETECTION BASED ONSPACE DIVISION : GENERAL MULTIUSER CASE
In the previous Section, a preliminary threshold detection method aiming to seperate two users is
proposed. In fact, “two users” can also be treated as “two states”. Based on such idea and adopting the
previous method, we can further investigate the signal detection method of general multiuser system. It
turns out that similar to the method for two-user system, the proposed multiuser detection method also
facilitate the performance analysis with IUI.
A. Basic Settings
Assume that all channel link gains (channel parameters) are known to the receiver. For all MPMTs,
the detected pulse numbers within one symbol duration are given by N= (N1;N2;:::;NM). Assume
that userAis transmitting and its channel parameter vector is st(a) = (a(1);a(2);:::;a(M)). We
have that
P(Nm=k) =e a(m)(a(m))k
k!;8m2f1;2;:::;Mg: (55)
In order to simplify the expression, denote that
p(Njst(a)) =MY
m=1(a(m))Nm
Nm!e a(m): (56)
April 26, 2023 DRAFT15
For usersAandB, let
Pe(A;B) =1
2(Pe(AjB) +Pe(BjA)) (57)
denote the detection error probability between the two users based on equal prior probability p(A) =
p(B) =1
2.
For the multiple users situation, assume that the Kinterfering users are (B1;B2;:::;BK)with channel
parameterst(bk) = (bk(1);bk(2);:::;bk(M))for userBk. Assumep(a= 0) =p(a= 1) =1
2and
p(bk= 0) =p(bk= 1) =1
2fork= 1;:::;K . Moreover, denote the mean number of background noise for
PMT array as (n(1);:::;n(M)). Obviously there are totally 2Kcombinations of (b1;:::;bK), denoted
as modes ('1;:::;' 2K). In this way, the channel parameters of interfering signal can be simpliﬁed as
follows,
'(m) =KX
k=1b
kbk(m); m= 1;:::;M ;'= (b
1;b
2;:::;b
K): (58)
For user group (A;B 1;B2;:::;BK), letC= (C1;:::;C 2K)andD= (D1;:::;D 2K)denote the states
corresponding to a= 1 anda= 0, respectively, such that,
Ck(m) =a(m) +'k(m) +n(m); m= 1;:::;M; k = 1;:::;2K;
Dk(m) ='k(m) +n(m); m=1;:::;M; k = 1;:::;2K: (59)
B. ML Detection
Firstly, we turn to ML detection as a baseline method for multiuser detection. Still for user group
(A;B 1;B2;:::;BK), based on Eq. (59), the binary decision rule can be given as follows,
P2K
k=1QM
m=1(Ck(m))Nm
Nm!e Ck(m)
P2K
k=1QM
m=1(Dk(m))Nm
Nm!e Dk(m)a=0
7
a=1p(a= 0)
p(a= 1): (60)
Sincep(a= 0) =p(a= 1) =1
2, the ML detection error probability can be calculated as follows,
PML
e(A;B 1;:::;BK) =
+1X
N1;:::;NM=01
2K+1min2KX
k=1MY
m=1(Ck(m))Nm
Nm!e Ck(m);2KX
k=1MY
m=1(Dk(m))Nm
Nm!e Dk(m)
:(61)
The ML detection suffers a high computational complexity, especially when MorKbecomes larger.
It’s expected to develop a new detection approach with lower real-time computational complexiy and
tractable detection error analysis.
April 26, 2023 DRAFT16
C. Successive Elimination Method
A detection approach based on successive comparison and elimination is provided. The fundamental
thought is that the signal detection with inter-user interference can be achieved by selecting the most
likely state Ti0fromTusing threshold detection, leading to desirable symbol ^a. Instead of precisely
locating state Ti0, we need to know whether Ti0belongs to set CorD. Let
U(Ci;Dj;N) =MX
m=1m(Ci(m);Dj(m))Nm th(Ci;Dj); (62)
where threshold th(Ci;Dj)is given in Eq. (27). Based on the arguments in Section IV, if
U(Ci;Dj;N)>0,Ciis more likely than Dj, and vice versa. Recall the error analysis in the previous
sections, we have that,
Pth
e(Ci;Dj) =1
2(Pth
e(CijDj) +Pth
e(DjjCi))
=1
2
p(U(Ci;Dj;N)>0jDj) +p(U(Ci;Dj;N)<0jCi)
: (63)
In this way, a multiuser detection method based on successive elimination tactic can be proposed. Based
on two setsC=fCig2K
i=1andD=fDjg2K
j=1, the corresponding channel parameters can be given by
Eq. (59). With the detected photon numbers N, the signal detection can be performed. During Round
1, signal model C1is selected and compared with (D1;:::;D 2K)sequentially. If U(C1;Dj;N)>0,
then the corresponding Djwill be eliminated. As for C1, if there exists at least one Djsuch that
U(C1;Dj;N)<0,C1will be eliminated when Round 1is over. The surviving members of CandD
will enter Round 2and the same operations will be repeated. The procedure will be carried on until
eitherCorDbecomes empty. Obviously, if Cﬁnally becomes empty, detect ^a= 0. Otherwise, if D
becomes empty, detect ^a= 1.
Based on the proposed algorithm, we can propose a closed-form upper bound on the detection error
probability, denoted as Pth
e, which can be calculated by the channel parameters aforementioned.
Theorem 4. Assume that Kis the total users number, Mis the total PMT number, a(m)is the channel
parameter between the desired user Aandm-th PMT,'i(m)is the channel parameter summation
(considering the additiveness of Poisson distribution) between interfering users (B1;:::;BK)andm-th
PMT when interfering mode is 'i. This explanation also adapts to 'j(m).n(m)is the background
noise intensity of the m-th PMT. We have that,
Pth
e=1
2K2KX
i=12KX
j=1QvuutMX
m=1(a(m) +'i(m) 'j(m))2
2(a(m) +'i(m) +'j(m) + 2n(m))
: (64)
April 26, 2023 DRAFT17
Proof. DenoteN1=fNj^a(N) = 1gandN0=fNj^a(N) = 0g. We have
Pe=1
2X
N2N 1P(Nja= 0) +X
N2N 0P(Nja= 1)
=1
2K+12KX
i=1X
N2N 1P(NjDi) +2KX
i=1X
N2N 0P(NjCi)
: (65)
For eachi, we have,
X
N2N 0P(NjCi) = 1 X
N2N 1P(NjCi): (66)
Construct
NCi
1=fNj2K
\
j=1[U(Ci;Dj;N)>0]g: (67)
For allN2NCi
1, we have ^a= 1, thusNCi
1N 1. Then, we have
X
N2N 0P(NjCi) = 1 X
N2N 1P(NjCi)
1 X
N2NCi
1P(NjCi)
= 1 P(2K
\
j=1[U(Ci;Dj;N)>0jCi])
=P(2K
[
j=1[U(Ci;Dj;N)<0jCi])
2KX
j=1P(U(Ci;Dj;N)<0jCi) =2KX
j=1Pth
e(DjjCi): (68)
Based on Eq. (43), Eq. (57), Eq. (65) and Eq. (68), we have
Pe1
2K+12KX
i=12KX
j=1Pth
e(CijDj) +2KX
i=12KX
j=1Pth
e(DjjCi)
=1
2K2KX
i=12KX
j=11
2(Pth
e(CijDj) +Pth
e(DjjCi))
=1
2K2KX
i=12KX
j=1Pth
e(Ci;Dj)
=1
2K2KX
i=12KX
j=1QvuutMX
m=1(a(m) +'i(m) 'j(m))2
2(a(m) +'i(m) +'j(m) + 2n(m))
: (69)
Since the weight vectors and detection threshold can be calculated in an ofﬂine manner, the successive
elimination method shows lower real-time computational complexity, since M-order Poisson possibility
multiplication is replaced by a linear weighted sum.
April 26, 2023 DRAFT18
VI. N UMERICAL SIMULATION
A. Gaussian Approximation of Poisson Weighted Sum
We justify the approximation of Poisson weighted sum W(;)using the corresponding Gaussian
approximation WG(;). Assume that the space division receiver assembles three PMTs with a single
user. Set the mean number of photons for the three sectors as (1;2;3) = (10;15;20)and the weight
vector is randomly generated satisfying kk= 1. The PDF curves of W(;)andWG(;)are
depicted in Fig. 3, validating Gaussian approximation.
Fig. 3: The probability density function of Poisson weighted sum and its Gaussian approxiamtion.
B. Performance of Space Division Receiver: Two Users Seperation
In this Subsection, the separability of a two-user system will be tested. The elevation angle of each
transmitting LED and each receiving PMT is 30, and each LED is straight to the receiver. Assume that
the FOV angle of each PMT is 40and the full angular beamwidth of each LED is 60. In this way, the
3D transceiver structure can be shown in Fig. 4. Recall that the detailed division of azimuth angle ﬁeld
is shown in Fig. 2, while the radial distance between each user and the receiver is 100m. Monte-Carlo
simulations show that the Poisson-arriving signal from a single user can be depicted by three dominated
PMTs, thus leading to inevitable inter-user interference.
The detection error rate with respect to different angles of AandBis simulated. The performances
are analyzed from two different perspectives. Firstly, set the angle difference between AandB, which
April 26, 2023 DRAFT19
Fig. 4: The 3D space division transceiver structure.
is denoted as (A;B), to be 5, 10and 20((B) =(A) + (A;B)), and change (A)from
0to 120(FOV of three PMTs) with step 5. Fig. 5 depicts the detection error rates under different
(A). Both the radical distance of user A(r(A)) and userB(r(B)) are set to be 100m. It shows that a
larger (A;B)leads to a lower detection error rate. Moreover, there exists an obvious ﬂuctuation when
changing(A)from 0to 120, indicating that the error rate is lower when Alocates at the edge of a
FOV according to Fig. 2. To justify this phenomenon more accurately, we change (A)from 0to 40
with step 1, and ﬁx (A;B) = 8. The simulated detection error rate is shown in Fig. 6, proving that
the detection error rate with Alocating at the edge of a FOV is lower than that with Alocating at the
center of a FOV .
Then, to depict the relationship between detection error rate and (A;B)in detail, set the angle of
A((A)) to be 0, 20, 40and 60, and change (A;B)from 3to 20. Fig. 7 depicts the detection
error rates under different (A;B). It can be observed that the detection error rate will decrease as
angle difference (A;B)increases.
Finally, we evaluate the performance of the two-user detection method proposed in Section III. Fixing
(A;B) = 10and changing (A)from 0to120with step 1, we compare the detection error rate of
the proposed detection method with that of maximum-likelihood (ML) detection method. For comparison,
we also show the threshold detection with uniform weight ( 1=:::=M). As shown in Fig. 8, the
performance of proposed threshold detection method is close to that of ML detection, and signiﬁcantly
outperforms that of uniform weight, justifying the asymptotical optimality of the proposed method.
April 26, 2023 DRAFT20
Fig. 5: The detection error rate under different
(A).
Fig. 6: The detection error rate under different
(A)within a single PMT FOV .
Fig. 7: The detection error rate under different
(A;B).
Fig. 8: The comparison of two different threshold
detections and ML detection.
C. Performance of Channel Estimation Based On Pilot Matrix
In this Subsection, the accuracy of channel estimation based on pilot matrix designed in Sec-
tion III is demonstrated. Set K= 4 as the user number, and 3dominating PMTs providing
detected photon numbers. As for users’ azimuth angles, set 1= 30;2= 40;3= 50,
and4= 60. Monte-Carlo simulation shows that the photon arrival intensity between each
user and PMT1 are (1:0491;3:2533;9:6285;20:8329) . The parameters for PMT2 and PMT3 are
April 26, 2023 DRAFT21
(9:7798;3:1585;37:3374;22:3473) and(37:1711;43:1114;1:0340;1:0000) , respectively.
Considering the overhead problem, usually the length of pilot sequence should not be longer than several
hundreds. In the ﬁrst part simulation, the pilot sequence length varies from 100 to500 with step 100.
Moreover, for K= 4, there are 14types of basic patterns of pilot matrix ( X(4)is singular, thus excluded)
according to Eq. (13) (The deﬁnition of X(R)is shown in Eq. (12)). To verify the estimation accuracy,
the theoretical estimation MSE from Eq. (20) and the test MSE (Monte-Carlo simulation repeated 500
times) under each basic pattern are compared. Simulation shows that the basic pattern shown in Eq. (70),
denoted asXopt, achieves the lowest MSE. To verify its optimality, the estimation MSE under two other
patterns will be depicted, too. As shown in Fig. 9(a), Fig. 9(b) and Fig. 9(c), during the channel estimation
of PMT1, PMT2 and PMT3, the estimation MSE under pattern Xoptis always lower than those under
other two patterns with the same pilot length. Moreover, ﬁxed the basic pattern, the theoretical MSE is
quite close to the test MSE and both of them decrease as the length of pilot sequence increases, indicating
that the MSE calculation shown in Eq. (20) is feasible, and longer pilot sequence beneﬁts the channel
estimation.
Xopt=0
BBBBBB@1 0 0 0 1
0 1 0 0 1
0 0 1 0 1
0 0 0 1 11
CCCCCCA: (70)
Moreover, under basic settings aforementioned, we justify that the threshold detection error rate is not
sensitive to imperfect channel estimation, which conforms to the conclusions in Subsection IV-D.
Firstly, we perform channel estimation under all the 14basic patterns of pilot matrix ( K= 4;L= 100 )
according to Eq. (13), and perform the two-users division detection between user 1and user 2. The basic
pattern block is repeated multiple times until exceeding length 100, and then columns in the last block
are removed randomly to reduce the length to 100if necessary. We repeat the channel estimation for 500
times, and the estimated parameters are adopted to signal detection simulation (with a 108-length PRBS
OOK test sequence) and the detection error rate is obtained. Compared with the real channel parameters,
we calculate the estimation MSE, the mean absolute error (MAE) of estimation, and the mean symbol
detection error rate (SER) under each pilot matrix pattern. Denote Xi1;:::;ik= [X(i1);:::;X(ik)], while
X(i)is shown in Eq. (12). For instance, X1;2;4can be written as follows,
X1;2;4=0
BBBBBB@1 0 0 0 1 1 1 0 0 0 1
0 1 0 0 1 0 0 1 1 0 1
0 0 1 0 0 1 0 1 0 1 1
0 0 0 1 0 0 1 0 1 1 11
CCCCCCA: (71)
April 26, 2023 DRAFT22
(a) The MSE of channel parameters detected by PMT1.
 (b) The MSE of channel parameters detected by PMT2.
(c) The MSE of channel parameters detected by PMT3.
Fig. 9: The MSE of pilot matrix channel estimation.
The MSE, MAE and SER results are shown in Table I. As a comparison, the SER with perfect
channel estimation is 0:0522466 . It’s seen that with the balanced basic pattern design of pilot matrix, the
normalized estimation MSE/MAE is around 10 210 1, leading to only about 10 410 5increment
of the symbol detection error. Thus, under the balanced pilot matrix design, the detection performance
is not sensitive to imperfect channel estimation.
However, a large performance degradation may occur if a random pilot matrix design is chosen.
Speciﬁcally, when the length of pilot matrix ( L) is short (usually L<50), an ill-conditioned pilot matrix,
which can lead to large estimation error and detection error, is more likely to be constructed. To justify
this point, under each length L, we repeat random pilot matrix design for 1000 times and obtain the
worst detection SER and the corresponding MSE/MAE, and the performance of the optimal balanced
April 26, 2023 DRAFT23
TABLE I: Channel estimation and signal detection performance under different balanced basic pattern
of pilot matrix (K=4, L=100).
PatternIndexNormalized MSE Normalized MAE SER
X1;40.0658 0.0539 0.0522515
X20.0726 0.0593 0.0522547
X1;20.0738 0.0589 0.0522615
X10.0764 0.0607 0.0522687
X1;2;40.0817 0.0623 0.0522721
X1;2;30.0819 0.0636 0.0523509
X2;40.0892 0.0660 0.0523644
X1;30.0986 0.0691 0.0524071
X1;2;3;40.0988 0.0701 0.0524266
X2;30.0999 0.0707 0.0524789
X2;3;40.1028 0.0717 0.0525042
X1;3;40.1072 0.0726 0.0525576
X30.1430 0.0838 0.0525860
X3;40.1778 0.0923 0.0526244
pilot matrix (X1;4) is also shown. From Table II, it is seen that shorter Lleads to a worse detection
performance of random pilot matrix design, but that of the optimal balanced pilot matrix design only
has a little change ( 10 3). The performance difference between these two designs will decrease with a
largerL. In conclusion, when choosing a short pilot matrix aiming to decrease the overhead, we will
risk suffering a high estimation error and a high detection error rate if adopting the random pilot matrix
design. Thus, it’s beneﬁcial to choose the optimal balanced pilot matrix design.
TABLE II: Channel estimation and signal detection performance under the optimal balanced pilot
matrix and the random designed pilot matrix (K=4).
LIndexMSE(random) MAE(random) SER(random) MSE(opt) MAE(opt) SER(opt)
20 4.0252 8.9659 0.1195937 0.3261 0.2447 0.0533203
30 3.4445 5.6216 0.0925499 0.2203 0.1269 0.0528763
50 2.2872 4.9198 0.0791195 0.1369 0.0826 0.0525223
70 1.7522 2.6499 0.0622262 0.0915 0.0682 0.0523786
100 0.9241 1.7515 0.0593964 0.0682 0.0576 0.0522471
April 26, 2023 DRAFT24
D. Performance of Multiuser Signal Detection with IUI
We focus on the multiuser threshold detection performance with unknown IUI, and compare it to that
of ML detection. The signal detection with 1,2 and 3 interfering users is simulated. Different angle pairs
will be set to observe how the detection performance will change as users’ positions change.
For the scenario with two users, set r(A) = 100m;r(B) = 100m. We aim to test the detection error
rate with respect to different angle difference (A;B). Recall that we adopt 9sectors within the whole
angle ﬁeld. Fix (A) = 0and(A) = 20, and change (A;B)from 2to30. Fig. 10(a) and
Fig. 10(b) depict the detection error rate under different (A;B)for(A) = 0and(A) = 20,
respectively. It’s apparent that a larger angle difference between user Aand userBleads to a lower
detection error rate. By comparing the two ﬁgures, we ﬁnd that the desired user ( A) located at the
edge of a PMT FOV has a better detection performance than that at the center of a PMT FOV , which
conforms to the previous conclusion. Moreover, it’s seen that three lines, representing PML
e,Ptest
eand
Pth
e, are quite close to each other while maintaining PML
e<Ptest
e<Pth
e. It indicates that Pth
eis indeed an
excellent closed-form approximation of PML
e. In addition, the successive elimination method is proved
to be feasible since Ptest
eis also close to PML
e.
(a) The detection error rate with one interfering user when
(A) = 0.
(b) The detection error rate with one interfering user when
(A) = 20.
Fig. 10: The detection error rate with one interfering user.
Now we turn to three-users system (desired user A, interfering users B1andB2) and four-users system
(desired user A, interfering users B1,B2andB3). Set the distance between each user and the receiver
to100m. We aim to test the detection error rate with respect to different users position. For the three-
user system, set (A;B 1) = (B1;B2) =  2and change the value of 2; while for the three-user
April 26, 2023 DRAFT25
system, set (A;B 1) = (B1;B2) = (B2;B3) =  3and change the value of 3. Fig. 11 shows
the detection error rate with 1,2 and 3 interfering users. Obviously, a larger amount of interfering users
increases the detection error rate. It is shown that Pth
eis still an excellent closed-form approximation of
PML
e and the successive elimination method is still feasible.
Fig. 11: The detection error rate with multiple interfering users.
Finally, we consider three-user system, and compare the whole execution time of threshold detection
(tTH) with that of ML detection ( tML) via simulations. Fig. 12 depicts ratiotML
tTHunder different channel
conditions, showing that the proposed successive elimination method is nearly 20 times faster than ML
detection.
VII. CONCLUSION
We have addressed the channel estimation and signal detection via exploiting the space division
potential of ultraviolet scattering communication. We have optimized the pilot matrix to reduce the
MSE of the LS channel estimation. In order to characterize the space division in MAC system, we have
adopted Gaussian approximation on the Poisson weighted sum, and analyzed the separability of the two
users by the optimal threshold detection rule. We have also addressed the signal detection in the case
of multiple users based on the previous threshold detection rule, and proposed a successive elimination
method with a tractable closed-form expression of the upper bound on the detection error probability.
April 26, 2023 DRAFT26
Fig. 12: The execution time ratio of ML to the proposed successive elimination detection.
The computational complexity of the proposed approach is around twenty times lower than that of the
ML detection.
APPENDIX A
PROOF OF THEOREM 2
Recall that the unbiased estimation mean-square-error of m-th PMT with respect to pilot matrix XKL
is shown as follows,
MSEm(X) =Tr((XXT) 1Xdiag(XTsr(m))XT(XXT) 1) +n(m)Tr((XXT) 1);(72)
wheren(m)is the Poisson noise intensity of the m-th PMT, Kis total users number, and sr(m)is
the estimated channel parameters vector. Deﬁne KKidentity matrix as IandKKfull-one matrix
asE. According to Eq. (1), we have
XXT=L[(a b)I+bE]: (73)
Recalling that X= (x1;x2;:::;xL), and noting that each element of matrix Xis either 0 or 1, we have
LX
l=1kxlk2
1=LX
l=1KX
k=1xl;k+ 2X
1k1<k2Kxl;k1xl;k2
=aKL +bK(K 1)L:
LX
l=1kxlk3
1=LX
l=1KX
k=1xl;k+ 6X
1k1<k2Kxl;k1xl;k2+ 6X
1k1<k2<k3Kxl;k1xl;k2xl;k3
April 26, 2023 DRAFT27
=aKL + 3bK(K 1)L+cK(K 1)(K 2)L: (74)
Using Matrix Inverse Lemma, we have
(XXT) 1=1
L(a b)[I b
a+ (K 1)bE]: (75)
Based on the properties of matrix trace, we have
Tr((XXT) 1Xdiag(XTsr(m))XT(XXT) 1) =Tr(XT(XXT) 1(XXT) 1Xdiag(XTsr(m))):
(76)
Furthermore, we have
Q0= (XXT) 1(XXT) 1=1
L2(a b)2[I 2ab (2 K)b2
(a+ (K 1)b)2E] =Q
L2(a b)2: (77)
Then, we have
MSEm(X) =Tr((XTQ0X)diag(XTsr(m))) +n(m)Tr((XXT) 1): (78)
Moreover, we have
Tr((XXT) 1) =K
L(a b)(1 b
a+ (K 1)b): (79)
Considering term Tr((XTQ0X)diag(XTsr(m))), recalling
XKL= (x1;x2;:::;xL);sr(m) = (s(1;m);s(2;m);:::;s(K;m ))T; (80)
we have
Tr((XTQ0X)diag(XTsr(m))) =1
L2(a b)2LX
l=1xT
lQxlxT
l
sr(m): (81)
According to Eq. (77), to simplify the calculation, denoting Q=I+ E, we have that,
LX
l=1xT
lQxlxT
l=LX
l=1xT
l(I+ E)xlxT
l=LX
l=1xT
lIxlxT
l+ LX
l=1xT
lExlxT
l
=LX
l=1(KX
k=1x2
k;l)xT
l+ LX
l=1(KX
k=1xk;l)2xT
l: (82)
Deﬁne
q(k0) =LX
l=1(KX
k=1x2
k;l)xk0;l+ LX
l=1(KX
k=1xk;l)2xk0;l; k0= 1;2;:::;K: (83)
Due to user balanced structure for X, we have
q(1) =q(2) =:::=q(K),q: (84)
April 26, 2023 DRAFT28
To simplify the calculation of q, consider the summation of fq(j)g,
Kq=KX
k0=1q(k0) =LX
l=1(KX
k=1x2
k;l)(KX
k0=1xk0;l) + LX
l=1(KX
k=1xk;l)2(KX
k0=1xk0;l)
=LX
l=1(KX
k=1xk;l)(KX
k0=1xk0;l) + LX
l=1(KX
k=1xk;l)3=LX
l=1(KX
k=1xk;l)2+ LX
l=1(KX
k=1xk;l)3
=LX
l=1kxlk2
1+ LX
l=1kxlk3
1: (85)
Thus, we have
q=1
K(LX
l=1kxlk2
1+ LX
l=1kxlk3
1)
=aL+b(K 1)L+ (aL+ 3b(K 1)L+c(K 1)(K 2)L): (86)
Denote 1as aK1full-one vector, note that,
LX
l=1xT
lQxlxT
l
sr(m) =q1sr(m) =qksr(m)k1: (87)
Based on Eq. (78), Eq. (79), Eq. (81), Eq. (86) and Eq. (87), noting that  = 2ab (2 K)b2
(a+(K 1)b)2, we have
Fm(a;b;c ) =n(m)K(1 b
a+(K 1)b)
L(a b)
+ksr(m)k1
L(a b)2
a+ (K 1)b+(2 K)b2 2ab
(a+ (K 1)b)2(a+ 3b(K 1) +c(K 1)(K 2))
: (88)
REFERENCES
[1] Z. Xu and B. M. Sadler, “Ultraviolet communications: potential and state-of-the-art,” IEEE Communications Magazine ,
vol. 46, no. 5, pp. 67–73, 2008.
[2] H. Elgala, R. Mesleh, and H. Haas, “Indoor optical wireless communication: potential and state-of-the-art,” IEEE
Communications Magazine , vol. 49, no. 9, pp. 56–62, 2011.
[3] H. Ding, G. Chen, A. K. Majumdar, B. M. Sadler, and Z. Xu, “Modeling of non-line-of-sight ultraviolet scattering channels
for communication,” IEEE Journal on Selected Areas in Communications , vol. 27, no. 9, pp. 1535–1544, 2009.
[4] T. Y . Aung, S. Arya, and Y . H. Chung, “Performance dependence of non-line-of-sight ultraviolet communications on
atmospheric parameters of the ultraviolet channel,” Optics Communications , vol. 443, pp. 7–11, 2019.
[5] H. Xiao, Y . Zuo, J. Wu, H. Guo, and J. Lin, “Non-line-of-sight ultraviolet single-scatter propagation model,” Optics Express ,
vol. 19, no. 18, pp. 17 864–17 875, 2011.
[6] G. Chen, L. Liao, Z. Li, R. J. Drost, and B. M. Sadler, “Experimental and simulated evaluation of long distance nlos uv
communication,” in 2014 9th International Symposium on Communication Systems, Networks & Digital Sign (CSNDSP) .
IEEE, 2014, pp. 904–909.
[7] L. Liao, R. J. Drost, Z. Li, T. Lang, B. M. Sadler, and G. Chen, “Long-distance non-line-of-sight ultraviolet communication
channel analysis: experimentation and modelling,” IET Optoelectronics , vol. 9, no. 5, pp. 223–231, 2015.
April 26, 2023 DRAFT29
[8] D. K. Borah, V . R. Mareddy, and D. G. V oelz, “Single and double scattering event analysis for ultraviolet communication
channels,” Optics Express , vol. 29, no. 4, pp. 5327–5342, 2021.
[9] Z. Xu, H. Ding, B. M. Sadler, and G. Chen, “Analytical performance study of solar blind non-line-of-sight ultraviolet
short-range communication links,” Optics Letters , vol. 33, no. 16, pp. 1860–1862, 2008.
[10] L. Wang, Z. Xu, and B. M. Sadler, “Non-line-of-sight ultraviolet link loss in noncoplanar geometry,” Optics Letters , vol. 35,
no. 8, pp. 1263–1265, 2010.
[11] Y . Sun and Y . Zhan, “Closed-form impulse response model of non-line-of-sight single-scatter propagation,” JOSA A , vol. 33,
no. 4, pp. 752–757, 2016.
[12] R. J. Drost, T. J. Moore, and B. M. Sadler, “Ultraviolet scattering propagation modeling: analysis of path loss versus
range,” JOSA A , vol. 30, no. 11, pp. 2259–2265, 2013.
[13] T. Wu, J. Ma, P. Su, R. Yuan, and J. Cheng, “Modeling of short-range ultraviolet communication channel based on spherical
coordinate system,” IEEE Communications Letters , vol. 23, no. 2, pp. 242–245, 2019.
[14] C. Gong, X. Zhang, Z. Xu, and L. Hanzo, “Optical wireless scattering channel estimation for photon-counting and
photomultiplier tube receivers,” IEEE Transactions on Communications , vol. 64, no. 11, pp. 4749–4763, 2016.
[15] D. Zou, C. Gong, K. Wang, and Z. Xu, “Characterization on practical photon counting receiver in optical scattering
communication,” IEEE Transactions on Communications , vol. 67, no. 3, pp. 2203–2217, 2018.
[16] S. M. Haas and J. H. Shapiro, “Capacity of wireless optical communications,” IEEE Journal on Selected Areas in
Communications , vol. 21, no. 8, pp. 1346–1357, 2003.
[17] K. Chakraborty, S. Dey, and M. Franceschetti, “Outage capacity of MIMO Poisson fading channels,” IEEE Transactions
on Information Theory , vol. 54, no. 11, pp. 4887–4907, 2008.
[18] A. Lapidoth and S. Shamai, “The Poisson multiple-access channel,” IEEE Transactions on Information Theory , vol. 44,
no. 2, pp. 488–501, 1998.
[19] G. Wang, C. Gong, and Z. Xu, “Signal characterization for multiple access non-line of sight scattering communication,”
IEEE Transactions on Communications , vol. 66, no. 9, pp. 4138–4154, 2018.
[20] A. Chaaban, Z. Rezki, and M.-S. Alouini, “On the capacity of the intensity-modulation direct-detection optical broadcast
channel,” IEEE Transactions on Wireless Communications , vol. 15, no. 5, pp. 3114–3130, 2016.
[21] A. Chaaban, O. M. S. Al-Ebraheemy, T. Y . Al-Naffouri, and M.-S. Alouini, “Capacity bounds for the Gaussian IM-DD
optical multiple-access channel,” IEEE Transactions on Wireless Communications , vol. 16, no. 5, pp. 3328–3340, 2017.
[22] H. Kim, B. Nachman, and A. El Gamal, “Superposition coding is almost always optimal for the Poisson broadcast channel,”
IEEE Transactions on Information Theory , vol. 62, no. 4, pp. 1782–1794, 2016.
[23] C. Gong, Q. Gao, and Z. Xu, “Signal detection for superposition transmission protocols for optical wireless scattering
broadcast channel,” IEEE Transactions on Wireless Communications , vol. 17, no. 8, pp. 5480–5493, 2018.
[24] A. Sokolovsky and S. I. Bross, “Attainable error exponents for the Poisson broadcast channel with degraded message sets,”
IEEE Transactions on Information Theory , vol. 51, no. 1, pp. 364–374, 2005.
[25] C. Gong and Z. Xu, “Channel estimation and signal detection for optical wireless scattering communication with inter-
symbol interference,” IEEE Transactions on Wireless Communications , vol. 14, no. 10, pp. 5326–5337, 2015.
[26] B. Liu, C. Gong, J. Cheng, and Z. Xu, “Correlation-based LTI channel estimation for multi-wavelength optical scattering
NLOS communication,” IEEE Transactions on Communications , vol. 68, no. 3, pp. 1648–1661, 2019.
[27] B. Liu, C. Gong, J. Cheng, Z. Xu, and J. Liu, “Blind and Semi-Blind channel estimation/equalization for Poisson channels
in optical wireless scattering communication systems,” IEEE Transactions on Wireless Communications , vol. 21, no. 8, pp.
5930–5946, 2022.
April 26, 2023 DRAFT30
[28] N. D. Chatzidiamantis, G. K. Karagiannidis, and M. Uysal, “Generalized maximum-likelihood sequence detection for
photon-counting free space optical systems,” IEEE Transactions on Communications , vol. 58, no. 12, pp. 3381–3385,
2010.
[29] C. Gong and Z. Xu, “LMMSE SIMO receiver for short-range non-line-of-sight scattering communication,” IEEE
Transactions on Wireless Communications , vol. 14, no. 10, pp. 5338–5349, 2015.
[30] C. Gong, K. Wang, Z. Xu, and X. Wang, “On full-duplex relaying for optical wireless scattering communication with
on-off keying modulation,” IEEE Transactions on Wireless Communications , vol. 17, no. 4, pp. 2525–2538, 2018.
[31] M. H. Ardakani, A. R. Heidarpour, and M. Uysal, “Performance analysis of relay-assisted NLOS ultraviolet communications
over turbulence channels,” IEEE/OSA Journal of Optical Communications and Networking , vol. 9, no. 1, pp. 109–118,
2017.
[32] S. Arya and Y . H. Chung, “State-of-the-art ultraviolet multiuser indoor communication over power-constrained discrete-time
Poisson channels,” Optical Engineering , vol. 59, no. 10, pp. 106 106–106 106, 2020.
[33] H. Ge, X. Zhou, Y . Chen, J. Zhang, W. Ni, X. Wang, and L. Zheng, “Shot-noise-limited photon-counting precoding scheme
for MIMO ultraviolet communication in atmospheric turbulence,” Optics Express , vol. 31, no. 1, pp. 426–441, 2023.
[34] X. Zhou, D. Zhang, R. Zhang, and L. Hanzo, “A photon-counting spatial-diversity-and-multiplexing MIMO scheme for
Poisson atmospheric channels relying on Q-ary PPM,” Optics Express , vol. 20, no. 24, pp. 26 379–26 393, 2012.
[35] C. Abou-Rjeily, “Spatial multiplexing for photon-counting MIMO-FSO communication systems,” IEEE Transactions on
Wireless Communications , vol. 17, no. 9, pp. 5789–5803, 2018.
[36] M. L. Riediger, R. Schober, and L. Lampe, “Multiple-symbol detection for photon-counting MIMO free-space optical
communications,” IEEE Transactions on Wireless Communications , vol. 7, no. 12, pp. 5369–5379, 2008.
[37] A. Gupta and M. Brandt-Pearce, “Receiver design for shot noise limited MIMO FSO/UV communication systems,” in
2012 IEEE Globecom Workshops . IEEE, 2012, pp. 1183–1187.
April 26, 2023 DRAFT