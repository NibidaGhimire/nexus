Hybrid functionals for periodic systems
in the density functional tight-binding method
Tammo van der Heide,1Bálint Aradi,1Ben Hourahine,2Thomas Frauenheim,3, 4, 5and Thomas A. Niehaus6,∗
1Bremen Center for Computational Materials Science, University of Bremen, Bremen, Germany
2SUPA, Department of Physics, The University of Strathclyde, Glasgow, G4 0NG, United Kingdom
3Constructor University, School of Science, Campus Ring 1, Bremen, Germany
4Computational Science and Applied Research Institute (CSAR), 518110, Shenzhen, China
5Beijing Computational Science Research Center (CSRC), 100193, Beijing, China
6Univ Lyon, Université Claude Bernard Lyon 1, CNRS,
Institut Lumière Matière, F-69622, Villeurbanne, France
(Dated: June 26, 2023)
Screened range-separated hybrid (SRSH) functionals within generalized Kohn-Sham density functional the-
ory (GKS-DFT) have been shown to restore a general 1 /(rε)asymptotic decay of the electrostatic interaction
in dielectric environments. Major achievements of SRSH include an improved description of optical properties
of solids and correct prediction of polarization-induced fundamental gap renormalization in molecular crys-
tals. The density functional tight-binding method (DFTB) is an approximate DFT that bridges the gap between
first principles methods and empirical electronic structure schemes. While purely long-range corrected RSH
are already accessible within DFTB for molecular systems, this work generalizes the theoretical foundation
to also include screened range-separated hybrids, with conventional pure hybrid functionals as a special case.
The presented formulation and implementation is also valid for periodic boundary conditions (PBC) beyond
theΓ-point. To treat periodic Fock exchange and its integrable singularity in reciprocal space, we resort to
techniques successfully employed by DFT, in particular a truncated Coulomb operator and the minimum im-
age convention. Starting from the first principles Hartree-Fock operator, we derive suitable expressions for the
DFTB method, using standard integral approximations and their efficient implementation in the DFTB+ soft-
ware package. Convergence behavior is investigated and demonstrated for the polyacene series as well as two-
and three-dimensional materials. Benzene and pentacene molecular and crystalline systems show the correct
polarization-induced gap renormalization by SRSH-DFTB at heavily reduced computational cost compared to
first principles methods.
I. INTRODUCTION
As a semi-empirical method, density functional tight bind-
ing (DFTB) [1, 2] fills the gap between methods such as
Hartree-Fock [3, 4] or Kohn-Sham density functional theory
(DFT) [5, 6] and fully empirical force-fields in the domain of
computational chemistry, condensed matter physics and mate-
rials science. Its high ratio of accuracy to computational cost
renders DFTB well-suited for extended systems with large
unit cells or long timescale molecular dynamics (MD). Over
the last two decades, the original DFTB formalism by Seifert
et al. [1] has been expanded by a number of extensions, in-
cluding self-consistent charge SCC-DFTB [2] and its exten-
sion to third order DFTB3 [7], spin and spin-orbit interac-
tions [8], time dependent TD-DFTB [9], real-time rTD-DFTB
using propagation of the reduced one body density matrix and
Ehrenfest dynamics [10, 11], machine learning enhanced re-
pulsive potentials [12, 13] as well as non-equilibrium Green’s
function based electron transport [14].
For molecular calculations, range-separated hybrid func-
tionals (RSH) [15–19] which constitute a mixture of non-local
Fock like and (semi-)local exchange of DFT have been es-
tablished as standard technique to address the inherent elec-
tronic self-interaction error (SIE) [20] of DFT and restore
the piecewise-linear [21, 22] behavior of the exact exchange-
∗thomas.niehaus@univ-lyon1.frcorrelation functional between integer occupations. Niehaus
and Della Sala [23] generalized the DFTB formalism to non-
periodic long-range corrected hybrid functionals (LC-DFTB),
based on GKS-DFT and the density matrix as basic variable
in the expansion of the Kohn-Sham energy functional, which
was later implemented in the DFTB+ [24, 25] software pack-
age.
For periodically repeating structures, difficulties due to the
Coulomb singularity of Fock exchange initially prevented an
immediate and widespread adoption of hybrid functionals for
solids. The CRYSTAL [26] software package, based on the
work of Pisani and Dovesi [27], provided the first publicly
available implementation of periodic Fock exchange, paving
the way for making periodic hybrid functionals readily acces-
sible for solids. In recent years effort has been made to de-
velop reliable schemes for treating the singularity, including
pioneering work by Gygi and Baldereschi [28] who lifted the
singularity by introducing auxiliary functions, Spencer and
Alavi [29] resorting to a truncated Coulomb operator that is
relatively simple to implement and does not posses a singular-
ity in reciprocal space, and most recently Sundararaman and
Arias’ [30] analytical proof of Wigner-Seitz truncation as an
ideal method for regularizing the Coulomb potential in the ex-
change kernel.
General range-separated hybrid functional implementations
have been developed for plane-wave [31–35] and localized
numerical [36–38] or Gaussian-type [39–42] orbital based
DFT codes. Here we derive suitable expressions for the DFTBarXiv:2302.12771v2  [physics.comp-ph]  23 Jun 20232
method and implement a real-space formulation of periodic
Fock exchange in the DFTB+ software package. We com-
pare two algorithmic solutions that follow the footsteps of the
truncated Coulomb interaction (TCI) by Guidon et al. [41] as
well as the minimum image convention (MIC) by Tymczak
et al. [42] that utilizes the full, unscreened, Coulomb interac-
tion.
The present work is structured as follows. In Section II,
we outline the basic periodic hybrid-functional DFTB theory,
starting from the expansion of the total energy functional, de-
riving the periodic Fock exchange Hamiltonian within DFTB
(by imposing Born–von Kármán (BvK) periodic boundary
conditions for the density matrix of a finite mesh of k-points).
Section III translates the equations into a formulation that
is compatible with the neighbor list concept of DFTB+, and
additionally gives expressions optimized for Γ-point only k-
point sampling, enabling efficient simulation of large systems
with thousands of atoms. This Section also contains bench-
marks covering the scaling of the Γ-point implementation with
system size and the parallel performance of the k-point im-
plementation. Total energy and band-gap convergence behav-
ior is then investigated and demonstrated by Section IV for
the polyacene series, complemented by armchair graphene
nanoribbons, two-dimensional h-BN monolayers and GaAs
bulk in the Supplemental Material [43]. In Section V, benzene
and pentacene molecular and crystalline systems are shown to
exhibit the correct polarization-induced gap renormalization,
that occurs if the surrounding dielectric medium is properly
taken into account. We close this work with a summary of our
findings and by providing a brief outlook in Section VI.
We should note that the focus of the present work lies in
the theory and implementation of the method, rather than an
in-depth benchmarking of its accuracy. The latter will be the
topic of a forthcoming article.
II. THEORY
A. Periodic GKS-DFT formalism
In the following we outline the basic periodic KS-DFT for-
malism, including Fock exchange. This provides the notation
and forms the basis for the DFTB approach described in Sec-
tion II B. All quantities are given in atomic units throughout
and we will denote the crystal momentum as kandk′, while
real space lattice vectors are denoted as g,h,landm.
According to the Coulomb-attenuating method
(CAM) [18], based on pioneering works by Gill [44]
and Savin [45], the electron-electron interaction is partitioned
into short- and long-range contributions using the adiabatic
connection theorem [46]
1
r=1−(α+β)+βe−ωr
r| {z }
DFT+α+β(1−e−ωr)
r| {z }
HF, (1)
where the short-range part is handled by a modified purely
density functional, that ensures mutual error cancellation oflocal exchange and correlation, while the exact Fock exchange
enforces the correct asymptotic decay in the long-range limit.
The parameters α,βandωdetermine the fraction of global
and long-range exact Fock exchange, as well as the value
of the smooth range-separation function, which we have as-
sumed to be of Yukawa type.
Complementing the usual kinetic energy T0[ρ]of the auxil-
iary system of non-interacting electrons in GKS-DFT with the
classical Coulomb interaction EH[ρ](Hartree term), external
potential vext(r)and nuclear-repulsion energy ENN, the above
partitioning leads to the total energy expression per unit cell
(UC)
E[ρ] =T0[ρ]+1
NZ
vext(r)ρ(r)dr+EH[ρ]+ENN+EDFT
c
+[1−(α+β)]EDFT
x+αEHF
x+β(Eω,DFT
x,sr+Eω,HF
x,lr),
(2)
with Nthe total number of such cells in the crystal. This ex-
pression can be shortened by introducing the local part of the
xc-functional
Exc,loc[ρ]:= [1−(α+β)]EDFT
x+βEω,DFT
x,sr+EDFT
c.(3)
Note that Exc,loc[ρ] =Eα,β,ω
xc,loc[ρ], but we refrain from explic-
itly stating the additional parameter dependencies for brevity.
Expressing the individual contributions of Eq. (2) in terms of
orbitals ψik(r), with additional quantum number k, the total
energy reads
E=∑
kwk∑
ifikZ
ψ∗
ik(r)
−∆
2+vext(r)
ψik(r)dr
+N
2∑
k,k′wkwk′∑
i jfikfjk′ZZ|ψik(r)|2|ψjk′(r′)|2
|r−r′|drdr′
−N
4∑
k,k′wkwk′∑
i jfikfjk′ZZ
drdr′
×ψ∗
ik(r)ψjk′(r)α+βh
1−e−ω|r−r′|i
|r−r′|ψ∗
jk′(r′)ψik(r′)
+Exc,loc[ρ]+ENN. (4)
We describe a spin-unpolarized formalism for closed shell
systems, where the spin degrees of freedom have already been
summed up. The occupation of eigenstate iat crystal momen-
tumkis denoted as fik∈[0,2]. The number of states iis given
by the number of basis functions in the UC. We further intro-
duce weights wk, with normalization ∑kwk=1, that arise
from sampling the Brillouin zone by only selecting a subset
of all wave-vectors compatible with the BvK cell.
For a crystal that is invariant with respect to cell transla-
tions, the GKS-orbitals are expected to obey the Bloch theo-
rem and extend throughout the whole crystal. We introduce
Bloch-functions βk
µ(r), that emerge from a unitary transfor-
mation of the atomic orbitals φµ(r)for orbital µcentered on
an atom in the reference cell, when shifted by any real-space
lattice vector g:
βk
µ(r) =1√
N∑
gφµ(r−g)eik·g. (5)3
Expressing the wavefunctions as a linear combination of
crystalline orbitals leads to states that equally possess Bloch-
wave character, therefore satisfying the Bloch-condition
ψik(r+g) =ψik(r)eik·g
ψik(r) =∑
µcµi(k)βk
µ(r), (6)
with eigenvector coefficients cµi(k)attributed to orbital µand
eigenstate i. By exploiting the translational symmetry, ˆO(r+
g,r′+g) =ˆO(r,r′), of an operator ˆO, folding operations for
transitions from direct to reciprocal space (and vice versa) are
obtained:
Oµν(g) =⟨φµ(r−g)|ˆO|φν(r)⟩=Oνµ(−g) (7)
Oµν(k) =∑
gOµν(g)e−ik·g. (8)
The special case ˆO=1refers to the overlap matrix elements
Sµν. We introduce the convention that the real-space shifts
in the arguments of Hamiltonian and overlap refer to the first
orbital, while the second remains in the reference cell. In re-
ciprocal space, the density matrix is built from the eigenvector
coefficients and occupations
Pµν(k) =∑
ifikcµi(k)c∗
νi(k) (9)
Pµν(k) =∑
gPµν(g)e−ik·g(10)
Pµν(g) =∑
kwkPµν(k)eik·g, (11)
while transformations according to Eq. (7) and Eq. (8) apply.
For the two-electron, four-center integrals we resort to Mul-
liken’s notation and distinguish between an unscreened and
screened, long-range Coulomb kernel
 
φl
µφh
ν|φm
κφg
λ
:=ZZ
drdr′
×φ∗
µ(r−l)φν(r−h)1
|r−r′|φ∗
κ(r′−m)φλ(r′−g)(12)
 
φl
µφh
ν|φm
κφg
λlr,ω:=ZZ
drdr′
×φ∗
µ(r−l)φν(r−h)1−e−ω|r−r′|
|r−r′|φ∗
κ(r′−m)φλ(r′−g),
(13)
with shorthand notation φg
µ:=φµ(r−g). We represent the
total energy of Eq. (4) in terms of the new Bloch basis and
exploit the translational symmetry of an arbitrary (in general,
non-local) operator in direct space to choose the reference (ze-roth) cell and carry out a trivial lattice summation, resulting in
E=∑
kwk∑
µνhµν(k)Pνµ(k)+Exc,loc[ρ]+ENN
+1
2∑
kk′wkwk′∑
µνκλPνµ(k)Pλκ(k′)
×∑
ghmeik′(g−m) 
φ0
µφh
ν|φm
κφg
λ
eik·h
−1
4∑
kk′wkwk′∑
µνκλPνµ(k)Pλκ(k′)∑
ghme−ik′(m−h)
×h
α 
φ0
µφh
λ|φm
κφg
ν
+β 
φ0
µφh
λ|φm
κφg
νlr,ωi
eik·g.(14)
Here, hµν(k)refers to the one-electron integral matrix ele-
ments of the kinetic energy and external potential.
By applying the variational principle to Eq. (14) we obtain
the secular equation
∑
νcνi(k)
Hµν(k)−εiSµν(k)
=0,∀i (15)
withk-dependent Hamiltonian matrix elements
Hµν(k) =hµν(k)+∑
gvxc,loc
µν(g)e−ik·g
+∑
k′wk′∑
λκPλκ(k′)∑
ghmeik′(g−m)
× 
φ0
µφh
ν|φm
κφg
λ
eik·h
−1
2∑
k′wk′∑
λκPλκ(k′)∑
ghmeik·geik′(h−m)
×h
α 
φ0
µφh
λ|φm
κφg
ν
+β 
φ0
µφh
λ|φm
κφg
νlr,ωi
,(16)
where the local part of the exchange-correlation potential (i.e.,
the functional derivative of Exc,loc) is introduced as
vxc,loc
µν[ρ](g) =Z
φg
µ(r)∗vxc,loc[ρ](r)φ0
ν(r)dr. (17)
Bloch-functions are bases for the irreducible representa-
tions of the translation group and super-matrices in recipro-
cal space, such as Hµν(k), can be transformed into a block-
diagonal form by unitary transformation [47]. This gives rise
to an independent diagonalization of Eq. (15) for each differ-
ent k-point.
B. Density functional tight binding
In the following we outline the periodic RSH-DFTB for-
malism of second order in the energy expansion.
The minimal valence-only basis set {φµ}of atomic orbitals
entering the eigenfunction ansatz of Eq. (6) is obtained by per-
forming first principles RSH calculations for neutral and spin-
unpolarized pseudo-atoms, as described in Refs. 7 and 24.
We continue by approximating the local part of the exchange-
correlation functional, by expanding around the reference up4
to second order in the perturbation
Exc,loc[ρ0+δρ] =Exc,loc[ρ0]+1
NZ
vxc,loc[ρ0](r)δρ(r)dr
+1
2NZZ
fxc,loc[ρ0](r,r′)δρ(r)δρ(r′)drdr′+O(δρ3),
(18)
thus linearizing the exchange-correlation potential. The den-
sity matrix of Eq. (9) is decomposed into reference and per-
turbation, such that P=P(0)+∆P. Usually, the reference
P(0)=∑APAis constructed as a superposition of densities of
non-interacting atoms, where the sum runs over all atoms ( A)
in the unit cell. Representing Eq. (18) in the Bloch basis of
Eq. (6) then yields
Exc,loc[ρ]≈Exc,loc[ρ0]+∑
kwk∑
µν∆Pνµ(k)vxc,loc
µν(k)
+1
2∑
kk′wkwk′∑
µνκλ∆Pνµ(k)∆Pλκ(k′)
×∑
g′∑
ll′eik·g′eik′(l′−l)fxc,loc
µνκλ(0,g′,l,l′)
(19)
fxc,loc
µνκλ(g,g′,l,l′):=ZZ
drdr′
×φg
µ(r)∗φg′
ν(r)fxc,loc(r,r′)φl
κ(r′)∗φl′
λ(r′),
(20)
where the matrix elements of first and second functional
derivatives are denoted as vxc,loc
µν andfxc,loc
µνκλ, respectively.
We continue by inserting Eq. (19) into the original energy
functional of Eq. (14), leading to
E=∑
kwk∑
µνH(0)
µν(k)Pνµ(k)+E(2)
DFT+E(2)
HF+Erep,(21)
with Erepcovering all terms that solely depend on the refer-
ence density and E(2)
DFTandE(2)
HFbeing of second order in ∆P
E(2)
DFT=1
2∑
kk′wkwk′∑
µνλκ∆Pνµ(k)∆Pλκ(k′)∑
ghmeik·h
×eik′(g−m)h 
φ0
µφh
ν|φm
κφg
λ
+fxc,loc
µνκλ(0,h,m,g)i
(22)
E(2)
HF=αEx,fr+βEx,lr(23)
=−1
4∑
kk′wkwk′∑
µνλκ∆Pνµ(k)∆Pλκ(k′)∑
ghmeik·g
×h
α 
φ0
µφh
λ|φm
κφg
ν
+β 
φ0
µφh
λ|φm
κφg
νlr,ωi
eik′(h−m).
(24)
Further, Eq. (21) introduced the zeroth-order HamiltonianH(0)
µν(k), that is defined as follows
H(0)
µν(k):=hµν(k)+∑
gvxc,loc
µν[ρ0](g)eik·g
+∑
k′wk′∑
λκP(0)
λκ(k′)∑
ghmeik′(g−m)
× 
φ0
µφh
ν|φm
κφg
λ
eik·h
−1
2∑
k′wk′∑
λκP(0)
λκ(k′)∑
ghmeik·geik′(h−m)
×h
α 
φ0
µφh
λ|φm
κφg
ν
+β 
φ0
µφh
λ|φm
κφg
νlr,ωi
.(25)
As usual in the DFTB framework, we adopt the two-center
approximation and replace onsite-blocks in the Hamiltonian
by diagonal matrices with free atom eigen-energies, εfree
µ, en-
suring the correct limit on dissociation and leading to
H(0)
µν(g) =

εfree
µ µ=ν
H(0)
µν[ρA+ρB]µ∈A,ν∈B
0 else .(26)
ρA=ρA(r−g)andρB=ρB(r)denote atomic densities,
derived from appropriate pseudo-atom calculations. εfree
µ,
as well as the non-diagonal elements of Eq. (26), are ob-
tained from RSH-DFT calculations and latter stored for high-
symmetry orbital configurations as a function of distance be-
tween atoms AandBin Slater-Koster tables [48]. The matrix
elements H(0)
µν(k)are recovered by transforming according to
Eq. (8).
In line with conventional DFTB and as generalized to pe-
riodic boundary conditions, the repulsive energy is approxi-
mated by a sum of fast decaying pair potentials [49]
Erep=1
2UC
∑
A,B∑
gVAB
rep(RAB−g), (27)
either determined by a higher level of theory [7] or fitted to
empirical data [50]. The sums over atoms A,Bare restricted to
the reference unit cell, while an additional direct lattice sum g
also accounts for contributions of images in neighboring cells.
The term E(2)
DFT, defined in Eq. (22) is treated by applying
the Mulliken approximation
φ∗
µ(r)φν(r)≈1
2Sµν 
|φµ(r)|2+|φν(r)|2
(28)
to the four-center integrals
 
φl
µφh
ν|φm
λφg
κ
≈1
4Sµν(l−h)Sλκ(m−g)
×h 
φl
µφl
µ|φm
λφm
λ
+ 
φl
µφl
µ|φg
κφg
κ
+ 
φh
νφh
ν|φm
λφm
λ
+ 
φh
νφh
ν|φg
κφg
κi
(29)
=1
4Sµν(l−h)Sλκ(m−g)
×h
γµλ(l−m)+γµκ(l−g)
+γνλ(h−m)+γνκ(h−g)i
. (30)5
In line with the convention introduced by Eq. (7), the real-
space shifts in the arguments of γare associated with the first
orbital, while the second orbital remains in the central cell.
We follow the reasoning of conventional second-order DFTB,
by approximating the orbital products |φµ|2as exponentially
decaying spherically symmetric charge densities, leading to
three integral parameterizations
γfr
µν=γfr
AB(RAB) =τ3
Aτ3
B
(8π)2ZZ
drdr′
×e−τA|r−RA|1
|r−r′|+fxc,loc[ρ0]
e−τB|r′−RB|(31)
γfr,HF
µν=γfr,HF
AB(RAB) =τ3
Aτ3
B
(8π)2ZZ
drdr′
×e−τA|r−RA|1
|r−r′|e−τB|r′−RB|(32)
γlr,HF
µν=γlr,HF
AB(RAB) =τ3
Aτ3
B
(8π)2ZZ
drdr′
×e−τA|r−RA|1−e−ω|r−r′|
|r−r′|e−τB|r′−RB|, (33)
with analytical expressions [2, 24]. A distinction is made be-
tween screened long-range (lr) and unscreened full-range (fr)
kernels. The parameter τAis obtained from requiring RSH-
DFT and RSH-DFTB yield the same second derivative of the
total energy for an atom with respect to orbital occupation,
i.e., predicting the same chemical hardness [24]. A detailed
derivation is provided in Appendix A.
Now we have all the prerequisites to treat the semi-local
energy contribution E(2)
DFT. To this end we compute Mulliken
populations, qµ, of orbital µ
qµ=∑
kwk∑
νPµν(k)Sνµ(k) (34)
=∑
g∑
νPµν(g)Sνµ(g), (35)
evaluated in direct or reciprocal space. The net charges of
atom Aare obtained by comparing the populations with the
neutral atom ( ZA)
∆qA=∑
µ[A]∆qµ=qA−ZA. (36)
The final result is obtained by summing over all atoms A,B
in the unit cell and accounting for any periodic images of B,
as captured by the sum over direct lattice vectors gextending
throughout the crystal
E(2)
DFT=1
2UC
∑
A,B∑
gγfr
AB(g)∆qA∆qB. (37)
C. Periodic Fock exchange in DFTB
To complete the theoretical foundation of periodic RSH-
DFTB, the energy contributions due to the additional Fockterms require special treatment. We restrict the derivation to
the screened, long-range Coulomb kernel, since its full-range
counterpart is contained as the limiting case of a large value
of the range-separation parameter, ω.
Firstly, the (back) Fourier transformation of Eq. (11) is
identified in order to simplify the expression, leading to
Ex,lr=−1
4∑
kwk∑
µνλκ∑
ghl∆Pνµ(k)∆Pλκ(−l)
×
φ0
µφh
λ|φh+l
κφg
νlr,ω
eik·g,l:=m−h. (38)
We now apply the Mulliken approximation and arrive at an
expression that is compatible with the DFTB formalism
Ex,lr=−1
16∑
kwk∑
µνλκ∑
ghl∆Pνµ(k)∆Pλκ(−l)
Sλ µ(h)Sκν(l+h−g)h
γlr,HF
µν(−g)+γlr,HF
µκ(−h−l)
+γlr,HF
λν(h−g)+γlr,HF
λκ(−l)i
eik·g. (39)
For later implementation using a neighbor list, as discussed
in Section III A, it is advantageous to carry out an index shift
l−→g−h−lthat simplifies the arguments of the real-space
overlaps
Ex,lr=−1
16∑
kwk∑
µνλκ∑
ghl∆Pνµ(k)∆Pλκ(h−l−g)
Sλ µ(h)Sκν(l)h
γlr,HF
µν(−g)+γlr,HF
µκ(−g−l)
+γlr,HF
λν(h−g)+γlr,HF
λκ(h−l−g)i
eik·g. (40)
By applying the variational principle and writing the above ex-
pression with respect to the density matrices, the correspond-
ing ground-state Hamiltonian emerges as
∆Hx,lr
µν(k) =−1
8∑
λκ∑
ghl∆Pλκ(h−l−g)Sλ µ(h)Sκν(l)
×h
γlr,HF
µν(−g)+γlr,HF
µκ(−g−l)
+γlr,HF
λν(h−g)+γlr,HF
λκ(h−l−g)i
eik·g.(41)
This illustrates that the evaluation of the associated en-
ergy contribution becomes straightforward once the exchange
Hamiltonian ∆Hx,lr
µν(k)is available
Ex,lr=1
2∑
kwk∑
µν∆Hx,lr
µν(k)∆Pνµ(k). (42)
Deriving the energy and Hamiltonian for global Fock-like ex-
change, instead of a range-separated expression, simply re-
quires substituting γlr,HF
µν withγfr,HF
µν.
III. IMPLEMENTATION
The extension of the DFTB formalism, according to Sec-
tions II B and II C, requires modifications to a) the parameter-
ization suite skprogs [51] and b) the main DFTB+ [25] code.6
The newly developed routines are publicly available in a) the
main branch of the official repository and b) a pull request of
the respective development branch to the main branch of the
official repository [52], currently under code review by the
maintainers.
For the zeroth-order Hamiltonian construction, we gener-
alized the scheme of Lutsker and co-workers [24] to handle
global Hartree-Fock exchange in addition to the already avail-
able screened kernels. This enables pre-tabulation of the H(0)
andSmatrix elements for general CAM xc-functionals and
further includes a generalized scheme to determine the decay
constants according to Eq. (A12).
The central performance critical task of developing an effi-
cient implementation to construct the Fock exchange matrix,
as provided by Eq. (41), is based on the neighbor-list-based
design of DFTB+. This utilizes the sparsity [53] pattern in-
duced by the spatial decay of the real-space overlap matrix
elements in the Slater-Koster tables.
A. Neighbor list based algorithm
In order to re-formulate Eq. (41), utilizing the concept of
neighbor lists, we first introduce the notation ¯L∈N(M)
which refers to atom ¯Lbeing a neighbor of atom M, where
atom Mis located in the central cell but ¯Lcould be inside a
periodically repeated neighboring unit cell, with Lbeing the
corresponding atom in the central cell. In a similar fashion,
the atomic orbitals ¯λ[¯L]are not restricted to atoms in the cen-
tral cell, but the corresponding orbital in the central cell is
labeled as λ[L]. This enables us to drop the cell index of the
real-space overlap matrices, since they are implicitly included
for atoms located outside the central cell.
We also follow DFTB+ specific conventions, such that the
real-space shift of the overlap Srefers to its first index, in line
with the notation of Section II A, and in particular Eq. (7). The
same reasoning also applies to the real-space density matrix
elements. Let λdenote an orbital that is folded back into the
central cell from a periodic image, we may then write S¯λ µ=
Sλ µ(h), leading to
∆Hx,lr
µ[M]ν[N](k) =−1
8∑
¯L∈N(M)
¯K∈N(N)∑
¯λ[¯L]
¯κ[¯K]S¯λ µS¯κν∑
ge−ik·g∆P¯λ¯κ(g)
×h
γlr,HF
MN(g)+γlr,HF
M¯K(g)+γlr,HF
¯LN(g)+γlr,HF
¯L¯K(g)i
. (43)
Eq. (43) exploits the fact that, except in the case of shell-
resolved DFTB, the γ-functions depend only on the atomic
species and not the individual orbitals, i.e. γlr,HF
¯λ¯κ(g) =
γlr,HF
¯L¯K(g)with ¯λ[¯L]and¯κ[¯K]. Analytic expressions for atomic
forces, i.e. the negative derivative of Eq. (43) with respect to
the ion positions, have been derived and implemented as well.
Although the force expressions for the general k-point im-
plementation have already been validated against numerical
derivatives, their algorithmic optimization is subject to ongo-
ing development and the current implementation is of limited
use for production applications. However, optimized formsof Eq. (43) for calculations restricted to the Γ-point, including
the energy gradients, are provided in Section B.
So far, two of the three previously infinite lattice sum-
mations have been replaced by well-defined finite summa-
tions over the neighbor list, leaving the yet unbounded g-
summation to discuss.
Practical calculations employ a finite set of k-points to sam-
ple the first Brillouin zone, with Nkunit cells spanning the
BvK supercell. Restricting the Bloch basis to a finite BvK su-
percell leads to finite-size errors, since it is not complete with
respect to all possible wavevectors, k, of the infinite crystal.
The density matrix as introduced in Eq. (11) is by construction
BvK periodic: Pµν(g) =Pµν(g+G), withGdenoting a BvK
super-lattice vector. This, means it repeats at the boundaries
of the BvK supercell without a phase factor. As shown by
Irmler et al. [39], this artificial periodicity causes lattice sums
in the Fock exchange energy expression to diverge. We have
implemented two of the widespread schemes to remedy this
issue, namely a truncated Coulomb interaction [29] (TCI) and
an adaption of the minimum image convention (MIC) [42].
These enable a robust implementation of periodic Fock ex-
change. A more pleasant consequence of the BvK periodic-
ity is that the real-space formulation only requires Nkdensity
matrices, Pµν(g), to be kept in storage. This is because every
lattice shift, g, may be folded back into the central BvK cell.
B. Truncated Coulomb interaction
In RSH-DFTB, truncating the Coulomb kernel of the four-
center integrals is equivalent to limiting the range of the γ-
integrals
γTC
MN(r) =
γfr/lr,HF
MN (RMN) ifRMN<Rc
0 else, (44)
with an adjustable real-space cutoff radius Rc. To avoid inter-
actions with the neighboring BvK supercells in simple-cubic
systems, Spencer and Alavi [29] linked Rcto the number of k-
points (which determine the BvK supercell volume). A more
robust scheme for arbitrary lattice geometries, as implemented
in this work, is to determine the maximum radius of a sphere
that still fits within the BvK supercell [39].
During self-consistent cycles the geometry and therefore
also the γ-integrals do not change. Our implementation pre-
tabulates all non-vanishing γMN(RMN)within the cutoff sphere
to speed up the Hamiltonian construction.
C. Minimum image convention
Another way of preventing divergent lattice sums was sug-
gested by Tymczak et al. [42] by restricting the sum over
super-lattice vectors according to the minimum image con-
vention. Later, Irmler and co-workers [39] generalized this to
arbitrary k-points. In this scheme the Coulomb interaction is
unaltered and fully taken into account.7
We adopt this idea by restricting the argument of the density
matrix ∆Pµν(g)of Eq. (43), such that it does not involve or-
bitals outside its Wigner-Seitz cell. This naturally restricts the
g-summation which, depending on the size of the BvK cell, in
turn depends on the k-point sampling employed. To determine
the unit cells within the Wigner-Seitz cell of the BvK cell we
employ an algorithm that does not assume a specific lattice ge-
ometry and works for arbitrary (linearly independent) lattice
vectors.
D. Integral pre-screening
Regardless of whether the TCI or MIC algorithms are used,
integral pre-screening targeting the density and overlap matri-
ces has the potential to drastically reduce the computational
cost of constructing the exchange Hamiltonian.
In direct self-consistent-field [54, 55] calculations, the
Hamiltonian is often constructed iteratively. Following
Lutsker and co-workers [24], the linearity of the Hamiltonian
with respect to the density matrix allows representation of the
Hamiltonian at the n-th self-consistent iteration as a sum of the
Hamiltonian at the previous iteration ∆H(∆Pn−1)plus a cor-
rection ∆H(∆n(∆P)). The change in the density matrix with
respect to the previous iteration is denoted as ∆n(∆P), result-
ing in
∆H(∆Pn) =∆H(∆Pn−1+∆Pn−∆Pn−1
|{z}
∆n(∆P)) (45)
=∆H(∆Pn−1)+∆H(∆n(∆P)). (46)
This approach therefore exploits the rapid decay of ∆n(∆P)
with increasing cycles of self-consistency. During the Hamil-
tonian construction, matrix-matrix products of the form
Iµν
¯L¯K(g):=∑
¯λ[¯L]∑
¯κ[¯K]S¯λ µS¯κν∆n(∆P¯λ¯κ(g)) (47)
occur. The upper bound of Eq. (47) is provided by taking the
individual absolute values of the factors
Iµν
¯L¯K(g)≤∑
¯λ[¯L]∑
¯κ[¯K]|S¯λ µ||S¯κν||∆n(∆P¯λ¯κ(g))|
≤Smax
¯LMSmax
¯KN∆n(∆P)max∑
¯λ[¯L]∑
¯κ[¯K]1, (48)
where maximum estimates for the overlap
Smax
¯LM:=max ¯λ[¯L],µ[M](|S¯λ µ|) and density matrix
∆n(∆P)max:=maxg(|∆n(∆P(g))|)have been defined. If
Smax
¯LMSmax
¯KN∆n(∆P)max<εscreen , where the trivial summations
over orbitals ¯λ,¯κhave been absorbed by the integral screen-
ing parameter εscreen , the evaluation of the corresponding
diatomic sub-block of ∆H(∆n(∆P))is omitted. In preparation
for the evaluation of Eq. (43), all occurring S(∆P)S-products
are estimated and the terms requiring an explicit evaluation
are distributed to available processors (provided that a mes-
sage passing interface (MPI) parallelized version of DFTB+
is being used).E. Scaling with system size
While supercells of several hundreds of atoms are often
unattainable for proper long-range corrected hybrid function-
als within RSH-DFT, we demonstrate that such cases are
well within reach of RSH-DFTB, even on a single proces-
sor core and for relatively densely packed materials such as
GaAs. Figure 1 compares the total wall-clock time of a RSH-
DFTB Γ-point calculation using the LCY-PBE functional and
Yukawa type range-separation function, to a conventional
PBE-parameterized DFTB (referred to as PBE-DFTB) run.
GaAs is computationally challenging due to its large num-
ber of interacting neighbors. The computational cost of LCY-
PBE-DFTB turns out to be considerably higher than for con-
ventional PBE-DFTB. However, considering that the bench-
mark was performed on a single CPU core only, calculations
of large supercells with roughly 1000 atoms can be accom-
plished in reasonable time. The higher cost of LCY-PBE-
254128 250 432 686 1024
Number of atoms in GaAs supercell020406080100Wallclock time [min]
LCY-PBE-DFTB
f(x)=axb
b2.94
avg. SCC cycle
atomic forces
sum Hx build
PBE-DFTB
f(x)=axb
b3.24
LCY-PBE-DFTB
f(x)=axb
b2.94
avg. SCC cycle
atomic forces
sum Hx build
PBE-DFTB
f(x)=axb
b3.24
FIG. 1. Total wall-clock time of a RSH-DFTB Γ-point calcula-
tion with the LCY-PBE xc-functional, in comparison with conven-
tional PBE-DFTB, as performed on a single CPU core (AMD Ryzen
7 PRO 5850U). For LCY-PBE-DFTB, the total time spend on an av-
erage self-consistent cycle, the construction of the RSH contribution
to the total Hamiltonian and atomic force evaluation is indicated as
well. GaAs supercells are employed as model system. LCY-PBE-
DFTB exhibits slightly sub-cubic scaling, which might indicate that
the asymptotic limit is not yet reached.
DFTB mainly originates from three facts: a) the pre-tabulation
of all ˜γTC
MNto build the super-matrix ˜γTC(see Section B),
b) the actual time spend on constructing the Hamiltonian
of Eq. (B2) and c) a higher number of total self-consistency
steps, compared to traditional DFTB. Reason c) is expected,
since (semi-)local DFTB requires only self-consistency with
respect to the Mulliken populations, while RSH-DFTB in-
troduces terms that depend on the full density matrix. Its
self-consistency is with respect to the (real-space) matrices
∆Pµν(g). In other words, traditional DFTB mixes the in- and
out-put Mulliken populations to propagate the self-consistent
cycles, while RSH-DFTB mixes ∆Pµν(g), which proves to be
more challenging and leads in most cases to an increased num-8
ber of self-consistency steps, and therefore diagonalizations of
the total Hamiltonian.
F. Parallel performance
The relatively high cost of constructing the exchange
Hamiltonian in RSH-DFTB requires an efficient paralleliza-
tion of this step, in order to exploit modern computing in-
frastructures and HPC facilities. While Section III E already
demonstrated the suitability for large supercells, another com-
mon task is the calculation of smaller systems with a dense k-
point sampling. Figure 2 illustrates the parallel performance
for the energy evaluation of a primitive GaAs unit cell. The
100101102
Number of MPI processes100101102Wallclock time [min]
60708090100
Percentage parallel efficiency
perfect scalingperfect scaling
FIG. 2. Parallel performance of DFTB+, when performing range-
separated calculations beyond the Γ-point ( εscreen is set at 10−7a.u.).
The primitive GaAs unit cell, sampled by a 9 ×9×9 Monkhorst-Pack
k-point set, served as model system to obtain the (I/O time removed)
wall-clock time of the entire DFTB+ run (with one MPI process cor-
responding to one processor core). Up to about 100 cores the parallel
efficiency is excellent, however a slight change in slope due to incip-
ient inter-node communication between 20 and 30 cores is observed.
The parallel efficiency then decreases to about 50 −60% when fur-
ther increasing the core count. Considering the extremely small test
system of only two atoms, this saturation is expected. The employed
HPC provides nodes of two Intel Xeon E5-2690v4 CPUs (2.6 GHz,
14 cores each), resulting in 28 cores per node, whereas inter-node
communication is based on Intel’s Omni-Path network architecture.
scaling of the total wall-clock time with MPI processes is
quite satisfactory and only saturates from about 100 cores
onwards, for this system. One bottleneck that causes the
parallel efficiency to drop when exceeding this core count,
at least in the current implementation, concerns the mixing
of input and output density matrices in the self-consistency
loop of DFTB+, which is not yet MPI parallelized. This
also affects the memory consumption. For some mixers (e.g.
modified Broyden’s method [56]) the history of all previous
∆Pµν(g)is kept in storage, which becomes unfeasible for ex-
tremely dense k-point samplings or an unusual large number
of self-consistent steps to reach convergence. Fortunately,
mixing schemes with limited memory (e.g. modified Ander-son’s method [57]) are readily available within DFTB+.
IV . CONVERGENCE BEHA VIOR
A. Polyacene series
The important class of π-conjugated polymers has spawned
numerous successful candidates for devices like organic light-
emitting diodes (OLEDs) [58–60], organic field-effect tran-
sistors (OFETs) [61–63], polymer solar cells (PSCs) [64–66]
and the growing field of organic electronics in general. One
representative of this class is the C4n+2H2n+4 series, forming
the polyacene oligomers. We choose this linear molecular
chain due to its relevance as a previous benchmark system
for range-separated DFT. For many π-conjugated polymers
(semi-)local DFT fails to describe the bond length alterna-
tion (BLA) and band-gap correctly. While Hartree-Fock (HF)
overestimates BLA significantly, (semi-)local DFT is known
to underestimate it. In fact, Körzdörfer et al. [67] suggested
that the many-electron self-interaction error (MSIE) of HF
and DFT approaches correlate with the BLA error and MSIE
minimization is key (but not the only issue) to obtaining ac-
curate BLAs. These quasi one-dimensional systems with low
environmental screening also provide a stringent test for the
removal of the divergence in the exchange interaction. In ad-
dition, the polyacenes feature a well-defined finite molecular
limit, which can be used to verify the periodic RSH-DFTB
implementation proposed here.
Since (semi-)local DFTB is directly derived from DFT, it
also inherits its shortcomings. A particularly severe deficiency
of PBE-DFT(B) is that the polyacene series becomes metal-
lic for increasing chain length [68]. We employ the ob2-1-1
parameters [69], created for the purely long-range corrected
LCY-BNL functional, to demonstrate that our implementation
of periodic RSH-DFTB converges to the same, finite band-gap
as the already available non-periodic formalism. We provide
an estimate of the polyacene bandgap for the family of purely
long-range corrected functionals, as calculated by the FHI-
aims code [37, 38, 70] on the LC- ωPBE [71] level of theory
using intermediate basis settings and a range-separation pa-
rameter of ω=0.3a−1
0, yielding Egap=2.8eV [72]. Since the
specific LC-BNL functional is not yet available through FHI-
aims (release version 221103) [73], this value does not allow
for a quantitative comparison with results obtained by the ob2-
1-1 parameters, however, offers valuable guidance from first
principles. Figure 3 illustrates the convergence of the poly-
acene band-gap convergence for the present periodic Γ-point
and k-point implementation, in direct comparison to the non-
periodic case. The calculations are based on the (unrelaxed)
primitive unit cell of polyacene (k-point implementation), as
listed in Structure S1 of the Supplemental Material [43], and
supercells (the Γ-point implementation) built from it. In the
case of the non-periodic implementation, the supercells are
converted into clusters and properly passivated by additional
hydrogen atoms at the chain ends (bond-length of C-H units:
1.1Å). The k-point sampling 1 ×1×(2≤n≤100)is cho-
sen according to the Monkhorst-Pack [74] scheme, where the9
polyacene chain is oriented along the z-direction and vacuum
inserted in x- and y-direction. What immediately stands out
0 20 40 60 80 100
Number of k-points along chain direction0246810Gap [eV]
k-point implementation:
TCI MIC0 20 40 60 80 100Number of benzene rings in cluster/supercell
cluster-implementation
-implementation
FIG. 3. Band-gap convergence behavior of the periodic implemen-
tations ( Γ-point, TCI, MIC) for the polyacene series, in compari-
son with the non-periodic algorithm. In the limit of dense k-points
or large clusters/supercells, respectively, all implementations agree
(Egap=2.9eV).
is that all implementations converge towards the same Kohn-
Sham gap, which is an essential step in the validation [75] of
the present method. A closer look at the convergence behav-
ior of the general k-point implementations of the TCI and MIC
schemes reveals strong fluctuations of the band-gap for non-
convergent k-point samplings 1 ×1×n, where n≲20. These
fluctuations originate from artifacts in the band-structure and
can be avoided by either manually reducing the Coulomb trun-
cation cutoff in TCI or removing outer shells of unit cells in-
side the Wigner-Seitz cell of the BvK supercell in MIC. We
take the opportunity of this specific case to highlight the pit-
falls of periodic Fock exchange in RSH-DFT(B). Figure 4
explicitly shows two fully converged band-structures of Fig-
ure 3, demonstrating that not only the gap size, but also all
bands, calculated with TCI or MIC are virtually identical. Ad-
ditionally, a non-convergent band-structure, originating from
a density calculation with 1 ×1×6 k-point sampling is in-
cluded. For this choice of parameters the band-gap collapses
and individual bands exhibit an unphysical dispersion. Too
small a BvK supercell does not allow for a natural decay of
the density matrix, but rather introduces a spurious periodic-
ity as described in Section III A. The extent to which artifacts
of non-convergent calculations based on coarse k-point sam-
plings manifest themselves is system-specific. As an example
shown in Figure S1 of the Supplemental Material [43], arm-
chair graphene nanoribbons (AGNRs) turn out to be a much
more benign system and convergence is achieved rapidly. We
refer to Structures S3-S5 and Figures S2-S3 of the Supple-
mental Material [43] to obtain further investigations covering
two-dimensional h-BN monolayer and GaAs bulk.
B'
 B
k-path4
2
024681012Energy EEVBM [eV]
k-point sampling:
1x1x6 (TCI)
1x1x15 (TCI)
1x1x15 (MIC)FIG. 4. Band-structures of the primitive polyacene unit cell, aligned
at their respective valence band maximum (VBM). Fully converged
RSH-DFTB calculations, with 1 ×1×15 k-point sampling in the self-
consistent run that produced the ground-state density, performed in
the TCI and MIC scheme, are compared to a band-structure that ex-
hibits artifacts due to an insufficient truncation of the Coulomb inter-
action for small BvK supercells. The first Brillouin zone was sam-
pled between B′= (0.0,0.0,−0.5)andB= (0.0,0.0,+0.5).
B. Total energy convergence
The total energy is often considered to provide a solid indi-
cation of the convergence behavior of a system. In the liter-
ature [29, 39, 41] it is used for the sake of comparing imple-
mentations and to demonstrate convergence. However, this
measure proved to be unreliable in many cases with regard
to other properties, including band-gaps. We would therefore
like to point out that, at least for periodic RSH-DFTB, further
quantities of interest should also be considered when check-
ing convergence. Figure 5 illustrates that the absolute devia-
tion in the total energy and band-gap with respect to their fully
converged reference decreases at different rates, with slower
convergence of the band-gap. This phenomenon appears to be
independent of the dimensionality of the system and applies,
e.g., for three-dimensional GaAs bulk and two-dimensional
h-BN monolayer included in Figure 5. To obtain a fully con-
verged total energy and band-structure as reference, we em-
ployed a GaAs density calculation with a 20 ×20×20 and h-
BN monolayer calculation with 20 ×20×1 Monkhorst-Pack
k-point sampling respectively.
V . POLARIZATION-INDUCED GAP RENORMALIZATION
Renormalization of the fundamental band-gap in molecu-
lar crystals by electronic polarization [76] is of central impor-
tance for organic electronics [58–63] and photovoltaics [64–
66]. Going from the molecule in gas phase to a molecu-
lar crystal with relative dielectric constant ε∞(orientationally10
5678910 15 20
Number of k-points along each direction0.000.050.100.15
GaAs bulk
Egap (MIC)
Egap (TCI)
Egap (TCI')Etot (MIC)
Etot (TCI)
Etot (TCI')
345678910 20
Number of k-points along plane directions0.00.20.40.60.8
h-BN monolayer
Egap (MIC)
Egap (TCI)Etot (MIC)
Etot (TCI)
Convergence [eV]
FIG. 5. Absolute deviation in the total energy and band-gap with
respect to their fully converged reference. For periodic RSH-DFTB
calculations, the total energy of a system is empirically found to con-
verge more rapidly than the Kohn-Sham band-gap. For GaAs bulk
it was found that setting the TCI cutoff as half of the minimum lat-
tice vector norm (TCI′), the total energy and band-gap converge more
quickly when compared to the scheme described in Section III B. The
choice of coupling the TCI cutoff to the k-point sampling can there-
fore significantly influence the convergence behavior of a system.
averaged and ion-clamped) leads to shrinkage of the funda-
mental gap. This renders the resulting material well-suited
for practical applications that require reduced optical gaps.
Due to the electronic polarization of the crystalline dielectric
medium, the energy required to create a quasi-hole is reduced
compared to its molecular phase, whereas creating a quasi-
electron releases more energy [77]. In other words, the ion-
ization potential (IP) and electron affinity (EA) decrease and
increase respectively.
Today’s standard repertoire of exchange-correlation func-
tionals within DFT, including (semi-)local LDA/GGA as well
as global and range-separated hybrids [15], do not properly
treat long-range correlation effects and fail to describe the
aforementioned gap renormalization, even qualitatively [78].
While many-body perturbation theory, especially Hedin’s GW
approximation [79] to the electron’s self-energy, Σ, captures
these renormalization effects, only recent screened range-
separated hybrid functionals [77] include this effect at the con-
siderably cheaper level of DFT.
According to the general CAM partitioning of the electron-
electron interaction introduced by Eq. (1), the limiting behav-
ior of the long-range part, that we treat in an exact Fock-like
manner, is determined by the parameters αandβ. For small
distances as r→0, the α/rcontribution prevails, whereas
the limiting case of r→∞scales like (α+β)/r. In the gas
phase, the correct 1 /rasymptotic decay is obtained if the con-
dition α+β=1 is fulfilled. In fact this only represents the
special case of ε∞=1 and a generalization to arbitrary di-
electric environments with asymptotic potential of 1 /(ε∞r)
requires that α+β=1/ε∞. For the gas-phase fundamen-
tal gap to coincide with the HOMO-LUMO gap of general-ized Kohn-Sham RSH-DFT [80, 81], the Fock-like exchange
term is required to be asymptotically correct [82, 83] and
the range-separation parameter ωshould be tuned to obey
the ionization-potential (IP) theorem [21, 84–86]. We fol-
low Refaely-Abramson et al. [77] by non-empirically deter-
mining ω, through minimizing the function
J2(ω;α) =
εω,α
H,n+IPω,α
n2
+
εω,α
H,a+IPω,α
a2
(49)
for the gas-phase. Here εω,α
H,n,εω,α
H,adenote the energies as-
sociated with the HOMO of the neutral (n) and anionic (a)
systems, tuned to match the respective IP obtained from to-
tal energy differences as closely as possible. Additional fig-
ures outlining the optimization process are provided in Sec-
tion S4 of the Supplemental Material [43]. For the sake of
comparing our results with Ref. 77, we do not attempt to
optimize αfrom first principles, but rather chose α=0.2,
which proved to yield satisfactory results for small organic
molecules. The employed exchange-correlation functional is
CAMY-PBEh [87] (with Y indicating the range-separation
function is of Yukawa type). In order to consistently com-
pare the results obtained with our RSH-DFTB method, we re-
sort to the molecular and crystalline geometries of Ref. 77,
covering the prototypical conjugated molecules benzene and
pentacene. The same reasoning applies to the choice of the
scalar dielectric constant, which is also taken from the cited
reference. A full overview of the resulting functional parame-
terization, including the optimally tuned range-separation pa-
rameters ω, is provided in Table S2 of the Supplemental Ma-
terial [43]. To avoid time-consuming re-parameterization, the
generated Slater-Koster files are based on the ob2-1-1 [69] pa-
rameters, which are expected to perform well in combination
with long-range corrected functionals. Additionally, results
obtained by a slight modification to the ob2-1-1 parameters
are shown, this decreases the density compression radius of
the carbon species to a value of rdens
C=3.3a0. We refer to Ta-
ble S1 of the Supplemental Material [43] for a detailed listing
of the electronic parameterization. Figure 6 compares the fun-
damental gaps obtained using different levels of theory. The
PBE-DFTB calculations were carried out based on the pbc-0-
3 parameters [89]. Since the hydrogen and carbon electronic
structure of pbc-0-3 is virtually identical to mio-1-1 [90]—
the usual choice for biological or organic molecules within
second-order DFTB—only one of the two options is included
for comparison. In line with expectations, PBE-DFTB is un-
able to capture changes in the surrounding dielectric medium
and severely underestimates not only the molecular but even
the crystalline fundamental gap. In stark contrast, optimally
tuned screened range-separated hybrid (OT-SRSH) DFTB as
derived and implemented in this work captures the renormal-
ization phenomenon at least qualitatively. However, the gas-
phase HOMO is slightly too low in both systems, which also
affects the bulk phase due to the chosen crystalline gap align-
ment. To maintain comparability with Ref. 77, the crystalline
gap was aligned symmetrically around the middle of the re-
spective gas-phase gap. Quantitative agreement would re-
quire a more in depth re-parameterization, which is outside
the scope of this work. We emphasize that OT-SRSH-DFTB is11
Molecule Crystal10.0
7.5
5.0
2.5
0.02.5HOMO     Energy E [eV]     LUMOBenzene
Molecule Crystal7
6
5
4
3
2
Pentacene
OT-SRSH-DFTB (rdens
C=6.1a0)
OT-SRSH-DFTB (rdens
C=3.3a0)PBE-DFTB (pbc-0-3)
G0W0
FIG. 6. Fundamental gaps of gaseous and crystalline benzene and pentacene, as obtained by conventional PBE-DFTB and optimally tuned
screened range-separated hybrid functionals (OT-SRSH-DFTB), compared with G 0W0calculations. To maintain comparability with Ref. 77,
crystalline gaps were aligned to the middle of their respective gas-phase gap. G 0W0values were taken from Refs. 83 and 88 (gas-phase) and
Ref. 77 (bulk).
systematically extending the domain of accessible exchange-
correlation functionals within (periodic) DFTB by only intro-
ducing system-specific adjustable parameters. These are de-
termined from first principles in a well-founded tuning pro-
cess, rather than being subject to empirical fitting.
VI. SUMMARY AND OUTLOOK
We have derived, implemented and tested Hartree-Fock ex-
change in the density functional tight-binding (DFTB) method
for periodic systems beyond the Γ-point. By applying the
usual DFTB approximations to matrix elements of the Fock
exchange operator, we arrived at a real-space formulation of
the exchange Hamiltonian that allows for efficient implemen-
tation in the DFTB+ code. To avoid artifacts owing to the arti-
ficial Born–von Kármán periodicity of the density matrix, we
resort to either a truncated Coulomb interaction or a minimum
image convention. These two methods proved to converge to
the same limit, when coupled to accurate Brillouin zone sam-
plings. Scaling with system size and parallel performance of
the developed routines indicate that systems with thousands
of atoms are well within reach of RSH-DFTB and that com-
putational resources are exploited efficiently. Pre-screening
of products of density matrix and overlaps, in combination
with an iterative construction of the Hamiltonian allows us to
further reduce the computational cost. Convergence behaviorand the pitfalls of periodic RSH-DFTB are demonstrated for
the polyacene series, showing that periodic and non-periodic
implementations converge towards the same limits, and that
the total energy is often not a reliable indicator for the con-
vergence of other properties like the band-gap. In line with
G0W0calculations, screened RSH-DFTB shows the correct
polarization-induced gap renormalization in benzene and pen-
tacene molecular crystals, at a heavily reduced computational
cost compared to first principles methods.
An in-depth benchmarking of the accuracy of periodic
RSH-DFTB is currently subject of ongoing investigations and
will be the topic of a future article.
ACKNOWLEDGMENTS
T. v. d. H. and T. A. N. acknowledge financial support from
the German Research Foundation (DFG) through Grant No.
FR2833/76-1. The simulations were performed on the HPC
cluster Aether at the University of Bremen, financed by the
German Research Foundation (DFG) within the scope of
Zukunftskonzept 66 “Ambitioniert und agil”, Bremen (GZ
ZUK 66/1-2015).12
DATA A VAILABILITY
The data that supports the findings of this study are avail-
able within the article and its Supplemental Material [43].
Appendix A: Hubbard parameter of RSH-DFTB
In analogy to conventional DFTB, the Hubbard Uof RSH-
DFTB is derived by requiring its equality with RSH-DFT. Fur-
ther, the xc-kernel kernel fxc,locis assumed to vanish [24] for
off-site elements A̸=B, whereas the on-site elements A=B
cover the full exchange-correlation contributions and read as
lim
RAA→0γfr
AA(RAA) =5
16τA (A1)
lim
RAA→0γlr,HF
AA(RAA) =5
16τA−τ8
A
(τ2
A−ω2)4
×5τ6
A+15τ4
Aω2−5τ2
Aω4+ω6
16τ5
A−ω
.
(A2)
Note that, by definition, the function γfr,HF=limω→∞γlr,HFis
always contained in the results for the more general screened
Coulomb kernel. Since the Hubbard Uis obtained from a
single atom RSH-DFT calculation, the following conditions
apply
Sµν=δµν (A3)
γfr,HF
µν=γfr,HF
AA(A4)
H(0)
µν=δµνεfree(A5)
∑
µcµicµj=δi j. (A6)
By utilizing Eqs. (A3) to (A6), the total RSH-DFTB energy of
the single atom in terms of occupation numbers niis [24]
Eatom=∑
µPµµεfree
µ+1
2γfr
AA∑
µκ∆Pµµ∆Pκκ
−1
4
αγfr,HF
AA+βγlr,HF
AA
∑
µν∆Pµν∆Pµν (A7)
=1
2∑
i jninjγfr
AA−1
4∑
in2
i
αγfr,HF
AA+βγlr,HF
AA
+O(ni),
(A8)with terms linear in niindicated by O(ni). For the highest
occupied shell it holds that for nelectrons, equally distributed
over the shell, give an orbital occupation ni=n/dl, where the
shell degeneracy is dl=2l+1. Inserting dlinto Eq. (A8),
yields
Eatom=1
2γfr
AAn2−1
4
αγfr,HF
AA+βγlr,HF
AAn2
dl+O(n).(A9)
Calculating the second derivative of Eq. (A9) with respect to
the shell occupation nthen becomes straightforward:
∂2Eatom
∂n2=γfr
AA−1
21
2l+1
αγfr,HF
AA+βγlr,HF
AA
. (A10)
In practice, the Hubbard Uof RSH-DFT is obtained by nu-
merically calculating the second derivative of the eigenvalue
εA
HOAO of the highest occupied atomic orbital of species Awith
respect to its occupation nHOAO
URSH−DFT
A=∂εA
HOAO
∂nHOAO. (A11)
By enforcing URSH−DFTB !=URSH−DFT, we finally end up with
the Hubbard Uof RSH-DFTB
URSH−DFTB
A=5
16τA"
1−1
2(2l+1)(
α+β 
1−τ8
A+3τ6
Aω2−τ4
Aω4+1
5ω6τ2
A−16
5τ7
Aω
(τ2
A−ω2)4!)#
, (A12)
an equation that should be solved numerically to obtain the decay constant τA.13
Appendix B: Γ-point approximation
For periodic RSH-DFTB calculations that are restricted to
only the Γ-point, we resort to the TCI scheme exclusively.
In the Γ-point-only approximation, any phase factors vanish
and the g-summation of Eq. (43) is carried out in advance,
yielding new γ-integrals
˜γTC
MN=∑
gγTC
MN(g+l). (B1)
With γTC
MNtruncated spherically and the g-summation cover-
ing the entire crystal, the value of ˜γTC
MNeventually becomes
independent of the shift, l, which greatly facilitates the pre-
tabulation of ˜γTC
MNfor all element combinations.
From this we infer that the exchange Hamiltonian at the Γ-
point∆Hx,lr(Γ)can be constructed from matrix-matrix multi-
plications of dense overlap and density matrices
∆Hx,lr(Γ) =−1
8n
S(Γ)∆P(Γ)S(Γ)
⊙˜γTC
+ 
S(Γ)∆P(Γ)
⊙˜γTC
S(Γ)
+S(Γ) 
∆P(Γ)S(Γ)
⊙˜γTC
+S(Γ) 
∆P(Γ)⊙˜γTC
S(Γ)o
, (B2)
with ˜γTCdenoting a super-matrix with the same shape as S(Γ)
and∆P(Γ). Element-wise multiplication is indicated by ⊙,
i.e. the Hadamard product. Eq. (B2) is a direct generalization
of the non-periodic algorithm that is already implemented in
the DFTB+ [25] code. Establishing ˜γTCis straightforward as
all elements of the diatomic block between atoms MandN,
containing orbitals { µ[M],ν[N]}, takes the same value: ˜γTC
MN,i.e.˜γTC
µ[M]ν[N]=˜γTC
MN. This algorithmic solution is appealing,
since it is exact in the sense that no integral screening, as de-
scribed in Section III D, is required and since dense matrix-
matrix multiplications can be performed efficiently and are
easy to parallelize. A neighbor-list based algorithm for Γ-
point calculations that includes integral pre-screening is im-
plemented as well. However, for the systems so far tested,
we observed a significantly higher efficiency for the matrix-
multiplication based algorithm, therefore we refrain from dis-
cussing the list-based approach in detail.
Analogously to Eq. (B2), the total energy and its gradients,
i.e. atomic forces, can be expressed in a similar fashion
Ex,lr
Γ=−1
16n
S(Γ)∆P(Γ)S(Γ)
⊙˜γTC
+ 
S(Γ)∆P(Γ)
⊙˜γTC
S(Γ)
+S(Γ) 
∆P(Γ)S(Γ)
⊙˜γTC
+S(Γ) 
∆P(Γ)⊙˜γTC
S(Γ)o
∆P(Γ) (B3)
Fα
M=−∂Ex,lr
Γ
∂Rα
M(B4)
=1
2∑
µ[M]∑
N̸=M∑
ν[N](∂Rα
MSµν)
×
∆PS 
∆P⊙˜γTC
+ 
(∆PS)⊙˜γTC
∆Psym
νµ
+1
4∑
µ[M]∑
N̸=M∑
ν[N](∂Rα
M˜γTC
µν)
×h
(∆PS)⊤⊙(∆PS)+(S∆PS)⊙∆Pisym
νµ, (B5)
with Cartesian coordinates Rα
Mof atom M,α∈ {x,y,z}and
Asym=1
2(A+A⊤)denoting the symmetric part of matrix A.
[1] G. Seifert, H. Eschrig, and W. Bieger, Eine approximative Vari-
ante des LCAO-X αVerfahrens, Z. Phys. Chem 267, 529 (1986).
[2] M. Elstner, D. Porezag, G. Jungnickel, J. Elsner, M. Haugk,
T. Frauenheim, S. Suhai, and G. Seifert, Self-consistent-charge
density-functional tight-binding method for simulations of
complex materials properties, Phys. Rev. B 58, 7260 (1998).
[3] D. R. Hartree, The Wave Mechanics of an Atom with a Non-
Coulomb Central Field. Part I. Theory and Methods, Math.
Proc. Cambridge Philos. Soc. 24, 89–110 (1928).
[4] V . Fock, Näherungsmethode zur Lösung des quantenmecha-
nischen Mehrkörperproblems, Zeitschrift für Physik 61, 126
(1930).
[5] P. Hohenberg and W. Kohn, Inhomogeneous Electron Gas,
Phys. Rev. 136, B864 (1964).
[6] W. Kohn and L. J. Sham, Self-Consistent Equations Includ-
ing Exchange and Correlation Effects, Phys. Rev. 140, A1133
(1965).
[7] D. Porezag, T. Frauenheim, T. Köhler, G. Seifert, and
R. Kaschner, Construction of tight-binding-like potentials on
the basis of density-functional theory: Application to carbon,
Phys. Rev. B 51, 12947 (1995).
[8] C. Köhler, T. Frauenheim, B. Hourahine, G. Seifert, andM. Sternberg, Treatment of Collinear and Noncollinear Elec-
tron Spin within an Approximate Density Functional Based
Method, J. Phys. Chem. A 111, 5622 (2007), pMID: 17428041,
https://doi.org/10.1021/jp068802p.
[9] T. Niehaus, Approximate time-dependent density functional
theory, Journal of Molecular Structure: THEOCHEM 914, 38
(2009), time-dependent density-functional theory for molecules
and molecular solids.
[10] T. N. Todorov, Time-dependent tight binding, J. Phys.: Con-
dens. Matter 13, 10125 (2001).
[11] T. A. Niehaus, D. Heringer, B. Torralva, and T. Frauenheim,
Importance of electronic self-consistency in the TDDFT based
treatment of nonadiabatic molecular dynamics, Eur. Phys. J. D
35, 467 (2005).
[12] R. K. Lindsey, L. E. Fried, and N. Goldman, ChIMES: A Force
Matched Potential with Explicit Three-Body Interactions for
Molten Carbon, J. Chem. Theory Comput. 13, 6222 (2017),
pMID: 29113430, https://doi.org/10.1021/acs.jctc.7b00867.
[13] T. van der Heide, J. Kullgren, P. Broqvist, V . Ba ˇci´c, T. Frauen-
heim, and B. Aradi, Fortnet, a software package for training
Behler-Parrinello neural networks, Computer Physics Commu-
nications 284, 108580 (2023).14
[14] A. Pecchia and A. D. Carlo, Atomistic theory of transport in
organic and inorganic nanostructures, Rep. Prog. Phys. 67, 1497
(2004).
[15] T. Leininger, H. Stoll, H.-J. Werner, and A. Savin, Combin-
ing long-range configuration interaction with short-range den-
sity functionals, Chem. Phys. Lett. 275, 151 (1997).
[16] J. Toulouse, A. Savin, and H.-J. Flad, Short-range exchange-
correlation energy of a uniform electron gas with modified
electron–electron interaction, International journal of quantum
chemistry 100, 1047 (2004).
[17] R. Baer and D. Neuhauser, Density functional theory with
correct long-range asymptotic behavior, Phys. Rev. Lett. 94,
043002 (2005).
[18] Y . Tawada, T. Tsuneda, S. Yanagisawa, T. Yanai, and
K. Hirao, A long-range-corrected time-dependent density
functional theory, J. Chem. Phys. 120, 8425 (2004),
https://doi.org/10.1063/1.1688752.
[19] S. Refaely-Abramson, R. Baer, and L. Kronik, Fundamental
and excitation gaps in molecules of relevance for organic photo-
voltaics from an optimally tuned range-separated hybrid func-
tional, Phys. Rev. B 84, 075144 (2011).
[20] J. P. Perdew and A. Zunger, Self-interaction correction to
density-functional approximations for many-electron systems,
Phys. Rev. B 23, 5048 (1981).
[21] J. P. Perdew, R. G. Parr, M. Levy, and J. L. Balduz, Density-
Functional Theory for Fractional Particle Number: Derivative
Discontinuities of the Energy, Phys. Rev. Lett. 49, 1691 (1982).
[22] L. Kronik and S. Kümmel, Piecewise linearity, freedom from
self-interaction, and a Coulomb asymptotic potential: three re-
lated yet inequivalent properties of the exact density functional,
Phys. Chem. Chem. Phys. 22, 16467 (2020).
[23] T. A. Niehaus and F. Della Sala, Range separated func-
tionals in the density functional based tight-binding
method: Formalism, Phys. Status Solidi B 249, 237 (2012),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/pssb.201100694.
[24] V . Lutsker, B. Aradi, and T. A. Niehaus, Implementation and
benchmark of a long-range corrected functional in the den-
sity functional based tight-binding method, J. Chem. Phys. 143,
184107 (2015), https://doi.org/10.1063/1.4935095.
[25] B. Hourahine, B. Aradi, V . Blum, F. Bonafé, A. Buccheri,
C. Camacho, C. Cevallos, M. Y . Deshaye, T. Dumitric ˘a,
A. Dominguez, S. Ehlert, M. Elstner, T. van der Heide, J. Her-
mann, S. Irle, J. J. Kranz, C. Köhler, T. Kowalczyk, T. Kuba ˇr,
I. S. Lee, V . Lutsker, R. J. Maurer, S. K. Min, I. Mitchell, C. Ne-
gre, T. A. Niehaus, A. M. N. Niklasson, A. J. Page, A. Pecchia,
G. Penazzi, M. P. Persson, J. ˇRezá ˇc, C. G. Sánchez, M. Stern-
berg, M. Stöhr, F. Stuckenberg, A. Tkatchenko, V . W.-z. Yu,
and T. Frauenheim, DFTB+, a software package for efficient
approximate density functional theory based atomistic simula-
tions, J. Chem. Phys. 152, 124101 (2020).
[26] R. Dovesi, F. Pascale, B. Civalleri, K. Doll, N. M. Harri-
son, I. Bush, P. D’Arco, Y . Noël, M. Rérat, P. Carbonnière,
M. Causà, S. Salustro, V . Lacivita, B. Kirtman, A. M. Fer-
rari, F. S. Gentile, J. Baima, M. Ferrero, R. Demichelis,
and M. De La Pierre, The CRYSTAL code, 1976–2020 and
beyond, a long story, J. Chem. Phys. 152, 204111 (2020),
https://doi.org/10.1063/5.0004892.
[27] C. Pisani and R. Dovesi, Exact-exchange Hartree–Fock
calculations for periodic systems. I. Illustration of
the method, Int. J. Quantum Chem. 17, 501 (1980),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/qua.560170311.
[28] F. Gygi and A. Baldereschi, Self-consistent Hartree-Fock and
screened-exchange calculations in solids: Application to sili-
con, Phys. Rev. B 34, 4405 (1986).[29] J. Spencer and A. Alavi, Efficient calculation of the exact ex-
change energy in periodic systems using a truncated Coulomb
potential, Phys. Rev. B 77, 193110 (2008).
[30] R. Sundararaman and T. A. Arias, Regularization of the
Coulomb singularity in exact exchange by Wigner-Seitz trun-
cated interactions: Towards chemical accuracy in nontrivial
systems, Phys. Rev. B 87, 165122 (2013).
[31] M. Betzinger, C. Friedrich, and S. Blügel, Hybrid functionals
within the all-electron FLAPW method: Implementation and
applications of PBE0, Phys. Rev. B 81, 195117 (2010).
[32] M. Schlipf, M. Betzinger, C. Friedrich, M. Ležai ´c, and
S. Blügel, HSE hybrid functional within the FLAPW method
and its application to GdN, Phys. Rev. B 84, 125142 (2011).
[33] J. Paier, R. Hirschl, M. Marsman, and G. Kresse, The
Perdew–Burke–Ernzerhof exchange-correlation functional ap-
plied to the G2-1 test set using a plane-wave basis set, J. Chem.
Phys. 122, 234102 (2005), https://doi.org/10.1063/1.1926272.
[34] P. Giannozzi, S. Baroni, N. Bonini, M. Calandra, R. Car,
C. Cavazzoni, D. Ceresoli, G. L. Chiarotti, M. Cococ-
cioni, I. Dabo, A. D. Corso, S. de Gironcoli, S. Fab-
ris, G. Fratesi, R. Gebauer, U. Gerstmann, C. Gougoussis,
A. Kokalj, M. Lazzeri, L. Martin-Samos, N. Marzari, F. Mauri,
R. Mazzarello, S. Paolini, A. Pasquarello, L. Paulatto, C. Sbrac-
cia, S. Scandolo, G. Sclauzero, A. P. Seitsonen, A. Smogunov,
P. Umari, and R. M. Wentzcovitch, QUANTUM ESPRESSO: a
modular and open-source software project for quantum simula-
tions of materials, J. Phys.: Condens. Matter 21, 395502 (2009).
[35] J. Paier, M. Marsman, K. Hummer, G. Kresse, I. C. Ger-
ber, and J. G. Ángyán, Screened hybrid density function-
als applied to solids, J. Chem. Phys. 124, 154709 (2006),
https://doi.org/10.1063/1.2187006.
[36] S. V . Levchenko, X. Ren, J. Wieferink, R. Johanni, P. Rinke,
V . Blum, and M. Scheffler, Hybrid functionals for large peri-
odic systems in an all-electron, numeric atom-centered basis
framework, Comput. Phys. Commun. 192, 60 (2015).
[37] X. Ren, P. Rinke, V . Blum, J. Wieferink, A. Tkatchenko,
A. Sanfilippo, K. Reuter, and M. Scheffler, Resolution-of-
identity approach to Hartree–Fock, hybrid density functionals,
RPA, MP2 and GW with numeric atom-centered orbital basis
functions, New Journal of Physics 14, 053020 (2012).
[38] A. C. Ihrig, J. Wieferink, I. Y . Zhang, M. Ropo, X. Ren,
P. Rinke, M. Scheffler, and V . Blum, Accurate localized resolu-
tion of identity approach for linear-scaling hybrid density func-
tionals and for many-body perturbation theory, New Journal of
Physics 17, 093020 (2015).
[39] A. Irmler, A. M. Burow, and F. Pauly, Robust Periodic
Fock Exchange with Atom-Centered Gaussian Basis Sets, J.
Chem. Theory Comput. 14, 4567 (2018), pMID: 30080979,
https://doi.org/10.1021/acs.jctc.8b00122.
[40] J. Heyd and G. E. Scuseria, Efficient hybrid den-
sity functional calculations in solids: Assessment of
the Heyd–Scuseria–Ernzerhof screened Coulomb hy-
brid functional, J. Chem. Phys. 121, 1187 (2004),
https://doi.org/10.1063/1.1760074.
[41] M. Guidon, J. Hutter, and J. VandeV ondele, Robust Periodic
Hartree-Fock Exchange for Large-Scale Simulations Using
Gaussian Basis Sets, J. Chem. Theory Comput. 5, 3010 (2009),
pMID: 26609981, https://doi.org/10.1021/ct900494g.
[42] C. J. Tymczak, V . T. Weber, E. Schwegler, and M. Challacombe,
Linear scaling computation of the Fock matrix. VIII. Periodic
boundaries for exact exchange at the Γpoint, J. Chem. Phys.
122, 124105 (2005), https://doi.org/10.1063/1.1869470.
[43] See Supplemental Material at [URL] for geometrical informa-
tion on the structures used for polyacene, armchair graphene15
nanoribbons, hexagonal boron nitride (h-BN) monolayer and
gallium arsenide (GaAs) bulk, the convergence behavior of the
periodic implementations for armchair graphene nanoribbons,
h-BN monolayer and GaAs bulk, full electronic and functional
parameterizations used in this work and details covering the
range-separation parameter tuning procedure.
[44] P. M. W. Gill, R. D. Adamson, and J. A. Pople, Coulomb-
attenuated exchange energy density functionals, Mol. Phys. 88,
1005 (1996), https://doi.org/10.1080/00268979609484488.
[45] A. Savin, Recent Developments and Applications of Modern
Density Functional Theory , edited by J. M. Seminario (Else-
vier, The Netherlands, 1996) pp. 327–357.
[46] J. P. Perdew, M. Ernzerhof, and K. Burke, Ratio-
nale for mixing exact exchange with density func-
tional approximations, J. Chem. Phys. 105, 9982 (1996),
https://doi.org/10.1063/1.472933.
[47] F. Pascale, C. M. Zicovich-Wilson, F. López Gejo, B. Civalleri,
R. Orlando, and R. Dovesi, The calculation of the vibrational
frequencies of crystalline compounds and its implementation in
the CRYSTAL code, J. Comput. Chem. 25, 888 (2004).
[48] J. C. Slater and G. F. Koster, Simplified LCAO Method for the
Periodic Potential Problem, Phys. Rev. 94, 1498 (1954).
[49] G. Seifert and J.-O. Joswig, Density-functional tight
binding—an approximate density-functional theory
method, WIREs Comput. Mol. Sci. 2, 456 (2012),
https://wires.onlinelibrary.wiley.com/doi/pdf/10.1002/wcms.1094.
[50] M. Gaus, C.-P. Chou, H. Witek, and M. Elstner, Automatized
Parametrization of SCC-DFTB Repulsive Potentials: Applica-
tion to Hydrocarbons, J. Phys. Chem. A 113, 11866 (2009),
pMID: 19778029, https://doi.org/10.1021/jp902973m.
[51] DFTB+ developers group, SkProgs,
https://github.com/dftbplus/skprogs.
[52] Pull request of modified DFTB+ version, containing the current
method, https://github.com/dftbplus/dftbplus/pull/1223 (2023).
[53] B. Aradi, B. Hourahine, and T. Frauenheim, DFTB+, a
Sparse Matrix-Based Implementation of the DFTB Method,
J. Phys. Chem. A 111, 5678 (2007), pMID: 17567110,
https://doi.org/10.1021/jp070186p.
[54] J. Almlöf, K. Faegri Jr., and K. Korsell, Princi-
ples for a direct SCF approach to LICAO–MOab-
initio calculations, J. Comput. Chem. 3, 385 (1982),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/jcc.540030314.
[55] M. Häser and R. Ahlrichs, Improvements on the di-
rect SCF method, J. Comput. Chem. 10, 104 (1989),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/jcc.540100111.
[56] D. D. Johnson, Modified Broyden’s method for accelerating
convergence in self-consistent calculations, Phys. Rev. B 38,
12807 (1988).
[57] D. G. Anderson, Iterative Procedures for Nonlinear Integral
Equations, J. ACM 12, 547–560 (1965).
[58] G. Barbarella, L. Favaretto, G. Sotgiu, M. Zambianchi,
A. Bongini, C. Arbizzani, M. Mastragostino, M. Anni, G. Gigli,
and R. Cingolani, Tuning Solid-State Photoluminescence Fre-
quencies and Efficiencies of Oligomers Containing One Cen-
tral Thiophene-S,S-dioxide Unit, J. Am. Chem. Soc. 122, 11971
(2000), https://doi.org/10.1021/ja002037p.
[59] U. Mitschke and P. Bäuerle, The electroluminescence of or-
ganic materials, J. Mater. Chem. 10, 1471 (2000).
[60] I. Perepichka, D. Perepichka, H. Meng, and F. Wudl,
Light-Emitting Polythiophenes, Adv. Mater. 17, 2281 (2005),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/adma.200500461.
[61] H. E. Katz, Organic molecular solids as thin film transistor
semiconductors, J. Mater. Chem. 7, 369 (1997).
[62] F. Garnier, R. Hajlaoui, A. Yassar, and P. Srivas-tava, All-Polymer Field-Effect Transistor Realized
by Printing Techniques, Science 265, 1684 (1994),
https://www.science.org/doi/pdf/10.1126/science.265.5179.1684.
[63] M. Halik, H. Klauk, U. Zschieschang, G. Schmid,
S. Ponomarenko, S. Kirchmeyer, and W. Weber, Re-
lationship Between Molecular Structure and Elec-
trical Performance of Oligothiophene Organic Thin
Film Transistors, Adv. Mater. 15, 917 (2003),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/adma.200304654.
[64] C. J. Brabec, N. S. Sariciftci, and J. C. Hummelen, Plastic Solar
Cells, Adv. Funct. Mater. 11, 15 (2001).
[65] H. Hoppe and N. S. Sariciftci, Organic solar cells: An overview,
J. Mater. Res. 19, 1924–1945 (2004).
[66] A. Moliton and R. C. Hiorns, Review of electronic and opti-
cal properties of semiconducting π-conjugated polymers: ap-
plications in optoelectronics, Polym. Int. 53, 1397 (2004),
https://onlinelibrary.wiley.com/doi/pdf/10.1002/pi.1587.
[67] T. Körzdörfer, R. M. Parrish, J. S. Sears, C. D. Sherrill, and J.-
L. Brédas, On the relationship between bond-length alternation
and many-electron self-interaction error, J. Chem. Phys. 137,
124305 (2012), https://doi.org/10.1063/1.4752431.
[68] T. A. Niehaus, M. Rohlfing, F. Della Sala, A. Di Carlo, and
T. Frauenheim, Quasiparticle energies for large molecules: A
tight-binding-based Green’s-function approach, Phys. Rev. A
71, 022508 (2005).
[69] V . Q. Vuong, J. Akkarapattiakal Kuriappan, M. Kubil-
lus, J. J. Kranz, T. Mast, T. A. Niehaus, S. Irle, and
M. Elstner, Parametrization and Benchmark of Long-
Range Corrected DFTB2 for Organic Molecules, J.
Chem. Theory Comput. 14, 115 (2018), pMID: 29232515,
https://doi.org/10.1021/acs.jctc.7b00947.
[70] V . Blum, R. Gehrke, F. Hanke, P. Havu, V . Havu, X. Ren,
K. Reuter, and M. Scheffler, Ab initio molecular simulations
with numeric atom-centered orbitals, Computer Physics Com-
munications 180, 2175 (2009).
[71] L. Gallandi and T. Körzdörfer, Long-Range Corrected DFT
Meets GW: Vibrationally Resolved Photoelectron Spectra from
First Principles, Journal of Chemical Theory and Computation
11, 5391 (2015), https://doi.org/10.1021/acs.jctc.5b00820.
[72] Due to technical difficulties experienced with the latest release
version 221103 of the FHIaims code, this calculation has been
carried out with version 210716.3 instead.
[73] FHIaims in version 221103 is interfaced with a recent version of
the libXC library (5.1.7), that, in principle, provides an imple-
mentation of the BNL functional. However, LDA based hybrid
functionals like BNL do not seem to be supported by FHIaims
in version 221103. Furthermore, to the best of our knowledge, a
manual adaption of the range-separation parameter ωis not yet
supported, including the current development version of FHI-
aims, rendering a quantitative comparison of the ob2-1-1 pa-
rameters with the literature parametrization of the BNL func-
tional [17], with ω=1a−1
0, meaningless.
[74] H. J. Monkhorst and J. D. Pack, Special points for Brillouin-
zone integrations, Phys. Rev. B 13, 5188 (1976).
[75] Another strategy for verifying the correct implementation that
has proven to be useful, is to test the translational invariance of
the method by homogeneously shifting the coordinates (partly
outside the unit cell) and verifying that the Kohn-Sham spec-
trum is unaltered.
[76] N. Sato, K. Seki, and H. Inokuchi, Polarization energies of
organic solids determined by ultraviolet photoelectron spec-
troscopy, J. Chem. Soc., Faraday Trans. 2 77, 1621 (1981).
[77] S. Refaely-Abramson, S. Sharifzadeh, M. Jain, R. Baer, J. B.
Neaton, and L. Kronik, Gap renormalization of molecular crys-16
tals from density-functional theory, Phys. Rev. B 88, 081204
(2013).
[78] M. Jain, J. R. Chelikowsky, and S. G. Louie, Reliability of Hy-
brid Functionals in Predicting Band Gaps, Phys. Rev. Lett. 107,
216806 (2011).
[79] L. Hedin, New Method for Calculating the One-Particle Green’s
Function with Application to the Electron-Gas Problem, Phys.
Rev.139, A796 (1965).
[80] G. Onida, L. Reining, and A. Rubio, Electronic excita-
tions: density-functional versus many-body Green’s-function
approaches, Rev. Mod. Phys. 74, 601 (2002).
[81] S. Kümmel and L. Kronik, Orbital-dependent density function-
als: Theory and applications, Rev. Mod. Phys. 80, 3 (2008).
[82] T. Stein, H. Eisenberg, L. Kronik, and R. Baer, Fundamen-
tal Gaps in Finite Systems from Eigenvalues of a Generalized
Kohn-Sham Method, Phys. Rev. Lett. 105, 266802 (2010).
[83] S. Refaely-Abramson, S. Sharifzadeh, N. Govind,
J. Autschbach, J. B. Neaton, R. Baer, and L. Kronik,
Quasiparticle Spectra from a Nonempirical Optimally Tuned
Range-Separated Hybrid Density Functional, Phys. Rev. Lett.
109, 226405 (2012).
[84] C.-O. Almbladh and U. von Barth, Exact results for the
charge and spin densities, exchange-correlation potentials, anddensity-functional eigenvalues, Phys. Rev. B 31, 3231 (1985).
[85] J. P. Perdew and M. Levy, Comment on “Significance of the
highest occupied Kohn-Sham eigenvalue”, Phys. Rev. B 56,
16021 (1997).
[86] M. Levy, J. P. Perdew, and V . Sahni, Exact differential equation
for the density and ionization energy of a many-particle system,
Phys. Rev. A 30, 2745 (1984).
[87] W. Chen, G. Miceli, G.-M. Rignanese, and A. Pasquarello,
Nonempirical dielectric-dependent hybrid functional with
range separation for semiconductors and insulators, Phys. Rev.
Materials 2, 073803 (2018).
[88] S. Sharifzadeh, I. Tamblyn, P. Doak, P. T. Darancet, and J. B.
Neaton, Quantitative molecular orbital energies within a G 0W0
approximation, Eur. Phys. J. B 85, 323 (2012).
[89] C. Köhler and T. Frauenheim, Molecular dynamics simulations
of CF x(x=2,3) molecules at Si3N4 and SiO2 surfaces, Surf. Sci.
600, 453 (2006).
[90] T. A. Niehaus, S. Suhai, F. Della Sala, P. Lugli, M. Elstner,
G. Seifert, and T. Frauenheim, Tight-binding approach to time-
dependent density-functional response theory, Phys. Rev. B 63,
085108 (2001).