arXiv:2303.16512v2  [math.CO]  29 Aug 2023HOOK LENGTH BIASES AND GENERAL LINEAR PARTITION
INEQUALITIES
CRISTINA BALLANTINE, HANNAH BURSON, WILLIAM CRAIG, AMANDA FOLSOM,
AND BOYA WEN
Abstract. Motivatedinpartbyhook-contentformulasforcertainrestricte dparti-
tions in representation theory, we consider the total number of h ooks of ﬁxed length
in odd versus distinct partitions. We show that there are more hook s of length 2,
respectively 3, in all odd partitions of nthan in all distinct partitions of n, and
make the analogous conjecture for arbitrary hook length t≥2. We also establish
additional bias results on the number of gaps of size 1 ,respectively 2, in all odd
versusdistinct partitionsof n. We conjecturesimilarbiasesand asymptotics, aswell
as congruences for the number of hooks of ﬁxed length in odd distin ct partitions
versus self-conjugate partitions.
An integral component of the proof of our bias result for hooks of length 3 is
a linear inequality involving q(n), the number of distinct partitions of n. In this
article we also establish eﬀective linear inequalities for q(n) in great generality, a
result which is of independent interest.
Our methods are both analytic and combinatorial, and our results an d conjec-
tures intersect the areas of representation theory, analytic nu mber theory, partition
theory, and q-series. Inparticular,weuseaRademacher-typeexactformulaf orq(n),
Wright’s circle method, modularity, q-series transformations, asymptotic methods,
and combinatorial arguments.
1.Introduction
Connections between representation theory and the theory of in teger partitions are
well-known. For example, the irreducible polynomial representation s of GL n(C) may
be indexed by partitions of length at most n; moreover, the conjugacy classes of the
symmetric group Sn, and therefore the number of non-equivalent irreducible complex
representations, may be indexed by the partitions of n.Hook lengths of partitions
play particularly important roles in establishing these connections. N amely, such irre-
ducible representations can be analyzed via partition Young tableaux . The dimension
2020Mathematics Subject Classiﬁcation. 11P82, 05A17, 05A15, 05A19, 11P83.
Key words and phrases. hook length, distinct partitions, odd partitions, partition asympto tics,
partition inequalities.
Acknowledgements. Craig was partially supported by the Thomas Je ﬀerson Fund at the Uni-
versity of Virginia and the NSF (DMS-1601306 and DMS-2055118) an d received funding from the
European Research Council (ERC) under the European Union’s Hor izon 2020 research and innova-
tion programme (grant agreement No. 101001179). Folsom was pa rtially supported by NSF Grant
DMS-2200728. Wen was partially supported by NSF Grant DMS-1928 930while she was in residence
at the Simons Laufer Mathematical Sciences Institute (formerly M SRI) in Berkeley, California, dur-
ing the Spring 2023 semester. The authors also acknowledge suppo rt from the Shanahan Fund at
the College of the Holy Cross.
1of a representation of Sn(respectively GLn(C)) corresponding to a particular par-
tition is given by a hook length formula (respectively a hook-content formula ). For
more on these topics, see e.g. [25].
We recall that a partition λ= (λ1,λ2,...,λ ℓ) ofsizen∈N0is a non-increasing
sequence of positive integers λ1≥λ2≥ ··· ≥λℓcalledpartsthat add up to n. The
number of parts of a partition λis called the lengthofλand is denoted by ℓ(λ). We
denote by Pthe set of all partitions, and by p(n) the number of partitions of n. We
adopt the usual convention that the empty set is the only partition of zero.
A partition λ= (λ1,λ2,...,λ ℓ) has a natural graphical representation as a Young
diagram (also called a Ferrers diagram ), i.e. a left-justiﬁed vertical array of boxes
withλiboxes in the i-th row from the top. The conjugate of a partition λis the
partition λ′whose Young diagram has the columns of λas rows. Each box in a
Young diagram of λmay be labeled with a hook number , also called hook length ,
which, informally, is the number of boxes in the upside-down-L-shap ed portion of the
diagram with the box appearing as its corner. More precisely, for a b ox in the i-th
row andj-th column of the Young diagram of a partition λ, its hook length is deﬁned
ash(i,j) =λi+λ′
j−i−j+1 (see Figure 1). We denote by H(λ) the multi-set of all
hook lengths of λ, and let
Ht(λ) :={h|h∈ H(λ), h≡0 (mod t)}.
IfHt(λ) =∅,thenλis called a t-core partition .
In their study of Seiberg-Witten theory, Nekrasov and Okounkov [18] discovered
the now celebrated formula for arbitrary powers of Euler’s inﬁnite p roduct in terms
of hook numbers.
Theorem 1.1 (Nekrasov-Okounkov) .For any complex number zwe have
/summationdisplay
λ∈Px|λ|/productdisplay
h∈H(λ)/parenleftBig
1−z
h2/parenrightBig
=∞/productdisplay
k=1(1−xk)z−1. (1.1)
Using properties of a classical combinatorial bijection between par titions and t-
cores and t-quotients, Han [10] established an extension of the Nekrasov-Ok ounkov
formula (1.1), which uniﬁes the Macdonald identities in representatio n theory and
the generating function for t-core partitions.
Theorem 1.2 (Han).Lettbe a positive integer. For any complex numbers yandz
we have
/summationdisplay
λ∈Px|λ|/productdisplay
h∈Ht(λ)/parenleftbigg
y−tyz
h2/parenrightbigg
=∞/productdisplay
k=1(1−xtk)t
(1−(yxt)k)t−z(1−xk). (1.2)
In a similar manner, Han [10] also obtained a two-variable generating f unction for
the number of partitions of nwithmhooks of length t.
Theorem 1.3 (Han).Lettbe a positive integer. For any complex number ywe have
/summationdisplay
λ∈Px|λ|y#{h∈H(λ), h=t}=∞/productdisplay
k=1(1+(y−1)xtk)t
1−xk. (1.3)
2Restricted partitions also play important roles in this context. For example, the re
is a relationship between irreducible spin representations of the sym metric group
and distinct partitions, with tableaux and hooks acting as liaisons (se e e.g. [17, 24]
for more). Han and Xiong have also established hook-content form ulas for distinct
partitions in [11, 12]. Here, we compare certain hook numbers of dist inct partitions
to those of odd partitions.
In what follows, we refer to a partition into odd parts as an odd part ition and to
a partition into distinct parts as a distinct partition. We denote by O(n), respec-
tivelyD(n), the set of odd, respectively distinct, partitions of n. Euler’s identity [1,
Corollary 1.2] states that |O(n)|=|D(n)|for alln≥0. In this paper we establish
results analogous to Han’s generating function (1.2) for partitions inO(n),respec-
tivelyD(n),fort= 2 in (3.1) and (3.3). We do the same for t= 3 in Section 4,
however our expressions for these generating functions are mor e complicated and are
not manifestly positive. We leave it as an open problem to ﬁnd simpler, m anifestly
positive generating functions for t= 3, and more generally for t≥3. We use these
results to study the total number of hooks of ﬁxed length in all par titions in O(n),
respectively D(n), as explained below.
Letat(n) (respectively bt(n)) be the total number of hooks of length tin all odd
(respectively distinct) partitions of n.
Example 1.4. We compute b2(7) = 6 and b3(7) = 6. The partitions of 7 into distinct
parts are (7) ,(6,1),(5,2),(4,3), and (4 ,2,1). We give their Young diagrams (in that
order) with hook lengths labeled.
7654321 754321 65321
1 21
5431 6421
321 31
1
Figure 1. The distinct partitions of n= 7 and their hook lengths.
For a partition λ, a box in its Young diagram has hook length 1 if and only if it is
at the end of a row and there is no box directly below it. Thus, in a part itionλ, the
number of hooks of length 1 equals the number of diﬀerent part size s inλ.
The next result was conjectured by Beck [20] and proved analytic ally by Andrews
[2].
Theorem 1.5 (Andrews) .The diﬀerence between the total number of parts in all
distinct partitions of nand the total number of diﬀerent part sizes in all odd partiti ons
ofnequalsc(n), the number of partitions of nwith exactly one part occurring three
times while all other parts occur only once.
Corollary 1.6. Forn≥0,b1(n)−a1(n) =c(n).
3Thus, there are at least as many hooks of length 1 in all distinct part itions of nas
there are in all odd partitions of n. Given Corollary 1.6 as well as the identity
/summationdisplay
t≥1at(n) =/summationdisplay
t≥1bt(n) (1.4)
which follows from Euler’s identity, it is natural to study the relations hip between
at(n) andbt(n) for any ﬁxed t≥1. Corollary 1.6 shows that b1(n)≥a1(n). We
conjecture that this bias reverses for t≥2; that is, for large enough nwe conjecture
that there are at least as many hooks of length tin all odd partitions of nas there
are in all distinct partitions of n. We state this conjecture formally below.
Conjecture 1.7.
(i)For every integer t≥2,there exists an integer Ntsuch that for all n > N t,
we haveat(n)≥bt(n). Moreover, we conjecture the following values of Ntfor
2≤t≤10:
t2345678910
Nt078181634345659
Figure 2. Conjectural values for Nt.
(ii)For every integer t≥2we have that at(n)−bt(n)→ ∞asn→ ∞.
We note that for n≤Nt(2≤t≤10), some values of at(n)−bt(n) are negative and
some are nonnegative. Data supporting Conjecture 1.7 was obtain ed by enumerating
partitions and not from generating functions; this is because the g enerating functions
forat(n) andbt(n) are diﬃcult to derive explicitly. We are, however, able to write
down generating functions for t= 2 and t= 3, which we use to ultimately prove
Conjecture 1.7 for t= 2 and t= 3.
Theorem 1.8. We have a2(n)≥b2(n)for alln≥0anda3(n)≥b3(n)for alln >7.
Theorem 1.9. Fort∈ {2,3}, we have at(n)−bt(n)→ ∞asn→ ∞.
Remark 1.10. Together, Theorems 1.8 and 1.9 prove that Conjecture 1.7 is true
whent= 2 and t= 3.
In order to prove Theorem 1.8 for t= 3, we use a special case of our Theorem 1.11
which gives a general result on linear inequalities for q(n), the number of partitions
ofninto distinct parts. The result of Theorem 1.11 is also of independent interest
(see also [15] for a similar result for p(n), the number of partitions of n).
Theorem 1.11. Suppose/summationtextr
k=1αk</summationtexts
ℓ=1βℓ, whereα={αk}r
k=1andβ={βℓ}s
ℓ=1
are sequences of positive real numbers, and r,s∈N. Moreover, let {µk}r
k=1,{νℓ}s
ℓ=1⊂
N0, whereµ1< µ2<···< µrandν1< ν2<···< νs. Then there exists an N(which
depends on α,β, andµr) such that for n > N,
r/summationdisplay
k=1αkq(n+µk)≤s/summationdisplay
ℓ=1βℓq(n+νℓ). (1.5)
Speciﬁcally, we may take N=Nα,β,µras given in (2.11).
4Remark 1.12. The assumptions µ1< µ2<···< µrandν1< ν2<···< νsare
made without loss of generality.
The remainder of the paper is structured as follows. In Section 2, w e prove The-
orem 1.11, as well as an analogous result (Corollary 2.7) for ρ(n,m),the number of
partitions of ninto distinct parts at least m. In Section 3 and 4 we prove Theorem
1.8 fort= 2 and t= 3, respectively. In Section 5, we establish asymptotic formulas
forat(n) andbt(n) fort∈ {2,3}, proving Theorem 1.9. In Section 6, we establish bias
results for additional partition statistics related to hook length. F inally, in Section 7,
we conjecture similar biases and asymptotics, as well as congruenc es for the number
of hooks of ﬁxed length in odd distinct partitions versus self-conju gate partitions.
2.General linear inequalities for partitions into distinct p arts
The case of t= 3 in the proof of Theorem 1.8 relies centrally on a certain linear
partition inequality (see (4.11)). In this section, we prove results w hich immediately
imply (4.11). In fact, we prove much more general results, namely T heorem 1.11 and
Corollary2.7, which arealsoofindependent interest. Themostimpor tantideabehind
the proof of Theorem 1.11 is the circle method developed by Hardy an d Ramanujan
in their seminal paper [13]. Using the modular transformation law of De dekind’s eta
function, they prove the famous asymptotic formula
p(n)∼1
4n√
3eπ√2n
3
asn→ ∞. Their method was later reﬁned by Rademacher [23] to prove an ex act
formula for p(n) expressed as a convergent inﬁnite series involving Kloosterman su ms
and Bessel functions. Such formulas in the literature on partition t heory are usually
calledRademacher-type formulas . TheRademacher-typeformulafor q(n), established
by Hagis in [9], is given by
q(n) =π
(24n+1)1/2∞/summationdisplay
k=1
koddk−1/parenleftBigg/summationdisplay′
h(modk)χ(h,k)e−2πinh
k/parenrightBigg
I1/parenleftBigg
π
12k(48n+2)1/2/parenrightbigg
.(2.1)
Above,I1is the Bessel function of the ﬁrst order (see (2.2)), χis an explicit expo-
nential function, and the sum on his taken over h(modk) relatively prime to k. As
discussed in the next subsection, this equation implies strong asymp totics for q(n)
which we use to prove Theorem 1.11.
2.1.Proof of Theorem 1.11. Recall that we aim to prove the inequality
r/summationdisplay
k=1αkq(n+µk)≤s/summationdisplay
ℓ=1βℓq(n+νℓ),
for suﬃciently large n, whereαk,βℓ∈R+and/summationtextr
k=1αk</summationtexts
ℓ=1βℓ. We also explicitly
deﬁneNα,β,µrsuch that this inequality holds for all n > N α,β,µr.
The main idea of the proof of Theorem 1.11 is that the Rademacher-t ype expansion
(2.1) allows us to reduce linear inequalities for q(n) to inequalities involving only
Bessel functions. Classical explicit asymptotics for Bessel funct ions then reduce this
problem to elementary inequalities involving exponential functions. T o this end, we
establish the following key proposition.
5Proposition 2.1. ForL∈Nandε >0,there exists an N(ε,L)such that
0<q(n+L)
q(n)−1< ε
forn > N(ε,L). Speciﬁcally, we may take N(ε,L) =NA,B,C(ε,L)as in(2.8)below.
Remark 2.2. As will become clear in the proof of Proposition 2.1, we may choose
anyA,B,Csuch that A,B,C > 0 and 0<1
A+1
B+1
C<1 in deﬁning N(ε,L) =
NA,B,C(ε,L) in (2.8). In practice, one can choose such A,B,Cto obtain a suitably
smallN(ε,L).
To prove Proposition 2.1, we will not need the full exact formula (2.1) forq(n), but
only certain error terms connected with it. Recall that the Bessel functions Is(x),
s∈C, are deﬁned by
Is(x) :=1
2πi/integraldisplay1+i∞
1−i∞w−s−1exp/parenleftbiggx
2/parenleftbigg
w+1
w/parenrightbigg/parenrightbigg
dw. (2.2)
We will use the following result due to Beckwith and Bessenrodt, which is derived
from Hagis’ formula (2.1).
Theorem 2.3 ([4, Theorem 2.3]) .Letµ=µn:=π
6√
2√24n+1. Then we have
q(n) =π2
6√
2µI1(µ)+E(µ)
where
|E(µ)| ≤0.9π2
6√
2·eµ
µ2/parenleftbig
1+5µ2e−µ/parenrightbig
.
We will also require eﬀective estimates for the I1Bessel function.
Proposition 2.4. For allx >3, we have
L1(x) :=ex
√
2πx/parenleftbigg
1−2
x/parenrightbigg
−2e−x
√
2πx< I1(x)<ex
√
2πx/parenleftbigg
1+2
x/parenrightbigg
+2e−x
√
2πx=:U1(x)
forx >3.
Proof.Letzbe a complex number with |arg(z)| ≤π
2and lets∈C. Then, from [21,
Exercise 7.13.2],
I1(z) =ez
√
2πz[1+δ(z)]+ie−z
√
2πz[1+γ(z)],
with bounds
|δ(z)| ≤3π
8|z|exp/parenleftbigg3π
8|z|/parenrightbigg
,|γ(z)| ≤3
4|z|exp/parenleftbigg3
4|z|/parenrightbigg
.
Thus for x >0, by the triangle inequality we have that
I1(x)≥ex
√
2πx/parenleftbigg
1−3π
8xexp/parenleftbigg3π
8x/parenrightbigg/parenrightbigg
−e−x
√
2πx/parenleftbigg
1+3
4xexp/parenleftbigg3
4x/parenrightbigg/parenrightbigg
6and
I1(x)≤ex
√
2πx/parenleftbigg
1+3π
8xexp/parenleftbigg3π
8x/parenrightbigg/parenrightbigg
+e−x
√
2πx/parenleftbigg
1+3
4xexp/parenleftbigg3
4x/parenrightbigg/parenrightbigg
.
It is easily checked that for all x >3 we have both
3π
8xexp/parenleftbigg3π
8x/parenrightbigg
<2
x
and
1+3
4xexp/parenleftbigg3
4x/parenrightbigg
<2
from which the statement of the proposition follows. /square
2.1.1.Proof of Proposition 2.1. Letε >0 and let L≥1 be an integer. We seek to
ﬁnd a real number N(ε,L) such that for n > N(ε,L), we have
0<q(n+L)
q(n)−1< ε.
Note that 0 < q(n+L)/q(n)−1 for alln≥5. Let ˜µ:=µn+L=π
6√
2/radicalbig
24(n+L)+1.
By Theorem 2.3, it suﬃces to prove that for suﬃciently large n
π2
6√
2˜µI1(˜µ)+/hatwideE(˜µ)
π2
6√
2µI1(µ)−/hatwideE(µ)<1+ε, (2.3)
where
/hatwideE(µ) :=0.9π2
6√
2·eµ
µ2/parenleftbig
1+5µ2e−µ/parenrightbig
.
It is straightforward to show that
/hatwideE(µ)<11
10·eµ
µ2(2.4)
forµ >9, or forn≥25. Note that ˜ µ > µ. By applying these simpliﬁcations to (2.3),
togetherwithProposition2.4, it nowsuﬃces toﬁnd N(ε,L)such thatfor n > N(ε,L)
we have
π2
6√
2˜µU1(˜µ)+11e˜µ
10˜µ2
π2
6√
2µL1(µ)−11eµ
10µ2<1+ε. (2.5)
We assume that n≥26 so that we may apply (2.4) and so that the denominator in
(2.5) is positive.
Now, using the deﬁnitions of L1andU1, we simplify and show that (2.5) is equiv-
alent to
π3
2e˜µ
12˜µ3
2+π3
2e˜µ
6˜µ5
2+π3
2e−˜µ
6˜µ3
2+11e˜µ
10˜µ2+(1+ε)/parenleftBigg
11eµ
10µ2+π3
2eµ
6µ5
2+π3
2e−µ
6µ3
2/parenrightBigg
<(1+ε)π3
2eµ
12µ3
2.
(2.6)
7Sincee−µµ−3
2is a decreasing function of µ, the fact that ˜ µ≥µimplies
π3
2e−˜µ
6˜µ3
2+(1+ε)π3
2e−µ
6µ3
2≤(2+ε)π3
2e−µ
6µ3
2,
and likewise the fact that eµµ−αis increasing for µ > αimplies
π3
2e˜µ
6˜µ5
2+(1+ε)π3
2eµ
6µ5
2≤(2+ε)π3
2e˜µ
6˜µ5
2
and
11e˜µ
10˜µ2+(1+ε)11eµ
10µ2≤(2+ε)11e˜µ
10˜µ2.
Therefore, to prove (2.6) we need only prove the inequality
π3
2e˜µ
12˜µ3
2+(2+ε)π3
2e˜µ
6˜µ5
2+(2+ε)11e˜µ
10˜µ2+(2+ε)π3
2e−µ
6µ3
2<(1+ε)π3
2eµ
12µ3
2.
Deﬁne functions Fj(n), 1≤j≤4, andM(n) so that the above inequality reads
F1(n)+F2(n)+F3(n)+F4(n)< M(n).
F1(n) isasymptotically larger than Fj(n)for2≤j≤4, andso itisnaturaltosimplify
further by bounding Fj(n), 2≤j≤4 with small multiples of F1(n). For any choice
of positive real numbers A,B,C, it is straightforward to show that F2(n)<ε
AF1(n)
for all
n > N A=NA(ε,L) :=12A2(2+ε)2
π2ε2−L−1
24,
thatF3(n)<ε
BF1(n) for all
n > N B=NB(ε,L) :=910787328 B4(2+ε)4
10000π8ε4−L−1
24,
and that F4(n)<ε
CF1(n) for
n > N C=NC(ε,L) :=3
4π2log2/parenleftbigg2C(2+ε)(1+L)
ε/parenrightbigg
−1
24.
The calculation of NCabove uses the assumptions n≥1 and ˜µ≥µ. We have reduced
our problem to proving that
(1+Dε)π3
2e˜µ
12˜µ3
2<(1+ε)π3
2eµ
12µ3
2(2.7)
for suﬃciently large n, where
D=D(A,B,C) :=1
A+1
B+1
C.
Because thechoice of A,B,Cismadefreely, wemake these choices so that0 < D <1,
which is required for (2.7) to hold for suﬃciently large n.
8Let ˜n:= 24n+1 for convenience. By elementary manipulations, (2.7) is equivalent
to
/parenleftbigg˜n
˜n+24L/parenrightbigg3
4
eπ
6√
2[√˜n+24L−√
˜n]<1+ε
1+Dε.
Since ˜n >0 andL >0, we have˜n
˜n+24L<1 and√
˜n+24L−√
˜n=24L√˜n+24L+√
˜n≤12L√
˜n.
Thus, it is enough to prove that for large enough nwe have
e√
2Lπ√
˜n<1+ε
1+Dε,
which holds if and only if
n > N D=ND(ε,L) :=L2π2
12log2/parenleftBig1+ε
1+εD/parenrightBig−1
24.
Therefore, we conclude that the inequality in Proposition 2.1 holds fo r alln >
NA,B,C(ε,L), where
NA,B,C(ε,L) := max( NA,NB,NC,ND,26). (2.8)
2.1.2.Proof of Theorem 1.11. Sinceq(n)>0 for alln≥0, (1.5) is equivalent to
r/summationdisplay
k=1αkq(n+µk)
q(n)≤s/summationdisplay
ℓ=1βℓq(n+νℓ)
q(n). (2.9)
Moreover, since for all n≥0, we have q(n+νℓ)/q(n)≥1 for all 1 ≤ℓ≤sand
q(n+µk)≤q(n+µr) for all 1 ≤k≤r, inequality (1.5) holds for all nsuch that
/parenleftBiggr/summationdisplay
k=1αk/parenrightBigg/parenleftbiggq(n+µr)
q(n)−1/parenrightbigg
≤s/summationdisplay
ℓ=1βℓ−r/summationdisplay
k=1αk.
LetL:=µrand
ε:=/parenleftBiggr/summationdisplay
k=1αk/parenrightBigg−1/parenleftBiggs/summationdisplay
ℓ=1βℓ−r/summationdisplay
k=1αk/parenrightBigg
. (2.10)
ChooseA,B,C > 0 such that1
A+1
B+1
C<1 and deﬁne
Nα,β,µr:=NA,B,C(ε,L) (2.11)
whereNA,B,C(ε,L) is given by (2.8) for the above choice of εandL. The proof then
follows from Proposition 2.1. /square
Remark 2.5. We point out that in practice, it may be possible to improve (i.e. de-
crease) the bound Nα,β,µrobtained in the proof of Theorem 1.11 above. For example,
at the outset, any summands αkq(n+µk) andβℓq(n+νℓ) appearing in an inequal-
ity (1.5) such that αk=βℓandµk=νℓcan be canceled, producing an equivalent
inequality with a larger εin (2.10). Similarly, in case of any summands αkq(n+µk)
andβℓq(n+νℓ) withαk/\e}atio\slash=βℓbutµk=νℓ, one may subtract min( αk,βℓ)q(n+µk)
from both sides of (1.5) yielding an equivalent inequality with potentially smallerL
and larger εas chosen in the proof of Theorem 1.11 above. Further, given L,εas
9in the proof of Theorem 1.11, one may seek to choose appropriate A,B,andCsuch
thatNα,β,µrin (2.11) is minimized.
2.2.General linear inequalities for distinct partitions witho ut small parts.
In our proof of Theorem 1.8 for t= 3, we require a linear partition inequality for
theρ(n,m), which counts partitions of ninto distinct parts all at least m. To prove
this inequality, we make use of the following result of Erd˝ os-Nicolas- Szalay [7] which
relatesq(n) andρ(n,m).
Theorem 2.6 (Theorem 1, [7]) .For allnandmsatisfying 1≤m≤n,we have that
q(n)
2m−1≤ρ(n,m)≤q(n+m(m−1)/2)
2m−1. (2.12)
General linear inequalities for ρ(n,m) then follow from Theorems 1.11 and 2.6. We
make this explicit in the following corollary.
Corollary 2.7. Suppose/summationtextr
k=1αk</summationtexts
ℓ=1βℓ, whereα={αk}r
k=1andβ={βℓ}s
ℓ=1
are sequences of positive real numbers, and r,s∈N. Moreover, let {µk}r
k=1,{νℓ}s
ℓ=1⊂
N0, whereµ1< µ2<···< µrandν1< ν2<···< νs. Then for any m∈N, there
exists an N(which depends on α,β,µr,andm) such that for n > N,
r/summationdisplay
k=1αkρ(n+µk,m)≤s/summationdisplay
ℓ=1βℓρ(n+νℓ,m). (2.13)
Speciﬁcally, we may take N=Nα,β,µr+m(m−1)/2as in(2.11).
Remark 2.8. Whenm= 1, Corollary 2.7 becomes Theorem 1.11.
Proof of Corollary 2.7. We apply Theorem 2.6 to each ρ(n+µk,m) and obtain
r/summationdisplay
k=1αkρ(n+µk,m)≤21−mr/summationdisplay
k=1αkq(n+µk+m(m−1)/2).(2.14)
By Theorem 1.11, after replacing {µk}with{µk+m(m−1)/2}, the right-hand side
of (2.14) is at most
21−ms/summationdisplay
ℓ=1βℓq(n+νℓ) (2.15)
forn > N α,β,µr+m(m−1)/2. Applying Theorem 2.6 again, this time to each q(n+νℓ),
we obtain that (2.15) is at most
s/summationdisplay
ℓ=1βℓρ(n+νℓ,m)
forn > N α,β,µr+m(m−1)/2as desired. /square
3.Hooks of length 2
In this section, we prove Theorem 1.8 in the case of hooks of length t= 2. To
do so, we ﬁrst establish relevant generating functions for odd (re spectively distinct)
partitions in Section 3.1 (respectively Section 3.2). In Section 3.3 we u se these results
to prove Theorem 1.8 for t= 2. We also give a combinatorial interpretation of the
excessa2(n)−b2(n), in analogy with Theorem 1.5.
10First we introduce some notation used throughout the remainder o f the article.
Theq-Pochhammer symbol is deﬁned for n∈N0∪{∞}by
(a;q)n:=n−1/productdisplay
j=0(1−aqj).
We will make use of the following well-known partition generating funct ions (with
|q|<1):
∞/summationdisplay
n=0p(n)qn=1
(q;q)∞,∞/summationdisplay
n=0q(n)qn= (−q;q)∞,
∞/summationdisplay
n=0o(n)qn=1
(q;q2)∞,∞/summationdisplay
n=0do(n)qn= (−q;q2)∞,
whereo(n) equals the number of odd parts partitions of n, anddo(n) equals the
number of distinct odd parts partitions of n. Since the only partition of n= 0 is the
empty partition, we have p(0) =q(0) =o(0) =do(0) = 1.
We may abuse notation, and use partition and Young diagram interch angeably; we
do the same for parts of a partition and rows of its diagram.
3.1.Odd partitions and hooks of length t =2.We establish the generating
function for a2(n).
Proposition 3.1. We have
/summationdisplay
n≥0a2(n)qn=1
(q;q2)∞/parenleftBigg
q2+/summationdisplay
n≥2(q2n−1+q2(2n−1))/parenrightBigg
.
Proof.Leta2(m,n) be the number of odd partitions of nwithmhooks of length 2
and denote by F2(z;q) the bivariate generating function for the sequence a2(m,n),
i.e.,
F2(z;q) :=/summationdisplay
n,m≥0a2(m,n)zmqn.
Ifλis an odd partition, then by considering the possible ways a hook of len gth
2 can occur in a Young diagram, we see that the number of hooks of le ngth 2 in λ
is equal to the number of diﬀerent part sizes of λthat are greater than 1 plus the
number of diﬀerent parts of λthat occur at least twice. Therefore we have
F2(z;q) =/parenleftbigg
1+q+zq2
1−q/parenrightbigg∞/productdisplay
n=2/parenleftbigg
1+zq2n−1+z2q2(2n−1)
1−q2n−1/parenrightbigg
. (3.1)
From the deﬁnition of a2(m,n), we have
/summationdisplay
n≥0a2(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle/vextendsingle
z=1F2(z;q).
Using logarithmic diﬀerentiation ﬁnishes the proof. /square
113.2.Distinct partitions and hooks of length t =2.We establish the generating
function for b2(n).
Proposition 3.2. We have
/summationdisplay
n≥0b2(n)qn=q2
1−q(−q2;q)∞. (3.2)
Proof.Letb2(m,n) be the number of distinct partitions of nwithmhooks of length
2 and denote by G2(z;q) the bivariate generating function for the sequence b2(m,n),
i.e.,
G2(z;q) :=/summationdisplay
n,m≥0b2(m,n)zmqn.
In the Young diagram of a distinct partition λ, the number of hooks of length 2 in
λequals the number of parts λisuch that λi−λi+1≥2, where λk= 0 ifk > ℓ(λ).
Thus, the number of hooksof length 2 in λcan becalculated as follows: start with the
Young diagram of λand remove the Sylvester triangle , i.e., subtract 1 from the last
part, 2 from the second to last part, etc., to obtain an ordinary pa rtitionµ. Then, we
count the number of diﬀerent part sizes in µ. We note that the number of diﬀerent
part sizes in µis equal to the number of diﬀerent part sizes in its conjugate µ′. Let
un(t,m) be the number of partitions of mwithtdiﬀerent part sizes and all parts at
mostn. Then
G2(z;q) =/summationdisplay
n≥1qn(n+1)/2/parenleftBigg/summationdisplay
m,t≥0un(t,m)ztqm/parenrightBigg
=/summationdisplay
n≥1qn(n+1)/2n/productdisplay
j=1/parenleftbigg
1+zqj
1−qj/parenrightbigg
.
(3.3)
From the deﬁnition of b2(m,n), we have
/summationdisplay
n≥0b2(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle/vextendsingle
z=1G2(z;q).
Logarithmic diﬀerentiation gives
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1G2(z;q) =/summationdisplay
n≥1qn(n+1)/21
(q;q)nq−qn+1
1−q.
Using the well-known limiting case of the q-binomial theorem (see e.g. [1, (2.2.6)]),
∞/summationdisplay
n=0qn(n+1)
2zn
(q;q)n= (−zq;q)∞ (3.4)
withz=q, we obtain
/summationdisplay
n≥0b2(n)qn=q
1−q/summationdisplay
n≥1qn2+n
2
(q;q)n−1=q2
1−q/summationdisplay
n≥0qn2+3n
2
(q;q)n=q2
1−q(−q2;q)∞.
/square
123.3.Proof of Theorem 1.8 for hooks of length t =2.Using Propositions 3.1
and 3.2, we have
/summationdisplay
n≥0(a2(n)−b2(n))qn=1
(q;q2)∞/parenleftBigg
q2+/summationdisplay
n≥2(q2n−1+q2(2n−1))/parenrightBigg
−q2
1−q(−q2;q)∞.
Then, using geometric series, Euler’s identity [1, (1.2.5)], 1 /(q;q2)∞= (−q;q)∞, and
straightforward manipulations, we obtain
/summationdisplay
n≥0(a2(n)−b2(n))qn=1
(q;q2)∞q2(1+q+q3)
1−q4−q2
1−q(−q;q)∞
1+q
= (−q;q)∞q2
1−q2/parenleftbigg1+q+q3
1+q2−1/parenrightbigg
= (−q;q)∞q2
1−q2/parenleftbiggq−q2+q3
1+q2/parenrightbigg
=q31+q3
1−q2(−q3;q)∞. (3.5)
Clearly, the expression in (3.5), expanded as a q-series, has non-negative coeﬃcients.
This concludes the proof of Theorem 1.8 for t= 2. /square
Next we give acombinatorial interpretation for a2(n)−b2(n). Here andthroughout,
fori∈Z+, we deﬁne the multiplicity mλ(i) ofiinλto be the number of times i
appears as a part in partition λ.
Proposition 3.3. Forn≥0,a2(n)−b2(n) =w(n), wherew(n)is the total number
of diﬀerent part sizes greater than 1in all odd partitions λofnwithmλ(1)≡0,3
(mod 4).
Proof.Letw(m,n) be the number of odd partitions λofnwithmλ(1)≡0,3 (mod 4)
and exactly mdiﬀerent part sizes greater than 1. Then,
H(z;q) :=/summationdisplay
n,m≥0w(m,n)zmqn=/parenleftbigg1
1−q4+q3
1−q4/parenrightbigg∞/productdisplay
k=1/parenleftbigg
1+zq2k+1
1−q2k+1/parenrightbigg
.
Using this, we compute
/summationdisplay
n≥0w(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1H(z;q) =1+q3
1−q4∞/productdisplay
k=1/parenleftbigg
1+q2k+1
1−q2k+1/parenrightbigg∞/summationdisplay
k=1q2k+1
=1+q3
1−q4·1
(q3;q2)∞·q3
1−q2
=q31+q3
1−q2·1−q
1−q4·(−q;q)∞
=q31+q3
1−q2·(−q3;q)∞,
which, together with (3.5), completes the proof. /square
134.Hooks of length 3
In this section, we prove Theorem 1.8 in the case of hooks of length t= 3. To
do so, we ﬁrst establish relevant generating functions for odd (re spectively distinct)
partitions in Section 4.1 (respectively Section 4.2). In Section 4.3 we u se these results
as well as results from Section 2 to prove Theorem 1.8 for t= 3.
First, we introduce some useful notation. For any partition λ, denote by ℓ(λ) the
length of λ, i.e., the number of parts in λ. We denote by ℓ1(λ) (respectively ℓ2(λ)) the
number of parts λiofλwithλi−λi+1= 1 (respectively λi−λi+1= 2). We assume
λk= 0 ifk > ℓ(λ).
4.1.Odd partitions and hooks of length t =3.We establish the generating
function for a3(n).
Proposition 4.1. We have that
/summationdisplay
n≥0a3(n)qn= (−q3;q)∞q3(1+q3)
1−q2+(−q;q)∞/parenleftbiggq6
1−q4+q3
1−q6/parenrightbigg
.
Proof.Letλbe an odd partition. Among parts equal to 1, there is a hook of lengt h
3 only in the third to last part equal to 1 (thus, only if the multiplicity of 1 is at least
three). For all other parts, there is a hook of length 3 in the secon d to last and third
to last occurrence of the part size (if the multiplicity of the part per mits). There is
also a hook of length 3 in the last occurrence of the part size if that la st occurrence
is in row iwithλi−λi+1/\e}atio\slash= 2. For example, the hooks of length 3 are marked in the
Young diagram of (7 ,7,7,7,3,3,1,1,1,1).
3
3
3
3
3
Leta3(m,n) be the number of odd partitions of nwithmhooks of length 3. It
follows from above that a3(m,n) is the number of odd partitions λofnsuch that
δmλ(1)≥3+/parenleftbigg/summationdisplay
u≥2(δmλ(u)≥1+δmλ(u)≥2+δmλ(u)≥3)/parenrightbigg
−ℓ2(λ) =m.
Here and throughout, δρdenotes the Kronecker delta symbol, which evaluates to 1 if
property ρis true, and 0 if not.
Ifx(k,n) is the number of odd partitions λofnsuch that
δmλ(1)≥3+/summationdisplay
u≥2(δmλ(u)≥1+δmλ(u)≥2+δmλ(u)≥3) =k,
14andy(k,n) is the number of odd partitions λofnwithℓ2(λ) =k, then
a3(n) =/summationdisplay
m≥0ma3(m,n) =/summationdisplay
k≥0kx(k,n)−/summationdisplay
k≥0ky(k,n).
LetF1(z;q) :=/summationdisplay
n,k≥0x(k,n)zkqnandF2(z;q) :=/summationdisplay
n,k≥0y(k,n)zkqn. Then,
/summationdisplay
n≥0a3(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F1(z;q)−∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F2(z;q).
By standard arguments, we have that
F1(z;q) =/parenleftbigg
1+q+q2+zq3
1−q/parenrightbigg/productdisplay
n≥1/parenleftbigg
1+zq2n+1+z2q2(2n+1)+z3q3(2n+1)
1−q2n+1/parenrightbigg
.
To ﬁndF2(z;q), we consider the conjugate of the 2-modular diagram of an odd
partition. The 2-modular diagram of an odd partition λis a Young diagram in which
rowihasλi+1
2boxes, with the ﬁrst box ﬁlled with 1, and the remaining boxes ﬁlled
with 2. Then the sum of the entries in row iequalsλi. See the left diagram in Figure
3.
Given an odd partition λofn, if a part λisatisﬁesλi−λi+1= 2, then the i-th
row in the 2-modular diagram of λhas last box ﬁlled with 2 and is exactly one box
longer than the next row. To ﬁnd ℓ2(λ), we conjugate the 2-modular diagram of λ,
and in it ﬁnd the number of rows with multiplicity 1 among the rows ﬁlled wit h 2
that are strictly shorter than the ﬁrst row. For example, the 2-m odular diagram of
λ= (11,9,5,3) with marked relevant rows and its conjugate are shown in Figure 3 .
Here,ℓ2(λ) = 2.
122222
12222
122
121111
2222
222
22
22
2
Figure 3. 2-modular diagram and conjugate for λ= (11,9,5,3).
Thus,
F2(z;q) =/summationdisplay
n≥1qn
1−q2nn−1/productdisplay
j=1/parenleftbigg
1+zq2j+q2(2j)
1−q2j/parenrightbigg
.
We use logarithmic diﬀerentiation to obtain
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F1(z;q) =1
(q;q2)∞/parenleftBigg
q3+/summationdisplay
n≥1(q2n+1+q2(2n+1)+q3(2n+1))/parenrightBigg
= (−q;q)∞/parenleftbigg
q3+q3
1−q2+q6
1−q4+q9
1−q6/parenrightbigg
15and
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F2(z;q) =/summationdisplay
n≥1qn1
(q2;q2)nn−1/summationdisplay
j=1q2j(1−q2j).
Using the well-known identity/summationdisplay
n≥0zn/(q;q)n= 1/(z;q)∞(see e.g. [1, (2.2.5)]) and the
geometric series identity, after simplifying, we further obtain that
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F2(z;q) =1
(q;q2)∞/parenleftbiggq2
1−q2−q4
1−q4+(1+q)(1+q3)
1−q4−1+q
1−q2/parenrightbigg
=1
(q;q2)∞q4
1−q4.
Finally, we have
/summationdisplay
n≥0a3(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F1(z;q)−∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1F2(z;q)
= (−q;q)∞/parenleftbigg
q3+q3
1−q2+q6
1−q4+q9
1−q6−q4
1−q4/parenrightbigg
= (−q3;q)∞q3(1+q3)
1−q2+(−q;q)∞/parenleftbiggq6
1−q4+q3
1−q6/parenrightbigg
.(4.1)
/square
4.2.Distinct partitions and hooks of length t =3.We establish the generating
function for b3(n).
Proposition 4.2. We have that
/summationdisplay
n≥0b3(n)qn= (−q;q)∞/summationdisplay
m≥2qm
1+qm−q2
1−q2(−q3;q)∞.
Proof.Letb3(m,n) denote the number of distinct partitions of nwithmhooks of
length 3. In a distinct partition λ, there is a hook of length 3 in every row λi>1
except when λi−λi+1= 2. Thus, b3(m,n) is the number of distinct partitions of n
such that ℓ(λ)−mλ(1)−ℓ2(λ) =m.
Ifu(k,n) is the number of distinct partitions of nwith exactly kparts greater than
1, andv(k,n) is the number of distinct partitions λofnwithℓ2(λ) =k, then
b3(n) =/summationdisplay
m≥0mb3(m,n) =/summationdisplay
k≥0ku(k,n)−/summationdisplay
k≥0kv(k,n).
LetG1(z;q) :=/summationdisplay
n,k≥0u(k,n)zkqnandG2(z;q) :=/summationdisplay
n,k≥0v(k,n)zkqn. Then,
/summationdisplay
n≥0b3(n)qn=∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1G1(z;q)−∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1G2(z;q). (4.2)
We have
G1(z;q) = (1+ q)(−zq2;q)∞.
16To ﬁndG2(z;q), letλbe a partition with distinct parts and, as in the case t= 2,
remove the Sylvester triangle from λto obtain a partition µwith at most ℓ(λ) parts.
Note that parts µiinµsuch that µi−µi+1= 1 correspond to parts λiinλsuch that
λi−λi+1= 2. Thus, ℓ1(µ) =ℓ2(λ). For a partition ν, denote by/tildewideℓ(ν) the number of
parts ofνwith multiplicity one. Since ℓ1(µ) =/tildewideℓ(µ′), we have
G2(z;q) =/summationdisplay
m≥1qm(m+1)
2m/productdisplay
j=1/parenleftbigg
1+zqj+q2j
1−qj/parenrightbigg
.
Using logarithmic diﬀerentiation, we compute
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1G1(z;q) = (−q;q)∞/summationdisplay
m≥2qm
1+qm(4.3)
and
∂
∂z/vextendsingle/vextendsingle/vextendsingle
z=1G2(z;q) =/summationdisplay
n≥1qn(n+1)
2
(q;q)nn/summationdisplay
j=1qj(1−qj)
=/summationdisplay
n≥1qn(n+1)
2
(q;q)n/parenleftbigg1−qn+1
1−q−1−q2(n+1)
1−q2/parenrightbigg
=q
1−q2/summationdisplay
n≥1qn(n+1)
2
(q;q)n−1(1−qn+1)
=q
1−q2/parenleftBigg/summationdisplay
n≥0qn(n+1)
2+n+1
(q;q)n−/summationdisplay
n≥0qn(n+1)
2+2n+3
(q;q)n/parenrightBigg
=q
1−q2/parenleftbig
q(−q2;q)∞−q3(−q3;q)∞/parenrightbig
=q2
1−q2(−q3;q)∞. (4.4)
For the second to last equality we use the q-binomial theorem (3.4) twice, once with
z=qand once with z=q2.
Finally, from (4.2), (4.3), and (4.4) we have that
/summationdisplay
n≥0b3(n)qn= (−q;q)∞/summationdisplay
m≥2qm
1+qm−q2
1−q2(−q3;q)∞. (4.5)
/square
4.3.Proof of Theorem 1.8 for hooks of length t =3.To prove Theorem 1.8 for
hooks of length t= 3, we ﬁnd a particular bisection A(q) +B(q) of the generating
function/summationtext
n≥0(a3(n)−b3(n))qnestablished in the prior two subsections. We then
proveseparatelythat A(q)andB(q)havenon-negativecoeﬃcientsof qnforsuﬃciently
largen. We complete the proof by verifying the theorem directly for the init ial
coeﬃcients.
The bisection A(q)+B(q) is somewhat ad hoc; on the other hand, it reveals that
our bias result for hooks of length t= 3 ultimately follows from the rather natural
17partition inequality established in Corollary 2.7. We welcome alternative proofs to
Theorem 1.8 for t= 3, especially a proof given by a combinatorial injection.
We deﬁne the q-series
A(q) := (−q;q)∞3/summationdisplay
m=1q4m
1+qm−(−q4;q)∞q4(1+q+2q3+q4)
and
B(q) := (−q;q)∞∞/summationdisplay
m=4q6m
1+qm+(−q9;q)∞/parenleftbiggq41(1+q2)(1+q3)
1−q3+q44(1+q3)(1+q5)
1−q5/parenrightbigg
+(−q9;q)∞(f(q)−g(q)),
where the polynomials f(q) andg(q) and their respective coeﬃcients {fj}and{gj}
are deﬁned by
f(q) :=q25+q26+q27+3q28+5q29+3q30+6q31+7q32+5q33+8q34+7q35+7q36
+9q37+8q38+7q39+7q40+6q41+6q42+5q43+4q44+3q45+3q46+2q47
+q48+q49+q50+q51(4.6)
=:q2427/summationdisplay
j=1fjqj, (4.7)
and
g(q) :=q9+q12+q13+q14+2q15+q16+q17+2q18+q19+2q20+2q21+q22(4.8)
=:q814/summationdisplay
j=1gjqj. (4.9)
Proposition 4.3. WithA(q)andB(q)deﬁned above, we have that
/summationdisplay
n≥0(a3(n)−b3(n))qn=A(q)+B(q).
Before proving Proposition 4.3, we establish the non-negativity of t he coeﬃcients
ofqnin the series expressions for A(q) andB(q) for suﬃciently large values of nby
proving Lemma 4.4 and Proposition 4.5 below.
In the remainder of the paper we use the notation G(q)/{ollowsequalS0, where S⊂N0, to
mean that when expanded asa q-series, the coeﬃcients of G(q) arenon-negative, with
the possible exception of the coeﬃcients of qnforn∈S. WhenS=∅, we simply use
the notation /{ollowsequal0.
Lemma 4.4. We have that A(q)/{ollowsequal{5,7}0.
Proposition 4.5. We have that
(−q9;q)∞(f(q)−g(q))/{ollowsequal{1,2,...,75}0. (4.10)
Remark 4.6. The coeﬃcients of qnfor some nin the exceptional set {1,2,...,75}
appearing in (4.10) are in fact non-negative, but the result of Prop osition 4.5 is
suﬃcient for our purposes.
18We begin with the proof of Proposition 4.5, which ultimately follows from a special
case of our Corollary 2.7. Following this, we provide an analytic ( q-series) proof of
Lemma 4.4.
Proof of Proposition 4.5. Using that ( −q9;q)∞is the generating function for ρ(n,9),
the statement in Proposition 4.5 is equivalent to the statement that
42/summationdisplay
j=29g43−jρ(n+j,9)≤26/summationdisplay
j=0f27−jρ(n+j,9) (4.11)
forn≥25. In Corollary 2.7 we take r= 14,s= 27,αk=g15−k,andβℓ=f28−ℓ,
so that 16 =/summationtext14
k=1αk</summationtext27
ℓ=1βℓ= 118. We further take µk=k+ 28,νℓ=ℓ−1,
andm= 9,so that by Corollary 2.7, we have that (4.11) holds for n > N α,β,78as in
(2.11), which proves the desired result for all but ﬁnitely many coeﬃ cients.
Precisely, we have as in the proof of Theorem 1.11 and using Corollary 2.7 that
L=µ14+ 9(9−1)/2 = 78 and ε= (118−16)/16 = 6.375. Experimenting with
MathematicaTM[26], we further choose positive A,B,Csatisfying 1 /A+1/B+1/C <
1, namely A= 180,B= 7,C= 471177, so that (4.11) holds for n > N α,β,78:=
N180,7,471177(6.375,78) = 67910 .5, a small enough value to allow us to verify inequality
(4.11) for 25 ≤n≤67910 using SageMath. This completes the proof of Proposition
4.5. /square
Proof of Lemma 4.4. We begin by rewriting A(q) as
A(q) = (−q2;q)∞q4+(1+q)q8(−q3;q)∞+(1+q)(1+q2)q12(−q4;q)∞
−(−q4;q)∞(q4+q5+2q7+q8)
= (−q4;q)∞(q6+2q9+q11+2q12+q13+q14+q15−q5−q7).
We have
(q5+q7)(−q4;q)∞=q5(−q5;q)∞+q9(−q5;q)∞+q7(−q5;q)∞+q11(−q5;q)∞.
Since,
q9(−q4;q)∞−q9(−q5;q)∞=q13(−q5;q)∞
q11(−q4;q)∞−q11(−q5;q)∞=q15(−q5;q)∞,
it follows that
(−q4;q)∞(q6+2q9+q11+q12−q5−q7)
= (−q4;q)∞(q6+q9+q12)+(−q5;q)∞(q13+q15)−(−q5;q)∞(q5+q7).
Next,
(q5+q7)(−q5;q)∞=q5+q7+q10(−q6;q)∞+q12(−q6;q)∞+q5Σ6+q7Σ6,
where we deﬁne for m∈N
Σm= Σm(q) :=/summationdisplay
k≥mqk(−qk+1;q)∞.
We observe that
q6(−q4;q)∞−q10(−q6;q)∞=q6(−q5;q)∞+q15(−q6;q)∞,
19q12(−q4;q)∞−q12(−q6;q)∞=q12(q4+q5+q9)(−q6;q)∞.
Finally, we have
q6(−q5;q)∞−q5Σ6=q6+q6Σ5−q5Σ6
=q6+/summationdisplay
m≥5qm+6(1+qm+1)(−qm+2;q)∞−/summationdisplay
m≥6qm+5(−qm+1;q)∞
=q6+/summationdisplay
m≥5q2m+7(−qm+2;q)∞
and similarly
q9(−q4;q)∞−q7Σ6=q9+/summationdisplay
m≥4qm+9(qm+1+qm+2+q2m+3)(−qm+3;q)∞.
This completes the proof. /square
4.3.1.Proof of Proposition 4.3. We use Propositions 4.1 and 4.2 and ﬁnd that
/summationdisplay
n≥0(a3(n)−b3(n))qn
= (−q3;q)∞q2+q3+q6
1−q2+(−q;q)∞/parenleftbiggq6
1−q4+q3
1−q6/parenrightbigg
−(−q;q)∞∞/summationdisplay
m=2qm
1+qm.
(4.12)
Next we observe that
−∞/summationdisplay
m=1qm
1+qm=∞/summationdisplay
m=1q4m
1+qm−q3
1−q3−q
1−q2,
which follows by a direct calculation, for example, by adding the negat ive of the series
inmon the left-hand-side to the one on the right, using the geometric s eries formula,
and simplifying. With this, we re-write (4.12) as
(−q2;q)∞q+(−q3;q)∞q2+q3+q6
1−q2+(−q;q)∞/parenleftbiggq6
1−q4+q3
1−q6−q3
1−q3−q
1−q2/parenrightbigg
(4.13)
+(−q;q)∞∞/summationdisplay
m=1q4m
1+qm.
By straightforward algebra, we ﬁnd that
(1+q2)(1+q3)q+(1+q3)q2+q3+q6
1−q2
+(1+q)(1+q2)(1+q3)/parenleftbiggq6
1−q4+q3
1−q6−q3
1−q3−q
1−q2/parenrightbigg
.
=−/parenleftbigg
q4(1+q+2q3+q4)+q9
1−q3/parenrightbigg
.
20We multiply this identity by ( −q4;q)∞and insert it into the sum seen in(4.13). Thus,
we have shown that the generating function for a3(n)−b3(n) equals
A(q)+(−q;q)∞∞/summationdisplay
m=4q4m
1+qm−(−q4;q)∞q9
1−q3. (4.14)
Next, we re-write
(−q;q)∞∞/summationdisplay
m=4q4m
1+qm= (−q;q)∞∞/summationdisplay
m=4q6m
1+qm+(−q3;q)∞/parenleftbigg
q16+q17+q18+q19
1−q5/parenrightbigg
,
(4.15)
which may againbeproved by, forexample, subtracting the two inﬁn ite series appear-
ingin(4.15),usinggeometricseries, andsimplifying. Wetaketheserie s(−q3;q)∞q19/(1−
q5) appearing in (4.15) and subtract from it the term ( −q4;q)∞q9/(1−q3) appearing
in (4.14) as follows:
(−q3;q)∞q19
1−q5−(−q4;q)∞q9
1−q3
= (−q9;q)∞/parenleftbigg
(−q3;q)6q19
1−q5−(−q4;q)5q9
1−q3/parenrightbigg
= (−q9;q)∞/parenleftbiggq41(1+q2)(1+q3)
1−q3+q44(1+q3)(1+q5)
1−q5−p(q)/parenrightbigg
,(4.16)
where
p(q) :=q9+q12+q13+q14+2q15+2q16+2q17+3q18+2q19+4q20+5q21+4q22+4q23
+5q24+5q25+5q26+6q27+5q28+4q29+6q30+4q31+3q32+5q33+2q34
+3q35+3q36+q38+q39.
Inserting (4.15) and then (4.16) into (4.14) followed by some straigh tforward algebra
reveals that the generating function for a3(n)−b3(n) may be written as
A(q)+(−q)∞∞/summationdisplay
m=4q6m
1+qm+(−q3)∞/parenleftbig
q16+q17+q18/parenrightbig
+(−q9)∞/parenleftbiggq41(1+q2)(1+q3)
1−q3+q44(1+q3)(1+q5)
1−q5−p(q)/parenrightbigg
=A(q)+B(q)
as claimed. In particular, we have also used the easy to verify identit y
(−q3;q)∞(q16+q17+q18)−(−q9;q)∞p(q) = (−q9;q)∞(f(q)−g(q)).
This completes the proof of Proposition 4.3. /square
Proof of Theorem 1.8 for t= 3.Using Proposition 4.3, Theorem 1.8 for t= 3 now
follows fromLemma 4.4 and Proposition 4.5, along with a ﬁnite computat ion of the q-
series coeﬃcients in Proposition 4.3 through the q75term, which is easily done (using,
for example, MathematicaTM). /square
215.Asymptotic formulas
In this section, we prove Theorem 1.9. To this end, we obtain asympt otic formulas
fora2(n),b2(n),a3(n), andb3(n)using thecirclemethod. Fromthese, weimmediately
obtainasymptoticformulasfor a2(n)−b2(n) anda3(n)−b3(n), allowingustoestablish
Theorem 1.9. As usual, for two functions f(n) andg(n), we write f(n)∼g(n) as
n→ ∞iff(n)
g(n)→1 asn→ ∞. Moreover, log denotes the natural logarithm.
Theorem 5.1. Asn→ ∞, we have
a2(n)∼35/4
8πn1/4eπ√n
3
and
b2(n)∼31/4
4πn1/4eπ√n
3.
Theorem 5.2. Asn→ ∞, we have
a3(n)∼31/4
3πn1/4eπ√n
3
and
b3(n)∼/parenleftbigg
log(2)−1
8/parenrightbigg31/4
2πn1/4eπ√n
3.
As an immediate consequence of these two theorems, we obtain the following corol-
laries.
Corollary 5.3. Asn→ ∞, we have
a2(n)−b2(n)∼31/4
8πn1/4eπ√n
3.
Corollary 5.4. Asn→ ∞, we have
a2(n)∼3
2b2(n).
Corollary 5.5. Asn→ ∞, we have
a3(n)−b3(n)∼/parenleftbigg19
48−log(2)
2/parenrightbigg31/4
πn1/4eπ√n
3.
Corollary 5.6. Asn→ ∞, we have
a3(n)∼2
3(log(2)−1
8)b3(n).
Remark 5.7. The asymptotic results in Corollaries 5.3 and 5.5 explain the inequali-
ties of Theorem 1.8 and prove Theorem 1.9. In addition, Corollaries 5.4 and 5.6 prove
stronger statements, as will be discussed in Section 7.
In light of Theorem 1.5, it is natural to ask about the asymptotics of a1(n) and
b1(n) as well. We outline them here since the proofsareeasier than those of Theorems
225.1 and 5.2. Asymptotics for b1(n) can be easily derived from [6, Theorem 1.1]; in
particular, as n→ ∞, we have
b1(n)∼31/4log(2)
2πn1/4eπ√n
3. (5.1)
Furthermore, using thegenerating functionidentity for a1(n)−b1(n) given in[2, (3.1)]
and [19, Proposition 1.8] (which we restate as Proposition 5.8 below) it can be shown
that
b1(n)−a1(n)∼31/4/parenleftbig
log(2)−1
2/parenrightbig
2πn1/4eπ√n
3 (5.2)
asn→ ∞. Using (5.1) and (5.2) along with the deﬁnition of ∼, we also deduce that
a1(n)∼31/4
4πn1/4eπ√n
3.
We additionally note, comparing with Corollaries 5.4 and 5.6, that
a1(n)∼1
log(4)b1(n).
We now discuss Wright’s circle method and use it to prove Theorems 5.1 and 5.2.
5.1.Wright’s circle method. The circle method is one of the most important tools
in the modern analytic theory of partitions. The method goes back t o famous work
of Hardy and Ramanujan on p(n) [13] in which they proved that
p(n)∼1
4n√
3eπ√2n
3
asn→ ∞. Rademacher [22] later extended their method to prove an exact f ormula
forp(n) similar to, and predating, (2.1). The presence of non-modular ter ms in the
generating functions of at(n) andbt(n), such as Lambert series and rational functions,
meansRademacher’s approachcannotbedirectlyusedtogiveexac t formulasfor at(n)
orbt(n). To overcome this diﬃculty, we use a variation of the circle method d ue to
Wright [27] to obtain asymptotic expansions. We use the formulation of this method
given by Ngo and Rhoades [19], who derived asymptotic formulas for t he coeﬃcients
of products L(q)ξ(q), where L(q) andξ(q) are certain analytic functions of q∈C
with|q|<1 andq /∈R≤0. Informally, ξmust have a “main” exponential singularity
asq→1 andL(q) must have polynomial behavior as q→1.
To state the formulation of Wright’s circle method given in [19], we requ ire some
notation. For |q|<1 andq/\e}atio\slash∈R≤0, we write q=e−zwithz=x+iysuch that
x >0 and|y|< π. Let 0< δ <π
2and deﬁne Dδ:={z∈C:|arg(z)|<π
2−δ}.
Equivalently, if we let ∆ = cot( δ), thenDδ:={x+iy∈C: 0≤ |y|<∆x}. For ﬁxed
c >0 and integer n≥1, we let C=C(c,n) be the circle in the complex plane centered
at zero with radius |q|=e−x, wherex=c√n. For ﬁxed δ, we letC1:=Dδ∩ Cand
C2:=C\C1. We call C1themajor arc andC2theminor arc . We will interchangeably
use Landau’s big-O and Vinogradov’s ≪notations in this section. Recall that for two
complex-valued functions f(z),g(z), we write f=O(g) orf≪gin a region if and
only if there is a constant C >0 such that |f(z)| ≤C|g(z)|for allzin that region.
LetL(q),ξ(q) be analytic functions for q=e−zin the unit disk, and ﬁx δandcas
above. Following Ngo and Rhoades, we deﬁne four hypotheses abou t the asymptotic
23properties of these functions. In (H1)–(H4) below, the notation ≪δandOδand
indicates that the implied constants depends on δ.
(H1) For every positive integer k, as|z| →0 in the cone Dδwe have
L(q) =1
zB/parenleftBiggk−1/summationdisplay
s=0αszs+Oδ/parenleftbig
zk/parenrightbig/parenrightBigg
,
whereB∈Randαs∈C.
(H2) As |z| →0 in the cone Dδwe have
ξ(q) =KzβeA
z/parenleftBig
1+Oδ/parenleftBig
e−γ
z/parenrightBig/parenrightBig
,
whereA:=c2, andK,β≥0 andγ >0.1
(H3) As |z| →0 in the regionπ
2−δ≤ |arg(z)|<π
2, we have
|L(q)| ≪δ|z|−C,
whereC >0.
(H4) As |z| →0 in the regionπ
2−δ≤ |arg(z)|<π
2, we have
|ξ(q)| ≪δξ(|q|)e−δ′
Re(z),
whereδ′=δ′(δ)>0.
Note that (H1) and (H2) put restrictions of the asymptotic behav ior ofL(q)ξ(q)
on the major arc; hypotheses (H3) and (H4) put restrictions on t he minor arc. Ngo-
Rhoades proved the following result from these hypotheses.
Proposition 5.8 ([19, Proposition 1.8]) .Assume the hypotheses above. Then as
n→ ∞we have for any N∈Z+that
c(n) =Ke2√
Ann1
4(2B−2β−3)/parenleftBiggN−1/summationdisplay
r=0prn−r
2+O/parenleftBig
n−N
2/parenrightBig/parenrightBigg
,
wherepr:=r/summationtext
j=0αjcj,r−jandcj,r:=(−1
4√
A)r√
Aj+β−B+1
2
2√πΓ(j+B+3
2+r)
r!Γ(j+B+3
2−r).
Observe that when applying Proposition 5.8, the precise values of th e constants
δ,γ,C, andδ′do not appear in the asymptotic formula, and therefore we will not p ut
any emphasis on computing these values exactly in the calculations of this section.
In Section 5.2, we verify the hypotheses (H2) and (H4) for the fun ction (−q;q)∞,
which appears in all the generating functions we consider. In Sectio n 5.3, we verify
the hypotheses (H1) and (H3) for certain rational functions and Lambert series which
appear in the generating functions for a2(n),b2(n),a3(n), andb3(n).
1Ngo and Rhoades assumed that γ > c2, but this is not strictly necessary when establishing
Proposition 5.8, although the scenario where γ > c2does arise naturally if ξis modular.
245.2.Modular transformations. Here, weprovidethecalculationoftheasymptotic
growth of ( −q;q)∞on both the major and minor arcs. As we have seen in previous
sections, the generating functions for at(n) andbt(n) naturally arise as the product of
(−q;q)∞and certain other factors. Since ( −q;q)∞is the only factor with exponential
singularities in the generating functions for at(n),bt(n),t= 2,3, we set ξ(q) :=
(−q;q)∞. We also let P(q) := (q;q)−1
∞be the generating function for the partition
functionp(n). Noteherethatfor q=e2πiτ, wehavetherelation P(e2πiτ) =eπiτ
12η−1(τ)
whereη(τ) is the Dedekind η-function. For the remainder of the section, we use the
notation q=e−z. The following transformation property for P(q) follows easily
from the modular modular transformation law η(−1/τ) =/radicalbig
τ/i η(τ) satisﬁed by the
Dedekind η-function:
P(q) =/radicalbiggz
2πexp/parenleftbiggπ2
6z−z
24/parenrightbigg
P/parenleftBig
e−4π2
z/parenrightBig
.
From this formula, it follows that
ξ(q) =1√
2exp/parenleftbiggπ2
12z+z
24/parenrightbiggP/parenleftBig
e−4π2
z/parenrightBig
P/parenleftBig
e−2π2
z/parenrightBig.
Using this transformation law, Jackson and Otgonbayar [14] prov ed the following
asymptotic results on ξ(q) on the major and minor arcs.
Lemma 5.9 ([14, Lemma 3.8]) .Let∆>0be a positive constant, and suppose
z=x+iysatisﬁes0≤ |y|<∆x. Then as z→0in this region, we have
ξ(q) =1√
2exp/parenleftbiggπ2
12z+z
24/parenrightbigg/parenleftBig
1+O/parenleftBig
e−23π2
12z/parenrightBig/parenrightBig
.
Lemma 5.10 ([14, Lemma 3.9]) .Let∆>0be a positive constant, and suppose
z=x+iysatisﬁes∆x≤ |y|< π. Then as z→0in this region, we have
|ξ(q)| ≪exp/parenleftbiggπ2
12x/parenleftbigg1
2+3
π2+6
π2(∆2+1)/parenrightbigg/parenrightbigg
.
In particular, if ∆>1.45, then there is a positive constant δ′such that
|ξ(q)| ≪ξ/parenleftbig
e−x/parenrightbig
·exp/parenleftbigg
−δ′
x/parenrightbigg
.
Remark 5.11. The results of Jackson and Otgonbayar are stronger than this; in
particular, their bounds are completely explicit.
Notice that as a result of Lemmas 5.9 and 5.10, ξ(q) = (−q;q)∞satisﬁes (H2) and
(H4) with the constants β= 0,K=1√
2andA=π2
12.
5.3.Estimating rational functions and Lambert series. To verify (H1) and
(H3) for our situation, we must consider the rational functions an d Lambert series
that appear in the generating functions for a2(n),b2(n),a3(n), andb3(n). We deﬁne
the following functions:
Lo,2(q) :=q2(1+q+q3)
1−q4,
25Ld,2(q) :=q2
1−q2,
Lo,3(q) :=q3(1+q3)
(1+q)(1−q4)+q6
1−q4+q3
1−q6,
Ld,3(q) :=Rd,3(q)+/summationdisplay
n≥1qn
1+qn:=−q2
(1−q4)(1+q)−q
1+q+/summationdisplay
n≥1qn
1+qn.
ByconsideringtheLaurentexpansionsof Lo,2(e−z),Ld,2(e−z),Lo,3(e−z),andRd,3(e−z),
we obtain the following results.
Lemma 5.12. As|z| →0, we have
Lo,2(q) =1
z/parenleftbigg3
4+O(z)/parenrightbigg
.
Lemma 5.13. As|z| →0, we have
Ld,2(q) =1
z/parenleftbigg1
2+O(z)/parenrightbigg
.
Lemma 5.14. As|z| →0, we have
Lo,3(e−z) =1
z/parenleftbigg2
3+O(z)/parenrightbigg
.
Lemma 5.15. As|z| →0, we have
Rd,3(q) =1
z/parenleftbigg−1
8+O(z)/parenrightbigg
.
Notice that, as a result of Lemmas 5.12 and 5.13, Lo,2andLd,2each satisfy (H1)
withconstants( B,α0) = (1,3
4)and(1,1
2), respectively. Similarly, byLemma5.14, Lo,3
satisﬁes (H1) with constants ( B,α0) = (1,2
3). Furthermore, by using the triangle and
reverse triangle inequalities, we obtain the following bounds onour ra tional functions,
which show that Lo,2,Ld,2, andLo,3satisfy (H3).
Lemma 5.16. Supposez=x+iy. Then, as |z| →0, we have
|Lo,2(q)|<3
2x≪ |z|−1.
Lemma 5.17. Supposez=x+iy. Then, as |z| →0, we have
|Ld,2(q)|<1
x≪ |z|−1.
Lemma 5.18. Supposez=x+iy. Then, as |z| →0, we have
|Lo,3(e−z)| ≪1
x≪ |z|−1.
Lemma 5.19. Supposez=x+iy. Then, as |z| →0in the regionπ
2−δ≤ |y|<π
2,
we have
|Rd,3(q)|<1
2x≪ |z|−1.
26Finally, we estimate theLambert series appearinginthe deﬁnitionof Ld,3(q). Using
a technique of Zagier [28, Section 4] based on Euler–Maclaurin summa tion, Craig
proved the following estimates for this Lambert series.
Lemma 5.20 ([6, Lemma 4.1]) .Let∆>0be a constant, and let z=x+iywith
0≤ |y|<∆x. Then as z→0in this region, we have
/summationdisplay
n≥1e−nz
1+e−nz∼log(2)
z.
Lemma 5.21 ([6, Lemma 4.6]) .Letz=x+iysatisfyx >0,0≤ |y|< π. Then we
have/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
n≥1e−nz
1+e−nz/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle<1
x2.
5.4.Proof of Theorems 5.1 and 5.2. In this section, we prove Theorems 5.1 and
5.2 by verifying that the hypotheses required for Proposition 5.8 ar e satisﬁed by the
generating functions of a2(n),b2(n),a3(n), andb3(n).
Proof of Theorem 5.1. By Lemmas 5.9 and 5.12, we have Lo,2(e−z) =3
4z+O(1) and
ξ(e−z) =1√
2exp/parenleftBig
π2
12z+O(z)/parenrightBig
on the major arc. These estimates show that Lo,2(q)
andξ(q) satisfy Hypotheses (H1) and (H2) with constants β= 0,K=1√
2,A=π2
12,
α0=3
4, andB= 1. Furthermore, on the minor arcs, Lemmas 5.10 and 5.16 show
that our generating function satisﬁes Hypotheses (H3) and (H4) .
Similarly, Lemmas 5.9, 5.13, 5.10, and 5.17 show that Ld,2(q) andξ(q) satisfy
Hypotheses (H1)-(H4) with constants β= 0,K=1√
2,A=π2
12,α0=1
2, andB= 1.
Therefore, we can apply Proposition 5.8 to obtain the desired asymp totics for b2(n)
anda2(n). /square
Recall that, by Proposition 4.5,
/summationdisplay
n≥0b3(n)qn= (−q;q)∞/summationdisplay
m≥2qm
1+qm−q2
1−q2(−q3;q)∞
=ξ(q)/parenleftBigg
−q
1+q+−q2
(1−q2)(1+q)(1+q2)+/summationdisplay
m≥1qm
1+qm/parenrightBigg
=ξ(q)Ld,3(q)
Proof of Theorem 5.2. Lemmas 5.9, 5.14, 5.10, and 5.18 show that Lo,3(q) andξ(q)
satisfy Hypotheses (H1)-(H4) with constants β= 0,K=1√
2,A=π2
12,α0=2
3,B= 1.
Furthermore, by Lemmas 5.9, 5.20, and 5.15, we have
Ld,3(e−z) =1
z/parenleftbigg
log(2)−1
8/parenrightbigg
+O(1)
andξ(e−z) =1√
2exp/parenleftBig
π2
12z+O(z)/parenrightBig
on the major arc. These estimates show that
Ld,3(q) andξ(q) satisfy Hypotheses (H1) and (H2) with constants β= 0,K=1√
2,
27A=π2
12,α0= log(2) −1
8, andB= 1. Furthermore, on the minor arcs, Lemmas 5.10,
5.21 and 5.19 show that our generating function satisﬁes Hypothes es (H3) and (H4).
Therefore, we can apply Proposition 5.8 to obtain the desired asymp totics for b3(n)
anda3(n). /square
6.Further bias results
Recall that we denote by ℓ1(λ) (respectively ℓ2(λ)) the number of parts λiofλ
withλi−λi+1= 1 (respectively λi−λi+1= 2). We assume λk= 0 ifk > ℓ(λ). For
j= 1,2, we refer to ℓj(λ), as the number of gaps of size jinλ. Note that the ℓ2(λ)
partition statistic appeared in our calculations of both a3(n) andb3(n). Thus, it is
natural to investigate a possible bias in the total number of gaps of size exactly 1,
respectively 2, in odd versus distinct partitions. We prove that suc h a bias exists. As
in the case with the total number hooks of ﬁxed length, the directio n of the bias for
the total number of gaps of size 2 is the opposite of that for the to tal number of gaps
of size 1.
Theorem 6.1. Forn∈N0,
/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ)
is non-negative except for n= 2andn= 4in which case it equals −1.
Theorem 6.2. Forn∈N0,
/summationdisplay
λ∈O(n)ℓ2(λ)−/summationdisplay
λ∈D(n)ℓ2(λ)
is non-negative except for n= 2andn= 6in which case it equals −1.
After proving each theorem, we provide combinatorial interpreta tions of the re-
spective excesses.
6.1.Proof of Theorem 6.1. Ifλ∈ O(n), then
ℓ1(λ) =/braceleftBigg
1 if 1∈λ,
0 else.
Thus,
/summationdisplay
n≥0/summationdisplay
λ∈O(n)ℓ1(λ)qn=q1
(q;q2)∞=q(−q;q)∞.
The number of gaps of size 1 all in distinct partitions of nis equal to the total
number of parts in all distinct partitions of nminus the total number of gaps of
size at least 2 in all distinct partitions of n, i.e.,b1(n)−b2(n). Using this and the
generating function for b2(n) found in (3.2), we have
/summationdisplay
n≥0/summationdisplay
λ∈D(n)ℓ1(λ)qn= (−q;q)∞/summationdisplay
m≥1qm
1+qm−q2
1−q(−q2;q)∞.
28Therefore,
/summationdisplay
n≥0
/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ)
qn
= (−q;q)∞/summationdisplay
m≥1qm
1+qm−q2
1−q(−q2;q)∞−q(−q;q)∞
= (−q;q)∞/parenleftBigg/summationdisplay
m≥1qm
1+qm−q2
1−q2−q/parenrightBigg
. (6.1)
We will show that the expression in (6.1), when expanded as a q-series, has non-
negative coeﬃcients for n≥5. We rewrite (6.1) as
(−q;q)∞/parenleftBigg/summationdisplay
m≥1q3m
1+qm−q2
1+q/parenrightBigg
, (6.2)
which can be seen by, for example, subtracting (6.2) from (6.1) and using the geo-
metric series identity.
Next we write
(−q;q)∞/parenleftBigg/summationdisplay
m≥1q3m
1+qm−q2
1+q/parenrightBigg
= (−q;q)∞/parenleftbiggq3
1+q+q6
1+q2−q2
1+q/parenrightbigg
+(−q;q)∞/summationdisplay
m≥3q3m
1+qm
= (−q3;q)∞/parenleftbig
q3+q5+q6+q7−q2−q4/parenrightbig
+(−q;q)∞/summationdisplay
m≥3q3m
1+qm.(6.3)
To ﬁnish the proof, we show that the only negative terms in
(−q3;q)∞/parenleftbig
q3+q5+q6+q7−q2−q4/parenrightbig
,
when expanded as a q-series, are −q2and−q4.
By expanding the q-Pochhammer symbol, we obtain
q2(−q3;q)∞=q2+q5(−q4;q)∞+q2/summationdisplay
k≥4qk(−qk+1;q)∞
=q2+q5(−q4;q)∞+q3/summationdisplay
k≥3qk(−qk+2;q)∞.
Similarly,
q3(−q3;q)∞=q3+q3/summationdisplay
k≥3qkqk+1(−qk+2;q)∞+q3/summationdisplay
k≥3qk(−qk+2;q)∞,
q4(−q3;q)∞=q4+q7(−q5;q)∞+q8(−q5;q)∞+q11(−q5;q)∞+q6/summationdisplay
k≥3qk(−qk+3;q)∞,
q5(−q3;q)∞=q5(−q4;q)∞+q8(−q5;q)∞+q12(−q5;q)∞,
29q6(−q3;q)∞=q6+q6/summationdisplay
k≥3q2k+1(1+q+qk+2)(−qk+3;q)∞+q6/summationdisplay
k≥3qk(−qk+3;q)∞,
q7(−q3;q)∞=q7(−q5;q)∞+q10(−q4;q)∞+q11(−q5;q)∞.
Then,
(−q3;q)∞/parenleftbig
q3+q5+q6+q7−q2−q4/parenrightbig
=−q2+q3−q4+H1(q),
where
H1(q) :=q6+q10(−q4;q)∞+q12(−q5;q)∞
+q3/summationdisplay
k≥3qkqk+1(−qk+2;q)∞+q6/summationdisplay
k≥3q2k+1(1+q+qk+2)(−qk+3;q)∞.
Clearly,H1(q) expanded as a q-series has non-negative coeﬃcients. This completes
the proof of Theorem 6.1. /square
The proof of Theorem 6.1 shows that
/summationdisplay
n≥0
/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ)
qn=−q2+q3−q4+H1(q)+(−q;q)∞/summationdisplay
m≥3q3m
1+qm.
We now give a combinatorial interpretation for/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ) whenn≥5.
First note that
(−q;q)∞/summationdisplay
m≥3q3m
1+qm
is the generating function for the number of partitions of nin which exactly one part
greater than 2 has multiplicity three and all other parts have multiplic ity one. Next,
we interpret the summands in H1(q) as combinatorial generating functions:
•q6is the generating function for the number of partitions of nwith exactly
three parts equal to 2 (and no other parts).
•q10(−q4;q)∞is the generating function for the number of partitions λofn
with exactly three parts equal to 2, all other parts distinct, and 1 ,3∈λ.
•q12(−q5;q)∞is the generating function for the number of partitions λofn
with exactly three parts equal to 1, all other parts distinct, and 2 ,3,4∈λ.
•q3/summationtext
k≥3qkqk+1(−qk+2;q)∞is the generating function for the number of par-
titionsλofnwithℓ(λ)≥5, exactly three parts equal to 1, all other parts
distinct, 2 /\e}atio\slash∈λ, and the two smallest parts not equal to 1 diﬀering by one.
•q6/summationtext
k≥3q2k+1(1 +q+qk+2)(−qk+3;q)∞equalsq6/summationtext
k≥3qkqk+1(−qk+2;q)∞+
q6/summationtext
k≥3qkqk+2(−qk+3;q)∞,which is the generating function for the number
of partitions λofnwithℓ(λ)≥5, exactly three parts equal to 2, all other
parts distinct, 1 /\e}atio\slash∈λ, and the two smallest parts not equal to 2 diﬀering by
one or two.
Thus, for n≥5,/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ)
30equals the number of partitions λofnwith exactly one part repeated three times
and all other parts distinct such that
(i) if the repeated part is 1, then ℓ(λ)≥5, the two smallest parts not equal to 1
diﬀer by one, and if 2 ∈λ, then 4∈λ.
(ii) if the repeated part is 2, then ℓ(λ) = 3 orℓ(λ)≥5, and
•if 1∈λ, then 3∈λ
•if 1/\e}atio\slash∈λ, then the two smallest parts not equal to 2 diﬀer by one or two.
Corollary 6.3. Forn≥5,/summationdisplay
λ∈D(n)ℓ1(λ)−/summationdisplay
λ∈O(n)ℓ1(λ)≤b1(n)−a1(n).
Proof.This follows immediately from the combinatorial interpretation above and
Corollary 1.6. /square
Remark 6.4. Corollary 6.3 can be rewritten as
a1(n)−/summationdisplay
λ∈O(n)ℓ1(λ)≤b1(n)−/summationdisplay
λ∈D(n)ℓ1(λ),forn≥5. (6.4)
In fact, the inequality is true for all n≥0. Combinatorially, (6.4) states that the
total number of diﬀerent part sizes greater than 1 in all odd partit ions ofnis at most
the total number of gaps greater than 1 in all distinct partitions of n. It is interesting
to compare this with Corollary 1.6 which implies that the total number o f parts in all
distinct partitions of nis at most the total number of diﬀerent part sizes in all odd
partitions of n.
6.2.Proof of Theorem 6.2. From Section 4,
/summationdisplay
λ∈D(n)ℓ2(λ) = (−q3;q)∞q2
1−q2and/summationdisplay
λ∈O(n)ℓ2(λ) = (−q;q)∞q4
1−q4.
Thus, we need to show that, the coeﬃcients of qn,n/\e}atio\slash= 2,6, in
H2(q) :=/summationdisplay
n≥0
/summationdisplay
λ∈O(n)ℓ2(λ)−/summationdisplay
λ∈D(n)ℓ2(λ)
qn= (−q;q)∞q4
1−q4−(−q3;q)∞q2
1−q2
arenon-negative. Adirect calculation shows that thecoeﬃcients o fq2andq6inH2(q)
are both equal to −1.
After some q-series manipulations, we have that
H2(q)+q2+q6= (−q3;q)∞q5
1−q2−q5(−q4;q)∞−q2(1+q4)/summationdisplay
m≥5qm(−qm+1;q)∞
= (−q4;q)∞q7
1−q−q2(1+q4)/summationdisplay
m≥5qm(−qm+1;q)∞
= (−q4;q)∞/summationdisplay
k≥7qk−(1+q4)/summationdisplay
k≥7qk(−qk−1;q)∞
= (1+q4)/summationdisplay
k≥7qk/parenleftbig
(−q5;q)∞−(−qk−1;q)∞/parenrightbig
.
31Moreover, for k≥7, we have
(−q5;q)∞−(−qk−1;q)∞=/summationdisplay
j≥5qj(−qj+1;q)∞−/summationdisplay
j≥k−1qj(−qj+1;q)∞
=k−2/summationdisplay
j=5qj(−qj+1;q)∞.
Thus,
H2(q)+q2+q6= (1+q4)/summationdisplay
k≥7qkk−2/summationdisplay
j=5qj(−qj+1;q)∞, (6.5)
which clearly has non-negative coeﬃcients and completes the proof . /square
We interpret (6.5) as a combinatorial generating function as follows . We write
k≥7 ask= 3d+r, 0≤r≤2 and we view qkas generating dparts equal to 3
and one part equal to r. The sum/summationtextk−2
j=5qj(−qj+1;q)∞generates non-empty distinct
partitions with smallest part between 5 and k−2 (inclusive).
Thus, for n/\e}atio\slash= 2,6,/summationdisplay
λ∈O(n)ℓ2(λ)−/summationdisplay
λ∈D(n)ℓ2(λ)
equals the number of partitions λofnsatisfying all of the following conditions:
(i)mλ(3)≥2, and if mλ(3) = 2, then λℓ(λ)<3,
(ii) 3 is the only repeated part, and 1 and 2 cannot both occur as par ts inλ,
(iii)λhas part greater than 4 and the smallest part sgreater than 4 satisﬁes
5≤s≤/parenleftbig/summationtext
λi≤3λi/parenrightbig
−2.
We also provide a second combinatorial interpretation for the exce ss of Theorem
6.2. From (6.5), we have that
H2(q)+q2+q6= (1+q4)/summationdisplay
k≥7qkk−1/summationdisplay
j=6qj−1(−qj;q)∞
= (1+q4)∞/summationdisplay
k=6qk−1(−qk;q)∞∞/summationdisplay
j=k+1qj
= (1+q4)∞/summationdisplay
k=6q2k
1−q(−qk;q)∞
=q2
1−q(1+q4)∞/summationdisplay
k=5q2k(−qk+1;q)∞.
Thus, for n/\e}atio\slash= 2,6,/summationdisplay
λ∈O(n)ℓ2(λ)−/summationdisplay
λ∈D(n)ℓ2(λ)
also equals the number of partitions λofnsuch that 1 occurs at least twice as a part
ofλ, there are no parts equal to 2 or 3, the smallest part greater tha n 4 occurs twice,
and all other parts occur once.
32We end this section by noting that the combinatorial interpretation s for the excess
in Theorem 6.1, respectively 6.2 are of a similar ﬂavor to Theorem 1.5.
7.Further conjectures
We conclude this paper with several remarks and conjectures. In particular, we ex-
plorepossiblegeneralizationsofourmainresults toothervaluesof tandotherfamilies
of partitions. We also remark brieﬂy on an apparent congruence wh ich appears in
our data.
7.1.A stronger conjecture. Recall Conjecture 1.7 (ii), which says that for all
integerst≥2,at(n)−bt(n)→ ∞asn→ ∞. Corollaries 5.3 and 5.5 establish
Conjecture 1.7 (ii) for t= 2 and t= 3.We also conjecture the following stronger
asymptotic result, which is proved for t= 2 and t= 3 in Corollaries 5.4 and 5.6.
Conjecture 7.1. For every integer t≥2, there is a positive constant αt>1such
thatat(n)∼αtbt(n)asn→ ∞.
We now give a heuristic explanation for why one should think that Conj ecture 7.1
is true. Due to Euler, we know that the number of partitions into odd parts equals
the number of partitions into distinct parts. Thus, the total numb er of cells among
the two families of partitions are also equal and, as noted in Section 1 , we have for
everynthat
/summationdisplay
t≥1at(n) =/summationdisplay
t≥1bt(n). (7.1)
Corollary 1.6 states that b1(n)> a1(n), and the main theorems of our paper establish
thatat(n)> bt(n) fort= 2,3 andnsuﬃciently large. To explain this phenomenon
informally, let λ∈ O(n) andµ∈ D(n) be random partitions of the same (suﬃciently
large) integer n. Theorem 1.5 implies that, on average, µshould have more hooks of
length 1 than λ. In order to balance this fact with (7.1), λmust have more hooks of
other lengths t. Since there are in general more “small” hook lengths than “large”
hook lengths in a given partition, we should expect the “small” hook len gths to be
the main contribution to balancing (7.1). Our results do not consider what happens
iftis allowed to vary with n, so we do not know whether a random odd partition
or a random distinct partition should have more “large” hook number s. However,
the data we obtain, in particular the fact that Ntappears to grow with t, suggests
that forn≤Ntit is usually true that bt(n)> at(n), contrary to the case for n≫0.
This suggests that the hook numbers of partitions into distinct par ts tend to be
either equal to 1 or large relative to n, while partitions into odd parts tend to have
hook numbers of more intermediate values. It would be interesting t o understand
this phenomenon in more detail. For example, given a positive constan t 0< ε <1,
one could ask whether odd or distinct partitions have more hook num bers of size
t≥nε. Our heuristic suggests that for large enough εin this interval, hooks of length
t≥nεshould be more common in distinct partitions of nthan in odd partitions
ofn. It would also be interesting to understand this picture in terms of p robability
distribution functions. Such a possibility is discussed further in Sect ion 7.4.
337.2.Hook bias conjectures for self-conjugate versus distinct o dd parts par-
titions. Since the number of self-conjugate partitions of nequals the number of
partitions of ninto distinct odd parts, one may study the possible bias in the number
of hooks of ﬁxed length in these sets of partitions. To this end, let a∗
t(n) be the total
number of hooks of length tin all self-conjugate partitions of nand letb∗
t(n) be the
total number of hooks of length tin all partitions of ninto distinct odd parts. We
propose the following conjecture, which is the analog of Conjectur e 1.7.
Conjecture 7.2. For every integer t≥2, there is an integer N∗
tsuch that for all
n > N t, we have a∗
t(n)≥b∗
t(n). Furthermore, we have a∗
t(n)−b∗
t(n)→ ∞asn→ ∞.
The following table gives conjectural values of the constants N∗
tfor 2≤t≤10.
t2345678910
N∗
t10822123020383254
Table: Conjectural values for N∗
t.
The explanation of this conjecture is, on heuristic grounds, the sa me as that for
Conjecture 1.7. In particular, it appears that the hook numbers o f partitions into
distinctoddpartstendtobeeitherverysmallorverylarge, where asthehooknumbers
of self-conjugate partitions tend to take intermediate values. It would be equally
natural to investigate such questions for other well-known partit ion identities. For
example, one could consider the Rogers-Ramanujan identities or Gla isher’s identity
involving k-regularpartitionsandpartitionswithpartsrepeatedatmost( k−1)times.
7.3.Congruence conjectures. We now consider a∗
t(n), the number of hooks of
lengthtin all self-conjugate partitions of n, from an arithmetic point of view. By the
symmetry of self-conjugate partitions, it is clear that a∗
2m(n)≡0 (mod 2) for all n;
this is because hook numbers on the main diagonal of a self-conjuga te partition are
necessarily (distinct) odd integers. While generating data in suppor t of Conjecture
7.2, the authors discovered what appear to be nontrivial congrue nce relations for
a∗
t(n) extending the trivial observation above.
Conjecture 7.3. We have for all n≥0andm≥1that
a∗
2m(n)≡0 (mod 2 m).
This has been veriﬁed by computer for 1 ≤m≤5 and 0 ≤n≤70. We note
that if we denote by a∗∗
t(n) the number of hooks of length divisible by tin all self-
conjugate partitions of n, then by using the sieve of Eratosthenes one may show
that the conjecture above is equivalent to showing that a∗∗
2m(n)≡0 (mod 2 m) for all
m≥1 andn≥0.
7.4.Future directions. There are a number of statistical results in the literature
regarding how hook numbers distribute among unrestricted partit ions. For example,
see [3, 5, 8, 16] for several diﬀerent approaches to such distribu tions. Adopting the
same philosophy as this paper, it would be natural to ask how these s tatistics behave
in families of partitions such as partitions into odd parts or partitions into distinct
parts. For example, based on our work and [3] it would be natural t o ask whether the
2-cores and 3-cores of partitions into distinct parts might be large r on average than
those of partitionsinto oddparts. It would also benatural to ask s imilar questions for
34partitionstatisticsotherthanthosestatisticsdiscussed inthispa per; afewpotentially
interesting examples might be the largest/smallest part or rank and crank statistics.
Data availability. Data sharing not applicable to this article as no datasets were
generated or analysed during the current study.
References
[1] George E. Andrews. The theory of partitions . Cambridge Mathematical Library. Cambridge
University Press, Cambridge, 1998. Reprint of the 1976 original.
[2] George E. Andrews. Euler’s partition identity and two problems of George Beck. Math. Student ,
86(1-2):115–119, 2017.
[3] Arvind Ayyer and Shubham Sinha. The size of t-cores and hook len gths of random cells in
random partitions. The Annals of Applied Probability , 33(1):85 – 106, 2023.
[4] Olivia Beckwith and Christine Bessenrodt. Multiplicative properties of the number of k-regular
partitions. Ann. Comb. , 20(2):231–250, 2016.
[5] Kathrin Bringmann, William Craig, Joshua Males, and Ken Ono. Distrib utions on partitions
arising from hilbert schemes and hook lengths. Forum of Mathematics, Sigma , 10:e49, 2022.
[6] William Craig. On the number of parts in congruence classes for par titions into distinct parts.
Research in Number Theory , 8(3):52, 2022.
[7] P. Erd˝ os, J.-L. Nicolas, and M. Szalay. Partitions into parts whic h are unequal and large. In
Number theory (Ulm, 1987) , volume 1380 of Lecture Notes in Math. , pages 19–30. Springer,
New York, 1989.
[8] Michael Griﬃn, Ken Ono, and Wei-Lun Tsai.Distributions ofhooklen gths in integerpartitions.
Proceedings of the American Mathematical Society , In press.
[9] Peter Hagis, Jr. Partitions into odd summands. Amer. J. Math. , 85:213–222, 1963.
[10] Guo-Niu Han. The Nekrasov-Okounkov hook length formula: re ﬁnement, elementary proof,
extension and applications. Ann. Inst. Fourier (Grenoble) , 60(1):1–29, 2010.
[11] Guo-Niu Han and Huan Xiong. New hook-content formulas for st rict partitions. In 28th In-
ternational Conference on Formal Power Series and Algebrai c Combinatorics (FPSAC 2016) ,
Discrete Math. Theor. Comput. Sci. Proc., BC, pages 635–645. 20 16.
[12] Guo-Niu Han and Huan Xiong. New hook-content formulas for st rict partitions. J. Algebraic
Combin., 45(4):1001–1019, 2017.
[13] Gordon H. Hardy and Srinivasa Ramanujan. Asymptotic formula e in combinatory analysis.
Journal of The London Mathematical Society-second Series , 17:75–115.
[14] Faye Jackson and Misheel Otgonbayar. Biases among congrue nce classes for parts in k-regular
partitions. arXiv preprint arXiv:2207.04352 , 2022.
[15] JacobKatriel. Asymptotically trivial linearhomogeneouspartitio n inequalities. J. Number The-
ory, 184:107–121, 2018.
[16] Hannah Lang, Hamilton Wan, and Nancy Xu. Distributions of hook lengths divisible by two or
three.Journal of Number Theory , 246:227–251, 2023.
[17] Sho Matsumoto and Piotr ´Sniady. Random strict partitions and random shifted tableaux. Se-
lecta Math. (N.S.) , 26(1):Paper No. 10, 59, 2020.
[18] Nikita A. Nekrasov and Andrei Okounkov. Seiberg-Witten theo ry and random partitions. In
The unity of mathematics , volume 244 of Progr. Math. , pages 525–596. Birkh¨ auser Boston,
Boston, MA, 2006.
[19] Hieu T. Ngo and Robert C. Rhoades. Integer partitions, proba bilities and quantum modular
forms.Res. Math. Sci. , 4:Paper No. 17, 36, 2017.
[20] OEIS Foundation. Entry A265251 in The On-Line Encyclopedia of Integer Sequences.
http://oeis.org/A265251 , 2017.
[21] FrankW.J.Olver. Asymptotics and special functions . AKPClassics.AKPetersLtd., Wellesley,
MA, 1997. Reprint of the 1974 original [Academic Press, New York].
[22] Hans Rademacher. On the partition function p(n). Proceedings of the London Mathematical
Society, s2-43(1):241–254, 1938.
35[23] Hans Rademacher. Topics in analytic number theory . Die Grundlehren der mathematischen
Wissenschaften, Band 169. Springer-Verlag, New York-Heidelber g, 1973. Edited by E. Gross-
wald, J. Lehner and M. Newman.
[24] Issai Schur. ¨Uber die Darstellung der symmetrischen und der alternierenden Gru ppe durch
gebrochene lineare Substitutionen. J. Reine Angew. Math. , 139:155–250, 1911.
[25] Richard P. Stanley. Enumerative combinatorics. Vol. 2 , volume 62 of Cambridge Studies in
Advanced Mathematics . Cambridge University Press, Cambridge, 1999.
[26] WOLFRAM.Numericalnonlinearlocaloptimization. https://reference.wolfram.com/language/tutorial/Con strainedOptimizationLocalNumerical.html#1422430628 .
[27] E. M. Wright. Stacks. II. Quart. J. Math. Oxford Ser. (2) , 22:107–116, 1971.
[28] DonZagier. The Mellin transform and related analytic techniques, In: E . Zeidler, Quantum ﬁeld
theory. I. Basics in mathematics and physics . A bridge between mathematicians and physicists.
Springer-Verlag, Berlin, 305–323, 2006.
Department of Mathematics and Computer Science, College of the Holy Cross,
Worcester, MA 01610, USA
Email address :cballant@holycross.edu
School of Mathematics, University of Minnesota, Twin Citie s, 127 Vincent Hall
206 Church St. SE, Minneapolis, MN 55455, USA
Email address :hburson@umn.edu
Mathematical Institute, University of Cologne, Gyrhofstr . 8b, 50931 Cologne,
Germany
Email address :wcraig@uni-koeln.de
Department of Mathematics and Statistics, Amherst College , Amherst, MA 01002,
USA
Email address :afolsom@amherst.edu
Department of Mathematics, University of Wisconsin, 480 Li ncoln Drive, Madison,
WI 53706, USA
Email address :bwen25@wisc.edu
36