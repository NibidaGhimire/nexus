Damage Preserving Transformation for Materials with Microstructure
Philip P. Müllera, Falk K. Wittela, David S. Kammera,∗
aInstitute for Building Materials (IfB), ETH Zuerich, Laura-Hezner-Weg 7, 8093, Zuerich, Switzerland
Abstract
The failure of heterogeneous materials with microstructures is a complex process of damage nucleation, growth and
localisation. This process spans multiple length scales and is challenging to simulate numerically due to its high com-
putational cost. One option is to use domain decomposed multi-scale methods with dynamical reﬁnement. If needed,
these methods reﬁne coarse regions into a ﬁne-scale representation to explicitly model the damage in the microstructure.
However, damage evolution is commonly restricted to ﬁne-scale regions only. Thus, they are unable to capture the
full complexity and breath of the degradation process in the material. In this contribution, a generic procedure that
allows to account for damage in all representations is proposed. The approach combines a specially designed orthotropic
damage law, with a scheme to generate pre-damaged ﬁne-scale microstructures. Results indicate that the damage ap-
proximation for the coarse representation works well. Furthermore, the generated ﬁne-scale damage patterns are overall
consistent with explicitly simulated damage patterns. Minor discrepancies occur in the generation but subsequently
vanish when explicit damage evolution continuous; for instance under increased load. The presented approach provides
a methodological basis for adaptive multi-scale simulation schemes with consistent damage evolution.
Keywords: Lattice, Continuum damage mechanics, Microstrutured disordered material, Anisotropic damage,
Multi-scale simulation, Harmonic decomposition, Damage modelling
∗Corresponding author
Email addresses: phimuell@ethz.ch (Philip P. Müller),
fwittel@ethz.ch (Falk K. Wittel), dkammer@ethz.ch (David S.
Kammer)Contents
1 Introduction 3
2 Materials and Methods 4
2.1 Generic Damage Transforming Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.2 Continuum Representation of 2D Isotropic Continua with Damage . . . . . . . . . . . . . . . . . . . . . . 4
2.3 Exemplary Material Motive . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2.4 Determining the Damage Law for the Continuum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.5 Process for the Construction of a Damaged Lattice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.6 Numerical Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.6.1 Numerical Simulation Procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.6.2 The UniformSim Simulation Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.6.3 The MultiLoadSim Simulation Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.6.4 The ReconstrSim Simulation Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
3 Results 8
3.1 Details of a Numerical Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
3.2 Estimation of the Damage Law /hatwideD(# κ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
3.3 Test of the Damage Evolution Law /hatwideD(# κ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.4 Estimation of the Transfer Function# /hatwider(# κ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.5 Tests of the Reconstruction Process . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
4 Summary and Conclusion 15
5 CRediT 15
6 Declaration of Competing Interest 15
7 Data Availability 15
Appendix A Parameters of /hatwiderx(κx)and/hatwidery(κy) 16
Appendix B Inﬂuence of the Characteristic Length /lscript 16
Appendix C Inﬂuence of the Number of Loading Steps 17
References 18
21. Introduction
At a certain scale even heterogeneous materials will
appear homogeneous and some can even be considered
isotropic. Among others, this is true for concrete, one
of the most widely used commodity on earth, a mixture
made of sand, aggregates, cement, water and chemical ad-
mixtures. The growth of damage inside concrete is highly
aﬀected by the particular microstructure, where, depend-
ing on the scale, aggregates or even sand grains act either
as focal points for stresses or obstacles for damage.
Damage initiates at very small scales, long before the
macroscopic structure itself will fail or crack. Instead, the
damage leads to a reduction of the material’s stiﬀness.
Nevertheless, at one point the accumulated damage be-
comes so widespread, that even its smallest increase, will
trigger the previously isolated nuclei to merge. This leads
to a cascade of increasingly larger defects, culminating in
the emergence of a macroscopic crack.
Continuum based methods are the methods of choice
if large structures should be simulated, due to their com-
putational eﬃciency. For taking into account intrinsic de-
generative processes constitutive laws are used. One of the
earliest, but still widely used laws for modelling damage in
concrete was proposed by Mazars (Lemaître, 2001; Mazars
et al., 1985). It employs a scalar damage variable to de-
grade the material’s stiﬀness. However, even if the mate-
rial was initially isotropic, damage will induce anisotropy
into the material’s behaviour. Clearly any scalar damage
variable is inherently unable to capture this. During the
years, a variety of anisotropic damage models were pro-
posed to address this issue (Brancherie et al., 2009; Braun
et al., 2021; H. Chen et al., 2016; Delaplace et al., 2008;
Desmorat et al., 2007; Gaede et al., 2013). All of them con-
sider the accumulated eﬀects of the damage’s growth, rep-
resented by internal state variables at the material points
and by that disregard the actual microstructure, whose
degeneration is the actual cause for the emerging damage.
To overcome this deﬁciency, the entire microstructure
could be explicitly represented and simulated. Unfortu-
nately, even with today’s fast computers, this is only pos-
sible for small sizes. A way to overcome this barrier are
multi-scale methods. They allow to invest computational
power exactly where it is needed, by combining diﬀerent
representations. Although, many diﬀerent methods were
proposed over the past years, they can be classiﬁed to be
either of hierarchical or of concurrent nature (Budarapu
et al., 2017; Liu, 2018; Lloberas-Valls et al., 2012a; Matou
et al., 2017; Unger and Eckardt, 2011).
Hierarchical methods, such as (Eliá et al., 2022; Reza-
khani et al., 2017; X. Sun et al., 2019; Xu et al., 2023), are
characterised by a full separation of scales, which allows
to treat every level independently from each other. Thus,
the information is passed between the diﬀerent levels as
one serves as input for the hierarchically higher level.
Opposed to this, concurrent methods, such as (Lloberas-
Valls et al., 2012b; Miller et al., 2009; Xiao et al., 2004),lack the full separation of scales and typically decompose
the computational domain into diﬀerent regions. Imagine
a typical setting where high accuracy is only needed inside
a small part of the computational domain, for example
around a crack tip. Ideally, one limits methods with high
accuracy but large computational burden to these small re-
gions, while the remaining part of the computational do-
main is described by much more eﬃcient methods. The
link between the diﬀerent regions is established by a cou-
pling scheme (Bitencourt et al., 2015; Farhat et al., 1991;
Lloberas-Valls et al., 2012b; Unger and Eckardt, 2011),
of which the Arlequin method is a particular general one
(Anciaux et al., 2008; Bauman et al., 2008; Guidault et al.,
2007; Unger and Eckardt, 2011; Wellmann et al., 2012).
Whenever the domain decomposition is not available in
advance, one must resort to adaptive methods, which re-
ﬁne regions on demand ( e.g., P. Y. Chen et al., 2021; Evan-
gelista, Alves, et al., 2020; Evangelista and Moreira, 2020;
Rodrigues et al., 2018; Unger and Eckardt, 2011; Zhang
et al., 2012). However, important questions are (i) how are
the regions that need to be reﬁned identiﬁed, and (ii) how
is the loading history of the coarse connected to the initial
state of the newly created ﬁne scale representation? Espe-
cially (ii) does not seem to be addressed well in literature.
Some authors assume that the coarse representation does
not accumulate any damage prior to reﬁnement, which is
triggered by a stress or strain based criteria (L. Chen et
al., 2021; P. Y. Chen et al., 2021; Rodrigues et al., 2018;
Unger, Eckardt, and Konke, 2011). Other authors link the
reﬁnement criteria to a damage law (Lloberas-Valls et al.,
2012b; Rezakhani et al., 2017; B. Sun et al., 2015; X. Sun
et al., 2019; Xu et al., 2023). Since most damage laws
employ a threshold below which it is inactive, reﬁnement
is triggered the ﬁrst time the loading surpasses it. Both
approaches restrict damage evolution only to reﬁned re-
gions, but have the advantage that the reﬁned region is
always undamaged at the beginning. Consequently, the
entire load history of the coarse regions is disregarded and
reﬁnement might occur unnecessarily early, since even the
smallest damage triggers a reﬁnement.
In this paper we propose, to the best of our knowledge,
a generic approach for the reﬁnement step in adaptive con-
current multi-scale simulations, which allows to account
for the damage evolution inside the coarse representation.
To this end, we equip the coarse scale representation with
its own anisotropic damage measure, which is based on a
damage variable recently presented by Oliver-Leblond et
al. (2021). Further, we develop a scheme to create ﬁne
scale representations with a certain initial damage pat-
tern on the ﬂy. This allows us to create ﬁne scale regions
that already contain an initial damage. Together, these
two components will allow to include damage evolution
in unreﬁned regions and to incorporate the coarse loading
history upon reﬁnement. In addition, the coarse damage
measure will allows much better control of the reﬁnement.
While our approach is generic and rather simple, its
practical details highly depend on the selected represen-
3tations. Thus, we demonstrate it by applying it to one
particular test case. The reminder of this paper is organ-
ised as follows: In Sec. 2, we explain our method in more
detail and present the proposed techniques. In Sec. 3 we
determine the parameters of our method and asses its ap-
plicability, before we draw ﬁnal conclusions in Sec. 4.
2. Materials and Methods
The particular choice of the material’s microstructure,
also called motive, is in general arbitrary, but should fol-
low principles of representative volume elements (RVE)
(Lemaître and Desmorat, 2005). The state of a discrete
representation with its inherent characteristic structure is
fully given by r, that describes every single discrete ele-
ment (right side of Fig. 1). In this representation, damage
D(r)is given by the irreversible degeneration of the con-
stituting elements. On the left side of Fig. 1, the smeared
continuum representation is shown, which lacks such an
explicit microstructure and only considers cumulative ef-
fects of the damage through internal state variables added
to the constitutive law. Here, damage is given by D, which
depends on the state# κat a particular location and is em-
bedded in the constitutive law.
Figure 1: The continuum damage depends on the continuum state# κand
has value D. Formally Dis a fourth order tensor, but in this work we
are using the second order tensor Dto represent damage. The discrete
damage D(r)depends on rand hence on the state of all discrete elements
of the lattice. The two representations as well as their damages are inter-
connected to each other by the homogenisation and reﬁnement processes,
respectively.
Scale of the lattice is exaggerated.
Since the continuum representation loses its validity
once cracks localise, one must reﬁne the continuum to its
discrete twin in such way that all important aspects of the
fracture will be captured accurately on the ﬁne scale. The
key for a meaningful adaptive modelling of the damage
evolution lies in the transformation of the continuum to
the discrete representation, that conserves the degraded
mechanical behaviour found inside the continuum. One
focus of this work is an approach to construct a discrete
representation that respects the preceding damage present
in the continuum representation.
Even though the procedure is generic and in principal
not restricted to speciﬁc numerical material representa-
tions, this paper focuses on one particular choice. How-
ever, we will outline the generic way of working with the
method (see Sec. 2.1), before we start with our speciﬁc
choice. We exemplary chose a two-dimensional plane stress,
isotropic material (see Sec. 2.2) with an underlying mate-
rial heterogeneity represented by a triangular network ofbeam-truss elements with linear-elastic, brittle behaviour
with quenched disorder of breaking thresholds (see Sec. 2.3).
We then discuss the particular choice of the damage law
as well as the reconstruction step (see Secs. 2.4, 2.5). To
determine and test them, we use data obtained from nu-
merical simulations (see Sec. 2.6).
2.1. Generic Damage Transforming Method
Initially, the domain is described as a continuum with-
out any internal structure, whose state is fully described
by the continuum state variable# κ. In the continuum, the
damage evolution is fully govern by the damage function
/hatwideD(# κ). Therefore,/hatwideD(# κ)can be interpreted as the macro-
scopic damage, that is expected for a hypothetical dis-
crete representation with identical loading. Thus we can
determine the function describing the macroscopic dam-
age by homogenising the discrete damage D(r). This leads
to a perspective on the damage law that is diﬀerent from
the conventional one, where the damage law is calibrated
against a physical material. Instead, here the law is cali-
brated against a particular numerical representation of the
material.
When the continuum model experiences a certain dam-
age limit, it is no longer suitable and has to be reﬁned to
a discrete representation. However, this discrete state has
to be consistent with the previous continuum representa-
tion. This includes stiﬀness and damage, which have to
be preserved as much as possible by the transformation.
Determining this reconstruction process challenging, since
it is by its very nature not unique.
2.2. Continuum Representation of 2D Isotropic Continua
with Damage
To represent a two-dimensional isotropic material un-
der plane stress, the Finite Element Method (FEM) and
as damage measure continuum damage mechanics (CDM)
is used (Lemaître, 2001; Lemaître, 1996; Lemaître and
Desmorat, 2005). We use the well known material law:
σ= (I − D )Cε, (1)
where σandεdenote the continuum stress and strain
tensors, respectively, Cis the continuum stiﬀness tensor
of the undamaged material, and Dis the damage tensor.
While in Eq. (1) damage is represented by a fourth order
tensor, in this work we use the second order tensor Dto de-
scribe damage (Lemaître and Desmorat, 2005, Sec. 1.1.4).
This choice allows to account for anisotropic eﬀects, while
avoiding the complexity of fourth order tensors. Due to the
choice of CDM, as continuum damage measure, the dam-
age variable Dcan directly be identiﬁed with the damage
function/hatwideD(# κ). Further, we identify# κas the continuum
state variable given as
# κ:=/parenleftbiggκx
κy/parenrightbigg
. (2)
4A zoning approach is used to divide the principal strain
space along an angle χ, known as zone boundary, into an
x- (shaded red parts) and y-zone (shaded yellow parts in
Fig. 2). The two components κxandκyrepresent the max-
imal reached principal tensile strain in xandydirection,
respectively, i.e.
κx:= max/parenleftbig
κx,/angbracketleftε1/angbracketright+/parenrightbig
, κ y:= max/parenleftbig
κy,/angbracketleftε2/angbracketright+/parenrightbig
.
While ε1andε2are the eigenvalues of the strain tensor
ε, its eigenvectors form a Givens rotation matrix of angle
Γ, which is sometimes called eigenangle. The angle Γ,
together with the boundary χ, determines which zone the
eigenvalues are associated with, see Fig. 2.
Figure 2: Interpretation of the zone boundary parameter χ. While ε1
and ε2are the eigenvalues of ε, its eigenvectors are described by the
value Γ. The eigenangle Γand the zone boundary χdetermines which
eigenvalue acts in which direction.
In the initial phase, where the CDM is used, the dam-
age is still small. This allows us to make some simplifying
assumptions on the damage variable D, that will also af-
fect/hatwideD(# κ): (i) We assume that the damage is orthotropic
which reduces Dto a diagonal matrix. For that reason,
we will only consider the eigenvalues of D, cf. Eq. (11).
(ii) We assume that there is no coupling between the di-
rections. Thus, a change of κx(κy) will only aﬀect the
damage along the x-direction ( y-direction). Later we will
slightly relax this assumption, cf. Eq. (12).
2.3. Exemplary Material Motive
The example material motive chosen here is based on
models proposed in Refs. (Herrmann et al., 1989; Mier,
2017), namely a regular triangular lattice but formed by
3rdorder Reddy truss-beam elements with characteristic
lattice size /lscript(Reddy, 1997; Reddy et al., 1997). Using
beams allows to include bending properties and the re-
sulting lattice is able to represent a Cosserat continuum
(Ostoja-Starzewski, 2008; Vardoulakis, 2019). The mi-
croscopical beams consist of an isotropic material with
Young’s modulus Eband Poisson’s ratio νb. A list of all
used material parameters is given in Tab. I. In a multi-
scale simulation, Ebhas to be chosen such that the result-
ing behaviour of the discrete structure matches the one ofthe continuum, i.e.its stiﬀness tensor C. However, since
this paper studies the reﬁnement step in isolation, with-
out having an actual continuum phase, the choice of Ebis
actually irrelevant.
Table I: Parameters of the discrete material motive.
Property Value Unit
Nx,Ny 300,346 [−]
Lx,Ly 2,1.998 m
H 1 m
Eb 1×106Pa
νb 0.3 [−]
kε 3 [−]
λε 0.02 [−]
kΦ 3◦
λΦ 0.02 [−]
Lattice Geometry. The motive is deﬁned by the number of
nodes (Nx, Ny)inx- and y-direction, the spatial extension
inx-direction Lx, with resulting characteristic lattice size
/lscript:=Lx/(Nx−1)and spatial y-extension Ly:=Ny/lscript√
3/2.
The inﬂuence of /lscripton the damage evolution is small (see
Appendix B). An out-of-plane height of His assumed. To
remove the symmetries of the lattice, topological disorder
is introduced (Moukarzel et al., 1992; Wittel, 2006) by
adding the random displacement
# x∆
i:=a/lscript
2# x∗
i (3)
to every internal node of the grid, where# x∗
iis a random
vector sampled uniformly from the unit circle (see Fig. 3a).
The distortion is controlled by parameter a∈[0,1[, known
as distortion level.
Figure 3: (a) Distortion of the central node, ignoring the distortion of the
surrounding nodes. The location of the distorted node (yellow circle), is
randomly selected within the blue circle of radius a/lscript/2. Afterwards, the
length of the beams are adjusted to match the new node location (black
lines). (b) The thickness of beam iis given as ti:=A(O)
i//lscripti, where /lscriptiis
its length and A(O)
iis the area the beam is representing. Points zLand
zKare centres of the adjacent triangles’ incircles.
Geometrical Properties of Beam-Truss Elements. The
thickness of beam i, denoted as ti, depends on the lat-
tice’s geometry. It is given as ti:=A(O)
i//lscripti, where A(O)
i
is the area represented by the beam and /lscriptiits length, see
5Fig. 3b. The area A(O)
iis formally deﬁned as the set of
points that are closer to beam ithan any other beam, but
are inside the lattice. It can be determined by ﬁnding the
intersection of the angle’s bisectors, i.e.centre of the incir-
cle, of the two adjacent triangles denoted as zKandzLin
Fig. 3b. In case the beam is part of the boundary A(O)
iis
artiﬁcially doubled. This ensures that in a regular lattice
all beams have the same axial rigidity.
Damage Criterion Applied to the Beam-Truss Lattice. In
the discrete representation, damage is the irreversible fail-
ure of elements, namely the reduction of their contributing
stiﬀness to an insigniﬁcant level. To determine if a beam
has surpassed its loading capacity, the elliptical criterion
/parenleftbiggεi
εi;th/parenrightbigg2
+max/parenleftBig/vextendsingle/vextendsingle/vextendsingleΦ(r)
i/vextendsingle/vextendsingle/vextendsingle,/vextendsingle/vextendsingle/vextendsingleΦ(l)
i/vextendsingle/vextendsingle/vextendsingle/parenrightBig
Φi;th=: Ψ i≥1 (4)
is used, where εi;thand Φi;thare the beam’s elongation
and bending thresholds, respectively (Herrmann et al.,
1989). Both thresholds are sampled independently from
the Weibull distributions εi;thiid∼Weib (kε, λε)andΦi;thiid∼
Weib (kΦ, λΦ).
The Discrete State Variable# r.The discrete state is
uniquely described by r. However, for the context of this
paper the surrogate discrete state variable
# r:=/parenleftbigg
rx
ry/parenrightbigg
(5)
is introduced and termed “discrete state variable” . Since# rhas only two components it does not uniquely describe
the damaged state. This ambiguity will be resolved by
the reconstruction process (see Sec. 2.5).# ris a purely
mathematical quantity designed to have certain properties.
First, its 1-norm/tildewider:=/bardbl# r/bardbl1:=|rx|+|rx|equals toNf/NT,
where Nfis the number of failed beams and NTthe total
number of beams in the lattice. /tildewideris also called the ratio of
failed beams (rfb). Second, its components are deﬁned by
associating them to the x- and y-zone, respectively, similar
to# κ(see Sec. 2.2). But while κxis connected to strains
in the x-zone, rxis related to the amount of beams that
have failed due to κx.
2.4. Determining the Damage Law for the Continuum
The damage function /hatwideD(# κ)will take the role of the
damage variable Dinside the constitutive equation (1).
Thus,/hatwideD(# κ)has to be designed such that its evolution
mimics the expected behaviour of D(see Sec. 3.2). For
the extraction, which involves two steps, the Uniform-
Simsimulation data of fully discrete lattices is used (see
Sec. 2.6.2).Step 1: Eﬀective Material Stiﬀness Tensor C.First, the
eﬀective stiﬀness tensor Cis calculated by homogenisation.
After the convergence of each loading step, the following
seven strain-states



1
2
3
,
4
5
0
,
6
0
0
,
0
7
0
,
0
0
8
,
9
0
10
,
0
9
8


, (6)
denoted as (εxx, εyy,2εxy)T×10−3, were applied to the
lattice, while blocking further damage to measure the re-
sulting stresses. This results in an overdetermined system
of21equations for the 6unknown coeﬃcients of C, which
is solved by a least-square approach.
Step 2: Determining the Damage Variable D.Second,
the damage variable Dis extracted from the eﬀective stiﬀ-
ness tensors of the lattice. For this, a technique originally
presented by Oliver-Leblond et al. (2021) is used. For com-
pleteness, the relevant equations are replicated to be
d(T) := tr 1,2[T] =Tkkij, (7a)
K:=1
4tr/bracketleftBig
d(C)/bracketrightBig
, (7b)
D:=D/bracketleftBig
C,/hatwideC/bracketrightBig
:=1
2K/parenleftbigg
d(C)−d/parenleftBig
/hatwideC/parenrightBig/parenrightbigg
. (7c)
The tensor deﬁned by Eq. (7a) is also known as dilatation
second order tensor, while scalar Kof Eq. (7b) is the bulk
modulus. Eq. (7c) combines the eﬀective Cand undam-
aged stiﬀness tensor /hatwideCto the damage variable D.Dis
by construction a real symmetric 2×2matrix, thus fully
characterised by its two eigenvalues d(x)andd(y)as well as
a single scalar Γ, describing the rotation of its eigenbasis
(see Fig. 2).
2.5. Process for the Construction of a Damaged Lattice
The reconstruction process, i.e.the creation of a dis-
crete lattice with a particular damage, involves two compo-
nents: (i) The transfer function# /hatwider(# κ), which transforms
the continuum state# κinto the discrete surrogate state
variable# r. (ii) A scheme which transforms the surrogate
state# rinto the full discrete state r. Hence, the scheme
must be able to resolve the inherently present ambiguity in# r. As direct consequence of the deﬁnition of the discrete
state# r(see Eq. (5)), the transfer function is given as
# /hatwider(# κ) :=/parenleftbigg/hatwiderx(κx)
/hatwidery(κy)/parenrightbigg
. (8)
As for the damage function /hatwideD(# κ), we are using data ob-
tained from the UniformSim simulations (see Sec. 2.6.2)
to empirically determine the function# /hatwider(# κ)that approxi-
mates# r. Due to the nature of# rit is impossible to mea-
sure its components and thus to ﬁt them directly. How-
ever, it is easy to measure and ﬁt the quantity /tildewider:=/bardbl# r/bardbl1.
6Because of the speciﬁc design of the simulations and as-
sumptions, it is possible to associate the value /tildewiderto the
components of# r, see Sec. 2.6.2.
For reconstructing the full discrete state, a probabilis-
tic scheme was devised. It starts by constructing an un-
damaged lattice from which certain beams are removed,
such that the resulting damage matches in a statistical
sense the one given by# κ. Due to the assumed decoupling
between the x- and y-zone, it is possible to handle the two
directions independently. For each direction α,i.e.xand
y, the following steps must be done:
1.From the continuum state καthe corresponding dis-
crete state variable, rα=/hatwiderα(κα)is computed.
Through the relationship Nα:=rα·NT, it is possible
to determine how many failed beams are associated
to this direction.
2.Each beam is assigned a probability deﬁned as
pi∝1
εi;th/vextendsingle/vextendsingle/vextendsingle/angbracketleftBig# bi,# tα/angbracketrightBig/vextendsingle/vextendsingle/vextendsinglek
, (9)
where εi;this the elongation threshold and# bithe di-
rection of the beam. The vector# tα, called “damage
basis”, represents the main damage direction. In our
motive, it is either# tx:= (1 ,0)Tor# ty:= (0 ,1)T.
Finally, parameter k, called “directional weight”, is
a tuning parameter that balances the relative impor-
tance of the two terms and needs to be determined
(see Sec. 3.4).
3.TheNαmany beams to fail are drawn from the prob-
ability distribution deﬁned by Eq. (9) without re-
placement.
4.The selected beams are marked as failed.
2.6. Numerical Simulations
For estimating and testing the damage function /hatwideD(# κ)
and the transfer function# /hatwider(# κ), a series of diﬀerent numer-
ical simulations are carried out on fully discrete lattices.
Due to the randomness of the lattice, 30realisations were
made for each case.
2.6.1. Numerical Simulation Procedure
The numerical simulations were carried out using a
customised version of the Akantu FEM library (Richart et
al., 2015). At the beginning of each loading step the cor-
responding boundary conditions are applied to the lattice.
Then the following iterative procedure is carried out:
First, the equilibrium positions of the nodes is deter-
mined, without considering beam failure. Then, for each
beam that has not yet failed the failure condition Eq. (4)
is evaluated. Among the beams that satisfy the failure
condition the one with the largest Ψvalue is removed.
These steps are repeated until no beam satisfy the failure
condition and the load increment ends.2.6.2. The UniformSim Simulation Setup
The ﬁrst type of simulation, called UniformSim , is used
for estimating the transfer function# /hatwider(# κ)and the damage
law/hatwideD(# κ). These simulations realise an uni-axial strain
Figure 4: Boundary conditions used by the UniformSim series, shown for
the case of ϕ= 0°. In general, the boundary conditions given by Eq. (10)
are applied to the whole boundary. Scale of the lattice is exaggerated.
state of the lattice that is also rotated by an arbitrary but
constant angle ϕ, called the pull direction. (see Fig. 4).
Thus
εϕ:=RϕT/parenleftbigg
/hatwideε10
0 0/parenrightbigg
Rϕ, (10)
where Rϕis the Givens rotation matrix for angle ϕ, is ap-
plied to the lattice’s boundary. In each loading step, /hatwideε1
is increased by 0.0001 until 0.005is reached. The limit is
chosen to ensure that no localisation will occur and that
damage maintains its diﬀuse character. The inﬂuence of
the strain increment on the damage evolution is small (Ap-
pendix C).
The particular setup of the UniformSim simulations
together with the previous assumptions on Dand# /hatwider(# κ)
allows the following conclusions and simpliﬁcations:
(i)A pull direction is either associated to the x- ory-
zone (see Sec. 2.2). This allows to probe the be-
haviour of a single zone. Which zone is probed de-
pends on ϕand the yet unknown zone boundary
value χ.
(ii)A simulation, i.e.a particular value of ϕ, will only
aﬀect the state of either the x- or the y-zone. Thus,
an increase of /hatwideε1will only aﬀect one eigenvalue of D
and a single component of# κas well as# r. Which
component is aﬀected depends on ϕandχ.
(iii) For the continuum state variable the relation /tildewideκ!=
/bardbl# κ/bardbl1!=|κα|!=/hatwideε1holds. Thus, one component
equals the applied uni-axial strain /hatwideε1, while the other
is zero.
(iv) For the discrete state variable, the relation /tildewider!=/bardbl# r/bardbl1!=
|rα|holds. Thus, only one component is non zero and
equals/tildewider. This can be used to determine the compo-
nents of# rfrom/tildewider, once the x- and y-zones are known
(see Sec. 3.4).
72.6.3. The MultiLoadSim Simulation Setup
For testing the damage function as well as the recon-
struction procedure, a second type of simulation is used,
called MultiLoadSim . It realises a bi-axial strain state,
imposed along the x- and y-axes (see Fig. 5). Both strains
are increased until εxx=εyy=εfinis reached, where εfin
is the control parameter. For each simulation, the loading
is imposed in three diﬀerent ways, but each time the same
initial lattice is used:
XThenYSim :εxxis increased in steps of 0.0001 until it
reaches εfinand then maintained. Then εyyis in-
creased by the same increment until εfinis reached.
YThenXSim :The same as XThenYSim , however, the order
of loading the axes is switched.
BothXYSim :Both strains εxxandεyyare increased simul-
taneously, in steps of 0.0001 until εfinis reached.
All three paths reach the same ﬁnal state, εxx=εyy=
κx=κy=εfin, but via diﬀerent paths. As a consequence,
the special relation /tildewideκ:=/bardbl# κ/bardbl1=|εxx|+|εyy|holds in
these simulations. Both, the XThenYSim and the YThenX-
Simloading path impose in the ﬁrst half of the loading an
uni-axial strain state and then switch to a bi-axial strain
state for the second half, while the BothXYSim loading path
imposes a bi-axial strain state from the beginning.
Figure 5: Boundary conditions used in the veriﬁcation simulations. Scale
of the lattice is exaggerated.
2.6.4. The ReconstrSim Simulation Setup
For testing the reconstruction process (see Sec. 2.5), a
third type of simulation is used, called ReconstrSim . The
basic setup is equivalent to UniformSim , but for ϕ= 0°.
Further, a lattice with a certain initial damage is used.
This damage was constructed to match the continuum
state# κ= (/hatwideε,0)T,i.e. the damage created by an uni-
axial strain of /hatwideεapplied along the x-direction. Another
important diﬀerence is, that the loading does not start at
zero but at/hatwideε. In case of a perfectly working reconstruc-
tion process, one would expect no additional damage for
strains ≤/hatwideε.
Unlike the MultiLoadSim tests, which focuses on the
value of the reconstructed damage, these tests focus on
how the reconstructed lattices behave after their recon-
struction. In essence, this test simulates the exchange ofthe continuum representation with the discrete represen-
tation, i.e.the reﬁnement process, which is the core ap-
plication of the proposed method.
3. Results
Our proposed method relies on the damage law /hatwideD(# κ)
used inside the continuum and the reconstruction process.
First, we discuss how we will use the techniques introduced
in Sec. 2 to process the data that we have collected from
the numerical simulations. Then, we determine the dam-
age law/hatwideD(# κ)and the zone boundary value χ(see Sec. 3.2)
followed by an assessment of its accuracy (see Sec. 3.3).
Thereafter, we repeat the process to determine the trans-
fer function# /hatwider(# κ)and the directional weight parameter k
(see Sec. 3.4). Finally, we demonstrate the applicability of
our method (see Sec. 3.5).
3.1. Details of a Numerical Simulation
Let’s consider a setting similar to UniformSim but with
ϕ= 0°(see Fig. 6a). Only one realisation is simulated and
the loading goes beyond /hatwideε1= 0.005.
We measure the normalised stresses (solid lines) and
compare them with the expected ones in case of suppressed
damage, i.e.undamaged case (dashed lines) (Fig. 6b). As
expected, initially the stresses behave predominantly lin-
ear. However, once a strain of about 0.003is reached, we
observe that /hatwideσxxstarts to deviate from the undamaged
case. While this deviation increases with further load-
ing, we cannot observe it for /hatwideσyy, that is much less af-
fected by the loading. At one point, we observe that both
stresses suddenly drop. This is caused by the emergence
of a macroscopic crack, which is the expected behaviour
for a brittle disordered material, such as concrete.
Using the techniques presented in Sec. 2.4, it is possible to
extract the macroscopic damage variable Dfor the lattice,
at any loading step. In Fig. 6c, we show the eigenvalues of
the extracted damage variables where we can see that d(x)
exceeds d(y). This also explains why /hatwideσxxdeviates much
more from the undamaged behaviour when compared to
/hatwideσyy. The underlying reason of this diﬀerence are the hor-
izontal beams. They experience much larger strains than
inclined beams, since they align with the loading and thus
fail at much larger number. From Fig. 6c, we can also see
that d(y)drops for a strain at around 0.002. This is a non-
physical behaviour as damage should always increase. It is
caused by some numerical issues during the determination
of the stiﬀness tensor (see Sec. 2.4) and the sensitivity of
damage extraction process.
Fig. 6d shows the ratio of failed beams (rfb), /tildewider:=/bardbl# r/bardbl1:=
Nf/NT, where Nfis the total number of number of failed
beams and NTthe total beams in the lattice. We will use
it to indirectly estimate the transfer function# /hatwider(# κ).
Figs. 6e-h show snapshots of the lattice’s underlying
microstructure. While taken at diﬀerent loading steps (see
Fig. 6d), they always show the same set of nodes, located
8Figure 6: Representative simulation example. (a) Schematics of the model conﬁguration, scale of the lattice is exaggerated. (b-d) Evolution of
continuum and microstructure properties of the lattice. Dotted lines denote strains beyond the limit of 0.005used in UniformSim . (b) Normalised
measured stresses. Dashed lines represent the behaviour in case of suppressed damage. (c) Eigenvalues of the extracted damage variable D, see Eq. (1).
(d) Ratio of failed beams /tildewiderin the specimen. (e-h) Snapshots of a small section of the microstructure. Colours indicate the remaining load carrying
capacity of the beams /hatwideΨi:= 1−Ψi, where Ψiis deﬁned by Eq. (4). Associated states are indicated in (d) by markers. Bending of beams is not shown.
roughly at the lattice’s centre. While the exact damage
pattern depends on the realisation of the lattice and lo-
cations where the snapshot was taken, statistically they
all look the same. It is this statistical damage pattern
that we want to capture by the transfer function# /hatwider(# κ)
and recreate by the reconstruction process. Whereas the
damage law/hatwideD(# κ)captures the accumulated eﬀects on the
lattice’s macroscopical stiﬀness.
3.2. Estimation of the Damage Law /hatwideD(# κ)
We now study the behaviour of the damage variable D
that we have extracted from the data of the UniformSim
simulations. From these observations, we will determine
the damage function /hatwideD(# κ)as well as the zone boundary
value χ(see Fig. 2).
Functional Form of /hatwidedx(κx)and/hatwidedy(κy).Since we have
assumed an orthotropic damage variable (see Sec. 2.2), we
have to assume the same for the damage function. Thus
arriving the tentative form of the damage function is given
by
/tildewideD(# κ) :=/parenleftbiggdxx(# κ) 0
0 dyy(# κ)/parenrightbigg
.To account for deviations from this assumption, we will
connect the two diagonal elements of the damage func-
tion with the eigenvalues of the measured damage vari-
able. Thus, we have only two functions that we need to
determine.
Fig. 7 shows the evolution of the eigenvalues d(x)and
d(x)from the extracted damage variable for the pull di-
rections ϕ∈ {0°,60°}at various distortion levels. For
ϕ= 0°, the eigenvalue d(x)is much larger than d(y), while
forϕ= 60°the opposite is observed. Later, we will use
this to determine the zone boundary value χ. Most im-
portantly, the ﬁgures show that both eigenvalues follow a
power law, irrespective of the pull direction and distortion.
Thus we approximate the diagonal elements/eigenvalues of
/hatwideD(# κ)as:
dxx≈/hatwidedx(κx;a, ϕ) :=α(x)
a,ϕ·κxβ(x)
a,ϕ, (11a)
dyy≈/hatwidedy(κy;a, ϕ) :=α(y)
a,ϕ·κyβ(y)
a,ϕ. (11b)
The parameters of these approximations depend on the
distortion level aand the pull direction ϕ. Later, we will
eliminate their dependency on ϕand obtain the ﬁnal pa-
rameters that only depend on a, which is constant. Fur-
9Figure 7: Eigenvalues of the extracted damage variable Dfor pull direc-
tions ϕ= 0°(a) and 60°(b). Solid lines correspond to d(x), while dashed
lines correspond to d(y). Colours indicate diﬀerent distortion levels aof
the underlying lattice.
ther, this choice guarantees that the damage is strictly
increasing.
Because of our previous assumption about the indepen-
dence of the directions, the approximations of the eigenval-
ues only depend on a single component of the continuum
state# κ(Sec. 2.2). While this could be justiﬁed due to their
large diﬀerences, that we can see in Fig. 7, we clearly see
that even for ϕ= 0°, there is a certain coupling between
d(x)andd(y). To handle this, we use a simple coupling
scheme, which leads to the ﬁnal damage function
/hatwideD(# κ) := (12)
max/braceleftbigg
/hatwidedx(κx),/hatwidedy(κy)
η/bracerightbigg
0
0 max/braceleftbigg
/hatwidedy(κy),/hatwidedx(κx)
η/bracerightbigg
,
where/hatwidedx(κx)and/hatwidedy(κy)are the approximations of the
eigenvalues deﬁned by Eq. (11) but without the depen-
dence on ϕ. The coupling ensures that the eigenvalues ofthe damage function /hatwideD(# κ)will at most diﬀer by a factor
ofη, which is exactly what we see in the case of uni-axial
loading (see Fig. 7). Here, we will assume that the em-
pirical parameter ηequals 10in all cases. We will later
give a justiﬁcation of the form and value of the proposed
coupling. It is important to notice that this coupling is
designed for the uni-axial case. However, a more elabo-
rated coupling might be needed, depending on the details
of other material motives.
Parameters of /hatwidedx(κx)and/hatwidedy(κy).Since the data, espe-
cially for the non-dominant eigenvalue shows strong vari-
ation for small strains, only data points corresponding to
strains above 0.002were used for the parameter estima-
tion. In Figs. 8a,b, we see that for small values of ϕ,
Figure 8: Values of the α- (a,b) and β-parameters (c,d) with respect to
the pull direction ϕ. Colours indicate diﬀerent distortion levels. Solid
lines correspond to lgα(x)
a,ϕandβ(x)
a,ϕ, while dashed lines to lgα(y)
a,ϕand
β(y)
a,ϕ. Error bars indicate the 95% conﬁdence interval.
theα(x)
a,ϕ-parameters are very close to each other, while for
larger values of ϕone observes a much larger scattering.
10Interestingly, α(y)
a,ϕ-parameters behave inversely. Further-
more, on Fig. 8b we can clearly observe the α(y)
a,ϕdepen-
dence on ϕ. We see that α(y)
a,ϕis small if ϕis small too, but
above a certain value of ϕ, the parameters become much
larger and their scattering increases. The same, but in an
opposite way, holds for the α(x)
a,ϕ-parameters but in a less
pronounced fashion.
The estimates for the β-parameters (see Figs. 8c,d)
show a similar behaviour with respect to ϕ. However,
while we observed a signiﬁcant change in the behaviour
of the α-parameters’ values, from a particular value of ϕ
on we just observe an increase of the variability of β.
In summary, from Fig. 8 we can conclude that the β- and
especially the α(y)-parameters have diﬀerent regimes de-
pending on ϕ. Further, inside such a regime, their partic-
ular value does not depend much on ϕ.
We also saw that the values for the β(x)-parameters for
small values of ϕandβ(y)-parameters for large values of
ϕare both close to three. This means that the growth
behaviour of/hatwidedx(κx)and/hatwidedy(κy)are very similar. This jus-
tiﬁes the form of the coupling used in the damage function
in Eq. (12).
Zone Boundary χ.In Figs. 7 and 8, we have observed
that depending on the pull direction either d(x)ord(y)is
dominant. We now exploit this fact to deﬁne χ. To this
end, we deﬁne the dominance function ζas:
ζ(a, ϕ) := lg/parenleftBigg
d(x)
a,ϕ; ˜κ=0.005
d(y)
a,ϕ; ˜κ=0.005/parenrightBigg
, (13)
with d(α)
a,ϕ; ˜κ=0.005as the damage eigenvalue associated to
direction α, once the uni-axial strain has reached 0.005.
The most important aspects of this function are its sign
and root, to a lesser extend its value. ζ > 0means that
d(x)is dominant, while ζ < 0indicates that d(y)is domi-
nant. Thus, χ, which might depend on the distortion a, is
deﬁned as ζ(a, χ)!= 0.
Examining Fig. 9, we see that, irrespective of the distor-
tion, χmust lie between 30°and 45°. After some exper-
imentation, we decided to use 40°as zone boundary, ir-
respective of the distortion level. A closer analysis might
yield diﬀerent estimations.
ζcan be seen as a measure of the coupling between
d(x)andd(y). Thus, we can used it to determine the value
of the empirical coupling parameter η, see Eq. (12). Our
value η= 10 was selected because it is roughly the mean
value for ϕ= 0°.
Final Parameters of /hatwidedx(κx)and/hatwidedy(κy).Eliminating the
dependency of the α- and β-parameters on the pull di-
rection ϕwill results in parameters that are valid inside
the entire x- ory-zone. For this, we combine the diﬀerent
Figure 9: Dominance function ζ(a, ϕ), Eq. 13, for diﬀerent distortion
parameters a. The x-dominated region, i.e.d(x)/greatermuchd(y), is deﬁned by
ζ >0, while the y-dominated (grey shaded) region, i.e.d(x)/lessmuchd(y), is
deﬁned by ζ <0. The UniformSim data was used.
estimates as:
lgα(x)
a:=1
|X|/summationdisplay
ϕ∈Xlgα(x)
a,ϕ,lgα(y)
a:=1
|Y|/summationdisplay
ϕ∈Ylgα(y)
a,ϕ,(14a)
β(x)
a:=1
|X|/summationdisplay
ϕ∈Xβ(x)
a,ϕ, β(y)
a:=1
|Y|/summationdisplay
ϕ∈Yβ(y)
a,ϕ, (14b)
where Xcontains all the pull directions associated to the
x- and Ythe ones associated to the y-zone. Parameters
associated to the transversal directions are simply ignored,
e.g. lgα(y)
a,ϕ=0°. Further, the functional form of /hatwidedx(κx)and
/hatwidedy(κy)is still given by Eq. (12), just without the depen-
dency on ϕ. Note that Eq. (14) weights the diﬀerent pull
directions equally.
3.3. Test of the Damage Evolution Law /hatwideD(# κ)
We now evaluate how well the damage function is able
to predict the damage of a fully discrete simulation. For
this purpose, the MultiLoadSim simulations are used.
Fig. 10 shows the results of such an experiment for
εfin= 0.002. We can see the eigenvalues, once computed
for the reference (solid), i.e. a fully discrete simulation,
and alternatively computed by the damage function /hatwideD(# κ)
(dash-dotted), i.e. CDM. They are plotted against the
normalised total strain τ:=˜κ/2εfin. Thus, both the X-
ThenYSim (orange) and the YThenXSim (green) load paths
switch from an uni-axial to a bi-axial strain state at τ=
0.5. We observe that irrespective of the loading path the
same ﬁnal damage values are reached. The value depends
on the used method, since the ﬁnal value of the CDM is
diﬀerent from the reference value. Note that this is not
problematic since the CDM is only used during the initial
phase.
Fig. 10 also demonstrates that the damage for the X-
ThenYSim and YThenXSim are very similar to each other.
11Figure 10: Damage eigenvalues for the three diﬀerent loading paths, de-
scribed in Sec. 2.6.3, with ﬁnal strain εfin= 0.002, plotted against
τ:=˜κ/2εfin. Using a fully discrete simulation (solid) as reference and
the CDM damage law /hatwideD(# κ)(dash-dotted). The colours indicates the
three diﬀerent loading paths. The distortion of the lattices was a= 0.3.
However, the eigenvalues are ﬂipped, which is the expected
behaviour. During the ﬁrst half of the loading ( i.e.τ <
0.5), the prediction of the dominant eigenvalue matches
well with the reference value for both loading paths. At
the same time, the non-dominant eigenvalue, i.e.the one
belonging to the transverse direction, is captured with less
but still acceptable accuracy. The mismatch is entirely
due to the rather crude choice of the ηcoupling parameter
(see Eq. (12)). However, it indicates that the proposed
coupling is indeed working.
Nevertheless, for the second half of the loading ( i.e.τ >
0.5) the CDM is unable to capture the evolution to a sat-
isfactory degree. In case of XThenYSim (orange lines), we
see that the CDM approximation of the x-eigenvalue/hatwidedxre-
mains constant, since κxis not aﬀected by a loading along
they-axis. However, we see that in the reference system
d(x)continuously increase (see Fig. 11 for more). The y-
eigenvalue/hatwidedypredicted by the CDM remains initially con-stant due to the coupling. Once /hatwidedy(κy)has become larger
than/hatwidedx(εfin)/η/hatwidedy(κy)starts to increase. However, as it can
be seen form Fig. 10b, the reference d(y)starts to increase
almost immediately.
A diﬀerent case is the BothXYSim loading path. From
Fig. 10, it seems that for τ <0.5its damage grows slower
than the dominant damage observed for the other two
paths. This is because BothXYSim only has half the num-
bers of loading steps the other two have. If this is corrected
for then it would actually grow faster. This indicates that
there is some form of coupling between the two directions
that is not considered correctly.
Figure 11: Final value of the d(x)andd(y)damage eigenvalues, com-
puted using the reference (solid), CDM (dash doted) and reconstruction
(dashed) method, plotted against εfin. The colours indicate the three
diﬀerent loading cases from Sec. 2.6.3. All lattices have a distortion of
a= 0.3.
In Fig. 11, we can see how the ﬁnal damage, i.e.val-
ues of d(x)andd(y)atεxx=εyy=εfin, depend on the
control parameter εfin, using either the reference (solid
lines), the CDM (dash-dotted lines) or the reconstruction
(dashed lines). The colours distinguish the three diﬀerent
load paths that were tested (see Sec. 2.6.3). The collapse
of the lines indicate that the damage is indeed path in-
12dependent, regardless of the ﬁnal strain εfin. However,
the ﬁnal value depends on the particular method that was
used. In in Fig. 10, we observe a gap between the ﬁnal
damage attained by the reference and the one predicted
by the CDM. We can now see that this gap is systematic
and actually increases with larger εfin. This is again in-
dicating that there is some form of coupling between the
directions that is not take into account yet.
3.4. Estimation of the Transfer Function# /hatwider(# κ)
Our procedure to reconstruct a discrete lattice repre-
sentation based on a damaged continuum state (presented
in Sec. 2.5) requires two unknown quantities: First, the
transfer function# /hatwider(# κ), which maps the continuum state# κto the corresponding discrete surrogate state# r. Sec-
ond, the directional weight parameter k, which balances
the orientation and the strength of a beam during the re-
construction process (see Eq. (9)). Analogously to the
determination of the damage function, the data from the
UniformSim is used.
Functional Form of /hatwiderx(κx)and/hatwidery(κy).As mentioned be-
fore, it is impossible to measure the components of# rdi-
rectly. However, as outlined in Sec. 2.6.2# ris connected
to the ratio of failed beam as /tildewider=/bardbl# r/bardbl1=Nf/NT!=rα.
Thus, we can estimate# rindirectly. Fig. 12 shows /tildewiderfor
Figure 12: /angbracketleft˜r/angbracketright:=/angbracketleftbig
/bardbl# r/bardbl1/angbracketrightbig
for pull direction ϕ= 0°, at diﬀerent values
of the distortion parameter a. No qualitative change is observed for
diﬀerent pull directions ϕ.
the pull direction ϕ= 0°at various distortion levels. As we
can see, the distortion level has only minor inﬂuence. Dif-
ferent pull directions do not lead to a qualitative change
(data not shown). For that reason, we approximate the
mean rfb as
/tildewider≈/vextenddouble/vextenddouble/vextenddouble# /hatwider(# κ)/vextenddouble/vextenddouble/vextenddouble
1:=/hatwider(κ;a, ϕ) :=α(r)
a,ϕ·κβ(r)
a,ϕ, (15)
with the two ﬁt parameters α(r)
a,ϕandβ(r)
a,ϕ. Both depend
on the distortion aand the pull direction ϕ. Due to ourprevious assumptions, we can identify its argument κdi-
rectly with/tildewideκ. To eliminate the dependency on ϕwe use
the same method as for the damage function (see Sec. 3.2).
However, parameters associated to pull directions in Xare
used to determine /hatwiderx(κx), while the ones belonging to Y
determine/hatwidery(κy). This will transform the approximation
of the scalar quantity/vextenddouble/vextenddouble/vextenddouble# /hatwider(# κ)/vextenddouble/vextenddouble/vextenddouble
1into the one for# /hatwider(# κ).
For the discussion about the estimated α- and β-para-
meters please see Appendix A.
Directional Weight Parameter k.The empirical tuning
parameter kinﬂuences the selection of beams during the
reconstruction process. It balances a beam’s strength, i.e.
its elongation threshold εth, against how well it aligns with
the damage basis# tα(see Sec. 2.5). We determine ksuch
that the reconstructed damage variable Dresembles the
reference damage Dmost closely. To this end, we deﬁne
Υk:=/vextenddouble/vextenddoubleD11−D11/vextenddouble/vextenddouble
/lscript2+/vextenddouble/vextenddoubleD22−D22/vextenddouble/vextenddouble
/lscript2+2/vextenddouble/vextenddoubleD12−D12/vextenddouble/vextenddouble
/lscript2(16)
as a measure of separation between the two damages. For
minimising Υk, we select a heuristic approach, in which
the reconstruction process (see Sec. 2.5) is run for diﬀer-
ent values of k. The kthat minimises Υkwill then be
used for the remaining part of this paper. However, for
this particular reconstruction process, the used α(r)- and
β(r)-parameters still depended on ϕ. Further, zoning was
ignored and as damage basis the pull direction ϕwas used.
The underlying lattice was not distorted. From Fig. 13 we
Figure 13: Υk, Eq. (16), for some values of kand various pull directions.
The reconstruction process was done on regular grids, without zoning.
Further the pull direction and its orthogonal was used as damage basis.
see that k= 6minimises Υkindependent of the pull di-
rection. We also see that pull directions {30°,90°}seem
to be almost unaﬀected by k, however, their values match
Υk=6. This is an artefact caused by the regular structure
of the underlying lattice and the scalar product used in the
deﬁnition of the selection probability (see Eq. (9)). How-
ever, this artefact is indicating that k= 6is indeed a good
choice.
133.5. Tests of the Reconstruction Process
Now we evaluate the performance of the proposed
reconstruction scheme to create a mechanically equiva-
lent lattice, based solely on the continuum state# κ(see
Sec. 2.5). For veriﬁcation, we use the MultiLoadSim sim-
ulations (see Sec. 2.6.3). In addition, we use the Re-
constrSim simulations to simulate a reﬁnement step (see
Sec. 2.6.4).
The MultiLoadSim Results. In Fig. 14, we see the re-
sults from the MultiLoadSim setup with εfin= 0.002
(see Sec. 2.6.3). They impose the bi-axial strain state
εxx=εyy=εfin, but with loading applied via three dif-
ferent paths. We used this setup before to assess the CDM
(see Sec. 3.3). An important note concerning the recon-
structed states is, that in each loading step the lattice and
hence the damage is constructed anew. Thus, although it
looks like a damage evolution, the damage at any loading
step has no connection to the previous one. However, each
time the same undamaged but distorted lattice was used.
Figure 14: Damage eigenvalues for the three diﬀerent loading paths, de-
scribed in Sec. 2.6.3, with ﬁnal strain εfin= 0.002, plotted against
τ:=˜κ/2εfin. Using fully discrete simulations (solid) as reference and the
reconstructed damage (dashed). The colours indicate the three diﬀerent
loading paths that were taken. The distortion of the lattices was a= 0.3.
See Fig. 10 for the damage evolution predicted by the CDM.
Figure 15: Behaviour of the d(x)and d(y)damage eigenvalues and /tildewider.
Colours indicate diﬀerent reconstruction parameters /hatwideε. Grey is the ref-
erence, i.e.no reconstruction. Circles indicate damage/rfb values of the
lattices directly after reconstruction. Squares indicate damage/rfb values
of the lattices for an applied strain of /hatwideε.
If we now compare the damage from the references
(solid lines) with the one from the reconstructed lattices
(dashed lines) in Fig. 14, we see that the overall dam-
age values are very similar to the ones obtained by the
CDM. As before, we observe that for τ < 0.5the dom-
inant eigenvalues, i.e. d(x)forXThenYSim andd(y)for
YThenXSim , are captured well. Then, for τ > 0.5, these
reconstructed eigenvalues stop growing and thus deviate
from the references (solid lines). An eﬀect we observed
for CDM (dashed lines), too. But if we look at the other
eigenvalues, i.e.d(y)forXThenYSim (orange) and d(x)for
theYThenXSim (green), we see that they start to increase
almost immediately like the reference. This was not the
case for the CDM (dash-dotted lines shown in Fig. 10).
The reconstruction process is aﬀected by the ignored cou-
pling between the directions as well. However, the damage
eigenvalues generated by it follow the reference much bet-
ter than the ones computed by the CDM.
The ReconstrSim Results. Now we are using the Recon-
strSim simulation setup, described in Sec. 2.6.4. The lat-
tices that are used here were reconstructed for the con-
tinuum state# κ= (/hatwideε,0)T. The system is loaded under
uni-axial strain along the x-axis, starting at /hatwideε. This setup
simulates how a discrete region that was loaded up to /hatwideε, as
continuum and then reﬁned behaves upon further loading.
In Fig. 15, we see how the damage eigenvalues d(x)and
d(y)(dashed and dotted lines, respectively) and the rfb /tildewider
(solid lines), evolve for diﬀerent reconstruction strains /hatwideε,
indicated by diﬀerent colours. The grey lines correspond
to the reference without any reconstruction.
14The circles in Fig. 15 indicate the values for d(x),d(y)
and/tildewiderhave in the reconstructed lattice before any loading
was applied to them. The circles associated to /bardbl# r/bardbl1show,
that the reconstructed lattices have a matching rfb value /tildewider
which is a consequence of its construction. It is, however,
much more important, that the reconstructed d(x)eigen-
value (circles), matches the one predicted by the reference.
Thus the process is able to reconstruct the dominant eigen-
value.
We are also observing that d(y)are not as well re-
constructed. This is a consequence of the assumptions
that the components of# rare independent. Since Re-
constrSim only impose strains along the x-axis, we have
κy≡0⇒ry≡0. Thus, the reconstructed y-eigenvalues
we are seeing are caused by a directional sampling eﬀect
created during the reconstruction of the damage. How-
ever, since d(y)is the non-dominant eigenvalue, we expect
and allow that it is less well reconstructed.
The squares in Fig. 15 indicate the state of the lat-
tices after an uni-axial strain of /hatwideεalong the x-axis was
applied to them. The diﬀerence between a square and its
associated circle proves that this strain causes the failure
of additional beams. If the reconstruction process would
work perfectly, any strain below or equal /hatwideεshould not lead
to the failure of any beam. Therefore, we might have re-
moved the right number of beams and these were more or
less correctly oriented, the selection of some of them was
not fully optimal.
Furthermore, we see that for subsequent loading steps,
the damage and rfb continue to increase (Fig. 15). While
the observed values for the restored systems remain above
the reference, the restored lattices slowly converge towards
them. This is because the damage created by the subse-
quent loading steps starts to dominate the artiﬁcial one,
that we created through the restoration process.
4. Summary and Conclusion
In this study, we presented a generic approach for the
creation of a discrete twin of a continuum representation
containing an initial damage. The discrete twin’s damage
is created in such a way, that it is mechanically consistent
to the original’s continuum damage. This is a step towards
adaptive multi-scale simulations, which take the state of
the coarse description of a region into account upon its
reﬁnement.
While the method is general and has no restrictions
concerning the used numerical representations, we pre-
sented it in form of a concrete example. As continuum
representation, we have used FEM with CDM as damage
measure. For the discrete representation, we have used
a lattice based on a triangular grid consisting of brittle
beam-truss elements.
One part of our method is the damage measure used
inside the continuum representation. This measure is used
during the initial continuum phase to track the evolvingcontinuum damage. Unlike classical CDM, that are cali-
brated to match the degradation of a particular material,
we calibrated the CDM against the degeneration of the
discrete numerical representation. Thus, it measures the
degeneration that would occur on a hypothetical ﬁne scale
representation.
We saw that the determined CDM is indeed able to
capture the damage caused by uni-axial strains to a sat-
isfying degree. However, for bi-axial loading, the CDM is
unable to achieve the same. This is explained by the as-
sumption that the directions are independent. Directional
coupling must be used to further improve the CDM’s ac-
curacy
The second part of our method is the ability to con-
struct a discrete damage that is mechanically consistent
to a given continuum state# κ. Since this problem is obvi-
ously not unique, we devised a stochastic scheme to gen-
erate representations containing such a particular discrete
damage.
We have seen, that the reconstruction process is indeed
able to create discrete lattices, whose initial degeneration
is consistent with the given continuum state# κ. A draw-
back is, that imposing a strain that corresponds to# κit-
self, leads to the failing of some additional beams. This
is indicating that the selection process needs to be further
reﬁned. Furthermore, as for the CDM, we observed prob-
lems for bi-axial strains, which are again caused by the
independence assumed between the directions.
Nevertheless, our data is indicating that our approach
works well for the case of uni-axial loading and is in prin-
cipal able to work for bi-axial loading. The next step is to
integrate our method into an adaptive multi-scale simula-
tion scheme.
5. CRediT
Philip Müller: Conceptualisation, Methodology, Soft-
ware, Validation, Writing - Original Draft, Visualisation;
Falk Wittel: Conceptualisation, Writing - Review & Edit-
ing, Supervision; David Kammer: Conceptualisation, Writ-
ing - Review & Editing, Supervision.
6. Declaration of Competing Interest
The authors declare that they have no known compet-
ing ﬁnancial interests or personal relationships that could
have appeared to inﬂuence the work reported in this paper.
7. Data Availability
The simulation data generated in this study have been
deposited in the ETH Research collection database avail-
able at TBA.
15Appendix A. Parameters of /hatwiderx(κx)and/hatwidery(κy)
The ﬁtting parameters (see Eq. (15)) of the ratio of
failed beams (rfb) /tildewider, denoted as α(r)
a,ϕandβ(r)
a,ϕwere esti-
mated in the same way as the ones for the two damage
functions/hatwidedx(κx)and/hatwidedy(κy). Figs. A.16a show the val-
Figure A.16: Dependence of the two ﬁtting parameters of Eq. (15),
lgα(r)
a, ϕ(a) and β(r)
a, ϕ(b), on the pull direction ϕ. Colours indicating
diﬀerent distortion levels a. The error bars is given by the 95% conﬁ-
dence interval.
ues for the α- and A.16b for the β-parameters. Compared
with the parameters we obtained for the damage law (see
Fig. 8) we see much less variability here. This is because
it is far easier to measure this quantity than the damage.
Appendix B. Inﬂuence of the Characteristic Length
/lscript
The characteristic size is deﬁned as /lscript:=Lx/(Nx−1),
where Lxis the specimen’s x-extension and Nxthe num-
ber of nodes along the x-direction. We will now study its
inﬂuence on the observed damage. For this a simulation
similar to UniformSim with ϕ= 0°was performed for dif-
ferent values of Nx. To account for the randomness the
Figure B.17: Evolution of the damage eigenvalues d(x)(solid line) and
d(y)(dashed line) for distortion level a= 0.3. The specimen was strained
along the x-direction up to εend= 0.005. Diﬀerent colours indicate
diﬀerent Nx, number of nodes along the x-direction. Nx= 300 is the
default case, see Table I. For all cases the standard deviation (omitted)
is roughly the same, see Fig. 7.
results are averaged over 30runs. In Fig. B.17 we observe
that, with the exception of the very coarse Nx= 50 grid,
all lines collapse. This shows that the damage evolution is
independent from the discretisation.
16Appendix C. Inﬂuence of the Number of Loading
Steps
In the simulation described in Sec. 2.6, the loading is
increased in steps of 10−4, until the ﬁnal strain of εend=
0.005is reached, which results in 50increments. The ef-
fect of the loading step is studied with a series of simula-
tions similar to UniformSim with ϕ= 0°. The specimen
is loaded until a strain of εend= 0.005is reached, but
with a diﬀerent number of load increments. To account
for the variation each simulation was performed 30times.
In Fig. C.18 we observe that the damage evolution is in-
Figure C.18: Evolution of the damage eigenvalues d(x)(solid line) and
d(y)(dashed line) for distortion level a= 0.3. The specimen was strained
along the x-direction up to εend= 0.005. Diﬀerent colours indicate
number of load steps that were performed to reach it. For all cases the
standard deviation (omitted) is roughly the same, see Fig. 7.
dependent of the loading rate.
17References
Anciaux, G., O. Coulaud, J. Roman, and G. Zerah (2008). “Ghost force reduction and spectral analysis of the 1 D
bridging method” . In: Bulletin of Sociological Methodology/Bulletin de Méthodologie Sociologique . Vol. 37. doi: 10.
1177/075910639203700105 .
Bauman, P. T., H. B. Dhia, N. Elkhodja, J. T. Oden, and S. Prudhomme (2008). “On the application of the Arlequin
method to the coupling of particle and continuum models” . In: Computational Mechanics 42.4. doi: 10.1007/s00466-
008-0291-1 .
Bitencourt, L. A. G., O. L. Manzoli, P. G. C. Prazeres, E. A. Rodrigues, and T. N. Bittencourt (2015). “A coupling
technique for non-matching ﬁnite element meshes” . In: Computer Methods in Applied Mechanics and Engineering
290. doi: 10.1016/j.cma.2015.02.025 .
Brancherie, D. and A. Ibrahimbegovic (2009). “Novel anisotropic continuumdiscrete damage model capable of represent-
ing localized failure of massive structures: Part I: theoretical formulation and numerical implementation” . In: Engi-
neering Computations 26.1. Ed. by A. Ibrahimbegovic, I. Koar, and P. Marovi. doi: 10.1108/02644400910924825 .
Braun, M., I. Iváñez, and M. P. Ariza (2021). “A numerical study of progressive damage in unidirectional composite
materials using a 2D lattice model” . In: Engineering Fracture Mechanics 249. doi: 10.1016/j.engfracmech.2021.
107767 .
Budarapu, P. R. and T. Rabczuk (2017). “Multiscale Methods for Fracture: A ReviewF” . In: Journal of the Indian
Institute of Science 97.3. doi: 10.1007/s41745-017-0041-5 .
Chen, H., Y. Jiao, and Y. Liu (2016). “A nonlocal lattice particle model for fracture simulation of anisotropic materials” .
In:Composites Part B: Engineering 90. doi: 10.1016/j.compositesb.2015.12.028 .
Chen, L., W. Sun, B. Chen, Z. Shi, J. Lai, and J. Feng (2021). “Multiscale study of ﬁbre orientation eﬀect on pullout
and tensile behavior of steel ﬁbre reinforced concrete” . In: Construction and Building Materials 283. doi: 10.1016/
j.conbuildmat.2021.122506 .
Chen, P. Y., M. Chantharayukhonthorn, Y. Yue, E. Grinspun, and K. Kamrin (2021). “Hybrid discrete-continuum
modeling of shear localization in granular media” . In: Journal of the Mechanics and Physics of Solids 153. doi:
10.1016/j.jmps.2021.104404 .
Delaplace, A. and R. Desmorat (2008). “Discrete 3D model as complimentary numerical testing for anisotropic damage” .
In:International Journal of Fracture 148.2. doi: 10.1007/s10704-008-9183-9 .
Desmorat, R., F. Gatuingt, and F. Ragueneau (2007). “Nonlocal anisotropic damage model and related computational
aspects for quasi-brittle materials” . In: Engineering Fracture Mechanics 74.10. doi: 10.1016/j.engfracmech.2006.
09.012 .
Eliá, J. and G. Cusatis (2022). “Homogenization of discrete mesoscale model of concrete for coupled mass transport and
mechanics by asymptotic expansion” . In: Journal of the Mechanics and Physics of Solids 167. doi: 10.1016/j.jmps.
2022.105010 .
Evangelista, F., G. d. S. Alves, J. F. A. Moreira, and G. O. F. d. Paiva (2020). “A globallocal strategy with the
generalized ﬁnite element framework for continuum damage models” . In: Computer Methods in Applied Mechanics
and Engineering 363. doi: 10.1016/j.cma.2020.112888 .
Evangelista, F. and J. F. A. Moreira (2020). “A novel continuum damage model to simulate quasi-brittle failure in mode
I and mixed-mode conditions using a continuous or a continuous-discontinuous strategy” . In: Theoretical and Applied
Fracture Mechanics 109. doi: 10.1016/j.tafmec.2020.102745 .
Farhat, C. and F.-X. Roux (1991). “A method of ﬁnite element tearing and interconnecting and its parallel solution
algorithm” . In: International Journal for Numerical Methods in Engineering 32.6. doi: 10.1002/nme.1620320604 .
Gaede, O., A. Karrech, and K. Regenauer-Lieb (2013). “Anisotropic damage mechanics as a novel approach to improve
pre- and post-failure borehole stability analysis” . In: Geophysical Journal International 193.3. doi: 10.1093/gji/
ggt045 .
Guidault, P.-A. and T. Belytschko (2007). “On the L2 and the H1 couplings for an overlapping domain decomposition
method using Lagrange multipliers” . In: International Journal for Numerical Methods in Engineering 70.3. doi:
10.1002/nme.1882 .
Herrmann, H. J., A. Hansen, and S. Roux (1989). “Fracture of disordered, elastic lattices in two dimensions” . In: Physical
Review B 39.1. doi: 10.1103/PhysRevB.39.637 .
Lemaître, J., ed. (2001). Handbook of materials behavior models . San Diego, CA: Academic Press. 3 pp. isbn: 978-0-12-
443341-0.
Lemaître, J. (1996). A Course on Damage Mechanics . Berlin, Heidelberg: Springer Berlin Heidelberg. doi: 10.1007/978-
3-642-18255-6 .
Lemaître, J. and R. Desmorat (2005). Engineering damage mechanics: ductile, creep, fatigue and brittle failures . Berlin
; New York: Springer. 380 pp. doi: 10.1007/b138882 .
18Liu, J. (2018). “Multi-scale FEM-DEM model for granular materials : micro-scale boundary conditions, statics and
dynamics” . PhD thesis. Technische Universiteit Eindhoven. isbn: 978-90-386-4621-3.
Lloberas-Valls, O., D. Rixen, A. Simone, and L. Sluys (2012a). “On micro-to-macro connections in domain decomposition
multiscale methods” . In: Computer Methods in Applied Mechanics and Engineering 225-228. doi: 10.1016/j.cma.
2012.03.022 .
Lloberas-Valls, O., D. Rixen, A. Simone, and L. Sluys (2012b). “Multiscale domain decomposition analysis of quasi-brittle
heterogeneous materials” . In: International Journal for Numerical Methods in Engineering 89.11. doi: 10.1002/nme.
3286 .
Matou, K., M. G. D. Geers, V. G. Kouznetsova, and A. Gillman (2017). “A review of predictive nonlinear theories for
multiscale modeling of heterogeneous materials” . In: Journal of Computational Physics 330. doi: 10.1016/j.jcp.
2016.10.070 .
Mazars, J. and J. Lemaître (1985). “Application of Continuous Damage Mechanics to Strain and Fracture Behavior of
Concrete” . In: Application of Fracture Mechanics to Cementitious Composites . Ed. by S. P. Shah. Vol. 94. NATO ASI
Series. Dordrecht: Springer Netherlands. doi: 10.1007/978-94-009-5121-1_17 .
Mier, J. G. M. van (2017). Fracture Processes of Concrete: Assessment of Material Parameters for Fracture Models .
1st ed. CRC Press. doi: 10.1201/b22384 .
Miller, R. E. and E. B. Tadmor (2009). “A uniﬁed framework and performance benchmark of fourteen multiscale
atomistic/continuum coupling methods” . In: Modelling and Simulation in Materials Science and Engineering 17.5.
doi:10.1088/0965-0393/17/5/053001 .
Moukarzel, C. and H. J. Herrmann (1992). “A vectorizable random lattice” . In: Journal of Statistical Physics 68.5. doi:
10.1007/BF01048880 .
Oliver-Leblond, C., R. Desmorat, and B. Kolev (2021). “Continuous anisotropic damage as a twin modelling of discrete bi-
dimensional fracture” . In: European Journal of Mechanics - A/Solids 89. doi: 10.1016/j.euromechsol.2021.104285 .
Ostoja-Starzewski, M. (2008). Microstructural randomness and scaling in mechanics of materials . CRC series–modern
mechanics and mathematics. Boca Raton: Chapman & Hall/CRC. 471 pp. doi: 10.1201/9781420010275 .
Reddy, J. N. (1997). “On locking-free shear deformable beam ﬁnite elements” . In: Computer Methods in Applied Mechanics
and Engineering . Containing papers presented at the Symposium on Advances in Computational Mechanics 149.1.
doi:10.1016/S0045-7825(97)00075-3 .
Reddy, J. N., C. M. Wang, and K. Y. Lam (1997). “Uniﬁed Finite Elements Based on the Classical and Shear Deformation
Theories of Beams and Axisymmetric Circular Plates” . In: Communications in Numerical Methods in Engineering
13.6. doi: 10.1002/(SICI)1099-0887(199706)13:6<495::AID-CNM82>3.0.CO;2-9 .
Rezakhani, R., X. Zhou, and G. Cusatis (2017). “Adaptive multiscale homogenization of the lattice discrete particle
model for the analysis of damage and fracture in concrete” . In: International Journal of Solids and Structures 125.
doi:10.1016/j.ijsolstr.2017.07.016 .
Richart, N. and J. F. Molinari (2015). “Implementation of a parallel ﬁnite-element library: Test case on a non-local
continuum damage model” . In: Finite Elements in Analysis and Design 100. doi: 10.1016/j.finel.2015.02.003 .
Rodrigues, E. A., O. L. Manzoli, L. A. G. Bitencourt, T. N. Bittencourt, and M. Sánchez (2018). “An adaptive concurrent
multiscale model for concrete based on coupling ﬁnite elements” . In: Computer Methods in Applied Mechanics and
Engineering 328. doi: 10.1016/j.cma.2017.08.048 .
Sun, B. and Z. Li (2015). “Adaptive concurrent multi-scale FEM for trans-scale damage evolution in heterogeneous
concrete” . In: Computational Materials Science 99. doi: 10.1016/j.commatsci.2014.12.033 .
Sun, X. and X. Guo (2019). “Domain information transfer method and its application in quasi-brittle failure analysis” .
In:Advances in Mechanical Engineering 11.12. doi: 10.1177/1687814019895736 .
Unger, J. F., S. Eckardt, and C. Konke (2011). “A mesoscale model for concrete to simulate mechanical failure” . In:
Computers and Concrete 8.4. doi: 10.12989/CAC.2011.8.4.401 .
Unger, J. F. and S. Eckardt (2011). “Multiscale Modeling of Concrete” . In: Archives of Computational Methods in
Engineering 18.3. doi: 10.1007/s11831-011-9063-8 .
Vardoulakis, I. (2019). Cosserat Continuum Mechanics: With Applications to Granular Media . Vol. 87. Lecture Notes in
Applied and Computational Mechanics. Cham: Springer International Publishing. doi: 10.1007/978-3-319-95156-0 .
Wellmann, C. and P. Wriggers (2012). “A two-scale model of granular materials” . In: Computer Methods in Applied
Mechanics and Engineering . Special Issue on Advances in Computational Methods in Contact Mechanics 205-208.
doi:10.1016/j.cma.2010.12.023 .
Wittel, F. K. (2006). “Diskrete Elemente-Modelle zur Bestimmung der Festigkeitsevolution in Verbundwerkstoﬀen” . PhD
Thesis. Universität Stuttgart. isbn: 3-930683-59-8.
Xiao, S. P. and T. Belytschko (2004). “A bridging domain method for coupling continua with molecular dynamics” .
In:Computer Methods in Applied Mechanics and Engineering . Multiple Scale Methods for Nanoscale Mechanics and
Materials 193.17. doi: 10.1016/j.cma.2003.12.053 .
19Xu, L., L. Jiang, L. Shen, L. Gan, Y. Dong, and C. Su (2023). “Adaptive hierarchical multiscale modeling for concrete
trans-scale damage evolution” . In: International Journal of Mechanical Sciences 241. doi: 10.1016/j.ijmecsci.
2022.107955 .
Zhang, H., J. Wu, and Y. Zheng (2012). “An adaptive multiscale method for strain localization analysis of 2D periodic
lattice truss materials” . In: Philosophical Magazine 92.28. doi: 10.1080/14786435.2012.731087 .
20