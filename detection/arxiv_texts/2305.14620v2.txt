Prepared for submission to JHEP
Automated calculation of Jet fragmentation at NLO in
QCD
ChongYang Liu1,2, Xiao-Min Shen1,2,3, Bin Zhou1,2, Jun Gao1,2
1INPAC, Shanghai Key Laboratory for Particle Physics and Cosmology, School of Physics and As-
tronomy, Shanghai Jiao-Tong University, Shanghai 200240, China
2Key Laboratory for Particle Astrophysics and Cosmology (MOE), Shanghai 200240, China
3Deutsches Elektronen-Synchrotron DESY, Notkestr. 85, 22607 Hamburg, Germany
Abstract: We present FMNLO, a framework to combine general-purpose Monte Carlo
generators and fragmentation functions (FFs). It is based on a hybrid scheme of phase-space
slicing method and local subtraction method, and accurate to next-to-leading order (NLO)
in QCD. The new framework has been interfaced to MG5 aMC@NLO and made publicly
available in this work. We demonstrate its unique ability by giving theoretical predictions
of various fragmentation measurements at the LHC, followed by comparison with the data.
With the help of interpolation techniques, FMNLO allows for fast calculation of fragmentation
processes for a large number of different FFs, which makes it a promising tool for future fits of
FFs. As an example, we perform a NLO fit of parton fragmentation functions to unidentified
charged hadrons using measurements at the LHC. We find the ATLAS data from inclusive
dijet production show a strong constraining power. Notable disparities are found between
our gluon FF and that of BKK, DSS and NNFF, indicating the necessities of additional
constraints and data for gluon fragmentation function.
Keywords: Fragmentation, Jet, QCDarXiv:2305.14620v2  [hep-ph]  6 Jan 2024Contents
1 Introduction 1
2 Theoretical framework 3
2.1 A hybrid scheme 3
2.2 Implementation 6
3 Validation 8
3.1 Lepton collisions 8
3.2 Hadron collisions 9
4 Applications at the LHC 10
4.1 Isolated-photon-tagged jets 11
4.2 Zboson tagged jets 14
4.3 QCD inclusive dijets 15
5 Analysis of fragmentation functions 16
5.1 Experimental data sets 16
5.2 Framework of the fit 18
5.3 Results and discussions 19
6 Conclusions 22
A Installation and running 23
B Comparison of the theory to data 26
C Theory ingredients 29
1 Introduction
Fragmentations of quarks and gluons into hadrons have been the central topic of QCD since
only hadrons are observed experimentally. QCD factorization ensures separation of the short
and long distance effects into matrix elements on production of partons and the fragmentation
functions(FFs) [1–3]. In its simplest form, fragmentation functions describe probability dis-
tribution on the fraction of momentum of the initial parton carried by the identified hadron.
Due to its non-perturbative essential, fragmentation functions are usually extracted from fits
to a variety of experimental data. However, dependence of the fragmentation functions on
– 1 –the momentum transfers or the so-called fragmentation scale follows the Dokshitzer-Gribov-
Lipatov-Altarelli-Parisi (DGLAP) evolution equation with time-like splitting kernels. For
extraction of FFs at next-to-next-to-leading order (NNLO), three-loop evolution kernels at
O(α3
s) in the strong coupling are needed, which have been calculated in Ref. [4–9].
The experimental data used to extract FFs includes Single-Inclusive Annihilation (SIA)
on lepton colliders, Semi-Inclusive Deep-Inelastic Scattering (SIDIS), and hadron production
on hadron-hadron colliders. The corresponding parton-level cross sections for SIA have been
calculated at NNLO in Ref. [10–13]. For SIDIS, the next-to-leading order (NLO) correc-
tions are given in Ref. [14–19], and approximate NNLO and N3LO corrections have also been
obtained from expansion of the resummed expressions[20, 21]. For ppcollisions, the corre-
sponding NLO corrections for single-inclusive production of a hadron are given by Ref.[22–27].
Various FFs [28–45] have been extracted from SIA, SIDIS and ppcollisions. However,
there exist several limitations in the current tools on calculations of parton fragmentations at
NLO. First, the available processes of hard scattering are limited and are usually implemented
case-by-case. Furthermore, interactions in the hard processes are usually constrained to be
SM interactions, thus are restrained from applications to study of various new physics beyond
the SM (BSM). Besides, even direct calculations at NLO are too costly in computation time
to be included into a global analysis of fragmentation functions.
In this work we provide a solution, dubbed FMNLO, by introducing a hybrid scheme
of NLO calculations utilizing a phase-space slicing of collinear regions in combination with
the usual local subtraction methods. Due to its simplicity we are able to realize the hybrid
scheme based on the widely used program MG5 aMC@NLO [46, 47]. That ensures numeri-
cal calculations on partonic cross sections for arbitrary hard processes of fragmentations at
NLO within SM and BSMs. We further generate the nominal and convoluted fragmentation
functions using the HOPPET program [48, 49] for fast convolutions with the partonic cross
sections.
The rest of our paper is organized as follows. In Sec. 2, we present the FMNLO framework,
which combines partonic cross section calculation and FFs at NLO QCD, in a way suitable for
Monte Carlo calculation. We also show how the corresponding calculation can be boosted with
interpolation techniques. In Sec. 3, our framework and its implementation are validated by
comparing our results with analytic predictions for SIA at lepton colliders and the predictions
of other program for inclusive hadron production at hadron colliders. Then we utilize FMNLO
to study three cases of hadron production at the LHC and compare our NLO QCD predictions
with the experimental measurements in Sec. 4. In Sec. 5, more ppcollision measurements
at the LHC are considered, and a NLO fit of parton fragmentation functions to unidentified
charged hadron is performed, followed by comparisons of our fitted FFs with existing FFs.
Finally our summary and conclusions are presented in Sec. 6.
– 2 –2 Theoretical framework
2.1 A hybrid scheme
Cross sections for any infrared and collinear (IRC) safe observables in a standard subtraction
scheme at NLO have the following schematic form:
dσ
dF=Z
dPS mh
|M|2
B,m+|M|2
V,m+|˜I|2
mi
δ(ˆF(pm;fm)−F)
+Z
dPS m+1h
|M|2
R,m+1δ(ˆF(pm+1;fm+1)−F)− |I|2
m+1δ(ˆF(˜pm;˜fm)−F)i
, (2.1)
where |M|2
B,|M|2
Vand|M|2
Rrepresent square of matrix elements at leading order (LO), one-
loop level and in real corrections, respectively. |I|2
m+1denotes the local subtraction terms
constructed in D= 4−2ϵdimensions when using dimensional regularizations, and
|˜I|2
m=Z
PS1|I|2
m+1 (2.2)
are the integrated subtraction terms over the phase space of real radiations. We have taken
a single differential cross section in observable Fas an example for a process with m(m+ 1)
finale state particles at LO (in real corrections). One can imagine Fbeing the transverse
momentum of either colorless particles or a clustered jet produced. The measure function ˆF
for the observable applies on either the Born kinematics and flavors {pm;fm}, or those in real
corrections {pm+1;fm+1}, and in real subtractions {˜pm;˜fm}. For local subtraction schemes,
for instance, in CS dipole subtraction [50, 51] or FKS subtraction [52, 53], contributions
from the second line of Eq. (2.1) can be evaluated immediately in four dimensions due to
cancellations of both infrared and collinear singularities. Note that in the infrared or collinear
limits the measure function of IRC safe observable equals for configurations {pm+1;fm+1}and
{˜pm;˜fm}. Both the virtual corrections and integrated subtraction terms carry poles in ϵwhich
again cancel among each other which renders the first line of Eq. (2.1) being finite in four
dimensions.
For fragmentation processes, the complications are due to uncancelled collinear singular-
ities from splitting of final state partons and thus observables are not collinear safe. However,
those singularities are universal and can be absorbed into definitions of bare fragmentation
functions similar to the mass factorization in scattering with initial hadrons. Considering
the transverse momentum distribution of a tagged hadron, a typical observable in parton
fragmentations, one can attempt to use the same formalism as for IRC safe observable and
calculate
dσ
dpT,h=Z
dxZ
dPS mh
|M|2
B,m+|M|2
V,m+|˜I|2
mimX
i=1δ(pT,h−xpT,i)D0
h/i(x)
+Z
dxZ
dPS m+1h
|M|2
R,m+1m+1X
i=1δ(pT,h−xpT,i)D0
h/i(x)
– 3 –− |I|2
m+1mX
˜i=1δ(pT,h−x˜pT,˜i)D0
h/˜i(x)i
. (2.3)
The bare fragmentation functions for finding a tagged hadron ( h) with a momentum fraction
ofxof the mother parton ( i) can be expressed in terms of the physical ones using mass
factorization with MS scheme as
D0
h/i(x) =Z1
xdy
yX
jP+
ji(y)Dh/j(x/y, µ D)≡X
jP+
ji⊗Dh/j(x, µD), (2.4)
where the time-like convolution kernel can be expressed as
P+
ji(y) =4πµ2
Re−γE
µ2
Dϵ
δijδ(1−y) +αS(µR)
2πP+(0)
ji(y)1
ϵ+...
, (2.5)
where µRandµDare the renormalization and fragmentation scale respectively, and γEis
the Euler-Mascheroni constant. The one-loop regularized splitting functions P+(0)
jiare given
in Appendix C and coincide with those of space-like splitting functions while the two-loop
results are available from Ref. [54].
However, one can not take the four dimensional limit in each of the two phase space inte-
grals and carry out numerical calculations due to the aforementioned collinear singularities.
Additional subtraction terms and their integrals are needed for the NLO calculation, for in-
stance, as given in Ref. [50, 51]. In this study we propose a minimal modification of Eq. (2.3)
by using additional slicing of radiation phase space to single out the collinear singularities
instead of including further local subtractions. We denote that as a hybrid scheme since it
involves both methods of local subtractions and slicing of phase space. The master formula
for the same distribution is given by
dσ
dpT,h=Z
dxZ
dPS mh
|M|2
B,m+|M|2
V,m+|˜I|2
mimX
i=1δ(pT,h−xpT,i)D0
h/i(x)
+Z
dxZ
dPS m+1(Θ(λ−C) + Θ( C−λ))h
|M|2
R,m+1m+1X
i=1δ(pT,h−xpT,i)D0
h/i(x)
− |I|2
m+1mX
˜i=1δ(pT,h−x˜pT,˜i)D0
h/˜i(x)i
=Z
dxZ
dPS mh
|M|2
B,m+|M|2
V,m+|˜I|2
mimX
i=1δ(pT,h−xpT,i)D0
h/i(x)
+Z
dxZ
dPS m+1Θ(C−λ)h
|M|2
R,m+1m+1X
i=1δ(pT,h−xpT,i)D0
h/i(x)
− |I|2
m+1mX
˜i=1δ(pT,h−x˜pT,˜i)D0
h/˜i(x)i
+|˜J |2
m, (2.6)
– 4 –where we have inserted two Θ functions to partition into the unresolved and resolved collinear
regions with a cutoff λ. The slicing variable Ccan be chosen as either the minimum of
the usual angular separations of all QCD partons ∆ θ=min{∆θij}in the center of mass
frame or the minimum of the boost-invariant angular separation of all QCD partons ∆ R=
min{∆Rij≡q
∆ϕ2
ij+ ∆y2
ij}. The phase space integral of m+1-body above the cutoff is free
of infrared and collinear singularities and can be calculated numerically in four dimensions.
The integral below the cutoff can be factorized using the collinear approximations. The
results contain collinear singularities and are included in terms |˜J |2
mwhich we calculate in
the following.
For NLO calculations, there only exist single unresolved collinear regions. Precisely,
giving the cutoff is small enough, there is no overlap of phase space between any collinear
regions of two partons {kl}. We can write the integral below the cutoff as following when
neglecting power corrections that vanish when taking the limit of λto zero,
|˜J |2
m=X
{kl}Z
dxZ
dPS m+1Θ(λ−∆Rkl)h
|M|2
R,m+1m+1X
i=1δ(pT,h−xpT,i)D0
h/i(x)
− |I|2
m+1mX
˜i=1δ(pT,h−x˜pT,˜i)D0
h/˜i(x)i
=mX
i=1Z
dxZ
dPS m|M|2
B,mαS(µR)
2π(4πµ2
R)ϵ
Γ(1−ϵ)Z1
0dzZz(1−z)(λpT,i)2
0ds
[z(1−z)s]−ϵ
s×X
jh
P(0)
ji(z, ϵ)δ(pT,h−zxpT,i)D0
h/j(x)
−1
2 
2δij+δgi(δqj+δ¯qj)
P(0)
ji(z, ϵ)δ(pT,h−xpT,i)D0
h/i(x)i
. (2.7)
We have parameterized the phase space of radiations with the invariant mass square sand the
momentum fraction zin each of the collinear regions. We further use the fact that both the
square of real matrix elements and its subtractions can be written as unregularized splitting
functions, P(0)
ji(z, ϵ)≡P(0)
ji(z) +ϵP′(0)
ji(z), times the square of Born matrix elements. It
is understood that the subscripts except the labels ( q,¯q, g) represent flavor of that parton
(q,¯q, g) when appearing in the splitting functions. We arrive at a rather compact form for
|˜J |2
mafter carrying out integrals in sandz, which is given by
|˜J |2
m=Z
dxZ
dPS m|M|2
B,mαS(µR)
2πmX
i=1δ(pT,h−xpT,i)
×h4πµ2
Re−γE
µ2
Dϵ 
−1
ϵ+ lnλ2p2
T,i
µ2
D!X
jP+(0)
ji⊗Dh/j(x, µD) +˜Dh/i(x, µD)i
,(2.8)
with ˜Dh/i(x, µD)≡P
jIji⊗Dh/j(x, µD), and the kernel of residuals Iji(z) can be expressed
– 5 –using the unregularized splitting functions,
Iji(z) =

2 ln[z(1−z)]P(0)
ji−P′(0)
ji,{ji}=qg, gq
h
2 ln[z(1−z)]P(0)
ji−P′(0)
jii
+,{ji}=qq
4CA
ln[z(1−z)](z(1−z) +1−z
z) +
zln[z(1−z)]
1−z
+
+1
18(10CA+ 46nfTF)δ(1−z),{ji}=gg.
Substituting |˜J |2
mback to the master formula Eq. (2.6) one can find that the remaining
collinear divergences or poles in ϵcancel with those from mass factorizations. After that all
remaining pieces are ready for numerical calculations performed directly in four dimensions
as will be explained in the next section.
In above derivations, we have chosen the slicing variable C= ∆Ras an example. It can
be easily transformed into the case of C= ∆θby exchanging λpT,iwith λEiin Eq. (2.7).
We emphasize that the hybrid scheme proposed above can apply equally to processes without
initial state hadrons, e.g., lepton collisions or particle decays, as well as lepton-hadron or
hadron-hadron collisions. In latter cases, that implies the usual NLO subtraction terms re-
lated to initial hadrons and mass factorizations of parton distributions are included implicitly
in the derivations. It is interesting to compare our scheme with the two-cutoff method for
NLO calculations of fragmentations introduced in Ref. [55]. We note that our kernels of resid-
ualsIgq,qg(z) coincide with similar quantities therein since the corresponding splittings are
free of soft divergences. For Iqq,gg(z), there is no simple correspondence of the two methods
since the soft divergences are handled differently.
2.2 Implementation
The advantage of above scheme is the capability of easy implementations into various existing
programs for NLO calculations designed for IRC safe observables. We demonstrate that for
calculations of differential distribution in the energy fraction xh≡2Eh/Qcarried by the
tagged hadron. Schematically our master formula can be recast as
dσ
dxh=mX
i=1Zdxi
xi"
dσ(0)
m
dxi+d˜σ(1)
m
dxi#
Dh/i(xh/xi, µD) +m+1X
i=1Zdxi
xid˜σ(1)
m+1
dxiDh/i(xh/xi, µD)
+mX
i=1Zdxi
xi"
αS(µR)
2πdσ(0)
m
dxi#
¯Dh/i(xh/xi, µD) +˜Dh/i(xh/xi, µD)
, (2.9)
with
¯Dh/i(x, µD)≡ 
lnλ2p2
T,i
µ2
D!
P+(0)
ji⊗Dh/j(x, µD), (2.10)
– 6 –anddσ(0)
m/dxiis the LO partonic differential cross section with respect to the energy fraction
carried by the i-th parton. The partonic cross sections d˜σ(1)
m/dxiandd˜σ(1)
m+1/dxican be
identified by comparing to various contributions in Eq. (2.6). In summary the differential
cross sections at NLO and at hadron level can be expressed as a convolution of the original
fragmentation functions ( D) and its integrals ( ¯Dand˜D) with various partonic cross sections.
We have constructed a fast interface specialized for our calculations as following. First
of all the fragmentation function and its integrals at arbitrary scales can be approximated by
an interpolation on a two-dimensional grid of xandQ,
D(x, Q) =nX
i=0nX
j=0Dk+i,l+jI(n)
iy(x)
δy−k
I(n)
jw(Q)
δw−l
, (2.11)
where we choose the interpolation variables y(x) =x0.3,w(Q) = ln(ln( Q/0.3 GeV)) and the
interpolation order n= 4. Dk,lis the value on the k-th node in xandl-th node in Q.
The spacing δy(δw) has been chosen so as to give Nx= 50 ( NQ= 16) grid points evenly
distributed for the typical kinematic regions considered. We use an n-th order polynomial
interpolating function I(n)
i(j)and the starting grid point k(l) is determined such that x(Q) is
located in between the k(l) + 1-th and k(l) + 2-th grid points. Substituting the interpolated
functions to Eq. (2.9) we arrive at
dσ
dxh=X
i=q,¯q,gNxX
k=1NQX
l=1
G(xh)i
k,lDk,l
h/i+¯G(xh)i
k,l¯Dk,l
h/i+˜G(xh)i
k,l˜Dk,l
h/i
. (2.12)
In practice we calculate partonic cross sections with MG5 aMC@NLO [46, 47] and extract
matrix of coefficients G,¯G, and ˜Gfor a series of xhvalues. The matrices need to be calculated
once and stored using histograms in MG5 aMC@NLO. For arbitrary choices of fragmenta-
tion functions we use HOPPET [48, 49] to carry out DGLAP evolution and convolution of
fragmentation functions. Thus the final hadronic cross sections can be obtained via matrix
multiplications efficiently without repeating the calculations of NLO partonic cross sections
which are time consuming. Experimental measurements provide bin-averaged cross sections
rather than differential cross sections at a single value of xh. They can be constructed again
using interpolations from differential cross sections on a dense grid of xhwhich we choose to be
the same as the one used for xinterpolation of fragmentation functions. We have verified that
the prescribed interpolations on both fragmentation functions and hadronic cross sections give
a precision better than a few per mille in general. We emphasize that the above fast interface
can also work for any hadronic differential cross sections related to longitudinal momentum in
fragmentations with minimal modifications. A driver for running MG5 aMC@NLO to gener-
ate the NLO coefficient tables for a variety of distributions and associated fast interface have
been made available as explained in Appendix A.
– 7 –3 Validation
In this section we demonstrate the validity of our calculation scheme and its implementa-
tion for several scenarios in both lepton collisions and hadron collisions. We note that in
MG5 aMC@NLO the NLO mode of lepton-hadron collisions is not publicly available yet.
Our calculation scheme can be easily implemented once the version including lepton-hadron
collisions is released.
3.1 Lepton collisions
We consider two scenarios of lepton collisions for benchmark purpose. We focus on the
NLO predictions for distribution of the energy fraction carried by the tagged hadron, namely
dσ/dx h. In the first case, the LO hard process involves the annihilation of an electron-positron
pair into quarks through virtual photons. These quarks subsequently undergo fragmentation
to produce the tagged hadrons. In the second case, the LO hard process involves the annihi-
lation of a muon-anti-muon pair into two gluons via the coupling with the SM Higgs boson.
These gluons then undergo fragmentation to produce the tagged hadrons. For above processes
the NLO predictions can be calculated analytically with results collected in Appendix C. For
simplicity we use a toy model of the fragmentation functions in the calculations
xDh/i(x, µ) =Nix−1/2(1−x)5, (3.1)
with Ni= 1 and 9 /4 for (anti-)quarks and gluons respectively. We choose a center of mass
energy Q= 200 GeV and set the renormalization and fragmentation scales to µR=µD=Q.
We show comparisons of our numerical results, denoted as FMNLO, and those using NLO
analytical formulas in Fig. 1 for the di-quark and in Fig. 2 for di-gluon production respectively.
We include two groups of results from FMNLO using a cutoff parameter of λ= 0.01 and 0 .04
to check the consistency of our hybrid scheme. The upper panel shows the NLO predictions
on distributions normalized to the LO total cross sections. The middle and lower panel show
the ratios of the three NLO predictions to the analytical results at NLO and the ratios of
the NLO results to the LO ones respectively. We find very good agreement between our
predictions and the analytical results for both channel. For instance, the NLO predictions
with λ= 0.04 differ with the analytical ones by at most two per mille in the range of xhfrom
0.01 to 1. We have checked that these differences are indeed due to the interpolations used
and can be reduced if a denser x-grid is used. The differences between FMNLO predictions
with λ= 0.01 and 0 .04 for the virtual photon case are mostly due to fluctuations of Monte
Carlo (MC) calculations. We further compare predictions with a variety of λchoice ranging
from 0.001 to 0.08 and conclude that the choice of λ= 0.04 is sufficiently small to ensure
convergence and stability of MC integration. It is worth noting that the numeric effects of
the size of a few per mille are much smaller than the typical experimental uncertainties or
scale variations of NLO predictions.
– 8 –0100020001/0d/dxh
e+e*qq
=Q=200 GeV
FMNLO (=0.01)
FMNLO (=0.04)
Analytical (NLO)
0.991.001.01Ratio
102
101
100
xh0.751.001.25NLO/LOFigure 1 . Comparison of the NLO predictions on distribution of the hadron energy fraction from
FMNLO and from analytical calculations for e+e−→γ∗→q¯qat a center of mass energy of 200 GeV.
3.2 Hadron collisions
We compare our calculations with the INCNLO program [56] for the case of unidentified
charged hadron production via QCD at hadron collisions. We consider the scenario of pp
collisions at LHC 7 TeV and predictions for the transverse momentum distribution of the
charged hadrons dσ/dp T,h. The charged hadrons are required to have rapidity |y|<2.0. On
various theoretical inputs we use CTEQ6M NLO parton distributions [57] and the BKK NLO
fragmentation functions [28–30]. Furthermore, for simplicity, we fix both the renormalization
and factorization scales to 100 GeV, and set the fragmentation scale to pT,h, namely transverse
momentum of the charged hadron.
In Fig. 3 we demonstrate independence of our NLO predictions on the choice of the
cutoff parameter. We show predictions of the double differential cross sections for pT,hin
three kinematic bins from 60 to 220 GeV, for several choices of λfrom 0 .002 to 0 .08. The
variations are within 1% in general mostly due to uncertainties of MC integration. In practice,
we recommend using a value of 0 .02∼0.04 for numerical stability. In Fig. 4 we present
comparisons of our NLO predictions with those from INCNLO1.4 [56] for a finer binning.
The agreements of the three predictions with λ= 0.02, 0 .04, and 0 .08 are similar to that
– 9 –05000100001/0d/dxh
+Hgg
=Q=200 GeV
FMNLO (=0.01)
FMNLO (=0.04)
Analytical (NLO)
0.991.001.01Ratio
102
101
100
xh12NLO/LOFigure 2 . Comparison of the NLO predictions on distribution of the hadron energy fraction from
FMNLO and from analytical calculations for µ+µ−→H∗→ggat a center of mass energy of 200
GeV.
in Fig. 2. From the middle panel we can find our predictions with λ= 0.04 agree with
INCNLO predictions at a few per mille in general. In the lower panel ratios of the NLO to
LO predictions for various conditions is presented. The NLO corrections can reach to 70% in
lower pT,hregions which are much larger than the discrepancies mentioned.
4 Applications at the LHC
Prescribed calculation scheme and its numerical implementation are especially desirable for
predictions of various measurements carried out at the LHC. In typical fragmentation mea-
surements at the LHC, the requirement is often imposed that the tagged hadron is produced
either within a reconstructed jet or in association with an isolated photon or a Zboson.
Meanwhile, jet algorithms and various selection cuts are applied in the analyses which can
be implemented easily in a MC event generator such as MG5 aMC@NLO. In the following,
we show three examples of such calculations that we adapted to the corresponding LHC
measurements. We focus on the measurements of spectrum of unidentified charged hadrons.
– 10 –0.991.001.01
s=7TeV
|yh|<2.0pph+X
pT,h  [60,110] GeV
0.991.001.01Ratio to =0.04
pT,h  [110,160] GeV
102
0.991.001.01
pT,h  [160,220] GeV
Figure 3 . Ratio of the NLO predictions on distribution of the hadron transverse momentum from
FMNLO with different choices of cut-off parameter relative to λ= 0.04 for inclusive jet production
inppcollisions with a center of mass energy of 7 TeV. Three representative bins on the transverse
momentum have been selected, and a rapidity cut of |yh|<2 of hadrons has been applied.
Predictions on tagged hadrons with a specified flavor can be obtained easily using the same
NLO grids multiplied with the corresponding fragmentation functions.
In the following calculations we use the CT14 NLO parton distribution functions [58], the
BKK fragmentation functions [28–30] and the NNFF1.1 fragmentation functions [42, 43] for
unidentified charged hadrons. We set central values of the factorization and renormalization
scales ( µF,0andµR,0) to the default dynamic scale used in MG5 aMC@NLO, namely the sum
of the transverse mass of all final state particles divided by 2. For the fragmentation scale,
we set its central value ( µD,0) to the maximum of the transverse momentum of all final state
particles. The above central values equal in the case of only two massless particles in the
final states. The scale variations are obtained by taking the envelope of theory predictions of
the 9 scale combinations of µF/µF,0=µR/µR,0={1/2,1,2}andµD/µD,0={1/2,1,2}. We
note alternative choices on the fragmentation scale of using the transverse momentum of the
jet multiplied by the jet cone size when calculating hadron fragmentation inside the jet [26].
For typical jet cone sizes of ∼0.5 used in the LHC measurements, the choice is close to our
nominal choice of the fragmentation scale.
4.1 Isolated-photon-tagged jets
In Ref. [59] the CMS collaboration measured parton fragmentation based on hard scattering
events in ppcollisions (√s= 5.02 TeV) consisting of an isolated photon in association with
– 11 –100102104d2/dpT,hdy (pb/GeV)
pph+X
s=7 TeV
|yh|<2INCNLO
FMNLO (=0.02)
FMNLO (=0.04)
FMNLO (=0.08)
0.951.001.05Ratio
25 50 75 100 125 150 175 200
pT,h (GeV)1.01.5NLO/LOFigure 4 . Comparison of the NLO predictions on distribution of the hadron transverse momentum
from FMNLO and from INCNLO for inclusive jet production in ppcollisions with a center of mass
energy of 7 TeV. A rapidity cut of |yh|<2 of hadrons has been applied.
jets. The photon is required to have a transverse momentum pT,γ>60 GeV and a pseudo-
rapidity |ηγ|<1.44. Jets are clustered with anti- kTalgorithm [60] with R= 0.3 and are
required to have pT,j>30 GeV and |ηj|<1.6. They select jets that have an azimuthal
separation to the photon ∆ ϕjγ>7π/8 and analyze the charged-particle tracks inside the
jet with transverse momentum ⃗ pT,hin Ref. [59]. The charged tracks are required to have
pT,h>1 GeV. The transverse momentum of the photon ⃗ pT,γserves as a good reference of
the initial transverse momentum of the fragmented parton. Thus ξγ
T≡ln[−p2
T,γ/(⃗ pT,γ·⃗ pT,h)]
is a good probe of the momentum fraction carried by the charged hadron. The results are
presented in a form of 1 /NjdNtrk/dξγ
Twhich is simply a linear combination of the quark and
gluon fragmentation functions at the LO evaluated at a momentum fraction of e−ξγ
T. Fig. 5
comprises three panels that present a comparison between NLO predictions obtained from
different fragmentation function sets and experimental data. The first panel displays the
results derived from the BKK and NNFF1.1 sets. Upon examination, it becomes evident
that the results from the BKK set closely resemble the experimental data and exhibit a good
agreement in the lower ξγ
Tregion, ranging from 0 .5 to 2 .5. As ξγ
Tincreases, the discrepancy
– 12 –enlarges, which can be attributed to the lack of fitted data in the small x=pT,h/pT,γ(<0.01)
regions [28–30]. This observation is further supported by the second panel, where the results
are normalized to the experimental data. The NNFF1.1 results match the experimental
data in the lower and higher regions, while a significant deviation is observed in the middle
region. Moreover, the error band indicates that the theoretical uncertainties increase with
higher values of ξγ
T. Finally, in the last panel, we give the LO and NLO predictions based
on NNFF1.1, normalized to NNFF1.1 results at NLO with nominal scale choice. The ratios
indicate that the NLO corrections contribute insignificantly, less than 20%, in the region
ξγ
T<3.5. However, for ξγ
T>3.5, the contribution switches from negative to positive, and the
ratio rises rapidly to nearly 2.
12341/NjdNtrk/dT,
ppj
s=5.02 TeV
NNFF1.1
BKK
Data
NNFF1.1 NLO
NNFF1.1 LO
12Ratio
1 2 3 4
T
12LO/NLO
Figure 5 . Comparison of NLO predictions to CMS measurement on normalized distribution of ξγ
Tfor
isolated photon production in ppcollisions with a center of mass energy of 5.02 TeV. The two colored
bands represent predictions including scale variations, based on NNFF1.1 and BKK fragmentation
functions respectively. The error bars indicate the total experimental uncertainties. Theoretical pre-
dictions have been normalized to the central value of data in the middle panel. In the lower panel
the two bands correspond to LO and NLO predictions based on NNFF1.1, normalized to the NLO
prediction with nominal scale choice.
– 13 –4.2 Zboson tagged jets
We now turn to the relevant calculations for the production process of Z boson in association
with jets at LHC. In Ref. [61] the CMS collaboration measured parton fragmentation based
on hard scattering events of the above process, where√s= 5.02 TeV. The Zboson is required
to have a transverse momentum pT,Z>30 GeV, and no jet reconstructions are performed.
They also analyzed all charged-particle tracks with an azimuthal separation to the Zboson
∆ϕtrk,Z >7π/8 in Ref. [61]. The charged tracks are required to have pT,h>1 GeV and |ηh|<
2.4. Different from the production process of an isolated photon in association with jets, we
use a distribution of 1 /NZdNtrk/dpT,hto show our results.
1010.00.20.40.61/NZdNtrk/dpT,h
ppZj
s=5.02 TeV
NNFF1.1
BKK
Data
NNFF1.1 NLO
NNFF1.1 LO
1011.01.5Ratio
101
pT,h (GeV)1.01.2LO/NLO
Figure 6 . Similar to Fig. 5 but with CMS measurement on normalized distribution of pT,hforZ
boson production in ppcollisions with a center of mass energy of 5.02 TeV.
In Fig. 6, the BKK and NNFF1.1 results are depicted as previously mentioned. It is
apparent from the first panel that the BKK data exhibits better agreement with the experi-
mental data in the whole kinematic region. In the second panel, we find that, in most regions,
the experimental data lies within the error band of the BKK results, with a maximum de-
viation of approximately 20%. Meanwhile, the NNFF1.1 results show a greater discrepancy,
particularly in the middle region. In the third panel, it can be seen that, in most regions, the
– 14 –NLO corrections are negative, but they diminish as pTincreases. The maximum corrections
at NLO is approximately 20%.
4.3 QCD inclusive dijets
In this subsection, we present the third example of the calculations mentioned above. In
Ref. [62] the ATLAS collaboration measured parton fragmentation based on hard scattering
events in ppcollisions (√s= 13 TeV) consisting of two or more jets. Jets are clustered with
anti-kTalgorithm with R= 0.4 and are required to have pT,j>60 GeV and |ηj|<2.1. The
two leading jets are required to satisfy a balance condition pT,j1/pT,j2<1.5, where pT,j1(2)
are the transverse momentum of the (sub-)leading jet. They also analyzed charged-particle
tracks inside the jet classified according to its transverse momentum and pseudo-rapidity
(forward or central) in Ref. [62]. The charged tracks are required to have pT,h>0.5 GeV
and|ηh|<2.5. The results are presented in a differential cross section of 1 /NjdNtrk/dζwith
ζ≡pT,h/pT,jandpT,jbeing the transverse momentum of the jet probed1.
024681/NjdNtrk/d
ppjj
s=13 TeV
centralNNFF1.1
BKK
Data
NNFF1.1 NLO
NNFF1.1 LO
0.02.55.0Ratio
102
101
100
12LO/NLO
Figure 7 . Similar to Fig. 5 but with ATLAS measurement on normalized distribution of ζfor dijet
production in ppcollisions with a center of mass energy of 13 TeV.
1We note that the distributions presented in the experimental publication have been multiplied by the bin
width of each data points.
– 15 –We present our NLO predictions and compare them to the ATLAS measurement using
the central jet of the two leading jets and with pT,j∈[200,300] GeV in Fig. 7. The data
are displayed as mentioned before. From the first two panels, we find both the NNFF1.1 and
BKK results fit well in the high ζregion. However, the BKK data aligns more closely with
the experimental data. In the lower ζregion, it can be seen that the first three bins of the
NNFF1.1 data exhibit a closer resemblance. And the error band of the BKK results in these
regions is considerable. In the third panel, it is apparent that the NLO correction is more
significant compared to the previous two experiments, and the ratio can reach nearly 2. The
NLO correction transitions from negative in the lower region of ζto positive in the higher
region.
5 Analysis of fragmentation functions
In this section we perform a NLO fit of the parton fragmentation functions to unidentified
charged hadrons using a variety of experimental data from ppcollisions at the LHC. Those
include processes on production of charged hadrons from inclusive dijets, in association with
an isolated photon and in association with a Zboson. They can probe fragmentation of both
gluon and quarks in a wide kinematic region due to different production mechanisms involved.
We demonstrate that such a fit at NLO accuracy with a few hundreds of experimental data
points can be accomplished easily with the help of the FMNLO framework. In the following
we first briefly introduce our selection of experimental data sets and the fitting framework,
and then show our best-fit and the estimated uncertainties of the fragmentation functions.
5.1 Experimental data sets
In this study, we analyzed several recent publications on fragmentation function measurements
at the LHC over the past five years. Relevant information including the kinematic coverage
are summarized in Table. 1. We focus our analysis solely on data obtained from ppcollisions.
These studies were conducted at a center of mass energy of 5.02 TeV, with the exception of the
ATLAS inclusive dijet analysis which used a higher energy of 13 TeV. The measurements can
be separated into three categories including using an isolated photon or a Zboson recoiling
against the fragmented parton, or using the clustered jet as a reference of the fragmented
parton.
In the case of the isolated-photon-tagged jets, the CMS 2018 analysis [59] measured the
normalized distribution 1 /NjdNtrk/dξγ
Tthat has been explained in previous sections. They
probe a region of momentum fractions of the parton carried by hadrons from 0 .01∼0.6
based on the definition of ξγ
T. The ATLAS 2019 analysis [63] has different setups as the CMS
analysis. We highlighted a few of them as below. Firstly the photons and the jet are required
to have a transverse momentum in [80, 126] GeV and [63, 144] GeV respectively. The pseudo-
rapidity of the photons and the jets have been extended to 2.37 and 2.1 compared to the CMS
measurement. In addition they measured the normalized distribution 1 /NjdNtrk/dpT,hin the
region pT,h∈[1,100] GeV, that is used in our fit.
– 16 –Experiments lum. observables Npt Range
CMS 5.02 TeV 27.4 pb−11/NjdNtrk/dξγ
T[59] 8(5) ξγ
T∈[0.5, 4.5]
ATLAS 5.02 TeV 25 pb−11/NjdNtrk/dpT,h[63] 10(7) pT,h∈[1, 100] GeV
CMS 5.02 TeV 320 pb−11/NZdNtrk/dpT,h[61] 14(11) pT,h∈[1, 30] GeV
ATLAS 5.02 TeV 160 pb−11/NZd2Ntrk/dpT,hd∆ϕ[64] 15(9) pT,h∈[1, 60] GeV
ATLAS 13 TeV 33 fb−11/NjdNtrk/dζ(central) [62] 261(143) ζ∈[0.002, 0.67]
ATLAS 13 TeV 33 fb−11/NjdNtrk/dζ(forward)[62] 261(143) ζ∈[0.002, 0.67]
Table 1 . Summary on experimental data sets used in this analysis, including the observable measured,
the number of data points before and after data selection, and the kinematic range covered.
For measurements involving Z-tagged jets, the CMS 2021 analysis [61] measured the
normalized distribution 1 /NZdNtrk/dpT,hwith setups detailed in previous sections. In the
ATLAS 2020 analysis [64], the same distribution was measured for three transverse momen-
tum regions of the Zboson, namely [15, 30] GeV, [30, 60] GeV, and beyond 60 GeV. Besides,
the requirement on azimuthal separation between the charged track and the Zboson is
∆ϕtrk,Z >3π/4 instead. The covered pT,hregion is [1, 30] GeV and [1, 60] GeV for CMS and
ATLAS respectively. Lastly in the ATLAS 2019 analysis of inclusive dijets at high energy and
with high luminosity [62], they measured the normalized distribution 1 /NjdNtrk/dζdetailed
in previous sections. That covered momentum fractions of the parton carried by hadrons
from 0.002 to 0.67, as well as a wide range of the transverse momentum of the partons by
utilizing jets in finned bins of pT,jfrom 100 to 2500 GeV. Furthermore, the distributions are
measured independently for the central and forward jet of the two leading jets to increase
further the discrimination on fragmentation of gluon and quarks.
Despite of the wide coverage on momentum fraction or transverse momentum of the
hadrons from above measurements, on the theoretical predictions it requires a careful evalua-
tion on validity of the factorization framework and on stability of the perturbation expansions.
There have been previous studies [65, 66] showing difficulties on fitting to experimental data
in certain kinematic regions indicating large higher-order corrections or even violations of
collinear factorization. In this study we take a conservative approach by selecting only those
data points corresponding to momentum fractions x > 0.01 at LO and data points with
transverse momenta of the hadrons pT,h>4 GeV. Furthermore, we exclude the jet transverse
momentum region of [100, 200] GeV for the inclusive dijet measurements since that corre-
sponds to a low transverse momentum of the hadrons in general. Similarly, we exclude the ξγ
T
regions greater than 3 for the CMS isolated-photon-tagged measurement. These kinematic
selections reduce our total number of data points from 569 to 318 as can be seen from Table. 1.
In principle one can perform a scan on above kinematic selections and study the stability of
the fitted fragmentation functions which we leave for future investigation.
– 17 –5.2 Framework of the fit
The parameterization form of fragmentation functions to unidentified charged hadrons used
at the initial scale Q0is
xDh/i(x, Q 0) =ai,0xαi(1−x)βi 
1 +pX
n=1ai,nxn!
, (5.1)
where {α, β, a n}are free parameters in the fit. We choose Q0= 5 GeV and use a zero-mass
scheme for heavy quarks with nf= 5. We assume fragmentation functions equal for all quarks
and anti-quarks since the data sets we selected show weak sensitivity on quark flavors of the
fragmented partons. The degree of polynomials is set to p= 2 since improvements of fit by
introducing higher-order terms are marginal. Thus the total number of free parameters is 10.
The fragmentation functions are evolved to higher scales using two-loop time-like splitting
kernels to be consistent with the NLO analysis. The splitting functions was calculated in
Refs. [54] and are implemented in HOPPET [48, 49] which we use in the analysis.
The quality of the agreement between experimental measurements and the corresponding
theoretical predictions for a given set of fragmentation parameters is quantified by the log-
likelihood function ( χ2), which is given by [67]
χ2({α, β, a n},{λ}) =NptX
k=11
s2
k
Dk−Tk−NλX
µ=1σk,µλµ
2
+NλX
µ=1λ2
µ. (5.2)
Nptis the number of data points, s2
kis the total uncorrelated uncertainties by adding sta-
tistical and uncorrelated systematic uncertainties in quadrature, Dkis the central value of
the experimental measurements, and Tkis the corresponding theoretical prediction which
depends on {α, β, a n}.σk,µare the correlated errors from source µ(Nλin total). We assume
that the nuisance parameters λµfollow a standard normal distribution.
By minimizing χ2({α, β, a n},{λ}) with respect to the nuisance parameters, we get the
profiled χ2function
χ2({α, β, a n},{ˆλ}) =NptX
i,j=1(Ti−Di)[cov−1]ij(Tj−Dj), (5.3)
where cov−1is the inverse of the covariance matrix
(cov) ij≡s2
iδij+NλX
µ=1σi,µσj,µ. (5.4)
We neglect correlations of experimental uncertainties between different data points since they
are not available. However, we include theoretical uncertainties into the covariance matrix of
Eq. (5.4) by default, assuming these to be fully correlated among points in each subset of the
– 18 –Experiments Nptχ2(/Npt), NLO χ2(/Npt), NLO w/o th. χ2(/Npt), LO w/o th.
CMS γ 5 11.3(2.27) 28.8(5.76) 48.5(9.71)
ATLAS γ 7 17.8(2.55) 18.8(2.68) 40.5(5.78)
CMS Z 11 16.2(1.47) 24.8(2.25) 906.9(82.4)
ATLAS Z 9 47.5(5.27) 48.1(5.34) 348.8(38.8)
ATLAS central jets 141 98.1(0.69) 112.9(0.79) 833.7(5.83)
ATLAS froward jets 141 76.4(0.53) 98.0(0.68) 855.6(5.98)
Total 318 267.4(0.84) 331.2(1.04) 3034.0(9.54)
Table 2 . The χ2of individual data sets and their sum from our nominal NLO fit and alternative fits
at NLO and LO without theoretical uncertainties. Numbers in parenthesis correspond to χ2divided
by the number of data points.
data shown in Table. 1. Those are data points within the same bin of the transverse momen-
tum of either the photon, Zboson or jets in the measurement. The theoretical uncertainties
σj,µare estimated by the half width of the scale variations from the prescription mentioned
in Sec. 4.1.
The best-fit of fragmentation parameters are found via minimization of the χ2and fur-
ther validated through a series of profile scans on each of those parameters. The scans of the
parameter space are carried out with MINUIT [68] program. We use the text-book criterion
of ∆χ2= 1 on determination of parameter uncertainties. It should be noted that tolerance
conditions are usually applied for fits involving multiple data sets [67] and will lead to conser-
vative estimation of uncertainties. In addition, we adopt the iterative Hessian approach [69] to
generate error sets of fragmentation functions that can be used for propagation of parameter
uncertainties to physical observable.
5.3 Results and discussions
The overall agreement between NLO predictions from our nominal fit and the experimental
data can be seen from Table. 2. The total χ2is 267 .4 for a total number of data points of
318. For the ATLAS dijet measurements which contain the majority of the data points, the
agreement is quite good with χ2/Nptwell below 1. Description of the isolated-photon mea-
surements is reasonable with χ2/Npt∼2. The agreement to CMS Z-boson measurement is
good while it is much worse for the ATLAS measurement with χ2/Npt∼5. The discrepancies
to data are mostly due to the low- pT,hkinematic bins ( ∼4 GeV) as shown in Appendix B. For
comparison we also include results from alternative fits with either excluding to the theoretical
uncertainties or using LO matrix elements and LO evolution of the fragmentation functions.
Impact of the theoretical uncertainties is mostly pronounced for the CMS isolated-photon
andZ-boson measurements. The LO fit shows a total χ2of more than 3000 indicating the
necessity of inclusion of NLO corrections.
The values of all 10 parameters of the fragmentation functions from our nominal best-fit
– 19 –quark α β a 0 a1 a2 ⟨x⟩
best-fit 0.375 2.166 6.016 -2.292 2.083 0.586
unc.(scan)+0.03
−0.03+0.11
−0.12+0.55
−0.56+0.10
−0.10+0.18
−0.20 –
unc.(Hessian)+0.03
−0.03+0.09
−0.10+0.45
−0.44+0.08
−0.08+0.16
−0.16+0.007
−0.008
gluon α β a 0 a1 a2 ⟨x⟩
best-fit 0.710 10.224 44.080 -3.527 11.786 0.510
unc.(scan)+0.09
−0.16+1.09
−0.91+19.54
−13.54+0.95
−0.85+3.54
−3.60 –
unc.(Hessian)+0.09
−0.10+0.91
−0.93+18.9
−14.1+0.92
−0.83+3.32
−3.52+0.011
−0.012
Table 3 . The best-fit parameters for quark and gluon from our nominal NLO fit and their uncertainties
(68% C.L.) estimated using profile scans or Hessian method. The last column is the first moment of
the fragmentation functions at the initial scale as calculated using the fitted functional forms.
are collected in Table. 3. In addition we also calculated the first moment of the quark and
gluon fragmentation functions ⟨x⟩which corresponds to the total momentum fraction carried
by charged hadrons at the initial scale. The values are 58.6% and 51.0% for quark and gluon
respectively. We also show the estimated uncertainties of the fitted parameters in Table. 3
as from both the profile scans and the Hessian calculation. In the latter case, two error sets
are generated for each of the 10 orthogonal Hessian directions, and the full uncertainties are
obtained by adding uncertainties from individual directions in quadrature [67]. We find good
agreements between uncertainties from the two methods in general. The relative uncertainties
of parameters for gluon are 2 ∼5 times larger than those of the quark, and also are more
asymmetric, indicating a larger fraction of quark jets than gluon jet in those measurements.
We compare our fragmentation functions fitted at NLO to those from NNFF1.1, BKK
and DSS[36–40] as a function of the momentum fraction xand at the scale Q0= 5 GeV,
which is presented in Fig. 8 for u-quark and in Fig. 9 for gluon respectively. We should
emphasize that in this comparison of our fit we use a restricted parametrization form, namely
setting equal of all quark fragmentation functions, which are allowed to be different in fits of
NNFF1.1, BKK and DSS, and the error criterion chosen by us is ∆ χ2= 1. It should be noted
that the small uncertainties in our work, which will be shown below, are partly attributed to
the specific assumption we have made in our parametrization.
The upper panel in both figures illustrates the value of the fragmentation function mul-
tiplied by the momentum fraction xas a function of xand in the lower one all results are
normalized to the central value of our findings. Finally, we need to mention that the col-
ored bands represent the estimated uncertainties from the corresponding fits when they are
available.
For the uquark, we observe a good agreement between NNFF1.1 results and our work
in the region 0 .1< x < 0.3 in Fig. 8. However, significant deviations, especially in the small
xregion, are observed. These deviations can reach up to nearly 80%. On the other hand,
our results remain within the error band of NNFF1.1 results in lower regions. It is important
– 20 –012xD(x)Q = 5.0 GeV 
u quark NNFF1.1
this work
BKK
DSS
102
101
100
x12ratioFigure 8 . The u-quark fragmentation function at Q0= 5 GeV from our nominal NLO fit as a function
of the momentum fraction x, and its comparison to the NNFF1.1, BKK and DSS results. The colored
bands indicate the uncertainties as estimated with the Hessian (MC) method for our (NNFF1.1) fit.
01234xD(x)Q = 5.0 GeV 
gluonNNFF1.1
this work
BKK
DSS
102
101
100
x024ratio
Figure 9 . The gluon fragmentation function at Q0= 5 GeV from our nominal NLO fit as a function
of the momentum fraction x, and its comparison to the NNFF1.1, BKK and DSS results. The colored
bands indicate the uncertainties as estimated with the Hessian (MC) method for our (NNFF1.1) fit.
– 21 –to note that the error band of NNFF1.1 data is large in the small xregion (where x <0.1),
indicating a lack of well-fitted data in that range. Comparatively, the BKK results exhibit
significant deviations from our findings throughout the entire region. Particularly in the small
xregion, the deviation can be as large as 160%. Unfortunately, the error data for BKK is
not available. DSS data only fits from 0.05 to 1, and errors are not provided. In the region
of 0.05< x < 0.3, a close resemblance with our work is also observed with the maximum
deviation about 20%. Furthermore, both the BKK and NNFF1.1 data show a decreasing
trend as xincreases, DSS data, in its available region, a decreasing trend is also observed,
while our results demonstrate an increase as xapproaches approximately 0.1, followed by a
decrease.
In the case of the gluon, Fig. 9 reveals significant discrepancies among the four results.
Firstly, it is evident that these results do not agree except for the BKK and DSS fits, indicating
a tension between different fits of the gluon fragmentation function. Secondly, the error band
associated with NNFF1.1 data is notably large, suggesting a higher level of uncertainties in
that dataset. Further examination reveals that in certain regions (specifically for x <0.5), the
ratio with respect to our work is less than 4. However, beyond this range, the ratio experiences
a sudden and pronounced increase. The upper panel also highlights the contrasting trends
exhibited by the BKK and DSS results. Specifically, the BKK results consistently decrease
asxincreases. But DSS results are not available at 0 .01< x < 0.05, therefore, its property
is not known in these regions. In contrast, our fit and the NNFF1.1 data initially display
an increase, followed by a subsequent decrease. Our results reach their maximum value at
approximately x= 0.05, while the NNFF1.1 data reach their peak at around x= 0.1. The
notable disparities among different datasets emphasize the need for additional constraints
and further data to improve the accuracy of the gluon fit.
6 Conclusions
In this work, we propose a new prescription for combining general-purpose Monte-Carlo gen-
erators with fragmentation functions (FFs) at NLO in QCD. This new framework, dubbed
FMNLO, is based on a hybrid scheme of NLO calculations utilizing a phase-space slicing of
collinear regions in combination with the usual local subtraction methods, and organizes var-
ious ingredients for fragmentation predictions in a way suitable for Monte Carlo calculations.
As a proof of concept, we realize FMNLO with MG5 aMC@NLO. The corresponding code is
publicly available and is introduced in Appendix A. Our scheme and its implementation are
validated for several scenarios in both lepton collisions and hadron collisions.
The combination of general-purpose MC generators and FFs allows for the study of single-
hadron production for various hard process at NLO in QCD with general selection cuts or
jet reconstruction. As examples, we compare the predictions of FMNLO with experimental
measurements of jet production with a tagged isolated photon, jet production with a tagged Z
boson, and inclusive dijet production. Also, we boost FMNLO with interpolation techniques,
such that for a given measurement, the time-consuming calculation of NLO partonic cross
– 22 –section can be reused when the fragmentation functions are changed. The combination of
these two features endows it with the unique ability of making theoretical predictions for
a wide range of measurements within a reasonable time consumption, which is essential for
a global fit of FFs. We demonstrate this ability by performing a NLO fit of parton FFs
to unidentified charged hadrons, using hadron production measurements at the LHC. Our
nominal fit shows very good agreements with the LHC data. We find that the high-precision
fragmentation measurements from ATLAS inclusive dijet production especially show a strong
constraining power on the FFs. Our unidentified charged-hadron FFs are then compared with
those from BKK, DSS and NNFF1.1. Notable disparity in gluon FF is found, indicating the
necessities of additional constraints and data in gluon fit. We emphasize that our framework
also works for FFs with specific flavors.
Besides its ability in extraction of FFs, the proposed scheme and its implementation
open the opportunity of studying BSM effects with single-hadron production. FMNLO is
also desirable for calculations of NLO hard functions needed for various predictions of QCD
resummation [70–73]. Furthermore, it can be generalized to calculate distributions of observ-
able related to transverse dependent fragmentation functions which have been widely used in
studies of jet substructures [8, 74, 75]. We leave those for future investigations and updates
of the program.
Acknowledgments
We would like to thank HX Zhu for motivating this work as well as contributions at early
stage. JG would like to thank HX Xing for discussions, B. Nachman and D. Kar for com-
munications on the ATLAS dijet data. This work was sponsored by the National Natural
Science Foundation of China under the Grant No.12275173 and No.11835005. The work of
X. Shen is supported in part by the Helmholtz-OCPC Postdoctoral Exchange Program under
Grant No. ZD2022004.
A Installation and running
The current version of the program FMNLOv1.0 and the related publications can be found on
the website2. Prerequisites on running the program include MG5aMC@NLO [46, 47] and possibly
LHAPDF6 library [76] for invoking fragmentation functions therein. The recommended version
ofMG5aMC@NLO is3.4.0 which has been tested thoroughly. The package FastJet [77, 78]
is also required which can be installed within MG5aMC@NLO . The paths to MG5aMC@NLO and
LHAPDF6 can be set separately at the top of Makefile under the main directory FMNLOv1.0
and of mgen.sh under directory mgen. The HOPPET v1.2.1-devel [48, 49] program has been
modified and integrated into the source file. Users should cite original works of those external
programs properly together with this publication. One can simply run make under the main
directory to compile all ingredients. Note that in order to retain full quark-flavor information
2http://fmnlo.sjtu.edu.cn/ ~fmnlo/
– 23 –inMG5aMC@NLO , one has to modify madgraph/core/helas objects.py in the native MGdi-
rectory to disable group of identical processes. That can be achieved by simply replace True
with False at the 3486-th line of the file. We mentioned earlier that the FKS subtractions
have not been implemented for NLO calculations of DIS processes in MG5aMC@NLO . However,
we are working toward an alternative solution that will come with the next release of FMNLO .
To calculate the parton fragmentation in a typical hard scattering process, two subse-
quent steps are followed. First, inside the directory mgen one invokes MG5aMC@NLO with a
customized analysis routine (a module ) to generate the interpolation tables storing matri-
ces of coefficient functions in Eq. 2.12. We have released modules for all processes included
in this study. New modules can be added easily following existing examples. In mgen, the
subdirectory common contains the common ingredients needed for all modules. Each mod-
ule has a separate directory including init.sh forMG5aMC@NLO command, precuts.f for
the selection of relevant phase space, and analysis HwUpp.f containing the main analysis
routine.
Various input parameters are specified in the file proc.run . Each line contains a record
for one input variable: a character tag with the name of the variable, followed by the vari-
able’s value. We take proc.run used for the calculation of CMS isolated-photon-tagged jet
measurement as an example.
# main input for generation of NLO fragmentation grid file by MG5
process A180104895
# subgrids with name tags
grid pp
obs 4
cut 0.02
pta1 60.0
pta2 10000.0
ptj1 30.0
ptj2 10000.0
# in MG5 format
set lpp1 1
set lpp2 1
set ebeam1 2510.0
set ebeam2 2510.0
set lhaid 13100
set iseed 11
set muR_over_ref 1.0
set muF_over_ref 1.0
end
•process specifies the name of the directory that contains the module to be loaded.
•grid is a string indicating the name of the running job.
•obsspecifies different distributions to be calculated: 1for distribution in ζ,2for dis-
tribution in pT,h,3and4for distributions in ξj
Torξγ(Z)
T.
•cutgives the slicing parameter λand a value of 0 .02 is recommended.
– 24 –•pta1 andpta2 specify the lower and upper limit of the kinematic range of the transverse
momentum of the photon.
•ptj1 andptj2 specify the lower and upper limit of the kinematic range of the transverse
momentum of the jet.
•Other possible inputs in this block include hrap andpthspecifying the upper limit on
the absolute pseudorapidity and the lower limit on the transverse momentum of the
hadrons. isca determines the choice on central value of the fragmentation scale, 1
for our nominal choice of max {pT,j}(Q) for pp(e+e−) collisions, and 2for using pT,h
(Eh). Default values of all above variables are assigned via the script file mgen.sh for
individual modules if not specified in proc.run .
•The remaining inputs follow the same syntax as the normal MG5aMC@NLO command, for
instance, lpp1 and ebeam1 are type and energy of collision particle 1, lhaid specifies
parton distribution of proton used for the calculation, etc.
The generation of fragmentation grid can be launched by the command ./mgen.sh proc.run .
Note that for the same process, generation of multiple grids can be grouped into a single
input file by simply repeating the two blocks after the process line. Once the generation of
grid is finished, it will be stored in an upper-level directory grid, for instance with a name
A180104895 pp.fmg for above example.
After generation of the grid, the calculation of physical distributions can be done within
seconds by running ./fmnlo in the directory data. Input parameters at this stage are specified
in the file input.card .
1 # loop for D fun (1/2 -> LO/NLO) | evo for D fun (0/1 -> internal/hoppet)
2 # followed by >=1/0 -> internal/LHAPDF | FFID | FFmember
3 2 0
4 0 NNFF11_HadronSum_nlo 0
5 # normalization | grid file | binnig file
6 # 0/1/2 -> absolute dis./normalized to corresponding order/leading order
7 # can include multiple entries in several lines
8 1 "../grid/A180104895_pp.fmg" "../grid/1801-04895.Bin"
•The 3rdline specifies the order of DGLAP evolution of the fragmentation functions, 1/2
for LO and NLO respectively, followed by 0/1for using the native evolution provided
by the input fragmentation functions or evolving with HOPPET package from the initial
scale Q0.
•The 4thline indicates the choice of fragmentation functions. A value of 0indicates
the usage of fragmentation functions from LHAPDF6 library and other integer values
correspond to fragmentation functions implemented in FMNLO1.0 , e.g., 1for the NLO
nominal fragmentation functions presented in this study (note one should use the NLO
evolution with HOPPET concurrently), 2for the BKK functions of unidentified charged
hadrons, and 3(4) for the KKP [31](DSS) functions. The following two inputs specify
– 25 –the name and set number of the fragmentation function in the case of using LHAPDF6.
Note that the value of the QCD coupling used in the evolution of fragmentation functions
is set consistently. It can either be imported from LHAPDF6 or set by HOPPET with
αS(MZ) fixed at 0.118. Other possibilities on the choice of fragmentation function can
be implemented by modifying the source file internal.f .
•The 8thline specifies choice of normalization: 0for absolute distributions, 1and 2
for normalized distributions to the total cross sections of corresponding order or LO
respectively. The followed are the name of the pre-generated grid file for the calculation
and the name of the file containing binning of the distribution. Multiple entries similar
to the 8thline can be added to calculate several distributions at once. The binning is
set via two-line inputs. For example, in 1801-04895.Bin ,
8
0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5
the first line specifies the total number of kinematic bins and the second line contains
all nodes of the bins in sequence.
Once ./fmnlo is executed, the format of the printout can be understood easily
ID(1/x dx/dkv) zd zu LO*{1,0.5,2} NLO*{1,0.5,2} NLO/LO
1 5.00000E-01 1.00000E+00 2.45041E-01 .. 2.61256E-01 .. 1.066 ..
2 1.00000E+00 1.50000E+00 6.69355E-01 .. 7.61367E-01 .. 1.137 ..
3 1.50000E+00 2.00000E+00 1.33705E+00 .. 1.61524E+00 .. 1.208 ..
4 2.00000E+00 2.50000E+00 2.12904E+00 .. 2.51633E+00 .. 1.182 ..
5 2.50000E+00 3.00000E+00 2.93954E+00 .. 3.23861E+00 .. 1.102 ..
6 3.00000E+00 3.50000E+00 3.65409E+00 .. 3.60505E+00 .. 0.987 ..
7 3.50000E+00 4.00000E+00 4.21952E+00 .. 3.12574E+00 .. 0.741 ..
8 4.00000E+00 4.50000E+00 2.98053E+00 .. 1.44477E+00 .. 0.485 ..
which contains the distribution at LO and NLO for three choices of the fragmentation scale
µD={1,1/2,2}µD,0and the ratio of NLO to LO predictions for all kinematic bins specified.
B Comparison of the theory to data
In this appendix we include more details on our nominal NLO fit to the LHC data. We first
show the total χ2profile from scans on individual parameters of the fragmentation functions
in Fig. 10 and 11 for quark and gluon respectively. In each scan all other parameters are set
free and are fitted to minimize the constrained χ2. The fragmentation function of quarks is
better constrained as mentioned above. The χ2profile shows a parabolic shape around the
minimum. The fragmentation function of gluon is less constrained especially for parameters
a0/1/2. For instance, the increase of χ2can barely reach 2 units even we scan over a wide
range of a0anda1. The large variations of the parameters also lead to a non-parabolic shape
of the χ2profile in the scan region.
Our NLO predictions based on the best-fit of the fragmentation functions and their
comparison to data are presented in Figs. 12 to 15. In the lower panel of each figure the
– 26 –0.3 0.4 0.5
q
02468102
1.75 2.00 2.25 2.50
q
02468102
4 6 8
a0,q02468102
2.6
 2.4
 2.2
 2.0
a1,q02468102
1.5 2.0 2.5 3.0
a2,q02468102
Figure 10 . Profile of total χ2change from scans on individual parameters of the quark fragmentation
functions under nominal fit with other parameters freely varying.
predictions are normalized to the central value of the experimental data. The colored bands
indicate estimated theoretical uncertainties from scale variations as explained in Sec. 4.1. We
show the comparison to isolated-photon production in Fig. 12 for both the CMS and ATLAS
measurements. The theoretical predictions locate within 10% of the data in general with the
exception of the first(last) bin in ξγ
T(pT,h) which corresponds to very large xregion. For the
Zboson production shown in Fig. 13, we again find good agreements to both the CMS and
ATLAS measurements. Furthermore, there is consistency observed between the two indepen-
dent measurements, providing additional confidence in the accuracy of our calculations. The
large χ2observed for the ATLAS data is mostly driven by the first pT,hbin of the highest pT,Z
region ( >60 GeV), which has a high precision of a few percents. Notably it has a pT,haround
4 GeV and receives contributions from region of momentum fractions x≲0.01, and may be
affected by additional uncertainties from both theoretical and experimental sides. Lastly in
Figs. 14-15 we present comparisons to the ATLAS dijet measurements for both the central
and the forward jet and for the selected bins of the transverse momentum of the jet. We find
excellent agreements between our theoretical predictions and the data in the full kinematic
region even without considering the theoretical uncertainties. The scale variations are almost
an order of magnitude larger than the experimental uncertainties.
– 27 –0.4 0.6 0.8 1.0
g
02468102
8 10 12
g
02468102
20 30 40 50 60
a0,g02468102
5
 4
 3
 2
a1,g02468102
5 10 15 20
a2,g02468102
Figure 11 . Profile of total χ2change from scans on individual parameters of the gluon fragmentation
functions under nominal fit with other parameters freely varying.
0.51.01.52.01/NjdNtrk/dT
CMS pp 5.02 T eV
+jet
Best Fit
Data
0.5 1.0 1.5 2.0 2.5 3.0
T
0.51.01.5Ratio
0.00.10.20.30.40.51/NjdNtrk/dpT,h
ATLAS pp 5.02 T eV
+jet
Best Fit
Data
101102
pT,h (GeV)0.51.01.5Ratio
Figure 12 . Our NLO predictions, obtained using the best-fit fragmentation functions, are shown and
compared to the CMS and ATLAS data on the isolated photon production. The blue solid line and
green dash-dotted line represent experimental data and our best-fit results respectively. The enveloped
scale uncertainty is shown by the colored bands. The total experimental uncertainty is shown by the
error bar. The results are normalized to central value of the experimental data and shown in the lower
panel with the same colors and line styles.
– 28 –0.00.10.20.31/NZdNtrk/dpT,h
CMS pp 5.02 T eV
Z+jetBest Fit
Data
1014×1006×1002×1013×101
pT,h (GeV)0.51.01.5Ratio
0.0250.0500.0750.1000.1251/NZd2Ntrk/dpT,h
ATLAS pp 5.02 T eV
Z+jet
15 GeV<pT<30 GeVBest Fit
Data
1014×1006×100
pT,h (GeV)0.51.01.5Ratio
0.00.10.20.31/NZd2Ntrk/dpT,h
ATLAS pp 5.02 T eV
Z+jet
30 GeV<pT<60 GeVBest Fit
Data
1014×1006×1002×1013×101
pT,h (GeV)0.51.01.5Ratio
0.00.20.41/NZd2Ntrk/dpT,h
ATLAS pp 5.02 T eV
Z+jet
pT>60 GeVBest Fit
Data
101
pT,h (GeV)0.51.01.5RatioFigure 13 . Similar to Fig. 12 but for the Zboson production and in different bins of transverse
momentum of the Zboson.
C Theory ingredients
We quote the LO unregularized splitting functions below:
P(0)
qq(z, ϵ) =CF1 +z2
1−z−ϵ(1−z)
, (C.1)
P(0)
gg(z, ϵ) = 2 CA(1−z+z2)2
z(1−z), (C.2)
P(0)
gq(z, ϵ) =CF1 + (1 −z)2
z−ϵz
, (C.3)
P(0)
qg(z, ϵ) =TF
1−2z(1−z)
1−ϵ
. (C.4)
Explicitly, the LO regularized splitting functions are given by
P+(0)
qq(z) =CF1 +z2
[1−z]++3
2δ(1−z)
, (C.5)
P+(0)
gg(z) = 2 CAz
[1−z]++1−z
z+z(1−z)
+δ(1−z)(11CA−4nfTF)
6, (C.6)
P+(0)
gq(z) =CF1 + (1 −z)2
z, (C.7)
– 29 –0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    200 GeV<pT<300 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    500 GeV<pT<600 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    700 GeV<pT<800 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    900 GeV<pT<1000 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    1200 GeV<pT<1400 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet central
    1600 GeV<pT<2000 GeVBest Fit
Data
102
101
100
0.51.01.5RatioFigure 14 . Similar to Fig. 12 but for the dijet production and in different bins of transverse momentum
of the central jet.
P+(0)
qg(z) =TF 
z2+ (1−z)2
. (C.8)
For the process of e+(p1)+e−(p2)→γ∗(q)→h+X, the normalized single hadron differential
cross sections in xh, where xhis the energy fraction carried by the tagged hadron (h), can be
written as
1
σ0dσ(γ∗)
dxh=dˆσ(γ∗)
dxg⊗Dh/g(z, µD) +1
nfP
j=1e2qjX
i=q,¯qe2
idˆσ(γ∗)
dxi⊗Dh/i(z, µD), (C.9)
– 30 –0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    200 GeV<pT<300 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    500 GeV<pT<600 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    700 GeV<pT<800 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    900 GeV<pT<1000 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    1200 GeV<pT<1400 GeVBest Fit
Data
102
101
100
0.51.01.5Ratio
0.00.51.01.52.01/NjdNtrk/d
    ATLAS pp 13 T eV
    dijet forward
    1600 GeV<pT<2000 GeVBest Fit
Data
102
101
100
0.51.01.5RatioFigure 15 . Similar to Fig. 12 but for the dijet production and in different bins of transverse momentum
of the forward jet.
where σ0=nfP
i=1e2
qi4πα2CA
3Q2with Q2=q2, and
dˆσ(γ∗)
dxq=dˆσ(γ∗)
dx¯q=δ(xq−1) +αS(µR)
π1
2P+(0)
qq(xq) ln(Q2
µ2
D) +4
3ln(1−xq)
1−xq
+
−1
[1−xq]++4π2−27
9δ(xq−1)−4
3(x2
q+ 1) ln( xq)
xq−1+1
3(5−3xq)
−2
3(xq+ 1) ln(1 −xq)
,
– 31 –dˆσ(γ∗)
dxg=αS(µR)
π
P+(0)
gq(xq) ln(Q2
µ2
D) +4
3(1 + (1 −xg)2)ln(x2
g(1−xg))
xg
.
Note that P+(0)
qq(xq) and P+(0)
gq(xg) are given by (C.5) and (C.7), respectively.
For the process of µ+(p1) +µ−(p2)→H(q)→h+X, we have
1
σ0dσ(H)
dxh=X
i=q,¯q,gdˆσ(H)
dxi⊗Dh/i(z, µD), (C.10)
where
σ0=α αS(µR)2CACFQ2C2
tm2
µ 
Q2−2m2
µ
576π2s2
Wv2m2
W 
m2
H−Q22,
dˆσ(H)
dxg= 2δ(xg−1) +αS(µR)
π
P+(0)
gg(xg) ln(Q2
µ2
D) + 2CAln(1−xg)
1−xg
+
−23
361
[1−xg]++ (π2
3+349
108)δ(xg−1) +ln(x2
g)
1−xg+23
36(x2
g+xg+ 1)
+ (1
xg−x2
g+xg−2) ln( x2
g(1−xg))
,
dˆσ(H)
dxq=dˆσ(H)
dx¯q=αS(µR)
π
P+(0)
qg(xq) ln(Q2
µ2
D) +1
2(x2
q+ (1−xq)2) ln(x2
q(1−xq))
+1
4xq(4−7xq)
.
Similarly, P+(0)
gg(xq) and P+(0)
qg(xg) are given by (C.6) and (C.8), respectively.
References
[1] J. C. Collins, D. E. Soper and G. F. Sterman, Factorization of Hard Processes in QCD ,Adv.
Ser.Direct. High Energy Phys. 5(1989) 1–91 [ hep-ph/0409313 ].
[2] J. C. Collins, Hard scattering factorization with heavy quarks: A General treatment ,Phys. Rev.
D58(1998) 094002 [ hep-ph/9806259 ].
[3] A. Metz and A. Vossen, Parton Fragmentation Functions ,Prog. Part. Nucl. Phys. 91(2016)
136–202 [ 1607.02521 ].
[4] A. Mitov, S. Moch and A. Vogt, Next-to-Next-to-Leading Order Evolution of Non-Singlet
Fragmentation Functions ,Phys. Lett. B638(2006) 61–67 [ hep-ph/0604053 ].
[5] S. Moch and A. Vogt, On third-order timelike splitting functions and top-mediated Higgs decay
into hadrons ,Phys. Lett. B659(2008) 290–296 [ 0709.3899 ].
[6] A. A. Almasy, S. Moch and A. Vogt, On the Next-to-Next-to-Leading Order Evolution of
Flavour-Singlet Fragmentation Functions ,Nucl. Phys. B854(2012) 133–152 [ 1107.2263 ].
[7] H. Chen, T.-Z. Yang, H. X. Zhu and Y. J. Zhu, Analytic Continuation and Reciprocity Relation
for Collinear Splitting in QCD ,Chin. Phys. C45(2021), no. 4 043101 [ 2006.10534 ].
[8] M.-x. Luo, T.-Z. Yang, H. X. Zhu and Y. J. Zhu, Unpolarized quark and gluon TMD PDFs and
FFs at N3LO,JHEP 06(2021) 115 [ 2012.03256 ].
– 32 –[9] M. A. Ebert, B. Mistlberger and G. Vita, TMD fragmentation functions at N3LO,JHEP 07
(2021) 121 [ 2012.07853 ].
[10] P. J. Rijken and W. L. van Neerven, O (alpha-s**2) contributions to the longitudinal
fragmentation function in e+ e- annihilation ,Phys. Lett. B386(1996) 422–428
[hep-ph/9604436 ].
[11] P. J. Rijken and W. L. van Neerven, Higher order QCD corrections to the transverse and
longitudinal fragmentation functions in electron - positron annihilation ,Nucl. Phys. B487
(1997) 233–282 [ hep-ph/9609377 ].
[12] A. Mitov and S.-O. Moch, QCD Corrections to Semi-Inclusive Hadron Production in
Electron-Positron Annihilation at Two Loops ,Nucl. Phys. B751(2006) 18–52
[hep-ph/0604160 ].
[13] J. Blumlein and V. Ravindran, O (alpha**2(s)) Timelike Wilson Coefficients for
Parton-Fragmentation Functions in Mellin Space ,Nucl. Phys. B749(2006) 1–24
[hep-ph/0604019 ].
[14] G. Altarelli, R. K. Ellis, G. Martinelli and S.-Y. Pi, Processes Involving Fragmentation
Functions Beyond the Leading Order in QCD ,Nucl. Phys. B160(1979) 301–329.
[15] P. Nason and B. R. Webber, Scaling violation in e+ e- fragmentation functions: QCD
evolution, hadronization and heavy quark mass effects ,Nucl. Phys. B421(1994) 473–517.
[Erratum: Nucl.Phys.B 480, 755 (1996)].
[16] W. Furmanski and R. Petronzio, Lepton - Hadron Processes Beyond Leading Order in Quantum
Chromodynamics ,Z.Phys. C11(1982) 293.
[17] D. Graudenz, One particle inclusive processes in deeply inelastic lepton - nucleon scattering ,
Nucl. Phys. B432(1994) 351–376 [ hep-ph/9406274 ].
[18] D. de Florian, M. Stratmann and W. Vogelsang, QCD analysis of unpolarized and polarized
Lambda baryon production in leading and next-to-leading order ,Phys. Rev. D57(1998)
5811–5824 [ hep-ph/9711387 ].
[19] D. de Florian and Y. Rotstein Habarnau, Polarized semi-inclusive electroweak structure
functions at next-to-leading-order ,Eur. Phys. J.C73(2013), no. 3 2356 [ 1210.7203 ].
[20] M. Abele, D. de Florian and W. Vogelsang, Approximate NNLO QCD corrections to
semi-inclusive DIS ,Phys. Rev. D104(2021), no. 9 094046 [ 2109.00847 ].
[21] M. Abele, D. de Florian and W. Vogelsang, Threshold resummation at NLL3 accuracy and
approximate N3LO corrections to semi-inclusive DIS ,Phys. Rev. D106(2022), no. 1 014015
[2203.07928 ].
[22] F. Aversa, P. Chiappetta, M. Greco and J. P. Guillet, QCD Corrections to Parton-Parton
Scattering Processes ,Nucl. Phys. B327(1989) 105.
[23] D. de Florian, Next-to-leading order QCD corrections to one hadron production in polarized pp
collisions at RHIC ,Phys. Rev. D67(2003) 054004 [ hep-ph/0210442 ].
[24] B. Jager, A. Schafer, M. Stratmann and W. Vogelsang, Next-to-leading order QCD corrections
to high p(T) pion production in longitudinally polarized pp collisions ,Phys. Rev. D67(2003)
054005 [ hep-ph/0211007 ].
[25] F. Arleo, M. Fontannaz, J.-P. Guillet and C. L. Nguyen, Probing fragmentation functions from
same-side hadron-jet momentum correlations in p-p collisions ,JHEP 04(2014) 147
[1311.7356 ].
[26] T. Kaufmann, A. Mukherjee and W. Vogelsang, Hadron Fragmentation Inside Jets in Hadronic
Collisions ,Phys. Rev. D92(2015), no. 5 054015 [ 1506.01415 ]. [Erratum: Phys.Rev.D 101,
079901 (2020)].
– 33 –[27] Y.-T. Chien, Z.-B. Kang, F. Ringer, I. Vitev and H. Xing, Jet fragmentation functions in
proton-proton collisions using soft-collinear effective theory ,JHEP 05(2016) 125 [ 1512.06851 ].
[28] J. Binnewies, B. A. Kniehl and G. Kramer, Next-to-leading order fragmentation functions for
pions and kaons ,Z.Phys. C65(1995) 471–480 [ hep-ph/9407347 ].
[29] J. Binnewies, B. A. Kniehl and G. Kramer, Pion and kaon production in e+ e- and e p
collisions at next-to-leading order ,Phys. Rev. D52(1995) 4947–4960 [ hep-ph/9503464 ].
[30] J. Binnewies, B. A. Kniehl and G. Kramer, Neutral kaon production in e+e−, ep, and pp ¯
collisions at next-to-leading order ,Phys. Rev. D53(Apr, 1996) 3573–3581.
[31] B. A. Kniehl, G. Kramer and B. Potter, Fragmentation functions for pions, kaons, and protons
at next-to-leading order ,Nucl. Phys. B582(2000) 514–536 [ hep-ph/0010289 ].
[32] L. Bourhis, M. Fontannaz, J. P. Guillet and M. Werlen, Next-to-leading order determination of
fragmentation functions ,Eur. Phys. J.C19(2001) 89–98 [ hep-ph/0009101 ].
[33] S. Albino, B. A. Kniehl and G. Kramer, Fragmentation functions for light charged hadrons with
complete quark flavor separation ,Nucl. Phys. B725(2005) 181–206 [ hep-ph/0502188 ].
[34] M. Hirai, S. Kumano, T. H. Nagai and K. Sudoh, Determination of fragmentation functions
and their uncertainties ,Phys. Rev. D75(2007) 094009 [ hep-ph/0702250 ].
[35] S. Kretzer, Fragmentation functions from flavor inclusive and flavor tagged e+ e- annihilations ,
Phys. Rev. D62(2000) 054001 [ hep-ph/0003177 ].
[36] D. de Florian, R. Sassot and M. Stratmann, Global analysis of fragmentation functions for
pions and kaons and their uncertainties ,Phys. Rev. D75(Jun, 2007) 114010.
[37] D. de Florian, R. Sassot and M. Stratmann, Global analysis of fragmentation functions for
protons and charged hadrons ,Phys. Rev. D76(Oct, 2007) 074033.
[38] D. de Florian, R. Sassot, M. Epele, R. J. Hern´ a ndez-Pinto and M. Stratmann, Parton-to-pion
fragmentation reloaded ,Physical Review D91(jan, 2015).
[39] D. de Florian, M. Epele, R. J. Hern´ a ndez-Pinto, R. Sassot and M. Stratmann, Parton-to-kaon
fragmentation revisited ,Physical Review D95(may, 2017).
[40] I. Borsa, R. Sassot, D. de Florian and M. Stratmann, Pion fragmentation functions at high
energy colliders ,Physical Review D105(feb, 2022).
[41] N. Sato, J. J. Ethier, W. Melnitchouk, M. Hirai, S. Kumano and . A. Accardi, First Monte
Carlo analysis of fragmentation functions from single-inclusive e+e−annih ilation ,Phys. Rev.
D94(2016), no. 11 114004 [ 1609.00899 ].
[42]NNPDF Collaboration, V. Bertone, S. Carrazza, N. P. Hartland, E. R. Nocera and J. ˜Rojo, A
determination of the fragmentation functions of pions, kaons, and protons with faithful u
ncertainties ,Eur. Phys. J.C77(2017), no. 8 516 [ 1706.07049 ].
[43]NNPDF Collaboration, V. Bertone, N. P. Hartland, E. R. Nocera, J. Rojo and L. Rottoli,
Charged hadron fragmentation functions from collider data ,Eur. Phys. J.C78(2018), no. 8
651 [ 1807.03310 ].
[44] R. A. Khalek, V. Bertone and E. R. Nocera, Determination of unpolarized pion fragmentation
functions using semi-inclusive deep-inelast ic-scattering data ,Phys. Rev. D104(2021), no. 3
034007 [ 2105.08725 ].
[45] M. Soleymaninia, H. Hashamipour and H. Khanpour, Neural network QCD analysis of charged
hadron fragmentation functions in the presence of SI DIS data ,Phys. Rev. D105(2022), no. 11
114018 [ 2202.10779 ].
[46] J. Alwall, R. Frederix, S. Frixione, V. Hirschi, F. Maltoni, O. Mattelaer, H. S. Shao, T. Stelzer,
P. Torrielli and M. Zaro, The automated computation of tree-level and next-to-leading order
– 34 –differential cross sections, and their matching to parton shower simulations ,JHEP 07(2014)
079 [ 1405.0301 ].
[47] R. Frederix, S. Frixione, V. Hirschi, D. Pagani, H. S. Shao and M. Zaro, The automation of
next-to-leading order electroweak calculations ,JHEP 07(2018) 185 [ 1804.10017 ]. [Erratum:
JHEP 11, 085 (2021)].
[48] G. P. Salam and J. Rojo, A Higher Order Perturbative Parton Evolution Toolkit (HOPPET) ,
Comput. Phys. Commun. 180(2009) 120–156 [ 0804.3755 ].
[49] G. Salam and J. Rojo, The HOPPET NNLO parton evolution package , in
16th International Workshop on Deep Inelastic Scattering and Related Subjects, p. 42, 7, 2008.
0807.0198 .
[50] S. Catani and M. H. Seymour, The Dipole formalism for the calculation of QCD jet
cross-sections at next-to-leading order ,Phys. Lett. B378(1996) 287–301 [ hep-ph/9602277 ].
[51] S. Catani, S. Dittmaier, M. H. Seymour and Z. Trocsanyi, The Dipole formalism for
next-to-leading order QCD calculations with massive partons ,Nucl. Phys. B627(2002)
189–265 [ hep-ph/0201036 ].
[52] S. Frixione, Z. Kunszt and A. Signer, Three jet cross-sections to next-to-leading order ,Nucl.
Phys. B467(1996) 399–442 [ hep-ph/9512328 ].
[53] S. Frixione, A General approach to jet cross-sections in QCD ,Nucl. Phys. B507(1997)
295–314 [ hep-ph/9706545 ].
[54] M. Stratmann and W. Vogelsang, Next-to-leading order evolution of polarized and unpolarized
fragmentation functions ,Nucl. Phys. B496(1997) 41–65 [ hep-ph/9612250 ].
[55] B. W. Harris and J. F. Owens, The Two cutoff phase space slicing method ,Phys. Rev. D65
(2002) 094032 [ hep-ph/0102128 ].
[56] M. Werlen, “INCNLO-direct photon and inclusive hadron production code website.” Version
1.4. http://lapth.cnrs.fr/PHOX FAMILY.
[57] J. Pumplin, D. R. Stump, J. Huston, H. L. Lai, P. M. Nadolsky and W. K. Tung, New
generation of parton distributions with uncertainties from global QCD analysis ,JHEP 07(2002)
012 [ hep-ph/0201195 ].
[58] S. Dulat, T.-J. Hou, J. Gao, M. Guzzi, J. Huston, P. Nadolsky, J. Pumplin, C. Schmidt,
D. Stump and C.-P. Yuan, New parton distribution functions from a global analysis of quantum
chromodynamics ,Physical Review D93(feb, 2016).
[59]CMS Collaboration, A. M. Sirunyan et.al.,Observation of Medium-Induced Modifications of
Jet Fragmentation in Pb-Pb Collisions at√sNN=5.02 TeV Using Isolated Photon-Tagged
Jets,Phys. Rev. Lett. 121(2018), no. 24 242301 [ 1801.04895 ].
[60] M. Cacciari, G. P. Salam and G. Soyez, The anti- ktjet clustering algorithm ,JHEP 04(2008)
063 [ 0802.1189 ].
[61]CMS Collaboration, A. M. Sirunyan et.al.,Using Z Boson Events to Study Parton-Medium
Interactions in Pb-Pb Collisions ,Phys. Rev. Lett. 128(2022), no. 12 122301 [ 2103.04377 ].
[62]ATLAS Collaboration, G. Aad et.al.,Properties of jet fragmentation using charged particles
measured with the ATLAS detector in ppcollisions at√s= 13 TeV,Phys. Rev. D100(2019),
no. 5 052011 [ 1906.09254 ].
[63]ATLAS Collaboration, M. Aaboud et.al.,Comparison of Fragmentation Functions for Jets
Dominated by Light Quarks and Gluons from ppand Pb+Pb Collisions in ATLAS ,Phys. Rev.
Lett. 123(2019), no. 4 042001 [ 1902.10007 ].
[64]ATLAS Collaboration, G. Aad et.al.,Medium-Induced Modification of Z-Tagged Charged
Particle Yields in Pb+PbCollisions at 5.02 TeV with the ATLAS Detector ,Phys. Rev. Lett.
126(2021), no. 7 072301 [ 2008.09811 ].
– 35 –[65] D. d 'Enterria, K. J. Eskola, I. Helenius and H. Paukkunen, Confronting current NLO parton
fragmentation functions with inclusive charged-particle spectra at hadron colliders ,Nuclear
Physics B883(jun, 2014) 615–628.
[66] T. N. Collaboration, V. Bertone, N. P. Hartland, E. R. Nocera, J. Rojo and L. Rottoli, Charged
hadron fragmentation functions from collider data , 2019.
[67] J. Gao, L. Harland-Lang and J. Rojo, The Structure of the Proton in the LHC Precision Era ,
Phys. Rept. 742(2018) 1–121 [ 1709.04922 ].
[68] F. James and M. Roos, Minuit - a system for function minimization and analysis of the
parameter errors and correlations ,Computer Physics Communications 10(1975), no. 6 343–367.
[69] J. Pumplin, D. R. Stump and W. K. Tung, Multivariate fitting and the error matrix in global
analysis of data ,Physical Review D65(dec, 2001).
[70] A. Gao, H. T. Li, I. Moult and H. X. Zhu, Precision QCD Event Shapes at Hadron Colliders:
The Transverse Energy-Energy Correlator in the Back-to-Back Limit ,Phys. Rev. Lett. 123
(2019), no. 6 062001 [ 1901.04497 ].
[71] H. Chen, M.-X. Luo, I. Moult, T.-Z. Yang, X. Zhang and H. X. Zhu, Three point energy
correlators in the collinear limit: symmetries, dualities and analytic results ,JHEP 08(2020),
no. 08 028 [ 1912.11050 ].
[72] Z.-B. Kang, D. Y. Shao and F. Zhao, QCD resummation on single hadron transverse
momentum distribution with the thrust axis ,JHEP 12(2020) 127 [ 2007.14425 ].
[73] H. T. Li, Z. L. Liu and I. Vitev, Centrality-dependent modification of hadron and jet production
in electron-nucleus collisions ,2303.14201 .
[74] Z.-B. Kang, K. Lee, J. Terry and H. Xing, Jet fragmentation functions for Z-tagged jets ,Phys.
Lett. B798(2019) 134978 [ 1906.07187 ].
[75] Y.-T. Chien, R. Rahn, D. Y. Shao, W. J. Waalewijn and B. Wu, Precision boson-jet azimuthal
decorrelation at hadron colliders ,JHEP 02(2023) 256 [ 2205.05104 ].
[76] A. Buckley, J. Ferrando, S. Lloyd, K. Nordstr¨ om, B. Page, M. R¨ ufenacht, M. Sch¨ onherr and
G. Watt, LHAPDF6: parton density access in the LHC precision era ,TheEuropean Physical
Journal C75(mar, 2015).
[77] M. Cacciari and G. P. Salam, Dispelling the N3myth for the ktjet-finder ,Phys. Lett. B641
(2006) 57–61 [ hep-ph/0512210 ].
[78] M. Cacciari, G. P. Salam and G. Soyez, FastJet User Manual ,Eur. Phys. J.C72(2012) 1896
[1111.6097 ].
– 36 –