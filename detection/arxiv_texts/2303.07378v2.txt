MNRAS 000, 1â€“13 (2018) Preprint 11 December 2023 Compiled using MNRAS L ATEX style file v3.0
Dark-ages reionization and galaxy formation simulation â€” XXI.
Constraining the evolution of the ionizing escape fraction
Simon J. Mutch,1,2,3â˜…Bradley Greig,1,2Yuxiang Qin,1,2Gregory B. Poole,4,1J. Stuart B. Wyithe1,2
1School of Physics, The University of Melbourne, Parkville, VIC 3010, Australia
2ARC Centre of Excellence for All Sky Astrophysics in 3 Dimensions (ASTRO 3D)
3Melbourne Data Analytics Platform, The University of Melbourne, Parkville, VIC 3010, Australia
4Centre for Astrophysics and Supercomputing, Swinburne University of Technology, PO Box 218, Hawthorn, VIC 3122, Australia
Accepted XXX. Received YYY; in original form ZZZ
ABSTRACT
The fraction of ionizing photons that escape their host galaxies to ionize hydrogen in the inter-galactic medium (IGM) is a
criticalparameterinanalysesofthereionizationera.Inthispaperweusethe Meraxes semi-analyticgalaxyformationmodelto
inferthemeanionizingphotonescapefractionanditsdependenceongalaxypropertiesthroughjointmodellingoftheobserved
high redshift galaxy population and existing constraints on the reionization history. Using a Bayesian framework, and under the
assumptionthatescapefractionisprimarilyrelatedtohalomass,wefindthatthejointconstraintsoftheUVluminosityfunction,
CMB optical depth, and the Ly ğ›¼forest require an escape fraction of (18Â±5)%for galaxies within haloes of ğ‘€â‰²109MâŠ™and
(5Â±2)%for more massive haloes. In terms of galaxy properties, this transition in escape fraction occurs at stellar masses of
ğ‘€â˜…âˆ¼107MâŠ™, nearly independent of redshift. As a function of redshift, reionization is dominated by the smaller ğ‘€â˜…â‰²107MâŠ™
galaxies with high escape fractions at ğ‘§â‰³6and by the larger ğ‘€â˜…â‰³107MâŠ™galaxies with lower escape fractions at ğ‘§â‰²6.
Galaxieswithstarformationratesof 10âˆ’2.5MâŠ™yrâˆ’1to10âˆ’1.5MâŠ™yrâˆ’1providethedominantsourceofionizingphotonsthroughout
reionization. Our results are consistent with recent direct measurements of a âˆ¼5%escape fraction from massive galaxies at
the end of reionization and support the picture of low mass galaxies being the dominant sources of ionizing photons during
reionization.
Key words: cosmology: theory; dark ages, reionization, first stars; diffuse radiation; early Universe; galaxies: high-redshift;
intergalactic medium
1 INTRODUCTION
TheEpochofReionization,duringwhichtheprogenitorsofmodern
day galaxies formed and reionized hydrogen throughout the inter-
galactic medium (IGM), is the least explored cosmic epoch. How-
ever,overthepasttwodecadestherehasbeensignificantprogressin
exploring the stellar growth history of these galaxies (e.g. Bouwens
etal.2017;Finkelsteinetal.2015),witharecentstep-changeinun-
derstandingthathasarisenthroughtheJames-WebbSpaceTelescope
(e.g. Naidu et al. 2022; Atek et al. 2022). At the same time, obser-
vations of the evolution of the ionization state of the inter-galactic
medium has been narrowed towards a scenario where reionization
completesat,orjustbelow, ğ‘§âˆ¼6(e.g.Bosmanetal.2022;Qinetal.
2021). This constraint has been achieved through a combination of
the integral measure of the reionization history obtained from CMB
measurements(e.g.PlanckCollaborationetal.2016b),andmeasure-
ments of absorption signals against sources emitting Ly- ğ›¼photons,
includingLy- ğ›¼forestopticaldepth,darkgapsandquasarLy- ğ›¼emis-
sionlinedampingwings(e.g.Becker&Bolton2013;McGreeretal.
2015; BaÃ±ados et al. 2018; Greig et al. 2022).
Starforminggalaxiesarethoughttoprovidethedominantsourceof
â˜…E-mail: smutch@unimelb.edu.au (SJM)ionizingphotonstoreionizetheUniverse(e.g.Srbinovsky&Wyithe
2007;Bouwensetal.2015;Qinetal.2017).However,weareunable
to directly relate the observed star forming galaxy population to the
evolution in the ionization state of the IGM due to the unknown
fractionofionizingphotonswhichescapefromtheISMofgalaxies.
Giventheevolutionofgalaxydensitywithredshift,andtheexpected
dependenceofstar-formationratewithhost-halomass,weexpectthat
thereislikelyadependenceofescapefractiononthesequantities(e.g.
Gnedin et al. 2008; Wise & Cen 2009). For example, in a scenario
wherethedominantphotonsourcesarelow-masshaloes,reionization
starts at higher redshift (e.g. Finkelstein et al. 2019). However, if
galaxies in more massive haloes are the more dominant sources,
then reionization will be delayed and conclude more rapidly (e.g.
Mesingeretal.2016;Naiduetal.2020).Moreover,sincethisescape
ofradiationislikelythroughchannelsoflowcolumndensityHIand
dust, the escape fraction is expected to be direction dependent for
individualgalaxiesandtohavealargescatterwithgalaxyproperties
(e.g. Cen & Kimm 2015; Yeh et al. 2023).
Given the importance of the escape fraction to our understanding
of reionization, there have been a number of studies to i) measure
the escape fraction directly in individual galaxies (e.g. Pahl et al.
2022;Begleyetal.2022;Bassettetal.2022),ii)todirectlysimulate
theISMofstarforminggalaxiesinacosmologicalcontext(e.g.Yeh
Â©2018 The AuthorsarXiv:2303.07378v2  [astro-ph.GA]  7 Dec 20232 S. J. Mutch et al.
et al. 2023; Wise & Cen 2009), and iii) to infer the average escape
fraction properties by comparing observed star-formation rates with
the reionization history (e.g. Wyithe et al. 2010; Finkelstein et al.
2019; Yung et al. 2020).
In this paper we follow the third approach, using a semi-analytic
model coupled with semi-numerical calculations of reionization,
whichoffersacomputationallyefficientroutetocalculatingthecon-
nectionbetweengalaxyformationandreionization(e.g.Mutchetal.
2016;Seileretal.2019;Visbaletal.2020;Hutteretal.2021).Weuti-
lizethe Meraxes semi-analyticmodel(Mutchetal.2016)toprovide
arealisticdescriptionofthegalaxypopulationat ğ‘§âˆ¼4âˆ’8,whichcan
be extended to both redshifts higher than observed and to luminosi-
ties fainter than observed based on physical descriptions of galaxy
formation physics. Meraxes couples this galaxy evolution to the
evolutionoftheionizationstateoftheIGMwithanassumedescape
fraction. Our approach is to provide a flexible relationship between
galaxy properties and the escape fraction, and then to constrain the
parametersdescribingthisrelationshipviaaBayesianframework.Ef-
ficient implementation of the Meraxes semi-analytic model makes
this parameter space exploration possible, even though the model
includes on the fly calculation of reionization and is directly run on
a dark-matter halo population close to the hydrogen cooling limit
within a large N-body simulation.
The paper outline is as follows. In Section 2 we outline the rele-
vant features of Meraxes . We then describe our implementation of
the statistical sampling of the parameter space for Meraxes in Sec-
tion3beforeconstrainingourgalaxyformationmodelparametersin
Section4.InSection5wedescribethereionizationobservationswe
employbeforepresentingourescapefractionmodelandtheresulting
constraints in Section 6. We finally provide our discussion and con-
clusionsinSections7and8,respectively.Throughoutthispaper,we
adopt a standard Î›CDM cosmology with Î©m=0.308,Î©Î›=0.692
andğ»0=67.8km/sMpcâˆ’1.
2 MERAXES
TheMeraxes semi-analytic model (Mutch et al. 2016) is designed
to explore galaxy formation across cosmic time, with a particular
focus on the Epoch of Reionization and the first galaxies. Some of
itskeyfeaturesincludeadelayedsupernovafeedbackschemewhich
accounts for the finite lifetime of massive stars and the use of â€œhor-
izontalâ€ merger trees whereby the entire simulation volume is pro-
cessedonesnapshotatatime(necessaryforanefficienttreatmentof
reionization). However, the defining feature of Meraxes is its close
coupling to a modified version of the semi-numerical reionization
code, 21cmFAST (Mesinger et al. 2011). This allows coupled mod-
ellingofreionizationwiththegrowthofthegalaxypopulation,both
temporallyandspatially.Takingintoaccountbothlocalandexternal
ionizing radiation, we can explore how subsequent star formation is
affectedandhowthisfeedsbackontotheprogressionofreionization.
As with many other semi-analytic models, Meraxes includes
treatmentsforstarformation,supernovafeedback,metalenrichment,
cooling, AGN feedback, and galaxy mergers. In this section we pro-
vide a broad overview of the model and any physical prescriptions
that are directly relevant for this work. A full description of the
model is provided in Mutch et al. (2016) and the subsequent papers
referenced below.2.1 Tiamat
Semi-analyticgalaxyformationmodelsworkbypost-processingdark
matterhalomergertreeseitherextractedfromcosmologicalN-body
simulationsorcreatedusingExtendedPress-Schechter(EPS)theory.
Inordertofullymodelreionization,wherethespatialdistributionof
galaxies directly influences their evolution, the former is required.
Inthiswork,weutilisetheTiamatN-bodysimulation,runaspart
of the Dark-ages Reionization And Galaxy Observables from Nu-
merical Simulations programme (DRAGONS; Poole et al. 2016).
Tiamat consists of 21603collisionless particles following a Planck
2015 cosmology (Planck Collaboration et al. 2016a) in a comoving
volumeof(100 Mpc)3,resultinginaparticlemassof 3.89Ã—106MâŠ™.
Thisallowsustoidentifythemajorityofatomic-coolingmasshaloes
acrossallredshiftsduringreionizationwithinalargeenoughvolume
to provide a statistically representative realisation of the large scale
process. Tiamat has been run down to a redshift of ğ‘§=1.8 with 101
snapshots output between ğ‘§=49 and 5, evenly spaced in time with
a cadence ofâˆ¼11 Myr, and a further 64 snapshots at ğ‘§<5, loga-
rithmically spaced in redshift. This fine snapshot cadence at high
redshift allows us to better track the progression of global reioniza-
tion, which proceeds rapidly during its mid phases. It also allows us
tomoreaccuratelymodelthestochasticnatureofstarformationand
itsimpactsonthereionizationprocessatthesehigh-redshifts(Mutch
et al. 2016). For more details on the Tiamat simulation, interested
readers are referred to Poole et al. (2016) and Angel et al. (2016).
Details on the halo merger tree construction can be found in Poole
et al. (2017).
2.2 Star formation and supernova feedback
The star formation and supernova feedback prescriptions imple-
mented in Meraxes closely follow those of Croton et al. (2006),
with updates presented in Guo et al. (2011).
Ateachtimestepinthesimulation,wecalculatetheamountofgas
requiredtobeaccretedbyeachhostdarkmatterhaloinordertomain-
tain the required baryon fraction in the presence of the intergalactic
ionization field. This gas is assumed to be shock-heated to the virial
temperature of the halo before cooling down to the central regions
toformarotationallysupportedexponentialdisc.Assumingangular
momentum conservation of the gas as it cools, the scale radius of
this disc is given by ğ‘Ÿdisc=ğ‘…virğœ†/âˆš
2, whereğœ†is the dimensionless
spin parameter of the halo (Bullock et al. 2001).
Following Kennicutt (1989), we assume that star formation in the
disconlyoccursoncethecoldgasdensityreachesacriticalthreshold,
Î£crit,whichcanbelinkedtotheinstantaneouspropertiesofthehost
darkmatterhalo.Theresultingstarformationrate, Â¤ğ‘šâˆ—,iscalculated
by assuming that some fraction, ğ›¼SF, of the cold gas, ğ‘šcold, above
thisthresholdisthenturnedintostarsperdiscdynamicaltime, ğ‘¡dyn:
Â¤ğ‘šâˆ—=ğ›¼SF
ğ‘¡dyn
ğ‘šcoldâˆ’2ğœ‹Î£critğ‘Ÿ2
disc
, (1)
wherethesecondtermontheright-handsidecorrespondstothecold
gasmassresultinginthecriticalsurfacedensityforadiscwithscale
radiusğ‘Ÿdisc.
Galaxymergerscanalsodriveshocksandturbulence,resultingin
enhancedstarformationepisodes.Wemodelthefractionofcoldgas
convertedintostarsinsucheventsfollowingSomervilleetal.(2001):
ğ‘šburst
ğ‘šcold=ğ›¼burstğ‘šgal
ğ‘šparentğ›¾burst
, (2)
whereğ‘šburstis the mass of newly formed stars, ğ‘šgalandğ‘šparent
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 3
are the total baryonic masses of the infalling and parent galaxies
respectively, and ğ›¾burstandğ›¼burstare free parameters. Following
Croton et al. (2006), we fix ğ›¾burst=0.7andğ›¼burst=0.57.
Energy injection from supernovÃ¦ is thought to be the dominant
feedback mechanism for controlling the growth of stellar mass (and
hence the production rate of ionizing photons) at the high redshifts
and low halo masses relevant for reionization (see e.g. Qin et al.
2017). We assume that this feedback mechanism is dominated by
massive, short-lived ( â‰²40 Myr) stars, ending in energetic Type-II
supernovÃ¦.ThetotalsupernovaenergyinjectedintotheISM, Î”ğ¸total,
afteratime,ğ‘¡,frompaststarformationepisodesofmass ğ›¿ğ‘šâˆ—isgiven
by:
Î”ğ¸total=ğœ–âˆ«ğ‘¡
0ğ›¿ğ‘šâˆ—
ğ‘‘ğ‘¡â€²ğ‘‘ğœ‰(ğ‘¡â€²)ğ‘‘ğ‘¡â€², (3)
whereğ‘‘ğœ‰is the metallicity dependent energy injection from stars
of ageğ‘¡âˆ’ğ‘¡â€²which we calculate directly from the stellar popula-
tion synthesis code Starburst99 (Leitherer et al. 1999), assuming
a Kroupa (2001) IMF. ğœ–is a free parameter which controls the ef-
ficiency with which the injected energy couples to the surrounding
ISM.Theamountofgasassumedtobedirectlyheatedbythisenergy
injection is modelled as
Î”ğ‘štotal=ğœ‚ğ›¿ğ‘šâˆ—, (4)
whereğœ‚isafreeparametercommonlyreferredtoasthemassloading
factor.
FollowingQiuetal.(2019),weassume ğœ–andğœ‚totakethefollowing
functional forms:
ğœ–=ğœ–01+ğ‘§
4ğ›¼ejectğ‘‰max
60 km sâˆ’1ğ›½
and (5)
ğœ‚=ğœ‚01+ğ‘§
4ğ›¼reheatğ‘‰max
60 km sâˆ’1ğ›½
, (6)
whereğ‘‰maxis the maximum circular velocity of the host halo, ğ›½=
âˆ’3.2(âˆ’1)forğ‘‰max<(â‰¥)60 km sâˆ’1(following Muratov et al.
2015) andğ›¼reheat=2(following Cora et al. 2018). We also assume
ğ›¼eject=0, as suggested by Qiu et al. (2019).
The energy injected into the ISM is used to adiabatically heat the
gas in the galaxy to the virial temperature of the host dark matter
halo where it joins a hot gas reservoir. The mass of gas added to the
hot reservoir, Î”ğ‘šhot, is given by
Î”ğ‘šhot=2Î”ğ¸total
ğ‘‰2
virÎ”ğ‘štotal. (7)
If there is more energy available than is required to reheat the full
Î”ğ‘štotalworth of gas to the virial temperature (i.e. Î”ğ‘šhot>Î”ğ‘štotal)
thentheremainderoftheenergyisusedtoejecttheremainingmass
fromthesystementirely.Formoredetailsonthesupernovafeedback
prescription, see Qiu et al. (2019).
2.3 Reionization
One of the key features of Meraxes is its treatment of reionization,
which is modelled using a modified version of the semi-numerical
reionization code 21cmFAST (Mesinger et al. 2011). At each time
stepinthesimulation,Cartesiangridsofhalomass,stellarmass,star
formationrate,andtotalmatterdensityareconstructed.Forthiswork
weemployagridresolutionof 2563,correspondingtoasidelengthof
0.39 Mpc. These are then filtered using an excursion set formalism
to identify ionized cells where the number of ionizing photons isgreater than the number of neutral atoms and recombination events.
As discussed in Section 1, the key free parameter controlling this
process is the escape fraction of ionizing radiation from the source
galaxies,ğ‘“esc.
WhenapatchoftheIGMisreionizedbyUVphotons,thetemper-
ature of the gas is raised to âˆ¼2Ã—104K. This acts to raise the local
Jeans mass, reducing the amount of material accreted by low mass
haloes. We model this process using a baryon fraction modifier:
Î”ğ‘šbaryon=ğ‘“bğ‘“modğ‘€virâˆ’ğ‘šbaryon, (8)
whereÎ”ğ‘šbaryonisthefreshlyaccretedbaryonmass, ğ‘“b=Î© b/Î©mis
theuniversalbaryonfraction, ğ‘šbaryonisthemassofbaryonsalready
present in the halo, and ğ‘“modis the baryon fraction modifier. The
value ofğ‘“modis calculated following Sobacchi & Mesinger (2013)
and depends on the mass of the halo, the strength of the local UV
ionizing background (which is again strongly dependent on the ion-
izing escape fraction), and the time over which the halo has been
exposed to this background. For further details of the reionization
prescription, see Mutch et al. (2016).
2.4 UV luminosities
In order to generate UV luminosities for each galaxy at a time ğ‘¡,
we sum the luminosities from each past star formation burst of age
ğœ. These luminosities are calculated by constructing a full spectral
energy distribution (SED) and applying a tophat filter centred on
1600Ã…, with a width of 100Ã…:
ğ¿UV(ğ‘¡)=
ğ‘›âˆ‘ï¸
ğ‘–=0âˆ«1650Ã…
1550Ã…ğ‘‘ğœ†âˆ«ğ‘¡
0ğ‘‘ğ‘¡â€²âˆ«ğ‘max
ğ‘minğ‘‘ğ‘ğœ“ ğ‘¡â€²âˆ’ğœğ‘–,ğ‘ğ‘†ğœ†(ğœğ‘–,ğ‘)ğ‘‡ğœ†(ğœğ‘–),
(9)
whereğœ“(ğ‘¡â€²âˆ’ğœğ‘–,ğ‘)is the metallicity ( ğ‘) dependant star formation
rateofaburst( ğ‘–)ofageğœğ‘–,ğ‘†ğœ†(ğœğ‘–,ğ‘)isthewavelengthandmetallic-
itydependentluminosityofasimplestellarpopulationofage ğœğ‘–,and
ğ‘‡ğœ†(ğœğ‘–)is the dust transmission function. We calculate ğ‘†ğœ†(ğœğ‘–,ğ‘)us-
ing the publicly available starburst99 stellar population synthesis
model (Leitherer et al. 1999), including nebular emission lines and
assumingaKroupa(2001)IMFwith ğ‘min=0.001andğ‘max=0.04.
Qiu et al. (2019) explored a number of physically motivated
parametrisations for the dust transmission, ğ‘‡ğœ†(ğœ), by constraining
Meraxes to match both the evolution of the observed ultraviolet
luminosityfunction(UVLF)andinfraredexcess(IRX)- ğ›½relationat
ğ‘§â‰³4. For this work, we employ the gas column density dust model
whereby the optical depth, Î“ğœ†, is given by
Î“ğœ†=eâˆ’ğ‘ğ‘§ğ‘šcold
1010â„âˆ’1MâŠ™ğ›¾GCDğ‘Ÿdisc
â„âˆ’1kpcâˆ’2ğœ†
1600Ã…ğ‘›
,(10)
whereğ‘,ğ›¾GCDandğ‘›are free parameters and ğ‘Ÿdiscandğ‘šcoldare as
introduced above. The resulting transmission is calculated using the
two phase model of Charlot & Fall (2000):
ğ‘‡ğœ†(ğ‘¡)=(
exp(âˆ’(ğœISMâˆ’ğœBC)Î“ğœ†)ğ‘¡ <ğ‘¡ BC
exp(âˆ’ğœISMÎ“ğœ†) ğ‘¡â‰¥ğ‘¡BC, (11)
whereğœISMandğœBCareagainfreeparameters.Here,photonsemitted
by young stars with ages less than ğ‘¡BCmust travel through both a
dense birthcloud and the more extended ISM. After this time, the
birthcloudisassumedtohavebeendestroyedandthephotonsareonly
attenuatedbytheISM.FormoredetailonboththeSEDconstruction
and dust model see Qiu et al. (2019).
MNRAS 000, 1â€“13 (2018)4 S. J. Mutch et al.
2.5 Unique features for parameter space exploration
One of the key benefits of semi-analytic models over more detailed
hydrodynamic simulations is their relatively low computational ex-
pense. This opens up the potential for statistical exploration of the
underlying free parameter space (e.g. Henriques et al. 2013; Qiu
et al. 2019). Meraxes has been designed to maximise this potential
by being written to be as efficient as possible without loss of flexi-
bility.Someoftherelevantuniquefeaturesofourmodelincludethe
pre-loadingofinputdata,theutilisationofgraphicsprocessingunits
(GPUs),andthesuiteofcompaniontoolswhichhavebeendeveloped
to programmaticaly interact with the model and its output.
In order to provide a converged sampling of the underlying pos-
terior probability distribution we require many tens-of-thousands of
model evaluations for moderate dimensionality problems ( âˆ¼10 free
parameters). In this situation, it is imperative that the model be-
ing evaluated can be run as quickly and efficiently as possible. For
Meraxes (runningonourinputN-bodysimulation,Tiamat)atleast
âˆ¼70% of the time taken for a single model call is devoted to read-
ing in the trees and dark matter density grids from disk, distributing
themamongstallavailableprocessors,andprocessingtheircontents.
Therefore, we have modified the SAM to be able to read in all in-
put data once, store this in memory, and then to run multiple times
without the need for any expensive input-output (IO) calls.
A further computational bottleneck for Meraxes is its treatment
of reionization using a modified version of the 21cmFast (Mesinger
et al. 2011) semi-numerical code. This currently requires the model
tofilteranumberof3DCartesiangridsusinganexcursionsetformal-
ismateverysnapshot.Eachoftheseexcursionsetcalculationsentails
a large number of Fourier transforms and multiple loops over every
cell (of which there are 2563for this work) in the gridded volume.
Toreducetheamountoftimespentdoingthisexpensivecalculation,
and thus allow our analysis to be completed in a timely fashion, the
reionization portion of Meraxes has been re-written to take advan-
tage of the Graphics Processing Units (GPUs) commonly available
on the majority of modern high performance computing systems.
This has sped up the reionization calculation by a factor of 8 for
typical combinations of grid dimensions and hardware resources.
3 PARAMETER SPACE SAMPLING
Inordertocarryoutastatisticalexplorationofthe Meraxes parame-
terspace,werequireamethodtocalculatethelikelihoodofthemodel
predictionsforagivensetofparametersandtothenprovidethecode
with a new set of trial parameters for the next run. To facilitate this,
aswellasfutureparameterspaceexplorationandcalibrationstudies
with Meraxes , we have developed a new companion code called
Mhysawhich provides a flexible two-way communication layer be-
tweenthemodel(writtenin C)andPython. Mhysawasdesignedto
efficiently facilitate calling Meraxes many times,with different pa-
rametervalues,andallowsustointerfaceanyPythonoptimisationor
samplingpackagewiththemodel.Italsoallowsustowriteallofour
likelihood calculations in Python and to leverage its many available
scientificandnumericallibraries,vastlyreducingdevelopmenttime.
Inpractice, Mhysadealswithinitialisingthemodel,updatingitspa-
rameters, directly accessing in-memory galaxies and haloes, calling
arbitraryPythoncodeattheendofeachsnapshot,doingcalculations
on an independent processor in the background whilst the model is
running, and orchestrating multiple instances of the model running
concurrently.
A further key feature of Mhysawhich greatly enhances futureTable 1.The free galaxy formation and dust model parameters used in this
workwhenconstrainingagainsttheobservedUVLFand ğ›½âˆ’ğ‘€UVrelations.
See Â§4 for details.
Parameter Description Equation
galaxy formation
log10(ğ›¼SF)Star formation efficiency 1
log10(Î£n)Surface density threshold for star formation 1
log10(ğœ–0)Supernova energy coupling efficiency 5
log10(ğœ‚0)Mass loading factor 6
dust
ğœISM ISM optical depth normalisation 11
ğœBC Birth cloud optical depth normalistion 11
ğ›¾GCD Cold gas mass dependence 10
ğ‘› Reddening slope 10
ğ‘ Redshift dependence 10
scienceinvestigations with Meraxes ,is thatit isnotonly limitedto
statistical sampling. Often we wish to simply find the â€˜bestâ€ model
which matches our chosen observational constraints, without neces-
sarily investigating parameter degeneracies or uncertainties. Mhysa
hasbeenwrittenwithaflexibleinterfacethatcanbeusedtocarryout
suchaglobaloptimisationofthemodelparametersusinganysuitable
technique, and leveraging the many publicly available packages.
Forthiswork,wemakeuseofthepubliclyavailablePythonpack-
ageUltranest (Buchner 2021) to carry out our parameter space
sampling using the nested sampling (Skilling 2004) Monte Carlo
algorithm MLFriends (Buchner 2014, 2017). The benefit of nested
samplingovermoretraditionalMarkovChainMonteCarlo(MCMC)
methodsforthisworkisfour-fold:Nestedsamplingdoesnotrequire
us to have an estimate of the global maximum likelihood param-
eter values in order to avoid a lengthy burn-in phase; it can more
efficiently deal with multi modality or complicated degeneracies in
probability distributions; it typically requires fewer likelihood eval-
uations to probe the underlying posterior probability distribution to
a satisfactory degree of accuracy; and it naturally provides us with
an estimate of the Bayes evidence that can be used to quantitatively
compare the support for different escape fraction parametrisations.
For each of the parameter space sampling runs presented in this
work, we use a minimum of 200 live points. This is the number of
points which are maintained throughout the sampling process and
iteratively updated to sample the posterior. More live points result
in a higher resolution sampling of the posterior, at the expense of
morelikelihoodevaluations.Thedefault Ultranest stoppingcriteria
were employed, with the exception of the maximum fraction of the
remaining evidence and minimum effective sample size, which we
set to 0.1 and 600, respectively.
4 THE GALAXY UV LUMINOSITY FUNCTION AND
ğ›½âˆ’ğ‘€UVRELATION
The galaxy UV luminosity function is the most direct observational
probeofthereionizinggalaxypopulationat ğ‘§â‰¥5.Ittracestherecent
star formation at a fixed number density and hence, the total ion-
izing photon production rate and its spatial distribution (under the
assumptionthatstarsprovidethebulkofionizingphotonsduringthe
EoR,e.g.Qinetal.2017).Therefore,ifwearetocarryoutaquanti-
tative investigation of allowed escape fraction models, we must first
calibrate our model against the observed UVLF.
The free parameters of the model which we allow to vary when
fittingtheUVLFarelistedinTable1.Theseareidenticaltothefree
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 5
parametersusedbyQiuetal.(2019)andincludefourgalaxyforma-
tion parameters controlling star formation and supernova feedback,
as well as four parameters which control dust extinction and how
it varies with cold gas mass. These parameters have been shown in
previousworkstobethemostimportantforcontrollingthegrowthof
earlygalaxiesinourmodel(e.g.Mutchetal.2016)andreproducing
the evolution of the UVLF (Qiu et al. 2019).
Theassumedpriordistributionsforeachparameterarepresentedin
AppendixA.Theyareselectedtoweaklyencodeourpastexperience
andphysicalintuition,however,wehaveensuredthatourconclusions
are insensitive to our precise choices except where explicitly stated
in the text.
For this work, we utilise the observational luminosity functions
from Bouwens et al. (2015). Following Gillet et al. (2020) (and as
originallysuggestedbyBouwensetal.2017)weenforceaminimum
uncertaintyof 0.08dexonalldatapoints.Sincereionizationisknown
to be largely complete to within ğ‘¥HIâˆ¼0.05byğ‘§âˆ¼5(e.g. Bosman
et al. 2022; Qin et al. 2021), we only consider redshifts greater
than this. The volume of our input N-body simulation (100 Mpc)3
also limits the brightest galaxies for which Meraxes can provide
statisticallysignificantpredictions,duetothelownumberdensityof
these biased objects. Therefore, at each redshift, we only consider
luminosities below which observations indicate there should be at
least 10 galaxies.
Wecalculatethelikelihoodofamodelparameterset, ğœƒ,assuming
uncorrelated, (log-)Normally distributed, errors:
ln LUVLF(ğœƒ)=
âˆ’1
2ğ‘ğ‘‘âˆ‘ï¸
ğ‘–=0 log10(ğœ™ğ‘–,obs)âˆ’log10(ğœ™ğ‘–,mod)2
ğœ2
ğ‘–âˆ’ln(2ğœ‹ğœğ‘–)
,(12)
whereğœ™ğ‘–,obsandğœ™ğ‘–,modare the observations and model predictions
fordatapoint ğ‘–,respectively, ğœ2
ğ‘–=ğœ2
ğ‘–,obs+ğœ2
ğ‘–,modisthecorrespond-
ing variance, and ğ‘ğ‘‘is the total number of data points. Note that
we use the appropriate value of ğœğ‘–,obswhen the model prediction is
greater than or less than the observational data point if the quoted
observational uncertainty is non-symmetric. Our choice of uncorre-
latedlog-normaluncertaintiesissimplyourbestestimateofthetrue
uncertainty distribution in the absence of further information (such
as a covariance matrix) and is a commonly made assumption. For
the model variance, we assume a Poisson distribution with a mean
equal to the galaxy number counts in each bin.
Inordertofullyconstrainalleightfreemodelparametersandbreak
degeneracies in the dust extinction model, Qiu et al. (2019) found it
necessary to additionally constrain against the evolution in the UV
slope (ğ›½) as a function of magnitude ( ğ‘€UV). We do similarly here,
utilising the biweight mean observations of Bouwens et al. (2014)
and again assuming uncorrelated, (log-)Normally distributed errors
as per Equation 12.
4.1 Constraints on galaxy formation parameters
We now explore the constraining power of the UVLF and ğ›½âˆ’ğ‘€UV
relation on the galaxy formation parameters of our model. In Mutch
et al. (2016), we demonstrated that reionization feedback only plays
aminorroleinshapingtheevolutionoftheobservable ğ‘§â‰³5galaxy
population.Wethereforeignoreourreionizationconstraintsandturn
offreionizationfeedbackforthissection,simplifyingourinterpreta-
tion and speeding up our calculations.
The model UVLFs are presented in Figure 1. Shaded bands in-
dicate the 68% and 95% confidence intervals of the model results,
22
 21
 20
 19
 18
 17
 16
MUV5
4
3
2
log10(/Mpc3)
z=8Bouwens et al. (2015)
Meraxes22
 21
 20
 19
 18
 17
 16
5
4
3
2
log10(/Mpc3)
z=722
 21
 20
 19
 18
 17
 16
5
4
3
2
log10(/Mpc3)
z=622
 21
 20
 19
 18
 17
 16
5
4
3
2
log10(/Mpc3)
z=5Figure 1. The best-fit galaxy UVLF (shaded regions) obtained by fitting
against the observed evolution of the UVLF alone (error bars). Dark and
light shading indicates the 68 and 95% confidence intervals, respectively.
Our model does a reasonable job of matching the observations at all fitted
redshifts, providing confidence that we can correctly model the evolution of
the observed faction of the total ionizing photon budget. See Â§4.1 for more
details.
sampled from the underlying posterior distribution. The model is
able to replicate the observational data reasonably well, across all
redshifts, however, the 68% range of the model ğœ™at fixedğ‘€UVis
noticeably smaller than that of the constraining observations. This
stems from a tension in matching all four redshifts simultaneously,
especially aroundâˆ’21â‰²ğ‘€UVâ‰²âˆ’20, where the observed ğ‘‘ğœ™/ğ‘‘ğ‘§
varies non-monotonically. When the model is constrained against a
singleredshift,thefreedomaffordedbythemodelandourchoiceof
free parameters means that the magnitude of our uncertainties are
similartothatoftheconstrainingobservations.Whenfittingagainst
multiple redshifts simultaneously, the volume of acceptable model
parameters reduces such that we are no longer able to reproduce
the full variance of a single redshift. In Figure 2, we show the cor-
MNRAS 000, 1â€“13 (2018)6 S. J. Mutch et al.
22
 21
 20
 19
 18
 17
 16
MUV2.4
2.2
2.0
1.8
1.6
1.4
z=6Bouwens et al. (2014)
Meraxes2.4
2.2
2.0
1.8
1.6
1.4
z=5
Figure 2. The best-fit galaxy ğ›½-ğ‘€UVrelation (shaded regions) obtained by
fittingagainsttheobservedevolutionoftheUVLFand ğ›½-ğ‘€UVrelationalone
(errorbars).Darkandlightshadedregionsindicatethe68and95%confidence
intervals, respectively. See Â§4.1 for more details.
51.251.451.651.852.052.2
log10(/[s1Mpc3])
2 3 4 5 6 7 8
redshift2.2
2.0
1.8
1.6
1.4
1.2
log10(SFR/[Myr1Mpc3])
Meraxes
Katsianis et al. (2021)
Figure3. Thepredictedcosmicstarformationratedensityevolutionobtained
byfittingagainsttheobservedevolutionoftheUVLFand ğ›½â€“ğ‘€UVrelationat
ğ‘§â‰¥5(solid line). The right hand axes shows the corresponding volume aver-
agedintrinsicionizingemissivity.Darkandlightshadedregionsindicatethe
68and95%confidenceintervalsat ğ‘§â‰¥5.Blackdatapointsshowtheobserved
star formationrate density from Katsianiset al. (2021) forcomparison. Note
thatthemodelwasnotcalibratedtoreproducethestarformationratedensity
evolution specifically (see Â§4.2).
respondingğ›½âˆ’ğ‘€UVrelation. Here, the uncertainty in the model
results is more similar to that of the constraining observations at
ğ‘§=5. We also show in Figure 3 the corresponding prediction for the
star formation rate density (and volume averaged intrinsic ionizing
emissivity) evolution together with their 68% and 95% confidence
intervals.Atredshift8,thepredictedemissivitycanvaryby âˆ¼25%,
decreasing toâˆ¼10% byğ‘§â‰²5.
The maximum a-posteriori (MAP) parameter values, along with
their marginalised posterior modes and highest density intervals
(HDIs), are presented in Table 2. The corresponding one and two-
dimensional posteriors are also shown in Appendix A. With the
exception of the critical surface density for star formation ( Î£ğ‘›) and
supernovaenergycouplingefficiency( ğœ–0),alloftheparameterspos-
22
 21
 20
 19
 18
 17
 16
MUV4.0
3.5
3.0
2.5
2.0
1.5
log10(/Mpc3)
z=2
Meraxes
Bouwens et al. (2021)Figure 4. The predicted ğ‘§=2UVLF found by constraining against the ob-
served evolution of the UVLF and ğ›½â€“ğ‘€UVrelation at ğ‘§â‰¥5(solid line). The
observationalresultsofBouwensetal.(2021)areshownforcomparison(er-
ror bars). Note that the model was not calibrated to reproduce the UVLF at
ğ‘§<5specifically (see Â§4.2).
sessawell-definedpeakintheir1Dmarginalisedposteriorswhichis
independentoftheimposedpriors.Thereareanumberofdegenera-
cies between the galaxy formation and dust model parameters. For
example,ahighercriticaldensityforstarformation( Î£ğ‘›)leavesmore
coldgasavailableforefficientstarformationinmassivesystemsand
hence requires more dust attenuation there (controlled by ğ›¾GCD) to
matchthebrightendoftheUVLF.Thesimilarityofthe ğœ–0posterior
distributiontoitsprioratallbutthesmallestvaluesindicatesthatthe
modelâ€™ssupernovafeedbackenergy couplinghasaminimumviable
efficiency,beyondwhichthereislittlechangetothepredictedUVLF.
Thisisduetosaturationeffects.Once ğœ–0islargeenough,allavailable
coldgas(asdeterminedbythemassloadingfactor, ğœ‚0,andavailable
cold gas reservoirs in the galaxy) is ejected and increasing the value
ofğœ–0has no effect.
4.2 Low redshift predictions
For this work, we choose to constrain our galaxy formation model
parameters against the ğ‘§â‰¥5observations alone. Whilst Meraxes
is capable of running all the way to ğ‘§=0, there are numerous bi-
ases and complications associated with simultaneously constrain-
ing against high and low -redshift observations. The abundance of
available observations at low redshift, coupled with the typically
smaller measurement uncertainties, means that our fit would prefer
matching them, at the expense of matching potentially inconsistent
high-redshift data.
Having said that, any model which completely fails to reproduce
relevantlow-redshiftobservationsshouldbedeemedinvalid.Forthis
reason,weranourmodelwiththemaximuma-posteriorigalaxyfor-
mation parameters down to ğ‘§=1.8(the lowest redshift available
fromtheTiamatsimulation)toensureourpredictionslooksensible.
Figure 3 shows the predicted evolution of the cosmic star formation
rate density compared against the UV-derived observational results
reported by Katsianis et al. (2021). Figure 4 further shows the pre-
dictedğ‘§=2UVLF compared against the observations of Bouwens
et al. (2021). In both cases there is a reasonable level of agreement
betweenourbestfitmodelandtheobservations,despitethefactthat
themodelwasnotdirectlycalibratedtoachievethis.Wearetherefore
satisfied that our best-fit galaxy formation parameters are valid, at
leastforthepurposesofreproducingtheUVevolutionofthegalaxy
population.
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 7
Table 2.The maximum a-posteriori (MAP) for each galaxy formation parameter when constraining against the observed evolution of the UVLF and ğ›½-ğ‘€UV
relation. The 1-D marginalised MAP, mean, and 68 and 95% highest density intervals (HDI) are also presented for each parameter. Plots of the 1-D and 2-D
marginalised posterior distributions are presented in Figure A3.
marginalised
MAP mode mean 68% HDI 95% HDI
log10(ğ›¼SF)-1.11 -1.18 -1.20 [-1.26, -1.12] [-1.35, -1.05]
log10(Î£n)-0.85 -1.10 -1.50 [-1.76, -0.61] [-2.75, -0.57]
log10(ğœ–0)0.65 1.47 2.43 [0.62, 2.96] [0.51, 4.88]
log10(ğœ‚0)0.68 0.64 0.68 [0.60, 0.75] [0.51, 0.84]
ğœISM 14.00 9.41 18.66 [0.17, 22.08] [0.01, 46.66]
ğœBC 289.77 282.73 671.60 [105.27, 801.06] [65.63, 1650.87]
ğ›¾GCD 1.52 1.35 1.39 [1.15, 1.53] [1.06, 1.83]
ğ‘› -2.43 -2.55 -2.46 [-2.88, -2.09] [-3.17, -1.64]
ğ‘ 0.69 0.88 0.87 [0.72, 0.97] [0.64, 1.11]
5 OBSERVATIONAL CONSTRAINTS ON REIONIZATION
Whilst the evolution of the observed UV luminosity function allows
us to constrain the ionizing photon budget as a function of time, it
does not provide any direct constraint on the fraction of these pho-
tonswhichescapetheirsourcegalaxyandparticipateinreionization
(ğ‘“esc). For this, we turn to the following three observations.
5.1 Thompson scattering optical depth
The integrated optical depth due to Thompson scattering of cosmic
microwave background photons by free electrons can be expressed
as:
ğœğ‘’=âˆ«âˆ
ğ‘§=0ğ‘dğ‘¡
dğ‘§(1+ğ‘§)3ğœT
Ã—
ğ‘„m
HIIâŸ¨ğ‘›HâŸ©+(ğ‘„m
HeII+2ğ‘„m
HeIII)âŸ¨ğ‘›HeâŸ©
dğ‘§,(13)
whereğœT=6.652Ã—10âˆ’25cm2is the Thomson scattering cross-
section,ğ‘„m
ğ‘‹is the mass-weighted global ionized fraction
of species ğ‘‹, andâŸ¨ğ‘›HâŸ©=1.88Ã—10âˆ’7(Î©bâ„2/0.022)cmâˆ’3and
âŸ¨ğ‘›HeâŸ©=0.148Ã—10âˆ’7(Î©bâ„2/0.022)cmâˆ’3are the average comov-
ing density of hydrogen and helium, respectively (Wyithe & Loeb
2003). In order to calculate ğœğ‘’from our model we follow the as-
sumptions outlined in Mutch et al. (2016). In particular, we assume
that helium and hydrogen are singly ionized at the same rate (i.e.
ğ‘„m
HeII(ğ‘§)=ğ‘„m
HII(ğ‘§)andğ‘„m
HeIII(ğ‘§>4)=0.0)untilğ‘§=4,afterwhich
heliumisassumedtobedoublyionized(Kuhlen&Faucher-GiguÃ¨re
2012, i.e.ğ‘„m
HeIII(ğ‘§â‰¤4)=1.0).
We utilise the Planck Collaboration et al. (2016b) measurement
ofğœğ‘’=0.058Â±0.012as our single data point. As with the ionizing
emissivity constraint above, we use use a standard ğœ’2likelihood
and assume Normally distributed errors. We further assume that the
uncertaintyonthemodelpredictionisnegligibleandthatthereisno
missing or underestimated systematic uncertainties associated with
the observational data.
5.2 Ionizing emissivity
The instantaneous ionizing emissivity (the number of meta-galactic
ionizing photons per unit time, per Hydrogen atom1) at the lat-
ter stages of reionization, can be inferred from Lyman-alpha forest
observations (e.g. Bolton & Haehnelt 2007; McQuinn et al. 2011;
1Often commonly expressed as the number of ionizing photons per unit
time, per unit volumeBecker&Bolton2013).FollowingMutchetal.(2016),wecalculate
this quantity from Meraxes using:
Â¤ğ‘ğ›¾=Â¤ğ‘šâˆ—ğ‘ğ›¾/ğ‘šâ˜…ğ‘“esc
ğ‘“bğ‘€tot(1âˆ’0.75ğ‘ŒHe), (14)
whereÂ¤ğ‘šâˆ—isthetotalstarformationrateinthefullsimulationvolume,
ğ‘ğ›¾/ğ‘šâ˜…is the number of ionizing photons per stellar baryon (fixed
at 6000 to be consistent with our assumed Kroupa (2001) IMF,
ğ‘“ğ‘=Î©ğ‘/Î©ğ‘šistheuniversalbaryonfraction,and ğ‘ŒHeistheHelium
mass fraction.
In this work, we constrain against the emissivities calculated by
Dâ€™Aloisio et al. (2018). These were derived by combining the most
recent measurements of the IGM opacity and gas temperature out
toğ‘§âˆ¼6with a suite of high-resolution hydrodynamic simulations
coveringabroadrangeofIGMthermalhistories.Formoredetailson
boththemethodologyusedtoobtaintheobservedionizingemissivity
valuesandthetreatmentoftheassociatederrors,wereferthereaderto
Dâ€™Aloisioetal.(2018).Weutiliseastandard ğœ’2likelihoodassuming
Normally distributed and uncorrelated errors (c.f. equation 12). We
choosetorestrictourselvesto ğ‘§>5inthiswork.Whileobservations
are available at ğ‘§ < 5, and these ionizing emissivity data would
place tighter constraints, the contribution from AGN can become
non-negligible at ğ‘§â‰²4(e.g. Trebitsch et al. 2021; Faucher-GiguÃ¨re
2020). Furthermore, at ğ‘§=5the snapshot cadence of the Tiamat
N-body simulation changes from constant in time to logarithmic in
redshift, introducing complications in any analysis between ğ‘§âˆ¼4.5
and 5.
5.3 Global neutral fraction
Thevolumeaveragedglobalneutralfractioncanbeprobedobserva-
tionally by a number of indirect methods. These include Lyman- ğ›¼
source counts (e.g. McGreer et al. 2015), Lyman- ğ›¼and Lyman-
break galaxy clustering (e.g. Mason et al. 2018; Hoag et al. 2019),
and QSO damping-wing absorption features (e.g. Greig et al. 2017;
Davies et al. 2018; Greig et al. 2019; Wang et al. 2020). Due to the
small available sample sizes and model-dependent nature of these
probes,theassociateduncertaintiesonindividualmeasurementsare
typically large. However, a direct measure of the volume averaged
globalneutralfraction, Â¯ğ‘¥HI,canalsobeobtainedfromthefractionof
pixels with zero flux in high- ğ‘§quasar spectra (Mesinger 2010). The
appearance of these â€˜darkâ€™ pixels in the Lyman- ğ›¼and/orğ›½forests
indicatesthepresenceofinterveningneutralhydrogen,providingan
upper limit to the cosmological neutral hydrogen fraction.
Inthiswork,weutiliseanumberofdifferentneutralfractioncon-
straints assembled from the recent literature, including both model
dependent and independent sources (McGreer et al. 2015; Mason
MNRAS 000, 1â€“13 (2018)8 S. J. Mutch et al.
et al. 2018; Hoag et al. 2019; Greig et al. 2017; Davies et al. 2018;
Greigetal.2019;Wangetal.2020).Withtheexceptionofthemodel
independentdarkpixelconstraints,werestrictourselvestoonlyutil-
isingobservationalvalueswitherrorbars,ratherthanupperorlower
limits. This is largely motivated by the difficulty in sensibly assign-
ing uncertainties to such limits. However, limited investigation has
further suggested that the inclusion of these limits, with the most
conservative assumption of a step function likelihood, leads to very
little additional constraining power on the evolution of our model
escape fraction in any case.
We use the 1-sigma uncertainties on each data point as presented
and,followingGreig&Mesinger(2017),wemodelupperandlower
limits as a one sided Gaussian with a likelihood of 1 below (/above)
theobservedvalue.Themodelpredictionsareobtainedbycalculating
the fraction of cells in our reionization grid with a neutral fraction
less than 10âˆ’4at the central redshift of each data point.
6 RESULTS
In this section we use our best fit model (MAP) combined with a
flexible halo mass dependent model for escape fraction to constrain
the relation between escape fraction and galaxy properties, and to
compute their contribution to the ionizing photon budget.
6.1 Constraints on escape fraction evolution
Recentnumericalstudieshaveindicatedthatthereisalikelycorrela-
tion between halo mass and the escape fraction of ionizing photons
(e.g. Paardekooper et al. 2015; Kimm et al. 2017; Yeh et al. 2023)
This is thought to be a result of low mass halos having shallower
potential wells, allowing supernova to more efficiently clear high
densitygasintheIGMandprovidechannelsforionizingphotonsto
escapethegalaxy.Inthissection,wethusinvestigatetheconstraining
poweroftheThompsonscatteringopticaldepth,ionizingemissivity,
and neutral fraction evolution on ğ‘“escas a function of halo mass.
We fix all galaxy evolution parameters to their maximum a-
posteriori (MAP) values found in Section 4, where we constrained
the model against the evolution of the UVLF. We note that this re-
moves any extra scatter in the recovered escape fraction introduced
by uncertainties in the evolution of ionizing source population, sim-
plifyingourinterpretation.Howevertheobservedstar-formationrate
density is constrained by the luminosity function to a âˆ¼10%level
atğ‘§âˆ¼6(see Figure 3), which is more precise than the observed
uncertaintiesintheionizationrateintheIGM.The10%uncertainty
on the star-formation rate density (which is linearly related to the
escape fraction with-respect-to the timing of reionization) is also
smallerthanthefractionalconstraintsontheescapefractionderived
below. We therefore find that the effect of simultaneously allowing
our galaxy formation parameters to be free, in addition to the reion-
ization parameters, would be minimal.
We choose a logistic functional form for the escape fraction:
ğ‘“esc(ğ‘€vir)=ğ‘“min+ğ‘“maxâˆ’ğ‘“min
1+exp
âˆ’ğ›¾esclog10ğ‘€vir
ğ‘€offset (15)
where
ğ›¾esc=4ğ‘‘ ğ‘“
ğ‘‘log10ğ‘€vir
(ğ‘“maxâˆ’ğ‘“min)(16)
This flexible, four parameter function allows the escape frac-
tion to vary between ğ‘“minandğ‘“maxwith a maximum rate of
0.030.040.050.060.070.080.09e
(a)
101
100N[ionN1
HIGyr1]
(b)
5 6 7 8 9 10 11 12 13 14
redshift0.00.20.40.60.81.0xHI
(c)dark pixel
LBGs
QSO
e
Nion
xHI combined
Figure 5. The reionization constraints used in this work (tan colour), along
with the mass dependent escape fraction model constrained against each
observation independently (red, blue and green shading) and simultaneously
(black shading). Dark and light shading indicate the 68 and 95% confidence
intervals, respectively. The Meraxes galaxy formation parameters are fixed
to their maximum a posteriori values as presented in table 2. See Â§6.1 for
discussionoftheseresults. Panel (a): TheThompsonscatteringopticaldepth
(Â§5.1). Panel (b): The evolution of the total ionizing emissivity (Â§5.2). The
insetpanelshowsazoom-inof ğ‘§=5-6. Panel (c): Theevolutionofthevolume
weighted neutral fraction (Â§5.3).
ğ‘‘ğ‘“/ ğ‘‘log10ğ‘€virmidway between the two, at a mass of ğ‘€offset.
Weusenon-flatpriorsfortheseparameters,bothtoencodeourphys-
ical intuition, and to improve the efficiency of our sampling. More
details can be found in Appendix A, however, we have ensured that
the precise choice of priors does not influence results except where
explicitly discussed below.
The results of the model after constraining against the three ob-
servations are presented in Figures 5 and the 1-D marginalised pos-
terior distributions of the escape fraction parameters are presented
in Figure 6. Coloured lines and shaded regions show the results of
fitting the escape fraction to match each observation independently,
whilstblacklinesandshadedregionsshowtheresultsofconstraining
against all three observational datasets simultaneously.
Thompsonscatteringopticaldepth: TheThompsonscatteringop-
tical depth is an integrated quantity spanning the full history of the
IGM back to the surface of last scattering. As such, it is sensitive to
both the timing and effective mid-point of reionization. From panel
(a)ofFigure5weseethatthemodelisabletoreproducethePlanck
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 9
0.00 0.05 0.10 0.15 0.20 0.25
fmin
0.1 0.2 0.3 0.4 0.5 0.6
fmaxe
Nion
xHI
combined
6 8 10 12 14
Moffset
20
 15
 10
 5
 0 5 10 15 20
df/dlog10Mvir
Figure 6. Kernel density estimate plots of the 1-D marginalised constraints
on the escape fraction parameters (Equation 15). The red, green and blue
curvesshowtheconstraintsfromtheCMBopticaldepth,neutralfractionand
ionizing photon rate observations respectively. The black curves show the
combined constraints.
Collaboration et al. (2016a) observations (dashed line and hatched
region)whenusingagalaxygrowthhistoryconsistentwithobserva-
tions.
The kernel density estimate (KDE) of the 1-D marginalised con-
straintsontheescapefractionparametersareshownbytheredlinesin
Figure6.Fromherewecanseethattheopticaldepthprovidesverylit-
tleconstrainingpowerontheescapefraction.Itmerelydemandsthat
theescapefractionvaluebebetween âˆ¼5âˆ’35%acrossthefullrangeof
contributing halo masses present in the model ( 108â‰¤ğ‘€âŠ™â‰²1013).
Interestingly, our model disfavours ğœğ‘’â‰²0.52, even when not
requiring a simultaneous match to the observed ionizing emissivity
and neutral fraction evolution (red shaded regions). This suggests
thatachievingloweropticaldepthsrequiresanescapefractionmodel
which has a stronger scaling with redshift than is possible with halo
mass alone.
MorerecentdeterminationsoftheopticaldepthfromPlanckCol-
laborationetal.(2020)suggest ğœğ‘’=0.0544+0.007
âˆ’0.008.Thisislowerthan
the constraint used in this work (see Section 5.1) and would require
amorerapidreionizationwithalargerminimum ğ‘“maxvaluethanwe
see in Figure 6. The result would be an increasing tension with our
constraintsonÂ¤ğ‘ionandğ‘¥HI,bothofwhichpreferlower ğ‘“maxvalues.
Ionizingemissivity: Thetotalionizingemissivity( Â¤ğ‘)directlycon-
strains the number of ionizing photons entering the IGM and thus,
whencoupledwithafixedUVLFevolution,placesthestrongestcon-
straints on the escape fraction. From the top two panels of Figure 6
we see that ionizing emissivity prefers a mass independent escape
fraction (ğ‘“minâ‰ˆğ‘“maxâ‰ˆ7%). For escape fractions parametrisa-
tionswhichvarywithmass,thereisapreferenceforalargepositive
slope(ğ‘‘ğ‘“/ğ‘‘log10ğ‘€vir)centredaround ğ‘€virâˆ¼109âˆ’1010MâŠ™.This
corresponds to a rapidly increasing escape fraction with decreas-
ing halo mass in our parametrisation, resulting in a constraint at
0.020.040.060.080.10fmin
0.10.20.30.40.5fmax
24
16
8
0
df/dlog10Mvir89101112Moffset
0.020.040.060.080.10
fmin
0.10.20.30.40.5
fmax89101112
MoffsetFigure 7. The 1 and 2-D marginalised posterior distributions for our escape
fraction model parameters when fitting to all three observational constraints
simultaneously.Bluecross-hairsindicatethemaximuma-posterioriparame-
ter set. The 2-D contours represent 1 and 2- ğœprobability density regions.
ğ‘€vir=108MâŠ™ofğ‘“escâˆ¼5âˆ’25%. This is driven by the observed
flattening in the ionizing emissivity beyond ğ‘§â‰²6, requiring both a
rapidincreaseintheemissivityusingearly-forming,lowmasshaloes
andareducedcontributionfromhigh-masshaloestokeeptheemis-
sivity as flat as possible at low redshift (see blue shaded regions in
panel (b) of Figure 5).
Neutral fraction evolution: The range of allowed neutral fraction
evolutionmodelsisshownbythegreenshadedregionsinpanel(c)of
Figure5.ThedarkpixelfractionupperlimitsofMcGreeretal.(2015)
ensurethatreionizationisallbutcompleteby ğ‘§âˆ¼5.5.Combinedwith
thehigherredshiftconstraints,particularlythatofHoagetal.(2019),
the escape fraction parameters are driven towards producing a late
andrapidreionizationscenario,requiringaminimumescapefraction
ofâˆ¼12%acrossallhalomasses(68%confidence).TheKDEsofthe
1-D marginalised parameter distributions in Figure 6 again indicate
thattheseobservationsareconsistentwithamassindependentescape
fraction. However, there is a weak preference for a positive slope
(ğ‘‘ğ‘“/ğ‘‘log10ğ‘€vir)andanincreaseinescapefractionwithincreasing
halomass.Thisiscontrarytoourphysicalintuitionandresultsfrom
thedesiretohaveasrapidevolutionintheneutralfractionaspossible,
whilstmaintainingalatestartbykeepingthecontributionfromearly-
forming, low mass haloes as small as allowed.
Combined reionization constraints: The black shaded regions in
Figure5andblackdashedlinesFigure6showtheresultofcalibrating
the escape fraction model using all three reionization constraints
together. For these combined constraints we also present the 2-D
marginalised distributions for escape fraction model parameters in
Figure 7 and the corresponding summary statistics in Table 3. From
Figure 5 we can see that the model is able to successfully match
all of the observational constraints simultaneously. By including all
constraints,wealsogreatlyreducetheallowedrangeofmodelresults,
mostnotablythoseoftheThompsonscatteringopticaldepth(panela)
MNRAS 000, 1â€“13 (2018)10 S. J. Mutch et al.
Table3.Themaximuma-posteriori(MAP)foreachescapefractionmodelparameter(Equation15)whenconstrainingagainsttheobservedThompsonscattering
opticaldepth,ionizingemissivityevolution,andglobalneutralfractionevolution.The1-Dmarginalisedmode,mean,and68%and95%highestdensityintervals
(HDI) are also presented for each parameter. Plots of the 1 and 2-D marginalised posterior distributions are presented in Figures 6 and 7, respectively.
MAP marginalised
mode mean 68% HDI 95% HDI
ğ‘‘ ğ‘“/ğ‘‘log10ğ‘€vir-5.89 -2.63 -21.73 [-0.11,-15.74] [-0.11,-100.26]
ğ‘“min 0.05 0.05 0.04 [0.03,0.06] [0.00,0.07]
ğ‘“max 0.16 0.13 0.18 [0.10,0.20] [0.08,0.34]
ğ‘€offset 9.36 9.18 9.52 [8.38,9.97] [8.33,10.94]
5 6 7 8 9 10 11 12 13
log10(Mvir/M)
0.00.10.20.3fesc
Figure 8. The predicted escape fraction evolution when constrained against
theThompsonscatteringopticaldepth,ionizingemissivity,andneutralfrac-
tion evolution. The galaxy formation parameters are fixed to the maximum
a-posteriori(MAP)valuesfoundinSection4.Darkandlightshadedregions
indicate the 68 and 95% confidence intervals, respectively. The dotted line
shows the MAP escape fraction evolution. A general trend of increasing es-
capefractionwithdecreasinghalomasscanbeseen,ingoodagreementwith
both theory and other works.
andionizingemissivity(panelb).Figures6and7showthatanegative
ğ‘‘ğ‘“/ğ‘‘log10ğ‘€vir(increasing escape fraction with decreasing halo
mass) is strongly favoured. The midpoint of the transition between
ğ‘“minandğ‘“maxis also restricted to a much narrower range than was
the case when constraining against any one observation alone.
InFigure8weshowtheresultingconstraintontheescapefraction
asafunctionofhalomass.At ğ‘€virâ‰³1010.5MâŠ™theescapefraction
isâˆ¼5%This is driven largely by a low escape fraction in high
mass halos being needed to keep the ionizing emissivity as flat as
possibleatğ‘§=5âˆ’6.ThelackofionizingphotonsenteringtheIGM
from high mass haloes reduces the ability of the model to achieve
a rapid reionization, producing optical depths â‰³0.062and a slower
neutral fraction evolution (see panels (a) and (c) of Figure 5). At
lower masses, the escape fraction rises to âˆ¼15âˆ’30%, required to
start reionization early enough to match all three constraints.
The dotted line in Figure 8 shows the maximum aposteriori es-
cape fraction parameterisation (see Table 3 for the corresponding
parameter values). It is tempting to draw conclusions about physi-
cal processes colluding to put some particular significance on halo
masses ofğ‘€virâ‰ˆ109.35MâŠ™, where the sharp transition in ğ‘“escoc-
curs.However,themarginalised68%highestdensityintervalforthe
ğ‘€offsetparameterisbroad( 108.38âˆ’109.97MâŠ™;Table3).FromFig-
ure 7, we can also see that the position of the step is correlated with
themaximumandminimumescapefractionparameters.Indeed,this
correlation is what drives the appearance of a gradual evolution in
68 and 95% confidence intervals of ğ‘“escvs.ğ‘€virin Figure 8.
Figure9showsthecorrespondingcumulativefractionalcontribu-
tion of halos to the instantaneous ionizing photon rate from halos
below a given mass at different redshifts. As expected the typical
halomassproducingionizingphotonsincreasesduringreionization.
8 9 10 11 12
log10(Mvir/M)
0.000.250.500.751.00Mvir
0NdM/prime
vir
Ntot
redshift
5.0
7.5
9.9
12.6
15.1Figure 9. The cumulative contribution to the instantaneous ionizing photon
rate from halos below a given mass at different redshifts resulting from
the best fit ğ‘“esc(ğ‘€vir)model constrained to match all reionization datasets
simultaneously.
However, as noted above, the best fit ğ‘“esc(ğ‘€vir)model favours an
escapefractionthatisdominatedbylowmassgalaxies,whilereion-
ization also supresses star formation in low mass halos. Together
these effects result in a very rapid transition in the halo mass above
which 50% of photons are produced from ğ‘€virâ‰³108.5MâŠ™atğ‘§âˆ¼9
toğ‘€virâ‰³1010.5MâŠ™atğ‘§âˆ¼5.
6.2 Escape fraction evolution with galaxy properties
Previousstudiesofescapefractionevolution,bothusingsimulations
and observations, have found mean trends with galaxy properties
such as stellar mass and colour (e.g. Pahl et al. 2022; Begley et al.
2022; Yeh et al. 2023). In this section, we use the MAP ğ‘“esc(ğ‘€vir)
parametervaluestoinvestigatethepredictedevolutionoftheescape
fraction with stellar mass and star formation rate.
TheupperpanelofFigure10showsthemeanescapefractionasa
function of galaxy stellar mass resulting from the ğ‘“esc(ğ‘€vir)model
(Equation 15) with the MAP parameter values listed in Table 3.
The shaded region indicates the 95% confidence intervals on the
mean, generated from 1,000 bootstrap samples. Since stellar mass
correlatespositivelywithhalomassinourmodel(Mutchetal.2016),
the results are qualitatively similar to the dependance on halo mass.
The typical escape fraction decreases from its maximum of âˆ¼20%
atğ‘€â˜…â‰²106MâŠ™toâˆ¼7%atğ‘€â˜…â‰³108MâŠ™. This decrease begins at
ğ‘€â˜…âˆ¼106.5MâŠ™atğ‘§âˆ¼15andshiftstosmallermassesasreionization
progressesduetoamildevolutionofthetypicalstellarmasshostedby
ğ‘€offset=109.25MâŠ™haloes, the pivot point of our MAP ğ‘“esc(ğ‘€vir)
model.
ThelowerpanelofFigure10showsthecorrespondingcumulative
fractional contribution of galaxies below a given stellar mass to
the instantaneous ionizing photon rate. Since stellar mass correlates
positively with halo mass we see a similar trend as Figure 9 where
the stellar mass above which galaxies dominate the ionizing photon
budget increases during reionization. The stellar mass above which
50% of photons are produced is predicted to be close to a constant
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 11
4 5 6 7 8 9 10 110.000.050.100.15fesc
redshift
5.0
7.5
9.9
12.6
15.1
4 5 6 7 8 9 10 11
log10(M*/M)
0.000.250.500.751.00M*
0NdM/prime
*
Ntot
Figure 10. Upper panel: The evolution of mean escape fraction vs. galaxy
stellarmassresultingfromthebestfit ğ‘“esc(ğ‘€vir)modelconstrainedtomatch
all reionization datasets simultaneously. Results are shown at 5 values of
redshift.Shadedregionsrepresentthe95%confidenceintervalsofthemean,
calculated from 1,000 bootstrapped samples. Data points are the observed
ğ‘§âˆ¼3resultsofPahletal.(2022).Wehighlightthatthesemeasurementswere
not included as constraints on our model. Lower panel: The corresponding
cumulativecontributiontotheinstantaneousionizingphotonratefromhalos
below a given stellar mass.
during the reionization era ( ğ‘€â˜…âˆ¼106MâŠ™atğ‘§â‰³7.5), but then
increases rapidly to ğ‘€â˜…âˆ¼108.5MâŠ™atğ‘§â‰²6.
Figure 11 shows how the mean escape fraction instead varies by
starformationrateforourMAPmodel.Weseeasimilarevolutionary
trendaswasfoundwithstellarmass.Theescapefractionhasamore
extendedevolutionwithstarformationrateasredshiftdecreases.The
lower panel of Figure 11 illustrates that galaxies with star-formation
ratesbetweenÂ¤ğ‘€â˜…âˆ¼10âˆ’1.5MâŠ™yrâˆ’1andÂ¤ğ‘€â˜…âˆ¼10âˆ’2.5MâŠ™yrâˆ’1con-
tribute the dominant sources of ionizing photons throughout reion-
ization.
7 DISCUSSION
Before concluding we compare our population based findings with
other recent theoretical results and observational studies.
Simulations typically show values of escape fraction that vary
betweenafewandafew10sofpercent(e.g.Paardekooperetal.2015;
Rosdahletal.2022),whichisinagreementwithourresultsandwith
priorempiricalcomparisonsofgalaxyluminosityfunctionsandLy-
alpha forest constraints (e.g. Bolton & Haehnelt 2007; Wyithe et al.
2010). Hydrodynamic radiative transfer simulations further indicate
that escape fractions decrease with halo mass for halos with ğ‘€virâ‰²
109MâŠ™(e.g. Kimm et al. 2017; Lewis et al. 2020). Most recently
Yeh et al. (2023) have computed the escape fractions of reionizing
galaxieswithinthe Thesanproject.Theyfindthatlow-massgalaxies
havingğ‘€â˜…â‰²107MâŠ™are the main drivers of reionization above
ğ‘§â‰³7, while higher-mass galaxies with ğ‘€â˜…â‰³108MâŠ™dominate the
escapedionizingphotonbudgetatlowerredshifts.Whencalculating
the dependence on mean escape fraction as a function of halo mass,
Yeh et al. (2023) report a value of a few percent in larger halos with
a sharp rise towards halo masses below ğ‘€virâˆ¼109MâŠ™(see also
0.000.050.100.15fesc
5
 4
 3
 2
 1
 0 1 2
log10(M*/[Myr1])
0.000.250.500.751.00M*
0NdM/prime
*
Ntot
redshift
5.0
7.5
9.9
12.6
15.1Figure 11. Upper panel: The evolution of mean escape fraction vs. instanta-
neous star formation rate resulting from the best fit ğ‘“esc(ğ‘€vir)model con-
strainedtomatchallobservationaldatasetssimultaneously.Resultsareshown
at 5 values of redshift. Shaded regions (only visible for ğ‘§=15) represent the
95% confidence intervals of the mean, calculated from 1,000 bootstrapped
samples. Data points are the observed ğ‘§âˆ¼3results of Pahl et al. (2022).
We highlight that these measurements were not included as constraints on
our model. Lower panel: The corresponding cumulative contribution to the
instantaneous ionizing photon rate from halos below a given stellar mass.
Kostyuk et al. 2023). Inference studies by Park et al. (2019) also
consider similar observational constraints to those used in this work
(the UV luminosity function, CMB optical depth and dark pixels).
AlthoughtheirUVionizingescapefractionhasasimpler,power-law
relation with the host halos mass, they also find ğ‘“escaround 5â€“30
per cent for low-mass haloes, with no significant preference on the
power-lawindex.Alloftheseresultsareinqualitativeagreementwith
ourfindings,especiallywhenthedifferentsimulationtechniquesand
mode of analysis are considered.
In addition to theoretical results we can compare our results in
lightofobservationalestimatesoftheescapefraction.Usingstacked
spectraofLymanbreakgalaxiesat ğ‘§âˆ¼3Pahletal.(2021)(following
Steidel et al. 2018) find an average value for the escape fraction of
0.06Â±0.01. Subsequently Pahl et al. (2022) find an anti-correlation
between the escape fraction and stellar mass. In Figures 10 and 11
we reproduce the measurements of escape fraction from Pahl et al.
(2022) for comparison with our model constraints (we stress that
thesemeasurementswerenotincludedasconstraintsonourmodel).
Themassesofthesegalaxiesareattheupperendofthosethoughtto
beresponsibleforreionization( ğ‘€â˜…â‰³108MâŠ™).However,ourresults
overlap at the lowest stellar masses and star formation rates present
in Pahl et al. (2021), as well as with many of the simulation studies
referenced above. Whilst the correlations at high masses and star
formationratesappeardifferent,wenotethatwehaveconstrainedour
escapefractiontofollowaredshift-independent,halomassdependent
form. We have very few galaxies in these high stellar mass / star
formation rate regimes due to our limited simulation volume and
therefore they provide almost no contribution to our fits.
Finally, we note that, whilst our N-body simulation, Tiamat, pro-
videsagoodbalancebetweenmassresolutionandsimulatedvolume,
it does not fully resolve all haloes down to the redshift-dependent
atomic cooling mass threshold. However, we miss less than 3 per
MNRAS 000, 1â€“13 (2018)12 S. J. Mutch et al.
cent of stellar mass at ğ‘§â‰ˆ6and less than 35 per cent at ğ‘§â‰²12,
therefore we do not expect this to significantly alter our conclusions
(see Section A1 of Mutch et al. 2016).
8 CONCLUSIONS
We have used the Meraxes semi-analytic model to infer the mean
ionizingphotonescapefractionanditsdependenceongalaxyproper-
tiesthroughjointmodellingoftheobservedhighredshiftUVgalaxy
luminosityfunctionandtheavailableconstraintsonthereionization
history with the Meraxes semi-analytic model. Meraxes couples
galaxy formation to a semi-numerical description of reionization,
allowingtheexplorationofreionizationandthegrowthofthegalaxy
population both temporally and spatially.
In this paper we present the application of nested sampling to
Meraxes , allowing statistical exploration of the underlying free pa-
rameter space, including identification of the best fit model as well
asstatisticalconfidenceintervals.Usingaflexiblemodelthatrelates
the escape fraction to halo mass, we use the joint constraints of the
UV luminosity function, CMB optical depth, and the Ly ğ›¼forest to
evaluate the allowed range of escape fraction values and halo mass
dependence. Our results show that available constraints require an
escapefractionof(18Â±5)%forgalaxieswithinhalosof ğ‘€â‰²109MâŠ™
and(5Â±2)%for larger mass halos.
Because Meraxes provides the star-formation rates and stellar
massesforeachdarkmatterhaloateachsimulationsnapshot,wecan
use these results to estimate the dependence of escape fraction on
stellar mass and redshift. We find that there is a transition from an
escape fraction ofâˆ¼18%to a smaller value of âˆ¼5%which occurs
at stellar masses of ğ‘€â˜…âˆ¼107MâŠ™. We find that this transition value
isquiteinsensitivetoredshift.Earlyinreionizationitcorrespondsto
star formation rates of Â¤ğ‘€â˜…âˆ¼10âˆ’1MâŠ™yrâˆ’1, and decreases towards
Â¤ğ‘€â˜…âˆ¼10âˆ’2MâŠ™yrâˆ’1by the end of reionization at ğ‘§âˆ¼5.
When considering the contribution of galaxies to the ionizing
photon budget as a function of redshift, we find that reionization is
dominated by the smaller ğ‘€â˜…â‰²107MâŠ™galaxies with high escape
fractions atğ‘§â‰³6, and by the larger galaxies ğ‘€â˜…â‰³107MâŠ™with
lower escape fractions at ğ‘§â‰²6. These stellar masses correspond to
galaxies with star formation rates of between Â¤ğ‘€â˜…âˆ¼10âˆ’1.5MâŠ™yrâˆ’1
andÂ¤ğ‘€â˜…âˆ¼10âˆ’2.5MâŠ™yrâˆ’1, which represent the dominant sources
throughout reionization. In sum, these results agree with recent di-
rectmeasurementsofa âˆ¼5%escapefractionfrommassivegalaxies
at the end of reionization, and support results from hydrodynamic
modellinganddirectobservationindicatingthattheescapeofioniz-
ing photons is dominated by low mass galaxies during reionization.
ACKNOWLEDGEMENTS
This research was supported by the Australian Research Council
CentreofExcellenceforAllSkyAstrophysicsin3Dimensions(AS-
TRO3D),throughprojectnumberCE170100013.Partsofthiswork
were performed on the OzSTAR national facility at Swinburne Uni-
versity of Technology. This work was supported by software sup-
port resources awarded under the Astronomy Data and Computing
Services (ADACS) Merit Allocation Program. ADACS is funded
from the Astronomy National Collaborative Research Infrastructure
Strategy(NCRIS)allocationprovidedbytheAustralianGovernment
andmanagedbyAstronomyAustraliaLimited(AAL).Thisresearch
relies heavily, and with great thanks, on the Python open sourcecommunity, in particular numpy(Harris et al. 2020), scipy(Virta-
nen et al. 2020), Cython(Behnel et al. 2011), matplotlib (Hunter
2007), h5py,ultranest (Buchner2021), seaborn (Waskom2021),
mpi4py(DalcÃ­netal.2005), jupyter(Granger&PÃ©rez2021), jinja2,
click,pandas(pandasdevelopmentteam2020),and xarray(Hoyer
& Hamman 2017).
DATA AVAILABILITY
Thedataunderlyingthisarticlewillbesharedonreasonablerequest
to the corresponding author.
REFERENCES
AngelP.W.,PooleG.B.,LudlowA.D.,DuffyA.R.,GeilP.M.,MutchS.J.,
Mesinger A., Wyithe J. S. B., 2016, MNRAS, 459, 2106
Atek H., et al., 2022, MNRAS, 000
BaÃ±ados E., et al., 2018, Nature, 553, 473
Bassett R., et al., 2022, MNRAS, 511, 5730
Becker G. D., Bolton J. S., 2013, MNRAS, 436, 1023
Begley R., et al., 2022, MNRAS, 513, 3510
Behnel S., Bradshaw R., Citro C., Dalcin L., Seljebotn D., Smith K., 2011,
Computing in Science Engineering, 13, 31
Bolton J. S., Haehnelt M. G., 2007, MNRAS, 382, 325
Bosman S. E. I., et al., 2022, MNRAS, 514, 55
Bouwens R. J., et al., 2014, ApJ, 793, 115
Bouwens R. J., et al., 2015, ApJ, 803, 34
BouwensR.J.,OeschP.A.,IllingworthG.D.,EllisR.S.,StefanonM.,2017,
ApJ, 843, 129
Bouwens R. J., et al., 2021, AJ, 162, 47
Buchner J., 2014, arXiv e-prints, p. arXiv:1407.5459
Buchner J., 2017, arXiv e-prints, p. arXiv:1707.04476
Buchner J., 2021, The Journal of Open Source Software, 6, 3001
Bullock J. S., Dekel A., Kolatt T. S., Kravtsov A. V., Klypin A. A., Porciani
C., Primack J. R., 2001, ApJ, 555, 240
Cen R., Kimm T., 2015, ApJ, 801, L25
Charlot S., Fall S. M., 2000, ApJ, 539, 718
Cora S. A., et al., 2018, MNRAS, 479, 2
Croton D. J., et al., 2006, MNRAS, 365, 11
Dâ€™Aloisio A., McQuinn M., Davies F. B., Furlanetto S. R., 2018, MNRAS,
473, 560
DalcÃ­n L., Paz R., Storti M., 2005, Journal of Parallel and Distributed Com-
puting, 65, 1108
Davies F. B., et al., 2018, ApJ, 864, 142
Faucher-GiguÃ¨re C.-A., 2020, MNRAS, 493, 1614
Finkelstein S. L., et al., 2015, ApJ, 810, 71
Finkelstein S. L., et al., 2019, ApJ, 879, 36
Gillet N. J. F., Mesinger A., Park J., 2020, MNRAS, 491, 1980
Gnedin N. Y., Kravtsov A. V., Chen H.-W., 2008, ApJ, 672, 765
Granger B. E., PÃ©rez F., 2021, Computing in Science & Engineering, 23, 7
Greig B., Mesinger A., 2017, MNRAS, 465, 4838
GreigB.,MesingerA.,HaimanZ.,SimcoeR.A.,2017,MNRAS,466,4239
Greig B., Mesinger A., BaÃ±ados E., 2019, MNRAS, 484, 5094
Greig B., Mesinger A., Davies F. B., Wang F., Yang J., Hennawi J. F., 2022,
Monthly Notices of the Royal Astronomical Society, 512, 5390
Guo Q., et al., 2011, MNRAS, 413, 101
Harris C. R., et al., 2020, Nature, 585, 357
Henriques B. M. B., White S. D. M., Thomas P. A., Angulo R. E., Guo Q.,
Lemson G., Springel V., 2013, MNRAS, 431, 3373
Hoag A., et al., 2019, ApJ, 878, 12
Hoyer S., Hamman J., 2017, Journal of Open Research Software, 5
Hunter J. D., 2007, Computing in Science & Engineering, 9, 90
Hutter A., Dayal P., Yepes G., GottlÃ¶ber S., Legrand L., Ucci G., 2021,
MNRAS, 503, 3698
Katsianis A., Yang X., Zheng X., 2021, ApJ, 919, 88
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 13
Kennicutt Robert C. J., 1989, ApJ, 344, 685
Kimm T., Katz H., Haehnelt M., Rosdahl J., Devriendt J., Slyz A., 2017,
MNRAS, 466, 4826
Kostyuk I., Ciardi B., Ferrara A., 2023, arXiv e-prints, p. arXiv:2308.01476
Kroupa P., 2001, MNRAS, 322, 231
Kuhlen M., Faucher-GiguÃ¨re C.-A., 2012, MNRAS, 423, 862
Leitherer C., et al., 1999, ApJS, 123, 3
Lemoine N. P., 2019, Oikos, 128, 912
Lewis J. S. W., et al., 2020, MNRAS, 496, 4342
Mason C. A., Treu T., DÄ³kstra M., Mesinger A., Trenti M., Pentericci L., de
Barros S., Vanzella E., 2018, ApJ, 856, 2
McGreer I. D., Mesinger A., Dâ€™Odorico V., 2015, MNRAS, 447, 499
McQuinn M., Oh S. P., Faucher-GiguÃ¨re C.-A., 2011, ApJ, 743
Mesinger A., 2010, MNRAS, 407, 1328
Mesinger A., Furlanetto S., Cen R., 2011, MNRAS, 411, 955
Mesinger A., Greig B., Sobacchi E., 2016, MNRAS, 459, 2342
MuratovA.L.,KereÅ¡D.,Faucher-GiguÃ¨reC.-A.,HopkinsP.F.,QuataertE.,
Murray N., 2015, MNRAS, 454, 2691
Mutch S. J., Geil P. M., Poole G. B., Angel P. W., Duffy A. R., Mesinger A.,
Wyithe J. S. B., 2016, MNRAS, 462, 250
Naidu R. P., Tacchella S., Mason C. A., Bose S., Oesch P. A., Conroy C.,
2020, ApJ, 892, 109
Naidu R. P., et al., 2022, ApJ, 940, L14
PaardekooperJ.-P.,KhochfarS.,DallaVecchiaC.,2015,MNRAS,451,2544
Pahl A. J., Shapley A., Steidel C. C., Chen Y., Reddy N. A., 2021, MNRAS,
505, 2447
Pahl A. J., Shapley A., Steidel C. C., Reddy N. A., Chen Y., Rudie G. C.,
Strom A. L., 2022, arXiv e-prints, p. arXiv:2210.16697
Park J., Mesinger A., Greig B., Gillet N., 2019, MNRAS, 484, 933
Planck Collaboration et al., 2016a, A&A, 594, A13
Planck Collaboration et al., 2016b, A&A, 596, A108
Planck Collaboration et al., 2020, A&A, 641, A6
Poole G. B., Angel P. W., Mutch S. J., Power C., Duffy A. R., Geil P. M.,
Mesinger A., Wyithe S. B., 2016, MNRAS, 459, 3025
PooleG.B.,MutchS.J.,CrotonD.J.,WyitheS.,2017,MNRAS,472,3659
Qin Y., et al., 2017, MNRAS, 472, 2009
Qin Y., Mesinger A., Bosman S. E. I., Viel M., 2021, MNRAS, 506, 2390
QiuY.,MutchS.J.,daCunhaE.,PooleG.B.,WyitheJ.S.B.,2019,MNRAS,
489, 1357
Rosdahl J., et al., 2022, MNRAS, 515, 2386
Seiler J., Hutter A., Sinha M., Croton D., 2019, MNRAS, 487, 5739
Skilling J., 2004, in Fischer R., Preuss R., Toussaint U. V., eds, American
Institute of Physics Conference Series Vol. 735, American Institute of
Physics Conference Series. pp 395â€“405, doi:10.1063/1.1835238
Sobacchi E., Mesinger A., 2013, MNRAS, 432, 3340
Somerville R. S., Primack J. R., Faber S. M., 2001, MNRAS, 320, 504
Srbinovsky J. A., Wyithe J. S. B., 2007, MNRAS, 374, 627
Steidel C. C., BogosavljeviÄ‡ M., Shapley A. E., Reddy N. A., Rudie G. C.,
Pettini M., Trainor R. F., Strom A. L., 2018, ApJ, 869, 123
Trebitsch M., et al., 2021, A&A, 653, A154
Virtanen P., et al., 2020, Nature Methods, 17, 261
Visbal E., Bryan G. L., Haiman Z., 2020, ApJ, 897, 95
Wang F., et al., 2020, ApJ, 896, 23
Waskom M. L., 2021, Journal of Open Source Software, 6, 3021
Wise J. H., Cen R., 2009, ApJ, 693, 984
Wyithe J. S. B., Loeb A., 2003, ApJ, 586, 693
WyitheJ.S.B.,HopkinsA.M.,KistlerM.D.,YÃ¼kselH.,BeacomJ.F.,2010,
MNRAS, 401, 2561
Yeh J. Y. C., et al., 2023, MNRAS,
Yung L. Y. A., Somerville R. S., Finkelstein S. L., Popping G., DavÃ© R.,
Venkatesan A., Behroozi P., Ferguson H. C., 2020, MNRAS, 496, 4574
pandas development team T., 2020, pandas-dev/pandas: Pandas,
doi:10.5281/zenodo.3509134, https://doi.org/10.5281/zenodo.
3509134APPENDIX A: PRIOR AND POSTERIOR PARAMETER
DISTRIBUTIONS
InthisAppendixwepresentthe2-Dmarginalisedprobabilitydistri-
butions (Figure A3) for the fits of the Meraxes model to the galaxy
UV luminosity function and ğ›½âˆ’ğ‘€UVrelation discussed in Sec-
tion 4.1. It is worth noting that Qiu et al. (2019) also used Meraxes
with the same free galaxy formation and dust parameters as we do,
but recovered different posterior distributions for some parameters
(see their figure A3). This can largely be attributed to the different
redshiftrangeutilisedfortheirconstraints( ğ‘§=7âˆ’4).Theinclusion
of lower redshift data, in particular, provides significant extra con-
straining power. The remaining differences are due to our different
choice of priors which can have an impact on poorly constrained
parameters.
We also provide detail of the prior probability distributions em-
ployed for all free parameters in this work. These encode the range
in allowed values (e.g. efficiency parameters must be in the range
0â€“1). In some cases they also weakly encode physical intuition and
the authors experience from past studies. We have ensured that the
precise choice of priors makes no significant qualitative or quanti-
tative difference to our findings except where explicitly noted in the
text. In appendix Table 1 we present a tabulated description of the
priors, and show these graphically in Figures A1 and A2.
Notethatwedonotuseuniformpriorsascommonlyemployedin
the galaxy formation literature. Our reasoning is that flat priors give
extra,undue,weighttoparametervalueswhichweknowfromexpe-
rienceandphysicalintuitiontobeunlikely.Whenusingsuchpriors,
one also must choose bounds for the parameter values, which in it-
self often imposes prior knowledge or intuition anyway. The use of
weakly informative priors, such as the ones we employ, additionally
provides numerous other statistical benefits (e.g. Lemoine 2019).
This paper has been typeset from a T EX/LATEX file prepared by the author.
MNRAS 000, 1â€“13 (2018)14 S. J. Mutch et al.
Table 1.Description of the priors employed for all free parameters.
Parameter Prior
Galaxy formation
log10(ğ›¼SF) ğ‘“(ğ‘¥)=Truncated Normal(ğ‘¥, ğ‘¥ min=âˆ’3.0, ğ‘¥max=0.0, ğœ‡=âˆ’1.0, ğœ=1.05)
log10(Î£n) ğ‘“(ğ‘¥)=Truncated Normal(ğ‘¥, ğ‘¥ min=âˆ’3.0, ğ‘¥max=0.0, ğœ‡=âˆ’1.0, ğœ=1.05)
log10(ğœ–0) ğ‘“(ğ‘¥)=Normal(ğ‘¥, ğœ‡=1.0, ğœ=2.0)
log10(ğœ‚0) ğ‘“(ğ‘¥)=Normal(ğ‘¥, ğœ‡=1.0, ğœ=2.0)
Dust model
ğœISM ğ‘“(ğ‘¥)=Beta(ğ‘¥/65, ğ›¼=1.0, ğ›½=1.1)/65
ğœBC ğ‘“(ğ‘¥)=Beta(ğ‘¥/5000, ğ›¼=1.0, ğ›½=1.8)/5000
ğ›¾ ğ‘“ (ğ‘¥)=Beta(ğ‘¥/15, ğ›¼=1.0, ğ›½=1.35)/15
ğ‘› ğ‘“ (ğ‘¥)=Beta(ğ‘¥/15, ğ›¼=1.0, ğ›½=1.35)/15
ğ‘ ğ‘“ (ğ‘¥)=Beta(ğ‘¥/10, ğ›¼=1.0, ğ›½=1.5)/10
Escape fraction model
ğ‘“min ğ‘“(ğ‘¥)=Beta(ğ‘¥, ğ›¼=1.0, ğ›½=3.0)
ğ‘“max ğ‘“(ğ‘¥)=Beta(ğ‘¥, ğ›¼=1.5, ğ›½=4.2)
ğ‘€offset ğ‘“(ğ‘¥)=Beta(ğ‘¥/20, ğ›¼=1.3, ğ›½=1.3)/20
ğ‘‘ ğ‘“/ğ‘‘log10ğ‘€vir ğ‘“(ğ‘¥)=Student-t(ğ‘¥/10, ğœˆ=1)/10
MNRAS 000, 1â€“13 (2018)Constraining escape fraction evolution 15
3.0
 2.5
 2.0
 1.5
 1.0
 0.5
 0.0log10(SF)
3.0
 2.5
 2.0
 1.5
 1.0
 0.5
 0.0log10(n)
4
 2
 0 2 4log10(0)
4
 2
 0 2 4log10(0)
0 10 20 30 40 50 60ISM
0 1000 2000 3000 4000 5000BC
0 2 4 6 8 10 12 14GCD
14
 12
 10
 8
 6
 4
 2
 0n
0 2 4 6 8 10amarginalised PDF
prior
FigureA1. KerneldensityestimatesofthemarginalisedPDFsforeachgalaxy
formationparameter(orange;seeSection4.1)comparedwiththecorrespond-
ing prior distributions (blue lines; see Tables 2 & 1). A similarity between
posterior distributions and priors indicates a lack of constraining power (e.g.
log10(ğœ–0)).
0.0 0.2 0.4 0.6 0.8 1.0
fmin
0.0 0.2 0.4 0.6 0.8 1.0
fmax
0.0 2.5 5.0 7.5 10.0 12.5 15.0 17.5 20.0
Moffset
60
 40
 20
 0 20 40 60
df/dlog10Mvirmarginalised PDF
priorFigure A2. Kernel density estimates of the marginalised PDFs for each ğ‘“esc
model parameter when fitting against the combined reionization constraints
(orange; see Section 6.1). These are compared with the corresponding prior
distributions (blue lines; see Tables 3 & 1). A similarity between posterior
distributions and priors would indicate a lack of constraining power.
MNRAS 000, 1â€“13 (2018)16 S. J. Mutch et al.
2.4
1.6
0.8
0.0log10(n)
12345log10(0)
0.50.60.70.80.9log10(0)
1020304050ISM
40080012001600BC
1.21.41.61.82.0GCD
3.0
2.5
2.0
1.5
n
1.35
1.20
1.05
0.90
log10(SF)
0.600.750.901.051.20a
2.4
1.6
0.8
0.0
log10(n)
12345
log10(0)
0.50.60.70.80.9
log10(0)
1020304050
ISM
40080012001600
BC
1.21.41.61.82.0
GCD
3.0
2.5
2.0
1.5
n0.600.750.901.051.20
a
Figure A3. The 1 and 2-D marginalised posterior distributions for our galaxy formation model parameters when constraining against the observed evolution of
the UVLF and ğ›½-ğ‘€UVrelation. Blue cross-hairs indicate the maximum a-posteriori parameter set. The 2-D contours represent 1 and 2- ğœprobability density
regions.
MNRAS 000, 1â€“13 (2018)