Lee-Yang theory of Bose-Einstein condensation
Fredrik Brange,1Tuomas Pyh aranta,1Eppu Heinonen,1Kay Brandner,2and Christian Flindt1
1Department of Applied Physics, Aalto University, 00076 Aalto, Finland
2School of Physics and Astronomy, University of Nottingham, Nottingham NG7 2RD, United Kingdom
Bose-Einstein condensation happens as a gas of bosons is cooled below its transition temperature,
and the ground state becomes macroscopically occupied. The phase transition occurs in the ther-
modynamic limit of many particles. However, recent experimental progress has made it possible to
assemble quantum many-body systems from the bottom up, for example, by adding single atoms to
an optical lattice one at a time. Here, we show how one can predict the condensation temperature
of a Bose gas from the energy uctuations of a small number of bosons. To this end, we make use of
recent advances in Lee-Yang theories of phase transitions, which allow us to determine the zeros and
the poles of the partition function in the complex plane of the inverse temperature from the high
cumulants of the energy uctuations. By increasing the number of bosons in the trapping potential,
we can predict the convergence point of the partition function zeros in the thermodynamic limit,
where they reach the inverse critical temperature on the real axis. Using less than 100 bosons, we
can estimate the condensation temperature for a Bose gas in a harmonic potential in two and three
dimensions, and we also nd that there is no phase transition in one dimension as one would expect.
I. INTRODUCTION
Bose-Einstein condensation is a remarkable physical
phenomenon by which a gas of bosons abruptly con-
denses into its ground state as it is cooled below its
transition temperature [1, 2]. Bose-Einstein condensa-
tion was rst observed with dilute atomic vapors that
were cooled below their transition temperature of a few
hundred nanokelvins [3, 4]. These results spurred a wide
range of developments that seek to explore how Bose-
Einstein condensates can be exploited for technological
applications, e. g. for quantum computing [5], sensing
[6], or thermal machines [7, 8]. At its core, Bose-Einstein
condensation can be understood using basic arguments
which relate the critical temperature of a gas solely to
the density of bosons, , the thermal de Broglie wave-
length,th=h=p2mkBT, and the geometry and di-
mension of the conning potential. For example, for free
bosons in three dimensions, the transition temperature
can be found from the relation, 3
th=(3=2)'2:61,
where(x) is Riemann's zeta function [9]. Typically, to
observe Bose-Einstein condensation, the gas must be di-
lute, and the temperature must be ultralow. However, in
recent years, Bose-Einstein condensation has also been
observed at room temperature with quasiparticles, such
as surface plasmons [10, 11] or magnons [12, 13]. To this
end, a large de Broglie wavelength can be obtained by
using bosons with a very low eective mass, rather than
cooling them to subkelvin temperatures.
Bose-Einstein condensation is a prime example of a
phase transition, which can be analyzed within the frame-
work of equilibrium statistical physics [14{16]. Phase
transitions occur in the thermodynamic limit of many
particles and large system sizes, and they are signaled
by a nonanalytic behavior of the free-energy density at
the critical value of the external control parameter, for
example, temperature, pressure, or magnetic eld. Early
on, Lee and Yang realized that this non analytic behavior
can be understood by considering the zeros of the parti-tion function in the complex plane of the control param-
eter [17{20]. In the case that a system exhibits a phase
transition, the complex partition function zeros will ap-
proach the critical value on the real axis in the thermo-
dynamic limit and thereby give rise to a nonanalytic be-
havior of the free-energy density [21{35]. Lee and Yang
thereby provided a rigorous foundation of phase transi-
tions. Moreover, in recent years, it has been realized that
partition-function zeros are not only a theoretical con-
(b)Im
Re1D 2D 3D(a)
y xV(x,y)
Re Re(c)T/Tc11
01â€“(T/Tc)22D
c cc= 1/kBTcN0 /N
FIG. 1. Lee-Yang theory of Bose-Einstein condensation. (a)
A two-dimensional harmonic potential V(x;y) containing a
gas of bosons. (b) Fraction of bosons in the ground state of a
two-dimensional potential as a function of the temperature T.
Below the critical temperature, Tc, the ground state becomes
macroscopically occupied. (c) Zeros of the canonical partition
function in the complex plane of the inverse temperature, =
1=(kBT), for dierent dimensions. The zeros correspond to
N= 20 bosons and were obtained with a high-temperature
expansion of the partition function. The red dots illustrate
potential convergence points cin the thermodynamic limit.arXiv:2301.10997v2  [cond-mat.quant-gas]  23 Mar 20232
cept. They can also be determined in experiments [36{
40]. In the approach that we follow here, the partition-
function zeros can be found from the uctuations of the
thermodynamic observable that couples to the control
parameter; for example, energy is coupled to the inverse
temperature, while the magnetization of a spin lattice
couples to the magnetic eld [39{44]. Thus, from these
uctuations, one can nd the partition-function zeros for
a given system size, and by gradually increasing the sys-
tem size, one may determine the thermodynamic con-
vergence point by extrapolation. This methodology has
already been realized experimentally [40], and it has also
been applied in theory to a variety of equilibrium prob-
lems, including simple models of DNA unfolding [41] and
spontaneous magnetization in spin lattices [42{44]. Sur-
prisingly, in many cases, the critical value of the control
parameter can be found using rather small system sizes.
The framework is not restricted to equilibrium settings
and can also be applied to non-equilibrium phase transi-
tions [39, 45]. In addition, it was recently extended to the
quantum realm to describe quantum phase transitions
in the many-body ground state of interacting quantum
systems [46{48] and to dynamical quantum phase tran-
sitions in spin lattices following a quench [49, 50].
The purpose of the present work is to apply the Lee-
Yang methodology to predict the condensation tempera-
ture of a Bose gas from the uctuations of the energy in a
harmonic potential in one, two, and three dimensions, as
illustrated in Fig. 1(a). Below the condensation tempera-
ture, the fraction of particles in the single-particle ground
state grows algebraically as the temperature is reduced,
as shown in Fig. 1(b) for a two-dimensional trapping po-
tential. The abrupt change in the ground state popula-
tion occurs in the thermodynamic limit of many particles.
By contrast, we here consider fewer than 100 bosons, and
we determine the partition-function zeros in the complex
plane of the inverse temperature from the high cumulants
of the energy uctuations. Examples are provided in
Fig. 1(c), where we show the complex partition-function
zeros obtained with a high-temperature expansion of the
partition function in one, two, and three dimensions. In
two and three dimensions, the zeros converge towards
the inverse transition temperature on the real axis as the
number of particles is increased. On the other hand, for
the one-dimensional trapping potential, there is no phase
transition, and the zeros remain complex.
This paper is organized as follows. In Sec. II, we pro-
vide a brief overview of the standard approach to Bose-
Einstein condensation based on the grand canonical en-
semble. We then turn to the canonical ensemble, which
we will use throughout this work, and where the number
of particles is xed. In Sec. III, we discuss the Lee-Yang
theory that we will be using, which considers the zeros
of the canonical partition function in the complex plane
of the inverse temperature. We show how the partition-
function zeros can be determined from the energy uctu-
ations of the Bose gas and how we can predict the transi-
tion temperature in the thermodynamic limit using fewerthan 100 bosons. In Sec. IV, we show results for bosons
in a harmonic trap in one, two, and three dimensions, for
which we predict the transition temperature by extrap-
olation to the thermodynamic limit. In Sec. V, we then
simulate the energy uctuations in a Bose gas to demon-
strate how the partition-function zeros in principle could
be determined experimentally. Finally, in Sec. VI, we
present our conclusions and provide an outlook on pos-
sible developments for the future. Additional technical
details are provided in Appendixes A and B.
II. BOSE-EINSTEIN CONDENSATION
A. Grand-canonical ensemble
The simplest approach to Bose-Einstein condensation
is provided by the grand-canonical ensemble as discussed
in most textbooks [9]. The equilibrium properties of the
gas are encoded in the grand-canonical partition func-
tion,
Z(;) = Trn
e (^H ^N)o
; (1)
where ^His the many-body Hamiltonian of the conned
bosons, the number operator is denoted by ^N, andis
the chemical potential, while = 1=kBTis the inverse
temperature. The grand potential correspondingly reads
(;) =  1lnZ(;)
'  1Z1
0dEgd(E) lnf1 e (E )g;(2)
where
gd(E) =1
(d 1)!E(d 1)
(~!0)d(3)
is the density of states of the potential with frequency !0
inddimensions. The mean number of bosons reads
N= @(;) =Z1
0dEgd(E)
1 zeE=Lid(z)
(~!0)d;(4)
wherez=eis the fugacity and Li d(z) is the polyloga-
rithmic function. At high temperatures, the contribution
for the single-particle ground state can be included in the
integrals above. On the other hand, at lower tempera-
tures, the ground-state population becomes macroscopic
and must be treated separately. When this happens, the
chemical potential approaches the ground-state energy,
which is set to zero, and we can thus nd the condensa-
tion temperature from Eq. (4) in the limit z!1, where
the polylogarithmic function is given by Riemann's zeta
function, Li d(1) =(d), with(2) =2=6 and(3)'1:2,
while it diverges for d= 1. We then nd the known
expression for the transition temperature in d= 2;3 di-
mensions,
Tc=~!0
kBN
(d)1=d
: (5)3
By contrast, there is no phase transition for the one-
dimensional harmonic potential. (See, however, Refs. [51,
52] and Appendix A for a discussion of Bose-Einstein
condensation of a nite number of trapped bosons in one
dimension, which is not an actual phase transition in the
thermodynamic limit.) The transition temperature in
Eq. (5) appears at rst to diverge with the number of
particles. However, in the thermodynamic limit, the par-
ticle density should be xed, and to this end one weakens
the potential, so that !d
0Nis kept constant [52].
B. Canonical ensemble
In the approach that we pursue in the following, we
consider the canonical ensemble, where the number of
particles is xed, and the partition function is dened as
ZN() = TrNn
e ^HNo
(6)
in terms of the Hamiltonian ^HNforNparticles. Im-
portantly, for an ideal Bose gas, the partition function
can be found from the recursive expressionthe recursive
expression [53{58]
ZN() =1
NNX
k=1Z1(k)ZN k(); (7)
which starts with the partition function for a single par-
ticle together with Z0() = 1. For a single particle in a
harmonic trapping potential, we readily nd
Z1() = 1X
n=0e ~!0(n+1=2)!d
=e ~!0=2
1 e ~!0d
(8)
and we can then obtain the partition function for Npar-
ticles using Eq. (7). At high temperatures, the partition
function for a single particle simplies to
Z1()'1
(~!0)d;  ~!01; (9)
which will be useful for some of our calculations.
C. Moments and cumulants of the energy
From the partition function and the associated free en-
ergy, we can obtain various thermodynamic observables
and their moments and cumulants. In particular, we can
obtain the moments of the total energy as
hUni= ( 1)n@n
ZN()
ZN()= TrN(
^Hn
Ne ^HN
ZN())
:(10)
Similarly, the cumulants of the energy are dened as
hhUnii= ( 1)n@n
lnZN(); (11)and they can be directly expressed in terms of the mo-
ments via the standard relation
hhUnii=hUni n 1X
m=1n 1
m 1
hhUmiihUn mi:(12)
Moreover, dierentiating Eq. (7) with respect to the in-
verse temperature and using the general Leibniz rule for
thenth derivative of a product of functions, we arrive at
Z(n)
N() =1
NNX
k=1NX
l=0n
l
klZ(l)
1(k)Z(n l)
N k();(13)
where we have introduced the notation Z(n)
N() =
@n
ZN(). Using this expression, we can recursively eval-
uate the high derivatives of the partition function and
the corresponding moments and cumulants using only
the derivatives of the one-particle partition function.
III. LEE-YANG THEORY
A. Partition function zeros and poles
In the works by Lee and Yang, they analyzed the non-
analytic behavior of the free-energy density at a phase
transition in terms of the complex partition function ze-
ros [17, 18]. In particular, they showed how a phase tran-
sition occurs as the zeros approach the real axis in the
thermodynamic limit. In the case of Bose-Einstein con-
densation, the zeros will converge towards the value of
the inverse temperature for which the phase transition
occurs. In Ref. [58], the complex partition-function zeros
of a Bose gas in a three-dimensional trapping potential
were found numerically. Here, by contrast, we consider
trapped bosons in one, two, and three dimensions, and
we use a cumulant method to determine the partition-
function zeros from the uctuations of the energy, which
in principle are measurable. We also discuss the fact
that the partition function does not have only complex
zeros. It also has poles, which is already clear from the
single-particle partition function in Eq. (8), which has
poles along the imaginary axis, including one at the ori-
gin. These poles appear because of the innitely many
oscillator states in the sum in Eq. (8) [45, 59].
As an illustration, we show in Fig. 1(c) the partition-
function zeros in the complex plane of the inverse tem-
perature, calculated numerically based on the recursive
relation in Eq. (7) for N= 20 particles together with
the high-temperature expansion in Eq. (9). These re-
sults already indicate that Bose-Einstein condensation
happens in the thermodynamic limit for two- and three-
dimensional trapping potentials, while the zeros stay o
of the positive real axis for a one-dimensional trap. More
accurate results are shown in Figs. 2(a) and 3(a), where
we show the partition-function zeros for N= 2;:::; 20
particles in two and three dimensions obtained with the4
-101Re Im
1/N0.5 0.4 0.3 0.2 0.1 0(c)
1.5Im1
0
-1
Re1 0.5(a)2
-2
Im1
0
-1
Re1 0.5 1.5(b)
N = 2,...,1002
-2 -22
220
FIG. 2. Three-dimensional harmonic potential. (a) Partition-function zeros in the complex plane of the inverse temperature
obtained numerically for N= 2;:::; 20 bosons. (b) Partition-function zeros closest to the inverse temperature = 1:15c,
marked with a cross, obtained with the cumulant method for N= 2;:::; 100 bosons. Here, we have used m= 7 dierent
cumulant orders up to order 17. (c) The real and (negative) imaginary parts of the zeros as a function of 1 =N. The red dots are
the extrapolated convergence points in the thermodynamic limit, which we determine based on the scaling ansatz in Eq. (25).
exact expression for the single-particle partition function
in Eq. (8). These results are also indicative of a phase
transition, although it is hard to reach larger system sizes
as the calculations become increasingly cumbersome with
increasing particle number. Instead, we make use of a cu-
mulant method that allows us to determine the partition-
function zeros from the uctuations of the energy. Here,
the starting point is a formal product expansion of the
canonical partition function reading [60]
ZN() =c0ec1Y
i( i)
Y
j( j); (14)
wherec0andc1are constants, and iandjare the zeros
and poles of the partition function, respectively. For a
nite number of particles, the zeros and the poles come
in complex conjugate pairs, since the partition function
is real valued for real values of .
B. Cumulant method
We now describe the cumulant method for extracting
several of the partition-function zeros from the uctua-
tions of the energy. To this end, we use the denition
of the cumulants in Eq. (11) together with the product
expansion in Eq. (14) to express the cumulants as
hhUnii= (n 1)!X
k( 1)pk
( k)n; n> 1; (15)
where the sum runs over all zeros ( pk= 1) and poles
(pk= 0), which we collectively denote by k. Impor-
tantly, the contribution from each zero or pole decreases
with the distance to the actual inverse temperature, ,
to the power of the cumulant order. Thus, for high cu-
mulant orders, we can truncate the sum ashhUnii'(n 1)!MX
k=1( 1)pk
( k)n; n1; (16)
where we have included only the Mzeros and poles that
are closest to the actual inverse temperature. In the case
withM= 2, only the pair of zeros that are closest to
the actual inverse temperature is included, and using the
method developed in Refs. [39{44], one may extract these
zeros from the high cumulants of the energy uctuations.
Recently, this approach was extended, so that more ze-
ros and poles can be included in the sum and determined
from the energy uctuations [49]. To simplify the nota-
tion, we dene the normalized cumulants as
un=hhUnii
(n 1)!; (17)
and then rewrite the truncated sum in Eq. (16) as
un' mX
k=1dkn
k (18)
with
k=1
 k(19)
anddkbeing the multiplicity of each zero or pole (a sim-
ple pole has dk= 1). To determine the zeros and poles
in Eq. (19), we note that expression (18) for the normal-
ized cumulants can be regarded as the general solution
of a homogeneous dierence equation of the form
un=a1un 1+a2un 2+:::+amun m; (20)
where the coecients akare still undetermined. To nd
them, we formulate a linear system of mequations, using
Eq. (20), which reads5
-101Re Im
1/N0.5 0.4 0.3 0.2 0.1 0(c)
1.5Im1
0
-1
Re1 0.5(a)
N = 2,...,100Im1
0
-1
Re1 0.5 1.5(b)2
-22
-22
-2220
FIG. 3. Two-dimensional harmonic potential. (a) Partition function zeros in the complex plane of the inverse temperature
obtained numerically for N= 2;:::; 20 bosons. (b) Partition function zeros closest to the inverse temperature = 1:15c,
marked with a cross, obtained with the cumulant method for N= 2;:::; 100 bosons. Here, we have used m= 7 dierent
cumulant orders up to order 17. (c) The real and (negative) imaginary parts of the zeros as functions of 1 =N. The red dots are
the extrapolated convergence points in the thermodynamic limit, which we determine based on the scaling ansatz in Eq. (25).
0
BBBB@un 1un 2::: un m+1un m
unun 1::: un m+2un m+1
...............
un+m 3un+m 4::: un 1un 2
un+m 2un+m 3::: unun 11
CCCCA0
BBBB@a1
a2
...
am 1
am1
CCCCA=0
BBBB@un
un+1
...
un+m 2
un+m 11
CCCCA: (21)
Recalling that the normalized cumulants ukare known, we may now solve for the coecients akby inverting the
matrix on the left-hand side of this equation. Afterwards, we may nd kas the roots of the equation
m a1m 1 a2m 2 ::: am 1 am= 0; (22)
which is the characteristic equation obtained from the recurrence relation in Eq. (20). As the last step, we obtain the
multiplicities dkas the solutions to the matrix equation
 0
BBBBB@1 1 ::: 1 1
01::: m 2m 1
...............
m 2
0m 2
1::: m 2
m 2m 2
m 1
m 1
0m 1
1::: m 1
m 2m 1
m 11
CCCCCA0
BBBBB@d0n
0
d1n
1
...
dm 2n
m 2
dm 1n
m 11
CCCCCA=0
BBBBB@un
un+1
...
un+m 2
un+m 11
CCCCCA; (23)
which follows directly from Eq. (18).
From the roots, we immediately nd the zeros and
poles ask= 1=ktogether with their multiplici-
tiesdkfrom the last matrix equation. Importantly, the
accuracy of the method can be gauged by the multiplic-
ities, which should be integers. Thus, deviations from
integer values indicate that the truncation in Eq. (16) is
not a good approximation. One can then include more
cumulants or increase the cumulant order to ensure con-
vergence. For the following results, we have carefully
checked that the position of the zeros and the poles have
converged with respect to the number of cumulants and
their order. Also, we consider only zeros and poles whose
multiplicity coecients dkdeviate from an integer value
by less than a tolerance threshold of 0.3.IV. CONDENSATION TEMPERATURE
A. Three-dimensional trapping potential
In Fig. 2, we show partition-function zeros in the
complex plane of the inverse temperature for the three-
dimensional harmonic trapping potential. In Fig. 2(a),
we show numerical results for the partition-function ze-
ros using system sizes in the range N= 2;:::; 20. By
contrast, in Fig. 2(b), we show results obtained using the
cumulant method, which allows us to extract the conju-
gate pair of zeros that are closest to the inverse tempera-
ture at which the cumulants are evaluated, marked with
a cross on the real axis. Thus, from the energy uctua-
tions of the Bose gas at this inverse temperature, we can
determine the closest partition-function zeros and moni-6
-602
1/N1 0.8 0.6 0.4 0.2 0(c)
0.55
0
-50 -0.5(a)
0.55
0
-5
Re0 -0.5(b)
-4-2
ReIm
Im
Im Re
FIG. 4. One-dimensional harmonic potential. (a) Poles of the partition function according to Eq. (27) for N= 6 bosons with
0= 1=(~!0). (b) Poles closest to the origin obtained with the cumulant method for N= 2;:::; 6 bosons. Here, we have used
m= 6 dierent cumulant orders up to order 25, with a tolerance threshold of 0.25. (c) The real and (negative) imaginary parts
of the poles a function of 1 =Ntogether with a linear extrapolation shown by a dashed line.
tor their motion as the system size is gradually increased
in the range N= 2;:::; 100. From the analysis of Bose-
Einstein condensation in the grand-canonical ensemble,
we know that the critical inverse temperature depends
on the number of particles according to Eq. (5). For this
reason, we use dimensionless units on the axes, where
c= 1=(kBTc) is the expected inverse transition temper-
ature. Here, we note that there are nite-size corrections
to the predicted transition temperature, which can be
obtained from the equation (see Appendix B for details)
Tc=~!0
kBN
(3)1=3
1 +3
2(2)
(3)~!0
kBTc 1=3
:(24)
However, in the thermodynamic limit, where !3
0Nis kept
constant by weakening the potential, we see that this
expression reduces to the one in Eq. (5) for d= 3.
To determine the convergence point in the thermody-
namic limit, we show in Fig. 2(c) the real and (negative)
imaginary parts of the zeros as a function of the inverse
particle number. We then use the scaling ansatz [42{44]
j0 ~cj/N (25)
from which we nd and the prediction for the criti-
cal point ~c, marked with red circles, with the method
of least squares. These results show how the extrapo-
lated convergence points come close to the expected in-
verse transition temperature with only a small imaginary
part. Thus, we see how the transition temperature in the
thermodynamic limit can be rather precisely estimated
from the energy uctuations of a gas with fewer than
100 bosons.
B. Two-dimensional trapping potential
In Fig. 3, we show results for the two-dimensional har-
monic trapping potential. In Fig. 3(a), we again show
numerical results for the partition-function zeros usingsystem sizes in the range N= 2;:::; 20. In addition,
we show in Fig. 3(b) results obtained using the cumulant
method based on cumulants of the energy evaluated at
the inverse temperature marked with a cross on the real
axis. To determine the convergence points of the parti-
tion function zeros, we again use the scaling ansatz in
Eq. (25) and nd the extrapolated values indicated with
red circles in Fig. 3(b) and 3(c). Similar to the three-
dimensional trapping potential, the extrapolated conver-
gence point is in good agreement with the expected in-
verse transition temperature. However, we notice that
the convergence of the zeros to the real axis is slower
than for the three-dimensional case. Thus, the estima-
tion of the critical temperature is not as accurate for the
two-dimensional case as for the three-dimensional case.
C. One-dimensional trapping potential
The results for the harmonic potential in two and three
dimensions illustrate how the transition temperature can
be determined from the energy uctuations of fewer than
100 particles. As our last application, we consider bosons
in a one-dimensional harmonic trapping potential. In this
case, no phase transition is expected in the thermody-
namic limit. In particular, the partition function takes
on the simple expression [53]
ZN() =e~!0N(N 1)=4NY
k=1Z1(k); (26)
whereZ1() is the partition function for a single particle
in Eq. (8). We then see that the partition function for N
particles only has poles along the imaginary axis at
k;n=2
~!0n
ki;n=:::; 1;0;1;:::
k= 1;:::;N(27)
as shown in Fig. 4(a).7
PN
 (U)
200 1500.010.020.030.040.05
0100 50(a)
0
Im1
0
-1
Re1 0.5 1.52
-2(c)
N = 2,4,...,30N = 30N = 20N = 30,20,10N = 10
30
20
10
n10 0 15 54050
0(b)
U
(U      )log | |
FIG. 5. Partition-function zeros from energy uctuations. (a) Distributions PN(U) of the energy for a three-dimensional
harmonic potential with N= 10;20;30 particles. (b) Energy cumulants of orders n= 1;:::;14, obtained from 107Monte Carlo
simulations. (c) Partition-function zeros obtained by averaging over 1000 sets of Monte Carlo simulations are shown by solid
circles. The exact zeros are shown with open circles. For all of these calculations, the inverse temperature is = 1:15c.
In Fig. 4(b), we show the poles that are closest to
the origin obtained with the cumulant method for N=
2;:::; 6 bosons. We focus on the poles that are not ex-
actly at the origin and have thus multiplied the partition
function in Eq. (8) by to eliminate the pole at = 0.
As expected, we nd no zeros or poles away from the
imaginary axis in the complex plane of the inverse tem-
perature, which implies that there is no phase transition
in the thermodynamic limit. In Fig. 4(c), we investigate
the real and (negative) imaginary parts of the poles as
a function of the inverse particle number to extrapolate
their position in the thermodynamic limit. In agreement
with Eq. (27), we nd that the pair of poles that are
closest to the origin converge towards the origin as the
number of bosons is increased. With this example we see
that the cumulant method correctly predicts that there
is no phase transition in the thermodynamic limit.
V. ENERGY FLUCTUATIONS
Finally, we show how the zeros can be determined from
simulated uctuations of the energy, which we generate
using a Monte Carlo method (and which, in principle,
are measurable). For the simulations, we need the prob-
abilityPN(Um) thatNbosons inddimensions have the
energyUm= (m+Nd=2)~!0withm= 0;1;2;:::. To
this end, we write the partition function as
ZN() =1X
m=0Gme Um; (28)
where the degeneracy Gmenters the probabilities as
PN(Um) =Gme Um
ZN(): (29)
We also renormalize the partition function as
zN() =e~!0Nd=2ZN(); (30)and can then dene the probability-generating function
GN(v) =zN( lnv=~!0)
zN()=X
mPN(Um)vm;(31)
having introduced the variable v=e ~!0. The gener-
ating function can be inverted for the probabilities as
PN(Um) =1
2iI
CdvGN(v)
vm+1; (32)
whereCis a positively oriented circle that is centered
around the origin with a radius that is smaller than 1.
To nd the probabilities in a numerically stable manner,
we use the scheme from Refs. [61, 62] for the inversion of
probability generating functions. We then have
PN(Um)'1
2mrm
r[GN(r) ( 1)mGN( r)]
+ 2m 1X
j=1( 1)jRe[reij=mGN(reij=m)]
;(33)
where 0< r < 1 is a small parameter, which ensures
that deviations from the exact values are smaller than
r2m=(1 r2m) [61]. We use r= 10 10=(2m)in all calcu-
lations, so that the deviations are smaller than 10 10.
In Fig. 5(a), we show energy distributions for dier-
ent numbers of particles in a three-dimensional trapping
potential. As one would expect, the distributions shift
towards higher energies as the number of particles is in-
creased. We use these distributions as the starting point
for our Monte Carlo simulations, where we simulate 107
measurements of the energy. From these simulations, we
then obtain the high cumulants in Fig. 5(b). Next, using
the cumulant method, we extract the partition function
zeros, shown with solid circles in Fig. 5(c). These zeros
were obtained by averaging over 1000 sets of simulations.
For the sake of comparison, we also show the exact ze-
ros with open circles, and we see that the Monte Carlo
simulations agree well with the exact results. We note
that cumulants of very high orders have been measured
for electron tunneling through quantum dots [40, 63].8
VI. CONCLUSIONS AND OUTLOOK
In conclusion, we have presented a Lee-Yang theory of
Bose-Einstein condensation and used a cumulant method
to predict the condensation temperature from the energy
uctuations of fewer than 100 bosons. For harmonic trap-
ping potentials in two and three dimensions, we obtained
predictions of the condensation temperature in the ther-
modynamic limit of many particles and large volumes,
which agree well with known results. Moreover, for a one-
dimensional trapping potential, we found no phase tran-
sition in the thermodynamic limit as one would expect.
Our approach is directly related to observables that, in
principle, are measurable, namely the uctuations of the
energy, and it thereby provides a link between experi-
mental observations and the Lee-Yang theory of phase
transitions. We have illustrated our methodology with
noninteracting particles. However, our approach would
work equally well for interacting particles as long the uc-
tuations of the energy are accessible. Potentially, with
further renements, our method could also be applied to
nonequilibrium Bose-Einstein condensates [64{66]. The
cumulant method has already been realized in experi-
ments on electron tunneling [40], and one may hope that
it can also be implemented for cold atoms with a small
and controllable number of bosons.
ACKNOWLEDGMENTS
This work was supported by the Academy of Fin-
land through the Finnish Centre of Excellence in Quan-
tum Technology (Projects No. 312057 and No. 312299)
and Grants No. 318937 and No. 331737. The work was
also supported by the Medical Research Council (Grant
No. MR/S034714/1) and the Engineering and Physical
Sciences Research Council (Grant No. EP/V031201/1).
T.P. acknowledges support from the Nokia Industrial
Doctoral School in Quantum Technology. K.B. ac-
knowledges support from the University of Nottingham
through a Nottingham Research Fellowship.
Appendix A: Bose-Einstein condensation of a nite
number of particles
Typically, phase transitions are associated with a non-
analytic behavior of the free energy, which emerges in
the thermodynamic limit of many particles and large
volumes. While Bose-Einstein condensation in two- and
three-dimensional harmonic potentials is consistent with
this picture, the case of a one-dimensional harmonic trap-
ping potential is dierent, and no singularities appear in
the thermodynamic limit. Nevertheless, as discussed in
Refs. [51, 52], for a nite number of particles the ground
state may still become macroscopically occupied below
a certain temperature, which resembles the behavior of
the two- and three-dimensional potentials. To see this,we consider the grand-canonical ensemble and relate the
average number of particles to the fugacity as
N=z
1 z+Lid(z)
(~!0)d; (A1)
where the rst term is the occupation of the ground state.
The fraction of particles in the ground state then becomes
N0
N=1
Nz
1 z; (A2)
where the fugacity is obtained by solving Eq. (A1) for the
fugacity in terms of the particle number N. Moreover, in
the thermodynamic limit, the fraction can be written as
N0
N= 1 (T=Tc)d; TTc; (A3)
whereTcford= 2;3 is given by Eq. (5) and for d= 1,
Tc=~!0
kBN
lnN: (A4)
Equation (A4) follows from the assumption that the
ground-state population N0is macroscopic, i.e., on the
order ofN, which leads to the chemical potential ap-
proaching the ground-state energy. Hence, we can
expand Eqs. (A1) and (A2) around small values of
1 and take the limit of large Nto arrive at
Eqs. (A3) and (A4).
Importantly, the transition temperature remains nite
in two and three dimensions since the product !d
0N
is kept constant in the thermodynamic limit. By con-
trast, the transition temperature goes to zero for the one-
dimensional potential because of the logarithmic term
in the denominator. For this reason, there is no Bose-
Einstein condensation for the one-dimensional harmonic
potential in the thermodynamic limit. On the other
hand, for a nite number of particles, the temperature
in Eq. (A4) is nite, and the fraction of particles in the
ground state can become large as illustrated in Fig. 6. We
note that similar gures can be found in Refs. [51, 52].
Appendix B: Finite-size correction to the transition
temperature for the three-dimensional trap
The condensation temperature in Eq. (5) can be mod-
ied to account for the system having a nite number of
particles. To this end, we note that the energy levels,
E=~!0(nx+ny+nz+ 3=2);ni= 0;1;2:::; (B1)
of the three-dimensional harmonic potential are degener-
ate with the degeneracy factors,
gn=1
2(n+ 1)(n+ 2); (B2)9
T/Tc(b)
0 0.5 1 1.5 2
T/Tc(c)
0 0.5 1 1.5 2
T/Tc3D 2D 1DN0 /N
00.20.40.60.81(a)
0 0.5 1 1.5 2N = 10
N = 102
N = 103
N â†’ âˆžN = 108
FIG. 6. Bose-Einstein condensation of a nite number of particles. We show the fraction of particles in the ground state as a
function of the temperature and with dierent numbers of particles in the trapping potential. The three panels correspond to
dierent dimensions, and the temperature Tcdepends on the number of particles according to Eqs. (5), (24), and (A4). The
black lines are given by Eq. (A3), which holds in the thermodynamic limit. For all three dimensions, the fraction of particles
in the ground state can become large with a nite number of particles. However, for the one-dimensional trapping potential,
the transition temperature Tcgoes to zero in the thermodynamic limit, and there is no phase transition.
wheren=nx+ny+nz. The average particle number
can then be expressed as
N=1X
n=0gnNn'N0+Z1
0dngnNn; (B3)
whereNn= (e~!0n 1) 1is a Bose-Einstein factor, and
N0= Li 0(z) is the ground-state population. Evaluatingthe integral, we nd
N= Li 0(z) +Li1(z)
(~!0)+3
2Li2(z)
(~!0)2+Li3(z)
(~!0)3;(B4)
where the last two terms, which involve only contribu-
tions from the excited states in the integral of Eq. (B3),
dominate above the critical temperature. Ignoring the
rst two terms in Eq. (B4) and taking the limit z!1 as
was done in Sec. II to nd the condensation temperature
in the thermodynamic limit, we nd an equation for Tc,
which can be rearranged to arrive at Eq. (24). We note
that there is not a similar correction to the transition
temperature for the two-dimensional trapping potential.
[1] E. A. Cornell and C. E. Wieman, Nobel Lecture: Bose-
Einstein condensation in a dilute gas, the rst 70 years
and some recent experiments, Rev. Mod. Phys. 74, 875
(2002).
[2] C. J. Pethick and H. Smith, Bose{Einstein Condensation
in Dilute Gases , 2nd ed. (Cambridge University Press,
Cambridge, 2008).
[3] M. H. Anderson, J. R. Ensher, M. R. Matthews, C. E.
Wieman, and E. A. Cornell, Observation of Bose-Einstein
condensation in a dilute atomic vapor, Science 269, 198
(1995).
[4] K. B. Davis, M. O. Mewes, M. R. Andrews, N. J. van
Druten, D. S. Durfee, D. M. Kurn, and W. Ketterle,
Bose-Einstein Condensation in a Gas of Sodium Atoms,
Phys. Rev. Lett. 75, 3969 (1995).
[5] T. Byrnes, K. Wen, and Y. Yamamoto, Macroscopic
quantum computation using Bose-Einstein condensates,
Phys. Rev. A 85, 040306 (2012).
[6] D. N. Aguilera et al., STE-QUEST | Test of the univer-
sality of free fall using cold atom interferometry, Classical
Quantum Gravity 31, 115010 (2014).[7] N. M. Myers, F. J. Pe~ na, O. Negrete, P. Vargas, G. D.
Chiara, and S.Dener, Boosting engine performance with
Bose{Einstein condensation, New J. Phys. 24, 025001
(2022).
[8] J. Eglinton, T. Pyh aranta, K. Saito, and K. Brandner,
Thermodynamic geometry of ideal quantum gases: a gen-
eral framework and a geometric picture of BEC-enhanced
heat engines, arXiv:2212.12076 (2022).
[9] S. J. Blundell and K. M. Blundell, Concepts in Thermal
Physics (Oxford University Press, Oxford, 2008).
[10] H. Deng, H. Haug, and Y. Yamamoto, Exciton-polariton
Bose-Einstein condensation, Rev. Mod. Phys. 82, 1489
(2010).
[11] T. K. Hakala, A. J. Moilanen, A. I. V akev ainen, R. Guo,
J.-P. Martikainen, K. S. Daskalakis, H. T. Rekola,
A. Julku, and P. T orm a, Bose{Einstein condensation in
a plasmonic lattice, Nat. Phys. 14, 739 (2018).
[12] T. Giamarchi, C. R uegg, and O. Tchernyshyov,
Bose{Einstein condensation in magnetic insulators, Nat.
Phys. 4, 198 (2008).10
[13] S. O. Demokritov, V. E. Demidov, O. Dzyapko, G. A.
Melkov, A. A. Serga, B. Hillebrands, and A. N.
Slavin, Bose{Einstein condensation of quasi-equilibrium
magnons at room temperature under pumping, Nature
443, 430 (2006).
[14] D. Chandler, Introduction to Modern Statistical Mechan-
ics(Oxford University Press, New York, 1987).
[15] N. Goldenfeld, Lectures on Phase Transitions and the
Renormalization Group (Westview, Boulder, 1992).
[16] M. Kardar, Statistical Physics of Fields (Cambridge Uni-
versity Press, Cambridge, 2007).
[17] C. N. Yang and T. D. Lee, Statistical Theory of Equa-
tions of State and Phase Transitions. I. Theory of Con-
densation, Phys. Rev. 87, 404 (1952).
[18] T. D. Lee and C. N. Yang, Statistical Theory of Equa-
tions of State and Phase Transitions. II. Lattice Gas and
Ising Model, Phys. Rev. 87, 410 (1952).
[19] R. A. Blythe and M. R. Evans, Lee-Yang Zeros and Phase
Transitions in Nonequilibrium Steady States, Phys. Rev.
Lett. 89, 080601 (2002).
[20] I. Bena, M. Droz, and A. Lipowski, Statistical mechan-
ics of equilibrium and nonequilibrium phase transitions:
The Yang-Lee formalism, Int. J. Mod. Phys. B 19, 4269
(2005).
[21] M. E. Fisher, Yang-Lee Edge Singularity and 3Field
Theory, Phys. Rev. Lett. 40, 1610 (1978).
[22] R. Kenna and C. B. Lang, Scaling and density of Lee-
Yang zeros in the four-dimensional Ising model, Phys.
Rev. E 49, 5012 (1994).
[23] M. Biskup, C. Borgs, J. T. Chayes, L. J. Kleinwaks, and
R. Koteck y, General Theory of Lee-Yang Zeros in Models
with First-Order Phase Transitions, Phys. Rev. Lett. 84,
4794 (2000).
[24] P. F. Arndt, Yang-Lee Theory for a Nonequilibrium
Phase Transition, Phys. Rev. Lett. 84, 814 (2000).
[25] S.-Y. Kim, Yang-Lee Zeros of the Antiferromagnetic Ising
Model, Phys. Rev. Lett. 93, 130604 (2004).
[26] R. G. Ghulghazaryan, K. G. Sargsyan, and N. S.
Ananikian, Partition function zeros of the one-
dimensional Blume-Capel model in transfer matrix for-
malism, Phys. Rev. E 76, 021104 (2007).
[27] J. Lee, Exact Partition Function Zeros of the Wako-
Sait^ o-Mu~ noz-Eaton Protein Model, Phys. Rev. Lett. 110,
248101 (2013).
[28] B.-B. Wei, S.-W. Chen, H.-C. Po, and R.-B. Liu, Phase
transitions in the complex plane of physical parameters,
Sci. Rep. 4, 5202 (2014).
[29] R. Kenna and B. Berche, Fisher's scaling relation above
the upper critical dimension, EPL 105, 26005 (2014).
[30] A. Garc a-Saez and T.-C. Wei, Density of Yang-Lee zeros
in the thermodynamic limit from tensor network meth-
ods, Phys. Rev. B 92, 125132 (2015).
[31] M. Krasnytska, B. Berche, Y. Holovatch, and R. Kenna,
Violation of Lee-Yang circle theorem for Ising phase tran-
sitions on complex networks, EPL 111, 60009 (2015).
[32] K. P. Gnatenko, A. Kargol, and V. M. Tkachuk, Two-
time correlation functions and the Lee-Yang zeros for an
interacting Bose gas, Phys. Rev. E 96, 032116 (2017).
[33] A. R. Kuzmak and V. M. Tkachuk, Detecting the Lee-
Yang zeros of a high-spin system by the evolution of
probe spin, EPL 125, 10004 (2019).
[34] M. Giordano, K. Kapas, S. D. Katz, D. Nogradi, and
A. Pasztor, Radius of convergence in lattice QCD at nite
Bwith rooted staggered fermions, Phys. Rev. D 101,074511 (2020).
[35] N. Matsumoto, M. Nakagawa, and M. Ueda, Embedding
the Yang-Lee quantum criticality in open quantum sys-
tems, Phys. Rev. Res. 4, 033250 (2022).
[36] C. Binek, Density of Zeros on the Lee-Yang Circle Ob-
tained from Magnetization Data of a Two-Dimensional
Ising Ferromagnet, Phys. Rev. Lett. 81, 5644 (1998).
[37] B.-B. Wei and R.-B. Liu, Lee-Yang Zeros and Critical
Times in Decoherence of a Probe Spin Coupled to a Bath,
Phys. Rev. Lett. 109, 185701 (2012).
[38] X. Peng, H. Zhou, B.-B. Wei, J. Cui, J. Du, and R.-B.
Liu, Experimental Observation of Lee-Yang Zeros, Phys.
Rev. Lett. 114, 010601 (2015).
[39] C. Flindt and J. P. Garrahan, Trajectory Phase Tran-
sitions, Lee-Yang Zeros, and High-Order Cumulants in
Full Counting Statistics, Phys. Rev. Lett. 110, 050601
(2013).
[40] K. Brandner, V. F. Maisi, J. P. Pekola, J. P. Garrahan,
and C. Flindt, Experimental Determination of Dynami-
cal Lee-Yang Zeros, Phys. Rev. Lett. 118, 180601 (2017).
[41] A. Deger, K. Brandner, and C. Flindt, Lee-Yang zeros
and large-deviation statistics of a molecular zipper, Phys.
Rev. E 97, 012115 (2018).
[42] A. Deger and C. Flindt, Determination of universal criti-
cal exponents using Lee-Yang theory, Phys. Rev. Res. 1,
023004 (2019).
[43] A. Deger and C. Flindt, Lee-Yang theory of the Curie-
Weiss model and its rare uctuations, Phys. Rev. Res. 2,
033009 (2020).
[44] A. Deger, F. Brange, and C. Flindt, Lee-Yang theory,
high cumulants, and large-deviation statistics of the mag-
netization in the Ising model, Phys. Rev. B 102, 174418
(2020).
[45] F. Brange, A. Deger, and C. Flindt, Nonequilibrium
phase transition in a single-electron micromaser, Phys.
Rev. B 105, 155421 (2022).
[46] T. Kist, J. L. Lado, and C. Flindt, Lee-Yang theory of
criticality in interacting quantum many-body systems,
Phys. Rev. Res. 3, 033206 (2021).
[47] P. M. Vecsei, J. L. Lado, and C. Flindt, Lee-Yang theory
of the two-dimensional quantum Ising model, Phys. Rev.
B106, 054402 (2022).
[48] P. M. Vecsei, C. Flindt, and J. L. Lado, Lee-Yang the-
ory of quantum phase transitions with neural network
quantum states, arXiv:2301.09923 (2023).
[49] S. Peotta, F. Brange, A. Deger, T. Ojanen, and C. Flindt,
Determination of Dynamical Quantum Phase Transi-
tions in Strongly Correlated Many-Body Systems Using
Loschmidt Cumulants, Phys. Rev. X 11, 041018 (2021).
[50] F. Brange, S. Peotta, C. Flindt, and T. Ojanen, Dynami-
cal quantum phase transitions in strongly correlated two-
dimensional spin lattices following a quench, Phys. Rev.
Res.4, 033032 (2022).
[51] W. Ketterle and N. J. van Druten, Bose-Einstein conden-
sation of a nite number of particles trapped in one or
three dimensions, Phys. Rev. A 54, 656 (1996).
[52] W. J. Mullin, Bose-Einstein condensation in a harmonic
potential, J. Low Temp: Phys. 106, 615 (1997).
[53] W. J. Mullin and J. P. Fern andez, Bose{Einstein conden-
sation, uctuations, and recurrence relations in statistical
mechanics, Am. J. Phys. 71, 661 (2003).
[54] H.-J. Schmidt and J. Schnack, Investigations on nite
ideal quantum gases, Phys. A 260, 479 (1998).11
[55] H.-J. Schmidt and J. Schnack, Thermodynamic
fermion{boson symmetry in harmonic oscillator poten-
tials, Phys. A 265, 584 (1999).
[56] P. Borrmann, O. M ulken, and J. Harting, Classication
of Phase Transitions in Small Systems, Phys. Rev. Lett.
84, 3511 (2000).
[57] O. M ulken, P. Borrmann, J. Harting, and H. Stamerjo-
hanns, Classication of phase transitions of nite bose-
einstein condensates in power-law traps by Fisher zeros,
Phys. Rev. A 64, 013611 (2001).
[58] W. van Dijk, C. Lobo, A. MacDonald, and R. K. Bhaduri,
Fisher zeros of a unitary Bose gas, Can. J. Phys. 93, 830
(2015).
[59] F. Brange, P. Menczel, and C. Flindt, Photon counting
statistics of a microwave cavity, Phys. Rev. B 99, 085418
(2019).
[60] G. B. Arfken, H. J. Weber, and F. E. Harris, Mathe-
matical Methods for Physicists: A Comprehensive Guide
(Academic Press, 2012).[61] J. Abate and W. Whitt, Numerical inversion of probabil-
ity generating functions, Oper. Res. Lett. 12, 245 (1992).
[62] D. Kambly, Counting statistics in interacting nano-scale
conductors , Ph.D. thesis, 2014.
[63] C. Flindt, C. Fricke, F. Hohls, T. Novotn y, K. Neto cn y,
T. Brandes, and R. J. Haug, Universal oscillations in
counting statistics, Proc. Natl. Acad. Sci. USA 106,
10116 (2009).
[64] D. Vorberg, W. Wustmann, R. Ketzmerick, and
A. Eckardt, Generalized Bose-Einstein Condensation into
Multiple States in Driven-Dissipative Systems, Phys.
Rev. Lett. 111, 240405 (2013).
[65] A. Schnell, D. Vorberg, R. Ketzmerick, and A. Eckardt,
High-Temperature Nonequilibrium Bose Condensation
Induced by a Hot Needle, Phys. Rev. Lett. 119, 140602
(2017).
[66] A. Schnell, R. Ketzmerick, and A. Eckardt, On the num-
ber of Bose-selected modes in driven-dissipative ideal
Bose gases, Phys. Rev. E 97, 032136 (2018).