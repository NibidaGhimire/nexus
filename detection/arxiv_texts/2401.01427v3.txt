Nash Equilibria in Greenhouse Gas Offset Credit Markets
Liam Welsh∗
Department of Statistical Sciences,
University of Toronto
Sebastian Jaimungal†
Department of Statistical Sciences,
University of Toronto
&
Oxford-Man Institute for Quantitative Finance,
University of Oxford
June 19, 2024
Abstract
One approach to reducing greenhouse gas (GHG) emissions is to incentivize carbon
capturing and carbon reducing projects while simultaneously penalising excess GHG out-
put. In this work, we present a novel market framework and characterise the optimal
behaviour of GHG offset credit (OC) market participants in both single-player and two-
player settings. The single player setting is posed as an optimal stopping and control prob-
lem, while the two-player setting is posed as optimal stopping and mixed-Nash equilibria
problem. We demonstrate the importance of acting optimally using numerical solutions
and Monte Carlo simulations and explore the differences between the homogeneous and
heterogeneous players. In both settings, we find that market participants benefit from
optimal OC trading and OC generation.
∗liam.welsh@mail.utoronto.ca
†sebastian.jaimungal@utoronto.ca
1arXiv:2401.01427v3  [q-fin.GN]  18 Jun 20241 Introduction
Severe impacts of man-made climate change are being experienced worldwide, caused by pollu-
tion and excess emissions since the industrial revolution. In an attempt to limit the damage of
climate change, nations around the world have been organising and establishing international
treaties, including the Kyoto Protocol in 1997, the Paris Agreement in 2015, and the Glasgow
Climate Pact in 2021. These treaties aim to limit greenhouse gas (GHG) pollution, increase
financing opportunities for developing nations to adopt climate friendly policy, and spur the
development of green technologies. One tool that nations can use to curb GHG emissions is
to implement carbon taxes or establish emissions markets. This work focuses on the latter,
specifically the Canadian GHG Offset Credit (OC) market where market participants can earn
OCs by implementing projects that reduce or capture GHG emissions. These OCs may then
be used to offset excess emissions or may be sold to other firms.
Given the pressing nature of climate change and the popularity of climate finance, the result-
ing extant literature is growing, particularly for climate, energy, and emissions based financial
derivatives.In many countries, including Canada (Government of Canada (2022c, 2023)), im-
pose their own carbon prices internally. While many regions are pricing carbon emissions
locally, there lacks an agreed upon global floor price for carbon which could further incentivize
emission reductions (International Monetary Fund (2022)). In fact, there are over sixty carbon
pricing instruments worldwide to control carbon emissions, including emission markets and
carbon taxes, covering 21% of GHG emissions (Santikarn et al. (2021)). However, only 4% are
valuing carbon emissions at a level inline with the Paris Agreement to meet the 2◦C limit.
GHG OC markets can often be structured as carbon cap-&-trade (C&T) markets, of which
there is considerable literature. Seifert et al. (2008) describe firm behaviour as the solution to
an optimal control problem in a single period C&T market, and further solve for the carbon
allowance price process. This is extended by Hitzemann and Uhrig-Homburg (2018) to allow for
a multi-period model. Howison and Schwarz (2012) presents a risk-neutral pricing framework
for emissions markets derivatives, while Carmona et al. (2009) analyses a player’s optimal
behaviour in carbon markets and further scrutinise the potential pitfalls of emission markets.
More recent work by Carmona et al. (2022) investigate how carbon taxes influence energy
producers’ production methods in a mean-field setting. The authors incorporate social external
negativity of carbon emissions in their model to achieve both a Nash equilibrium and what
they deem to be a social optimum . The notion of utilising social impact with regards to climate
finance is not uncommon. In particular, Kiesel and Stahl (2022) manages climate change risk
via an uncertainty-based framework, such that the authors claim capital-based risk measures
are unable to properly capture the deep uncertainties induced by climate change. Kenyon
et al. (2022) introduce a carbon equivalence principle to allow for better market alignment
for CO 2e based derivatives for improved coherence in emissions markets. In green derivatives
research, Amundsen et al. (2006) analyses price volatility models of renewable energy certificates
(RECs) in the context of energy. REC markets and green certificate markets are closely related
alternatives to carbon emissions markets. Shrivats and Jaimungal (2020) characterises solar
2REC markets, which is then extended to a mean-field game setting in Shrivats et al. (2022)
and Firoozi et al. (2021). Hustveit et al. (2017) investigates green certificate markets from an
investors perspective, and find that with increased renewable energy penetration, the value of
green certificates will decline to zero despite their highly sensitive nature to energy generation
and consumption.
Here, we develop a novel framework that characterises player behaviour in a multi-player
GHG OC market in the form of a bi-matrix game. For our work, we employ techniques from
stochastic control theory for optimal stopping (Pham (2009)) and game theory (Fudenberg and
Tirole (1991); Osborne and Rubinstein (1994); Osborne et al. (2004)) to characterise optimal-
ity in player behaviour. When there are many players in a market, mean-field game (MFG)
(see Carmona et al. (2018); Huang et al. (2006, 2007); Lasry and Lions (2007)) may be used to
study approximations to Nash equilibria. Canada’s emissions market, however, is not highly
populated (Sadikman et al. (2022)), thus we do not proceed along a MFG approach. Instead,
we analyse a GHG OC market using traditional game theoretic approaches for two cases: single-
player and two-player. In the single-player setting, the player has the ability to choose when
to generate OCs through project investment. This leads to a combined sequence of stopping
and control problems and we solve the resulting quasi-variational inequality (QVI) using an
implicit-explicit finite-difference (FD) scheme. As OCs must converge to their marginal price at
the compliance date, we model OC price dynamics with a Brownian bridge. In the two-player
setting, both players can choose to trade or generate OCs, therefore, the QVI is replaced with
a bi-matrix game where each player’s decision has an impact on the other’s value. The induced
Nash equilibrium from the bi-matrix game provides insight as to how players behave when
presented with homogeneous and heterogeneous project opportunities. The approach we take
can be extended to a multiple player setting, however, there are computational issues that need
addressing to make it a viable approach. We also present simulations for both the single-player
and two-player markets, and compared against na¨ ıve strategies demonstrating the importance
of properly modelling players’ optimal behaviour. Liu et al. (2023), the closest work to ours,
formulates a single player optimal stopping problem to analyse when a firm should purchase a
carbon emission right for carbon asset management – akin to an American option. Our work
differs in multiple dimensions though, including the motivating setting, the single and multi-
player formulation (as we have sequences of combined stopping and control problems), and the
numerical experiments that we carry out.
The remainder of this paper is organised as follows. Necessary background information on
the GHG market in Canada and motivation is provided in Section 2. Section 3 introduces the
GHG OC market structure used throughout this paper. Section 4 presents the mathematical
model used in a single-player setting, with a numerical implementation and simulation results
in Sections 4.1 and 4.2, respectively. In Section 5, the two-player version of the market is
introduced, and the bi-matrix game is constructed. Section 5.1 and 5.2 contain the numerical
implementation and simulated results for the two-player setting, respectively. The two-player
model is then extended to a multi-period setting in Section 5.4. Concluding remarks and
3potential avenues of future research are provided in Section 6.
2 Background and Motivation
In Canada, GHG emissions (also referred to as carbon emissions) are regulated at both the
federal and provincial level. Provincial governments are allowed to implement their own GHG
emissions framework and market (e.g. a carbon price) with the caveat that it meets the min-
imum federal pricing standards and GHG reduction targets (Sadikman et al. (2022)). The
Canadian federal government has recently developed a new GHG OC system at the federal
level aimed at expanding project opportunities and streamlining the process ((Government of
Canada, 2022a; Sadikman et al., 2022)). This new system contains three main components: a
new regulations framework for OC generation; updated development protocols for methods to
quantify GHG reductions across various sectors; and an OC tracking and project registration
system. The updated framework is available for both regulated and unregulated firms. Any
firm may participate in the voluntary market, but regulated firms must take part in the compli-
ance market. We summarise the Canadian market structure below (see Government of Canada
(2022a,b,c, 2023); Sadikman et al. (2022)).
In the compliance market, firms are provided with an emissions limit in metric tonnes (Mt)
of carbon dioxide equivalent (CO 2e). A CO 2e is a predefined and common unit used for to
measure GHG emissions based on their warming potential, relative to CO 2. For example, one
tonne of methane has a global warming potential 25 times higher than that of CO 2, and hence
one tonne of methane is equivalent to 25 tonnes of CO 2. Firms that are under their emissions
limit receive surplus OCs equal to to the difference of their limit to their output. Firms that
exceed their emissions limit are penalised and can use acquired OCs to reduce or eliminate their
penalty. Penalised firms must either pay a fine or submit a combination of surplus and non-
surplus OCs. Non-surplus OCs, which are federally or provincially approved and regulated, can
be generated by the firm itself or purchased from other firms. In 2022, the federal government
set the excess GHG emissions penalty to $50 per MtCO 2e, and is increasing the penalty each
year a linear amount each year until 2030 when the penalty will reach $170 per MtCO 2e as a
method to financially motivate firms to generate OCs and participate in the GHG OC market.
OCs are certified financial derivatives distributed by a regulatory body that can be used by
regulated firms for compliance purposes. OCs are measured in tonnes of CO 2e, such that one OC
represents the removal (or reduction) of one tonne of CO 2e from the atmosphere or production
process. For these OCs, GHGs are converted using their warming potential back into CO 2to
allow for standardisation across OC markets. The purpose of GHG OC markets is to encourage
the development of GHG capturing and/or GHG reducing projects by GHG emitting firms, to
slow the destruction of climate change. OCs are generated via approval from a governing body
by reducing GHG emissions or by implementing and registering a GHG emissions reducing or
capturing project. These projects typically have investment costs associated. Project examples
include, but are not limited to, tree planting, capturing methane generated from landfills or
4livestock, composting, and updating machinery to more efficient and less polluting models.
OCs can be invalidated after their creation if it was found that the OCs were issued under
incorrect information. The regulating entity typically requires that these be replaced, thus an
additional investment must be made by the firm in order to comply. Hence, an OC represents a
verifiable receipt that either GHGs emissions have been reduced or GHGs have been captured
from the atmosphere. On a compliance date, firms that exceed their emissions limit over
the corresponding compliance period submit acquired OCs to the regulatory body to mitigate
their financial penalty. OCs that are generated in the voluntary market cannot be used for
regulatory purposes. As such, OCs that are generated in the compliance market typically trade
at a premium over their voluntary market counterparts. Compliance market OCs remain viable
for regulatory purposes for eight calendar years from the date of their creation.
Both regulated and unregulated firms can generate and trade OCs. While regulated firms
that take part in the compulsory market must abide by certain regulations or else face a
penalty, unregulated firms can participate in the voluntary market. The motivation for un-
regulated firms to participate (and potentially invest in OC generation) can come from, but
is not limited to, internal emission reduction commitments, ESG and other altruistic goals,
or customer and investor pressure. In 2023, the federal government began accepting and reg-
istering GHG OC generating projects. Due to the recency of this market’s inception, there
is currently limited data available, and as of February 2024, only one project has been reg-
istered and verified (Government of Canada, 2024). Provincial markets, however, have been
established for many years, including British Columbia’s (BCs) and Qu´ ebec’s. Between the
years of 2010 and 2022 in BC, 8.7 million tonnes of CO 2e were offset from the public sector by
OCs generated within the province through registered and verified OC projects (Government
of British Columbia, 2024), while in Qu´ ebec, over 1.5 million OCs were issued between Jan-
uary 2014 and March 2024 for projects including landfill methane reclamation/destruction and
halocarbon destruction (Gouvernement du Qu´ ebec, 2024).
The voluntary market in Canada is gaining traction, due to carbon neutrality goals set by
many major banks, energy and natural resource firms, and public institutions. Hence, demand
for OCs in the voluntary market is increasing. OCs that are generated in the voluntary market
typically trade at a discount to those traded in the compliance market as the validating bodies
may not meet the rigorous standards of the provincial or federal agencies. As such, not all
voluntarily produced OCs may eligible to be used for compliance purposes. Unregulated firms
may generate OCs that can be used for compliance purposes, assuming project and validating
requirements were met. We analyse regulated firms participating in the compliance market.
This choice is made for two reasons: (1) the goals of unregulated firms greatly vary within
the voluntary market and are dependent on each firms reason for participation; and (2) due
to the possibility of financial penalties, regulated firms are incentivized to take part in this
market. These firms have the choice between investing in GHG reducing or capturing projects
and trading for OCs on the market, inducing a game structure to the market model.
53 Offset Credit Market Model
We assume the following structure for our GHG OC market model. A firm (i.e. player) that
participates in the market may be regulated or unregulated. Regulated firms (i.e. firms with
emission thresholds) are required to participate in this market. This type of firm has a maximum
threshold of emissions that if it exceeds, the firm faces a financial penalty. In our setting, we
assume that a regulated firm has an emission limit in units of MtCO 2e at the end of a regulatory
period at time T. Excess emissions over this limit, denoted by R, must be covered using OCs.
Any OC shortfall from R(and above the emissions limit) is penalised. We assume Rto be
deterministic and exogenously determined. Throughout this work, we refer to Ras the OC
requirement, as a player requires a terminal inventory of ROCs to completely eliminate their
penalty. The penalty structure implemented in Canada is linear and the penalty value per
emission excess is growing each year (Sadikman et al., 2022). Thus, we impose a penalty
structure at the end of a compliance period of
G(x) :=−p(R−x)+, (1)
where y+:= max( y,0) and xrepresents a firm’s OC inventory. It is possible that the terminal
penalty can take a variety of forms depending on the market regulations. In the terminal penalty
above, a firm is penalised a fixed value pper unit of OC shortfall (i.e. a linear penalty structure).
Unregulated firms do not have to meet some minimum threshold of OC inventory. As such, the
terminal value can take a more diverse array of possibilities that may incorporate social benefits
or public relations metrics. The structure of the terminal value for an unregulated firm can
vary largely depending on a firms goals, products, and/or clientele. Alternatively, the market
can be structured such that it does not penalise inaction, but instead rewards participation.
Using this style of terminal preferences can apply to both regulated and unregulated firms. A
(monetary) reward can be given to firms for each OC they hold at the end of some period,
either up to some maximum threshold or a diminishing value structure can be employed. The
flexibility of this choice can allow market makers and legislators to analyse the potential impact
on firms’ behaviours.
A firm’s OCs may either be generated by approval from a regulatory body through project
investment or can be bought and/or sold on the GHG OC market. We assume that at all
instances in time t∈[0, T], a firm may generate OCs. In particular, the firm aims to decide
on the rate of OC investment and the sequence of times at which it will invest in an eligible
project. A firm may also trade OCs throughout the entire period, and the decision to generate
does not impact their ability to trade. The single and two-player versions of the problem are
analysed in Sections 4 and 5, respectively.
We work on a completed and filtered probability space (Ω ,F,(Ft)t∈[0,T],P), on which the
OC spot price is denoted S= (St)t∈[0,T], and ( Ft)t∈[0,T]is the natural filtration generated by
S. The firm’s OC inventory process is defined as X= (Xt)t∈[0,T]. A firm can trade at rate
ν= (νt)t∈[0,T], such that ν∈ V where Vis the set of admissible trading rates consisting of
6F-predictable process such that E[RT
0ν2
tdt]<∞. A positive (negative) rate corresponds to
buying (selling) OCs. From the purchase and sale of OCs the firm obtains a total reward of
−RT
0Stνtdt. We further apply a trading friction in the form of a stylised transaction cost of
κ
2RT
0ν2
tdt. This results in firms mitigating the speed at which they trade, and it may represent
a combination of real and fictitious costs. While we specify a quadratic stylised transaction cost,
any convex function of νtcan be used to impose such a constraint. The firm’s OC inventory
between times at which it invests satisfies the ODE dXt=νtdt.
We assume that a firm has a fixed generation capacity of ξ, such that if a firm chooses
to generate at time τ∈[0, T], their inventory jumps by ξ, so that Xτ=Xτ−+ξ, where
Xt−:= lim s↑tXs. The cost of generating these OCs is denoted c. As the generation of OCs
increases the possible trading volume, it is natural to include a price impact to the OC spot
price in the event a firm generates. This price impact parameter is denoted η. Thus, if a firm
generates ξ-many OCs at time t∈[0, T], then the OC spot price jumps such that Sτ=Sτ−−η ξ.
In the sequel, we denote the set of F-stopping times by T.
Next, we specify the dynamics of the OC spot price. In particular, we choose to model the
price as a Brownian bridge, such that at Tthe spot price equals the marginal price of an OC
induced by the penalty given in (1). Therefore, Ssatisfies the SDE
dSt=p−St
T−tdt+σ dW t, (2)
where σis the volatility of the OC spot price and W= (Wt)t∈[0,T]is a standard P-Brownian
motion.
The choice of dynamics for the OC price forces the value of the OC spot price at time t=T
to be equal to the penalty value pand the OC price also converges to the penalty value pas
t→T, thus avoiding any potential arbitrage opportunity that firms may take advantage of.
For instance, under other OC price dynamics (such as geometric Brownian motion), the OC
spot price an instant prior to the terminal time could exceed the penalty value ( ST−> p), such
that a player would sell their OC inventory as they can generate more value from selling their
inventory and accepting the penalty than by using their inventory for regulatory purposes. In
a multiplayer scenario, players share a common noise due to the stochasticity of the OC price.
We assume that no trading or generating can take place at the terminal time t=T, hence
any OCs that are to be used for regulatory purposes must be procured prior to the regulatory
date. Moreover, any excess OCs after submitting to the required amount to regulator expire
worthless.
4 Single-Player Setting
In this section, we analyse how a single player participating in this market will optimally behave.
This player has the capacity to generate ξ-many OCs at a cost of c. The player’s terminal
value V(T, x, s ), where Vis the player’s value, is determined by the terminal penalty function,
7G(x) =−p(R−x)+. The player optimises over trading speed ν∈ Vand over an increasing
sequence of F-stopping times τ= (τi)i∈N, i.e., τi∈ T, for all i∈Nandτ1< τ2< . . . . The
sequence of stopping times represents the times at which the player invests in a green project.
The player’s performance criterion may be stated as
E
G(XT)−ZT
0Suνudu−κ
2ZT
0ν2
udu−X
i∈N1τi≤Tc
. (3)
The first term represents the regulatory penalty, the second term represents the trading costs,
the third term represents the stylised transaction cost, and the fourth term represents the total
generation costs.
As per the dynamic programming principle (DPP), to optimise the criterion over all ν∈ V
andτ∈ T, we introduce the value of an arbitrary strategy starting at an arbitrary point in
time t∈[0, T] at an arbitrary point in state space Xt−=x, S t−=s, which we denote by
Jν,τ(t, x, s ) :=Et,x,s"
G(XT)−ZT
tSuνudu−κ
2ZT
tν2
udu−X
i∈N1t≤τi≤Tc#
. (4)
Here, Et,x,s[·] denotes conditional expectation given that Xt−=x, S t−=s. Let k:= min {i:
τi> t}, then, by iterated expectations, we may also write
Jν,τ(t, x, s ) :=Et,x,s"
−Zτk∧T
tSuνudu−κ
2Zτk∧T
tν2
udu
+
Jν,τ
τk, Xτ−
k+ξ, Sτ−
k−η ξ
−c
1{τk≤T}#
.(5)
Next, define the value function as V(t, x, s ) = supν∈V,τ∈TJν,τ(t, x, s ). Applying the DPP
for stopping and control problems (see Pham (2009)), the value function is the unique viscosity
solution of the QVI
max(
∂tV(t, x, s ) + sup
v∈R
−v s−κ
2v2+v ∂xV(t, x, s ) +p−s
T−t∂sV(t, x, s ) +σ2
2∂ssV(t, x, s )
;
 
V(t, x+ξ, s−η ξ)−c
−V(t, x, s ))
= 0,
(6)
subject to the terminal condition V(T, x, s ) =G(x).
The continuation component of the QVI results in the player’s optimal trading behaviour,
while the second component of the QVI represents the change in the value function when they
generate OCs which induces a change in the OC inventory and the asset price, as well as
incurring a cost.
8From the form above, we may solve for the optimal trade rate vin feedback form as
v∗(t, x, s ) =1
κ(∂xV(t, x, s )−s). (7)
Substituting v∗into the QVI (6) results in the value function satisfying
max(
∂tV(t, x, s ) +1
2κ 
∂xV(t, x, s )−s2+p−s
T−t∂sV(t, x, s ) +σ2
2∂ssV(t, x, s ) ;
 
V(t, x+ξ, s−η ξ)−c
−V(t, x, s ))
= 0,(8)
subject to the terminal condition V(T, x, s ) =G(x). This QVI does not admit a closed form
solution. Instead, we develop a numerical scheme for approximating the optimal solution in
the following section.
4.1 Numerical Implementation
Numerically approximating the optimal solution of (8) requires the estimation of two PDE
solutions, which are derived from the value of a player trading and the value of a player
generating. To develop the appropriate PDEs, we discretise time and write the time grid
as{0,∆t,2∆t, . . . , N ∆t=T}and denote ti:=i∆t.
First, we denote the value in the continuation region (i.e., trading) as U. From the dynamic
programming principal, for t∈[tk−1, tk],Uis given by
U(t, x, s ) = sup
ν∈VEt,x,s
V(tk, Xtk, Stk)−Ztk
tSuνudu−κ
2Ztk
tν2
udu
. (9)
The optimised profit functional (9) elicits the same form of the continuation component in (8).
Through Feynman-Kac, Usatisfies the PDE
0 =∂tU(t, x, s ) +1
2κ(∂xU(t, x, s )−s)2+p−s
T−t∂sU(t, x, s ) +σ2
2∂ssU(t, x, s ), (10)
for all t∈[tk−1, tk], and subject to terminal condition U(tk, x, s) =V(tk, x, s).
The player chooses whether or not to generate OCs, hence, the value function at t=tk−1
is given by
V(tk−1, x, s) = max {U(tk−1, x, s),(U(tk−1, x+ξ, s−η ξ)−c)} (11)
with terminal condition V(T, x, s ) =G(x).
To estimate the solution of (10) and solve (11), we implement an FD scheme that is implicit
with respect to the OC price sand explicit with respect to player’s inventory x. This structure
is chosen as it avoids numerical instabilities that arise when tis close to the terminal time
Tresulting from the Brownian bridge dynamics. We construct spatial grid x1, . . . , x Iwith
xi+1=xi+ ∆xand offset price grid s1, . . . , s Jwith sj+1=sj+ ∆s, and let Vk,i,j=V(tk, xi, sj).
9Denote I:={1, . . . , I }andJ:={1, . . . , J }. Further, we assume that the second partial
derivatives in offset credit price vanish at the boundary points of the spatial grid. Thus, for
I\ {1, I}we are required to solve the matrix system

1−2 1 0 . . .
a2b2c20. . .
0a3b3c3 0 . . .
..................
0. . . a J−1bJ−1cJ−1
0. . . 0 1 −2 1

Uk−1,i,1
Uk−1,i,2
Uk−1,i,3...
Uk−1,i,J−1
Uk−1,i,J
=
0
Hk,i,2
Hk,i,3
...
Hk,i,J−1
0
(12)
for the vector Uk−1,i,·where
Hk,i,j=Vk,i,j+∆t
2κVk,i+1,j−Vk,i−1,j
2 ∆x−sj2
, (13)
aj= ∆tp−sj
2 ∆s(T−tk−1)−σ2
2 (∆s)2
, (14)
bj= 1 + ∆ tσ2
(∆s)2, and (15)
cj=−∆tp−sj
2 ∆s(T−tk−1)+σ2
2 (∆s)2
. (16)
The values of H,a,b, and care obtained using centralised FD approximations to the PDE
in (10) with an implicit relation in ∂sUand∂ssUwhile maintaining an explicit relation for
∂xU. The derivation of these values is provided in Appendix A.
Using the matrix system (12), the algorithm for the one-player model is provided in Algo-
rithm 1.
Algorithm 1: Single-player value function and optimal decision boundary
Input: t,s,x grid
1Set terminal values VN,i,j =G(xi);
2fork=N, N−2, . . . , 1do
3 Solve (12) for Uk−1,i,·for each i∈I\ {1, I};
4 Use interpolation to compute Uk−1,1,·andUk−1,I,·;
5 SetVk−1,i,j= max {U(tk−1, xi, sj),(U(tk−1, x+ξ, s−η ξ)−c)}for all i∈I, j∈J;
6 Store the decision region Dk−1,i,j:=1{Vk−1,i,j≥U(tk−1,xi,sj)}for all i∈I, j∈J;
7 Store the optimal trading rate v∗
k−1,i,iusing the FD approximation of (7) for all i∈I, j∈J;
8end
Output: V,ν∗, and D
4.2 Results
We implement the above algorithm in Python and generate 5 ,000 OC price sample paths to
analyse how a regulated player’s optimal strategy behaves. We set the marginal cost of OC
generation to be equal to the terminal penalty for all experiments. Specifically, in this single-
10player environment we take ξ= 0.1 OCs, c= $0.25,R= 5, and the penalty p= $2.50 per OC
below the requirement R. The model parameters are provided in Table 1. We use 100 time
steps between the initial time t= 0 and the terminal time t=Tand set the compliance period
to be one month, T= 1/12 years. Unless otherwise specified, the units of time are in years.
For the simulated OC price, we set a reflective boundary at zero. The volatility σof the OC
price is set to 0 .5.
T (years) σ κ η ξ c S0RPenalty
1/12 0.5 0.03 0.05 0.1 0.25 2.5 5 2.5
Table 1: Simulation parameters for single-player market.
Three na¨ ıve strategies are developed for comparative purposes: (1) trading at a constant
rate ˜vsuch that the OC requirement is met at t=T; (2) trading at the constant rate ˜ vuntil
t=T/2 followed by successive generation until the requirement is met; and (3) successive
generation starting at t= 0 until the requirement is met. The same random seed is used to
generate all scenarios for all strategies to allow for direct comparisons.
0 50.02.5t=0.000
0 50.02.5t=0.010
0 50.02.5t=0.020
0 50.02.5t=0.030
0 50.02.5t=0.040
0 50.02.5t=0.050
0 50.02.5t=0.060
0 50.02.5t=0.070
0 50.02.5t=0.080
InventoryOC PriceStrategy
Trade Only
Trade + Generate
Figure 1: Trade-Generation regions at multiple time points. Generation region is in white.
Dashed lines indicate terminal OC requirement (vertical) and penalty value (horizontal).
110 50.02.5t=0.000
0 50.02.5t=0.010
0 50.02.5t=0.020
0 50.02.5t=0.030
0 50.02.5t=0.040
0 50.02.5t=0.050
0 50.02.5t=0.060
0 50.02.5t=0.070
0 50.02.5t=0.080
100
50
050
InventoryOC PriceTrade RateFigure 2: Trade rates at multiple time points. Dashed lines indicate terminal OC requirement
(vertical) and penalty value (horizontal).
We begin by analysing the generation region and trade rates of a single player’s optimal
strategy in Figure 1 and Figure 2, respectively. When inventory is greater than the regulatory
threshold R= 5, there is no generation region and the trading rate is negative as the player
can sell off excess inventory for profit. When below the regulatory threshold and below the
penalty value $2.50, the player trades at a positive rate (i.e. purchases OCs). The generation
region at the start of the period is below the penalty value and when inventory is less than
the requirement. This region grows as time approaches Tand begins to include area above
the penalty value. The corresponding trade rates in this region are negative, demonstrating
that it is beneficial for the agent to generate and sell their inventory at a premium above the
penalty rather than use them for regulatory purposes. We find positive trade rates for early
time points when the player is above their requirement and the OC price is sufficiently low, as
they anticipate the price will converge to the penalty and can sell their excess inventory for a
profit.
The player acquires the majority of their inventory through generation and only conducted
minor trading, demonstrated in Figure 3. The player generates an average of 4.742 OCs
throughout the period across all samples. As the initial spot price of an OC, S0, is set to the
penalty value of $2.50, the player always begins the period in the generation region and stays
in the generation region until price impact from successive generation creates a large enough
impact to exit the generation region. When outside the generation region, small amounts
of positive trading (buying) occurs. Figure 4 compares the mean inventories of the optimal
strategy and three na¨ ıve strategies. As the trade rates and generation instances in the na¨ ıve
strategies are fixed, no deviation occurs in their inventory over time.
120.00 0.02 0.04 0.06 0.08
Time012345InventoryOCs Acquired through Trading and Generation
Traded
2.5%-97.5% Quantile
Generated
2.5%-97.5% QuantileFigure 3: Trade-Generation regions and trade rates at multiple time points. Generation region
is in white.
0.00 0.02 0.04 0.06 0.08
Time012345InventoryMean Inventory over Time
Optimal Strategy
2.5%-97.5% Quantile
Constant Trade Rate
Constant trade till T/2, then Gen
Only Generate
Figure 4: Inventory with respect to time for the single-player optimal strategy and na¨ ıve strate-
gies with 95% quantiles.
Each strategies’ terminal profit–and–loss (PnL) is determined by combining the costs as-
sociated with each strategy and the terminal penalty. Figure 5 displays a histogram of each
strategy’s PnL along with its corresponding kernel density estimates. In all sample paths, the
optimal strategy achieves a superior PnL to the only generate strategy, which is a constant
value of −$12.50. This is also the value of incurring the full penalty. While the na¨ ıve strategies
that include a trading component achieve better PnLs over the optimal strategy in a some
sample paths, they achieve a worse expected PnL and left tail expectation (TE). PnL and TE
are presented in Table 2. When compared to all three na¨ ıve strategies, the optimal strategy
achieves both a superior mean PnL and TE demonstrating that the optimal strategy completely
hedges against downside risk. The optimal strategy’s PnL standard error (SE), i.e. the error in
the estimator of the PnL’s mean, is also much smaller than the other strategies that incorporate
trading, indicating very little uncertainty in our ability to improve over the penalty.
1312.50
 12.475
 12.45
 12.425
 12.40
PnL0510152025Optimal Strategy PnL
13.0
 12.8
 12.6
 12.4
 12.2
 12.0
PnL0123Naïve Strategy PnLs
Optimal Strategy
Only Generate
Constant Trade Rate
Constant Trade till T/2, then GenFigure 5: Terminal PnL histograms for the single-player optimal strategy and na¨ ıve strategies
with kernel density estimates.
Optimal Constant Half Trade, Only
Strategy Trade Half Generate Generate
Mean PnL −$12.464−$12.499 −$12.499−$12.500
TE−$12.495−$12.926 −$12.735 –
PnL SE ( ×10−3) 0 .349 2 .874 1 .582 –
Table 2: Mean PnL, TE, and PnL SE for the single-player optimal strategy and na¨ ıve strategies.
5 Two-Player Setting
In this section, we extend the single-player problem to the two-player game setting and char-
acterise their equilibrium behaviour. With the inclusion of second player, the QVI from the
single-player framework evolves into a bi-matrix game and we must apply a game theoretic
approach (see Fudenberg and Tirole (1991); Osborne and Rubinstein (1994); Osborne et al.
(2004)) to analyse the resulting model.
The Nash equilibrium, if it exists, may be a pure strategy or mixed strategy equilibrium.
A pure strategy Nash equilibrium is one in which each, at each state, a player always chooses
a specific action, and neither player can obtain a better value by deviating from their choice.
A mixed strategy Nash equilibrium is one in which the players draw their strategy from a
distribution over actions (independently of one another) – i.e., their strategies are randomised.
We will be seeking mixed strategy Nash equilibria. For a mixed strategy Nash equilibrium,
a player’s reward equals the sum over the action rewards multiplied by the probabilities that
each player takes the appropriate actions.
In the bi-matrix game representing the GHG OC market, each player has the choice whether
or not to invest in OC generation. We denote each players’ value functions with a 1 or 2 to
indicate ownership. Players may have differing terminal penalties, e.g., player one may require
more credits to offset their excess emissions than player two. Therefore, we denote the terminal
penalty of player masG(m), where G(m)(x) =−p(Rm−x)+. In the two-player setting, an
14additional complexity is introduced. Specifically, if one player trades while the other generates,
the price impact affects both players. In this case, the trading player benefits when purchasing
at a lower cost and is at a disadvantage when selling. If both players choose to generate OCs
the price impact will be incurred twice. For this two-player setting we work directly in discrete
time, as there is no hope for analytical tractability in the continuous time setting.
5.1 Numerical Implementation
Extending the discrete time approach presented in Section 4.1 to the two-player setting is
straightforward. As in the single-player case, we denote the value function of the two possible
player states, trading and generating as U(m)andU(m)†,m∈M:={1,2}. Using the same
notation and framework as Section 4.1, for t∈[tk−1, tk], we define
U(m)(t,x, s) = sup
ν(m)∈VEt,x,s
V(m)(tk,Xtk, Stk)−Ztk
tSuν(m)
udu−κ
2Ztk
t(ν(m)
u)2du
,(17)
where xis the two-dimensional vector representing players’ inventory. Note, the agents must
track the inventory of the other agent as well as their own inventory, hence the value functions
depend on the vector of states. The PDE associated with (17) is the same as was found
in the single-player framework, given by (10), but with terminal conditions U(m)(tk,x, s) =
V(m)(tk,x, s) and the spatial derivative in ∂xreplaced by ∂xm. Hence, similar to the single
player setting, the optimal trading rate for player- mis given in feedback form as
v∗(m)(t,x, s) =1
κ 
∂xmV(m)(t,x, s)−s
. (18)
The value of each player at time t=tk−1is determined by the Nash equilibrium of the
bi-matrix game shown in Table 3, where 11:= (1 ,0) and 12:= (0 ,1). Players may not have the
same inventory, therefore, we must compute the Nash equilibria for all possible combinations
of the player’s inventory.
Player 2
Trade Generate
Player 1TradeU(1)(t,x, s),
U(2)(t,x, s)U(1)(t,x, s−η ξ2),
U(2)(t,x+ξ212, s−η ξ2)−c2
GenerateU(1)(t,x+ξ111, s−η ξ1)−c1,
U(2)(t,x, s−η ξ1)U(1)(t,x+ξ111, s−η(ξ1+ξ2))−c1,
U(2)(t,x+ξ212, s−η(ξ1+ξ2))−c2
Table 3: Bi-matrix game of two-player GHG OC market for a two-player setting.
The Nash equilibrium of the game given by Table 3 can be determined by numerically
estimating the solutions to four PDEs, as each player has two PDEs (continuation and holding)
characterising their actions’ values. To estimate the PDE solutions, we utilise implicit-explicit
FD scheme developed in Section 4.1. The implicit FD matrix systems, given by (12), has the
15same structure in the two-player setting, with the appropriate ownership subscript applied to
the relevant terms. To compute each players’ value from the resulting Nash equilibrium, we
use the mixed strategy Nash equilibrium probabilities. We denote π(m)
t,x,sto be the probability
associated with player– mgenerating OCs at state ( t,x, s), which is found by solving for the
Nash equilibrium in Table 3. Letting ( −m) denote the other player in the game, the mth
player’s value is determined by
V(m)(tk−1,x, s)
= (1−π(m)
tk−1,x,s) (1−π(−m)
tk−1,x,s)U(m)(tk−1,x, s)
+ (1−π(m)
tk−1,x,s)π(−m)
tk−1,x,sU(m)(tk−1,x, s−η ξ−m)
+π(m)
tk−1,x,s(1−π(−m)
tk−1,x,s)U(m)(tk−1,x+ξm1m, s−η ξm)
+π(m)
tk−1,x,sπ(−m)
tk−1,x,sU(m)(tk−1,x+ξm1m, s−η(ξm+ξ−m)).(19)
The form of (19) is determined by the probabilities of each player choosing the action of trading
or generating multiplied by the associated value corresponding to that action.
The algorithm for solving for the mixed-strategy Nash equilibria in this environment is
given in Algorithm 2. We utilise the Python library NashPy to solve for the Nash equilibria. To
improve computational efficiency, one can use parallel programming to simultaneously compute
the equilibria.
Algorithm 2: Two-player value functions and mixed strategy Nash equilibria
Input: t, s,xgrid
1Set terminal values V(m)
N,i,j=G(m)(xim) for m∈M;
2fork=N, N−2, . . . , 1do
3 for each i1, i2∈Ido
4 Solve (12) for U(m)
k−1,i,·for each m∈Musing interpolation for boundary points in I;
5 Compute the mixed-strategy Nash equilibria for the bi-matrix game in Table 3 to calculate
and store V(m)
k−1,i,jandπ(m)
k−1,i,jfor all j∈J,m∈M;
6 Store the optimal trading rate v∗(m)
k−1,i,jusing the FD approximation of (18) for all j∈J,
m∈M;
7 end
8end
Output: V(m),v∗(m), and π(m)form∈M
5.2 Results
5.2.1 Homogeneous Investment Opportunities
We first analyse two regulated players that have equal investment opportunity for OC generation
(ξ1=ξ2andc1=c2). The values of ξandcare chosen such that the cost of generating one OC
is equal to the penalty value. We use a linearly spaced grid for the spatial coordinates over 100
time points, with simulation parameters presented in Table 4 and we simulate 5 ,000 OC price
sample paths to examine a player’s optimal strategies. Each player begins the period with zero
inventory (i.e X0, i= 0).
16T (years) σ κ η ξ 1,2c1,2S0R1,2Penalty
1/12 0.5 0.03 0.05 0.1 0.25 2.5 5 2.5
Table 4: Simulation parameters for a homogeneous two player market.
Figure 6 displays the probabilities that player one will generate at a given state in the upper
panel and their trade rates in the lower panel. Due to homogeneity, player two has identical
probabilities and trade rates. Areas of high generation probability (low trading probability)
occur earlier in the period and when the player’s inventory is below their requirement and
the OC price is below the penalty value. As time approaches T, the boundary between low
and high generation probability becomes linear along the respective player’s terminal inventory
requirement. The optimal trade rates are intuitive: a player purchases OCs when their inventory
is below the requirement, and as time approaches Tthey sell excess inventory at faster rates.
We find that at early time points, players do purchase OCs when their inventory exceeds the
requirement and the price is below the penalty value, as players anticipate the OC price will
increase to the penalty by T. If players start the period with zero OCs, they begin in a region
of generation and subsequently impact the OC price pushing it down. As such, our figures
focus on OC prices that are at or below $2.50, as that is the region the players the environment
remains when following the optimal strategy.
Figure 7 displays how players’ inventories evolve over the period and the inventory they
acquire through generation. As in the single player scenario, both players generate the majority
of their OCs in a period of successive generation at the start of the period, driving the OC price
down due to market impact. This is followed by a period of trading with sporadic generation
instances when the players are able to trade at a more advantageous OC price. In the figure,
the sample paths and quantiles are extremely similar due to symmetric nature of the players
– only minor differences occurring due to small differences when each player generates at the
midway point due to their probabilities.
170 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
00.20.40.60.81.0
Player 2 InventoryPlayer 1 InventoryPlayer 1 Generation Probability
0 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
-120-90-60-3003065
Player 2 InventoryPlayer 1 InventoryPlayer 1 Trade RateFigure 6: Trading probability and trade rate conditional on taking a trading action of player
one. Rows represent time points throughout the period and columns are OC prices. Player
two’s results are equivalent to player one when rotated 90 degrees.
180.00 0.02 0.04 0.06 0.08
t012345InventoryPlayer 1
Xt
0.00 0.02 0.04 0.06 0.08
t012345Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
St
0.00 0.02 0.04 0.06 0.08
t012345Generated InventoryPlayer 1
Xt
0.00 0.02 0.04 0.06 0.08
t012345Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
StFigure 7: Total inventory (top) and generated inventory (bottom) with mean inventory (red),
95% quantiles (shaded red), and sample path (blue) for a homogeneous players. Corresponding
OC price sample path (black) on right axis.
The terminal PnL distribution of both players, shown in Figure 8, demonstrates that both
players achieved non-trivial improvement over the maximum terminal penalty of −$12.50 and
the PnLs of the na¨ ıve strategies from Section 4.2. Each players’ mean PnL and TE are given
in Table 5. As the players are homogeneous, they obtain the same summary statistics. Both
players completely hedge against downside risk when behaving in accordance to the Nash
equilibria, as demonstrated by their TE.
PnL SE
Mean PnL TE ( ×10−3)
Player 1 −$12.393 −$12.467 0.622
Player 2 −$12.393 −$12.467 0.622
Table 5: Mean PnL, TE, and PnL SE for
homogeneous players.
12.50
 12.45
 12.40
 12.35
 12.30
 12.25
T erminal PnL0246810Histogram of T erminal PnL
Player 1
Player 2
Figure 8: Terminal PnL histograms and
KDEs of players with homogeneous invest-
ment opportunities.
195.2.2 Heterogeneous Investment Opportunities
Next, we explore players who have heterogeneous investment opportunities (i.e. generation
capacity), such that ξ1̸=ξ2andc1̸=c2. This setting represents firms that have different
project investment opportunities that generate an unequal amount of instantaneous OCs, and
can representing a small firm and a large firm. The remaining market parameters remain as in
Table 4, with the modifications: ξ1= 0.1, ξ2= 0.4,c1= $0.25,andc2= $1.00. As before,
the marginal price of generation is equal to the penalty value for both players and we generate
5,000 OC price samples paths to analyse their optimal strategies. In all paths, both players
start with an initial inventory of zero OCs.
The players’ Nash equilirbia probabilities for generating are presented in Figure 9. Player
one’s generation probabilities are very similar to those of the homogeneous case presented in
the previous section. Player one has large regions of high generation probability when below
their OC threshold and when at or below the penalty value. Player two has more variability
in their generation probability than player one, due to their advantage in their generation
capacity. As they can generate four times the amount of OCs than player one at any time their
strategy allows for more freedom in their action choice, represented by the probabilities that
are not concentrated at zero or one. For both players, we find there is more variability in the
generation probabilities when the OC price is at the penalty value (which equals the marginal
cost to generate one OC).
The corresponding trade rates are displayed in Figure 10. These results are similar to the
homogeneous player setting. Trade rates are negative when player’s inventories exceed the
requirement and positive when below the requirement. For OC prices that exceed the penalty,
minor amounts of negative trading take place as it is more advantageous for players to sell their
inventory at the premium over the penalty value and incur the penalty.
Figures 11 and 12 demonstrate the difference in the strategies that players take. Both players
begin with successive instances of generation. Player two then begins a long period of trading
with intermittent generation. Meanwhile, player one has a period of trading beginning around
1
2Twith only minor generation instances. The successive generation by both players drives
down the OC price, demonstrated by the sample path (black), creating a mutually beneficial
environment where both players can trade at more advantageous prices. Both players generate
the majority of their required OCs.
200 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
00.20.40.60.81.0
Player 2 InventoryPlayer 1 InventoryPlayer 1 Generation Probability
0 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
00.20.40.60.81.0
Player 2 InventoryPlayer 1 InventoryPlayer 2 Generation ProbabilityFigure 9: Trading probability of players with heterogeneous generation capability. Rows repre-
sent time points throughout the period and columns are OC prices.
210 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
-120-90-60-3003065
Player 2 InventoryPlayer 1 InventoryPlayer 1 Trade Rate
0 2.5 5.0 7.502.55.07.5t=0.00St=2.30
0 2.5 5.0 7.502.55.07.5St=2.40
0 2.5 5.0 7.502.55.07.5St=2.50
0 2.5 5.0 7.502.55.07.5t=0.03
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.06
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5t=0.08
0 2.5 5.0 7.502.55.07.5
0 2.5 5.0 7.502.55.07.5
-120-90-60-3003065
Player 2 InventoryPlayer 1 InventoryPlayer 2 Trade RateFigure 10: Trade rates conditional on taking a trading action of players with heterogeneous
generation capability. Rows represent time points throughout the period and columns are OC
prices.
220.00 0.02 0.04 0.06 0.08
t012345InventoryPlayer 1
Xt
0.00 0.02 0.04 0.06 0.08
t012345Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
StFigure 11: Mean inventory (red), 95% quantile (shaded red), and sample path (blue) on left
axis and corresponding OC price sample (black) on right axis for heterogeneous players.
0.00 0.02 0.04 0.06 0.08
t012345Generated InventoryPlayer 1
Xt
0.00 0.02 0.04 0.06 0.08
t012345Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
St
Figure 12: Mean inventory acquired by generation (red), 95% quantile (shaded red), and sample
path (blue) on left axis and corresponding OC price sample (black) on right axis for heteroge-
neous players.
Figure 13 displays the terminal PnL histograms of each player while Table 6 displays the
mean PnLs and CVaRs 95. For both players, the terminal PnL is always better than incurring the
full penalty and their downside risk is completely eliminated. Both players achieve significantly
better terminal statistics than the na¨ ıve strategies from Section 4.2. Player one achieves slightly
better terminal statistics than player two, which we attribute to their lower costs to generate
OCs. There is a modest increase in player one’s SE of their PnL than there is with player two.
Both players achieve superior terminal statistics than their homogeneous counterparts however,
demonstrating the mutual benefits of interacting with players with larger generation capacity.
23PnL SE
Mean PnL TE ( ×10−3)
Player 1 −$12.376 −$12.456 0.665
Player 2 −$12.387 −$12.461 0.545
Table 6: Mean PnL, TE, and PnL SE for
heterogeneous players.
12.50
 12.40
 12.30
 12.20
T erminal PnL0246810Histogram of T erminal PnL
Player 1
Player 2Figure 13: Terminal PnL histograms of
players with heterogeneous investment op-
portunities.
5.3 Comparisons
In all prior simulations, model parameters and players’ marginal cost of OC generation were
equivalent. This allows for direct comparison across scenarios. Player’s abiding by the optimal
strategy always achieve a superior PnL compared to the full penalty and completely eliminate
their downside risk. In other words, the TE values of all players are superior to the full penalty
value. Given our parameter choices, all experiments demonstrate the benefit and importance
of being able to generate OCs through project investment, as the majority of OCs are acquired
by generation. Given the low liquidity of OCs in the Canadian market (Sadikman et al. (2022))
this result is in line with how firms currently behave. In Table 7, the mean value of generated
OCs across the simulations for each experiment is shown, alongside mean PnL and TE. Players
across all experiments on average generate at least 85% of their terminal OC inventory. Players
that participate in the two-player market achieve a superior mean PnL and TE than the player
who participates in the single-player market, demonstrating importance to model this style of
market as a multi-player game. Both players in the heterogeneous scenario achieve superior
PnLs and TEs compared to their homogeneous counterpart, demonstrating an inherited benefit
from participating in a market with players with larger generation capabilities. Across both two
player settings, the players obtain similar statistics as they are allowed to simultaneously trade
and generate OCs, which partially offsets some of the benefits of having a larger generation
capacity.
Player (Experiment) Single Player P1 (Equal) P2 (Equal) P1 (Hetero) P2 (Hetero)
Generation Capacity ξ= 0.1 ξ1= 0.1 ξ2= 0.1 ξ1= 0.1 ξ2= 0.4
Mean Generated OCs 4.742 4.444 4.443 4.412 4.473
Mean PnL −$12.464 −$12.393 −$12.393 −$12.376 −$12.387
TE −$12.495 −$12.467 −$12.467 −$12.456 −$12.461
Table 7: Mean generated OCs, PnL, and TE for each single-period experiment.
245.4 Multi-Period Model
OCs in the Canadian market last for multiple years (and compliance periods) if they are not
submitted for compliance purposes. Hence, it is natural to extend our methodology to accom-
modate a multi-period framework. We assume a model with L–many compliance dates, where
a compliance date takes place on ( Tl)l∈{1,...,L}where the lthcompliance period takes place be-
tween [ Tl−1, Tl) for l∈ {1, . . . , L }andT0represents the start of the first period. OCs acquired
prior to compliance date Tlmay be used for regulatory purposes on Tl. Player- m’s assessment
of a strategy ( ν,τ) in this setting (at state ( t,x, s)) is given by
J(m)ν,τ(t,x, s)
:=Et,x,s"LX
l=11t≤TlG(m)
l(X(m)
Tl)−ZTL
t 
Suν(m)
u−κ
2(ν(m)
u)2
du−X
i∈N1t≤τi≤TLcm#
,(20)
where G(m)
l(x) =−p(R(m)
l−x)+such that R(m)
lis player– m’s OC requirement for the lth
period to completely eliminate their penalty. As in the two-player setting, players’ optimal
values are determined by the Nash equilibrium induced by the bi-matrix game. The bi-matrix
game structure and numerical implementation remains the as in the single-period two-player
model from Section 5.1, with minor modifications to allow for multiple compliance dates.
The simulation parameters, presented in Table 8, are similar to those in Section 5.2.2 for
two heterogeneous players. We analyse a scenario with two compliance periods with T1=1
12
andT2=2
12, representing a compliance date at the end of each month for two consecutive
months. The trading friction is also increased, symbolising an environment that is more hostile
to trading. We assume that players have the same OC requirement and this requirement is
constant across both periods. We run the experiment using 150 time points, such that there
are 75 time points for each period.
T (years) σ κ η ξ 1ξ2c1c2S0R1,2
1,2Penalty
[1/12,2/12] 0.5 0.06 0.05 0.1 0.4 0.25 1.00 2.5 5 2.5
Table 8: Simulation parameters for two-period two-player market with heterogeneous invest-
ment opportunities.
In Figures 14 and 15, time points prior to t= 1/12 are within the first compliance period,
while time points after are within the second compliance period. Figure 14 shows that as
the first compliance date approaches in the first period, both players have large regions of
high generation probability when below the OC requirement. Both players’ results are similar
to those in the single-period setting in Section 5.2.2 when analysing one period in the two-
period setting. The corresponding trade rates, shown in Figure 15, follow the same pattern
as before, with positive trading and negative trading occurring when players are below and
above their OC requirement, respectively. As there is more trading friction in this scenario,
25players are less inclined to trade at fast speeds and only do so when the gain is substantial.
The boundaries between positive and negative trading become much more stark at the end of
the final compliance period.
Figures 16 and 17 display the inventory and cumulative generated inventory for each player,
respectively. In our simulation, both players slightly exceed the inventory requirement in the
first period, as they are able to bank any excess OCs for the following period after compliance
submission. When either player banks OCs, it provides them with more opportunities in the
subsequent period to trade to help offset their costs. Fewer generation instances occur in the
second period, due to the previous periods banked OCs, resulting in a moderate amount of
increased variability in PnL, as demonstrated by player two’s quantiles.
0.00 0.05 0.10 0.15
t012345InventoryPlayer 1
Xt
0.00 0.05 0.10 0.15
t012345Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
St
Figure 16: Mean inventory with 95% quantile (red) on left axis and mean OC price with 95%
quantile (blue) on right axis for heterogeneous players in multi-period model. Vertical dashed
lines represent compliance dates.
0.00 0.05 0.10 0.15
t0246810Cumulative Generated InventoryPlayer 1
Xt
0.00 0.05 0.10 0.15
t0246810Player 2
Xt
2.02.12.22.32.42.52.6
St
2.02.12.22.32.42.52.6OC Price
St
Figure 17: Cumulative mean inventory acquired by generation with 95% quantile (red) on left
axis and mean OC price with 95% quantile (blue) on right axis for heterogeneous players in
multi-period model. Vertical dashed lines represent compliance dates.
The terminal PnL distribution, shown in Figure 9, clearly demonstrates that both players
achieve beneficial outcomes than if they simply incurred the penalty in both compliance peri-
ods. The maximum penalty a player can incur after both periods −$25.00. Players’ terminal
statistics, shown in Table 18 further demonstrate that both players attain non-trivial savings
260.0 2.5 5.0 7.50.02.55.07.5t=0.00St=2.30
0.0 2.5 5.0 7.50.02.55.07.5St=2.40
0.0 2.5 5.0 7.50.02.55.07.5St=2.50
0.0 2.5 5.0 7.50.02.55.07.5t=0.06
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.11
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.16
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
00.20.40.60.81.0
Player 2 InventoryPlayer 1 InventoryPlayer 1 Generation Probability
0.0 2.5 5.0 7.50.02.55.07.5t=0.00St=2.30
0.0 2.5 5.0 7.50.02.55.07.5St=2.40
0.0 2.5 5.0 7.50.02.55.07.5St=2.50
0.0 2.5 5.0 7.50.02.55.07.5t=0.06
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.11
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.16
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
00.20.40.60.81.0
Player 2 InventoryPlayer 1 InventoryPlayer 2 Generation ProbabilityFigure 14: Trading probability of players with heterogeneous generation capability in a two-
period setting. The first two rows in each sub-figure correspond to the first period while the
last two rows take place in the second period.
270.0 2.5 5.0 7.50.02.55.07.5t=0.00St=2.30
0.0 2.5 5.0 7.50.02.55.07.5St=2.40
0.0 2.5 5.0 7.50.02.55.07.5St=2.50
0.0 2.5 5.0 7.50.02.55.07.5t=0.06
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.11
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.16
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
-60-3003060
Player 2 InventoryPlayer 1 InventoryPlayer 1 Trade Rate
0.0 2.5 5.0 7.50.02.55.07.5t=0.00St=2.30
0.0 2.5 5.0 7.50.02.55.07.5St=2.40
0.0 2.5 5.0 7.50.02.55.07.5St=2.50
0.0 2.5 5.0 7.50.02.55.07.5t=0.06
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.11
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5t=0.16
0.0 2.5 5.0 7.50.02.55.07.5
0.0 2.5 5.0 7.50.02.55.07.5
-60-3003060
Player 2 InventoryPlayer 1 InventoryPlayer 2 Trade RateFigure 15: Trade rates conditional on players taking a trading action of players with hetero-
geneous generation capability in a two-period setting. The first two rows in each sub-figure
correspond to the first period while the last two rows take place in the second period.
28when abiding by the Nash equilibrium strategy despite the increased trading friction. Players
eliminate all downside risk by a significant margin, as indicated by the players’ TE.
PnL SE
Mean PnL TE ( ×10−3)
Player 1 −$24.892 −$24.950 0.472
Player 2 −$24.894 −$24.956 0.477
Figure 18: Mean PnL, TE, and PnL SE
for heterogeneous players in a two period
model.
25.00
 24.95
 24.90
 24.85
 24.80
 24.75
T erminal PnL024681012Histogram of T erminal PnL
Player 1
Player 2Table 9: Terminal PnL histograms of play-
ers with heterogeneous investment oppor-
tunities in a two period model.
6 Conclusion
We developed a GHG OC model representative of Canada’s market in a single-player and two-
player setting. In the single-player setting, the player’s value function solves a QVI, while
in the two-player setting, players’ value functions are determined by by computing the Nash
equilibrium of a bi-matrix game. We found the scale of a player’s OC generating projects
plays a vital role in determining their behaviour and heavily influences the Nash equilibria of
the two-player game. In the instances of the two-player game we analysed, players had well
defined decision boundaries between trading OCs and generating OC. We find that players who
participate in the market with a heterogeneous counterpart perform better than those with a
homogeneous counterpart. Here, better performance is measured with respect to terminal PnL
and TE. This result stems from one of the two players in the heterogeneous setting have a larger
generation capacity, despite having higher instantaneous investment cost. The explicit-implicit
FD scheme constructed for the numerical implementation allowed us to estimate the players’
value functions and Nash equilibria avoiding numerical instabilities that would have been caused
by the OC price’s dynamics in an entirely explicit scheme. This choice of OC price dynamics
allowed for a more realistic and arbitrage-free market model due to the convergence to the
penalty value at the end of the compliance period. All simulations we performed demonstrated
the importance of investing in GHG reducing and capturing projects from a financial perspective
by completely mitigating downside risk, even under the strict choice that the marginal cost to
generate one OC is equal to the penalty value. In more hostile trading environments, players
still achieved financial gains when abiding by the equilibria. These financial incentives are in
addition from the societal benefits these projects have on the earth’s climate.
The market model and methodology presented in this paper will aid firms in deciding when
to invest in projects that reduce or capture GHG emissions. In addition, this work allows
legislators to more effectively organise OC and emissions markets by allow them to predict
29a market participant’s behaviour. As nations strive for the goals set by the Paris Climate
Accords and COP26, emissions markets and further GHG regulation are becoming more com-
monplace. Hence, the ability to properly model the resulting market is vital. Understanding
player behaviour in GHG OC markets is vital to both the regulators, who can update the
market framework given new findings, and the players, who must know how to optimally be-
have in order to offset their excess emissions. Both firms and the environment benefit from
carbon capturing project implementation. As the world is reeling with the consequences of an
increasingly warming and unstable climate, GHG OC markets and their regulation is one tool
that can help slow the effects of climate change by creating incentives for firms to engage and
invest in GHG emission reduction and capturing.
6.1 Future Directions
The model presented in this paper allows for multiple possible extensions, as both the analyt-
ical and numerical framework are adaptable to a number of problem instances. One natural
extension is to characterise how players behave when presented with multiple different project
opportunities. This can be done in both the single-player and two-player setting. In the single-
player setting, this is accomplished by including additional terms to the player’s QVI with
multiple possible ξandccombinations. In the two-player setting, rows and columns would be
added to the game matrices of the players to represent additional project opportunities for the
players.
A second worthwhile extension would be to pose this market model and optimisation prob-
lem in a reinforcement learning framework. One way to accomplish this is to employ the
techniques developed by Casgrain et al. (2022), which allows for the efficient computation of
Nash equilibria in general-sum stochastic games. The flexibility of this RL framework would
allow for easier scalability to a larger finite number of players that will better represent the
future GHG OC market (Sadikman et al. (2022)).
7 Acknowledgements
LW would like to thank Noah Marshall and Anthony Coache for helpful suggestions regarding
numerical PDE methods. LW would like to acknowledge support from the Natural Sciences
and Engineering Research Council of Canada via a Canadian Graduate Scholarship. SJ would
like to acknowledge support from the Natural Sciences and Engineering Research Council of
Canada (RGPIN-2018-05705). Both LW and SJ would like to thank the associate editor and
anonymous referee for the helpful and constructive comments.
References
Amundsen, E. S., Baldursson, F. M., and Mortensen, J. B. (2006). Price volatility and banking
in green certificate markets. Environmental and Resource Economics , 35(4):259–287.
30Carmona, R., Dayanıklı, G., and Lauri` ere, M. (2022). Mean field models to regulate carbon
emissions in electricity production. Dynamic Games and Applications , 12(3):897–928.
Carmona, R., Delarue, F., et al. (2018). Probabilistic theory of mean field games with applica-
tions I-II . Springer.
Carmona, R., Fehr, M., and Hinz, J. (2009). Optimal stochastic control and carbon price
formation. SIAM Journal on Control and Optimization , 48(4):2168–2190.
Casgrain, P., Ning, B., and Jaimungal, S. (2022). Deep Q-learning for Nash equilibria: Nash-
DQN. Applied Mathematical Finance , 29(1):62–78.
Firoozi, D., Shrivats, A. V., and Jaimungal, S. (2021). Principal agent mean field games in rec
markets. arXiv preprint arXiv:2112.11963 .
Fudenberg, D. and Tirole, J. (1991). Game theory . MIT press.
Gouvernement du Qu´ ebec (2024). Offset credits. https://www.environnement.gouv.qc.ca/
changements/carbone/credits-compensatoires/index-en.htm , Last accessed on 2024-
03-12.
Government of British Columbia (2024). Selling carbon offsets to the Province. https://www2.
gov.bc.ca/gov/content/environment/climate-change/industry/selling-offsets ,
Last accessed on 2024-03-11.
Government of Canada (2022a). Canada’s greenhouse gas offset credit system.
https://www.canada.ca/en/environment-climate-change/services/climate-change/
pricing-pollution-how-it-will-work/output-based-pricing-system/
federal-greenhouse-gas-offset-system.html , Last accessed on 2023-05-03.
Government of Canada (2022b). Canadian greenhouse gas offset credit system reg-
ulations: SOR/2022-111. https://gazette.gc.ca/rp-pr/p2/2022/2022-06-08/html/
sor-dors111-eng.html , Last accessed on 2023-05-11.
Government of Canada (2022c). The federal carbon pollution pricing
benchmark. https://www.canada.ca/en/environment-climate-change/
services/climate-change/pricing-pollution-how-it-will-work/
carbon-pollution-pricing-federal-benchmark-information.html , Last accessed
on 2023-05-03.
Government of Canada (2023). Carbon pollution pricing systems across Canada.
https://www.canada.ca/en/environment-climate-change/services/climate-change/
pricing-pollution-how-it-will-work.html , Last accessed on 2023-05-03.
Government of Canada (2024). Canada’s greenhouse gas offset credit system public reg-
istry. https://marchescarbone-carbonmarkets.canada.ca/en/public-registry , Last
accessed on 2024-03-11.
31Hitzemann, S. and Uhrig-Homburg, M. (2018). Equilibrium price dynamics of emission permits.
Journal of Financial and Quantitative Analysis , 53(4):1653–1678.
Howison, S. and Schwarz, D. (2012). Risk-neutral pricing of financial instruments in emission
markets: A structural approach. SIAM Journal on Financial Mathematics , 3(1):709–739.
Huang, M., Caines, P. E., and Malham´ e, R. P. (2007). Large-population cost-coupled LQG
problems with nonuniform agents: individual-mass behavior and decentralized ϵ-Nash equi-
libria. IEEE transactions on automatic control , 52(9):1560–1571.
Huang, M., Malham´ e, R. P., Caines, P. E., et al. (2006). Large population stochastic dynamic
games: closed-loop McKean-Vlasov systems and the Nash certainty equivalence principle.
Communications in Information & Systems , 6(3):221–252.
Hustveit, M., Frogner, J. S., and Fleten, S.-E. (2017). Tradable green certificates for renewable
support: The role of expectations and uncertainty. Energy , 141:1717–1727.
International Monetary Fund (2022). Why countries must cooperate on
carbon prices. https://www.imf.org/en/Blogs/Articles/2022/05/19/
blog-why-countries-must-cooperate-on-carbon-prices , Last accessed on 2023-05-04.
Kenyon, C., Berrahoui, M., and Macrina, A. (2022). The carbon equivalence principle. Available
at SSRN 3979608 .
Kiesel, R. and Stahl, G. (2022). An uncertainty-based risk management framework for climate-
change risk. Available at SSRN 4243603 .
Lasry, J.-M. and Lions, P.-L. (2007). Mean field games. Japanese journal of mathematics ,
2(1):229–260.
Liu, Y., Sun, H., Meng, B., Jin, S., and Chen, B. (2023). How to purchase carbon emission
right optimally for energy-consuming enterprises? Analysis based on optimal stopping model.
Energy Economics , 124:106758.
Osborne, M. J. et al. (2004). An introduction to game theory , volume 3(3). Oxford university
press New York.
Osborne, M. J. and Rubinstein, A. (1994). A course in game theory . MIT press.
Pham, H. (2009). Continuous-time stochastic control and optimization with financial applica-
tions, volume 61. Springer Science & Business Media.
Sadikman, J., Duncanson, S., Saric, D., Brinker, C., Pacholok, S., and Miller, L. (2022). The
evolution of canada’s carbon markets and their role in energy transition. Alberta Law Review ,
pages 329–329.
32Santikarn, M., Churie Kallhauge, A. N., Bozcaga, M. O., Sattler, L., Mccormick, M. S., Fer-
ran Torres, A., Conway, D., Mongendre, L., Inclan, C., Mikolajczyk, S., et al. (2021). State
and trends of carbon pricing 2021.
Seifert, J., Uhrig-Homburg, M., and Wagner, M. (2008). Dynamic behavior of CO 2spot prices.
Journal of Environmental Economics and Management , 56(2):180–194.
Shrivats, A. and Jaimungal, S. (2020). Optimal generation and trading in solar renewable
energy certificate (SREC) markets. Applied Mathematical Finance , 27(1-2):99–131.
Shrivats, A. V., Firoozi, D., and Jaimungal, S. (2022). A mean-field game approach to equilib-
rium pricing in solar renewable energy certificate markets. Mathematical Finance .
A Finite Difference Coefficients
To solve for the coefficients of the FD scheme, we discretise the partial derivatives using central
difference. Upon substituting the discretisations, the PDE (10) becomes
Vk,i,j−Uk−1,i,j
∆t+1
2κVk,i+1,j−Vk,i−1,j
2 ∆x−sj2
+p−sj
T−tk−1Uk−1,i,j+1−Uk−1,i,j−1
2 ∆s
+σ2
2Uk−1,i,j+1−2Uk−1,i,j+Uk−1,i,j−1
(∆s)2= 0.
(21)
By isolating for the terms Uk−1,i,j−1, Uk−1,i,j, Uk−1,i,j+1, we construct the linear system (for a
fixed i):
Vk,i,j
∆t+1
2κVk,i+1,j−Vk,i−1,j
2 ∆x−sj2
=
Uk−1,i,j
∆t−p−sj
T−tk−1Uk−1,i,j+1−Uk−1,i,j−1
2 ∆s−σ2
2Uk−1,i,j+1−2Uk−1,i,j+Uk−1,i,j−1
(∆s)2,
Hk,i,j
∆t=p−sj
2 ∆s(T−tk−1)−σ2
2 (∆s)2
Uk−1,i,j−1+1
∆t+σ2
(∆s)2
Uk−1,i,j
−p−sj
2 ∆s(T−tk−1)+σ2
2 (∆s)2
Uk−1,i,j+1,
Hk,i,j=ajUk−1,i,j−1+bjUk−1,i,j+cjUk−1,i,j+1.
33