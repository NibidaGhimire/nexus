Polyhedral Aspects of Feedback Vertex Set
and Pseudoforest Deletion Setâˆ—
Karthekeyan Chandrasekaranâ€ Chandra Chekuriâ€¡Samuel FioriniÂ§
Shubhang Kulkarniâ€ Stefan WeltgeÂ¶
Abstract
We consider the feedback vertex set problem in undirected graphs (FVS). The input to FVS is an
undirected graph G= (V, E)with non-negative vertex costs. The goal is to find a minimum cost subset
of vertices SâŠ†Vsuch that Gâˆ’Sis acyclic. FVS is a well-known NP-hard problem and does not
admit a (2âˆ’Ïµ)-approximation for any fixed Ïµ >0assuming the Unique Games Conjecture. There are
combinatorial 2-approximation algorithms [BBF95, BG96] and also primal-dual based 2-approximations
[CGHW98, Fuj99]. Despite the existence of these algorithms for several decades, there is no known
polynomial-time solvable LP relaxation for FVS with a provable integrality gap of at most 2. More
recent work [CM16] developed a polynomial-sized LP relaxation for a more general problem, namely
Subset FVS, and showed that its integrality gap is at most 13for Subset FVS, and hence also for FVS.
Motivated by this gap in our knowledge, we undertake a polyhedral study of FVS and related prob-
lems. In this work, we formulate new integer linear programs (ILPs) for FVS whose LP-relaxation can
be solved in polynomial time, and whose integrality gap is at most 2. The new insights in this process
also enable us to prove that the formulation in [CM16] has an integrality gap of at most 2for FVS. Our
results for FVS are inspired by new formulations and polyhedral results for the closely-related pseudo-
forest deletion set problem (PFDS). Our formulations for PFDS are in turn inspired by a connection to
the densest subgraph problem. We also conjecture an extreme point property for a LP-relaxation for
FVS, and give evidence for the conjecture via a corresponding result for PFDS.
âˆ—Corresponding Author: Karthekeyan Chandrasekaran, Affiliation: University of Illinois, Urbana-Champaign, E-mail Ad-
dress: karthe@illinois.edu.
â€ University of Illinois, Urbana-Champaign, Email: {karthe, smkulka2}@illinois.edu. Supported in part by NSF grants
CCF-1814613 and CCF-1907937.
â€¡University of Illinois, Urbana-Champaign, Email: chekuri@illinois.edu. Supported in part by NSF grants CCF-1910149 and
CCF-1907937.
Â§UniversitÃ© libre de Bruxelles, Email: sfiorini@ulb.ac.de
Â¶Technische UniversitÃ¤t MÃ¼nchen, Email: weltge@tum.de. Supported in part by Deutsche Forschungsgemeinschaft (DFG,
German Research Foundation), project number 451026932.
1arXiv:2303.12850v2  [cs.DS]  30 May 2024Contents
1 Introduction 3
1.1 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2 Preliminaries 10
3 Pseudoforest Deletion Set 11
3.1 Orientation and 2-Pseudotree Cover constraints . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.2 Extreme point property of the Weak Density polyhedron . . . . . . . . . . . . . . . . . . . . . 12
3.2.1 Background on supermodular functions and set families . . . . . . . . . . . . . . . . . 13
3.2.2 Conditional supermodularity of Weak Density constraints . . . . . . . . . . . . . . . . 14
3.2.3 Conditional properties of tight sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3.2.4 Conditional basis structure for extreme points . . . . . . . . . . . . . . . . . . . . . . . 16
3.2.5 Proof of Theorem 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
3.3 Extreme point property of the Orientation polyhedron . . . . . . . . . . . . . . . . . . . . . . 20
4 Feedback Vertex Set 23
4.1 Weak Density and Cycle Cover constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
4.1.1 Minimal FVS and Weak Density constraints . . . . . . . . . . . . . . . . . . . . . . . . 24
4.1.2 Proof of integrality gap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
4.2 Orientation and Cycle Cover constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
4.3 Alternative formulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
A Pseudoforest Deletion Set 30
A.1 Polynomial-time separation oracle for 2-Pseudotree Cover constraints . . . . . . . . . . . . . 30
B Feedback Vertex Set 31
B.1 Polynomial-sized formulation of the Cycle Cover polyhedron . . . . . . . . . . . . . . . . . . . 31
B.2 Chekuri-Madan formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
B.2.1 Chekuri-Madanâ€™s ILP for SFVS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
B.2.2 Reduction from FVS to SFVS satisfying the CM-properties . . . . . . . . . . . . . . . 33
B.2.3 Bounding the integrality gap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
B.3 Orientation formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
21 Introduction
We consider the feedback vertex set problem in undirected graphs. For a graph G= (V, E), a subset
UâŠ†Vis afeedback vertex set ifGâˆ’Uis acyclic; in other words Uis a hitting set for the cycles of
G. In the feedback vertex set problem (FVS), the input is an undirected graph G= (V, E)with non-
negative vertex costs c:Vâ†’Râ‰¥0and the goal is to find a feedback vertex set of minimum cost, i.e.,
minnP
uâˆˆUc(u):UâŠ†VandUis a feedback vertex set for Go
. FVSisafundamentalvertexdeletionprob-
lem in the field of combinatorial optimization and appears in Karpâ€™s list of 21 NP-Complete problems (as
a decision version). We consider the approximability of FVS, in particular via polynomial-time solvable
polyhedral formulations. First, we mention some known lower bounds. Via a simple reduction, the well-
known weighted vertex cover problem can be reduced to FVS in an approximation preserving fashion. Hence,
known results for the vertex cover problem imply that there is no polynomial-time (2âˆ’Ïµ)-approximation
for every fixed constant Ïµ >0under the Unique Games Conjecture (UGC) [KR08] and that there is no
polynomial-time (1.36âˆ’Ïµ)-approximation for every fixed constant Ïµ >0under the PÌ¸=NPassumption
[DS05].
Approximation algorithms for the unweighted version of FVS (UFVS), i.e., when all vertex costs are one,
havebeenstudiedsince1980s. An O(logn)-approximationforUFVSisimplicitintheworkofErdÃ¶sandPÃ³sa
[EP62]; Monien and Schulz [MS81] seem to be the first ones to explicitly study the problem, and obtained an
O(âˆšlogn)-approximationforUFVS.Bar-Yehuda, Geiger, Naor, andRoth[BYGNR98]improvedtheratiofor
UFVS to 4, and also noted that an O(logn)-approximation holds for FVS. Soon after that, Bafna, Berman,
and Fujito [BBF95], and independently Becker and Geiger [BG96], obtained 2-approximation algorithms for
FVS. While [BBF95] explicitly uses the local-ratio terminology, [BG96] describes the algorithm in a purely
combinatorial fashion. Although the algorithm in [BBF95] is described via the local-ratio method, the
underlying LP relaxation is not obvious. As observed in [BYGNR98], the natural hitting set LP relaxation
for FVS has an integrality gap of Î˜(log n). Chudak, Goemans, Hochbaum, and Williamson [CGHW98]
described exponential sized integer linear programming (ILP) formulations for FVS, and showed that the
algorithms in [BBF95, BG96] can be viewed as primal-dual algorithms with respect to the LP relaxations
of these formulations. This also established that these LP relaxations have an integrality gap of at most 2.
Fujito [Fuj99] considered a unified generalization of FVS and vertex cover, namely matroidal FVS, and gave
aO(logn)-approximation for matroidal FVS via connections to submodular set cover. In the same work,
Fujito formulated an exponential sized ILP for matroidal FVS, and designed a primal-dual algorithm with
respect to its LP relaxation. He proved that the algorithm has an approximation ratio of 2for a certain
family of matroids. When specialized to FVS, we note that the ILP and the resulting primal-dual algorithm
in [Fuj99] is slightly different from the one in [CGHW98] although they both yield 2-approximations.
Werecalltheintegerlinearprogram(ILP)formulationandtheassociatedLP-relaxationfrom[CGHW98].
For a graph G= (V, E)and a subset SâŠ†V, letE[S]:=
{u, v} âˆˆE:u, vâˆˆS	
andG[S]:= (S, E[S]), and
for a vertex vâˆˆV, letdS(v)denote the degree of vinG[S]. We will denote the following polyhedron as the
strong density polyhedron and the constraints describing the polyhedron as strong density constraints1:
PSD(G):=
xâˆˆRV
â‰¥0:X
uâˆˆS(dS(u)âˆ’1)xuâ‰¥ |E[S]| âˆ’ |S|+ 1âˆ€Ssuch that E[S]Ì¸=âˆ…
.(1)
Chudak, Goemans, Hochbaum, and Williamson proved that strong density constraints are valid for FVS and
that the following is an integer linear programming formulation for FVS:
minX
uâˆˆVcuxu:xâˆˆPSD(G)âˆ©ZV
. (FVS-IP: SD)
They interpreted the local-ratio algorithm from [BBF95] as a primal-dual algorithm with respect to2the
1The use of the â€œdensityâ€ terminology will be clear later when we discuss the connection to the densest subgraph problem
and its LP relaxation.
2AnÎ±-approximation with respect to an LP min{cTx:Axâ‰¤b}is an algorithm that returns an integral solution zâˆ—satisfying
Axâ‰¤bsuch that cTzâˆ—â‰¤Î±OPT LP, where OPT LPis the optimum objective value of the LP.
3LP-relaxation of (FVS-IP: SD) that we explicitly write below:
minX
uâˆˆVcuxu:xâˆˆPSD(G)
. (FVS-LP: SD)
Itis,however,notknownwhether(FVS-LP:SD)canbesolvedinpolynomialtime. Equivalently,itisopen
to design a polynomial-time separation oracle for the family of strong density constraints. Moreover, there
has been no other polynomial-time solvable LP relaxation through which one could obtain a 2-approximation
for FVS. This status leads to the following natural question:
Question 1. Does there exist an ILP formulation for FVS whose LP-relaxation can be solved in polynomial
time and has integrality gap at most 2?
The lack of solvable LP relaxations for FVS with small integrality gap has also been a stumbling block
for the design of approximation algorithms for a generalization of FVS called the subset feedback vertex set
problem (Subset-FVS) [ENSZ00]: the input is a vertex-weighted graph Gand a terminal set TâŠ†V, and the
goal is to remove a minimum cost subset of vertices Sto ensure that Gâˆ’Shas no cycle containing a terminal
tâˆˆT. There is an 8-approximation for Subset-FVS [ENZ00] and this is based on a complex algorithm that
combines combinatorial and LP-based techniques. Chekuri and Madan [CM16] formulated a polynomial-
sized integer linear program for Subset-FVS and showed that the integrality gap of its LP-relaxation is at
most 13. They explicitly raised the question of whether the integrality gap of their formulation is better for
FVS; in fact it is open whether their formulationâ€™s integrality gap is at most 2for Subset-FVS.
In this work, we provide an affirmative answer to Question 1 by undertaking a polyhedral study of
FVS and a closely related problem, namely the pseudoforest deletion set problem that will be described
shortly. In addition to formulating polynomial-time solvable LP relaxations with small integrality gap,
it is also of interest to find algorithms that can round fractional solutions to the LP relaxations, and to
understand properties of extreme points of the corresponding polyhedra. Based on several interrelated
technical considerations, we conjecture the following property for the strong density polyhedron:
Conjecture 1. LetG= (V, E)be a graph that contains a cycle. For every extreme point xof the polyhedron
PSD(G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/2.
This conjecture would lead to an alternative proof that the integrality gap of the LP-relaxation (FVS-LP:
SD) is at most 2via iterative rounding (instead of the primal-dual technique). Although we were unable to
resolvethisconjectureforthestrongdensitypolyhedron, wewereabletoshowthatavariantoftheconjecture
holds for a weak density polyhedron (to be defined later). The weak density polyhedron closely resembles
the strong density polyhedron and is associated with an ILP formulation of the pseudoforest deletion set
problem. We also discuss extreme point properties for other formulations later in the paper.
Pseudoforest Deletion Set Problem (PFDS). A connected graph is a pseudotree if it has exactly one
cycle; inotherwordsthereisanedgewhoseremovalresultsinaspanningtree. Agraphisa pseudoforest ifev-
eryconnectedcomponentiseitheracyclicorapseudotree. Foragraph G= (V, E), asubset UâŠ†Visapseud-
oforest deletion set ifGâˆ’Uisapseudoforest. Inthepseudoforestdeletionsetproblem(PFDS),theinputisan
undirected graph G= (V, E)with non-negative vertex costs c:Vâ†’Râ‰¥0and the goal is to find a pseudofor-
est deletion set of minimum cost, i.e., minnP
uâˆˆUc(u):UâŠ†VandUis a pseudoforest deletion set for Go
.
Intuitively, one can see that PFDS is closely related to FVS: we note that a feasible solution for FVS in a
given graph Gis a feasible solution to the PFDS instance on G. Also, finding an FVS in a graph that is a
pseudoforest is easy: for each connected component that is a pseudotree, we remove the cheapest vertex in
its unique cycle. PFDS and FVS are special cases of the more general â„“-pseudoforest deletion problem that
was introduced in [PRS18] from the perspective of parameterized algorithms (FVS corresponds to â„“= 0and
PFDS to â„“= 1). Lin, Feng, Fu, and Wang [LFFW19] studied approximation algorithms for â„“-pseudoforest
deletion problem. In this paper, we restrict attention to PFDS and FVS and do not discuss the more general
4â„“-pseudoforest deletion problem. The status of PFDS is very similar to that of FVS. It has an approxi-
mation preserving reduction from the vertex cover problem and consequently, it is NP-hard, and does not
have a polynomial time (2âˆ’Ïµ)-approximation for every constant Ïµ >0assuming the UGC. It admits a
polynomial-time 2-approximation based on the local-ratio technique [LFFW19]. The authors in [LFFW19]
do not discuss LP relaxations for PFDS. However, the local-ratio technique of [LFFW19] can be converted
to an LP-based 2-approximation for PFDS following the ideas in [CGHW98]. We describe the associated
LP relaxation. A graph G= (V, E)is a2-pseudotree if it is connected and has |E| â‰¥ |V|+ 1(i.e., the graph
has at least 2edges in addition to a spanning tree). We will denote the following polyhedra as weak density
polyhedron and 2-pseudotree cover polyhedron respectively, and the constraints describing them as weak
density constraints and 2-pseudotree cover constraints respectively:
PWD(G):=
xâˆˆRV
â‰¥0:X
uâˆˆS(dS(u)âˆ’1)xuâ‰¥ |E[S]| âˆ’ |S| âˆ€SâŠ†V
,and (2)
P2-PT-cover (G):=
xâˆˆRV
â‰¥0:X
uâˆˆUxuâ‰¥1âˆ€UâŠ†Vsuch that G[U]contains a 2-pseudotree
.(3)
We encourage the reader to compare and contrast the weak density constraints with the strong density
constraints. Weakdensityconstraintsand 2-pseudotreecoveringconstraintsarevalidforPFDS.Inparticular,
the following are ILP formulations for PFDS:
minX
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©ZV
and (PFDS-IP: WD)
minX
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©P2-PT-cover (G)âˆ©ZV
. (PFDS-IP: WD-and-2PT-cover)
The local-ratio technique for PFDS due to Lin, Feng, Fu, and Wang [LFFW19] can be converted to a
2-approximation for PFDS with respect to the following LP-relaxation via the primal-dual technique:
minX
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©P2-PT-cover (G)
. (PFDS-LP: WD-and-2PT-cover)
The family of 2-pseudotree cover constraints admits a polynomial-time separation oracle (see Lemma 18).
However, we do not know a polynomial-time separation oracle for the family of weak density constraints
(similar to the status of strong density constraints), and for this reason we do not know how to solve (PFDS-
LP: WD-and-2PT-cover) in polynomial time3. This leads to the following question (which is the counterpart
of Question 1 for PFDS):
Question 2. Does there exist an ILP formulation for PFDS whose LP-relaxation can be solved in polynomial
time and has integrality gap at most 2?
We emphasize that weak density constraints and our answer to Question 2 will play a crucial role in our
answer to Question 1. Furthermore, we prove an extreme point property of the weak density polyhedron that
closely resembles the extreme point property of the strong density polyhedron mentioned in Conjecture 1.
1.1 Results
We begin with our results for PFDS. These results influence our results for FVS which will be discussed
subsequently.
3We note that Fujitoâ€™s framework [Fuj99] encompasses PFDS and hence a 2-approximation follows from his work. It appears
that [LFFW19] were unaware of [Fuj99]. The authors of this paper also became aware of [Fuj99] after completing an earlier
version. The LP relaxation in [Fuj99] does not appear to have a polynomial-time separation oracle.
5PFDS: ILP formulations and LP integrality gap. We answer Question 2 affirmatively via a new ILP
for PFDS. Our ILP for PFDS is based on Charikarâ€™s LP for the densest subgraph problem (DSG) [Cha00].
In DSG, the input is an undirected graph G= (V, E)and the goal is to find an induced subgraph G[S]of
maximum density where the density of SâŠ†Vis defined as |E(S)|/|S|. We define the density of Gto be
max{|E[S]|/|S|:âˆ… Ì¸=SâŠ†V}. We note that a graph is a pseudoforest if and only if its density is at most
one. Thus, PFDS can equivalently be phrased as the problem of finding a minimum cost subset of vertices
to delete so that the remaining graph has density at most one. Charikar formulated an LP to compute
the density of a graph. The dual of Charikarâ€™s LP can be interpreted as a fractional orientation problem.
Using that dual, we obtain an ILP for PFDS. We describe the details now. Via Charikarâ€™s LP and previous
results, one can show that an unweighted graph Ghas density at most Î»iff the edges of Gcan be fractionally
oriented such that the total fractional in-degree at every vertex is at most Î». For an edge e=uvwe use
variables ye,uandye,vto denote the fractional amount of ethat is oriented towards uandvrespectively. We
recall that in PFDS the goal is to remove vertices such that the residual graph has density at most 1. Thus,
we also have variables xufor each uâˆˆVto indicate whether uis deleted. An edge e=uvis in the residual
graph only if uandvare not deleted. These observations allow us to formulate the an ILP for PFDS based
on the polyhedron below. We refer to this as the orientation polyhedron:
Porient(G):=ï£±
ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£³(x, y):xu+xv+ye,u+ye,vâ‰¥1âˆ€eâˆˆE:e=uv
xu+P
eâˆˆÎ´(u)ye,uâ‰¤1âˆ€uâˆˆV
xuâ‰¥0âˆ€uâˆˆV
ye,uâ‰¥0âˆ€eâˆˆÎ´(u), uâˆˆV.ï£¼
ï£´ï£´ï£´ï£½
ï£´ï£´ï£´ï£¾.
We will denote the projection of Porient(G)to the xvariables by Qorient(G). For non-negative costs
c:Vâ†’Râ‰¥0, we consider the following formulations:
minX
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©ZV
and (PFDS-IP: orient)
minX
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©P2-PT-cover (G)âˆ©ZV
.(PFDS-IP: orient-and-2PT-cover)
WewillbeinterestedintheintegralitygapofthefollowingLP-relaxationof (PFDS-IP: orient-and-2PT-cover):
minX
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©P2-PT-cover (G)
. (PFDS-LP: orient-and-2PT-cover)
Theorem 1. For an input graph G= (V, E)with non-negative costs c:Vâ†’Râ‰¥0,(PFDS-IP: orient) and
(PFDS-IP: orient-and-2PT-cover) are integer linear programming formulations for PFDS. Moreover, we have
the following properties:
(1)Qorient (G)âŠ†PWD(G)for every graph Gand there exist graphs Gfor which Qorient (G)âŠŠPWD(G).
(2) The LP (PFDS-LP: orient-and-2PT-cover) is solvable in polynomial time and its integrality gap is at
most 2.
We note that a necessary step for showing Theorem 1(1) is to show that there exists a polynomial-time
separationoracleforthefamilyof 2-pseudotreecoverconstraints. WeincludeaproofofthisfactinLemma18
in Appendix A.1 for the sake of completeness. We also note that the upper bound of 2on the integrality gap
of(PFDS-LP:orient-and-2PT-cover)mentionedinTheorem1istightasshowninFigure1. Asaconsequence
of Theorem 1, we immediately obtain an integer linear program for PFDS whose LP-relaxation is solvable
in polynomial time and has integrality gap at most 2â€” namely (PFDS-IP: orient-and-2PT-cover). We also
bound the integrality gap of the LP-relaxation of (PFDS-IP: orient), but this will be based on extreme point
properties and will be discussed next.
6Figure 1: An example showing that the integrality gap of (PFDS-LP: orient-and-2PT-cover) tends to 2as
ntends to infinity. Consider the graph G= (V, E)as shown above (where Kndenotes the complete graph
onnvertices) with cost of every vertex aâˆˆVâˆ’ {u, v, w }being 1and costs of vertices u, v, wbeing infinite.
The optimum value of (PFDS-IP: orient-and-2PT-cover) is nâˆ’1. The optimum value of (PFDS-LP: orient-
and-2PT-cover) is at most n/2: the solution xa= 1/2for every vertex aâˆˆVâˆ’{u, v, w },xu=xv=xw= 0,
ye,a= 0for all edges e=abwhere a, bâˆˆVâˆ’{u, v, w },yuv,v=yvw,w =ywu,u= 1,yuv,u=yvw,v=ywu,w = 0,
andyua,a= 1/2,yua,u= 0for every aâˆˆVâˆ’ {u, v, w }is feasible for (PFDS-LP: orient-and-2PT-cover) and
has cost n/2.
PFDS: extreme point properties. Motivated by Conjecture 1 and the goal of designing primal rounding
algorithms for PFDS (and thus, for FVS), we investigate extreme point properties of the weak density
polyhedron and the orientation polyhedron. Although we were unable to resolve Conjecture 1 for the strong
density polyhedron, we were able to prove an extreme point property for the weak density polyhedron.
Theorem 2. LetG= (V, E)be a graph that is not a pseudoforest. For every extreme point xof the
polyhedron PWD(G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
Our proof of Theorem 2 is based on a conditional supermodularity propertyâ€”if all coordinates are small,
then the weak density constraints have a supermodular property; we use this supermodular property to
show the existence of a structured basis for the extreme point which is subsequently used to arrive at a
contradiction. To the best of authorsâ€™ knowledge, the conditional supermodularity property based proof
has not previously appeared in the literature on iterated rounding, and might be of independent interest.
Theorem 2 implies the corollary below regarding the following LP-relaxation of (PFDS-IP: WD):
minX
uâˆˆVcuxu:xâˆˆPWD(G)
. (PFDS-LP: WD)
Corollary 2.1. The integrality gap of (PFDS-LP: WD) is at most 3.
Corollary 2.1 can be seen to follow from Theorem 2 by the iterative rounding technique, where we
repeatedly apply the following two steps until the graph Gis a pseudoforest: (1) Compute an extreme point
optimum solution xof (PFDS-LP: WD). (2) By Theorem 2, there exists a vertex uâˆˆVsuch that xuâ‰¥1/3;
include the vertex uin the solution and remove it from the graph G. The approximation factor of the
solution constructed by this procedure relative to the starting extreme point optimum solution to the LP is
at most 3. The example given in Figure 2a shows that the (1/3)-bound in Theorem 2 and the integrality
gap of 3mentioned in Corollary 2.1 are both tight.
We emphasize that the extreme point result given in Theorem 2 and the integrality gap result mentioned
in Corollary 2.1 are interesting only from a polyhedral viewpoint currently, and are not of help from the
perspective of algorithm design. This is because, implementing the above-mentioned iterative rounding
71/30 0
0 0
(a) The unique extreme point in the weak density poly-
hedron along the all-ones objective direction for the
butterfly graph is as shown. The largest coordinate is
1/3and all other coordinates are 0. Consequently, the
integrality gap of the LP min{P
uâˆˆVxu:xâˆˆPWD(G)}
is at least 3.1/30 0
0 02/3
1/32/3
1/30
2/31/31/3
1/31/3
0
2/3
(b) A minimal extreme point in the orientation polyhe-
dron along the all-ones objective direction for the but-
terflygraphisasshown. Thelargest x-coordinateis 1/3
and all other x-coordinates are 0. Consequently, the in-
tegrality gap of the LP min{P
uâˆˆVxu:xâˆˆPorient (G)}
is at least 3.
procedure requires us to solve the LP-relaxation (PFDS-LP: WD) in polynomial time, but we do not know
how to do this yet.
We next show that although Qorient(G)is a subset of PWD(G)(as shown in Theorem 1), the extreme
point result for PWD(G)given in Theorem 2 still holds for Qorient(G). We will say that an extreme point of
a polyhedron is minimal if for each variable, reducing the value of that variable by any Ïµ >0while keeping
the rest of the variables unchanged results in a point that is outside the polyhedron. We note that extreme
points of a polyhedron along non-negative objective directions will be minimal.
Theorem 3. LetG= (V, E)be a graph that is not a pseudoforest. For every minimal extreme point (x, y)
of the polyhedron Porient (G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
Similar to Corollary 2.1 that follows from Theorem 2, Theorem 3 implies the corollary below regarding
the following LP-relaxation of (PFDS-IP: orient):
minX
uâˆˆVcuxu:xâˆˆQorient(G)
(PFDS-LP: orient)
Corollary 3.1. The integrality gap of (PFDS-LP: orient) is at most 3. Moreover, given an extreme point
optimum solution xfor the LP, there exists a polynomial time algorithm to obtain an integral feasible solution
xâ€²for the LP-relaxation such thatP
uâˆˆVcuxâ€²
uâ‰¤3P
uâˆˆVcuxu.
Corollary 3.1 can be seen to follow from Theorem 3 by the iterative rounding technique, where we
repeatedly apply the following two steps until the graph Gis a pseudoforest: (1) Compute an extreme point
optimum solution xofminnP
uâˆˆVcuxu:xâˆˆQorient(G)o
. (2) By Theorem 3, there exists a vertex uâˆˆV
such that xuâ‰¥1/3; include the vertex uin the solution and remove it from the graph G. The approximation
factor of this procedure is 3. In contrast to the weak density constraints based LP, namely (PFDS-LP: WD),
we can solve the orientation based LP, namely (PFDS-LP: orient), in polynomial time. The example given in
Figure 2b shows that the (1/3)-factor in Theorem 3 and the integrality gap of 3mentioned in Corollary 3.1
are both tight.
81/3 1/3
1/3 1/3
Figure 3: The unique extreme point optimum for (FVS-LP: WD-and-cycle-cover) along the all-ones objective
direction on the complete graph K4is as shown. Consequently, the integrality gap of (FVS-LP: WD-and-
cycle-cover) is at least 3.
FVS: poly-sized ILP formulations and LP integrality gaps. Next, we answer Question 1 affirma-
tively via a new ILP for FVS. In order to achieve this goal, we formulate an intermediate ILP for FVS
whose LP-relaxation has integrality gap at most 2, but it is unclear if this LP-relaxation is polynomial-time
solvable. We will later formulate a polynomial-sized ILP for FVS whose LP-relaxation is at least as strong
as that of the intermediate ILP, thereby achieving our goal. Our intermediate ILP is based on weak density
constraints and the following polyhedron that will be referred to as the cycle cover polyhedron:
Pcycle-cover (G):=
xâˆˆRV
â‰¥0:X
uâˆˆUxuâ‰¥1âˆ€UâŠ†Vsuch that G[U]contains a cycle
.(4)
We will denote the constraints describing the cycle cover polyhedron as cycle cover constraints. It is known
that the integrality gap of this polyhedron for FVS is Î˜(log n)[BYGNR98].
For non-negative costs c:Vâ†’Râ‰¥0, we consider the following formulation and its LP-relaxation:
minX
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©Pcycle-cover (G)âˆ©ZV
and (FVS-IP: WD-and-cycle-cover)
minX
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©Pcycle-cover (G)
. (FVS-LP: WD-and-cycle-cover)
Theorem4. For aninput graph G= (V, E)with non-negative costs c:Vâ†’Râ‰¥0,(FVS-IP: WD-and-cycle-cover)
isan integerlinear programming formulationfor FVS. Moreover, theintegralitygap of (FVS-LP: WD-and-cycle-cover)
is at most 2.
Theorem 4 shows that (FVS-IP: WD-and-cycle-cover) is an ILP for FVS whose LP-relaxation (FVS-LP:
WD-and-cycle-cover) has integrality gap at most 2. However, we do not have a polynomial-time algorithm
to solve the LP-relaxation (FVS-LP: WD-and-cycle-cover). This is because, we do not have a polynomial-
time separation oracle for the family of weak density constraints (although we do have a polynomial-time
separation oracle for the family of cycle cover constraints).
Remark 1. In the spirit of using iterative rounding to bound integrality gaps (e.g., Theorem 2 that leads
to Corollary 2.1 and Theorem 3 that leads to Corollary 3.1), it is tempting to bound the integrality gap of
(FVS-LP: WD-and-cycle-cover) by proving an extreme point result. In particular, if we could show that
every extreme point optimum of (FVS-LP: WD-and-cycle-cover) had a coordinate with value at least 1/2,
then we would have an alternative proof of the integrality gap bound mentioned in Theorem 4 via the iterative
rounding technique. However, the example given in Figure 3 shows that there exists an extreme point optimum
of (FVS-LP: WD-and-cycle-cover) all of whose coordinates have value at most 1/3.
We will use Theorem 1 in conjunction with Theorem 4 to prove the following result:
9Theorem 5. There exists a polynomial-sized integer linear programming formulation for FVS whose LP-
relaxation has integrality gap at most 2.
We prove Theorem 5 by showing three different polynomial-sized integer linear programs for FVS all of
whose LP-relaxations have integrality gap at most 2:
1. The first formulation is
minX
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©Pcycle-cover (G)âˆ©ZV
.(FVS-IP: orient-and-cycle-cover)
By Theorem 1(1), we have that Qorient(G)âŠ†PWD(G). As a consequence of Theorem 4, the integrality
gap of the following LP-relaxation is also at most 2:
minX
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©Pcycle-cover (G)
.(FVS-LP: orient-and-cycle-cover)
Both Qorient(G)andPcycle-cover (G)admitapolynomial-sizeddescription(seeLemma19inAppendixB.1
for polynomial-sized description of Pcycle-cover (G)), and thus, we have a polynomial-sized ILP for FVS
whose LP-relaxation has integrality gap at most 2.
2. The second formulation is the Chekuri-Madan formulation who, as we remarked earlier, formulated an
ILP for Subset-FVS and showed that the integrality gap of its LP-relaxation is at most 13[CM16]. We
show that their LP-relaxation specialized for FVS has integrality gap at most 2by proving that it is at
least as strong as (FVS-LP: orient-and-cycle-cover). Our result gives additional impetus to improving
the integrality gap of their LP-relaxation for Subset-FVS.
3. Our third formulation to prove Theorem 5 is based on the orientation perspective, but without cycle
cover constraints (as opposed to our first formulation). Here, we give an orientation based ILP formu-
lation whose associated polyhedron is contained in the strong density polyhedron. Since the integrality
gap of (FVS-LP: SD) is at most 2(as shown by Chudak, Goemans, Hochbaum, and Williamson
[CGHW98]), the integrality gap of our third formulation is also at most 2.
We emphasize that the proof of the integrality gap of the LP-relaxation of all three of our ILPs rely on
the integrality gap upper bound of (FVS-LP: WD-and-cycle-cover) or (FVS-LP: SD). It would be interesting
to have a direct proof. In particular, it would be useful to design a primal rounding algorithm (for arbitrary
LP-optimum solutions or for extreme point LP-optimum solutions) that yields a 2-approximate solution.
Organization. We focus on PFDS in Section 3 and FVS in Section 4. In Section 3.1, we prove properties of
the orientation polyhedron and show Theorem 1. In Sections 3.2 and 3.3, we prove extreme point properties
of the weak density polyhedron and the orientation polyhedron and show Theorems 2 and 3 respectively. In
Section 4.1, we prove properties of the weak density polyhedron and show Theorem 4. In Section 4.2, we
give a polynomial-sized ILP formulation for FVS with integrality gap at most 2, thereby proving Theorem 5.
For the sake of completeness, we discuss two additional polynomial-sized ILP formulations for FVS with
integrality gap at most 2in Section 4.3.
2 Preliminaries
For a minimization IP min{cTx:Axâ‰¤b, xâˆˆZn
â‰¥0}, theintegrality gap of its LP-relaxation min{cTx:Axâ‰¤
b, xâ‰¥0}is the maximum ratio, over all non-negative cost functions, of the minimum cost of a feasible
solution to the IP and that of the LP, i.e., max câˆˆRnmin{cTx:Axâ‰¤b, xâˆˆZn
â‰¥0}/min{cTx:Axâ‰¤b, xâ‰¥0}.
For a graph G= (V, E), we will use Î´(A, B)to denote the set of edges with exactly one end-vertex in Aand
exactly one end-vertex in B. We summarize the results of Lin, Feng, Fu, and Wang [LFFW19] in a manner
that will be useful for our polyhedral study.
10Theorem 6. (PFDS-IP: WD) and (PFDS-IP: WD-and-2PT-cover) are ILP formulations for PFDS. Fur-
themore, the LP-relaxation (PFDS-LP: WD-and-2PT-cover) has integrality gap at most 2.
We emphasize that Lin, Feng, Fu, and Wang did not prove Theorem 6 directly, but their local ratio
based algorithm and standard techniques to convert local ratio based algorithms to LP-based primal-dual
algorithms (following the ideas in [CGHW98]) lead to the theorem.
3 Pseudoforest Deletion Set
In this section, we formally prove our main results for Pseudoforest Deletion Set. We prove Theorem 1 in
Section 3.1, Theorem 2 in Section 3.2, and Theorem 3 in Section 3.3.
3.1 Orientation and 2-Pseudotree Cover constraints
In this section, we restate and prove Theorem 1.
Theorem 1. For an input graph G= (V, E)with non-negative costs c:Vâ†’Râ‰¥0,(PFDS-IP: orient) and
(PFDS-IP: orient-and-2PT-cover) are integer linear programming formulations for PFDS. Moreover, we have
the following properties:
(1)Qorient (G)âŠ†PWD(G)for every graph Gand there exist graphs Gfor which Qorient (G)âŠŠPWD(G).
(2) The LP (PFDS-LP: orient-and-2PT-cover) is solvable in polynomial time and its integrality gap is at
most 2.
Proof.In order to show that (PFDS-IP: orient) and (PFDS-IP: orient-and-2PT-cover) are ILP formulations
for PFDS, it suffices to show that the ILP (PFDS-IP: orient) is a formulation for PFDS. This is because
2-pseudotree cover constraints are valid for PFDS.
For a subgraph ËœG= (ËœV ,ËœE)of the graph G, we let dËœG(u):=|Î´(u)âˆ©ËœE|denote the degree of the vertex u
in the subgraph ËœG. We now define an intermediate polyhedron PWD-Subgraphs (G).
PWD-Subgraphs (G):=ï£±
ï£²
ï£³xâˆˆRV
â‰¥0:X
uâˆˆËœV(dËœG(u)âˆ’1)xuâ‰¥ |ËœE| âˆ’ |ËœV| âˆ€subgraphs ËœG= (ËœV ,ËœE)ofG.ï£¼
ï£½
ï£¾.(5)
We note that PWD-Subgraphs (G)âŠ†PWD(G). We will use the following claim to show that the ILP (PFDS-IP:
orient) formulates PFDS and also to conclude that Qorient(G)âŠ†PWD(G).
Claim 1. Qorient (G)âŠ†PWD-Subgraphs (G).
Proof.LetxâˆˆQorient(G). Then, there exists a vector ysuch that (x, y)âˆˆPorient(G). Let ËœG= (ËœV ,ËœE)be an
arbitrary subgraph of G. We have the following:
|ËœE| â‰¤X
e=vwâˆˆËœE(xv+xw+ye,v+ye,w)
=X
vâˆˆËœV(dËœG(v)âˆ’1)xv+X
vâˆˆËœVï£«
ï£¬ï£­xv+X
eâˆˆÎ´ËœG(v)ye,vï£¶
ï£·ï£¸
â‰¤X
vâˆˆËœV(dËœG(v)âˆ’1)xv+|ËœV|,
where the inequalities are because the vector (x, y)âˆˆPorient. Rearranging the above inequality gives the
constraint for ËœGgiven in PWD-Subgraphs (G). Hence, xâˆˆPWD-Subgraphs (G).
11We remark that Claim 1 can be strengthened to show that Qorient(G) =PWD-Subgraphs (G), but we will
not need this stronger version for the purposes of this theorem. We now show that the ILP (PFDS-IP:
orient) formulates PFDS. Let SâŠ†Vbe a pseudoforest deletion set, i.e., the subgraph F:=Gâˆ’Sis a
pseudoforest. Let x:=Ï‡Sâˆˆ {0,1}Vdenote the indicator vector of the set S. Select an arbitrary orientation
of the pseudoforest Fsuch that the maximum indegree of every vertex is at most 1, and let ye,v:= 1for the
edge e=vwifeis an edge of Fthat is oriented towards v, and ye,v:= 0otherwise. Then, (x, y)âˆˆPorient(G).
Next, suppose xâˆˆQorient(G)âˆ©ZV. Then, we have that xâˆˆ {0,1}V. By Claim 1, xâˆˆPWD-Subgraphs (G)âŠ†
PWD(G). Since (PFDS-IP: WD) is an ILP formulation for PFDS by Theorem 6, it follows that the set
S:={uâˆˆV:xu= 1}is a pseudoforest deletion set for the graph G. This concludes the proof that the ILP
(PFDS-IP: orient) formulates PFDS.
We now prove the two additional conclusions of the theorem statement.
(1) By Claim 1, we have that Qorient(G)âŠ†PWD-Subgraphs (G)âŠ†PWD(G). We now show that there is a
graph Gsuch that PWD-Subgraphs (G)âŠŠPWD(G). In particular, we consider the graph K5= (V, E)
where V={v1, v2, . . . , v 5}andE= V
2
. Let x= (2/3,2/3,1/3,0,0). We note that xâˆˆPWD(K5).
We now show that xÌ¸âˆˆPWD-Subgraphs (K5). Consider the subgraph ËœG= (ËœV ,ËœE)obtained by removing
the edge {v1, v2}from the graph G, i.e. ËœV=Vand ËœE= V
2
âˆ’ {v1, v2}. Then, we have the following:
X
uâˆˆËœV(dËœG(u)âˆ’1)xu= 2x1+ 2x2+ 3x3+ 3x4+ 3x5=11
3<4 =|ËœE| âˆ’ |ËœV|.
In particular, the vector xdoes not satisfy the constraint of PWD-Subgraphs (K5)defined by the subgraph
ËœG. Thus, we have that Qorient(K5)âŠ†PWD-Subgraphs (K5)âŠ‚PWD(K5).
(2) By Theorem 6, the ILP (PFDS-IP: WD-and-2PT-cover) is a valid formulation of PFDS and its LP-
relaxation (PFDS-LP: WD-and-2PT-cover) has integrality gap at most 2. We have already shown
that the ILP (PFDS-IP: orient-and-2PT-cover) is a valid formulation of PFDS and that Qorient(G)âŠ†
PWD(G). Consequently, the integrality gap of (PFDS-LP: orient-and-2PT-cover) is at most 2. Finally,
we note that (PFDS-LP: WD-and-2PT-cover) can be solved in polynomial time because Qorient(G)is
the projection of Porient(G)which admits a polynomial sized description, and because 2-pseudotree-
cover constraints admit a polynomial time separation oracle by Lemma 18 (in Appendix A.1). The
polynomial time separation oracle for 2-pseudotree-cover constraints is based on the fact that node-
weighted Steiner tree for constant number of terminals is solvable in polynomial time. We present its
proof in a separate subsection for clarity.
3.2 Extreme point property of the Weak Density polyhedron
In this section, we prove Theorem 2. We restate it below.
Theorem 2. LetG= (V, E)be a graph that is not a pseudoforest. For every extreme point xof the
polyhedron PWD(G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
For a fixed xâˆˆRV, we define the function fx:2Vâ†’Ras
fx(S):=|E[S]| âˆ’ |S| âˆ’X
uâˆˆS(dS(u)âˆ’1)xuâˆ€SâŠ†V.
Using this function, we can express the weak density polyhedron as
PWD(G) =n
xâˆˆRV
â‰¥0:fx(S)â‰¤0âˆ€SâŠ†Vo
.
12In Section 3.2.1, we recall properties of supermodular functions and chain set families. In Section 3.2.2,
we show that if xuâ‰¤1/2for all uâˆˆV, then the function fx:2Vâ†’Ris supermodular. This conditional
supermodularity property allows us to uncross the tight constraints that form a basis of an extreme point
xfor which xuâ‰¤1/2for all uâˆˆV. We prove properties about the tight constraints in Section 3.2.3 and
show the existence of a chain basis in Section 3.2.4. Using the chain basis structure and its properties, we
complete the proof of Theorem 2 in Section 3.2.5.
Notation. Letb(S):=|E[S]| âˆ’ |S|for all SâŠ†V. For vertex uâˆˆV, letÏ‡uâˆˆ {0,1}Vdenote the indicator
vector of u. For a subset SâŠ†V, let row(S)denote the row of the constraint matrix of PWD(G)corresponding
to the set S, i.e,
row(S)u=(
dS(u)âˆ’1ifuâˆˆS
0 o.w.âˆ€uâˆˆV.
ForJâŠ†2V, let Rows (J) ={row(S):SâˆˆJ}. When the context is clear, we also use Rows (J)to denote the
submatrix of the weak density polyhedron constraint matrix given by the set Rows (J). We let span(Rows (J))
denote the spanof the set of vectors Rows (J), i.e. the smallest linear subspace that contains the set Rows (J).
We let columns (J)denote the set of columns of the submatrix Rows (J). For matrix M, we denote rank(M)
as therankof the matrix. We note that rank(Rows (J)) = rank(columns (J)). For xâˆˆRV, we will use
gx(S):=P
uâˆˆS(dS(u)âˆ’1)xufor all SâŠ†V,Tx:={SâŠ†V:fx(S) = 0}be the tight sets for x, and
Z:={uâˆˆV:xu= 0}. Let xâˆˆP(G)be an extreme point of the weak density polyhedron. For JâŠ† Tx, we
say that the set Rows (J)is abasisforxifspan(Rows (J)) = span(Rows (2V)).
3.2.1 Background on supermodular functions and set families
Here, we recall supermodular functions, chain set families, and some of their properties that will be useful
while proving the extreme point property of the weak density polyhedron. A set function f:2Vâ†’Ris said
to besupermodular iff(A) +f(B)â‰¤f(Aâˆ©B) +f(AâˆªB)for all subsets A, BâŠ†V. We refer the reader
to [Fuj05] for background on supermodular set functions and their properties. We will rely on the following
property:
Proposition 1. LetG= (V, E)be an undirected graph with non-negative edge weights w:Eâ†’Râ‰¥0. Then,
the function f:2Vâ†’Râ‰¥0defined by f(S):=P
eâˆˆE[S]wefor all SâŠ†Vis supermodular.
Two sets AandBare said to crossif they have a non-empty intersection and neither set is contained
in the other, i.e. Aâˆ©B, Aâˆ’B, Bâˆ’AÌ¸=âˆ…. For a ground set V, the set C={A1, A2, . . . A â„“} âŠ†2Vis said
to be achain family if its elements can be ordered such that A1âŠ†A2âŠ†. . .âŠ†Aâ„“. We need the following
proposition on chain families. This is well-known but we give a proof for the sake of completeness.
Proposition 2. LetCbe a chain family and Abe a subset that crosses some set Bâˆˆ C. Then, the number
of sets in Ccrossed by AâˆªBandAâˆ©Bis strictly less than the number of sets in Ccrossed by A.
Proof.Our strategy will be to pick an arbitrary set in Cthat crosses the set AâˆªB(resp. Aâˆ©B) and show
that this picked set also crosses the set A. The claim then follows since the set Bcrosses the set Abut not
the set AâˆªB(resp Aâˆ©B).
LetPâˆˆ Cbe an arbitrary set that crosses the set AâˆªB. Since both B, Pâˆˆ C, it must be that either
PâŠ‚BorBâŠ‚P. First, we consider the case where PâŠ‚B. Then PâŠ‚AâˆªBand thus does not cross the set
AâˆªBas it is contained in it. This contradicts the choice of P. Next, we consider the case where BâŠ‚P. If
AâŠ†Pthen AâˆªBâŠ†P, contradicting choice of Pcrossing AâˆªB. Furthermore, if PâŠ†A, then BâŠ‚PâŠ†A,
contradicting the hypothesis that the set Bcrosses the set A. Finally, Aâˆ©PÌ¸=âˆ…asAâˆ©BÌ¸= 0andBâŠ‚P.
Thus the set Pcrosses the set A.
LetPâˆˆ Cbe an arbitrary set that crosses the set Aâˆ©B. Since the sets P, Bâˆˆ Care part of a chain
family, it must be that either PâŠ†BorBâŠ†P. IfBâŠ†P, then Aâˆ©BâŠ†P, contradicting the choice of set
P. Thus PâŠ†B. IfPâŠ†A, then PâŠ†Aâˆ©B, contradicting the choice of set P. Moreover, if AâŠ†P, then we
have that AâŠ†B, contradicting that AandBcross. Thus the set Pcrosses the set A.
133.2.2 Conditional supermodularity of Weak Density constraints
We now show that the function fxis supermodular if xu<1
2âˆ€uâˆˆV.
Lemma 1. LetxâˆˆRV. Ifxu<1
2âˆ€uâˆˆV, then the function fxis supermodular.
Proof.LetSâŠ†V. We have
fx(S) =|E[S]| âˆ’ |S| âˆ’X
uâˆˆS(dS(u)âˆ’1)xu
=|E[S]| âˆ’X
uâˆˆSdS(u)xuâˆ’ |S|+X
uâˆˆSxu
=|E[S]| âˆ’X
uâˆˆSX
vâˆˆÎ´(u)xuâˆ’X
uâˆˆS(1âˆ’xu)
=|E[S]| âˆ’X
uvâˆˆE[S](xu+xv)âˆ’X
uâˆˆS(1âˆ’xu)
=X
uvâˆˆE[S] 
1âˆ’(xu+xv)
âˆ’X
uâˆˆS(1âˆ’xu).
Thus, the function fxcan be expressed as fx=pxâˆ’qxfor functions px, qx:2Vâ†’Rdefined by px(S):=P
uvâˆˆE[S](1âˆ’(xu+xv))andqx(S):=P
uâˆˆS(1âˆ’xu). Since xu<1/2for all uâˆˆV, we have that px(S)â‰¥0
andqx(S)â‰¥0for all SâŠ†V.
Now, let H= (V, E)be a graph with edge weights w:Eâ†’Rdefined by w(uv):= 1âˆ’(xu+xv). We note
that the edge weights are non-negative since xa<1/2for all aâˆˆV. By definition, px(S) =P
uvâˆˆE[S]w(uv)
for all SâŠ†V. By Proposition 1, the function pxis supermodular. Moreover, the function qxis modular.
Thus, the function fxis the sum of a supermodular function and a modular function. Consequently, fxis a
supermodular function.
3.2.3 Conditional properties of tight sets
Next, we prove certain properties of tight sets that help us to prove the existence of a well-structured basis
for the extreme point xunder the condition that xu<1/2for every uâˆˆV.
Lemma 2 (Conditional Uncrossing Properties) .Letxbe an extreme point of PWD(G)such that xu<1
2for
alluâˆˆVand the family of tight sets for xbeTx:={SâŠ†V:fx(S) = 0}. Let A, Bâˆˆ T. Then,
1.Aâˆ©BÌ¸=âˆ…, i.e., tight sets overlap,
2.Aâˆ©B, AâˆªBâˆˆ Tx, i.e. tight sets form a lattice family,
3.Î´(Aâˆ’B, Bâˆ’A) =âˆ…, i.e. tight sets admit no crossing edges, and
4.row(A) +row(B) =row(Aâˆ©B) +row(AâˆªB).
Proof.We recall that for a set SâŠ†V, we denote b(S):=|E[S]| âˆ’|S|. Moreover, for the point xâˆˆPWD(G),
we denote gx(S):=P
uâˆˆS(dS(u)âˆ’1)xu. We prove each property separately below.
141. By way of contradiction, assume that Aâˆ©B=âˆ…. We have that
b(AâˆªB)â‰¤gx(AâˆªB)
=gx(A) +gx(B) +X
abâˆˆÎ´(A,B)(xa+xb)
=|E[A]âˆ’ |A|+|E[B]âˆ’ |B|+X
abâˆˆÎ´(A,B)(xa+xb)
=|E[AâˆªB]| âˆ’ |AâˆªB| âˆ’ |Î´(A, B)|+X
abâˆˆÎ´(A,B)(xa+xb)
=b(AâˆªB)âˆ’ |Î´(A, B)|+X
abâˆˆÎ´(A,B)(xa+xb)
< b(AâˆªB)âˆ’ |Î´(A, B)|+|Î´(A, B)|,
a contradiction. Here, the first inequality is by the weak density constraint for the set AâˆªB. The
first and third equalities are by the hypothesis that Aâˆ©B=âˆ…. The final inequality is because xu<1
2
âˆ€uâˆˆV.
2. We have the following:
0 =fx(A) +fx(B)â‰¤fx(AâˆªB) +fx(Aâˆ©B)â‰¤0.
Here, the first equality is due to the sets A, Bâˆˆ Tx, and thus fx(A) =fx(B) = 0. The first inequality
follows from supermodularity of the function fxshown in Lemma 1. The final inequality follows from
weak density constraints for the sets AâˆªBandAâˆ©B. Thus, all inequalities are equalities, and we
have that fx(Aâˆ©B) =fx(AâˆªB) = 0using weak density constraints on the respective sets.
3. By way of contradiction, assume that Î´(Aâˆ’B, Bâˆ’A)Ì¸=âˆ…. Since A, Bâˆˆ Tx, we have that Aâˆ©B,
AâˆªBâˆˆ Txby the previously shown property that tight sets uncross. Thus, fx(A) = fx(B) =
fx(Aâˆ©B) =fx(AâˆªB) = 0. We have that
0 =fx(A) +fx(B)âˆ’fx(Aâˆ©B)âˆ’fx(AâˆªB) =X
uvâˆˆÎ´(Aâˆ’B,Bâˆ’A) 
1âˆ’(xu+xv)
>0,
a contradiction. Here, the second equality is by definition of fx, and the final inequality is because
xu<1
2âˆ€uâˆˆV.
4. Let uâˆˆVbe an arbitrary vertex. It suffices to show that (dA(u)âˆ’1) + ( dB(u)âˆ’1) = ( dAâˆªB(u)âˆ’1) +
(dAâˆ©B(u)âˆ’1). We consider four cases:
First, we consider the case uâˆˆAâˆ’B. Then, we have that (1) dA(u) =dAâˆ’B(u) +Î´(u, Aâˆ©B),
(2)dB(u) = 0(3)dAâˆ©B(u) = 0and (4) dAâˆªB(u) =dAâˆ’B(u) +Î´(u, Aâˆ©B). Here, (4) follows from
Î´(u, Bâˆ’A) =âˆ…by the previous part. Thus, the claimed equality follows. We note that the argument
for the case where uâˆˆBâˆ’Ais similar to this case.
Next, we consider the case uâˆˆAâˆ©B. Then, we have that (1) dA(u) =dAâˆ©B(u) +Î´(u, Aâˆ’B), (2)
dB(u) =dAâˆ©B(u) +Î´(u, Bâˆ’A), and (3) dAâˆªB(u) =dAâˆ©B(u) +Î´(u, Aâˆ’B) +Î´(u, Bâˆ’A). Thus, the
claimed equality follows.
Finally, we consider the case uâˆˆVâˆ’(AâˆªB). Then, we have that dA(u) =dB(u) =dAâˆ©B(u) =
dAâˆªB(u) = 0and the claimed equality follows.
Next, we show that every tight set is of size at least 2and the graph induced over the tight set is
connected.
15Lemma 3. Letxbe an extreme point of PWD(G)such that xu<1
2for all uâˆˆVand the family of tight
sets for xbeTx:={SâŠ†V:fx(S) = 0}. For every Aâˆˆ Tx, we have that |A| â‰¥2and the graph G[A]is
connected.
Proof.LetAâˆˆ Tx. Suppose that |A|= 1. Let A={u}. Then, Aâˆˆ Tximplies that fx({u}) = 0.
Equivalently, âˆ’xu=âˆ’1and hence, xu= 1, a contradiction. Hence, |A| â‰¥2. Next, we show that G[A]is
connected. By way of contradiction, let A=A1âŠŽA2such that G[A1], G[A2]are disconnected components
ofG[A]. Then, we have the following:
gx(A1) +gx(A2) =gx(A)
=b(A)
=|E[A]| âˆ’ |A|
=|E[A1]| âˆ’ |A1|+|E[A2]| âˆ’ |A2|
=b(A1) +b(A2)
â‰¤gx(A1) +gx(A2).
Here, the first and fourth equalities are because A1âˆ©A2=âˆ…. The second equality holds because Aâˆˆ Tx.
The final inequality holds by the weak density constraints on A1andA2.
The chain of inequalities implies that the final inequality is an equality. By weak density constraints for
A1andA2, we also have that b(A1)â‰¤gx(A1)andb(A2)â‰¤gx(A2)and consequently, A1andA2are tight
sets, i.e., A1, A2âˆˆ Tx. However, A1âˆ©A2=âˆ…by assumption, contradicting Lemma 2 that tight sets must
overlap.
3.2.4 Conditional basis structure for extreme points
In this section, we use the conditional structural properties of tight sets proved in Section 3.2.3 to show that
every extreme point xfor the weak density polyhedron for which xu<1/2for all uâˆˆVhas a well-structured
basis. We recall that a 2-pseudotree is a connected graph that has one more edge than the number of vertices.
The following lemma is the main result of this section.
Lemma 4. Letxbe an extreme point of PWD(G)such that xu<1
2âˆ€uâˆˆV, the family of tight sets for xbe
Tx:={SâŠ†V:fx(S) = 0}, and let Z:={uâˆˆV:xu= 0}. Then, there exists a family C âŠ† T xsuch that
(1) the family Cis a chain family,
(2) the set of vectors Rows (C âˆª Z )is linearly independent,
(3)span(Rows (C âˆª Z )) = span(Rows (Txâˆª Z)),
(4) For each Sâˆˆ C, the subgraph G[S]contains a 2-psuedotree,
(5) For each Sâˆˆ Cand each vertex uâˆˆS, we have that dS(u)â‰¥2, and
(6) For every A, Bâˆˆ Csuch that AâŠ‚B, there exists a vertex vâˆˆBâˆ’Asuch that xv>0.
Proof.We first show that there exists a family satisfying properties (1)-(4). Let C(1)âŠ† Txbe an inclusion-
wise maximal chain family. Claim 2 below shows that span(Rows (C(1))) = span(Rows (Tx)).
Claim 2. span(Rows (C(1))) = span(Rows (Tx)).
Proof.By way of contradiction assume false. Let Aâˆˆ Txsuch that row(A)Ì¸âˆˆspan(Rows (C(1)))andAcrosses
the fewest number of sets in C(1). Consider a set Bâˆˆ C(1)such that Bcrosses A. We note that such a set B
exists since otherwise the family C(1)âˆª{A}contradicts the inclusion-wsie maximality of C(1). Recall that by
Lemma 2, the sets Aâˆ©B, AâˆªBâˆˆ Txare also tight. We note that by Proposition 2, the sets Aâˆ©BandAâˆªB
cross fewer sets in C(1)than the number of sets in C(1)crossed by A. We consider two cases based on whether
16row(AâˆªB),row(Aâˆ©B)âˆˆspan(Rows (C(1))). First, consider the case where row(AâˆªB)Ì¸âˆˆspan(Rows (C(1)))
without loss of generality. Since AâˆªBcrosses fewer sets in C, the set AâˆªBcontradicts the choice of A.
Next, consider the case where row(AâˆªB),row(Aâˆ©B)âˆˆspan(Rows (C(1))). By Lemma 2, we have that
row(A) +row(B) =row(AâˆªB) +row(Aâˆ©B). Thus row(A)âˆˆspan(Rows (B, Aâˆ©B, AâˆªB)), contradicting
choice of A.
LetC(2)âŠ† C(1)be an inclusion-wise maximal family such that the set Rows (C(2)âˆª Z)is linearly inde-
pendent. We note that span(Rows (C(2)âˆª Z)) = span(Rows (C(1)âˆª Z)) = span(Rows (Txâˆª Z)), where the first
equality is because the family C(2)is inclusion-wise maximal. In particular, we have that the family C(2)
satisfies properties (1)-(3). Claim 3 below shows that the family C(2)also satisfies property (4).
Claim 3. For every Sâˆˆ C(2), the subgraph G[S]contains a 2-pseudotree.
Proof.By way of contradiction, let Sâˆˆ C(2)such that G[S]does not contain a 2-pseudotree. Let Si:=
{uâˆˆS:dS(u) =i}andSâ‰¥i:={uâˆˆS:dS(u)â‰¥i}. We note that b(S)â‰¤0since G[S]does not contain a
2-pseudotree. Hence, we have that
0â‰¥b(S) =g(S)
=X
uâˆˆS(dS(u)âˆ’1)xu
=X
uâˆˆS0(dS(u)âˆ’1)xu+X
uâˆˆS1(dS(u)âˆ’1)xu+X
uâˆˆSâ‰¥2(dS(u)âˆ’1)xu
â‰¥X
uâˆˆSâ‰¥2xu
â‰¥0
Here, the first equality holds because Sâˆˆ Tx. The final inequality holds since |S| â‰¥2andG[S]has no
isolated vertices by Lemma 3, and by the non-negativity constraints on vertex variables of PWD(G).
Thus, all inequalities above are equalities, and consequently, we have thatP
uâˆˆSâ‰¥2xu= 0This, coupled
with the non-negativity constraints on vertex variables, implies that xu= 0for each uâˆˆSâ‰¥2. We also
note that row(S)u= 0for each uâˆˆS1âˆªS0asS0=âˆ…anddS(u)âˆ’1 = 0foruâˆˆS1. Thus, we have that
row(S)âˆˆspan(Rows (Z)), contradicting linear independence of Rows (C(2)âˆª Z).
We now show the existence of a family satisfying properties (1)-(5). Let C âŠ† T xbe a family satisfying
properties (1)-(4) which minimizesP
SâˆˆC|S|. We will show that this Calso satisfies property (5). By way
of contradiction, suppose there exists Sâˆˆ Cwith uâˆˆSsuch that dS(u)<2. Since Sâˆˆ Tx, we have that
|S| â‰¥2anddS(u)â‰¥1since tight sets cannot have isolated vertices by Lemma 3. Thus, dS(u) = 1. Let
uvâˆˆE[S]be the unique edge incident to uinG[S]. We note that E[S]should contain at least one more
edge apart from the edge uvas otherwise row(S) = 0. Furthermore, by Lemma 3, the subgraph G[S]must
be connected. Thus, dS(v)â‰¥2and we have the following:
gx(Sâˆ’u) =gx(S)âˆ’xv
=b(S)âˆ’xv
=|E[S]| âˆ’ |S| âˆ’xv
= (|E[Sâˆ’u]|+ 1)âˆ’(|Sâˆ’u|+ 1)âˆ’xv
=b(Sâˆ’u)âˆ’xv
â‰¤gx(Sâˆ’u)âˆ’xv
The above chain of inequalities implies that xvâ‰¤0. By the non-negativity constraints on xv, we have that
xv= 0. Thus, the final inequality in the above chain is in fact an equality, and hence, the set Sâˆ’uis inTx.
We now make three observations:
171.row(S)âˆ’Ï‡v=row(Sâˆ’u)(we note that the LHS subtracts the indicator vector of the vertex vwhile
the RHS considers the row vector of the set Sâˆ’u, where uis the vertex with dS(u) = 1),
2. Every Xâˆˆ Csuch that XâŠ‚Seither has dX(u) = 1orXdoes not contain u, and
3. For every XâŠ‚Ssuch that Xâˆˆ Candu, vâˆˆX,row(X)âˆ’Ï‡v=row(Xâˆ’u).
Here, the first observation is due to dS(u) = 1and thus row(S)u= 0. The second observation follows because
of monotonicity of the induced-degree function and the fact that tight sets cannot have isolated vertices by
Lemma 3. The third observation follows by writing down the corresponding chain of inequalities as above
for each such set X. Then, by the three observations, we can remove the vertex ufrom every set in Cthat
contains uresulting in a set family Câ€²Ì¸=Cthat still satisfies properties (1)-(4). However, we have thatP
SâˆˆCâ€²|S|<P
SâˆˆC|S|, contradicting our choice of family C.
Finally, we show that Calso satisfies property (6). By way of contradiction, assume that there exists
A, Bâˆˆ Csuch that AâŠ‚Bandxu= 0for each uâˆˆBâˆ’A. We first show a lower bound on |Î´(A, Bâˆ’A)|.
Claim 4.|Î´(A,Bâˆ’A)|
2â‰¥ âˆ’b(Bâˆ’A).
Proof.First, we argue that the subgraph G[Bâˆ’A]is a forest. By way of contradiction, suppose that the
subgraph G[Bâˆ’A]contains a cycle. Let Cbe a minimal cycle in the subgraph G[Bâˆ’A]. Then, gx(C) = 0
asxu= 0for each uâˆˆBâˆ’Aby our hypothesis. Furthermore, b(C) = 0asCis a cycle. Thus, Câˆˆ Txis a
tight set. However, since CâŠ†Bâˆ’A, we have that Câˆ©A=âˆ…. This contradicts the fact that all tight sets
must overlap (as shown by Lemma 2).
Letkbe the number of disconnected acyclic components of the forest G[Bâˆ’A]. Then, we have the
following two observations:
1.b(Bâˆ’A) =âˆ’kand
2.|Î´(A, Bâˆ’A)| â‰¥2k.
We note that the claim follows from above observations. We justify these observations next.
The first observation follows from the fact that the subgraph G[Bâˆ’A]is a forest. In particular, we have
that
b(Bâˆ’A) =E[Bâˆ’A]âˆ’ |Bâˆ’A|= 
|Bâˆ’A| âˆ’1
âˆ’(kâˆ’1)
âˆ’ |Bâˆ’A|=âˆ’k.
We now prove the second observation. Each of the kacyclic components of the subgraph G[Bâˆ’A]is
either a singleton or has at least two leaves. If the component is a singleton vertex v, then we have that
|Î´(v, A)|=dB(v)â‰¥2, where the inequality is because Bâˆˆ Cand the family Csatisfies property (5).
Alternatively, suppose that the component has two leaves. Let vbe an arbitrary leaf of the component. We
note that the induced degree dBâˆ’A(v) = 1. Thus, |Î´(v, A)|=dB(v)âˆ’dBâˆ’A(v)â‰¥1, where the inequality is
once again because Bâˆˆ CandCsatisfies property (5).
18With the above lower bound on the cut size |Î´(A, Bâˆ’A)|, we get the required contradiction as follows:
gx(A) +|Î´(A, Bâˆ’A)|
2> gx(A) +X
uvâˆˆÎ´(A,Bâˆ’A)xu
=gx(A) +gx(Bâˆ’A) +X
uvâˆˆÎ´(A,Bâˆ’A)(xu+xv)
=gx(B)
=b(B)
=|E[B]| âˆ’ |B|
= 
|E[A]|+|E[Bâˆ’A]|+|Î´(A, Bâˆ’A)|
âˆ’ 
|A|+|Bâˆ’A|
=b(A) +b(Bâˆ’A) +|Î´(A, Bâˆ’A)|
â‰¥b(A) +|Î´(A, Bâˆ’A)|
2
=gx(A) +|Î´(A, Bâˆ’A)|
2.
The first inequality follows from xu<1/2âˆ€uâˆˆV. The first equality follows from the assumption that
xu= 0for each uâˆˆBâˆ’A. The penultimate inequality follows from Claim 4, and the final equality holds
since the set Aâˆˆ Txis a tight set.
3.2.5 Proof of Theorem 2
We now complete the proof of Theorem 2. In the next lemma, we use a stronger hypothesis that xu<1/3
for all uâˆˆVto show that there exist at least two vertices u, vwhich take non-zero values. We emphasize
that the lemma does not rely on extreme point properties and holds for every feasible point xsatisfying the
hypothesis.
Lemma 5. LetG= (V, E)be a connected graph with minimum degree at least 2such that Gcontains a
2-pseudotree. Let xâˆˆPWD(G)such that xu<1/3for all uâˆˆV. Then, there exist distinct vertices u, vâˆˆV
such that xu, xv>0.
Proof.By way of contradiction, let SâŠ†Vbe a set such that the subgraph G[S]is connected, has minimum-
degree at least 2, contains a 2-pseudotree, but Scontains at most one vertex with a corresponding non-zero
vertex variable. We first consider the case where xv= 0for all vâˆˆS. Observe that in this case, gx(S) = 0.
Consequently, we have that 0 =gx(S)â‰¥b(S) =|E[S]| âˆ’ |S| â‰¥1, a contradiction. Here, the first inequality
is by the weak-density constraint on S, and the second inequality is because G[S]is connected and contains
a2-pseudotreeâ€”this can be observed by starting with the 2-pseudotree, and then charging the remaining
vertices to the edges which connect them to the 2-pseudotree.
We next consider the case where the set Scontains exactly one vertex vâˆˆSsuch that xv>0. It follows
that
(dS(v)âˆ’1)xv=gx(S)â‰¥b(S) =|E[S]| âˆ’ |S|.
Here the first equality is because xvis the only non-zero variable, while the first inequality is by the weak-
density constraint on S. We now consider two cases based on the degree of vinG[S].
First, consider the case where dS(v)â‰¥4. Then we have the following:
xv=|E[S]| âˆ’ |S|
dS(v)âˆ’1â‰¥|S| âˆ’1 +dS(v)
2âˆ’ |S|
dS(v)âˆ’1=1
2
1âˆ’1
dS(v)âˆ’1
â‰¥1
2Â·2
3=1
3,
a contradiction to our hypothesis that xu<1/3âˆ€uâˆˆV. Here, the first inequality is by hypothesis that
dS(u)â‰¥2for each uâˆˆS.
19Next, consider the case where dS(v)â‰¤3. We recall (from the last sentence of the first paragraph) that
b(S) =|E[S]| âˆ’ |S| â‰¥1since G[S]is connected and contains a 2-pseudotree. This gives us the required
contradiction as follows:
1â‰¤b(S)â‰¤gx(S) = (dS(v)âˆ’1)xvâ‰¤2xv<1,
Here, the first inequality holds by the weak-density constraints on S, while the the final inequality holds due
to our hypothesis that xv<1
2.
We use Lemma 5 to conclude the following:
Corollary 5.1. LetG= (V, E)be a connected graph with minimum degree at least 2such that Gcontains a
2-pseudotree. Let xbe an extreme point of PWD(G)such that xu<1
3for all uâˆˆV, the family of tight sets
forxbeTx:={SâŠ†V:fx(S) = 0}, and let Z:={uâˆˆV:xu= 0}. LetC âŠ† T xbe a chain family satisfying
the properties in Lemma 4. Then, for every Sâˆˆ C, there exist distinct vertices u, vâˆˆSsuch that xu, xv>0.
Proof.By Lemma 4, we have that for every Aâˆˆ C, the subgraph G[A]contains a 2-pseudotree. The claim
follows by Lemma 5.
We now restate and prove Theorem 2.
Theorem 2. LetG= (V, E)be a graph that is not a pseudoforest. For every extreme point xof the
polyhedron PWD(G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
Proof.By way of contradiction, let xu<1
3for all uâˆˆV. Let C={C1, C2, C3, . . . , C t}be the chain basis
guaranteed by Lemma 4. We order the sets in the basis so that C0âŠ†C1âŠ†C2âŠ†C3âŠ† Â·Â·Â· âŠ† CtâŠ†Ct+1,
where we denote C0:=âˆ…andCt+1:=Vfor notational convenience. Let NZ(Ci) ={vâˆˆCi:xv>0}. Let
NZ:=NZ(V)be the set of vertices vwith xv>0. Then, NZcan be partitioned as follows: NZ(V) =
âŠŽiâˆˆ[t+1]NC(Ci)\NC(Ciâˆ’1). Hence, we have that
|C|<X
iâˆˆ[t]NZ(Ci)\NZ (Ciâˆ’1)â‰¤ |NZ| .
The first inequality holds due to the following two reasons: (i) |NZ(C1)\NZ (C0)|=|NZ(C1)| â‰¥2by
Corollary 5.1 and (ii) |NZ(Ci)\NZ (Ciâˆ’1)| â‰¥1foriâˆˆ[2, t]by property (6) of Lemma 4. The second
inequality is because |NZ(Ct+1)\NZ (Ct)| â‰¥0and our observation that the set of differences of subsequent
basis sets in the chain ordering of Cpartitions the set of non-zero variables. Thus, we have that
|V|=|Z|+|C|<|Z|+|NZ| =|V|,
a contradiction. The first equality is because xis an extreme point and Cis such that Rows (C âˆªZ )is linearly
independent and span(Rows (C âˆª Z )) = span(Rows (Txâˆª Z))by Lemma 4. The last equality is because the
number of variables is equal to the sum of the number of zero variables and the number of non-zero variables.
3.3 Extreme point property of the Orientation polyhedron
In this section, we prove Theorem 3. We restate it below.
Theorem 3. LetG= (V, E)be a graph that is not a pseudoforest. For every minimal extreme point (x, y)
of the polyhedron Porient (G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
We recall that an extreme point of Porient(G)is said to be minimal if we cannot lower any single variable,
keeping the others unchanged, while maintaining feasibility. Before proceeding with the proof of Theorem 3,
we establish a few lemmas. In the lemmas below, we always assume that Gis not a pseudoforest, (Â¯x,Â¯y)
20is a minimal extreme point of Porient(G)and, aiming toward a contradiction, Â¯x(v)<1/3for all vertices
vâˆˆV(G).
For a graph G, we denote its edge-vertex incidence graph by H. Thus, V(H) =V(G)âˆªE(G)andE(H) =
{ev:eâˆˆE(G), vâˆˆV(G), eâˆˆÎ´(v)}. We note that |V(H)|=|V(G)|+|E(G)|and|E(H)|= 2|E(G)|.
Thesupport graph ofÂ¯yis the subgraph of the incidence graph Hwhose vertices are all the vertices of the
incidence graph Hand whose edges are those for which Â¯ye,v>0. Denoting this subgraph by H(Â¯y), we have
V(H(Â¯y)) =V(H) =V(G)âˆªE(G)andE(H(Â¯y)) ={evâˆˆE(H):Â¯ye,v>0}.
Lemma 6. The support graph H(Â¯y)is a forest.
Proof.Towards a contradiction, suppose that there exists a cycle in H(Â¯y). Since H(Â¯y)is bipartite, the edge
set of this cycle can be partitioned into two matchings M1andM2. Given some Îµ >0, we define two points
Â¯yÂ±âˆˆRE(H)by letting Â¯yÂ±:= Â¯yÂ±ÎµÏ‡M1âˆ“ÎµÏ‡M2. IfÎµis sufficiently small, both (Â¯x,Â¯y+)and(Â¯x,Â¯yâˆ’)are feasible
(that is, belong to the orientation polytope), which contradicts the fact that (Â¯x,Â¯y) =1
2(Â¯x,Â¯y+) +1
2(Â¯x,Â¯yâˆ’)is
extreme.
Lemma 7. The number of (connected) components of H(Â¯y)is|V(G)|âˆ’|E(G)|+m0, where m0denotes the
number of edges evâˆˆE(H)such that Â¯ye,v= 0.
Proof.Wehavethat |V(H(Â¯y))|=|V(G)|+|E(G)|and|E(H(Â¯y))|= 2|E(G)|âˆ’m0bydefinition. ByLemma6,
the number of components of H(Â¯y)is
|V(H(Â¯y))| âˆ’ |E(H(Â¯y))|= (|V(G)|+|E(G)|)âˆ’(2|E(G)| âˆ’m0)
=|V(G)| âˆ’ |E(G)|+m0.
Lemma 8. Every edge e=vwâˆˆE(G), we have Â¯ye,v>0orÂ¯ye,w>0(or both) and Â¯xv+ Â¯xw+ Â¯ye,v+ Â¯ye,w= 1.
Proof.If both Â¯ye,v= 0andÂ¯ye,w= 0then, since (Â¯x,Â¯y)is feasible, we have Â¯xv+ Â¯xwâ‰¥1. Hence, Â¯xvâ‰¥1/2or
Â¯xwâ‰¥1/2, a contradiction.
For the second part, toward a contradiction, suppose that Â¯xv+ Â¯xw+ Â¯ye,v+ Â¯ye,w>1. We may assume (by
symmetry) that Â¯ye,v>0. Then, slightly decreasing Â¯ye,vpreserves the feasibility of (Â¯x,Â¯y). This contradicts
the minimality of (Â¯x,Â¯y).
Now consider a component Tof the support graph H(Â¯y). By Lemma 6, the component Tis a tree. We
define the defectofTas the number vertices vâˆˆV(T)âˆ©V(G)such that Â¯xv>0, plus the number of vertices
vâˆˆV(T)âˆ©V(G)such that Â¯xv+P
eâˆˆÎ´(v)Â¯ye,v<1. Below, we denote this quantity by defect( T).
We say that component TistightifÂ¯xv+P
eâˆˆÎ´(v)Â¯ye,v= 1for all vertices vâˆˆV(T)âˆ©V(G). Tight
components play an important role in our analysis. We seek a tight component with extra properties,
dubbed â€˜interestingâ€™ (Lemma 11 below states that such tight components exist).
Lemma 9. LetTbe a tight component of H(Â¯y). Suppose that some vertex vâˆˆV(G)is a leaf of T. Then
Thas exactly two vertices and Â¯xw= 0for the other vertex wâˆˆV(G)that is incident to the unique edge of
GinT.
Proof.Since Tis tight, we have Â¯xv+P
eâˆˆÎ´(v)Â¯ye,v= 1. If Â¯ye,v= 0for all eâˆˆÎ´(v), we get Â¯xv= 1, a
contradiction. Hence, Thas at least two vertices and we have Â¯ye,v= 0for all eâˆˆÎ´(v)except for precisely
one edge, say f=vw. From Â¯xv+ Â¯yf,v= 1andÂ¯xv+ Â¯xw+ Â¯yf,v+ Â¯yf,w(see Lemma 8), we get Â¯xw+ Â¯yf,w= 0,
which implies Â¯xw= 0andÂ¯yf,w= 0. The result follows.
We will call a tight component Twith exactly two vertices as a dyad. Let Tbe a dyad, say, with
V(T) ={v, f}where vâˆˆV(G)andf=vwâˆˆE(G). We note that xv+P
eâˆˆÎ´(v)ye,v= 1follows from the
tight constraints xv+xw+yf,v+yf,w= 1,xw= 0,ye,v= 0for all eâˆˆÎ´(v)\ {f}andyf,w= 0.
21Lemma 10. LetT1, ..., Tkdenote the components of H(Â¯y)and let ddenote the number of dyads. We have
kX
i=1defect( Ti)â‰¤kâˆ’d . (6)
Proof.The number of variables defining the orientation polytope is |V(G)|+|E(H)|=|V(G)|+2|E(G)|. By
Lemma 8, we can write the total number of constraints that are tight at (Â¯x,Â¯y)as|E(G)|+ntight+n0+m0,
where ntightdenotes the number of vertices vâˆˆV(G)such that Â¯xv+P
eâˆˆÎ´(v)Â¯ye,v= 1,n0denotes the number
of vertices vâˆˆV(G)such that Â¯xv= 0, and m0(as above) denotes the number of edges evâˆˆE(H)such
that Â¯ye,v= 0. For every dyad T, the tight constraint Â¯xv+P
eâˆˆÎ´(v)Â¯ye,v= 1follows from the other tight
constraints, where vis the unique vertex of GinT. Since (Â¯x,Â¯y)is an extreme point, we have that the number
of variables is at most the number of tight constraints. Hence,
|V(G)|+ 2|E(G)| â‰¤ |E(G)|+ntight+n0+m0âˆ’d.
Rewriting the above gives
|V(G)| âˆ’ntight+|V(G)| âˆ’n0â‰¤ |V(G)| âˆ’ |E(G)|+m0âˆ’d .
Inequality (6) follows from this and Lemma 7.
We call a component TofH(Â¯y)interesting if it is tight, has defect at most 1and is not a dyad. By
Lemma 9, interesting components Thave the following properties: (i) Thas at least three vertices, (ii) every
leaf of Tis an edge of G, and (iii) Â¯x(v) = 0for all vertices vâˆˆV(T)âˆ©V(G)except at most one.
Lemma 11. At least one component of H(Â¯y)is interesting.
Proof.First, we observe that if Â¯xv= 0for all vertices vâˆˆV(G), then Gis a pseudoforest, which contradicts
our hypothesis. Hence, there exists a vertex râˆˆV(G)with Â¯xr>0.
LetT1, ..., Tkdenote the components of H(Â¯y). If some Tiwhich is not a dyad has defect( Ti) = 0, then
Tiis interesting. Hence, we may assume that defect( Ti)â‰¥1for all components that are not dyads. By
Lemma 10, this implies defect( Ti) = 0for all dyads and defect( Ti) = 1for all the other components. Then,
the unique component containing ris interesting.
We now restate and prove Theorem 3.
Theorem 3. LetG= (V, E)be a graph that is not a pseudoforest. For every minimal extreme point (x, y)
of the polyhedron Porient (G), there exists a vertex uâˆˆVsuch that xuâ‰¥1/3.
Proof.Aiming toward a contradiction, suppose that Â¯xv<1/3for all vertices vâˆˆV(G). Hence, each one of
the above lemmas apply. Let Tdenote an interesting component of H(Â¯y), which exists by Lemma 11. Since
it is interesting, Thas at least two vertices and each leaf of Tis an edge of G.
LetrâˆˆV(T)âˆ©V(G)denote any vertex such that Â¯xv= 0for all vertices vâˆˆV(T)âˆ©V(G)distinct from
r. We call rtherootofT. For wâˆˆV(G), letdT(w)denote the number of edges eâˆˆV(T)âˆ©E(G)that are
incident to w. (This is a slight abuse of notation since dT(w)is also defined for vertices wâˆˆV(G)outside
ofT.) We let N(T)denote the set of vertices wâˆˆV(G)such that dT(w)>0andw /âˆˆV(T). Finally, we let
L(T)âŠ†E(G)denote the leaf set of T.
By Lemma 8 and since Tis an interesting component of the support graph H(Â¯y), we have
|V(T)âˆ©E(G)| âˆ’ |V(T)âˆ©V(G)|
=X
e=vwâˆˆV(T)âˆ©E(G) 
Â¯xv+ Â¯xw+ Â¯ye,v+ Â¯ye,w
âˆ’X
vâˆˆV(T)âˆ©V(G)ï£«
ï£­Â¯xv+X
eâˆˆÎ´(v)Â¯ye,vï£¶
ï£¸
= (dT(r)âˆ’1)Â¯xr+X
wâˆˆN(T)dT(w)Â¯xw.
22We notice that |V(T)âˆ©E(G)| âˆ’ |V(T)âˆ©V(G)|=|L(T)| âˆ’1. Hence, from the equations above, we get
(dT(r)âˆ’1)Â¯xr+X
wâˆˆN(T)dT(w)Â¯xw=|L(T)| âˆ’1. (7)
LetM:= (dT(r)âˆ’1) +P
wâˆˆN(T)dT(w) = (dT(r)âˆ’1) +|L(T)|denote the sum of the coefficients in the
left-hand side of (7). We note that dT(r)â‰¤ |L(T)|. This implies Mâ‰¤2|L(T)| âˆ’1. Thus,
1
Mï£«
ï£­(dT(r)âˆ’1)Â¯xr+X
wâˆˆN(T)dT(w)Â¯xwï£¶
ï£¸â‰¥|L(T)| âˆ’1
2|L(T)| âˆ’1â‰¥1
3.
This is a contradiction since the left-hand side is an average of values that are all strictly less than 1/3.
4 Feedback Vertex Set
In this section, we prove our main results for FVS. We prove Theorem 4 in Section 4.1 and Theorem 5 in
Section 4.2. We discuss two additional polynomial-sized ILP formulations for FVS with integrality gap at
most 2in Section 4.3.
4.1 Weak Density and Cycle Cover constraints
In this section, we restate and prove Theorem 4.
Theorem4. For aninput graph G= (V, E)with non-negative costs c:Vâ†’Râ‰¥0,(FVS-IP: WD-and-cycle-cover)
isan integerlinear programming formulationfor FVS. Moreover, theintegralitygap of (FVS-LP: WD-and-cycle-cover)
is at most 2.
LetG= (V, E)be a graph with non-negative vertex costs c:Vâ†’Râ‰¥0. By definition, the ILP
min{P
uâˆˆVcuxu:xâˆˆPcycle-cover (G)âˆ©ZV}formulates FVS. We note that weak density constraints are
valid for FVS. Consequently, (FVS-IP: WD-and-cycle-cover) is an ILP formulation for FVS. The rest of the
section is devoted to proving the integrality gap bound mentioned in Theorem 4.
Lemma 12. The integrality gap of the LP (FVS-LP: WD-and-cycle-cover) is at most 2.
LetCbe the set of cycles in the input graph G. Let b(S):=|E[S]| âˆ’ |S|for all SâŠ†V. We rewrite
(FVS-LP: WD-and-cycle-cover) and its dual in Figure 4.
Primal:
minX
uâˆˆVcuxu
s.t.X
uâˆˆS(dS(u)âˆ’1)xuâ‰¥b(S),âˆ€SâŠ†V
X
uâˆˆCxuâ‰¥1 âˆ€Câˆˆ C
xuâ‰¥0 âˆ€uâˆˆVDual:
maxX
SâŠ†Vb(S)yS+X
CâˆˆCzC
s.t.X
SâŠ†V:uâˆˆS(dS(u)âˆ’1)yS+X
CâˆˆC :uâˆˆCzCâ‰¤cuâˆ€uâˆˆV
ySâ‰¥0 âˆ€SâŠ†V
zCâ‰¥0 âˆ€Câˆˆ C
Figure 4: WD-CC Primal and Dual LPs for FVS
We will need the definition of semi-disjoint cycles from [CGHW98]: A cycle Cin graph G is semi-disjoint
(with respect to the graph G) if there is at most one vertex in Cof degree strictly larger than 2. We call such
a vertex as the pivotvertex of the semi-disjoint cycle. We note that such cycles can be viewed as â€œhanging
offâ€ the graph via their pivots which are cut vertices.
234.1.1 Minimal FVS and Weak Density constraints
In this section, we show an important property of inclusion-wise minimal feedback vertex sets. Let Fbe
a feedback vertex set for a graph G. Awitness cycle for a vertex fâˆˆFis a cycle Cof the graph Gsuch
that Fâˆ©C={f}i.e.fis the only vertex that witnesses the cycle C. We note that every vertex of a
minimal FVS must have a witness cycle. In Lemma 13, we show that for a graph with non-trivial degree and
no semi-disjoint cycles, every minimal feedback vertex set is essentially a 2-approximation to the optimal
feedback vertex set with respect to an appropriate cost function. We note that our proof of the lemma
appears implicitly in [CGHW98]. However, we include it here for completeness.
Lemma 13. LetGbe a graph with minimum-degree at least 2and containing no semi-disjoint cycles. Then,
for every minimal feedback vertex set F, we have that
X
vâˆˆF(d(v)âˆ’1)â‰¤2b(V).
Proof.We first show a convenient sufficient condition that proves the claimed upper bound. We subse-
quently prove this sufficient condition by an edge-counting argument. Let tdenote the number of connected
components in Gâˆ’F.
Claim 5. If|Î´(F, Vâˆ’F)| â‰¥ |F|+ 2t, thenP
vâˆˆF(d(v)âˆ’1)â‰¤2b(V).
Proof.We have the following:
X
vâˆˆF(d(v)âˆ’1) = 2 |E| âˆ’ |F| âˆ’X
vâˆˆVâˆ’Fd(v)
= 2|E| âˆ’ |F| âˆ’ 
|Î´(F, Vâˆ’F)|+ 2|E[Vâˆ’F]|
= 2|E| âˆ’ |F| âˆ’ 
|Î´(F, Vâˆ’F)|+ 2(|V| âˆ’ |F| âˆ’t)
â‰¤2|E| âˆ’ |F| âˆ’ 
2|V| âˆ’ |F|
= 2b(V).
Here, the first equality holds because the sum of all vertex degrees is 2|E|, the third equality is because
Gâˆ’Fis acyclic, and the inequality is due to the hypothesis that |Î´(F, Vâˆ’F)| â‰¥ |F|+ 2t.
We now show that a minimal feedback vertex set Fhas at least |F|+ 2tedges crossing it. For this, we
consider the auxiliary bipartite graph H= (KâˆªF, E H)as follows: Each vertex kâˆˆKcorresponds to a
connected component CkinGâˆ’F. For vertices kâˆˆK, fâˆˆF, the graph Hcontains the edge (k, f)if there
exists a vertex vâˆˆCksuch that the edge (v, f)âˆˆEexists in the original graph G. Furthermore, we define
the weight of an edge (k, f)âˆˆEHaswH(k, f):=|Î´G(Ck, f)|. We note that |K|=t.
Since Fis an inclusionwise minimal feedback vertex set, every vertex fâˆˆFhas a witness cycle. We note
that there are no edges between the components of Gâˆ’F. Thus, every witness cycle is completely contained
in some component Ckfor some kâˆˆK. In particular, this implies that in the graph H, every vertex fâˆˆF
has an edge of weight at least 2incident on it. For each fâˆˆFpick an arbitrary such edge efâˆˆÎ´H(f)of
weight at least 2and call it fâ€™sprimary edge. Then, reducing the weight of all primary edges by 1still leaves
all edges in EHwith positive weight, but counts |F|edges in the cut |Î´(F, Vâˆ’F)|in the original graph G.
LetHâ€²denote the residual graph after this weight reduction. By Claim 5, it now suffices to show that the
weight of all edges in Hâ€²is at least 2|K|.
For this, we claim that each vertex kâˆˆKmust have a cumulative edge-weight of at least 2incident on
it in the residual graph Hâ€². By way of contradiction, suppose that there exists a vertex kâˆˆKwith total
incident edge-weight at most 1. We consider two cases. First, suppose that khas no incident edges. We recall
that we reduced the weight of only primary edges in our weight-reduction step. Thus, if there was a primary
edge incident to k, then kwould have a weight 1edge incident on it in the residual graph, contradicting the
case assumption. Thus, there are no edges incident to CkinG, i.e. Ckis a disconnected acyclic component
24ofG. In particular, Ckcontains a leaf vertex, contradicting the hypothesis that the minimum degree of Gis
at least 2.
Next, consider the case where khas a total weight of 1incident on it in the residual graph Hâ€². Let fâˆˆF
be its unique neighbor in the residual graph. Then, fmust also be its unique neighbor in H. We note that if
Ckhas only one edge to finG, then Ckmust contain a leaf node in Gas it is acyclic, a contradiction. Thus,
Ckdoes not contain any leaf nodes, is acyclic, and has exactly 2edges to finG. In particular, Ckâˆª {f}is
a semi-disjoint cycle in G, contradicting the hypothesis that Ghas no semi-disjoint cycles.
4.1.2 Proof of integrality gap
In this section, we prove Lemma 12, i.e., we show that the integrality gap of the LP-relaxation for FVS given
in Figure 4 is at most 2. We prove this by constructing a dual feasible solution (y,z)and a FVS Fsuch that
the cost of Fis at most twice the dual objective value of (y,z). This implies that the integrality gap of the
LP is at most 2since the LP is a relaxation for FVS. We construct such a pair of solutions via a primal-dual
algorithm. Our primal-dual algorithm is an extension of the 2-approximation primal-dual algorithm due to
[CGHW98]. We state our algorithm in Algorithm 1.
Algorithm 1 Primal-Dual for FVS
Input:(1) Graph G= (V, E); (2) Vertex weights c:Vâ†’R+.
Output: Feedback vertex set FâŠ†V.
1. Initialize (y, z):= 0,i:= 1,F:=âˆ…, and G1=G.
2.Whilethe graph Gi= (Vi, Ei)has a cycle:
(a) Recursively remove vertices of degree 1from Gi.
(b)IfGihas a semi-disjoint cycle Ci:
Define the set Si=Cias the semi-disjoint cycle.
Increase dual variable zSiuntil the first dual constraint for some vertex viâˆˆCibecomes tight.
(c)Else:
Define the set Si=Vias the entire vertex set.
Increase dual variable ySiuntil the first dual constraint becomes tight for some vertex viâˆˆVi.
(d) Update F:=Fâˆª {vi}
Gi+1:=Giâˆ’vi
i:=i+ 1.
3. Perform reverse-delete on F.
4. Return F.
Algorithm 1 is a primal-dual algorithm based on the LP relaxation for FVS given in Figure 4. The
algorithm initializes with the dual feasible solution (y= 0,z= 0). In the ith iteration of the while-loop,
the algorithm selects a specific set Siof vertices (which is either a cycle Cior entire vertex set Vi) and
increases the corresponding dual variable until a dual constraint for some vertex viâˆˆSibecomes tight. It
then includes the vertex viinto the FVS and removes vifrom the graph. Adding vito the candidate set Fis
interpreted as setting the primal variable xvi= 1. Thus, Algorithm 1 always maintains dual feasibility and
primal complementary slackness (i.e., xvi= 1only if the dual constraint for viis tight).
We now explain the reverse-delete procedure mentioned in Algorithm 1. Let â„“be the number of iteration
of the while loop. The reverse-delete procedure iteratively considers vertices in the reverse-order in which
they were added into F, i.e. vâ„“, vâ„“âˆ’1, . . . v 1. For every vertex in this order, the procedure checks whether
removal of this vertex from Fis still a feasible FVS for G. If so, then the vertex is removed from F. We will
later rely on reverse-delete to show that Fâˆ©Siis a minimal FVS in G[Si]for every iteration i.
25We now observe that the algorithm terminates in polynomial time to return a feasible FVS.
Lemma 14 (Feasibility and Runtime) .Algorithm 1 returns a feasible FVS for the input graph Gin poly-
nomial time.
Proof.Each step of the while loop and reverse-delete procedure can be implemented to run in polynomial
time. In ith iteration of the while-loop, at least one vertex of the graph Giis removed. The empty graph
has no cycles and so the while-loop will terminate in at most linear number of iterations. Furthermore, the
reverse delete step considers every vertex in Fexactly once, and so, it also terminates in at most linear
number of steps. The output set Fis a feasible FVS by the terminating condition of the while-loop and the
fact that reverse-delete deletes a vertex only if its deletion maintains feasibility.
We now bound the approximation factor of the solution Freturned by Algorithm 1. Let (y,z)be the
dual solution constructed by Algorithm 1 and let Ï‡Fâˆˆ {0,1}Vbe the indicator vector of F. We note that
Lemma 14 implies that Ï‡Fis a feasible solution to the primal LP. Let primal (Ï‡F),dual(y,z)denote the
objective values of the primal and dual LPs for solutions Ï‡Fand(y,z)respectively.
LetI1âŠ†[â„“]denote the set of iterations in which the dual variable for the entire residual graph was
increased (i.e. statement (c) of Algorithm 1 is executed) and let I2âŠ†[â„“]denote the set of iterations in
which the dual variable for a semi-disjoint cycle in the residual graph was increased (i.e. statement (b) of
Algorithm 1 is executed). For notational convenience, we let Fj=Fâˆ© {vj}andFâ‰¥j=âˆªkâˆˆ[j,â„“]Fj. The next
lemma shows that the set Siâˆ©Fâ‰¥iis a minimal feedback vertex set for the subgraph G[Si]for each iâˆˆ[â„“].
Lemma 15. The set Siâˆ©Fâ‰¥iis a minimal feedback vertex set for the subgraph G[Si]for each iâˆˆ[â„“].
Proof.We prove by induction on â„“âˆ’i. For the base case, we consider i=â„“. We observe that Fâ‰¥â„“={vâ„“}as
otherwise, the following two observations result in a contradiction: (i) The reverse-delete step only removes
vâ„“from Fif the set Fâˆ’ {vâ„“}is a feasible feedback vertex set for G; and (ii) if Fâˆ’ {vâ„“}were a FVS for G,
then the algorithm would have terminated after the (â„“âˆ’1)thiteration. We note that Fâ„“is a FVS for Gâ„“as
there was no (â„“+ 1)thiteration. If the set Sâ„“=Vâ„“is the entire vertex set of the graph Gâ„“, then vâ„“âˆˆVâ„“.
Alternatively, if the set Sâ„“is a semi-disjoint cycle Câ„“, then vâ„“âˆˆCâ„“, as otherwise the cycle Câ„“would remain
inGâ„“+1contradicting that there were only â„“iterations. In both scenarios, the set Sâ„“âˆ©Fâ‰¥â„“is a minimal FVS
forG[Sâ„“].
For the inductive case, assume that 0â‰¤i < â„“. By the inductive hypothesis, we have that the set Sjâˆ©Fâ‰¥j
is a minimal FVS for the graph G[Sj]for all â„“â‰¥j > i. We consider two cases based on whether the set Si
is a semi-disjoint cycle of Gior the entire vertex set of Gi.
First, we consider the case where Siis a semi-disjoint cycle Ci. We need to show that |Fâˆ©Ci|= 1. We
observe that 1â‰¤ |Fâˆ©Ci| â‰¤2: The lower bound follows from the fact that the set Fâ‰¥iis a feasible FVS
forGiand thus intersects all cycles in at least one vertex. The upper bound holds by the following three
observations: (i) The vertex viis the first vertex of the set Cito be selected into Fby the algorithm; (ii) If
the vertex viis the pivot vertex, then all vertices in Ciâˆ’ {vi}get recursively removed and thus cannot be
selected into Fin any subsequent iteration after i; and (iii) If the vertex viis not the pivot vertex, then all
vertices in Ciâˆ’{vi}except the pivot vertex get recursively removed due to step (a) and thus, only the pivot
vertex can be included into Fin some subsequent iteration after i. We note that if scenario (ii) happens,
then Fâ‰¥iâˆ©Ci={vi}and hence, |Fâˆ©Ci|= 1. Alternatively, suppose that scenario (iii) happens. If the pivot
is never selected into F, then once again we have Fâ‰¥iâˆ©Ci={vi}and hence, |Fâˆ©Ci|= 1. Otherwise the
pivot is selected into Fand the reverse-delete step processes the pivot vertex before processing vi. If the
reverse-delete step removes the pivot vertex from F, then once again we have Fâ‰¥iâˆ©Ci={vi}and hence,
|Fâˆ©Ci|= 1. Otherwise, the reverse-delete step does not remove the pivot from F. Consider the iteration of
reverse-delete that processes viâ€”we need to show that reverse-delete will indeed remove viin this iteration.
We observe that the set {vk:kâˆˆ[1, iâˆ’1]}has not been processed by reverse-delete and this set intersects
every cycle that is not entirely contained in Gi(this is true since Giis the residual graph after removal
of{v1, . . . v iâˆ’1}along with recursively removing degree-1 vertices in each step). Since the pivot for Ciis
already in Fand the cycle Ciis semi-disjoint in Gi, the reverse-delete step must remove the vertex vifrom
26Fasviintersects no cycles other than those already intersected by Fâˆ’ {vi}. In particular, Fâ‰¥iâˆ©Ciis a
singleton set consisting of the pivot vertex for Ci. Thus, in all cases we have that |Fâ‰¥iâˆ©Ci|= 1. It follows
thatFiis a minimal FVS for the cycle G[Ci].
Next, we consider the case when Si=Viis the entire vertex set of the subgraph Gi. Here, we consider the
set of all cycles that viintersects in Gand partition them into two types: (1) Cycles completely contained
inGi; and (2) cycles that include at least one vertex from Vâˆ’Vi. Since Fâ‰¥iis a feasible FVS for Gi, we
have that Fâ‰¥iintersects all cycles of the first type. Furthermore, since the vertices in Vâˆ’Vido not exist in
Gi, the set {v1, . . . , v iâˆ’1}intersect all cycles of the second type. We recall that the set Fâ‰¥i+1is a minimal
FVS for Gi+1.
We consider the first subcase where the set Fâ‰¥i+1is an FVS for the graph Gi. Then, the set Fâ‰¥i+1
intersects all cycles contained in Gi. In particular, it intersects all cycles of type (1). Thus, the set
{v1, . . . , v iâˆ’1} âˆªFâ‰¥i+1is a feasible FVS for the original graph G. Due to this, the reverse-delete step
removes the vertex vifrom Fand we have that Fâ‰¥i=Fâ‰¥i+1. Furthermore, by the inductive hypothesis we
have that Fâ‰¥i+1is a minimal FVS for Gi+1. Thus, the set Fâ‰¥iis a minimal FVS for Gi=G[Si].
We next consider the remaining subcase where the set Fâ‰¥i+1is not a FVS for the graph Gi. In particular,
there must be a cycle of the first type that viintersects, but none of the vertices of Fâ‰¥i+1intersect. In
particular, the set {v1, . . . , v iâˆ’1} âˆªFâ‰¥i+1is not a feasible FVS for the original graph Gas the set does
not intersect all type (1) cycles. Thus, the reverse-delete step cannot remove vifrom F. By the induction
hypothesis, we have that Fâ‰¥i+1is a minimal FVS for Gâ‰¥i+1. Consequently, none of these vertices can be
removed from Fâ‰¥ias the resulting set would not be a feasible FVS. It follows that Fâ‰¥iis a minimal FVS for
Gi=G[Si].
We show in Lemma 16 that the solution Fconstructed by the algorithm has cost at most twice the
objective value of the dual feasible solution (y,z)constructed by the algorithm. We recall that Ï‡Fâˆˆ {0,1}V
is the indicator vector of the set Fandprimal (Ï‡F),dual(y,z)denote the objective values of the primal and
dual LPs for solutions Ï‡Fand(y,z)respectively.
Lemma 16 (Integrality gap bound) .We have that
primal (Ï‡F)â‰¤2Â·dual(y,z).
Proof.We have that
primal (Ï‡F) =X
vâˆˆFcv
=X
vâˆˆFï£«
ï£­X
SâŠ†V:vâˆˆS(dS(v)âˆ’1)yS+X
CâˆˆC:vâˆˆCzCï£¶
ï£¸
=X
SâŠ†VySX
vâˆˆFâˆ©S(dS(v)âˆ’1) +X
CâˆˆCzCX
vâˆˆFâˆ©C1
=X
iâˆˆI1ySiX
vâˆˆFâˆ©Si(dSi(v)âˆ’1) +X
iâˆˆI2zCi|Fâˆ©Ci|
â‰¤2X
iâˆˆI1ySib(Si) +X
iâˆˆI2zCi
â‰¤2Â·dual(y,z).
Here, the second equality follows by the primal complementary slackness maintained by Algorithm 1. The
fourth equality follows by the fact that all dual variables that were not incremented during some iteration of
Algorithm 1 have value zero. The first inequality follows by Lemma 15 and Lemma 13. Here, we note that
foriâˆˆI2,|Fâˆ©Ci|= 1(by Lemma 15) because G[Ci]is an induced cycle and consequently a minimal FVS
forG[Ci]contains exactly 1vertex.
27Lemma 16 completes the proof of Lemma 12 since dual(y,z)â‰¤primal (Ï‡F)by weak duality and the fact
that the ILP min{P
uâˆˆVcuxu:xâˆˆPWD(G)âˆ©Pcycle-cover (G)âˆ©ZV}is an ILP formulation for FVS (whose
LP-relaxation is given in Figure 4). It also proves that the approximation factor of the solution Freturned
by Algorithm 1 is at most 2.
4.2 Orientation and Cycle Cover constraints
In this section, we give a polynomial-sized ILP for FVS based on orientation and cycle cover constraints.
Moreover, we show that the integrality gap of the LP-relaxation of this formulation is at most 2. We consider
the following formulation:
minï£±
ï£²
ï£³X
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©Pcycle-cover (G)âˆ©ZVï£¼
ï£½
ï£¾. (FVS-IP: orient-and-cycle-cover)
Lemma17. For aninput graph G= (V, E)with non-negative vertexcosts c:Vâ†’Râ‰¥0,(FVS-IP: orient-and-cycle-cover)
is an integer linear programming formulation for FVS. Moreover, its LP-relaxation has integrality gap at most
2.
Proof.The indicator vector xof a feedback vertex set of Gis contained in Qorient(G)âˆ©Pcycle-cover (G).
Moreover, every integral solution xâˆˆQorient(G)âˆ©Pcycle-cover (G)is the indicator vector of a feedback vertex
set: since xâˆˆQorient(G)âˆ©ZV, we have that xâˆˆ {0,1}Vand since xâˆˆPcycle-cover (G), we have that xis the
indicator vector of a feedback vertex.
We now show that the integrality gap of the LP-relaxation is at most 2. By Theorem 1(1), we have that
Qorient(G)âŠ†PWD(G)and hence, the integrality gap of the LP-relaxation is at most the integrality gap of
(FVS-LP: WD-and-cycle-cover). By Theorem 4, the integrality gap of (FVS-LP: WD-and-cycle-cover) is at
most 2.
Theorem 5 follows from Lemma 17, the observation that Qorient(G)can be expressed using polynomial
number of variables and constraints (see the description of Porient(G)), and the fact that the cycle cover
polyhedron can equivalently be described using polynomial number of variables and constraints. We note
that this fact is folklore, but we include a proof of it in Lemma 19 in the appendix.
4.3 Alternative formulations
In Section 4.2, we described an ILP formulation based on orientation and cycle cover polyhedra and showed
that its LP-relaxation is at least as strong as (FVS-LP: WD-and-cycle-cover). We briefly discuss two more
polynomial-sized LP-relaxations for FVS with integrality gap at most 2. We give full details in the appendix
for the sake of completeness.
We recall that Chekuri and Madan [CM16] gave a polynomial-sized ILP formulation for Subset-FVS.
We note that the LP-relaxation of their ILP-formulation specialized for FVS has integrality gap at most
that of the LP-relaxation of (FVS-IP: orient-and-cycle-cover). Consequently, the LP-relaxation of their
ILP formulation has integrality gap at most 2. We present the details in Appendix B.2. This result gives
additional impetus to improving the integrality gap analysis of their LP-relaxation for Subset-FVS.
Next, we give an ILP formulation based only on orientation constraints (without relying on cycle cover
constraints) - see Appendix B.3. We show that its LP-relaxation is at least as strong as that of the strong
density constraints based formulation and consequently is also at most 2.
Acknowledgements. Samuel Fiorini and Stefan Weltge would like to thank GwenaÃ«l Joret and Yelena
Yuditsky for preliminary discussions. Karthekeyan Chandrasekaran and Samuel Fiorini would like to ac-
knowledge the support of the trimester program on Discrete Optimization at the Hausdorff Institute for
Mathematics (2021) for facilitating initial discussions on the problem. Chandra Chekuri, Samuel Fiorini and
28Stefan Weltge would like to thank the Oberwolfach Research Institute for Mathematics and the organizers
of the Combinatorial Optimization workshop (2021) during which this research started. Shubhang Kulkarni
thanks Da Wei Zheng for engaging in preliminary discussions on the separation oracle for 2-pseudotree cover
constraints. We thank the reviewers for their comments which helped improve the presentation of the paper.
Declarations
Funding and/or Conflicts of Interests/Competing Interests. Karthekeyan Chandrasekaran and
ShubhangKulkarniweresupportedinpartbyNSFgrantsCCF-1814613andCCF-1907937. ChandraChekuri
was supported in part by NSF grants CCF-1910149 and CCF-1907937. Stefan Weltge was supported in part
by Deutsche Forschungsgemeinschaft (DFG, German Research Foundation), project number 451026932. No
Conflicts of Interests/Competing Interests.
References
[BBF95] Vineet Bafna, Piotr Berman, and Toshihiro Fujito. Constant ratio approximations of the
weighted feedback vertex set problem for undirected graphs. In Algorithms and Computations ,
pages 142â€“151, 1995.
[BG96] Ann Becker and Dan Geiger. Optimization of Pearlâ€™s method of conditioning and greedy-like
approximation algorithms for the vertex feedback set problem. Artificial Intelligence , 83:167â€“
188, 1996.
[BWB18] Austin Buchanan, Yiming Wang, and Sergiy Butenko. Algorithms for node-weighted steiner
tree and maximum-weight connected subgraph. Networks , 72(2):238â€“248, 2018.
[BYGNR98] Reuven Bar-Yehuda, Dan Geiger, Joseph Naor, and Ron M Roth. Approximation algorithms
for the feedback vertex set problem with applications to constraint satisfaction and bayesian
inference. SIAM Journal on Computing , 27(4):942â€“959, 1998.
[CGHW98] FabiÃ¡n A. Chudak, Michel X. Goemans, Dorit S. Hochbaum, and David P. Williamson. A pri-
malâ€“dual interpretation of two 2-approximation algorithms for the feedback vertex set problem
in undirected graphs. Operations Research Letters , 22(4):111â€“118, 1998.
[Cha00] Moses Charikar. Greedy Approximation Algorithms for Finding Dense Components in a Graph.
InApproximation Algorithms for Combinatorial Optimization , pages 84â€“95, 2000.
[CM16] Chandra Chekuri and Vivek Madan. Constant factor approximation for subset feedback set
problems via a new LP relaxation. In Proceedings of the Twenty-Seventh Annual ACM-SIAM
Symposium on Discrete Algorithms , SODA, pages 808â€“820, 2016.
[DS05] Irit Dinur and Samuel Safra. On the hardness of approximating minimum vertex cover. Annals
of mathematics , pages 439â€“485, 2005.
[ENSZ00] Guy Even, Joseph Naor, Baruch Schieber, and Leonid Zosin. Approximating minimum subset
feedback sets in undirected graphs with applications. SIAM Journal on Discrete Mathematics ,
13(2):255â€“267, 2000.
[ENZ00] Guy Even, Joseph Naor, and Leonid Zosin. An 8-approximation algorithm for the subset
feedback vertex set problem. SIAM Journal on Computing , 30(4):1231â€“1252, 2000.
[EP62] Paul ErdÃ¶s and Lajos PÃ³sa. On the maximal number of disjoint circuits of a graph. Publ. Math.
Debrecen , 9:3â€“12, 1962.
29[Fuj99] Toshihiro Fujito. Approximating node-deletion problems for matroidal properties. Journal of
Algorithms , 31(1):211â€“227, 1999.
[Fuj05] Satoru Fujishige. Submodular functions and optimization . Elsevier, 2005.
[KR08] Subhash Khot and Oded Regev. Vertex cover might be hard to approximate to within 2- Îµ.
Journal of Computer and System Sciences , 74(3):335â€“349, 2008.
[LFFW19] Mugang Lin, Qilong Feng, Bin Fu, and Jianxin Wang. An approximation algorithm for the
â„“-pseudoforest deletion problem. Theoretical Computer Science , 806, 08 2019.
[MS81] Burkhard Monien and Reinald Schulz. Four approximation algorithms for the feedback vertex
set problem. In WG, pages 315â€“326, 1981.
[PRS18] Geevarghese Philip, Ashutosh Rai, and Saket Saurabh. Generalized pseudoforest deletion:
Algorithms and uniform kernel. SIAM Journal on Discrete Mathematics , 32(2):882â€“901, 2018.
[Wes00] Douglas B. West. Introduction to Graph Theory . Prentice Hall, 2000.
A Pseudoforest Deletion Set
A.1 Polynomial-time separation oracle for 2-Pseudotree Cover constraints
Inthissection, weshowthatthefamilyof 2-pseudotreecoverconstraintsadmitsapolynomialtimeseparation
oracle.
Lemma 18. The family of 2-pseudotree cover constraints admits a polynomial-time separation oracle.
Inordertosolvetheseparationproblem,itsufficestodesignapolynomialtimealgorithmforthe Minimum
Cost 2-Pseudotree problem: The input to MC2PT is a vertex-weighted graph 
G= (V, E), w:Vâ†’Râ‰¥0
,
and the goal is to compute a minimum weight subset UâŠ†Vof vertices such that G[U]is a2-pseudotree,
i.e.,
minX
uâˆˆUw(u):UâŠ†VandG[U]is a2-pseudotree
.
Our strategy to solve MC2PT is to reduce it to solving a polynomial number of special instances of the Mini-
mum Node-Weighted Steiner Tree4(NWST), and use the result of [BWB18] which says that these special in-
stances of NWST can be solved in polynomial time. Formally, the input to NWST is a vertex-weighted graph 
G= (V, E), w:Vâ†’Râ‰¥0
and a terminal set SâŠ†V. We will say that a graph His aSteiner tree inGfor
terminal set SifHis connected, acyclic, and is a subgraph of Gwith SâŠ†VH. Moreover, the weight of a sub-
graph HofGis the sum of weights of vertices in H. The NWST problem is to find a minimum weight Steiner
treein Gforterminalset S, i.e., min{P
uâˆˆVHw(u):H= (VH, EH)is a Steiner tree in Gfor terminal set S}.
NWST can be solved in polynomial time if the number of terminals is a constant.
Proposition 3 (Theorem 1 of [BWB18]) .There exists a O(3kn+ 2kn2+n3)time algorithm for NWST,
where kdenotes the number of terminals and ndenotes the number of vertices in the input instance.
The following proposition shows a correspondence between minimum weight 2-pseudotrees in a vertex-
weighted graph and Steiner trees.
Proposition 4. LetG= (V, E)be a graph with non-negative vertex weights w:Vâ†’Râ‰¥0and let Wâ‰¥0.
Then, there exists a subset UâŠ†Vsuch that G[U]is a2-pseudotree withP
uâˆˆUw(u)â‰¤Wif and only if
there exists a pair of edges e1=u1v1, e2=u2v2inGsuch that there exists a Steiner tree H= (VH, EH)in
the graph Gâ€²:=Gâˆ’ {e1, e2}for terminal set S:={u1, v1, u2, v2}withP
uâˆˆVHw(u)â‰¤W.
4We refer to nodesasverticesfor consistency with the rest of our technical sections.
30Proof.We will say that a graph T= (VT, ET)is aminimal 2-pseudotree if it is connected and has exactly
|VT|+ 1edges. Equivalently, Thas exactly 2edges in addition to a spanning tree. We observe that for a
subset UâŠ†V, the subgraph G[U]is a2-pseudotree if and only if there exists a subgraph T= (U, E T)of
G[U]such that Tis a minimal 2-pseudotree. Hence, it suffices to show that there exists a subset UâŠ†Vsuch
that G[U]has a subgraph that is a minimal 2-pseudotree withP
uâˆˆUw(u)â‰¤Wif and only if there exists
a pair of edges e1=u1v1, e2=u2v2inGsuch that there exists a Steiner tree H= (VH, EH)in the graph
Gâ€²:=Gâˆ’ {e1, e2}for terminal set S:={u1, v1, u2, v2}withP
uâˆˆVHw(u)â‰¤W. We prove this statement
now.
LetUâŠ†Vsuch that G[U]contains a subgraph T= (U, E T)that is a minimal 2-pseudotree withP
uâˆˆUw(u)â‰¤W. Then, there exists a pair of edges e1=u1v2ande2=u2v2inTsuch that the subgraph
H:=Tâˆ’ {e1, e2}is acyclic, connected, and is a subgraph of T. In particular, we have that His acyclic,
connected, and is a subgraph of Gâ€²:=Gâˆ’ {e1, e2}with S={u1, v1, u2, v2} âŠ†U=V(H). Hence, for the
pair of edges e1, e2inG, we have that His a Steiner tree in Gâ€²for terminal set SwithP
uâˆˆV(H)w(u) =P
uâˆˆUw(u)â‰¤W.
Next, let e1=u1v2, e2=u2v2be a pair of edges in Gsuch that there exists a Steiner tree H= (VH, EH)
in the graph Gâ€²:=Gâˆ’ {e1, e2}for terminal set S={u1, v1, u2, v2}withP
uâˆˆVHw(u)â‰¤W. Consider the
graph T:=H+{e1, e2}. Then, Tis a minimal 2-pseudotree. The vertex set of TisU:=VHandTis
a subgraph of G[U]. Hence, we have a subset UâŠ†Vsuch that G[U]has a subgraph that is a minimal
2-pseudotree withP
uâˆˆUw(u)â‰¤W.
We now restate and prove Lemma 18.
Lemma 18. The family of 2-pseudotree cover constraints admits a polynomial-time separation oracle.
Proof.It suffices to show that MC2PT can be solved in polynomial time. Let G= (V, E)with vertex
weights w:Vâ†’Râ‰¥0be the input instance of MC2PT. Consider the following algorithm: for all pairs
of edges e1=u1v1ande2=u2v2inE, use the algorithm guaranteed by Proposition 3 to solve NWST
on the graph Gâˆ’ {e1, e2}with vertex weights wfor terminal set {u1, v1, u2, v2}, and return the minimum
weight solution over all instances. The correctness of the algorithm follows from Proposition 4. We now
analyze the runtime of the algorithm. There are O(|V|2)pairs of edges to enumerate. Furthermore, for
each pair of edges, the associated NWST instance can be solved in polynomial time using the algorithm
from Proposition 3 since each such instance has only four terminals. Thus, the algorithm runs in polynomial
time.
B Feedback Vertex Set
B.1 Polynomial-sized formulation of the Cycle Cover polyhedron
In this section, we show that Pcycle-cover (G)can be expressed using polynomial number of variables and
constraints. This is folklore, but we include its proof for the sake of completeness. For a graph G= (V, E),
we define Eâ€²:={(e, s),(e, t):âˆƒcycle in Gcontaining e=stâˆˆE}and consider
Pdist-cycle-cover (G):=ï£±
ï£´ï£´ï£²
ï£´ï£´ï£³(x, d)âˆˆRV
â‰¥0Ã—RVÃ—Eâ€²
â‰¥0:d(e,s)
s= 0 âˆ€(e=st, s)âˆˆEâ€²
d(e,s)
t+xsâ‰¥1 âˆ€(e=st, s)âˆˆEâ€²
d(e,s)
a+xbâ‰¥d(e,s)
bâˆ€(e, s)âˆˆEâ€², abâˆˆEâˆ’ {e}ï£¼
ï£´ï£´ï£½
ï£´ï£´ï£¾.(8)
Lemma 19. For every graph G= (V, E), the polyhedron Pcycle-cover (G)is the projection of the polyhedron
Pdist-cycle-cover (G)toxvariables. Consequently, Pcycle-cover (G)admits a polynomial-sized description.
Proof.LetQdist-cycle-cover (G)be the projection of Pdist-cycle-cover (G)to the xvariables. We prove that
Qdist-cycle-cover (G) =Pcycle-cover (G)by showing inclusion in both directions.
31First, we show that Qdist-cycle-cover (G)âŠ†Pcycle-cover (G). Let xâˆˆQdist-cycle-cover (G). Let dâˆˆRVÃ—Eâ€²
â‰¥0be
a vector such that (x, d)âˆˆPdist-cycle-cover (G). It suffices to show that for every cycle CinG, we have thatP
uâˆˆV(C)xuâ‰¥1. Let Cbe a cycle in G. Fix an edge e=stâˆˆE(C). By definition of the set Eâ€², we have
that(e, s)âˆˆEâ€². Consequently, d(e,s)
s= 0andd(e,s)
t+xsâ‰¥1by the first two constraints of Pdist-cycle-cover (G).
Leta1=s, a2, a3, . . . , a râˆ’1, ar=tbe the ordered vertices along the sâˆ’tpath induced by E(C)âˆ’e. Then,
for every iâˆˆ[râˆ’1], we have that d(e,s)
ai+xai+1â‰¥d(e,s)
ai+1by the third constraint of Pdist-cycle-cover (G). Adding
all of these constraints gives us thatPr
i=2xaiâ‰¥d(e,s)
ar=d(e,s)
tâ‰¥1âˆ’xs= 1âˆ’xa1. Thus, the constraintPr
i=1xaiâ‰¥1holds.
Next, we show that Qdist-cycle-cover (G)âŠ‡Pcycle-cover (G). Let xâˆˆPcycle-cover (G). Let dâˆˆRVÃ—Eâ€²
â‰¥0be
defined as follows: for each (e=st, s)âˆˆEâ€², let
d(e,s)
u:= minï£±
ï£²
ï£³X
vâˆˆPâˆ’{s}xv:Pis a path from stouandPÌ¸={s, t}ï£¼
ï£½
ï£¾.
We show that (x, d)âˆˆPdist-cycle-cover (G). We note that the vector (x, d)is non-negative by definition. Let
(e=st, s)âˆˆEâ€². Then, d(e,s)
s= 0by definition. Moreover, d(e,s)
t+xsâ‰¥1holds because of the following
reasoning: let Pbe a path from stotsuch that d(e,s)
t=P
vâˆˆPâˆ’{s}xvandPÌ¸={s, t}. Then, Pconcatenated
with the edge stforms a cycle Candd(e,s)
t+xs=xs+P
vâˆˆPâˆ’{s}xv=P
uâˆˆV(C)xuâ‰¥1. Finally, the
inequality d(e,s)
a+xbâ‰¥d(e,s)
bfor every edge abâˆˆEholds because of the following reasoning: for an edge
abâˆˆE, letPbe a path from stoasuch that d(e,s)
a=P
vâˆˆPâˆ’{s}xv. Then, Pconcatenated with bis a path
from stoband consequently, d(e,s)
bâ‰¤P
vâˆˆP+{b}âˆ’{s}xvby definition.
B.2 Chekuri-Madan formulation
In this section, we show that the polynomial-sized ILP for FVS given by Chekuri and Madan is such that
its LP-relaxation has integrality gap at most 2. Chekuri and Madan formulated a polynomial-sized ILP for
the more general problem of Subset Feedback Vertex Set (SFVS). SFVS is defined as follows: The input is a
graph G= (V, E)with non-negative vertex costs c:Vâ†’Râ‰¥0along with a set of terminals TâŠ†V. A subset
Uof non-terminals is said to be a subset feedback vertex set if Gâˆ’Uhas no cycle containing a vertex of
T. The goal is to find a least cost subset feedback vertex set. In Section B.2.1, we discuss Chekuri-Madanâ€™s
ILP for SFVS (henceforth referred to as ( SFVS-IP: CM )) with some background and notation. In Section
B.2.2, we discuss a reduction from FVS to SFVS satisfying certain technical properties. In Section B.2.3,
we show that the integrality gap of the LP-relaxation of ( SFVS-IP: CM ) specialized for FVS (henceforth
referred to as the ( FVS-LP: CM )) is at most 2.
B.2.1 Chekuri-Madanâ€™s ILP for SFVS
In this section, we discuss the ( SFVS-IP: CM ). Let H= (VH, EH)denote the input graph, SHâŠ†VHdenote
the terminal set, and cH:VHâ†’Râ‰¥0denote the vertex cost function. We will say that a cycle is interesting
if it contains a terminal. Let CHdenote the set of interesting cycles in the graph H.
Henceforth, we will assume that a SFVS of finite cost exists in the graph H. Furthermore, we will assume
without loss of generality that the instance Hsatisfies the following properties (see [CM16] for a justification
of these assumptions):
(i) the graph His connected,
(ii) each terminal siâˆˆSHhas infinite cost, is a degree two vertex with neighbors ai, bihaving infinite cost,
(iii) no two terminals are connected by an edge or share a neighbor,
(iv) there exists a special non-terminal degree one vertex râˆˆVwith infinite cost, and
32(v) each interesting cycle contains at least two terminals.
We refer to properties (i)-(v) as CM-properties.
Notation. Throughout this section we will use the following notation: We let k=|SH|denote the number
of terminals. We refer to the set Pi:={ai, bi}as thepivot set for the terminal si, and the set PH=âˆªiâˆˆ[k]Pi
as the set of all pivots. We define the set
â„“H(u) ={iâˆˆ[k]:siis reachable from uvia a path not containing any other terminals } âˆª {k+ 1}
as the set of labelsfor each vertex uâˆˆVH\S. We denote ËœVHas the set of vertices in VHthat are not in
SHâŠŽPHâŠŽ {r}. We denote ËœEHas the set of edges in EHthat are not incident to any terminals and the set
Eâ€²
Has the set of edges incident to terminals. We will refer to Eâ€²
Has special edges.
(SFVS-IP: CM ).See Figure 5 for the labelling-based ( SFVS-IP: CM ). In this ILP, we have vertex
variables xufor each uâˆˆËœVindicating whether the vertex uis in the SFVS F, and vertex labelling variables
zu,ifor each uâˆˆËœVâˆªPH, iâˆˆ[k]indicating whether vertex ureceives label i. We note that Figure 5 simplifies
the exposition of the ILP from [CM16] by explicitly substituting the values for variables whose values are
directlysetbyconstraints,i.e. xu= 0foruâˆˆSâˆª{r},zsi,i= 1foriâˆˆ[k],and zr,k+1= 1. Moreover,itslightly
strengthens the first constraint (Chekuri-Madan used a slightly weaker constraint: xu+P
iâˆˆ[k+1]zu,i= 1).
The constraints can be interpreted as follows: Let Fbe a minimal finite cost subset feedback vertex
set of H. Constraint (1) says that if a vertex uâˆˆËœVHis not in F, then it must receive exactly one of the
labels in â„“H(u). Constraint (2) says that exactly one of aiandbican receive the label ifor each iâˆˆ[k].
Constraint (3) is a spreading constraint that says that both end vertices of every non-special edge in Hâˆ’F
must receive the same label. Constraint (4) is a cycle covering constraint and says that the solution Fmust
intersect every interesting cycle in at least one vertex. Constraint (5) ensures that the set Fcontains no
pivot vertices.
We now briefly address why a labeling satisfying the LP constraints must exist for every minimal finite
weight subset feedback vertex set F(see [CM16] for further details). We note that none of the vertices of
SâˆªPâˆª{r}are in Fas these have infinite cost. Let the graph Hâ€²= (VHâ€², EHâ€²)be defined as Hâ€²=Hâˆ’F. For
simplicity, we first assume that the graph Hâ€²is connected and then address the more general case when Hâ€²
is not connected. Since there is no cycle containing any terminal in Hâ€², each terminal is a cut vertex in Hâ€².
Consider the block-cut-vertex tree decomposition Tâ€²ofHâ€²â€” (refer to [Wes00] for details on block-cut-vertex
tree decompositions). We label a vertex uofHâ€²asiâˆˆ[k]if terminal siis the first terminal encountered on
any path from vertex uto the root rin the graph Hâ€². If no terminals are encountered, then we label the
vertex as k+ 1. We note that such a labelling is well-defined as Tâ€²is the block-cut-vertex tree and the set
Sare cut vertices. In this labelling, we observe that every non-special edge uvâˆˆËœEHâ€²has the property that
both end points receive the same label. Finally, in the case where Hâ€²is not connected, we can justify the
existence of such a labeling by picking an arbitrary non-terminal vertex from each component, imagining a
dummy edge connecting it to the root r, and considering the labeling corresponding to block-cut-vertex tree
of this (implicit) graph.
B.2.2 Reduction from FVS to SFVS satisfying the CM-properties
FVS can be seen as a special case of SFVS where every vertex in the graph is a terminal. However, this simple
reduction does not result in an SFVS instance satisfying the CM-properties (see properties (i)â€“(v) mentioned
in the first paragraph of Section B.2.1). In this section, we show how to construct an SFVS instance from
an FVS instance such that the SFVS instance satisfies the required properties. Let G= (VG, EG)with
vertex costs cG:VGâ†’Râ‰¥0be the FVS instance. We will construct an SFVS instance H= (VH, EH)with
terminals SHand vertex costs cH:VHâ†’Râ‰¥0satisfying the required properties. We may assume that the
FVS instance Ghas an infinite-weighted degree-1 root vertex r, satisfying property (iv) since adding such a
vertex does not change the set of minimal feasible solutions. We construct Has follows:
33Subset Feedback Vertex Set:
minX
uâˆˆËœVHcuxu
s.t.
(1)xu+X
iâˆˆâ„“H(u)zu,i= 1 âˆ€uâˆˆËœVHâˆªPH
(2)zai,i+zbi,i= 1 âˆ€iâˆˆ[k]
(3)xu+zu,iâˆ’zv,iâ‰¥0 âˆ€uvâˆˆËœEH, iâˆˆ[k+ 1]
(4)X
uâˆˆCxuâ‰¥1 âˆ€Câˆˆ CH
(5)xu= 0 âˆ€uâˆˆPH
(6)zu,iâ‰¥0 âˆ€uâˆˆËœVHâˆªPH, iâˆˆ[k+ 1]
(7)xuâ‰¥0 âˆ€uâˆˆËœVH
(8)zu,iâˆˆZ âˆ€uâˆˆËœVHâˆªPH, iâˆˆ[k+ 1]
(9)xuâˆˆZ âˆ€uâˆˆËœVH
Figure 5: ( SFVS-IP: CM )
1. For each edge e=uvâˆˆEG, we subdivide the edge eso that the edge becomes a path u, ae, se, be, vof
length 4.
2. We let SH=S
eâˆˆE(G){se}denote the terminal set. Thus, the set Pe:={ae, be}is the set of pivot
vertices for each terminal seâˆˆSH, and the set PH:=S
eâˆˆE(G)Peis the set of all pivots of the graph
H.
3. We define the cost function as cH(u) =cG(u)ifuâˆˆVG, and cH(u) =âˆžotherwise (i.e., if uâˆˆSHâˆªPH).
We observe that the graph Hsatisfies properties (i)-(v) assumed by the Chekuri-Madan LP. The next
proposition says that solving FVS in the graph Gwith cost function cGis equivalent to solving SFVS in the
graph Hwith terminal set SHwith cost function cH. The proposition follows by construction.
Proposition 5. LetFâŠ†VG. The set Fis a feedback vertex set for Gif and only if the set Fis a subset
feedback vertex set for the graph Hwith terminal set SH. Furthermore, the cost of Fin both graphs is the
same, i.e. cG(F) =cH(F).
[CM16] showed that the LP-relaxation of ( SFVS-IP: CM ) given in Figure 5 has integrality gap at most
13. It immediately follows that the integrality gap of that LP-relaxation on the instance Hconstructed as
above is also at most 13. In the subsequent section, we tighten this integrality gap to 2for instances H
constructed as above.
B.2.3 Bounding the integrality gap
In this section, we show that the LP-relaxation of the ( SFVS-IP: CM ) given in Figure 5 for the instance
Hconstructed as given in the reduction in Section B.2.2 has integrality gap at most 2. We prove this by
showing that the LP constraints imply orientation and cycle cover constraints. Consequently, the integrality
gap of the LP-relaxation is at most that of min{P
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©Pcycle-cover (G)}. By Lemma 17,
it follows that the integrality gap of the LP-relaxation is at most 2.
34Webeginbysimplifyingthe( SFVS-IP: CM )giveninFigure5forSFVSinstances Hthatareconstructed
from FVS instances as obtained from the reduction in Section B.2.2. We make two observations that will
help us in the simplification. The first observation is that each edge eâˆˆEGcorresponds to a unique terminal
seâˆˆVH. Thus, we may replace the set [k]which indexed the set of terminals in the ILP of Figure 5 with
the set EG. For ease of exposition, we denote erby the label k+ 1. We now give the second observation.
LetuâˆˆVGbe arbitrary. Since each edge eâˆˆÎ´G(u)has been subdivided in the graph Hand contains a
terminal se, the only terminals that ucan reach via a path that does not contain any other terminal is
exactly {se:eâˆˆÎ´G(u)}. For an arbitrary pivot vertex uâˆˆPH, let g(u)denote the unique non-terminal
neighbor of uinH. Then, the only terminals that ucan reach via a path that does not contain any other
terminal is exactly {se:eâˆˆÎ´G(g(u))}. We summarize these observations in the next proposition.
Proposition 6. We have that
1. For each vertex uâˆˆVG, we have that â„“H(u) =Î´G(u)âˆª {er};
2. For each pivot vertex uâˆˆP, we have that â„“H(u) =Î´G(g(u))âˆª {er}.
Using Proposition 6 and the first observation mentioned above, we simplify the ( SFVS-IP: CM ) in
Figure 5 for the SFVS instance Hand write its LP-relaxation ( FVS-LP: CM ) in Figure 6.
LP-relaxation of ( SFVS-IP: CM ) for graph H:
minX
uâˆˆËœVHcuxu
s.t.
(1)xu+X
eâˆˆâ„“H(u)zu,e= 1 âˆ€uâˆˆËœVHâˆªPH
(2)zae,e+zbe,e= 1 âˆ€eâˆˆEG
(3)xu+zu,eâˆ’zv,eâ‰¥0 âˆ€uvâˆˆËœEH, eâˆˆEGâˆª {er}
(4)X
uâˆˆCxuâ‰¥1 âˆ€Câˆˆ CH
(5)xu= 0 âˆ€uâˆˆPH
(6)zu,eâ‰¥0 âˆ€uâˆˆËœVHâˆªPH, eâˆˆEGâˆª {er}
(7)xuâ‰¥0 âˆ€uâˆˆËœVH
Figure 6: ( FVS-LP: CM )
We now show that the constraints of the LP in Figure 6 imply the orientation and cycle cover constraints
forG.
Lemma 20. Let(x,z)be a feasible solution to ( FVS-LP: CM ) from Figure 6. Then,
1.xâˆˆPcycle-cover (G)and
2.(x,y)âˆˆPorient (G), where ye,u=zu,efor all eâˆˆÎ´(u), uâˆˆVG.
Proof.We have that xâˆˆPcycle-cover (G)owing to inequality (4). We now show that (x,y)âˆˆPorient(G). We
havethat xuâ‰¥0forall uâˆˆVGandye,uâ‰¥0forall eâˆˆÎ´G(u), uâˆˆVG. Wenowshowthat xu+P
eâˆˆÎ´G(u)ye,uâ‰¤
1for every uâˆˆVG. Let uâˆˆV. We have that
xu+X
eâˆˆÎ´G(u)ye,u=xu+X
eâˆˆâ„“H(u)zu,eâˆ’zu,er= 1âˆ’zu,erâ‰¤1,
35where the last inequality holds since zu,erâ‰¥0.
Finally, we show that xu+xv+ye,u+ye,vâ‰¥1for every e=uvâˆˆEG. Let e=uvâˆˆEG. Let u, ae, se, be, v
be the path in the graph Hcorresponding to the subdivided edge e. Then, we have that
xu+xv+ye,u+ye,v=xu+xv+zu,e+zv,e
= (xu+xv+zu,e+zv,e) + (zae,e+zbe,e)âˆ’(zae,e+zbe,e)
= 1 + ( xu+zu,eâˆ’zae,e) + (xv+zv,eâˆ’zbe,e)
â‰¥1.
Here, the third equality follows from constraint (2) and the final inequality follows from constraint (3) of
(FVS-LP: CM ) in Figure 6.
Lemma 20 implies that min{P
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©Pcycle-cover (G)}is a relaxation of ( FVS-LP:
CM) from Figure 6. Lemma 17 tells us that the integrality gap of min{P
uâˆˆVcuxu:xâˆˆQorient(G)âˆ©
Pcycle-cover (G)}is at most 2. Consequently, the integrality gap of ( FVS-LP: CM ) from Figure 6 is also at
most 2. We note that ( FVS-LP: CM ) from Figure 6 can be converted to a polynomial-sized LP by replacing
inequality (4) using a polynomial-sized description of cycle cover constraints as given in Lemma 19.
B.3 Orientation formulation
In this section, we give another polynomial-sized ILP for FVS whose LP-relaxation has integrality gap at
most 2. This ILP is based only on orientation constraints and does not require cycle cover constraints (in
contrast to the ILP presented in Section 4.2). We consider the following formulation and denote it as the
(FVS-IP: Complete-Orient ):
minX
uâˆˆVcuxu
xv+xw+yf
e,v+yf
e,wâ‰¥1âˆ€e=vwâˆˆE, fâˆˆE (9)
xv+X
e=vwâˆˆEyf
e,wâ‰¥1âˆ€vâˆˆV, fâˆˆE (10)
X
vâˆˆVâˆ’{a,b}xv+X
e=vwâˆˆEâˆ’{f}(yf
e,w+yf
e,v)â‰¤ |V| âˆ’2âˆ€f=abâˆˆE (11)
xuâ‰¥0âˆ€uâˆˆV (12)
yf
e,vâ‰¥0âˆ€eâˆˆÎ´(v), vâˆˆV, fâˆˆE (13)
xuâˆˆZâˆ€uâˆˆV
yf
e,vâˆˆZâˆ€eâˆˆÎ´(v), vâˆˆV, fâˆˆE.
Theorem 5 follows from the following lemma.
Lemma 21. For an input graph G= (V, E)with non-negative vertex costs c:Vâ†’Râ‰¥0, (FVS-IP:
Complete-Orient ) is an integer linear programming formulation for FVS. Moreover, its LP-relaxation
has integrality gap at most 2.
Proof.Letxbe the indicator vector of a feedback vertex set SofG. We show that there exists a binary
vector ysatisfying the constraints. Let Tbe a spanning tree of Gcontaining all edges of Gthat are not
incident to vertices in S. Fix an edge f=abâˆˆE. For each vertex vâˆˆV\(Sâˆª {a, b}), set yf
e,w= 1where
e=vwis the first edge on the unique path from vtoainT. Moreover, set yf
f,a=yf
f,b= 1and all other yf
variables to 0. We prove that this choice of ysatisfies all constraints.
For an edge e=vwâˆˆE, if|Sâˆ© {v, w}| â‰¥ 1, then xv+xwâ‰¥1and if v, wÌ¸âˆˆS, then eâˆˆTand
consequently, either yf
e,v= 1oryf
e,w= 1and hence, the constraint xv+xw+yf
e,v+yf
e,wâ‰¥1holds. For
36a vertex vâˆˆV, ifvâˆˆS, then xvâ‰¥1and if vâˆˆVâˆ’S, then there exists an edge e=vwâˆˆTand
hence, yf
e,w= 1and consequently, the constraint xv+P
e=vwâˆˆEyf
e,wâ‰¥1holds. It remains to show that the
constraintP
vâˆˆVâˆ’{a,b}xv+P
e=vwâˆˆEâˆ’{f}(yf
e,w+yf
e,v)â‰¤ |V|âˆ’2holds. By the choice of x, it suffices to show
that|S\ {a, b}|+P
e=vwâˆˆTâˆ’{f}(yf
e,w+yf
e,v)â‰¤ |V| âˆ’2holds. By the choice of yf, it suffices to show that
|S\ {a, b}|+P
e=vwâˆˆT(yf
e,w+yf
e,v)â‰¤ |V|. Simplifying this further, it suffices to show that
X
e=vwâˆˆT(yf
e,w+yf
e,v)â‰¤ |(Vâˆ’S)âˆª {a, b}|.
We note thatP
e=vwâˆˆT(yf
e,w+yf
e,v) =P
vâˆˆV(P
e=vwâˆˆTyf
e,w). Hence, it suffices to show that
X
vâˆˆVï£«
ï£­X
e=vwâˆˆTyf
e,wï£¶
ï£¸â‰¤ |(Vâˆ’S)âˆª {a, b}|.
We have the following four inequalities:
X
e=vwâˆˆTyf
e,wâ‰¤1âˆ€vâˆˆVâˆ’(Sâˆª {a, b}),
X
e=vwâˆˆTyf
e,w= 0âˆ€vâˆˆSâˆ’ {a, b},
X
e=awâˆˆTyf
e,w=yf
e,b= 1,and
X
e=bwâˆˆTyf
e,w=yf
e,a= 1.
Hence,P
vâˆˆVP
e=vwâˆˆTyf
e,w
â‰¤ |(Vâˆ’S)âˆª {a, b}|.
Next, we show that an integral solution to the system of inequalities (9), (10), (11), (12), and (13) is the
indicator vector of a feedback vertex set. We will use the following claim.
Claim 6. Constraints (9), (10), (11), (12), and (13) imply the strong density constraints.
Proof.Let(x, y)be a solution satisfying constraints (9), (10), (11), (12), and (13). Let SâŠ†Vsuch that
E[S]Ì¸=âˆ…. We will show thatX
uâˆˆS(dS(u)âˆ’1)xuâ‰¥ |E[S]| âˆ’ |S|+ 1.
Equivalently, we will show that
|E[S]| âˆ’ |S| âˆ’X
uâˆˆS(dS(u)âˆ’1)xuâ‰¤ âˆ’1.
Let us rewrite the LHS as
|E[S]| âˆ’ |S| âˆ’X
uâˆˆS(dS(u)âˆ’1)xu=X
vwâˆˆE[S](1âˆ’xvâˆ’xw) +X
vâˆˆS(xvâˆ’1).
Let us inspect each sum separately. Fix an arbitrary f=abâˆˆE[S]. We have that
X
vwâˆˆE[S](1âˆ’xvâˆ’xw) =X
vwâˆˆE[S]
1âˆ’xvâˆ’xwâˆ’yf
e,wâˆ’yf
e,v
+X
vwâˆˆE[S]
yf
e,v+yf
e,w
â‰¤1âˆ’xaâˆ’xbâˆ’yf
f,aâˆ’yf
f,b+X
vwâˆˆE[S]
yf
e,v+yf
e,w
37where the inequality follows from (9) and the fact that f=abâˆˆE[S]. We also have that
X
vâˆˆS(xvâˆ’1) =X
vâˆˆSï£«
ï£­xvâˆ’1 +X
e=vwâˆˆEyf
e,wï£¶
ï£¸âˆ’X
vâˆˆSX
e=vwâˆˆEyf
e,w
â‰¤X
vâˆˆVï£«
ï£­xvâˆ’1 +X
e=vwâˆˆEyf
e,wï£¶
ï£¸âˆ’X
vâˆˆSX
e=vwâˆˆEyf
e,w
where the last inequality follows from (10). Before adding the two upper bounds, we also note that
X
vwâˆˆE[S]
yf
e,v+yf
e,w
âˆ’X
vâˆˆSX
e=vwâˆˆEyf
e,wâ‰¤0
by (13). Hence,
X
vwâˆˆE[S](1âˆ’xvâˆ’xw) +X
vâˆˆS(xvâˆ’1)â‰¤1âˆ’xaâˆ’xbâˆ’yf
f,aâˆ’yf
f,b+X
vâˆˆVï£«
ï£­xvâˆ’1 +X
e=vwâˆˆEyf
e,wï£¶
ï£¸
= 1âˆ’ |V|+X
vâˆˆVâˆ’{a,b}xv+X
vwâˆˆEâˆ’{f}(yf
e,v+yf
e,w)
â‰¤ âˆ’1
where the last inequality follows from (11).
By the results of Chudak, Goemans, Hochbaum, and Williamson [CGHW98], every integral solution
satisfying strong density constraints corresponds to the indicator vector of a feedback vertex set. Thus, by
Claim 6, an integral solution to the system of inequalities (9), (10), (11), (12), and (13) is the indicator
vector of a feedback vertex set. This completes the proof that the formulation given in the lemma is indeed
an integer linear programming formulation for FVS.
Finally, we bound the integrality gap of the LP-relaxation. By the results of Chudak, Goemans,
Hochbaum, and Williamson [CGHW98], we know that (FVS-IP: SD) is an ILP formulation for FVS and the
integrality gap of its LP-relaxation (FVS-LP: SD) is at most 2. We have already shown that the ILP in the
lemma statement is a valid formulation for FVS. By Claim 6, the LP-relaxation of the ILP in the lemma
statement has integrality gap at most 2.
38