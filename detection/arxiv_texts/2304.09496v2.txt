WEAK CONVERGENCE OF TAMED EXPONENTIAL
INTEGRATORS FOR STOCHASTIC DIFFERENTIAL
EQUATIONS
UTKU ERDO ˘GAN AND GABRIEL J. LORD
Abstract. We prove weak convergence of order one for a class of expo-
nential based integrators for SDEs with non-globally Lipschitz drift. Our
analysis covers tamed versions of Geometric Brownian Motion (GBM)
based methods as well as the standard exponential schemes. The nu-
merical performance of both the GBM and exponential tamed meth-
ods through four different multi-level Monte Carlo techniques are com-
pared. We observe that for linear noise the standard exponential tamed
method requires severe restrictions on the step size unlike the GBM
tamed method.
1.Introduction
We consider weak convergence analysis of tamed schemes for semi-linear
stochastic differential equations (SDEs) of the form
(1) d Xt= (AXt+F(Xt)) dt+mX
i=1(BiXt+gi(Xt)) dWi
t, X 0=x∈Rd,
with m,d∈N. Here Wi
tare iid Brownian motions on the probability space
(Ω,F,P) with filtration ( Ft)t∈[0,T]. The nonlinearity F:Rd→Rdonly
satisfies a one-sided Lipschitz condition, where as the gi:Rd→Rdare
globally Lipschitz. We assume throughout that the matrices A,Bi∈Rd×d
satisfy the following zero commutator conditions
(2) ABi−BiA= 0, B jBi−BiBj= 0 for i, j= 1, . . . , m.
Condition (2) is used to exploit the exact solution of Geometric Brownian
Motion (GBM) below. By introducing the notation Wt:= [W1
t, . . . , Wm
t]T,
(3) µ(y) :=Ay+F(y), σ i(y) :=Biy+gi(y),
and the matrix σ(x) := [ σi(x)], (i.e. columns formed by σi) we can re-write
(1) as
(4) d Xt=µ(Xt)dt+σ(Xt)dWt, X 0=x∈Rd.
The schemes we examine are in the class of exponential integrators. These
methods have proved to be effective schemes for many SDEs and stochastic
partial differential equations (SPDEs). Originally only linear (or linearized)
drift terms were exploited, see for example [23, 3, 26, 17, 18], however re-
cently several exponential integrators that also exploit the linear terms in
diffusion emerged [16, 11, 10, 31]. We are particularly interested in dealing
with a one-sided Lipschitz drift term Fwith superlinear growth. Hutzen-
thaler et al. [14] showed both strong and weak divergence of Euler’s method
1arXiv:2304.09496v2  [math.NA]  4 Jul 20242 UTKU ERDO ˘GAN AND GABRIEL J. LORD
for the general SDE (1) with superlinearly growing coefficients Fand/or
gi. Following [14] many explicit variants of Euler–Maruyama schemes that
guarantee the strong convergence to the exact solution of SDE were derived,
see for example [15, 25, 2, 21, 33, 29]. The most well known approach to
deal with superlinearly growing coefficients is to employ “taming” to pre-
vent the unbounded growth of numerical solutions. Although there has been
much consideration of strong convergence of tamed schemes, see for exam-
ple [15, 27, 28] there has been little consideration of weak convergence for
SDEs [5, 4, 32, 30]. In [5], Br´ ehier investigated the weak error of the explicit
tamed Euler scheme for SDE’s with one–sided Lipschitz continuous drift
and additive noise to approximate averages with respect to the invariant
distribution of the continuous time process. Bossy et al. , [4], proposed and
proved weak convergence of a semi-explicit exponential Euler scheme for a
one-dimensional SDE with non-globally Lipschitz drift and diffusion behav-
ing as xα, with α >1. Due to the weak condition on the diffusion coefficient,
their study covers regularity results for the solution of the Kolmogorov PDE
commonly used in weak error analysis. In [30], Wang et al. formulated a
general weak convergence theorem for one-step numerical approximations of
SDEs with non-globally drift coefficients. They applied this to prove weak
convergence of rate one for the tamed and backward Euler–Maruyama meth-
ods. We would like to point out that their analysis is not directly applicable
to our GBM based schemes as it is not a classical one-step method but
rather the composition of the GBM flow and a one-step flow. In the context
of SPDEs, Cai et al. [7] constructed and analysed a weak convergence of a
numerical scheme based on a spectral Galerkin method in space and a tamed
version of the exponential Euler method. Below we impose conditions that
are similar to those for the SPDE in [7]. We prove weak convergence for a
class of exponential integrators where a form of taming is used for the one-
sided Lipschitz drift term. The GBM methods exploit the exact solution of
geometric Brownian motion, see [11] and [12] where strong convergence of
related methods were considered. Further, by taking A=Bi= 0 (or incor-
porating these terms into the nonlinearities) we simultaneously prove weak
convergence for the standard exponential tamed scheme such as in [9].Our
proof is based on the Kolmogorov equation and one of the main difficulties
is to take into account the stochasticity in the solution operator.
In our numerical experiments we compare different approaches to estimate
the weak errors all using multi-level Monte Carlo (MLMC) techniques as
reviewed in [13]. For a linear diffusion term we observe that the exponential
tamed method does not perform well for larger time step sizes and hence a
time step size restriction is required for MLMC techniques (for example to
estimate the weak errors). This is of particular interest as tamed methods
were originally introduced and strong convergence was examined precisely
to control nonlinearities in the context of MLMC type simulations, see [15].
The GBM based method does not suffer in this way in our experiments for
linear noise. For nonlinear diffusion both tamed based methods require a
step size restriction for convergence on the MLMC techniques.
The paper is organized as follows: in Section 2 we state our assumptions
on the drift and diffusion, present the new numerical method and state ourWEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 3
main results. In Section 3 we present numerical simulations illustrating the
rate of convergence using the MLMC simulations and compare the differ-
ent approaches. The proofs of the main results are then given in detail in
Sections 4 and 5.
2.Setting and Main Results
Throughout the paper we let
·,·
denote the standard inner product in
Rd(so
y, z
=y⊺zfory, z∈Rd) and∥·∥represent both the Euclidean norm
for vectors as well as the induced matrix norm. A vector β= (β1, β2, . . . , β d)
is a multiindex of order |β|=Pd
i=1βiwith nonnegative integers components.
The partial derivative operator corresponding to the multiindex βis defined
as
Dβh(x) =∂|β|h(x)
∂β1x1∂β2x2. . . ∂βdxd
where h∈C|β|(Rd;Rl). For a nonnegative integer j, we let Djh(x) represent
thejth order derivative operator applied to a function h∈Cj(Rd;Rl). When
j= 1 we simply write the Jacobian as Dh.
Additionally, Ck
b(Rd;R) denotes of the set of k-times differentiable func-
tions, which are uniformly continuous and bounded together with their
derivatives up to k-th order.
We define the sets
Nn:={0,1,2, . . . , n } and N+
n:={1,2, . . . , n }.
Before introducing our class of numerical methods we present three results
from [8] on the existence and uniquenes, bounded moments and mean-square
differentiability of the exact solution to (4).
2.1.Preliminary Results for the SDE. For an SDE such as (4) with
globally Lipschitz drift and diffusion coefficients many classical textbooks
on stochastic analysis consider the Kolmogorov PDE. However, for non-
globally Lipschitz drift coefficients there are far fewer results. One key work
is Cerrai [8] for the properties of the exact solution to a SDE with one-sided
drift coefficient.
Assumption 1. LetH≥0be given. Let the functions Fandgi∈
Ch(Rd;Rd)for some h≥Hwhere i= 1,2, . . . , m . Define the matrix g
by the columns of giso that g= [gi]. Additionally, assume that
(i) there exists r≥0such that for any j= 0,1, . . . , h
supy∈Rd∥DαF(y)∥(1 +∥y∥2r+1−j)−1<∞,|α|=j;
(ii) there exists ρ≤rsuch that for any j= 0,1, . . . , h
supy∈Rd∥Dαgi(y)∥(1 +∥y∥ρ−j)−1<∞,|α|=j;
(iii) for all p >0there exist K=K(p)∈Rsuch that
y,DF(z)y
+p∥Dg(z)y∥2≤K∥y∥2,∀y, z∈Rd.
Assumption 2. There exist constants a >0andr, γ, c ≥0such that for
anyy, z∈Rd

Az, z
+
F(y+z)−F(y), z
≤ −a∥z∥2r+2+c(∥y∥γ+ 1).4 UTKU ERDO ˘GAN AND GABRIEL J. LORD
In particular, under Assumption 1, Cerrai [8] proves the existence and
uniqueness of a solution to the SDE (1).
Theorem 1 ([8],Theorem 1.3.5) .Suppose that Assumption 1 holds with
H= 3. Then there exists a unique solution Xtfort∈[0, T]to the SDE
(1)along with the following moment bound for p≥1and constant C=
C(p, T)>0
(5) E[∥Xt∥p]< C(1 +∥x∥p).
To get order one weak convergence we need to assume bounded moments
of derivatives of the exact solution to the SDE (1) with respect to the initial
condition. By the notation Xx
t, we emphasize that the initial condition is
X0=x. We denote the derivative of the exact solution with respect to the
initial condition by DxXx
t. The following regularity result is given in [8] (see
also [30, 32]).
Theorem 2 ([8], Theorem 1.3.6) .Let Assumption 1 hold with H= 3,
Assumption 2 hold and Xx
tbe the solution to (1). Then Xx
tishtimes
mean-square differentiable and for i= 1, . . . , h ,p≥1andt∈[0, T]
sup
x∈RdEhDi
xXx
tpi
<∞.
Assumption 3. Let the test function ϕ:Rd→Randϕ∈C2
b(Rd).
Before continuing we define the quantity
(6) Ψ( t, x) :=E[ϕ(Xt)|X0=x] =E[ϕ(Xx
t)].
Theorem 3 ([8], Theorem 1.6.2) .Let Assumption 1 with H= 3, Assump-
tion 2 and Assumption 3 hold. Let Xtbe the solution to (1). Then, Ψ(t, x)
defined in (6)is the unique classical solution to the Kolmogorov PDE
(7)∂
∂tΨ(t, x) =LΨ(t, x)
where, with µandσidefined in (3),Lis given by
LΨ(t, x) :=DΨ(t, x)µ(x) +1
2mX
i=1σi(x)⊺D2Ψ(t, x)σi(x).
Remark 1. Rather than imposing an extra hypotheses (Hypotheses 1.3)
as in [8]on the diffusion coefficient we assume in Assumption 3 that ϕis
inC2
b(Rd). Together with the mean-square differentiability of Xx
tgiven in
Theorem 2, Ψ(t, x)then satisfies smoothness and boundedness conditions
required in the proof of Theorem 1.6.2 in [8].
2.2.Tamed GBM Method and Convergence Results. Our class of
exponential methods takes advantage of the linear terms in (1) by exploiting
the stochastic operator
(8) Φt,t0= exp 
(A−1
2mX
i=1B2
i)(t−t0) +mX
i=1Bi(Wi
t−Wi
t0)!WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 5
which, under the commutativity condition (2), is the solution to
(9) d Φt,t0=AΦt,t0dt+mX
i=1BiΦt,t0dWi
t, Φt0,t0=Id.
Given N∈Nand final time Twe set the time step size ∆ t=T
N. This gives
the uniform time partition 0 = t0< t1< t2< . . . < t N=Twith tn=n∆t.
We denote increments ∆ Wi
n:=Wi
tn+1−Wi
tn.
We propose and prove weak convergence of the tamed GBM method
(10)
YN
n+1=Φtn+1,tn 
YN
n+ 
Ftm
∆t(YN
n)−mX
i=1Bigi(YN
n)!
∆t+mX
i=1gi(YN
n)∆Wi
n!
where Ftm
∆tis the taming term given by
(11) Ftm
∆t(y) :=α(∆t, y)F(y).
The taming function α(∆t, y) is assumed to satisfy for all y∈Rdand ∆ t >0
(12)∥α(∆t, y)F(y)∥∆t≤1,0≤α(∆t, y)≤1,|α(∆t, y)−1| ≤C∆t,
where C > 0 is a constant independent of ∆ t. The typical form of taming
(e.g. [15, 27]) is to take α(∆t, y) = (1 + ∆ t∥F(y)∥p)−1, so that with p= 1
(13) Ftm
∆t(y) =F(y)
1 + ∆ t∥F(y)∥.
Strong convergence of (10) with (13) and gi≡0 was considered in [12]
and the efficiency of the method was illustrated numerically. If we take
α(t, y)≡1, so that Ftm
∆t=Fin (10), then we obtain one of the methods in
[11] (proved to be strongly convergent with order 1/2 under global Lipschitz
assumptions). Further it was shown the method is highly efficient for SDE’s
with dominant linear terms and, by a homotopy approach, is competitive
when applied to highly non-linear forms of (1). Note that it is clear from (1)
that taking Bi= 0 and A=Bi= 0 (or incorporating these terms into the
nonlinearities) we recover from (10) the exponential tamed and the standard
tamed methods respectively.
Before we state our main results we give an integral representation of the
continuous version of the numerical method. Let us define the continuous
extension of numerical solution ¯Ytfort∈[tn, tn+1] by
(14) ¯Yt=Φt,tn¯Ytn+Φt,tnZt
tn 
Ftm
∆t(¯Ytn)−mX
i=1Bigi(¯Ytn)!
ds
+Φt,tnZt
tnmX
i=1gi(¯Ytn)dWi
s.
Then it is clear that YN
n=¯Ytnfortn≤t < t n+1.
Lemma 1. Let¯Ytbe the interpolated continuous version in (14) of the
numerical solution given in (10). Then the differential for this solution is6 UTKU ERDO ˘GAN AND GABRIEL J. LORD
given by
(15) d ¯Yt=µtmdt+mX
i=1σtm
idWi
t, t ∈[tn, tn+1]
where µtm=µtm(t, tn)andσtm
i=σtm
i(t, tn)and
(16) µtm:=A¯Yt+Φt,tnFtm
∆t(¯Ytn),and σtm
i:=Bi¯Yt+Φt,tngi(¯Ytn).
Proof. By the definition of the inverse GBM (see for example [19]),
dΦ−1
t,tn= 
−A+mX
i=1B2
i!
Φ−1
t,tndt−mX
i=1BiΦ−1
t,tndWi
t.
We seek the appropriate µtmandσtm
i. The product rule for the Itˆ o differ-
ential gives
(17) d 
Φ−1
t,tn¯Yt
=Φ−1
t,tn
(−A+mX
i=1B2
i)¯Yt+µtm−mX
i=1Biσtm
i
dt
+Φ−1
t,tnmX
i=1 
σtm
i−Bi¯Yt
dWi
t.
On the other hand (14) can be written as
(18) d 
Φ−1
t,tn¯Yt
= 
Ftm
∆t(¯Ytn)−mX
i=1Bigi(¯Ytn)!
dt+mX
i=1gi(¯Ytn)dWi
t.
By comparison of (18) with (17), we find
Φ−1
t,tn 
(−A+mX
i=1B2
i)¯Yt+µtm−mX
i=1Biσtm
i!
=Ftm
∆t(¯Ytn)−mX
i=1Bigi(¯Ytn)(19)
Φ−1
t,tn 
σtm
i−Bi¯Yt
=gi(¯Ytn), i= 1,2. . . , m. (20)
Solving matrix equation (20) for σtm
i, the commutativity conditions (2) and
substitution into equation (19) to determine µtmgives the desired result. □
Our main result is weak convergence of order one of the numerical scheme
(10) and to prove this we make use of bounded moments.
Assumption 4. There exists K > 0such that for all i= 1, . . . , m
∥gi(y)−gi(z)∥ ≤K∥y−z∥,∀y, z∈Rd.
Remark 2. The global Lipschitz property given in Assumption 4 implies
boundedness of Dg. Together with Assumption 1, by the mean value Theo-
rem, there exists K∈Rsuch that for all y, z∈Rd
(21)
y−z, F(y)−F(z)
≤K∥y−z∥2.
Theorem 4. Let Assumption 1 with H= 1and Assumption 4 hold. Then,
forYN
nbe given by (10) and for all p∈[1,∞)
sup
N∈Nsup
0≤n≤NEhYN
npi
<∞.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 7
The proof of this Theorem is given in Section 4 and follows the approach
of [15]. However we need to control the stochastic operator in (8) and in
contrast to [12] we also now need to take account of the nonlinear diffusion
terms gi. The main novelty in our proof below is the interaction between
these two terms.
Theorem 5. Let Assumption 1 with H= 4, Assumption 2 and Assumption
4 hold. Let XTbe the solution to (1). Let YN
Nbe found from (10) and(12)
hold. Then, for all ϕ:Rd→R,ϕ∈C4
b(Rd)there is a constant C > 0,
independent of ∆tsuch that
|E
ϕ(YN
N)
−E[ϕ(XT)]| ≤C∆t.
Although in Theorem 3 we have ϕ∈C2
b(Rd), to get first order weak
convergence, we impose ϕ∈C4
b(Rd) in Theorem 5. We prove Theorem 5
in Section 5 using the Kolmogorov equation. Once again we need to take
careful account of the stochastic operator Φt,t0from (8) as well as dealing
with the one-sided Lipschitz drift F. Before giving the proofs we present
some numerical results.
3.Numerical Results
We seek to estimate numerically the weak discretization error |E[ϕ(XT)]−
E
ϕ(YN
N)
|, where YN
Nis a numerical approximation to XTwith ∆ t=T/N.
To illustrate the rate of convergence we need to estimate the weak error
for different values of ∆ t. Our aim is to examine this in the absence of
an analytic solution or where the numerical solution of the Kolomogorov
equation is prohibitively expensive. We also wish to illustrate the weak
convergence rate of order 1 that is proved in Theorem 5.
In practice we take a reference numerical solution so that XT≈YNRwith
NR>> N (with ∆ tR=T/N R). We then estimate
|E
ϕ(YNR)
−E
ϕ(YN
N)
|=|E
ϕ(YNR)−ϕ(YN
N)
|.
Note that YNRmay be computed by a different method to that for YN
N. In
[20] issues in computing weak errors using MLMC methods for SPDEs are
discussed with multiplicative noise and upper and lower bounds of simulation
errors are obtained. However the authors did not consider the simultaneous
computation of a reference solution. In [1] the MLMC method is examined
where the zero solution is asymptotically mean square stable and an im-
portance sampling technique was introduced. We observe similar stability
issues below.
We briefly discuss four approaches to estimate the weak error using the
multi-level Monte-Carlo technique (MLMC), see [13, 22]. We denote these
methods Trad ,MLMCL0 ,MLMC ,MLMCSR and examine them nu-
merically in our experiments. In a traditional method, denoted Trad , we
estimate independently E
ϕ(YNR)
andE
ϕ(YN
N)
by a MLMC method.
Thus, for the reference solution we have
(22) E
ϕ(YNR)
=E
ϕ(YN0)
+RX
ℓ=1E
ϕ(YNℓ)−ϕ(YNℓ−1)8 UTKU ERDO ˘GAN AND GABRIEL J. LORD
and for the approximation, with NL:=N
(23) E
ϕ(YN
N)
=Eh
ϕ(YN0
N0)i
+LX
ℓ=1Eh
ϕ(YNℓ
Nℓ)−ϕ(YNℓ−1
Nℓ−1)i
.
An alternative is to exploit difference in the telescoping sums from the
MLMC approach for the reference YNR(22) and numerical approximation
YN
N(23). Subtracting we get
E
ϕ(YNR)
−E
ϕ(YN
N)
=Eh
ϕ(YN0)−ϕ(YN0
N0)i
+LX
ℓ=1Eh
ϕ(YNℓ)−ϕ(YNℓ−1)−[ϕ(YNℓ
Nℓ)−ϕ(YNℓ−1
Nℓ−1)]i
+RX
ℓ=L+1E
ϕ(YNℓ)−ϕ(YNℓ−1)
. (24)
For the coarsest level ℓ= 0 we have a choice of estimating E
ϕ(YN0)
−
Eh
ϕ(YN0
N0)i
orEh
ϕ(YN0)−ϕ(YN0
N0)i
. If the reference YN0is found with a
different method to that of YN0
N0, we can expect some variance reduction
using the latter method over the former (and so fewer samples required
to approximate the expectation). Note that if only computing for a fixed
single Lthen we expect further variance reduction for the second term, i.e.
in estimating
Eh
ϕ(YNℓ)−ϕ(YNℓ−1)−[ϕ(YNℓ
Nℓ)−ϕ(YNℓ−1
Nℓ−1)]i
.
However, here we wish to compute for different values of Lin order to il-
lustrate the rate of convergence. Thus, rather than recomputing (24) for
different Lwe instead as follows (to avoid recomputing the MLMC esti-
mates).
ForMLMCL0 we exploit efficiency of variance reduction on the coarsest
level and so estimate Eh
ϕ(YN0)−ϕ(YN0
N0)i
,with estimations of
Eh
ϕ(YNℓ
Nℓ)−ϕ(YNℓ−1
Nℓ−1)i
, ℓ∈N+
L,&E
ϕ(YNℓ)−ϕ(YNℓ−1)
, ℓ∈N+
R.
Where as for MLMC we estimate the weak error by (24) and estimate
E
ϕ(YN0)
,Eh
ϕ(YN0
N0)i
separately. Finally we see from (24) that if the same
numerical scheme is used to estimate both the reference solutions and YN
N
that
E
ϕ(YNR)
−E
ϕ(YN
N)
=RX
ℓ=L+1E
ϕ(YNℓ)−ϕ(YNℓ−1)
.
This method does not allow for a more accurate (e.g. higher order) reference
solution (as it uses a self reference). We call this MLMCSR and estimate
E
ϕ(YNℓ)−ϕ(YNℓ−1)
, ℓ = 1,2, . . . , R.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 9
Method d= 1 d= 4 d= 10
MLMCL0 18.51 (9.25) 180.87 (9.89) 303.31 (0.47)
MLMC 15.51. (0.08) 177.92 (0.41) 304.07 (0.39)
Trad GBM 15.30 (13.82) 141.57 (0.29) 247.92 (0.05)
Trad Tamed 13.82 (0.02) 81.10 (0.23) 151.65 (0.21)
Table 1. Average computational times in seconds (and
standard deviation) required to compute the convergence
plots (e.g. Fig. 1 (a) or (b) or one curve in (c) or (d)).
Note that MLMCSR is computed directly from MLMC .
To illustrate the rate one weak convergence results of Theorem 5 we con-
sider the following cubic SDE in Rd
dX= [AX+X−X3]dt+β1XdW+β2X
1 +X2dW.
This cubic equation is often used as a test equation as solutions exhibit
transitions between different phases. With d= 1 it is sometimes known as
the Ginzburg-Landau equation, [19]. For larger dthe system of SDEs can
be thought of as arising from the spatial discretization of a stochastic Allen-
Cahn equation, see for example [23, 11, 14, 6, 7]. We first examine the linear
diffusion with β1= 0.1,β2= 0 and then non-linear diffusion β1=β2= 0.1.
We look at dimensions d= 1,4,10,50 and d= 100. For d= 1 we take A=
−4,X0=x= 0.5. For d≥4Ais the standard tridiagonal matrix from the
finite difference approximation to the Laplacian: A= 0.5d−2diag(1 ,−2,1)
and as initial data we take X0=x= 0.5 exp(−10(y−0.5)2) where y=
[1/d,2/d, . . . , (d−1)/d]T. We solve to T= 1 and as ϕ, we take ϕ(y) =∥y∥2.
The standard exponential tamed method is used as the reference solution
YNR(except for MLMCSR when looking at our GBM tamed method)
and we take (13) as our taming function. We perform 10 separate runs
computing the full weak error convergence plot and use this to estimate the
standard deviation.
First we examine the linear noise case with β1= 0.1 (and β2= 0).
Table 1 compares the efficiency of the different methods for estimating the
weak error for dimensions d= 1,4 and 10. We restrict ∆ t <0.0075 in
these computations to ensure we see convergence of the exponential tamed
method. We observe, as expected, that estimating the weak error directly
by either MLMCL0 orMLMC is far more efficient than using the MLMC
in a traditional from Trad . We also observe there is a slight advantage to
using MLMCL0 compared to MLMC (due to some variance reduction
on the coarsest level). Trad (GBM) looks at convergence for the GBM
based methods and (Tamed) to the exponential tamed method, we observe
a small overhead in the GBM method compared to Tamed. However, as we
discuss below, there are advantages to the GBM approach. An alternative
method would be to take a drift implicit method and to solve a nonlinear
system of equations at each step. The weak errors are similar to those
for GBM. Using the standard fsolve (without providing the linearization)
in MATLAB leads to computational times two orders of magnitude larger
(e.g. 2396 seconds (8.6) for MLMC0 and 2396 seconds (2.8) for MLMC)10 UTKU ERDO ˘GAN AND GABRIEL J. LORD
performed on the same cluster. For this reason we only show convergence
plots for the explicit methods.
In Fig. 1 we show weak convergence for d= 1 and in all approaches
observe the expected rate of convergence one. Furthermore in (c) and (d),
where we have a direct comparison to the exponential tamed method, we
see the GBM based method has a smaller error constant. We see in (d) that
the two smallest step sizes (∆ t= 2−9and ∆ t= 2−9) are too close to the
reference time step to observe convergence.
10-310-2
Time step10-510-410-310-210-1Weak ErrorWeak Error:MLMCL0
Reference slope 1
(a)MLMCL0
10-310-2
Time step10-510-410-310-210-1Weak ErrorWeak Error:MLMC
Reference slope 1 (b)MLMC
10-310-2
Time step10-410-3Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1
(c)MLMCSR
10-310-210-1
Time step10-410-310-210-1Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1 (d)Trad
Figure 1. Comparison of different approaches to estimate
the weak error for d= 1 with β1= 0.1 and β2= 0.
In Fig. 2 we show convergence for d= 4 and observe the predicted
convergence of rate 1. In (a), (b) and (c) we restrict the largest step so that
∆t <0.02. For the exponential tamed method it was essential to impose this
restriction on the maximum step size as, although solutions remain bounded,
the error is too large to observe convergence. These large solutions also lead
to large variances and hence an infeasible large number of samples, (see also
the discussion in [1]). This is illustrated by comparing (c) where we restrict
∆t <0.02 and (d) where ∆ t <0.2. The exponential tamed method only
starts to converge for ∆ t≤0.02. For the larger step sizes in (d) we see the
GBM based method performs well (unlike the exponential tamed method).
The small step size restriction on the standard exponential method as d
increases makes it difficult to obtain a reference solution using this method
using the MLMC method.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 11
10-410-310-2
Time step10-610-510-410-310-210-1Weak ErrorWeak Error:MLMC
Reference slope 1
(a)MLMCL0
10-410-310-2
Time step10-610-510-410-310-210-1Weak ErrorWeak Error:MLMCL0
Reference slope 1 (b)MLMC
10-410-310-210-1100
Time step10-510-410-310-2Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1
(c)MLMCSR (∆t <0.02)
10-310-210-1100
Time step10-410-2100102104Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1 (d)MLMCSR (∆t <0.2)
Figure 2. Comparison of 3 different approaches to estimate
the weak error for d= 4 with β1= 0.1 and β2= 0. In (d) we
see that the exponential tamed method is not well behaved
for large time step size.
In Fig. 3 we illustrate convergence using MLMCSR for the two methods
with d= 50 and d= 100. We only examine MLMCSR as for these larger
values of ddue to unreliable results the exponential tamed method for larger
∆tvalues (as discussed for Fig. 2). We see that for d= 50 we require
∆t <2×10−4and for d= 100 that ∆ t <10−4to obtain an approximation
using the standard exponential tamed method. However, we observe that
the GBM method converges with the predicted order and there is no issue
with large variances.
For the nonlinear diffusion, with β1=β2= 0.1 in (3), we illustrate
convergence in Figure 4 (a) MLMCSR and (b) Trad . We have taken d= 4
and observe weak convergence of rate one. Both the methods MLMC and
MLMCL0 also show rate one convergence with the GBM based method
having a smaller error constant. For this nonlinear noise, for larger values
of ∆t, although the taming ensures solutions remain bounded the variance
does not reduce. This is now for both methods.12 UTKU ERDO ˘GAN AND GABRIEL J. LORD
10-410-3
Time step10-510-4Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1
(a)MLMCSR d= 50
10-410-3
Time step10-510-4Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1 (b)MLMCSR d= 100
Figure 3. Convergence for d= 50 and d= 100 with
β1= 0.1 and β2= 0. For larger time step sizes the ex-
ponential tamed method has a large variance and we do not
see convergence until smaller time step sizes.
10-310-2
Time step10-410-3Weak Error
GBM Tamed
Exponential Tamed
Reference slope 1
(a)MLMCSR
10-310-210-1
Time step10-510-410-310-210-1Weak ErrorGBM Tamed
Exponential Tamed
Reference slope 1 (b)Trad
Figure 4. Weak convergence for d= 4 with β1=β2= 0.1.
We observe rate one convergence. A time step size restriction
is required.
4.Proof of Theorem 4 : bounded moments
We let ∆ Wk:= (∆ W1
k,∆W2
k, . . . , ∆Wm
k)T.For the drift we define the
notation
(25) N(x) :=Ftm
∆t(x)−mX
i=1Bigi(x)
where Ftm
∆tis defined in (11). We can use Nto re-write (10) as
YN
n+1=Φtn+1,tn 
YN
n+N(YN
n)∆t+mX
i=1gi(YN
n)∆Wi
n!
.
We now prove the boundedness of the operator Φt,t0in stochastic Lpspaces.
Lemma 2. Suppose p≥2,0≤s < t≤Tand let Φt,sbe given in (8)with
t0=s. Then,WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 13
i)For any Fsmeasurable random variable vinLp(Ω,Rd)
∥Φt,sv∥Lp(Ω,Rd)≤exp  
∥A∥+p−1
2mX
i=1∥Bi∥2!
(t−s)!
∥v∥Lp(Ω,Rd).
ii)There are constants κ1,2>0, independent of (t−s)such that
E[∥Φt,s∥p]≤κ1exp(κ2(t−s)).
Proof. For the proof of i), see [12].
To show ii) we recall that for a standard Gaussian variable z∼N(0,1)
andα >0
(26)
E[exp( α|z|)] =1√
2πZ∞
−∞exp(α|x|) exp(−x2/2)dx= exp( α2/2)
1 + erf( α/√
2)
.
From (8) we have that
(27)
∥Φt,s∥p≤exp p(A−1
2mX
i=1B2
i)(t−s)!
exp 
pmX
i=1∥Bi∥|Wi
t−Wi
s|!
.
By taking expectation of both sides in (27) and considering the indepen-
dence and distribution of random values |Wi
t−Wi
s|and using (26) for
i= 1,2, . . . , m , we have
E[∥Φt,s∥]p
≤exp p(A−1
2mX
i=1B2
i)(t−s)!mY
i=1E
exp 
p∥Bi∥|Wi
t−Wi
s|
= exp p(A−1
2mX
i=1B2
i)(t−s)!
×mY
i=1exp1
2p2∥Bi∥2(t−s)
1 + erf(p√t−s∥Bi∥√
2)
.
By the boundedness of the function erf, the positive constants κ1andκ2are
determined in terms of p,∥A∥and∥Bi∥. □
For the proof of Theorem 4, we adapt the approach given in [15]. In
[12] a similar approach was taken with linear diffusion and so the additional
element below is dealing with the nonlinear diffusion terms gi. We start by
introducing appropriate sub events of Ω. We let ΩN
0:= Ω, then for n∈N+
N
ΩN
n:=(
ω∈Ω|sup
k∈Nn−1DN
k(ω)≤N1/4r,sup
k∈Nn−1∥∆Wk∥ ≤1)
,
where the parameter ris as defined in Assumption 1. The dominating
stochastic process DN
nis defined with DN
0:= (λ+∥x∥)eλand for n∈N+
N
by
DN
n:= (λ+∥x∥) sup
u∈Nnn−1Y
k=uΦtk+1,tkexp 
λ+ sup
u∈Nnn−1X
k=u
λ∥∆Wk∥2+βN
k!14 UTKU ERDO ˘GAN AND GABRIEL J. LORD
where
βN
k:= 1∥YN
k∥≥1
YN
k,Pm
i=1gi(YN
k)∆Wi
k
YN
k2and λ:= max {λ0, λ1, λ2, λ3, λ4}.
Here λ0, . . . , λ 4are constants defined by
λ0:= exp mX
i=1∥Bi∥+TA−1
2mX
i=1B2
i!
×
1 + 2 TK+T∥F(0)∥
. . .+mX
i=1∥Bi∥TK+TmX
i=1Bigi(0)+mK+mX
i=1∥gi(0)∥
λ1: =mmX
i=1(K+∥gi(0)∥)2
λ2: = (2 K+∥F(0)∥)4
λ3: = mX
i=1∥Bi∥K+mX
i=1Bigi(0)!4
λ4: = 
4T2+ 2T2,
where the constant K > 0 denotes a constant that arises from the constants
in Assumption 1, 4 and (21). The first result shows we can dominate the
numerical solution on the set ΩN
n.
Lemma 3. Let Assumption 1 hold with H= 1. Let YN
nbe given by (10)
and let (12) hold. For all n∈NNwe have the pathwise inequality
1ΩNnYN
n≤DN
n.
Proof. On ΩN
n+1by construction ∥∆Wn∥ ≤ 1 for n∈NN−1. Therefore,Φtn+1,tn<∞forn∈NN−1. We prove the Lemma on two subsets of
ΩN
n+1
S(1)
n+1:= ΩN
n+1∩ {ω∈Ω|YN
n(ω)≤1}
S(2)
n+1:= ΩN
n+1∩ {ω∈Ω|1≤YN
n(ω)≤N1/(4r)}.
First, on S(1)
n+1, we have from (10) and the triangle inequality that
YN
n+1≤Φtn+1,tn 
YN
n+ ∆tN(YN
n)+mX
i=1gi(YN
n)∥∆Wn∥!
.
SinceYN
n≤1,∥∆Wn∥ ≤ 1 on S(1)
n+1, and by the taming inequality
α(∆t, y)≤1 from (12), we have that
YN
n+1≤Φtn+1,tn 
1 + ∆ tF(YN
n)+ ∆tmX
i=1Bigi(YN
n)+mX
i=1gi(YN
n)!
.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 15
Adding and subtracting F(0),Pm
i=1Bigi(0), as well as gi(0) for i= 1, . . . , m ,
and then applying the triangle inequality we get
YN
n+1≤Φtn+1,tn
1 + ∆ tF(YN
n)−F(0)+ ∆t∥F(0)∥
+ ∆tmX
i=1Bigi(YN
n)−mX
i=1Bigi(0)+ ∆tmX
i=1Bigi(0)
+mX
i=1 gi(YN
n)−gi(0)+∥gi(0)∥
.
By the polynomial growth condition on DFgiven in Assumption 1, the
global Lipschitz condition on gi(Assumption 4), and using that ∆ t≤T
YN
n+1≤Φtn+1,tn
1 +TK
1 +YN
n2rYN
n+T∥F(0)∥
+TKmX
i=1∥Bi∥YN
n+TmX
i=1Bigi(0)+mKYN
n+mX
i=1∥gi(0)∥
.
OnS(1)
n+1, sinceYN
n≤1 and ∥∆Wn∥ ≤1, we have
(28)YN
n+1≤λ.
To bound S(2)
n+1, we start from (10) by squaring the norm
YN
n+12≤Φtn+1,tn2YN
n+ ∆tN(YN
n) +mX
i=1gi(YN
n)∆Wi
n2
≤Φtn+1,tn2 
YN
n2+ ∆t2N(YN
n)2+mmX
i=1gi(YN
n)2∥∆Wn∥2
+ 2∆t
YN
n,N(YN
n)
+ 2
YN
n,mX
i=1gi(YN
n)∆Wi
n
+2∆t
N(YN
n),mX
i=1gi(YN
n)∆Wi
n!
.
Applying the Cauchy-Schwarz and Arithmetic-Geometric inequalities
YN
n+12≤Φtn+1,tn2 
YN
n2+ 2∆ t2N(YN
n)2+ 2mmX
i=1gi(YN
n)2∥∆Wn∥2
+2∆t
YN
n,N(YN
n)
+ 2
YN
n,mX
i=1gi(YN
n)∆Wi
n!
.(29)
Let us consider N(YN
n) (see (25)). Following the argument in [15, (40) in
Proof of Lemma 3.1] we have
F(YN
n)2≤N√
λYN
n2.
Further, by Assumption 4 , the global Lipschitz property of the function gi
(30)mX
i=1Bigi(YN
n)2
≤ mX
i=1∥Bi∥K+mX
i=1Bigi(0)!2YN
n2
≤√
λYN
n216 UTKU ERDO ˘GAN AND GABRIEL J. LORD
andgi(YN
n)2≤(K+∥gi(0)∥)2YN
n2.
By definition of λ, we have
mmX
i=1gi(YN
n)2≤λYN
n2.
Therefore the linear growth of the second term on the RHS of (29)
N(YN
n)2≤4N√
λYN
n2
onS(2)
n+1is obtained. The one-sided Lipschitz condition on F(21) and the
Cauchy–Schwarz inequality give that

YN
n, F(YN
n)
≤
YN
n, F(YN
n)−F(0)
+
YN
n, F(0)
≤(K+∥F(0)∥)YN
n2
≤√
λYN
n2(31)
where we have used that 1 ≤ ∥YN
n∥. Therefore by the inequalities (30), (31),
Cauchy-Schwarz inequality for the term
YN
n,Pm
i=1Bigi(YN
n)
andλ >1

YN
n,N(YN
n)
=α(∆t, YN
n)
YN
n, F(YN
n)
−
YN
n,mX
i=1Bigi(YN
n)
≤ 
α(∆t, YN
n) + 1√
λYN
n2.
As a result, since ∆ t=T/N,α(∆t, YN
n)<1, by (12), and (4 T2+2T)≤√
λ,
we see that on S(2)
n+1(29) becomes
YN
n+12≤Φtn+1,tn2YN
n2
1 +8T2
N√
λ+ 2λ∥∆Wn∥2+4T
N√
λ+ 2βN
n
≤Φtn+1,tn2YN
n2
1 +2λ
N+ 2λ∥∆Wn∥2+ 2βN
n
≤Φtn+1,tn2YN
n2exp2λ
N+ 2λ∥∆Wn∥2+ 2βN
n
. (32)
Now we carry out an induction argument on n. The case for n= 0 is obvious
by initial condition on ΩN
0= Ω. Let l∈NN−1and assumeYN
n(ω)≤
DN
n(ω) holds for all n∈Nlwhere ω∈ΩN
n. We now prove that
YN
l+1(ω)≤DN
l+1(ω) for all ω∈ΩN
l+1.
For all ω∈ΩN
l+1, we have by the induction hypothesisYN
n(ω)≤DN
n(ω)≤
N1/(4r),n∈Nland ΩN
l+1⊆ΩN
n+1. For any ω∈ΩN
l+1,ωbelongs to S(1)
l+1or
S(2)
l+1. For the inductive argument we define a random variable
τN
l(ω) := max
{−1} ∪ {n∈Nl−1}YN
n(ω)≤1}WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 17
as in [15]. This definition implies that 1 ≤YN
n(ω)≤N1/(4r)for all
n∈ {τN
l+1(ω) + 1, τN
l+2(ω), . . . , l}. By the bound in (32)
YN
l+1(ω)≤Φtl+1,tl(ω)YN
l(ω)expλ
N+λ∥∆Wl(ω)∥2+βN
l(ω)
≤YN
τN
l+1(ω)+1(ω)
×lY
n=τN
l+1(ω)+1 Φtn+1,tn(ω)
exp
lX
n=τl+1+1λ
N+λ∥∆Wn(ω)∥2+βN
n(ω)

≤YN
τN
l+1(ω)+1(ω)
×sup
u∈Nl+1lY
n=uΦtn+1,tn(ω)exp 
λ+ sup
u∈Nl+1lX
n=u
λ∥∆Wn(ω)∥2+βN
n(ω)!
.
By considering (28), the following completes the induction step and proof
YN
l+1(ω)≤(λ+∥x∥)
×sup
u∈Nl+1lY
n=uΦtn+1,tn(ω)exp 
λ+ sup
u∈Nl+1lX
n=u
λ∥∆Wn(ω)∥2+βN
n(ω)!
=DN
l+1(ω).
□
Lemma 4. For all p≥1,supN∈NE
supn∈NN|DN
n|p
<∞.
Proof. By two applications of H¨ older’s inequalities, we have
sup
N∈N
N≥8λpTsup
n∈NNDN
n
Lp(Ω,R)
≤eλ
sup
N∈N
N≥8λpTexpN−1X
k=0
λ∥∆Wk∥2
L2p(Ω,R)

×sup
N∈N(λ+∥x∥) sup
n∈NNsup
u∈Nnn−1Y
k=uΦtk+1, tksup
n∈NNexp 
sup
u∈Nnn−1X
k=uβN
k!
L2p(Ω,R)
≤eλ
sup
N∈N
N≥8λpTexpN−1X
k=0
λ∥∆Wk∥2
L2p(Ω,R)

×
sup
N∈Nsup
n∈NNexp 
sup
u∈Nnn−1X
k=uβN
k!
L4p(Ω,R)

×
sup
N∈N(λ+∥x∥) sup
n∈NNsup
u∈Nnn−1Y
k=uΦtk+1, tk
L4p(Ω,R)
.18 UTKU ERDO ˘GAN AND GABRIEL J. LORD
Then by (27) and since λandxare deterministic we get
sup
N∈N
N≥8λpTsup
n∈NNDN
n
Lp(Ω,R)
≤eλ(λ+∥x∥)
sup
N∈N
N≥8λpTexpN−1X
k=0
λ∥∆Wk∥2
L2p(Ω,R)

×
sup
N∈Nsup
n∈NNexp 
sup
u∈Nnn−1X
k=uβN
k!
L4p(Ω,R)

×
sup
N∈NN−1Y
k=0exp (A−1
2mX
i=1B2
i)∆t!mY
i=1exp 
∥Bi∥|∆Wi
k|
L4p(Ω,R)
.
The second and third terms are shown to be bounded in [15, Lemma 3.5].
On the other hand, the boundedness of the last term on the RHS is due to
the ∆ tdependence of the upper bound of E
exp(∥Bi∥|∆Wi
k|)
as shown in
the proof of Lemma 2 (ii). □
Lemma 5. Let¯Ytbe given by (14). For all p≥2andt∈(tn, tn+1], there
exists K=K(p, T)>0such that
(33)¯Yt2
Lp(Ω,Rd)≤K
1 +¯Ytn2
Lp(Ω,Rd)
.
Proof. Note that ¯Ytis the solution to a linear Itˆ o SDE
¯Yt=¯Ytn+Zt
tn 
A¯Ys+Φs,tnFtm
∆t(¯Ytn)
ds+mX
i=1Zt
tn 
Bi¯Yt+Φt,tngi(¯Ytn)
dWi
t
with initial condition ¯Ytnon the interval [ tn, t] by Lemma 1. After adding and
subtracting the termsPm
i=1Rt
tnΦs,tngi(0)dWi
s, we have by Jensen inequality
for sums and integrals as well as the Burkholder-Davis-Gundy inequality (see
[24])
E¯Ytp≤6p−1
E¯Ytnp
+∥A∥p(t−tn)p−1Zt
tnE¯Yspds
+(t−tn)p−1Zt
tnEΦs,tnα(∆t,¯Ytn)F(¯Ytn)p
ds
+(t−tn)p/2−1mX
i=1∥Bi∥pZt
tnE¯Ysp
ds
+(t−tn)p/2−1mX
i=1Zt
tnEΦs,tn 
gi(¯Ytn)−gi(0)p
ds!
.
Using Lemma 2, thatα(∆t,¯Ytk)F(¯Ytk)∆t≤1 and the global Lipschitz
property of gi, the desired inequality is achieved from an application of the
continuous Gronwall Lemma. □
We now use Lemmas 2–5 to prove the scheme has bounded moments.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 19
Proof of Theorem 4 : Bounded moments.
Proof. Consider the Itˆ o equation for the continuous extension of numerical
solution given in Lemma 1 on [0 , t]
¯Ytn=x+n−1X
k=0Ztk+1
tk 
A¯Ys+Φs,tkα(∆t,¯Ytk)F(¯Ytk)
ds
+n−1X
k=0mX
i=1Ztk+1
tk 
Bi¯Ys+Φs,tkgi(¯Ytk)
dWi
s.
By adding and subtracting the termsPm
i=1Pn−1
k=0Rtk+1
tkΦs,tkgi(0)dWi
sand
using the triangle inequality, we have
¯Ytn
Lp(Ω,Rd)≤∥x∥+∥A∥n−1X
k=0Ztk+1
tk¯Ys
Lp(Ω,Rd)ds
+n−1X
k=0Ztk+1
tkΦs,tkα(∆t,¯Ytk)F(¯Ytk)
Lp(Ω,Rd)ds
+n−1X
k=0Ztk+1
tkmX
i=1Bi¯YsdWi
s
Lp(Ω,Rd)
+n−1X
k=0Ztk+1
tkΦs,tkmX
i=1gi(0)dWi
s
Lp(Ω,Rd)
+n−1X
k=0Ztk+1
tkΦs,tkmX
i=1 
gi(¯Ytk)−gi(0)
dWi
s
Lp(Ω,Rd).
By Lemma 2, thatα(∆t,¯Ytk)F(¯Ytk)∆t≤1 in (12), along with the Burkholder-
Davis-Gundy inequality we have
¯Ytn
Lp(Ω,Rd)≤ ∥x∥+∥A∥n−1X
k=0Ztk+1
tk¯Ys
Lp(Ω,Rd)ds+KN
+p n−1X
k=0Ztk+1
tkmX
i=1Bi¯Ys2
Lp(Ω,Rd)ds!1/2
+pK mX
i=1∥gi(0)∥2T!1/2
+K2√mp n−1X
k=0Ztk+1
tk¯Ytk2
Lp(Ω,Rd)ds!1/2
.20 UTKU ERDO ˘GAN AND GABRIEL J. LORD
By taking the square of both sides and applying the Jensen inequalities for
sums and integrals
(34)¯Ytn2
Lp(Ω,Rd)≤4
∥x∥+pK mX
i=1∥gi(0)∥2T!1/2
+KN
2
+ 4∥A∥2Tn−1X
k=0Ztk+1
tk¯Ys2
Lp(Ω,Rd)ds
+ 4p2n−1X
k=0Ztk+1
tkmX
i=1Bi¯Ys2
Lp(Ω,Rd)ds
+ 4K4mp2n−1X
k=0Ztk+1
tk¯Ytk2
Lp(Ω,Rd)ds.
Substituting (33) into (34) and rewriting the resulting integral inequality in
discrete form, we have
YN
n2
Lp(Ω,Rd)≤4
∥x∥+pK mX
i=1∥gi(0)∥2T!1/2
+KN
2
+ 4∥A∥2Tn−1X
k=0K(1 +YN
k2
Lp(Ω,Rd))T
N
+ 4p2n−1X
k=0mX
i=1∥Bi∥2K(1 +YN
k2
Lp(Ω,Rd))T
N+ 4K4mp2n−1X
k=0YN
k2
Lp(Ω,Rd)T
N.
By the discrete Gronwall inequality
sup
n∈NNYN
n
Lp(Ω,Rd)≤C∥A∥,∥Bi∥,T,p,K
∥x∥+pK mX
i=1∥gi(0)∥2T!1/2
+KN+∥A∥T√
K+pmX
i=1∥Bi∥√
KT!
.
Following the bootstrap argument presented in [15, Lemma 3.9] to deal with
the term KN on the RHS, we get
(35) sup
N∈Nsup
n∈NN1(ΩNn)cYN
n
Lp(Ω,Rd)<∞
and
(36) sup
N∈N
N≥8λpTsup
n∈NN1ΩNnYN
n
Lp(Ω,Rd)≤sup
N∈N
N≥8λpTsup
n∈NNDN
n
Lp(Ω,Rd).
The boundedness of the term in right hand side of (36) is proved in Lemma
4. Hence the proof is complete. □WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 21
5.Proof of Weak Convergence
We now take Cas a generic constant that is independent of the time step
size ∆ t.
Lemma 6. Let the Assumptions of Theorem 3 hold. For each T >0, there
exists C >0such that for 0≤t≤T
(37) |E[DΨ(t, x)ξ]| ≤C∥E[ξ]∥, for all ξ∈Lp(Ω,Rd), p≥1.
Proof. By interchanging the derivative and expectation (see discussion in [4,
sections 5.1 and 5.2]), the chain rule and the definition of Ψ in (6)
|E[DΨ(t, x)ξ]|=|DΨ(t, x)E[ξ]|
=|E[Dϕ(Xx
t)DxXx
t]E[ξ]|.
Then by the deterministic Cauchy-Schwarz and triangle inequality
|E[DΨ(t, x)ξ]| ≤ ∥E[Dϕ(Xx
t)DxXx
t]∥∥E[ξ]∥
≤E[∥Dϕ(Xx
t)DxXx
t∥]∥E[ξ]∥
≤Eh
∥Dϕ(Xx
t)∥2i1/2
Eh
∥DxXx
t∥2i1/2
∥E[ξ]∥
where on the last step we used the stochastic Cauchy-Schwarz inequality.
The fact that ϕ∈C2
b(Rd) and Theorem 2 complete the proof. □
Considering the definition of the function Ψ in (6), we define
(38) u(t,¯Yt) := Ψ( T−t,¯Yt).
We point out the inequality (37) implies, for udefined in (38), that
(39) |E
Du(s,¯Ys)ξ
| ≤C∥E[ξ]∥
where ξis aRd-valued random variable. We are now in a position to prove
weak convergence.
Proof of Theorem 5: weak convergence.
Proof. Recall the definition of Ψ( t, x) from (6). Applying the Itˆ o formula
on [tn, tn+1) for Ψ( t,¯Yt) with ¯Ytgiven by (15) gives
(40) dΨ( t,¯Yt) =∂
∂t+ˆLn(t)
Ψ(t,¯Yt)dt+mX
i=1ˆLi
n(t)Ψ(t,¯Yt)dWi
t
where
ˆLn(t)Ψ(t,¯Yt) :=DΨ(t,¯Yt)µtm(t, tn) +1
2mX
i=1σtm
i(t, tn)⊺D2Ψ(t,¯Yt)σtm
i(t, tn)
ˆLi
n(t)Ψ(t,¯Yt) :=DΨ(t,¯Yt)σtm
i(t, tn)
andµtmandσtm
iare defined in (16). Now we define the error function eby
e:=|Ψ(0,¯YT)−Ψ(T,¯Y0)|=E
ϕ(¯YT)−ϕ(Xx
T)|X0=x.22 UTKU ERDO ˘GAN AND GABRIEL J. LORD
By definition of uin (38) and by a telescopic sum, we have
e=|E
u(T,¯YT)
−u(0,¯Y0)|=N−1X
k=0E
u(tk+1,¯Ytk+1)−u(tk,¯Ytk).
An application of Itˆ o’s formula for u(s,¯Ys), using (40) on each of the subin-
tervals, and the zero expectation of Itˆ o integrals gives
e=N−1X
k=0EZs=tk+1
s=tk∂
∂su(s,¯Ys) +ˆLk(s)u(s,¯Ys)
ds.
On the other hand, u(s,¯Ys) = Ψ( T−s,¯Ys) satisfies the Kolmogorov PDE
(7)
∂
∂su(s,¯Ys) =−Lu(s,¯Ys).
So we have
(41) e=N−1X
k=0EZtk+1
tk
ˆLk(s)u(s,¯Ys)− Lu(s,¯Ys)
ds.
Consider the integrand
ˆLk(s)u(s,¯Ys)− Lu(s,¯Ys) =Du(s,¯Ys) 
µtm(s, tk)−µ(¯Ys)
+1
2mX
i=1σtm
i(s, tk)⊺D2u(s,¯Ys)σtm
i(s, tk)−1
2mX
i=1σi(¯Ys)⊺D2u(s,¯Ys)σi(¯Ys)
=Du(s,¯Ys) 
Φs,tkFtm
∆t(¯Ytk)−F(¯Ys)
+mX
i=1(Bi¯Ys)⊺D2u(s,¯Ys) 
Φs,tkgi(¯Ytk)−gi(¯Ys)
+1
2mX
i=1 
Φs,tkgi(¯Ytk)⊺D2u(s,¯Ys) 
Φs,tkgi(¯Ytk)
−1
2mX
i=1gi(¯Ys)⊺D2u(s,¯Ys)gi(¯Ys).
Adding and subtracting the terms Du(s,¯Ys)Ftm
∆t(¯Ytk),Du(s,¯Ys)F(¯Ytk) and
defining
Θk
1(s,x) :=mX
i=1 
Bi¯Ys⊺D2u(s,x) 
Φs,tkgi(¯Ytk)
Θk
2(s,x) :=mX
i=1 
Bi¯Ys⊺D2u(s,x)gi(x)
Θk
3(s,x) :=1
2mX
i=1 
Φs,tkgi(¯Ytk)⊺D2u(s,x) 
Φs,tkgi(¯Ytk)
Θk
4(s,x) :=1
2mX
i=1gi(x)⊺D2u(s,x)gi(x)WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 23
such that Θk
1(tk,¯Ytk) = Θk
2(tk,¯Ytk), Θk
3(tk,¯Ytk) = Θk
4(tk,¯Ytk), we have
ˆLk(s)u(s,¯Ys)−Lu(s,¯Ys) :=Tk
1(s)+Tk
2(s)+Tk
3(s)+Tk
4(s)+Tk
5(s)+Tk
6(s)+Tk
7(s)
where
Tk
1(s) :=Du(s,¯Ys) 
Φs,tkFtm
∆t(¯Ytk)−Ftm
∆t(¯Ytk)
Tk
4(s) := Θk
1(s,¯Ys)−Θk
1(tk,¯Ytk)
Tk
2(s) :=Du(s,¯Ys) 
Ftm
∆t(¯Ytk)−F(¯Ytk)
Tk
5(s) := Θk
2(tk,¯Ytk)−Θk
2(s,¯Ys)
Tk
3(s) :=Du(s,¯Ys) 
F(¯Ytk)−F(¯Ys)
Tk
6(s) := Θk
3(s,¯Ys)−Θk
3(tk,¯Ytk)
Tk
7(s) := Θk
4(tk,¯Ytk)−Θk
4(s,¯Ys).
In terms of these functions, the error (41) is given by
e=N−1X
k=0EZtk+1
tk
Tk
1(s) +Tk
2(s) +Tk
3(s) +Tk
4(s) +Tk
5(s) +Tk
6(s) +Tk
7(s)
ds.
We now seek to bound eachE
Tk
iby a term of order ( s−tk) or ∆ ton
the subinterval [ tk, tk+1], for i= 1, . . . , 7.
Starting with Tk
1, the Itˆ o equation for Φin (9) for Ftkmeasurable, Rd-
valued random variables v∈L2(Ω,Rd) gives
Φs,tkv=v+Zs
tkAΦr,tkvdr+Zs
tkmX
i=1BiΦr,tkvdWi
r.
By the zero expectation of Itˆ o integrals and Fubini’s Theorem,
E[Φs,tkv−v] =Zs
tkE[Φr,tkv]dr.
Taking v=Ftm
∆t(¯Ytk), boundedness of the operator Φfrom Lemma 2 and
bounded moments of numerical solution in Theorem 4 and the inequality
(39), we have
Eh
Tk
1(s)i≤CZs
tkE
Φr,tkFtm
∆t(¯Ytk)
dr≤C(s−tk).
ForTk
2, by the definition of Ftm
∆tin (12) we have
Eh
Tk
2(s)i=E
Du(s,¯Ys) 
−∆tα(∆t,¯Ytk)F(¯Ytk)F(¯Ytk)≤C∆t,
where the inequality α(∆t,¯Ytk)<1 from (12), bounded moments of numer-
ical solution from Theorem 4 and the inequality (39) are used.
We now consider Tk
3. Itˆ o’s formula for Fj(¯Ys) around ¯Ytkwhere Fj:
Rd→Rrefers to the jth component of the vector valued function Ffor
j= 1, . . . , d gives
Fj(¯Ys) =Fj(¯Ytk) +Zs
tkˆLkFj(¯Yr)dr+mX
i=1Zs
tkˆLi
kFj(¯Yr)dWi
r
where
ˆLkFj(¯Yr) :=DFj(¯Yr)µtm(r, tk) +1
2mX
i=1σtm
i(r, tk)⊺D2Fj(¯Yr)σtm
i(r, tk)
ˆLi
kFj(¯Yr) :=DFj(¯Yr)σtm
i(r, tk).24 UTKU ERDO ˘GAN AND GABRIEL J. LORD
By zero expectation of the Itˆ o integral and Jensen’s inequality for the inte-
gral and expectation, we have
E
Fj(¯Ys)−Fj(¯Ytk)2= (s−tk)Zs
tkEh
|ˆLkFj(¯Yr)|2i
dr.
By polynomial growth assumption on the derivatives of Fand bounded
numerical moments, we conclude thatEh
Tk
3(s)i=CE
F(¯Ys)−F(¯Ytk)≤C(s−tk).
Now consider the term Tk
4. By applying the Itˆ o formula to the function
Θk
1(t,¯Yt) over the interval [ tk, s] and taking expectation, we have
Tk
4=Eh
Θk
1(s,¯Ys)−Θk
1(tk,¯Ytk)i
=EZs
tk
(∂
∂r+ˆLk)Θk
1(r,¯Yr)
dr
.
The integrand is given by
∂
∂r+ˆLk
Θk
1(r,¯Yr) =mX
i=1 
Bi¯Yr⊺∂
∂r 
D2u(r,¯Yr) 
Φr,tkgi(¯Ytk)
+mX
i=1 
Bi¯Yr⊺D2u(r,¯Yr)(A−1
2mX
k=1B2
k)Φr,tkgi(¯Ytk)
+mX
i=1Dh 
Bi¯Yr⊺D2u(r,¯Yr) 
Φr,tkgi(¯Ytk)i
µtm(r, tk)
+1
2mX
i=1σtm
i(r)⊺D2h 
Bi¯Yr⊺D2u(r,¯Yr) 
Φr,tkgi(¯Ytk)i
σtm
i(r, tk). (42)
By the continuity of all the derivatives of u, the condition that ϕ∈C4
b(Rd)
and bounded moments of the numerical method in Theorem 4 we have,
similar to the arguments in [32, Appendix B], that Eh
(∂
∂r+ˆLk)Θk
1(r,¯Yr)i
is uniformly bounded on [ tk, s]. Therefore we conclude
Eh
Tk
4(s)i≤Zs
tk|E
(∂
∂r+ˆLk)Θk
1(r,¯Yr)
|dr≤C(s−tk).
Similar arguments can be applied to Tk
5, Tk
6, Tk
7as well. Finally, by Fu-
bini’s theorem for integrals
e=N−1X
k=0EZtk+1
tk(Tk
1(s) +Tk
2(s) +Tk
3(s) +Tk
4(s) +Tk
5(s) +Tk
6(s) +Tk
7(s))ds
≤C 
∆t+N−1X
k=0Ztk+1
tk(s−tk)ds!
=C(T)∆t.
we obtain the desired order for the weak error of the scheme. □
Acknowledgements 1. The first author is supported by The Scientific and
Technological Research Council of Turkey (TUBITAK) 2219-International
Postdoctoral Research Fellowship Program, grant number 1059B192202051.WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 25
We are grateful to two anonymous reviewers for their comments and sug-
gestions.
Conflict of interests:
Not Applicable.
References
[1] Ableidinger, M., Buckwar, E., Thalhammer, A.: An importance sampling technique
in Monte Carlo methods for SDEs with a.s. stable and mean-square unstable equilib-
rium. Journal of Computational and Applied Mathematics 316, 3–14 (2017). DOI
https://doi.org/10.1016/j.cam.2016.08.043. URL https://www.sciencedirect.com/
science/article/pii/S0377042716304125 . Selected Papers from NUMDIFF-14 7,
10
[2] Beyn, W.J., Isaak, E., Kruse, R.: Stochastic C-Stability and B-Consistency of explicit
and implicit Euler-type schemes. Journal of Scientific Computing 67(3), 955–987
(2016). DOI 10.1007/s10915-015-0114-4 2
[3] Biscay, R., Jimenez, J., Riera, J., Valdes, P.: Local linearization method for the
numerical solution of stochastic differential equations. Annals of the Institute of Sta-
tistical Mathematics 48(4), 631–644 (1996) 1
[4] Bossy, M., Jabir, J.F., Martinez, K.: On the weak convergence rate of an exponential
Euler scheme for SDEs governed by coefficients with superlinear growth. Bernoulli
27(1), 312–347 (2021) 2, 21
[5] Br´ ehier, C.E.: Approximation of the invariant distribution for a class of ergodic
sdes with one-sided lipschitz continuous drift coefficient using an explicit tamed euler
scheme. ESAIM: PS 27, 841–866 (2023). DOI 10.1051/ps/2023017. URL https://
doi.org/10.1051/ps/2023017 2
[6] Br´ ehier, C.E., Gouden` ege, L.: Weak convergence rates of splitting schemes for the
stochastic Allen–Cahn equation. BIT Numerical Mathematics 60(3), 543–582 (2020)
9
[7] Cai, M., Gan, S., Wang, X.: Weak convergence rates for an explicit full-discretization
of stochastic Allen–Cahn equation with additive noise. Journal of Scientific Comput-
ing86(3), 1–30 (2021) 2, 9
[8] Cerrai, S.: Second order PDE’s in finite and infinite dimension: a probabilistic
approach, 1 edn. Springer, Berlin Heidelberg (2001). DOI https://doi.org/10.1007/
b80743 3, 4
[9] Chen, Z., Gan, S., Wang, X.: A full-discrete exponential Euler approximation of
the invariant measure for parabolic stochastic partial differential equations. Ap-
plied Numerical Mathematics 157, 135–158 (2020). DOI https://doi.org/10.1016/j.
apnum.2020.05.008. URL https://www.sciencedirect.com/science/article/pii/
S0168927420301525 2
[10] Debrabant, K., Kværnø, A., Mattsson, N.C.: Runge–Kutta Lawson schemes for sto-
chastic differential equations. BIT Numerical Mathematics 61(2), 381–409 (2021) 1
[11] Erdogan, U., Lord, G.J.: A new class of exponential integrators for SDEs with mul-
tiplicative noise. IMA Journal of Numerical Analysis 39(2), 820–846 (2018). DOI
10.1093/imanum/dry008 1, 2, 5, 9
[12] Erdogan, U., Lord, G.J.: Strong convergence of a GBM based tamed integrator for
SDEs and an adaptive implementation. Journal of Computational and Applied Math-
ematics 399, 113,704 (2022). DOI https://doi.org/10.1016/j.cam.2021.113704. URL
https://www.sciencedirect.com/science/article/pii/S0377042721003265 2, 5,
7, 13
[13] Giles, M.B.: Multilevel Monte Carlo methods. Acta Numerica 24, 259–328 (2015).
DOI 10.1017/S096249291500001X 2, 7
[14] Hutzenthaler, M., Jentzen, A., Kloeden, P.E.: Strong and weak divergence in finite
time of Euler’s method for stochastic differential equations with non-globally Lipschitz
continuous coefficients. Proceedings of the Royal Society A 467(2130), 1563–1576
(2011). DOI 10.1098/rspa.2010.0348 1, 2, 926 UTKU ERDO ˘GAN AND GABRIEL J. LORD
[15] Hutzenthaler, M., Jentzen, A., Kloeden, P.E.: Strong convergence of an explicit
numerical method for SDEs with nonglobally Lipschitz continuous coefficients. Ann.
Appl. Probab. 22(4), 1611–1641 (2012). DOI 10.1214/11-AAP803 2, 5, 7, 13, 15, 17,
18, 20
[16] Jentzen, A., R¨ ockner, M.: A Milstein scheme for SPDEs. Foundations of Computa-
tional Mathematics 15(2), 313–362 (2015) 1
[17] Jimenez, J., Shoji, I., Ozaki, T.: Simulation of stochastic differential equations
through the local linearization method. a comparative study. Journal of Statistical
Physics 94(3-4), 587–602 (1999) 1
[18] Jimenez, J.C., Carbonell, F.: Convergence rate of weak local linearization schemes
for stochastic differential equations with additive noise. J. Comput. Appl. Math. 279,
106–122 (2015). DOI 10.1016/j.cam.2014.10.021. URL http://dx.doi.org/10.1016/
j.cam.2014.10.021 1
[19] Kloeden, P., Platen, E.: Numerical Solution of Stochastic Differential Equations.
Stochastic Modelling and Applied Probability. Springer, Berlin Heidelberg (2011) 6,
9
[20] Lang, A., Petersson, A.: Monte Carlo versus multilevel Monte Carlo in weak er-
ror simulations of SPDE approximations. Mathematics and Computers in Simula-
tion143, 99–113 (2018). DOI https://doi.org/10.1016/j.matcom.2017.05.002. URL
https://www.sciencedirect.com/science/article/pii/S037847541730188X . 10th
IMACS Seminar on Monte Carlo Methods 7
[21] Li, X., Mao, X., Yin, G.: Explicit numerical approximations for stochastic differential
equations in finite and infinite horizons: truncation methods, convergence in pth
moment and stability. IMA Journal of Numerical Analysis 39(2), 847–892 (2018).
DOI 10.1093/imanum/dry015 2
[22] Lord, G.J., Powell, C.E., Shardlow, T.: An introduction to computational stochastic
PDEs (2014). DOI 10.1017/CBO9781139017329 7
[23] Lord, G.J., Rougemont, J.: A numerical scheme for stochastic PDEs with Gevrey
regularity. IMA J. of Numerical Analysis 24(4), 587–604 (2004) 1, 9
[24] Mao, X.: Stochastic differential equations and applications. Elsevier, Amsterdam
(2007) 18
[25] Mao, X.: The truncated Euler–Maruyama method for stochastic differential equa-
tions. Journal of Computational and Applied Mathematics 290, 370 – 384 (2015).
DOI https://doi.org/10.1016/j.cam.2015.06.002 2
[26] Mora, C.M.: Weak exponential schemes for stochastic differential equations with
additive noise. IMA J. Numer. Anal. 25(3), 486–506 (2005). DOI 10.1093/imanum/
dri001. URL http://dx.doi.org/10.1093/imanum/dri001 1
[27] Sabanis, S.: A note on tamed Euler approximations. Electronic Communications in
Probability 18, 1–10 (2013) 2, 5
[28] Sabanis, S.: Euler approximations with varying coefficients: The case of superlinearly
growing diffusion coefficients. Ann. Appl. Probab. 26(4), 2083–2105 (2016). DOI
10.1214/15-AAP1140 2
[29] Tretyakov, M.V., Zhang, Z.: A fundamental mean-square convergence theorem for
SDEs with locally Lipschitz coefficients and its applications. SIAM J. Numer. Anal.
51(6), 3135–3162 (2013). DOI 10.1137/120902318 2
[30] Wang, X., Zhao, Y., Zhang, Z.: Weak error analysis for strong approximation
schemes of SDEs with super-linear coefficients. IMA Journal of Numerical Analy-
sis p. drad083 (2023). DOI 10.1093/imanum/drad083. URL https://doi.org/10.
1093/imanum/drad083 2, 4
[31] Yang, G., Burrage, K., Komori, Y., Burrage, P., Ding, X.: A class of new Magnus-
type methods for semi-linear non-commutative Ito stochastic differential equations.
Numerical Algorithms pp. 1–25 (2021) 1
[32] Zhao, Y., Wang, X.: Weak approximation schemes for SDEs with super-linearly
growing coefficients. Applied Numerical Mathematics 198 (2024). DOI 10.1016/j.
apnum.2024.01.003 2, 4, 24WEAK CONVERGENCE OF TAMED EXPONENTIAL INTEGRATORS 27
[33] ˙Izgi, B., C ¸etin, C.: Semi-implicit split-step numerical methods for a class of nonlinear
stochastic differential equations with non-Lipschitz drift terms. Journal of Computa-
tional and Applied Mathematics 343, 62 – 79 (2018). DOI https://doi.org/10.1016/
j.cam.2018.03.027 2
Department of Mathematics, Eskis ¸ehir Technical University, YunusEmre
Kamp ¨us¨u, Eskis ¸ehir, 26470, T ¨urkiye
Email address :utkuerdogan@eskisehir.edu.tr
Department of Mathematics, IMAPP, Radboud University, Nijmegen, 6500
GL, Netherlands
Email address :gabriel.lord@ru.nl