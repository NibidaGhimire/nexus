Inverse Design of All-dielectric Metasurfaces with Bound States
in the Continuum
Sergei Gladyshev1;;y, Theodosios D. Karamanos2;;y, Lina Kuhn3;4,
Dominik Beutel3, Thomas Weiss1, Carsten Rockstuhl3;5, Andrey Bogdanov6
1Institute of Physics, University of Graz, Universit ¬®atsplatz 5, 8010 Graz, Austria,
2Institut Langevin, ESPCI Paris, Universit ¬¥e PSL, CNRS, 75005 Paris, France,
3Institute of Theoretical Solid State Physics, Karlsruhe Institute of Technology, 76131 Karlsruhe, Germany,
4Steinbuch Centre for Computing - ScientiÔ¨Åc Computing & Mathematics, Karlsruhe Institute of Technology, Germany
5Institute of Nanotechnology, Karlsruhe Institute of Technology, 76344 Eggenstein-Leopoldshafen, Germany
6Qingdao Innovation and Development Base of Harbin Engineering University, Qingdao 266000, Shandong, China
e-mail: sergei.gladyshev@uni-graz.at, theodosios.karamanos@espci.fr.
yThese authors have contributed equally.
Metasurfaces with bound states in the continuum (BICs) have proven to be a power-
ful platform for drastically enhancing light-matter interactions, improving biosensing,
and precisely manipulating near- and far-Ô¨Åelds. However, engineering metasurfaces to
provide an on-demand spectral and angular position for a BIC remains a prime chal-
lenge. A conventional solution involves a Ô¨Åne adjustment of geometrical parameters,
requiring multiple time-consuming calculations. In this work, to circumvent such te-
dious processes, we develop a physics-inspired, inverse design method on all-dielectric
metasurfaces for an on-demand spectral and angular position of a BIC. Our suggested
method predicts the core-shell particles that constitute the unit cell of the metasur-
face, while considering practical limitations on geometry and available materials. Our
method is based on a smart combination of a semi-analytical solution, for predicting
the required dipolar Mie coefÔ¨Åcients of the meta-atom, and a machine learning algo-
rithm, for Ô¨Ånding a practical design of the meta-atom that provides these Mie coefÔ¨Å-
cients. Although our approach is exempliÔ¨Åed in designing a metasurface sustaining a
BIC, it can, also, be applied to many more objective functions. With that, we pave the
way toward a general framework for the inverse design of metasurfaces in speciÔ¨Åc and
nanophotonic structures in general.
INTRODUCTION
Bound states in the continuum (BICs) are non-radiating solutions to the wave equation with a spectrum
embedded in the continuum of the propagating modes in the surrounding space. BICs are a general
1arXiv:2305.10020v2  [physics.optics]  18 May 2023wave phenomenon that can exist in a variety of acoustic, hydrodynamic, quantum mechanical, and elec-
tromagnetic systems ( 1‚Äì3). Because of their inÔ¨Ånite radiative lifetimes, BICs are actively studied in
optics and photonics, opening up enormous opportunities to realize compact planar high-Q metastruc-
tures necessary for biosensing, integrated nonlinear nanophotonics, and an enhancement of light-matter
interactions ( 4). In photonics, the most promising platform supporting BICs are metasurfaces (5). Meta-
surfaces offer a vast number of designs with materials compatible to BIC. In particular, metasurfaces
with BICs demonstrated their efÔ¨Åciency for lasing ( 6‚Äì10 ), biosensing ( 11‚Äì14 ), polaritons ( 15‚Äì18 ), and
enhancing nonlinear optical effects ( 19‚Äì22 ).
Optical resonances in periodic metasurfaces radiate only into the open diffraction channels, while
BICs remain non-radiating due to the vanishing coupling to all open diffraction channels. For subwave-
length metasurfaces, there is only one open diffraction channel and, thus, one coupling coefÔ¨Åcient. It can
vanish due to symmetry reasons or due to a Ô¨Åne-tuning of the system‚Äôs geometrical or material param-
eters ( 23). In the Ô¨Årst case, the BICs are called symmetry-protected and usually exist in high symmetry
points of the k-space. In the second case, BICs are called accidental orparametric , and they can exist
at an arbitrary point in the k-space along the high-symmetry directions ( 24). This explains the term
‚Äúaccidental‚Äù. The accidental BICs are extremely sensitive to changes in the geometry of the unit cell
or the material parameters. Such a high sensitivity makes it challenging and time-consuming to design
metasurfaces with a pre-required or Ô¨Åxed spectral and angular position of BIC.
As an alternative to the time-consuming and brute-force optimization ( 25, 26 ), an inverse design ap-
proach can be used ( 27‚Äì30 ). The term ‚Äúinverse design‚Äù, herein, refers to the process of designing a
metasurface with optical properties by initially specifying the desired response rather than the structure
of the metasurface itself. Such an inverse design involves dedicated algorithms, e.g., from Bayesian in-
ference, topology optimization, or artiÔ¨Åcial neural networks. The purpose is always to Ô¨Ånd the optimal
metasurface that provides a predeÔ¨Åned optical response ( 31‚Äì34 ). Inverse design can offer metasurfaces
with a wide range of optical properties, including phase shifts, polarization conversions, and beam steer-
ing. It is a powerful tool for designing advanced optical devices and has applications in Ô¨Åelds such as
imaging, sensing, and telecommunications ( 35‚Äì38 ). Despite the power of inverse design methods based
on artiÔ¨Åcial neural networks, the underlying physics of the found optimum often remains vague.
In this work, we develop a physics-inspired inverse design procedure for all-dielectric metasurfaces
sustaining an accidental BIC at a predeÔ¨Åned frequency and incidence angle. Our framework is based on a
smart combination of a semi-analytical approach and a dedicated machine-learning algorithm. Our pro-
cedure includes three steps schematically shown in Fig. 1. In the Ô¨Årst step, the problem is solved within
a ‚Äútoy‚Äù model. Here, we consider all-dielectric meta-atoms in dipole approximation and capture their
response using a T-matrix. After representing the meta-atoms utilizing the electric/magnetic (dipole)
polarizabilities, or, equivalently, the scattering (dipole) Mie coefÔ¨Åcients, the metasurface model is set up.
The existence condition for an accidental BIC at a predeÔ¨Åned spectral and angular position is derived
analytically as a function of the Mie coefÔ¨Åcients of the constituting particle through the identiÔ¨Åcation
of the system‚Äôs eigenmodes. At the end of that Ô¨Årst step, we know the polarizabilities of the particle
such that the metasurface offers the predeÔ¨Åned BIC. In the second step, using a dedicated artiÔ¨Åcial neural
network, we identify the geometrical and material parameters of a core-shell, spherical particle that of-
fers the desired and previously identiÔ¨Åed polarizabilities so that the metasurface sustains the predeÔ¨Åned
BICs. The neural network accounts for the practical limitations on the sizes of the spherical particle
2shells and refractive indices of the materials. In this way, a physically feasible meta-atom is found that
provides the desired BIC when placed on an inÔ¨Ånite 2D array. In the last step, we numerically verify the
design. We also test the robustness of the designed BIC position in k-space if higher-order multipoles
contribute besides the dipolar one, namely quadrupoles and octupoles. This entire process is described
in the following.
Figure 1: The concept of our proposed framework. Beginning from the top left, an accidental BIC
sustained by a metasurface is desired at a speciÔ¨Åc normalized frequency and incidence angle given by
(~!d;d). Then, the metasurface is analytically modeled via the multipolar expansion up to dipolar order.
The predeÔ¨Åned BIC is supported when the isotropic meta-atom decorating the unit cell of the metasurface
has a speciÔ¨Åc electric and magnetic dipolar polarizability. Following that, a realistic core-shell particle
that provides the desired polarizabilities is designed via a machine-learning algorithm in the second
step. Finally, the proposed, realistic metasurface is numerically validated concerning its performance
and robustness in the third step. By the latest at that stage, a realistic metasurface is described in all its
details.
3RESULTS
Step 1: BIC in dipolar metasurface
Let us consider in our ‚Äùtoy‚Äù model a metasurface consisting of isotropic and non-absorbing particles
described in dipole approximation. The particles are arranged on a square lattice with a subwavelength
period, i.e. for any incidence angle, there is only a zeroth diffraction order. The considered unit cell is
shown in Fig. 2(a). The surrounding medium is a vacuum. The metasurface is illuminated by a time-
harmonic linearly polarized plane wave in either TE (or s) or TM (or p) polarization.
Considering the renormalization of the particle‚Äôs polarizability due to the lattice interaction and im-
posing a condition that expresses the existence of a resonance, i.e., a denominator in the renormalized
polarizability has to be zero, allows for the analytical identiÔ¨Åcation of an equation that must be satisÔ¨Åed
for the existence of a BIC. For a given lattice, frequency, polarization, and incidence angle, this equa-
tion expresses the necessary relation between the dipolar magnetic b1and electric a1Mie coefÔ¨Åcients to
encounter a BIC. A derivation is given in the METHODS section, but the Ô¨Ånal expressions read
b1= 1 +a1(C1+C3)
C2+a1 
C1C2+C2C3 2C2
5=F(a1); (TE / s-polarized incidence) (1a)
a1= 1 +b1(C1+C3)
C2+b1 
C1C2+C2C3 2C2
5; (TM / p-polarized incidence) (1b)
whereCi(i= 1;:::;5) are the elements of the lattice interaction coefÔ¨Åcients matrixCs(see Supple-
mentary Material, Sec. S5). These interaction coefÔ¨Åcients are calculated via an Ewald summation meth-
ods ( 39‚Äì41 ).
The elements ofCsdepend on the lattice constant d, frequency!, and Bloch wavevector. Therefore,
they carry the information about the desired point of operation. Once they are Ô¨Åxed, the Mie coefÔ¨Åcients
can be identiÔ¨Åed such that a BIC is supported. Note that the equations for s- and p-polarization are
similar. Only the coefÔ¨Åcients a1andb1are swapped, as anticipated, due to symmetry. One should
notice from (1) that the electric-magnetic lattice coupling coefÔ¨Åcient is crucial for the existence of a
simultaneous solution for (a1;b1), indicating the importance of multipolar, electromagnetic coupling to
realize BICs. The analytical derivation of Eqs. (1) is further elaborated in the Supplementary Material .
Hence, for the speciÔ¨Åc scenario considered, Eqs (1) provides the exact condition to encounter a BIC
for s- or p-polarized incidences, respectively. To further simplify the design, the Mie coefÔ¨Åcients are
parametrized using what is called the Mie angles ( 42). For a lossless particle, a single angle bound
between =2and=2is sufÔ¨Åcient to express any possible value a Mie coefÔ¨Åcient might attain. A
representation of the Mie coefÔ¨Åcients in terms of these Mie angles is highly beneÔ¨Åcial for the further
design. For example, for the s-polarized incidence case, by substituting dipole electric and magnetic
Mie angles, E1andM1(see METHODS) into Eq. (1a), the exact solution can be easily obtained via a
non-linear equation solver for a given wavelength, incidence angle, and lattice dimension.
The process of identifying the BIC graphically can be demonstrated by assuming an s-polarized
incidence, as depicted in Fig. 2(a). After expressing the right hand side of Eq. (1a) as F(a1),All possible
Mie angles in the range of [ =2;=2], which parametrize the magnetic and electric dipolar coefÔ¨Åcients,
are swept through. The left-hand side (only the b1coefÔ¨Åcient) and the right-hand side of Eq. (1a) are
shown in the complex plane in Fig. 2(b). between  =2and=2that parametrize the magnetic and
4Figure 2: The toy model: (a) A unit cell of a metasurface made from a periodic arrangement of scatterers
with electric and magentic dipole polarizabilities in a square lattice. (b) A graphical representation of
how the Mie coefÔ¨Åcients are identiÔ¨Åed that lead to the desired response. The analytical expression for
the Mie coefÔ¨Åcient that needs to be satisÔ¨Åed to sustain a BIC at a predeÔ¨Åned normalized frequency
and incidence angle for a given period is plotted separately concerning its left- and right-handed sides.
Each side depends only on one Mie coefÔ¨Åcient. By parametrizing the Mie coefÔ¨Åcients with the Mie
angles, both sides of the expression in the complex plane have been plotted. From the point of crossing,
the Mie coefÔ¨Åcients that provide the desired BIC are identiÔ¨Åed. (c) The reÔ¨Çection Ras a function of
dimensionless frequency !d=2cand angle of incidence for a square lattice with period d= 450
nm. The lattice is decorated with particles that offer the previously identiÔ¨Åed Mie coefÔ¨Åcients. The
appearance of the BIC at the predeÔ¨Åned frequency and incidence angle can be seen. (d) The reÔ¨Çection R
as a function of dimensionless frequency !d=2cin close proximity to the off-  BIC.
electric dipolar coefÔ¨Åcients. The left-hand side, i.e. only the b1coefÔ¨Åcient, and the right-hand side of
(1a) are shown in the complex plane in Fig. 2(b). As required by lossless scatterers, all possible Mie
5coefÔ¨Åcients, including the ones of b1, lie on a circle in the complex plane with a center at the (0:5;0)
point and a radius of 1. It can be identiÔ¨Åed that the BIC is located where Refb1g= RefF(a1)gand
Imfb1g= ImfF(a1)gfor a speciÔ¨Åc wavelength, incidence angle, and lattice constant. Once the b1
coefÔ¨Åcient is known, the a1value can be explicitly calculated.
As an example, we Ô¨Ånd a combination of Mie angles ( E1;M1), or, in other words,T0matrix, for
which a BIC exists for the desired normalized frequency ~!d=!d=2c= 0:517and incident angle
d= 55in TE- / s-polarization. The reÔ¨Çection from a metasurface formed by the 2D array of dipolar
particles, corresponding to the calculated (a1;b1)values, is shown in Fig. 2(c). The reÔ¨Çection is shown
as a function of the normalized frequency, !d=2c, and the incidence angle, . Additionally, we have
been assuming here that the T-matrix is non-dispersive.
For the selected a1andb1dipole moments, a narrow resonant band is formed. This resonant band
disappears precisely at the target parameters (~!d;d), thus, hailing a BIC. To make the success of the
proposed methodology more explicit, in Fig. 2(d), we illustrate the change in resonance shape for the
reÔ¨Çection coefÔ¨Åcient, R, as a function of !d=2c, for different incident angles from 52to57. The
resonance becomes inÔ¨Ånitely narrow at an angle of dat~!d, or theQ-factor becomes inÔ¨Ånite. It implies
that the incident wave does not interact with the metasurface that gets fully transparent. Therefore, the
presented methodology succeeds in providing the Mie coefÔ¨Åcients for a spherical particle to observe a
BIC at a speciÔ¨Åc frequency and an angle of incidence of a plane wave upon a periodic arrangement of
the particle.
Step 2: Deep learning-assisted engineering of spherical particles for BIC realization
In the previous subsection, a method was presented that provides the T-matrix for an isotropic parti-
cle to achieve an accidental BIC for a speciÔ¨Åc normalized frequency and incidence angle.. Although
this approach was successful, if one wants to provide a practical design of a metasurface that exhibits
BICs, the calculated (a1;b1)values must be linked to a realistic scatterer. In this work, we employ a
deep-learning scheme to assign the calculated Mie coefÔ¨Åcients to a spherical core-shell nano-particle of
realistic dimensions and made from existing materials for an operation at optical wavelengths.
To Ô¨Ånd a suitable scatterer that provides desired Mie angles, a gradient-based deep learning-assisted
approach is performed, schematically explained in Fig. 3(a). More details on the ArtiÔ¨Åcial Neural Net-
works (ANNs) can be found in the article ( 43). Initially, we train a set of ANNs to predict the Mie angles
of coated dielectric spheres made from one to Ô¨Åve shells and at 200distinct wavelengths, between 800nm
-1200 nm. A part of the ANNs is also a classiÔ¨Åer that predicts the most probable number of shells to
provide the requested Mie angles. Actually, the exemplarily shown core-shell particle in Fig. 3(a) has
only three shells. Our trained ANN simply predicted at the end a core-shell particle with three shells only
as the most appropriate, which is illustrated here. The materials of the layers are restricted to discrete
refractive indices classes ranging from 1:4 3:5, values that are realistic at optical wavelengths for spe-
ciÔ¨Åc materials (see table 1). The radius of the core is limited to 20nm - 50nm. The dimension of each
shell is restricted to 20nm - 40nm. The ANNs are used as a fully differentiable surrogate model in a
gradient-based optimization algorithm, namely the limited-memory Broyden-Fletcher-Goldfarb-Shanno
algorithm including boundary constraints, or L-BFGS-B ( 44).
The actual solution to the inverse problem starts from random particle parameters as network input,
for which we predict the spectral dependencies of the Mie angles with the trained ANN. From that output,
6Figure 3: Inverse design: (a) Scheme to Ô¨Ånd the geometrical and material parameters of a meta-atom
(core-shell particle) with a target optical response. In the central part, there is a fully differentiable
artiÔ¨Åcial neural network that can predict the Mie angles for a given core-shell particle. The network
was trained within a given spectral region using discrete material classes and constrained geometrical
dimensions for the core and the shell that make the design feasible for realization. A gradient descent
is then used to identify the parameters characterizing the core-shell particle such that predeÔ¨Åned dipolar
Mie angles are provided at a design wavelength. At the very end, a second optimization is performed
where the refractive indices of the considered materials are Ô¨Åne-tuned to reach an absolute precision.
The table shows the design parameters for the example considered in the text. (b) Contribution of each
multipole moment (up to quadrupolar order) to the scattering cross-section of the core-shell particle sc
as a function of the wavelength for the Ô¨Ånal design. (c) Mie angles as a function of wavelength: the
dotted line refers to the Mie angles of the optimized toy model, and the solid line refers to the Mie angles
of the Ô¨Ånal design. The intersection of the dotted and solid lines in the d= 870 nm.
we compute an objective function f, the Mean Absolute Error (MAE) of the ANN output and the target
7Class 1 2 3 4 5 6 7
Refractive index 1.4649 1.7196 1.9447 2.0745 2.4317 3.0 3.5
Material SiO2 MgO ZnO ZrO2 TiO2 AlAs GaAs
Table 1: Diferent materials, associated classes and refractive indices.
Mie angles at the desired wavelength, d, as
f(target;NN;d) =1
2X
i2fE1;M1gji;target(d) i;NN(d)j: (2)
Subsequently, the gradients of fwith respect to the particle parameters@f
@(r;n)are computed, and they are
adjusted iteratively to minimize the MAE. This procedure is repeated for several initial parameters until
we Ô¨Ånd a core-shell particle that provides the target Mie angles with high accuracy.
Unfortunately, the discretization of the refractive index values naturally leads to a restriction of the
possible design space. Thus, the design Mie angles and those of the optimized stricture do not match in
a perfect sense after that procedure, i.e., we found an agreement only up to two digits after the comma.
However, the BIC is very sensitive to slight changes in the Mie angles. Hence, we perform a second
optimization using the actual analytical computation of the Mie angles and varied the refractive index of
the involved materials slightly for Ô¨Åne-tuning. This approach alone is signiÔ¨Åcantly slower than ANN-
assisted design, especially for several initial trials. Fortunately, in this work, the designed particle can
be Ô¨Åne-tuned to achieve the required accuracy (eight digits after the comma) and grant the appearance
of the BIC, given the results of the Ô¨Årst ANN-assisted optimization approach as a single starting point.
The Ô¨Åne-tuning of the refractive index of the shells could be carefully done by suitable doping of the
respective material, which should be within reach with existing technology ( 45‚Äì47 ). In summary, this
procedure provides a physical particle that can be used to form a metasurface that offers the BIC at the
predeÔ¨Åned frequency and incidence angle.
Step 3: Application of the design methodology
The procedure presented above will now be applied to propose a metasurface with a square unit cell
decorated by core-shell dielectric spheres that realize a BIC for a predeÔ¨Åned lattice, frequency, and
incidence angle. For this purpose, let us begin with the theoretical setup depicted in Fig. 2 with the
resulting Mie coefÔ¨Åcients from (1), a1= 0:4046 + 0:4908i andb1= 0:5508 + 0:4974i for~!d=
0:517 andd= 55. Afterward, the algorithm presented in the previous section will be utilized to
design a realistic core-shell spherical particle that provides the calculated Mie coefÔ¨Åcients a1andb1. We
deÔ¨Åne the dimension of the square lattice as d= 450 nm, thus, the desired operational wavelength is
d= 870 nm. The obtained set of parameters of the core-shell particle, i.e., the refractive indices and
the geometric dimensions of the shells and core, of which the square array should consist, is shown in
Fig. 3(a). Next, we perform a multipolar decomposition of the scattered Ô¨Åeld ( 48) from the designed
spherical particle upon illumination with a linearly polarized plane wave. As depicted in Fig. 3(b), it
possesses predominantly a dipolar response around the operational wavelength, d. Moreover, the Mie
angles of the designed core-shell particle are calculated ( 42) and presented for the wavelength spectrum
8500 1200 nm in Fig. 3(c). Although the Mie angles are dispersive within the considered spectrum, they
possess at the ~!dthe required values for the designed operation, equal those requested by the theoretical
model.
Figure 4: (a) The square lattice of core-shell particles. (b,d) ReÔ¨Çection coefÔ¨Åcients of the actual metasur-
face as calculated with a full-wave Maxwell solver that exploits the T-matrix formalism. The reÔ¨Çection
is shown as a function of the frequency and the incidence angle for a lattice dimension d= 450 nm.
(b) Calculation in dipole approximation. (d) Calculation in octupole approximation. (c,e) The reÔ¨Çection
coefÔ¨Åcient versus the normalized frequency in proximity to the off-  BIC for a lattice dimension dand
using the dipole or the octupole approximation, respectively.
Finally, the designed core-shell spherical particle is placed on a 2D square array (Fig. 4(a)) and the
optical response from the metasurface is analyzed with a dedicated T-matrix based full-wave solver (See
Supplementary Material ) (39, 40 ). In Figs. 4(b) and (d), the reÔ¨Çection depending on the normalized
frequency,!d=2c, and the incidence angle, , are shown when only dipole (Ô¨Årst order) and up to
octupole (third order) multipoles are considered in the response calculation, respectively ( 40). Please
note, the dipolar approximation would correspond to the assumption in the design process. However,
the actual particle does not, of course, have a purely dipolar response, but also small, yet non-negligible,
higher-order multipolar coefÔ¨Åcients. These higher-order multipolar contributions usually need to be
considered when the response from an actual metasurface is predicted.
SpeciÔ¨Åcally, when only the dipolar response of the particle is considered (Fig. 4(b)), a BIC is ob-
served at the (~!;) = (0:518;54:5), almost exactly on the desired location in the parameter space. A
9Figure 5: Robustness of the BICs. (a) the positions of the BICs for different angles (deg.) and normal-
ized frequency ~!values: circles and contour in the form of a rectangle ABCD . (b) the values of the Mie
angles for BICs from panel a.
more clear view of the reported BIC point is given in Fig. 4(c), where the reÔ¨Çection coefÔ¨Åcient of the
corresponding metasurface is plotted versus the normalized frequency for various angles of incidence.
Thus, the deviation of the obtained core-shell particle metasurface from the desired BIC point in the
theoretical dipole analysis is 1%. The discrepancy can easily be explained by the fact that the realistic
structure does not provide exactly the desired Mie coefÔ¨Åcients. In other words, the consideration of ac-
tual materials causes these small deviations. Finally, to verify that the proposed design still fulÔ¨Ålls the set
goals when higher order multipoles are taken into account, the reÔ¨Çection coefÔ¨Åcient from the core-shell
particle metasurface is calculated when considering multipoles up to octupolar order, i.e., j= 3(39,40 ).
One can observe in Fig. 4(d) and (e) that the resulting BIC position at (~!;) = (0:516;55:5)does
not differ much from the desired one. Therefore, it can be safely deduced that the performance of the
designed metasurface will remain the same in realistic conditions.
DISCUSSION
The sensitivity of the BIC against deviations in the Mie angles parameterizing the optical response of
the scatterers will now be discussed. Figure 5 demonstrates how the position of the BIC for different
anglesand frequency ~!values translates to values of the required Mie angles. The bounding box as
a rectangleABCD is transformed very strongly in the plane of the Mie angles. That can also be seen
in the individual circles that provide some insights into the robustness. Generally, for a robust BIC, we
require each area in the plane of the Mie angles to be as large as possible and as circular as possible. That
10would suggest that a given Mie coefÔ¨Åcient only needs to be roughly hit to ensure that a BIC appears in
the target area given by the circles in the plane spanned by the frequency and incident angle. However,
the BIC is extremely sensitive for a strongly reduced area of the surface in the plane of the Mie angles.
Thus, for that case, the Mie angles must be precisely met to cause a BIC at predeÔ¨Åned frequencies and
angles. Moreover, we notice that some circles are stretched and elongated in the plane of the Mie angles.
Here, we will speak about conditional robustness. In this case, many Mie angles, for, let‚Äôs say, the
electric dipole moment, permit the observation of the BIC in the target range of parameters. However,
the other Mie angle must be carefully tuned to be within the stretched circle. One can roughly conclude
that the most robust region is in the zone of lower frequencies and shorter angles (close to the corner A).
However, the excitations of BICs in the related parameter regime are difÔ¨Åcult for practical systems. The
sizes of realistic spheres, obtained as a result of the deep learning-assisted engineering step, compare
already very well to the period of the metasurface. Therefore, the BIC position could shift a lot relative
to the desired angles and frequencies since the renormalization is substantial in that parameter domain.
In Fig. 5(b), the intersection of two lines of the bounding box occurs as a further interesting phe-
nomenon. It means that for these Mie angles at the point of intersection, the metasurface sustains two
distinct BICs for different pairs of frequency and incidence angles. This case is discussed in more detail
in the Supplementary Material .
Although, in this work, we have utilized the dipole approximation to design the meta-atoms, i.e.,
only up to the Ô¨Årst multipolar order, the core idea behind the presented methodology is general and can
be applied to higher-order multipoles or more complex scatterers. Provided that the general eigenvalue
problem (see (6) in METHODS) can be solved under some approximations and the solutions corre-
sponding to the BIC resonances can be recognized, the Mie angles that lead to the desired BIC can be
expressed. For example, in ( 40), for a square metasurface illuminated by a normally-incident plane wave
and consisting of an isotropic particle with only a magnetic dipole and an electric quadrupole excited, a
BIC point was identiÔ¨Åed, or the required (b1;a2)values. Then, a suitable inverse design technique can
be used to identify an actual meta-atom that offers these desired Mie angles. In the work at hand, the
acquired Mie coefÔ¨Åcients were assigned to a core-shell particle via the deep learning algorithm. These
considerations can be extended to more complex, e.g., anisotropic or bi-anisotropic scatterers and can
accommodate an increasing number of multipolar orders. Approximate models for the T matrix could
be utilized for that purpose ( 49, 50 ) or more advanced neural networks can be trained ( 51).
In summary, the physics-inspired inverse design procedure for all-dielectric metasurfaces sustaining
an accidental BIC at a certain frequency and angle of incidence was developed in this work. The method-
ology utilized a smart combination of a semi-analytical approach and a dedicated machine-learning algo-
rithm. Firstly, the problem was solved within a theoretical model considering all-dielectric meta-atoms
using the dipole approximation and the T-matrix technique. The existence condition for an acciden-
tal BIC was derived in terms of Mie angles. Secondly, using a dedicated artiÔ¨Åcial neural network, the
geometrical and material parameters of a core-shell, spherical particle that offered the desired optical
response provided by the BIC condition were identiÔ¨Åed. In this way, a physically feasible meta-atom
was found that provided the desired BIC when placed on an inÔ¨Ånite 2D array. Finally, the design was nu-
merically veriÔ¨Åed, and the robustness of the designed position BIC in k-space was tested by considering
higher-order multipoles.
11METHODS
The T-matrix formulation for 2D arrays and BIC identiÔ¨Åcation
Considering a metasurface composed of a square array of isotropic and non-absorbing particles, as shown
in Figure 2(a). The surrounding medium is a vacuum.
If an arbitrary scatterer is placed in an inÔ¨Ånite homogeneous background and the vector spherical
harmonics (VSH) basis is employed to expand the Ô¨Åelds, the scattering response to an incident electro-
magnetic wave can be described using the T matrix, orT0, as
ae
am
=T0qe
qm
="TeeTem
TmeTmm#qe
qm
: (3)
Vectors qfe;mgcontain the incident wave electric or magnetic coefÔ¨Åcients, respectively, while afe;mg
contain the scattering electric or magnetic coefÔ¨Åcients, respectively ( 52). For each multipolar expansion
orderj2N, the size of the aforementioned vectors increases by 2j+ 1. Prior knowledge of the T
matrix can predict the electromagnetic response of a scatterer, since it depends on the scatterer‚Äôs geom-
etry, constituting materials, and surrounding material. The elements of the T matrix can generally be
extracted up to a preset expansion order via numerical simulations ( 48,53 ), while for special geometries,
such as spheres, cylinders, etc., the T matrix elements can be calculated analytically. The particular
case of isotropic particles, i.e., spherical ones, is very interesting because apart from enabling analytic
calculations, the respective T matrices become diagonal, or,Tem=Tme=0andTee
il=Tmm
il= 0, for
i6=l, withfi;lg2[ j;j], whileTee
jandTmm
jbecome scalar matrices for each multipolar order j, or,
Tee
j= ajIandTmm
j= bjI. The parameters ajandbjare called the Mie coefÔ¨Åcients (54).
For an isotropic particle, it is convenient to parameterize the coefÔ¨Åcients with Mie angles (42). In
particular, for lossless particles and when only dipoles are considered, i.e., j= 1, all possible Mie
coefÔ¨Åcients can be expressed using two parameters E1andM1, or
a1=1
1 i tanE1; 
2E1
2; (4a)
b1=1
1 i tanM1; 
2M1
2: (4b)
As a result, the optical response of the corresponding scatterer can be parameterized with the two Mie
angles above, while still having a clear physical picture. This formulation is very important because the
control parameters, namely E1andM1, are placed between an upper and lower boundary, which will aid
optimization methods and subsequent metasurface design. Furthermore, similar expressions involving
Mie angles, like the ones of (4) above, exist for higher-order multipoles, the addition of absorption or
Lorentzian dispersion for Mie coefÔ¨Åcients (see Supplementary Material ).
Let us now assume an inÔ¨Ånite square array composed of arbitrary, identical, absorption-less, spherical
particles placed in a homogeneous material, as depicted in Fig. 1. The response of the metasurface can be
calculated via the T matrix of the particle by employing microscopic models ( 39,40,55,56 ). An important
aspect to be noted herein is that the T matrix of the particle within the metasurface is re-normalized due
to the particle interaction. Thus, in 2D array models, the isolated particle‚Äôs T matrix,T0, from (3) is
12replaced with the effective T matrix calculated via ( 55)
Te=I T0Cs 1T0; (5)
whereIis the identity matrix, andCsis the lattice coupling matrix expressed in spherical coordinates,
which is a function of the unit cell dimension, the frequency, and the wavevector, and is calculated,
herein, via rapidly converging summations using Ewald‚Äôs method ( 39, 41, 57 ). The analytical method
based on a multipolar expansion that is used in this work for the calculation of the response of an inÔ¨Ånite
2D square array ( 40) is elaborated in the Supplementary Material .
It should be stressed that, although the scattering response of a single particle and of the subsequent
2D array is provided here using the spherical coordinates and the T matrix approach, the analysis that
will follow is valid and interchangeable with the use of multipoles in Cartesian coordinates and the
polarizability matrix. In particular, one can obtain the T matrix of a particle from the polarizability
matrix, and vice versa using the appropriate transformation matrices for each multipolar order ( 40, 58 ).
Additionally, modiÔ¨Åcations of the same matrices can transform multipoles of the same type and order
from a spherical to a Cartesian basis and vice versa, as presented in the Supplementary Materials for
multipoles up to the j= 3order.
After deÔ¨Åning the multipolar description of the electromagnetic response of 2D arrays composed
of isotropic particles, next, we will present the procedure for identifying the presence of BICs after
setting certain goals. First, let us theoretically acquire the BIC position using the multipolar expansion
technique ( 40,59‚Äì61 ). If we again assume a square array composed of identical and isotropic particles, its
response to an incident Ô¨Åeld can be described by substituting (3) and (5) into the equations that describe
the response of a 2D array ( 39,40 ) (see Supplementary Material ), and, thus, a linear system of equations
is formed. Solving the eigenvalue problem leads to the modes of the array, including, in this case, the
trapped ones that do not couple with radiation channels, i.e., the BICs. Therefore, if we invert the square
matrix of the system to the left side of (3) and set the excitation to zero, or qfe;mg=0, the resulting
homogeneous system will have a non-trivial solution if the determinant of the matrix is zero ( 25,26,40 ).
In particular, after some algebra, the BIC condition is reduced to
I T0Cs= 0: (6)
The symmetry of the resonators is tightly related to their mode structure and multipole content, which
determine the linear and non-linear response of the resonator. Using group theory, it is possible to classify
the eigenmodes into irreducible representations and understand their multipole content ( 62‚Äì64 ). Our
model is characterized only by the dipole response. Table 1 shows how the dipole moments correspond
to different types of eigenmodes for a square array of particles outside the off-  point in a spherical
basis. The system is characterized by the C2vsymmetry group in direction  X. There are only 4 types
of modes:A1,A2,B1, andB2. Destructive interference of the eigenmodes of one type is necessary for
BICs formed by the Friedrich-Wintgen mechanism. It can be concluded that in this model, parametric
BIC exists only in modes of types B1andB2.
The expression (6) is general in nature and can be used for any type of lattice or particle in a ho-
mogenous medium ( 40). Due to its complexity, (6) can only be solved numerically in its general form,
i.e., for higher-order multipoles or more diverse lattices. Nevertheless, for speciÔ¨Åc reduced cases, versa-
tile analytic solutions can be found, as demonstrated in ( 40) for the case of the coupled electric dipole -
13Irreducible representation A1A2B1 B2
Cartesian basis pymypz;mxmz;px
Spherical basis ae
11,ae
1 1am
11,am
1 1ae
10,am
11,am
1 1am
10,ae
11,ae
1 1
Table 2: The classiÔ¨Åcation of modes by irreducible representations and the multipole composition of the
eigenmode for C2vsymmetry group in direction  Xin the dipole approximation for different bases.
magnetic quadrupole on a square lattice and a normal, TM wave incidence. In this work, we consider a
square lattice decorated by isotropic and lossless particles, whose response is expanded only up to dipolar
order, orj= 1. Then, because the elements of the lattice interaction matrix,Cs, can be pre-calculated
for a speciÔ¨Åc incident wavevector, kinc, and a normalized lattice dimension, d=, eventually, (6) can be
solved forj= 1with the Mie angles of (4) as the unknowns.
Acknowledgments
D.B. and C.R. acknowledge support by the Deutsche Forschungsgemeinschaft (DFG, German Research
Foundation) under Germany‚Äôs Excellence Strategy via the Excellence Cluster 3D Matter Made to Order
(EXC-2082/1-390761711) and by the Carl Zeiss Foundation. C.R. also acknowledges support by the
Helmholtz Association via the Helmholtz program ‚ÄúMaterials Systems Engineering‚Äù (MSE), and the
KIT through the ‚ÄúVirtual Materials Design‚Äù (VIRTMAT). L.K. acknowledges support by the NHR@KIT
program and the Karlsruhe School of Optics and Photonics.
Supplementary material
Sections
- S1. Field expansion via vector spherical harmonics.
- S2. Scattering from 2D arrays via multipolar expansion.
- S3. Mie angles deÔ¨Ånition.
- S4. Transformation from Cartesian to Spherical multipoles.
- S5. BIC identiÔ¨Åcation for a dipole metasurface.
- S6. Computation of the lattice coupling matrixCs.
- S7. Two BICs in one band.
Figures
- Fig.S1. A square lattice of identical particles along with the set-up Cartesian and spherical coor-
dinate systems.
- Fig.S2. Model with a Lorentzian dispersion.
- Fig.S3. Two BICs on one mode line.
References in (65‚Äì72 )
14References and Notes
1. C. W. Hsu, B. Zhen, A. D. Stone, J. D. Joannopoulos, M. Solja Àáci¬¥c, Bound states in the continuum.
Nat. Rev. Mater. 1, 1‚Äì13 (2016).
2. K. Koshelev, G. Favraud, A. Bogdanov, Y . Kivshar, A. Fratalocchi, Nonradiating photonics with
resonant dielectric nanostructures. Nanophotonics 8, 725‚Äì745 (2019).
3. K. L. Koshelev, Z. F. Sadrieva, A. A. Shcherbakov, Y . S. Kivshar, A. A. Bogdanov, Bound states in
the continuum in photonic structures. Phys.-Usp. 93(2023). [Online; accessed 16. Feb. 2023].
4. S. I. Azzam, A. V . Kildishev, Photonic Bound States in the Continuum: From Basics to Applications.
Adv. Opt. Mater. 9, 2001469 (2021).
5. C.-W. Qiu, T. Zhang, G. Hu, Y . Kivshar, Quo Vadis, Metasurfaces? Nano Lett. 21, 5461‚Äì5474
(2021).
6. A. Kodigala, T. Lepetit, Q. Gu, B. Bahari, Y . Fainman, B. Kant ¬¥e, Lasing action from photonic bound
states in continuum. Nature 541, 196‚Äì199 (2017).
7. S. T. Ha, Y . H. Fu, N. K. Emani, Z. Pan, R. M. Bakker, R. Paniagua-Dom ¬¥ƒ±nguez, A. I. Kuznetsov,
Directional lasing in resonant semiconductor nanoantenna arrays. Nat. Nanotechnol. 13, 1042‚Äì1047
(2018).
8. C. Huang, C. Zhang, S. Xiao, Y . Wang, Y . Fan, Y . Liu, N. Zhang, G. Qu, H. Ji, J. Han, L. Ge,
Y . Kivshar, Q. Song, Ultrafast control of vortex microlasers. Science 367, 1018‚Äì1021 (2020).
9. M.-S. Hwang, H.-C. Lee, K.-H. Kim, K.-Y . Jeong, S.-H. Kwon, K. Koshelev, Y . Kivshar, H.-G. Park,
Ultralow-threshold laser using super-bound states in the continuum. Nat. Commun. 12, 1‚Äì9 (2021).
10. S. I. Azzam, K. Chaudhuri, A. Lagutchev, Z. Jacob, Y . L. Kim, V . M. Shalaev, A. Boltasseva, A. V .
Kildishev, Single and Multi-Mode Directional Lasing from Arrays of Dielectric Nanoresonators.
Laser Photonics Rev. 15, 2000411 (2021).
11. A. Ndao, L. Hsu, W. Cai, J. Ha, J. Park, R. Contractor, Y . Lo, B. Kant ¬¥e, Differentiating and quantify-
ing exosome secretion from a single cell using quasi-bound states in the continuum. Nanophotonics
9, 1081‚Äì1086 (2020).
12. A. Tittl, A. Leitis, M. Liu, F. Yesilkoy, D.-Y . Choi, D. N. Neshev, Y . S. Kivshar, H. Altug, Imaging-
based molecular barcoding with pixelated dielectric metasurfaces. Science 360, 1105‚Äì1109 (2018).
13. A. Leitis, A. Tittl, M. Liu, B. H. Lee, M. B. Gu, Y . S. Kivshar, H. Altug, Angle-multiplexed all-
dielectric metasurfaces for broadband molecular Ô¨Ångerprint retrieval. Sci. Adv. 5, eaaw2871 (2019).
14. S. Romano, G. Zito, S. Manag `o, G. CalaÔ¨Åore, E. Penzo, S. Cabrini, A. C. De Luca, V . Mocella,
Surface-Enhanced Raman and Fluorescence Spectroscopy with an All-Dielectric Metasurface. J.
Phys. Chem. C 122, 19738‚Äì19745 (2018).
1515. V . Kravtsov, E. Khestanova, F. A. Benimetskiy, T. Ivanova, A. K. Samusev, I. S. Sinev, D. Pidgayko,
A. M. Mozharov, I. S. Mukhin, M. S. Lozhkin, Y . V . Kapitonov, A. S. Brichkin, V . D. Kulakovskii,
I. A. Shelykh, A. I. Tartakovskii, P. M. Walker, M. S. Skolnick, D. N. Krizhanovskii, I. V . Iorsh,
Nonlinear polaritons in a monolayer semiconductor coupled to optical bound states in the continuum.
Light Sci. Appl. 9, 1‚Äì8 (2020).
16. S. Cao, H. Dong, J. He, E. Forsberg, Y . Jin, S. He, Normal-Incidence-Excited Strong Coupling
between Excitons and Symmetry-Protected Quasi-Bound States in the Continuum in Silicon Ni-
tride‚ÄìWS2 Heterostructures at Room Temperature. J. Phys. Chem. Lett. 11, 4631‚Äì4638 (2020).
17. E. Maggiolini, L. Polimeno, F. Todisco, A. Di Renzo, M. De Giorgi, V . Ardizzone, R. Mastria,
A. Cannavale, M. Pugliese, V . Maiorano, et al. , Strongly enhanced light-matter coupling of a mono-
layer ws2 from a bound state in the continuum. arXiv preprint arXiv:2209.00129 (2022).
18. T. Weber, L. K ¬®uhner, L. Sortino, A. B. Mhenni, N. P. Wilson, J. K ¬®uhne, J. J. Finley, S. A. Maier,
A. Tittl, Strong light-matter interaction with self-hybridized bound states in the continuum in mono-
lithic van der waals metasurfaces. arXiv preprint arXiv:2209.01944 (2022).
19. N. Bernhardt, K. Koshelev, S. J. U. White, K. W. C. Meng, J. E. Fr ¬®och, S. Kim, T. T. Tran, D.-Y . Choi,
Y . Kivshar, A. S. Solntsev, Quasi-BIC Resonant Enhancement of Second-Harmonic Generation in
WS2 Monolayers. Nano Lett. 20, 5309‚Äì5314 (2020).
20. G. Zograf, K. Koshelev, A. Zalogina, V . Korolev, R. Hollinger, D.-Y . Choi, M. Zuerch, C. Spiel-
mann, B. Luther-Davies, D. Kartashov, S. V . Makarov, S. S. Kruk, Y . Kivshar, High-Harmonic
Generation from Resonant Dielectric Metasurfaces Empowered by Bound States in the Continuum.
ACS Photonics 9, 567‚Äì574 (2022).
21. I. S. Sinev, K. Koshelev, Z. Liu, A. Rudenko, K. Ladutenko, A. Shcherbakov, Z. Sadrieva, M. Bara-
nov, T. Itina, J. Liu, A. A. Bogdanov, Y . Kivshar, Observation of Ultrafast Self-Action Effects in
Quasi-BIC Resonant Metasurfaces. Nano Lett. 21, 8848‚Äì8855 (2021).
22. Z. Liu, J. Wang, B. Chen, Y . Wei, W. Liu, J. Liu, Giant Enhancement of Continuous Wave Sec-
ond Harmonic Generation from Few-Layer GaSe Coupled to High-Q Quasi Bound States in the
Continuum. Nano Lett. 21, 7405‚Äì7410 (2021).
23. B. Zhen, C. W. Hsu, L. Lu, A. D. Stone, M. Solja Àáci¬¥c, Topological Nature of Optical Bound States in
the Continuum. Phys. Rev. Lett. 113, 257401 (2014).
24. C. W. Hsu, B. Zhen, J. Lee, S.-L. Chua, S. G. Johnson, J. D. Joannopoulos, M. Solja Àáci¬¥c, Observation
of trapped light within the radiation continuum. Nature 499, 188‚Äì191 (2013).
25. A. B. Evlyukhin, M. A. Poleva, A. V . Prokhorov, K. V . Baryshnikova, A. E. Miroshnichenko,
B. N. Chichkov, Polarization switching between electric and magnetic quasi-trapped modes in bian-
isotropic all-dielectric metasurfaces. Laser & Photonics Reviews 15, 2100206 (2021).
26. D. R. Abujetas, J. Olmos-Trigo, J. A. S ¬¥anchez-Gil, Tailoring accidental double bound states in the
continuum in all-dielectric metasurfaces. Advanced Optical Materials p. 2200301 (2022).
1627. P. R. Wiecha, A. Arbouet, A. Arbouet, C. Girard, C. Girard, O. L. Muskens, O. L. Muskens, Deep
learning in nano-photonics: inverse design and beyond. Photonics Res. 9, B182‚ÄìB200 (2021).
28. S. Molesky, Z. Lin, A. Y . Piggott, W. Jin, J. Vuckovi ¬¥c, A. W. Rodriguez, Inverse design in nanopho-
tonics. Nat. Photonics 12, 659‚Äì670 (2018).
29. M. Elizarov, Y . S. Kivshar, A. Fratalocchi, Inverse-designed metaphotonics for hypersensitive detec-
tion. ACS Nanoscience Au 2, 422‚Äì432 (2022).
30. P. R. Wiecha, A. Y . Petrov, P. Genevet, A. Bogdanov, Inverse design of nanophotonics devices and
materials (2022).
31. J. Jiang, M. Chen, J. A. Fan, Deep neural networks for the evaluation and design of photonic devices.
Nat. Rev. Mater. 6, 679‚Äì700 (2021).
32. W. Ma, Z. Liu, Z. A. Kudyshev, A. Boltasseva, W. Cai, Y . Liu, Deep learning for the design of
photonic structures. Nat. Photonics 15, 77‚Äì90 (2021).
33. S. Krasikov, A. Tranter, A. Bogdanov, Y . Kivshar, Intelligent metaphotonics empowered by machine
learning. OEA 5, 210147-1‚Äì210147-24 (2022).
34. A. Estrada-Real, A. Khaireh-Walieh, B. Urbaszek, P. R. Wiecha, Inverse design with Ô¨Çexible design
targets via deep learning: Tailoring of electric and magnetic multipole scattering from nano-spheres.
Photonics and Nanostructures-Fundamentals and Applications 52, 101066 (2022).
35. T. Zahavy, A. Dikopoltsev, D. Moss, G. I. Haham, O. Cohen, S. Mannor, M. Segev, Deep learning
reconstruction of ultrashort pulses. Optica 5, 666‚Äì673 (2018).
36. H. Kabir, Y . Wang, M. Yu, Q.-J. Zhang, Neural Network Inverse Modeling and Applications to
Microwave Filter Design. IEEE Trans. Microwave Theory Tech. 56, 867‚Äì879 (2008).
37. T. Zhang, J. Wang, Q. Liu, J. Zhou, J. Dai, X. Han, Y . Zhou, K. Xu, EfÔ¨Åcient spectrum prediction
and inverse design for plasmonic waveguide systems based on artiÔ¨Åcial neural networks. Photonics
Res. 7, 368‚Äì380 (2019).
38. Y . Rivenson, Z. G ¬®or¬®ocs, H. G ¬®unaydin, Y . Zhang, H. Wang, A. Ozcan, Deep learning microscopy.
Optica 4, 1437‚Äì1443 (2017).
39. D. Beutel, A. Groner, C. Rockstuhl, I. Fernandez-Corbaton, EfÔ¨Åcient simulation of biperiodic, lay-
ered structures based on the t-matrix method. Journal of the Optical Society of America B 38,
1782‚Äì1791 (2021).
40. A. Rahimzadegan, T. D. Karamanos, R. Alaee, A. G. Lamprianidis, D. Beutel, R. W. Boyd, C. Rock-
stuhl, A comprehensive multipolar theory for periodic metasurfaces. Advanced Optical Materials
10, 2102059 (2022).
41. D. Beutel, I. Fernandez-Corbaton, C. Rockstuhl, UniÔ¨Åed lattice sums accommodating multiple sub-
lattices for solutions of the helmholtz equation in two and three dimensions. Physical Review A 107,
013508 (2023).
1742. A. Rahimzadegan, R. Alaee, C. Rockstuhl, R. W. Boyd, Minimalist mie coefÔ¨Åcient model. Optics
Express 28, 16511‚Äì16525 (2020).
43. L. Kuhn, T. Rep ¬®an, C. Rockstuhl, Inverse design of core-shell particles with discrete material classes
using neural networks. ScientiÔ¨Åc Reports 12, 19019 (2022).
44. R. H. Byrd, P. Lu, J. Nocedal, C. Zhu, A limited memory algorithm for bound constrained optimiza-
tion. SIAM Journal on scientiÔ¨Åc computing 16, 1190‚Äì1208 (1995).
45. M. ¬¥Smietana, M. My ¬¥sliwiec, P. Mikulic, B. S. Witkowski, W. J. Bock, Capability for Ô¨Åne tuning
of the refractive index sensing properties of long-period gratings by atomic layer deposited al2o3
overlays. Sensors 13, 16372‚Äì16383 (2013).
46. S. K. Medda, S. De, G. De, Synthesis of au nanoparticle doped sio 2‚Äìtio 2 Ô¨Ålms: tuning of au surface
plasmon band position through controlling the refractive index. Journal of Materials Chemistry 15,
3278‚Äì3284 (2005).
47. B. Schwenzer, L. Wang, J. S. Swensen, A. B. Padmaperuma, G. Silverman, R. Korotkov, D. J.
Gaspar, Tuning the optical properties of mesoporous tio2 Ô¨Ålms by nanoscale engineering. Langmuir
28, 10072‚Äì10081 (2012).
48. X. G. Santiago, M. Hammerschmidt, S. Burger, C. Rockstuhl, I. Fernandez-Corbaton,
L. Zschiedrich, Decomposition of scattered electromagnetic Ô¨Åelds into vector spherical wave func-
tions on surfaces with general shapes. Physical Review B 99, 045406 (2019).
49. A. Serdyukov, I. Semchenko, S. Tretyakov, A. Sihvola, Electromagnetics of bi-anisotropic materi-
als: Theory and applications (Gordon and Breach science publishers, 2001).
50. R. Marqu ¬¥es, F. Martin, M. Sorolla, Metamaterials with negative parameters: theory, design, and
microwave applications (John Wiley & Sons, 2011).
51. T. Rep ¬®an, Y . Augenstein, C. Rockstuhl, Exploiting geometric biases in inverse nano-optical problems
using artiÔ¨Åcial neural networks. Optics Express 30, 45365‚Äì45375 (2022).
52. M. I. Mishchenko, L. D. Travis, A. A. Lacis, Scattering, absorption, and emission of light by small
particles (Cambridge university press, 2002).
53. G. Dem ¬¥esy, J.-C. Auger, B. Stout, Scattering matrix of arbitrarily shaped objects: combining Ô¨Ånite
elements and vector partial waves. Journal of the Optical Society of America A 35, 1401‚Äì1409
(2018).
54. C. F. Bohren, D. R. Huffman, Absorption and Scattering of Light by Small Particles (John Wiley &
Sons, 2008).
55. Y .-L. Xu, Scattering of electromagnetic waves by periodic particle arrays. Journal of the Optical
Society of America A 30, 1053‚Äì1068 (2013).
1856. T. Antonakakis, F. I. Baida, A. Belkhir, K. Cherednichenko, S. Cooper, R. Craster, G. Dem ¬¥esy,
J. Desanto, G. Granet, B. Gralak, et al. , Gratings: Theory and numeric applications (2014).
57. I. M. Fradkin, S. A. Dyakov, N. A. Gippius, Fourier modal method for the description of nanoparticle
lattices in the dipole approximation. Physical Review B 99, 075310 (2019).
58. J. Mun, S. So, J. Jang, J. Rho, Describing meta-atoms using the exact higher-order polarizability
tensors. ACS Photonics 7, 1153‚Äì1162 (2020).
59. K. Koshelev, Y . Kivshar, Dielectric resonant metaphotonics. ACS Photonics 8, 102‚Äì112 (2020).
60. D. R. Abujetas, J. Olmos-Trigo, J. J. S ¬¥aenz, J. A. S ¬¥anchez-Gil, Coupled electric and magnetic dipole
formulation for planar arrays of particles: Resonances and bound states in the continuum for all-
dielectric metasurfaces. Physical Review B 102, 125411 (2020).
61. A. B. Evlyukhin, V . R. Tuz, V . S. V olkov, B. N. Chichkov, Bianisotropy for light trapping in all-
dielectric metasurfaces. Physical Review B 101, 205415 (2020).
62. Z. Sadrieva, K. Frizyuk, M. Petrov, Y . Kivshar, A. Bogdanov, Multipolar origin of bound states in
the continuum. Physical Review B 100, 115303 (2019).
63. S. Gladyshev, K. Frizyuk, A. Bogdanov, Symmetry analysis and multipole classiÔ¨Åcation of eigen-
modes in electromagnetic resonators for engineering their optical properties. Physical Review B 102,
075103 (2020).
64. Z. Xiong, Q. Yang, W. Chen, Z. Wang, J. Xu, W. Liu, Y . Chen, On the constraints of electromagnetic
multipoles for symmetric scatterers: eigenmode analysis. Optics Express 28, 3073‚Äì3085 (2020).
65. A. D. Utyushev, V . I. Zakomirnyi, I. L. Rasskazov, Collective lattice resonances: Plasmonics and
beyond. Reviews in Physics 6, 100051 (2021).
66. L. Tsang, J. A. Kong, R. T. Shin, Theory of Microwave Remote Sensing (Wiley Series in Remote
Sensing and Image Processing) (Wiley-Interscience, 1985).
67. E. P. Wigner, On the matrices which reduce the kronecker products of representations of sr groups.
The Collected Works of Eugene Paul Wigner (Springer, 1993), pp. 608‚Äì654.
68. A. Messiah, Clebsch-gordan (c.-g.) coefÔ¨Åcients and‚Äô3j‚Äôsymbols. Appendix CI in Quantum Mechan-
ics2, 1054‚Äì1060 (1962).
69. P. P. Ewald, Die berechnung optischer und elektrostatischer gitterpotentiale. Annalen der Physik
369, 253‚Äì287 (1921).
70. K. Kambe, Theory of Low-Energy Electron Diffraction (I. Application of the Cellular Method to
Monatomic Layers). Zeitschrift f ¬®ur Naturforschung A 22(1967).
71. A. Rahimzadegan, R. Alaee, T. Karamanos, R. W. Boyd, C. Rockstuhl, Colossal enhancement of the
magnetic dipole moment by exploiting lattice coupling in metasurfaces. JOSA B 38, C217‚ÄìC224
(2021).
1972. F. G. De Abajo, R. G ¬¥omez-Medina, J. S ¬¥aenz, Full transmission through perfect-conductor subwave-
length hole arrays. Physical review E 72, 016608 (2005).
20