Draft version May 30, 2023
Typeset using L ATEXtwocolumn style in AASTeX631
Monte Carlo Radiation Transport for Astrophysical Transients Powered by Circumstellar Interaction
Gururaj Wagle
 ,1Emmanouil Chatzopoulos
 ,1, 2Ryan Wollaeger
 ,3, 1and Christopher J. Fontes
3
1Department of Physics and Astronomy, Louisiana State University, Baton Rouge, LA 70803, USA
2Institute of Astrophysics, Foundation for Research and Technology-Hellas (FORTH), Heraklion, 70013, Greece
3Center for Theoretical Astrophysics, Los Alamos National Laboratory, Los Alamos, NM 87544, USA
(Received April 4, 2023; Revised May 25, 2023; Accepted May 30, 2023)
Submitted to APJ
ABSTRACT
In this paper, we introduce SuperLite , an open-source Monte Carlo radiation transport code de-
signed to produce synthetic spectra for astrophysical transient phenomena affected by circumstellar
interaction. SuperLite utilizes Monte Carlo methods for semi-implicit, semi-relativistic radiation
transport in high-velocity shocked outflows, employing multi-group structured opacity calculations.
The code enables rapid post-processing of hydrodynamic profiles to generate high-quality spectra that
can be compared with observations of transient events, including superluminous supernovae, pulsa-
tional pair-instability supernovae, and other peculiar transients. We present the methods employed
inSuperLite and compare the code’s performance to that of other radiative transport codes, such
asSuperNu and CMFGEN. We show that SuperLite has successfully passed standard Monte Carlo
radiation transport tests and can reproduce spectra of typical supernovae of Type Ia, Type IIP and
Type IIn.
Keywords: methods: numerical — radiative transfer — supernovae: general — stars: evolution —
circumstellar matter
1.INTRODUCTION
Classical supernovae (SNe) are broadly divided into
Type I, Type II and their sub-types based on their ob-
served light curves and spectra following the explosion
(see Filippenko 1997, for a review of the SN classification
system). Unambiguous identification of the progenitor
star is not possible for most of these events due to ob-
servational limitations. However, a significant progress
has been made during the past several decades in un-
derstanding the mechanisms that drive the formation
of these explosive events through theoretical modeling
and the supporting observational evidence (see, e.g.,
Branch & Wheeler 2017; Burrows & Vartanyan 2021;
Hillebrandt et al. 2013). In the case of Type Ia super-
novae (SNe Ia), the pre-explosion progenitor star has
not been successfully observed in the archival images,
Corresponding author: Gururaj Wagle
gwagle1@lsu.eduwith only one exception in the case of spectroscopically
abnormal SN 2012Z (Wright et al. 2016). The consen-
sus about the progenitor of SN Ia being a white dwarf is
based on the observations of early light curves that im-
ply a compact star. The other widely accepted theory is
that the progenitor white dwarf is part of a binary sys-
tem, and it either accretes mass from its non-degenerate
companion or merges with a white dwarf companion,
which leads to the explosive core-carbon burning that
results into a SN Ia. However, the evidence for the na-
ture of such a companion star is also not well-established
through observations (Branch & Wheeler 2017). There
are several theories proposed to explain the explosion
mechanism ranging from pure detonation to pure de-
flagration to deflagration-to-detonation models (Hille-
brandt et al. 2013).
Even in the case of more commonly observed core-
collapse supernovae (CCSNe or SNe Type II), the pre-
explosion archival observations are limited to nearby
events ( d≤30Mpc, Smartt 2009; Van Dyk et al.arXiv:2305.17184v1  [astro-ph.HE]  26 May 20232 Wagle et al.
2023). The SNe II result from the gravitational collapse
of the core of massive stars (M >8M⊙on the zero-
age main-sequence, ZAMS, at solar metalicity, Woosley
et al. 2002). Bethe & Wilson (1985) proposed a de-
layed neutrino heating model in competition with then
favored core bounce-shock model of Colgate & White
(1966) to explain these the CCSN mechanism. The
neutrino-driven model of Bethe & Wilson was obser-
vationally confirmed when SN 1987A, identified as SN
II, exploded in the Large Magellanic Cloudy (LMC) at
a distance of less than 50 kpc (Arnett et al. 1989).
Kamiokande-II (Hirata et al. 1987), Irvine-Michigan-
Brookhaven (Bionta et al. 1987) detectors and the Bak-
san Scintillator Telescope (Alexeyev et al. 1988) ob-
served the neutrino flux from the location of SN 1987A,
which agreed with that predicted by the theory. Similar
to SNe II, the theory also predicts that a flux of neutri-
nos can be observed from SNe Ia; however, it is about 4
magnitude smaller than SNe II. Theoretical calculations
done for the detonation-to-deflagration model show that
a SN Ia at a distance of about 10 kpc will be barely
observable by the largest current and next-generation
neutrino detectors (Wright et al. 2016). Thus to make
such an observation, a SN Ia has to explode at a close
distance.
Inspite of the advancements in our knowledge over
past several decades, there still exists a gap in our un-
derstanding of the characteristics of progenitor stars and
the differences in the observed characteristics of SNe of
the same type that result from these stars. For exam-
ple, the archival observations of the pre-explosion sites
of CCSNe stipulate that the progenitor stars of SNe II
are red supergiant stars (RSGs) that retained large hy-
drogen envelopes at the time of their explosion (Smartt
et al. 2009; Smartt 2015). On the other hand, the pre-
explosion archival images indicate that SN 1987A re-
sulted from an explosion of a blue supergiant star (BSG)
that retained a substantial amount of hydrogen in its
envelope (Arnett et al. 1989). Arnett (1991) originally
proposed a model with a ZAMS mass of ∼20 M ⊙and
metallicity one-forth of the Sun with no mass-loss to ex-
plain a BSG progenitor star. Woosley et al. (1988) and
Woosley (1988) showed that the same model star with
no convective overshoot or semi-convection remains a
RSG through helium burning and later becomes a BSG
to explode as a SN II. Alternately, the more recent bi-
nary merger models explain most of the observed prop-
erties of the progenitor of SN 1987A (Menon & Heger
2017). This demonstrates that the properties of the pro-
genitor stars and the characteristics of the resulting SN
depend greatly upon the choices of the initial conditions
on the mass, metallicity and chemical composition, in-ternal mixing, stellar rotation, mass loss in stellar wind,
binarity, etc. (some of these properties are explored in
the four-article series, Wagle et al. 2019; Wagle & Ray
2020; Wagle et al. 2020; Palani Balaji et al. 2022).
There exist observed properties in some cases of SN
explosions that are evidently the result of an interac-
tion between the supernova outflow and the circumstel-
lar material (CSM) that surrounds the progenitor star,
formed by mass-loss prior to its explosion. In the ab-
sence of such interactions, the light curves are primarily
powered by the initial shock energy deposited at the
time of explosion and by radioactive decay of56Ni or
56Co. However, in the presence of strong SN ejecta-
circumstellar material interaction (hereafter, CSI), ad-
ditional SN luminosity is displayed in the form of the
ultra-violet (UV) or X-ray emission observed during the
early phases to the radio emission observed during the
late times. The nature of this emission depends upon
the mass and location of the CSM and the properties
and rate of expansion of the supernova ejecta, which in
turn depends on the structure and evolution of the pro-
genitor star. The CSI gives rise to a strong and fast
shock wave in the CSM and a reverse shock in the SN
ejecta. In such situations, the radiation leaks through
the shocked region as the time-scale of photon diffusion
is much shorter than the shock-crossing time, and the
assumptions of local thermodynamic equilibrium (LTE)
are no longer valid. The inverse-Compton scattering of
photons due to the fast electrons in the shocked CSM
produce the UV and X-ray emission. In addition the
free-free radiation from both the forward- and reverse-
shocked regions produce X-ray emission. The atoms
in the high-density cool dense shell (CDS) formed by
the compressed shocked ejecta recombine to form the
narrow-width emission lines observed in the SNe of Type
IIn (“n” stands for narrow), especially the Balmer se-
ries line H α. The wings of these emission lines can be
broadened by multiple electron scattering. (see Branch
& Wheeler 2017; Chevalier & Fransson 1994; Chevalier
et al. 2006; Chevalier & Fransson 2017; Dessart et al.
2016; Dessart & Hillier 2022, for further reading.)
In addition to classical SNe IIn, over the last two
decades, a new class of SNe that might indicate pres-
ence of strong CSI has been discovered (Quimby et al.
2011; Quimby 2012; Gal-Yam 2012). These SNe ex-
hibit luminosities of an order of magnitude higher than
their classical counterparts. These eponymous superlu-
minous supernovae (SLSNe) have observed properties,
such as light curves (LCs) and spectra that cannot be
solely attributed to any of the standard explosion mech-
anisms outlined above. The SLSNe are broadly clas-
sified into two classes – SLSN-I (hydrogen-poor) andRadiation Transport for Interacting Transients with SuperLite 3
SLSN-II (hydrogen-rich) – to which most of the ob-
served SLSNe belong. There is also a class of radioac-
tively powered SLSNe (SLSN-R), which are less com-
mon, but better understood (Gal-Yam 2012). SN 2007bi
is the first well-observed SLSN-R. The enormous lumi-
nosity of this SLSN implies large amount of radioactive
nickel ( >3M⊙, Gal-Yam et al. 2009) as expected from
a full-fledged pair-instability supernova (PISN) model
for very massive stars with initial mass well in excess
of 100 M ⊙(Rakavy & Shaviv 1967; El Eid et al. 1983;
Kasen et al. 2011; Chatzopoulos & Wheeler 2012). One
of the mechanisms among the plausible scenarios that
could explain the observed luminosities of these SLSNe
is the CSI (Moriya et al. 2018). The evidence of CSI
has been observed in the case of luminous SN 2017hcc,
which exhibited narrow emission lines in its spectra like
a classical SN IIn. The late time multi-wavelength ob-
servations of this SNe show evidence of CSI (Chandra
et al. 2022). In rare cases, luminous SNe are observed to
have SN Ia-like features before exhibiting SN IIn trends,
which could be attributed to a WD exploding into dense
CSM. (e.g., SN 2018evt, Yang et al. 2023)
Understanding the nature of the episodic mass-loss as-
sociated with SNe and SLSNe is a challenge. Stars loose
mass throughout their lives in the form of radiation-
driven winds from their surface (de Jager et al. 1988;
Vink et al. 2001). The rate at which the mass is lost de-
pends on the mass and luminosity of the star. The mass-
loss is relatively unimportant in the pre-SN evolution of
the low- and intermediate-mass stars ( ≤10 M ⊙) until the
final stages of evolution. However, in higher-mass stars
(>20 M ⊙), a significant amount of the stellar mass can
be taken away by the mass lost during stellar eruptions
throughout their life. Therefore, the mass-loss is impor-
tant for massive stars in determining the type of the re-
sulting SN explosion. The CSM created by the moss-loss
can come from both radiation-driven winds and episodic
eruptions (Smith 2014). The mass-loss rates in the range
of 10−4to several M ⊙resulting in total CMS mass of
∼0.1 to tens of M ⊙have been inferred form observa-
tions (Branch & Wheeler 2017). The late-phase nuclear
burning (especially Ne/O core-burning) in massive stars
can lead to convectively- driven hydrodynamic waves (g-
modes). Gravity waves and acoustic modes are excited
at the interface of convective and radiative zones. These
waves deposit super-Eddington heat near the surface,
which can drive a appreciable mass-loss under certain
conditions (Quataert & Shiode 2012; Fuller 2017; Fuller
& Ro 2018). Other mechanisms that can drive high
mass loss involve binary interactions leading to common
envelope ejection and binary mergers (Bodenheimer &
Taam 1984; Taam & Bodenheimer 1989, 1991).There are several existing and upcoming astrophysical
transient search projects such as the James Webb Space
Telescope (JWST) and the Wide Field Infrared Survey
Telescope (WFIRST) that will most likely include pri-
mordial transient events in the early universe including
the SN explosions of the first stars. In addition, facilities
such as the Zwicky Transient Facility (ZTF, Bellm et al.
2019) and the Vera Rubin Observatory (formerly known
as LSST; Large Synoptic Survey Telescope, Ivezic et al.
2008) will be discovering up to a million of new transient
events every night.
The prevalence of the role of CSI in many astrophysi-
cal transients necessitates the need for a radiation trans-
port (RT) code that can simulate the emitted spectrum
over the life of the transient under a variety of initial pro-
genitor configurations. While a few codes that include
the necessary assumptions to tackle the CSI regime ex-
ist, most of them are not fully accessible to the pub-
lic and lack several components of physics that are im-
portant in strongly-shocked explosive outflows. In this
paper, we introduce SuperLite , an open–source Monte
Carlo Radiation Transport (MCRT) code that can be
used to model interacting SN and transient spectra for
easy comparison to observations.
In section 2 we summarize the capabilities of other
numerical frameworks that have been used to model in-
teracting SN (Type IIn) spectra, in 3, we describe the
numerical methods adapted in SuperLite and the mod-
ifications made in its parent code SuperNu to enable it
to post-process the non-homologous SN ejecta. In sec-
tion 4, we present results to verify that the code works
as expected in the standard test case scenarios. In sec-
tion 5, we present the results of the spectra produced by
SuperLite and compare it with other codes for several
different SN types including the homologous and non-
homologous velocity profiles. Finally, in section 6, we
discuss the results of the SuperLite code development
along with the upcoming enhancements to the code.
2.REVIEW OF SN RADIATION TRANSPORT
CODES.
There are two distinct approaches to solving the equa-
tions of radiation transport – the deterministic approach
and the Monte Carlo approach. Both approaches have
their advantages and disadvantages (see Castor 2004, for
further reading). In the deterministic approach a full or
partial set of radiative transport equations are solved by
discretizing them into coupled system of algebraic equa-
tions. These methods can prove to be computationally
very inefficient for large systems and have limited par-
allel scalability (Abdikamalov et al. 2012).4 Wagle et al.
In the Monte-Carlo (MC) methods, the radiation
transport equations are not solved directly as is done
with the deterministic methods. Instead, the trajecto-
ries of a number of packets of particles such as photons
or neutrinos (referred to as MC particles or MC packets
or MCP) are calculated stochastically using probability
distribution functions (PDF) and pseudo-random num-
bers. Each MC particle represents a number of physical
particles. Therefore, the number of MC particles re-
quired for calculations is much less than the number of
physical particles they represent. The individual MC
particles propagate seemingly randomly, but the ensem-
ble of MC particles can provide an accurate representa-
tion of radiative transport process and the evolution of
the radiation field. The biggest disadvantage of using
MC methods is the stochastic fluctuations in the results
of the MC calculations, due to its probabilistic nature.
The MC methods suffer from MC noise, which roughly
scales with the number of MC particles as N−1/2(Ab-
dikamalov et al. 2012). Thus one must use a large num-
ber of MC particles for better statistics, and hence, a
better signal-to-noise ratio (SNR).
Nevertheless, the MC particles can be decoupled and
propagated independently, similar to the physical pho-
tons they represent. The number of MC particles is
constrained by the computer memory and processing
power, but with the modern high-performing computing
systems this problem can be easily overcome with paral-
lelization of the code. The computational cost increases
further in the regions of high optical thickness. Special
techniques need to be applied in the diffusion regime to
overcome this issue (see Noebauer & Sim 2019, for a
review of advanced MC techniques). A significant ad-
vantage of MC methods is that the scattering processes
are easy to implement, compared to the deterministic
methods discussed above. The propagation direction of
the scattered particle can be chosen from a PDF con-
structed from the scattering kernels (Abdikamalov et al.
2012). In addition, MC methods are less susceptible to
numerical errors and are easy to extend to multidimen-
sional time-dependent problems (Noebauer & Sim 2019;
Kasen et al. 2006). Therefore, the MC methods can be
more advantageous for large and complicated systems,
such as explosive and interacting outflows.
The numerical frameworks that simulate the evolu-
tion or the radiation properties of the gas ejected dur-
ing a SN explosion rely on several simplifying approx-
imations; the most common being the assumption of
homologous expansion of the ejected material ( v∝r),
the LTE conditions, and the Sobolev approximation for
line opacity (Sobolev 1960). (These approximations are
discussed further in section 3). For more common SNexplosion types, such as SN Ia and SN IIP, these approx-
imations yield LCs and spectra that are well in agree-
ment with observations (Branch & Wheeler 2017). In
the case of the CSI, most of these assumptions break
down; more specifically that of homologous expansion
of the ejecta and LTE. The Sobolev approximation also
breaks down as a result of the non–homologous expan-
sion of the shocked SN ejecta and CSM, since the line
interaction surfaces are not parallel planes anymore (Ry-
bicki & Hummer 1978). To reliably produce the outcome
in such cases, the hydrodynamic step has to be solved
and the quantities need to be evaluated at each time step
before the transport step is performed (Roth & Kasen
2015; Noebauer & Sim 2019).
There are codes that use numerical approaches to
solve for the time-dependent non-equilibrium radiation-
hydrodynamic (RHD) evolution of the SN ejecta, e.g.,
STELLA (Blinnikov & Bartunov 1993; Blinnikov et al.
1998; Blinnikov & Sorokina 2004; Blinnikov et al. 2006),
which uses a radiation intensity moments scheme, or
The SuperNova Explosion Code ( SNEC, Morozova et al.
2015), which uses flux-limited diffusion approximation.
Both SNEC and STELLA are 1-D, multi-group RHD
codes that evolve the radiation field to predict bolo-
metric SN light curve. They calculate the ionization
and excitation level populations of limited number of
species in LTE conditions. SNEC imposes the same ra-
diation and matter temperatures, while STELLA does
not treat radiation in equilibrium with matter. Codes
such as SEDONA (Kasen et al. 2006) use MCRT meth-
ods to produces SN light curves, spectra, and polariza-
tion. SEDONA is a multidimensional, multi-frequency
code that uses expansion opacity approximation. It also
assumes that the ejecta are in homologous expansion.
Roth & Kasen (2015) have coupled the MCRT code to
1-D, non-relativistic RHD solvers. These codes rely on
simplifications, such as a single grey opacity or a limited
number of groups, to speed up the calculations. They
are useful in providing the general emission properties
and model light curves, but they cannot predict a re-
solved spectrum that includes the effects of line emis-
sivity and opacity. Some of the other popular publicly
available RHD codes include HERACLES (Gonz´ alez et al.
2007), FLASH (Dubey et al. 2012; Fryxell et al. 2000),
andCASTRO (Zhang et al. 2011, 2013).
There exist codes that predict a synthetic spectrum by
solving the radiation transfer equations such as CMFGEN
(Hillier & Miller 1998; Hillier & Dessart 2012), SYN++
(Thomas et al. 2011), or by using MC techniques like in
the case of TARDIS (Kerzendorf & Sim 2014), SuperNu
(Wollaeger et al. 2013; Wollaeger & van Rossum 2014),
and PHOENIX (Hauschildt 1992; Hauschildt & BaronRadiation Transport for Interacting Transients with SuperLite 5
1999, 2004; van Rossum 2012). TARDIS and CMFGEN
are 1-D, MC codes that post-process the hydrody-
namic profiles, and they are computationally inexpen-
sive compared to the RHD codes that involve time-
dependent calculations. SYN++ is also a 1-D code that is
a modern C++version of parametrized spectral synthesis
code SYNOW (Synthesis Now , Branch et al. 2009; Fisher
2000) that can be used for rapid analysis of SN spec-
tra. SuperNu is a time evolution code that advances
the radiation field in each iteration. TARDIS ,SYN++ ,
and SuperNu all assume homologous expansion of the
ejecta while implementing the radiation transport and
for opacity and Doppler shift calculations. A comparison
of RT codes performed by a collaboration of ten groups
around the world that are developing existing RT codes
is discussed in great detail by Blondin et al. (comprehen-
sive supernova radiative-transfer code-comparison ini-
tiative; StaNdaRT, 2022). The TARDIS code assumes
that the effective photosphere is external to the volume
in which a majority of luminosity is generated, which
only holds true for early epochs of SNe Ia (Kerzendorf
& Sim 2014).
Table 1 summarizes the capabilities of some of the
most frequently cited codes that have been used to
model SN spectra and of our new, open–source code
SuperLite that we introduce in this paper.
3.NUMERICAL METHODS
SuperLite is a multigroup radiative transport code
that uses Implicit Monte Carlo (IMC, Fleck & Cum-
mings 1971) and discrete diffusion Monte Carlo (DDMC,
Densmore et al. 2007, 2008, 2012) methods to model ra-
diation transport processes in explosive and interacting
outflows. IMC solves the radiation transport equations
semi-implicitly by treating absorption and emission as
instanteneous effective scattering as explained in Fleck
& Cummings (1971). The DDMC method is used to
optimize IMC where local cell optical depth is higher
than the user-specified value, to speed-up the calcula-
tions by treating several low mean-free-path scattering
events with single diffusion events (see, for instance, Ab-
dikamalov et al. 2012). SuperLite is developed by sig-
nificantly modifying the “parent” SuperNu code and by
relaxing some of its original assumptions that do not
hold for outflows affected by shocked regions due to
CSI. SuperLite is a time-independent code that uses an
Eulerian grid for MCRT simulation. The MC particle
properties are mapped into the lab frame and advanced
by the lab-frame form of Equation (1) (see, for instance,
Wollaeger et al. 2013, equation 1). The co-moving frameenergy of the particle is conserved during each interac-
tion. The opacity calculations are performed in the co-
moving frame, by discretizing opacity into groups via
direct integration over co-moving wavelengths. As an
input to the SuperLite simulation, the spatial coordi-
nates, velocity, temperature, and mass/density profiles
are derived from a hydrodynamic or a RHD simulation
at any given time since the SN explosion from an ex-
ternal code (such as STELLA). The outflow structures
obtained from RHD simulations have the benefit of pos-
sessing implicit time-dependence in the temperature and
material profiles. The SuperLite simulation itself is
done in steady–state and is therefore time-independent.
SuperLite assumes that the information about the ra-
diation field is fully taken into account by the radia-
tion temperature structure predicted by the RHD pro-
files that are used as input. Hence, the radiation energy
deposited into the spatial grid cells due to the radioac-
tive decays of56Ni or56Co is not implicitly re-added. In
effect, SuperLite is a two-temperature code. The radi-
ation temperature, Tris assumed to equal to electron
temperature, Te, ifTris not known a priori.
3.1. Nonhomologous expansion
In the absence of CSI, the SN ejecta outflows are in
a state of near free-expansion after the initial shock-
breakout phase. Hence, at any given time after the ex-
plosion, the radial distance of a particular layer of the
ejecta from the center of the expansion can be found
if the velocity profile at any other time during the ex-
pansion is known. In other words, the radial distance
of a layer of SN ejecta at any given time ‘ t’ since the
explosion, r(t), can be given by a simple relationship,
r(t) =vt. This relationship also simplifies other quan-
tities such as the divergence of velocity at time t, that
becomes ⃗∇ ·⃗ v(t) = 3 /t, and the density decreases with
time as ρ(t)∝t−3. This is the standard assumption
of homology which is hard-wired into many SN spectral
synthesis codes, as discussed in section 2. In the case of
shocked ejecta due to CSI, the assumption of homolo-
gous expansion fails as the velocity profile is nonhomol-
ogous in the entire region between forward and reverse
shocks. In SuperLite , the equations of radiation trans-
port are used in their original form without assuming
homologous expansion, as discussed in sections 3.2 and
3.4.
3.2. Steady-state approximation
The Implicit Monte Carlo (IMC) equation in comov-
ing frame, with assumptions for semi-relativistic simpli-
fications from Castor (2004); Wollaeger et al. (2013), is
written as:6 Wagle et al.
Table 1. Physics and approximations in some commonly used SN Radiation Transport codes.
Code RT post- Homologous Ionization & Line Geometry Parallel Open
Method processing Expansion Excitation Opacity, κν Processing Source
(1) (2) (3) (4) (5) (6) (7) (8) (9)
SuperLite MC Yes No LTE(T e) CMF κν 1-D MPI/OpenMP Yes
SuperNu MC No Yes LTE(T e) CMF κν multi-D MPI/OpenMP Yes
CMFGEN RTE - CMF Yes No dn/dt CMF κν 1-D – Partly
TARDIS MC Yes Yes dilute-LTE(T r) Sobolev 1-D – Partly
SEDONA MC No Yes LTE(T e) Expansion multi-D MPI/OpenMP Partly
STELLA RH-MG No No LTE(T e) Expansion 1-D – Partly
SYN++ RTE - CMF Yes Yes LTE(T x) Sobolev 1-D MPI/OpenMP Yes
Note —Column headings: (1) Name of the code. (2) The numerical method used radiative transfer equation – MC: Monte
Carlo, RTE-CMF: Radiation Transfer equation, Co-moving Frame, RH-MG: multi-group radiation hydrodynamics. (3) If the
code post-processes the profiles or takes time-steps and evolve the profiles. (4) Whether or not the ejecta are assumed to be
in homologous expansion ( v=rt) in the code. (5) The method used to calculate ionization and excitation level populations.
In LTE treatment, the Boltzmann excitation formula is used for excitation level populations and Saha-Boltzmann equation
is used for ionization stage population, with setting the temperature to either the electron temperature (T e) or the radiation
temperature (T r).SYN++ uses user-specified temperature for local thermodynamic equilibrium (LTE). TARDIS uses dilute-LTE
treatment as an approximation to non-LTE (NLTE) by using a dilution factor Wto scale the excitation level population. In
NLTE, the rate equations are solved using the time-dependence on level populations ( dn/dt ). In a steady-state case, dn/dt =0.
Currently, we are testing the NLTE for bound-bound opacity for hydrogen lines in SuperLite , which will be part of our future
publications. (6) Line opacity calculations can be performed line by line explicitly in the co-moving frame (CMF) or by using
the Sobolev approximation or by using an approximate frequency-dependent ‘expansion’ opacity. (7) Available geometry. The
2-D and 3-D geometries are not being completely implemented and tested for SuperLite , hence, these are not part of the current
version. However, the code is easily extendible to higher dimensions, and it will be part of our future publications. (8) The
optional Message-Passing Interface (MPI) and OpenMP framework for parallel processing to speed-up the calculations. (9)
All of the codes presented here have a public version available, but some codes do not include all of the methods and physics
implemented in the code in their public versions. For example, the nonhomology and/or the NLTE applications for SEDONA ,
TARDIS , and CMFGEN are present in the literature, but the code is not publicly available in its entirety.
1
cDIν
Dt+ˆΩ· ∇Iν−ˆΩ· ∇⃗ v·ˆΩ
cν∂Iν
∂ν+3ˆΩ· ∇⃗ v·ˆΩ
cIν−
1
cˆΩ· ∇⃗ v·
I−ˆΩˆΩ
· ∇ˆΩIν+σIν
=1
4πσeb
σP,e(1−f)Z Z
σ′I′
νdν′dΩ′+1
4πfσbacT4
+1
4πσeb
σP,e(1−f)˙Q ,(1)
where cis the speed of light, ais the radiation con-
stant, tis time, Iνis radiation intensity, ˆΩ is photon
direction, νis photon frequency, σis opacity (assumed
to be only absorption here), σeis the emission opacity,
σP,eis the Planck mean emission opacity, ˙Qis a source
term (for instance, a radioactive decay energy rate), bis
the normalized Planck function given by
b(ν) =15
π4h
kT(hν/kT )3
ehν/kT−1, (2)
where, Tis temperature, and fis the Fleck factor (Fleck
& Cummings 1971), given by
f=1
1 + 4 aT3cσP,e∆t/CV, (3)with CVbeing the material heat capacity at constant
volume. Here ∆t is the physical time-step size, which
can be arbitrarily chosen as noted by Kerzendorf & Sim
(2014). The terms on the left-hand side of equation (1)
from left to right are the Lagrangian time derivative,
spatial streaming operator, Doppler shift, adiabatic ef-
fect, directional aberration, and intensity attenuation
from absorption, respectively (see, for instance Castor
2004). The terms on the right-hand side are the ef-
fective scattering source (absorption instantly followed
by emission), thermal emission (reduced by the amount
treated with effective scattering), and any sources of en-
ergy in ejecta (again, radioactive energy), respectively
(Fleck & Cummings 1971).
In the steady state approximation, we can modify
equation (1) by neglecting the local time derivative and
setting ∆ t→ ∞ , while preserving O(v/c) effects. For
infinite time-step size,
lim
∆t→∞f= 0. (4)
Under these assumptions, equation (1) becomesRadiation Transport for Interacting Transients with SuperLite 7
⃗ v
c· ∇Iν+ˆΩ· ∇Iν−ˆΩ· ∇⃗ v·ˆΩ
cν∂Iν
∂ν+3ˆΩ· ∇⃗ v·ˆΩ
cIν−
1
cˆΩ· ∇⃗ v·
I−ˆΩˆΩ
· ∇ˆΩIν+σIν
=1
4πσeb
σP,eZ Z
σ′I′
νdν′dΩ′+1
4πσeb
σP,e˙Q . (5)
The right-hand side of equation (5) implies that all pho-
ton collisions result in effective scattering, i.e., no MC
packets are absorbed, hence conserving the co-moving
frame energy of the packets as mentioned before. Each
scattered particle is emitted with a new propagation di-
rection. Effectively, all MC particles escape the domain
as flux particles. For each particle that enters the inner
boundary of the domain, a new particle with equal en-
ergy is generated with a random outward propagation
direction at the inner boundary to conserve co-moving
energy. For IMC, with these additional assumptions, the
treatment of most of the terms remains the same; parti-
cle Lorentz transforms take care of O(v/c) terms in the
equation. The updated DDMC treatment is discussed
in section 3.4.
3.3. Sourcing of MC particles
The MC particles are sourced in each spatial cell ac-
cording to the amount of radiation energy contained
within the cell based on the input profile. As men-
tioned earlier, it is assumed that the energy deposition
by radioactive decay has been already taken into ac-
count in the radiation field by the hydrodynamics code
from which the profile is imported. Thus, the radioac-
tive decay term is not separately added to the energy
source for the particles.
In the TARDIS code (Kerzendorf & Sim 2014, their
Equation 10), particles are sampled on an inner surface
with radius riand temperature Ti, and the energy per
particle, for Nparticles, is
E=4πr2
iacT4
i
4N∆t. (6)
Assuming the radiation temperature is known, similar
to equation (6), particles can be sourced in each spatial
cell with energy Ejat a surface with cell-centered radius
rjgiven as,
Ej=4πr2
jaT4
r,jVj
4Nj˜∆t , (7)
where Tr,jis the radiation temperature in cell j. Here,
we have used ˜∆tto indicate individual particle’s to-
tal propagation time to distinguish from the simulationtime-step size ∆ t, that is taken to be infinite. The bolo-
metric luminosity is computed as:
L=1
˜∆tNpX
pEp, (8)
where pis an index for escaped particles, Npis the total
number of escaped particles, and Epis the energy weight
at escape. Initializing particle weights with equation (7)
and using the particle initialization sampling procedures
for each cell “surface” described, the result for Lis in-
dependent of ˜∆t. However, this is only true under the
assumption that particle propagation is independent of
˜∆tas well. To make SuperLite truly time-independent,
we use the “luminosity” weights, Lj=Ej/˜∆tinstead
of equation (7) to instantiate the MC particles in each
cell. This effectively eliminates the choice of arbitrary
time-step size, which should not affect the results of the
simulation. To ensure that the total output luminosity
is equal to the user-input bolometric luminosity, the sum
of the luminosity weights of all of the MC particles in
all of the spatial cells is set to be equal to the user-input
bolometric luminosity. As there is no loss of energy, the
total output luminosity predicted by SuperLite remains
unchanged.
The initial frequency of the particles is sampled with
the normalized blackbody distribution given by equation
(2). The particles are evenly distributed in the zone with
the initial direction cosine µ=√r, where r∈(0,1] is
a random number uniformly distributed in the interval
from 0 to 1.
3.4. Particle propagation and Doppler correction
The particle propagation is tracked through the trans-
port (IMC) and diffusion (DDMC) steps. In the IMC
step, the distance traveled by the packet, dp, is
dp= min( dB, dthm, dcol, ddop), (9)
where dBis the distance to the nearest cell boundary,
dthmis the Thompon scattering distance, dcolis the dis-
tance to effective scattering resulting from collision be-
tween a MC particle and an atom or an ion, and ddopis
the distance to the Doppler shift to the adjacent upper
or lower group, based on the divergence of velocity in
that cell. As stated earlier, all collisions result in effec-
tive scattering. As the particles propagate, the position,
frequency, and direction of propagation of the particle
is updated. In 1-D spherical geometry, the particle’s ra-
dial coordinate, rpand the component of the direction
of propagation along the radial direction, µp= ˆrp·ˆΩp
are updated as follows:
r′
p=q
r2p+d2p+ 2µprpdp
µ′
p= (µprp+dp)/r′
p.(10)8 Wagle et al.
Here, r′
pandµ′
pare particle’s updated radial coordinate
and the component of propagation direction along the
radial coordiante, respectively.
The distances in equation (9) are given by Wollaeger
et al. (2013, spatial distance is used here instead of “ve-
locity” distance)
dB=

((r2
i−1/2−(1−µ2
p)r2
p)1/2+µprp),
ifµ <−p
1−(xi/x)2
((r2
i+1/2−(1−µ2
p)r2
p)1/2−µprp),
otherwise(11)
where, ri−1/2and ri+1/2are the left and right cell
boundaries for a cell with index “ i”, respectively (with
i∈[1...n],nbeing the maximum number of spatial
cells), and
dthm/col =|lnr|/σthm/col . (12)
Here, the form of the equation remains the same for
the Thomson scattering distance and the distance to
collision event. σthmis the lab-frame Thomson scat-
tering opacity and σcolcontains the lab-frame opacity
contributions detailed in section 3.5.1. We generalize
the formula for distance to Doppler shift, ddop, between
groups to non-homologous flows. The equation to find
this distance is derived from invariance of frequency in
thev= 0 frame (lab frame),
νp=ν(0)
p
(1−µpv(rp)/c)=νg±1/2
(1−µ′pv(r′p)/c), (13)
where µ′
pandr′
pare given by equation (10). We assume
that within a spatial cell, the radial velocity is linear
with respect to radius,
v(rp) =mi(rp−ri−1/2) +vi−1/2=mirp+ ˜vi,(14)
where mi= (vi+1/2−vi−1/2)/(ri+1/2−ri−1/2) is the
slope of velocity across the radial domain of cell iand
˜vi=vi−1/2−miri−1/2. We define a new inertial frame,
the ˜viframe, to evaluated ddop. In this frame, the in-
variance is
˜νp=ν(0)
p
(1−˜µp(v(rp)−˜vi)/c)=νg±1/2
(1−˜µ′p(v(r′p)−˜vi)/c),
(15)
where ˜ νpand ˜µpare the frequency and radial direction
component in the new frame of reference, relating to the
comoving frame, to order v/c, via
˜νp=ν(0)
p(1 +µ(0)
p(v(rp)−˜vi)/c), (16a)
˜µp=µ(0)
p+ (v(rp)−˜vi)/c
1 +µ(0)
p(v(rp)−˜vi)/c. (16b)Similar to the lab frame, in the ˜ viframe ˜ µpand ˜νpare
invariant. Moreover, ˜ µpand ˜νpcan be found from the
lab or comoving frame using Eqs. (16). Furthermore, as
in the lab frame, relating the initial and final ˜ vi-frame
direction components, ˜ µ′
pr′
p= ˜µprp+ddop, we find the
distance to Doppler shift is
ddop=c
mi
1−νg±1/2
˜νp
−˜µprp
=c
mi
1−˜µp(v(rp)−˜vi)
c−νg±1/2
˜νp
=c
mi˜νp
ν(0)
p−νg±1/2
.(17)
We see that for homologous flow mi= 1/tand ˜vi=
0, hence the ˜ viframe becomes the lab frame and Eq.
(17) becomes the distance to Doppler shift presented
by Wollaeger et al. (2013). Importantly, this equation
for Doppler shifting encodes redshifting based on the
sign of the radial velocity gradient, mi, which can be
seen by examining the right side of the third equality.
Given νg+1/2< ν(0)
p< νg−1/2(decreasing group index
implying increasing frequency), if mi<0, then νg±1/2=
νg−1/2to give ddop>0, corresponding to blue-shifting.
Similarly, if mi>0, then νg±1/2=νg+1/2to give ddop>
0, corresponding to red-shifting. When mi= 0, there
is no radial velocity differential across the cell, so the
distance is infinite, meaning the particle frequency does
not shift toward either group boundary in the comoving
frame.
Since ˜ viis artificial, it is possible that |v(rp)−˜vi|vio-
lates the O(v/c) approximation, and can even be greater
than c. In these instances, at least, a direct numerical
solution for ddopcan be obtained using Newton-Raphson
iteration, where the variable that is iteratively updated
isddop. We define the function φas follows,
φ(s) =miµprp−c
1−νg±1/2
νp
+˜viµ′
p(s)+mis .(18)
By construction, φ(ddop) = 0. The derivative of Eq. (18)
is
dφ
ds= ˜vidµ′
p
ds+mi= ˜vi(1−(µ′
p(s))2)
r′p(s)+mi,(19)
where use has been made of a standard identity for the
path-derivative of µp(s). Introducing a convergence tol-
erance εtol, the Newton-Raphson iteration proceeds as
follows.
1. Estimate an initial value of s=s0.
2. While |sk−sk−1|> skεtol, for iteration k:Radiation Transport for Interacting Transients with SuperLite 9
(a) Evaluate r′
p(sk) and µ′
p(sk) using Eqs (10)
(replacing dpwith sk).
(b) Evaluate Eqs. (18) and (19) using s=sk,
r′
p(sk), and µ′
p(sk).
(c) Calculate next iteration value:
sk+1=sk−φ(sk)
dφ
ds
s=sk
(d)k+ 1→k
3. Set ddop=sk, where skis the final iteration.
We adopt this method to calculate the Doppler distance
inSuperLite .
For DDMC, the energy loss due to Doppler shift is de-
termined by the time-step size, which is infinite (or un-
defined) as discussed in section 3.2. This choice would
imply that the energy should be redshifted to 0, which
is obviously incorrect. To best match the impact of de-
tailed Lorentz transformations in the IMC portions, the
DDMC particle’s time-of-flight in a spatial cell can be
used, with energy loss begin determined by (see, e.g,
Wollaeger et al. 2013),
E′=Ee−∇·⃗ vi·δtk/3, (20)
where δtkis the time spent by the particle in cell jon
MC step k. Note that the equation simplifies to the
standard approach of Wollaeger & van Rossum (2014)
when the flow is homologous, ∇ ·⃗ vj= 3/tfor all j. To
see this, if the time step ∆ tis re-imposed,
X
kδtk= ∆t, (21)
so,
E(f)
p=E(i)
pY
ke−δtk/t=E(i)
pe−∆t/t, (22)
where E(i)
pandE(f)
pare initial and end-of-time-step par-
ticle weight, respectively. For both IMC and DDMC,
in steady state, non-Doppler adiabatic loss from expan-
sion is assumed to have been taken into account by the
pre-existing values of radiation temperature in each cell,
Tr,j.
The spatial leakage opacity formulation for DDMC fol-
lows Wollaeger & van Rossum (2014), where optically
thick groups are regrouped (or collapsed) into single
groups in order to optimize the simulations, by minimiz-
ing the direct treatment of line-to-line effective scatter-
ing. However, we depart from previous DDMC formu-
lations by developing a novel approach to Doppler shiftfrom discontiguous groups in non-homologous flows. In-
tegrating the diffusion equation over the subset of groups
to collapse into DDMC, assuming a Planck function
Ansatz for frequency dependence within the resulting
DDMC group, for a leakage opacity for leaking from
the single DDMC group to one of several adjacent IMC
groups via Doppler shift, we obtain
σdop=

∇ ·⃗ vi
3cbGDX
g∈δG+
D(νb)|g+1/2if∇ ·⃗ vi>0,
−∇ · ⃗ vi
3cbGDX
g∈δG−
D(νb)|g−1/2if∇ ·⃗ vi<0,
(23)
where subscript GDis the subset of groups collapsed
into one group for DDMC, denoting integration over the
subset, δG±
Dis the subset of groups of the DDMC sub-
set that are adjacent to IMC groups, either at the long
(+) or short (-) wavelength side of the DDMC group. If
Doppler shift is sampled in DDMC from the discrete
probability distribution formed by equation (23) and
the other standard leakage opacities, then the partic-
ular group edge in δG±
Dthat the particle escapes from
is sampled from the discrete probability formed by the
values ( νb)|g±1/2.
3.5. Opacity and Emissivity Calculations
3.5.1. Local Themodynamic Equilibrium
Thermodynamic Equilibrium (TE) describes an equi-
librium state of interaction between gas and the radia-
tion field – a state where the radiation field is described
by the Planck’s law and the level populations by Saha-
Boltzmann equations. Both of these are determined by
the same state variable, the local temperature T, and
the equilibrium state is described as the Local Thermo-
dynamic Equilibrium (LTE). From microscopic point-of-
view, in state of LTE, all atomic processes are in detailed
balance, i.e., the number of atomic processes is balanced
by the exact same number of inverse processes. We fol-
low the same method as in SuperNu to determine the
ionization balance and excitation level populations in
each cell based on the LTE conditions. The Saha ion-
ization equation (see Hubeny & Mihalas 2015) is:
n0,j+1,k
n0,j,k∗
=2
ne2πmekBTe
h23/2g0,j+1,k
g0,j,k
exp−ϵIjl
kBTe
, (24)
where, n0,j,kis the number density of the ground state
population of an ion with net charge jfor a chemical10 Wagle et al.
species k. The asterisk ‘ ∗’ on the RHS of equation (24)
implies LTE. neis the number density of the electrons,
andg0,j,kis the statistical weight of the ground state of
stage jandϵIjkis the ionization energy of stage j.Te
is the electron temperature and the other symbols have
their usual meanings.
The number density (originally “occupation number”)
(or population) of a particular excited state iin ioniza-
tion stage jcan be determined using the Boltzmann
excitation equation, once the ground-state populations
have been calculated, i.e.
n∗
ijk=CInen∗
0,j,k
T3/2gijk
g0,j+1,k
expϵIjk−ϵijk
kBT
,
(25)
where, ϵijkis the energy of excited level i, and
CI=1
2h2
2πmekB3/2
. (26)
By summing equation (25) over all levels within an
ion stage, the total ion number density of successive ion
stages can be obtained from the Saha-Boltzmann equa-
tion,
Nj,k
Nj+1,k∗
=CIne
T3/2Uj,k
Uj+1,k∗
expϵIjk
kBT
,(27)
where, U∗
j,kis a LTE partition function. The following
relationship between the ground state number density
n∗
0,j,kand the total number density Njkis also used:
N∗
j,k=n∗
0,j,k
g0,j,kU∗
j,k. (28)
Equation (27) is solved iteratively in SuperLite to de-
termine the ionization populations and the electron den-
sity, until a desired accuracy is reached.
The line opacity is calculated, under the assumption
of LTE, for the transition from a lower level lto an
upper level mfor within an ionization stage jof chemical
species k(dropping the subscripts jandk) as
κ∗
l→m=n∗
lπe2
mecfl→m
ϕν
1−exp
−ϵl→m
kBT
,
(29)
where, fl→mis the oscillator strength and ϵl→mis the
corresponding transition energy. The symbol ϕνrepre-
sents the line profile function, which is set to a delta
function in SuperLite as in SuperNu . The factor in
square brackets represents the effect of stimulated emis-
sion. The line emissivity is calculated under the LTE
assumption from Kirchhoff’s law:
η∗(ν, T) =κ∗(ν, T)B(ν, T), (30)where, B(ν, T) is the Planck function.
InSuperLite , the opacities are computed under the
LTE assumption using a subgroup structure, as ex-
plained in Wollaeger & van Rossum (2014). We in-
clude the atomic data for elements up to atomic num-
berZ= 30. The opacity contributions include bound-
bound (b-b), bound-free (b-f) and free-free (f-f) tran-
sitions, as well as standard elastic Thomson scattering
opacity. The line opacities (b-b opacities) are calculated
using the oscillator strength data for each atomic species
using the Kurucz line list1. The data used in SueprLite
includes hundreds of levels of each species with about
786,000 transitions in total. The b-f opacities are cal-
culated using the analytic fit prescription described by
Verner et al. (1996) and the f-f opacities are calculated
using the Gaunt factors based on the work of Suther-
land (1998). The total absorption opacity is the sum
of the bound-bound, bound-free, and the free-free con-
tributions for each subgroup. The wavelength groups
have logarithmic spacing, while the subgroups have uni-
form linear spacing, unless otherwise specified. It is also
possible to include a custom grid for the groups. The
opacity mixing control parameter ασ∈(0,1] introduced
by Wollaeger & van Rossum (2014) is also included to
linearly combine reciprocal (“Rosseland type”) and di-
rect averages of opacity. The Planck-averaged opacity
is calculated using the total absorption opacity. The
Rosseland mean opacity includes the scattering contri-
bution as well. However, the Rosseland mean opacity
is calcualted only for output in the LTE version of the
code.
3.5.2. Non-Local Thermodynamic Equilibrium
The assumption of statistical equilibrium holds true
if the statistical timescale is much shorter than the
timescale over which the radiation field changes. This is
the case for the regions with high optical depths, but by
definition not in the regions that play a role in shaping
the spectrum. As the radiation leaves and reaches the
observer from these regions, the assumption of LTE is
violated. In non-LTE (NLTE) conditions, the detailed
balance between excitation and de-excitation processes
may be broken, leading to non-thermal populations of
energy levels. To determine the level populations and
ionization state of the gas, a complete set of rate equa-
tions has to solved (Castor 2004; Oelgoetz et al. 2007;
Hubeny & Mihalas 2015). In the matrix form, we can
write these equations as
A·n=b (31)
1http://kurucz.harvard.edu/atoms.htmlRadiation Transport for Interacting Transients with SuperLite 11
Here, the matrix A, which is often referred to as the rate
matrix , contains the radiative rates (R, for interactions
between particles and photons), and the collisional rates
(C, for interactions between two or more particles). The
elements of matrix Afor levels iandjare then:
Aii=X
j̸=i(Rij+Cij), (32)
Aij=−(Rij+Cij), for j ̸=i (33)
nis a vector of level populations, n =
(n1, n2, ..., n NL)T, where NL is the number of lev-
els, and bis the vector of the rate at which a level’s
population changes, dn/dt . In steady-state, dn/dt = 0.
InSuperLite , we have added the NLTE treatment
for calculations of excited level populations of hydro-
gen up to the principle quantum number, n = 10. We
use the quasistatic approximation that the ionization
balance can be decoupled from the excited-state popu-
lation calculation. Furthermore, we assume that most
of the population is in the ground state of the neu-
tral and singly charged ion stages of hydrogen. The
majority of the population flow between the two ion
stages via ionization and recombination processes will
occur through transitions that connect the ground states
of the two ionization stages of hydrogen (rather than
via processes that involve excited states), due to their
massive populations relative to the excited-state popu-
lations. This dominant flow of population via ioniza-
tion/recombination processes is, to a very good approx-
imation, encapsulated within the prescribed ionization
balance values defined by the LTE Saha ionization equa-
tion (24). Therefore, we do not consider the effect of
ionization/recombination processes on the two ground
states, but only on the processes that effect the excited-
state populations. We solve the rate matrix to find the
excited state populations of hydrogen, with an addi-
tional condition that the sum of ground- plus excited-
state populations equals the ionization state population,Pni=N. The first row of the Ais replaced with
1’s and the bis set to ( N,0,0, ...,0), to reflect this
boundary condition. To calculate the rate matrix we
have included photo-ionisation and radiative recombi-
nation, and electron-impact collisional excitation and
de-excitation rates calculated with the Los Alamos Na-
tional Laboratory (LANL) suite of atomic physics codes
(Fontes et al. 2015). The b-b line opacity and line
emissivity are calculated using equations (14.12a) and
(14.12b) of Hubeny & Mihalas (2015). In our NLTE
implementation, the b-b opacity for other elements are
calculated under the LTE assumption, as described in
section 3.5.1 The b-f and the f-f opacities, and the Thom-son scattering opacity are also calculated using the same
methods as described in section 3.5.1. The NLTE im-
plementation is still in the testing phase, but some of
the initial model results are displayed in section 5.
4.CODE VERIFICATION
4.1. Line Transport in moving media - homologous
and non-homologous cases
In this section, we present the test carried out to ver-
ify the SuperLite code using the transport of line radi-
ation in a moving media as described in Roth & Kasen
(2015, section 7.2). For this test, we consider an uni-
form density sphere of minimum radius, rmin= 1014
cm and maximum radius, rmax= 1015cm, with uni-
form logarithmic grid of 100 spatial cells. The choice
of density and temperature structures is not important
for this problem. We choose an uniform density of
ρ= 10−11g cm−3and uniform temperature Te= 103
K. In this test case, we have considered the velocity pro-
file to be homologous. For cell “i”, the velocity is given
asvi=vmax(ri/rmax)[cm/s ], where vmax= 108cm/s is
adopted. We instantiate MC packets at the inner bound-
ary of the domain with intensity 1 erg/cm2/s/Hz/sr.
(The choice of the intensity is arbitrary.) The MC pack-
ets are sampled with an uniform frequency distribution
for this verification test. We use 219MC packets for this
test. A logarithmic frequency grid between the energies
of 0.8 eV to 1.2 eV with 200 frequency groups is used.
The line frequency of 1 eV is chosen so that the line is
roughly in the middle of the frequency grid. The line
opacity is calculated as
κν= (dv/dr )∗(τS/c)∗(νc/dνg)
= (dv/dr )∗(1/c)∗(1/dνg)[cm−1] (34)
where, τSis the Sobolev optical depth, which was cho-
sen to be 1 (Roth & Kasen 2015, equations 61). dνg
is the width of the frequency group containing the line
centered at frequency νc= 1 eV. The semi-analytic so-
lution to the emerging line profile is given by equation
60 of Roth & Kasen. As illustrated in Figure 1a, the
spectrum produced by SuperLite is in good agreement
with the semi-analytic solution.
We also compare a version of the analytic solution to
a non-homologous problem, where a wind profile with
a constant velocity value of v= 105cm/s is added to
the homologous profile. The drop to 105cm/s intro-
duces a single spatial cell with a negative velocity gradi-
ent. We attempt to account for this in the semi-analytic
solution by using the homologous intensity solution as
an inner boundary source for the region with the nega-
tive velocity gradient. We test two variants of the non-
homologous problem: one where the line in the negative12 Wagle et al.
gradient cell is purely scattering, as in the homologous
region, and one where the line in the negative gradi-
ent cell is purely absorbing. For the scattering vari-
ant, shown in Figure 1b, a slight enhancement in the
emission and absorption peaks of the P-Cygni profile is
observed for the simulated spectrum, which can be at-
tributed to part of the uncollided flux that is at slightly
lower frequency than the absorption trough edge, which
is getting blue-shifted back into resonance with the line.
However, our analytic solution does not reflect this en-
hancement effect. For the absorption variant, the range
of frequencies corresponding to the absorption trough
happens to also be nearly equal to the range of lab frame
frequencies that resonate with the line in the negative
gradient cell. The analytic solution for this is to sim-
ply attenuate the intensity by e−τSover those frequency
ranges. As expected, for both the semi-analytic solu-
tion and the SuperLite result, in Figure 1c, only the
absorption trough is enhanced.
4.2. Type Ia SN spectra
We verify the results of the snapshot post-processing
with SuperLite by comparing with the results of radi-
ation transfer calculations for time-dependent evolution
of a SN-Ia by the SuperNu code. In the case of SNe
Ia, the SN ejecta homologously expands following the
shock break-out from the surface of a progenitor white
dwarf that exceeds the Chandrasekhar mass. We use the
1D spherically-symmetric w7model of a carbon-oxygen
white dwarf of about 1.37 M ⊙at the time of explosion
(Nomoto et al. 1984), that is included as a test case
within the public version of the SuperNu code (Wollaeger
& van Rossum 2014) and has been used by several other
authors (Kasen et al. 2006; Kromer & Sim 2009; van
Rossum 2012). The input structure includes the den-
sity and abundance profile for several key isotopes up to
56Ni in a velocity grid. The ground- and excited-level
populations are calculated in SuperNu using the LTE
assumptions discussed in section 3.5.1. The model sim-
ulations start at 2 days from the time of explosion. The
outer boundary of the ejecta outflow has a velocity of
expansion about 0.07 times the speed of light. The out-
put spectra is saved by SuperNu at the end of each time
step. We adjusted the SuperNu code to enable the check-
pointing of the SN ejecta profile at regular intervals, as
the time-dependent MC calculations are advancing. The
profile checkpoints include mass, electron temperature,
and mass factions, which we used as inputs for the post-
processing simulation with SuperLite .
For the purposes of this test, we chose to post-process
a profile at 10 days since the time of explosion, near
the time of peak luminosity. The radial coordinates aregenerated using the velocity grid with the relationship
ri=vit, as the expansion in this case is homologous.
Here, “ i” is the cell index and “ t” is the time since ex-
plosion.
The structure imported from SuperNu is shown in Fig-
ure 2. The bolometric luminosity predicted by SuperNu
is used as an input to normalize the total input lumi-
nosity to the SuperLite simulation as described in sec-
tion 3.3. The energy deposition due to radioactive de-
cay processes are not included in SuperLite , as this
energy is already accounted for in the SuperNu simula-
tion. Similar to SuperNu , the opacity calculations are
performed using the LTE assumptions. The electron
temperature is used for both the sourcing of the MC
packets and for the opacity calculations. The simula-
tion input for SuperLite contains 64 spatial cells and
250 wavelength groups between the wavelength range of
1000 and 32000 ˚A, both set to the same values as the
SuperNu model simulation. About a million (220) MC
packets were used for the SuperLite simulation, while
for the SuperNu simulation about 16 million (224) ini-
tial and source MC packets each were used. SuperLite
requires a smaller number of MC packets to obtain the
same level of SNR. This is because, as a single-step,
post-processing code with the steady-state assumption,
all of the instantiated MC packets are processed through
the ejecta. None of the MC packets are either absorbed
(destroyed), censused, or buffered for the next time step
inSuperLite .
Figure 3 shows a comparison between the spectra pre-
dicted by SuperNu at the time step when the output pro-
file was saved at 10 days after explosion with the spec-
tra predicted by the LTE version of SuperLite in right
panel, along with the light curve for the SN generated
bySuperNu in the left panel. Within the uncertainty
of the MC noise, the spectra produced by both codes
are in good agreement. The SuperLite simulation was
completed within five minutes on a typical desktop with
parallel processing using 6 MPI ranks.
4.3. Profile Truncation Depth
In Figure 4, we show the effect of truncation depth
into the ejecta profile on the calculations of spectra by
SuperLite for the w7model. As SuperLite is a post-
processing code, it doesn’t need entire ejecta to process
the spectra. Including the line forming region is suffi-
cient to predict the spectra within the uncertainties of
MC calculations. To demonstrate this, we truncated
the ejecta profile for the w7at different location based
on the optical depth ( τ) calculated using the Rosseland
mean optical depth, and simulated the spectrum using
theSuperLite code for this model. The optical depth isRadiation Transport for Interacting Transients with SuperLite 13
(a)
 (b)
(c)
Figure 1. The result of the test for line transport in a homologously expanding ejecta are shown in the left panel, while that
for the non-homolgous case are shown in the right and bottom panels. Continuum photons are injected into a uniform sphere
containing pure-scattering media with Sobolev line optical depth of τS= 1. The line in the non-homologous region is scattering
(right) or absorbing (bottom). Results from the MC transport are compared to the semi-analytic solution as discussed in section
4.1. Within the uncertainty of MC noise, the modeled spectra compare well with the analytic solution.
set to 0 at the location of the observer at infinity. Thus,
it increases into the ejecta. The left panel of the figure
shows τwith the locations of τ= 100, 50, 10, and 1
marked with vertical lines. The ejecta profile was trun-
cated from the surface inward at these locations into the
ejecta. The right panel of the figure shows a compari-
son for the simulations with different truncation depths.
As seen in this figure, the spectra predicted by the code
remains mostly unaffected until about the truncation
depth at τ= 10 (green, dashed-dotted line). The spec-
tra for τ= 1 (thin cyan line) is significantly different
than the original simulation with the entire ejecta pro-
file (black, solid line). As the optical depth varies with
the frequency of the photon packet, the depth in to theoutflow profile up to the Rosseland mean optical depth
ofτ= 1 is not sufficient enough for correctly predict-
ing all of the transitions. We recommend including the
outflow profile up to a Rosseland mean optical depth of
τ≈30–50 for better prediction of the synthetic spectra.
5.APPLICATIONS TO SUPERNOVA SPECTRAL
MODELING
Here, we present the synthetic spectra produced
with SuperLite post-processing simulations for various
types of SNe including both the homologous and non-
homologous expansion regimes, and compare them with
observations or results from the CMFGEN code.
5.1. Type IIP SN spectra14 Wagle et al.
Figure 2. The velocity, temperature, electron number density, and density profile plots at 10 days since the time of explosion
for the W7SN Ia model.
(a)
 (b)
Figure 3. In left panel, the light curve predicted by SuperNu for the W7SN Ia model is shown. The black dot marks the
luminosity at 10 days since the time of explosion where profile was extracted from the SuperNu simulation for post-processing
with SuperLite. In the right panel, a comparison of spectra at 10 days since the time of explosion produced by SuperNu and
LTE version of SuperLite are shown.
In this section, we present the results of SuperLite
post-processing for two typical SN IIP models and com-
pare the results with the time-evolution simulation per-
formed with SuperNu in one case and to the observations
of a typical SN IIP in the other case.
5.1.1. Model s18.0
For the first case, we use model s18.0 from the suite
of SN IIP model simulations presented by Curtis et al.(2021). The model consists of a star with ZAMS mass
equal to 18 M ⊙and solar metallicity, and a pre-SN mass
of 14.5 M ⊙at the time of explosion, with a 9.25 M ⊙
hydrogen envelope. The pre-SN radius of the progenitor
star is 1010 R ⊙. An explosion energy of 1.45 ×1051erg is
assumed. The SuperNu comparison model corresponds
to 20 days from time of explosion. The velocity profile
is shown in Figure 12 of (Curtis et al. 2021). We use
theSuperNu input files kindly provided by Dr. SanjanaRadiation Transport for Interacting Transients with SuperLite 15
(a)
 (b)
Figure 4. The effects of truncation depth of the ejecta on the predicted spectra are shown. In the left panel, the optical depth
(τ) calculated from the Rosseland mean opacity is shown for the ejecta profile of the W7SN Ia model. The optical depth is set
to 0 at the location of the observer at infinity, so the optical depth increases into the ejecta. The vertical lines in the left panel
mark the location of τ= 100, 50, 10, and 1, respectively, from left to right. In the right panel, a comparison of spectra produced
bySuperLite by truncating the ejecta at different optical depths from the surface inward is shown. The black, solid line shows
the spectrum for the whole ejecta profile. The spectrum remains mostly unaffected up to τ=50 (red, dashed line). It changes
slightly at longer wavelengths for τ=10 (green, dashed-dotted line). However, it changes significantly when the ejecta profile is
truncated at τ=1 (cyan, thin solid line).
Curtis (private communication) to re-run the SuperNu
simulation with the same setup as in their paper. The
SuperNu model was run with 218initial MC packets and
additional 218source packets were added every timestep,
with a maximum limit of 228MC packets. The model
contains 689 spatial cells, and 1000 wavelength groups
with the wavelength range of 1000–32,000 ˚A. Similar
tow7model discussed earlier, we have used a modified
version of SuperNu code that saves SN ejecta profiles
at checkpoints every few days. The profiles from this
SuperNu simulation are used for post-processing with
SuperLite .
For a comparison of the SuperNu output spectra to
that produced with SuperLite in 1D, we choose a phase
corresponding to 20 days after the SN explosion. The
hydrogen recombination front begins to recede into the
H–rich SN ejecta at around 20 days, marking the be-
ginning of the eponymous plateau phase that lasts for
about 104 days (see figure 13 of Curtis et al. 2021). For
the 1-D simulation calculated with SuperLite , we gen-
erate the radial coordinates under the assumption of ho-
mologous expansion, as in the previous case, because
theSuperNu model simulation is run on a homologous
velocity grid. The ejecta was truncated at the Rosse-
land mean optical depth of 100. The model contains
172 spatial cells, and 6000 wavelength groups with the
wavelength range of 1000–30,000 ˚A. This simulation was
run with about a million (220) MC particles is the same
Figure 5. A comparison of spectra produced with the
SuperNu and the LTE version of the SuperLite codes for
a Type IIP model at 20 days since the time of explosion is
shown. The SuperNu spectrum is taken from figure 5 of Cur-
tis et al. (2021). The two spectra are in good agreement with
each other.
as that used in the w7model. The spectra generated
with SuperNu and SuperLite are shown in Figure 5.
The spectrum generated with SuperNu from figure 5 of
Curtis et al. (2021) is superimposed on the SuperLite
spectrum. The SuperNu spectrum is smooted, while the
SuperLite spectrum is not smoothed. The two spectra
are in a good agreement with each other.16 Wagle et al.
5.1.2. A classical SN IIP: SN 1999em
Here, we present a comparison between the synthetic
spectra predicted by SuperLite to the observed spec-
tra for a typical SN IIP, SN 1999em that exploded in
the host galaxy NGC 1637 (Lick Observatory Super-
nova Search Li 1999). Based on the pre-explosion ob-
servations of the progenitor star, Smartt et al. (2002)
derived an upper limit on of 12 ±1 M⊙on the ZAMS
mass of the progenitor star of SN 1999em, assuming a
distance of 7.5 ±0.5 Mpc determined by the expanding
photosphere method (Hamuy et al. 2001). Smartt et al.
(2009) derived an upper limit of 15 M ⊙for the same,
assuming a distance of 11.7 ±1.0 Mpc determined using
the Cepheid variables in the host galaxy (Leonard et al.
2003). Utrobin (2007) performed optical hydrodynamic
model fitting to the bolometric light curve and spectro-
scopic evolution of H αline for SN 1999em to determine
the progenitor properties. With an adopted distance of
11.7 Mpc, their model with solar metallicity and a mass
of 19±1.2 M ⊙for the ejected envelope mass, a pre-SN
radius of 500 ±200 R ⊙exploded with 1.3 ±0.1 Bethe en-
ergy and 0.036 ±0.009 M ⊙of nickel mass fitted well with
observations. For the shorter distance of 7.5 Mpc, their
model with 16 M ⊙of envelope mass, pre-SN radius of
375 R ⊙exploded with 0.686 Bethe energy and 0.0162
M⊙of nickel mass was the best fit model. We do not
intend to fit the observed SN 1999em spectra, but we
use the example of SN 1999em to illustrate the capacity
of our code to model a typical SN IIP spectrum. To
this effect, we use one of the two models of SN 1999em-
like progenitor star explored by Paxton et al. (2018),
which we describe below. The properties of the model
are listed in their table 3.
We evolve a progenitor star with solar metallicity
and ZAMS mass of 19 M ⊙with the stellar evolution
code MESA (Modules for Experiments in Stellar As-
trophysics; Paxton et al. 2011, 2013, 2015, 2018, 2019).
This progenitor star has a pre-SN mass of 17.8 M ⊙,
with a massive H-rich envelope and pre-SN radius of 603
R⊙. The model star is exploded with STELLA (a ver-
sion of the code provided with the MESA distribution),
by injecting energy of 1 Bethe at the base of the enve-
lope and assuming nickel mass of 0.042 M ⊙. The pro-
files are generated at several checkpoints by STELLA.
These profiles include the electron and radiation tem-
peratures, as well as the total bolometric luminosity es-
timated by STELLA. These profiles are used for post-
processing with SuperLite to generate synthetic spec-
tra. For the SuperLite simulation, we choose a phase
corresponding to 40 days since the maximum bolometric
luminosity of the SN. This phase is within the plateau
of the SN light curve. We truncate the ejecta profile
Figure 6. A comparison of spectra produced with the the
LTE and the NLTE versions of the SuperLite code for a SN
IIP model for SN 1999em at 40 days since explosion. The
NLTE implementation is still being tested. The observed
spectra from Faran et al. (2014); Leonard et al. (2002) for
SN 1999em is shown in the background for comparison. The
lightgrey curve shows the observed spectra obtained at 38d
and the grey curve shows the observed spectra obtained at
40d since the peak luminosity.
at the STELLA-predicted optical depth of 100 for the
SuperLite simulation. The input structure contains 154
spatial cells. We choose 6000 wavelength groups with a
range of 1 to 30,000 ˚A. About a million (220) MC parti-
cles are instantiated for the simulation. Figure 6 shows
the spectra predicted by the LTE and NLTE versions of
theSuperLite code. The observed spectra taken at 38
and 42 days since the peak in the light curve of the SN
is plotted in the figure for comparison with SuperLite
prediction. The observed spectroscopic data is obtained
using 1m Nickel reflector at Lick Observatory (Faran
et al. 2014; Leonard et al. 2002). The SuperLite simu-
lation qualitatively predicts the observed line features
with the P-Cygni profiles, with blue-shifted emission
components, and the continuum in that taken at day 38.
However, this observed spectrum extends only to wave-
length of 6800 ˚A. The Ca II feature around 8500 ˚A in
the spectrum observed at day 42 are also well-predicted
bySuperLite code. The observed spectrum at day 42
is not corrected for the effects of dust absorption, while
the model spectra does not take these effects into ac-
count. This explains the differences in the continuum in
the two spectra at the shorter wavelengths.
5.2. Type IIn SN spectra
One of the main motivations behind the development
ofSuperLite was to model the spectra of astrophysical
transients that are affected by strong interaction with aRadiation Transport for Interacting Transients with SuperLite 17
CSM. Toward that end, in this section we present the
first interacting SN spectra simulated with our code.
5.2.1. A classical SN IIn
We construct a model progenitor star for a typical SN
IIn with ZAMS mass of 19 M ⊙with the same specifi-
cations as described in section 5.1.2 for the SN 1999em.
In addition, we append a dense H-rich CSM of 0.2 M ⊙
around the progenitor star that corresponds to a mass-
loss rate of 0.025 M ⊙/yr for 8 years before the core-
collapse stage, with the velocity of the stellar wind set
to 200 km s−1. A power law index of 2 is used to con-
struct the CSM density profile around the progenitor
star. The model progenitor star is then exploded into
the surrounding CSM using STELLA. The explosion en-
ergy of 0.78 Bethe is injected at the base of the envelope.
A total nickel mass of 0.042 M ⊙is used for this simu-
lation. The non-homologous expansion of the SN ejecta
is tracked by the time-dependent RHD evolution. As
earlier, the profiles generated at several checkpoints by
STELLA that include the electron and radiation tem-
peratures, as well as the total bolometric luminosity
are used for the SuperLite simulation. We refer to
this model as A4, and it belongs to a suite of mod-
els that we have explored with STELLA for the inter-
acting SNe. The complete suite of models along with
the post-processed SuperLite simulations will be pre-
sented in a future publication. The profiles generated
by STELLA at 5, 10, 20, and 30 days since the maxi-
mum in the bolometric luminosity are used to run the
post-processing model simulations with the SuperLite
code to generate spectra for the A4 model. In the top
4 panels of Figure 7, velocity, temperature, density, and
velocity gradient profiles that we use as an input for our
post-processing simulations with SuperLite are shown
for each of these phases. The vertical lines show the lo-
cation of the Rosseland mean optical depth of 1. The
optical depth is set to 0 at the location of the observer
at infinity, so the optical depth increases in to the pro-
file. As the time progresses, the photosphere recedes
deeper traversing the shocked region around 30 days.
The bottom 4 panels in Figure 7 show the spectral evo-
lution of the SN ejecta for the A4 model at these selected
phases. The strong and narrow emission lines, especially
the Balmer series lines H αand H βcan be seen in the
spectra. As the ejecta expands and cools down, the con-
tinuum shifts toward longer wavelengths. The spectra
resulting from our experimental NLTE implementation
has also been shown in this figure. The LTE and NLTE
spectra look very similar until 30 days phase, where the
photosphere is traversing the shocked region, where the
LTE assumption breaks.5.2.2. A Luminous SN IIn - SN 2017hcc
We simulated another example of a SN IIn that un-
dergoes stronger CSI. This model is similar to the pro-
genitor of SN 2017hcc that exploded in a spiral dwarf
galaxy of near-solar metallicity at a distance of 73 Mpc
(Tonry 2011). It was classified as a SLSN IIn based on
its peak absolute magnitude of -20.7 mag (Prieto et al.
2017). A RHD simulation of the evolution of SN ejecta
was performed with HERACLES using a progenitor star
similar to that of SN 2017hcc. The profiles at several dif-
ferent checkpoints during the RHD evolution of the SN
ejecta were kindly provided by Luc Dessart, along with
the synthetic spectra predicted by CMFGEN (private
communication). It is an engineered model with 10 M ⊙
ejecta mass and 5.7 M ⊙CSM mass with mass loss of
0.2 M ⊙/year. The radius at the interface between the
ejecta and the CSM at the start of the RHD simulation
is 1015cm. The maximum velocity of ejecta is 16,600
km/s and the velocity of the CSM is 100 km/s. The
RHD calculations with HERACLES do not include the
radioctive decay of56Ni. As the power from interac-
tion is more dominant compared to radioactive decay,
this shall not affect the results. The profiles are trun-
cated at the HERACLES predicted electron scattering
optical depth of 30. Here, we present the results of the
synthetic spectrum produced with SuperLite by post-
processing the checkpoint profile at 36 days from the
time of explosion for this model and compare it with
the same predicted by CMFGEN. The profile consists
for 80 spatial cells. For the SuperLite simulation, 6000
wavelength groups are used in the range of 1 to 30,000 ˚A.
The profiles from HERACLES did not include the ra-
diation temperature, so it was set equal to the electron
temperature in our simulations.
The electron density calculated with SuperLite using
LTE assumption qualitatively matches that predicted
by CMFGEN as shown in the left panel of Figure 8.
In the right panel of Figure 8, the spectrum predicted
bySuperLite using LTE assumption at 36 days since
explosion is compared with that predicted by CMFGEN.
The line ratios in this plot show that the H αline is
comparable in strength to the H βline in the spectrum
predicted by SuperLite , while the H αline is stronger in
CMFGEN spectrum. The differences in the line ratios
and continuum emission can be attributed to the lack of
radiation temperature structure in the input profile, as
well as the LTE assumption. We are actively working
on resolving these discrepancies. We would like to note,
however, that the spectra generated with CMFGEN and
SuperLite are otherwise similar.
6.RESULTS AND CONCLUSIONS18 Wagle et al.
(a)
(b)
Figure 7. In panel (a), the velocity, electron temperature, electron density, and density profiles at 5, 10, 15, and 20 days from
the time of explosion for a SN IIn model A4 are shown. The vertical dashed lines in the velocity plot mark the radial coordinate
of the cell where the Rosseland mean optical depth is 1. As the ejecta expands and cools down, the photosphere recedes into
the shocked region. In panel(b), the spectra produced with the LTE and NLTE versions of SuperLite corresponding to the
same phases are shown. The spectra are normalized to H αline strength for ease of comparison. The NLTE version of the code
is still being tested.
In this paper we have presented the first publicly-
available, Monte Carlo radiation transport code,
SuperLite , that is optimized to compute synthetic spec-tra for astrophysical transients strongly affected by cir-
cumstellar interactions (CSI). SuperLite enables users
to post-process the hydrodynamic profiles of interact-Radiation Transport for Interacting Transients with SuperLite 19
(a)
 (b)
Figure 8. Panel (a) shows a comparison of the electron number density calculated with the SuperLite code under LTE
assumption with the CMFGEN code for a SN IIn model provided by Luc Dessart (private communication), both of which show
a good agreement. Panel (b) shows a comparison of the spectrum produced with SuperLite under LTE conditions (blue) to
that produced by CMFGEN (grey) for the same model. The spectra are normalized to the H αline strength for comparison.
The two codes show a good agreement.
ing transient events with non-homologously expanding
outflows. SuperLite is published2under GNU3 public
license and it is free to use and develop. The SuperLite
code is developed by significantly modifying the existing
SuperNu code (Wollaeger et al. 2013; Wollaeger & van
Rossum 2014). SuperLite uses the multigroup IMC-
DDMC approach with accelerated diffusion theory and
relativistic corrections of the first order. It has Message-
Passing Interface (MPI) and OpenMP capabilities for
parallelization of large grids, which allows faster com-
putations. The code uses standard LTE assumptions to
calculate the opacities in each domain cell that include
the bound-bound opacities for several thousand lines up
toZ= 30 and analytic fits for bound-free and free-
free opacities. The standard elastic Thomson scattering
opacity is also included in the calculations. It has the
following enhancements that distinguish the code from
its parent code and some other publicly-available SN
spectral synthesis codes:
•The commonly used assumption of the SN ejecta
to be homologously expanding (i.e. v∝rat any
given time tsince explosion) is not made in the
SuperLite code. The equations such as the trans-
port equation to advance the MC paricles and the
Doppler shift corrections are solved in their origi-
nal form without assuming homology. This is im-
2https://github.com/gururajw/superliteportant for the outflows affected by CSI where the
assumption of homology breaks.
•We have also implemented and are currently test-
ing the non-LTE treatment for calculating the b-b
opacities for several hundred hydrogen lines using
the rate coefficients that include radiative recom-
bination and photoionization rates, and electron-
impact excitation and de-excitation rates for exci-
tation states of singly ionized hydrogen up to the
principal quantum number of n= 10.
We have tested SuperLite by performing some stan-
dard MCRT tests, as well as, by successfully simulat-
ing spectra for typical SNe of different types as demon-
strated in sections 4 & 5. We have compared the spectra
simulated by our code to that simulated by its parent
code SuperNu for a SN Ia and SN IIP with homologous
outflows. We have also compared the the spectra sim-
ulated by our code for a SN IIP to the observations of
a similar SN, and for a SN IIn to the calculations per-
formed by the CMFGEN code. Our code compares well
with the other codes and observations for these cases.
With SuperLite , we can model a multitude of tran-
sients powered by strong CSI, such as SLSNe, PPISN
shell collisions, collisions with material expelled by a
past merger and can model luminous, rare and uncharac-
teristic transient phenomena. This will help with inter-
pretation of transient events discovered by the current
and next generation high-cadence, wide-field transient
surveys conducted by facilities such as the Vera Rubin20 Wagle et al.
Telescope, ZTF and others by enabing direct compar-
isons to observed time-series of transient spectra.
SuperLite , being a Monte Carlo code, is easily ex-
tendable to work with 2-D and 3-D geometries. We
plan to adapt SuperLite to multi-D in the near future,
which will enable it to model spectra for transient events
interacting with non spherically–symmetric circumstel-
lar environments and help us explore viewing angle ef-
fects. Furthermore, a new implementation that implic-
itly couples a hydrodynamic solver with MCRT will be
introduced to properly model the feedback of radiation
into the expanding material, similar to that presented
by Noebauer & Sim (2019); Roth & Kasen (2015). This
will further enhance the capability of SuperLite as an
open-source radiation transport tool to accelerate the
interpretation of new intriguing transient astrophysicalphenomena that challenge our understanding of extreme
cosmic catastrophes.
We thank Luc Dessart, Sanjana Curtis for kindly pro-
viding us their model inputs to test SuperLite code.
We would like to thank J. Craig Wheeler, Chris Fryer,
Nathan Smith, David Branch for useful discussions. GW
and EC would like to thank the National Science Foun-
dation (NSF) for their support made possible by the
NSF grant AST-1907617.1
2
3
4
5
6
7
Software: SuperNu (Wollaeger et al. 2013; Wollaeger
& van Rossum 2014), STELLA (Blinnikov & Bartunov
1993; Blinnikov et al. 1998; Blinnikov & Sorokina 2004;
Blinnikov et al. 2006), MESA (Paxton et al. 2011, 2013,
2015, 2018, 2019),
REFERENCES
Abdikamalov, E., Burrows, A., Ott, C. D., et al. 2012, ApJ,
755, 111, doi: 10.1088/0004-637X/755/2/111
Alexeyev, E. N., Alexeyeva, L. N., Krivosheina, I. V., &
Volchenko, V. I. 1988, Physics Letters B, 205, 209,
doi: 10.1016/0370-2693(88)91651-6
Arnett, D. 1991, ApJ, 383, 295, doi: 10.1086/170786
Arnett, W. D., Bahcall, J. N., Kirshner, R. P., & Woosley,
S. E. 1989, ARA&A, 27, 629,
doi: 10.1146/annurev.aa.27.090189.003213
Bellm, E. C., Kulkarni, S. R., Graham, M. J., et al. 2019,
PASP, 131, 018002, doi: 10.1088/1538-3873/aaecbe
Bethe, H. A., & Wilson, J. R. 1985, ApJ, 295, 14,
doi: 10.1086/163343
Bionta, R. M., Blewitt, G., Bratton, C. B., et al. 1987,
Physical Review Letters, 58, 1494,
doi: 10.1103/PhysRevLett.58.1494
Blinnikov, S., & Sorokina, E. 2004, Ap&SS, 290, 13,
doi: 10.1023/B:ASTR.0000022161.03559.42
Blinnikov, S. I., & Bartunov, O. S. 1993, A&A, 273, 106
Blinnikov, S. I., Eastman, R., Bartunov, O. S., Popolitov,
V. A., & Woosley, S. E. 1998, ApJ, 496, 454,
doi: 10.1086/305375
Blinnikov, S. I., R¨ opke, F. K., Sorokina, E. I., et al. 2006,
A&A, 453, 229, doi: 10.1051/0004-6361:20054594
Blondin, S., Blinnikov, S., Callan, F. P., et al. 2022, A&A,
668, A163, doi: 10.1051/0004-6361/202244134
Bodenheimer, P., & Taam, R. E. 1984, ApJ, 280, 771,
doi: 10.1086/162049
Branch, D., Chau Dang, L., & Baron, E. 2009, PASP, 121,
238, doi: 10.1086/597788
Branch, D., & Wheeler, J. C. 2017, Supernova Explosions,
doi: 10.1007/978-3-662-55054-0Burrows, A., & Vartanyan, D. 2021, Nature, 589, 29,
doi: 10.1038/s41586-020-03059-w
Castor, J. I. 2004, Radiation Hydrodynamics (Cambridge
University Press)
Chandra, P., Chevalier, R. A., James, N. J. H., & Fox,
O. D. 2022, MNRAS, 517, 4151,
doi: 10.1093/mnras/stac2915
Chatzopoulos, E., & Wheeler, J. C. 2012, ApJ, 748, 42,
doi: 10.1088/0004-637X/748/1/42
Chevalier, R. A., & Fransson, C. 1994, ApJ, 420, 268,
doi: 10.1086/173557
—. 2017, in Handbook of Supernovae, ed. A. W. Alsabti &
P. Murdin, 875, doi: 10.1007/978-3-319-21846-5 34
Chevalier, R. A., Fransson, C., & Nymark, T. K. 2006,
ApJ, 641, 1029, doi: 10.1086/500528
Colgate, S. A., & White, R. H. 1966, ApJ, 143, 626,
doi: 10.1086/148549
Curtis, S., Wolfe, N., Fr¨ ohlich, C., et al. 2021, ApJ, 921,
143, doi: 10.3847/1538-4357/ac0dc5
de Jager, C., Nieuwenhuijzen, H., & van der Hucht, K. A.
1988, A&AS, 72, 259
Densmore, J. D., Evans, T. M., & Buksas, M. W. 2008,
Nuclear Science and Engineering, 159, 1,
doi: 10.13182/NSE159-01
Densmore, J. D., Thompson, K. G., & Urbatsch, T. J.
2012, Journal of Computational Physics, 231, 6924,
doi: 10.1016/j.jcp.2012.06.020
Densmore, J. D., Urbatsch, T. J., Evans, T. M., & Buksas,
M. W. 2007, Journal of Computational Physics, 222, 485,
doi: 10.1016/j.jcp.2006.07.031
Dessart, L., & Hillier, D. J. 2022, A&A, 660, L9,
doi: 10.1051/0004-6361/202243372Radiation Transport for Interacting Transients with SuperLite 21
Dessart, L., Hillier, D. J., Audit, E., Livne, E., & Waldman,
R. 2016, MNRAS, 458, 2094, doi: 10.1093/mnras/stw336
Dubey, A., Daley, C., ZuHone, J., et al. 2012, ApJS, 201,
27, doi: 10.1088/0067-0049/201/2/27
El Eid, M. F., Fricke, K. J., & Ober, W. W. 1983, A&A,
119, 54
Faran, T., Poznanski, D., Filippenko, A. V., et al. 2014,
MNRAS, 442, 844, doi: 10.1093/mnras/stu955
Filippenko, A. V. 1997, ARA&A, 35, 309,
doi: 10.1146/annurev.astro.35.1.309
Fisher, A. K. 2000, PhD thesis, University of Oklahoma,
Norman
Fleck, J. A., J., & Cummings, J. D. 1971, Journal of
Computational Physics, 8, 313,
doi: 10.1016/0021-9991(71)90015-5
Fontes, C. J., Zhang, H. L., Abdallah, Jr., J., et al. 2015,
Journal of Physics B Atomic Molecular Physics, 48,
144014, doi: 10.1088/0953-4075/48/14/144014
Fryxell, B., Olson, K., Ricker, P., et al. 2000, ApJS, 131,
273, doi: 10.1086/317361
Fuller, J. 2017, MNRAS, 470, 1642,
doi: 10.1093/mnras/stx1314
Fuller, J., & Ro, S. 2018, MNRAS, 476, 1853,
doi: 10.1093/mnras/sty369
Gal-Yam, A. 2012, Science, 337, 927,
doi: 10.1126/science.1203601
Gal-Yam, A., Mazzali, P., Ofek, E. O., et al. 2009, Nature,
462, 624, doi: 10.1038/nature08579
Gonz´ alez, M., Audit, E., & Huynh, P. 2007, A&A, 464, 429,
doi: 10.1051/0004-6361:20065486
Hamuy, M., Pinto, P. A., Maza, J., et al. 2001, ApJ, 558,
615, doi: 10.1086/322450
Hauschildt, P. H. 1992, JQSRT, 47, 433,
doi: 10.1016/0022-4073(92)90105-D
Hauschildt, P. H., & Baron, E. 1999, Journal of
Computational and Applied Mathematics, 109, 41.
https://arxiv.org/abs/astro-ph/9808182
—. 2004, A&A, 417, 317, doi: 10.1051/0004-6361:20034473
Hillebrandt, W., Kromer, M., R¨ opke, F. K., & Ruiter, A. J.
2013, Frontiers of Physics, 8, 116,
doi: 10.1007/s11467-013-0303-2
Hillier, D. J., & Dessart, L. 2012, MNRAS, 424, 252,
doi: 10.1111/j.1365-2966.2012.21192.x
Hillier, D. J., & Miller, D. L. 1998, ApJ, 496, 407,
doi: 10.1086/305350
Hirata, K., Kajita, T., Koshiba, M., et al. 1987, PhRvL, 58,
1490, doi: 10.1103/PhysRevLett.58.1490
Hubeny, I., & Mihalas, D. 2015, Theory of Stellar
Atmospheres. An Introduction to Astrophysical
Non-equilibrium Quantitative Spectroscopic AnalysisIvezic, Z., Axelrod, T., Brandt, W. N., et al. 2008, Serbian
Astronomical Journal, 176, 1, doi: 10.2298/SAJ0876001I
Kasen, D., Thomas, R. C., & Nugent, P. 2006, ApJ, 651,
366, doi: 10.1086/506190
Kasen, D., Woosley, S. E., & Heger, A. 2011, ApJ, 734,
102, doi: 10.1088/0004-637X/734/2/102
Kerzendorf, W. E., & Sim, S. A. 2014, MNRAS, 440, 387,
doi: 10.1093/mnras/stu055
Kromer, M., & Sim, S. A. 2009, MNRAS, 398, 1809,
doi: 10.1111/j.1365-2966.2009.15256.x
Leonard, D. C., Kanbur, S. M., Ngeow, C. C., & Tanvir,
N. R. 2003, ApJ, 594, 247, doi: 10.1086/376831
Leonard, D. C., Filippenko, A. V., Gates, E. L., et al. 2002,
PASP, 114, 35, doi: 10.1086/324785
Li, W. D. 1999, IAUC, 7294, 1
Menon, A., & Heger, A. 2017, in The Lives and
Death-Throes of Massive Stars, ed. J. J. Eldridge, J. C.
Bray, L. A. S. McClelland, & L. Xiao, Vol. 329, 64–68,
doi: 10.1017/S1743921317003003
Moriya, T. J., Sorokina, E. I., & Chevalier, R. A. 2018,
SSRv, 214, 59, doi: 10.1007/s11214-018-0493-6
Morozova, V., Piro, A. L., Renzo, M., et al. 2015, ApJ, 814,
63, doi: 10.1088/0004-637X/814/1/63
Noebauer, U. M., & Sim, S. A. 2019, Living Reviews in
Computational Astrophysics, 5, 1,
doi: 10.1007/s41115-019-0004-9
Nomoto, K., Thielemann, F. K., & Yokoi, K. 1984, ApJ,
286, 644, doi: 10.1086/162639
Oelgoetz, J., Fontes, C. J., Zhang, H. L., & Pradhan, A. K.
2007, Physical Review A, 76, 062504
Palani Balaji, H., Ray, A., Wagle, G. A., & Raghu, A.
2022, ApJ, 933, 194, doi: 10.3847/1538-4357/ac7528
Paxton, B., Bildsten, L., Dotter, A., et al. 2011, ApJS, 192,
3, doi: 10.1088/0067-0049/192/1/3
Paxton, B., Cantiello, M., Arras, P., et al. 2013, ApJS, 208,
4, doi: 10.1088/0067-0049/208/1/4
Paxton, B., Marchant, P., Schwab, J., et al. 2015, ApJS,
220, 15, doi: 10.1088/0067-0049/220/1/15
Paxton, B., Schwab, J., Bauer, E. B., et al. 2018, ApJS,
234, 34, doi: 10.3847/1538-4365/aaa5a8
Paxton, B., Smolec, R., Schwab, J., et al. 2019, arXiv
e-prints. https://arxiv.org/abs/1903.01426
Prieto, J. L., Chen, P., Dong, S., et al. 2017, Research
Notes of the American Astronomical Society, 1, 28,
doi: 10.3847/2515-5172/aa9c46
Quataert, E., & Shiode, J. 2012, MNRAS, 423, L92,
doi: 10.1111/j.1745-3933.2012.01264.x22 Wagle et al.
Quimby, R. M. 2012, in Death of Massive Stars:
Supernovae and Gamma-Ray Bursts, ed. P. Roming,
N. Kawai, & E. Pian, Vol. 279, 22–28,
doi: 10.1017/S174392131201263X
Quimby, R. M., Kulkarni, S. R., Kasliwal, M. M., et al.
2011, Nature, 474, 487, doi: 10.1038/nature10095
Rakavy, G., & Shaviv, G. 1967, ApJ, 148, 803,
doi: 10.1086/149204
Roth, N., & Kasen, D. 2015, ApJS, 217, 9,
doi: 10.1088/0067-0049/217/1/9
Rybicki, G. B., & Hummer, D. G. 1978, ApJ, 219, 654,
doi: 10.1086/155826
Smartt, S. J. 2009, ARA&A, 47, 63,
doi: 10.1146/annurev-astro-082708-101737
—. 2015, PASA, 32, e016, doi: 10.1017/pasa.2015.17
Smartt, S. J., Eldridge, J. J., Crockett, R. M., & Maund,
J. R. 2009, MNRAS, 395, 1409,
doi: 10.1111/j.1365-2966.2009.14506.x
Smartt, S. J., Gilmore, G. F., Tout, C. A., & Hodgkin,
S. T. 2002, ApJ, 565, 1089, doi: 10.1086/324690
Smith, N. 2014, ARA&A, 52, 487,
doi: 10.1146/annurev-astro-081913-040025
Sobolev, V. V. 1960, Moving Envelopes of Stars,
doi: 10.4159/harvard.9780674864658
Sutherland, R. S. 1998, MNRAS, 300, 321,
doi: 10.1046/j.1365-8711.1998.01687.x
Taam, R. E., & Bodenheimer, P. 1989, ApJ, 337, 849,
doi: 10.1086/167155
—. 1991, ApJ, 373, 246, doi: 10.1086/170043
Thomas, R. C., Nugent, P. E., & Meza, J. C. 2011, PASP,
123, 237, doi: 10.1086/658673
Tonry, J. L. 2011, PASP, 123, 58, doi: 10.1086/657997
Utrobin, V. P. 2007, A&A, 461, 233,
doi: 10.1051/0004-6361:20066078
Van Dyk, S. D., de Graw, A., Baer-Way, R., et al. 2023,
MNRAS, 519, 471, doi: 10.1093/mnras/stac3549van Rossum, D. R. 2012, ApJ, 756, 31,
doi: 10.1088/0004-637X/756/1/31
Verner, D. A., Ferland, G. J., Korista, K. T., & Yakovlev,
D. G. 1996, ApJ, 465, 487,
doi: 10.1086/17743510.48550/arXiv.astro-ph/9601009
Vink, J. S., de Koter, A., & Lamers, H. J. G. L. M. 2001,
A&A, 369, 574, doi: 10.1051/0004-6361:20010127
Wagle, G. A., & Ray, A. 2020, ApJ, 889, 86,
doi: 10.3847/1538-4357/ab5d2c
Wagle, G. A., Ray, A., Dev, A., & Raghu, A. 2019, ApJ,
886, 27. https://arxiv.org/abs/1910.01679
Wagle, G. A., Ray, A., & Raghu, A. 2020, ApJ, 894, 118,
doi: 10.3847/1538-4357/ab8bd5
Wollaeger, R. T., & van Rossum, D. R. 2014, ApJS, 214,
28, doi: 10.1088/0067-0049/214/2/28
Wollaeger, R. T., van Rossum, D. R., Graziani, C., et al.
2013, ApJS, 209, 36, doi: 10.1088/0067-0049/209/2/36
Woosley, S. E. 1988, ApJ, 330, 218, doi: 10.1086/166468
Woosley, S. E., Heger, A., & Weaver, T. A. 2002, Reviews
of Modern Physics, 74, 1015,
doi: 10.1103/RevModPhys.74.1015
Woosley, S. E., Pinto, P. A., & Ensman, L. 1988, ApJ, 324,
466, doi: 10.1086/165908
Wright, W. P., Nagaraj, G., Kneller, J. P., Scholberg, K., &
Seitenzahl, I. R. 2016, PhRvD, 94, 025026,
doi: 10.1103/PhysRevD.94.025026
Yang, Y., Baade, D., Hoeflich, P., et al. 2023, MNRAS, 519,
1618, doi: 10.1093/mnras/stac3477
Zhang, W., Howell, L., Almgren, A., Burrows, A., & Bell,
J. 2011, ApJS, 196, 20, doi: 10.1088/0067-0049/196/2/20
Zhang, W., Howell, L., Almgren, A., et al. 2013, ApJS, 204,
7, doi: 10.1088/0067-0049/204/1/7