SCoRE sets: A versatile framework for
simultaneous inference
Fabian J.E. Telschow1, Junting Ren2and Armin Schwartzman2,3
1Department of Mathematics, Humboldt University of Berlin
2Division of Biostatistics, University of California, San Diego
3Halıcıo˘ glu Data Science Institute, University of California, San Diego
May 30, 2024
Abstract
We study asymptotic statistical inference in the space of bounded
functions endowed with the supremums norm over an arbitrary met-
ric space Susing a novel concept: Simultaneous COnfidence Region
of Excursion (SCoRE) Sets. They simultaneously quantify the uncer-
tainty of several lower and upper excursion sets of a target function.
We investigate their connection to multiple hypothesis tests control-
ling the familywise error rate in the strong sense and show that they
grant a unifying perspective on several statistical inference tools such
as simultaneous confidence bands, quantification of uncertainties in
level set estimation, for example, CoPE sets, and multiple hypothesis
testing over S, for example, finding relevant differences or regions of
equivalence within S. In particular, our abstract setting allows us to
refine and reduce the assumptions in recent articles on CoPE sets and
relevance and equivalence testing using the supremums norm.
1 Introduction
Historically there has been a large body of work connecting hypothesis tests
and confidence sets. The earliest work on this topic is Neyman [1937] which
developed the well known duality between families of point hypothesis tests
and confidence sets , compare [Lehmann et al., 2005, Thm 3.5.1] for a modern
treatment. Later in Aitchison [1964, 1965], Gabriel [1969] simultaneous
confidence sets have been used to derive tests for more complex hypotheses,
1arXiv:2302.05139v5  [math.ST]  29 May 2024especially in multiple testing. The opposite direction starting from stagewise
multiple testing procedures and deriving simultaneous confidence sets has
been studied, among others, in Stefansson [1988], Hayter and Hsu [1994],
Holm [1999], Guilbaud [2008], Magirr et al. [2013].
Most of the above works have in common that they treat statistical hy-
pothesis testing as the fundamental paradigm and view confidence sets as a
derived concept. However, there is an intuitive appeal of confidence inter-
vals over hypothesis testing which is nicely expressed in R. Little’s comment
to the ASA statement on the p-value Wasserstein and Lazar [2016]: “[...]
I teach a basic course in biostatistics to public health students. Confidence
intervals are no problem–ideas like margin of error have even entered the
vernacular. The difficulties begin with hypothesis testing. [...]” . Implicitly,
this intuition appeared as well in the works on equivalence testing where
the null hypothesis is that a parameter (for example a population mean) is
not contained in a known interval because the first equivalence tests were
based on confidence intervals Westlake [1972], Schuirmann [1981]. Only later
tests have been derived from the intersection-union principle Schuirmann
[1987], Hauck and Anderson [1992]. A thoughtful discussion of the connec-
tion between confidence intervals and equivalence tests and possible pitfalls
is presented in Berger and Hsu [1996].
Our Contributions. In this article we aim to strengthen the confidence
set viewpoint. We assume that the following mathematical objects are given:
an unknown target function µ:S→R, an estimator ˆ µofµthat satisfies a
weakened version of a uniform limit theorem (ULT) in the space of bounded
functions ℓ∞(S) endowed with the supremums norm and two sets AandBof
real-valued functions over S. Our main theorem (Theorem 1) then provides
the limit distribution that the canonical estimates ˆUaand ˆLbderived from
the ULT of the upper Uaand lower Lbexcursion sets above aand below
bofµ, respectively, simultaneously satisfy ˆUa⊆ U aand ˆLb⊆ L bfor all
a∈ A andb∈ B. The concept is visualized in Figure 5 in the Appendix.
Our Theorem 1 and its corollaries generalize coverage probability excursion
(CoPE) sets Sommerfeld et al. [2018], Bowring et al. [2019, 2021] and yield a
more general version of the view on simultaneous confidence bands that we
introduced in Ren et al. [2022]. In particular, we resolve some shortcomings
in Sommerfeld et al. [2018] which led to unnecessary assumptions on µ.
Our second main contribution is to clarify the connection between con-
fidence regions for excursion sets and multiple hypotheses tests that control
the familywise error rate (FWER) in the strong sense. Especially, we give
2a useful duality in Proposition 1. From this perspective we develop another
interpretation of Theorem 1 as providing the oracle limit distribution of a
class of multiple testing strategies that asymptotically control the FWER
in the strong sense, compare Section 4.1. Furthermore, we show in Theo-
rem 3 and 5 that many recently proposed asymptotic global relevance and
equivalence tests for functional data based on the supremums norm, among
others, Dette and Tang [2021], Dette and Kokot [2022, 2021], can be derived
and generalized from the viewpoint of our Theorem 1. Even better, our es-
tablished duality allows us to construct from Theorem 1 local relevance and
local equivalence tests that control the FWER in the strong sense, compare
Theorem 4 and 6. To the best of our knowledge the latter have not been
discussed in the literature yet.
A third contribution of our article is discussing a slight shift in the inter-
pretation of statistical inference on excursion sets from the viewpoint of our
duality between confidence sets for excursion sets and multiple hypothesis
testing which we exemplify in a simple multiple linear regression example in
Section 5.
Finally, we want to point out that we aware of the fact that the assump-
tion that an estimator ˆ µsatisfies a ULT might be too strong. We introduce
this assumption mainly to compare to the current literature and derive ex-
plicit limit distributions. The core of our results, however, is the SCoRE set
Metatheorem, Theorem 7, which requires considerably weaker assumptions.
Connections to the Literature. The first work we are aware of which
quantifies the uncertainty of the lower and the upper excursion set above
zero of a function µdefined on RDfrom a statistical viewpoint is Mammen
and Polonik [2013]. Using an estimator ˆ µNofµthey construct from data a
lower and an upper excursion set ˆLandˆUabove zero respectively and prove
in their Lemma 2.1. nonasymptotic bounds such that both inclusions ˆL ⊆ L 0
andˆU ⊆ U 0hold true. This can be viewed as a special case of our Proposition
3 from Appendix C. In their Theorem 3.1 they apply these sets to quantify
the uncertainty of the excursion sets of a kernel density estimator above
a single c∈Rasymptotically. They show that under certain assumptions
onµ, for example, a non-degeneracy condition of the gradient of µthe
above inclusion is asymptotically valid, if the parameter for constructing
ˆLand ˆUis estimated using the bootstrap. Noteworthy this result does
not explicitly extract the asymptotic distribution. Another more recent
work which applies similar ideas to kernel density estimators is Qiao and
Polonik [2019]. In particular, they derive assumptions and rates for having
3asymptotically nominal coverage and give a broad overview on applications
of level and excursion set estimation.
The first article that explicitly derives limit distributions for confidence
regions of excursion sets for general estimators ˆ µofµsatisfying a central
limit theorem in C(S) is Sommerfeld et al. [2018]. This paper has some
shortcomings, for example, µis not allowed to be tangential to the level c,
[Sommerfeld et al., 2018, Assumption 2.1.(a) and Lemma 1] which is a similar
condition as the Assumption (A.ii) required in Theorem 3.1. of Mammen
and Polonik [2013]. However, in Sommerfeld et al. [2018] this condition is
only needed because of an imprecise definition, which also prevents that their
theory can be connected easily to multiple hypothesis testing controlling the
FWER. We explain this in more detail in Section 3.2 and Appendix E. Note
that this definition persists in the applications of their work to geoscience
French et al. [2017] and neuroimaging Bowring et al. [2019, 2021] and has
also been used in the innovative work Maullin-Sapey et al. [2023] which
generalizes Sommerfeld et al. [2018] to intersections and unions of excursion
sets of several functions µ1, . . . , µK∈a(s),K∈N, above a single c∈R.
Our Corollary 3 generalizes the main theorem from Sommerfeld et al. [2018]
as it removes their Assumption 2.1.(a), allows for non-constant thresholds
c∈ℓ∞(S) and can be interpreted in terms of a multiple hypothesis test.
To date only Ren et al. [2022] is dealing with several excursion sets at
the same time. Their main theorem shows that properly thresholding SCBs
yields simultaneous confidence regions for all lower and upper excursion sets
overc∈R. We generalize their main result in our Proposition 2 and embed
it into the testing literature. Moreover, our Corollary 1 can be viewed as its
asymptotic generalization as it connects asymptotic (1 −α)-SCBs (among
others, Degras [2011], Telschow and Schwartzman [2022]) and simultaneous
confidence regions for excursion sets. In principle even the fast and fair SCBs
Liebl and Reimherr [2019] can be fitted into our framework. Here we need
to fall back to the SCoRE set Metatheorem, since their key innovation is
that the quantile parameter qis a function, which enables them to adapt the
width of the SCBs not only to the variance, yet also to the local correlation.
The benefit of this is that invalidation of the coverage can be spread fairly
over a partition of S= [0,1]. We do not include this result here, since we
restrict ourselves to constant qfor the sake of simplicity.
Last but not least there is a less obvious connection to the recently
proposed relevance tests Dette et al. [2020], Dette and Tang [2021], Dette
and Kokot [2022] and equivalence tests Dette and Kokot [2021], Dette et al.
[2018] in the space of continuous functions over S= [0,1]. These articles
use the test statistic ∥ˆµN∥∞= sups∈S|ˆµN(s)|and derive using a CLT of ˆ µ
4inC(S) its limiting distributions under the null and alternative hypotheses
which depend on the set of extreme points of µ. We explain in Section 4
how these test procedures can be derived from Corollary 2 and clarify that
they only control the FWER in the weak sense at level α. In our Theorems
4 and 6 we improve these testing strategies by modifying them to control
the FWER in the strong sense at level α.
Organization of the Article. In Section 2 we introduce notations and
definitions required to understand our main results. In Section 3 we explain
our main theorem, its corollaries and the required assumptions. It also con-
tains a general strategy to consistently estimate generalized preimages –a
concept that appears in our main theorem– and outlines a general strat-
egy to estimate the required quantile parameter. The connection between
SCoRE sets and statistical hypothesis testing are explained in Section 4.
In particular, we state our duality to certain multiple hypothesis tests in
Section 4.1 and the oracle limit distribution in Section 4.2. In Section 5 we
explain the interpretation of statistical inference based on SCoRE sets using
a simple example from linear regression. The article finishes with a dis-
cussion, Section 6, of some consequences of our results and ideas for future
work.
2 Notations and Definitions
In this article ( S, d) denotes a metric space. S\B, clBfor the topological
closure, int Bfor the interior and ∂B= clB\intBfor the topological bound-
ary of B. The set F(S) denotes the set of functions f:S→R∪ {±∞} .
The set ℓ∞(S)⊂ F(S) is the set of all bounded functions f∈ F(S), i.e.,
∥f∥∞= sups∈S|f(s)|<∞andC(S)⊆ F(S) is the subset of continu-
ous functions with respect to the topology generated by the metric d. If
f∈ F(S) and r∈R∪ {±∞} , we write f≡r, iffis the constant function
with value rand if no confusion is possible we identify rwith the constant
function with value r. For any f∈ F(S) we define, as usual,
sup
s∈∅f(s) =−∞ and inf
s∈∅f(s) =∞. (1)
Let (Ω ,P,P) be a probability space. Our results are based on the J.
Hoffmann-Jørgensen theory of weak convergence as elaborated in the first
chapters of Van Der Vaart et al. [1996]. Recall that the inner probability
of a set V⊂Ω is given by P∗(V) = sup {P(W)|W⊆V , W ∈P}, and
5itsouter probability byP∗(V) = inf {P(W)|W⊇V , W ∈P}. We use
repeatedly the statements ( i) and ( ii) of the Portmanteau Theorem [Van
Der Vaart et al., 1996, Theorem 1.3.4]. Hence we introduce the following
shorter notation to simplify bounds on the the limes inferior (lim ) of inner
probabilities and limes superior ( lim) of outer probabilities.
Definition 1. Let Ω N⊆Ω be a sequence of sets, X: Ω→Ra random
variable and q∈R. We write
lim
N→∞P∗
ΩN
=P
X≺q
,
under Assumptions (A)/(B)if the following two statements hold:
Under Assumptions (A): lim
N→∞P∗
ΩN
≥P
X < q
Under Assumptions (B): lim
N→∞P∗
ΩN
≤P
X≤q
.
To compactly state our main result, Theorem 1, we require generalized
notions of preimages and graphs of functions. We introduce these concepts
hereafter. A visualization of these concepts can be found in Figure 1. Recall
that the graph of f∈ F(S) is the set Γ( f) =
(s, r)∈S×R|r=f(s)	
.
Definition 2 (Graph of a Set of Functions ).For any H ⊆ F (S) define
thegraph of Hto be the union of the graphs of its elements, i.e.,
Γ(H) =[
h∈HΓ(h).
As a further convention we will write h∈Γ(H) if Γ( h)⊆Γ(H) forh∈ F(S).
Definition 3 (Preimage of a Set of Functions ).For any H ⊆ F (S) and
g∈ F(S) define the preimage of Hunder gby
g−1
H=
s∈S| ∃h∈ H:g(s) =h(s)	
.
IfH={h},h∈ F(S), the abbreviation g−1
{h}=g−1
his used.
IfH ̸⊂ C (S) org /∈ C(S) we need a generalized concept of a preimage of
a set of functions in the sense that we add all “touching points” of Γ( g) and
Γ(H) to the preimage. Making this idea mathematically precise requires the
thickening of a set H ⊆ F (S).
Definition 4 (Thickenings of a Set of Functions ).ForH ⊆ F (S) and
η >0 the set H±η=
h±ε∈ F(S)|h∈ H,0≤ε≤η	
is the±η-thickening
ofH, while Hη=H−η∪ H +ηis called the η-thickening of H.
6Definition 5 (Generalized Preimage of a Set of Functions ).ForH ⊆
F(S) and g∈ F(S) we call the set
g±
H=\
η>0clg−1
H±η
theupper(+)/lower(-) generalized preimage of Hunder g.
Remark 1.The terminology generalized preimage is reasonable as g−1
H⊆
g±
H⊆g−1
H. The main reason why the generalized preimage appears later on
is that for Sbeing compact and g±
H̸=∅, it holds that
lim
N→∞dH
clg−1
H±ηN,g±
H
= 0, (2)
for any positive sequence ( ηN)N∈N⊂Rconverging to zero as g−1
H±η⊆g−1
H±η′
forη′≥η, see [Tuzhilin, 2020, Corollary 5.30]. Moreover, g±
His the unique
set with this property since it is closed. If there would be another A⊆S
satisfying (2), it holds by the triangle inequality that
dH 
g±
H, A
≤lim
N→0dH
clg−1
H±ηN,g±
H
+dH
clg−1
H±ηN, A
= 0
and therefore g±
H= clA, compare [Tuzhilin, 2020, Problem 5.1.(3)].
Figure 1: Visualization of Definitions 2-5. Black: the target function µ.
Red: the graph Γ( A) of a set of functions A. Light red: the graph Γ( A−η) of
lower η-thickening A−ηofA. Moreover, the preimages and lower generalized
preimages of Aunder µare shown below the x-axis.
73 An Asymptotic SCoRE Set Theorem
In this section we state and discuss our main theorems. The main assump-
tion will be that the estimators ˆ µN: Ω→ℓ∞(S) ofµ∈ℓ∞(S) satisfy
a uniform limit theorem (ULT) in ℓ∞(U) for some appropriately chosen
U⊆S. Although we call ˆ µNan estimator we do not in general assume that
it is measurable. Our main objects of interest are excursion sets:
Definition 6. Thelower and upper excursion sets of µover f∈ F(S) are
Lf=
s∈S|µ(s)< f(s)	
,Uf=
s∈S|µ(s)> f(s)	
.
Ifµis replaced by ˆ µN, we call the originating set-valued functions ˆLfand
ˆUfthe lower and upper excursion sets of ˆ µNoverf.
The notation used in our main theorem and its corollaries can be sim-
plified, if we define
TA,B(f) = max(
sup
s∈µ−1
Af(s),sup
s∈µ−1
B−f(s))
TA,B(f) = max(
sup
s∈u−
Af(s),sup
s∈u+
B−f(s)) (3)
forA,B ⊆ F (S) and µ, f∈ℓ∞(S). Here u±
His the upper/lower generalized
preimage of H ⊆ F (S) under µ. We abbreviate TH,H(f) = TH(f) and
TH,H(f) =TH(f).
3.1 Assumptions
The next definition specifies what kind of uniform limit theorem our main
result requires.
Definition 7. Letσ∈ℓ∞(S) be such that 0 <o< σ(s)<O<∞for all
s∈Sand ( τN)N∈N⊂Ra positive sequence converging to zero. We denote
with ( GN)N∈Nthe sequence
GN=ˆµN−µ
τNσ. (4)
LetA,B ⊆ F (S), ˜η >0 and A−˜ηandB+˜ηbe the one-sided thickenings of
AandBrespectively as defined in Definition 4. We say that an estimator
ˆµNofµwith values in ℓ∞(S) fulfills a uniform limit theorem on A−˜η∪ B+˜η
or short a A−˜η-B+˜η-ULT, if the following conditions hold:
8(i) There exist a tight, Borel measurable G: Ω→ℓ∞ 
clµ−1
A−˜η∪clµ−1
B+˜η
such that GN⇝Gweakly in ℓ∞ 
clµ−1
A−˜η∪clµ−1
B+˜η
in the sense of [Van
Der Vaart et al., 1996, Definition 1.3.3]. Here we silently identified GN
and its restriction to cl µ−1
A−˜η∪clµ−1
B+˜η.
(ii) There is a constant K > 0 and a sequence ( ZN)N∈Nof functions
Ω→ℓ∞(S) with inf s∈Sτ−1
NZN(s) being asymptotically tight1such
thatP∗almost surely for all a∈ Aand all b∈ Bit holds that
 
ˆµN(s)−a(s)
·sgn 
µ(s)−a(s)
≥σ(s) 
K+ZN(s)
(5)
for all s∈S\clµ−1
A−˜ηand
 
ˆµN(s)−a(s)
·sgn 
µ(s)−a(s)
≥σ(s) 
K+ZN(s)
for all s∈S\clµ−1
B+˜η.
Remark 2.Condition ( ii) is an adaptation of Assumption 2.1.(c) from Som-
merfeld et al. [2018] and weakens the assumption of having a ULT as in
(i) on all of SEssentially it assumes that the sequence of estimators ˆ µN
have the correct sign for all s∈Ssufficiently far away from the generalized
preimage u−1
Aandu−1
B. This follows for u−1
Afrom
lim
N→∞P∗h
∃s∈S\µ−1
A˜η: sgn 
µ(s)−a(s)
=−sgn 
ˆµN(s)−a(s)i
≤lim
N→∞P∗h
∃s∈S\µ−1
A˜η:−ˆµN(s)−a(s)≥σ(s) 
K+ZN(s)i
≤lim
N→∞P∗h
inf
s∈SZN(s)≤ −Ki
≤1−lim
N→∞P∗h
inf
s∈SZN(s)∈[−K, K ]i
= 0,
where we used (5) in the first inequality and inf s∈Sτ−1
NZN(s) being asymp-
totically tight in the last equality.
LetA,B ∈ F (S) and ˜ η >0. The following assumptions are used in our
main result:
(A1) The estimator ˆ µNofµsatisfies an A−˜η-B+˜η-ULT.
(A2) GandGNrestricted to 
clµ−1
A−˜η\intu−
A
∪ 
clµ−1
B+˜η\intu+
B
have
almost surely continuous sample paths.
1In the sense of [Van Der Vaart et al., 1996, p.21]
9(A3) clµ−1
A−˜ηand cl µ−1
B+˜ηare compact.
(A4) clµ−1
A=u−
Aand cl µ−1
B=u+
B.
Remark 3.Assumptions (A1) -(A3) are required to prove the lower bounds
on the confidence statements in our main theorem. They ensure that for
A,B ⊆ F (S) and ( ηN)N∈Nconverging to zero, that
TclAηN,clBηN(GN)⇝TA,B(G) weakly in R,
by Lemma 6 in Appendix B.3.
Remark 4.The compactness assumption in (A3) can be relaxed. The re-
quirement in the proof is that for any sequence ( ηN)N∈Nconverging to zero
we have that cl µ−1
A−ηNand cl µ−1
B+ηNare converging in Hausdorff distance to
u−
Aandu+
Brespectively, which is implied by (A3) as discussed in Remark 1.
Remark 5.Assumption (A4) yields that the lower and upper bound of
the confidence statement in our main theorem are derived from the same
limiting process. In particular, (A4) is trivially satisfied if A,B ⊆ C(S)
andµ∈C(S), compare Appendix D. However, if (A4) is not satisfied,
there exists a slightly different limiting process which yields an upper bound
similar to the upper bound in Theorem 1, compare Remark 9.
3.2 An Asymptotic SCoRE Set Theorem
The next result is our main theorem. It can be viewed as a Corollary of
the SCoRE set Metatheorem for random variables satisfying a ULT, see
Appendix C.
Theorem 1. LetA,B ⊆ F (S)andq∈R. Assume (A1) . Then
lim
N→∞P∗h
∀a∈ A∀ b∈ B:ˆUa+qτNσ⊆ Ua∧ˆLb−qτNσ⊆ L bi
=P
TA,B(G)≺q
under (A2) ,(A3) /(A4) .
Remark 6.The above theorem is valid even if u−
A∪u+
B=∅. In this case the
inner probability that the inclusions on the l.h.s. hold true simultaneously
converges to 1 for all q∈R, which is consistent with our notation as
P
T∅,∅(G)< q
=P[−∞< q] = 1 .
10Figure 2: Illustration that µ−1
{a}is not necessarily the Hausdorff-limit of
µ−1
{a}−η. The problem are ”touching points” of Γ( µ) and Γ( a) such as s0≈
0.4, ifµoraare discontinuous. Left: Asµ(s0)̸=a(s0) it holds s0/∈µ−1
{c}.
However, for each η >0 there is an sη∈µ−1
{a}ηarbitrary close to s0. Thus,
the Hausdorff convergence µ−1
{a}−ηtoµ−1
{a}fails. Right: Asb(s0) =µ(s0) it
holds that µ−1
{a}−ηconverges in Hausdorff distance to µ−1
{a}asη→0.
Remark 7.Since u−1
C=u−1
C′forC′=
c∈ F(S)|c∈Γ(C)	
we could replace
A,BbyA′,B′in the above theorem without changing the r.h.s.. Neither
does the r.h.s. change if we add any of the inclusions S\ˆLa+qτNσ⊆S\ La,
a∈ A, orS\ˆUb−qτNσ⊆S\ Ub,b∈ B, to the probability statement on the
l.h.s., compare Lemma 2.
Remark 8.Assumption (A4) cannot be weakened to include any s0∈u−1
A\
clµ−1
Aors0∈u−1
B\clµ−1
Bwithout getting a weaker upper bound. The
reason is that the sharp upper bound requires that, for some a∈ Aorb∈ B,
µ(s0)/∈
ˆµN−qτNσ(s0),∞
for an s0∈u−1
Aimplies that ˆUa+qτNσ̸⊆ U a, or
µ(s0)/∈ 
− ∞,ˆµN−qτNσ(s0)
for an s0∈u−1
Bimplies that ˆLb−qτNσ̸⊆ L b.
This, however, cannot be guaranteed at points of discontinuity of µ,aorb,
even if GNhas continuous sample paths, compare Fig. 3.
Remark 9.If(A4) is not satisfied, then there is always the following weaker
upper bound in Theorem 1 on the limes superior: P
TA,B(G)≤q
. This up-
per bound can be easily derived from the SCoRE set Metatheorem, compare
Remark 22 in Appendix C.
Setting A=B=F(S) in Theorem 1 implies S=u±
A=µ−1
A= clµ−1
A=
intµ−1
Aand therefore (A2) -(A4) are satisfied even if Sis non-compact by
11Figure 3: Illustration of why Assumption (A4) cannot be weakened to
include points s0∈u−1
c\clµ−1
cforc∈ {a, b}even if GNis continuous in a
neighbourhood of u−1
c\clµ−1
cin both panels. The reason is that the SCoRE
sets inclusions in both panels are satisfied although ˆ µN(s0)−qτNσ(s0)>
µ(s0) in the right panel and ˆ µN(s0) +qτNσ(s0)< µ(s0) in the left panel.
Remark 4. Therefore we obtain the following corollary.
Corollary 1. Letq∈Rand assume (A1) withA=B=F(S). Then
lim
N→∞P∗h
∀c∈ F(S) :ˆLc−τNqσ⊆ L c∧ˆUc+τNqσ⊆ Uci
=Ph
max
s∈S|G(s)| ≺qi
.
This result is connected to the standard construction of an (1 −α)-SCB
for an estimator satisfying a ULT. In this case the intervals
lN(s), uN(s)
=
ˆµN(s)−qτNσ(s),ˆµN(s)+qτNσ(s)
,s∈S, form an asymptotic (1 −α)-SCB
forµ, ifqαis the smallest q >0 such that
Ph
max
s∈S|G(s)| ≤qi
≥1−α .
The estimated level sets in the above corollary are now exactly the upper
excursion sets of lNand the lower excursion sets of uNoverc, i.e.,
ˆUc+τNqσ=
s∈S|lN(s)> c(s)	
,ˆLc−τNqσ=
s∈S|uN(s)< c(s)	
.
Our next result will be used in Section 4 to connect Theorem 1 to equiv-
alence and relevance tests. Readers familiar with the works [Dette et al.,
2020, Dette and Kokot, 2021, 2022] might spot the structural similarities be-
tween the limiting distribution of Corollary 2 and their limiting distribution
to compute the critical threshold of their tests. This is not a coincidence as
we will explain in Section 4.
12Corollary 2. Assume a, b∈ F(S),A={a},B={b},q∈Rand(A1) .
Then
lim
N→∞P∗h
ˆUa+qτNσ⊆ Ua∧ˆLb−qτNσ⊆ L bi
=Ph
Ta,b(G)≺qi
.
under (A2) ,(A3) /(A4) .
Fora=b=c∈ F(S), the above corollary generalizes Theorem 1 from
Sommerfeld et al. [2018] as it neither requires their Assumption 2.1(a) nor
continuity assumptions on µandc. To showcase this and highlight important
conceptual differences to their result, we include the next corollary which
deals with the continuous case.
Corollary 3. LetSbe compact, µ, c∈C(S),A=B={c}andq∈R.
Assume (A1) -(A2) . Then
lim
N→∞P∗h
ˆUc+qτNσ⊆ Uc∧ˆLc−qτNσ⊆ L ci
=P
Tc(G)≺q
.
The reason why the above result does not need the non-tangentiality as-
sumption (Sommerfeld et al. [2018, Assumption 2.1(a)]) is that the inclusion
statement on the r.h.s. slightly differs from the inclusion statement in Som-
merfeld et al. [2018]. Expressing their inclusion statement ˆA+
c⊆ A c⊆ˆA−
c
in our notation yields
S\ˆLc+qτNσ⊆S\ Lc∧ˆLc−qτNσ⊆ L c.
Thus, compared to Sommerfeld et al. [2018] we replaced the statement S\
ˆLc+qτNσ⊆S\ LcbyˆUc+qτNσ⊆ Uc. An illustration why this is necessary to
obtain the sharp upper bound without additional conditions can be found
in Figure 7 from Appendix E.
Another strong argument for our change in the definition of the inclusion
statement compared to Sommerfeld et al. [2018] is that the random sets
ˆUc+qτNσ⊆ Uc, S \
ˆUc+qτNσ∪ˆLc−qτNσ
,ˆLc−qτNσ
from Corollary 3 are a partition of S, which satisfies with high probability
ˆUc+qτNσ⊆ Uc, µ−1
c⊆S\ ˆUc+qτNσ∪ˆLc−qτNσ
,ˆLc−qτNσ⊆ L c.
This means that Sis divided into three regions. For the sets ˆUc+qτNσand
ˆLc−qτNσwe know that (asymptotically) with a probability given by qthe
13function µon these regions is larger and smaller than c, respectively. We can
make no statement about any sin the third region, yet we can guarantee
with a probability depending on qthat this region is a superset of the level
setµ−1
c. Noteworthy, the partition S\ˆLc+qτNσ,ˆLc+qτNσ∩S\ˆLc−qτNσ
and ˆLc−qτNσofSresulting from [Sommerfeld et al., 2018, Theorem 1] does
not have such nice probabilistic properties because the preimage µ−1
ccan
intersect S\ˆLc+qτNσand ˆLc+qτNσ∩S\ˆLc−qτNσ.
3.3 Estimation of the Generalized Preimage and Bootstrap-
ping the Quantile of SCoRE Sets
Estimation of qsuch that the families derived in Theorem 1 are (1 −α)-
SCoRE sets requires estimation of u±
CforC ⊆ F (S). In the case of S
being compact, a Hausdorff-distance consistent estimator can be derived by
replacing µby ˆµNin the definition of cl µ−1
C±ηand choosing ηdepending on N
appropriately. More precisely, if ( kN)N∈Nis a positive sequence converging
to zero, we define the following estimator of u±
Cby
ˆu±
C= cl
s∈S∃c∈ C: 0≤ ∓ 
ˆµN(s)−c(s)
≤kNτNσ(s)	
.(6)
This idea is similar to the estimation of the extremal sets in Dette et al. [2020]
and related work. The consistency in Hausdorff-distance of this estimator
is stated in the next result.
Theorem 2. LetSbe compact, C ⊆ F (S)and(kN)N∈Nbe a positive se-
quence such that limN→∞kNτN= 0 andlimN→∞kN/log 
τ−2
N
=κfor
some κ >0, then dH ˆu±
C,u±
C
→0in outer probability as N→ ∞ .
In principle, this consistency result allows us to estimate the quantile
of SCoRE sets from Theorem 1 along the lines described in Dette et al.
[2020]. A general strategy2to achieve this is to show within the assumed
probabilistic model that realizations of a bootstrap processes B(1)
N, . . . , B(R)
N
can be obtained which satisfy

GN, B(1)
N, . . . , B(R)
N
⇝
G, G(1), . . . , G(R)
weakly in 
ℓ∞(clµ−1
A−˜η∪clµ−1
B+˜η)R+1. Here G(1), . . . , G(R)are i.i.d. copies of
G. Combining this with Theorem 2 and a simple generalization of Lemma
2not necessarily the best in a given probabilistic model
14B.3 from Dette et al. [2020], which can be derived using our Appendix B.3,
yields for any sequence ( ηN)N∈Nconverging to zero,

TclA−ηN,clB−ηN(GN), TclA−ηN,clB−ηN 
B(1)
N
, . . . , T clA−ηN,clB−ηN 
B(R)
N
⇝
TA,B(G),TA,B 
G(1)
, . . . , TA,B 
G(R)
weakly in RR+1with TA,B 
G(1)
, . . . , TA,B 
G(R)
∼TA,B(G) i.i.d..
4 Hypothesis Testing and SCoRE Sets
In this section we connect SCoRE sets to statistical hypothesis testing and
use Theorem 1 to develop novel statistical hypothesis tests. Our develop-
ments can be seen as an extension of the duality of confidence intervals and
hypothesis tests in point hypothesis testing as given in [Lehmann et al.,
2005, Thm 3.5.1] to multiple hypothesis testing. The following definition
will reduce and unify the notations in the upcoming sections.
Definition 8. Let Θ be a set, H0,θbe a null hypothesis and H1,θan cor-
responding alternative hypothesis for θ∈Θ. Assume there is a statistical
test for H0,θat each θ∈Θ which decides whether H0,θis rejected. The set
of true null hypotheses and its estimate are
H0=
θ∈Θ|H0,θis true	
,ˆH0=
θ∈Θ|H0,θis not rejected	
.
Similarly, the set were the alternative hypothesis is true and its estimate are
H1=
θ∈Θ|H1,θis true	
,ˆH1=
θ∈Θ|H0,θis rejected	
.
Definition 9 (Strong Family-wise Error Rate Control) .Let{Tθ}θ∈Θbe a
family of tests such that each Tθis a test for a null hypothesis H0,θ, where
θ∈Θ. We say that this family controls the family-wise error rate (FWER)
in the strong sense at level α, if
FWER( H0) =P∗
∃s∈ H 0:Tθis rejected
≤α
for all possible sets H0⊆Θ.3
Remark 10.It follows immediately from Definition (8) that
FWER( H0) = 1−P∗
H0⊆ˆH0
.
3We supress that P∗might depend on H0.
154.1 Multiple Hypothesis Tests Derived from SCoRE Sets
This section is complementary to the tests derived from confidence sets in
Aitchison [1964]. While (simultaneous) confidence sets for a parameter µ
allow to derive joint tests for essentially all possible hypotheses, SCoRE sets
restrict the set of jointly testable hypotheses, which can lead to an increase
in power compared to confidence set based tests. In this section we assume
a more general framework than in the rest of this article to highlight the
close connection between confidence regions for excursion sets and tests that
control the FWER in the strong sense.
Letµ∈ℓ∞(S) be a target function, A,B ⊆ F (S) sets of known excursion
functions and recall that UaandLbare the upper/lower excursion sets of µ
above/below a/brespectively.
Definition 10. (SCoRE sets) Let α∈(0,1),P(S) denote the power set of
SandUa: Ω→ P (S),ω7→ˆUa(ω) and La: Ω→ P (S),ω7→ˆLb(ω) be
set-valued function. If the families {ˆUa}a∈Aand{ˆLb}b∈Bsatisfy
P∗h
∀a∈ A∀ b∈ B:ˆUa⊆ Ua∧ˆLb⊆ L bi
≥1−α ,
for all µ∈ℓ∞(S) we say that {Ua}a∈Aand{Lb}b∈Bform (1 −α)-Simultanuous
COnfidence Region of Excursion (SCoRE) sets for ( A,B).
The hypotheses, which we want to test jointly for a∈ Aandb∈ B, are
H≤a
0,s:µ(s)≤a(s) vs H≤a
1,s:µ(s)> a(s)
H≥b
0,s:µ(s)≥b(s) vs H≥b
1,s:µ(s)< b(s)(7)
Using definition 8 we define the joint FWER for a family of tests on the
hypotheses (7) by
FWER
H≤A
0,H≥B
0
= 1−P∗h
∀a∈ A∀ b∈ B:ˆUa⊆ Ua∧ˆLb⊆ L bi
(8)
which by Remark 10 is consistent with Definition 9 and therefore the fol-
lowing immediate consequence is not surprising.
Proposition 1. (SCoRE sets and Multiple Hypothesis Test Duality) As-
sume that {ˆUa}a∈Aand{ˆLb}b∈Bform (1−α)-SCoRE sets for (A,B), then
the family of tests given by
T≤a
s=(
reject ,ifs∈ˆUa
accept ,else,T≥b
s=(
reject ,ifs∈ˆLb
accept ,else,
16fora∈ A andb∈ Bcontrol the joint FWER at level αfor all µ∈ℓ∞(S).
Conversely, assume we have tests T≤a
sandT≥b
swhich control the joint
FWER for all a∈ A andb∈ B in the strong sense, then {ˆH≤a
1}a∈Aand
{ˆH≥a
1}b∈Bform (1−α)-SCoRE sets for (A,B).
Remark 11.The same duality holds between asymptotic tests and asymp-
totic SCoRE sets and for the inclusion statement from Sommerfeld et al.
[2018]. Additionally, it establishes that, for example, stagewise multiple
testing procedures such as the Bonferroni-Holm procedure Holm [1979], can
be used to construct (1 −α)-SCoRE sets for ( A,B).
An immediate application of this duality are simultaneous confidence
bands because a slight variation on the main theorem of Ren et al. [2022]
shows that they define simultaneous SCoRE sets for 
F(S),F(S)
; here the
change of the inclusion statement greatly simplifies the proof.
Proposition 2. Assume that µ∈ℓ∞(S)and that the family indexed by
s∈Sof random intervalsˆl(s),ˆu(s)
forms an (1−α)-SCB for µ. Then
P∗h
∀c∈ F(S) :ˆUc⊆ Uc∧ˆLc⊆ L ci
≥1−α (9)
Remark 12.As in Ren et al. [2022] the proof shows the equivalence of
(E1)∀s∈S:ˆl(s)≤µ(s)≤ˆu(s)
(E2)∀c∈ F(S) :ˆLc⊆ L c∧ˆUc⊆ Uc.
Therefore an upper bound of the form
P∗h
∀c∈ F(S) :ˆUc⊆ Uc∧ˆLc⊆ L ci
≤1−β
forβ≤αyields an (1 −β) upper bound for (9) as well.
A SCB even yields joint tests for less standard hypotheses such as the
local relevance hypothesis or the equivalence hypothesis, i.e.,
Hs,∆
0,rel:µ(s)∈[−∆,∆]vs.Hs,∆
1,rel:µ(s)/∈[−∆,∆]
H∆
0,eq:∃s∈S:µ(s)/∈(−∆,∆)vs.H∆
1,eq:∀s∈S:µ(s)∈(−∆,∆)
for some ∆ >0, by defining the decision rules as
reject Hs,∆
0,rel:⇐⇒ s∈ˆU∆∪ˆL−∆⇐⇒ ˆu(s)<−∆∨ˆl(s)>∆
reject H∆
0.eq:⇐⇒ ˆU−∆∩ˆL∆=S⇐⇒ ∀ s∈S:ˆl(s),ˆu(s)
∈(−∆,∆)
How these observations relate to recently established relevance and equiv-
alence tests for C(S)-valued data based on the supremums norm and why
SCoRE sets despite the duality given in Proposition 1 are a useful concept,
are the topics of the next sections.
174.2 Oracle Limit Distributions of Multiple Hypothesis Tests
From the viewpoint of the previous section, we will now present a possible
interpretation of Theorem 1 as providing oracle limit distributions of stan-
dard multiple hypothesis tests derived from a ULT and thereby answering
the question why the concept of SCoRE sets is useful.
Here we assume the setting and notations of Theorem 1. In particular,
we assume that an estimator ˆ µNof a target function µsatisfying (A1) -(A4)
is given, as well as, two sets A,B ⊆ F (S). Thus, as ˆ µNsatisfies a ULT the
canonical tests for the hypotheses (7) are
Ts,a
≤,q=(
reject ,if ˆµN(s)≥a(s) +qτNσ(s),i.e.,s∈ˆUa+qτNσ
accept ,else
Ts,b
≥,q=(
reject ,if ˆµN(s)≤a(s)−qτNσ(s),i.e.,s∈ˆLb−qτNσ
accept ,else,(10)
where q≥0 is a parameter, which can be chosen to control the level of
the test. By Definition 8 it holds that H≤a
0=S\ Ua,ˆH≤a
0=S\ˆUa+qτNσ,
H≥b
0=S\Lband ˆH≥b
0=S\ˆLb−qτNσ. Thus, applying the limes superior and
limes inferior to (8) we obtain from Theorem 1 the next corollary. We call
this result the oracle limit distribution of the joint tests given in (10) over all
a∈ Aandb∈ Bbecause it provides explicitly the sharp limit distribution
of the joint FWER for each possible µ∈ℓ∞(S).
Corollary 4 (Oracle Limit Distribution of FWER) .Assume the notation
and assumptions of Theorem 1. Then the joint FWER of the tests given by
(10) on the hypotheses (7)fora∈ A andb∈ Bsatisfies
lim
N→∞FWER
H≤A
0,H≥B
0
= 1−P
TA,B(G)≺q
for all µ∈ℓ∞(S). In particular, given α∈(0,1)andqαsuch that
P∗
TA,B(G)< qα
≥1−α ,
it holds that the tests given by (10) using q=qαcontrol the joint FWER
over all hypotheses H≤a
0,sandH≥b
0,sfor all s∈S,a∈ Aandb∈ Bat level α.
Remark 13.It is noteworthy that changing the hypotheses in (7) to
H<a
0,s:µ(s)< a(s) vs H<a
1,s:µ(s)≥a(s)
H>b
0,s:µ(s)> b(s) vs H>b
1,s:µ(s)≤b(s)
18does not have the oracle limit distribution from Corollary 4. The reason is
that the natural test obtained from the ULT is
T≤a
s,q=(
reject ,ifs∈S\ˆLa+qτNσ
accept ,else
T≥b
s,q=(
reject ,ifs∈S\ˆUb−qτNσ
accept ,else.
Thus, while the asymptotic upper bound of the FWER remains the same,
the lower bound is only identical under further assumptions, for example,
onAandB, or under restrictions of the set of possible target functions µas
provided by [Mammen and Polonik, 2013, Assumption (A.ii)] and [Sommer-
feld et al., 2018, Assumption 2.1(a)], compare Section E in particular Figure
8. Thus, from our asymptotic oracle distribution view on multiple testing
it is preferable that the null hypothesis at each sis a closed set because
otherwise the FWER can only be controlled conservatively for some µ.
Remark 14.Corollary 4 means that Theorem 1 yields joint tests for the
hypotheses (7) for any two sets of functions AandB. An inconvenience is
thatTA,B(G) =−∞for all µsuch that u−
A∪u+
B=∅. Thus, any q∈Ryields
in this case a test that asymptotically controls the FWER in the strong
sense at any α >0. In the next sections we propose solutions based on ideas
from Dette et al. [2020] that make the quantile qunique.
4.3 Global Relevance Tests
In the literature on statistical inference in the Banach space C(S) the global
relevance hypothesis, i.e.,
H0:∀s∈S:µ(s)∈
−∆,∆
vs.H1:∃s∈S:µ(s)/∈
−∆,∆
for ∆ ≥0, has recently gained attention in Dette et al. [2020], Dette and
Kokot [2022], Dette and Tang [2021]. In all these articles the strategy to ob-
tain a test at level αis based on the supremums norm ∥f∥∞= sups∈S|f(s)|
fors∈S. The next box summarizes this approach conceptually.
I. Define an estimator ˆ µNofµand prove that it satisfies a ULT
inC(S), i.e., there exists a random process GonSsuch that 
ˆµN−µ
/τN⇝Gweakly in C(S).
19II. Use the CLT from I. to prove 
∥ˆµN∥∞− ∥µ∥∞
/τN⇝T 
E
for
T 
E
= maxn
sup
s∈E+G(s),sup
s∈E−−G(s)o
(11)
depending on the extremal sets E±=
s∈S|µ(s) =±∥µ∥∞	
.
III. Obtain the (1 −α) quantile q1−αofT 
E
.
IV. Reject H0at significance level α, if∥ˆµN∥∞>∆ +τNq1−α
The latter is justified by their observation that II. implies
lim
N→∞Ph
∥ˆµN∥∞>∆ +τNq1−αi
=

0,∥µ∥∞<∆
α ,∥µ∥∞= ∆
1,∥µ∥∞>∆(12)
As the structure of the limit distribution (11) is suspiciously similar to
Ta,b= max(
sup
s∈u−
aG(s),sup
s∈u+
b−G(s))
, (13)
the limit distribution of Corollary 2, it is natural to ask whether and how
they are related. To clarify this, we first note that all considered functions
or sample paths of processes are in C(S) and Sis compact. Hence (A3)
and(A4) are satisfied. Moreover, we have that Step I. implies (A1) and
(A2) for the choice σ(s) = 1 for all s∈Sby [Van Der Vaart et al., 1996,
1.3.10 Theorem]. Finally, the extremal sets E±satisfy
E±=
s∈S|µ(s) =±∥µ∥∞	
=µ−1
±∥µ∥∞=u±
±∥µ∥∞.
which shows using a(s) =∥µ∥∞andb(s) =−∥µ∥∞for all s∈Sin (13) that
T 
E
=T∥µ∥∞,−∥µ∥∞. (14)
Assuming q1−αbeing given by Step III, we obtain from Corollary 2 that
1−α= lim
N→∞P∗h
ˆU∥µ∥∞+τNq1−α⊆ U∥µ∥∞∧ˆL−∥µ∥∞−τNq1−α⊆ L−∥µ∥∞i
= lim
N→∞P∗h
ˆU∥µ∥∞+τNq1−α=∅ ∧ ˆL−∥µ∥∞−τNq1−α=∅i
= lim
N→∞P∗h
∥ˆµN∥∞≤ ∥µ∥∞+τNq1−αi
20which is equivalent to the case ∆ = ∥µ∥∞in (12). Similarly, Corollary 2
yields for ∆ >∥µ∥∞that
1 =Ph
T∆,−∆(G)≤q1−αi
= lim
N→∞P∗h
ˆU∆+τNq1−α⊆ U ∆∧ˆL−∆−τNq1−α⊆ L−∆i
= lim
N→∞P∗h
∥ˆµN∥∞≤∆ +τNq1−αi
asµ−1
±∆=∅. Note that this is equivalent to the case ∆ >∥µ∥∞in (12). In
order to obtain the case ∆ <∥µ∥∞, we compute
lim
N→∞P∗h
∥ˆµN∥∞>∆ +τNq1−αi
= lim
N→∞P∗h
ˆU∆+τNq1−α̸=∅ ∨ ˆL−∆−τNq1−α̸=∅i
= 1−lim
N→∞P∗h
ˆU∆+τNq1−α=U∥µ∥∞∧ˆL−∆−τNq1−α=L−∥µ∥∞i
≥1−lim
N→∞P∗h
ˆU∆+τNq1−α⊆ U∥µ∥∞∧ˆL−∆−τNq1−α⊆ L−∥µ∥∞i
= 1
where the last equality follows from Lemma 3 from Appendix B. Thus, we
recovered also the case ∆ <∥µ∥∞in (12).
After the above analysis it is not surprising that Corollary 2 enables us
to test the hypothesis
H0:∀s∈S:µ(s)∈
b(s), a(s)
vs.H1:∃s∈S:µ(s)/∈
b(s), a(s)
.
fora, b∈ F(S) under weak condition. The global relevance test for the
above hypothesis based on Corollary 2 is
Reject H 0⇐⇒ ˆUa+qτNσ̸=∅ ∨ ˆL−b−qτNσ̸=∅. (15)
In contrast to the general strategy discussed above this test can take the
asymptotic variance of the estimator ˆ µNinto account by setting σidentical
to the square root of the asymptotic variance. Similar arguments as above
then prove the following theorem which generalizes (12).
Theorem 3. Letα∈(0,1),a, b∈ F(S),δ= max {δa, δb}with
δa= sup
s∈S
µ(s)−a(s)	
, δ b= sup
s∈S
b(s)−µ(s)	
, (16)
21A=
a+δ	
andB=
b−δ	
. Assume that (A1) is satisfied and qαfulfills
P
Ta+δ,b−δ(G)≥qα
≤α. Then the global relevance test given in (15) with
quantile q=qαsatisfies
(a)Case δ= 0: If(A2) and(A3) are satisfied, then
lim
N→∞P∗
H0is rejected
≤α .
If(A4) is satisfied, then
lim
N→∞P∗
H0is rejected
≥Ph
Ta+δ,b−δ(G)> qαi
.
(b)Case δ <0:limN→∞P∗
H0is rejected
= 0.
(c)Case δ >0:limN→∞P∗
H0is rejected
= 1.
Remark 15.Ifu+
a+δ∪u−
b−δ=∅, then all q∈Rsatisfy P
Ta+δ,b−δ(G)≥
q
= 0≤α. However, our construction implies u+
a+δ∪u−
b−δ̸=∅. This
follows directly from the definition of δand the definition of the generalized
preimage because δsatisfies that a(s) +δ≥µ(s) and b(s)−δ≤µ(s) for all
s∈Sand by construction either u+
a+δ̸=∅oru−
b−δ̸=∅.
4.4 A Local Relevance Test with Strong FWER Control
In the last section we saw that the global relevance hypothesis can be re-
jected at level αif certain estimated excursion sets are empty. In applications
one is usually not only interested in finding evidence for µnot being some-
where within a given envelop defined by the intervals [ b(s), a(s)],s∈S, but
wants to localize where µ(s)/∈[b(s), a(s)]. Translated into the language of
hypothesis testing this is a multiple hypothesis test for the alternatives
H0,s:µ(s)∈
b(s), a(s)
vs. H1,s:µ(s)/∈
b(s), a(s)
,
which controls the FWER in the strong sense at level α. We will call such
a test a local relevance test. The idea is to use the membership in the
excursion set for a decision on H0,s, i.e.,
Reject H 0,s⇐⇒ s∈ˆUa+qτNσ∨s∈ˆLb−qτNσ. (17)
As the set of true null hypotheses is H0=S\(Ua∪ Lb), we immediately
can show that a test defined by (17) satisfies
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗h
H0⊆S\ ˆUa+qτNσ∪ˆLb−qτNσi
≤1−P∗h
ˆUa+qτNσ⊆ Ua∧ˆLb−qτNσ⊆ L bi
.(18)
22Thus, we can asymptotically control the FWER using Corollary 2 by choos-
ingqappropriately. The only problem is –as in the global test case – that
in general u+
a∪u−
bcan be the empty set which implies that the r.h.s of (18)
is asymptotically equal to 0 for all q∈R. Therefore, inspired by the global
relevance case and Dette et al. [2020], we find the smallest δ >0 such that
u+
a+δ∪u−
b−δ̸=∅, yetUa=Ua+δandLb=Lb−δto make qunique.
Theorem 4. Letα∈(0,1),a, b∈ F(S),δ= min {δa, δb}with
δa= sup
s∈Sµ(s)−a(s), δ b= sup
s∈Sb(s)−µ(s), (19)
A=
a+δ	
andB=
b−δ	
. Assume that (A1) is satisfied and qαfulfills
P
Ta+δ,b−δ(G)≥qα
≤α, ifu+
a+δ∪u−
b−δ̸=∅, and qα= 0else. Then the
local relevance test given by (17) with quantile q=qαsatisfies
(a) Assume (A2) and(A3) , then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
≤α .
Assume (A4) , then
lim
N→∞P∗
∀s∈ˆH1:s∈ H 1
≥1−α .
(b)Case δ= 0: If(A4) and either H0=Sorinfs∈S 
a(s)−b(s)
≥
M > 0hold true. Then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
≥Ph
Ta+δ,b−δ+(G)> qαi
.
Define HηN
1=Lb−−ηN∪Ub++ηN. IfηNN→∞− − − − → 0andτ−1
NηNN→∞− − − − → ∞ ,
then
lim
N→∞P∗
∀s∈ HηN
1:s∈ˆH1
= 1.
(d)Case δ >0:Then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
= 0, lim
N→∞P∗
∀s∈ H 1:s∈ˆH1
= 1.
Remark 16.One sided hypothesis tests can be obtained by setting either
a(s) =∞orb(s) =−∞ for all s∈Sfor all s∈S. The two-sided point
hypotheses for a single b∈ F(S) is the special case where a=b. Theorem
4 shows that our test is asymptotically a consistent test that controls the
FWER at level α. This test is uniformly more powerful than the standard
asymptotic single-step test which uses the quantiles of max s∈S|G(s)|.
23Figure 4: Illustration of the critical sets u−
aandu−
∥µ∥∞of Theorem 3 and 4
respectively. Under stationarity of Git holds that the smaller the Lebesgue
volume of the critical set the smaller is the threshold q, i.e., the power to
reject the null hypothesis from Theorem 3 is higher. Left: the local relevance
test has a higher power. Right: the global relevance test has a higher power.
Remark 17.The local relevance test also yields a test for the global relevance
hypothesis. Interestingly, the global test is not uniformly more powerful than
the local test in detecting departures from the global null. The reason is that
the tests from Theorem 3 and 4 only differ in the definition of the critical
sets over which the maxima of ±Gare taken. In Figure 4 we illustrate this
under the assumption that Gis stationary.
4.5 Equivalence Tests
In Dette and Kokot [2021] a global equivalence test for data in C(S),S=
[0,1], is proposed. In this section we show that again Corollary 2 can be
used to weaken the assumptions of their testing strategy.
Assume a, b∈ F(S) such that b(s)< a(s) for all s∈Sare given. The
statistical hypotheses of an equivalence test are the hypotheses
H0:∃s∈S:µ(s)/∈ 
b(s), a(s)
vs.H1:∀s∈S:µ(s)∈ 
b(s), a(s)
.
Thus, the natural test statistic based on excursion sets is
Reject H 0⇐⇒ ˆUa+qτNσ=∅ ∧ ˆL−b−qτNσ=∅. (20)
Using this we can generalize the test procedure proposed in Dette and Kokot
[2021] similar as in Theorem 3.
24Theorem 5. Letα∈(0,1),a, b∈ F(S)such that infs∈S|a(s)−b(s)|>0,
δbe defined as in Theorem 3, A=
a+δ	
andB=
b−δ	
. Assume
that(A1) is satisfied and qαfulfills P
Ta+δ,b−δ(G)≤qα
≤α. Then the
equivalence test given in (20) with quantile q=qαsatisfies
(a)Case δ= 0: If(A4) is satisfied, then
lim
N→∞P∗
H0is rejected
≤α .
If(A2) and(A3) are satisfied, then
lim
N→∞P∗
H0is rejected
≥P
Ta+δ,b−δ(G)< qα
.
(b)Case δ >0:limN→∞P∗
H0is rejected
= 0.
(c)Case δ <0:limN→∞P∗
H0is rejected
= 1.
Remark 18.If we assume that µ,ˆµN, a, b∈C([0,1]) and σ(s) = 1, s∈S,
then simple algebra shows that the above testing strategy is identical to
the testing strategy from Dette and Kokot [2021], because ˆUa+qτNσ=∅and
ˆL−b−qτNσ=∅is equivalent to
max
sup
s∈SˆµN(s)−a(s),sup
s∈Sb(s)−ˆµN(s)
≤τNqα
and their theoretical quantile is identical to qα. The only difference is that
in the definition of the quantile they use ” <”, which is irrelevant as in their
model the cumulative distribution function of Ta+δ,b−δ(G) is continuous.
Remark 19.Using Remark 9 and comparing the assumptions of Theorem 3
and 5 we can conclude that the assumptions to get an equivalence test that
asymptotically controls the FWER requires much weaker assumptions than
in a relevance test, i.e., ˆ µNneeds to satisfy a ULT only on µ−1
{a+δ}∪µ−1
{b−δ},
while Theorem 3 requires a ULT on an ˜ η-thickening of µ−1
{a−δ}∪µ−1
{b+δ}.
4.6 Local Equivalence Tests
We finally discuss a local version of the equivalence hypothesis, i.e.,
H0,s:µ(s)/∈ 
b(s), a(s)
vs.H1,s:µ(s)∈ 
b(s), a(s)
,
fora, b∈ F(S) such that inf s∈Sa(s)−b(s)>0. A test based on excursion
sets is the following:
Reject H 0,s⇐⇒ s∈S\ˆUa−qτNσ∩S\ˆLb+qτNσ. (21)
We can proof a similar Theorem as Theorem 3 for the local equivalence test.
25Theorem 6. Letα∈(0,1),a, b∈ F(S),δbe defined as in Theorem 4,
A=
a−δ	
andB=
b+δ	
. Assume that (A1) is satisfied and qαfulfills
P
Tb−δ,a+δ(G)≥qα
≤α, ifu+
b−δ∪u−
a+δ̸=∅, and qα= 0else. Then the
local equivalence test given by (21) with quantile q=qαsatisfies
(a) Assume (A2) and(A3) , then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
≤α .
Assume (A4) , then
lim
N→∞P∗
∀s∈ˆH1:s∈ H 1
≥1−α .
(b)Case δ= 0: If(A4) and either H0=Sorinfs∈S 
a(s)−b(s)
≥
M > 0hold true. Then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
≥Ph
Ta+δ,b−δ(G)> qαi
.
Define HηN
1=Lb−−ηN∪Ub++ηN. IfηNN→∞− − − − → 0andτ−1
NηNN→∞− − − − → ∞ ,
then
lim
N→∞P∗
∀s∈ HηN
1:s∈ˆH1
= 1.
(d)Case δ >0:Then
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
= 0, lim
N→∞P∗
∀s∈ H 1:s∈ˆH1
= 1.
Remark 20.A standard approach for an equivalence test of a parameter
µ∈Ris the Principle of Confidence Interval Inclusion (PCII) [Wellek, 2010,
Chapter 3.1]. Let Xdenote the observations and C±(X;α) the one-sided
(1−α)-confidence bounds for µ, i.e.,
P
µ∈ 
− ∞, C−(X;α)
=P
µ∈ 
C+(X;α),∞
=α .
Letb < a . The alternatives H0:µ /∈(b, a) vs.H1:µ∈(b, a) can be tested
at significance level αby rejecting H0if 
C−(X;α), C+(X;α)
⊆(b−, b+).
By construction the interval 
C−(X;α), C+(X;α)
constitutes a (1 −2α)-
CI for µ. This explains the name of the principle. The first conservative
equivalence test was derived in the above fashion in Westlake [1972] using a
(1−α)-CI. We argue now that the conservativeness has been a relic of using a
26CI instead of SCoRE sets. To see this, assume ˆ µNsatisfies τ−1
N(ˆµN−µ)/σ⇝
Gand define C±(X;α) = ˆµN±q±
ατNσwith q±
αsatisfying P
∓G≤q±
α
=
1−α. The PCII rejects H0if
ˆµN∈ 
b+τNq−
ασ, a−τNq+
ασ
.
The connection to the local equivalence test based on SCoRE sets is as
follows. It can be easily verified that qαfrom Theorem 6 satisfies
qα=(
q+
α,if|µ−a| ≤ |µ−b|
q−
α,else
and that the local equivalence test based on SCoRE sets rejects H0if
ˆµN∈ 
b+τNqασ, a−τNqασ
,
which is exactly the test derived from the PCII if Ghas a symmetric distri-
bution.
5 An Application to Scheff´ e Type Inference For
Multiple Linear Regression
In order to highlight potential benefits from statistical inference using SCoRE
sets, we compare them in this section with Scheff´ e’s simultaneous testing for
all contrasts in multiple linear regression models. In order to explain the dif-
ference more concretely, we keep the considered probabilistic model simple
by restricting ourselves to homoscedastic Gaussian errors.
Let (XN)N∈N∈RN×Kbe a sequence of design matrices of rank K < N ,
(τN)N∈Nbe a sequence satisfying lim N→∞τ−2
N(XT
NXN)−1=X∈RK×K
with Xinvertible and the observations yNare generated from a linear
model, i.e., yN∼ N 
XNβ, ξ2IN×N
with ξ∈R>0. Recall that ˆβN=
(XT
NXN)−1XT
NyN,N∈N, is the uniformly minimum-variance unbiased es-
timator (UMVU) of β. Usually not β, but linear contrasts µ(a) =aTβ,
a∈RK, are of interest. Interpreting a∈RKas the parameter set, we
define a stochastic process indexed in RKand its asymptotic variance by
ˆµN(a) =aTˆβN,σ2(a) =ξ2aTXa. Since all involved quantities are Gaus-
sian and continuous in a, we obtain
GN(a) =ˆµN(a)−µ(a)
τNξ√
aTXa⇝G(a) (22)
27weakly in C 
RK
, where Gis the zero-mean Gaussian process with covari-
ance function
c(a,b) =aTXb√
aTXa√
bTXb,fora,b∈RK.
Since GN(a) =GN(˜a) and G(a) =G(˜a) with ˜a=a/∥a∥, the domain of the
processes can be assumed to be the compact space SK−1={a∈RK| ∥a∥=
1}instead of RK.
A standard task in multiple linear regression is finding contrasts b∈
SK−1using the observations yNsuch that with high probability b∈ {a∈
SK−1|aTβ̸= 0}. This can be achieved for example using SCBs Scheff´ e
[1953]. The asymptotic analogue of Scheff´ e’s (1 −α)-SCBs for contrasts are
given by the intervals with endpoints
ˆµ(a)±q1−α,Kσ(a) =aTˆβN±τNq1−α,Kξ√
aTXa, (23)
where q2
1−α,Kis the (1 −α)-quantile of a χ2
K-distributed random variable
[Rencher and Schaalje, 2008, eq. (8.71)]. Based on this and using Theorem
8.5 from Rencher and Schaalje [2008] the asymptotic version of Scheff´ e’s test
rejects the null hypothesis of aTβ= 0 for all a∈SK−1at significance level
α, if
ξ−2 ˆβT
NXTXˆβN2> τ2
Nq2
1−α,K,
which is equivalent to the existence of a∈SK−1such that zero is not
contained in the interval given by (23). Our Corollary 1 shows that this SCB
contains more information than allowing us to perform a valid hypothesis
test for aTβ= 0 for all a∈SK−1. We actually know that
Ph
∀c∈ F 
RK
:ˆLc−q1−α,KKσ⊆ L c∧ˆUc+q1−α,KKσ⊆ Uci
= 1−α .
This implies for the function csatisfying c(a) = 0 for all a∈SK−1that all
contrasts b∈SK−1contained in either of the two sets
ˆL−τNq1−α,Kσ=n
a∈SK−1:aTˆβ<−τNq1−α,Kξ√
aTXao
,
ˆUτNq1−α,Kσ=n
a∈SK−1:aTˆβ> τNq1−α,Kξ√
aTXao
are asymptotically with probability at least 1 −αcorrectly discovered to be
non-zero contrasts, i.e., b∈ {a∈SK−1|aTβ̸= 0}=Lc∪ Uc. This result
holds independently of the actual value of β. The drawback is low detection
power since it allows to simultaneously construct confidence subsets for any
28function c∈ F(Sk−1). The power can be improved by applying our Corollary
3 which gives upper and lower confidence subsets solely for the function
c(a) = 0 for all a∈SK−1.
Corollary 5. Assume the multiple linear regression model depending on N
as defined above. Let c(a) = 0 for all a∈SK−1andq∈R≥0. Then
lim
N→∞Ph
ˆL−τNqσ⊆ L 0∧ˆUτNqσ⊆ U 0i
=χ2 
q2, K−1 +1β=0
.
Here 1β=0is the indicator function, i.e., one, if β= 0, and zero else,
andu7→χ2(u, k)is the cumulative distribution function of a χ2
k-distributed
random variable.
Ifβ= 0 is true or we want to secure ourselves against this case, the above
corollary does not and should not allow to improve the detection power
compared to the asymptotic SCB approach based on Scheff´ e as in this case
the limit distribution agrees with the limit distribution used to construct the
SCB. However, by taking into account that the limit distribution depends
on the true βas shown in the above result, we can devise a more powerful
strategy to detect non-zero contrasts a∈RKforβ, while controlling the
FWER at level α.
To do so we use contrary to the SCBs the β̸= 0 case to tune the quantile
for detection. If q2
1−α,K−1is the (1 −α)-quantile of a χ2
K−1-distributed
random variable, then Corollary 5 yields
lim
N→∞Ph
ˆL−τNq1−α,K−1σ⊆ L 0∧ˆUτNq1−α,K−1σ⊆ U 0i
=(
1−α , ifβ̸= 0
χ2 
q2
1−α,K−1, K
,ifβ= 0.
This means that, if β̸= 0, all as non-zero discovered contrasts a, i.e.,
a∈ˆL−τNq1−α,K−1σ∪ˆUτNq1−α,K−1σ, are asymptotically with probability 1 −α
correctly identified to be non-zero. On the other hand, if β= 0, it holds
thatL0=U0=∅. Thus, asymptotically the probability to find (wrongly)
a non-zero contrast is 1 −χ2 
q2
1−α,K−1, K
> α. This is the quantifiable
price to pay for a higher power. To illustrate it, assume α= 0.05 and
k= 4. Then all discovered contrasts are with probability 0 .95 correctly
identified to be non-zero contrasts, if the true β̸= 0. In the worst case that
β= 0, then the probability of wrongly discovering a non-zero contrast is
1−χ2 
q2
0.95,3,4
≈0.1. As it is impossible to judge with certainty whether
β= 0, the researcher can use the information from ˆβto judge how risky
it is to ignore the worst case scenario and communicate this in forms of
confidence bands for βor alike.
296 Discussion
In this article we refined, extended and unified different statistical inference
tools for a target function µfrom an estimator ˆ µNwhich control FWER-
like criteria over a metric space S. In particular, we demonstrated that
CoPE sets Sommerfeld et al. [2018], SCBs and recently proposed relevance
and equivalence tests for C(S)-valued data based on the supremum norm,
among others Dette et al. [2020], can all be derived from Theorem 1. Fur-
thermore, our abstract viewpoint allowed us to weaken the assumptions of
the aforementioned methods and clarify some of their conceptual shortcom-
ings, for example, by changing the definition of the inclusion statement from
Sommerfeld et al. [2018]. We finish our current endeavor with a few remarks
and directions for future research.
As, for example, in nonparametric statistics ˆ µNoften does not satisfy a
ULT, it is worthwhile to explore assumptions different to (A1) -(A3) which
enable us to compute the limit distributions given in the SCoRE set Metathe-
orem from Appendix C. Especially, it might be possible to derive the testing
strategy from B¨ ucher et al. [2021] MARKER (maybe add more) from our
SCoRE sets framework as it is very similar to the testing problems discussed
in this work, yet their estimator does not satisfy a ULT. Additionally, we
believe that the SCoRE set metatheorem and the change of the inclusion
statement might allow us to remove Assumption 2.2.3 from Maullin-Sapey
et al. [2023] and extend their construction of confidence regions for intersec-
tions and unions of excursion sets of several estimators to more complicated
combinations of excursion sets such as the symmetric difference. Further-
more, it would be of interest to extend our current theory to develop honest
and adaptive SCoRE sets which would generalize the concept of honest and
adaptive simultaneous confidence bands, among others, Li [1989], Gin´ e and
Nickl [2010], Hoffmann and Nickl [2011], or to relax the relatively strict
FWER like requirement for the inclusion statements to hold with a cer-
tain probability in our SCORE sets to weaker assertions resembling FDR
(e.g.,Benjamini and Hochberg [1995]) or k-FWER (e.g., Lehmann and Ro-
mano [2005]) multiple comparison corrections.
Finally, as one of our main contributions was to shed light on the connec-
tions between confidence regions for excursion sets and hypothesis testing,
we want to remedy a misconception from Bowring et al. [2019] which mo-
tivates CoPE sets as a solution to the paradox caused by the fallacy of
the null hypothesis Rozeboom [1960]. They write ”[...] the paradox is that
while statistical models conventionally assume mean-zero noise, in reality
all sources of noise will never cancel, and therefore improvements in exper-
30imental design will eventually lead to statistically significant results. Thus,
the null hypothesis will, eventually, always be rejected Meehl [1967]. [...]”
and later they write ”[...] Unlike hypothesis testing, our spatial Confidence
Sets (CSs) allow for inference on non-zero raw effect sizes. [...]” . The
fallacy of the null hypothesis can be an important practical problem. Yet
CoPE sets fall short being a conceptual solution because they still assume
a zero-mean noise model. Therefore their inference on level sets cof the
true signal suffers from the same problem of finding signals above cif the
noise is not zero-mean. To make this point more clear by our established
duality Proposition 1 any FWER test with strong control at level αwhich
tests the alternatives H0,s:µ(s) =cvs.H1,s:µ(s)̸=cwould be a
solution to the fallacy of the null hypothesis, if CoPE sets are. An actual
possibility to dissipate Meehl’s concern are for example (1 −α)-SCoRE sets
over 
{c+ ∆},{c−∆}
, ∆>0, if we can assume that the mean of the error
process is bounded within [ −∆,∆]. Yet again this approach is dual to a
local relevance test by Proposition 1.
So what are the advantages of SCoRE sets over hypothesis testing? First
and foremost SCoRE sets break with the dogma of phrasing research ques-
tions in terms of statistical hypotheses. They emphasize what really matters:
a quantifiable observable µand what can be concluded from an experiment
about the uncertainty of preimages of µwhich are relevant for the researcher.
Secondly, they allowed us to derive the oracle limiting distributions for the
canonical hypotheses tests derived from a ULT that control the FWER in
the strong sense at level αand thereby disclose the actual target of such
multiple tests. Thirdly, the natural interpretation of SCoRE sets, nicely
presented4forA=B={c}in Fig.1 of Bowring et al. [2019], is closer to the
interpretation of confidence intervals and therefore hopefully does cause less
confusion among students, practitioners and experts than the interpretation
of tests and p-values.
Acknowledgments
F.T. is funded by the Deutsche Forschungsgemeinschaft (DFG) under Ex-
cellence Strategy The Berlin Mathematics Research Center MATH+ (EXC-
2046/1, project ID:390685689). F.T. and A.S. were partially supported by
NIH grant R01EB026859. The first ideas of this paper emerged during a
4The description actually corresponds to the inclusion statement from this article and
not to the inclusion statement from Sommerfeld et al. [2018] that was used to generate
the figure.
31revision of a project with A. Bowring and T. Nichols and we are thank-
ful to both for helpful discussions in early stages of the manuscript. F.T.
also wants to thank the WIAS Berlin, where parts of this research was per-
formed, for offering a guest researcher status and especially K. Tabelow and
J. Pohlzehl for their general hospitality. F.T. thanks D. Liebl for reading
through the introduction and the example on multiple linear regression and
giving precious ideas how to streamline the presentation and providing the
opportunity to present parts of this work on a conference and in a seminar in
Bonn. F.T. owes special gratitude to B. Stankewitz for tremendous psycho-
logical support during Covid times, helpful discussions on uniform conver-
gence (Lemma 5), struggling through the introduction and giving valuable
feedback when the notation was still a complete mess.
References
Jerzy Neyman. Outline of a theory of statistical estimation based on the
classical theory of probability. Philosophical Transactions oftheRoyal
Society ofLondon. Series A,Mathematical andPhysical Sciences, 236
(767):333–380, 1937.
Erich Leo Lehmann, Joseph P Romano, and George Casella. Testing
statistical hypotheses, volume 3. Springer, 2005.
John Aitchison. Confidence-region tests. Journal oftheRoyal Statistical
Society: Series B(Methodological), 26(3):462–476, 1964.
J Aitchison. Likelihood-ratio and confidence-region tests. Journal ofthe
Royal Statistical Society: Series B(Methodological), 27(2):245–250, 1965.
K Ruben Gabriel. Simultaneous test procedures–some theory of multiple
comparisons. TheAnnals ofMathematical Statistics, 40(1):224–250, 1969.
Gunnar Stefansson. On confidence sets in multiple comparisons. Statistical
Decision Theory andRelated Topics IV, 2:89–104, 1988.
Anthony J Hayter and Jason C Hsu. On the relationship between step-
wise decision procedures and confidence sets. Journal oftheAmerican
Statistical Association, 89(425):128–136, 1994.
Sture Holm. Multiple confidence sets based on stagewise tests. Journal of
theAmerican Statistical Association, 94(446):489–495, 1999.
32Olivier Guilbaud. Simultaneous confidence regions corresponding to holm’s
step-down procedure and other closed-testing procedures. Biometrical
Journal: Journal ofMathematical Methods inBiosciences, 50(5):678–692,
2008.
Dominic Magirr, Thomas Jaki, Martin Posch, and F Klinglmueller. Simul-
taneous confidence intervals that are compatible with closed testing in
adaptive designs. Biometrika, 100(4):985–996, 2013.
Ronald L Wasserstein and Nicole A Lazar. The asa statement on p-values:
context, process, and purpose. TheAmerican Statistician, 70(2):129–133,
2016.
Wilfred J Westlake. Use of confidence intervals in analysis of comparative
bioavailability trials. Journal ofPharmaceutical Sciences, 61(8):1340–
1341, 1972.
DL Schuirmann. On hypothesis-testing to determine if the mean of a normal-
distribution is contained in a known interval. In Biometrics, volume 37,
pages 617–617, 1981.
Donald J Schuirmann. A comparison of the two one-sided tests procedure
and the power approach for assessing the equivalence of average bioavail-
ability. Journal ofPharmacokinetics andBiopharmaceutics, 15(6):657–
680, 1987.
WW Hauck and S Anderson. Types of bioequivalence and related statistical
considerations. International Journal ofClinical Pharmacology, Therapy,
andToxicology, 30(5):181–187, 1992.
Roger L Berger and Jason C Hsu. Bioequivalence trials, intersection-union
tests and equivalence confidence sets. Statistical Science, 11(4):283–319,
1996.
Max Sommerfeld, Stephan Sain, and Armin Schwartzman. Confidence
regions for spatial excursion sets from repeated random field observa-
tions, with an application to climate. Journal oftheAmerican Statistical
Association, 113(523):1327–1340, 2018.
Alexander Bowring, Fabian Telschow, Armin Schwartzman, and Thomas E
Nichols. Spatial confidence sets for raw effect size images. NeuroImage,
203:116187, 2019.
33Alexander Bowring, Fabian JE Telschow, Armin Schwartzman, and
Thomas E Nichols. Confidence Sets for Cohen’s deffect size images.
NeuroImage, 226:117477, 2021.
Junting Ren, Fabian JE Telschow, and Armin Schwartzman. Inverse set esti-
mation and inversion of simultaneous confidence intervals. arXiv preprint
arXiv:2210.03933, 2022.
Holger Dette and Jiajun Tang. Statistical inference for function-on-function
linear regression. arXiv preprint arXiv:2109.13603, 2021.
Holger Dette and Kevin Kokot. Detecting relevant differences in the covari-
ance operators of functional time series: a sup-norm approach. Annals of
theInstitute ofStatistical Mathematics, 74(2):195–231, 2022.
Holger Dette and Kevin Kokot. Bio-equivalence tests in functional data by
maximum deviation. Biometrika, 108(4):895–913, 2021.
Enno Mammen and Wolfgang Polonik. Confidence regions for level sets.
Journal ofMultivariate Analysis, 122:202–214, 2013.
Wanli Qiao and Wolfgang Polonik. Nonparametric confidence regions for
level sets: Statistical properties and geometry. Electronic Journal of
Statistics, 13(1):985–1030, 2019.
Joshua P French, Seth McGinnis, and Armin Schwartzman. Assessing nar-
ccap climate model effects using spatial confidence regions. Advances
inStatistical Climatology, Meteorology andOceanography, 3(2):67–92,
2017.
T Maullin-Sapey, A Schwartzman, and TE Nichols. Spatial confidence re-
gions for combinations of excursion sets in image analysis. Journal ofthe
Royal Statistical Society: Statistical Methodology Series B, 2023.
David A Degras. Simultaneous confidence bands for nonparametric regres-
sion with functional data. Statistica Sinica, pages 1735–1765, 2011.
Fabian JE Telschow and Armin Schwartzman. Simultaneous confidence
bands for functional data using the Gaussian kinematic formula. Journal
ofStatistical Planning andInference, 216:70–94, 2022.
Dominik Liebl and Matthew Reimherr. Fast and fair simultaneous confi-
dence bands for functional parameters. arXiv preprint arXiv:1910.00131,
2019.
34Holger Dette, Kevin Kokot, and Alexander Aue. Functional data analysis
in the Banach space of continuous functions. TheAnnals ofStatistics, 48
(2):1168–1192, 2020.
Holger Dette, Kathrin M¨ ollenhoff, Stanislav Volgushev, and Frank Bretz.
Equivalence of regression curves. Journal oftheAmerican Statistical
Association, 113(522):711–729, 2018.
Aad W Van Der Vaart, Adrianus Willem van der Vaart, Aad van der
Vaart, and Jon Wellner. Weak convergence andempirical processes: with
applications tostatistics. Springer-Verlag, New York, 1996.
Alexey A Tuzhilin. Lectures on Hausdorff and Gromov-Hausdorff distance
geometry. arXiv preprint arXiv:2012.00756, 2020.
Sture Holm. A simple sequentially rejective multiple test procedure.
Scandinavian journal ofstatistics, pages 65–70, 1979.
Stefan Wellek. Testing statistical hypotheses ofequivalence. Chapman and
Hall/CRC, Boca Raton, 2010.
Henry Scheff´ e. A method for judging all contrasts in the analysis of variance.
Biometrika, 40(1-2):87–110, 1953.
Alvin C Rencher and G Bruce Schaalje. Linear models instatistics. John
Wiley & Sons, Inc., Hoboken, New Jerseys, 2008.
Axel B¨ ucher, Holger Dette, and Florian Heinrichs. Are deviations in a
gradually varying mean relevant? A testing approach based on sup-norm
estimators. TheAnnals ofStatistics, 49(6):3583–3617, 2021.
Ker-Chau Li. Honest confidence regions for nonparametric regression. The
Annals ofStatistics, 17(3):1001–1008, 1989.
Evarist Gin´ e and Richard Nickl. Confidence bands in density estimation.
TheAnnals ofStatistics, 38(2):1122–1170, 2010.
Marc Hoffmann and Richard Nickl. On adaptive inference and confidence
bands. TheAnnals ofStatistics, 39(5):2383–2409, 2011.
Yoav Benjamini and Yosef Hochberg. Controlling the false discovery rate: a
practical and powerful approach to multiple testing. Journal oftheRoyal
Statistical Society: series B(Methodological), 57(1):289–300, 1995.
35Erich Leo Lehmann and Joseph P Romano. Generalizations of the familywise
error rate. TheAnnals ofStatistics, 33(3):1138–1154, 2005.
William W Rozeboom. The fallacy of the null-hypothesis significance test.
Psychological Bulletin, 57(5):416, 1960.
Paul E Meehl. Theory-testing in psychology and physics: A methodological
paradox. Philosophy ofScience, 34(2):103–115, 1967.
Add somewhere:
Remark 21.Figure 2 shows that, if µis not continuous or there is no set
A′⊆C(S) such that Γ 
A
= Γ 
A′
, then it is necessary in general to
consider the generalized preimage u−1
Ainstead of µ−1
Ain our main theorem.
However, in Appendix D we give a general condition for which u−1
A=µ−1
A.
36A Additional Figures
Figure 5: Illustration of SCoPE sets for A={a}andB={b}using the band
given by ˆ µN±qτNσ.Left: In contrast to a simultaneous confidence band
the true µdoes not need to be inside the band ˆ µN±qτNσeverywhere. Only
close to µ−1
aandµ−1
bit is necessary that ˆ µN−qτNσ < µ and ˆµN+qτNσ > µ
respectively. Right: An example that the SCoRE set inclusion for ais not
satisfied because ˆ µN−qτNσ > µ in a neighbourhood of µ−1
a.
Figure 6: Left: Illustration of obtaining the critical sets for the global rel-
evance and the global relevance test. Right: global relevance hypothesis is
true. Left: global equivalence hypothesis is true.
37B Auxiliary Lemmata
B.1 A Lemma on Inner Probability
The following result should be well-known. We include it for completeness
since we will use it often in our proofs.
Lemma 1. For all A, B⊆Ωit holds that
P∗(A∩B)≥P∗(A)−P∗( Ω\B) =P∗(A) +P∗(B)−1 (24)
Proof. This follows from ( A∩B)∗=A∗∩B∗(e.g., VW 1.2 Exc.15), since
P∗(A∩B) =P(A∗∩B∗)≥P(A∗) +P(B∗)−1 =P∗(A) +P∗(B)−1.
Note that for A⊂Ω the set A∗⊆Ais the (always existing) measurable
set such that P∗(A) =P(A∗). The claim follows from P∗(B) = 1−P∗( Ω\
B).
B.2 Inclusion Lemmas
In this section we assume that N∈N, ˆµNis an estimator of µ∈ℓ∞(S),
τN>0,c∈ F(S),q, σ∈ℓ∞(S) such that 0 <o≤sups∈Sσ(s)≤O<∞
and we use the notation GN=ˆµN−µ
τNσfrom (4).
Lemma 2. Letc∈ F(S),˜η > η > 0and assume there exists K > 0and
ZN:S→Rsuch that for all s∈S\µ−1
{c}˜ηit holds that
 
ˆµN(s)−c(s)
·sgn 
µ(s)−c(s)
≥σ(s) 
K+ZN(s)
. (25)
(i) Let cq=c+qστN. Assume
sup
s∈µ−1
{c}−ηGN(s)−q(s)<0, sup
s∈µ−1
{c}−˜ηGN(s)−q(s)<η
τNO
inf
s∈Sτ−1
NZN(s) +q(s)>−Kτ−1
N,
then ˆUcq⊆ UcandS\ˆLcq⊆S\ Lc.
(ii) Let cq=c−qστN. Assume
inf
s∈µ−1
{c}+ηGN(s)+q(s)>0, inf
s∈µ−1
{c}+˜ηGN(s) +q(s)>−η
τNO
inf
s∈Sτ−1
NZN(s) +q(s)>−Kτ−1
N,
then ˆLcq⊆ L candS\ˆUcq⊆S\ Uc.
38Proof. Only the statements for open excursion sets are proven. The proofs
for the closed excursion sets are almost identical.
We begin with the proof of ( i). Note that ˆUcq⊆ U cis equivalent to
S\ Uc⊆S\ˆUcq. Let s0∈ 
S\ Uc
∩µ−1
{c}−ηwhich implies µ(s0)≤c(s0).
This together with the first inequality of the assumptions yields
ˆµN(s0)−c(s0)
τNσ(s0)≤GN(s0)< q(s0)
showing 
S\Uc
∩µ−1
{c}−η⊆S\ˆUcq. Similarly, s0∈ 
S\Uc
∩µ−1
{c}−˜η∩S\µ−1
{c}−η
satisfies c(s0)−µ(s0)> ηwhich is equivalent to µ(s0) +η < c (s0). Together
with the second inequality of the assumptions this yields
ˆµN(s0)−c(s0)
τNσ(s0)≤GN(s0)−η
σ(s0)τN≤GN(s0)−η
OτN< q(s0)
showing 
S\Uc
∩µ−1
{c}−˜η∩S\µ−1
{c}−η⊆S\ˆUcq. Finally, s0∈ 
S\Uc
∩S\µ−1
{c}−˜η
and
sup
s∈S−τ−1
NZN(s)−q(s)< Kτ−1
N⇔ inf
s∈Sτ−1
NZN(s) +q(s)>−Kτ−1
N
combined with (25) implies that
ˆµN(s0)−c(s0)
τNσ(s0)≤ −Kτ−1
N−τ−1
NZN(s0)<−Kτ−1
N+q(s0) +Kτ−1
N=q(s0).
Thus, 
S\ Uc
∩S\µ−1
{c}−˜η⊆S\ˆUcq. Hence we proved S\ Uc⊆S\ˆUcq.
We prove ( ii) similarly. Again note that ˆLcq⊆ L cis equivalent to S\Lc⊆
S\ˆLcq. Assume s0∈ 
S\ Lc
∩µ−1
{c}+η. Thus, µ(s0)≥c(s0) and the first
inequality of the assumptions yields
ˆµN(s0)−c(s0)
τNσ(s0)≥GN(s0)>−q(s0)
which shows 
S\ Lc
∩µ−1
{c}+η⊆S\ˆLcq. Similarly, s0∈ 
S\ Lc
∩ 
µ−1
{c}+˜η\
µ−1
{c}+η
implies µ(s0)−η > c (s0). Hence, the second inequality of the
assumptions yields
ˆµN(s0)−c(s0)
τNσ(s0)> G N(s0) +η
τNO>−q(s0)
39showing 
S\ Lc
∩ 
µ−1
{c}+˜η\µ−1
{c}+η
⊆S\ˆLcq. Finally, for s0∈ 
S\ Lc
∩
S\µ−1
{c}+˜ηit holds that
µN(s0)−c(s0)
τNσ(s0)≥Kτ−1
N+τ−1
NZN(s0)> Kτ−1
N−q(s0)−Kτ−1
N=−q(s0).
Thus, 
S\ Lc
∩S\µ−1
{c}+˜η⊆S\ˆLcq. Collecting the results yields S\ Lc⊆
S\ˆLcq.
Lemma 3. Letb, c∈ F(S),˜η > 0,ZNbe defined as in Lemma 2 and
c±
q=c±qτNσ. Assume sup
GN(s)|s∈µ−1
{c}˜η	
,infs∈Sτ−1
NZN(s)and
GN(s),s∈µ−1
{c}˜η, are asymptotically tight.
Ifinfs∈S{c(s)−b(s)}>0, then
lim
N→∞P∗ˆUc+
q⊆ Ub
= 1, lim
N→∞P∗ˆLc−
q⊆ L b
= 0,
where we additionally assume Lc\ Lb̸=∅for the second equality.
Ifsups∈S{c(s)−b(s)}<0, it holds
lim
N→∞P∗ˆLc−
q⊆ L b
= 1, lim
N→∞P∗ˆUc+
q⊆ Ub
= 0,
where we additionally assume Uc\ Ub̸=∅for the second equality.
Proof. We only proof the first claim as the proof of the second is similarly.
The assumption δ >0 yields
∆N
s=µ(s)−c(s)
τNσ(s)≤ −δ
τNO
for all s∈S\ Ub. Using this and defining Uc
b=S\ Ubwe obtain
P∗h
ˆUc+
q⊆ Ubi
=P∗"
sup
s∈Uc
bGN(s) + ∆N
s−q(s)≤0#
≥P∗"
sup
s∈Uc
b∩µ−1
{c}˜ηGN(s)−q(s)≤δ
τNO∧ sup
s∈Uc
b∩S\µ−1
{c}˜ηGN(s) + ∆N
s−q(s)≤0#
≥P∗"
sup
s∈Uc
b∩µ−1
{c}˜ηGN(s)−q(s)≤δ
τNO∧ inf
s∈Uc
b∩S\µ−1
{c}˜ηK+ZN(s)
τN+q(s)≥0#
≥P∗"
sup
s∈µ−1
{c}˜ηGN(s)≤δ
τNO− ∥q∥∞#
+P∗"
inf
s∈SK+ZN(s)
τN≥ ∥q∥∞#
−1
40Applying the limes inferior to both sides implies lim N→∞P∗h
ˆUc+
q⊆ Ubi
= 1
by the asymptotic tightness assumption.
Similarly, let s∗∈ L c\ Lb̸=∅, then ∆N(s∗)≤ −δ
τNO. Therefore, if
s∗∈µ−1
{c}˜η,
P∗h
ˆLc−
q⊆ L bi
=P∗h
GN(s∗) + ∆N
s≥ −q(s∗)i
≤1−P∗h
GN(s∗)>−q(s∗) +δ
τNOi
and, if s∗∈S\µ−1
{c}˜η,
P∗h
ˆLc−
q⊆ L b
=P∗h
ˆµN(s∗)−c(s∗)
τNσ(s∗)≥ −q(s∗)i
≤1−P∗h
K+ZN(s∗)
τN> q(s∗)i
.
In both cases applying the limes superior the r.h.s. converges to zero by the
asymptotic tightness assumption.
Lemma 4. Leta, b∈ F(S),aq=a−qτNσ,bq=b+qτNσandinfs∈S 
a(s)−
b(s)
> δ > 0. Assume that inf
GN(s)|s∈µ−1
{b}˜η}andinf
τ−1
NZN(s)|s∈
S	
are asymptotically tight. Then
lim
N→∞P∗h
S\ 
Ub∪ˆLaq
̸=∅i
=lim
N→∞P∗h
S\ 
La∪ˆUbq
̸=∅i
= 0.
Proof. We only show one of the two claims as the proofs are similar. Define
Lc
a=S\ La, then
P∗h
S\ 
La∪ˆUbq
̸=∅i
≤P∗"
inf
s∈LcaˆµN(s)−b(s)
τNσ(s)−q(s)≤0#
≤P∗"
inf
s∈µ−1
{b}˜η∩LcaGN(s)−q(s)≤ −δ
τNo#
+P∗"
inf
s∈SK+ZN(s)
τN−q(s)≤0#
≤P∗"
inf
s∈µ−1
{b}˜ηGN(s)−q(s)≤ −δ
τNo#
+P∗"
inf
s∈SK+ZN(s)
τN−q(s)≤0#
≤2−P∗"
inf
s∈µ−1
{b}˜ηGN(s)>∥q∥∞−δ
τNo#
−P∗"
inf
s∈SZN(s)
τN>∥q∥∞−τNK#
Applying the limes superior to both sides implies that the r.h.s. converges
to zero as Ntends to infinity by the asymptotical tightness assumption.
41B.3 Lemmas on Uniform Convergence
This appendix collects some facts about uniform convergence and supremum
statistics.
Lemma 5. Let 
AN
N∈N⊆SandA,B ⊂S,(εN)N∈Nconverging to zero
such that dH(AN,A)≤εN. Let f, g∈ F(S).
(i)sup
s∈ANf(s)−sup
t∈Af(t)
≤max
0,supn
|f(s)−f(t)|(s, t)∈ 
AN\ A
× 
A \int(A)
:d(s, t)≤εNo
(ii)sup
s∈Bf(s)−sup
t∈Bg(t)≤sup
s∈Bf(s)−g(t)
Assume additionally AN⊇ A N+1⊇ A for all N∈Nand(fN)N∈N⊂
ℓ∞(A1)such that
sup
s∈A1|fN(s)−f(s)|N→∞− − − − → 0
andfuniform continuous on A1\int 
A
. Then
(iii)sup
s∈ANf(s)−sup
t∈Af(t)N→∞− − − − → 0
(iv)sup
s∈ANfN(s)−sup
t∈Af(t)N→∞− − − − → 0
Proof. For statement (i), fix ϵ > 0 and N > 0, without loss of general-
ity, assume that sups∈ANf(s)≥supt∈Af(t). Let s∗∈ A Nbe such that
sups∈ANf(s) =f(s∗) +ϵandt∗∈ A such that d(t∗, s∗)< εN(exists since
dH(AN,A)< εN). Then
sup
s∈ANf(s)−sup
t∈Af(t)≤f(s∗)−f(t∗) +ϵ
≤supn
|f(s)−f(t)|(s, t)∈ A N× A:d(s, t)≤εNo
+ϵ
Since ϵcan be arbitrarily small,
sup
s∈ANf(s)−sup
t∈Af(t)≤supn
|f(s)−f(t)|(s, t)∈ A N×A:d(s, t)≤εNo
.
For statement (ii),
sup
s∈BfN(s) = sup
s∈B 
fN(s)−f(s) +f(s)
≤sup
s∈B 
fN(s)−f(s)
+ sup
s∈Bf(s)
⇐⇒ sup
s∈BfN(s)−sup
s∈Bf(s)≤sup
s∈B 
fN(s)−f(s)
≤sup
s∈B|fN(s)−f(s)|
42Using sups∈Bf(s) a similar calculation yields
sup
s∈BfN(s)−sup
s∈Bf(s)≥ −sup
s∈B|fN(s)−f(s)|,
which proves the claim.
For statement (iii), note that since AN⊃ A it is possible to replace
s∈ A Nbys∈ A N\ Aandt∈ Abyt∈ A \ int(A) in the supremum on the
r.h.s. of ( i), i.e.,
sup
s∈ANf(s)−sup
t∈Af(t)
≤max
supn
|f(s)−f(t)|(s, t)∈ 
AN\ A
× 
A \int(A)
:d(s, t)≤εNo
,0
Since fis uniformly continuous on AN\int 
A
⊆ A 1\int 
A
, r.h.s con-
verges to zero as εN→0. Statement (iv) follows directly from the triangle
inequality and ( ii) and ( iii).
Lemma 6. LetA,B ⊆Sand(AN)N∈N,(BN)N∈Nbe sequences of sets such
thatAN⊇ A N+1⊇ A andBN⊇ B N+1⊇ B for all N∈Nas well as
dH(AN,A)→0anddH(BN,B)→0asN→ ∞ . Assume GN⇝Gin
ℓ∞(A1∪ B1)with GBorel measurable and the restriction of GandGNto
A1\int 
A
∪ B1\int 
B
have uniformly continuous sample paths. Then
max 
sup
s∈AN−GN(s),sup
s∈BNGN(s)!
⇝max
sup
s∈A−G(s),sup
s∈BG(s)
Proof. This is a consequence of the extended continuous mapping theorem
[Van Der Vaart et al., 1996, Theorem 1.11.1] and Lemma 5(iv). More pre-
cisely, define the maps
H:ℓ∞(A1∪ B1)→R, f7→max 
sup
s∈A−f(s),sup
s∈Bf(s)!
HN:ℓ∞(A1∪ B1)→R, f7→max 
sup
s∈AN−f(s),sup
s∈BNf(s)!
The claim follows from the extended continuous mapping theorem, if
for any sequence ( fN)N∈N⊂ℓ∞(A1∪ B1) converging to finℓ∞(A1∪ B1)
such that the restrictions of fNandftoA1\int 
A
∪ B1\int 
B
are
43uniformly continuous, it holds that HN(fN)→H(f). Using max( a, b) =
2−1 
a+b+|a−b|
fora, b∈Rand triangle inequalities yields
HN(fN)−H(f)≤sup
s∈AN−fN(s)−sup
s∈A−f(s)+sup
s∈BNfN(s)−sup
s∈Bf(s),
which converges to zero by Lemma 5(iv). Note that we do not need to
assume Gto be separable since our DNin [Van Der Vaart et al., 1996,
Theorem 1.11.1] is always the subspace of ℓ∞(A1∪B1) where the restriction
toA1\int 
A
∪B1\int 
B
are uniformly continuous [Van Der Vaart et al.,
1996, Problems and Complements 1., p.70].
44C The Asymptotic SCoRE Set Metatheorem
In this section we prove a general SCoRE Set Metatheorem. All theorems
of the main manuscript are corollaries of this result. Its main benefit is that
it has weaker assumptions on ˆ µNthan assuming a ULT.
As in the main manuscript, let (Ω ,P,P) be a probability space, ( S, d) be
a metric space and A,B ⊆ F (S). Let µ∈ℓ∞(S) and σ∈ℓ∞(S) such that
0<o< σ(s)<Ofor all s∈S. Let ˆ µN: Ω→ℓ∞(S),N∈N, and ( τN)N∈N
a positive sequence converging to zero. Define a map GN: Ω→ℓ∞(S) by
GN=ˆµN−µ
τNσ.
Since we do not assume that the map GNis measurable, weak convergence
involving GNis understood in the sense of [Van Der Vaart et al., 1996,
Definition 1.3.3]. For C ⊆ F (S) we define the sets U±η
C= clµ−1
C±η. Moreover,
we define the set where GNhas continuous sample paths from the inside of
µ−1
Cin a neighbourhood around s∈Sby
Ωs
ct=n
ω∈Ω| ∃open V∋s:GN|V∩clµ−1
C(ω)∈C 
V∩clµ−1
Co
and for any W⊆∂µ−1
C\µ−1
Cwe define ΩW
ct=T
s∈WΩs
ctthe subset of Ω
where GNhas continuous sample paths on W.
ForA, B⊆S,f, q±∈ℓ∞(S) and q={q+, q−}, we define
Tq
A,B(f) = max 
sup
s∈Af(s)−q+(s),sup
s∈B−f(s)−q−(s)!
.
LetGqandHqdepending on qbe random variables with values in R,
˜η >0 and ( ηN)N∈Na positive sequence such that lim N→∞ηNτ−1
N=∞. We
require the following assumptions:
(M1) Assume Tq
U−ηN
A,U+ηN
B(GN)⇝Gqweakly in R.
(M2) The sequence Tq
U−˜η
A,U+˜η
B(GN) is asymptotically tight in the sense of
[Van Der Vaart et al., 1996, p.21].
(M3) Assume there is a constant K > 0 such that
 
ˆµN(s)−c(s)
·sgn 
µ(s)−c(s)
≥σ(s) 
K+ZN(s)
for all c∈ A ∪ B and all s∈S\ 
µ−1
A−˜η∪µ−1
B+˜η
and an sequence
ZN: Ω→ℓ∞(S) such that inf s∈Sτ−1
NZN(s) is asymptotically tight.
45(M4) LetWA⊆∂µ−1
A\µ−1
AandWB⊆∂µ−1
B\µ−1
BwithP∗ 
ΩWA
ct
=
P∗ 
ΩWB
ct
= 1 and assume that Tq
µ−1
A∪WA,µ−1
B∪WB(GN)⇝Hqweakly
inR.
With this at hand, we can prove our SCoRE Set Metatheorem.
Theorem 7. LetA,B ⊆ F (S)andq±∈ℓ∞(S)be arbitrary. Define aq=
a+τNq+σfor all a∈Γ 
A
andbq=b−τNq−σfor all b∈Γ 
B
.
1. Assume u−
A∪u+
B̸=∅and(M1) ,(M2) and(M3) . Then
lim
N→∞P∗"
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L b#
≥Ph
Gq<0i
.
2. Assume u−
A∪u+
B=∅,(M2) and(M3) . Then
lim
N→∞P∗"
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L b#
= 1.
3. Assume u−
A∪u+
B̸=∅. Then under (M4) it holds that
lim
N→∞P∗"
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L b#
≤Ph
Hq≤0i
.
Proof. We begin with proving the first and the second claim. For any η >0
such that ˜ η > η , Lemma 2(i) yields that
sup
s∈clµ−1
A−ηGN(s)−q+(s)<0, sup
s∈clµ−1
A−˜ηGN(s)−q+(s)<Oητ−1
N
inf
s∈Sτ−1
NZN(s) +q+(s)>−Kτ−1
N,(26)
implies ˆUaq⊆ Uafor all a∈Γ(A) and Lemma 2(ii) shows that
sup
s∈clµ−1
B+η−GN(s)−q−(s)<0, sup
s∈clµ−1
B+˜η−GN(s)−q−(s)< ητ−1
N,
inf
s∈Sτ−1
NZN(s) +q−(s)>−Kτ−1
N,(27)
implies ˆLbq⊆ L bfor all b∈Γ(B).
46Let ( ηN)N∈Nbe a sequence of positive numbers such that ηN→0 and
ηNτ−1
N→ ∞ . Combining Lemma 1, (27) and (26) yields
P∗h
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L bi
≥P∗h
Tq
U−ηN
A,U+ηN
B(GN)<0i
−P∗
Tq
U−˜η
A,U+˜η
B(GN)≥OηNτ−1
N
−P∗
inf
s∈Sτ−1
NZN(s)<−inf
s∈Smax 
q−(s), q+(s)
−Kτ−1
N
≥P∗h
Tq
U−ηN
A,U+ηN
B(GN)<0i
−P∗
Tq
U−˜η
A,U+˜η
B(GN)≥OηNτ−1
N
−P∗
inf
s∈Sτ−1
NZN(s)<−inf
s∈Smax 
q−(s), q+(s)
−Kτ−1
N
.
The last two summands can be made arbitrarily small because the asymp-
totically tightness condition implies that for any ϵ >0 we find ˜K > 0 such
that for all δ >0
lim
N→∞−P∗
inf
s∈Sτ−1
NZN(s)<−˜K−δ
=−1 + lim
N→∞P∗
inf
s∈Sτ−1
NZN(s)>−˜K−δ
≥ −1 + lim
N→∞P∗
inf
s∈Sτ−1
NZN(s)∈[−˜K−δ,˜K+δ]
≥ϵ .
Thus, setting ˜K= inf s∈Smax 
q−(s), q+(s)
we see that we can bound the
last term by ϵ. The same argument applies to the second summand.
Ifu−
A∪u+
B̸=∅, then the Portmanteau Theorem [Van Der Vaart et al.,
1996, 1.3.4] and (M1) yields
lim
N→∞P∗
Tq
U−ηN
A,U+ηN
B(GN)<0
≥P
Gq<0
,
which proves the first claim.
Ifu−
A∪u+
B=∅, then there is an η >0 such that cl µ−1
A−η∪clµ−1
B+η=∅for
some η >0, then Tq
U−ηN
A,U+ηN
B(GN) =−∞for all Nlarge enough. Thus,
lim
N→∞P∗
Tq
U−ηN
A,U+ηN
B(GN)<0
≥1,
47which finishes the proof of the second claim.
In order to prove the third claim, we first prove that on ΩA
ct∩ΩB
ctwe
have that
(E1)∀a∈Γ(A)∀b∈Γ(B):ˆUaq⊆ Ua∧ˆLbq⊆ L b
=⇒(E2) Tq
µ−1
A∪WA,µ−1
B∪WB(GN)≤0,
which is equivalent to
¬(E2) ∃s∗∈µ−1
A∪WA:GN(s∗)> q+(s∗)
∨ ∃s∗∈µ−1
B∪WB:−GN(s∗)> q−(s∗)
=⇒ ¬ (E1)∃a∈Γ(A) : ˆUaq=n
GN(s)>a(s)−µ(s)
τNσ(s)+q+(s)o
̸⊆ Ua
∨ ∃b∈Γ(B) : ˆLbq=n
GN(s)<b(s)−µ(s)
τNσ(s)−q−(s)o
̸⊆ L b.
To prove this, we first assume s∗∈µ−1
Asuch that GN(s∗)> q+(s∗).
Hence there is a∈ Asuch that µ(s∗) =a(s∗). Thus, s∗/∈ Ua, yet GN(s∗)>
q+(s∗) implies s∗∈ˆUaq. the case s∗∈UA\µ−1
A. Thus, assume s∗∈WA
such that GN(s∗)> q+(s∗). By the continuity assumption in the definition
ofWAwe find an s′∈µ−1
Asuch that GN(s′)> q+(s′). This, again implies
the existence of an a∈ Asuch that s′/∈ Ua, but s′∈ˆUaq.
The case that s∗∈µ−1
B∪WBsuch that −GN(s∗)> q−(s∗) implies ¬(E1)
is almost identical to the previous argument and therefore omitted. Together
we have proven (E1)⇒(E2) .
Consequentially, as P∗ 
ΩWA
cont∩ΩWB
cont
= 1 holds, we have that
P∗h
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L bi
=P∗h n
∀a∈Γ 
A
∀b∈Γ 
B
:ˆUaq⊆ Ua∧ˆLbq⊆ L bo
∩Ωconti
≤P∗h
Tq
µ−1
A∪WA,µ−1
B∪WB(GN)≤0
∩Ωconti
=P∗h
Tq
µ−1
A∪WA,µ−1
B∪WB(GN)≤0i
.
Applying the limit superior to both sides and using the Portmanteau The-
orem yields the claim.
Remark 22.As we tried to make the upper bound as tight as possible we
needed to introduce the sets WAandWBwhere GNis continuous from the
48inside of µ−1
Aandµ−1
Brespectively. However, setting WA=WB=∅we
always get an upper bound that at most misses points from ∂µ−1
A\µ−1
A
and∂µ−1
B\µ−1
B. In particular, if µ−1
Aandµ−1
Bare closed it holds that
WA=WB=∅and the upper bound is tight.
The proof of the SCoRE Set Metatheorem can be thought of as taking
the limit of the following non-asymptotic bounds.
Proposition 3. LetA,B ⊆ F (S),q±∈ F(S)andηN<˜η. Define c±
q=
c±±qτNσfor all c±∈Γ 
C±
. Then
P∗"
∀c−∈Γ 
A
∀c+∈Γ 
B
:ˆLc−
q⊆ L c−∧ˆUc+
q⊆ Uc+#


≥P∗h
Tq
U−ηN
A,U+ηN
B(GN)<0∧Tq−,q+
S,S(GN)<OηNτ−1
Ni
≤P∗h
Tq
µ−1
A∪WA,µ−1
B∪WB(GN)≤0i .
Remark 23.Using Lemma 1 it can be easily verified that Lemma 2.1 from
Mammen and Polonik [2013] is the special case of the above proposition
withC±={0}. The benefit of our version is that it more clearly shows
that the probability of the lower bound needs to be tuned by q±to obtain
valid non-asymptotic control of the inclusions and the gap in exact control
is given by the difference between the given upper and lower bound.
49D A condition for u−1
C=µ−1
C
In the main article we introduced the generalized preimage u−1
Cwhich col-
lects all points in Ssuch that either 
s, µ(s)
∈Γ(C) or 
s, µ(s)
is a touching
point of Γ( C) in the sense that the graph Γ( µ) gets arbitrary close to Γ( C).
The sharp upper bound (A4) in Theorem 1 holds true if u−1
C= clµ−1
C.
Therefore we now discuss fairly general conditions under which u−1
C=µ−1
C.
A key concept we will need is the boundary of a set C ⊆ F (S).
Definition 11 (Boundary of a Set of Functions ).A boundary ∂Cof
C ⊆ F (S) is a set D ⊆ F (S) such that
Γ(D) =(
(s, r)∈S×Rr∈∂ [
c∈Cc(s)!)
.
Here ∂Iis the topological boundary of I⊆Runder the standard topology.
While the boundary of Cis not a unique set, any two boundaries DandD′
satisfy that Γ( D) = Γ( D′). Therefore Γ 
∂C
is a unique set.
The next lemma generalizes Lemma 1 from Sommerfeld et al. [2018] and
implies u−1
C=µ−1
C.
Lemma 7. LetC ⊂ F (S),µ−1
C˜ηbe compact for some ˜η >0and 
ηN
n∈N⊂R
a positive zero-sequence. Assume that Γ 
∂C
is closed and the restriction of
µtoclµ−1
C˜η\intµ−1
Cis continuous. Then
lim
N→∞dH
µ−1
CηN, µ−1
C
= 0.
Proof. Define the set Mε:={s∈S: infs′∈µ−1
Cd(s, s′)< ε}. By definition
µ−1
C⊂µ−1
CηNfor all N. Therefore convergence in Hausdorff distance of µ−1
CηN
toµ−1
Cfollows, if for any ε >0 there exists an N0∈Nsuch that for all
N > N 0it holds that µ−1
CηN⊂Mε. To this end, assume the contrary.
Then, there exists ε >0 such that for some subsequence ( Nk)k∈Nthere are
sNk∈µ−1
CηNk\µ−1
Cwith infs∈µ−1
Cd(sNk, s)≥ε. Since for large enough kthe
sequence ( sNk)k∈Nis contained in the compact set µ−1
C˜ηit can w.l.o.g. be
assumed that it converges to a limit s∗∈S, say. Assume that kis large
enough such that µ−1
CηNk\µ−1
C⊆µ−1
Cη0\µ−1
C. Since µis continuous on
the closed set cl µ−1
C˜η\intµ−1
Cit follows that µ(sNk)→µ(s∗) for some s∗∈
50clµ−1
C˜η\intµ−1
C. By construction there is a sequence 
sNk, cNk(sNk)
∈Γ(∂C)
such that
|µ(sNk)−cNk(sNk)| ≤ηNkk→∞− − − → 0. (28)
Thus, lim k→∞cNk(sNk) =µ(s∗). Since Γ 
∂C
is closed and 
sNk, cNk(sNk)
∈
Γ 
∂C
for all k∈N, its limit 
s∗, µ(s∗)
is contained in Γ 
∂C
. By (28) it
follows that 
s∗, µ(s∗)
∈Γ(∂C)∩Γ(µ). This implies s∗∈µ−1
C, since Γ( ∂C)
is closed. A contradiction.
Remark 24.The importance of Γ( ∂C) being closed is visualized in Fig. 7
which gives an example for C={c}where cis discontinuous at s0∈S.
The problem here is that Γ( µ) intersects Γ 
∂{c}
= Γ(c) at a point which
does not belong to Γ( c). This situation can be circumvented by finding a
set˜Cwith Γ ˜C
= cl 
Γ(C)
. This means adding functions such that their
graph may pass through the boundary points of Γ( C) while otherwise being
contained in Γ 
C
. This is illustrated in the right panel of Fig. 7.
Figure 7: Illustration of the assumption that Γ( ∂C) needs to be closed for
Hausdorff convergence in Lemma 7. Left: Since ais only right continuous at
s0≈0.4 and µ(s0) = lim s→−s0a(s) it holds that cl µ−1
a−ηdoes not converge
in Hausdorff distance to µ−1
a.Right: IfA={a}is extended to include
the function ˜ awhich satisfies ˜ a(s) =a(s) for all s∈S\ {s0}and ˜a(s0) =
lims→−s0a(s), then cl µ−1
{a,˜a}−ηdoes converge to µ−1
{a,˜a}in Hausdorff-distance.
51E The Difference between ”>”or”≥”Excursion
Sets
To simplify notations let us define B∁=S\Bfor all B⊆S. This sec-
tion explains why the inclusions ˆUa+qτNσ⊆ U aand ˆLb−qτNσ⊆ L bare more
natural than ˆL∁
a+qτNσ⊆ L∁
aand ˆU∁
b−qτNσ⊆ U∁
bwhich are used in the liter-
ature. For example, Sommerfeld et al. [2018], Bowring et al. [2019, 2021],
Maullin-Sapey et al. [2023] assume a(s) =b(s) =c∈Rfor all s∈Sand
study the probability of the inclusions ˆL∁
c+qτNσ⊆ L∁
c⊆ˆL∁
c−qτNσ. The main
issue with excursion sets using ” ≥” instead of ” >” is that an ”open ball”
or ”non-tangentiality” condition is required to prove sharp upper bounds.
This condition is restrictive since it means that µcannot be flat on Γ 
∂C
as
illustrated in Fig. 8. Because this section only serves an illustrative purpose,
we simplify the proof by assuming u−1
C=µ−1
C. This means that µ−1
C⊆Sis
closed. Furthermore, we require the following assumptions:
(A2’) There exist an ˜ η > 0 such that the restriction of GNtoµ−1
C˜ηhas
almost surely continuous sample paths.
(A5) Assume that for all open Os⊂Scontaining s∈µ−1
∂C−∩µ−1
C−there is
ac−∈ C−such that Os∩Uc−̸=∅and for all open Os⊂Scontaining
s∈µ−1
∂C+∩µ−1
C+there is a c+∈ C+such that Os∩ Lc+̸=∅.
Remark 25.Condition (A2’) is stronger than Condition (A2) , since the
latter only required continuity from outside µ−1
Ctowards µ−1
∂CofGNwhile
(A2’) requires additionally the continuity from the inside µ−1
Ctowards µ−1
∂C.
Remark 26.IfC={c}forc∈ F(S) then µ−1
∂C=µ−1
C=
s∈S:µ(s) =
c(s)	
and(A5) is equivalent to the open ball condition of Assumption 2.1.(a)
from Sommerfeld et al. [2018].
Theorem 8. LetA,B ⊆ F (S)and assume (A1) -(A3) . Then
lim
N→∞P∗h
∀a∈ A∀ b∈ B:ˆL∁
a+qτNσ⊆ L∁
a∧ˆU∁
b−qτNσ⊆ U∁
bi
≥P[TA,B(G)< q].
If also either µ−1
∂A∩µ−1
A=∅andµ−1
∂B∩µ−1
B=∅or else (A2’) and(A5) ,
then
lim
N→∞P∗h
∀a∈ A∀ b∈ B:ˆL∁
a+qτNσ⊆ L∁
a∧ˆU∁
b−qτNσ⊆ U∁
bi
≤P[TA,B(G)≤q].
Proof. The proof of the lower bound is the same as the corresponding proof
in Theorem 1 and therefore omitted. The proof of the upper bound is similar
52to the the proof of the upper bound in the SCoRE Set Metatheorem 7. The
main difference is that we need to prove
(E1)∀a∈ A∀ b∈ B:
ˆµN(s) +qτNσ(s)≤b(s)	
⊆
µ(s)≤b(s)	
∧
ˆµN(s)−aτNσ(s)≥a(s)	
⊆
µ(s)≥a(s)	
=⇒(E2)∀s∈µ−1
A∀s′∈µ−1
B: ˆµN(s)−qτNσ(s)≤µ(s)
∧µ(s′)≤ˆµN(s′) +qτNσ(s′)
for the subset of Ω where ˆ µNhas continuous sample paths on µ−1
C˜η.
Assume (E1) holds, but not (E2) . W.l.o.g. assume there exist an
s∗∈µ−1
Asuch that ˆ µN(s∗)−qτNσ(s∗)≥µ(s∗), i.e., GN(s∗)≥q. First we
assume s∗∈µ−1
A\µ−1
∂A. Since µ−1
A\µ−1
∂Ais open, there exists a∈ Asuch that
a(s∗)∈ 
µ(s∗),ˆµN(s∗)−qτNσ(s∗)
. Thus, s∗/∈ L∁
a, but ˆ µN(s∗)−qτNσ(s∗)≥
a(s∗), which contradicts (E2) . On the other hand, for s∗∈µ−1
∂A∩µ−1
A, choose
Os∗small enough such that GN(s)≥qfor all s∈ O s∗. This is possible by
(A2’) . Then (A5) guarantees the existence of asuch that s′∈ O s∗∩ La.
Thus, s′/∈ L∁
a, but GN(s′)≥q. A contradiction. Similarly, the case s∗∈µ−1
B
can be treated. Hence as in the proof of Theorem 7 an application of the
Portmanteau Theorem finishes the proof.
Figure 8: Illustration that S\ˆLa+qτNσ⊆S\ Larequires more assumptions
to obtain a sharp upper bound than ˆUa+qτNσ⊆ U a.Left: the inclusion
S\ˆLa+qτNσ⊆S\ Ladoes hold true although ˆ µN−qτNσ > µ near s≈
0.5.Right: the problem does not appear because Ua=∅and therefore
ˆUa+qτNσ̸⊆ Ua.
53F Proofs of the Results in Section 3
F.1 Proof of Theorem 1
Proof. We want to apply the SCoRE Set Metatheorem 7 in the case that
q±≡q. By(A1) -(A3) we obtain from Lemma 6
Tq,q
A−ηN,B+ηN(GN)⇝TA,B(G)−q , Tq,q
A,B(GN)⇝Tq,q
A,B(G)
Tq,q
A−˜η,B+˜η(GN)⇝Tq,q
A−˜η,B+˜η(G).
Therefore (M1) is satisfied. Condition (M2) holds since the random vari-
ableTq,q
A−˜η,B+˜η(G) onRis tight which is equivalent to Tq,q
A−˜η,B+˜η(GN) being
asymptotically tight [Van Der Vaart et al., 1996, Lemma 1.3.8 ]. Assumption
(M3) is part of Assumption (A1) .
F.2 Proof of Theorem 2
We first establish that the estimate ˆu±
Cis with inner probability tending to
one inside the set cl µ−1
C±˜η.
Lemma 8. Assume ˆµNsatisfies Definition 7(ii) for some ˜η > 0. Let
(kN)N∈Nbe a positive sequence such that limN→∞kNτN= 0. Then
lim
N→∞P∗h
ˆu±
C⊆clµ−1
C±˜ηi
= 1.
Proof. Define sgnc,f(s) = sgn 
f(s)−c(s)
forf∈ F(S) and the set
ˆµ±
C=
s∈S∃c∈ C: 0≤ ∓ 
ˆµN(s)−c(s)
≤kNτNσ(s)	
. (29)
Note that clˆ µ±
C⊆ˆu±
C. Assume that s∈ˆµ±
C∩ 
S\µ−1
C±˜η
. From Definition
7(ii) and (29) we obtain
o 
K+ZN(s)
≤sgnc,µ(s) 
ˆµN(s)−c(s)
≤kNτNσ(s),
which implies ZN(s)≤τNkNOo−1−K. Since inf s∈Sτ−1
NZN(s) is asymp-
totically tight and lim τNkN= 0 it holds that
lim
N→∞P∗
ZN(s)≤τNkNOo−1−K
= 0
combining this with Remark 2 shows that
lim
N→∞P∗h
ˆµ±
C∩ 
S\µ−1
C±˜η
̸=∅i
= 0⇔ lim
N→∞P∗h
ˆµ±
C⊆µ−1
C±˜ηi
= 1
⇔ lim
N→∞P∗h
ˆu±
C⊆clµ−1
C±˜ηi
= 1
which is the claim.
54Using the above Lemma we can prove Theorem 2. The idea of the proof
is inspired by the proof of Theorem 3.6 from Dette et al. [2020].
Proof. We begin with proving the Hausdorff convergence of the estimator
ˆu±
Cofu±
C. To begin with let ηN=ρokNτNfor some ρ∈(0,1) and recall the
definition of ˆ µ±
Cfrom (29). Assuming Nlarge enough such that ηN<˜ηwe
obtain
P∗h
µ−1
C±ηN⊆ˆµ±
Ci
=P∗"
sup
s∈µ−1
C±ηNinf
c∈Cmax
0,∓ˆµN(s)−c(s)
σ(s)
≤kNτN#
=P∗"
sup
s∈µ−1
C±ηNinf
c∈Cmax
0,∓ˆµN(s)−µ(s)
σ(s)∓µ(s)−c(s)
σ(s)
≤kNτN#
≥P∗"
sup
s∈µ−1
C±ηNinf
c∈Cmax
0,∓ˆµN(s)−µ(s)
σ(s)+ρkNτN
≤kNτN#
=P∗"
sup
s∈µ−1
C±ηN|GN(s)| ≤kN(1−ρ)#
≥P∗"
sup
s∈clµ−1
C±˜η|GN(s)| ≤kN(1−ρ)#
.
The latter converges to one since sups∈clµ−1
C±˜η|GN(s)|is asymptotically tight.
Therefore we have lim N→∞P∗
clµ−1
C±ηN⊆ˆu±
C
= 1 and thus
lim
N→∞P∗"
sup
s∈u±
Cinf
s′∈ˆu±
C|s−s′|> ϵ#
≤lim
N→∞P∗"
sup
s∈clµ−1
C±ηNinf
s′∈ˆu±
C|s−s′|> ϵ#
= 0.
It remains to prove that
lim
N→∞P∗"
sup
s∈ˆu±
Cinf
s′∈u±
C|s−s′|> ϵ#
= 0. (30)
55To see this note that whenever ˆu±
C⊆clµ−1
C±˜ηit holds that
sup
s∈ˆµ±
Cinf
c∈Cmax
0,∓ 
µ(s)−c(s)	
≤sup
s∈ˆµ±
Cinf
c∈Cµ(s)−ˆµN(s)∓ 
ˆµN(s)−c(s)
≤sup
s∈ˆµ±
C|µ(s)−ˆµN(s)|+kNτNO
≤sup
s∈clµ−1
C±˜η|µ(s)−ˆµN(s)|+kNτNO
which implies by Lemma 8 that
lim
N→∞P∗"
sup
s∈ˆµ±
Cinf
c∈Cmax
0,∓ 
µ(s)−c(s)	
≤2kNτNO#
≥lim
N→∞P∗"
sup
s∈clµ−1
C±˜η|µ(s)−ˆµN(s)| ≤kNτNO#
≥lim
N→∞P∗"
sup
s∈µ−1
C±˜η|GN(s)| ≤kN#
= 1.
Thus, sups∈ˆµ−1
Cinfc∈Cmax
0,∓ 
µ(s)−c(s)	
converges to zero outer al-
most surely. It remains to show that this implies that sups′∈ˆu±
Cinfs∈u±
C|s−
s′| →0 outer almost surely as the the result of the Theorem then follows
from Van Der Vaart et al. [1996].
Let us assume that sups∈ˆµ±
Cinfc∈C|µ(s)−c(s)|converges to zero outer
almost surely. By Egorov’s Theorem (Lemma 1.9.2(iii) from Van Der Vaart
et al. [1996]) this is equivalent to
∀δ >0∃A⊆Ω∀ε >0∀ω∈A∃N′∀N > N′:
P(A)≥1−δ∧ sup
s∈ˆµ±
C(ω,N)inf
c∈C|µ(s)−c(s)|< ϵ(31)
and assume that sups′∈ˆu±
Cinfs∈u±
C|s−s′| →0 is not converging outer almost
surely, i.e.,
∃δ >0∀A⊆Ω∃ε0>0∃ω0∈A∀N′∃N > N′:
P(A)≥1−δ∧ sup
s′∈ˆu±
C(ω0,N)inf
s∈u±
C|s−s′| ≥ϵ0.(32)
For clarity we explicitly added the dependence on ω,ω0andNhere.
56Letδfrom (32). For this δwe choose the corresponding Afrom (31).
Hence by (32) there is a ε0andω0∈Asuch that for all N′>0 there is an
N > N′satisfying
sup
s′∈ˆu±
C(ω0,N)inf
s∈u±
C|s−s′| ≥ϵ0. (33)
We will now construct a contradiction between (31) and (32). From (33)
we obtain a sequence ( sN′)N′∈N⊂Ssatisfying, for some N > N′,
sN′∈ˆu±
C(ω0, N), inf
s∈u±
C|s−sN′| ≥ϵ0.
Let us define the set ˜N=
N∈N| ∃N′∈N:sN′∈ˆu±
C(ω0, N)	
. As Sis
compact, we can by replacing ( sN)N∈Nby a convergent subsequence w.l.o.g.
assume that sN→s∗forN→ ∞ with
s∗∈\
N∈˜Nclˆµ±
C(ω0, N) and inf
s∈u±
C|s−s∗| ≥ϵ0. (34)
Ifs∗∈T
N∈˜Nˆµ±
C(ω0, N), then (34) immediately contradicts (31). More
general, if s∗∈T
N∈˜Nclˆµ±
C(ω0, N) we find a sequence ( tN)N∈Nsuch that
tN∈ˆµ±
C(ω0, N) converging to s∗. As u±
Cis a compact set this implies that
infs∈u±
C|s−tN| ≥ϵ1>0 for all Nlarge enough. The latter contradicts (31),
which finishes the proof.
57G Proofs of the Results in Section 4
G.1 Proof of Proposition 2
Proof. It is enough to show that the equivalence of
(E1)∀s∈S:ˆlN(s)≤µ(s)≤ˆuN(s)
(E2)∀c∈ F(S) :ˆLc⊆ L c∧ˆUc⊆ Uc.
Case (E1)⇒(E2) : Assume that s∗∈ˆUc, i.e., c(s∗)< lN(s∗). By (E1) it
holds that lN(s∗)≤µ(s∗) which implies c(s∗)< µ(s∗), i.e., s∗∈ˆUc. Similar,
s∗∈ Lcis proven.
Case (E2)⇒(E1) : By (E2) it holds for c=µthat ˆUµ⊆ U µ=∅and
S=S\ Lµ⊆S\ˆLµwhich is equivalent to (E1) .
G.2 Proof of Theorem 3
Proof. Note that Lb+δ=Ua+δ=∅.
Ifδ≤0, then H0is true. Moreover, by the definition of δwe have that
P∗
H0is rejected
=P∗ˆUa+qατNσ̸=∅ ∨ ˆLb+qατNσ̸=∅
=P∗ˆUa+qατNσ̸⊆ Ua+δ∨ˆLb+qατNσ̸⊆ L b+δ
= 1−P∗ˆUa+qατNσ⊆ Ua+δ∧ˆLb+qατNσ⊆ L b+δ
.(35)
We first prove statement ( a). As δ= 0 the claim follows directly from (35)
and Corollary 2 for A={a}andB={b}.
Statement ( b) follows from (35) and Lemma 3 as δ <0. Statement ( c)
follows from Lemma 3 as well, because for δ >0 and we have
P∗
H0is rejected
=P∗ˆUa+qατNσ̸=∅ ∨ ˆLb+qατNσ̸=∅
= 1−P∗ˆUa+qατNσ⊆ Ua+δ∧ˆLb+qατNσ⊆ L b+δ
.
G.3 Proof of Theorem 4
Proof. It is helpful to remember the definitions of the sets
H0=S\(Ua∪ Lb) and H1=Ua∪ Lb
of true null hypotheses and true alternative hypotheses respectively.
58We first prove ( a). As the definition of δimplies
Ua=Ua−δ,Lb=Lb+δ,
it follows that
P∗
∃s∈ H 0:s∈ˆH1
=P∗h
∃s∈ H 0:s∈ˆUa+qατNσ∪ˆLb−qατNσi
= 1−P∗h
∀s∈ H 0:s∈S\ ˆUa+qατNσ∪ˆLb−qατNσi
≤1−P∗h
∀s∈ H 0:s∈S\ ˆUa−δ+qατNσ∪ˆLb+δ−qατNσi
= 1−P∗h
H0⊆S\ ˆUa−δ+qατNσ∪ˆLb+δ−qατNσi
≤1−P∗h
ˆUa−δ+qατNσ⊆ Ua−δ∧ˆLb+δ−qατNσ⊆ L b+δi
.
Thus, applying the limes superior to both sides, Corollary 2 with A=
a−δ	
andB=
b+δ	
yields
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
≤1−Ph
Ta−δ,b+δ(G)< qαi
≤α .
The second inequality is a consequence of the first and the observation that
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗
H0⊆ˆH0
= 1−P∗ˆH1⊆ H 1
.
This finishes the proof of ( a).
We now prove ( b). Note that δ= 0. The case H0=Simplies Ua=∅
andLb=∅. Again Corollary 2 with A=
a	
andB=
b	
yields
lim
N→∞P∗
∃s∈ H 0:s∈ˆH1
= 1−lim
N→∞P∗h
ˆUa+qατNσ=∅ ∧ ˆLb−qατNσ=∅i
≥1−Ph
Ta−δ,b+δ(G)≤qαi
.
To prove the case inf s∈Sa(s)−b(s)≥M > 0 we observe that
P∗h
ˆUa+qατNσ⊆ Ua∧ˆLb−qατNσ⊆ L bi
≥P∗h
H0⊆S\ ˆUa+qατNσ∪ˆLb−qατNσi
+P∗h
ˆUa+qατNσ⊆ Ubi
+P∗h
ˆLb−qατNσ⊆ L ai
−2,
59sinceH0=S\(Ua∪ Lb). Using this yields
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗h
H0⊆S\ ˆUa+qατNσ∪ˆLb−qατNσi
≥ −1−P∗h
ˆUa+qατNσ⊆ Ua∧ˆLb−qατNσ⊆ L bi
+P∗h
ˆUa+qατNσ⊆ Ubi
+P∗h
ˆLb−qατNσ⊆ L ai
.
Applying the limes superior part of Corollary 2 with A=
a	
andB=
b	
and Lemma 3, which shows that the last two probabilities on the r.h.s.
converge to 1, finishes the proof of ( b).
To prove the second claim of ( b). Recall the definitions
∆a
N(s) =µ(s)−a(s)
τNσ(s)and ∆b
N(s) =µ(s)−b(s)
τNσ(s). (36)
Hence HηN
1=Ua+ηN∪ Lb−ηNimplies that
inf
s∈Ua+ηN∆a
N(s)≥ηN
OτN, sup
s∈Lb−ηN∆b
N(s)≤ −ηN
OτN.
60Thus,
P∗
∀s∈ HηN
1:s∈ˆH1
=P∗h
Ua+ηN∪ L b−ηN⊆ˆUa+qατNσ∪ˆLb−qατNσi
≥P∗h
Ua+ηN⊆ˆUa+qατNσ∧ L b−ηN⊆ˆLb−qατNσi
=P∗"
inf
s∈Ua+ηNGN(s) + ∆+
N(s)> qα∧ sup
s∈Lb−ηNGN(s) + ∆−
N(s)<−qα#
≥P∗"
inf
s∈UaGN(s) +ηN
OτN> qα∧sup
s∈LbGN(s)−ηN
OτN<−qα#
≥P∗"
inf
s∈Ua∩clµ−1
{a}˜ηGN(s)> qα−ηN
OτN∧ inf
s∈Ua∩S\clµ−1
{a}˜ηK+ZN(s)
τN> qα
∧ sup
s∈Lb∩clµ−1
{b}˜ηGN(s)<−qα+ηN
OτN∧ sup
s∈Lb∩S\clµ−1
{b}˜ηK+ZN(s)
τN<−qα#
≥P∗"
inf
s∈Ua∩clµ−1
{a}˜ηGN(s)> qα−ηN
OτN#
+ 2P∗"
inf
s∈SK+ZN(s)
τN> qα#
+P∗"
sup
s∈Lb∩clµ−1
{b}˜ηGN(s)<−qα+ηN
OτN#
−3
N→∞− − − − → 1,
since all four inner probabilities on the last line converge to one, which
follows from the fact that
inf
s∈Sτ−1
NZN(s), inf
s∈Ua∩clµ−1
{a}˜ηGN(s), inf
s∈Lb∩clµ−1
{b−}˜η−GN(s)
are all asymptotically tight. For the latter two this follows from the weak
convergence GN⇝Gon cl µ−1
{a}˜ηand Lemma 6. This means the proof of ( c)
is complete.
Finally, we prove ( d). Since ∆ >0 it holds that
inf
s∈Ua∆a
N(s)≥∆
OτN,sup
s∈Lb∆b
N(s)≤ −∆
OτN
The proof for H1therefore is essentially identical to the proof of the last
61statement in part ( b). Moreover, we have that
P∗
∀s∈ H 0:s∈ˆH0
=P∗h
H0⊆S\ ˆUa+qατNσ∪ˆLb−qατNσi
≥P∗h
ˆUa+qατNσ⊆ Ua−δ∧ˆLb−qατNσ⊆ L b+δi
≥P∗h
ˆUa+qατNσ⊆ Ua−δi
+P∗h
ˆLb−qατNσ⊆ L b+δi
−1.
Since inf s∈S 
a(s)−δ+a(s)
> δand sups∈S 
b(s)−b(s)−δ
<−δthe
claim follows from Lemma 3.
G.4 Proof of Theorem 5
Proof. Ifδ≥0, then H0is true, i.e., Lb=Ua=∅. Moreover, by the
definition of δwe have that
P∗
H0is rejected
=P∗ˆUa+qατNσ=∅ ∧ ˆLb+qατNσ=∅
=P∗ˆUa+qατNσ⊆ Ua+δ∧ˆLb+qατNσ⊆ L b+δ
.(37)
We first prove statement ( a). As δ= 0 the claim follows directly from (37)
and Corollary 2 for A={a}andB={b}.
Statement ( b) follows from (37) and Lemma 3 as δ >0. Statement ( c)
follows from Lemma 3 as well, because for δ <0 and we have
P∗
H0is rejected
=P∗ˆUa+qατNσ=∅ ∧ ˆLb+qατNσ=∅
=P∗ˆUa+qατNσ⊆ Ua+δ∧ˆLb+qατNσ⊆ L b+δ
.
G.5 Proof of Theorem 6
Proof. Recall that H0=S\ 
Ub∩ La
andH1=Ub∩ La.
We first prove ( a). We obtain
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗
∀s∈ H 0:s∈ˆH0
= 1−P∗h
S\ 
Ub∩ La
⊆S\ ˆUb+qατNσ∩ˆLa−qατNσi
≤1−P∗h
ˆUb+qατNσ⊆ Ub∧ˆLa−qατNσ⊆ L ai
≤1−P∗h
ˆUb−δ+qατNσ⊆ Ub−δ∧ˆLa+δ−qατNσ⊆ L a+δi
.
62Thus, applying the limes superior to both sides of the above inequality and
Corollary 2 with A=
b−δ	
andB=
a+δ	
yields the claim. The second
inequality follows from the first and
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗
H0⊆ˆH0
= 1−P∗ˆH1⊆ H 1
.
In order to proof ( b) we use our previous calculation we obtain
P∗
∃s∈ H 0:s∈ˆH1
= 1−P∗h
S\ 
Ub∩ La
⊆S\ ˆUb+qατNσ∩ˆLa−qατNσi
≥1−P∗h 
S\ Ub⊆S\ˆUb+qατNσ∨S\ Ub∩ˆLa−qατNσ̸=∅
∧ 
S\ La⊆S\ˆLa−qατNσ∨S\ La∩ˆUb+qατNσ̸=∅i
≥1−P∗h
ˆUb+qατNσ⊆ Ub∧ˆLa−qατNσ⊆ L a,i
−P∗
CN
.
Here
CN=ˆUb+qατNσ∩ 
S\ La
̸=∅ ∨ 
S\ Ub
∩ˆLa−qατNσ̸=∅
Applying the limes inferior to this inequality, Corollary 2 with A=
b−δ	
andB=
a+δ	
on the first probability and recognizing that P∗
CN
converges to one by Lemma 4, since inf s∈S 
a(s)−b(s)
>0, yields the
claim.
For the second claim recall the notation introduced in (36). Since HηN
1=
Ub+ηN∩ La−ηNimplies that
inf
s∈Ub+ηN∆b
N(s)≥ηN
OτN, sup
s∈La−ηN∆a
N(s)≤ −ηN
OτN.
Thus, P∗[A∩B⊆C∩B]≥P∗[A⊆C∧B⊆C] for all A, B, C, D yields
P∗
∀s∈ HηN
1:s∈ H 1
=P∗h
Ub+ηN∩ La−ηN⊆ˆUb+qατNσ∩ˆLa−qατNσi
≥P∗"
inf
s∈Ub+ηNGN(s) + ∆b
N(s)> qα∧ sup
s∈La−ηNGN(s) + ∆a
N(s)<−qα#
The rest of the proof is almost identical to the proof of Theorem 4b).
Proof of (c):The proof is similar to the proof of part (c) from Theorem
4.
63H Proofs of the Results in Section 5
Lemma 9. Letl∈R,a,w∈RKandl2
∥a∥2≤1. Let P= 
vT
1, . . . ,vT
k−1
∈
RK−1×K, where v1, . . . ,vK−1form a basis of the hyperplane E={x∈
RK:aTx= 0}. Let P⊥
E=P(PTP)−1PTthe orthogonal projection onto
E.
a) max
∥x∥=1
aTx=l±xTw=±laTw
∥a∥2+q
1−l2
∥a∥2P⊥
Ew
b) max
∥x∥=1
aTx=l|xTw|=laTw
∥a∥2+q
1−l2
∥a∥2P⊥
Ew
Proof. Forx∈RKwe define ˆx=x/∥x∥. Every x∈ {x∈RK:aTx=l}
can be decomposed into
x=la
∥a∥2+xE,withxE∈E .
Using this decomposition, the fact that ˆxT
Ewdoes not depend on ∥xE∥and
that the smallest angle between the vector ±wand the linear subspace E
is the angle between wand its orthogonal projection P⊥
E(±w) onto E, we
obtain
max
∥x∥=1
aTx=lxT(±w) = max
∥xE∥2=1−l2
∥a∥2±laTw
∥a∥2+xT
E(±w)
=±laTw
∥a∥2+ max
∥xE∥2=1−l2
∥a∥2∥xE∥ˆxT
E(±w)
=±laTw
∥a∥2+q
1−l2
∥a∥2max
∥ˆxE∥2=1ˆxT
E(±w)
=±laTw
∥a∥2+q
1−l2
∥a∥2wTP⊥
EP⊥
Eww
=±laTw
∥a∥2+q
1−l2
∥a∥2P⊥
Ew.
This proves equation a). Finally, b) is an immediate consequence of a).
H.1 Proof of Corollary 5
Proof. Assumptions (A1) -(A4) are trivially satisfied in this setup, since
SK−1is compact, µandccontinuous and GNdefined in (22) has continuous
64sample paths. Let ε∼ N (0, IK×K). Applying Theorem 1 and Lemma 9
yields
lim
N→∞Ph
ˆUτNqσ⊆ U 0∧ˆL−τNqσ⊆ L 0i
=P"
max
∥a∥=1
aTβ=0aTX1/2ε√
aTXa≤q#
=PhP(PTP)−1PTε≤qi
.
Ifβ= 0 then P=IK×K. Ifβ̸= 0, then P∈RK×(K−1)is a matrix having
as columns a basis of the hyperplane
a∈RK: (X−1/2β)Ta= 0	
. The
claim follows since P(PTP)−1PTis an orthogonal projection and therefore
P(PTP)−1PTε∼ N 
0, I(K−1+1β=0)×(K−1+1β=0)
.
65