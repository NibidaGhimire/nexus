Using a one-dimensional nite-element approximation of Webster's
horn equation to estimate individual ear canal acoustic transfer
from input impedances
Nick Wulbusch1, Reinhild Roden2, Alexey Chernov1, and Matthias Blau2,3
1Institut f ur Mathematik, Carl-von-Ossietzky Universit at, Oldenburg, Germany
2Institut f ur Audiologie und H ortechnik, Jade-Hochschule, Oldenburg, Germany
3Cluster of Excellence "Hearing4All"
1nick.wulbusch@uni-oldenburg.de
Abstract
In many applications, knowledge of the sound pressure transfer to the eardrum is important. The
transfer is highly inuenced by the shape of the ear canal and its acoustic properties, such as the
acoustic impedance at the eardrum. Invasive procedures to measure the sound pressure at the eardrum
are usually elaborate or costly. In this work, we propose a numerical method to estimate the transfer
impedance at the eardrum given only input impedance measurements at the ear canal entrance by using
one-dimensional rst-order nite elements and Nelder-Mead optimization algorithm. Estimations on
the area function of the ear canal and the acoustic impedance at the eardrum are achieved. Results
are validated through numerical simulations on ten dierent ear canal geometries and three dierent
acoustic impedances at the eardrum using synthetically generated data from three-dimensional nite
element simulations.
1 Introduction
Humans have individually shaped ear canals which will individually inuence the sound transfer from the
ear canal entrance to the eardrum. In many applications such as hearing aids or insert earphones, one is
interested in the sound pressure at the eardrum, however, it is often not practical to measure it directly.
Therefore, it is desirable to be able to individually predict the eardrum sound pressure from measurements
at the entrance to the ear canal. One possibility is to measure the acoustic impedance, i.e., the ratio of sound
pressure and volume velocity, at the entrance of the ear canal. The goal is then to estimate the transfer
impedance, i.e., the ratio of the eardrum sound pressure to the volume velocity at the entrance, because
one can then use input and transfer impedances together with a source model to individually predict the
eardrum pressure, see e.g. [1].
A useful one-dimensional equation to study this behavior is Webster's horn equation [2], describing the
sound pressure in a horn, i.e., a tube with varying diameter. In order to solve Webster's equation for
the sound pressure at dierent positions along the ear canal, an area function which describes the area
along the ear canal is needed. If three-dimensional ear canal geometries are given, a curved center axis
and an associated area function can be computed, using for instance the method proposed by [3]. In most
cases, such data is, however, not available. Alternatively, area functions can be estimated from acoustic
impedances or reectances measured at the entrance of the individual ear canal.
In a number of publications, the phase of the reectance was used to estimate the transfer impedance and
area function [4, 1, 5, 6, 7, 8]. As an example, in [4] the optimization was done by an electro-acoustic model
and a gradient method to approximate the radius function for a measured (or simulated) input reectance.
Given reference pressure values at the eardrum, the pressure was transformed back to the entrance for
individual ear canals. A chain matrix, optimized using reectance data then lead to accurate results for the
radius function and the pressure at the drum for frequencies up to 16 kHz.
Another approach using a reectance-based method was considered in [5] where the aim was to reproduce
the ear canal cross-sectional area. Specically, a time-domain reectance was calculated and the inverse
solution to the time-domain horn equation was formulated in terms of forward and backward traveling
pressure waves to obtain the area function by using a nite dierence approximation. The solution to the
inverse problem was analyzed for innite acoustic horns in [9]. In [5] the area function of the inverse solution
was applied to measurements made in an ear simulator. The estimated ear canal area function was close to
1arXiv:2304.07131v1  [math.OC]  14 Apr 2023the one of the simulator. Furthermore, the authors estimated the ear canal area function from reectance
measurements on real subjects, assuming the eardrum to be rigid, although the true ear canal area functions
were not known. The resulting ear canal area functions looked plausible and similar to other ear canal area
functions from the literature. The transfer impedance, however, was not investigated.
In this paper, we present a dierent approach based on data of the input impedance in the frequency domain.
Working in the frequency domain appears to be more convenient with respect to actual measurement data
(i.e., acoustic impedances or reectances) whose validity will in general be limited to a certain frequency
range. Our aim is to estimate the transfer impedance of the individual residual ear canal. To this end,
we parameterize the ear canal area function and the acoustic impedance of the eardrum. We solve the
horn equation in the frequency domain with linear nite elements and optimize the parameters using the
Nelder-Mead method [10] with respect to given data of the input impedance. By doing so, we also obtain
estimations of the ear canal area function and the acoustic impedance at the eardrum.
The general idea of the method is described in section 2. The generation of data as input and for validation
purposes is explained in section 3. In section 4 the procedure from section 2 will be extended by several
adjustments to avoid unrealistic results during the parameter tting. The nal version of our method is
validated in section 5 on a variety of ear canal geometries with dierent eardrum impedance models. Finally,
in section 6 conclusions are given.
A MATLAB implementation of the complete method can be found in the supplementary material [11].1
2 Method
The main goal of our method is to estimate the transfer impedance Ztr, based on data of the input impedance
Zin;data, for individual ear canals. To do this, we use Webster's horn equation [2] in the frequency domain
as surrogate model of a simplied representation of the pressure distribution in the ear canal,
d
dx
S(x)d
dxp(x)
+k2S(x)p(x) = 0 in [0 ;`]; (1a)
S(0)dp
dx(0) =qi!; (1b)
S(`)dp
dx(`) +i!
Zdp(`) = 0: (1c)
The solution p(x) to this problem denotes the acoustic pressure, S(x) is the area function, k=2f
the
wavenumber with frequency fand wavelength ,qthe volume velocity, != 2fthe angular frequency, 
the density of air inside the ear canal and Zdthe acoustic impedance of the eardrum. In this setting, the
aim is to estimate the transfer impedance Ztr=p(`)
qfrom given data of the input impedance Zin;datawhich
in turn is modeled by Zin=p(0)
qin the one-dimensional surrogate (1a)-(1c). The area function S(x) and
acoustic impedance Zdat the eardrum are unknown. In the following, these quantities are parameterized
and tted to the given data of the input impedance by minimizing the cost function
J0(Zin) =X
f2FAlog10Zin(f)
Zin;data(f)2
+BargZin(f)
Zin;data(f)2
; (2)
with weighting parameters AandB. These are chosen as A= 10 andB= 1. The cost function is thus
the weighted sum of the squared dierences between model and data of the logarithmic amplitude and the
phase in radians. Zin;data(f) denotes the given data, i.e., the input impedance from the measurement at the
entrance of the ear canal for a specic frequency f, whereasZin(f) denotes the input impedance from the
solution of problem (1a)-(1c) at the entrance. Fdenotes a set of frequencies. Dierent choices of Fwill
be discussed in section 4.3. Unknown parameters are involved in the area function S(x), the model for the
acoustic impedance at the eardrum Zdand the length of the ear canal `. The area function is modeled as
S(x) :=S(x;S0;c;s;`) =S0+MX
m=1cmcosmx
`
+smsinmx
`
: (3)
The acoustic impedance ZEDat the eardrum is modeled using a two-resonator model, similar to the model
described in [12],
ZED=1
10L0;1=20 dB(iv1Q1+ 1)+1
10L0;2=20 dB(iv2Q2+ 1) 1
Pas/m3; (4)
1See supplementary material at https://github.com/nickwulbusch/ear-canal-parameter-tting-1d for full MATLAB-Code
of the nal method.
2where
vi=!
2f0;i 2f0;i
!(5)
and the parameters Qi,f0;iandL0;iare the quality factor, the resonance frequency and the impedance
level at resonance (in dB re 1 Pa s/m3), respectively. This model is a good compromise between the number
of parameters and approximation as compared to more sophisticated models like the model by [13]. It is
notably capable of modeling the cadaver measurements of [14] with acceptable accuracy.
Following the suggestion by [15], the innermost part of the ear canal is modeled as a lumped compliance (of
a right circular cone of 4 mm length and 2.5 mm radius) acting in parallel with the eardrum impedance,
Zd=ZEDZvol
ZED+Zvol; (6)
where
Zvol=c2
i!V; (7)
ZEDcorresponds to the acoustic impedance at the eardrum, cis the speed of sound and Vis the volume of
the cone. This eectively removes the innermost part from the ear canal geometry.
The parameters used in the denitions of the area function, i.e., S(x) in (3) and the acoustic impedance of
the eardrum Zdin (6), were tted using the Nelder-Mead constrained optimization procedure [10, 16]. To
this end, equations (1a)-(1c) were solved numerically by a self-implemented nite-element code in MATLAB
using linear basis functions and the Simpson quadrature rule to compute the integrals. For this, equation
(1a) was multiplied by a test function u(x) and integrated over the interval [0 ;`]. Changing the signs and
integrating by parts lead to the so called weak formulation
Z`
0S(x)p0(x)u0(x)dx+i!
Zdp(`)u(`) k2Z`
0S(x)p(x)u(x)dx= qi!u (0): (8)
To discretize this problem we divided the interval into smaller intervals [ xn 1;xn] withxn=n`
N,n= 1;:::;N
for someN2N. These subintervals are called elements. Next we considered a basis f'ngnof continuous
and piecewise linear functions, where 'nare hat functions on the corresponding subinterval [ xn;xn+1] and
0 elsewhere:
'n(x) =8
><
>:x xn 1
xn xn 1;ifx2[xn 1;xn);n= 1;:::;N;
xn+1 x
xn+1 xn;ifx2[xn;xn+1];n= 0;:::;N 1;
0; else:(9)
The discrete solution pNto (8) is written in terms of this basis,
pN(x) =NX
n=0cn'n(x); (10)
where the coecients cnare computed by solving the system of linear equations
(A M+R)c=F; (11)
where
Aij=Z`
0S(x)'0
j(x)'0
i(x)dx; (12a)
Mij=k2Z`
0S(x)'j(x)'i(x)dx; (12b)
RNN =i!
Zd; Rij= 0;fori6=N6=j; (12c)
F1= qi!; F i= 0;fori6= 0: (12d)
In the experiments, the number of elements was chosen frequency-dependent as N= 4 max 
1 m`=2;1
,
i.e., the discretization is dierent for each frequency. In this case the typical "rule of thumb" of 10 elements
per wave length is guaranteed. Additionally for the case of the horn equation, the discretization error with
respect to a the magnitude and phase seems to be uniformly bounded, see gure 1. The discretization error
was computed with respect to a reference solution with Nref= 5000 elements.
Figure 2 illustrates an example solution for the weak formulation (8) of the horn equation (1a)-(1c) for
a frequency of f= 6 kHz,Zd= (6:08 + 7:34i)107Pas/m3and an area function chosen as illustrated in
gure 2, i.e., a typical area function for an ear canal. In comparison, the solution to the pure Helmholtz
problem, i.e., using a constant area function, is visualized as well to see the impact of the area function.
310-510-310-1input impedance
transfer impedance
102103104
frequency [Hz]10-710-510-310-1phase difference [rad]Figure 1: Level dierence and phase dierence of Zin=p(0)
qandZin;ref=pref(0)
qandZtr=p(L)
qand
Ztr;ref=pref(L)
q. The discrete solution pof (8) is computed with N= 4 max 
1 m`=2;1
elements for
a typical area function S(x) and eardrum impedance Zd. The reference solution prefis computed with
Nref= 5000 elements. The error is uniformly bounded within the frequency range 100 Hz to 20 kHz.
3 Data
The synthetically generated input impedance and validation data were created by 3D nite-element sim-
ulations on geometries from the IHA database [17, 18]. For the simulation, the STL geometry was cut at
the rst bend of the ear canal. The rst bend was determined by computing the center axis of the ear
canal using the VMTK toolbox [19]. Then, the coordinates with highest curvature of this center axis in the
region of the rst bend, which can be visually estimated, was evaluated using the MATLAB function of [20].
The implementation by [21] was used to shape the entrance surface with respect to the coordinates of the
rst bend and the corresponding tangential vectors. This modied geometry was used in [22], where the
geometries were discretized in a tetrahedral mesh with approximately 70,000-100,000 degrees of freedom,
which corresponds to a maximum edge length of 1 mm of an element. The meshes at the eardrum were
rened further with maximum edge length of 0.2 mm. As example, the meshed ear canal from subject 5 is
illustrated in gure 3.
The entrance surface was then assumed to vibrate piston-like to provide the excitation of the residual ear
canal. Using this set-up, acoustic input impedances for three dierent types of impedances at the eardrum
were computed at the entrance, by solving the Helmholtz equation,
p3D(x) +k2p3D(x) = 0 in D; (13a)
@p3D
@n= vni! on   entrance; (13b)
@p3D
@n+i!
eZEDj drumjp3D= 0 on   drum; (13c)
@p3D
@n= 0 on   wall; (13d)
withDbeing the interior of the geometry,   entrance@Dis the surface at the entrance,   drum@Dis
the surface that corresponds to the eardrum and   wallis the wall of the ear canal.@
@ndenotes the outer
normal derivative. Note that comparing equation (1b) and (13b) we have dierent signs, since in (1b) the
derivative in the one-dimensional model is directed into the interval. vnis the particle velocity. The input
impedance used as input data during the parameter tting was averaged over the entrance surface   entrance
Zin;data=1
j entrancejR
 entrancep3D(x)d entrance
j entrancejvn:
4130135140145150
variable area function
constant area
0 0.005 0.01 0.015 0.02 0.025
axial distance x [m]--/20/2phase [rad]
0 0.005 0.01 0.015 0.02 0.025
axial distance x [m]00.511.522.533.544.55area function S [m2]10-5Figure 2: Solution for the Horn equation with f= 6000 Hz with variable area function and constant area
function using linear nite elements (top) and associated area functions (bottom).
Figure 3: Mesh of the ear canal of subject 5 cut at the rst bend. The ear canal was rotated such that both
the entrance and the eardrum (marked faces) are visible.
The considered eardrum impedances eZEDare of the following types
(i) impedance model by Hudde and Engel [13],
(ii) a two-resonator model as described in (4) with parameters given in table 1,
(iii) (nearly) rigid, i.e., eZED8:41022 8:81015i Pas/m3,
They are illustrated in gure 4. For the validation in section 5, the transfer impedance Ztr;datawas computed
with respect to the umbo, i.e.,
Ztr;data=p3D(xumbo)
j entrancejvn:
The entrance impedance Zin;dataand transfer impedance Ztr;datawere computed for 200 distinct frequencies
linearly distributed in the range between 100 Hz and 20 kHz. A total of 30 data sets, ten subjects with three
dierent impedance models each, were available for testing and validation.
5150160170180190
Hudde
Two-resonator
102103104
frequency [Hz]--/20/2phase [rad]Figure 4: Eardrum impedances types (i) and (ii) for eZEDthat were used to compute the reference data.
Type (iii) is not shown due to the large magnitude that is constant at approximately 458 dB with zero
phase.
resonator 1 resonator 2
f0 1000 Hz 3500 Hz
Q 1.1 1.5
L0153 dB re 1 Pas=m3157 dB re 1 Pas=m3
Table 1: Parameters used for the generation of data using the two-resonator model.
4 Original parameter tting and renement of the method
S0[m2] `[m] cm sm
upper bound 210 41510 32 m+210 52 m+210 5
lower bound 10 54510 3 2 m+210 5 2 m+210 5
basic 610 53010 3(210 6;0; : : : ; 0) (0 ;0; : : : ; 0)
L0;1[dB] L0;2[dB] Q1Q2f0;1[Hz] f0;2[Hz] V[m3]
upper bound 200 L0;1+40 10 10 2500 6000 5 :2310 8
lower bound 50 L0;1+0 0.3 0.3 500 2500 1 :310 8
basic 161 L0;1+20 1.2 1.2 900 4000 2 :6210 8
Table 2: Basic estimate with lower and upper bounds of the parameters of the ear canal area function and
the two-resonator impedance model used in the one-dimensional surrogate model. The decibel values for
impedance levels L0;1andL0;2refers to dB re 1 Pa s=m3.
We began with the basic algorithm and M= 4, i.e., four sine and cosine summands in the denition
of the area function S(x) in (3). The parameter tting was done with a subset of all available frequencies,
more specically with 25 logarithmically distributed frequencies in the range from 100 Hz to 20 kHz. The
parameter constraints were set according to table 2 to ensure that the area function S(x) does not take
excessive values, the oscillations of the area function are not unreasonably large and the impedance mag-
nitude at the eardrum corresponds approximately to the expectations from commonly used models (i) and
(ii) as in gure 4. To enhance the accuracy, the Nelder-Mead method was used with three restarts, taking
the result of the preceding optimization as initialization. Since the Nelder-Mead optimization procedure
does not guarantee convergence to a global minimum, the parameter tting procedure was executed several
times with dierent initial parameters. These were chosen as random perturbation of up to 25 % from the
60 0.01 0.02 0.03 0.04
axial distance x [m]01234567area function S [m2]10-5
umboparameter fitting
data
120140160180input impedance
102103104
frequency [Hz]-/20/2phase [rad]transfer impedance
102103104
frequency [Hz]Figure 5: Results for the original parameter tting method for subject 5 and impedance model (ii). Solutions
to each of the twelve dierent initial parameter sets are depicted by a black line respectively. Left: Area
function. The rear part represents the cone as part of the impedance model, see discussion in section 2.
Center: Input impedance Zin. Right: Transfer impedance Ztr.
basic set of parameters, also depicted in table 2, i.e., for a given parameter with basic value 0,
init=0(1 + 0:25U( 1;1));
whereU( 1;1) is the uniform distribution over the interval (  1;1). In total, twelve dierent initial param-
eter sets were considered. Figure 5 shows the results obtained with all twelve sets of initial parameters,
considering data generated from the geometry of subject 5 and eardrum impedance model (ii). All twelve
initial parameter sets converged to similar results, thus the lines for each model type are very close to each
other. The area function S(x) has a similar trend in comparison to the area function computed by the
method of [3] which is depicted as data curve in gure 5. The input impedance is tted well over the whole
frequency range and even for the transfer impedance only slight dierences between data and model can be
observed.
However, this original parameter tting did not lead to comparably good results for all subjects and all
dierent types of eardrum impedances. To enhance the robustness of the method, several aspects that lead
to problems or unrealistic results for individual subjects and eardrum impedance models are considered in
the following and possible solution strategies are discussed, implemented and illustrated.
4.1 Avoiding negative areas
For some initial parameter sets, the original parameter tting procedure returns a parameter set where the
corresponding area function S(x) takes negative values for some part in the interval [0 ;`]. Even though the
reference data, i.e., the input impedance, was matched reasonably well, see gure 6, some larger dierences
can be observed for the transfer impedance. We also note that the initial parameter set largely inuences
the result, thus the method is not very robust with regard to the initialization. Two possible strategies to
prevent negative area function are
(1) further restriction on the parameters S0;cmandsmsuch that the area function Swill always be
positive,
(2) adding a penalty term to the cost function that penalizes negative or small values of S.
Here the rst strategy is not very practical. It leads to strong restrictions on S0in the way that the lower
bound needs to be relatively large or the restrictions on cmandsmare such that admissible geometries are
quite restricted.
The second strategy still keeps a lot of freedom in the geometry-related parameters and will be used in the
following. The penalty term is chosen as
J1;H(1)(S0;c;s;`) = 104kmax 
H(1) S(x);0
k1
H(1); (14)
70 0.01 0.02 0.03 0.04 0.05
axial distance x [m]01234567area function S [m2]10-5
umboparameter fitting
data
120140160180input impedance
102103104
frequency [Hz]-/20/2phase [rad]transfer impedance
102103104
frequency [Hz]Figure 6: Parameter tting may lead to negative values of the area function. Results for subject 3 and
impedance model (i). Solutions to each of the twelve dierent initial parameter sets are depicted by a black
line respectively. Left: Area function. The rear part represents the cone as part of the impedance model,
see discussion in section 2. Center: Input impedance Zin. Right: Transfer impedance Ztr.
wherekk1is the discrete supremum norm. This penalty term penalizes the area function becoming smaller
thanH(1). We choose H(1)= 10 5m2, which is about one half of the base area of the standard cone with
a radius of 2.5 mm.
The updated procedure now usually generates functions that are positive on [0 ;`]. If the area still becomes
negative then the model-data mist is probably just too large and a meaningful parameter tting is not pos-
sible with the underlying one-dimensional surrogate model (1a)-(1c) or the initial values were chosen poorly.
0 0.01 0.02 0.03 0.04 0.05
axial distance x [m]01234567area function S [m2]10-5
umboparameter fitting
data
0 0.01 0.02 0.03 0.04 0.05
axial distance x [m]umbo
0 0.01 0.02 0.03 0.04 0.05
axial distance x [m]umbo
Figure 7: Left: Results incorporating penalty term J1for subject 3 and impedance model (i) for twelve
dierent initial parameter sets. Parameter tting may lead to unrealistic ear canal geometries due to large
increases in the area function near the eardrum. Center: Results incorporating penalty terms J1andJ2for
subject 3 and impedance model (i) for twelve dierent initial parameter sets. Parameter tting may lead to
largely overestimating the length of the ear canal. Right: Results incorporating penalty terms J1,J2and
prior estimating of the ear canal length `for subject 3 and impedance model (i) for twelve dierent initial
parameter sets. Parameter tting leads to a realistic are function.
Occasionally the problem arises that the area function steeply increases after reaching the minimum.
One case for this behavior is illustrated in gure 7a. This is anatomically at least unusual. Therefore,
another penalty term is applied that penalizes solutions in which the end of the ear canal is larger than the
overall minimum or close to that minimum. This additional penalty term is given as
J2;H(2)(S0;c;s;`) = 104maxS(`) S(x) H(2)
jS(x)j;0
1: (15)
The penalty is chosen as H(2)= 0 which enforces the minimum of the area function to be at the end of the
8ear canal. The cost function now becomes
J=J0+J1;H(1)+J2;H(2): (16)
Using the updated cost function Jin the parameter tting leads to more realistic ear canal area functions,
see gure 7b.
4.2 Accomodating long and short ear canals
The length of the ear canal varies for each individual, thus the bounds of `are chosen as 15 mm `45 mm
to be able to model short and long ear canals. Arbitrary initial values for `may, however, lead the Nelder-
Mead algorithm converge to a local minimum with an inadequate result for the value of `, as can be seen in
gure 7b. To avoid this, we estimate `in a rst step by looking at the rst maximum of the input impedance
magnitude of the data, see for example gure 6b at around 8 kHz. Assuming a rigidly terminated cylindrical
waveguide, the initial length is estimated as
`est=c
2fmax; (17)
wherefmaxcorresponds to the frequency where the rst maximum of the input impedance magnitude, i.e.,
the data, is achieved. It turned out that in general the rst maximum frequency gave a better result than
the rst minimum, which is why the length was estimated using equation (17). The ear canal is not a rigidly
terminated cylindrical waveguide, but still this is a reasonable rst approximation. Using this estimated
`estas initial parameter leads to more appropriate results in the numerical simulations. To ensure that the
overall length does not vary much from this estimated initial length during the parameter tting, the bounds
for`were redened to `est 3 mm``est+ 1 mm. The upper bound is stricter since the impedance
model already assumes that the ear canal is longer due to the cone at the end representing the innermost
part of the ear canal. These bounds lead to reasonable results for most initial values, see gure 7c. Further
results using the rened method are discussed in the validation in section 5.
In the following subsection we further discuss the inuence of the chosen frequency set for the parameter
tting and the inuence of the length of the expansion of the area function.
4.3 Inuence of the bandwidth and frequency spacing used in the parameter
tting
While the improvements of the prior subsections lead to better results in the parameter tting, in some
cases problems arise at very high frequencies, because some features of the 3D geometry cannot be captured
in a one-dimensional model. This means that not for all ear canal shapes good estimations on the transfer
impedance for frequencies up to 20 kHz can be expected. An example is illustrated in gure 8. Here, the
minimum of the magnitude of the input impedance at approximately 17 kHz is much lower than usual. For
this individual, good approximations for high frequencies cannot be achieved using the horn equation. It
might therefore be useful to restrict the frequency range during the parameter tting to get better results
regarding the lower frequency part. Restricting the frequency range to frequencies smaller than 10 kHz lead
to improvements in the input impedance Zinand transfer impedance Ztrfrom the parameter tting, see
gure 9.
In the following, dierent choices for frequency subsets are considered. The considered frequency sets
were either uniformly or logarithmically distributed (rounded up to the nearest 100 Hz). Figure 10 illustrates
the validation for uniformly distributed frequencies where the magnitude and phase dierence of the transfer
impedance was computed with respect to the reference data. For some frequency sets, ner resolutions in the
low frequency range (up to 3 kHz) or the higher frequency range (larger than 3 kHz) were used. Dierent
upper limits were also considered, where the frequency sets were restricted either to frequencies up to
20 kHz or 10 kHz for reasons discussed above. Additionally, for some frequency sets F, the frequencies that
correspond to the maxima and minima of the input impedance magnitude were included, because these are
the frequencies where usually the largest error with respect to the data is made and these frequencies are
characteristic for the specic ear canal shape. We could observe that the frequency set using logarithmic
distribution while additionally including the frequencies corresponding to the maxima and minima of the
magnitude of the input impedance results in comparably low function values for the specic frequency range
with respect to the validation function
Jval(Ztr) =X
f=100 Hz;200 Hz;
:::;20 kHzAlog10Ztr(f)
Ztr;data(f)2
+BargZtr(f)
Ztr;data(f)2
: (18)
9120140160180input impedance
parameter fitting
data
102103104
frequency [Hz]-/20/2phase [rad]transfer impedance
102103104
frequency [Hz]Figure 8: Ear canal of subject 9 and impedance model (i) as example for a case of high frequency behavior
that cannot be reproduced with the one-dimensional model. The last minimum in the entrance and transfer
impedance data gets very low. Including high frequencies in the parameter tting very likely inuences
precision for lower frequencies.
120140160180input impedance
parameter fitting
data
102103104
frequency [Hz]-/20/2phase [rad]transfer impedance
102103104
frequency [Hz]
Figure 9: Ear canal of subject 9 and impedance model (i) when only using data for frequencies up to 10 kHz.
Improvements in the lower frequency range, especially up to 8 kHz can be observed in comparison to gure
8.
Although other congurations lead to comparable validation function values, plotting the actual dierence
of the magnitude in dB over the frequency showed that for low frequencies the versions using uniformly dis-
tributed frequencies result in slightly worse behavior in the low frequency range with magnitude dierences
of up to 3 dB in the frequency range from 100 Hz to 6 kHz, see gure 10 as example, while the logarithmically
distributed frequencies only lead to magnitude dierences of up to 1.5 dB in this frequency range. This case
is discussed and illustrated in the validation in section 5. Consequently, a logarithmic distributed frequency
set with maxima and minima frequencies was the choice for the validation in section 5.
Since usually frequencies smaller than 10 kHz are especially of interest, we restrict the frequencies to
10 kHz to improve the results in this range, especially if the pressure distribution in the ear canal exhibits
large three-dimensional eects due to the geometry of the ear canal.
10-20-1001020
102103104
frequency [Hz]--/2-/4-/80/8/4/2Figure 10: Validation for the parameter tting considering dierences of the transfer impedance for fre-
quencies for linearly distributed frequencies up to 20 kHz considering all data sets. Straight solid line: 5 dB
or 45Â°dierence. Straight dashed line: 3 dB or 22.5 Â°dierence. Blue lines: 5 and 95 quantile. Red line in
between: Mean. Dashed gray lines: Frequencies used during the parameter tting.
4.4 Inuence of the number of parameters in the area function expansion
1 2 3 4 5 6 7 8
number of Fourier coefficients in expansion100101102103validation function Jval
Figure 11: Validation function Jvaldepending on number of Fourier coecients in area function.
In the parameter ttings in the previous sections, the number of geometrical parameters ciandsiwas
always chosen as M= 4. In this section, observations on varying number of parameters Mare discussed.
Figure 11 illustrates the validation function Jvalfrom (18) computed for varying parameter M. The un-
derlying data for the boxplot are the rened parameter ttings of all ten subjects and all three dierent
impedance models (i)-(iii). We observe only small changes for M4. Thus, due to increasing computa-
tional cost in the following experiments M= 4 was chosen as a reasonable compromise between accuracy
and computational cost.
115 Validation
5.1 Transfer impedance
-20-1001020
102103104
frequency [Hz]--/2-/4-/80/8/4/2
Figure 12: Validation for the parameter tting considering dierences of the transfer impedance for fre-
quencies for up to 10 kHz. Straight solid line: 5 dB or 45 Â°dierence. Straight dashed line: 3 dB or 22.5 Â°
dierence. Blue lines: 5 and 95 quantile. Red line in between: Mean. Dashed gray lines: Frequencies used
during the parameter tting.
In this section validation results are presented. To this end, ten dierent ear canals with three dierent
impedance models at the eardrum were considered as discussed in section 3.
-20-1001020
102103104
frequency [Hz]--/2-/4-/80/8/4/2
Figure 13: Validation for the parameter tting considering dierences of the transfer impedance for frequen-
cies for up to 20 kHz exluding subject 9 that showed unusual behavior for high frequencies. Straight solid
line: 5 dB or 45 Â°dierence. Straight dashed line: 3 dB or 22.5 Â°dierence. Blue lines: 5 and 95 quantile.
Red line in between: Mean. Dashed gray lines: Frequencies used during the parameter tting.
12In gure 12 the transfer impedance level and phase dierence between the data and the parameter tting,
i.e.,
20 log10Ztr
Ztr;data
and argZtr
Ztr;data
;
are plotted. The blue lines indicate the 5% and 95% quantile over the 30 parameter ttings based on 30
data sets, i.e., 10 dierent subjects and three dierent impedance models at the eardrum, in total.
The parameter tting was done for twelve initial parameter sets in all cases. Only the one with the
lowest cost function over all 200 frequencies was kept. The results are illustrated in gure 12. In this case
the results show magnitude dierences of less than 1 dB for all frequencies in the range of up to 7 kHz,
and still magnitude dierences smaller than 5 dB for frequencies between 7 kHz and 10 kHz. In most cases
the magnitude dierence is even smaller than 3 dB for frequencies up to 10 kHz. For larger frequencies
the dierences are very large since only frequencies up to 10 kHz were used in the parameter tting. Note
however, that for most geometries reasonable results were also achieved for higher frequencies, see gure 13.
5.2 Ear canal area function
During the parameter tting, the estimated parameters for the ear canal area function can be used to
construct an area function to get an approximate model of the geometry.
01234567area function S [m2]10-5
umboparameter fitting
data
umbo umbo
01234567area function S [m2]10-5
umbo umbo umbo
0 0.01 0.02 0.03 0.04
axial distance x [m]01234567area function S [m2]10-5
umbo umbo
0 0.01 0.02 0.03 0.04
axial distance x [m]umbo
0 0.01 0.02 0.03 0.04
axial distance x [m]01234567area function S [m2]10-5
umbo
Figure 14: Results for the ear canal area functions for all ten subjects and all three impedance models
10 kHz.
In gure 14 area functions taken from the parameter tting (using logarthmically distributed frequencies
up to 10 kHz) are displayed comparing it with the area function computed from the 3D geometry using the
method described in [3]. Main features for most ear canals could be reproduced reasonably well. Note that
the geometry used for the generation of the data was cut at the rst bend of the center axis obtained from
using the VMTK toolbox. This center axis diers from the one proposed by [3]. Especially the entrance
13surface will not be perpendicular to the center axis by [3] which explains the large deviations at the entrance
of the area function for some subjects like subject 3 and subject 9. Overall, the approximations from the
parameter tting are quite close to the area function generated with the method from [3]. The area functions
are also largely unaected by the impedance model used for the data generation.
5.3 Impedance at eardrum
140150160170180190
parameter fitting
data
/20/2phase [rad]
140150160170180190
/20/2phase [rad]
102103104
frequency [Hz]200300400500
102103104
frequency [Hz]/20/2phase [rad]
Figure 15: Estimated impedances at the eardrum for dierent underlying model data: (i) Hudde (ii) two-
resonator (iii) rigid.
The parameter tting also lead to an approximation of the impedance at the eardrum. This is illustrated
in gure 15. The data of the two-resonator model (ii) can be reconstructed well since this is the impedance
model we used in the parameter tting. The model by [13] is approximated well in the low frequency range.
The impedance condition (iii) could not be approximated well since the bounds on the parameters do not
allow impedances of such high magnitude. However, one can observe that the magnitude is larger than in
the other cases, such that the resulting parameter tting is closer to the rigid case. In all cases, the true
eardrum impedance had a larger magnitude than the estimated one at frequencies above 2 kHz.
6 Conclusion
In this paper a method to estimate the transfer impedance from input impedance is described and validated.
Using synthetically generated data the method produces accurate results, especially in the frequency range
of 100 Hz to 7 kHz. We can furthermore estimate the ear canal area function and the eardrum impedance,
where for the area function the main features of the geometry were recognized. The eardrum impedance
was estimated well in the low frequency range if the underlying impedance model was tting. For higher
frequencies, however, the eardrum impedance estimation was underestimated in general.
Future work should involve the validation and enhancement of the method using in vivo measurements.
14Acknowledgments
This research was partially funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foun-
dation) { Project ID 352015383 { SFB 1330 C1
Data availability statement
An implementation of the complete model is available on GitHub, under the reference
https://github.com/nickwulbusch/ear-canal-parameter-tting-1d.
References
[1] M. Blau, T. Sankowsky, P. Roeske, H. Mojallal, M. Teschner, and C. Thiele, \Prediction of the sound
pressure at the ear drum in occluded human cadaver ears," Acta Acustica united with Acustica , vol. 96,
no. 3, pp. 554{566, 2010.
[2] A. G. Webster, \Acoustical impedance and the theory of horns and of the phonograph," Proceedings
of the National Academy of Sciences of the United States of America , vol. 5, no. 7, pp. 275{282, 1919.
[3] M. R. Stinson and B. W. Lawton, \Specication of the geometry of the human ear canal for the
prediction of sound-pressure level distribution," The Journal of the Acoustical Society of America ,
vol. 85, no. 6, pp. 2492{2503, 1989.
[4] H. Hudde, A. Engel, and A. Lodwig, \Methods for estimating the sound pressure at the eardrum," The
Journal of the Acoustical Society of America , vol. 106, no. 4 Pt 1, pp. 1977{1992, 1999.
[5] D. M. Rasetshwane and S. T. Neely, \Inverse solution of ear-canal area function from reectance," The
Journal of the Acoustical Society of America , vol. 130, no. 6, pp. 3873{3881, 2011.
[6] T. Sankowsky-Rothe, M. Blau, E. Rasumow, H. Mojallal, M. Teschner, and C. Thiele, \Prediction
of the sound pressure at the ear drum in occluded human ears," Acta Acustica united with Acustica ,
vol. 97, no. 4, pp. 656{668, 2011.
[7] T. Sankowsky-Rothe, M. Blau, S. K ohler, and A. Stirnemann, \Individual equalization of hearing
aids with integrated ear canal microphones," Acta Acustica united with Acustica , vol. 101, no. 3, pp.
552{566, 2015.
[8] N. N. Souza, S. Dhar, S. T. Neely, and J. H. Siegel, \Comparison of nine methods to estimate ear-canal
stimulus levels," The Journal of the Acoustical Society of America , vol. 136, no. 4, pp. 1768{1787, 2014.
[9] D. M. Rasetshwane, S. T. Neely, J. B. Allen, and C. A. Shera, \Reectance of acoustic horns and
solution of the inverse problem," The Journal of the Acoustical Society of America , vol. 131, no. 3, pp.
1863{1873, 2012.
[10] J. A. Nelder and R. Mead, \A simplex method for function minimization," The Computer Journal ,
vol. 7, no. 4, pp. 308{313, 1965.
[11] N. Wulbusch, \Ear canal parameter tting 1d [code]," 2023. [Online]. Available:
https://github.com/nickwulbusch/ear-canal-parameter-tting-1d
[12] A. Stirnemann, \Ein Mittelohrmodell basierend auf der Aussenohr-Transferimpedanz," Fortschritte
der Akustik - DAGA 2011, D usseldorf , 2011.
[13] H. Hudde and A. Engel, \Measuring and modeling basic properties of the human middle ear and ear
canal. part iii: Transfer functions and model calculations," Acta Acustica , no. 84, pp. 1091{1109, 1998.
[14] J. J. Rosowski, P. J. Davis, S. N. Merchant, K. M. Donahue, and M. D. Coltrera, \Cadaver middle
ears as models for living ears: comparisons of middle ear input immittance," The Annals of otology,
rhinology, and laryngology , vol. 99, no. 5 Pt 1, pp. 403{412, 1990.
[15] H. Hudde and A. Engel, \Measuring and modeling basic properties of the human middle ear and ear
canal. part i: Model structure and measuring techniques," Acta Acustica , no. 84, pp. 720{738, 1998.
15[16] J. D'Errico. fminsearchbnd, fminsearchcon. [Online]. Available:
https://www.mathworks.com/matlabcentral/leexchange/8277-fminsearchbnd-fminsearchcon
[17] R. Roden and M. Blau, \The IHA database of human geometries including torso, head and complete
outer ears for acoustic research," 08 2020, 49th International Congress and Exposition on Noise Control
Engineering, Inter-Noise, Seoul.
[18] ||, \The IHA database of human geometries including torso, head and complete outer ears for
acoustic research," 2021.
[19] L. Antiga, \Patient-specic modeling of geometry and blood ow in large arteries," 01 2002, doctoral
thesis, Politecnico di Milano, dipartimento di bioingegneria.
[20] A. Mjaavatten, \Curvature of a 1d curve in a 2d or 3d space." [Online]. Avail-
able: https://www.mathworks.com/matlabcentral/leexchange/69452-curvature-of-a-1d-curve-in-a-
2d-or-3d-space, (last visited March 8, 2023).
[21] D. Claxton, \Frenet." [Online]. Available: https://www.mathworks.com/matlabcentral/leexchange/11169-
frenet, (last visited March 8, 2023).
[22] COMSOL, \Comsol multiphysics Â®,"Stockholm, Sweden . [Online]. Available: www.comsol.com
16