Power Grid Parameter Estimation Without Phase
Measurements: Theory and Empirical Validation
Jean-S ´ebastien Brouillon
Giancarlo Ferrari Trecate
Institute of Mechanical Engineering
Ecole Polytechnique F ´ed´erale de Lausanne
Lausanne, Switzerland
{jean-sebastien.brouillon, giancarlo.ferraritrecate }@epfl.chKeith Moffat
Florian D ¨orfler
Department of Information Technology and Electrical Engineering
ETH Z ¨urich
Z¨urich, Switzerland
{kmoffat, dorfler }@ethz.ch
Abstract —Reliable integration and operation of renewable
distributed energy resources requires accurate distribution grid
models. However, obtaining precise models is often prohibitively
expensive, given their large scale and the ongoing nature of
grid operations. To address this challenge, considerable efforts
have been devoted to harnessing abundant consumption data for
automatic model inference. The primary result of the paper is
that, while the impedance of a line or a network can be estimated
without synchronized phase angle measurements in a consistent
way, the admittance cannot. Furthermore, a detailed statistical
analysis is presented, quantifying the expected estimation errors
of four prevalent admittance estimation methods. Such errors
constitute fundamental model inference limitations that cannot be
resolved with more data. These findings are empirically validated
using synthetic data and real measurements from the town
of Walenstadt, Switzerland, confirming the theory. The results
contribute to our understanding of grid estimation limitations
and uncertainties, offering guidance for both practitioners and
researchers in the pursuit of more reliable and cost-effective
solutions.
Index Terms —Distribution Grid, Parameter estimation, Smart
meters, Network identification
I. I NTRODUCTION
The deployment of sensors and machine learning techniques
on power grids has opened a new set of power system
monitoring applications. Among them, line parameter and
topology estimation may play a crucial role for deploying
smart energy resources [1]–[7]. This is specially needed
at the distribution level, as Distribution System Operators
(DSOs) often lack accurate models of their Distribution Grids
(DGs)1. Many recent studies have shown that physical models
of a distribution grid can be estimated from synchronized
voltage and current measurements [8]–[12]. However, micro
synchrophasor measurement units ( µPMUs) remain expensive
and therefore mostly absent in DGs.
Sensor costs motivate grid analysis that does not rely
on accurate phase angle measurements, as voltage and cur-
This research is supported by the Swiss National Science Foundation under
the NCCR Automation (grant agreement 51NF40 180545).
1We focus on distribution network applications in this paper, however the
analysis applies to transmission networks as well.rent magnitude sensors are considerably cheaper than µPMU
sensors. Smart meter sensors [13] are becoming ubiquitous
for measuring power consumption. The load—coverage in
European DGs is already above 70% [14]. Thus, the question
whether it is possible to accurately estimate grid impedance or
admittance without synchronized phase angle measurements is
of practical importance. This paper investigates the feasibility
of impedance and admittance estimation from voltage and
current magnitude and power angle measurements only.
Given that phase angles are typically small in DGs, one
might consider applying the methods used for synchronized
measurements with a zero angle. However, recent research
demonstrates that such an approach results in an inconsistent
estimate [15], even when employing Error-in-Variables (EIV)
methods, e.g., the Total Least Squares (TLS). Consistency is
critical when estimating DG parameters because the stability
of the voltage operating point leads to a low Signal-to-Noise
Ratio (SNR), which can only be mitigated by collecting a large
volume of data.
Prior research has improved the accuracy of power system
parameter estimation from smart meter measurements. The
authors of [16] attempted to simultaneously estimating phase
angles and parameters, which reduced the estimation error in
some cases but did not provide consistency guarantees. A sim-
ilar approach is employed in [17], where µPMUs are added at
some nodes to mitigate inconsistencies, albeit not eliminating
them entirely. A more recent development [18] focuses on
canceling the phase variable out of the current flow equations.
This reduction yields consistent estimates of X/R ratios and
certain transformations of conductance and susceptance, but
not of these quantities themselves. Alternatively, some studies
such as [19] have chosen to estimate impedance rather than
admittance, but inverting the impedance estimates also results
in accuracy issues [12].
In this paper, we aim to enhance our understanding of
existing estimation methods by quantifying their inherent
biases, i.e., their expected estimation errors. Our contribution
can be summarized in three main aspects. We first present
a detailed statistical model for common DG sensors and
utilize it to express the biases associated with each estimation
method in a single-line identification setup. Notably, we reveal
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024arXiv:2401.09989v1  [eess.SY]  18 Jan 2024that while each method effectively addresses certain biases
from previous approaches, no admittance estimation method
achieves a perfect bias cancellation, for which synchronized
phasor measurements are required. Second, we show how the
same reasoning can be applied to admittance matrix estimation
problems when the topology is unknown. Third, to validate
our findings and underscore the practical challenges of the
problem, we conduct an experiment using real DG data,
thereby demonstrating the applicability of the methods in the
real world.
A. Preliminaries and Notation
Complex numbers are defined as z=a+jb, where
a, b∈R2andj2=−1. The complex conjugate of z∈
Cis denoted by z⋆. The pseudo-inverse A†of a matrix
A∈Cm×nis obtained by inverting its non-zero singular
values, i.e., if A=Udiag([s,0, . . . , 0])(V⋆)⊤then A†=
Udiag([1/s,0, . . . , 0])(V⋆)⊤. IfAis square and invertible,
thenA†is equal to A−1the inverse of A. The noisy measure-
ment of a variable xis denoted by ˜x. In a regression model
˜z=A˜x+ϵ, we call ˜xand˜zthe Right-Hand Side (RHS) and
Left-Hand Side (LHS) variables, respectively. All variables
have an implicit time-dependence, except the parameters of
the network and probability distributions. This dependence
is implicit. The stacked vector of N+ 1 measurements of
a variable xis denoted by [˜x]tN
t=t0
II. S YSTEM MODEL
A. Distribution Network
We model the a power grid as a graph G(V,E)withnnodes
V={1, . . . , n }and edges E ⊆ V×V . Each node h= 1, . . . , n
is injecting a current ihat a voltage vh. Consumer nodes are
modeled with a negative injection. Nodal AC voltages can
be expressed as phasors vh=|vh|ejθh, where θhis the phase
difference with node 1. The nodal power angle ϕhis the phase
difference between the current injection ihand the voltage
vh(i.e., the arc cosine of the power factor). Additionally, we
define all the quantities for each line h→kusing a double
subscript notation ” hk”. Thus, the voltage drop, current flow,
and power angle of a line from htokarevhk,ihk, and
ϕhk, respectively. For convenience, we define ϕhkas the angle
between ihkandvh.
Assumption 1. The voltage phase angle differences are small,
i.e.,|θh| ≪1.
Comparatively small amounts of power is transmitted on
DGs, which are also quite resistive. This means that Assump-
tion 1 is quite mild. Similar to the voltages, nodal currents are
also phasors ih=|ih|ejθh−jϕh, where the nodal power angle
ϕhis not small in general.
We use a lumped- πcircuit to model each electrical con-
nection in E[20], where the lines are modeled as an inductor
and a resistor in series, and the shunts as capacitors. This
gives the line and shunt admittances yhk=ghk+jbhkand
yhh,s, respectively. If two nodes handkare not connected,
we use yhk= 0. We assume that there are no phase-shiftingtransformers, and that the existing transformers have a constant
ratio over the duration of the experiment. This means that
the voltages and currents can be re-scaled to model the
transformers as simple line admittances.
All parameters are collected in the admittance matrix Y=
G+jBwith GandBinRn×n.Yis defined by its non-
diagonal elements Yhk=yhk,∀h, k∈ V2and its diagonal
ones Ykk=−Pn
k=1yhk+yhh,s,∀h∈ V. For convenience,
we also define the X/R ratio ρhk=−bhk
ghkof each line2.
B. Measuring Devices
Smart meters provide the measurements |˜vh|and|˜ih|of
the amplitudes |vh|and|ih|of the voltage and current and
the measurement ˜ϕhof the power angle ϕh. Moreover, such
sensors can provide the line flow measurements ˜ihkand˜ϕhk
if they are placed on a specific line rather than a node.
Assumption 2. The noise on the current magnitude, voltage
magnitude, and power angle measurements is independent,
Gaussian, and centered on zero.
Although the regulations of commercial smart meters re-
quire a given maximum admissible error, which would imply
that the noise follow a truncated Gaussian [21], the resulting
interval is usually large enough to approximate the noise
distribution as Gaussian.
Assumption 3. The error on power angle measurement is
small.
With Assumption 3, the noise on the current phasor is
almost perfectly Gaussian in Cartesian coordinates. However,
the real and imaginary parts of the noise on current measure-
ments are not independent if the power angle is non-zero.
Remark 1. The active and reactive powers are not a linear
combination of the measured quantities and are subject to
the dependence between the real and imaginary parts of the
current noise. Their uncertainty is therefore neither Gaussian-
distributed nor independent, which is a common assumption
in the literature.
For clarity, we define the noise on the difference of voltage
magnitudes between two nodes and its distribution as
δv
hk:= (|˜vh| − |˜vk|)−(|vh| − |vk|)∼ N(0, σv
hk). (1a)
We chose the lower-case symbol σv
hkfor the variance to
emphasize the fact that it is scalar. We also define the noise
on the line current flow |˜ihk|e−j˜ϕhkmeasured at node has
δℜ
hk
δℑ
hk
:=|˜ihk|cos(˜ϕhk)−|ihk|cos(ϕhk)
|˜ihk|sin(˜ϕhk)−|ihk|sin(ϕhk)
∼ N(0,Σi
hk),(1b)
where Σi
hkis a 2-by-2symmetric matrix containing the
variances σℜ
hk=var[δℜ
hk]andσℑ
hk=var[δℑ
hk]of both parts of
the noise on ihkin the diagonal elements, and their covariance
cov[δℜ
hk, δℑ
hk]in the off-diagonal elements. Finally, we consider
2Inverting a complex number does not invert the ratio between its real and
imaginary parts.
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024the the final measurements are synchronized block-averages
of the instantaneous readings, and that the average over the
estimation window is subtracted from each block to center the
data.
III. L INE PARAMETER ESTIMATION
We first study the estimation problem for a single line before
addressing network estimation in Section VI.
A. Impedance Estimation
The parameters zhk=y−1
hkof a line h→krelate the current
flowihkto the difference of voltages vh−vkat each end of
the line according to the following relationship
|vh|ejθh− |vk|ejθk=zhk|ihk|ej(θh−ϕhk), (2)
which can be written in real numbers and linearized using
e−jθhk≈1−jθhkfrom Assumption 1 as
|vh| − |vk|=rhk|ihk|cos(ϕhk) +xhk|ihk|sin(ϕhk),(3a)
|vk|θhk=−rhk|ihk|sin(ϕhk) +xhk|ihk|cos(ϕhk).(3b)
As shown in [15], (3) is a very close approximation of (2)
when the currents and voltages are exact.
The phase θhkis not measured so one must use (3a) to fit
the parameters rhkandxhk. With noisy measurements, the
regression is performed on the model
|˜vh|−|˜vk|=rhk|˜ihk|cos(˜ϕhk) +xhk|˜ihk|sin(˜ϕhk) +ϵhk,(4)
where ϵhk=δv
hk−rhkδℜ
hk−xhkδℑ
hkembeds the uncertainty.
Remark 2. Under Assumption 1, (3b)≈0so one
can also use (3b) as a regularizer with strength λ, by
adding −λrhk|˜ihk|sin(˜ϕhk) +λxhk|˜ihk|cos(˜ϕhk)≈0
to the regression. This can be done by augmenting
the voltage and current data matrices with [0]tN
t=t0and
[−λ|˜ihk|sin(˜ϕhk), λ|˜ihk|cos(˜ϕhk)]tN
t=t0, respectively.
B. Admittance Estimation
Similar to the impedance, the admittance relates the current
flowihkto the difference of voltages vh−vkat each end of the
line, but in the inverse way. This gives following relationship
|ihk|e−jϕhk=yhk 
|vh| − |vk|e−jθhk
. (5)
As for (3), using the truncated expansion e−jθhk≈1−jθhk
yields
|ihk|cos(ϕhk) =ghk(|vh| − |vk|)−bhk|vk|θhk, (6a)
|ihk|sin(ϕhk) =−ghk|vk|θhk−bhk(|vh| − |vk|). (6b)
One can observe that the unobserved phase angle θhkis not
simple from (6) as it is done in (3). Assumption 1 hints that one
could handle the missing phase measurements by replacing
them with zero. However, the phase often has a key role in
power transmission in practice so assuming it to be exactly
zero is often too constraining. Nevertheless, for very resistivegrids, inferring ghkandbhkin the following regression model
sometimes yields good results.
|˜ihk|cos(˜ϕhk)=ghk(|˜vh|−|˜vk|) +µhk−bhk|vk|θhk,(7a)
|˜ihk|sin(˜ϕhk)=−bhk(|˜vh|−|˜vk|) +νhk−ghk|vk|θhk| {z }
considered as noise,(7b)
where µhk=δℜ
hk−ghkδv
hkandνhk=δℑ
hk+bhkδv
hk.
To conclude this section, we observe that the admittance
regression model (7) actively enforces a small phase angle
θhk, in contrast with the impedance regression (4).
IV. I MPEDANCE ESTIMATION BIAS AND VARIANCE
This section characterizes the bias and variance of single
line impedance estimation. As described in Appendix A, fitting
(4) using the Ordinary Least Squares (OLS) results in biased
estimates of xhkandrhk. This bias can be eliminated by using
Total Least Squares (TLS). However, if there are correlations
between the LHS and the RHS of the regression model, the
TLS estimates can also be biased. Nevertheless, for the noise
model (1), the TLS are a close approximation of the Maximum
Likelihood Estimator (MLE), which can only be computed
exactly if the phase is known.
Lemma 1. If a regression model ˜z=A(˜x−ϵx) +ϵz, where
ϵx, ϵx∼ N(0,Σ)3is fitted to Ddatasets ˜xd,˜zd, the bias of
the TLS is given by
E[ˆA]−A= DX
d=1var[˜xd]−var[ϵxd]!−1
(8)
· DX
d=1cov[ϵxd, ϵzd] +cov[ϵxd,˜zd] +cov[˜xd, ϵzd]!
.
Proof. The proof is derived in Appendix A-B.
Applying Lemma 1 with D= 1 to the model (4) with the
noise statistics (1) gives the bias
E[ˆrhk]−rhk= (var[|˜ihk|cos(˜ϕhk)]−var[δℜ
hk])−1
·(cov[δℜ
hk,|˜vh|−|˜vk|]+cov[|˜ihk|cos(˜ϕhk), δv
hk]−cov[δℜ
hk, δv
hk]),
and similarly for xhk. All three covariances are zero in (1)
so we conclude that the TLS estimate of the impedance is
unbiased. Moreover, the variance of the impedance estimate
can be derived from [22] as4
varˆrhk
ˆxhk
=σv
hk+∥[rhk, xhk]∥2
Σi
hk
Nvar|˜ihk|cos(˜ϕhk)
|˜ihk|sin(˜ϕhk)−1
,(9)
where ∥[rhk, xhk]∥2
Σi
hk= [rhk, xhk]Σi
hk[rhk, xhk]⊤. Equation
(9) shows the consistency5of the TLS estimate because
var[ˆrhk,ˆxhk]→0asN→ ∞ .
3The RHS and LHS variables must be normalized to have the same noise
variance.
4var[ˆrhk,ˆxhk]depends on the exact parameters rhkandxhkand can, in
practice, only be estimated if the SNR is sufficiently high [22].
5Consistent means that it converges with probability 1to the exact param-
eters as N→ ∞ . Efficient means that its variance is equal to the Camer-Rao
lower bound [23].
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024V. A DMITTANCE ESTIMATION BIAS
This section characterizes the biases of several admittance
estimation methods from the literature for a single line. We
focus on the limit case where the sample size is very large,
because the amount of data is not a big limitation for the
estimation problem. This means that although the variance can
be derived from [22] (similar to (9)), we do not include it in
this study because it decays to zero as N→ ∞ and is therefore
less limiting than the biases.
The analysis demonstrates that four known methods for
estimating the admittance from smart meter measurements
produce biased estimates. Nevertheless, we show in Section
V-D that, surprisingly, the biases decay with N→ ∞ only if
one inverts the impedance estimate. Thus, if one is interested
in the admittance of a line from a large data set, it may be
better to estimate the impedance and then invert the estimate.
A. Omitted-Phase Bias
We start by quantifying the bias that appears when fitting the
model (7) using the TLS. The magnitude difference |˜vh|−|˜vk|
is often correlated with the phase shift θhk, which means that
a bias may appears if it is incorporated as noise, as explained
in Section V-C. Using Lemma 1 with D= 1 and the model
(7a), we can express the resulting omitted-phase bias6with
E[ˆghk]−ghk=
bhk(var[|˜vh|−|˜vk|]−σv
hk)−1cov[|˜vh|−|˜vk|,|vk|θhk],
and similarly for ˆbhk.
In order to avoid the omitted-phase bias, the authors of
[16], [17] estimate both the phase θhkand the parameters ghk
andbhkiteratively in a joint problem. This means using the
estimates ˆghkandˆbhkto find the estimate ˆeθ
hkof|vk|θhk,
which can in be plugged in (7) to update ˆghkandˆbhk. Any
method to compute ˆeθ
hkwill aim at satisfying (7). Rearranging
the terms, vectorizing and plugging in the estimates, this
means
ˆeθ
hkˆbhk
ˆghk
=(|˜vh|−|˜vk|−δv
hk)ˆghk
−ˆbhk
−|˜ihk|cos(˜ϕhk)
sin(˜ϕhk)
+δℜ
hk
δℑ
hk
.
(10)
The estimate ˆeθ
hkcan then be used in (7) as
|˜ihk|cos(˜ϕhk)= [ghk, bhk][(|˜vh|−|˜vk|),−ˆeθ
hk]⊤+µhk,(11a)
|˜ihk|sin(˜ϕhk)=−[ghk, bhk][ˆeθ
hk,(|˜vh|−|˜vk|)]⊤+νhk,(11b)
While estimating θhkavoids the omitted-phase bias, it leads
to a real and imaginary simultaneity bias7, which is presented
in the next section.
6More commonly known as omitted-variable bias.
7The simultaneity bias problem is well known in statistics. It originates
from the lack of causality between variables that occur simultaneously [24],
i.e., variations in voltage and current flow.B. Real and Imaginary Simultaneity
A simultaneity bias appears when LHS variables in one
equation appear on the RHS of another equation, hence
creating correlation between the noise on the LHS and the
variables in the RHS. To show that this correlation exists, we
consider that the estimates are good, i.e., [ˆeθ
hk,ˆghk,ˆbhk]≈
[|vk|θhk, ghk, bhk]. Because [ˆghk,ˆbhk][ghk, bhk]†≈1by con-
struction, one obtains
cov
[δℜ
hk, δℑ
hk],ˆeθ
hk
≈cov
[δℜ
hk, δℑ
hk],ˆeθ
hk[ˆghk,ˆbhk]
[ghk, bhk]†.
The expression (10) shows that ˆeθ
hkis correlated to the noises
δℜ
hkandδℑ
hk. Hence,
cov
[δℜ
hk, δℑ
hk],ˆeθ
hk[ˆghk,ˆbhk]
=var
δℜ
hk
δℑ
hk
,
which means that
cov
[δℜ
hk, δℑ
hk],ˆeθ
hk
≈Σi
hk[ghk, bhk]†.
Hence, using Lemma 1 for (11) with D= 2 and the
datasets [|˜vh|−|˜vk|,−ˆeθ
hk],|˜ihk|cos(˜ϕhk)and[−ˆeθ
hk,−|˜vh|+
|˜vk|],|˜ihk|sin(˜ϕhk)yields the real and imaginary simultaneity
bias
E[ˆbhk,ˆghk]⊤−[bhk, ghk]⊤≈
− 
var|˜vh|−|˜vk|
−ˆeθ
hk
|{z}
from (11a)+var
ˆeθ
hk
|˜vh|−|˜vk|
|{z}
from (11b)−se
hk0
0se
hk!−1
Σi
hk[ghk, bhk]†,
where se
hk=var[ˆeθ
hk−|˜vk|θhk] +σv
hk.
The solution given in the literature [24] to the simultaneity
bias is to study the reduced regression model, i.e. plugging
one equation into the other, substituting the exact unknown
variable rather than its estimate. This has been done in [18],
where the authors reduce the equations to remove the unob-
served phase θhk. We proceed similarly here, i.e., reducing
|˜vk|θhkby plugging (7b) into (7a), which gives the reduced
regression model
|˜ihk|cos(˜ϕhk) =−ρhk|˜ihk|sin(˜ϕhk) (12)
+ghk(1+ρ2
hk)(|˜vh|−|˜vk| −δv
hk) +ρhkδℑ
hk+δℜ
hk.
This regression gives the estimates of ρhkandghk(1 +ρ2
hk). The
latter can then be divided by (1 + ˆρ2
hk)to obtain an estimate
ofghk. A similar process can be followed for bhkby plugging
(7a) into (7b).
C. Endogeneity of δℜ
hkandδℑ
hk
We investigate the bias of TLS estimates when using the
regression model (12). As explained in Section II-B, there is
a correlation between δℜ
hkandδℑ
hkwhen the power angle is
not zero. Hence, from Lemma 1, the estimate of ˆρhkhas the
following endogeneity bias
E[ˆρhk]−ρhk= [1,0]·
−
var
|˜ihk|sin(˜ϕhk)
|˜vh|−|˜vk|
−
σℑ
hk0
0σv
hk−1
cov[δℜ
hk, δℑ
hk]
0
,
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024when estimated from (12).
The removal of the endogeneity bias can be done by
dividing (12) by ghk(1+ρ2
hk)and putting |˜vh| − |˜vk|on the
LHS. Thus, the dependence of δℜ
hkandδℑ
hkdoes not cross
sides. Surprisingly, adjusting (12) in this way produces (4), an
impedance estimate, because
rhk=g−1
hk
(1+ρ2
hk)= 
ghk+b2
hkg−1
hk−1, (13a)
xhk=ρhkrhk=− 
bhk+g2
hkb−1
hk−1. (13b)
D. Impedance Inversion Bias
If the goal is to estimate the admittance values, rather than
the impedance values, the problem is still not fully solved as
one must invert (13) to obtain the estimates of ghkandbhk8.
This yields
ghk= 
rhk+x2
hkr−1
hk−1, (14a)
bhk=− 
xhk+r2
hkx−1
hk−1. (14b)
We can quantify the quality of the admittance estimate using
bounds on E[|ˆghk|]andE[|ˆbhk|], as the signs are known9. To
do so, we rewrite (14) as
|ghk|=rhk(x2
hk+r2
hk)−1+xhk·0,
|bhk|=rhk·0 +xhk(x2
hk+r2
hk)−1.
Plugging the functions f1(r, x) = (x2+r2)−1andf2(r, x) =
0, which are convex on the positive quadrant, into a sharp10
Jensen-like inequality [25, Theorem 2.1] gives the bounds11
E[|ˆghk|]≥E[ˆrhk]f1var[ˆrhk]
E[ˆrhk]+E[ˆrhk],cov[ˆxhk,ˆrhk]
E[ˆrhk]+E[ˆxhk]
,
E[|ˆbhk|]≥E[ˆxhk]f1cov[ˆxhk,ˆrhk]
E[ˆxhk]+E[ˆrhk],var[ˆxhk]
E[ˆxhk]+E[ˆxhk]
,
where the variance of the estimates var [ˆrhk,ˆxhk]is given by
(9). Using the definition of f1(r, x) = (r2+x2)−1and noting
thatE[ˆrhk] =rhkandE[ˆxhk] =xhk, one gets
E[|ˆghk|]≥r3
hk
(var[ˆrhk]+r2
hk)2+(cov[ˆxhk,ˆrhk]+rhkxhk)2,(15a)
E[|ˆbhk|]≥x3
hk
(var[ˆxhk]+x2
hk)2+(cov[ˆxhk,ˆrhk]+rhkxhk)2.(15b)
Because of the consistency of the TLS estimate,
var[ˆrhk,ˆxhk]→0asN→ ∞ . This means that ˆghk
andˆbhkcan be asymptotically unbiased because the RHS of
(15) tends to (14). However, with a finite number of samples,
var[ˆrhk,ˆxhk]can remain quite high, which may heavily bias
the admittance estimate.
8In Section V-B, inverting (1 + ˆρ2
hk)also leads to a bias because ρhkis
not known exactly.
9From the line model in Section II-A, rhkandxhkare positive. One can
enforce the signs of the conductance and susceptance by setting ˆghk= 0 if
the result was negative and ˆbhk= 0 if it was positive.
10the equality holds for at least one realization of ˆrhkandˆxhk
11Upper bounds were recently discovered for univariate functions [26],
however there are no upper bounds yet for bivariate problems such as (14)VI. N ETWORK IDENTIFICATION
Often, DSOs are interested in estimating the model for their
full network. Ideally, the model could be estimated from smart
meter injection measurements throughout the network. When
a grid is radial and the topology is known, the network esti-
mation problem for the full network can be decomposed into
individual line parameter estimation problems for each line
using Kirchoff’s Current Law. However, this is not possible for
mesh networks or radial networks with unknown topologies.
Thus, it is desirable to have a method for estimating the grid
parameters for a full network12from just smart meter voltage
and injection measurements.
Estimating a network from just smart meter voltage and
injection measurements is a much more challenging task than
estimating just a single line, however, and thus requires the
following additional approximation:
ih≈ |ih|e−jϕh: neglect current phase shifts .
Such approximations are quite accurate under Assumption
1, as shown in [18]. With the aforementioned approxima-
tions, the Kirchhoff law at node his given by |ih|e−jϕh=Pn
k=1yhk(|vh|(1−jθh)−|vk|(1−jθk)). In matrix form and
for all h∈ V, this gives
Iℜ= (G|V| −B(|V|Θ)), (16a)
Iℑ=−(B|V|+G(|V|Θ)), (16b)
where Iℜ= [|ih|cos(ϕh)]n
h=1,Iℜ= [|ih|sin(ϕh)]n
h=1,
|V|= [|vh|]n
h=1, and Θ = [|θh|]n
h=1. The parameter estimation
problem consists in finding G∈Rn×nandB∈Rn×n
from noisy measurements of the current magnitudes, voltage
magnitudes and power angles.
A. Reduced Regression Model
Similar to [28], we use pseudo-inverses to avoid the prob-
lems caused by the singularity of Yin the absence of shunt
elements. Recall that if Yis invertible, its pseudo-inverse is
equal to its inverse. We first note that BG†G=Bbecause
the matrices have the same null space13defined by the vector
of all ones and are both rank n−1. Hence, multiplying (16b)
byBG†on both sides, one can rewrite (16) as
B(|V|θ) = (G|V| −Iℜ),
B(|V|θ) =−(BG†B|V|+BG†Iℑ).
Combining the two equations yields the reduced model
(G+BG†B)|V|=Iℜ−BG†Iℑ. (17)
This model was first presented in [18], where the au-
thors regress |V|andIℑonto Iℜto obtain G= (G+
12The “full” network that is estimated consists of the Kron-reduced network
connecting just the nodes at which the injections are measured. Note,
the Kron-reduction is different than the statistical reductions that are used
elsewhere in this paper. The unmeasured injections are treated as noise [12],
[27].
13For this reason, the equality also holds for GB†B=Gand other
combinations of these matrices, as well as their sums and products.
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024BG†B)(GG†+ (BG†)2)†, and similarly for B. However, as
explained in Section V-C, the regression (17) suffers from a
correlation between IℜandIℑ, which makes the estimation
ofBG†very challenging.
B. Equivalent Impedance
In order to avoid the bias caused by the correlation between
IℜandIℑ, we define the matrix Osuch that Ohh=n−1
nand
Ohk=1
n. This matrix has the same null space as GandB
and has rank n−1. Moreover, the matrix (G+BG†B)also
has the same null space and rank, which means that O(G+
BG†B)†(G+BG†B) =O. Moreover, by construction O(G+
BG†B)†= (G+BG†B)†. We can therefore multiply both
sides of (17) by O(G+BG†B)†to obtain
O|V|= (G+BG†B)†Iℜ−(G+BG†B)†BG†Iℑ.
Finally, because (G+BG†B)†BG†= (B+GB†G)†, similar
to (4) and (13), one obtains the regression
O|V|=RIℜ+XIℑ, (18)
where
R= (G+BG†B)†,
X=−(B+GB†G)†,⇔G= (R+XR†X)†,
B=−(X+RX†R)†.(19)
Estimating RandXusing the TLS is consistent, unbiased and
efficient for the same reasons as in the single line problem.
Similar to Section V-D, the pseudo-inversion of the estimates
ofRandXlead to an asymptotic bias. It can also be bounded
using [25, Theorem 2.1]. The exact expressions are very long
and are outside of the scope of this paper. Nevertheless, we
show the accuracy of the estimates numerically in the next
section.
VII. U NBALANCED THREE -PHASES IDENTIFICATION
The parameter estimation of unbalanced three-phase net-
works can be done using the same methods as for the single-
phase ones by stacking the voltages and current matrices as
V|= [Vk]k=a,b,c∈R3nand similarly for Iℜ
|andIℑ
|. However,
this greatly reduces the SNR as the phases are often heavily
correlated with one another. In this case, the voltage difference
between the phases is too small to be detected. There are two
main ways to simplify the problem:
(i) Assume that all self-admittances are equal and that all
mutual admittances are equal.
(ii) Assume that all self-admittances are equal and that all
mutual admittances are zero.
The simplification (i) still tries to estimate the mutual
admittances and is adapted for heavily unbalanced loads. It
is equivalent to the assumption that the network infrastructure
is balanced, while the loads are not. This assumption is similar
to neglecting the negative and zero sequences and holds quite
well if all phases follow the same path, even if they are not
transposed [29]. The resulting regression can be written as
O|Vabc|=RLIℜ
abc+XLIℑ
abc+RM (20)
+ (Iℜ
cab+Iℜ
bca) +XM(Iℑ
cab+Iℑ
bca)where Vabc= [Va, Vb, Vc]∈Rn×3and similarly for Iℜ
abc,Iℜ
cab,
Iℜ
bca,Iℑ
abc,Iℑ
cab, and Iℑ
bca.
The simplification (ii) holds for balanced enough systems,
when the influence of mutual components cancels out. The
regression (18) can be used with Vabc,Iℜ
abc, and Iℑ
abcin place
ofV,Iℜ, and Iℑ, respectively. The number of parameters to
estimate is reduced, therefore increasing the data-efficiency.
However, it may not be applicable in networks with large
single-phase loads.
VIII. E XPERIMENTS
We validate our results on the 16kV distribution grid of
Walenstadt, Switzerland. Not all the nodes are observed/have
smart meter measurements. We first use the line from the
substation to Schlittriet to test the single-line identification
methods. We then experiment with network identification us-
ing the Br ¨usis-to-Freihof six-node sub-network. A groundtruth
model of the network is not available so we assess the accuracy
of the estimation methods using a combination of intuition,
cross-validation, and synthetic data, as explained below.
Schlittriet
Br¨usis
TscherlachSonnental
T¨obeliGenerator
FreihofSub-networkRest of the network
Fig. 1: Graph of the region of interest in the Walenstadt network.
The lines that will be identified are in blue. The unobserved nodes
are in red.
A. Single Line Estimation
1) Real-World Data Single Line Estimation: The line of
interest connecting ”Schlittriet” to the substation (see Fig.
1) has a resistance of approximately 0.1Ω.14Its reactance
is however unknown. We first use the raw data into all four
methods described in Section V to obtain the results in Fig. 2.
In the rest of the section, we use the sub-figure indices (a)-(d)
of Fig. 2 to denote the corresponding methods.
We assess the consistency of the estimates with R= 0.1Ω,
i.e., our only ground truth, by inverting the 7-days estimate
using (13). We observe that (a), (c), and (d) are consistent
with R= 0.1Ω, but (b) yields y= 0.003−0.46jS, which
corresponds to an incorrect R= 0.01Ω. Moreover, (b) and (c)
estimates a much larger X/R ratio than all three other methods.
Because the true conductance and susceptance of the line
is not known, we use cross validation in order to determine
the accuracy of the methods. We split the data into 6 days
for estimating the parameters, and 1 day to validate the line
flow power predictions that use the parameters. Table I shows
14The linear resistivity is 114mΩ/km and the line is 880m long. The
reactance is much harder to compute as it depends on the environment of
the line [30].
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 20247 3 2 1−10141016g [S]
7 3 2 17 3 2 17 3 2 1
7 3 2 1−10−4−101410
(a)b [S]
7 3 2 1
(b)7 3 2 1
(c)7 3 2 1
(d)
sample size [days]
Fig. 2: Estimates of the conductance and susceptance of a single line
using (a) the admittance regression (7), (b) the joint estimation using
(10), (c) the reduced model (12), (d) the impedance regression (4)
with real data. For each method, the points mark the estimates using
each data subset and the line their average. The true conductance b
and susceptance gof the line is not known, but R≈0.1Ω.
that (a) provides a good estimate for only P, (b) provides good
estimates for only Q, and (c) does not provide a good estimate.
Thus, only (d) could approximate both PandQcorrectly.
method P [kW] Q [kV A]
measured 107.49 5.19
(a) admittance (7) 138.69 13.34
(b) joint (10) 0.044 6.98
(c) reduced (12) 15.62 47.08
(d) impedance (4) 140.34 6.63
TABLE I: Measured and predicted average power transmission in
the estimated line for the last day of the data.
2) Synthetic Data Single Line Estimation: In order to un-
derstand better the very wide range of estimates, we generate
synthetic data by computing the voltages that would perfectly
match the measured power for all 7 days and y= 10−0.5j
S. We then add an increasing amount of Gaussian noise to
observe how the estimates behave and compute the expected
biases from Section V.
0.05 0.1 0.2 0.5 1 2 5051015g [S]
0.05 0.1 0.2 0.5 1 2 50.05 0.1 0.2 0.5 1 2 50.05 0.1 0.2 0.5 1 2 5
0.05 0.1 0.2 0.5 1 2 5−10−50510
(a)b [S]
0.05 0.1 0.2 0.5 1 2 5
(b)0.05 0.1 0.2 0.5 1 2 5
(c)0.05 0.1 0.2 0.5 1 2 5
(d)
noise std. [A], [°], [V]
Fig. 3: Estimates of the conductance and susceptance of a single line
using the four methods (a)-(d) with synthetic data. For each method,
the points mark the estimates affected by one of the 50 realizations
of the noise generated for each noise level. The line in color shows
their average and the black line shows the predicted bias. In case (d)
the black line is a lower bound on the bias.
Fig. 3 shows that all methods perform much better with
synthetic data. However, the gestimates in (b) and (c) get
smaller with more noise and the bestimate in (a) is too large by
a factor of 2. Both of these errors can also be observed in Fig.2. Moreover, the bestimate in (c) changes sign and becomes
larger. We also observe that the bias predictions become worse
with large amounts of noise, probably because Assumption 3
does not hold anymore. Moreover, the approximation of E[b]
for (b) given in Section V-B is not very close, and the lower
bound (15) for (d) is very loose in this particular case.
B. Network Estimation
1) Real-World Data Network Estimation: We use V , P and
Q measurements from the sub-network indicated in Fig. 1 in
order to estimate its admittance matrix. The singular values of
[V, Iℜ, Iℑ]reveal a SNR of approximately 1, which makes the
estimation challenging. In order to avoid numerical stability
issues15, we test the TLS-based methods with OLS as well.
The estimation with all 7 days of data yields the following
results for each method.
(a) from [15] diverges with both OLS and TLS, yielding a
quasi-infinite admittance estimate.
(b) from [16] converges to zero.
(c) from [18] diverges with the TLS but results in the matrix
shown in Fig. 4 (c).
(d) using (18) yields the matrix shown in Fig. 4 (d) with the
TLS and a similar one with the OLS.
Brüsis
Tscherlach
Sonnental
Töbeli
Töbeli Generator
FreihofBrüsis
Tscherlach
Sonnental
Töbeli
Töbeli Generator
Freihof
2500500075001000012500150001750020000
(c)
Brüsis
Tscherlach
Sonnental
Töbeli
Töbeli Generator
FreihofBrüsis
Tscherlach
Sonnental
Töbeli
Töbeli Generator
Freihof
1020304050607080 (d)
Fig. 4: Heatmaps of the magitudes of the admittance matrix estimates
given by the methods (c) and (d).
The resistance of the lines should be similar to the one in
Section VIII-A given their length and cross-section. We note
that only (d) is consistent with this observation. While the
topology is not recognizable from Fig. 4 (d), the estimate may
be useful for control and state estimation purposes. If it is not,
the the data must be improved by installing more accurate
smart meter sensors, PMUs, or lineflow measurements.
IX. C ONCLUSION
Estimating electrical grid parameters using unsychronized
measuring devices is challenging. This paper quantifies this
challenge by describing the non-zero expected admittance
estimation error for four admittance estimation methods in the
literature, as well as the variance of impedance estimation.
15In high SNR scenarios, the TLS may fail to estimate the EIV correctly
and remove parts of the signal instead. While the OLS is biased, it is more
robust than the TLS.
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024Impedance estimation can be conducted without bias using
TLS. The results in this paper warrant further impedance and
admittance estimation experiments with real smart meter data,
and experiments that combine smart meter data with data
from other types of sensors such as uPMUs and lineflow
measurements.
ACKNOWLEDGEMENT
We thank the Swiss National Science Foundation for sup-
porting this research under the NCCR Automation project
(grant number 51NF40 180545). We would also like to thank
Benjamin Sawicki and WEW (the DSO of Walenstadt) for
providing the data required by our experiments. Additionally,
we thank Lisa Laurent and Paul Den ´e for the eye-opening
results that they found during their Master projects.
REFERENCES
[1] “Quadrennial energy review report,” IEEE Power and Energy Society,
Tech. Rep., September 2015.
[2] “Developing innovative technologies to enhance reliability, ensure re-
silience, and increase flexibility,” US Department of Energy, Tech. Rep.,
March 2017.
[3] K. Morrissey, “Fundamental research challenges for distribution state
estimation to enable high-performing grids,” Smarter Grid Solutions,
Tech. Rep., May 2018.
[4] L. Schenato, G. Barchi, D. Macii, R. Arghandeh, K. Poolla, and
A. V on Meier, “Bayesian linear state estimation using smart meters and
pmus measurements in distribution grids,” in 2014 IEEE International
Conference on Smart Grid Communications (SmartGridComm) , 2014,
pp. 572–577.
[5] A. Iovine, T. Rigaut, G. Damm, E. De Santis, and M. D. Di Benedetto,
“Power management for a dc microgrid integrating renewables and
storages,” Control Engineering Practice , vol. 85, pp. 59–79, 2019.
[6] “Flexible export limits-final response and proposed actions-july 2023,”
Australian Energy Regulator, Tech. Rep., 2023.
[7] M. Z. Liu and L. N. Ochoa, “Project edge–knowledge sharing report:
Electrical model validation and operating envelope calculation,” Tech.
Rep., 2023.
[8] O. Ardakanian, V . W. S. Wong, R. Dobbe, S. H. Low, A. von Meier,
C. J. Tomlin, and Y . Yuan, “On identification of distribution grids,” IEEE
Transactions on Control of Network Systems , vol. 6, no. 3, pp. 950–960,
2019.
[9] E. Fabbiani, P. Nahata, G. D. Nicolao, and G. Ferrari-Trecate, “Iden-
tification of ac networks via online learning,” IEEE Transactions on
Control Systems Technology , 2021.
[10] R. Arghandeh, M. Gahr, A. von Meier, G. Cavraro, M. Ruh, and G. An-
dersson, “Topology detection in microgrids with micro-synchrophasors,”
in2015 IEEE Power & Energy Society General Meeting . IEEE, 2015,
pp. 1–5.
[11] A. Wehenkel, A. Mukhopadhyay, J.-Y . Le Boudec, and M. Paolone,
“Parameter estimation of three-phase untransposed short transmission
lines from synchrophasor measurements,” IEEE Transactions on Instru-
mentation and Measurement , vol. 69, no. 9, pp. 6143–6154, 2020.
[12] K. Moffat, M. Bariya, and A. V on Meier, “Unsupervised impedance
and topology estimation of distribution networks—limitations and tools,”
IEEE Transactions on Smart Grid , vol. 11, no. 1, pp. 846–856, 2020.
[13] K. Weranga, S. Kumarawadu, and D. Chandima, Smart metering design
and applications . Springer, 2014.
[14] S. Vitiello, N. Andreadou, M. Ardelean, and G. Fulli, “Smart metering
roll-out in europe: Where do we stand? cost benefit analyses in the clean
energy package and research trends in the green deal,” Energies , vol. 15,
no. 7, p. 2340, 2022.
[15] L. Laurent, J.-S. Brouillon, and G. Ferrari-Trecate, “Maximum likeli-
hood estimation of distribution grid topology and parameters from smart
meter data,” in 2023 IEEE PES Grid Edge Technologies Conference &
Exposition (Grid Edge) . IEEE, 2023, pp. 1–5.[16] J. Zhang, Y . Wang, Y . Weng, and N. Zhang, “Topology identification and
line parameter estimation for non-pmu distribution network: A numerical
method,” IEEE Transactions on Smart Grid , vol. 11, no. 5, pp. 4440–
4453, 2020.
[17] V . L. Srinivas and J. Wu, “Topology and parameter identification of
distribution network using smart meter and µpmu measurements,” IEEE
Transactions on Instrumentation and Measurement , vol. 71, pp. 1–14,
2022.
[18] J. Zhang, P. Wang, and N. Zhang, “Distribution network admittance
matrix estimation with linear regression,” IEEE Transactions on Power
Systems , vol. 36, no. 5, pp. 4896–4899, 2021.
[19] M. Vanin, F. Geth, R. D’hulst, and D. Van Hertem, “Combined unbal-
anced distribution system state and line impedance matrix estimation,”
International Journal of Electrical Power & Energy Systems , vol. 151,
p. 109155, 2023.
[20] P. Kundur, Power System Stability and Control . CRC Press New York,
NY , USA, 2007.
[21] Q. Cetina, R. A. J. Roscoe, and P. S. Wright, “Challenges for smart
electricity meters due to dynamic power quality conditions of the grid: A
review,” in 2017 IEEE International Workshop on Applied Measurements
for Power Systems (AMPS) . IEEE, 2017, pp. 1–6.
[22] J. Crassidis and Y . Cheng, “Error-covariance analysis of the total least
squares problem,” Journal of Guidance, Control, and Dynamics , vol. 37,
07 2014.
[23] G. Casella and R. Berger, Statistical Inference . Duxbury Press, 01
2002.
[24] J. M. Wooldridge, Introductory econometrics: A modern approach .
Cengage learning, 2015.
[25] R. A. Agnew and J. E. Pecaric, “Generalized multivariate jensen-
type inequality.” JIPAM. Journal of Inequalities in Pure & Applied
Mathematics [electronic only] , vol. 7, no. 4, pp. Paper–No, 2006.
[26] J. Liao and A. Berg, “Sharpening jensen’s inequality,” The American
Statistician , 2018.
[27] F. D ¨orfler, J. W. Simpson-Porco, and F. Bullo, “Electrical networks and
algebraic graph theory: Models, properties, and applications,” Proceed-
ings of the IEEE , vol. 106, no. 5, pp. 977–1005, 2018.
[28] O. Stanojev, L. Werner, S. Low, and G. Hug, “Tractable identification of
electric distribution networks,” arXiv preprint arXiv:2304.01615 , 2023.
[29] J.-S. Brouillon, E. Fabbiani, P. Nahata, K. Moffat, F. D ¨orfler, and
G. Ferrari-Trecate, “Bayesian error-in-variables models for the identifi-
cation of distribution grids,” IEEE Transactions on Smart Grid , vol. 14,
no. 2, pp. 1289–1299, 2022.
[30] J. R. Carson, “Electromagnetic theory and the foundations of electric
circuit theory 1,” Bell System Technical Journal , vol. 6, no. 1, pp. 1–17,
1927.
[31] I. Markovsky and S. Van Huffel, “Overview of total least-squares
methods,” Signal processing , vol. 87, no. 10, pp. 2283–2302, 2007.
[32] S. Rhode, F. Bleimund, and F. Gauterin, “Recursive generalized total
least squares with noise covariance estimation,” IFAC proceedings
volumes , vol. 47, no. 3, pp. 4637–4643, 2014.
APPENDIX A
DILUTION BIAS AND TOTAL LEAST SQUARES
We explore different methods to fit regression models such
as (4) or (7a). In order to present the theory in various cases,
we consider a general regression model ˜z=Ax+ϵ. For
example, in (4) zrepresents the voltage drop and xrepresents
the current. The matrix Acontains the parameters and the
noise term ϵis such that E[ϵ] = 0 .
A. Dilution Bias
The OLS are a very common method for parameter estima-
tion, which estimates Aas
ˆA=var[x]−1cov[x,˜z]. (21)
This estimate is exact if (i) the variance and covariance
estimates are exact and (ii) cov [x, ϵ] = 0 , which means
cov[x,˜z] = Avar[x]. The condition (i) is usually almost
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024satisfied with very large amounts of data, as the uncertainty
on variance scales with the inverse of the number of samples.
The condition (ii) is not satisfied in (4) and (7a), as
the noises on |˜vh| − |˜vk|,|˜ihk|cos(˜ϕhk), and|˜ihk|sin(˜ϕhk)
are collected in ϵhk, thus creating correlations. Independent
uncertainty in the measurement ˜xofx, then var [˜x] =var[x]+
var[˜x−x], so var [˜x]−1≺var[x]−1, which leads to a dilution
bias in the OLS [31].
B. Total Least Squares
The TLS estimate the parameters Aand the exact variance
var[x]simultaneously, assuming that ϵ=ϵz+ϵx∼ N(0,Σz)+
N(0, AΣzA⊤), i.e., that the right and left hand side variables
are i.i.d., Gaussian and centered on zero. The variance var [x]is
computed as var [˜x]−var[ϵx], where var [ϵx]is obtained using
a low-rank approximation of [x+ϵx, z+ϵz][31]16. In this
case, (21) becomes
ˆA= (var[˜x]−var[ϵx])−1cov[˜x,˜z]. (22)
This estimate is unbiased if and only if cov [˜x,˜z] =cov[x, z]+
cov[ϵx,˜z] +cov[˜x, ϵz]−cov[ϵx, ϵz] =cov[x, z]. Otherwise the
bias is given by (var[˜x]−var[ϵx])−1(cov[˜x,˜z]−cov[x, z]),
which is equal to (8) when D= 1.
C. Multiple Datasets
IfDdatasets ˜xd,˜zdof equal size such that zd=
Axdford= 1 , . . . , D are combined, (21) becomes
ˆA= PD
d=1var[xd]−1PD
d=1cov[xd,˜zd]. Moreover, sim-
ilar to (22), the TLS estimate uses var [xd] = var[˜xd]−
var[˜xd−xd]when the noise is independent. Hence the
bias is PD
d=1var[xd]−var[˜xd−xd]−1PD
d=1(cov[˜xd,˜zd]−
cov[xd, zd]), which is equal to (8).
16The TLS can also be computed online using its recursive formulation
[32]
23rd Power Systems Computation Conference
PSCC 2024Paris, France — June 4 – 7, 2024