arXiv:2304.03774v3  [cond-mat.str-el]  3 Aug 2023Spectral representation of Matsubara n-point functions:
Exact kernel functions and applications
Johannes Halbinger, Benedikt Schneider and Björn Sbierski
Department of Physics and Arnold Sommerfeld Center for Theo retical Physics (ASC),
Ludwig-Maximilians-Universität München, Theresienstr. 37, München D-80333, Germany
Munich Center for Quantum Science and Technology (MCQST), S chellingstr. 4, D-80799 München, Germany
(Dated: August 4, 2023)
In the ﬁeld of quantum many-body physics, the spectral (or Le hmann) representation simpliﬁes
the calculation of Matsubara n-point correlation functions if the eigensystem of a Hamilt onian is
known. It is expressed via a universal kernel function and a s ystem- and correlator-speciﬁc product
of matrix elements. Here we provide the kernel functions in f ull generality, for arbitrary n, arbitrary
combinations of bosonic or fermionic operators and an arbit rary number of anomalous terms. As
an application, we consider bosonic 3- and 4-point correlat ion functions for the fermionic Hubbard
atom and a free spin of length S, respectively.
I. INTRODUCTION AND DEFINITIONS
Multi-point correlation functions of nquantum mechanical operators, also known as n-point functions, are a central
concept in the study of quantum many-body systems and ﬁeld th eory [ 1]. They generalize the well-known 2-point
functions, which, for the example of electrons in the solid s tate, are routinely measured by scanning tunneling spec-
troscopy or angle-resolved photon emission spectroscopy [ 2]. For magnetic systems, the 2-point spin correlators can
be probed in a neutron scattering experiment. Higher order c orrelation functions with n= 3,4,5...can for example
be measured in non-linear response settings [ 3]. In the emerging ﬁeld of cold atomic quantum simulation, (e qual-time)
n-point functions are even directly accessible [ 4].
On the theoretical side the study of higher order correlatio n functions gains traction as well. One motivation is
the existence of exact relations between correlation funct ions of diﬀerent order n[5,6]. Although these relations can
usually not be solved exactly, they form a valuable starting point for further methodological developments like the
parquet approximation [ 7]. Thus even if the 4-point correlator (or, in that context, i ts essential part, the one-line
irreducible vertex [ 1]) might not be the primary quantity of interest in a calculat ion, it appears as a building block of
the method. Another example is the functional renormalizat ion group method (fRG) in a vertex expansion [ 8,9]. It
expresses the many body problem as a hierarchy of diﬀerentia l equations for the vertices that interpolate between a
simple solvable starting point and the full physical theory [10]. Whereas experiments measure correlation functions in
real time (or frequency), in theory one often is concerned wi th the related but conceptually simpler versions depending
on imaginary time [ 1]. In the following, we will focus on these Matsubara correla tion functions, which, nevertheless
feature an intricate frequency dependence.
Whereas the above theoretical methods usually provide only an approximation for the n-point functions, an im-
portant task is to calculate these objects exactly. This sho uld be possible for simple quantum many body systems.
We consider systems simple if they are amenable to exact diag onalization (ED), i.e. feature a small enough Hilbert
space, like few-site clusters of interacting quantum spins or fermions. Also impurity systems, where interactions onl y
act locally, can be approximately diagonalized using the nu merical renormalization group [ 11].
Knowing the exact n-point functions for simple systems is important for benchm ark testing newly developed methods
before deploying them to harder problems. Moreover, n-point functions for simple systems often serve as the start ing
point of further approximations like in the spin-fRG [ 12–14], or appear intrinsically in a method like in diagrammatic
extensions of dynamical mean ﬁeld theory [ 15] with its auxiliary impurity problems. Another pursuit ena bled by the
availability of exact n-point functions is to interpret the wealth of information e ncoded in these objects, in particular
in their rich frequency structure. For example, Ref. [ 16] studied the ﬁngerprints of local moment formation and Kond o
screening in quantum impurity models.
In this work we complete the task to calculate exact n-point functions by generalizing the spectral (or Lehmann)
representation [ 1,17] for Matsubara n-point correlation functions to arbitrary n. We assume that a set of eigenstates
and -energies is given. Following pioneering work of Refs. [ 18–20] and in particular the recent approach by Kugler
et al. [21], we split the problem of calculating imaginary frequency c orrelators into the computation of a universal
kernel function and a system- and correlator-speciﬁc part ( called partial spectral function in Ref. [ 21]). We provide
the kernel functions in full generality for an arbitrary num bernof bosonic or fermionic frequencies. Previously, these
kernel functions were known exactly only up to the 3-point ca se [18], for the fermionic 4-point case [ 19–21] or for
the general n-point case [ 21] but disregarding anomalous contributions to the sum that t he kernel function consists
of. These anomalous contributions are at the heart of the com plexity of Matsubara n-point functions. They occur2
when certain combinations of eigenenergies and external fr equencies vanish individually, see the anti-diagonal rays
in Fig. 1(c). Physically, they correspond to long-term memory eﬀect s, are related to non-ergodicity and, in the case
of bosonic two-point functions reﬂect the diﬀerence betwee n static isothermal susceptibilities and the zero-frequen cy
limit of the dynamical Kubo response function [ 22,23].
The structure of the paper is as follows: In Sec. IIwe deﬁne the Matsubara n-point function GA1...A n/parenleftbig
ω1, ..., ω n−1/parenrightbig
and review some of its properties. The spectral representat ion is derived in Sec. IIIwith Eq. ( 15) being the central
equation written in terms of the kernel function Kn(Ω1, ...,Ωn−1). Our main result is an exact closed-form expression
of this most general kernel function which is given in Sec. IV. Examples for n= 2,3,4,5 are given in Sec. Vwhere
we also discuss simpliﬁcations for the purely fermionic cas e. We continue with applications to two particular systems
relevant in the ﬁeld of condensed matter theory: In Sec. VI, we consider the Hubbard atom and the free spin of length
S, for which we compute n-point functions not previously available in the literatur e. We conclude in Sec. VII.
II. DEFINITION OF MATSUBARA n-POINT FUNCTION GA1...A n/parenleftbig
ω1, ..., ω n/parenrightbig
We consider a set of n= 2,3,4, ...operators{A1, A2, ..., A n}deﬁned on the Hilbert space of a quantum many-body
Hamiltonian H. The operators can be fermionic, bosonic or a combination of both types, with the restriction that
there is an even number of fermionic operators. As an example ,A1=d†d≡n,A2=d,A3=d†where d†anddare
canonical fermionic creation and annihilation operators. A subset of operators is called bosonic if they create a close d
algebra under the commutation operation. They are called fe rmionic if the algebra is closed under anti-commutation,
see Sec. 1 of Ref. [ 24]. Spin operators are thus bosonic.
We deﬁne the imaginary time-ordered n-point correlation functions for τk∈[0, β] [25,26],
GA1A2...A n(τ1, τ2, ..., τ n)≡∝an}bracketle{tT A1(τ1)A2(τ2)...A n(τn)∝an}bracketri}ht, (1)
where Ak(τk) =eτkHAke−τkHdenotes Heisenberg time evolution. Here and in the followin g,k= 1,2, ..., n . The
expectation value is calculated as/angbracketleftbig
.../angbracketrightbig
= tr[ ρ...] where ρ= exp(−βH)/Zis the thermal density operator at temperature
β= 1/TandZ= tr exp(−βH) denotes the partition function. Note that other conventio ns for the n-point function
diﬀering by a prefactor are also used in the literature, e.g. Ref. [ 21] multiplies with ( −1)n−1. In Eq. ( 1), the imaginary
time-ordering operator Torders the string of Heisenberg operators,
TA1(τ1)A2(τ2)...A n(τn)≡ζ(p)Ap(1)(τp(1))Ap(2)(τp(2))...A p(n)(τp(n)), (2)
where pis the permutation p∈Snsuch that τp(1)> τ p(2)> ... > τ p(n)[see Fig. 1(a)] and the sign ζ(p) is−1 if the
operator string Ap(1)Ap(2)...A p(n)diﬀers from A1A2...A nby an odd number of transpositions of fermionic operators,
otherwise it is +1. The special case n= 2, with ζ(12) = 1 and ζ(21) = ζ(ζ= 1 for A1,2bosonic, ζ=−1 for A1,2
fermionic), simpliﬁes to
TA1(τ1)A2(τ2) =/braceleftBigg
A1(τ1)A2(τ2) : τ1> τ 2,
ζA2(τ2)A1(τ1) :τ2> τ 1.(3)
(a)
(b)(c)
. . .
. . .
-6-4-202466
4
2
0
-2
-4
-6
m1m2
-2.3-1.6-0.800.81.62.3
Figure 1. (a) Ordering convention for imaginary times in Eq. (9). (b) Eigenstates and energies of the Hubbard atom. (c)
Matsubara correlation function GSxSySz(ω1, ω2) with ωj= 2πm j/β(mj∈Z,j= 1,2) for the Hubbard atom ( 35) atβ= 10,
h= 0.1,ǫ=−2,U= 2, see Eq. ( 45). The sharp anti-diagonal ray ∝δω1+ω2,0represents an anomalous term of order a= 1.
The other broadened rays become sharp and anomalous for h→0, see Eq. ( 49).3
Imaginary time-ordered correlation functions ( 1) fulﬁll certain properties which we review in the following , see
e.g. [ 26] for a more extensive discussion. First, they are invariant under translation of all time arguments,
GA1A2...A n(τ1, τ2, ..., τ n) =GA1A2...A n(τ1+τ, τ2+τ, ..., τ n+τ), (4)
with τ∈Rsuch that τk+τ∈[0, β]. They also fulﬁll periodic or anti-periodic boundary cond itions for the individual
arguments τk,
GA1...A n(τ1, ..., τ k= 0, ..., τ n) =ζkGA1...A n(τ1, ..., τ k=β, ..., τ n) (5)
where ζk= +1 or−1 ifAkis from the bosonic or fermionic subset of operators, respec tively. This motivates the use
of a Fourier transformation,
GA1...A n(τ1, ..., τ n)≡β−n/summationdisplay
ω1,...,ω ne−i(ω1τ1+...+ωnτn)GA1...A n(ω1, ..., ω n), (6)
GA1...A n(ω1, ..., ω n) =/integraldisplayβ
0dτ1···/integraldisplayβ
0dτne+i(ω1τ1+...+ωnτn)GA1...A n(τ1, ..., τ n), (7)
where ωk= 2πm k/βorωk= 2π(mk+ 1/2)/βwith mk∈Zbosonic or fermionic Matsubara frequencies, respectively ,
and/summationtext
ωkis shorthand for/summationtext
mk∈Z. Note that fermionic Matsubara frequencies are necessaril y nonzero, a property that
will become important later. As we will not discuss the real- frequency formalisms, we will not write the imaginary unit
in front of Matsubara frequencies in the arguments of GA1...A n(ω1, ..., ω n). Again, note that in the literature, diﬀerent
conventions for the Fourier transformation of n-point functions are in use. In particular some authors pick diﬀerent
signs in the exponent of Eq. ( 7) for fermionic creation and annihilation operators, or cho se these signs depending on
operator positions.
Time translational invariance ( 4) implies frequency conservation at the left hand side of Eq. (7),
GA1...A n/parenleftbig
ω1, ..., ω n−1, ωn/parenrightbig
≡βδ0,ω1+...+ωnGA1...A n/parenleftbig
ω1, ..., ω n−1/parenrightbig
, (8)
where on the right hand side we skipped the n-th frequency entry in the argument list of G. Note that we do not use
a new symbol for the correlation function when we pull out the factor βand the Kronecker delta function.
III. SPECTRAL REPRESENTATION OF GA1...A n/parenleftbig
ω1, ..., ω n−1/parenrightbig
The integrals involved in the Fourier transformation ( 7) generate all n! diﬀerent orderings of the time arguments
τk. As in Ref. [ 21] it is thus convenient to use a sum over all n! permutations p∈Snand employ a product
ofn−1 step-functions θ, with θ(x) = 1 for x > 0 and 0 otherwise, to ﬁlter out the unique ordering for which
β > τ p(1)> τ p(2)> ... > τ p(n−1)> τ p(n)>0, see Fig. 1(a),
GA1...A n(τ1, ..., τ n) =/summationdisplay
p∈Snζ(p)/bracketleftBiggn−1/productdisplay
i=1θ(τp(i)−τp(i+1))/bracketrightBigg
/angbracketleftbig
Ap(1)(τp(1))Ap(2)(τp(2))...A p(n)(τp(n))/angbracketrightbig
. (9)
To expose explicitly the time dependence of the Heisenberg o perators, we insert ntimes the basis of eigenstates and
-energies of the many-body Hamiltonian H. Instead of the familiar notation/vextendsingle/vextendsinglej1/angbracketrightbig
,/vextendsingle/vextendsinglej2/angbracketrightbig
, ...andEj1, Ej2, ...we employ/vextendsingle/vextendsingle1/angbracketrightbig
,/vextendsingle/vextendsingle2/angbracketrightbig
, ...andE1, E2,.... for compressed notation and denote operator matrix el ements as A12=∝an}bracketle{t1|A|2∝an}bracketri}ht. We obtain
GA1...A n(τ1, ..., τ n) =/summationdisplay
p∈Snζ(p)/bracketleftBiggn−1/productdisplay
i=1θ(τp(i)−τp(i+1))/bracketrightBigg
(10)
×1
Z/summationdisplay
1...ne−βE 1eτp(1)E1A12
p(1)e(−τp(1)+τp(2))E2A23
p(2)e(−τp(2)+τp(3))E3...e(−τp(n−1)+τp(n))EnAn1
p(n)e−τp(n)E1,
and apply the Fourier transform according to the deﬁnition ( 7),
GA1...A n/parenleftbig
ω1, ..., ω n/parenrightbig
=1
Z/summationdisplay
p∈Snζ(p)/summationdisplay
1...ne−βE 1A12
p(1)A23
p(2)...An1
p(n)(11)
×/bracketleftBigg/integraldisplayβ
0dτp(1)eΩ12
p(1)τp(1)/bracketrightBigg/bracketleftbigg/integraldisplayτp(1)
0dτp(2)eΩ23
p(2)τp(2)/bracketrightbigg
.../bracketleftbigg/integraldisplayτp(n−2)
0dτp(n−1)eΩn−1n
p(n−1)τp(n−1)/bracketrightbigg/bracketleftbigg/integraldisplayτp(n−1)
0dτp(n)eΩn1
p(n)τp(n)/bracketrightbigg
,4
where we deﬁned
Ωab
k≡iωk+Ea−Eb∈C. (12)
In Eq. ( 11), the ﬁrst line carries all the information of the system and the set of operators {A1, A2, ..., A n}. The
second line can be regarded as a universal kernel function de ﬁned for general{Ω1,Ω2, ...,Ωn}probed at Ω k∈Cwhich
depends on the system and correlators via ( 12). Upon renaming the τ-integration variables τp(k)→τk, this kernel
function is written as follows:
Kn(Ω1, ...,Ωn)≡/bracketleftBigg/integraldisplayβ
0dτ1eΩ1τ1/bracketrightBigg/bracketleftbigg/integraldisplayτ1
0dτ2eΩ2τ2/bracketrightbigg
.../bracketleftbigg/integraldisplayτn−2
0dτn−1eΩn−1τn−1/bracketrightbigg/bracketleftbigg/integraldisplayτn−1
0dτneΩnτn/bracketrightbigg
(13)
≡βδ0,Ω1+Ω 2+...+Ω nKn(Ω1, ...,Ωn−1) +Rn(Ω1, ...,Ωn). (14)
In the second line we split Kninto a part Knproportional to βδ0,Ω1+Ω 2+...+Ω nand the rest Rn. We dropped Ω nfrom
the argument list of Knwhich can be reconstructed from {Ω1, ...,Ωn−1}.
Finally, we express GA1...A n/parenleftbig
ω1, ..., ω n/parenrightbig
of Eq. ( 11) using the kernel Knso that the general Ω k∈Cget replaced
by Ωab
kof Eq. ( 12). For these, Ω12
p(1)+ Ω23
p(2)+...+ Ωn1
p(n)=i(ω1+ω2+...+ωn), since the Ekcancel pairwise. The
structure of Eq. ( 8) (which followed from time translational invariance) impl ies that the terms proportional to Rnare
guaranteed to cancel when summed over permutations p∈Sn, so that only the terms proportional to Knremain. We
drop the βδ0,ω1+ω2+...+ωnfrom both sides [c.f. Eq. ( 8)] and ﬁnd the spectral representation of the n-point correlation
function in the Matsubara formalism,
GA1...A n/parenleftbig
ω1, ..., ω n−1/parenrightbig
=1
Z/summationdisplay
p∈Snζ(p)/summationdisplay
1...ne−βE 1A12
p(1)A23
p(2)...An1
p(n)×Kn/parenleftBig
Ω12
p(1),Ω23
p(2), ...,Ωn−1n
p(n−1)/parenrightBig
. (15)
An equivalent expression was derived in the literature befo re [21], see also Refs. [ 18–20] for the cases of certain small
n. However, the kernel functions Knwhere previously only known approximately, for situations involving only a low
order of anomalous terms, see the discussion in Sec. V. We deﬁne an anomalous term of order a= 1,2, ...n−1 as a
summand contributing to Kn(Ω1, ...,Ωn−1) that contains a product of aKronecker delta functions δ0,x, where xis a
sum of a subset of {Ω1, ...,Ωn−1}. As can be seen in Fig. 1(c), these anomalous contributions to GA1...A n/parenleftbig
ω1, ..., ω n/parenrightbig
correspond to qualitatively important sharp features.
In the next section, we present a simple, exact expression fo r general Kn(Ω1, ...,Ωn−1). Readers not interested in
the derivation can directly skip to the result in Eq. ( 26) or its explicit form for n= 2,3,4,5 in Sec. ( V).
IV. GENERAL KERNEL FUNCTION Kn/parenleftbig
Ω1, ...,Ωn−1/parenrightbig
Assuming the spectrum and matrix elements entering Eq. ( 15) are known, the remaining task is to ﬁnd expressions
for the kernel function Kn(Ω1, ...,Ωn−1) deﬁned via Eqns. ( 13) and ( 14) as the part ofKn(Ω1,Ω2, ...,Ωn) multiplying
βδ0,Ω1+Ω 2+...+Ω n. To facilitate the presentation in this section, in Eq. ( 13) we rename the integration variables
τk→τn−k+1and deﬁne new arguments zn−j+1= Ω jforj= 1,2, ..., n−1,
Kn(Ω1=zn,Ω2=zn−1, ...,Ωn=z1) =/bracketleftBig/integraldisplayβ
0dτneznτn/bracketrightBig/bracketleftBig/integraldisplayτn
0dτn−1ezn−1τn−1/bracketrightBig
.../bracketleftBig/integraldisplayτ3
0dτ2ez2τ2/bracketrightBig/bracketleftBig/integraldisplayτ2
0dτ1ez1τ1/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
≡h1(τ1)/bracketrightBig
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
≡h2(τ2)(16)
=βδ0,z1+z2+...+znKn(zn, zn−1, ..., z 2) +R(zn, zn−1, ..., z 1). (17)
As indicated in Eq. ( 16), we call hk(τk) the integrand of the/integraltextτk+1
0dτkintegral for k= 1,2, ..., n . At k= 1 this
integrand is given by h1(τ1) =ez1τ1and we will ﬁnd hkfork= 2,3, ..., n iteratively. For z∈C, we deﬁne the
abbreviations δz≡δ0,zand
∆z≡/braceleftBigg
0 if z= 0
1
zifz∝ne}ationslash= 0(18)5
and consider the integral (for p= 0,1,2, ...and ˜τ≥0, proof by partial integration and induction)
/integraldisplay˜τ
0dτ τpezτ=/bracketleftBigg
˜τp+1
p+ 1δz+p! (−1)p∆1+p
zp/summationdisplay
l=0(−1)l
l!∆−l
z˜τl/bracketrightBigg
ez˜τ−p! (−1)p∆p+1
z. (19)
Recall that we are only interested in the contribution Kn(zn, zn−1, ..., z 2) that fulﬁlls frequency conservation, see
Eq. ( 17). The δz1+z2+...+znin front of this term arises from the ﬁnal τnintegration of hn(τn)∝e(z1+z2+...+zn)τnvia
the ﬁrst term in Eq. ( 19). This however requires that all zk(except the vanishing ones, of course) remain in the
exponent during the iterative integrations. This requirem ent is violated by the last term in the general integral ( 19)
(which comes from the lower boundary of the integral). All te rms inKnthat stem from this last term in Eq. ( 19)
thus contribute to Rnand can be dropped in the following [ 21]. Note however, that it is straightforward to generalize
our approach and keep these terms if the full Knis required.
To deﬁne the iterative procedure to solve the n-fold integral in Eq. ( 16), we make the ansatz
hk(τk) =k−1/summationdisplay
l=0fk(l)τl
ke(zk+zk−1+...+z1)τk, (20)
which follows from the form of the integral ( 19) and our decision to disregard the terms contributing to Rn. The
ansatz ( 20) is parameterized by the numbers fk(l) with l= 0,1, ..., k−1. These numbers have to be determined
iteratively, starting from fk=1(l= 0) = 1, read oﬀ from h1(τ1) =ez1τ1, c.f. Eq. ( 16). Iteration rules to obtain the
fk(l) from fk−1(l) are easily derived from Eqns. ( 16), (19) and ( 20). We obtain the recursion relation
fk(l) =k−1/summationdisplay
p=0˜Mk−1(l, p)fk−1(p) (21)
written as a matrix-vector product of fk−1= (fk−1(0), fk−1(1), ..., f k−1(k−2))Twith the k×(k−1)-matrix
˜Mk−1(l, p) =p!
l!/bracketleftBig
δl,p+1˜δk−1+θ(p−l+ 1/2) (−1)l+p˜∆1+p−l
k−1/bracketrightBig
, (22)
where ˜∆k≡∆zk+...+z2+z1,˜δk≡δzk+...+z2+z1. The tilde on top of the ˜δkand˜∆ksignals the presence of a sum of zjin
the arguments (below we will deﬁne related quantities witho ut tilde for the sum of Ω j). Note that the ﬁrst (second)
term in brackets of Eq. ( 22) comes from the ﬁrst (second) term in square brackets of Eq. ( 19).
The next step is to ﬁnd Kn(zn, zn−1, ..., z 2). This requires to do the integral/integraltextβ
0dτnhn(τn) which can be again
expressed via Eq. ( 19) but with the replacement ˜ τ→β. Only the ﬁrst term provides a βδz1+z2+...+znand is thus
identiﬁed with Kn. We ﬁnd:
Kn(zn, zn−1, ..., z 2) =n−1/summationdisplay
l=0βlfn(l)
l+ 1. (23)
The argument z1that the right hand side of Eq. ( 23) depends on is to be replaced by z1=−z2−z3−...−zn,
in line with the arguments in Kn(zn, zn−1, ..., z 2). Then, to conform with Eq. ( 15), we reinstate Ω j=zn−j+1for
j= 1,2, ..., n−1. This amounts to replacing the terms ˜δjand ˜∆jthat appear in fn(l) as follows,
˜δj=δzj+...+z2+z1=δΩ1+Ω 2+...+Ω n−j≡δn−j, (24)
−˜∆j=−∆zj+...+z2+z1= ∆ Ω1+Ω 2+...+Ω n−j≡∆n−j, (25)
where we used Ω 1+ Ω 2+...+ Ω n= 0 = zn+...+z2+z1. Finally, we can express Eq. ( 23) using a product of n−1
matrices ˜Mmultiplying the initial length-1 vector with entry f1(0) = 1. Transferring to the Ω-notation by using
Eqns. ( 24) and ( 25), we obtain
Kn(Ω1, ...,Ωn−1) =n−1/summationdisplay
in−1=0n−2/summationdisplay
in−2=0···2/summationdisplay
i2=01/summationdisplay
i1=0βin−1
in−1+ 1M1(in−1, in−2)M2(in−2, in−3)···Mn−2(i2, i1)Mn−1(i1,0)(26)
with
Mj(l, p)≡p!
l!/bracketleftBig
δl,p+1δj−θ(p−l+ 1/2) ∆1+p−l
j/bracketrightBig
. (27)
The closed form expression ( 26) of the universal kernel, to be used in the spectral represen tation ( 15), is our main
result. By deﬁnition it is free of any singularities as the ca se of vanishing denominators is explicitly excluded in
Eq. ( 18).6
#anom. K2(Ω1)K3(Ω1,Ω2)K4(Ω1,Ω2,Ω3)K5(Ω1,Ω2,Ω3,Ω4)factor for entire row
a= 0 −∆1 +∆ 1∆2 −∆1∆2∆3 +∆ 1∆2∆3∆4 1
a= 1+δ1 −δ1∆2 +δ1∆2∆3 −δ1∆2∆3∆4β
2
−∆1δ2 +∆ 1δ2∆3 −∆1δ2∆3∆4β
2+ ∆ 1
+∆ 1∆2δ3 −∆1∆2δ3∆4β
2+ ∆ 1+ ∆ 2
−∆1∆2∆3δ4β
2+ ∆ 1+ ∆ 2+ ∆ 3
a= 2+δ1δ2 −δ1δ2∆3 +δ1δ2∆3∆4β
2β
3
−δ1∆2δ3 +δ1∆2δ3∆4β
2/parenleftbigβ
3+ ∆ 2/parenrightbig
−∆1δ2δ3 +∆ 1δ2δ3∆4β
2β
3+ ∆ 1/parenleftbigβ
2+ ∆ 1/parenrightbig
+δ1∆2∆3δ4β
2/parenleftbigβ
3+ ∆ 2+ ∆ 3/parenrightbig
+∆ 1δ2∆3δ4β
2β
3+ (∆ 1+ ∆ 3)/parenleftbigβ
2+ ∆ 1/parenrightbig
+∆ 1∆2δ3δ4β
2β
3+ (∆ 1+ ∆ 2)/parenleftbigβ
2+ ∆ 2/parenrightbig
+ ∆2
1
a= 3+δ1δ2δ3 −δ1δ2δ3∆4β
2β
3β
4
−δ1δ2∆3δ4β
2β
3/parenleftbigβ
4+ ∆ 3/parenrightbig
−δ1∆2δ3δ4β
2/parenleftbigβ
3β
4+ ∆ 2/parenleftbigβ
3+ ∆ 2/parenrightbig/parenrightbig
−∆1δ2δ3δ4β
2β
3β
4+ ∆ 1/parenleftbigβ
2β
3+ ∆ 1/parenleftbigβ
2+ ∆ 1/parenrightbig/parenrightbig
a= 4 +δ1δ2δ3δ4β
2β
3β
4β
5
Table I. Universal kernel functions Kn/parenleftbig
Ω1, ...,Ωn−1/parenrightbig
forn= 2,3,4,5 deﬁned in Eq. ( 14) and calculated from Eq. ( 26) in Sec. IV.
In each column, the kernel function in the top row is obtained by ﬁrst multiplying the entries listed below it in the same co lumn
by the common factor in the rightmost column and then taking t he sum, see Eqns. ( 30) and ( 31) as examples. The symbols δj
and ∆ jare deﬁned in Eqns. ( 28) and ( 29). The rows are organized with respect to the number aof appearances of δj, i.e. the
order of the anomalous terms.
V. EXPLICIT KERNEL FUNCTIONS Kn/parenleftbig
Ω1, ...,Ωn−1/parenrightbig
FOR n= 2,3,4,5
While the previous section gives a closed form expression fo r kernel functions of arbitrary order, we here evaluate
the universal kernel functions Kn(Ω1, ...,Ωn−1) deﬁned in Eq. ( 14) from Eq. ( 26) for n= 2,3,4,5 and show the results
in Tab. I. In each column, the kernel function denoted in the top row is obtained by ﬁrst multiplying the entries listed
below it in the same column by the common factor in the rightmo st column and then taking the sum. The symbols
δjand ∆ jforj= 1,2, ..., n−1 which appear in Tab. Iare deﬁned by
δj≡δΩ1+Ω 2+...+Ω j,0, (28)
∆j≡∆Ω1+Ω 2+...+Ω j≡/braceleftBigg
0 if Ω 1+Ω 2+...+Ω j=0
1
Ω1+Ω 2+...+Ω jif Ω 1+Ω 2+...+Ω j∝ne}ationslash= 0, (29)
compare also to the previous section. As an example, for n= 2 and n= 3 we obtain from Tab. I
K2(Ω1) =−∆1+β
2δ1, (30)
K3(Ω1,Ω2) = +∆ 1∆2−β
2δ1∆2−∆1δ2/parenleftbiggβ
2+ ∆ 1/parenrightbigg
+δ1δ2β
2β
3, (31)
respectively. The rows of Tab. Iare organized with respect to the number aof factors δlin the summands. Here,
a= 0 indicates the regular part and a= 1,2, ..., n−1 indicates anomalous terms. There are n−1choose aanomalous
terms of order a. Our results are exact and go substantially beyond existing expressions in the literature – these are
limited to n≤3 [18] or to fermionic n= 4 [ 19–21] with a= 0,1 (and a= 2,3 guaranteed to vanish, see below) or
arbitrary nwith a= 0 [ 21]. Alternative expressions for the n= 3,4 kernel functions with a≤1 were given in [ 21],
but they are consistent with our kernel functions as they yie ld the same correlation functions, see the Appendix.7
In the case of purely fermionic correlators (all Akfermionic), individual Matsubara frequencies ωkcannot be
zero. Thus the complex numbers Ωab
k=iωk+Ea−Ebof Eq. ( 12) always have a ﬁnite imaginary part, regardless
of the eigenenergies. In this case, only sums of an even numbe r of frequencies can be zero, and we can simplify
δ1=δ3=δ5=...= 0. The expressions for the kernels in Tab. I, now denoted by Kn|Ffor the fermionic case, simplify
to
K2(Ω1)|F=−∆1, (32)
K4(Ω1,Ω2,Ω3)|F= ∆ 1∆3/bracketleftbigg
δ2/parenleftbiggβ
2+ ∆ 1/parenrightbigg
−∆2/bracketrightbigg
, (33)
K6(Ω1, ...,Ω5)|F= ∆ 1∆3∆5/braceleftbigg
−∆2∆4−δ2δ4/bracketleftbiggβ
2β
3+ (∆ 1+ ∆ 3)/parenleftbiggβ
2+ ∆ 1/parenrightbigg/bracketrightbigg
(34)
+δ4∆2/parenleftbiggβ
2+ ∆ 1+ ∆ 2+ ∆ 3/parenrightbigg
+δ2∆4/parenleftbiggβ
2+ ∆ 1/parenrightbigg/bracerightbigg
.
This concludes the general part of this work. Next, we consid er two example systems frequently discussed in the
condensed matter theory literature. Using our formalism, w e provide analytical forms of correlation functions that to
the best of our knowledge were not available before.
VI. APPLICATIONS: HUBBARD ATOM AND FREE SPIN
A. Fermionic Hubbard atom
The Hubbard atom (HA) describes an isolated impurity or othe rwise localized system with Hamiltonian
H=ǫ(n↑+n↓) +Un↑n↓−h(n↑−n↓), (35)
see Fig. 1(b) for a sketch. The HA corresponds to the limit of vanishing system-bath coupling of the Anderson
impurity model (AIM), or vanishing hopping in the Hubbard mo del (HM). The particle number operators nσ=d†
σdσ
count the number of fermionic particles with spin σ∈{↑ ,↓}, each contributing an onsite energy ǫshifted by an
external magnetic ﬁeld hinz-direction. An interaction energy Uis associated to double occupation.
Due to its simplicity and the four-dimensional Hilbert spac e, the correlation functions for the HA can be found
analytically using the spectral representation. It is ther efore often used for benchmarking [ 3,27,28]. The presence
of the interaction term leads to a non-vanishing n= 4 one-line irreducible vertex function. The HA serves as an
important reference point to study and interpret propertie s of the AIM and HM beyond the one-particle level, for
example divergences of two-line irreducible vertex functi ons [29–32] and signatures of the local moment formation in
generalized susceptibilities [ 16,33]. Using the fermionic kernels in Eqns. ( 32) and ( 33), we have checked that our
formalism reproduces the results for the 2-point and 4-poin t correlators given in Refs. [ 19,21,26] for half-ﬁlling,
ǫ=−U/2 and h= 0.
Correlation functions including bosonic operators descri be the asymptotic behaviour of the n= 4 fermion vertex
for large frequencies [ 34] or the interaction of electrons by the exchange of an eﬀecti ve boson [ 35,36]. These relations
involve correlation functions of two bosonic operators or o f one bosonic and two fermionic operators, giving rise to
expressions possibly anomalous in at most one frequency arg ument, i.e. a≤1.
For the HA, AIM and HM, bosonic correlation functions for n > 2 have not been considered thoroughly so far.
Only recently, steps in this direction were taken, particul arly in the context of non-linear response theory [ 3]. The
response of a system to ﬁrst and second order in an external pe rturbation is described by 2- and 3-point correlation
functions, respectively. For the HA, physically motivated perturbations aﬀect the onsite energy via a term δǫnor take
the form of a magnetic ﬁeld δh·S. Here, the parameters δεandδhdenote the strength of the perturbation and we
deﬁne
n=n↑+n↓, Sx=1
2/parenleftBig
d†
↑d↓+d†
↓d↑/parenrightBig
, Sy=−i
2/parenleftBig
d†
↑d↓−d†
↓d↑/parenrightBig
, Sz=1
2(n↑−n↓). (36)
The resulting changes of the expectation values of the densi ty or magnetization in arbitrary direction are described
in second order of the perturbation by the connected parts of the correlation functions GA1A2A3(τ1, τ2, τ3), with
Ai∈{n, S x, Sy, Sz}, where the time-ordered expectation value is evaluated wit h respect to the unperturbed system
(35) and Fourier transformed to the frequencies of interest. Th ese objects have been studied numerically in Ref. [ 3].
In the following, we give explicit, analytic expressions of the full correlation functions GA1A2A3(ω1, ω2) (i.e. including8
disconnected parts), for arbitrary parameters ǫ,Uandhand for all possible operator combinations using the (boson ic)
kernel function K3, see Eq. ( 31). To the best of our knowledge, these expressions have not be en reported before.
The eigenstates of the HA Hamiltonian ( 35) [see Fig. 1(b)] describe an empty ( |0∝an}bracketri}ht), singly occupied ( d†
↑|0∝an}bracketri}ht=|↑∝an}bracketri}ht,
d†
↓|0∝an}bracketri}ht=|↓∝an}bracketri}ht) or doubly occupied ( d†
↑d†
↓|0∝an}bracketri}ht=|↑↓∝an}bracketri}ht) impurity with eigenenergies E0= 0, E↑=ǫ−h,E↓=ǫ+hand
E↑↓= 2ǫ+U, respectively. The partition function is Z= 1 + e−β(ǫ−h)+e−β(ǫ+h)+e−β(2ǫ+U).We deﬁne
s=e−βǫ
Zsinh( βh), c =e−βǫ
Zcosh( βh), (37)
and obtain all non-vanishing bosonic 3-point correlation f unctions (where ω3=−ω1−ω2):
Gnnn(ω1, ω2) = 2 β2δω1δω2/parenleftbigg4e−β(2ǫ+U)
Z+c/parenrightbigg
, (38)
GnnSz(ω1, ω2) =β2δω1δω2s, (39)
GnSxSy(ω1, ω2) =−βδω1sω2
ω2
2+ 4h2, (40)
GnSxSx(ω1, ω2) =GnSySy(ω1, ω2) = 2 βδω1h s
ω2
2+ 4h2, (41)
GnSzSz(ω1, ω2) =β2
2δω1δω2c, (42)
GSzSxSx(ω1, ω2) =GSzSySy(ω1, ω2) =−sω2ω3+ 4h2
(ω2
2+ 4h2)(ω2
3+ 4h2)+βδω1h c
ω2
2+ 4h2, (43)
GSzSzSz(ω1, ω2) =β2
4δω1δω2s, (44)
GSxSySz(ω1, ω2) = 2 h sω1−ω2
(ω2
1+ 4h2)(ω2
2+ 4h2)−β
2δω3cω1
ω2
1+ 4h2. (45)
We observe that each conserved quantity, in this case nandSz, contributes an anomalous term ∝δωkin its respective
frequency argument ωk. If an operator Akis conserved [ H, A k] = 0, the basis over which we sum in Eq. ( 15) can be
chosen such that both HandAkare diagonal, A12
k=A11
kδ1,2. IfA11
k∝ne}ationslash= 0 for some state 1 the vanishing eigenenergy
diﬀerence leads to the appearance of an anomalous contribut ion. If the operators in the correlator additionally
commute with each other, in our case for example [ n, Sz] = 0, there exists a basis in which all operators and the
Hamiltonian are diagonal, giving rise to correlation funct ions anomalous in all frequency arguments.
In the limit of vanishing ﬁeld h→0, we introduce an additional degeneracy E↑=E↓=ǫin the system, potentially
resulting in additional anomalous contributions. The corr esponding correlation functions can then be obtained in two
ways. Either we recompute them using the kernel function K3or we take appropriate limits, for example
lim
h→0hsinh( βh)
ω2
k+ 4h2=β
4δωk, (46)
resulting in
Gnnn(ω1, ω2) =β2δω1δω22(4e−β(2ǫ+U)+e−βǫ)
Z, (47)
GnSαSα(ω1, ω2) =β2δω1δω2e−βǫ
2Z(α∈{x, y, z}), (48)
GSxSySz(ω1, ω2) =βe−βǫ
2Z(−δω1∆ω2+δω2∆ω1−δω1+ω2∆ω1), (49)
with all other correlation functions vanishing. As already pointed out in Ref. [ 3], only the last correlation function
retains a nontrivial frequency dependence due to non-commu ting operators.
B. Free spin S
We now consider correlation functions of a free spin of lengt hS, without a magnetic ﬁeld, so that temperature
T= 1/βis the only energy scale. The operators {Sα}α=x,y,z fulﬁll SxSx+SySy+SzSz=S(S+ 1) and the SU(2)9
n= 2GS+S−(ω) =GSzSz(ω) =βδωb1
n= 3GS+S−Sz(ω1, ω2) =βb1(−δω1∆iω2+δω2∆iω1+δω1+ω2∆iω2) =−iGSxSySz(ω1, ω2)
n= 4GSzSzSzSz(ω1, ω2, ω3) =δω1δω2δω3β3b3
GS+S+S−S−(ω1, ω2, ω3) =βb1[2×δω1δω2δω3×β2
5/parenleftbig
3b1−1
3/parenrightbig
+r]
GS+S−SzSz(ω1, ω2, ω3) =βb1[1×δω1δω2δω3×β2
5/parenleftbig
3b1−1
3/parenrightbig
−r]
r= ∆ iω1∆iω2(δω1+ω3+δω2+ω3−δω3−δω4)−/parenleftbig
δω1∆2
iω2+δω2∆2
iω1/parenrightbig
(δω3+δω4)−∆iω3∆iω4(δω1+δω2)
Table II. Matsubara correlation functions for a free spin- Sup to order n= 4. Here, ω4=−ω1−ω2−ω3.
algebra [ Sα1, Sα2] =i/summationtext
α3={x,y,z }ǫα1α2α3Sα3, thus they are bosonic. Since the Hamiltonian vanishes and t herefore
all eigenenergies are zero, every Ωab
kin the spectral representation ( 15) can vanish and a proper treatment of all
anomalous terms is essential. As the Heisenberg time depend ence is trivial, Sα(τ) =Sα, the non-trivial frequency
dependence of the correlators, which can be can be non-vanis hing at any order n, derives solely from the action of
imaginary time-ordering.
The correlators are required, for example, as the non-trivi al initial condition for the spin-fRG recently suggested
by Kopietz et al., Refs. [ 13,37–40]. However, for n >3 they are so far only partially available: They are either gi ven
for restricted frequency combinations, or for the purely cl assical case Sα1=Sα2=...=Sαnwhere the SU(2) algebra
does not matter, or for ﬁnite magnetic ﬁeld via an equation of motion [ 37] or diagrammatic approach [ 41,42].
We deﬁne the spin raising and lowering operators,
S±= (Sx±iSy)/√
2, (50)
which have to appear in pairs for a non-vanishing correlator due to spin-rotation symmetry. As for the HA, we do not
consider connected correlators in this work for brevity. Th e classical Sz-correlator can be found from its generating
functional with source ﬁeld h[13],
G(y=βh) =sinh [ y(S+ 1/2)]
(2S+ 1) sinh [ y/2], (51)
/angbracketleftbig
(Sz)l/angbracketrightbig
= lim
y→0∂l
yG(y)≡bl−1, (52)
for example b1=S
3(S+ 1) and b3=S
15/parenleftbig
3S3+ 6S2+ 2S−1/parenrightbig
and vanishing blfor even l. For all other correlators
involving αk=±, we adapt Eq. ( 15) for the free spin case,
GSα1Sα2...Sαn(ω1, ..., ω n−1) =/summationdisplay
p∈Sn∝an}bracketle{tSαp(1)Sαp(2)...Sαp(n)∝an}bracketri}htKn/parenleftbig
iωp(1), iωp(2), ..., iω p(n−1)/parenrightbig
, (53)
where we made use of the fact that all eigenenergies are zero a nd the Heisenberg time evolution is trivial. It is
convenient to evaluate the equal-time correlators in Eq. ( 53) as
∝an}bracketle{tSα1Sα2...Sαn∝an}bracketri}ht=1
2S+ 1S/summationdisplay
m=−S∝an}bracketle{tm|Sα1Sα2...Sαn|m∝an}bracketri}ht≡1
2S+ 1S/summationdisplay
m=−Sn/summationdisplay
l=0plml=p0+n/summationdisplay
l=2plbl−1 (54)
where in the last step we used Eq. ( 52). We ﬁnd the real expansion coeﬃcients {pl}l=0,1,...,n iteratively by moving
through the string α1α2...αnfrom the right and start from pl=δ0,l. Based on the Szeigenstates{/vextendsingle/vextendsinglem/angbracketrightbig
}m=−S,...,S −1,S
we obtain the iteration rules from Sz/vextendsingle/vextendsinglem/angbracketrightbig
=m/vextendsingle/vextendsinglem/angbracketrightbig
andS±/vextendsingle/vextendsinglem/angbracketrightbig
=/radicalbig
1/2/radicalbig
S(S+ 1)−m(m±1)/vextendsingle/vextendsinglem±1/angbracketrightbig
. We deﬁne an
auxiliary integer cthat keeps track of the intermediate state |m+c∝an}bracketri}ht, initially c= 0. Depending on the αjthat we
ﬁnd in step j=n, n−1...,1 we take one of the following actions: (i) For αj=z, we update pl←pl−1+cpl∀land
leave cunchanged. It is understood that pl<0= 0. (ii) For αj= +, we combine the square-root factor brought by the
raising operator with the factor that comes from the necessa ryαj′=−at another place in the string. We replace
pl←−1
2pl−2−2c+1
2pl−1+/parenleftbig3
2b1−cc+1
2/parenrightbig
pl∀land then let c←c+ 1. (iii) For αj=−, we update c←c−1 and keep
plunchanged, pl←pl∀l.
Our ﬁnal results for the free spin correlators are reported i n Tab. II. We reproduce the known spin correlators for
n= 2,3 and determine the non-classical correlators GS+S+S−S−andGS+S−SzSzat order n= 4, which to the best of10
our knowledge were not available in the literature [ 43]. We also conﬁrmed the classical result for GSzSzSzSz, which
in our full quantum formalism requires some non-trivial can cellations. To arrive at our results, we used the identity
∆a+b(∆a+ ∆ b)−∆a∆b=δa∆2
b+δb∆2
a−δa+b∆a∆b. (55)
We ﬁnally comment on the relation between the n= 3 free spin- Scorrelator GS+S−Szfrom Tab. ( II) and the result for
GSxSySzfound for the zero-ﬁeld limit of the HA in Eq. ( 49). The operators Sx,y,zfor the Hubbard model [c.f. Eq. ( 36)]
project to the singly-occupied S= 1/2 subspace spanned by the states/vextendsingle/vextendsingle↑/angbracketrightbig
,/vextendsingle/vextendsingle↓/angbracketrightbig
. Thus, using GSxSySz=iGS+S−Sz
and specializing the free spin result from Tab. ( II) toS= 1/2 (where b1= 1/4) we ﬁnd agreement with the HA result
(49) up to the factor 2 e−βǫ/Z. This factor represents the expectation value of the projec tor to the singly-occupied
sector in the HA Hilbert space and goes to unity in the local-m oment regime.
VII. CONCLUSION
In summary, we have provided exact universal kernel functio ns for the spectral representation of the n-point
Matsubara correlator. Our results are an eﬃcient alternati ve to equation-of-motion approaches which often have
diﬃculties to capture anomalous terms related to conserved or commuting operators. We expect our results to be
useful for various benchmarking applications, as starting points for emerging many-body methods and for unraveling
the physical interpretation of n-point functions in various settings. Our results also appl y in the limit T→0 where
the formally divergent anomalous contributions are to be un derstood as βδω,0→2πδ(ω). Some of these Dirac delta-
functions will vanish after subtracting the disconnected c ontributions, others indicate truely divergent susceptib ilities
like the 1 /TCurie law for the spin-susceptiblity of the Hubbard atom in t he local moment regime [ 26]. Although
our work has focused on imaginary frequency (Matsubara) cor relators, with analytical expressions now at hand, it is
also interesting to study the intricacies of analytical con tinuation to real frequencies and thus to further explore th e
connection of Matsubara and Keldysh correlators [ 44].
ACKNOWLEDGMENTS
We acknowledge useful discussions with Karsten Held, Fried rich Krien, Seung-Sup Lee, Peter Kopietz, Fabian
Kugler, Nepomuk Ritz, Georg Rohringer, Andreas Rückriegel . We thank Andreas Rückriegel for sharing unpublished
results on 4-point free spin correlators and pointing out fu rther simpliﬁcations of the analytical expressions. BS and BS
are supported by a MCQST-START fellowship. We acknowledge f unding from the International Max Planck Research
School for Quantum Science and Technology (IMPRSQST) for JH , from the Deutsche Forschungsgemeinschaft under
Germany’s Excellence Strategy EXC-2111 (Project No. 39081 4868), and from the Munich Quantum Valley, supported
by the Bavarian state government with funds from the Hightec h Agenda Bayern Plus.
APPENDIX: EQUIVALENCE TO CONVENTION OF REF. [21]
In Ref. [ 21] by Kugler, Lee and von Delft (KLD), only regular ( a= 0) and anomalous terms of order a= 1 have
been considered for n= 3,4. The corresponding kernel functions were derived from onl y (n−1)! permutations by
setting τn= 0 and τi/ne}ationslash=n>0, but still applied to all n! permutations to obtain the correlation functions. For n= 3,
the resulting kernel function (Eq. (46) in Ref. [ 21]) reads
K3,KLD(Ω1,Ω2) = ∆ 1∆2−∆1δ21
2(β+ ∆ 1)−δ1∆21
2(β+ ∆ 2). (56)
This can be compared to the corresponding kernel function fo rn= 3 found in our Eq. ( 31) truncated to a≤1,
Ka≤1
3(Ω1,Ω2) = ∆ 1∆2−∆1δ2/parenleftbiggβ
2+ ∆ 1/parenrightbigg
−β
2δ1∆2. (57)
Both approaches are equally valid and should yield the same c orrelation functions (consistently discarding terms
with a= 2), yet the kernel functions are obviously diﬀerent. To res olve this issue, we deﬁne the diﬀerence of the
kernel functions
K3,diﬀ(Ω1,Ω2) =K3,KLD(Ω1,Ω2)−Ka≤1
3(Ω1,Ω2) =1
2/parenleftbig
∆2
1δ2−δ1∆2
2/parenrightbig
(58)11
and show that the corresponding contributions to the correl ation function vanishes when summed over cyclically
related permutations p= 123 ,231,312. These contributions are given by
1
Z/summationdisplay
p=123 ,231,312ζ(p)/summationdisplay
123e−βE 1A12
p(1)A23
p(2)A31
p(3)K3,diﬀ(Ω12
p(1),Ω23
p(2))
=ζ(123)
2Z/summationdisplay
123e−βE 1A12
1A23
2A31
3/parenleftBigg
(1−δω1δE1−E2)δω1+ω2δE1−E3
(iω1+E1−E2)2−δω1δE1−E2(1−δω1+ω2δE1−E3)
(iω1+iω2+E1−E3)2/parenrightBigg
+ζ(231)
2Z/summationdisplay
123e−βE 1A12
2A23
3A31
1/parenleftBigg
(1−δω2δE1−E2)δω2+ω3δE1−E3
(iω2+E1−E2)2−δω2δE1−E2(1−δω2+ω3δE1−E3)
(iω2+iω3+E1−E3)2/parenrightBigg
+ζ(312)
2Z/summationdisplay
123e−βE 1A12
3A23
1A31
2/parenleftBigg
(1−δω3δE1−E2)δω3+ω1δE1−E3
(iω3+E1−E2)2−δω3δE1−E2(1−δω3+ω1δE1−E3)
(iω3+iω1+E1−E3)2/parenrightBigg
.(59)
Considering the second term of permutation p= 312 and renaming the summation variables 2 →1, 3→2, 1→3
yields
−ζ(312)
2Z/summationdisplay
123e−βE 1A12
3A23
1A31
2δω3δE1−E2(1−δω3+ω1δE1−E3)
i(ω3+ω1) +E1−E3
=−ζ(312)
2Z/summationdisplay
123e−βE 3A12
1A23
2A31
3δω3δE3−E1(1−δω3+ω1δE3−E2)
(iω3+iω1+E3−E2)2
=−ζ(123)
2Z/summationdisplay
123e−βE 1A12
1A23
2A31
3δω1+ω2δE1−E3(1−δω1δE1−E2)
(iω1+E1−E2)2,(60)
where we used ω3=−ω1−ω2and the fact that δω3enforces the third operator to be bosonic, such that ζ(312) = ζ(123).
This term exactly cancels the ﬁrst contribution of permutat ionp= 123 in ( 59). Repeating similar steps for the
remaining terms, we ﬁnd that the the second term of p= 123 and the ﬁrst term of p= 231 as well as the second term
ofp= 231 and the ﬁrst term of p= 312 cancel, leading to
1
Z/summationdisplay
p∈{123,231,312}ζ(p)/summationdisplay
123e−βE 1A12
p(1)A23
p(2)A31
p(3)K3,diﬀ(Ω12
p(1),Ω23
p(2)) = 0 . (61)
Similarly, summing over the second set of cyclically relate d permutations p= 132 ,213,321 leads to a vanishing result,
leading to the conclusion that
1
Z/summationdisplay
p∈S3ζ(p)/summationdisplay
123e−βE 1A12
p(1)A23
p(2)A31
p(3)K3,diﬀ(Ω12
p(1),Ω23
p(2)) = 0 . (62)
Thus we have shown that both kernel functions in Eqns. ( 56) and ( 57) are equivalent as they yield the same correlation
functions after summing over all permutations. The same sta tement holds true for case of n= 4 and a= 1.
[1] J. W. Negele and H. Orland. Quantum Many-Particle Systems . Westview, 1988.
[2] H. Bruus and K. Flensberg. Many-Body Quantum Theory in Condensed Matter Physics . Oxford Graduate Texts, 2004.
[3] P. Kappl, F. Krien, C. Watzenböck, and K. Held. Non-linea r responses and three-particle correlators in corre-
lated electron systems exempliﬁed by the Anderson impurity model. Phys. Rev. B , 107(20):205108, May 2023. doi:
10.1103/PhysRevB.107.205108.
[4] G. Semeghini, H. Levine, A. Keesling, S. Ebadi, T. T. Wang , D. Bluvstein, R. Verresen, H. Pichler, M. Kalinowski,
R. Samajdar, A. Omran, S. Sachdev, A. Vishwanath, M. Greiner , V. Vuletić, and M. D. Lukin. Probing topological spin
liquids on a programmable quantum simulator. Science , 374(6572):1242–1247, December 2021. doi:10.1126/scien ce.abi8794.
[5] L. Hedin. New Method for Calculating the One-Particle Gr een’s Function with Application to the Electron-Gas Proble m.
Phys. Rev. , 139(3A):A796–A823, August 1965. doi:10.1103/PhysRev.1 39.A796.
[6] N.E. Bickers. Self-Consistent Many-Body Theory for Condensed Matter Sys tems. Springer.12
[7] B. Roulet, J. Gavoret, and P. Nozières. Singularities in the X-Ray Absorption and Emission of Metals. I. First-Order
Parquet Calculation. Phys. Rev. , 178(3):1072–1083, February 1969. doi:10.1103/PhysRev. 178.1072.
[8] P. Kopietz, L. Bartosch, and F. Schütz. Introduction to the Functional Renormalization Group . Springer, 2010.
[9] W. Metzner, M. Salmhofer, C. Honerkamp, V. Meden, and K. S chönhammer. Functional renormalization group approach
to correlated fermion systems. Rev. Mod. Phys. , 84:299, March 2012. doi:10.1103/RevModPhys.84.299.
[10] C. Wetterich. Exact evolution equation for the eﬀectiv e potential. Physics Letters B , 301(1):90–94, February 1993. ISSN
0370-2693. doi:10.1016/0370-2693(93)90726-X.
[11] S.-S. Lee, F. Kugler, and J. von Delft. Computing Local M ultipoint Correlators Using the Numerical Renormalizatio n
Group. Phys. Rev. X , 11(4):041007, October 2021. doi:10.1103/PhysRevX.11.0 41007.
[12] J. Reuther and R. Thomale. Cluster functional renormal ization group. Phys. Rev. B , 89(2):024412, January 2014. doi:
10.1103/PhysRevB.89.024412.
[13] J. Krieg and P. Kopietz. Exact renormalization group fo r quantum spin systems. Phys. Rev. B , 99(6):060403, February
2019. doi:10.1103/PhysRevB.99.060403.
[14] A. Rückriegel, J. Arnold, R. Goll, and P. Kopietz. Spin f unctional renormalization group for dimerized quantum spi n
systems. Phys. Rev. B , 105(22):224406, June 2022. ISSN 2469-9950, 2469-9969. do i:10.1103/PhysRevB.105.224406.
[15] G. Rohringer, H. Hafermann, A. Toschi, A. A. Katanin, A. E. Antipov, M. I. Katsnelson, A. I. Lichtenstein, A. N. Rubts ov,
and K. Held. Diagrammatic routes to nonlocal correlations b eyond dynamical mean ﬁeld theory. Rev. Mod. Phys. , 90(2):
025003, May 2018. doi:10.1103/RevModPhys.90.025003.
[16] P. Chalupa, T. Schäfer, M. Reitner, D. Springer, S. Ande rgassen, and A. Toschi. Fingerprints of the Local Moment
Formation and its Kondo Screening in the Generalized Suscep tibilities of Many-Electron Problems. Phys. Rev. Lett. , 126
(5):056403, February 2021. doi:10.1103/PhysRevLett.126 .056403.
[17] H. Lehmann. Über Eigenschaften von Ausbreitungsfunkt ionen und Renormierungskonstanten quantisierter Felder. Nuovo
Cim, 11(4):342–357, April 1954. ISSN 1827-6121. doi:10.1007/ BF02783624.
[18] A.M. Shvaika. On the spectral relations for multitime c orrelation functions. 9(3(47)):447–458, 2006.
[19] H. Hafermann, C. Jung, S. Brener, M. I. Katsnelson, A. N. Rubtsov, and A. I. Lichtenstein. Superperturbation solver for
quantum impurity models. Europhys. Lett. , 85(2):27007, January 2009. ISSN 0295-5075, 1286-4854. do i:10.1209/0295-
5075/85/27007.
[20] A.M. Shvaika. Spectral properties of four-time fermio nic Green’s functions. 19(3):33004, 2016. doi:10.5488/CM P.19.33004.
[21] F. B. Kugler, S.-S. B. Lee, and J. von Delft. Multipoint C orrelation Functions: Spectral Representation and Numeri cal
Evaluation. Phys. Rev. X , 11(4):041006, October 2021. doi:10.1103/PhysRevX.11.0 41006.
[22] P. C. Kwok and T. D. Schultz. Correlation functions and G reen functions: Zero-frequency anomalies. J. Phys. C: Solid
State Phys. , 2(7):1196, July 1969. ISSN 0022-3719. doi:10.1088/0022- 3719/2/7/312.
[23] C. Watzenböck, M. Fellinger, K. Held, and A. Toschi. Lon g-term memory magnetic correlations in the Hubbard
model: A dynamical mean-ﬁeld theory analysis. SciPost Phys. , 12(6):184, June 2022. ISSN 2542-4653. doi:
10.21468/SciPostPhys.12.6.184.
[24] A. Tsvelik. Quantum Field Theory in Condensed Matter Physics . Cambridge U. Press, 2007.
[25] G. Rohringer, A. Valli, and A. Toschi. Local electronic correlation at the two-particle level. Phys. Rev. B , 86(12):125114,
September 2012. doi:10.1103/PhysRevB.86.125114.
[26] G. Rohringer. New Routes towards a Theoretical Treatment of Nonlocal Elec tronic Correlations . Thesis, Technische
Universität Wien, 2013.
[27] F. Krien and A. Valli. Parquetlike equations for the Hed in three-leg vertex. Phys. Rev. B , 100(24):245147, December 2019.
ISSN 2469-9950, 2469-9969. doi:10.1103/PhysRevB.100.24 5147.
[28] F. Krien, A. Kauch, and K. Held. Tiling with triangles: P arquet and G W γmethods uniﬁed. Phys. Rev. Research , 3(1):
013149, February 2021. ISSN 2643-1564. doi:10.1103/PhysR evResearch.3.013149.
[29] T. Schäfer, S. Ciuchi, M. Wallerberger, P. Thunström, O . Gunnarsson, G. Sangiovanni, G. Rohringer, and A. Toschi.
Nonperturbative landscape of the Mott-Hubbard transition : Multiple divergence lines around the critical endpoint. Phys.
Rev. B , 94(23):235108, December 2016. doi:10.1103/PhysRevB.94 .235108.
[30] P. Thunström, O. Gunnarsson, Sergio Ciuchi, and G. Rohr inger. Analytical investigation of singularities in two-p article
irreducible vertex functions of the Hubbard atom. Phys. Rev. B , 98(23):235107, December 2018. ISSN 2469-9950, 2469-
9969. doi:10.1103/PhysRevB.98.235107.
[31] P. Chalupa, P. Gunacker, T. Schäfer, K. Held, and A. Tosc hi. Divergences of the irreducible vertex functions in cor-
related metallic systems: Insights from the Anderson impur ity model. Phys. Rev. B , 97(24):245136, June 2018. doi:
10.1103/PhysRevB.97.245136.
[32] M. Pelz, S. Adler, M. Reitner, and A. Toschi. The highly n onperturbative nature of the Mott metal-insulator transit ion:
Two-particle vertex divergences in the coexistence region . (arXiv:2303.01914), March 2023. doi:10.48550/arXiv.23 03.01914.
[33] S. Adler, F. Krien, P. Chalupa-Gantner, G. Sangiovanni , and A. Toschi. Non-perturbative intertwining between spi n
and charge correlations: A "smoking gun" single-boson-exc hange result. (arXiv:2212.09693), December 2022. doi:
10.48550/arXiv.2212.09693.
[34] N. Wentzell, G. Li, A. Tagliavini, C. Taranto, G. Rohrin ger, K. Held, A. Toschi, and S. Andergassen. High-frequency
asymptotics of the vertex function: Diagrammatic parametr ization and algorithmic implementation. Phys. Rev. B , 102(8):
085106, August 2020. ISSN 2469-9950, 2469-9969. doi:10.11 03/PhysRevB.102.085106.
[35] F. Krien, A. Valli, and M. Capone. Single-boson exchang e decomposition of the vertex function. Phys. Rev. B , 100(15):
155149, October 2019. ISSN 2469-9950, 2469-9969. doi:10.1 103/PhysRevB.100.155149.
[36] M. Gievers, E. Walter, A. Ge, J. von Delft, and F. B. Kugle r. Multiloop ﬂow equations for single-boson exchange fRG.13
Eur. Phys. J. B , 95(7):108, July 2022. ISSN 1434-6036. doi:10.1140/epjb/ s10051-022-00353-6.
[37] R. Goll, D. Tarasevych, J. Krieg, and P. Kopietz. Spin fu nctional renormalization group for quantum Heisenberg fer -
romagnets: Magnetization and magnon damping in two dimensi ons. Phys. Rev. B , 100(17):174424, November 2019.
doi:10.1103/PhysRevB.100.174424.
[38] R. Goll, A. Rückriegel, and P. Kopietz. Zero-magnon sou nd in quantum Heisenberg ferromagnets. Phys. Rev. B , 102(22):
224437, December 2020. doi:10.1103/PhysRevB.102.224437 .
[39] D. Tarasevych and P. Kopietz. Dissipative spin dynamic s in hot quantum paramagnets. Phys. Rev. B , 104(2):024423, July
2021. doi:10.1103/PhysRevB.104.024423.
[40] D. Tarasevych, A. Rückriegel, S. Keupert, V. Mitsiioan nou, and P. Kopietz. Spin functional renormalization group for
the J1-J2-J3 quantum Heisenberg model. Phys. Rev. B , 106(17):174412, November 2022. ISSN 2469-9950, 2469-996 9.
doi:10.1103/PhysRevB.106.174412.
[41] V. G. Vaks and S. A. Pikin. Thermodynamics of an ideal fer romagnetic substance. Soviet Journal of Experimental and
Theoretical Physics , 26(1):188, 1968.
[42] V. G. Vaks, A. I. Larkin, and S. A. Pikin. Spin Waves and Co rrelation Functions in a Ferromagnetic. Soviet Journal of
Experimental and Theoretical Physics , 26:647, March 1968. ISSN 1063-7761.
[43] We thank Andreas Rückriegel for sharing unpublished re sults on 4-point free spin correlators and pointing out furt her
simpliﬁcations of the analytical expressions.
[44] A. Ge, J. Halbinger, S.-S. Lee, J. von Delft, and F. B. Kug ler. manuscript in preparation.