arXiv:2303.05348v1  [math.AP]  9 Mar 2023ON SOBOLEV NORMS INVOLVING
HARDY OPERATORS IN A HALF-SPACE
RUPERT L. FRANK AND KONSTANTIN MERZ
Abstract. We consider Hardy operators on the half-space, that is, ordinary and fractional
Schr¨ odinger operators with potentials given by the appropriate p ower of the distance to the
boundary. We show that the scales of homogeneous Sobolev space s generated by the Hardy
operators and by the fractional Laplacian are comparable with eac h other when the coupling
constant is not too large in a quantitative sense. Our results exten d those in the whole
Euclidean space and rely on recent heat kernel bounds.
Contents
1. Introduction and main result 1
1.1. Setting of the problem 1
1.2. Main result 2
1.3. Background and motivation 5
1.4. Method of proof and organization of the paper 7
2. Heat kernel bounds for Hardy operators 9
3. Riesz kernel bounds 9
4. Proof of the generalized Hardy inequality (Theorem 3) 12
5. Diﬀerence of heat kernels 17
6. Proof of the reversed Hardy inequality (Theorem 5) 21
7. Commutator bounds 25
7.1. Radial cut-oﬀ 25
7.2. Boundary cut-oﬀ 29
7.3. Combined cut-oﬀ 32
8. Density of C∞
c(Rd
+) 32
9. Proof of the main result 35
Appendix A. Deﬁnition of the exponent p 36
Appendix B. Proof of Theorem 10 37
References 39
1.Introduction and main result
1.1.Setting of the problem. In this paper we consider the Hardy operators in a half-space,
given informally by
L(α)
λ= (−∆)α/2
Rd
++λx−α
dinL2(Rd
+). (1)
Date : March 9, 2023.
©2023 by the authors. This paper may be reproduced, in its entirety , for non-commercial purposes.
Support through U.S. National Science Foundation grant DMS-195 4995, by the Deutsche Forschungsgemein-
schaft through Germany’s Excellence Strategy, grant EXC-2111 -390814868 (R.L.F.), and by the PRIME pro-
gramme of the German Academic Exchange Service (DAAD) with fund s from the German Federal Ministry
of Education and Research (BMBF) (K.M.) is acknowledged.
12 R. L. FRANK AND K. MERZ
Here and in what follows Rd
+=Rd−1×(0,∞) and we write x= (x′,xd)∈Rd−1×(0,∞).
We are mostly interested in the fractional case α∈(0,2), but our results are also new in the
local caseα= 2. The operators L(α)
λare considered with a Dirichlet boundary condition for
α= 2 and a certain analogue for α<2. The precise meaning of ( −∆)α/2
Rd
+will be explained in
the next subsection; it is sometimes called the regional fractional L aplacian; see, e.g., [BBC03]
and [Kwa19, Section 8.4].
The constant λis assumed to satisfy
λ≥λ∗
where
λ∗:=−Γ(1+α
2)
π/parenleftbigg
Γ(1+α
2)−2α−1√π
Γ(1−α
2)/parenrightbigg
.
Note thatλ∗depends on α, but not on d, and that λ∗=−1
4ifα= 2. Also, λ∗<0 if
α∈(0,1)∪(1,2] andλ∗= 0 ifα= 1.
The constant λ∗plays the role of a critical coupling constant. As is well-known for α= 2
and shown by Bogdan and Dyda [BD11] for α<2, the constant λ∗is the optimal constant in
Hardy’s inequality, which states that
L(α)
λ∗≥0.
Our goal in this paper is to study the powers
/parenleftBig
L(α)
λ/parenrightBigs/2
withs∈(0,2].
More precisely, we are interested in the domains of these operator s (which are subspaces
containing the operator domain of L(α)
λ) and, in particular, in the question how these domains
for general λ≥λ∗compare with the domain of this operator in the case λ= 0. When
λ>λ∗/\e}atio\slash= 0 ands≤1, it is easy to see that the domains of ( L(α)
λ)s/2and (L(α)
0)s/2coincide; see,
e.g., [FMS21, Remark 1.2] for a similar argument. Our main interest is th erefore in the case
s>1, corresponding to subspaces between the form domain and the o perator domain. In our
main result (Theorem 1 below) we will show that, for a certain explicit r ange ofs, depending
onλ, the domains of ( L(α)
λ)s/2and (L(α)
0)s/2coincide.
There are several motivations for studying this question, coming b oth from pure mathemat-
ics and from applications to nonlinear dispersive equations and mathe matical physics, and we
will discuss some of them in Subsection 1.3 below. There, we will also give references to the
growing literature on the analogous question in other settings. Pion eering papers on this topic
are those by Killip, Visan and Zhang [KVZ16] and by Killip, Miao, Visan, Zha ng and Zheng
[KMV+18].
1.2.Main result. Before presenting our results, we will ﬁrst discuss the deﬁnition of the
operators (1) and then introduce a parameterization of the coup ling constant λthat will be
important in what follows.
Deﬁnition of the operators. Let us give theprecise deﬁnition of L(α)
λasselfadjoint, nonnegative
operatorsintheHilbertspace L2(Rd
+). Throughoutthispaper,weassumethat d≥1,α∈(0,2]
andλ∈[λ∗,∞), except where explicitly stated otherwise.
Forα∈(0,2), we consider the quadratic form
1
2A(d,−α)/integraldisplay/integraldisplay
Rd
+×Rd
+|u(x)−u(y)|2
|x−y|d+αdxdy+λ/integraldisplay
Rd
+|u(x)|2
xα
ddxHARDY OPERATORS IN A HALF-SPACE 3
with
A(d,−α) :=α
21−απd/2Γ(d+α
2)
Γ(1−α
2), (2)
and forα= 2 we consider the quadratic form
/integraldisplay
Rd
+|∇u(x)|2dx+λ/integraldisplay
Rd
+x−2
d|u(x)|2dx.
These quadratic forms are considered for functions u∈C1
c(Rd
+), that is, continuously diﬀer-
entiable functions whose support is a compact subset of the open s etRd
+. According to the
classical Hardy inequality for α= 2 and its sharp extension to α <2 by Bogdan and Dyda
[BD11], these quadratic forms are nonnegative if (and only if) λ∈[λ∗,∞). By a theorem of
Friedrichs these forms therefore give rise to selfadjoint, nonneg ative operators L(α)
λinL2(Rd
+)
for whichC1
c(Rd
+) is a form core.
The operators ( L(α)
λ)s/2appearing below are deﬁned by the spectral theorem. We will use
the fact that C∞
c(Rd
+) belongs to the domain of these operators for any s∈[0,2] and any
α∈(0,2]; see Lemma 15.
Deﬁnition of the exponent p.For givenα∈(0,2] (not reﬂected in the notation) we set M:=α
ifα<2 andM:=∞ifα= 2 and introduce the function
(−1,M)∋p/ma√sto→C(p) :=1
π/parenleftbigg
Γ(α) sinπα
2+Γ(1+p)Γ(α−p) sinπ(2p−α)
2/parenrightbigg
.(3)
Whenα= 2, one sees that the poles ofΓ( α−p) cancel with the zeros ofsinπ(2p−α)
2and, indeed,
thatC(p) =p(p−1) for allp>−1. Similarly, for α= 1 one ﬁnds C(p) =1
π(1−πpcotπp).
The following properties of Care known and we refer to Appendix A for details and refer-
ences. The function p/ma√sto→C(p) is continuous and symmetric with respect to p=α−1
2, strictly
increasing on [α−1
2,M) and its value at p=α−1
2isλ∗. Moreover, lim p→MC(p) = +∞. Thus,
for anyλ∈[λ∗,∞) there is a unique
p∈[α−1
2,M) withC(p) =λ. (4)
We emphasize that pdepends on α, besidesλ.
One can show that C(α−1) =C(0) = 0. Thus, the case λ= 0 corresponds to p=
(α−1)+:= max{α−1,0}and the case λ>0 top>(α−1)+.
Using the explicit expression of C(p) forα= 2 we see that
p=1
2/parenleftBig
1+√
1+4λ/parenrightBig
ifα= 2. (5)
Notation. We write
A∧B:= min{A,B}, A∨B:= max{A,B}.
Moreover, in order to abbreviate some statements we suppress c onstants and write A/lessorsimilarBfor
A,B∈R+whenever there is a constant c>0 such that A≤cB. The notation A∼Bmeans
A/lessorsimilarB/lessorsimilarAand in this case we say that AandBare comparable. If we want to emphasize
that the constant cmay depend on some parameter, say τ, we writeA/lessorsimilarτB.4 R. L. FRANK AND K. MERZ
Main result – Equivalence of Sobolev norms. Our main result is contained in the following
theorem. It states that the L2(Rd
+)-norms generated by certain powers of L(α)
λare comparable
to those generated by the corresponding powers of L(α)
0.
Theorem 1. Letα∈(0,2]and letλ≥0whenα <2andλ≥ −1/4whenα= 2. Letpbe
deﬁned by (4), and lets∈(0,2].
(1)Ifs<(1+2p)/α, thendom(L(α)
λ)s/2⊂dom(L(α)
0)s/2and
/ba∇dbl(L(α)
0)s/2u/ba∇dblL2(Rd
+)/lessorsimilard,α,λ,s/ba∇dbl(L(α)
λ)s/2u/ba∇dblL2(Rd
+)for allu∈dom(L(α)
λ)s/2. (6)
Moreover,C∞
c(Rd
+)is an operator core of (L(α)
λ)s/2.
(2)Ifs<(1+2(α−1)+)/α, thendom(L(α)
0)s/2⊂dom(L(α)
λ)s/2and
/ba∇dbl(L(α)
λ)s/2u/ba∇dblL2(Rd
+)/lessorsimilard,α,λ,s/ba∇dbl(L(α)
0)s/2u/ba∇dblL2(Rd
+)for allu∈dom(L(α)
0)s/2. (7)
Moreover,C∞
c(Rd
+)is an operator core of (L(α)
0)s/2.
In particular, for s∈(0,2] withs <1+2(p∧(α−1)+)
αwe have the equality dom( L(α)
λ)s/2=
dom(L(α)
0)s/2as well as the equivalence
/ba∇dbl(L(α)
λ)s/2u/ba∇dblL2(Rd
+)∼d,α,λ,s/ba∇dbl(L(α)
0)s/2u/ba∇dblL2(Rd
+)for allu∈dom(L(α)
λ)s/2.
Note also that
p∧(α−1)+=/braceleftBigg
(α−1)+ifλ≥0,
p ifλ≤0.
In Section 9 we will see that the assumption s <1+2(p∧(α−1)+)
αis necessary for the equality
dom(L(α)
λ)s/2= dom(L(α)
0)s/2(under the additional assumption α<3/2 ifd= 1).
Forα= 1, we have λ∗= 0 and the assumption λ≥0 in Theorem 1 is optimal, as is the
assumption λ≥ −1/4 forα= 2. Forα∈(0,2)\ {1}the restriction to λ≥0 is probably
technical. It comes from bounds on the heat kernel of L(α)
λ, which are an ingredient in our
proofs and which are currently known only for λ≥0 whenα <2. Since we expect these
bounds to be true also for λ∈[λ∗,0), we will accompany each of our main results with a
remark stating the potential extension.
Remark 2.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tL(α)
λ(x,y) satisﬁes the upper bound
in (9) below with pdeﬁned by (4). Then Theorem 1 remains valid for this value of λ. This
follows by the same arguments as in the proof below, taking into acco unt Remarks 4, 6 and 25.
We next present two important ingredients in the proof of Theorem 1 which are of indepen-
dent interest. They concern variants of Hardy’s inequality.
Theorem 3 (Generalized Hardy inequality) .Letα∈(0,2]and letλ≥0whenα∈(0,2)and
λ≥ −1/4whenα= 2. Letpbe deﬁned by (4). Then, ifs∈(0,1+2p
α∧2d
α), one has
/ba∇dblx−αs/2
du/ba∇dblL2(Rd
+)/lessorsimilard,α,λ,s/ba∇dbl(L(α)
λ)s/2u/ba∇dblL2(Rd
+)for allu∈C∞
c(Rd
+). (8)
Remark 4.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the upper bound
in (9) below with pdeﬁned by (4). Then Theorem 3 remains valid for this value of λ. This
follows by the same arguments as in the proof below, taking into acco unt Remark 14.
It is interesting to compare the assumption s∈(0,1+2p
α∧2d
α) in Theorem 3 with the corre-
sponding assumption for the Hardy inequality in Rdwith weight |x|−αs/2with a point singu-
larity, namely s∈(0,d+2p
α∧2d
α); cf. [FMS21, Proposition 1.4] or [KMV+18, Proposition 3.2].HARDY OPERATORS IN A HALF-SPACE 5
The diﬀerence between dand 1 in this assumption reﬂects the diﬀerent dimensionalities of the
sets where the Hardy weight is singular.
Theorem 5 (Reversed Hardy inequality) .Letα∈(0,2]and letλ≥0whenα <2and
λ≥ −1/4whenα= 2. Letpbe deﬁned by (4)and lets∈(0,2]. Then
/vextenddouble/vextenddouble/vextenddouble/parenleftBig
(L(α)
λ)s/2−(L(α)
0)s/2/parenrightBig
u/vextenddouble/vextenddouble/vextenddouble
L2(Rd
+)/lessorsimilard,α,λ,s/ba∇dblx−αs/2
du/ba∇dblL2(Rd
+)for allu∈C∞
c(Rd
+).
Remark 6.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tL(α)
λ(x,y) satisﬁes the upper bound
in (9) below with pdeﬁned by (4). Then Theorem 5 remains valid for this value of λ. This
follows by the same arguments as in the proof below, taking into acco unt Remark 18.
Remark 7.We have made the choice to compare the operators L(α)
λfor general λ≥λ∗with
the operator L(α)
0for the case λ= 0. This is natural given the quadratic form deﬁnition of
the operators L(α)
λ. Forα <2, there is another natural choice for the comparison operator,
namelyL(α)
λ0withλ0∈(0,∞) deﬁned by
A(d,−α)/integraldisplay
Rd
−dy
|x−y|d+α=λ0
xα
d.
(The fact that the left side is a constant multiple of x−α
dfollows by simple translation and
dilation considerations.) With this deﬁnition of λ0, we have for u∈C1
c(Rd
+), identiﬁed with
its extension by zero to Rd,
/ba∇dbl(−∆)α/4u/ba∇dbl2
L2(Rd)=1
2A(d,−α)/integraldisplay/integraldisplay
Rd×Rd|u(x)−u(y)|2
|x−y|d+αdxdy
=1
2A(d,−α)/integraldisplay/integraldisplay
Rd
+×Rd
+|u(x)−u(y)|2
|x−y|d+αdxdy+λ0/integraldisplay
Rd
+|u(x)|2
xα
ddx.
In this sense the operator L(α)
λ0is equally natural as L(α)
0. Our arguments in this paper extend
without signiﬁcant changes to the case where we compare with L(α)
λ0. However, for the sake
of concreteness and conciseness we have decided to present the arguments in the case of
comparison with the operator L(α)
0.
Remark8.We consider the Schr¨ odinger operators L(α)
λwhose potential is precisely λx−α
d. In
someapplicationsitisnecessary toallowmoregeneralpotentials Vsatisfyingλ|x|−α≤V(x)≤
˜λx−α
dfor allx∈Rd
+with someλ∗≤λ≤˜λ<∞. In this case an analogue of Theorem 1 holds
withpdeﬁned by (4) with the given λ; in particular, it is independent of ˜λ. This follows by
a simple modiﬁcation of our proofs. We have carried out the details in [ FMS21, Section 4] in
the case of Hardy weights with point singularities and omit the corres ponding details here.
1.3.Background and motivation. After having presented our main results, we would like
to put them into context and discuss some previous, related result s.
Homogeneous operators appear frequently in applications as mode l operators or as scaling
limits of more complicated operators, and one aims at analyzing them in as much detail as
possible to draw conclusions about the perturbed versions that ap pear in applications. From
the point of view of pure mathematics and harmonic analysis homogen eous operators are
interesting as testing grounds of how much of Euclidean Fourier ana lysis remains valid when
one dispenses with translation invariance.
A typical feature of homogeneous operators is the appearance o f critical coupling constants.
These are often related to sharp constants in Hardy-type inequa lities. For instance, Hardy’s6 R. L. FRANK AND K. MERZ
original inequality [Har19, Har20, OK90, KMP06] is the case d= 1 of the inequality
/integraldisplay
Rd
+|∇u|2dx≥1
4/integraldisplay
Rd
+|u|2
x2
ddxfor allu∈C1
c(Rd
+).
This inequality is precisely what guarantees that the operators L(2)
λwithλ≥ −1
4are lower
semibounded on C1
c(Rd
+) and therefore can be realized as selfadjoint operators in L2(Rd
+). The
fact that the constant1
4in Hardy’s inequality is sharp means that the operators L(2)
λwith
λ <−1
4are not lower semibounded on C1
c(Rd
+) and therefore cannot have a lower bounded
selfadjoint extension. In applications the operators L(2)
λappear almost only with λ≥ −1
4.
Another natural extension of Hardy’s inequality to the higher dimen sional case is
/integraldisplay
Rd|∇u|2dx≥(d−2)2
4/integraldisplay
Rd|u|2
|x|2dxfor allu∈C1
c(Rd) ifd≥3.
The corresponding operators −∆ +λ|x|−2forλ≥ −(d−2)2
4where studied in the inﬂuential
paper by Killip, Miao, Visan, Zhang and Zheng [KMV+18]. These authors were motivated
by the analysis of nonlinear dispersive PDEs, more precisely, by the s tudy of the global well-
posedness and scattering for the nonlinear Schr¨ odinger equatio n with inverse-square potential
[KMV+17, KMVZ17]. In [KMV+18] the domains of the operators ( −∆ +λ|x|−2)s/2were
compared with the homogeneous Sobolev spaces ˙Hs(Rd) and in this connection a relation
between the power sand the coupling constant λwas observed for the ﬁrst time. Earlier,
Killip, Visan and Zhang [KVZ16] had studied a similar question for the Diric hlet Laplacian
on the complement of a compact, convex set, motivated again by qu estions about nonlinear
Schr¨ odinger equations. The techniques developed in [KVZ16, KMV+18] play an important
role in our analysis.
Hardy’s inequality has been generalized to powers of the Laplacian. A special case of a
result by Herbst [Her77] is that
/vextenddouble/vextenddouble(−∆)α/4u/vextenddouble/vextenddouble2
L2(Rd)≥2αΓ(d+α
4)2
Γ(d−α
4)2/vextenddouble/vextenddouble|x|−α/2u/vextenddouble/vextenddouble2
L2(Rd)for allu∈˙Hα
2(Rd) ifd>α.
For alternative proofs of Herbst’s inequality see [KPS81, Yaf99, FL S08, FS08]. Of particular
importance is the case α= 1 andd= 3, since the operator√
−∆+m2−m2+λ|x|−1in
L2(R3) provides a model for a relativistic description of an electron in the C oulomb ﬁeld of a
point nucleus. The scale invariant model problem for the latter oper ator is the homogeneous
operator√
−∆+λ|x|−1and many results about the latter operator have implications for th e
quantum mechanics with relativistic eﬀects. For instance, Lieb–Thir ring inequalities for the
latteroperatorwere used tosolve theproblem ofstabilityofmatte r inthepresence ofmagnetic
ﬁelds [FLS08, FLS07].
Recently, in joint work with Heinz Siedentop and Barry Simon, we discu ssed the analogue
of the strong Scott conjecture for relativistic electrons [FMSS20 ]. This is a quantum many-
body problem, where the underlying one-body operator is again√
−∆+m2−m2+λ|x|−1in
L2(R3). In connection with this investigation we needed information about the domains of
the operators (√
−∆+λ|x|−1)s/2. More precisely, in our approach we needed to know that for
anyλ>λ∗there is ans>1 such that the L2(Rd)-norms generated by (√
−∆+λ|x|−1)s/2are
equivalent to those generated by ( −∆)s/2. That this is indeed the case was shown in [FMS21],
thus leading to a proof of the strong Scott conjecture in the relat ivistic case. For an alternative
proof see [FMS23a] and for a review about the Scott conjecture s ee [FMS23b].HARDY OPERATORS IN A HALF-SPACE 7
In passing we mention that the papers [KVZ16, KMV+18] also deal with the case where
the underlying norms are those in Lp(Rd) withp/\e}atio\slash= 2. Similarly, the results in [FMS21], which
concernedL2-norms, have been extended to Lp-norms with general 1 < p <∞; see [Mer21]
forλ>0 and [BD23, BN22] for all λ≥λ∗. Proofs for p/\e}atio\slash= 2 often rely on multiplier theorems
in the spirit of the Mikhlin–H¨ ormander theorem. (Note that such mu ltiplier theorems are
immediate consequences of the spectral theorem when p= 2.) In the local case α= 2 the
proof of multiplier theorems can be based on heat kernel bounds wit h Gaussian oﬀ-diagonal
decay. In the absence of such bounds the case α <2 is substantially more complicated; see
also [Mer22].
Inthepresentpaperweaddresstheanalogousquestioninthe L2-caseforfractionaloperators
on half-spaces. The corresponding sharp Hardy inequality in this se tting is due to Bogdan
and Dyda [BD11] and states that
1
2A(d,−α)/integraldisplay/integraldisplay
Rd
+×Rd
+|u(x)−u(y)|2
|x−y|d+αdxdy≥ −λ∗/integraldisplay
Rd
+|u(x)|2
xα
ddxfor allu∈C1
c(Rd
+).
For an alternative proof see [FS10].
The main new diﬃculty compared to previous investigations is the pres ence of a boundary
in the fractional case. Note that there is an interplay between the orderαof the operator and
the eﬀect of the boundary. For α<1 we expect the inﬂuence of the boundary to be negligible,
withα= 1 being a subtle borderline case. This expectation manifests itself, for instance, in
the appearance of the positive part ( α−1)+in part (2) of Theorem 1. Related to this is
the appearance, for small αand largeλ, of a large extra factor in the Riesz kernel bounds
(Theorem 11 below) when the distance of both points to the bounda ry is much smaller than
their mutual distance. This is a phenomenon not encountered in pre vious studies of similar
questions.
We expect our results in the model case of a homogeneous operato r on a half-space to have
applications and extensions to the study of both more general ope rators and more general
domains.
1.4.Method of proof and organization of the paper. The proof of Theorem 1 consists
of two parts. In the ﬁrst part, we prove the relevant inequalities f or functions in C∞
c(Rd
+)
and in the second part, we show that the latter set is an operator c ore, thereby extending the
inequalities to all functions in the domain in the relevant operators.
The ﬁrst part of the proof of Theorem 1, is an immediate consequen ce of Theorems 3 and
5. The main ingredient for the proof of both of these theorems are pointwise bounds on
the heat kernels of the operators L(α)
λ, which have been proved recently by Cho, Kim, Song
and Vondraˇ cek [CKSV20] and Song, Wu and Wu [SWW22] for α <2. The structure of
these bounds is that they diﬀer from the whole space heat kernel b y a product of two extra
factors that depend on the distance of x(resp.y) from the boundary relative to t1/α. This is
summarized in Section 2, with some technical details deferred to App endix B.
For the proof of Theorem 3 we use these heat kernel bounds to de duce Riesz kernel bounds,
that is, bounds on the kernels of the operators ( L(α)
λ)−s/2withs <2d
α; see Theorem 11. For
α= 2 and all λ, or forα <2 and all not too large λ(depending on αands), these Riesz
kernel bounds inherit the structure of the heat kernel bounds, namely the whole space kernel
multiplied by two extra factors. When α<2 andλis large, however, this product structure of
the Riesz kernel bounds is no longer valid and needs to be replaced by a term, which relative
to the product structure becomes unbounded when both xandyare close to the boundary8 R. L. FRANK AND K. MERZ
(comparedto |x−y|). Thisphenomenon doesnotoccur inprevious works onrelatedque stions,
such as [KVZ16, KMV+18, FMS21].
Once the Riesz kernel bounds have been established, the generaliz ed Hardy inequality in
Theorem 3 follows by Schur tests; see Section 4. This is conceptually similar to [KVZ16,
KMV+18, FMS21], but the violation of the product structure for certain λnecessitates some
extra eﬀorts. This will complete the proof of Theorem 3.
Turning to the proof of Theorem 5, we need bounds on the diﬀerence of the heat kernels of
L(α)
λandL(α)
0. Those are derived in Section 5. The diﬃculty here is that in a certain r egion
of space, namely when both xandyare far away from the boundary (compared to t1/α),
but close together (compared to their distance from the boundar y), one needs to quantify a
cancellation coming from taking the diﬀerence of the heat kernels. Again there are similarities
to earlier such arguments, but we believe that here we carry them o ut more eﬃciently than in
[FMS21] and that our new arguments would simplify the proof in [FMS2 1].
Once the bounds on the diﬀerence of the heat kernels have been es tablished, the reverse
Hardy inequality in Theorem 5 follows by Schur tests; see Section 6. T hese Schur tests are
again conceptually similar to earlier arguments, but require substan tially more technical work.
It is perhaps worth pointing out the simple idea that guides the techn ical work in Sections
4, 5 and 6, namely to exploit the invariance of the operators L(α)
λwith respect to translations
parallel to the boundary. This implies that the kernels of the various operators discussed
above depend on the variables x′andy′only through their diﬀerence x′−y′(in fact, only
on|x′−y′|), and therefore one aims at integrating out these variables. In th is way we try to
eﬀectively reduce the problem to the one for the operator L(α)
λin one dimension. Once one is
in one dimension, the distinction of the various regions (deﬁned thro ugh the length scales xd,
yd,|x−y|andt1/α) simpliﬁes considerably and allows one to conclude the proof.
We also note that we could have used the invariance with respect to t ranslations parallel to
theboundary alreadyatthe beginning andwritten L(α)
λasadirect integral of certainoperators
L(α)
λ(ξ′) inL2(R+), depending on a parameter ξ′∈Rd−1, the Fourier variable corresponding
to the space variable x′. In this way, we can rewrite all inequalities in Theorems 1, 3 and
5 as inequalities for the operators L(α)
λ(ξ′)with constants uniform in ξ′. While this would
have immediately reduced the problem to the one-dimensional case, one would have to deal
with the uniformity in the parameter ξ′. Also, as far as we know, precise heat kernel bounds
for the operators L(α)
λ(ξ′) are not available in the literature. (In this connection we mention
the recent heat kernel bounds for ( −∆+1)α/2+V(α)
λinL2(Rd) for certain critical potentials
V(α)
λthat satisfy V(α)
λ∼λ|x|−αasx→0; see [JKS22a, JKS22b].) We also note that precise
information on the operators ( −d2
dx2+|ξ′|2)α/2inL2(R+) (deﬁned on C1
c(R+) via extension by
zero toR, then action on Rand then restriction back to R+) has been obtained in [Kwa11].
This information has been instrumental in [FG16]. These operators a re similar, but in general
diﬀerent from the operators L(α)
λ(ξ′).
This concludes our discussion of the ﬁrst part of the proof of Theo rem 1. The second part,
namely the proof of the operator core property, takes up Sectio ns 7 and 8. The main result
here is Theorem 24 in Section 8. Its proof relies once more on the hea t kernel bounds in
Section 2. The novel ingredient here is a combination of these bound s with Schauder theory
for the Laplacian and its fractional analogue. Applying Schauder es timates on appropriately
chosen scales we obtain local H¨ older norm bounds. These allow us to control action of the
commutator of ( −∆)α/2with cut-oﬀ functions. Such bounds are the topic of Section 7.
Weendthisintroductionbynotingthatinthispaperwehave restrict ed ourselves tothecase
where the underlying norms are L2-norms. This is the case most frequently encountered inHARDY OPERATORS IN A HALF-SPACE 9
applications, including the before-mentioned ones to mathematical physics. There are other
applications, such as those in connection with nonlinear Schr¨ odinge r equations, where one
needsLp-norm with general 1 < p <∞. Also from a harmonic analysis point of view the
proof of such bounds is a formidable problem, related to spectral m ultiplier theorems; see the
references above inthe case of a point singularity. Proving ananalo gue inthe present situation
of singularities along a hyperplane is an open problem.
2.Heat kernel bounds for Hardy operators
Notation. In the following, we omit the superscript ( α) in the notation for L(α)
λand write
merelyLλ≡L(α)
λwhen there is no danger of confusion.
Of fundamental importance for us are pointwise bounds on the hea t kernel ofLλ. We begin
with the case α<2.
Theorem 9. Letα∈(0,2)and letλ≥0. Letpbe deﬁned by (4). Then one has, for all
x,y∈Rd
+andt>0,
e−tLλ(x,y)∼/parenleftBig
1∧xd
t1/α/parenrightBigp/parenleftBig
1∧yd
t1/α/parenrightBigp
t−d
α/parenleftbigg
1∧t1/α
|x−y|/parenrightbiggd+α
. (9)
Let us give references for where this theorem is proved. For λ= 0 andα≤1 the bound
appears in [CK03]. (More precisely, [CK03] considers reﬂected proc esses, but for α≤1 this
coincides with the censored processes that we are interested in.) F orλ= 0 and 1 < α <2
the bound appears in [CKS10]. (More precisely, [CKS10] only has this b ound up to some
arbitrary, but ﬁxed time. However, by scaling invariance, once this bound is proved for any
given time, it follows for all times.) The case λ≥0 has been treated more recently and the
bound appears in [CKSV20]; see also [SWW22].
Our deﬁnition of the function p/ma√sto→C(p), which relates pand the coupling constant λ, is
seemingly diﬀerent from the one used in [CKSV20]. We show that it is not in Appendix A.
As we have already said in the introduction, the restriction λ≥0 in our main results is a
consequence of this restriction in Theorem 9. We expect that the la tter theorem, and therefore
also our main results, extend to the full range λ≥λ∗.
We now turn the case α= 2.
Theorem 10. Letα= 2and letλ≥ −1
4. Letpbe given by (4), that is, by (5). Then, for all
x,y∈Rd
+andt>0,
exp(−tLλ)(x,y)≍/parenleftbigg
1∧xd√
t/parenrightbiggp/parenleftbigg
1∧yd√
t/parenrightbiggp
t−d/2e−c|x−y|2/t, (10)
where the notation ≍means the same as ∼, but where the constants cin the exponential
function are allowed to be diﬀerent in the upper and the lower bounds.
While an explicit expression of the heat kernel of Lλforα= 2 is available, it leads to a
somewhat diﬀerent heat kernel bound and we explain in Appendix B ho w to obtain the bound
stated in Theorem 10, where one is willing to give up something in the con stantcin the
exponent, but insists on the product structure of the prefacto r.
3.Riesz kernel bounds
In this section we use the heat kernel bounds from the previous se ction to prove two-sided
bounds on the kernels of the Riesz operators L−s/2
λ. They are crucial for the proof of the
generalized Hardy inequality (Theorem 3).10 R. L. FRANK AND K. MERZ
Theorem 11. Letα∈(0,2]and letλ≥0whenα∈(0,2)andλ≥ −1/4whenα= 2. Letp
be deﬁned by (4)and lets∈(0,2d
α∧2(d+2p)
α). Then the following holds.
(a)For allx,y∈Rd
+with|x−y| ≤xd∨yd,
L−s/2
λ(x,y)∼d,α,λ,s|x−y|αs
2−d/parenleftbigg
1∧xd
|x−y|∧yd
|x−y|/parenrightbiggp
. (11)
(b)For allx,y∈Rd
+withxd∨yd≤ |x−y|,
L−s/2
λ(x,y)∼d,α,λ,s|x−y|αs
2−d/parenleftbiggxdyd
|x−y|2/parenrightbiggp
·/bracketleftBigg
1α=2
+/parenleftBigg
1p≤α
2(1+s
2)+/parenleftbigg
ln|x−y|
xd∨yd/parenrightbigg
1p=α
2(1+s
2)+/parenleftbigg|x−y|
xd∨yd/parenrightbigg2p−α(1+s
2)
1p>α
2(1+s
2)/parenrightBigg
1α<2/bracketrightBigg
.(12)
Remark 12.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the bound in (9)
withpdeﬁned by (4). Then (11) and (12) remain valid. Similarly, the upper ( resp. lower)
bound in (9) implies the upper (resp. lower) bound in (11) and (12). T his follows by the same
arguments as in the proof below.
Note that when α= 2 or when α <2 andp <α
2(1+s
2) the bound in the theorem can be
written as
L−s/2
λ(x,y)∼d,α,λ,s|x−y|αs
2−d/parenleftbigg
1∧xd
|x−y|/parenrightbiggp/parenleftbigg
1∧yd
|x−y|/parenrightbiggp
(13)
for allx,y∈Rd
+. This is reminiscent of the Riesz kernel bounds in [KVZ16, FMS21]. Re-
markably, a bound of this form does not hold globally when α<2 andp≥α
2(1+s
2), and in
the regionxd∨yd≤ |x−y|the Riesz kernel is larger than the right side in (13). This is a
consequence of the slow oﬀ-diagonal decay of the heat kernel in t he caseα<2. We will see in
the following sections that this worse behavior does not lead to addit ional restrictions in the
generalized Hardy inequality or the reverse Hardy inequality.
Proof.By the spectral theorem, the Riesz kernel can be represented a s
L−s/2
λ(x,y) =1
Γ(s/2)/integraldisplay∞
0e−tLλ(x,y)ts/2dt
t.
Inserting the two-sided bounds for e−tLλ(x,y) in (9) and (10) and changing variables, we see
that the left side of (11) is comparable to
/integraldisplay∞
0dt
tt−d
α+s
2/parenleftBig
1∧xd
t1/α/parenrightBigp/parenleftBig
1∧yd
t1/α/parenrightBigp/bracketleftbigg/parenleftbigg
1∧t1+d/α
|x−y|d+α/parenrightbigg
1α<2+exp/parenleftbigg
−c|x−y|2
t/parenrightbigg
1α=2/bracketrightbigg
=|x−y|αs
2−d/integraldisplay∞
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
×/parenleftbigg
1∧xdτ1/α
|x−y|/parenrightbiggp/parenleftbigg
1∧ydτ1/α
|x−y|/parenrightbiggp
for certainc>0, possibly diﬀerent for the upper and lower bounds. The integral is similar to
that in [KVZ16, Lemma 5.2] (or [FMS21, (2.3)], but with xdandydin place of |x|and|y|and
pin place of −δ). There are, however, some diﬀerences, in particular in the case α <2 and
p≥α
2(1+s
2), so we include the details of the bounds.HARDY OPERATORS IN A HALF-SPACE 11
We shall show that for all T,S >0 with|T−1
α−S−1
α| ≤1 we have
/integraldisplay∞
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧(τ/S)1/α/parenrightbigp
∼

/parenleftBig
1∧T−1
α∧S−1
α/parenrightBigp
ifT∧S≤1,
(TS)−p
α/bracketleftBig
1α=2
+/parenleftBig
1p≤α
2(1+s
2)+ln(T∧S)1p=α
2(1+s
2)+(T∧S)2p
α−1−s
2/parenrightBig
1α<2/bracketrightBigifT∧S≥1.
SettingT:= (|x−y|/xd)α,S:= (|x−y|/yd)α, we easily deduce from this the assertion. Note
that the bound |T−1
α−S−1
α| ≤1 comes from |xd−yd| ≤ |x−y|.
To prove the above assertion, by symmetry we may assume that S≤T.
CaseS≤T≤1. In this case we have S−1
α≤T−1
α+1≤2T−1
αand soS∼T. Thus, the
relevant integral is comparable to/integraldisplay∞
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbig2p,
and we claim that this is comparable to 1. Indeed,/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbig2p
=/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
∼1,
sinceT≤1 and since the integral converges at both zero (according to the assumptions
2<d
α)
and inﬁnity. For a lower bound we drop the integral between 0 and Tand for an upper bound,
we estimate it by
/integraldisplayT
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbig2p
≤/integraldisplayT
0dτ
ττ−1−s
2τd
α+1(τ/T)2p
α∼T−s
2+d
α≤1,
sinceαs
2<d∧(d+2p) ensures the convergence of the integral and the last inequality.
CaseS≤1≤T. In this case we have S−1
α≤T−1
α+1≤2 and soS∼1. Thus, the relevant
integral is comparable to/integraldisplay∞
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧τ1/α/parenrightbigp,
and we claim that this is comparable to T−p
α. Indeed, we have, usings
2<d+2p
α,
/integraldisplay1
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧τ1/α/parenrightbigp
∼T−p
α/integraldisplay1
0dτ
ττ−1−s
2τd
α+1τ2p
α∼T−p
α.
For a lower bound we drop the integral between 1 and ∞and for anupper bound, we estimate,
using 1+s
2−p
α>0 whenα<2 (as a consequence of s>0 andp<α),
/integraldisplayT
1dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧τ1/α/parenrightbigp
∼/integraldisplayT
1dτ
ττ−1−s
2/bracketleftBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
(τ/T)p
α/lessorsimilarT−p
α12 R. L. FRANK AND K. MERZ
and, using again 1+s
2−p
α≥0 whenα<2,
/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧τ1/α/parenrightbigp
=/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
∼T−1−s
21α<2+T−1−s
2+d
2e−cT1α=2/lessorsimilarT−p
α.
Case1≤S≤T. We split the relevant integral into three pieces, by cutting at Sand atT.
For the ﬁrst integral we ﬁnd, using s<2(d+2p)
α,
/integraldisplayS
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧(τ/S)1/α/parenrightbigp
= (ST)−p
α/integraldisplayS
0dτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
τ2p
α
∼(ST)−p
α/parenleftBig/parenleftBig
1p≤α
2(1+s
2)+(lnS)1p=α
2(1+s
2)+S2p
α−1−s
21p>α
2(1+s
2)/parenrightBig
1α<2+1α=2/parenrightBig
.
This term is of the claimed form. Thus, for a lower bound we can drop t he integral between
Sand∞.
We bound the second integral from above by
/integraldisplayT
Sdτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧(τ/S)1/α/parenrightbigp
=T−p
α/integraldisplayT
Sdτ
ττ−1−s
2/bracketleftBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
τp
α
/lessorsimilarT−p
α/parenleftBig
S−1−s
2+p
α1α<2+S−1−s
2+p
α+d
2e−cS1α=2/parenrightBig
.
Whenα<2 andp>α
2(1+s
2), thisupper boundequals thesize oftheﬁrst integral, andfor p≤
α
2(1+s
2) we bound T−p
αS−1−s
2+p
α≤(TS)−p
α. Whenα= 2, have clearly T−p
αS−1−s
2+p
α+d
2e−cS/lessorsimilar
(TS)−p
α.
We bound the third integral exactly as in the case S≤1≤Tand obtain
/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig/parenleftBig
1∧τd
α+1/parenrightBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig/parenleftbig
1∧(τ/T)1/α/parenrightbigp/parenleftbig
1∧(τ/S)1/α/parenrightbigp
=/integraldisplay∞
Tdτ
ττ−1−s
2/bracketleftBig
1α<2+τd
2+1e−cτ1α=2/bracketrightBig
∼T−1−s
21α<2+T−1−s
2+d
2e−cT1α=2.
Whenα<2 andp≤α
2(1+s
2), we bound
T−1−s
2≤(ST)−1
2(1+s
2)≤(ST)−p
α/parenleftBig
1p≤α
2(1+s
2)+(lnS)1p=α
2(1+s
2)/parenrightBig
and whenα<2 andp>α
2(1+s
2), we bound, recallingp
α<1+s
2,
T−1−s
2≤(ST)−p
αS2p
α−1−s
2.
Whenα= 2, we have p≥1
2>0 and therefore T−1−s
2+d
2e−cT/lessorsimilar(ST)−p
α. This completes the
proof. /square
4.Proof of the generalized Hardy inequality (Theorem 3)
We ﬁrst prove a theorem that is closely related to Theorem 3.HARDY OPERATORS IN A HALF-SPACE 13
Theorem 13. Letα∈(0,2]and letλ≥0whenα∈(0,2)andλ≥ −1/4whenα= 2. Letp
be deﬁned by (4). Then, ifs∈(0,1+2p
α∧2d
α), one has
/ba∇dblx−αs/2
dL−s/2
λg/ba∇dblL2(Rd
+)/lessorsimilard,α,λ,s/ba∇dblg/ba∇dblL2(Rd
+)for allg∈L2(Rd
+). (14)
Conversely, if (14)holds for some s∈(0,2d
α∧2(d+2p)
α), thens<1+2p
α.
Remark 14.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the bound in (9)
withpdeﬁned by (4). Then the assertions of Theorem 13 remain valid. Simila rly, the upper
(resp. lower) bound in (9) implies the suﬃciency (resp. necessity) o f the assumption s<1+2p
α
for the validity of (14). This follows by the same arguments as in the p roof below, taking into
account Remark 12.
The basic strategy of the proof is to use Theorem 11 in order to rep lace the operator L−s/2
λ
by one with a more explicit kernel.
Proof.We assume throughout that α,λandpare as in the statement of the theorem and that
s∈(0,2d
α∧2(d+2p)
α).
Necessity of the assumption s <1+2p
α.We consider a similar example as in [KMV+18,
p. 1283]. Let w= (0,0,...,2)∈Rd
+and 0≤ϕ∈C∞
c(Rd
+) withϕ≥1 inB1/2(w). We use part
(a) of Theorem 11. (More precisely, we also use part (b) to see tha t the bound in part (a) is
also valid for xd∨yd<|x−y| ≤2(xd∨yd).) This shows that, for x∈Rd
+with|x| ≤1, we
have
(L−s/2
λϕ)(x)≥/integraldisplay
Rd
+dy1|x−y|≤2ydL−s/2
λ(x,y)ϕ(y)
/greaterorsimilar/integraldisplay
Rd
+dy1|x−y|≤2yd1|y−w|≤1
2|x−y|αs
2−d/parenleftbigg
1∧xd
|x−y|∧yd
|x−y|/parenrightbiggp
/greaterorsimilarxp
d/integraldisplay
Rd
+dy1|x−y|≤2yd1|y−w|≤1
2/greaterorsimilarxp
d.
In the third inequality we used the fact that |x−y| ∼1 and 1∧xd
|x−y|∧yd
|x−y|∼xd
|x−y|on the
domain of integration. (Indeed, clearly,1
2≤ |x−y| ≤ |x|+|y−w|+|w| ≤7
2,xd≤1 and
yd≥3
2.) In the fourth inequality we used the fact that the inequality |x−y| ≤2ydis satisﬁed
for allywith|y−w| ≤1
2. (Indeed, |x−y| ≤ |x′−y′|+ (yd−xd)≤ |x′|+|y′|+yd, where
|x′| ≤ |x| ≤1≤2
3ydand|y′| ≤ |y−w| ≤1
2≤1
3yd.)
This allows us to bound
/ba∇dblx−αs
2
dL−s/2
λϕ/ba∇dblL2(Rd
+)≥ /ba∇dbl1|x|≤1x−αs
2
dL−s/2
λϕ/ba∇dblL2(Rd
+)/greaterorsimilar/ba∇dbl1|x|≤1xp−αs
2
d/ba∇dblL2(Rd
+).
Since the right side is inﬁnite if s≥1+2p
α, we see that the inequality s<1+2p
αis necessary for
the validity of (8).
Suﬃciency of the assumption s <1+2p
α.We shall prove the L2(Rd
+)-boundedness of the
operator with kernel x−αs
2
dL−s
2
λ(x,y). By the upper bounds in Theorem 11, it suﬃces to prove
theL2(Rd
+)-boundedness of the operator with kernel K(x,y), deﬁned to be x−αs
2
dtimes the
function appearing in the bounds in Theorem 11. We will divide Kinto four pieces supported
in essentially disjoint sets and show boundedness of the resulting fo ur operators. To that end
we perform Schur tests as in [KMV+18, Proposition 3.2] (with sin place ofαs
2andσin place
of−p). These Schur tests involve weights and the weights are chosen diﬀ erently for the four
diﬀerent pieces of K.14 R. L. FRANK AND K. MERZ
The four regions are deﬁned by |x−y| ≤4(xd∧yd), 4xd≤ |x−y| ≤4yd, 4yd≤ |x−y| ≤4xd
and 4(xd∨yd)≤ |x−y|. The factors of 4 will be convenient in some regions and we observe
that Theorem 11 as stated is equivalent to a variant of Theorem 11 w here the distinction
between parts (a) and (b) includes similar factors of 4.
Case|x−y| ≤4(xd∧yd).In this case we have 1 ∧xd
|x−y|∧yd
|x−y|∼1 and therefore the kernel
becomes
K(x,y)∼x−αs
2
d|x−y|αs
2−d.
For the ﬁrst half of the Schur test we bound/integraldisplay
|x−y|≤4(xd∧yd)x−αs
2
d|x−y|αs
2−ddy≤/integraldisplay
|x−y|≤4xdx−αs
2
d|x−y|αs
2−ddy/lessorsimilar1.
For the second half of the Schur test, we note that yd≤xd+|x−y| ≤xd+4(xd∧yd)≤5xd
and therefore x−αs
2
din the kernel can be replaced by y−αs
2
d. Therefore, the second half of the
Schur test is similar to the ﬁrst, and we deduce the L2(Rd
+)-boundedness of the piece of Kin
this region.
Case4xd≤ |x−y| ≤4yd.In this case, we have 1 ∧xd
|x−y|∧yd
|x−y|∼xd
|x−y|and therefore the
kernel becomes
K(x,y) =xp−αs
2
d|x−y|αs
2−d−p.
We perform a Schur test with weight
w(x,y) =/parenleftbiggxd
|x−y|/parenrightbiggβ
withαs
2−p<β <1+p−αs
2.
The assumption s<1+2p
αguarantees that one can ﬁnd such a β.
For the ﬁrst half of the Schur test we bound/integraldisplay
4xd≤|x−y|≤4ydw(x,y)K(x,y)dy/lessorsimilarx−αs
2+p+β
d/integraldisplay
|x−y|≥xd/4|x−y|αs
2−d−p−βdy/lessorsimilar1,
where the ﬁniteness of the integral comes from the choice of β. For the second half of the Schur
test we note that in our region we have |x−y| ≥yd−xd≥yd−|x−y|/4, so|x−y| ≥4yd/5.
We bound/integraldisplay
4xd≤|x−y|≤4ydw(x,y)−1K(x,y)dx
/lessorsimilar/integraldisplay
4yd/5≤|x−y|≤4ydx−αs
2+p−β
d|x−y|αs
2−d−p+βdx
=/integraldisplay
4/5≤|w|≤4(wd+1)−αs
2+p−β|w|αs
2−d−p+β1{wd>−1}dw<∞,
where we changed variables x−y=ydwand where the ﬁniteness of the integral comes from
the choice of β. We deduce the L2(Rd
+)-boundedness of the piece of Kin this region.
Case4yd≤ |x−y| ≤4xd.In this case, we have 1 ∧xd
|x−y|∧yd
|x−y|∼yd
|x−y|and therefore the
kernel becomes
K(x,y) =x−αs
2
dyp
d|x−y|αs
2−d−p.HARDY OPERATORS IN A HALF-SPACE 15
We perform a Schur test with weight
w(x,y) =/parenleftbigg|x−y|
yd/parenrightbiggγ
with−p<γ <1+p.
Sincep≥α−1
2>−1
2it is possible to ﬁnd such a γ.
Similarly as in the previous case (but with xandyinterchanged), we have |x−y| ≥4xd/5
and, in particular, yd≤xd∼ |x−y|. Therefore, for the ﬁrst half of the Schur test we bound
/integraldisplay
4yd≤|x−y|≤4xdw(x,y)K(x,y)dy/lessorsimilarx−d−p+γ
d/integraldisplay
4yd≤|x−y|≤4xdyp−γ
ddy
≤x−d−p+γ
d/integraldisplay
|x′−y′|≤4xd, yd≤xdyp−γ
ddy
=/integraldisplay
|w′|≤4,wd≤1wp−γ
ddw<∞,
where the ﬁniteness of the integral comes for the choice of γ. For the second half of the Schur
test we bound, using again xd∼ |x−y|,
/integraldisplay
4yd≤|x−y|≤4xdw(x,y)−1K(x,y)dx/lessorsimilaryp+γ
d/integraldisplay
|x−y|≥4yd|x−y|−d−p−γdx
=/integraldisplay
|w|≥4|w|−d−p−γdw<∞,
where the ﬁniteness of the integral comes from the choice of γ. We deduce the L2(Rd
+)-
boundedness of the piece of Kin this region.
Case4(xd∨yd)≤ |x−y|.In this region the kernel is
K(x,y) =x−αs
2
d|x−y|αs
2−d/parenleftbiggxdyd
|x−y|2/parenrightbiggp
·/bracketleftBigg
1α=2
+/parenleftBigg
1p≤α
2(1+s
2)+/parenleftbigg
ln|x−y|
xd∨yd/parenrightbigg
1p=α
2(1+s
2)+/parenleftbigg|x−y|
xd∨yd/parenrightbigg2p−α(1+s
2)
1p>α
2(1+s
2)/parenrightBigg
1α<2/bracketrightBigg
.
We perform a Schur test with weight
w(x,y) =/parenleftbiggxd
|x−y|/parenrightbiggβ/parenleftbigg|x−y|
yd/parenrightbiggγ
withαs
2−p<β <1+p−αs
2,−p<γ <1+p.
Whenα<2 andp>α
2(1+s
2), we also assume that
−1−α<β−γ <1+α.
A possible parameter choice that satisﬁes all the constraints is β=γ=1
2.
For the ﬁrst Schur test we bound/integraldisplay
4(xd∨yd)≤|x−y|w(x,y)K(x,y)dy=/summationdisplay
R∈2Z/integraldisplay
4(xd∨yd)≤|x−y|1R≤|x−y|<2Rw(x,y)K(x,y)dy
/lessorsimilar/summationdisplay
2xd<R∈2Z/integraldisplay
Rd
+1|x′−y′|<2R12yd<RwR(x,y)KR(x,y)dy,16 R. L. FRANK AND K. MERZ
wherewRandKRare deﬁned as wandK, but with |x−y|at each occurrence replaced by R.
For ﬁxedR∈2ZwithR>2xd, we carry out the y′-integration and, if α<2 andp=α
2(1+s
2),
we boundxd∨yd≥yd. In this way, we obtain
/integraldisplay
Rd
+1|x′−y′|<2R12yd<RwR(x,y)KR(x,y)dy/lessorsimilarx−αs
2+p+β
dRαs
2−2p−β+γ−1
×/integraldisplayR/2
0dydyp−γ
d·/bracketleftBigg
1α=2
+/parenleftBigg
1p≤α
2(1+s
2)+/parenleftbigg
lnR
yd/parenrightbigg
1p=α
2(1+s
2)+/parenleftbiggR
xd∨yd/parenrightbigg2p−α(1+s
2)
1p>α
2(1+s
2)/parenrightBigg
1α<2/bracketrightBigg
/lessorsimilarx−αs
2+p+β
dRαs
2−p−β+xα+β−γ+1
dR−α−β+γ−11p>α
2(1+s
2)1α<2.
Here the assumption p−γ >−1 guarantees the yd-integral to converge near zero. The
additional term in case α<2 andp>α
2(1+s
2) comes from the integral between 0 and xd.
Summing with respect to Rwe obtain
/summationdisplay
2xd<R∈2Z/parenleftBig
x−αs
2+p+β
dRαs
2−p−β+xα+β−γ+1
dR−α−β+γ−11p>α
2(1+s
2)1α<2/parenrightBig
∼1.
Here the assumptions β >αs
2−pandβ−γ >−1−αguarantee the convergence of the R-sum.
For the second Schur test we bound similarly
/integraldisplay
4(xd∨yd)≤|x−y|w(x,y)−1K(x,y)dx
=/summationdisplay
R∈2Z/integraldisplay
4(xd∨yd)≤|x−y|1R≤|x−y|<2Rw(x,y)−1K(x,y)dx
/lessorsimilar/summationdisplay
2yd<R∈2Z/integraldisplay
Rd
+1|x′−y′|<2R12xd<RwR(x,y)−1KR(x,y)dx.
For ﬁxedR∈2ZwithR>2yd, we carry out the x′-integration and, if p=α
2(1+s
2), we bound
xd∨yd≥xd. In this way, we obtain
/integraldisplay
Rd
+1|x′−y′|<2R12xd<RwR(x,y)−1KR(x,y)dx/lessorsimilaryp+γ
dRαs
2−2p+β−γ−1
×/integraldisplayR/2
0dxdx−αs
2+p−β
d·/bracketleftBigg
1α=2
+/parenleftBigg
1p≤α
2(1+s
2)+/parenleftbigg
lnR
xd/parenrightbigg
1p=α
2(1+s
2)+/parenleftbiggR
xd∨yd/parenrightbigg2p−α(1+s
2)
1p>α
2(1+s
2)/parenrightBigg
1α<2/bracketrightBigg
/lessorsimilaryp+γ
dR−p−γ+yα−β+γ+1
dR−α+β−γ−11p>α
2(1+s
2)1α<2.
Here the assumption β <1+p−αs
2guarantees the convergence of the xd-integral near zero.
The additional term in case α <2 andp >α
2(1+s
2) comes from the integral between 0 and
yd.
Summing with respect to Rwe obtain
/summationdisplay
2yd<R∈2Z/parenleftBig
yp+γ
dR−p−γ+yα−β+γ+1
dR−α+β−γ−11p>α
2(1+s
2)1α<2/parenrightBig
∼1.HARDY OPERATORS IN A HALF-SPACE 17
Here the assumptions γ >−pandβ−γ <1 +αguarantee the convergence of the R-sum.
This concludes the Schur test and we deduce the L2(Rd
+) boundedness of the piece of Kin
this last region. /square
To deduce Theorem 3 from Theorem 13 we need the following lemma.
Lemma 15. Letα,s∈(0,2]andλ≥λ∗. ThenC∞
c(Rd
+)⊂domLs/2
λ.
Proof.Since the domains are nested as sdecreases, it suﬃces to consider the case s= 2. The
caseα= 2 is classical, so we may assume α <2. Letf∈C∞
c(Rd
+). By deﬁnition of the
Friedrichs extension, we need to ﬁnd a g∈L2(Rd
+) such that
1
2A(d,−α)/integraldisplay/integraldisplay
Rd
+×Rd
+(u(x)−u(y))(f(x)−f(y))
|x−y|d+αdxdy+λ/integraldisplay
Rd
+u(x)f(x)
xα
ddx
=/integraldisplay
Rd
+u(x)g(x)dx
for allu∈C1
c(Rd
+). By polarizing the computation in Remark 7, identifying both fandu
with their extension by zero to Rd, we see that this is equivalent to
/integraldisplay
Rd(−∆)α/4u(x)(−∆)α/4f(x)dx+(λ−λ0)/integraldisplay
Rd
+u(x)f(x)
xα
ddx=/integraldisplay
Rd
+u(x)g(x)dx.
This holds with g:= ((−∆)α/2f)|Rd
++(λ−λ0)x−α
df. Indeed, the ﬁrst term belongs to L2(Rd
+)
since|ξ|α/hatwidef∈L2(Rd) and the second one since x−α
dis bounded on the support of f. This
completes the proof. /square
Proof of Theorem 3. For givenf∈C∞
c(Rd
+),g:=Ls/2
λf∈L2(Rd
+) by Lemma 15, so Theorem
3 follows from Theorem 13. /square
Remark16.The same proof, without invoking Lemma 15, shows that the genera lized Hardy
inequality (8) holds for all f∈domLs/2
λunder the assumptions of Theorem 3.
5.Difference of heat kernels
A key tool for the proof of the reversed Hardy inequality (Theore m 5) are bounds for the
diﬀerence between the heat kernels of L0andLλ, i.e.,
Kα
t(x,y) := e−tL0(x,y)−e−tLλ(x,y).
Givenα∈(0,2] andλ≥λ∗, letpbe deﬁned by (4) and set
q:= min{p,(α−1)+}.
We formulate our bounds in terms of the functions
Jα
t(x,y) :=/parenleftbig
1xd∨yd≤t1/α+1xd∨yd≥t1/α1|x−y|≥(xd∧yd)/2/parenrightbig/parenleftBig
1∧xd
t1/α/parenrightBigq/parenleftBig
1∧yd
t1/α/parenrightBigq
×t−d
α/bracketleftBigg/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
1α<2+exp/parenleftbigg
−c|x−y|2
t/parenrightbigg
1α=2/bracketrightBigg
and, with some appropriate constant c>0,
Mα
t(x,y) :=1xd∨yd≥t1/α1|x−y|≤(xd∧yd)/2
×t1−d
α
(xd∨yd)α/bracketleftBigg/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
1α<2+exp/parenleftbigg
−c|x−y|2
t/parenrightbigg
1α=2/bracketrightBigg
.18 R. L. FRANK AND K. MERZ
Theorem 17. Letα∈(0,2]and letλ≥0whenα∈(0,2)andλ≥ −1/4whenα= 2. Then,
for allx,y∈Rd
+andt>0, one has
|Kα
t(x,y)|/lessorsimilarJα
t(x,y)+Mα
t(x,y). (15)
Remark 18.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the upper bound
in (9) with pdeﬁned by (4). Then (15) remains valid. This follows by the same argu ments as
in the proof below.
Proof.We assume λ/\e}atio\slash= 0 without loss generality as the claim is trivial when λ= 0. By scaling,
it suﬃces to consider t= 1 and, by symmetry, it suﬃces to consider xd≤yd. We now drop
the subscript tinKα
t,Jα
t, andMα
t.
By the triangle inequality and the bounds (9) and (10), we obtain
|Kα(x,y)|/lessorsimilar/bracketleftBig
(1∧xd)p(1∧yd)p+(1∧xd)(α−1)+(1∧yd)(α−1)+/bracketrightBig
×/bracketleftBig/parenleftbig
1∧|x−y|−d−α/parenrightbig
1α<2+e−c|x−y|21α=2/bracketrightBig
.
For an upper bound we can replace both exponents pand (α−1)+byqand arrive at the
claimed bound in the regions where yd≤1 and where yd≥1 and|x−y| ≥xd/2.
In the following we concentrate on the region where yd≥1 and|x−y| ≤xd/2. Note that
in this region we have yd≤xd+|x−y| ≤(3/2)xd, soxd∼yd≥1.
By Duhamel’s formula, i.e.,
e−L0−e−Lλ=λ/integraldisplay1
0dse−(1−s)L0x−α
de−sLλ,
and the bounds (9) and (10), we conclude
|Kα(x,y)|/lessorsimilar/integraldisplay1
0ds/integraldisplay
Rd
+dz
zα
ds−d
α(1−s)−d
α/parenleftbigg
1∧zd
(1−s)1/α/parenrightbigg(α−1)+/parenleftBig
1∧zd
s1/α/parenrightBigp
×/bracketleftBigg/parenleftBigg
1∧(1−s)1+d
α
|x−z|d+α/parenrightBigg/parenleftBigg
1∧s1+d
α
|y−z|d+α/parenrightBigg
1α<2
+exp/parenleftbigg
−c/parenleftbigg|x−z|2
1−s+|y−z|2
s/parenrightbigg/parenrightbigg
1α=2/bracketrightbigg
.
Note that here we dropped the factors
/parenleftbigg
1∧xd
(1−s)1/α/parenrightbigg(α−1)+/parenleftBig
1∧yd
s1/α/parenrightBigp
∼1, (16)
sincexd∼yd≥1 ands∈[0,1].
We divide the zintegration at zd=xd/2, leading to the bound
|Kα(x,y)|/lessorsimilarkα
<(x,y)+kα
>(x,y)
with
kα
>(x,y) :=/integraldisplay1
0ds/integraldisplay
zd>xd/2dz
zα
ds−d
α(1−s)−d
α/parenleftbigg
1∧zd
(1−s)1/α/parenrightbigg(α−1)+/parenleftBig
1∧zd
s1/α/parenrightBigp
×/bracketleftBigg/parenleftBigg
1∧(1−s)1+d
α
|x−z|d+α/parenrightBigg/parenleftBigg
1∧s1+d
α
|y−z|d+α/parenrightBigg
1α<2
+exp/parenleftbigg
−c/parenleftbigg|x−z|2
1−s+|y−z|2
s/parenrightbigg/parenrightbigg
1α=2/bracketrightbigg
.HARDY OPERATORS IN A HALF-SPACE 19
and similarly for kα
<.
We discuss kα
<andkα
>separately and begin with the latter. We bound z−α
d/lessorsimilarx−α
d/lessorsimilary−α
d
and we bound
/parenleftBigg
1∧zd
(1−s)1
α/parenrightBigg(α−1)+/parenleftBig
1∧zd
s1/α/parenrightBigp
≤/parenleftBigg
1∧zd
(1−s)1
α/parenrightBiggq/parenleftBig
1∧zd
s1/α/parenrightBigq
.
Now we enlarge the zd-integration to all of (0 ,∞) and reinsert the trivial factors (16), but with
both exponents replaced by q. Noting that qis the exponent corresponding to the operator
L−λ−(whereλ−= (−λ)∨0), we conclude that
kα
>(x,y)/lessorsimilar1
yα
d/integraldisplay1
0ds/integraldisplay
Rd
+dze−(1−s)L−λ−(x,z)e−sL−λ−(z,y) =1
yα
d/integraldisplay1
0dse−L−λ−(x,y)
∼Mα(x,y),
where we used the semigroup property of exp( −sL−λ−) and the heat kernel bounds and we
dropped again trivial factors as in (16) (with exponents q).
It remains to deal with kα
<, where we integrate over zd< xd/2. We ﬁrst discuss the case
α<2. We begin by carrying out the z′-integration. Computations are simpliﬁed if we use the
fact that |xd−zd| ∼xdby the choice of the cut-oﬀ in the integral and similarly |yd−zd| ∼
yd∼xd(since|zd| ≤xd/2≤yd/2). Thus, |x−z| ∼ |x′−z′|+xdand|y−z| ∼ |y′−z′|+xd
and the integral to be computed is comparable to
/integraldisplay
Rd−1dz′/parenleftBigg
1∧(1−s)1+d
α
xd+α
d+|x′−z′|d+α/parenrightBigg/parenleftBigg
1∧s1+d
α
xd+α
d+|y′−z′|d+α/parenrightBigg
. (17)
We simplify the integrand, using s∈[0,1] andxd∼yd≥1,
1∧(1−s)1+d
α
xd+α
d+|x′−z′|d+α∼(1−s)1+d
α
xd+α
d+|x′−z′|d+α
and
1∧s1+d
α
xd+α
d+|y′−z′|d+α∼s1+d
α
xd+α
d+|y′−z′|d+α.
Using Lemma 22 we see that the integral (17) is comparable to
s1+d
α(1−s)1+d
αx−α−1
d
xd+α
d+|x′−y′|d+α.
For an upper bound, one can remove the term |x′−y′|in the denominator. Thus, we have
shown that
kα
<(x,y)/lessorsimilarx−d−2α−1
d/integraldisplay1
0ds/integraldisplayxd/2
0dzd
zα
ds(1−s)/parenleftbigg
1∧zd
(1−s)1/α/parenrightbigg(α−1)+/parenleftBig
1∧zd
s1/α/parenrightBigp
.
Next, we carry out the s-integration for ﬁxed zd∈[0,xd/2]. The integral coming from
s≤1/2 is
∼/integraldisplay1/2
0dss(1∧zd)(α−1)+/parenleftBig
1∧zd
s1/α/parenrightBigp
∼(1∧zd)(α−1)++p.
Here we used p<α. Similarly, the integral coming from s≥1/2 is
∼/integraldisplay1
1/2ds(1−s)/parenleftbigg
1∧zd
(1−s)1/α/parenrightbigg(α−1)+
(1∧zd)p∼(1∧zd)(α−1)++p.20 R. L. FRANK AND K. MERZ
This leads to the bound
kα
<(x,y)/lessorsimilarx−d−2α−1
d/integraldisplayxd/2
0dzd
zα
d(1∧zd)(α−1)++p
∼x−d−2α−1
d/parenleftbig
1α≥1+(ln(1+xd))1α=1+x1−α
d1α<1/parenrightbig
.
In the last computation, we used the fact that, if α≥1, thenp>0 (note that for α= 1, this
inequality is ensured by the assumption λ>λ∗= 0), and if α<1, thenp−α≥α−1
2−α>−1.
Finally, we note that, since xd/greaterorsimilar1,
x−d−2α−1
d/parenleftbig
1α≤1+(ln(1+xd))1α=1+x1−α
d1α<1/parenrightbig
/lessorsimilarx−α
d/parenleftbig
1∧x−d−α
d/parenrightbig
.
Sincexd∼ydandxd/2≥ |x−y|, we deduce that kα
<(x,y)/lessorsimilarMα(x,y) ifα<2.
It remains to treat the case α= 2. The argument is similar, but slightly simpler. The
z′-integral can be done explicitly, yielding
/integraldisplay
Rd−1dz′exp/parenleftbigg
−c/parenleftbigg|x−z|2
1−s+|y−z|2
s/parenrightbigg/parenrightbigg
= constsd−1
2(1−s)d−1
2exp/parenleftbigg
−c/parenleftbigg
|x′−y′|2+(xd−zd)2
1−s+(yd−zd)2
s/parenrightbigg/parenrightbigg
.
Fors∈[0,1] and allxd,yd,zd≥0 we bound
(xd−zd)2
1−s+(yd−zd)2
s≥(xd−zd)2+(yd−zd)2≥1
2(xd−yd)2.
Also, as before, using the restriction zd<xd/2 andyd≥xd,
(xd−zd)2
1−s+(yd−zd)2
s≥(xd−zd)2+(yd−zd)2/greaterorsimilarx2
d.
Combining these two bounds gives
exp/parenleftbigg
−c/parenleftbigg
|x′−y′|2+(xd−zd)2
1−s+(yd−zd)2
s/parenrightbigg/parenrightbigg
≤exp(−˜cx2
d)exp/parenleftBig
−c
4|x−y|2/parenrightBig
/lessorsimilarx−2
dexp/parenleftBig
−c
4|x−y|2/parenrightBig
=M2(x,y),
whereM2(x,y) is now deﬁned with cbeing one quarter of the constant in the heat kernel
bound. (Obviously, the bound on k2
>remains valid if cis decreased.)
Thus, to prove that k2
<(x,y)/lessorsimilarM2(x,y) it suﬃces to prove that
/integraldisplay1
0ds/integraldisplayxd/2
0dzd
z2
ds−1
2(1−s)−1
2/parenleftbigg
1∧zd
(1−s)1/2/parenrightbigg/parenleftBig
1∧zd
s1/2/parenrightBigp
/lessorsimilar1.
To prove this, we ﬁrst perform the s-integral for ﬁxed zd∈[0,xd/2] and ﬁnd
/integraldisplay1
0dss−1
2(1−s)−1
2/parenleftbigg
1∧zd
(1−s)1/2/parenrightbigg/parenleftBig
1∧zd
s1/2/parenrightBigp
∼(1∧zd)p+1/parenleftBig
1+ln(1+1
zd)/parenrightBig
1p≤1+(1∧zd)21p>1.
We omit the detail of this computation. Since the right side, multiplied b yz−2
d, is integrable
over (0,∞) (forp≤1, we usep>1/2>0), we obtain the claimed bound. /squareHARDY OPERATORS IN A HALF-SPACE 21
6.Proof of the reversed Hardy inequality (Theorem 5)
Proof of Theorem 5. Step 1. The assertion for s= 2 follows from Lλ−L0=λx−α
d. In the
following we assume 0 <s<2 andλ/\e}atio\slash= 0. By the spectral theorem, we have, for f∈C∞
c(Rd
+),
/parenleftBig
Ls/2
λ−Ls/2
0/parenrightBig
f=−1
Γ(−s/2)/integraldisplay∞
0dt
tt−s/2/parenleftbig
e−tL0−e−tLλ/parenrightbig
f
=−1
Γ(−s/2)/integraldisplay∞
0dt
tt−s/2/integraldisplay
Rd
+dyKα
t(·,y)f(y).
(HereweuseLemma15, which guaranteesthat C∞
c(Rd
+)⊂domLs/2
λ∩domLs/2
0.) Abbreviating
g(y) :=y−αs/2
d|f(y)|, it suﬃces to show that the right side of
/vextenddouble/vextenddouble/vextenddouble/parenleftBig
Ls/2
λ−Ls/2
0/parenrightBig
f/vextenddouble/vextenddouble/vextenddouble
L2(Rd
+)/lessorsimilar/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble/integraldisplay
Rd
+dy/integraldisplay∞
0dt
tt−s
2Kα
t(·,y)yαs
2
dg(y)/vextenddouble/vextenddouble/vextenddouble/vextenddouble/vextenddouble
L2(Rd
+)
is bounded by a multiple of /ba∇dblg/ba∇dblL2(Rd
+). By the pointwise bound of Theorem 17 it suﬃces to
show theL2(Rd
+)-boundedness of the operator associated to the kernel
/integraldisplay∞
0dtt−1−s/2(Jα
t(x,y)+Mα
t(x,y))yαs/2
d, x,y∈Rd
+, (18)
withMα
tandJα
tdeﬁned in the previous section. This L2(Rd
+)-boundedness will be shown in
the following two steps, which therefore will conclude the proof of T heorem 5.
Step 2.We begin with the kernel coming from the Mα
t-part of (18). As discussed in the
proof of Theorem 17, on the support of Mα
t(x,y) we havexd∼yd. Hence,
/integraldisplay∞
0dt
tt−s
2Mα
t(x,y)yαs
2
d∼/integraldisplay∞
0dt
tt−s
2Mα
t(x,y)(xdyd)αs
4.
This replaces the kernel by a symmetric one and we only have to perf orm a single Schur test
instead of two. We obtain
sup
x∈Rd
+/integraldisplay
Rd
+dy/integraldisplay∞
0dt
tt−s
2Mα
t(x,y)(xdyd)αs
4
/lessorsimilarsup
x∈Rd
+/integraldisplay
yd∼xddy/integraldisplay
t≤(xd∨yd)αdt
tt−s
2(xdyd)αs
4
×t1−d
α
(xd∨yd)α/bracketleftBigg/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
1α<2+exp/parenleftbigg
−c|x−y|2
t/parenrightbigg
1α=2/bracketrightBigg
/lessorsimilarsup
x∈Rd
+xαs
2−α
d/integraldisplay
yd∼xddy/integraldisplay
t/lessorsimilarxα
ddt
tt−s
2+1−d
α/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
.
We now interchange the order of integration and do the y-integral ﬁrst. We bound
/integraldisplay
yd∼xddy/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
≤/integraldisplay
Rddy/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
∼td
α.
Therefore, the supremum over x∈Rd
+above is /lessorsimilarsupx∈Rd
+xαs
2−α
d/integraltextCxα
d
0dtt−s
2<∞. Thus, the
Schur test implies the L2(Rd
+)-boundedness of the corresponding operator.22 R. L. FRANK AND K. MERZ
Step 3.We now study the kernel coming from the Jα
t-part of (18). Two preliminary steps
will simplifyourcomputations. First, if α= 2weboundexp/parenleftBig
−c|x−y|2
t/parenrightBig
/lessorsimilar1∧t1+d
α
|x−y|d+α. Second,
we replace each of the two factors (1 ∧...)qby (1∧...)−rwith
−r:=q∧0,
where we recall q= min{p,(α−1)+}. Thus,Jα
t≤˜Jα
twith
˜Jα
t(x,y) :=/parenleftbig
1xd∨yd≤t1/α+1xd∨yd≥t1/α1|x−y|≥(xd∧yd)/2/parenrightbig/parenleftBig
1∧xd
t1/α/parenrightBig−r/parenleftBig
1∧yd
t1/α/parenrightBig−r
×t−d
α/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
,
and it suﬃces to prove the assertion with ˜Jα
tinstead ofJα
t.
For that purpose we insert the cut-oﬀs 1xd∨yd≤t1/αand1xd∨yd≥t1/αand bound the two terms
separately. We have
/integraldisplay∞
0dtt−1−s
2˜Jα
t(x,y)1xd∨yd≤t1/αyαs
2
d
∼yαs
2
d(xdyd)−r/integraldisplay∞
(xd∨yd)αdtt−1−s
2+2r
α−d
α/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
/lessorsimilaryαs
2
d(xdyd)−r/bracketleftbig
(|x−y|∨xd∨yd)−αs
2+2r−d+1xd∨yd≤|x−y||x−y|−d−α(xd∨yd)2r+α−αs
2/bracketrightbig
.
The ﬁrst term here comes from the t-integral from ( |x−y| ∨xd∨yd)αto∞. This integral
converges since −s
2+2r
α−d
α<0. (Note that s >0 and 2r≤(1−α)+<1.) The second
term comes from an upper bound on the integral between ( xd∨yd)αand|x−y|α, in fact,
from an upper bound on the integral between 0 and |x−y|α. This integral converges since
−s
2+2r
α+1>0.
The above bound can be simpliﬁed since (using r≥0)
1xd∨yd≤|x−y||x−y|−d−α(xd∨yd)2r+α−αs
2≤(|x−y|∨xd∨yd)−αs
2+2r−d.
We now turn to the contribution to ˜Jα
tfrom{xd∨yd≥t1/α}. We have
/integraldisplay∞
0dtt−1−s
2˜Jα
t(x,y)1xd∨yd≥t1/αyαs
2
d
∼yαs
2
d/integraldisplay(xd∨yd)α
0dtt−1−s
2−d
α/parenleftBig
1∧xd∧yd
t1/α/parenrightBig−r/parenleftBigg
1∧t1+d
α
|x−y|d+α/parenrightBigg
1|x−y|≥(xd∧yd)/2
≤yαs
2
d|x−y|−d−α/integraldisplay(xd∨yd)α
0dtt−s
2/parenleftBig
1∧xd∧yd
t1/α/parenrightBig−r
1|x−y|≥(xd∧yd)/2
/lessorsimilaryαs
2
d|x−y|−d−α/bracketleftbig
(xd∧yd)α−αs
2+(xd∧yd)−r(xd∨yd)r+α−αs
2/bracketrightbig
1|x−y|≥(xd∧yd)/2.
The ﬁrst term here comes from the integral from 0 to ( xd∧yd)α. This converges since s<2.
The second term comes from an upper bound on the integral from ( xd∧yd)αto (xd∨yd)α, in
fact, from an upper bound on the integral between 0 and ( xd∨yd)α. This integral converges
since−s
2+r
α>−1.
The above bound can be simpliﬁed since (using r≥0)
(xd∧yd)α−αs
2≤(xd∧yd)−r(xd∨yd)r+α−αs
2.HARDY OPERATORS IN A HALF-SPACE 23
To summarize, we have shown that
/integraldisplay∞
0dtt−1−s
2˜Jα
t(x,y)yαs
2
d/lessorsimilaryαs
2
d(xdyd)−r(|x−y|∨xd∨yd)−αs
2+2r−d
+yαs
2
d|x−y|−d−α(xd∧yd)−r(xd∨yd)r+α−αs
21|x−y|≥(xd∧yd)/2.
We claim that this is
/lessorsimilar/parenleftbigg|x−y|∨xd∨yd√xdyd/parenrightbigg2r(|x−y|∨xd∨yd)α
(|x−y|∨(xd∧yd))d+α. (19)
Indeed, for the terms involving sthis follows from yd≤xd∨yd≤ |x−y|∨xd∨ydand for
those involving rit follows from r≥0 and
|x−y|∨xd∨yd√xdyd≥xd∨yd√xdyd=/radicalbiggxd∨yd
xd∧yd.
Moreover,
(|x−y|∨xd∨yd)−d≤(|x−y|∨xd∨yd)α
(|x−y|∨(xd∧yd))d+α,
and
|x−y|−d−α(xd∨yd)α−αs
21|x−y|≥(xd∧yd)/2/lessorsimilar(|x−y|∨xd∨yd)α−αs
2
(|x−y|∨(xd∧yd))d+α.
This proves that (19) is an upper bound on the quantity of interest . The claimed L2(Rd
+)-
boundedness now follows from Proposition 19 below, noting that r≤(1−α)+/2<1/2./square
Proposition 19. Letα>0and0≤r<1
2. Then the integral operator with integral kernel
/parenleftbigg|x−y|∨xd∨yd√xdyd/parenrightbigg2r(|x−y|∨xd∨yd)α
(|x−y|∨(xd∧yd))d+α
is bounded on L2(Rd
+).
Proof. Step 1. We denote the kernel in the proposition by k(x,y). As a preliminary step to
the main argument, let us carry out the integration over the Rd−1-variables. We claim that
/integraldisplay
Rd−1dy′k(x,y)/lessorsimilar/parenleftbiggxd∨yd√xdyd/parenrightbigg2r(xd∨yd)α
(|xd−yd|∨(xd∧yd))1+α. (20)
Note that the kernel on the right side is the kernel corresponding to the case d= 1 of the
proposition. (Indeed, one has |xd−yd| ≤xd∨yd, soxd∨yd=|xd−yd|∨xd∨yd.)
To prove (20), we distinguish between the regions where |x−y|≷xd∨yd. We ﬁnd
/integraldisplay
Rd−1dy′k(x,y)/lessorsimilar/parenleftbiggxd∨yd√xdyd/parenrightbigg2r/integraldisplay
|x′−y′|<xd∨yddy′ (xd∨yd)α
(|x′−y′|∨|xd−yd|∨(xd∧yd))d+α
+/integraldisplay
|x−y|>xd∨yddy′/parenleftbigg|x−y|√xdyd/parenrightbigg2r1
|x−y|d.(21)
In the ﬁrst integral we scale y′=x′+(|xd−yd|∨(xd∧yd))wand obtain
/parenleftbiggxd∨yd√xdyd/parenrightbigg2r/integraldisplay
|x′−y′|<xd∨yddy′ (xd∨yd)α
(|x′−y′|∨|xd−yd|∨(xd∧yd))d+α
=/parenleftbiggxd∨yd√xdyd/parenrightbigg2r(xd∨yd)α
(|xd−yd|∨(xd∧yd))1+α/integraldisplay
|w|<(xd∨yd)/(|xd−yd|∨(xd∧yd))dw
(|w|∨1)d+α.
Bounding the latter integral by a constant, we obtain a term of the form (20).24 R. L. FRANK AND K. MERZ
We turn now to the second integral in (21) and claim that
/integraldisplay
|x−y|>xd∨yddy′/parenleftbigg|x−y|√xdyd/parenrightbigg2r1
|x−y|d/lessorsimilar/parenleftbiggxd∨yd√xdyd/parenrightbigg2r1
xd∨yd. (22)
Since|xd−yd|∨(xd∧yd)≤xd∨yd, this will prove (20).
To prove (22) we ﬁrst restrict the integral to |x′−y′|>(xd∨yd)/2 and ﬁnd, changing
variablesy′=x′+|xd−yd|w,
/integraldisplay
|x′−y′|>(xd∨yd)/2dy′/parenleftbigg|x−y|√xdyd/parenrightbigg2r1
|x−y|d
=|xd−yd|2r−1
(xdyd)r/integraldisplay
|w|>(xd∨yd)/(2|xd−yd|)dw
(1+|w|2)(d−2r)/2
∼/parenleftbiggxd∨yd√xdyd/parenrightbigg2r
(xd∨yd)−1.
Here we used r<1
2. This bound is of the form (22).
It remains to compute the integral in (22) where the restriction |x−y|>xd∨ydis replaced
by|x′−y′| ≤(xd∨yd)/2. In the latter region we have
1
4(xd∨yd)2+|xd−yd|2≥ |x−y|2≥(xd∨yd)2,
and therefore |xd−yd|/greaterorsimilarxd∨yd. Clearly |xd−yd| ≤xd∨ydand therefore |x−y| ∼xd∨yd.
Thus,
/integraldisplay
2|x′−y′|≤xd∨yd<|x−y|dy′/parenleftbigg|x−y|√xdyd/parenrightbigg2r1
|x−y|d
∼/parenleftbiggxd∨yd√xdyd/parenrightbigg2r1
(xd∨yd)d/integraldisplay
2|x′−y′|≤xd∨yd<|x−y|dy′
/lessorsimilar/parenleftbiggxd∨yd√xdyd/parenrightbigg2r1
xd∨yd,
which is again of the form (22). This completes the proof of (20).
Step 2.We perform weighted Schur tests for the operator with kernel giv en by the right
side of (20). As weight we choose
w(x,y) =/parenleftbiggxd
yd/parenrightbiggβ
withr<β <1−r.
Sincer<1
2, it is possible to ﬁnd such a β.
For the ﬁrst part of the Schur test, we use (20) to bound
/integraldisplay
Rd
+dyw(x,y)k(x,y)∼/integraldisplay∞
0dyd/parenleftbiggxd
yd/parenrightbiggβ/parenleftbiggxd∨yd√xdyd/parenrightbigg2r(xd∨yd)α
(|xd−yd|∨(xd∧yd))1+α
=/integraldisplay∞
0dtt−β−r(1∨t)α+2r
(|1−t|∨(1∧t))1+α
∼/integraldisplay∞
0dtt−β−r(1∧t−1+2r)<∞.
The ﬁniteness of the last integral uses the assumptions r<β <1−r.HARDY OPERATORS IN A HALF-SPACE 25
For the second part of the Schur test, we note that, by symmetr y, (20) remains valid with
dy′replaced by dx′. Thus,
/integraldisplay
Rd
+dxw(x,y)−1k(x,y)∼/integraldisplay∞
0dxd/parenleftbiggyd
xd/parenrightbiggβ/parenleftbiggxd∨yd√xdyd/parenrightbigg2r(xd∨yd)α
(|xd−yd|∨(xd∧yd))1+α
=/integraldisplay∞
0dtt−β−r(1∨t)α+2r
(|1−t|∨(1∧t))1+α<∞,
as before. The L2(Rd
+)-boundedness therefore follows from the Schur test. /square
7.Commutator bounds
Throughout this section we assume that 0 <α<2. Our goal is to bound the commutators
[(−∆)α/2,ζ]v(x) =A(d,−α)/integraldisplay
Rdζ(x)−ζ(y)
|x−y|d+αv(y)dy
for functions vsupported in Rd
+. In general the integral on the right side does not converge
absolutely and should be understood as a principal value integral (w hose converges we will
follow from our results).
We will impose certain boundedness and decay assumptions on v, as well as, for α≥1, mild
regularity assumptions. The function ζis a cut-oﬀ function and we are interested in tracking
the dependence of the commutator on the size of the transition zo ne, whereζswitches from
zero to one.
Thissection issplit into threeparts, corresponding todiﬀerent cho ices ofthecut-oﬀfunction
ζ. In Subsection 7.1 we will consider a cut oﬀ at a large distance from th e origin, in Subsection
7.2 a cut oﬀ at a small distance from the boundary hyperplane, and in Subsection 7.3 the
combination of both.
The assumption on vwill always be of the form
|v(x)| ≤(1∧|x|−d−α)(1∧xd)pfor allx∈Rd
+ (23)
with a certain parameter p≥α−1
2. This bound is reminiscent of the heat kernel bound in
Theorem 9 and, in fact, in the next section we will use this theorem to verify (23) in our
application where v∈e−tLλC∞
c(Rd
+). There, the parameter pwill depend on λas in our main
result, but in this section pis an arbitrary parameter.
The additional regularity assumptions will be formulated in terms of t he following H¨ older
seminorms. For a function uon a set Ω and 0 <β≤2, we write
[u]Cβ(Ω):=/braceleftBigg
supx,y∈Ω|u(x)−u(y)|
|x−y|βif 0<β≤1,
supx,y∈Ω|∇u(x)−∇u(y)|
|x−y|β−1if 1<β≤2.(24)
Our assumption on vwill then read
[v]Cβ(Bℓx(x))≤(1∧|x|−d−α)(1∧xd)p−βfor allx∈Rd
+withℓx:= 1∧xd
2.(25)
We will always assume that β >α−1.
7.1.Radial cut-oﬀ. In this subsection we bound the term
I(x) :=/integraldisplay
Rdχ(x)−χ(y)
|x−y|d+αv(y)dy,
wherevissupportedin Rd
+. Concerning thefunction χweassumethat, foracertainparameter
R≥1,
0≤χ≤1, χ(x) = 1 if|x| ≤R, χ (x) = 0 if|x| ≥2R,|∇χ|/lessorsimilarR−1,(26)26 R. L. FRANK AND K. MERZ
as well as, if α≥1,
|D2χ|/lessorsimilarR−2. (27)
HereD2χdenotes the Hessian of χ.
Lemma 20. Let0<α<2. LetR≥1, assume that χsatisﬁes (26)and, ifα≥1also(27).
Letp≥α−1
2, assume that vsatisﬁes (23)and, ifα≥1, also(25)with someβ >α−1.
(a)Ifα<1, then
|I(x)|/lessorsimilar1|x|≤RR−d−2α+1|x|>R|x|−d−αfor allx∈Rd
+.
(b)Ifα≥1, then
|I(x)|/lessorsimilar1|x|≤RR−d−2α+1|x|>R|x|−d−α
+1|x|∼RR−d−α−1/parenleftBig
(1∧xd)−(p−α+1)−+1p=α−1ln1
1∧xd+1α=1lnR/parenrightBig
for allx∈Rd
+.
(c)In either case,
/ba∇dblI/ba∇dblL2(Rd
+)/lessorsimilarR−α−d/2.
In the formulation of (b) we recall the notation a−:= max{−a,0}.
Proof of Lemma 20. Case α<1. Step 1. We claim that
|I(x)|/lessorsimilar1|x|≤4R/integraldisplay
|y|>R1
|y|d+α|v(y)|dy+1|x|>R
21
|x|d+α/integraldisplay
|y|≤2R|v(y)|dy
+1R
2<|x|≤4R1
R/integraldisplay
R
4<|y|≤8R1
|x−y|d+α−1|v(y)|dy. (28)
To prove (28) we note that, if |x| ≤R
2, then
|I(x)|=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
|y|>R.../vextendsingle/vextendsingle/vextendsingle/vextendsingle/lessorsimilar/integraldisplay
|y|>R1
|y|d+α|v(y)|dy.
If|x|>4R, then
|I(x)|=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
|y|≤2R.../vextendsingle/vextendsingle/vextendsingle/vextendsingle/lessorsimilar/integraldisplay
|y|≤2R1
|x|d+α|v(y)|dy.
Finally, ifR
2<|x| ≤4R, then
|I(x)|/lessorsimilar/integraldisplay
|y|>8R1
|y|d+α|v(y)|dy+/integraldisplay
|y|≤R
41
|x|d+α|v(y)|dy
+1
R/integraldisplay
R
4<|y|≤8R1
|x−y|d+α−1|v(y)|dy,
where we used |χ(x)−χ(y)|/lessorsimilarR−1|x−y|, which follows from the gradient bound on χ.
Combining the above bounds, we obtain (28).
Step 2.We now insert the bounds on vinto the right side of (28). We clearly have
/integraldisplay
|y|≤2R(1∧|y|−d−α)(1∧yd)pdy/lessorsimilar1
and /integraldisplay
|y|>R1
|y|d+α(1∧|y|−d−α)(1∧yd)pdy/lessorsimilarR−d−2α.HARDY OPERATORS IN A HALF-SPACE 27
The last bound is clear if p≥0 (which is the only case relevant when λ≥0). Whenp<0 the
same bound is valid for the integral restricted to yd≥1. For the integral with the opposite
restriction is easily seen to be bounded by R−d−1−2α. (Note that in this integral one has
|y′| ∼ |y|.) Finally, ifR
2<|x| ≤4R, then, since α∈(0,1),
/integraldisplay
R
4<|y|≤8R1
|x−y|d+α−1(1∧|y|−d−α)(1∧yd)pdy
/lessorsimilarR−d−α/integraldisplay
R
4<|y|≤8R(1∧yd)p
|x−y|d+α−1dy/lessorsimilarR−d−2α+1.
Here, for an upper bound, we replace the integral over {R
4<|y| ≤8R}by the integral over
|x−y| ≤12R. Forp≥0 we can drop the factor (1 ∧yd)p. Forp <0 we argue similarly as
before by distinguishing the cases yd≤1 andyd>1.
This proves the claimed pointwise bound in (a). The L2-bound in (c) follows by a simple
integration. /square
It remains toprove Lemma 20 for α≥1. Wediscuss the ﬁrst part ofthe argument ingreater
generality since it will also be useful in the next subsection. We are int erested in bounding
/integraldisplay
Rdζ(x)−ζ(y)
|x−y|d+αv(y)dy,
whereζisC2andvis H¨ older continuous with some exponent β. In the setting of Lemma 20
we haveζ=χ.
We ﬁx a local length scale ℓx, depending on x∈Rd
+, and we decompose
/integraldisplay
Rd
+ζ(x)−ζ(y)
|x−y|d+αv(y)dy=/integraldisplay
|y−x|≤ℓxζ(x)−ζ(y)
|x−y|d+α(v(y)−v(x))dy
+v(x)/integraldisplay
|y−x|≤ℓxζ(x)−ζ(y)+∇ζ(x)·(y−x)
|x−y|d+αdy
+/integraldisplay
|y−x|>ℓxζ(x)−ζ(y)
|x−y|d+αv(y)dy.(29)
Note that because of the principal value we were free to introduce the term ∇ζ(x)·(y−x),
which contributes zero to the integral (because of oddness), bu t makes it converge absolutely.
We will always bound the ﬁrst term by
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
|y−x|≤ℓxζ(x)−ζ(y)
|x−y|d+α(v(y)−v(x))dy/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤[v]Cβ(Bℓx(x))[ζ]C1(Bℓx(x))/integraldisplay
|y−x|≤ℓxdy
|x−y|d+α−1−βdy
/lessorsimilar[v]Cβ(Bℓx(x))[ζ]C1(Bℓx(x))ℓ−α+1+β
x(30)
for someβ >α−1. Similarly, we will bound the second term by
/vextendsingle/vextendsingle/vextendsingle/vextendsinglev(x)/integraldisplay
|y−x|≤ℓxζ(x)−ζ(y)+∇ζ(x)·(y−x)
|x−y|d+αdy/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤ |v(x)|[ζ]C2(Bℓx(x))/integraldisplay
|y−x|≤ℓxdy
|x−y|d+α−2dy/lessorsimilar|v(x)|[ζ]C2(Bℓx(x))ℓ2−α
x.(31)
After these preliminaries we return to the proof of Lemma 20.28 R. L. FRANK AND K. MERZ
Proof of Lemma 20. Case α≥1.We apply the preceding discussion with ζ=χ. For the ﬁrst
term in (29) we use the bound (30) and note that [ χ]C1(Bℓx(x))vanishes unless |x| ∼R, in
which case it is /lessorsimilarR−1. This leads to a bound
1|x|∼R(1∧|x|−d−α)(1∧xd)p−α+1R−1.
Similarly, for the second term in (29) using the bound (31) we obtain
1|x|∼R(1∧|x|−d−α)(1∧xd)p−α+2R−2.
Since 1∧xd≤1≤R, this bound on the second term is smaller than the bound on the ﬁrst
term and can be ignored.
We now turn to the third term in (29),
/tildewideI(x) :=/integraldisplay
|y−x|>ℓxχ(x)−χ(y)
|x−y|d+αv(y)dy.
We claim that
/vextendsingle/vextendsingle/vextendsingle/tildewideI(x)/vextendsingle/vextendsingle/vextendsingle/lessorsimilar1|x|≤4R/integraldisplay
|y|>R1
|y|d+α|v(y)|dy+1|x|>R
21
|x|d+α/integraldisplay
|y|≤2R|v(y)|dy
+1R
2<|x|≤4R1
R/integraldisplay
R
4<|y|≤8R1|x−y|>ℓx
|x−y|d+α−1|v(y)|dy. (32)
This is proved in the exact same way as (28).
We now insert the bounds on vinto the right side of (32). The ﬁrst two terms are bounded
as in the case α <1. The bound for the third term in (32), however, is diﬀerent now, s ince
|x−y|−d−α+1is not locally integrable. We claim that
/integraldisplay
R
4<|y|≤8R1|x−y|>ℓx
|x−y|d+α−1|v(y)|dy
/lessorsimilarR−d−α/parenleftBig
(1∧xd)−(p−α+1)−+1p=α−1ln1
1∧xd+1α=1lnR/parenrightBig
.
Indeed, the factor of R−d−αcomes from one factor in the bound on v, so it suﬃces to prove
/integraldisplay
R
4<|y|≤8R1|x−y|>ℓx
|x−y|d+α−1(1∧yd)pdy
/lessorsimilar(1∧xd)−(p−α+1)−+1p=α−1ln1
1∧xd+1α=1lnR.
We split the y-integral according to whether yd>3 oryd≤3. Beginning with the former
case, we note that |x−y| ≥ |xd−yd|>1 ifxd≤2. Thus, for all xd>0,
/integraldisplay
R
4<|y|≤8R1|x−y|>ℓx1yd>3
|x−y|d+α−1(1∧yd)pdy/lessorsimilar/integraldisplay
R
4<|y|≤8R1|x−y|>1
|x−y|d+α−1dy
≤1+(lnR)1α=1.
Next, we consider the integral over yd≤3. Performing the y′-integration over all of Rd−1, we
obtain/integraldisplay
R
4<|y|≤8R1|x−y|>ℓx1yd≤3
|x−y|d+α−1(1∧yd)pdy
/lessorsimilar/integraldisplay
yd≤3yp
d
|x′−y′|d+α−1+|xd−yd|d+α−1+ℓd+α−1
xdy/lessorsimilar/integraldisplay3
0yp
d
|xd−yd|α+ℓα
xdydHARDY OPERATORS IN A HALF-SPACE 29
This integral is easily seen to be
/lessorsimilarx−α
d1xd>1+x−(p−α+1)−
d 1xd≤1+ln1
1∧xd1p=α−1.
(To prove this for xd≤3/2 we split the yd-integral at yd= 2xd.) This proves the claimed
bound.
Combining all these bounds, we obtainthe claimed pointwise boundon Iinstatement (b) of
Lemma 20. The L2-bound in (c) follows by integration. On easily veriﬁes that the ‘additio nal’
term (compared to the case α <1) is subdominant. Here we note that 2( p−α+ 1)>−1,
which makes the relevant xd-integral ﬁnite near the origin. /square
7.2.Boundary cut-oﬀ. In this subsection we bound the term
II(x) :=/integraldisplay
Rdθ(x)−θ(y)
|x−y|d+αv(y)dy.
As before, the function vwill be supported in Rd
+. Concerning the function θwe assume that,
for a certain parameter r≤1,
0≤θ≤1, θ(x) = 0 ifxd≤r, θ(x) = 1 ifxd≥2r,|∇θ|/lessorsimilarr−1,(33)
as well as, if α≥1 andd= 1,
|D2θ|/lessorsimilarr−2. (34)
Tosimplifymatters, weassumethat θisonlyafunctionofthelastcoordinate xdofx= (x′,xd).
Lemma 21. Let0< α <2. Letr≤1and assume that θsatisﬁes (33)and, ifα≥1and
d= 1, also(34). Letα−1
2≤p<α, assume that vsatisﬁes (23)and, ifα≥1andd= 1, also
(25)with someβ >α−1. Then
|II(x)|/lessorsimilar/parenleftbigg
rp−α∧rp+1
x1+α
d/parenrightbigg
(1+xd)1+α(1∧|x|−d−α)for allx∈Rd
+.
In particular
/ba∇dblII/ba∇dblL2(Rd
+)/lessorsimilarrp−α+1/2.
Proof of Lemma 21. Case d≥2ord≥1andα<1. Step 1. We claim that
|II(x)|/lessorsimilar1xd≤4r/integraldisplay
yd>r1
|x′−y′|d+α+yd+α
d|v(y)|dy (35)
+1xd>r
2/integraldisplay
yd≤2r1
|x′−y′|d+α+xd+α
d|v(y)|dy
+1r
2<xd≤4r1
r/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+α|v(y)|dy.
To prove (35) we argue in the same way as we did for (28). We note th at, ifxd≤r
2, then
|II(x)|=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
yd>r.../vextendsingle/vextendsingle/vextendsingle/vextendsingle/lessorsimilar/integraldisplay
yd>r1
|x′−y′|d+α+yd+α
d|v(y)|dy.
Ifxd>4r, then
|II(x)|=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/integraldisplay
yd≤2r.../vextendsingle/vextendsingle/vextendsingle/vextendsingle/lessorsimilar/integraldisplay
yd≤2r1
|x′−y′|d+α+xd+α
d|v(y)|dy.30 R. L. FRANK AND K. MERZ
Finally, ifr
2<xd≤4r, then
|II(x)|/lessorsimilar/integraldisplay
yd>8r1
|x′−y′|d+α+yd+α
d|v(y)|dy+/integraldisplay
yd≤r
41
|x′−y′|d+α+xd+α
d|v(y)|dy
+1
r/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+α|v(y)|dy,
where we used |θ(x)−θ(y)|/lessorsimilarr−1|xd−yd|, which follows from the gradient bound on θand
the fact that it only depends on the last coordinate. Combining the a bove bounds, we obtain
(35).
Step 2.We now insert the bounds on vinto the right side of (35). In the two integrals
with an upper bound on ydwe use 1 ∧|y|−d−α∼1∧|y′|−d−α. This allows us to compute the
yd-integral in the second integral. In this way, we obtain
|II(x)|/lessorsimilar1xd≤4r/integraldisplay
yd>r1
|x′−y′|d+α+yd+α
d(1∧|y|−d−α)(1∧yd)pdy
+1xd>r
2rp+1/integraldisplay
Rd−11
|x′−y′|d+α+xd+α
d(1∧|y′|−d−α)dy′
+1r
2<xd≤4rrp−1/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+α(1∧|y′|−d−α)dy. (36)
A straightforward computation shows that, ifr
2<xd≤4r, then
/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+αdyd∼r2
|x′−y′|d+α+xd+α
d. (37)
(Indeed, we substitute yd=xd+|x′−y′|tand note that the upper and lower bounds in the t
integral are of order r.) We note that (37) requires the assumption α <1 ifd= 1 (with the
convention that terms involving x′ory′are absent).
Ifwe substitute (37) into (36), we see that thethird termonther ight side of (36) isbounded
from above by a constant times the second term and can therefor e be dropped.
We now perform the y′integral in the ﬁrst and second integrals in (36) using Lemma 22
below. (We note that 1 ∧|y′|−d−α∼(1+|y′|d+α)−1and 1∧|y|−d−α∼((1+yd)d+α+|y′|d+α)−1.)
In this way, we obtain
|II(x)|/lessorsimilar1xd≤4r/integraldisplay
yd>ry−1−α
d
(1+yd)d+α+|x′|d+α(1∧yd)pdyd+1xd>r
2rp+1x−1−α
d(1+xd)1+α
(1+xd)d+α+|x′|d+α.
Finally, we compute
/integraldisplay
yd>ry−1−α
d
(1+yd)d+α+|x′|d+α(1∧yd)pdyd∼rp−α
1+|x′|d+α.
The dominant contribution comes from the integral over [ r,1] and we used p<α.
This yields the claimed pointwise bound. (Note that for xd≤4rwe have (1+ |x′|d+α)−1∼
1∧|x|−d−α.) TheL2-bound follows by simple integration. The dominant contribution come s
from thexd-integral over [0 ,1]. /square
Lemma 22. LetN≥1. Then for all β >0and alla,b∈RN,r,s>0,
/integraldisplay
RN(rs)βdx
(rN+β+|x−a|N+β)(sN+β+|x−b|N+β)/lessorsimilar(r+s)β
(r+s)N+β+|a−b|N+β.HARDY OPERATORS IN A HALF-SPACE 31
Proof of Lemma 22. By symmetry we may assume that r≤s. By translation and dilation,
we may and will assume b= 0 ands= 1. Thus, it suﬃces to show
/integraldisplay
RNrβdx
(rN+β+|x−a|N+β)(1+|x|N+β)/lessorsimilar(1+r)β
(1+r)N+β+|a|N+β. (38)
We distinguish between |a|≶(1+r).
Case|a| ≤(1+r).The right side of (38) is comparable to 1r<1+r−N1r≥1. Whenr <1,
we bound the left side of (38) from above by
rβ/integraldisplay
RNdx
rN+β+|x−a|N+β=/integraldisplay
RNdx
1+|x|N+β∼1.
Whenr≥1, we bound the left side of (38) from above by
rβ/integraldisplay
RNdx
rN+β(1+|x|N+β)∼r−N.
Case|a| ≥(1+r).The right side of (38) is comparable to (1+ r)β|a|−N−β. We bound the
left side of (38) from above by
/integraldisplay
RNrβ
(rN+β+|x−a|N+β)(1+|x|N+β)/parenleftBig
1|x|<|a|
2+1|a|
2≤|x|≤2|a|+1|x|≥2|a|/parenrightBig
dx
/lessorsimilarrβ/integraldisplay
RNdx
|a|N+β(1+|x|N+β)+/integraldisplay
RNrβ1|x|∈[|a|/2,2|a|]
(rN+β+|x−a|N+β)|x|−N−βdx
+rβ/integraldisplay
RNdx
|x|2N+2β1|x|≥2|a|
/lessorsimilarrβ|a|−N−β+|a|−N−βrβ/integraldisplay
RNdx
rN+β+|x|N+β+rβ|a|−N−2β/lessorsimilar1+rβ
|a|N+β.
This concludes the proof. /square
Proof of Lemma 21. Case d= 1andα≥1.In fact, we will argue for general d≥1, assuming
(25) and (34). We argue as in explained in the previous section aroun d (29), choosing ζ=θ.
For the ﬁrst term in (29) we use the bound (30) and note that [ θ]C1(Bℓx(x))vanishes unless
xd∼r, in which case it is of order r−1. This leads to a bound
1xd∼r(1∧|x|−d−α)(1∧xd)p−α+1r−1.
Similarly, for the second term in (29) we use the bound (31) and obta in
1xd∼r(1∧|x|−d−α)(1∧xd)p−α+2r−2.
Since 1∧xd∼rforxd∼r, the two bounds are of the same order.
We now turn to the third term in (29), which we denote by /tildewiderII(x). We claim that
/vextendsingle/vextendsingle/vextendsingle/tildewiderII(x)/vextendsingle/vextendsingle/vextendsingle/lessorsimilar1xd≤4r/integraldisplay
yd>r1
|x′−y′|d+α+yd+α
d|v(y)|dy
+1xd>r
2/integraldisplay
yd≤2r1
|x′−y′|d+α+xd+α
d|v(y)|dy
+1r
2<xd≤4r1
r/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+α|v(y)|dy. (39)
This is proved in the exact same way as (35).
We now insert the bounds on vinto the right side of (39). The ﬁrst two terms are bounded
as in the proof of Lemma 21. The bound for the third term, however , is diﬀerent now. Noting32 R. L. FRANK AND K. MERZ
that 1∧ |y|−d−α∼(1 +|y′|d+α)−1on the domain of integration, we arrive on the following
upper bound on the third term
1r
2<xd≤4rrp−1/integraldisplay
r
4<yd≤8r|xd−yd|
|x′−y′|d+α+|xd−yd|d+α1
|y′|d+α+1dy.
Computing the yd-integral using (37) and the the y′-integral using Lemma 22, we can bound
/lessorsimilar1r
2<xd≤4rrp+1/integraldisplay
Rd−11
|x′−y′|d+α+xd+α
d1
|y′|d+α+1dy′
/lessorsimilar1r
2<xd≤4rrp−α
1+|x′|d+α.
Combining all these bounds we obtain the claimed pointwise bound. The L2-bound follows as
before. /square
7.3.Combined cut-oﬀ. We now combine Lemmas 20 and 21.
Corollary 23. Let0<α<2. Let0<r≤1≤R<∞, assume that χandθsatisfy(26)and
(33)and, ifα≥1, also(27)and(34). Letα−1
2≤p<α, assume that vsatisﬁes (23)and, if
α≥1, also(25)with someβ >α−1. Then
/ba∇dbl[(−∆)α/2,χθ]v/ba∇dblL2(Rd
+)/lessorsimilarrp−α+1/2+R−α−d/2.
Proof.We decompose
1
A(d,−α)[(−∆)α/2,χθ]v(x) =θ(x)/integraldisplay
Rdχ(x)−χ(y)
|x−y|d+αv(y)dy+/integraldisplay
Rdθ(x)−θ(y)
|x−y|d+αχ(y)v(y)dy
and bound the L2-norms of the two terms on the right side separately. For the ﬁrst term we
can drop the term θ(x)∈[0,1] and apply Lemma 20. For the second term we apply Lemma
21, noting that the product χvsatisﬁes its assumptions. This is clear for α <1. Forα≥1
we use
[χv]Cβ(Br(a))
≤

/ba∇dblχ/ba∇dblL∞(Br(a))[v]Cβ(Br(a))+/ba∇dblv/ba∇dblL∞(Br(a))[χ]Cβ(Br(a)) ifβ≤1,
/ba∇dblχ/ba∇dblL∞(Br(a))[v]Cβ(Br(a))+/ba∇dbl∇v/ba∇dblL∞(Br(a))[χ]Cβ−1(Br(a))
+/ba∇dbl∇χ/ba∇dblL∞(Br(a))[v]Cβ−1(Br(a))+/ba∇dblv/ba∇dblL∞(Br(a))[χ]Cβ(Br(a))ifβ >1.
All factors involving χon the right side are /lessorsimilar1 by (26), (27) and R≥1. Moreover, we note
that ifvsatisﬁes (23) and (25) for some β=β0>0, then it satisﬁes (25) for any 0 <β <β 0.
We conclude that χvsatisﬁes (25) with the same βasvdoes. /square
8.Density of C∞
c(Rd
+)
Our goal in this section is to prove the following theorem. It will be the main ingredient to
prove the operator core property stated in Theorem 1.
Theorem 24. Letα∈(0,2]and letλ≥0whenα <2andλ≥ −1/4whenα= 2. Letp
be deﬁned by (4), and lets∈(0,2]. Assume that s <(1+2p)/α. Then for any f∈L2(Rd
+)
there is a sequence (ϕn)⊂C∞
c(Rd
+)such that
Ls/2
λϕn→finL2(Rd
+).
If, in addition f∈domL−s/2
λ, then the sequence can be chosen such that, in addition,
ϕn→L−s/2
λfinL2(Rd
+).HARDY OPERATORS IN A HALF-SPACE 33
Remark 25.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the upper bound
in (9) with pdeﬁned by (4). Then Theorem 24 remains valid for this value of λ. This follows
by the same arguments as in the proof below, since Lemma 26 remains valid for this value of
λ.
Our strategy of proof of this theorem uses some ideas of [KVZ16, Lemma 4.4]. The basic
strategy is to ﬁrst prove Theorem 24 for fof a special form, namely, f∈Ls/2
λe−tLλC∞
c(Rd
+)
for some 0 < t <∞. To do this, we will use the following pointwise bounds on functions in
e−tLλC∞
c(Rd
+). For the deﬁnition of the H¨ older seminorm see (24).
Lemma 26. Letα,λandpbe as in Theorem 24. Let 0< t <∞andψ∈e−tLλC∞
c(Rd
+).
Then, for all x∈Rd
+,
|ψ(x)|/lessorsimilar(1∧xd)p(1∧|x|−d−α), (40)
|Lλψ(x)|/lessorsimilar(1∧xd)p(1∧|x|−d−α), (41)
|(−∆)α/2ψ(x)|/lessorsimilar(1∧xd)p−α(1∧|x|−d−α), (42)
[ψ]Cβ(Bℓx(x))/lessorsimilar(1∧xd)p−β(1∧|x|−d−α)withℓx:= 1∧xd
2,0<β <α. (43)
We remark that for α= 2 the decay in these bounds can be greatly improved, but it is
convenient for us to have a uniﬁed statement.
Proof of Lemma 26. We writeψ=e−tLλk. The bound (40) follows immediately from The-
orems 9 and 10. For the bound (41) we write Lλψ=e−tLλLλk. Forα= 2 we have
Lλk∈C∞
c(Rd
+) and so the claimed bound follows again from Theorem 10. For 0 <α<2 one
easily veriﬁes that
|Lλk(x)|/lessorsimilar1∧|x|−d−α
and then one uses this bound and Theorem 9 to again deduce (41). W e omit the details of
this computation.
To prove (42) we recall the deﬁnition of λ0from Remark 7. As shown there, we have
(−∆)α/2=Lλ0on functions supported on Rd
+. Thus,
(−∆)α/2ψ=Lλψ−(λ−λ0)x−α
dψ.
Therefore (42) follows from (40) and (41).
Finally, to prove (43) we use Schauder estimates. These bounds st ate that for a function u
onRd, fora∈Rd,r>0 and for 0 <β <α, one has
[u]Cβ(Br/2(a))/lessorsimilarα,β,dr−β/ba∇dblu/ba∇dblL∞(B2r(a))+rα−β/ba∇dbl|·−a|−d−αu/ba∇dblL1(B2r(a)c)
+rα−β/ba∇dbl(−∆)α/2u/ba∇dblL∞(B2r(a)). (44)
Forα= 2 this bound is classical and can be deduced, for instance, from [GT 01, Theorem 3.9
and its proof]. (Indeed, in this case the term involving the norm on B2r(a)cis not needed.)
For 0<α<2 the bound appears, for instance, in [ROS14, Corollary 2.5].
We apply (44) with a=xandr= 2˜ℓxwith˜ℓx= 1∧xd
8. Using (40) and (42) we easily ﬁnd
that
˜ℓ−β
x/ba∇dblψ/ba∇dblL∞(B4˜ℓx(x))/lessorsimilar(1∧xd)p−β(1∧|x|−d−α),
˜ℓα−β
x/ba∇dbl(−∆)α/2ψ/ba∇dblL∞(B4˜ℓx(x))/lessorsimilar(1∧xd)p−β(1∧|x|−d−α).
Moreover, using (40) a computation whose details we omit shows tha t
˜ℓα−β
x/ba∇dbl|·−x|−d−αψ/ba∇dblL1(B4˜ℓx(x)c)/lessorsimilar(1∧xd)p−β(1∧|x|−d−α).34 R. L. FRANK AND K. MERZ
Inserting these bounds into (44) we obtain (43) with ˜ℓxinstead ofℓx. The bound with ℓx
follows by a simple covering argument, using for a given xthe bound in Bℓx(x) together with
the bounds in Bℓy(y) fory∈Bℓx(x)\B˜ℓx(x). /square
Proof of Theorem 24. Step 1. We ﬁrst prove this theorem for fof a special form, namely,
wheref∈Ls/2
λe−tLλC∞
c(Rd
+) for some 0 <t<∞.
Let 0< t <∞and letψ∈e−tLλC∞
c(Rd). For parameters 0 < r≤1≤R <∞to be
determined, we let χandθbe functions as in Corollary 23 and we abbreviate
ϕ:=χθψ.
Then, by (40),
/ba∇dblϕ−ψ/ba∇dblL2(Rd
+)≤ /ba∇dbl1xd≤2rψ/ba∇dblL2(Rd
+)+/ba∇dbl1|x|>Rψ/ba∇dblL2(Rd
+)/lessorsimilarrp+1/2+R−α−d/2.
Moreover,
/ba∇dblLλ(ϕ−ψ)/ba∇dblL2(Rd
+)=/ba∇dbl(1−χθ)Lλψ/ba∇dblL2(Rd
+)+/ba∇dbl[(−∆)α/2,χθ]ψ/ba∇dblL2(Rd
+)
and, by (41),
/ba∇dbl(1−χθ)Lλψ/ba∇dblL2(Rd
+)/lessorsimilarrp+1/2+R−α−d/2.
Forα<2 we apply Corollary 23 and ﬁnd
/ba∇dbl[(−∆)α/2,χθ]ψ/ba∇dblL2(Rd
+)/lessorsimilarrp−α+1/2+R−α−d/2.
The same bound holds for α= 2 as well, as follows by writing
[−∆,χθ]ψ=−2∇(χθ)·∇ψ−∆(χθ)ψ
and using the pointwise bounds (40) and (43). Thus, for all α≤2,
/ba∇dblLλ(ϕ−ψ)/ba∇dblL2(Rd
+)/lessorsimilarrp−α+1/2+R−α−d/2.
Since 0<s≤2 we have, by the spectral theorem,
/ba∇dblLs/2
λ(ϕ−ψ)/ba∇dblL2(Rd
+)≤ /ba∇dblϕ−ψ/ba∇dbl1−s/2
L2(Rd
+)/ba∇dblLλ(ϕ−ψ)/ba∇dbls/2
L2(Rd
+).
Inserting the above bounds, we conclude that
/ba∇dblLs/2
λ(ϕ−ψ)/ba∇dblL2(Rd
+)/lessorsimilarrp+1/2−αs/2+R−α−d/2.
Since, by assumption s<(1+2p)/α, this tends to zero as r→0 andR→ ∞. Note also that
/ba∇dblϕ−ψ/ba∇dblL2(Rd
+)tends to zero, proving the second assertion of the theorem for f=Ls/2
λψ.
Step 2.We now prove Theorem 24 in the general case.
Letf∈L2(Rd
+) andε >0. By the spectral theorem, we have e−tLλf→fast→0 and
e−tLλf→0 ast→ ∞. (The latter convergence uses the fact that 0 is not an eigenvalue of
Lλ.) Therefore, there are t1>0 such that /ba∇dble−t1Lλf−f/ba∇dblL2(Rd
+)≤εandt2<∞such that
/ba∇dble−t2Lλf/ba∇dblL2(Rd)≤ε. Then, with t:=t1/2 andT:=t2/2,
/ba∇dbl(e−2tLλ−e−2TLλ)f−f/ba∇dblL2(Rd
+)≤ /ba∇dble−t1Lλf−f/ba∇dblL2(Rd
+)+/ba∇dble−t2Lλf/ba∇dblL2(Rd)≤2ε.
SinceC∞
c(Rd
+) is dense in L2(Rd
+) and since L−s/2
λ(e−tLλ−e−TLλ) is bounded (since s∈[0,2]),
there is ak∈C∞
c(Rd
+) such that
/ba∇dblk−L−s/2
λ(e−tLλ−e−TLλ)f/ba∇dblL2(Rd
+)≤ε.
We deﬁneψ:= (e−tLλ+e−TLλ)kand write
e−2tLλ−e−2TLλ=Ls/2
λ(e−tLλ+e−TLλ)L−s/2
λ(e−tLλ−e−TLλ)HARDY OPERATORS IN A HALF-SPACE 35
to ﬁnd
/ba∇dblLs/2
λψ−f/ba∇dblL2(Rd
+)≤ /ba∇dblLs/2
λ(e−tLλ+e−TLλ)/ba∇dbl/ba∇dblk−L−s/2
λ(e−tLλ−e−TLλ)f/ba∇dblL2(Rd
+)
+/ba∇dbl(e−2tLλ−e−2TLλ)f−f/ba∇dblL2(Rd
+)
≤/parenleftBig
/ba∇dblLs/2
λ(e−tLλ+e−TLλ)/ba∇dbl+2/parenrightBig
ε.
According to Step 1 (applied both to Ls/2
λe−tLλkand toLs/2
λe−TLλk) there is a ϕ∈C∞
csuch
that
/ba∇dblLs/2
λϕ−Ls/2
λψ/ba∇dblL2(Rd
+)≤ε.
It follows that
/ba∇dblLs/2
λϕ−f/ba∇dblL2(Rd
+)≤/parenleftBig
/ba∇dblLs/2
λ(e−tLλ+e−TLλ)/ba∇dbl+3/parenrightBig
ε.
This proves the ﬁrst assertion of the theorem.
For the second assertion we assume that f∈domL−s/2
λ. Then we choose t1,t2∈(0,∞)such
that, in addition, we have /ba∇dble−t1LλL−s/2
λf−L−s/2
λf/ba∇dblL2(Rd
+)≤εand/ba∇dble−t2LλL−s/2
λf/ba∇dblL2(Rd
+)≤ε.
Then/ba∇dbl(e−2tLλ−e−2TLλ)L−s/2
λf−L−s/2
λf/ba∇dblL2(Rd
+)≤2ε. Moreover, by Step 1, we may assume,
in addition, that /ba∇dblϕ−ψ/ba∇dblL2(Rd
+)≤ε. From this one deduces, similarly as before,
/ba∇dblϕ−L−s/2
λf/ba∇dblL2(Rd
+)≤/parenleftbig
/ba∇dble−tLλ+e−TLλ/ba∇dbl+3/parenrightbig
ε,
which completes the proof of the theorem. /square
9.Proof of the main result
Proof of Theorem 1. We begin with the proof of (6) and (7) for functions u∈C∞
c(Rd
+). Using
just the triangle inequality, the claims are an immediate consequence of the usual Hardy
inequality, as well as its reversed and generalized versions in Theore ms 3 and 5. The argument
is as in [KMV+18, FMS21] and we omit the details.
We now extend (6) to all u∈domLs/2
λ. According to Theorem 24 (applied to f=Ls/2
λu)
there is a sequence ( ϕn)⊂C∞
c(Rd
+) such that ϕn→uinL2(Rd
+) andLs/2
λϕn→Ls/2
λuin
L2(Rd
+). It follows from inequality (6), applied to ϕn−ϕm, that (Ls/2
0ϕn) is Cauchy in L2(Rd
+)
and therefore convergent to some f∈L2(Rd
+). Since the operator Ls/2
0is closed, we conclude
thatu∈domLs/2
0andLs/2
0u=f. The claimed inequality (6) for unow follows by passing to
the limit in the inequality for ϕn.
The extension of (7) follows similarly. We only note that the pthat corresponds to λ= 0
is (α−1)+. Therefore the assumption s<(1+2(α−1)+)/αin Theorem 1 coincides with the
assumption in Theorem 24 (applied with λ= 0). /square
We now discuss optimality of the assumptions in Theorem 1.
Proposition 27. Letα∈(0,2]and letλ≥0whenα∈(0,2)andλ≥ −1/4whenα= 2. Let
pbe deﬁned by (4), and lets∈(0,2].
(1)Ifλ<0,p<d−1/2anddom(L(α)
λ)s/2⊂dom(L(α)
0)s/2, thens<(1+2p)/α.
(2)Ifλ>0,(α−1)+<d−1/2anddom(L(α)
0)s/2⊂(L(α)
0)s/2, thens<(1+2(α−1)+)/α.
Note that the ‘additional’ assumptions p<d−1/2 and (α−1)+<d−1/2 are automatically
satisﬁed when d≥2 or whend= 1 andα≤3/2.
Remark 28.Letα∈(0,2),λ∈[λ∗,0) and assume that e−tLλ(x,y) satisﬁes the lower bound
in (9) with pdeﬁned in (4). Then part (1) in Proposition 27 remains valid for this va lue ofλ.
This follows by the same arguments as in the proof below.36 R. L. FRANK AND K. MERZ
Proof.We prove part (1), the other part being proved similarly. We will prov e the theo-
rem under the additional assumption s <1+2(α−1)+
2∧2d
α. Note that the assumption λ <0
(which is equivalent to p<(α−1)+) and the assumption p<d−1/2 imply that the interval
[1+2p
α,1+2(α−1)+
2∧2d
α) is nonempty. Thus our proof will show that in this interval the inclu-
sion domLs/2
λ⊂domLs/2
0fails. By operator monotonicity of taking roots (see, e.g., [BS87,
Section 10.4]) it then follows that the inequality also fails for all s≥1+2(α−1)+
2∧2d
α.
Thus, assumethat s<1+2(α−1)+
2∧2d
α. Letu∈e−LλC∞
c(Rd
+). Thenu∈domLs/2
λ⊂domLs/2
0.
Applying Theorem 13 with λ= 0 andg=Ls/2
0u(here we need the upper bound on s) we infer
thatx−αs/2
du∈L2(Rd
+). Using the lower bound in Theorem 9 and arguing as in the necessity
part of the proof of Theorem 13 we deduce that s<(1+2p)/α, as claimed. /square
Appendix A.Definition of the exponent p
Throughout this appendix we assume α∈(0,2). Forp∈(−1,α), we set
γ(α,p) :=/integraldisplay1
0(tp−1)(1−tα−p−1)
(1−t)1+αdt.
The function Cis deﬁned in [CKSV20, Remark 3.3] for d= 1 by
(−1,α)∋p/ma√sto→C(p) :=A(1,−α)γ(α,p)
and in [CKSV20, Equation (3.4)] for d≥2 by
(−1,α)∋p/ma√sto→C(p) :=A(d,−α)|Sd−2|
2B/parenleftbiggα+1
2,d−1
2/parenrightbigg
γ(α,p)
with the beta function B. Let us show that that these deﬁnitions coincides with our deﬁnition
(3) and, in particular, that they are independent of d.
First, we recalling the formula for A(d,−α) from (2) and |Sd−2|=2πd−1
2
Γ(d−1
2)we ﬁnd
A(d,−α)|Sd−2|
2B/parenleftbiggα+1
2,d−1
2/parenrightbigg
=A(1,−α),
which already shows the independence of d. Thus, from now on d= 1. Moreover, by the
reﬂection and duplication formulas of the gamma function, we obtain
A(1,−α) =sinπα
2
πΓ(α+1). (45)
Next, according to [BD11, (2.2)] we have for α/\e}atio\slash= 1 andα>p> −1
γ(α,p) =1
α(α−1)[(p+1−α)(p+2−α)B(p+1,2−α)
−(1−α)(2−α)B(1,2−α)+p(p−1)B(α−p,2−α)].
Expressing the beta functions as gamma functions and using its fun ctional equation, we ﬁnd
γ(α,p) =1
α(α−1)/bracketleftbiggΓ(p+1)Γ(2−α)
Γ(p−α+1)−(1−α)+Γ(α−p)Γ(2−α)
Γ(−p)/bracketrightbigg
=1
α−Γ(1−α)
α/bracketleftbiggΓ(p+1)
Γ(p−α+1)+Γ(α−p)
Γ(−p)/bracketrightbigg
.(46)
Using the reﬂection formula for the gamma function, we obtain
Γ(p+1)
Γ(p−α+1)+Γ(α−p)
Γ(−p)=−1
πΓ(1+p)Γ(α−p)(sinπ(p−α)+sinπp).HARDY OPERATORS IN A HALF-SPACE 37
Inserting this into (46) and combining it with (45) we obtain
C(p) =sinπα
2
πΓ(α)+Γ(α)Γ(1−α)Γ(1+p)Γ(α−p)sinπα
2
π2(sinπ(p−α)+sinπp).
Theclaimedformula(3)nowfollowsfromΓ( α)Γ(1−α) =π/sin(πα)(bythereﬂectionformula)
and
sinπα
2
sinπα(sinπ(p−α)+sinπp) = sinπ(2p−α)
2.
Having established the equality between our deﬁnition of Cand that in [CKSV20], we can
use its properties established in [CKSV20, Subsection 3.1], namely, it s strict monotonicity on
[α−1
2,α), its divergence at p=αand its vanishing at p=α−1,0. Its symmetry with respect
top=α−1
2is immediate from (3).
Appendix B.Proof of Theorem 10
Throughout this section, we assume α= 2.
Step 1.By separation of variables, we have
e−tLλ(x,y) =et∆Rd−1(x′,y′)·e−t(−∆R++λx−2
d)(xd,yd).
Since the ﬁrst factor is equal to (4 πt)−d−1
2e−|x′−y′|2/4t, we see that the theorem in dimensions
d≥2 follows from its special case for d= 1. Thus, in what follows we consider the latter case.
Step 2.It is convenient to work with a unitarily equivalent version of Lλ. Namely for µ≥0
we consider the nonnegative quadratic form
/integraldisplay∞
0|u′|2r2µ+1dr
deﬁned for u∈C1
c(R+). By a theorem of Friedrichs this form gives rise to a selfadjoint,
nonnegative operator Lµin the Hilbert space L2(R+,r2µ+1dr). We note that functions uin
the operator domain of Lµare twice weakly diﬀerentiable and Lµu=−u′′−(2µ+1)r−1u′.
It is well-known that the operator Lµcan be diagonalized by a Hankel transform, which,
in particular, gives an integral formula for its heat kernel. The resu lting integral over Bessel
functions can be carried out using standard formulas and one arriv es at the explicit expression
e−tLµ(r,s) = (2t)−1/parenleftbigg1
rs/parenrightbiggµ
·exp/parenleftbigg
−r2+s2
4t/parenrightbigg
Iµ/parenleftBigrs
2t/parenrightBig
(47)
This formula appears, for instance, in [BS02, p. 75]. We emphasize th at this is the heat kernel
with respect to the underlying measure r2µ+1dr, that is
(e−tLµf)(r) =/integraldisplay∞
0e−tLµ(r,s)f(s)s2µ+1ds.
Using the facts that
lim
z→0z−µIµ(z) =2−µ
Γ(1+µ)and lim
z→∞z1
2e−zIµ(z) =1√
2π,
we immediately obtain from (47) that
e−tLµ(r,s)∼/parenleftBig
1∧r·s
t/parenrightBigµ+1
2/parenleftbigg1
rs/parenrightbiggµ+1
2
·t−1
2·exp/parenleftbigg
−(r−s)2
4t/parenrightbigg
. (48)38 R. L. FRANK AND K. MERZ
Next, we show that there is a 0 <c<1 such that for all r,s,t>0 one has
/parenleftbigg
1∧r√
t/parenrightbiggµ+1
2/parenleftbigg
1∧s√
t/parenrightbiggµ+1
2/parenleftbigg1
rs/parenrightbiggµ+1
2
·t−1
2·exp/parenleftbigg
−(r−s)2
4t/parenrightbigg
/lessorsimilare−tLµ(r,s)
/lessorsimilar/parenleftbigg
1∧r√
t/parenrightbiggµ+1
2/parenleftbigg
1∧s√
t/parenrightbiggµ+1
2/parenleftbigg1
rs/parenrightbiggµ+1
2
·t−1
2·exp/parenleftbigg
−c(r−s)2
4t/parenrightbigg
.(49)
In fact, we show that this holds for any 0 < c <1, but the constant that our proof gives for
the second “ /lessorsimilar” diverges as capproaches 1.
Note that (1 ∧r√
t)(1∧s√
t) and 1∧rs
tcoincide when either r,s≤√
torr,s≥√
tand that
the former is never larger than the latter for any r,s. In view of (48), this proves the ﬁrst “ /lessorsimilar”
in (49) and shows that we only need to prove the second “ /lessorsimilar” in the regions r≤√
t≤sand
s≤√
t≤r. By symmetry, it suﬃces to consider the former region. Moreover , by scaling, we
can suppose t= 1/4. We abbreviate p:=µ+ 1/2 and show that there is a 0 < c <1 such
that, for all r≤1/2≤s,
(1∧rs)pexp/parenleftbig
−(r−s)2/parenrightbig
/lessorsimilarrp·exp/parenleftbig
−c(r−s)2/parenrightbig
. (50)
This will clearly imply the second “ /lessorsimilar” in (49).
For the proof of (50) we distinguish between rs≤1 andrs≥1 and start with the former
case. Here we need to show
spexp(−(r−s)2)/lessorsimilarexp(−c(r−s)2).
This can be inferred by taking the p-th root and the inequalities s= (s−r)+r≤(s−r)+1/2.
The term corresponding to ( s−r) can be controlled by taking c<1 arbitrary. To prove (50)
whenrs≥1 we need to show
exp/parenleftbig
−(r−s)2/parenrightbig
/lessorsimilarrp·exp/parenleftbig
−c(r−s)2/parenrightbig
.
This can be inferred by multiplying by rp, taking the p-th root and the inequalities r−1≤s=
(s−r)+r≤(s−r)+1/2. As before, the term corresponding to ( s−r) can be controlled by
takingc<1 arbitrary. This completes the proof of (50).
Step 3.It remains to translate the result from the operator Lµto the operator Lλ. The
operatorU, deﬁned by ( Uf)(x) =xµ+1
2f(x), is unitary from L2(R+,r2µ+1dr) toL2(R+,dx).
It mapsC1
c(R+) into itself and, for a function ufrom this space, we ﬁnd by an integration by
parts/integraldisplay∞
0/parenleftbig
|(Uu)′(x)|2+(µ2−1
4)x−2|Uu(x)|2/parenrightbig
dx=/integraldisplay∞
0|u′(r)|2r2µ+1dr.
This implies that
U∗Lµ2−1/4U=Lµ
and, consequently, for all t,x,y>0,
e−tLµ2−1/4(x,y) = (xy)µ+1
2e−tLµ(x,y).
In view of (49) we obtain the assertion in Theorem 10. /squareHARDY OPERATORS IN A HALF-SPACE 39
References
[BBC03] Krzysztof Bogdan, Krzysztof Burdzy, and Zhen-Qing Ch en. Censored stable processes. Probab.
Theory Related Fields , 127(1):89–152, 2003.
[BD11] Krzysztof Bogdan and Bart/suppress lomiej Dyda. The best constan t in a fractional Hardy inequality. Math.
Nachr. , 284(5-6):629–638, 2011.
[BD23] The Anh Bui and Piero D’Ancona. Generalized Hardy operator s.Nonlinearity , 36(1):171–198,
2023.
[BN22] The Anh Bui and Georges Nader. Hardy spaces associated t o generalized Hardy operators and
applications. NoDEA Nonlinear Diﬀerential Equations Appl. , 29(4):Paper No. 40, 40, 2022.
[BS87] M. Sh. Birman and M. Z. Solomjak. Spectral Theory of Selfadjoint Operators in Hilbert Space .
Mathematics and its Applications (Soviet Series). D. Reidel Publishing Co., Dordrecht, 1987.
Translated from the 1980 Russian original by S. Khrushch¨ ev and V . Peller.
[BS02] Andrei N. Borodin and Paavo Salminen. Handbook of Brownian Motion — Facts and Formulae .
Probability and its Applications. Birkh¨ auser Verlag, Basel, second e dition, 2002.
[CK03] Zhen-Qing Chen and Takashi Kumagai. Heat kernel estimate s for stable-like processes on d-sets.
Stochastic Process. Appl. , 108(1):27–62, 2003.
[CKS10] Zhen-Qing Chen, Panki Kim, and Renming Song. Two-sided he at kernel estimates for censored
stable-like processes. Probab. Theory Related Fields , 146(3-4):361–399, 2010.
[CKSV20] Soobin Cho, Panki Kim, Renming Song, and Zoran Vondraˇ c ek. Factorization and estimates of
Dirichlet heat kernels for non-local operators with critical killings. J. Math. Pures Appl. (9) ,
143:208–256, 2020.
[FG16] Rupert L. Frank and Leander Geisinger. Reﬁned semiclassica l asymptotics for fractional powers of
the Laplace operator. J. Reine Angew. Math. , 712:1–37, 2016.
[FLS07] Rupert L. Frank, Elliott H. Lieb, and Robert Seiringer. Stab ility of relativistic matter with mag-
netic ﬁelds for nuclear charges up to the critical value. Comm. Math. Phys. , 275(2):479–489, 2007.
[FLS08] Rupert L. Frank, Elliott H. Lieb, and Robert Seiringer. Hard y-Lieb-Thirring inequalities for frac-
tional Schr¨ odinger operators. J. Amer. Math. Soc. , 21(4):925–950, 2008.
[FMS21] Rupert L. Frank, Konstantin Merz, and Heinz Siedentop. E quivalence of Sobolev norms involv-
ing generalized Hardy operators. International Mathematics Research Notices , 2021(3):2284–2303,
February 2021.
[FMS23a] Rupert L. Frank, Konstantin Merz, and Heinz Siedentop. Relativistic strong Scott conjecture: A
short proof. In B.-G. Englert, H. Siedentop, and M.-I. Trappe, ed itors,Density Functionals for
Many-Particle Systems: Mathematical Theory and Physical A pplications , volume 41 of Lecture
Notes Series, Institute of Mathematical Sciences, Nationa l University of Singapore , pages 69–79.
World Scientiﬁc, April 2023.
[FMS23b] Rupert L. Frank, Konstantin Merz, and Heinz Siedentop. The Scott conjecture for large Coulomb
systems: a review. Lett. Math. Phys. , 113(1):Paper No. 11, 2023.
[FMSS20] Rupert L. Frank, Konstantin Merz, Heinz Siedentop, and Barry Simon. Proof of the strong Scott
conjecture for Chandrasekhar atoms. Pure Appl. Funct. Anal. , 5(6):1319–1356, December 2020.
[FS08] Rupert L. Frank and Robert Seiringer. Non-linear ground st ate representations and sharp Hardy
inequalities. J. Funct. Anal. , 255(12):3407–3430, 2008.
[FS10] Rupert L. Frank and Robert Seiringer. Sharp fractional Ha rdy inequalities in half-spaces. In Around
the research of Vladimir Maz’ya. I , volume 11 of Int. Math. Ser. (N. Y.) , pages 161–167. Springer,
New York, 2010.
[GT01] David Gilbarg and Neil S. Trudinger. Elliptic Partial Diﬀerential Equations of Second Order .
Classics in Mathematics. Springer-Verlag, Berlin, 2001. Reprint of t he 1998 edition.
[Har19] G. H. Hardy. Notes on some points in the integral calculus LI : On Hilbert’s double-series theorem,
and some connected theorems concerning the convergence of inﬁ nite series and integrals. Messenger
of Mathematics , 48:107–112, 1919.
[Har20] G. H. Hardy. Note on a theorem of Hilbert. Mathematische Zeitschrift , 6(3–4):314–317, 1920.
[Her77] Ira W. Herbst. Spectral theory of the operator ( p2+m2)1/2−Ze2/r.Comm. Math. Phys. , 53:285–
294, 1977.40 R. L. FRANK AND K. MERZ
[JKS22a] Tomasz Jakubowski, Kamil Kaleta, and Karol Szczypkows ki. Bound states and heat ker-
nels for fractional-type Schr¨ odinger operators with singular pot entials.arXiv e-prints , page
arXiv:2208.00683, August 2022.
[JKS22b] Tomasz Jakubowski, Kamil Kaleta, and Karol Szczypkows ki. Relativistic stable operators with
critical potentials. arXiv e-prints , page arXiv:2208.00687, August 2022.
[KMP06] Alois Kufner, Lech Maligranda, and Lars-Erik Persson. The prehistory of the Hardy inequality.
Amer. Math. Monthly , 113(8):715–732, 2006.
[KMV+17] Rowan Killip, Changxing Miao, Monica Visan, Junyong Zhang, and Jiq iang Zheng. The energy-
critical NLS with inverse-square potential. Discrete Contin. Dyn. Syst. , 37(7):3831–3866, 2017.
[KMV+18] R. Killip, C. Miao, M. Visan, J. Zhang, and J. Zheng. Sobolev space s adapted to the Schr¨ odinger
operator with inverse-square potential. Math. Z. , 288(3-4):1273–1298, 2018.
[KMVZ17] Rowan Killip, Jason Murphy, Monica Visan, and Jiqiang Zheng. The focusing cubic NLS with
inverse-square potential in three space dimensions. Diﬀerential Integral Equations , 30(3-4):161–
206, 2017.
[KPS81] V. F. Kovalenko, M. A. Perelmuter, and Ya. A. Semenov. Sc hr¨ odinger operators with Ll/2
w(Rl)-
potentials. J. Math. Phys. , 22:1033–1044, 1981.
[KVZ16] Rowan Killip, Monica Visan, and Xiaoyi Zhang. Riesz transform s outside a convex obstacle. Int.
Math. Res. Not. IMRN , (19):5875–5921, 2016.
[Kwa11] Mateusz Kwa´ snicki. Spectral analysis of subordinate Bro wnian motions on the half-line. Studia
Math. , 206(3):211–271, 2011.
[Kwa19] Mateusz Kwa´ snicki. Fractional Laplace operator and its p roperties. In Handbook of fractional cal-
culus with applications. Vol. 1 , pages 159–193. De Gruyter, Berlin, 2019.
[Mer21] Konstantin Merz. On scales of Sobolev spaces associated t o generalized Hardy operators. Math.
Z., 299(1):101–121, 2021.
[Mer22] Konstantin Merz. On complex-time heat kernels of fraction al Schr¨ odinger operators via Phragm´ en-
Lindel¨ of principle. J. Evol. Equ. , 22(3):Paper No. 62, 30, 2022.
[OK90] B. Opic and A. Kufner. Hardy-type inequalities , volume 219 of Pitman Research Notes in Mathe-
matics Series . Longman Scientiﬁc & Technical, Harlow, 1990.
[ROS14] Xavier Ros-Oton and Joaquim Serra. The Dirichlet problem fo r the fractional Laplacian: regularity
up to the boundary. J. Math. Pures Appl. (9) , 101(3):275–302, 2014.
[SWW22] Renming Song, Peixue Wu, and Shukun Wu. Heat kernel estim ates for non-local operator with
multisingular critical killing. arXiv e-prints , page arXiv:2203.03891, March 2022.
[Yaf99] D. Yafaev. Sharp constants in the Hardy-Rellich inequalities .Journ. Functional Analysis ,
168(1):212–144, October 1999.
(Rupert L. Frank) Mathematisches Institut, Ludwig-Maximilans Universit ¨at M¨unchen, The-
resienstr. 39, 80333 M ¨unchen, Germany, and Munich Center for Quantum Science and T ech-
nology (MCQST), Schellingstr. 4, 80799 M ¨unchen, Germany, and Mathematics 253-37, Cal-
tech, Pasadena, CA 91125, USA
Email address :r.frank@lmu.de
(Konstantin Merz) Institut f ¨ur Analysis und Algebra, Technische Universit ¨at Braunschweig,
Universit ¨atsplatz 2, 38106 Braunschweig, Germany, and Department of Mathematics, Grad-
uate School of Science, Osaka University, Toyonaka, Osaka 5 60-0043, Japan
Email address :k.merz@tu-bs.de