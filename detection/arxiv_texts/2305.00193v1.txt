Optimal Control of Short-Time Attractors in Active Fluid Flows
Carlo Sinigaglia and Francesco Braghin
Politecnico di Milano, Department of Mechanical Engineering, 20156, Italy
Mattia Serra
University of California San Diego, Department of Physics, CA 92093, USA
(Dated: May 2, 2023)
Objective Eulerian Coherent Structures (OECSs) and instantaneous Lyapunov exponents (iLEs)
govern short-term material transport in uid ows as Lagrangian Coherent Structures and the
Finite-Time Lyapunov Exponent do over longer times. Attracting OECSs and iLEs reveal short-
time attractors and are computable from the Eulerian rate-of-strain tensor. Here we devise an
optimal control strategy to create short-time attractors in viscosity-dominated active uids. By
modulating the active stress intensity, our framework achieves a target prole of the minimum
eigenvalue of the rate-of-strain tensor, controlling the location and shape of short-time attractors.
We use numerical simulations to show that our optimal control strategy eectively achieves desired
short-time attractors while rejecting disturbances. Combining optimal control and recent advances
on coherent structures, our work oers a new perspective to steer material transport in unsteady
ows, with applications in synthetic active nematics and multicellular systems.
Large-scale coherent dynamics where global collec-
tive behaviors arise from local interactions, individual
anisotropies and activity are ubiquitous. Bird ocks,
bacterial swarms or ensembles of cells exhibit macro-
scopic patterns whose length scale is orders of magni-
tude larger than the individual size [1{14]. The macro-
scopic dynamics of these systems of active individuals
{or active matter{ exhibit nonstandard physical prop-
erties such as self-organization, symmetry breaking and
non-reciprocity [15{20]. There are several descriptions of
active matter systems [21], including agent-based models,
coarse-grained continuum models, and data-driven mod-
els [22]. Here we focus on hydrodynamic models, which
predict the macroscopic behavior of the system from a
small set of parameters and take the form of Partial Dif-
ferential Equations (PDEs) describing quantities such as
velocity, density and nematic tensor.
Besides studying the emergent properties of active
matter, it is natural to ask how one can control such
systems to steer their global dynamics. The main pos-
sibilities rely on distributed or boundary control tech-
niques [23]. Experimentally, [24] generated desired per-
sistent uid ows by regulating light patterns on a mix-
ture of optogenetically modied motor proteins and mi-
crotubule laments. Also controlling light, [25] achieved
spatiotemporal patterning of extensile active stresses in
microtubule-based active uids. By controlling an exter-
nal electric eld aecting cellular signaling networks, [26]
steered the collective motion of MDCK-II epithelial cells.
From a theoretical perspective, [27] propose a new frame-
work to steer topological defects {the localized singulari-
ties in the orientation of the active building blocks [3]{ by
controlling activity stress patterns. [28] devised an Opti-
mal Control Problem (OCP) to achieve a target nematic
director eld by controlling either an applied vorticity
mserra@ucsd.edueld in the nematic tensor dynamics or the active stress
magnitude in the velocity dynamics. Alternative control
strategies use surface anchoring at the boundaries and
substrate drag to rectify the coherent ow of an active
polar uid in a 2D channel [29].
Existing theoretical methods target a desired cong-
uration of the nematic director eld, topological defects
or uid velocities. While defects' dynamics drive large-
scale chaotic ow [32{34], they may not be enough to
predict spatiotemporal material transport. For instance,
[35] shows in experimental and numerical active nemat-
ics that the director eld alone cannot predict if dierent
domain regions will mix over a desired time interval or re-
main separated by a transport barrier, as well as predict
where transport barriers are. In fact, even the knowledge
of the velocity eld and typical streamline or vorticity
plots are sub-optimal to studying material transport in
unsteady ows, as shown in experimental and simulated
velocities [31, 36, 37] and Figure 1.
A natural framework to quantify material transport
is the concept of Coherent Structures (CSs), see e.g.
[36, 38, 39], which serve as the robust frame-invariant
skeletons shaping complex trajectory patterns. CSs in-
clude Lagrangian Coherent Structures (LCSs)[36] which
organize material transport over a nite time interval,
and their short-time limits called Objective Eulerian Co-
herent Structures (OECSs) [38, 40]. Attractors, their
domain of attraction and repellers are widespread CSs
in embryonic development across species [14, 41, 42] and
active nematics [35]. Controlling material transport in
active matter enables the modulation of spatial mixing
or trapping in synthetic systems but also enhances our
understanding and perhaps the ability to inuence mul-
ticellular ows in embryonic development.
Here, we consider the OCP of a simplied version of the
compressible active uid introduced in [41, 43] to describe
multi-cellular movements in vertebrate gastrulation. In
the hydrodynamic approximation, the system's states arearXiv:2305.00193v1  [physics.flu-dyn]  29 Apr 20232
FIG. 1. Example of short-time attractors in multicellular ows. The chicken embryo's epiblast contains 60;000 cells during
gastrulation, which occurs over 12 hours. Velocities are reconstructed using particle image velocimetry and Light Sheet
Microscopy [30]. The scale bar is 500 m, andt= 0 corresponds to the beginning of gastrulation. (a) Velocity eld v(x;520)
(black vectors) and (b) instantaneous Lyapunov Exponent eld s1(x;520) (colormap), consisting of the smallest eigenvalue of
the rate-of-strain tensor of v. The left inset in (b) shows the corresponding uorescence image, and AP denotes the Anterior-
Posterior axis of the embryo. Negative values of s1(x;520) mark short-time attractors, which are undetected by inspection
ofv(insets in a). To visualize the eect of short-term attractors, green dots in panel b mark the current t= 520 position
F520
475(x0) =x0+R520
475v(F
475;)dof short-time trajectories of v(x;t), starting at t= 475 from a uniform spatial conguration.
Within this short time (45 min= 12h6% of gastrulation time), trajectories accumulate on the s1(x;520) trench. See Fig. S2
for the same analysis at a dierent time. (c) Examples of asymptotic attracting structures in a steady velocity eld v(x) include
a sink xed point (red circle) and the unstable manifold (red curve) of a saddle xed point (black circle). These attracting
structures are stationary and anchored to a xed point of v(x). In unsteady ows v(x;t), these notions are unsuitable for
predicting material attraction: they produce false positives and false negatives [31]. By contrast, short-term attractors (d)
provide the correct material attraction locations, which can move and deform: the velocity is nonzero and nonconstant along
the short-term attractor (insets in panel a).
described by PDEs that couple the multicellular uid ve-
locity v, the orientational dynamics , which dictates the
anisotropy of the active stresses, and mwhich describes
the active stress intensity. We seek to control the loca-
tion and shape of short-time attractors marking regions
of material accumulation.
I. MATERIAL TRANSPORT
Long-term material transport is a fundamentally La-
grangian phenomenon, originally studied by keeping
track of the longer-term redistribution of individual trac-
ers released in the ow. In that setting, the Finite Time
Lyapunov Exponent (FTLE) and Lagrangian coherent
structures (LCSs) have been ecient predictors of tracer
behavior see e.g. [14, 35, 39, 44{46]. An alternative
to Lagrangian approaches is to nd their instantaneous
limits purely from Eulerian observations, thereby avoid-
ing the pitfalls of trajectory integration, while predicting
short-term material transport. Additionally, LCSs are
generally impractical to control { no literature exists {
because they are dened as nonlinear functions of uid
trajectories, which are themselves integrals of the Eule-
rian velocity v.
Short-time attractors { originally dened as Attract-
ing OECSs [31] { govern material transport in uid ows
over short-times, revealing critical information in chal-
lenging problems such as search and rescue operations at
sea [47] and oil-spill containment [48]. A simpler, more
controllable alternative to attracting OECSs for locat-
ing short-time attractors is the instantaneous LyapunovExponent (iLE)[49], dened as the instantaneous limit of
the well known FTLE. The iLE locates short-time attrac-
tors as trenches { or negative regions { of the smallest
eigenvalues1of the rate-of-strain tensor of the uid ve-
locity v. For example, Figs.1a-b show short-term attrac-
tors marked by trenches of s1(scalar eld) in an exper-
imental velocity eld (black vector eld) describing the
motion of thousands of cells during chick gastrulation
[30]. A strong trench of s1marks a short-term attrac-
tor along the anterior-posterior (AP) axis corresponding
to the forming primitive streak [14] (panel b), while re-
maining not identiable from the inspection of the cor-
responding velocity eld (panel a and its inset). Similar
results hold in dierent ows (see e.g., Fig. 1 of [31] and
Figs. 4-5 of [47]). To conrm the eect of short-term at-
tractors, panel b shows that tracers (green dots) released
from a uniform grid of initial conditions and advected by
v(x;t) for a short time accumulate on the s1trench.
Classical asymptotic attracting structures (Fig. 1c) in-
clude sink-type xed points (red dot) and the unstable
manifold (red curve) of saddle-type xed points of steady
velocity elds. These structures, however, cannot move
or deform in time and inuence material transport only
for steady velocity elds. As shown in Figs.1a-b, inspec-
tion and control of the velocity eld vis sub-optimal to
create material traps in general unsteady ows. First,
because the velocity eld and its streamlines are not ob-
jective, i.e., they depend on the choice of reference frame
used to describe motion (see also SM Section 6 and Figs.
S1-S2). By contrast, the location of material accumu-
lation is frame invariant [31, 44], as any quantication
of the material response of a deforming continuum must3
FIG. 2. Optimal solution of the nonlinear OCP generating short-time attractors. The target minimum eigenvalue z(x) is the
indicator function of a rectangle at the center of the domain. The optimal eigenvalue eld s?
1(x) is shown by the colormap.
Each row (a-b) corresponds to a dierent initialization time ( ti; i= 1;2). In each row, we visualize the eect of short-time
attractors by initializing a uniform set of uid tracers (yellow dots) at each tiand displaying their later positions integrating
v(x;t) over short times, as in Figs. 1b.
be according to a fundamental axiom of mechanics [50].
Second, it might be an unnecessarily strong requirement,
or uncompliant with boundary conditions, to prescribe
v(x;t) directly. On the other hand, short-time attractors
(Figs. 1b,d) are frame invariant, can move and deform,
and apply to general unsteady ows. Here we devise
an optimal control framework that uses the active stress
intensitymas the control input to achieve a target short-
time attractor, dened by a desired distribution of s1or
iLE, in active viscous ows.
II. ACTIVE FLUID MODEL
We adopt a simplied version of the mechanochemical
model developed in [41] consisting of an active stokes ow
characterized by the passive viscous stress v= pI+
2Sdand active stress a=m(B I=2), where Sdis the
deviatoric rate-of-strain tensor, B=e
echaracterizes
the orientation of active elements e= (cos() sin())>,
mdenotes the intensity of active stress and Ithe iden-
tity tensor. To account for ow compressibility, we use a
simple continuity equation rv=c( 2p p0m) where
positive isotropic viscous stress ( p > 0), and isotropic
contractile-type ( m> 0) active stress contribute to neg-
ative ow divergence via the bulk viscosity 1 =cand anondimensional parameter p0. Biologically, p0modulates
the cell propensity to ingress into the third dimension
given active isotropic apical contraction. The resulting
system of PDEs in nondimensional form [41] is
2p1v+r[rv] +g(m;) =0;
g(m;) =p1[2(Brm+mrB) + (p0 1)rm] =r(Am);
t=f1(v;);mt=f2(v;m);
wherep1=cis a second nondimensional parameter
characterizing the ratio of the shear to bulk viscosity,
andA= 2p1B+p1(p0 1)I. The rst two terms in the
force balance describe passive forces due to shear and
compressibility, while the active forces garise from spa-
tial variations of mand. To set up our optimal control
problem, we consider a simplied dynamics where the
orientation of active elements (x) is time-independent
and prescribed, while the active stress intensity m(x;t)
is the control input.
III. RESULTS
To control short-time attractors, the OCP involves
steering the minimum eigenvalue of the rate of strain
tensor towards a target function while minimizing the4
FIG. 3. Optimal control state pair ( m?;v?) and moving disturbance dassociated to the OCP described in Fig. 2. dand
v?are vector elds (arrows) with their magnitude also displayed in the colormap. The v?vectors are normalized to ease
visualization. Each row (a-b) corresponds to dierent initialization times tias Fig. 2. The velocity dynamics vare strongly
aected by the presence of the disturbance.
overall control eort and its gradient:
min
m;vJs=1
2Z

(s1 z)2d
 +
2Z


m2+krmk2
d
;
s:t: 2p1v r[rv] =g(m) +din 
v=0 on@
;
(1)
wherez(x) represents a scalar target for the minimum
eigenvalues1(x) of the rate-of-strain tensor Sofv, and
d(x;t) is a disturbance on the state dynamics.
Following a Lagrangian variational approach, we de-
rive a system of rst-order necessary optimality condi-
tions for the OCP problem. We note that Jsis nonlinear
and nonquadratic due to the relation s1(S(v)). Conse-
quently, suciency is not guaranteed, as typical in non-
convex problems. We dene the Lagrangian as
L=Js+Z


g(m) +d+ 2p1v+r[rv]
d
;
whereis the adjoint function, and obtain the strong
form of the optimality conditions by imposing the rst
variations of the Lagrangian to be zero for all allowed
variations of the state, adjoint and control functions. We
provide the complete derivation in the SM Sections 2-4,
and summarize here the necessary conditions as a cou-
pled system of PDEs. The optimal pair for the OCP (1)
(v; m) should satisfy the following system of rst-ordernecessary conditions
 2p1v r[rv] =g(m) +d in 
v=0 on@
 2p1 r[r] = r
(s1 z)1
1
in 
=0 on@
 m+m r:A= 0 in 
 ;
(2)
where1(x) is the eigenvector function associated to
s1(x). We note that (2) requires an iterative method due
to the nonlinear relationship between vand the forcing
term of the adjoint equation involving s1and1(x).
We numerically solve (2) using the Finite Element
Method (FEM) and a gradient-based algorithm (SM Sec.
5). We consider a circular domain with zero velocity
boundary conditions and note that our algorithm ap-
plies to arbitrary-shaped domains. We set the target
shapezas a scaled indicator function of a rectangle so
that the target value is  10 inside the rectangle and
zero elsewhere. We set the cable orientation to a con-
stant value =
4from the x-axis and choose the con-
trol weighting parameter = 10 6and the nondimen-
sional model parameters p0= 10; p1= 0:5.p1mod-
ulates the overall uid compressibility while high p0in-
duces high negative divergence in regions with higher m
[41]. We select the space-time varying disturbance force
asd(x;t) =de (r(t)
)2[ (y yc(t));x xc(t)], where
xc(t) = [ 0:5 +t;0:5],r(t) =jjx xc(t)jj, and set the
intensityd= 50, and standard deviation = 0:2. Fig-
ure 2 shows the resulting optimal s1along with a grid
of particles advected over short times for two dierent5
FIG. 4. Controlled and uncontrolled dynamics for a dierent spatiotemporal disturbance dcompared to Figs. 2-3. Each row
(a-b) corresponds to a dierent time ( ti; i= 1;2). The second column shows the s1(x) eld in the case of no control along
with uid tracers (yellow dots) advected for a short time interval of length 0 :025 by the uncontrolled v(x;t), starting from a
uniform initial grid at ti. The third and fourth columns show the same as the second one in the case of weak ( = 0:1) and
strong (= 10 6) control. Particles are advected under the optimal controlled velocity, whose corresponding s?
1(x) eld is in
the colormap. A higher results in worse control performance due to its increasing relative importance in the cost functional.
Here, d(x;t) =d(xc1(t)) d(xc2(t)), where xc1(t) = 0:5[cos(0:5t+);cos(0:5t+)];xc2(t) = 0:5[cos(0:5t);cos(0:5t)],
andd(xci(t)) = [ (y yci(t));(x xci(t))]500 exp(  ((x xci(t))2+ (y yci(t)2))=0:22.
initialization times.
Figure 3 shows the optimal state-control pair and its
associated disturbance forcing d. The control macts
through g(m) =r(Am), and therefore both mandrm
contribute to the state dynamics. This is why the con-
trol generates sharp gradients to track the target eigen-
value accurately. Furthermore, the control eld rejects
the disturbance by generating a vortex-shaped counter-
acting eect. Overall the disturbance strongly inuences
the optimal velocity. Figure 4 shows the interplay be-
tween the control weight , the disturbance dand the
accuracy of the tracking objective that is key to generat-
ing a short-time attractor. As in the earlier gures, each
row (a-b) corresponds to a dierent time ( ti; i= 1;2).
To present an additional test case, we select a dier-
ent disturbance compared to Figs. 2-3, generating two
vortex-shaped force-eld streamlines (Figure 4, rst col-
umn) using the same functional form in the previous test
case. The target eigenvalue zis the same as in Figs. 2-3.
The uncontrolled dynamics ( m= 0) does not generate at-
traction, as shown by short-term advected particles (yel-
low dots) and the s1(x) eld in Figure 4, second column.
A high= 0:1 (or weak control) steers the eigenvalue
towards the target, but its eect is too mild to generate
short-time attraction (Figure 4, third column). Indeed,
a higher control weight would result in a lower relevance
of the tracking term in the cost function and hence poor
tracking performances. Figure 4 fourth column shows theresults for a low = 10 6(or strong control), as in Fig-
ure 2, resulting in the desired short-time attractor that
serves as a material trap while rejecting disturbances.
Dierent rows (a-b) show the same results for two dier-
ent initialization times as in Figs. 2-3.
IV. CONCLUSION
By combining recent advances in coherent structures
from nonlinear dynamics, control theory and active mat-
ter, we formulated, analyzed and numerically solved an
optimal control problem that generates material short-
time attractors at desired locations while rejecting dis-
turbances. We used a simplied version of model [41] de-
scribing a compressible, viscosity-dominated, active uid
representing a planar multicellular ow, and used the
active stress intensity as the control input. We iden-
tify short-time attractors as the smallest instantaneous
Lyapunov exponent [49], the instantaneous limit of the
well-known FTLE, which is computable from the smallest
eigenvalue of the rate of strain tensor of the ow velocity.
Short-time attractors are frame invariant and predict
the correct location of material attraction, which may be
undetected from the inspection of the frame-dependent
velocity eld (Fig. 1, [31, 47]). Using the same frame-
work, one can control the position of material repellers,
which, together with attractors, shape complex motion6
in synthetic active matter [35] and embryo morphogen-
esis across species [14, 42]. Controlling attractors and
repellers oers a new, robust, and frame-invariant per-
spective to steer motion in synthetic and natural active
matter. It will enable the creation of material traps for
medical applications as well as enhance our understand-
ing and the possibility of manipulating multicellular ows
in morphogenesis. For example, it will shed light on how
myosin activity (active stress intensity) generates the re-
quired motion that compartmentalizes the embryo, segre-
gating distinct cell types (repellers) and steering specic
cells to precise locations (attractors). In future work, weplan to consider the explicit orientational dynamics of
the active stress anisotropy, the eect of inertial forces,
and the control of Lagrangian Coherent Structures that
shape uid motion over longer time scales.
ACKNOWLEDGMENTS
We acknowledge Alex Plum for his comments on the
manuscript.
[1] J. Toner and Y. Tu, Long-range order in a two-
dimensional dynamical XY model: How birds y to-
gether, Physical Review Letters 75, 4326 (1995).
[2] T. Vicsek and A. Zafeiris, Collective motion, Physics re-
ports 517, 71 (2012).
[3] M. C. Marchetti, J. F. Joanny, S. Ramaswamy, T. B.
Liverpool, J. Prost, M. Rao, and R. A. Simha, Hydrody-
namics of soft active matter, Rev. Mod. Phys. 85, 1143
(2013).
[4] K. Kruse, J. Joanny, F. J ulicher, J. Prost, and K. Seki-
moto, Asters, vortices, and rotating spirals in active gels
of polar laments, Physical review letters 92, 078101
(2004).
[5] M. Ballerini, N. Cabibbo, R. Candelier, A. Cavagna,
E. Cisbani, I. Giardina, V. Lecomte, A. Orlandi,
G. Parisi, A. Procaccini, et al. , Interaction ruling an-
imal collective behavior depends on topological rather
than metric distance: Evidence from a eld study, Pro-
ceedings of the national academy of sciences 105, 1232
(2008).
[6] H. Zhang, A. Ber, E. Florin, and H. Swinney, Collec-
tive motion and density uctuations in bacterial colonies,
Proceedings of the National Academy of Sciences 107,
13626 (2010).
[7] A. Bricard, J. Caussin, N. Desreumaux, O. Dauchot, and
D. Bartolo, Emergence of macroscopic directed motion in
populations of motile colloids, Nature 503, 95 (2013).
[8] C. Dombrowski, L. Cisneros, S. Chatkaew, R. Goldstein,
and J. Kessler, Self-concentration and large-scale coher-
ence in bacterial dynamics, Physical review letters 93,
098103 (2004).
[9] K. Copenhagen, R. Alert, N. S. Wingreen, and J. W.
Shaevitz, Topological defects promote layer formation in
myxococcus xanthus colonies, Nature Physics 17, 211
(2021).
[10] O. J. Meacock, A. Doostmohammadi, K. R. Foster, J. M.
Yeomans, and W. M. Durham, Bacteria solve the prob-
lem of crowding by moving slowly, Nature Physics 17,
205 (2021).
[11] P. Friedl and D. Gilmour, Collective cell migration in
morphogenesis, regeneration and cancer, Nature reviews
Molecular cell biology 10, 445 (2009).
[12] B. Ladoux and R. M ege, Mechanobiology of collective
cell behaviours, Nature Reviews Molecular Cell Biology
18, 743 (2017).
[13] A. Doostmohammadi, J. Ign es-Mullol, J. Yeomans, andF. Sagu es, Active nematics, Nature communications 9,
3246 (2018).
[14] M. Serra, S. Streichan, M. Chuai, C. J. Weijer, and
L. Mahadevan, Dynamic morphoskeletons in develop-
ment, Proceedings of the National Academy of Sciences
117, 11444 (2020).
[15] S. Ramaswamy, Active matter, Journal of Statistical Me-
chanics: Theory and Experiment 2017 , 054002 (2017).
[16] M. C. Marchetti, J. F. Joanny, S. Ramaswamy, T. B.
Liverpool, J. Prost, M. Rao, and R. A. Simha, Hydrody-
namics of soft active matter, Reviews of Modern Physics
85, 1143 (2013).
[17] J. Toner, Y. Tu, and S. Ramaswamy, Hydrodynamics and
phases of ocks, Annals of Physics 318, 170 (2005).
[18] M. Fruchart, R. Hanai, P. B. Littlewood, and V. Vitelli,
Non-reciprocal phase transitions, Nature 592, 363
(2021), arXiv:2003.13176.
[19] M. J. Bowick, N. Fakhri, M. C. Marchetti, and S. Ra-
maswamy, Symmetry, thermodynamics, and topology in
active matter, Physical Review X 12, 010501 (2022).
[20] S. Shankar, A. Souslov, M. J. Bowick, M. C. Marchetti,
and V. Vitelli, Topological active matter, Nature Reviews
Physics 4, 380 (2022).
[21] M. R. Shaebani, A. Wysocki, R. G. Winkler, G. Gomp-
per, and H. Rieger, Computational models for active mat-
ter, Nature Reviews Physics 2, 181 (2020).
[22] C. Joshi, S. Ray, L. M. Lemma, M. Varghese, G. Sharp,
Z. Dogic, A. Baskaran, and M. F. Hagan, Data-driven
discovery of active nematic hydrodynamics, Physical re-
view letters 129, 258001 (2022).
[23] A. Manzoni, S. Salsa, and A. Quarteroni, Optimal Con-
trol of Partial Dierential Equations, Analysis, Analysis,
Approximation and Applications (Springer, 2021).
[24] T. D. Ross, H. J. Lee, Z. Qu, R. A. Banks, R. Phillips,
and M. Thomson, Controlling organization and forces in
active matter through optically dened boundaries, Na-
ture572, 224 (2019).
[25] L. M. Lemma, M. Varghese, T. D. Ross, M. Thomson,
A. Baskaran, and Z. Dogic, Spatiotemporal patterning
of extensile active stresses in microtubule-based active
uids, arXiv preprint arXiv:2209.06277 (2022).
[26] D. J. Cohen, W. James Nelson, and M. M. Maharbiz,
Galvanotactic control of collective cell migration in ep-
ithelial monolayers, Nature materials 13, 409 (2014).
[27] S. Shankar, L. V. Scharrer, M. J. Bowick, and M. C.
Marchetti, Spatiotemporal control of active topological7
defects, arXiv preprint arXiv:2212.00666 (2022).
[28] M. M. Norton, P. Grover, M. F. Hagan, and S. Fraden,
Optimal control of active nematics, Physical review let-
ters125, 178005 (2020).
[29] P. Gulati, S. Shankar, and M. C. Marchetti, Bound-
aries control active channel ows, Frontiers in Physics
10, 10.3389/fphy.2022.948415 (2022).
[30] E. Rozbicki, M. Chuai, A. Karjalainen, F. Song, H. Sang,
R. Martin, H. Kn olker, M. MacDonald, and C. Weijer,
Myosin-II-mediated cell shape changes and cell interca-
lation contribute to primitive streak formation, Nat Cell
Biol17, 397 (2015).
[31] M. Serra and G. Haller, Objective eulerian coherent
structures, Chaos: An Interdisciplinary Journal of Non-
linear Science 26, 053110 (2016).
[32] L. Giomi, Geometry and topology of turbulence in active
nematics, Phys. Rev. X 5, 031003 (2015).
[33] S. Shankar and M. C. Marchetti, Hydrodynamics of ac-
tive defects: From order to chaos to defect ordering,
Phys. Rev. X 9, 041047 (2019).
[34] A. J. Tan, E. Roberts, S. A. Smith, U. A. Olvera,
J. Arteaga, S. Fortini, K. A. Mitchell, and L. S. Hirst,
Topological chaos in active nematics, Nature Physics 15,
1033 (2019).
[35] M. Serra, L. Lemma, L. Giomi, Z. Dogic, and L. Mahade-
van, Defect-mediated dynamics of coherent structures in
active nematics, arXiv preprint arXiv:2104.02196, to ap-
pear in Nature Physics (2023).
[36] G. Haller, Lagrangian coherent structures, Annual Rev.
Fluid. Mech 47, 137 (2015).
[37] M. Serra, P. Sathe, I. Rypina, A. Kirincich, S. D. Ross,
P. Lermusiaux, A. Allen, T. Peacock, and G. Haller,
Search and rescue at sea aided by hidden ow structures,
Nature Communications 11, 1 (2020).
[38] M. Serra and G. Haller, Objective Eulerian coherent
structures, Chaos 26, 053110 (2016).
[39] A. Hadjighasem, M. Farazmand, D. Blazevski, G. Froy-
land, and G. Haller, A critical comparison of Lagrangian
methods for coherent structure detection, Chaos 27,
053104 (2017).
[40] P. J. Nolan, M. Serra, and S. D. Ross, Finite-time lya-
punov exponents in the instantaneous limit and material
transport, Nonlinear Dynamics 100, 3825 (2020).
[41] M. Serra, G. S. N ajera, M. Chuai, V. Spandan, C. J. Wei-
jer, and L. Mahadevan, A mechanochemical model reca-
pitulates distinct vertebrate gastrulation modes, bioRxiv
(2021).
[42] M. Lange, A. Granados, S. VijayKumar, J. Bragan-
tini, S. Ancheta, S. Santhosh, M. Borja, H. Kobayashi,
E. McGeever, A. C. Solak, et al. , Zebrahub-multimodal
zebrash developmental atlas reveals the state transition
dynamics of late vertebrate pluripotent axial progenitors,
bioRxiv , 2023 (2023).
[43] M. Chuai, G. Serrano N ajera, M. Serra, L. Mahadevan,
and C. J. Weijer, Reconstruction of distinct vertebrate
gastrulation modes via modulation of key cell behav-
iors in the chick embryo, Science Advances 9, eabn5429
(2023).
[44] G. Haller, Lagrangian coherent structures, Annu. Rev.
Fluid Mech 47, 137 (2015).
[45] S. Shadden, F. Lekien, and J. E. Marsden, Denition and
properties of Lagrangian coherent structures from nite-
time Lyapunov exponents in two-dimensional aperiodic
ows, Physica D 212, 271 (2005).[46] M. Serra, P. Sathe, F. Beron-Vera, and H. G., Uncovering
the Edge of the Polar Vortex, J. Atmos. Sci. 74, 3871
(2017).
[47] M. Serra, P. Sathe, I. Rypina, A. Kirincich, S. D. Ross,
P. Lermusiaux, A. Allen, T. Peacock, and G. Haller,
Search and rescue at sea aided by hidden ow structures,
Nature communications 11, 1 (2020).
[48] R. Duran, T. Nordam, M. Serra, and C. H. Barker, Hor-
izontal transport in oil-spill modeling, in Marine Hydro-
carbon Spill Assessments (Elsevier, 2021) pp. 59{96.
[49] P. J. Nolan, M. Serra, and S. D. Ross, Finite-time Lya-
punov exponents in the instantaneous limit and mate-
rial transport, Nonlinear Dynamics 100, 3825 (2020),
arXiv:1904.06817.
[50] M. Gurtin, An introduction to continuum mechanics , Vol.
158 (Academic press, 1982).
[51] S. Salsa, Partial dierential equations in action: from
modelling to theory , Vol. 99 (Springer, 2016).
[52] R. A. Horn and C. R. Johnson, Matrix analysis (Cam-
bridge university press, 2012).
[53] D. Arndt, W. Bangerth, B. Blais, M. Fehling,
R. Gassm oller, T. Heister, L. Heltai, U. K ocher, M. Kro-
nbichler, M. Maier, P. Munch, J.-P. Pelteret, S. Proell,
K. Simon, B. Turcksin, D. Wells, and J. Zhang, The
deal.II library, version 9.3, Journal of Numerical Math-
ematics 29, 171 (2021).
[54] S. G. Johnson, The NLopt nonlinear-optimization pack-
age(2011).Supplementary material: Optimal Control of Short-Time Attractors in Active Fluid
Flows
Carlo Sinigaglia and Francesco Braghin
Politecnico di Milano, Department of Mechanical Engineering, 20156, Italy
Mattia Serra
University of California San Diego, Department of Physics, CA 92093, USA
(Dated: May 2, 2023)
S5. S1. NOTATION
We adopt a slightly dierent notation than the main
text to distinguish continuous functions and their associ-
ated numerical discretization. Continuous space-varying
functions are denoted with lowercase bold arrowed sym-
bols (i.e. v2H1
0(
)2) while their numerical discretiza-
tion as the standard bold vector v2RNwhereNis the
number of degrees of freedom of the Finite Element dis-
cretization. Furthermore, matrices arising from the nu-
merical discretization are denoted with uppercase letters
i.e.A2RNN.
S6. S2. ANALYSIS OF THE STATE DYNAMICS
In order to set up the problem in the proper setting
we need some basic notions from functional analysis, see
e.g. [51]. We denote L2(
)2the space of vector-valued
square integrable functions, that is ffjR

kfk2d
<1g
then,H1
0(
)2denotes the space of vector-valued square
integrable functions with zero trace and square integrable
gradient , that is ff2L2(
)2jR

krfk2
F<1andf@
=
0gwhileH 1(
)2denotes its dual, that is the space
of continuous linear functionals dened on H1
0(
)2. We
can now select the appropriate spaces for our problem.
The state dynamics v2H1
0(
)2while the control input
m2H1(
). In this setting, the control operator can be
dened as the linear operator g:H1(
)7!H 1(
)2.
The function g(m)2L2(
)2sincem2H1(
), as we
will prove in the following theorem on the well-posedness
of the state dynamics. The weak formulation of the state
dynamics reads: nd v2H1
0(
)2such that
Z


 2p1v r[rv]
d
 =Z

g(m)d
82H1
0(
)2, which can be rearranged in a more conve-
nient form using integration by parts and homogeneous
boundary conditions as
Z

2p1rv:r+ (rv)(r)d
 =Z

 mA:rd
mserra@ucsd.edu.82H1
0(
)2, where the operator : denotes the Frobe-
nius innner product of two matrices, that is A:B=
nX
inX
jAijBij. Note that the Frobenius inner product
induces a norm in the space of matrices that we denote
askAkF:=p
A:A, for more details, see e.g. [52]. Exis-
tence and uniqueness of solutions to this problem follow
from an application of the Lax-Milgram lemma of func-
tional analysis, see e.g. [51]. In particular, we can set the
state problem in abstract form by dening the symmetric
bilinear form a(v;) :=R

2p1rv:r+(rv)(r)d
and the linear functional Fm:=R

g(m)d
. In this
setting, we can prove the following result.
Proposition 1 There exists a unique weak solution vto
a(v;) =Fm82H1
0(
)2:
Furthermore, vdepends continuously on the control func-
tionmthat is
kvkH1
0(
)2pCp
2p1kmkH1(
)2
whereCpis the Poincar e constant depending only on 
and= maxfkr Ak2
L1(
);kAk2
L1(
)gdoes not de-
pend on vandm.
Proof The control operator gthat appears on the right-
hand side of the state equation can be bounded with
respect to the H1-norm of the control function mas
kgk2
L2(
)2k(rA)mk2
L2(
)2+kArmk2
L2(
)2
kr Ak2
L1(
)kmk2
L2(
)+kAk2
L1(
)krmk2
L2(
)
kmk2
H1(
)2
where= maxfkr Ak2
L1(
);Mg. Note that we have
used the triangle inequality and the operator bound on
the matrix Awhich is assumed to be suciently smooth.
Once this bound is established, we can prove existence
and uniqueness of a weak solution to the state equation
by showing that the hypotheses of Lax-Milgram lemma
are satised, that is the bilinear form is continuous and
coercive and the linear functional Fmis continuous with
respect to the H1
0(
)2-norm. Coerciveness can by proven9
as follows
a(v;v) =Z

2p1rv:rv+ (rv)(rv)d
Z

2p1rv:rvd
 = 2p1kvk2
H1
0(
)2
since, thanks to Poincar e inequality,qR

rv:rvd
 is
a norm in H1
0(
)2. Continuity of the linear functional
can be inferred by
jFm jkg(m)kL2(
)2k kL2(
)2
pCpkmkH1(
)2k kH1
0(
)2
using the bounds of the control operator gwith re-
spect to the norm of mand the Poincar e inequality, i.e.
k kL2(
)2Cpkr kL2(
)2=Cpk kH1
0(
)2. Continu-
ity of the state dynamics vwith respect to the control m
is proven by plugging in vas test function in the weak
formulation of the problem and using the coercivity of
the bilinear form. Indeed we have
2p1kvk2
H1
0(
)2a(v;v) =Fmv
pCpkmkH1(
)2kvkH1
0(
)2
from which we get
kvkH1
0(
)2pCp
2p1kmkH1(
)2:

S7. S3. ANALYSIS OF THE OPTIMAL
CONTROL PROBLEM
We have already established existence and uniqueness
of a solution to the state equation. It is left to prove
that the functional Jis weakly sequentially lower semi-
continous. The term of the cost functional involving the
controlmis trivially weakly lower semicontinuous since
it is theH1(
)-norm of the control function squared. We
will now prove that the rst term involving the eigenvalue
s1is continuous in vand thus weakly sequentially lower
semicontinuous.
Before deriving a system of rst-order necessary condi-
tions for optimality we prove well-posedness by showing
thats12L2(
), indeed
ks1k2
L2(
)=Z

s2
1d
Z

(s2
1+s2
2)d
Z

kS(v)k2
Fd
Z

krvk2
Fd
 =kvk2
H1
0(
)2(S3)
thanks to the inequalityPn
i=1s2
ikAk2
Finvolving the
eigenvalues of a matrix A. The second inequality comes
from the following reasoning, it holds that:
2S(v) :S(v) rv:rv=r(rv v (rv)v)+(rv)2Integrating over 
 and using the boundary conditions we
get
Z

kS(v)k2
Fd
 =1
2Z

krvk2
Fd
 +Z

(rv)2d

Z

krvk2
Fd
 (S4)
since (rv)2= (Tr(rv))2krvk2
F.
We denote Js[v] :=R

(s1 z)2d
 and show that
jJs[vn] Js[v]j ! 0 as vn!v. We also denote
s1;n:=s1(vn) ands1:=s1(v) to ease the notation. Note
also thatJs[v] =R

(s1 z)2d
 = (s1 z;s1 z)L2(
)=
ks1 zk2
L2(
)can be seen either as a scalar product in
L2(
) or as a tracking type cost functional involving the
norm ofs1 z, which is well-posed since s12L2(
).
Indeed, we can write
Js[vn] Js[v] = (s1;n z;s1;n z)L2(
) (S5)
 (s1 z;s1 z)L2(
)
= (s1;n;s1;n)L2(
) (s1;s1)L2(
)
 2(s1;n s1;z)L2(
)(s1;n;s1)L2(
)
= (s1;n;s1;n s1)L2(
)+ (s1;s1;n s1) 2(s1;n s1;z)
ks1;nkL2(
)ks1;n s1kL2(
)(S6)
+ks1kL2(
)ks1;n s1kL2(
)
+2kzkL2(
)ks1;n s1kL2(
)
=
ks1;nkL2(
)+ks1kL2(
)+ 2kzkL2(
)
ks1;n s1kL2(
)
=Cks1;n s1kL2(
)
where we have used the properties of the inner product
and the Cauchy-Schwarz inequality in L2(
). Note that
the constant C:=
ks1;nk+ks1k+2kzk
is well-dened
and nite since s1;n;s1;z2L2(
). Now, if we can prove
thatks1;n s1kL2(
)Lkvn vkH1
0(
)2for some con-
stantL>0,the result follows. In proving that this indeed
holds we need a theorem from eigenvalues perturbation
analysis from [52], Chapter 6, Corollary 6.3.8 that we
state here. If AandEare symmetric matrices, denoting
^sthe eigenvalues of A+Eand bysthe eigenvalues of A
it holds thatPn
i=1j^si sij2kEk2
F. We can write
ks1;n s1k2
L2(
)=Z

(s1;n s1)2d
 (S7)
Z

kS(vn) S(v)k2
Fd
 =Z

kS(vn v)k2
Fd
Z

kr(vn v)k2
Fd
 =kvn vk2
H1
0(
)2
where in applying Corollary 6.3.8 we set A=S(v(x))
andE=S(vn(x)) S(v(x)) which are both symmetric.10
S8. S4. DERIVATION OF THE OPTIMALITY
SYSTEM
The Gateaux derivative of Lcomputed at vin the direc-
tion can be written as:
L0(v) =@
@
=01
2Z

(s1(S(v+ )) z)2d
 (S8)
+Z


2p1(v+ ) +r[r(v+ )]
d

:
In the following we will need the dierentiation formula
for a non repeated eigenvalue with respect to a sym-
metric matrix function A() parametrized with respect
to a scalar 2R, see e.g. [52], Theorem 6.3.12, Chapter
6. Indeed, we haved
d
=0=(0)>dA
d
=0(0) where
is the associated normalized eigenvector.
The rst term in (S8) can be rearranged using integra-
tion by parts and the linearity of Frobenius inner product
as
@
@
=01
2Z

(s1(S(v+ )) z)2d
=Z

(s1(S(v)) z)@
@
=0s1(S(v+ )d
=Z

(s1 z)>
1S( )1d
 =Z

(s1 z)1
1:S( )d
= Z

r
(s1 z)1
1
 d
+Z

r((s1 z)1
1 )d
= Z

r
(s1 z)1
1
 d
+
 Z
@
((s1 z)1
1 )d
where we have used the fact that for a matrix-valued
function A(x) and a vector-valued function  (x) it holds
thatr(A ) = (rA) +A:r :Using integration
by parts, the second term of Equation (S8) reads:
@
@
=0Z


2p1(v+ ) +r[r(v+ )]
d

=Z


2p1+r[r]
 d
:
From the optimality condition
L0(v) = 08 2H1
0(
)
we obtain the strong form of the adjoint equation which
is a linear elliptic PDE of the form
 2p1 r[r] = r
(s1 z)1
1
in 
=0 on@
where1(x) is the space varying eigenvector associated
to the minimum eigenvalue s1(x) and(x) is the adjointvariable. The Euler equation can be recovered by taking
the rst variation of the Lagrangian with respect to the
control function m.
L0(m)h=Z

mh+rmrhd

+@
@
0Z

g(m+h)d
:
Due to the linearity of the inner product and of gwe
have:
@
@
0Z

g(m+h)d
 =@
@
0Z


g(m) +g(h)
d
=Z

g(h)d
:
Using integration by parts and the explicit form of gwe
get:
Z

g(h)d
 =Z

r
Ah
d
 = Z

r:Ahd
sinceshould satisfy homogeneous Dirichlet boundary
conditions. The Euler equation is obtained by the opti-
mality condition:
L0(m)h= 08h2H1(
)
which gives
 m+m r:A= 0:
S9. S5. DETAILS ON THE NUMERICAL
IMPLEMENTATION
We select linear piecewise continuous nite elements
and use the software package deal.II [53] for the nite
element approximation while NLopt [54] is used for the
gradient-based optimization. The discretized system of
optimality conditions read
Av=Bm
A=f(v)
(Am+M)m+B>=0
whereAandMare the standard stiness and mass ma-
trix of the Finite Element formulation of vector-valued
and scalar-valued elliptic problems, respectively. The
discretized input operator is Bij= R

r i:A jd
where iand jare the associated vector and scalar ba-
sis functions, respectively. The nonlinear forcing in the
adjoint equation is obtained from the weak formulation of
the adjoint equation as fi=R

(s1 z)1
1:S( i)d
wheres1(v) and1(v) are obtained from the numeri-
cal solution of v. At each iteration of the gradient-
based optimizer the reduced gradient can be computed
by solving state and adjoint equation, then we have
rJ=(Am+M)m+B>which is used for the control
update. Where not otherwise stated, the optimization is
completed when the L2norm of the reduced gradient is
less than 10 7.11
FIG. S5. Solution of the OCP in eqs. (1-2) from the main text, setting d=0andz1to create a short-term attractor along
the positive y axis. (a) Streamlines of the velocity eld v. (b)s1(x) marks short-time attraction, conrmed by uid tracers
advected by vover a short time, as Figs. 1,2,4. (c) Streamlines of the velocity eld ~v. The tilde frame is rotating with respect to
the standard frame at constant angular velocity != 120rad(time is in nondimensional units). The rotated frame is displayed
at the time when it is instantaneously aligned with the standard frame. While vand the streamlines are frame-dependent,
s1(x) = ~s1(~ x) is not, correctly predicting short-term attractors regardless of the arbitrary choice of the reference frame used to
describe motion.
S10. S6. OBJECTIVITY
Assume v(x;t) is the velocity eld solving the OCP
(eq. (2)) or one experimentally measured as in Figs.
1a-b. Objectivity is a fundamental axiom of mechan-
ics [50] that states that the material response of a de-
forming continuum is independent of the reference frame
chosen to describe the motion, for all frames related by
Euclidean (or distance preserving) transformations of the
form: ~x=Q(t)x+b(t), where Q(t)2SO(2) and b(t)
is a translation vector. Therefore, the location of short-
time attractors, which is related to uid deformation and
motion, cannot depend on the reference frame choice.
Denoting by~() and () the same quantity expressed
in the ~xandxframes, scalar objective quantities must
transform [50] as ~ c(~x;t) =c(x;t), objective vector elds
must transform as ~c(~x;t) =Q(t)c(x;t), etc.. Short-time
attractors are objective because ~ s1(~x;t) =s1(x;t) [31].
By contrast, it is well known that the velocity eld and
its streamlines are not as
~v(~x;t) =Q(t)v(Q>~x;t) +_Q(t)Q>(t)~x+_b(t):(S9)To visualize the eects of frame invariance, we solve
the OCP in eqs. (1-2) from the main text, setting for
simplicity d=0, andz1in order to create a short-term
attractor along the positive y axis (Figs. S5a-b). We
then select a coordinate frame ~xwith _b=0and constant
angular velocity !so that
Q(t) =
cos(!t) sin(!t)
sin(!t) cos(!t)
;_Q(t) =!
 sin(!t) cos(!t)
cos(!t) sin(!t)
:
(S10)
The frame rotation does not aect s1and the loca-
tion of material attraction, but distorts the streamlines
of~vas shown in Figure S5c, highlighting the fact that
the streamlines or the velocity eld are suboptimal to
identify material attraction. Using the same coordinate
transformation, a similar conclusion holds using the ex-
perimental velocity eld used in Fig.1, as shown in Fig.
S6.12
FIG. S6. Same as Figs. 1a-b for a dierent time. (a) Velocity eld v(x). (b) v(x) ands1(x) eld. (c) s1(x) locates a
short-term attractor, as veried by uid tracers (green) advected by v(x) over a short time from uniform initial conditions,
as in Figs. 1b. (d) Velocity eld ~v(~x) obtained from eqs. (S9,S10), setting != 1rad=min ,_b=0and starting with ~xand
xaligned at the time shown t= 640. v(x) and its streamlines are frame dependent and hence are strongly aected by the
choice (motion) of the reference frame. By contrast, s1(x) = ~s1(~ x) is objective and predicts the correct location of short-term
attractors.