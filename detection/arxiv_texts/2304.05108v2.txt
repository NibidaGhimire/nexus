arXiv:2304.05108v2  [nlin.SI]  12 Sep 2023Quasi-periodic solutions to hierarchies of nonlinear
integrable equations and bilinear relations
A. Zabrodin∗
April 2023ITEP-TH-11/23
Abstract
This is a short review of the construction of quasi-periodic (algebraic-geomet-
rical) solutions to hierarchies of nonlinear integrable eq uations. As is well known,
thesolutionsareexpressedthroughRiemann’stheta-funct ionsassociated withalge-
braic curves. It is explained how solutions from this class c an be treated within the
framework of the approach to the integrable hierarchies dev eloped by the Kyoto
school. Three representative examples are considered in de tail: the Kadomtsev-
Petviashvili hierarchy, the 2D Toda lattice hierarchy and t he B-version of the
Kadomtsev-Petviashvili hierarchy.
Contents
1 Introduction 2
2 Algebraic-geometrical preliminaries 3
2.1 Arbitrary curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
2.2 Curves with holomorphic involution . . . . . . . . . . . . . . . . . . . . . 8
3 The KP hierarchy 11
3.1 Bilinear relations for the KP hierarchy . . . . . . . . . . . . . . . . . . . 11
3.2 The one-point Baker-Akhiezer functions . . . . . . . . . . . . . . . . . . 12
3.3 The tau-function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.4 On the choice of the local parameter . . . . . . . . . . . . . . . . . . . . 1 5
∗SkolkovoInstituteofScienceandTechnology,143026,Moscow,R ussiaandNationalResearchUniver-
sity Higher School of Economics, 20 Myasnitskaya Ulitsa, Moscow 10 1000, Russia, and NRC “Kurchatov
institute”, Moscow, Russia; e-mail: zabrodin@itep.ru
14 2D Toda lattice hierarchy 16
4.1 Bilinear relations for the Toda lattice hierarchy . . . . . . . . . . . . . . 16
4.2 The two-point Baker-Akhiezer functions . . . . . . . . . . . . . . . . . . 18
4.3 The tau-function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
5 The BKP hierarchy 21
5.1 Bilinear relations for the BKP hierarchy . . . . . . . . . . . . . . . . . . 21
5.2 The Baker-Akhiezer function . . . . . . . . . . . . . . . . . . . . . . . . . 2 3
5.3 The tau-function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
Acknowledgments 28
References 28
1 Introduction
Exact quasi-periodic solutions to nonlinear integrable equations (so liton equations) are
known to be expressed in terms of Riemann’s theta-functions asso ciated to algebraic
curves (Riemann surfaces). For the ﬁrst time the explicit formulas were obtained for the
(1+1)-dimensional Korteveg-de Vries equation, see [1, 2].
The uniﬁed approach to integration of more general (2+1)-dimens ional Kadomtsev-
Petviashvili (KP) equation was developed by Krichever in 1977 [3, 4]. I t was shown that
quasi-periodic solutions are constructed starting from certain alg ebraic-geometrical data:
a smooth algebraic curve of ﬁnite genus with a marked point and a loca l parameter in
the vicinity of this point. That is why such solutions are sometimes calle d “algebraic-
geometrical”. Explicit formulas can be written in terms of the Riemann theta-functions,
with the corresponding Riemann matrix being the matrix of periods of holomorphic
diﬀerentials (see also [5, 6]). Moreover, Novikov’s conjecture (pro ved by Shiota in 1986
[7]) states that exact theta-functional solutions to the KP equat ion solve the famous
Schottky problem: they give a characterization of Jacobian variet ies among all abelian
tori.
The methods developed in [3, 4] are applicable to other integrable equ ations as well.
Quasi-periodic solutions to the 2D Toda lattice equation were ﬁrst co nstructed in [8].
Quasi-periodic solutions to the B-version of the KP hierarchy (BKP) were discussed in
[9, 10].
One of the basic objects in the construction of algebraic-geometr ical solutions is the
Baker-Akhiezer function which can be regarded as a proper gener alization of the expo-
nential functionontheRiemannspheretosurfaces ofnonzero ge nus. Thekeyobservation
is that the Baker-Akhiezer function satisﬁes an over-determined system of linear equa-
tions whose compatibility condition is equivalent to the nonlinear equat ion. Remarkably,
the Baker-Akhiezer function can be written explicitly in terms of the Riemann theta
functions and Abel map.
2A little bit later an algebraic analysis of nonlinear integrable equations w as initiated
in the works of the Kyoto school [11, 12]. The emphasis was made on t he fact that the
integrable equations form inﬁnite hierarchies with inﬁnitely many comm uting ﬂows. The
corresponding analysis of the 2D Toda lattice hierarchy was given in [1 3]. A common
solution to the whole hierarchy is provided by the tau-function which satisﬁes a bilinear
relation. The construction of algebraic-geometrical solutions can be extended to the
hierarchy. It turns out that the corresponding tau-function is e ssentially the Riemann
theta-function or Prym theta-function (for the BKP hierarchy) .
In this review we describe the construction of quasi-periodic solutio ns to the KP,
2D Toda lattice and BKP hierarchies. The main references are [3, 4, 5 , 6, 9, 14]. In
our presentation, the main attention is payed to the demonstratio n of how these theta-
functional solutions can be embedded into the framework of the Ky oto school approach.
Our aimis to show that theequivalence of the two approaches isbase d onsome nontrivial
facts about diﬀerentials on Riemann surfaces.
Section 2isacollectionofnecessary factsaboutRiemannsurfaces andtheta-functions
which we give without proofs. The material of section 2.2 is used only in section 5. In
sections 3, 4 and 5 we consider quasi-periodic solutions to the KP, 2D Toda lattice and
BKPhierarchies respectively. Wehave triedto organizethepresen tation according to the
following scheme: ﬁrst we introduce the hierarchy by means of the b ilinear relations for
tau-functionfollowing the approachof theKyoto school, then give explicit expressions for
the Baker-Akhiezer function and tau-function and, ﬁnally, show h ow they can be treated
in the bilinear formalism.
2 Algebraic-geometrical preliminaries
Here we present the basic notions and facts about Riemann surfac es [15, 16], theta-
functions [17] and diﬀerentials on Riemann surfaces which are neces sary for the con-
struction of quasi-periodic solutions to the integrable hierarchies.
2.1 Arbitrary curves
Matrix of periods and Jacobian. Let Γ be a smooth compact algebraic curve (a
Riemann surface) of genus g. We ﬁx a canonical basis of cycles aα,bα(α= 1,...,g) with
theintersections aα◦aβ=bα◦bβ= 0,aα◦bβ=δαβandabasisofholomorphicdiﬀerentials
dωα(abelian diﬀerentials of the ﬁrst kind) normalized by the condition/contintegraldisplay
aαdωβ=δαβ.
The period matrix is deﬁned as
Tαβ=/contintegraldisplay
bαdωβ, α,β = 1,...,g. (2.1)
It is a symmetric matrix with positively deﬁned imaginary part.
The Jacobian of the curve Γ is the g-dimensional complex torus
J(Γ) =Cg/{/vectorN+T/vectorM}, (2.2)
where/vectorN,/vectorMareg-dimensional vectors with integer components.
3The Abel map. Fix a point Q0∈Γ and deﬁne the Abel map /vectorA(P),P∈Γ from Γ to
J(Γ) as
/vectorA(P) =/vector ω(P) =/integraldisplayP
Q0d/vector ω, d/vector ω = (dω1,...,dω g). (2.3)
The Abel map can be extended to the group of divisors D=n1Q1+...+nKQKas
/vectorA(D) =K/summationdisplay
i=1ni/integraldisplayQi
Q0d/vector ω=K/summationdisplay
i=1ni/vectorA(Qi). (2.4)
The Riemann bilinear identity. Letaα,bαbe Jordan arcs which represent the
canonical basis of cycles intersecting transversally at a single point and let
˜Γ = Γ\/uniondisplay
α/parenleftBig
aα/uniondisplay
bα/parenrightBig
be a simply connected subdomain of Γ (a fundamental domain). Inte grals of any two
meromorphic diﬀerentials dΩ′,dΩ′′satisfy the Riemann bilinear identity
/contintegraldisplay
∂˜Γ/parenleftBig/integraldisplayP
Q0dΩ′/parenrightBig
dΩ′′(P) =g/summationdisplay
α=1/parenleftbigg/contintegraldisplay
aαdΩ′/contintegraldisplay
bαdΩ′′−/contintegraldisplay
bαdΩ′/contintegraldisplay
aαdΩ′′/parenrightbigg
.(2.5)
In particular, if a-periods of both diﬀerentials are equal to zero, we have
/contintegraldisplay
∂˜Γ/parenleftBig/integraldisplayP
Q0dΩ′/parenrightBig
dΩ′′(P) = 0. (2.6)
Abelian diﬀerentials of the second kind. LetP∞∈Γ be a marked point and k−1
a local parameter in a neighborhood of the marked point ( k=∞atP∞). LetdΩjbe
diﬀerentials of the second kind with the only pole at P∞of the form
dΩj=dkj+O(k−2)dk, k→ ∞
normalized by the condition/contintegraldisplay
aαdΩj= 0, and Ω jbe the (multi-valued) functions
Ωj(P) =/integraldisplayP
Q0dΩj+qj,
where the constants qjare chosen in such a way that Ω i(P) =ki+O(k−1), namely,
Ωi(P) =ki+/summationdisplay
j≥11
jΩijk−j. (2.7)
It follows from the Riemann bilnear identity that the matrix Ω ijis symmetric: Ω ij= Ωji
(one should put dΩ′=dΩi,dΩ′′=dΩjin (2.6)).
Set
Uα
j=1
2πi/contintegraldisplay
bαdΩj,/vectorUj= (U1
j,...,Ug
j). (2.8)
One can prove the following relation:
d/vector ω=/summationdisplay
j≥1/vectorUjk−j−1dk (2.9)
4or
/vectorA(P)−/vectorA(P∞) =/integraldisplayP
P∞d/vector ω=−/summationdisplay
j≥11
j/vectorUjk−j(2.10)
(this follows from (2.5) if one puts dΩ′=dωα,dΩ′′=dΩj).
Similarly, let P0∈Γ be another marked point with local parameter k(k(P0) = 0).
Letd¯Ωjbe diﬀerentials of the second kind with the only pole at P0of the form
d¯Ωj=dk−j+O(1)dk, k→0
normalized by the condition/contintegraldisplay
aαd¯Ωj= 0, and
¯Ωi(P) =/integraldisplayP
Q0d¯Ωi+ ¯qi=k−i+/summationdisplay
j≥11
j¯Ωijkj,¯Ωij=¯Ωji.
Set
Vα
j=1
2πi/contintegraldisplay
bαd¯Ωj, (2.11)
then the Riemann bilienar identity implies that
/vectorA(P)−/vectorA(P0) =−/summationdisplay
j≥11
j/vectorVjkj. (2.12)
We will also need the expansions of the functions Ω i(P),¯Ωi(P) near the points P0,
P∞respectively:
Ωi(P) = Ωi(P0)+/summationdisplay
j≥11
jωijkj, P→P0,
¯Ωi(P) =¯Ωi(P∞)+/summationdisplay
j≥11
j¯ωijk−j, P→P∞,(2.13)
and the Riemann bilienar identity implies that ¯ ωij=ωji.
The Riemann theta-functions. The Riemann theta-function associated with the
Riemann surface is deﬁned by the absolutely convergent series
Θ(/vector z) = Θ(/vector z|T) =/summationdisplay
/vector n∈Zgeπi(/vector n,T/vector n)+2πi(/vector n,/vector z), (2.14)
where/vector z= (z1,...,z g) and (/vector n,/vector z) =g/summationdisplay
α=1nαzα. It is an entire function with the following
quasi-periodicity property:
Θ(/vector z+/vectorN+T/vectorM) = exp(−πi(/vectorM,T/vectorM)−2πi(/vectorM,/vector z))Θ(/vector z). (2.15)
More generally, one can introduce the theta-functions with chara cteristics/vectorδ′,/vectorδ′:
Θ/bracketleftBigg/vectorδ′
/vectorδ′′/bracketrightBigg
(/vector z) =/summationdisplay
/vector n∈Zgeπi(/vector n+/vectorδ′,T(/vector n+/vectorδ′))+2πi(/vector n+/vectorδ′,/vector z+/vectorδ′′). (2.16)
5Riemann’s constants. Consider the function f(P) = Θ(/vectorA(P)−/vector e) and assume that
it is not identically zero. It can be shown that this function has gzeros on Γ at a divisor
D=Q1+...+Qgand/vectorA(D) =/vector e−/vectorK, where/vectorK= (K1,...,K g) is the vector of Riemann’s
constants
Kα=πi+πiTαα−2πi/summationdisplay
β/negationslash=α/contintegraldisplay
aβωα(P)dωβ(P). (2.17)
In other words, for any non-special eﬀective divisor D=Q1+...+Qgof degreegthe
function
f(P) = Θ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
has exactly gzeros at the points Q1,...,Q g. LetKbe the canonical class of divisors
(the equivalence class of divisors of poles and zeros of abelian diﬀere ntials on Γ), then
one can show that
2/vectorK=−/vectorA(K). (2.18)
It is known that deg K= 2g−2. In particular, this means that holomorphic diﬀerentials
have 2g−2 zeros on Γ.
The bi-diﬀerential. We also need the bi-diﬀerential dPdQΩ(P,Q) such that it is sym-
metric inP,Q, its only singularity is a second order pole at P=Qand the integrals over
a-cycles vanish. It is related to the diﬀerentials dΩjas follows:
res
Q=P∞/parenleftBig
ki(Q)dPdQΩ(P,Q)/parenrightBig
=−dΩi(P). (2.19)
The expansion in the local parameters is
dPdQΩ(P,Q) =/parenleftBigg1
(k−1(P)−k−1(Q))2−/summationdisplay
i,j≥1Ωijk1−i(P)k1−j(Q)/parenrightBigg
dk−1(P)dk−1(Q).
(2.20)
In fact this bi-diﬀerential can be expressed through the odd thet a-function
Θ∗(/vector z) = Θ/bracketleftBigg/vectorδ′
o
/vectorδ′′
o/bracketrightBigg
(/vector z)
(Θ∗(/vector0) = 0), where ( /vectorδ′
o,/vectorδ′′
o) is an odd half-integer theta-characteristics. We have:
dPdQΩ(P,Q) =dPdQlogΘ∗/parenleftBig/vectorA(P)−/vectorA(Q)/parenrightBig
. (2.21)
Calculating the double integral/integraldisplayP1
P∞/integraldisplayP2
Q0dPdQΩ(P,Q) in two ways (using ﬁrst (2.20) and
then (2.21)), we obtain the equality
log(k−1(P1)−k−1(P2))k−1(Q0)
(k−1(P1)−k−1(Q0))k−1(P2)−/summationdisplay
i,j≥1Ωijk−i(P1)k−j(P2)
ij+/summationdisplay
i,j≥1Ωijk−i(P1)k−j(Q0)
ij
= logΘ∗/parenleftBig/vectorA(P2)−/vectorA(P1)/parenrightBig
Θ∗/parenleftBig/vectorA(P∞)/parenrightBig
Θ∗/parenleftBig/vectorA(P2)−/vectorA(P∞)/parenrightBig
Θ∗/parenleftBig/vectorA(P1)/parenrightBig.
6Tending here Q0→P∞, we arrive at the relation
exp/parenleftBigg
−/summationdisplay
i,j≥1Ωijk−i
1k−j
2
ij/parenrightBigg
=CΘ∗/parenleftBig/vectorA(P1)−/vectorA(P2)/parenrightBig
(k1−k2)Θ∗/parenleftBig/vectorA(P1)−/vectorA(P∞)/parenrightBig
Θ∗/parenleftBig/vectorA(P2)−/vectorA(P∞)/parenrightBig,(2.22)
wherek1=k(P1),k2=k(P2) and
C=g/summationdisplay
α=1Uα
1Θ∗,α(/vector0),Θ∗,α(/vector0) =∂Θ∗(/vector z)
∂zα/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
/vector z=0
is a constant.
Abelian diﬀerential of the third kind. We will also need the abelian diﬀerentials of
the third kind which are meromorphic diﬀerentials with two simple poles w ith residues
±1 (dipole diﬀerentials). In particular, let dΩ0be the diﬀerential having a simple pole at
P0with residue +1 and another simple pole at P∞with residue −1 with zero a-periods.
The expansions of the function Ω 0(P) near these points are
Ω0(P) =

logk+Ω00+/summationdisplay
j≥11
jΩ0jk−j, P→P∞,
logk+¯Ω00+/summationdisplay
j≥11
j¯Ω0jkj, P→P0.(2.23)
Set
Uα
0=1
2πi/contintegraldisplay
bαdΩ0. (2.24)
The following important relations are immediate consequences of the Riemann bilinear
identity:
/vectorA(P0)−/vectorA(P∞) =U0, (2.25)
Ω0i=−Ωi(P0),¯Ω0i=¯Ωi(P∞). (2.26)
Note that the function Ω 0(P) (2.23) is given by
Ω0(P) = logΘ∗(/vectorA(P)−/vectorA(P0)
Θ∗(/vectorA(P)−/vectorA(P∞))(2.27)
and the constant Ω 00in the expansion (2.23) is the following:
Ω00=−logC+logΘ ∗(/vectorA(P0)−/vectorA(P∞)). (2.28)
The holomorphic diﬀerential dζ.Tendingk1→k2in (2.22), we get
exp/parenleftBigg
−/summationdisplay
i,j≥1Ωijk−i−j
ij/parenrightBigg
dk=Cdζ
Θ2∗/parenleftBig/vectorA(P)−/vectorA(P∞)/parenrightBig, (2.29)
7wheredζis the holomorphic diﬀerential
dζ=g/summationdisplay
α=1Θ∗,α(/vector0)dωα. (2.30)
It is known (see [17]) that the diﬀerential dζhasdoublezeros at some g−1 points
R1,...,R g−1while the function
f∗(P) = Θ∗/parenleftBig/vectorA(P)−/vectorA(P∞)/parenrightBig
has simple zeros at the same points RiandP∞. Therefore, the diﬀerential in the right
hand side of (2.29) has the only (second order) pole at P∞and no zeros. However, this
diﬀerential iswell-deﬁned onlyonacovering ofthecurve Γ because it isnot single-valued.
The odd theta-function Θ ∗and the diﬀerential dζdepend on the choice of the odd
theta-characteristics but the prime form
E(P,Q) =Θ∗(/vectorA(P)−/vectorA(Q))/radicalBig
dζ(P)/radicalBig
dζ(Q)(2.31)
doesnotdependonit[16,17]. Thebi-diﬀerential (2.21) dPdQΩ(P,Q) =dPdQlogE(P,Q)
also does not depend on the choice of the odd theta-characterist ics (the1
2-diﬀerentials/radicalBig
dζ(P),/radicalBig
dζ(Q) cancel).
The Fay identity. At last, we mention the trisecant Fay identity [16] satisﬁed by the
function Θ/parenleftBig
/vector z+/vectorA(P)/parenrightBig
:
Θ∗/parenleftBig/vectorA(P1)−/vectorA(P2)/parenrightBig
Θ∗/parenleftBig/vectorA(P3)−/vectorA(P4)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P1)+/vectorA(P2)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P3)+/vectorA(P4)/parenrightBig
+Θ∗/parenleftBig/vectorA(P2)−/vectorA(P3)/parenrightBig
Θ∗/parenleftBig/vectorA(P1)−/vectorA(P4)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P2)+/vectorA(P3)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P1)+/vectorA(P4)/parenrightBig
+Θ∗/parenleftBig/vectorA(P3)−/vectorA(P1)/parenrightBig
Θ∗/parenleftBig/vectorA(P2)−/vectorA(P4)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P1)+/vectorA(P3)/parenrightBig
Θ/parenleftBig
/vector z+/vectorA(P2)+/vectorA(P4)/parenrightBig
= 0.
(2.32)
HereP1,P2,P3,P4are four arbitrary points on Γ and /vector zis an arbitrary vector.
2.2 Curves with holomorphic involution
Assume now that the curve Γ admits a holomorphic involution ιwith two ﬁxed points
P∞andP0. The Riemann-Hurwitz formula implies that genus gis even:g= 2g0. The
curve Γ is two-sheet covering of the factor-curve Γ 0= Γ/ιof genusg0. In the vicinity of
P∞we ﬁx a local parameter k−1(k−1(P∞) = 0) such that k(ιP) =−k(P).
The Prym variety. We introduce a canonical basis of cycles aα,bαon Γ with the
propertiesιaα=−ag0+α,ιbα=−bg0+α,α= 1,...,g 0. Hereandbelowthesumslike α+g0
forα= 1,...,gare understood modulo g, i.e., for example, ( g0+1)+g0= 1. Letdωαbe
8the corresponding basis of normalized holomorphic diﬀerentials, the nι∗dωα=−dωg0+α,
α= 1,...,g 0. With this choice, the matrix of periods enjoys the symmetry
Tαβ=Tα+g0,β+g0. (2.33)
Note that the symmetry property (2.33) of the period matrix implies the relation
Θ(ι/vector u) = Θ(/vector u) for anyu∈Cg. (2.34)
The Prym diﬀerentials are deﬁned as dυα=dωα+dωg0+α(hereα= 1,...,g 0); they
are odd with respect to the involution. The g0×g0matrix
Παβ=/contintegraldisplay
bαdυβ, α,β= 1,...,g 0 (2.35)
is called the Prym matrix of periods. It is a symmetric matrix with positiv ely deﬁned
imaginary part.
The involution ιinduces the involution of the Jacobian: ιuα=−uα+g0, or, explicitly,
ι(u1,...,u g) =−(ug0+1,...,u g,u1,...,u g0). (2.36)
The Prym variety Pr(Γ)⊂J(Γ) is a subvariety of the Jacobian of Γ deﬁned by the
conditionι(/vector u) =−/vector u, i.e. it is the variety
Pr(Γ) =/braceleftBig
/vector u∈Cg/vextendsingle/vextendsingle/vextendsingle/vector u= (u1,...,u g0,u1,...,u g0)/bracerightBig
/(Zg+TZg).
It is isomorphic to the g0-dimensional torus Pr=Cg0/((Zg0+ΠZg0).This torus can be
embedded into the Jacobian by the map
σ(/vector u) = (u1,...,u g0,u1,...,u g0)∈J(Γ), /vector u= (u1,...,u g0), (2.37)
and the image is the Prym variety.
The Abel-Prym map. TheAbel-Prymmap /vectorAPr(P),P∈ΓfromΓto Pr(Γ)isdeﬁned
as
/vectorAPr(P) =/vector υ(P) =/integraldisplayP
P0d/vector υ, d/vector υ = (dυ1,...,dυ g0), (2.38)
or
Apr
α(P) =Aα(P)+Ag0+α(P) =Aα(P)−Aα(ιP). (2.39)
The Abel-Prym map can be extended to the group of divisors by linear ity. Note that
for curves with involution the initial point of the Abel map is not arbitr ary: it isP0, the
second ﬁxed point of the involution. Note that according to our deﬁ nitionsAα(ιP) =
−Ag0+α(P) that agrees with the induced involution of the Jacobian (2.36).
9Abelian diﬀerentials. The normalized abelian diﬀerentials of the second kind dΩj
with poles at P∞and corresponding abelian functions Ω j,
Ωj(P) =/integraldisplayP
P0dΩj,
are deﬁned in the same way as in section 2.1. Note that the initial point in the abelian
integral deﬁning the function Ω jis the second ﬁxed point P0. The involution implies
ι∗dΩj= (−1)jdΩj, (2.40)
and for their b-periods we have
Ug0+α
j= (−1)j+1Uα
j. (2.41)
Therefore, instead of (2.10) it holds
/vectorAPr(P) =−2/summationdisplay
j≥1,odd1
j/vectorUjk−j. (2.42)
The Prym theta-function. The Prym theta-function is deﬁned by the series
ΘPr(/vector z) = ΘPr(/vector z|Π) =/summationdisplay
/vector n∈Zg0eπi(/vector n,Π/vector n)+2πi(/vector n,/vector z). (2.43)
Consider the function f(P) = Θ Pr(/vectorAPr(P)−/vector c) with/vector c∈Cg0and suppose that it does
not vanish identically. Then the zero divisor Dof this function on Γ is of degree gand
satisﬁes the relation
σ(/vector c) =/vectorA(D)−1
2/vectorA(P∞)+/vectorK. (2.44)
We also note the following important relation [16]: for any /vector u∈Cg0it holds
Θ/parenleftBig
σ(/vector u)+1
2/vectorA(P∞)/parenrightBig
= Θ/parenleftBig
σ(/vector u)−1
2/vectorA(P∞)/parenrightBig
=C/parenleftBig
ΘPr(/vector u)/parenrightBig2, (2.45)
i.e., the Riemann theta-function on this part of the Jacobian is a full s quare and the
square root is, up to a constant multiplier, the Prym theta-functio n.
Analogue of (2.29). Let us consider the bi-diﬀerential
dPdQω(P,Q) =dPdQΩ(P,Q)−dPdQΩ(P,ιQ) =dPdQlogE(P,Q)
E(P,ιQ).(2.46)
Notethatforcurveswithinvolutionthedoublesumin(2.20)contains onlytermsinwhich
i,jhave the same parity. Taking this into account and recalling that k(ιQ) =−k(Q),
we can write
dPdQω(P,Q) =/parenleftBigg1
(k−1(P)−k−1(Q))2+1
(k−1(P)+k−1(Q))2
−2/summationdisplay
i,joddΩijk1−i(P)k1−j(Q)
dk−1(P)dk−1(Q).(2.47)
10Calculating the double integral/integraldisplayP
Q′
0/integraldisplayQ
Q0dPdQωin two ways (using (2.46) and (2.47)) and
equating the results, we obtain, in the limit Q0→P∞,Q′
0→P∞:
logk−1(P)−k−1(Q)
k−1(P)+k−1(Q)−2/summationdisplay
i,joddΩijk−i(P)k−j(Q)
ij= logE(P,Q)
E(P,ιQ). (2.48)
Exponentiating and tending Q→P, we obtain, using the expression (2.31) for the prime
form:
exp/parenleftBig
−2/summationdisplay
i,joddΩijk−i−j
ij/parenrightBigdk
k=−2/radicalBig
dζ(P)dζ(ιP)
Θ∗(/vectorA(P)−/vectorA(ιP)). (2.49)
This formula is an analogue of (2.29). The denominator has simple zero s at the points
P0,P∞and at some points Ri,ιRi,i= 1,...,g−1. The latter 2 g−2 poles are canceled
by zeros of the holomorphic diﬀerential in the numerator.
3 The KP hierarchy
3.1 Bilinear relations for the KP hierarchy
The set of independent variables in the KP hierarchy is the inﬁnite set of (in general com-
plex) “times” t={t1,t2,t3,...}. The universal dependent variable is the tau-function
τ=τ(t). All equations of the hierarchy are encoded in the bilinear relation
/contintegraldisplay
C∞eξ(t−t′,z)τ(t−[z−1])τ(t′+[z−1])dz= 0 (3.1)
valid for arbitrary t,t′, where
t±[z−1] =/braceleftBig
t1±z−1,t2±1
2z−2,t3±1
3z−3,.../bracerightBig
and
ξ(t,z) =/summationdisplay
j≥1tjzj. (3.2)
The contour C∞in (3.1) is a big circle encircling ∞. Note that the simplest (trivial)
solution of (3.1) is τ(t) = 1.
Let us set t−t′= [z−1
1]+[z−1
2]+[z−1
3]−[z−1
4] in (3.1). The residue calculus yields
(z1−z2)(z3−z4)τ(t−[z−1
1]−[z−1
2])τ(t−[z−1
3]−[z−1
4])
+(z2−z3)(z1−z4)τ(t−[z−1
2]−[z−1
3])τ(t−[z−1
1]−[z−1
4])
+(z3−z1)(z2−z4)τ(t−[z−1
1]−[z−1
3])τ(t−[z−1
2]−[z−1
4]) = 0(3.3)
which is the Hirota-Miwa equation for the tau-function. It is a gener ating equation for
the diﬀerential equations of the hierarchy. They are obtained by e xpanding it in negative
powers ofz1,z2,z3,z4. In the limit z4→ ∞,z3→ ∞equation (3.3) becomes
∂t1logτ/parenleftBig
t+[z−1
1]−[z−1
2]/parenrightBig
τ(t)= (z2−z1)
τ/parenleftBig
t+[z−1
1]/parenrightBig
τ/parenleftBig
t−[z−1
2]/parenrightBig
τ(t)τ/parenleftBig
t+[z−1
1]−[z−1
2]/parenrightBig−1
.(3.4)
11Important objects of the theory are the wave function ψ(t,z) and its dual ψ†(t,z).
They are expressed through the tau-function as follows:
ψ(t,z) =eξ(t,z)τ(t−[z−1])
τ(t), (3.5)
ψ†(t,z) =e−ξ(t,z)τ(t+[z−1])
τ(t). (3.6)
Here it is implied that the spectral parameter zbelongs to some neighborhood of ∞. In
terms of the wave functions, the bilinear relation (3.1) acquires the form
/contintegraldisplay
C∞ψ(t,z)ψ†(t′,z)dz= 0. (3.7)
3.2 The one-point Baker-Akhiezer functions
The (one-point) Baker-Akhiezer function Ψ = Ψ( t,P) is a function on the curve Γ of
genusg(Pis a point of Γ) which is analytic everywhere except at the marked poin tP∞,
where it has an essential singularity of the prescribed form and gsimple poles at some
pointsQ1,...,Q g∈Γ. We denote the divisor of poles of Ψ by
D=Q1+...+Qg
and assume that it is non-special. The standard argument shows th at the linear space
of Baker-Akhiezer functions is one-dimensional. In other words, t he Baker-Akhiezer
function is unique up to a common multiplier. In the vicinity of P∞the Baker-Akhiezer
function as a function of the local parameter k−1has the form
Ψ(t,P) =eξ(t,k)/parenleftBig
1+ξ1(t)k−1+ξ2(t)k−2+.../parenrightBig
, P→P∞ (3.8)
(we assume that only a ﬁnite number of the times tjare diﬀerent from zero). The above
mentioned common multiplier is ﬁxed by the condition lim
P→P∞/parenleftBig
e−ξ(t,k)Ψ(t,P)/parenrightBig
= 1.
LetdΩ be the abelian diﬀerential of the second kind with the only (second o rder) pole
atP∞andgsimple zeros at the points of the divisor D. Such a diﬀerential is unique up
to a common constant multiplier. It has other gzeros at some points Q†
1,...,Q†
g. Let
D†=Q†
1+...+Q†
g
be the divisor of these zeros, then we have the relation
D+D†=K+2P∞ (3.9)
which means that
/vectorA(D)+/vectorA(D†)+2/vectorK−2/vectorA(P∞) = 0 (3.10)
in the Jacobian. One can introduce the adjoint (dual) Baker-Akhiez er function Ψ†by
the requirement that it has the divisor of poles D†and in the vicinity of P∞it behaves
as
Ψ†(t,P) =e−ξ(t,k)/parenleftBig
1+ξ†
1(t)k−1+ξ†
2(t)k−2+.../parenrightBig
, P→P∞.(3.11)
12The diﬀerential Ψ( t,P)Ψ†(t′,P)dΩ(P) is holomorphic everywhere on Γ except the
pointP∞(poles of the Baker-Akhiezer functions are canceled by zeros of dΩ). Therefore,
the residue at this point is equal to zero and we have
/contintegraldisplay
C∞Ψ(t,P)Ψ†(t′,P)dΩ(P) = 0 (3.12)
for allt,t′, whereC∞is a small contour around the point P∞.
Using the Riemann’s theta-function and the Abel map, one can write the Baker-
Akhiezer function in the explicit form:
Ψ(t,P) = exp/parenleftBig/summationdisplay
j≥1tjΩj(P)/parenrightBigΘ/parenleftBig/vectorA(P)+/summationtext
j≥1/vectorUjtj−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/summationtext
j≥1/vectorUjtj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig,
(3.13)
where we use the notation introduced in section 2. In (3.13) it is assu med that the
path of integration in the Abel map and Ω jis the same. This function is normalized in
such a way that Ψ(0 ,P) = 1. The corresponding expression for the dual Baker-Akhiezer
function is
Ψ†(t,P) = exp/parenleftBig
−/summationdisplay
j≥1tjΩj(P)/parenrightBigΘ/parenleftBig/vectorA(P)−/summationtext
j≥1/vectorUjtj−/vectorA(D†)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(D†)+/vectorK−/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D†)−/vectorK/parenrightBig
Θ/parenleftBig/summationtext
j≥1/vectorUjtj+/vectorA(D†)+/vectorK−/vectorA(P∞)/parenrightBig.
(3.14)
Using the relation (3.10), one can rewrite it in the form
Ψ†(t,P) = exp/parenleftBig
−/summationdisplay
j≥1tjΩj(P)/parenrightBig
×Θ/parenleftBig/vectorA(P)−/summationtext
j≥1/vectorUjtj+/vectorA(D)+/vectorK−2/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)+/vectorA(D)+/vectorK−2/vectorA(P∞)/parenrightBig
Θ/parenleftBig/summationtext
j≥1/vectorUjtj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig.(3.15)
The standard argument shows that the Baker-Akhiezer function satisﬁes the linear
equation
∂t2Ψ =∂2
xΨ+uΨ, x=t1 (3.16)
(which has the form of the non-stationary Schr¨ odinger equation ), where
u(x) =−∂xξ1. (3.17)
3.3 The tau-function
The tau-function is deﬁned as
τ(t) = exp/parenleftBig
−1
2/summationdisplay
i,j≥1Ωijtitj/parenrightBig
Θ/parenleftBig/summationdisplay
j≥1/vectorUjtj+/vectorZ/parenrightBig
, (3.18)
13where the constant vector /vectorZis parametrized through the divisor Das
/vectorZ=−/vectorA(D)−/vectorK+/vectorA(P∞). (3.19)
Equation (2.10) implies that
Θ/parenleftBig/summationdisplay
j≥1/vectorUj(tj∓1
jk−j)+/vectorZ/parenrightBig
= Θ/parenleftBig
±/vectorA(P)+/summationdisplay
j≥1/vectorUjtj+/vectorZ∓/vectorA(P∞)/parenrightBig
,
so we see that the Baker-Akhiezer functions (3.13), (3.15) are co nnected with the tau-
function in the same way as the wave functions (see (3.5), (3.6)). N amely, in a neighbor-
hood ofP∞we have
Ψ(t,P) =C(k)ψ(t,k),Ψ†(t,P) =C†(k)ψ†(t,k), (3.20)
where
C(k) =τ(0)
τ(−[k−1]), C†(k) =τ(0)
τ([k−1]). (3.21)
A simple calculation shows that
τ(t−[k−1
1]−[k−1
2])τ(t)
τ(t−[k−1
1])τ(t−[k−1
2])= exp/parenleftBigg
−/summationdisplay
i,j≥1Ωijk−i
1k−j
2
ij/parenrightBigg
×Θ/parenleftBig/vectorA(P1)+/vectorA(P2)+/summationtext
j≥1/vectorUjtj+/vectorZ/parenrightBig
Θ/parenleftBig/summationtext
j≥1/vectorUjtj+/vectorZ/parenrightBig
Θ/parenleftBig/vectorA(P1)+/summationtext
j≥1/vectorUjtj+/vectorZ/parenrightBig
Θ/parenleftBig/vectorA(P2)+/summationtext
j≥1/vectorUjtj+/vectorZ/parenrightBig.(3.22)
Using (2.22), it is straightforward to check that the tau-function (3.18) satisﬁes the
Hirota-Miwa equation (3.3). It appears to be equivalent to the Fay id entity (2.32).
It is instructive to compare equation (3.12) and the standard bilinea r relation for the
tau-function (3.1) or (3.7) (here we follow [18]). Comparing the two e quations (3.12) and
(3.1), we conclude that they coincide if it holds
dΩ =τ(−[k−1])τ([k−1])
τ2(0)dk
=Θ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D†)−/vectorK/parenrightBig
Θ2/parenleftBig/vectorA(D)+/vectorK−/vectorA(P∞)/parenrightBig exp/parenleftBig
−/summationdisplay
i,j≥1Ωijk−i−j
ij/parenrightBig
dk.(3.23)
Using (2.29), we can rewrite this as
dΩ =CΘ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D†)−/vectorK/parenrightBig
Θ2∗/parenleftBig/vectorA(P)−/vectorA(P∞)/parenrightBig dζ, (3.24)
where the holomorphic diﬀerential dζis given by (2.30). Its properties (see [17] and
section 2) imply that the diﬀerential in the right hand side is a well-deﬁn ed meromorphic
diﬀerential on Γ with the only second order pole at P∞and 2gzeros at the points of the
divisorsD,D†. Therefore, it has all the properties of the diﬀerential dΩ and hence must
be proportional to it.
143.4 On the choice of the local parameter
The tau-function (3.18) provides a quasi-periodic solution to the KP hierarchy in the
Hirota form. The solution depends on the algebraic curve Γ and on th e choice of the
local parameter k−1in a neighborhood of the marked point P∞. The latter dependence
can be easily controlled.
Let˜k−1be another local parameter:
k=˜k+a0+a1˜k−1+a2˜k−2+..., k → ∞.
Then we can write
dki=i/summationdisplay
l=1aild˜kl+d(ki)− (3.25)
with some triangular matrix a= (aij) given by
ail= res∞/parenleftBig
ki˜k−ld˜k/˜k/parenrightBig
, (3.26)
where theresidue isdeﬁned asres∞(k−jdk) =δ1j. In(3.25), ( ...)±means projection onthe
positive (negative) power part of the series with respect to ˜k. This implies the following
relation between the diﬀerentials dΩiand the diﬀerentials d˜Ωideﬁned in a similar way
and with the same normalization with the help of the local parameter ˜k−1:
dΩi=i/summationdisplay
l=1aild˜Ωl. (3.27)
Then a similar relation for their periods holds:
Uα
j=i/summationdisplay
l=1ail˜Uα
lorUα=a˜Uα, (3.28)
whereUαis the half-inﬁnite column vector with components Uα
j.
Let us deﬁne the times ˜tjby the relation
/summationdisplay
j≥1tjdkj=/summationdisplay
j≥1˜tjd˜kj+O(˜k−2)d˜k. (3.29)
This relation means that the times ˜tjare linear combinations of the tj’s:
˜tj=/summationdisplay
l≥jtlaljor˜t=ta. (3.30)
Using (3.28), we see that/summationdisplay
j≥1tjUα
jdoes not change when we change the local parameter:
/summationdisplay
j≥1tjUα
j=tUα=˜ta−1a˜Uα=/summationdisplay
j≥1˜tj˜Uα
j, (3.31)
so the theta-function in (3.18) remains the same.
15Next, we can write:
˜t˜Ω˜t=tΩt+t∆t,∆ =a˜ΩaT−Ω, (3.32)
where Ω is the matrix Ω ij(see (2.7)) and ∆ is some matrix which we are going to ﬁnd
explicitly. For this purpose, we write
d˜Ωi=d˜ki−/summationdisplay
l≥1˜Ωil˜k−l−1d˜k
and act to the both sides of this equation by the matrix a. We get:
i/summationdisplay
l=1aild˜Ωl=dΩi=dki−d(ki)−−/summationdisplay
j≥1i/summationdisplay
l=1ail˜Ωlj˜k−j−1d˜k.
On the other hand,
dΩi=dki−/summationdisplay
l≥1Ωilk−l−1dk,
so we have the equality
d(ki)−+/summationdisplay
j≥1i/summationdisplay
l=1ail˜Ωlj˜k−j−1d˜k=/summationdisplay
l≥1Ωilk−l−1dk.
Multiplying it by kmand taking the residue, we obtain:
/summationdisplay
l,jail˜Ωljamj−Ωim=−res∞/parenleftBig
kmd(ki)−/parenrightBig
= ∆im. (3.33)
It is easy to see that the matrix ∆ ijis symmetric and can be equivalently written as
∆ij=−res∞/parenleftBig
(ki)+dkj/parenrightBig
. (3.34)
Therefore, we arrive at the relation between the tau-functions ( 3.18) and ˜τ(˜t) given by
the same formula, where all quantities (except /vectorZ) go with tilde:
˜τ(˜t) = exp/parenleftBig
−1
2/summationdisplay
i,j≥1∆ijtitj/parenrightBig
τ(t). (3.35)
We see that the theta-function multiplier remains invariant and only t he quadratic form
changes.
4 2D Toda lattice hierarchy
4.1 Bilinear relations for the Toda lattice hierarchy
Theindependentvariablesinthe2DTodalatticehierarchyaretwoinﬁ nitesetsofcomplex
variables t={t1,t2,t3,...}(“positive times”), ¯t={¯t1,¯t2,¯t3,...}(“negative times”) and
16an integer variable n∈Z(“zeroth time”). The dependent variable is the tau-function
τn(t,¯t). All equations of the hierarchy are encoded in the bilinear relation
/contintegraldisplay
C∞zn−n′−1eξ(t−t′,z)τn/parenleftBig
t−[z−1],¯t/parenrightBig
τn′+1/parenleftBig
t′+[z−1],¯t′/parenrightBig
dz
=/contintegraldisplay
C0zn−n′−1eξ(¯t−¯t′,z−1)τn+1/parenleftBig
t,¯t−[z]/parenrightBig
τn′/parenleftBig
t′,¯t′+[z]/parenrightBig
dz(4.1)
valid for all n,t,¯tandn′,t′,¯t′, where the contour C∞is the same as in (3.1) and C0is a
small circle around 0. Note that
τn(t,¯t) = exp/parenleftBig/summationdisplay
j≥1jtj¯tj/parenrightBig
(4.2)
is the simplest (trivial) solution.
Clearly, the KP hierarchy can be embedded into the 2D Toda lattice hie rarchy by
ﬁxingn= 0,¯t= 0. Fixing ¯t=¯t′= 0, one obtains what is called the modiﬁed KP
(mKP) hierarchy with the bilinear relation
/contintegraldisplay
C∞zm−1eξ(t−t′,z)τn/parenleftBig
t−[z−1]/parenrightBig
τn−m+1/parenleftBig
t′+[z−1]/parenrightBig
dz=δm,0τn+1(t)τn(t′), m≥0.(4.3)
Let us point out some important consequences of the bilinear relatio n. If we set
n−n′= 1,t−t′= [a−1],¯t−¯t′= [b−1], then the residue calculus yields
τn/parenleftBig
t−[a−1],¯t/parenrightBig
τn/parenleftBig
t,¯t−[b−1]/parenrightBig
−τn(t,¯t)τn/parenleftBig
t−[a−1],¯t−[b−1]/parenrightBig
= (ab)−1τn+1/parenleftBig
t,¯t−[b−1]/parenrightBig
τn−1/parenleftBig
t−[a−1],¯t/parenrightBig
.(4.4)
Diﬀerentiating(4.1)withrespect to t1andthensetting n=n′,t−t′= [a−1],¯t−¯t′= [b−1],
we get:
∂t1logτn+1/parenleftBig
t,¯t−[b−1]/parenrightBig
τn/parenleftBig
t−[a−1],¯t/parenrightBig=a
1−τn(t,¯t)τn+1/parenleftBig
t−[a−1],¯t−[b−1]/parenrightBig
τn/parenleftBig
t−[a−1],¯t/parenrightBig
τn+1/parenleftBig
t,¯t−[b−1]/parenrightBig
.(4.5)
Important objects of the theory are the wave functions ψn,¯ψnand their dual ψ†
n,¯ψ†
n.
They are expressed through the tau-function as follows:
ψn(t,¯t,z) =zneξ(t,z)τn/parenleftBig
t−[z−1],¯t/parenrightBig
τn(t,¯t), (4.6)
¯ψn(t,¯t,z) =zneξ(¯t,z−1)τn+1/parenleftBig
t,¯t−[z]/parenrightBig
τn(t,¯t), (4.7)
ψ†
n(t,¯t,z) =z−ne−ξ(t,z)τn+1/parenleftBig
t+[z−1],¯t/parenrightBig
τn+1(t,¯t), (4.8)
¯ψ†
n(t,¯t,z) =z−ne−ξ(¯t,z−1)τn/parenleftBig
t,¯t+[z]/parenrightBig
τn+1(t,¯t). (4.9)
In terms of the wave functions, the bilinear relation reads
/contintegraldisplay
C∞dz
zψn(t,¯t,z)ψ†
n′(t′,¯t′,z) =/contintegraldisplay
C0dz
z¯ψn(t,¯t,z)¯ψ†
n′(t′,¯t′,z). (4.10)
174.2 The two-point Baker-Akhiezer functions
The two-point Baker-Akhiezer function Ψ = Ψ( n,t,¯t,P) is a function on the curve Γ of
genusgwhich is analytic everywhere except at the marked points P∞,P0, where it has es-
sential singularities oftheprescribed formand gsimple polesatsomepoints Q1,...,Q g∈
Γ. As before, we denote the divisor of poles of Ψ by D=Q1+...+Qgand assume that
it is non-special. The standard argument shows that the linear spac e of two-point Baker-
Akhiezer functions is one-dimensional, i.e., it is unique up to a common co nstant multi-
plier. This multiplier can be ﬁxed by the condition lim
P→P∞/parenleftBig
k−ne−ξ(t,k)Ψ(n,t,¯t,P)/parenrightBig
= 1,
wherek−1is the local parameter in a neighborhood of the point P∞(k(P∞) =∞). In
the vicinity of P∞the Baker-Akhiezer function has the form
Ψ(n,t,¯t,P) =kneξ(t,k)/parenleftBig
1+ξ1(n,t,¯t)k−1+ξ2(n,t,¯t)k−2+.../parenrightBig
, P→P∞(4.11)
(we assume that only a ﬁnite number of the times tj,¯tjare diﬀerent from zero). In
the vicinity of the other marked point, P0, with the local parameter k(k(P0) = 0), the
Baker-Akhiezer function has the form
Ψ(n,t,¯t,P) =kneξ(¯t,k−1)+ϕn(t,¯t)/parenleftBig
1+¯ξ1(n,t,¯t)k+¯ξ2(n,t,¯t)k2+.../parenrightBig
, P→P0.(4.12)
In this section we denote by dΩ the abelian diﬀerential of the third kind with simple
poles at the points P0,P∞with residues ±1 andgsimple zeros at the points of the divisor
D. Such a diﬀerential is unique up to a common constant multiplier. It ha s othergzeros
at some points Q†
1,...,Q†
g. LetD†=Q†
1+...+Q†
gbe the divisor of these zeros, then we
have the relation
D+D†=K+P∞+P0 (4.13)
which means that
/vectorA(D)+/vectorA(D†)+2/vectorK−/vectorA(P∞)−/vectorA(P0) = 0 (4.14)
in the Jacobian. Similarly to the one-point case, one can introduce th e dual Baker-
Akhiezer function Ψ†by the requirement that it has the divisor of poles D†and in the
vicinity of the points P∞,P0it behaves as
Ψ†(n,t,¯t,P) =k−ne−ξ(t,k)/parenleftBig
1+ξ†
1(n,t,¯t)k−1+ξ†
2(n,t,¯t)k−2+.../parenrightBig
, P→P∞,(4.15)
Ψ†(n,t,¯t,P) =k−ne−ξ(¯t,k−1)−ϕn(t,¯t)/parenleftBig
1+¯ξ†
1(n,t,¯t)k+¯ξ†
2(n,t,¯t)k2+.../parenrightBig
, P→P0.(4.16)
The diﬀerential Ψ( n,t,¯t,P)Ψ†(n′,t′,¯t′,P)dΩ(P) is holomorphic everywhere on Γ ex-
cept the points P∞,P0. Therefore, sum of the residues at these points is equal to zero
and we have /parenleftBig/contintegraldisplay
C∞−/contintegraldisplay
C0/parenrightBig
Ψ(n,t,¯t,P)Ψ†(n′,t′,¯t′,P)dΩ(P) = 0 (4.17)
for alln,n′,t,t′, whereC∞(C0) is a small contour around the point P∞(P0).
18The explicit form of the two-point Baker-Akhiezer function is
Ψ(n,t,¯t,P) = exp/parenleftBig
nΩ0(P)−nΩ00+/summationdisplay
j≥1tjΩj(P)+/summationdisplay
j≥1¯tj(¯Ωj(P)−¯Ωj(P∞)/parenrightBig
×Θ/parenleftBig/vectorA(P)+n/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig
n/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig,
(4.18)
where we use the notation introduced in section 2. It is assumed tha t the path of
integration in the Abel map and Ω j,¯Ωjis the same. Tending P→P0in (4.18) and
comparing with (4.12), we obtain:
eϕn(t,¯t)= exp/parenleftBig
n(¯Ω00−Ω00)+/summationdisplay
j≥1(tjΩj(P0)−¯tj¯Ωj(P∞)/parenrightBig
×Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P∞)/parenrightBig
Θ/parenleftBig
(n+1)/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P0)/parenrightBig
Θ/parenleftBig
n/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig.
(4.19)
The explicit form of the dual Baker-Akhiezer function is
Ψ†(n,t,¯t,P) = exp/parenleftBig
−nΩ0(P)+nΩ00−/summationdisplay
j≥1tjΩj(P)−/summationdisplay
j≥1¯tj(¯Ωj(P)−¯Ωj(P∞)/parenrightBig
×Θ/parenleftBig/vectorA(D)+/vectorK−/vectorA(P0)/parenrightBig
Θ/parenleftBig/vectorA(P)+/vectorA(D)+/vectorK−/vectorA(P∞)−/vectorA(P0)/parenrightBig
×Θ/parenleftBig
−/vectorA(P)+(n+1)/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK+2/vectorA(P∞)/parenrightBig
Θ/parenleftBig
(n+1)/vectorU0+/summationtext
j≥1/vectorUjtj+/summationtext
j≥1/vectorVj¯tj−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig.(4.20)
The standard argument shows that the Baker-Akhiezer function satisﬁes the linear
equation
∂t1Ψ(n) = Ψ(n+1)+vnΨ(n), (4.21)
where
vn(t,¯t) =∂t1ϕn(t,¯t). (4.22)
4.3 The tau-function
The tau-function for quasi-periodic solutions of the 2D Toda lattice is given by
τn(t,¯t) = exp/parenleftBig
−Q(n,t,¯t)/parenrightBig
Θ/parenleftBig
n/vectorU0+/summationdisplay
j≥1/vectorUjtj+/summationdisplay
j≥1/vectorVj¯tj+/vectorZ/parenrightBig
, (4.23)
19where the constant vector /vectorZis deﬁned in (3.19) and Q(n,t,¯t) is the following quadratic
form of the times n,t,¯t:
Q(n,t,¯t) =1
2/summationdisplay
i,jΩijtitj+1
2/summationdisplay
i,j¯Ωij¯ti¯tj+/summationdisplay
i,jωijti¯tj
+n/summationdisplay
j/parenleftBig
Ω0jtj+¯Ω0j¯tj/parenrightBig
+1
2(Ω00−¯Ω00)n2.(4.24)
Here we use the notation introduced in section 2.
In the simplest possible case Γ is a genus 0 Riemann surface (the Riema nn sphere). In
thiscasethetheta-functionisabsent, Ω j=kj,¯Ωj=k−j, Ω0= logkandsoΩ ij=¯Ωij= 0,
ωij=δij. Therefore, the tau-function in this case is the trivial one given by (4.2).
Using the relations presented in section 2, one can verify by straigh tforward calcula-
tions that
Ψ(n,t,¯t,P) =

kneξ(t,k)τ0(0,0)
τ0(−[k−1],0)τn(t−[k−1],¯t)
τn(t,¯t), P→P∞,
kneξ(¯t,k−1)+ω0τ0(0,0)
τ1(0,−[k])τn+1(t,¯t−[k])
τn(t,¯t), P→P0,(4.25)
Ψ†(n,t,¯t,P) =

k−ne−ξ(t,k)τ1(0,0)
τ1([k−1],0)τn+1(t+[k−1],¯t)
τn+1(t,¯t), P→P∞,
k−ne−ξ(¯t,k−1)−ω0τ1(0,0)
τ0(0,[k])τn(t,¯t+[k])
τn+1(t,¯t), P→P0.(4.26)
Hereω0=1
2(Ω00−¯Ω00). Recalling equations (4.6)–(4.9), we see that near the points P∞,
P0the Baker-Akhiezer functions essentially coincide (up to normalizat ion) with the wave
functions:
Ψ(n,t,¯t,P) =

τ0(0,0)
τ0(−[k−1],0)ψn(t,¯t,k), k→ ∞,
τ0(0,0)eω0
τ1(0,−[k])¯ψn(t,¯t,k), k→0,(4.27)
Ψ†(n,t,¯t,P) =

τ1(0,0)
τ1([k−1],0)ψ†
n(t,¯t,k), k→ ∞,
τ1(0,0)e−ω0
τ0(0,[k])¯ψ†
n(t,¯t,k), k→0,(4.28)
It remains to identify the bilinear relations (4.10) and (4.17). Equatio ns (4.27), (4.28)
state that they coincide if the following identities hold:
dΩ(P) =τ0(−[k−1],0)τ1([k−1],0)
τ0(0,0)τ1(0,0)dk
k, k→ ∞, (4.29)
20dΩ(P) =−τ1(0,−[k])τ0(0,[k])
τ0(0,0)τ1(0,0)dk
k, k→0. (4.30)
Let us prove the ﬁrst one. We have:
The r.h.s. of (4.29)
= exp/parenleftBig
−/summationdisplay
i,jΩijk−i−j
ij−/summationdisplay
jΩ0jk−j
j/parenrightBigΘ/parenleftBig/vectorA(P)−/vectorA(P∞)+/vectorZ/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(P∞)−/vectorU0−/vectorZ/parenrightBig
Θ/parenleftBig/vectorZ/parenrightBig
Θ/parenleftBig/vectorU0+/vectorZ/parenrightBigdk
k
=CΘ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D†)−/vectorK/parenrightBig
Θ2
∗/parenleftBig/vectorA(P)−/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorZ/parenrightBig
Θ/parenleftBig/vectorU0+/vectorZ/parenrightBigexp/parenleftBig
−Ω0(P)+Ω00/parenrightBig
dζ
=Θ/parenleftBig/vectorA(P)−/vectorA(D)−/vectorK/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(D†)−/vectorK/parenrightBig
Θ∗/parenleftBig/vectorA(P0)−/vectorA(P∞)/parenrightBig
dζ
Θ/parenleftBig/vectorZ/parenrightBig
Θ/parenleftBig/vectorU0+/vectorZ/parenrightBig
Θ∗/parenleftBig/vectorA(P)−/vectorA(P∞)/parenrightBig
Θ∗/parenleftBig/vectorA(P)−/vectorA(P0)/parenrightBig,
wheredζis the diﬀerential (2.30) and when passing from the second to the th ird line we
have used (2.29) and (4.14). One can see that the r.h.s. is a well-deﬁn ed meromorphic
diﬀerential on Γ with the only simple poles at the points P∞,P0and simple zeros at the
divisorsD,D†. Therefore, it must be proportional to dΩ. The identity (4.30) can be
proved in a similar way.
5 The BKP hierarchy
5.1 Bilinear relations for the BKP hierarchy
The BKP hierarchy was introduced in [19, 20]. The set of independen t variables in
the BKP hierarchy is the inﬁnite set of “times” tjnumbered by odd indices: to=
{t1,t3,t5,...}. The universal dependent variable is the tau-function τ(to). All equations
of the hierarchy are encoded in the bilinear relation
/contintegraldisplay
C∞eξ(to−t′
o,z)τ(to−2[z−1]o)τ(t′
o+2[z−1]o)dz
2πiz=τ(to)τ(t′
o) (5.1)
valid for arbitrary to,t′
o, where
to±2[z−1]o=/braceleftBig
t1±2z−1,t3±2
3z−3,t5±2
5z−5,.../bracerightBig
and
ξ(to,z) =/summationdisplay
j≥1,oddtjzj. (5.2)
The contour C∞is a big circle encircling ∞. The simplest (trivial) solution of (5.1) is
τ(to) = 1.
Sett′o=to−2[a−1]o−2[b−1]o−2[c−1]oin (5.1), then
eξ(to−t′
o,z)=(a+z)(b+z)(c+z)
(a−z)(b−z)(c−z)
21and the residue calculus gives the following equation:
(a+b)(a+c)(b−c)τ[a]τ[bc]+(b+a)(b+c)(c−a)τ[b]τ[ac]
+(c+a)(c+b)(a−b)τ[c]τ[ab]+(a−b)(b−c)(c−a)ττ[abc]= 0,(5.3)
whereτ[a]:=τ(to+ 2[a−1]o),τ[ab]:=τ(to+2[a−1]o+2[b−1]o),τ[abc]:=τ(to+2[a−1]o+
2[b−1]o+2[c−1]o). For the ﬁrst time it has appeared in [21]. Taking the limit c→ ∞, we
get the equation
ττ[ab]/parenleftbigg
1+1
a+b∂t1logτ
τ[ab]/parenrightbigg
=τ[a]τ[b]/parenleftBigg
1+1
a−b∂t1logτ[b]
τ[a]/parenrightBigg
.(5.4)
The diﬀerential equations of the hierarchy are obtained by expand ing it in inverse powers
ofa,b.
The wave function ψ(to,z) is connected with the tau-function by the formula
ψ(to,z) =ψBKP(to,z) =eξ(to,z)τ(to−2[z−1]o)
τ(to). (5.5)
In terms of the wave function, the bilinear relation acquires the for m
/contintegraldisplay
C∞ψ(to,z)ψ(t′
o,−z)dz
2πiz= 1. (5.6)
The KP and BKP hierarchies are closely related with each other. Their interrelations
were discussed in [9, 11], see also the recent review [22]. The latter ca n be regarded
as a subhierarchy of the former, with all times with even indices being ﬁxed to 0 and
some strong restrictions in the space of solutions. Let t•be the set of times t•=
{t1,0,t3,0,t5,0,...}and letτKP(t) be the KP tau-function. The following constraint
distinguishes those KP tau-functions that give rise to solutions of t he BKP hierarchy:
/parenleftBig
τKP(t•−[z−1])/parenrightBig2=τKP(t•)τKP(t•−2[z−1]o). (5.7)
Moreover, the BKP tau-function is the square root of the KP tau- function:
τ(to) =/radicalBig
τKP(t•). (5.8)
Taking this into account, one can rewrite (5.7) in the form
τKP(t•−[z−1]) =τ(to)τ(to−2[z−1]o). (5.9)
Comparing (3.5) and (5.5), we then conclude that
ψKP(t•,z) =ψBKP(to,z), (5.10)
so the wave functions in the two hierarchies are essentially the same .
225.2 The Baker-Akhiezer function
The quasi-periodic solutions of the BKP hierarchy can be construct ed along the same
lines as those of the KP hierarchy. However, while in the latter case o ne could start from
an arbitrary genus galgebraic curve and arbitrary eﬀective divisor of degree gon it, in
the BKP case the algebraic-geometrical data underlying the solutio n are not arbitrary.
Namely, the algebraic curve must admit a holomorphic involution ιwith two ﬁxed points
one of which is P∞(and the other one is P0). From the Riemann-Hurwitz formula it
then follows that gis even:g= 2g0. The divisor is also subject to some restriction (see
(5.11) below).
The Baker-Akhiezer function is deﬁned in the same way as in the begin ning of section
3.2. Aswehaveseen, itessentiallycoincideswiththewavefunction. U ndertheconditions
outlined above, it can be explicitly constructed either in terms of the Riemann theta-
functions, as in section 3.2 (the left hand side of (5.10), or in terms o f the Prym theta-
functions (the right hand side of (5.10). The identity (5.10) states that these two ways
are equivalent and lead to the same result.
Admissible divisors. We call the eﬀective divisor D=Q1+...+Qgadmissible if 2g
pointsQi,ιQiare zeros of a meromorphic diﬀerential dΩ which has simple poles at the
ﬁxed points of the involution P0(with residue +1) and P∞(with residue −1). In other
words, admissible divisors are subject to the condition
D+ιD=K+P0+P∞, (5.11)
whereKis the canonical class. Taking the Abel map (we recall that the initial point of
the Abel map is P0), we have
/vectorA(D)+/vectorA(ιD)+2/vectorK=/vectorA(P∞),
or
ι/parenleftBig/vectorA(D)−1
2/vectorA(P∞)+/vectorK/parenrightBig
=−/parenleftBig/vectorA(D)−1
2/vectorA(P∞)+/vectorK/parenrightBig
, (5.12)
whence we conclude that
/vector z=−/vectorA(D)−/vectorK+1
2/vectorA(P∞) (5.13)
belongs to the Prym variety (cf. (3.19)). In some formulas below we treat/vector zas a vector
belonging to Cg0(via the inverse map σ−1).
Baker-Akhiezer function in terms of Prym theta-functions. The explicit form
of the Baker-Akhiezer function in terms of the Prym theta-funct ions and Abel-Prym map
is
Ψ(to,P) = exp/parenleftBig/summationdisplay
j≥1,oddtjΩj(P)/parenrightBigΘPr/parenleftBig/vectorAPr(P)+/summationtext
j≥1,odd/vectorUjtj+/vector z/parenrightBig
ΘPr/parenleftBig
/vector z)/parenrightBig
ΘPr/parenleftBig/vectorAPr(P)+/vector z/parenrightBig
ΘPr/parenleftBig/summationtext
j≥1,odd/vectorUjtj+/vector z/parenrightBig.(5.14)
This function has poles at the divisor Dand the essential singularity at the point P∞
with the expansion of the same form (3.8). The diﬀerential Ψ( to,P)Ψ(to,ιP)dΩ is
23holomorphic everywhere except the points P0,P∞, where it has simple poles. Not-
ing that lim
P→P∞Ψ(to,P)Ψ(to,ιP) = 1 and using the residue theorem, we conclude that
Ψ(to,P0) =±1. Since Ψ(0 ,P0) = 1 and this function is continuous in to, we see that we
should choose the plus sign:
Ψ(to,P0) = 1. (5.15)
Consider now the diﬀerential Ψ( to,P)Ψ(t′
o,ιP)dΩ. This diﬀerential, too, is holo-
morphic everywhere on Γ except the points P0,P∞, where it has simple poles. Since
Ψ(to,P0) = Ψ(t′
o,P0) = 1, the residue at P0is equal to 1, whence the residue at P∞is
equal to −1 and thus the bilinear relation
/contintegraldisplay
C∞Ψ(to,P)Ψ(t′
o,ιP)dΩ = 1 (5.16)
holds for all to,t′
o.
The standard argument based on uniqueness of the Baker-Akhiez er function shows
that it satisﬁes the linear equation
∂t3Ψ =∂3
xΨ+3u∂xΨ, x=t1, u=∂xξ1. (5.17)
Baker-Akhiezer function in terms of Riemann theta-functio ns.Alternatively,
one can give an explicit expression for the Baker-Akhiezer function in terms of the Rie-
mann theta-functions and Abel map according to (3.13):
Ψ(to,P) = exp/parenleftBig/summationdisplay
j≥1,oddtjΩj(P)/parenrightBigΘ/parenleftBig/vectorA(P)−/vectorA(P∞)+/summationtext
j≥1,odd/vectorUjtj+/vectorZ/parenrightBig
Θ/parenleftBig/vectorZ/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(P∞)+/vectorZ/parenrightBig
Θ/parenleftBig/summationtext
j≥1,odd/vectorUjtj+/vectorZ/parenrightBig,(5.18)
/vectorZ=/vector z+1
2/vectorA(P∞). (5.19)
The equivalence of (5.14) and (5.18) is based on the following remarka ble identity:
Θ2/parenleftBig/vectorA(P)−/vectorA(P∞)+/vectorZto/parenrightBig
=C(P)Θ/parenleftBig/vectorA(P)−/vectorA(ιP)+/vectorZto/parenrightBig
Θ/parenleftBig/vectorZto/parenrightBig
(5.20)
valid for any vector /vectorZto=−/vectorA(D)−/vectorK+/vectorA(P∞)+/summationtext
j≥1,odd/vectorUjtj=/vectorZ+/summationtext
j≥1,odd/vectorUjtj, where
Dis an admissible divisor. Indeed, substituting (5.20) into (5.18) and us ing (2.45), we
get (5.14). We note that identity (5.20) is nothing else than identity ( 5.7) for the KP
tau-functions that give rise to solutions of the BKP hierarchy.
Proof of identity (5.20). The proof of (5.20) goes along the lines of the proof of
a similar identity given in [23]. This proof belongs to I.Krichever. For ea chQ∈Γ,
Q/\e}atio\slash=P0,P∞, letdΩQ(P) be the unique normalized meromorphic diﬀerential of the third
kind with simple poles at QandιQwith residues +1 and −1 respectively and let Ω Q(P)
be the corresponding abelian integral
ΩQ(P) =/integraldisplayP
P∞dΩQ. (5.21)
24Consider the function Ψ Q(to,P) deﬁned by the formula
ΨQ(to,P) = exp/parenleftBig
ΩQ(P)+/summationdisplay
j≥1,oddtjΩj(P)/parenrightBig
×Θ/parenleftBig/vectorA(P)−/vectorA(P∞)+/vectorA(Q)−/vectorA(ιQ)+/summationtext
j≥1,odd/vectorUjtj+/vectorZ/parenrightBig
Θ/parenleftBig/vectorZ/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(P∞)+/vectorZ/parenrightBig
Θ/parenleftBig/summationtext
j≥1,odd/vectorUjtj+/vectorA(Q)−/vectorA(ιQ)+/vectorZ/parenrightBig.
(5.22)
It is easy to check that Ψ Q(to,P) is the Baker-Akhiezer function corresponding to the
non-eﬀective divisor D+ιQ−Q. Indeed, the Riemann bilinear identity gives the relation
1
2πi/contintegraldisplay
bαdΩQ=/vectorA(Q)−/vectorA(ιQ). Hence the right hand side of (5.22) does not depend on a
choice of the integration path. In a neighborhood of P∞the function Ψ Q(to,P) has the
form
ΨQ(to,P) =eξ(to,k)/parenleftBig
1+ξQ,1(to)k−1+ξQ,2(to)k−2+.../parenrightBig
, P→P∞.(5.23)
Finally, this function has poles at Dand an additional pole at ιQ, where the factor
eΩQ(P)in (5.22) has simple pole. Furthermore, this factor vanishes at P=Q, therefore
ΨQ(to,Q) = 0.
Let us consider the diﬀerential Ψ Q(to,P)ΨQ(to,ιP)dΩ. By the same argument as
above, it is a meromorphic diﬀerential with no poles at DandιD. A possible pole at ιQ
is canceled by the zero of Ψ QatQ. Hence this diﬀerential has simple poles at the points
P0andP∞only. Then the same arguments as in the proof of (5.15) give the equ ation
Ψ2
Q(to,P0) = 1⇒ΨQ(to,P0) =±1. (5.24)
It turns out that, in contrast to (5.15), the correct sign here is −1:
ΨQ(to,P0) =−1. (5.25)
(This looks like a counter-intuitive fact!) The correct sign can be det ermined by the
following argument. The function Ψ Q(to,P0) is continuous in toandQforQ/\e}atio\slash=P∞.
Therefore, in order to ﬁnd the correct sign, we set to= 0 and choose Qin a neighborhood
ofP∞with local parameter k−1. By the deﬁnition of Ω Q(P) we have
eΩQ(P)=k(P)−k(Q)
k(P)+k(Q)/parenleftBig
1+O(k−1(P))/parenrightBig
.
Foranyﬁxed positive r≪1onecanchoose ηsuch thatfor |k−1(Q)|<ηand|k−1(P)|=r
the inequality/vextendsingle/vextendsingle/vextendsingle1+eΩQ(P)/vextendsingle/vextendsingle/vextendsingle<Mηholds with a constant Mindependent of η. Moreover,
for any ﬁxed path from a point P′,|k−1(P′)|=r, toP0there exists a constant M1(which
depends onthepathbut doesnotdepend on η)such thattheinequality/vextendsingle/vextendsingle/vextendsingle/integraldisplayP0
P′dΩQ/vextendsingle/vextendsingle/vextendsingle<M1η
holds. It then follows that for a ﬁxed path from P∞toP0
lim
Q→P∞eΩQ(P0)=−1. (5.26)
25In fact if we deﬁne ˜ΩQ(P) =/integraldisplayP
Q0dΩQwith some initial point Q0→P∞, then the result
depends on the order of the limits:
lim
Q0→P∞lim
Q→P∞e˜ΩQ(P0)= 1 but lim
Q→P∞lim
Q0→P∞e˜ΩQ(P0)=−1,
and our case is the latter limit1. The ratio of theta-functions in (5.22) is a continuous
function of Qwhich tends to 1 as Q→P∞and thus equation (5.25) is proved.
Now consider the diﬀerential Ψ Q(to,P)Ψ(to,ιP)dΩ. It is a meromorphic diﬀerential
with possible poles at P0,P∞andιQ. From (5.15), (5.25) it follows that the sum of
residues at P0,P∞equals−2. Therefore,
res
P=ιQ/parenleftBig
ΨQ(to,P)Ψ(to,ιP)dΩ(P)/parenrightBig
= 2. (5.27)
From (5.15) it follows that the diﬀerential Ψ Q(to,P)∂t1Ψ(to,ιP)dΩ is holomorphic at P0.
Then the residue argument implies that
res
P=ιQ/parenleftBig
ΨQ(to,P)∂t1Ψ(to,ιP)dΩ(P)/parenrightBig
=−res
P=P∞/parenleftBig
ΨQ(to,P)∂t1Ψ(to,ιP)dΩ(P)/parenrightBig
.(5.28)
The right hand side of (5.28) can be expressed in terms of the ﬁrst c oeﬃcientsξ1and
ξQ,1of the expansions of Ψ and Ψ QaroundP∞:
res
P=P∞/parenleftBig
ΨQ(to,P)∂t1Ψ(to,ιP)dΩ(P)/parenrightBig
=ξQ,1(to)−ξ1(to). (5.29)
From (5.27), (5.28) and (5.29) it follows that
∂t1logΨ(to,Q) =−1
2/parenleftBig
ξQ,1(to)−ξ1(to)/parenrightBig
. (5.30)
Equation (2.10) implies that /vectorA(P)−/vectorA(P∞) =−/vectorU1k−1+O(k−2). Using this relation,
one can ﬁnd the ﬁrst coeﬃcients of the expansion of the ratios of t heta-functions in the
formulas for Ψ and Ψ QnearP∞:
ξQ,1(to)−ξ1(to) =c−∂t1logΘ/parenleftBig/vectorA(Q)−/vectorA(ιQ)+/vectorZto/parenrightBig
Θ/parenleftBig/vectorZto/parenrightBig, (5.31)
where
c=∂ΩQ(P)
∂k−1/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
P=P∞. (5.32)
The evaluation of formula (3.13) at P=Qyields
∂t1logΨ(to,Q) =∂t1logΘ/parenleftBig/vectorA(Q)+/vectorZto/parenrightBig
Θ/parenleftBig/vectorZto/parenrightBig+Ω1(Q). (5.33)
From the Riemann bilinear identity for the diﬀerentials dΩ1anddΩQit follows that
c= Ω1(ιQ)−Ω1(Q) =−2Ω1(Q).
Then from (5.30), (5.31) and (5.33) equation (5.20) follows.
1Wecanillustratethesomewhatcounter-intuitiveconclusion(5.26)b ythecasewhenΓistheRiemann
sphere, then
exp/integraldisplayP0
P∞dΩQ= exp/integraldisplayk0
∞/parenleftBigdz
z−q−dz
z+q/parenrightBig
=k0−q
k0+q, q=k(Q),
and this indeed tends to −1 asq→ ∞.
265.3 The tau-function
The tau-function of the BKP hierarchy is given by
τ(to) = exp/parenleftBig
−1
4/summationdisplay
i,joddΩijtitj/parenrightBig
ΘPr/parenleftBig/summationdisplay
j≥1,odd/vectorUjtj+/vector z/parenrightBig
. (5.34)
Equation (2.45) implies that it is indeed a square root of the KP tau-fu nction (3.18) at
t2j= 0.
It isinstructive tocomparetheBKPtau-functionwiththemKPtau- functionτmKP
n(t)
with even times put equal to zero. Using the connection between th e mKP and Toda
lattice hierarchies explained in section 4.1 and formula (4.23) for the T oda tau-function,
we can write the algebraic-geometrical mKP tau-function associat ed with curves with
involution:
τmKP
n(t)/vextendsingle/vextendsingle/vextendsingle
t2j=0= exp/parenleftBig
−1
2/summationdisplay
i,joddΩijtitj/parenrightBig
Θ/parenleftBig
n/vectorU0+/summationdisplay
j≥1,odd/vectorUjtj+/vectorZ/parenrightBig
.(5.35)
HereU0=/vectorA(P0)−/vectorA(P∞) =−/vectorA(P∞). From (2.45) we see that
τmKP
0(t)/vextendsingle/vextendsingle/vextendsingle
t2j=0=τmKP
1(t)/vextendsingle/vextendsingle/vextendsingle
t2j=0=τ2(to) (5.36)
and, furthermore,
τmKP
n(t)/vextendsingle/vextendsingle/vextendsingle
t2j=0=τmKP
1−n(t)/vextendsingle/vextendsingle/vextendsingle
t2j=0, n≥0. (5.37)
The constraint (5.37) is speciﬁc for the B-version of the Toda (or m KP) hierarchy dis-
cussed in [13].
Similarly to the KP case, using (2.42), we can see that
Ψ(to,P) =eξ(to,k)τ(0)τ(to−2[k−1]o)
τ(to)τ(−2[k−1]o)=τ(0)
τ(−2[k−1]o)ψ(to,k),(5.38)
where the BKP wave function ψ(to,k) is given by (5.5).
Finally, we are going to prove that the bilinear relation (5.6) for the wa ve function is
thesameasthebilinearrelation(5.16)fortheBaker-Akhiezerfunc tion. Theirequivalence
is based on the following identity:
dΩ(P) =τ(−2[k−1]o)τ(2[k−1]o)
τ2(0)dk
k(5.39)
or
dΩ(P) = exp/parenleftBig
−2/summationdisplay
i,joddΩijk−i−j
ij/parenrightBigΘPr(/vectorAPr(P)+/vector z)ΘPr(/vectorAPr(P)−/vector z)
Θ2
Pr(/vector z)dk
k.(5.40)
Using the relation (2.45) we can write this in terms of the Riemann thet a-functions:
dΩ(P) = exp/parenleftBig
−2/summationdisplay
i,joddΩijk−i−j
ij/parenrightBigdk
k
×
Θ/parenleftBig/vectorA(P)−/vectorA(ιP)−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(ιP)−/vectorA(D)−/vectorK/parenrightBig
Θ2/parenleftBig/vectorZ/parenrightBig
1/2
.
(5.41)
27Now, taking into account (2.49), we represent this identity in the fo rm
dΩ(P) =−2/radicalBig
dζ(P)dζ(ιP)
Θ∗(/vectorA(P)−/vectorA(ιP))
×
Θ/parenleftBig/vectorA(P)−/vectorA(ιP)−/vectorA(D)−/vectorK+/vectorA(P∞)/parenrightBig
Θ/parenleftBig/vectorA(P)−/vectorA(ιP)−/vectorA(D)−/vectorK/parenrightBig
Θ2/parenleftBig/vectorZ/parenrightBig
1/2
.
(5.42)
One can check that the right hand side is a well-deﬁned diﬀerential wit h zeros at D,ιD
and two simple poles at P0,P∞with residues ±1. Therefore, it indeed coincides with
dΩ.
Acknowledgments
The research has been supported in part within the framework of t he HSE University
Basic Research Program.
References
[1] A.ItsandV. Matveev, Schr¨ odinger operators with ﬁnite-gap spectrum and N-soliton
solutions of the Korteweg–de Vries equation , Teor. Mat. Fys. 23:1(1975) 51–68
(English translation: Theor. Math. Phys. 23:1(1975) 343–355).
[2] B. Dubrovin, V. Matveev and S. Novikov, Nonlinear equations of Korteweg-de Vries
type, ﬁnite-zone linear operators and abelian varieties , Uspekhi Mat. Nauk 31:1
(1976)55–136(Englishtranslation: RussianMathematical Survey s31:1(1976)59—
146).
[3] I. Krichever, Integration of nonlinear equations by methods of algebraic geometry ,
Funkt. Anal. i ego Pril. 11:1(1977) 15–31 (English translation: Funct. Anal. and
Its Appl. 11:1(1977) 12–26).
[4] I.Krichever, Methodsofalgebraicgeometryinthetheoryofno nlinear equations, Us-
pekhi Mat. Nauk 32:6(1977) 183–208 (English translation: Russian Mathematical
Surveys32:6(1977) 185–213).
[5] B. Dubrovin, Theta functions and nonlinear equations , Uspekhi Mat. Nauk 36:2
(1981) 11–80 (English translation: Russian Mathematical Surveys 36:2(1981) 11–
92).
[6] B. Dubrovin, Integrable systems and Rienmann surfaces , Lecture Notes,
https ://people.sissa.it/dubrovin/rsnleqweb.pdf.
[7] T. Shiota, Characterization of Jacobian varietes in terms of soliton e quations, Inv.
Math.83(1986) 333–382.
28[8] I.M. Krichever, Periodic non-abelian Toda chain and its two-dimensional ge neral-
ization, Uspekhi Mat. Nauk 36:2(1981) 72–80 (Appendix to Dubrovin’s paper [5]).
[9] E. Date, M. Jimbo, M. Kashiwara and T. Miwa, Quasi-periodic solutions of the
orthogonalKP equation– Transformationgroups of soliton e quationsV ,Publ.RIMS,
Kyoto Univ. 18(1982) 1111–1119.
[10] S. Natanzon, Diﬀerential equations on the Prym theta function. A realnes s criterion
for two-dimensional ﬁnite-zone potential Schr¨ odinger op erators, Funk. Anal. i ego
Pril.26(1992) 17–26 (English translation: Func. Anal. Appl. 26(1992) 13–20).
[11] E. Date, M. Jimbo, M. Kashiwara and T. Miwa, Transformation groups for soli-
ton equations , in “Nonlinear Integrable Systems – Classical Theory and Quantum
theory”, M. Jimbo and T. Miwa (eds.), World Sci., Singapore, 1983, pp . 39–119.
[12] M. Jimbo and T. Miwa, Soliton equations and inﬁnite dimensional Lie algebras ,
Publ. RIMS, Kyoto University 19(1983) 943–1001.
[13] K. Ueno and K. Takasaki, Toda lattice hierarchy , Adv. Studies in Pure Math. 4
(1984) 1–95.
[14] I. Krichever, T. Shiota, Soliton equations and the Riemann-Schottky problem , Hand-
bookofmoduli, Vol.II,205–258,Adv.Lect.Math.(ALM),25,Int .Press, Somerville,
MA, 2013.
[15] G. Springer, Introduction to Riemann surfaces , Addison-Wesley Publishing Com-
pany, Inc. Reading, Massachusetts, U.S.A., 1957.
[16] J.D. Fay, Theta functions on Riemann surfaces , Lect. Notes Math., Vol. 352, Berlin,
Heidelberg, New York: Springer, 1973.
[17] D. Mumford, Tata Lectures on Theta I, II , Progress in Mathematics, Vol. 28, 43,
Birkh¨ auser, Boston, Basel, Stuttgart, 1983, 1984.
[18] I. Krichever and A. Zabrodin, Kadomtsev-Petviashvili turning points and CKP hi-
erarchy, Commun. Math. Phys. 386(2021) 1643–1683, arXiv:2012.04482.
[19] E. Date, M. Jimbo, M. Kashiwara and T. Miwa, KP hierarchy of orthogonal and
symplectic type – Transformation groups for soliton equati ons VI, J. Phys. Soc.
Japan50(1981) 3813–3818.
[20] E. Date, M. Jimbo, M. Kashiwara and T. Miwa, Transformation groups for soliton
equations IV. A new hierarchy of soliton equations of KP type , Physica D 4D(1982)
343–365.
[21] T. Miwa, On Hirota’s diﬀerence equations , Proc. Japan Acad. Ser. A 58(1982)
9–12.
[22] A. Zabrodin, Kadomtsev-Petviashvili hierarchies of types B and C , Teor. Mat. Fys.
208(2021) 15–38 (English translation: Theor. Math. Phys. 208(2021) 865–885),
arXiv:2102.12850.
29[23] I. Krichever and A. Zabrodin, Toda lattice with constraint of type B ,
arXiv:2210.12534.
30