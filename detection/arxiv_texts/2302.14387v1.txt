arXiv:2302.14387v1  [econ.EM]  28 Feb 2023Uniﬁed and robust Lagrange multiplier type
tests for cross-sectional independence in
large panel data models
Zhenhong Huang∗, Zhaoyuan Li†and Jianfeng Yao‡
Abstract
This paper revisits the Lagrange multiplier type test for th e null hypothesis of no
cross-sectional dependence in large panel data models. We p ropose a uniﬁed test
procedure and its power enhancement version, which show rob ustness for a wide
class of panel model contexts. Speciﬁcally, the two procedu res are applicable to
both heterogeneous and ﬁxed eﬀects panel data models with the presence of weakly
exogenous as well as lagged dependent regressors, allowing for a general form of
non-normal error distribution. With the tools from Random M atrix Theory, the
asymptotic validity of the test procedures is established u nder the simultaneous limit
scheme where the number of time periods ( T) and the number of cross-sectional units
(n) go to inﬁnity proportionally. The derived theories are acc ompanied by detailed
Monte Carlo experiments, which conﬁrm the robustness of the two tests and also
suggest the validity of the power enhancement technique.
Keywords: Cross-sectional dependence, Large panels, Coeﬃcient heterog eneity, Weak ex-
ogenous, Random Matrix Theory
∗Department of Statistics and Actuarial Science, The University of Hong Kong. Email: zh-
huang7@connect.hku.hk
†School of Data Science, The Chinese University of Hong Kong, Shen zhen. Email:
lizhaoyuan@cuhk.edu.cn
‡SchoolofDataScience, The ChineseUniversityofHongKong(Shen zhen). Email: jeﬀyao@cuhk.edu.cn
11 Introduction
In panel data analysis, the problem of error cross-sectional dep endence has attracted
substantial attention in recent years. This cross-sectional dep endence can arise for various
reasons, such as omitted common or spatial eﬀects. Ignoring err or cross-sectional depen-
dence can have dramatic eﬀects on conventional panel estimator s, e.g., the least squares,
ﬁxed and random eﬀect estimators, and yield invalid inferential proc edures such as com-
monly used panel unit root tests, where these tests assume cros s-sectional independence.
Therefore, designing eﬃcacious tests for cross-sectional depe ndence is essential in panel
data analysis.
There has been much work on testing for cross-sectional depend ence in the literature.
Breusch and Pagan (1980) proposed a Lagrange multiplier ( LM) test based on the squared
pair-wise Pearson correlation coeﬃcients of the residuals. Under t he null hypothesis of no
cross-sectional dependence, the LMtest is asymptotically chi-squared distributed with
T→ ∞andnﬁxed. However, it is not applicable for large n, which renders its popularity
considering recent researches have focused on the large panels w here both Tandncan be
large. In such high dimensional setting, there are two mainstream s chemes considered by
statisticians andeconometricians, beingknown assequential limit sc heme andsimultaneous
limit scheme deﬁned as following:
SEQ-L:T→ ∞,followed by n→ ∞,
and
SIM-L: (n,T)→ ∞such thatn
T→c∈(0,∞),
respectively. Under the SIM-L scheme, Frees (1995) proposed a distribution free LMtype
test allowing for large n,R2
AVE, based on the squared pair-wise Spearman rank correlation
coeﬃcients, which is asymptotically distributed as Chi-squared. The test has however im-
posed limitations on the number of regressors and could be oversize d for small T. Pesaran
2(2004) suggested a scaled version of the LMtest, denoted by CDLM, and showed its
asymptotic property. The author however pointed out that the CDLMtest is not correctly
centered at zero for small T, and is likely to exhibit large size distortions as nincreases.
Pesaran (2004) also proposed an alternative approach, the CDPtest, which employs pair-
wise Pearson correlation coeﬃcients of the residuals as well, but with out squaring them.
This test has universally correct size under a broad course of pane l data model designs, but
it lacks power when correlation coeﬃcients within panel units have va riable signs leading
to certain cancellation eﬀect. Particularly, this happens when the e rrors are generated
from a factor model where the loadings average to zero. Pesaran (2015) extended the
CDPtest to the scenario of weak cross-sectional dependence. Pesa ran et al. (2008) put
forward another approach, LMadj, by deriving the exact expected values and variances
of the squared correlation coeﬃcients under the assumption of no rmally distributed errors
and strictly exogenous regressors. By applying the classical cent ral limit theory, it is shown
that the LMadjtest converges to standard normal distribution under the SEQ-L scheme.
Bailey et al. (2021) proposed a new LMtype test, LMRMT, and proved its asymptotic
normality under the SIM-L scheme using Random Matrix Theory. How ever, they require
the assumptions of normal regressors and normal errors. In a s lope homogeneity setting,
Baltagi et al. (2012) analyzed the performance of the CDLMtest in the ﬁxed eﬀects panel
data model, then presented a bias corrected test, LMbc, and established its asymptotic nor-
mality under the SIM-L scheme assuming normal errors and strictly exogenous regressors.
Baltagi et al. (2012) also showed that the LMbctest can be applied to dynamic panel data
model with ﬁxed eﬀects, using the within estimator proposed by Hah n and Kuersteiner
(2002). However, the slope homogeneity restriction has often be en rejected in empirical
analyses, see a detailed survey by Baltagi et al. (2008). Meanwhile, there are limited tests
designed for the dynamic panel data model. Examples include the GMM approach of
Saraﬁdis et al. (2009) applied to panels with homogeneous coeﬃcient s under factor model
3representation, and a heteroskedasticity robust LMtest,LMHOY, of Halunga et al. (2017)
withn2/T→0 required.
We make two distinct contributions in this paper. First, we propose a LMtype test
statisticthatcanbeappliedtoawideclassoflinearpanelmodels. Spe ciﬁcally, weshowthat
our test is robust to both static and dynamic heterogeneous pane l data models with weakly
exogenous regressors and non-normal errors. With tools from R andom Matrix Theory,
we treat sample correlation matrix of residuals directly as a random m atrix to establish
the asymptotic normality of the test statistics under the SIM-L sc heme, which has been
suggested to be a more reliable strategy when dealing with high-dimen sional statistical
problems, see Yao et al. (2015). We also show that the proposed te st is mathematically
equivalent to both the LMRMTand the LMbctest. This ﬁnding theoretically enriches
theLMRMTandLMbctest by relaxing the restrictive assumptions they need. It is worth
mentioning that the existing literature on testing for cross-sectio nal dependence has mostly
focusedonthecaseofstrictly exogenous regressors, including t heLMadj,LMbcandLMHOY
tests. Though Pesaran (2015) showed that the CDPtest is also applicable to autoregressive
panel data models so long as the errors are symmetrically distribute d, the properties of the
CDPtest for dynamic panels that include weakly exogenous regressors have not yet been
investigated. The new proposed test ﬁlls this gap for the weakly exo genous regressors case,
and to the best of our knowledge, there is no such a uniﬁed test so f ar.
Second, weak cross-sectional dependence is common in empirical a pplications, see, for
example, Bailey et al. (2016), Ertur and Musolesi (2017). This leads to a sparse correlation
structure with few nonzero oﬀ-diagonal entries. Therefore, it is important to test the
existence of such weak cross-sectional dependence, which corr esponds to sparse alternatives
in the high-dimensional statistics literature. The mainstream of mor e powerful tests for
sparse alternatives are based on the maxima absolute value of samp le correlations, see
Cai et al. (2011) and Hall et al. (2010). However, these tests req uire stringent conditions
4that are ‘unfeasible’ in econometric applications and often suﬀer fr om size distortions due
to slow rates of convergence. In view of this, we propose a novel a nd easy-implemented test
statistic for cross-sectional dependence based on the fourth m oment of sample correlation
to boost the power of detecting sparse alternatives. Again, this t est can be used in any
aforementioned panel setting under suitable conditions on higher m oments of the errors.
The remainder of the paper is organized as follows. Section 2 discuss es the existing
tests for no cross-sectional dependence. Section 3 introduces the new test statistics and
establishes the limiting distributions under the SIM-L scheme. Sectio ns 4 and 5 demon-
strate that the proposed tests can be extended to both the dyn amic and ﬁxed eﬀects panel
data models. Section 6 reports the results of Monte Carlo simulation s. Section 7 provides
concluding remarks and further discussions.
Notations. Throughout the paper, for a matrix A∈ Rn×n,tr(A) represents the
traceA. We use λ1(A),...,λ n(A) to denote neigenvalues of A. Further, for vectors
a,b∈ Rn×1, we write /an}bracketle{ta,b/an}bracketri}ht=aTbfor their scalar product. In addition. /bardbl·/bardblrepresents
the Euclidean norm for a vector and the induced operator norm for a matrix.
2 Existing tests for cross-sectional dependence based
on sample correlation
Consider the heterogeneous panel data model:
yit=x′
itβi+vit,fori= 1,···,n;t= 1,···,T, (1)
whereiindexes the cross-sectional units and tthe time series observations, yitis the
response variable and xitis ak×1 vector of regressors with unity on the ﬁrst row with
coeﬃcients βiallowed to vary cross the cross-sectional units. For each i, the error term,
vit, are assumed to be serially independent with zero mean and ﬁnite var iance. The null
5hypothesis of interest in the literature is
H0:vitis independent of vjt,for alltandi/ne}ationslash=j.
WhenTis suﬃciently large, a natural way to test H0is based on some reliable estimates
(ˆρij) for the pair-wise error sample correlations ( ρij). Speciﬁcally,
ˆρij= ˆρji=/summationtextT
t=1ˆvitˆvjt/parenleftBig/summationtextT
t=1ˆv2
it/parenrightBig1/2/parenleftBig/summationtextT
t=1ˆv2
jt/parenrightBig1/2, (2)
where ˆvitis the Ordinary Least Squares (OLS) estimate of vitin (1) deﬁned by
ˆvit=yit−x′
itˆβi, (3)
withˆβibeing the OLS estimate of βiby regressing the Tsample observations yitonxit
for each i. In the seemingly unrelated regression equations (SURE) context with ﬁxed n
and asT→ ∞, Breusch and Pagan (1980) proposed a Lagrange multiplier ( LM) test for
testingH0given by
LM=T
2/summationdisplay
1≤i/negationslash=j≤nˆρ2
ij=T
2/bracketleftBig
tr(ˆR2)−n/bracketrightBig
, (4)
whereˆR= (ˆρij)1≤i,j≤nis the sample correlation matrix of residuals. It has been shown
thatLMd−→χ2
d, whered=1
2n(n−1) under H0and normal errors assumption. However,
it is well known that the LMtest is severely oversized when nis relatively large compared
toT. To amend this size distortion, Pesaran (2004) put forward a scale d version of the
LMtest given by
CDLM=/radicalBigg
1
4n(n−1)/summationdisplay
1≤i/negationslash=j≤n(Tˆρ2
ij−1) =/radicalBigg
T2
4n(n−1)/bracketleftbigg
tr(ˆR2)−n−n(n−1)
T/bracketrightbigg
,(5)
which is asymptotically distributed as N(0,1) under the SEQ-L scheme. There are two
important cases where the CDLMtest isnot reliable. Firstly, asBaltagi et al. (2012) noted,
it will exhibit substantial size distortions in the homogeneous panel d ata model. Secondly,
Pesaran (2004) pointed out that, in ﬁnite Tcase, the CDLMtest tends to over-reject the
6null due to the fact that E(Tˆρ2
ij−1) is not correctly centered at zero. This kind of bias
even accumulates as nbecomes larger. In this case, Dufour and Khalaf (2002) suggeste d to
apply bootstrapmethod to (5). Pesaran (2004) and Pesaran (20 15) proposed analternative
adjustment based on the raw, non-squared, sample correlation c oeﬃcients given by
CDP=/radicalBigg
T
2n(n−1)/summationdisplay
1≤i/negationslash=j≤nˆρij. (6)
The test is asymptotically distributed as standard normal under bo th SEQ-L and SIM-L
schemes. However, it is widely reported that the CDPtest suﬀers from a speciﬁc loss
of power when the loadings have zero mean in the cross-sectional d imension under factor
representation. Baltagi et al. (2012) proposed another modiﬁed version of the CDLMtest
for ﬁxed eﬀect panel data model, LMbc, given by
LMbc=CDLM−n
2(T−1)=/radicalBigg
T2
4n(n−1)/bracketleftBigg
tr(ˆR2)−n−n(n−1)
T−n/radicalbig
n(n−1)
T(T−1)/bracketrightBigg
.
(7)
The test is asymptotically standard normal with normal errors and strictly exogenous
regressors under the SIM-L scheme. Pesaran et al. (2008) prop osed an alternative ﬁnite
sample adjustment to the LMtest by deriving the exact moments of the squared sample
correlation coeﬃcients under normal errors and strictly exogeno us regressors assumptions.
TheirLMadjtest statistic is given by
LMadj=/radicalBigg
1
2n(n−1)/summationdisplay
1≤i/negationslash=j≤n(T−k)ˆρ2
ij−µT,i,j
σT,i,j, (8)
where
µT,i,j=1
T−ktr(MiMj), σ2
T,i,j= [tr(MiMj)]2a1T+tr(MiMj)2a2T,
and
a1T=a2T−1
(T−k)2, a2T=3
(T−k+2)2,
Mi=IT−X′
i(XiX′
i)−1Xiis the projection matrix, where Xi= (xi1,···,xiT) contains T
samples on the kregressors for the i-th individual regression. Under H0and the SEQ-L
7scheme,LMadjwas shown to be asymptotically distributed as N(0,1).However, as pointed
out by Pesaran et al. (2008), the LMadjtest is not robust in panel data models with weakly
exogenous regressors. Bailey et al. (2021) proposed another mo diﬁedLMtest forheteroge-
nous panel data models based on Random Matrix Theory, LMRMT, given by
LMRMT=σ−1
RMT/bracketleftbigg
tr(ˆR2)−n−n2
T−n2
T2+n
T/bracketrightbigg
, (9)
where
σRMT=4n(2n+T)(n+2T)
T3−4(κ−1)n(n+T)2
T3−(κ−3)n(n−4T)2(n+T)2
T5(10)
withκ=3T(T−k−2)
(T+2)(T−k). Under the assumptions of normal regressors and normal error s, the
authors showed that LMRMTis asymptotically distributed as N(0,1) under the SIM-L
scheme. The application scopes of the discussed tests are summar ized in Table 1. (The
table also contains the new tests proposed in this paper in the last tw o columns so-called
RLMandRLMPE, which are developed later.)
3 The RLM test and its power enhancement
3.1 The RLM test
Motivated by the existing well-known tests based on the sum of squa red sample corre-
lation coeﬃcients in (4), (5), (7), (8) and (9), it is natural to cons ider the limiting behavior
oftr(ˆR2) under the SIM-L scheme. Throughout the paper, we consider th e following
assumptions.
Assumption 1. T→ ∞,n=n(T)→ ∞such that cT=n
T→c∈(0,∞).
Assumption 2. For each i, the errors, {vit}, are i.i.d distributed with mean 0 and variance
σ2
i.
8Table 1: Application scope of each test for cross-sectional indepe ndence
CDPLMadjLMbcLMRMTRLM RLM PE
Heterogeneous coeﬃcients /check /check ?/check /check /check
Fixed eﬀects panels * * /check * /check /check
Dynamic panels /check*/check * /check /check
Weakly exogenous regressors * ? ? * /check /check
Non-normal errors /check* * * /check /check
SIM-L /check?/check /check /check /check
Notes: “ /check” signiﬁes that the test can be applied in corresponding panel settin g with a
theoretical justiﬁcation. “*” means the test is empirically validated without however a
theoretical basis. “ ?” denotes that it remains unclear in the literature whether such tes t is
applicable.
Assumption 3. (i) The errors have uniformly bounded sixth moment, i.e.
supi,tE|vit|6+ǫ≤C1for some positive constant C1andǫ >0.
(ii) The errors have uniformly bounded eighth moment, i.e. supi,tE|vit|8+ǫ≤C2for some
positive constant C2andǫ >0.
For a static heterogeneous panel data model, we further assume
Assumption 4. For each i, the regressors, xit, satisfy
(i)E(vit|xit,···,xi1) = 0 for all iandt.
(ii) letXi= (xi1,...,xiT), there exists a k×knonrandom positive deﬁnite matrix B
such that1
TXiX′
ip→B.
(iii) max 1≤t≤T/bardbl1√
Txit/bardblp→0.
9Assumption 2isstandardallowing for heteroskedastic errorsacro ss units. Assumption 3
requiressuitablemomentsoftheerrorsforthetwoproposedtes tprocedures, respectively. It
helps relax the often-met normal error assumption by RandomMat rix Theory. Assumption
4(i) only requires the regressors to be weakly exogenous. Assump tion 4(ii) and (iii) impose
mild conditions on the design matrix. We note that Assumption 4 does n ot impose the
dependence structure between errors and regressors, which a llows for the regressors to
be weakly exogenous. Under these assumptions,√
T(ˆβi−βi) is asymptotically normal
according to Lai and Wei (1982).
For a dynamic heterogeneous panel data model with laggeddepend ent variable included
in regressors, more assumptions are needed which will be discussed in Section 4.
Now we are in the position of introducing the RLMtest and establishing its asymptotic
property in the following theorem.
Theorem 1. Under Assumptions 1, 2, 3 (i)and 4,
RLM=tr(ˆR2)−µ0
σ0d−→N(0,1),
whereµ0=n+n2
T−1−cTandσ2
0= 4c2
T.
The proof of Theorem 1 is provided in the Appendix, and the method is in two stages.
Intheﬁrst stage, Lemma 1establishes theCentral Limit Theorem o ftr(R2) withtoolsfrom
Random Matrix Theory, where R= (ρij)1≤i,j≤n. In the second stage, Lemma 2 shows that
the asymptotic bias of tr(ˆR2) disappears under the SIM-L scheme with cT→c∈(0,∞).
3.1.1 Relationship between the RLMandLMRMTtests
By the respective deﬁnitions of the LMRMTandRLMin (9) and Theorem 1, we have
µ0=n(1+n
T−1)−cT=n/parenleftbigg
1+n
T(1+1
T−1)/parenrightbigg
−cT=n+n2
T+n2
T2−n
T+o(1),
and
σ2
0=σ2
RMT+o(1)
10asκ= 3+o(1). It follows that
RLM=LMRMT+o(1), (11)
which indicates that LMRMTis asymptotically equivalent to RLMregardless of model
speciﬁcations and assumptions. Note that the proof the asympto tic normality of LMRMT
in Bailey et al. (2021) heavily relies on the assumptions of normal regr essors and normal
errors as it is used to ensure the residuals have desirable propertie s, and then transform
the sample correlation matrix of residuals to the sample correlation m atrix of a nomarlized
population with unit covariance matrix (see details in Section 3.1 in Bailey et al. (2021)).
From (11), we conclude that the LMRMTis also valid without the restrictive assumptions
of normality. Besides, as we will show later, RLMis also valid in both dynamic and ﬁxed
eﬀects panel data models, which theoretically extends the applicat ion scope of LMRMT.
This ﬁnding isconsistent with the simulation ﬁndings that show such ro bustness of LMRMT
in Bailey et al. (2021).
3.1.2 Relationship of the RLM,LMbcandCDLMtests
Bytherespectivedeﬁnitionsofthe CDLM,LMbcandRLMtestsin(5),(7)andTheorem
1, we have the following identities
CDLM=LMbc+n
2(T−1), (12)
CDLM=/radicalbiggn
n−1/parenleftbigg
RLM+n
2(T−1)/parenrightbigg
(13)
and
LMbc=/radicalbiggn
n−1/parenleftbigg
RLM+√n
2(T−1)(√n+√n−1)/parenrightbigg
. (14)
Note that the factor/radicalbign
n−1→1 and the remainder√n
2(T−1)(√n+√n−1)→0. It follows that the
two tests, RLMandLMbc, are always asymptotically equivalent, while the CDLMstatistic
has always a positive mean shift of valuen
2(T−1).
11In particular, Theorem 1 is also valid for the LMbcstatistic. Moreover, anticipating
Theorems 3 and 5 in Sections 4 and 5, for dynamic and ﬁxed eﬀects pa nel data model,
respectively, these asymptotic normality are also valid for the LMbcstatistic. In this sense,
the results from the paper can also be considered as new extension of theLMbctest,
originallydeveloped forhomogeneousﬁxedeﬀectspaneldatamode linBaltagi et al.(2012),
to various large panel models with coeﬃcient heterogeneity.
3.2 The RLMPEtest
In the high dimensional setting, for testing the identity hypothesis H0: corr(vt) =In,
wherevt= (v1t,...,v nt)′, there are mainly two types of test statistics. The majority of
existing tests are based on the squared Frobenius norm /bardblR−In/bardbl2
F=tr(R2)−n=/summationtext
i/negationslash=jρ2
ij.
However, this quadratic statistic lacks power if corr( vt) is a sparse matrix, see Fan et al.
(2015). Considering this, tests based on the maxima of absolute va lues, max i<j|ρij|, which
share a asymptotic type I extreme value distribution, are generally powerful under sparse
alternatives. This approach has however a main drawback that suc h test can suﬀer from
size distortions, which is common for statistics of the maximum type, see Liu et al. (2008).
Besides, this way is not as appropriate as the Frobenius norm (sum) type in some cases.
For example, consider the alternative
H1: corr(vt) =In+Pn,
wherePnis a perturbation matrix with diagonal entries being zero and snon-zero oﬀ
diagonal entries, where s∈ {1,...,n2−n}. Intuitively, Pncan be designed as a dense
matrix but with weak coeﬃcients such that max i<j|ρij|< zαfor anys. Consequently, the
extreme value type tests will fail to detect such a matrix. In such in stances, the sum type
tests are more suitable in the light of the fact that the eigenvalues o fRcould vary from H0
toH1, which results in larger quadratic statistic value by tr(R2) =/summationtextn
i=1λ2
i(R). In order
12to realize an interpolation of the two types of statistics above, nam ely the maximum type
and the sum type, we propose a new test statistic based on tr(R4) =/summationtextn
i=1λ4
i(R). The
reason is that large empirical correlations, ρ4
ij, would be more emphasized in tr(R4) than
intr(R2). To see this, consider increasingly large powers of the sample corr elations, ρm
ij,
wheremis a positive integer. Let E= argmax(i,j):i<j|ρij|, then
/summationdisplay
i/negationslash=j|ρij|m∼card(E)·(max
i<j|ρij|)m,asm→ ∞, (15)
where card( E) denotes thecardinality ofthe set E. Therefore, thenew statistic with m= 4
can mimic some properties of the maximum type, while remaining a sum ty pe smoothing
statistic. The resulting power is expected to be higher than tr(R2) when very few sample
correlations are signiﬁcantly non-zero under sparse alternatives , and higher than maximum
type statistics when there are many but relatively small correlation s.
3.2.1 Test based on/summationtext
i/negationslash=jˆρ4
ij
On the ground of analyses above, we propose a new test statistic b ased on the fourth
power of ˆ ρijin the following theorem.
Theorem 2. Under Assumptions 1, 2, 3 (ii)and 4,
RLMPE=tr(ˆR4)−µPE
σPEd−→N(0,1)
whereµPE=n+6n2
T−1+6n3
(T−1)2+n4
(T−1)2−6cT(1 +cT)2−2c2
Tandσ2
PE= 8c2
T+ 96c3
T(1 +
cT)2+16c2
T(3c2
T+8cT+3)2.
Remark 1. We choose m= 4 to generate the RLMPEtest for technical simplicity. In
fact, one can increase mto any large even integer to obtain new tests that may have larger
power in the sparse correlation setting. This strategy is feasible wit h the proof techniques
provided in Appendix. Further, by (15), it is expected that tests b ased on/summationtext
i/negationslash=j|ˆρij|m
would share similar power with maximum type statistics, which has been suggested as a
13powerful tests in sparse data, for example, see Cai et al. (2014) . It can provide a series of
potential statistics that can well control the size and may be more powerful under sparse
alternatives at the same time.
Remark 2. For the initial RLMtest (also the LMbctest), the remarkable screening tech-
nique in Fan et al. (2015) can provide an improved test that has the s ame asymptotic size
with non-inferior asymptotic power against a broader range of alte rnatives. Compared to
this approach, our power enhanced test avoids constructing suc h a “power enhancement
component” by increasing the power of the sample correlation to fo ur. However, studying
the power properties of our technique with diﬀerent choices of mis not the main focus in
this paper and remains an open problem.
The proof of the Theorem 2 is similar to that of Theorem 1, which requ ires the two
lemmas given in Appendix.
4 Dynamic panel data model
In this section, we show that the RLMandRLMPEtests are asymptotically valid in a
dynamic panel data model, which is speciﬁed as following:
yit=αiyi,t−1+x′
itβi+vit, (16)
fori= 1,...,n;t= 1,...,T, whereyi,t−1is the lagged dependent variable. Let zit=
(yi,t−1,x′
it),φi= (βi,αi)′, then (16) can be rewritten as yit=z′
itφi+vit. We show that the
proposed RLMandRLMPEtestsstillhavestandardnormallimitingdistributionunderthe
null hypothesis in the dynamic panel data model. To establish the asy mptotic normality,
we need additional assumptions as following,
Assumption 5. (i){yit}1≤i≤n,1≤t≤Tis a stationary and ergodic process.
14(ii) Letyi= (yi,0,...,y i,T−1),1
Tyiy′
i=Op(1) holds uniformly in i.
We establish the limiting distributions of the proposed tests in the follo wing theorems
Theorem 3. Under Assumptions 1, 2, 3 (i), 4 and 5,
RLMd−→N(0,1).
Theorem 4. Under Assumptions 1, 2, 3 (ii), 4 and 5,
RLMPEd−→N(0,1).
Under Assumption 5, the proofs of Theorems 3 and 4 follow along the same lines as
that of static panel data model. See the Appendix.
5 Fixed eﬀects panel data model
In this section, we establish the asymptotic normality of the RLMandRLMPEtests
in a ﬁxed eﬀects panel data model. We ﬁnd that as long as the coeﬃcie nt estimator is
√
T-consistent, the proposed tests still have standard normal limitin g distribution under
the null. To allow for weakly exogenous regressors, various consist ent estimators have been
proposed in the literature including Chudik and Pesaran (2015), Chu dik et al. (2018) etc.
However, these estimators require stronger assumptions than t he static panel data model.
For simplicity of illustration, we focus on residuals obtained by the with in estimator. The
strictly exogenous assumption is then necessary for the consiste ncy of the within estimator.
One can relax this assumption to the weakly exogenous one by applyin g a√
T-consistent
estimator.
Consider a ﬁxed eﬀects panel data model:
yit=x′
itβ+µi+vit, (17)
15fori= 1,...,n;t= 1,...,T, whereµidenotes the time-invariant individual eﬀect. The
within estimator in (17) is speciﬁed by
ˆβ=/parenleftBiggT/summationdisplay
t=1n/summationdisplay
i=1˜xit˜x′
it/parenrightBigg−1/parenleftBiggT/summationdisplay
t=1n/summationdisplay
i=1˜xit˜yit/parenrightBigg
, (18)
where˜xit=xit−1
T/summationtextT
t=1xitand ˜yit=yit−1
T/summationtextT
t=1yit.
Assumption 6. The regressors, xit, satisfy
(i) (strictly exogenous) E(vit|xiT,···,xi1) = 0 and E(vjt|xiT,···,xi1) = 0 for all i,j
andt.
(ii) For the demeaned regressors ˜xit,1
T/summationtextT
t=1˜xitand1
T/summationtextT
t=1˜xit˜x′
jtare stochastic bounded
for alli,j. Besides, lim (n,T)→∞1
nT/summationtextn
i=1/summationtextT
t=1˜xit˜x′
itexists and is nonsingular.
Under the Assumptions 1, 2, 3 and 6, ˆβis√
nT−consistent. We establish the validity
of our proposed tests in the following theorems.
Theorem 5. Under Assumptions 1, 2, 3 (i)and 6,
RLMd−→N(0,1).
Theorem 6. Under Assumptions 1, 2, 3 (i)and 6,
RLMPEd−→N(0,1).
The proofs of Theorems 5 and 6 are given in the Appendix.
6 Monte Carlo simulations
In this section, we conduct Monte Carlo simulations to examine the em pirical sizes and
powers of our RLMandRLMPEtests, which are deﬁned by (1) and (2), respectively, and
compare their performances to that of the CDptest and the LMadjtest deﬁned by (6)
16and (8), respectively. We consider four data generating process es (DGPs): heterogeneous
panel data model with either strictly or weakly exogenous regress ors, ﬁxed eﬀects panel
data model and pure dynamic panel data model.
Before looking at the simulation results, we consider the estimated r ejection frequencies
within range from 3.6% to 6.5% to provide evidence consistent with the robustness of
the tests, following the arguments in Halunga et al. (2017). Besides , we don’t include the
LMRMTand theLMbctests since they are almost identical to the RLMtest by (11) and
(14).
6.1 Monte Carlo design
6.1.1 DGP1: Heterogeneous panel data model with strictly ex ogenous regres-
sors
We ﬁrst consider the DGP used in Pesaran et al. (2008), which is spec iﬁed by
yit=αi+k/summationdisplay
l=2xlitβli+vit, i= 1,2,...,n;t= 1,2,...,T,
whereαi∼IIDN(1,1),βli∼IIDN(1,0.04). The regressors are generated as
xlit= 0.6xlit−1+ulit, i= 1,2,...,n;t=−50,...,0,...,T;l= 2,...,k
withxli,−51= 0 where ulit∼IIDN(0,τ2
li/(1−0.62)),τ2
li∼IIDχ2(6)/6. The ﬁrst 50
observations are discarded to lessen the eﬀects of initial values. N ow we generate the
disturbances under the null H0asvit=σiǫit, whereσi∼χ2(2)/2 and{ǫit}are generated
from three diﬀerent distributions: (i) normal, N(0,1), (ii) chi-squared, ( χ2(5)−5)/√
10
and (iii) student-t, t10//radicalbig
10/8. The normalizations in (ii) and (iii) are such that errors
have mean one and variance one. To investigate the eﬀects of the n umber of regressors,
k= 2,4 are considered.
17To examine the powers of the proposed tests, the disturbances a re generated by a factor
model as following:
vit=λift+ǫit, (19)
whereft(t= 1,...,T) are the factors with ft∼IIDN(0,1) andλi(i= 1,...,n) are the
loadings. We consider the following three cases of loading construct ion:
(1) Dense case. λi∼IIDU(−b,b), fori= 1,...,n, whereb=/radicalbig
3h/nandh= 3.
(2) Sparse case. λi∼IIDU(0.5,1.5), fori= 1,...,[n0.3], andλi= 0, for i= [n0.3] +
1,...,n, where [n0.3] is the integer part of n0.3.
(3) Less-sparse case. λi∼IIDU(0.5,1.5), fori= 1,...,[n0.5], andλi= 0, for i=
[n0.5]+1,...,n.
In the dense case, hmeasures the degree of cross-sectional dependence. The spar se case
and the less-sparse case follow the design used in Bailey et al. (2016) to model the weak
and strong cross-sectional dependence, respectively. The Mon te Carlo experiments are
conducted for T= 50,100,200, and three diﬀerent choices of ratio n/T= 0.5,1,2 basing
on 2000 replications. To obtain the empirical size, the proposed RLMtest,RLMPEtest
andLMadjtest are implemented at the one-sided 5% nominal signiﬁcance level, w hileCDP
test is conducted at the two-sided 5% nominal signiﬁcance level.
6.1.2 DGP2: Heterogeneous panel data model with weakly exog enous regres-
sors
To investigate the performances of the RLMandRLMPEtests in panel data models
with weakly exogenous regressors, we consider the following DGP:
yit=αi+x1,itβ1i+x2,itβ2i+vit, i= 1,2,...,n;t= 1,2,...,T,
18k= 2
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 5.15 5.15 5.55 5.55 4.65 5.35 4.9 5.25 5.15
RLMPE5.4 5.7 5.6 5.2 4.45 5.8 4.8 5 5.55
LMadj5.85 5.35 5.85 6 4.7 5.45 5.4 5.45 5.25
CDP4.75 4.45 4.65 4.85 4.25 5.25 4.5 4.15 5.1
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 5.5 5.15 4.55 5.05 4.5 4.95 5.15 4.95 6
RLMPE5.5 5.9 4.75 4.45 4.85 4.9 5.05 4.7 5.6
LMadj 5.7 5.25 4.6 5.1 4.6 5 5.35 4.95 6
CDP5.4 4.85 5.05 5.25 5.2 5.1 5.2 4.75 5.2
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 5.8 5.3 6.2 5.1 5.45 5 5.4 5.6 5.5
RLMPE5.5 5 5.55 4.95 5.55 4.65 5.4 5.85 5.35
LMadj 5.7 5.3 6.2 5.05 5.45 5 5.2 5.5 5.5
CDP4.05 4.75 5.7 5 4.85 5.4 4.85 5.05 4.9
k= 4
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 5.65 5.05 5.65 5.5 5.25 5.4 5.3 5.4 5.3
RLMPE5.4 5.3 5.5 5.35 5.2 5 5.4 5.65 5.45
LMadj5.75 5.05 5.75 5.6 5.25 5.4 5.4 5.45 5.3
CDP4.95 5.1 4.55 5.45 5.3 5.1 4.85 5.35 5.2
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 7.3 5 5.25 6.45 6 5.35 6.4 6.25 5.3
RLMPE7.1 5.35 5.05 5.75 5.7 5.35 6.2 5.5 5.1
LMadj 6.7 4.55 5.2 5.75 5.6 5.2 5.6 5.7 5.1
CDP5.55 4.75 5 4.35 4.7 5.25 4.3 4.4 5.35
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 6.75 5.85 6.25 7.65 5.9 5.55 7.55 5.75 4.95
RLMPE6.25 6.15 5.55 7.4 5.75 5.55 7.25 5.75 4.95
LMadj 5 5 5.55 5.8 4.75 5.1 5.65 4.9 4.65
CDP5.9 5.7 4.85 5.15 5.3 5.5 4.45 5.5 4.95
Table 2: Empirical size of tests in DGP1
19k= 2,h= 3
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 91.45 98.9 99.85 99.55 98.75 100 99.6 99.75 99.8
RLMPE95.95 99.85 100 99.85 99.75 100 99.85 100 99.95
LMadj92.3 98.95 99.85 99.55 98.8 100 99.6 99.8 99.8
CDP5.15 4.9 4.45 5.29 5.05 5.1 5.35 4.75 4.7
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 75.45 91.45 96.7 81.25 80.55 95.45 79.95 86.1 98.1
RLMPE84.2 97.4 99.9 89.6 93.1 99.85 89.65 95.2 100
LMadj75.95 91.6 96.8 81.85 80.8 95.45 80.4 86.25 98.1
CDP5.05 11 5.2 4.9 4.95 4.85 4.3 4.7 4.35
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 60.4 59.8 74.75 43 60.25 72.9 62.7 55.55 62.6
RLMPE73.85 78.55 91.35 55.35 78.35 91.75 75.9 73.85 84.7
LMadj60.2 59.8 74.75 42.8 60.2 72.9 62.6 55.5 62.45
CDP7.2 4.75 4.7 4.65 4.6 5.4 4.9 5.6 5.05
k= 4,h= 3
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 90.1 99.2 99.55 98.15 98.9 99.95 95.1 99.4 99.9
RLMPE94.9 99.85 100 99.4 99.85 100 97.55 99.85 100
LMadj90.2 99.2 99.55 98.15 98.95 99.95 95.15 99.4 99.9
CDP5.2 7.65 4.4 31.65 4.85 4.85 4.7 5.55 4.8
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 80.7 91.9 96.25 79.2 87.3 95.65 78.3 91.85 96.55
RLMPE88.45 98.1 99.65 88.85 95.85 99.55 87.6 97.95 99.65
LMadj79.55 91.6 96.2 78.5 87 95.5 76.8 91.4 96.55
CDP4.1 5.2 4.6 4.05 5 4.35 4 5.2 5.35
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 48.15 70.95 70.15 49.15 60.8 68.6 47.4 60.1 65.7
RLMPE60.1 87.5 91.05 60.75 78.6 89.1 58.65 78.25 86.3
LMadj43.35 68.3 68.75 43.65 58.25 67.1 42.65 56.75 63.85
CDP5.25 4.7 4.9 4.55 5.05 4.95 7.55 5.3 4.3
Table 3: Empirical power of of tests in DGP1 for dense case
20k= 2
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 20.4 28.85 43.95 20.55 25.9 39.85 20.25 20.3 27.7
RLMPE18.35 30.65 52.25 17.2 28.15 45.6 18.75 21.05 31.25
LMadj21.5 29.25 44.45 21.55 26.75 40.25 21.6 21 28
CDP7.45 6.75 6.65 7.15 7.8 6.9 7.4 6.85 6.5
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 23.6 13.6 38.35 14.05 18.95 39.55 11.9 23.75 31.3
RLMPE25.6 13.8 49.3 14.15 20.5 50.5 11.95 25.85 38
LMadj24.2 13.65 38.45 14.75 19.2 39.7 12.45 24.05 31.4
CDP7.9 6 7.35 7.35 6 7.25 6.8 5.9 6.4
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 12.2 11.85 27.9 10.45 18.4 38.45 11.8 19.75 54.15
RLMPE13.4 12.5 35.8 10.8 20.35 52.75 12.65 21.9 72.15
LMadj12.1 11.8 27.8 10.4 18.35 38.3 11.7 19.7 54.1
CDP6.55 5.45 6.55 6.65 5.9 7.1 6.2 6 6.9
k= 4
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 10.45 24.3 26.4 9.15 27.25 27 17.5 51.7 28.5
RLMPE10 27.85 30.95 9.65 28.65 28.9 15.85 58.05 30.35
LMadj10.5 24.35 26.4 9.3 27.6 27.05 17.55 51.95 28.5
CDP6.25 7.75 5.95 7.1 7.75 7 7.1 9.1 6.75
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 16.5 29.9 16.45 15 13.35 36.35 16.85 9.5 50.3
RLMPE16.45 34 18.8 15.05 13.55 46.5 17.15 10.35 64.95
LMadj15.35 28.75 16.1 13.65 12.9 35.95 15.6 9.05 49.9
CDP 7 6.95 6.2 7.4 7 6.9 7.7 5.75 7
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 14.3 18.2 55.95 11.15 15.55 47.65 8.4 15.85 77.55
RLMPE14.1 19.85 75.55 11.1 15.6 64.25 9.1 17.1 93.3
LMadj10.85 16 54.4 8.25 13.7 46.35 6.2 13.75 75.85
CDP5.1 6.15 7.5 5.4 6.1 7.25 5.1 6.25 7.6
Table 4: Empirical power of tests in DGP1 for sparse case
21k= 2
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 99.3 100 100 98.95 99.9 100 99.15 97.85 100
RLMPE99.9 100 100 99.6 100 100 99.75 99.4 100
LMadj99.55 100 100 99.1 99.9 100 99.2 97.9 100
CDP54.1 71.6 96.9 55.7 66.5 96.8 54.45 46.55 95.15
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 99.9 100 100 91.45 100 100 75.6 100 100
RLMPE100 100 100 96.7 100 100 84.95 100 100
LMadj99.9 100 100 91.6 100 100 76.05 100 100
CDP59.8 68.3 97.85 43.1 76.85 97.6 33.9 82.45 98.2
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 99.8 100 100 97.95 100 100 97.45 100 100
RLMPE100 100 100 99.65 100 100 99.45 100 100
LMadj99.75 100 100 97.85 100 100 97.45 100 100
CDP60.85 79.15 96.9 51 80.2 94.75 49.9 78 98.6
k= 4
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 99.4 99.95 100 86.9 99.95 100 96.05 100 100
RLMPE99.7 100 100 92.65 100 100 98.35 100 100
LMadj99.4 99.95 100 87 99.95 100 96.1 100 100
CDP56.55 64.8 95.15 38.7 62.5 95.75 46.15 87.2 93.05
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 87.8 100 100 78.65 100 100 94.85 99.75 100
RLMPE94.45 100 100 87.75 100 100 98.4 100 100
LMadj86.45 100 100 77.65 100 100 94.15 99.75 100
CDP39.7 75.2 96.85 34.5 71 93.6 45.25 58 96.35
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 97.4 100 100 95.25 100 100 91.15 100 100
RLMPE99.45 100 100 98.6 100 100 96.65 100 100
LMadj96.55 100 100 93.45 100 100 88.4 100 100
CDP46.15 74.4 98.4 44.15 74.9 93.3 40.75 80.35 97.75
Table 5: Empirical power of tests in DGP1 for less sparse case
22Weakly exogenous
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 5.85 4.45 4.75 5.1 4.7 5.55 4.7 5.2 5.8
RLMPE5.15 4.15 4.9 4.75 4.9 6.4 5.3 5.05 5.6
LMadj9.25 8.4 8.6 8.8 8.8 9.2 8.95 8.85 9.2
CDP4.65 4.25 4 5 4.5 5.05 5.6 4.4 5.35
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 4.55 5.4 5.8 5.65 4.95 5.05 5.55 5 5.9
RLMPE5.2 5.05 5.15 5.6 4.95 4.9 5.85 4.9 5.05
LMadj13.15 13.6 14 13.65 13 12.6 13.75 13.4 12.6
CDP5.6 4.35 5.2 6.25 5.2 5.6 6.1 5.2 6.2
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 5.85 6.9 5.3 5.05 5.45 4.8 4.4 5.2 5.2
RLMPE5.05 5.75 5.1 5.5 5.75 4.7 5.7 5.2 5.6
LMadj28.2 27.25 27.3 27.35 28.25 26.3 30.35 28.5 26.7
CDP4.5 5.1 5.1 5.7 5.05 5.65 4.85 5.1 5.9
Table 6: Empirical size of tests in DGP2
whereαi∼IIDN(1,1),βli∼IIDN(1,0.04), and
x1,it= 0.6x1,it−1+u1,it, i= 1,2,...,n;t=−50,...,0,...,T,
x2,it=yit−1+u2,it, i= 1,2,...,n;t=−50,...,0,...,T,
withyi,−51=x1,i,−51= 0 where u1it,u2it∼IIDN(0,τ2
li/(1−0.62)),τ2
li∼IIDχ2(6)/6. This
set up allows for feedback from yit−1to the regressors, thus rendering weakly exogenous.
The errors, {vit}, are generated in the same way as DGP1.
236.1.3 DGP3: Fixed eﬀects panel model
The third DGP considered is a ﬁxed eﬀects panel data model with hom ogeneous coef-
ﬁcients, which is speciﬁed as
yit=α+k/summationdisplay
l=2xlitβl+µi+vit, i= 1,2,...,n;t= 1,2,...,T,
whereαandβlare set arbitrarily to 1 and l, respectively, µi∼IIDN(1,1). The regressors
and errors are generated in the same way as DGP1.
6.1.4 DGP4: Dynamic panel data model
To examine the properties of the RLMandRLMPEtests in a dynamic panel data
model, we follow the design of Pesaran et al. (2008):
yit=ξi(1−βi)+βiyit−1+viti= 1,2,...,n;t=−50,...,0,...,T,
withyi,−51= 0, where βi∼IIDN(1,0.04), and the ﬁxed eﬀects, ξi, are drawn as vi0+ηi,
withηi∼IIDN(1,2). The errors, {vit}, are generated in the same way as DGP1.
6.2 Simulation results
Table 2 reports the empirical size of these tests for the DGP1. The proposed RLMand
RLMPEtests successfully control the size under almost all settings, irre spective of number
of regressors included in the panel data model1. For a ﬁxed ratio n/T, the empirical size
of theRLMandRLMPEtests converge to the nominal size of 0 .05 asT→ ∞, that
authenticates the asymptotic normality of the tests under the SI M-L scheme. Besides, the
performance of RLMare almost identical to LMadj. TheCDPtest has correct size in all
cases.
1However, for small sample size with more regressors, i.e. T= 50 and k= 4, the RLMandRLMPE
tests would be slightly oversized. For example, the empirical sizes of RLMandRLMPEare 7.65 and 7.4
under normal errors, respectively.
24k= 2
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 5.7 4.7 5.05 5.1 5.45 5.55 5 5.1 4.95
RLMPE5.55 4.85 4.95 4.9 4.8 5.6 5.2 4.7 4.6
LMadj 6.4 5.15 5.1 5.6 5.75 5.65 5.7 5.4 5.1
CDP4.5 4.7 5.05 4.8 4.45 5.3 5.1 4.45 4.85
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 4.85 5.25 4.6 5 5 4.7 5.05 4.35 5.6
RLMPE4.9 4.9 4.75 5.25 4.7 5.05 5.5 4 5.65
LMadj5.45 5.4 4.7 5.2 5.05 4.95 5.4 4.55 5.65
CDP5.2 4.75 6.2 5.45 5.5 5.7 5.55 5.6 5.5
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 6.45 6.35 4.35 5.05 5.3 4.7 4.65 5 4.3
RLMPE6.55 5.9 4.75 5.65 5.4 5.2 5 5.1 4.55
LMadj6.45 6.35 4.35 5.15 5.35 4.7 4.7 5 4.3
CDP4.85 5.95 4.9 4.95 5.4 5.55 4.25 5.45 5
k= 4
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 5.1 6.05 4.7 4.7 4.65 5.35 5.05 4.45 5.45
RLMPE4.95 5.05 5.05 4.45 4.25 5.05 4.2 4.85 5.25
LMadj 5.4 6.4 4.75 5 4.7 5.35 5.35 4.5 5.45
CDP4.95 6.1 4.6 4.65 5.2 5.25 4.35 5.05 5.05
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 5.75 5.15 4.75 4.8 5.25 4.75 5 5.8 5.3
RLMPE5.7 5.05 4.85 4.7 5.7 4.75 5.2 5.45 5.2
LMadj 5.4 4.8 4.55 4.2 5.05 4.6 4.5 5.55 5.25
CDP5.05 4.9 5.65 4.95 4.85 5 5.3 5.35 4.9
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 5.35 6.15 5.1 6.05 5.4 4.75 4.9 5.3 4.9
RLMPE5.65 5.8 4.95 5.55 5.1 5.05 5.55 5.1 5.1
LMadj4.15 5.25 4.85 4.55 4.3 4.4 3.95 4.9 4.4
CDP 5 4.9 3.75 5.15 5.15 5.15 5.3 5.4 4.7
Table 7: Empirical size of tests in DGP3
25Dynamic
Chi-squared Normal Student-t
(T,n) (50,25) (100,50) (200,100) (50,25) (100,50) (200,100) (5 0,25) (100,50) (200,100)
n
T=1
2RLM 6.3 5.25 5.1 5.05 5.5 5.25 5.4 4.75 4.85
RLMPE5.8 5.15 4.45 4.7 5.3 4.9 5.4 4.7 4.9
LMadj6.75 5.45 5.1 5.45 5.6 5.3 5.85 5.15 4.95
CDP4.9 5.3 5.4 4.35 5 5.45 4.35 5.8 5.15
Chi-squared Normal Student-t
(T,n) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200) (50,50) (100,100) (200,200)
n
T= 1RLM 6.65 5.25 5.95 5.8 5.35 4.6 6.2 5.3 5
RLMPE5.7 5.35 5.4 6.1 5.45 4.45 6.05 5.5 4.6
LMadj 6.7 5.3 6 5.9 5.35 4.6 6.35 5.4 5
CDP4.75 4.85 4.85 4.85 4.6 4.25 4.8 4.8 5.5
Chi-squared Normal Student-t
(T,n) (50,100) (100,200) (200,400) (50,100) (100,200) (200,40 0) (50,100) (100,200) (200,400)
n
T= 2RLM 5.7 5.9 5.65 6.2 5.1 5.35 5.95 5.5 5.45
RLMPE6.45 6.05 5.1 5.4 5.45 5.05 5.05 5.3 5.15
LMadj 5.3 5.7 5.6 5.75 5 5.3 5.6 5.35 5.3
CDP4.4 6 4.55 5.7 5.75 5.05 5 4.95 5.6
Table 8: Empirical size of tests in DGP4
26Table3demonstrates theempirical power ofthese testsunder th ealternativewithdense
factors. The RLMtest has comparable power to LMadjregardless of ( n,T) combinations
and error distributions. In contrast, the CDPtest suﬀers from little power by construction,
where mean of factor loading is close to zero as mentioned by Pesara n et al. (2008). The
power enhancement version of RLM, theRLMPEtest, outperforms others across the
board, especially when n/T= 2. For example, the power of the RLMPEtest is 78.25% for
T= 100,n= 200,k= 4,h= 3 and student-t errors, whereas the power of the RLMand
LMadjtests are 60.1% and 56.75%, respectively. It improves the power by up to around
30%. Besides, the power of the RLMPEtest is 69.2% for T= 100,n= 200,k= 2,h= 3
and chi-square errors, and the power of the RLMandLMadjtests are 51.2% and 51.1%,
respectively. These results indicate that the RLMPEtest successfully boost the power.
The empirical power of these tests under the alternative with spar se and less sparse
factors are summarized in Tables 4 and 5, respectively. The RLMtest again has similar
performance to LMadj. The empirical power of RLMPEshow that it performs the best
among those tests. The power of the CDPtest ﬂoats around 5% throughout as in Pesaran
(2015).
For the heterogeneous panel data model with weakly exogenous r egressors, Table 6
shows that LMadjbecomes considerably oversized, especially for the case n/T= 2, where
it has size around 28%. This shows that the LMadjtest is not robust to weakly exogenous
regressors, which is also observed in Bailey et al. (2021). However, our proposed RLMtest
andRLMPEtests control the size well, which are not sensitive to the strictly ex ogenous
assumptions on regressors. Therefore, though it is widely report ed that the LMadjtest
has generally satisfying empirical performances regardless of res trictive strictly exogenous
regressors and normal errors assumptions, the present DGP2 is indeed a rare situation
where the LMadjtest is outperformed by others.
Table 7 reports the size of the tests for the ﬁxed eﬀects panel da ta model. It shows
27that the proposed RLMandRLMPEtests have the correct size, close to the 5% nominal
signiﬁcance level, for example, RLMhas 5.1% and 5% size results, respectively for T=
50,n= 25 under normal errors and for T= 100,n= 200 under chi-squared errors. Similar
results for RLMPEcan be also observed in this table. Pesaran’s LMadjandCDPtests
have correct size in this setting as in Pesaran (2004) and Pesaran e t al. (2008).
Finally, Table 8 gives the empirical size of these tests for dynamic pan el data model.
It shows that the proposed RLMandRLMPEtests have the correct size, e.g. 5.15% for
n= 100,T= 100 with chi-squared error, which is comparable to the LMadjtest. The CDP
always has correct size as in Pesaran (2004). The results of empiric al power for DGP2,
DGP3 and DGP4 are similar to those of DGP1, so we omit it here.
Based on these ﬁndings, the RLMPEtest is strongly recommended for practitioners if
it is not clear whether weakly exogenous regressors are present o r not, given its universally
correct size and better power performances. Instead, when re gressors are believed to be
strictly exogenous, then the RLMPEtest, a easily implemented and computationally cheap
procedure, is preferred for large panels ( T≥50). For T≤50,RLMPEis still applicable
though it might be slightly oversized, or the LMadjtest is a suggested method at the risk
of intensive computation.
7 Conclusion
This paper has developed a Lagrange multiplier type test for the null hypothesis of
no cross-sectional dependence in large panel models. The proced ure can be applied to
a wide class of linear panel data models and shows robustness to quit e general forms of
non-normality in the disturbance distribution. We further propose d a power enhancement
versionofthe LMtypetestbasedonthefourthmomentofthesamplecorrelationso btained
from residuals to boost power under sparse alternatives, which on ly requires existence of
28higher moment but still shares such robustness. The simulations illus trate that this test
has satisfactory power under the sparse alternatives of weak cr oss-sectional dependence,
and both of the tests successfully control the size in diﬀerent dat a generating processes.
Forfuturework, it isinteresting toexplore theoretically thepower propertiesof RLMPE
and the optimal mthat would maximise power. Also, it would be of interest to investigate
the performance of the RLMandRLMPEtests in the weakly cross-sectional dependence
framework. In addition, testing the null hypothesis with no cross- sectional dependence
when errors are serial dependent will also be studied.
29Appendix
This appendix includes the proofs of the following lemmas:
Lemma 1. Under Assumptions 1, 2 and 3 (i),
tr(R2)−µ0
σ0d−→N(0,1).
Lemma 2. Under Assumptions 1, 2, 3 (i)and 4,
tr(ˆR2) =tr(R2)+op(1).
Lemma 3. Under Assumptions 1, 2 and 3 (ii),
tr(R4)−µPE
σPEd−→N(0,1).
Lemma 4. Under Assumptions 1, 2, 3 (ii)and 4,
tr(ˆR4) =tr(R4)+op(1).
In the static heterogeneous panel data model, ˆβi= (XiX′
i)−1Xiyiis the OLS esti-
mator and the residuals are given by ˆ vit=vit−x′
it/parenleftBig
ˆβi−βi/parenrightBig
. Letvi= (vi1,...,v iT)′,
ˆvi= (ˆvi1,...,ˆviT)′fori= 1,...,n, consequently, ˆvi=vi−X′
i/parenleftBig
ˆβi−βi/parenrightBig
. Deﬁne
ˆV=/parenleftbigg
ˆv1,···,ˆvn/parenrightbigg
,wi=X′
i/parenleftBig
ˆβi−βi/parenrightBig
andW=/parenleftbigg
w1,···,wn/parenrightbigg
. Using this notation,
ˆvi=vi−wi,ˆV=V−Wandthesamplecovariancematricescanbewrittenas ST=1
TˆV′ˆV,
ˆST=1
TV′Vwith elements ST,i,j=1
TT/summationtext
t=1vitvjt,ˆST,i,j=1
TT/summationtext
t=1ˆvitˆvjt,respectively.
To accomplish the proof of results above, several lemmas are intro duced as following.
Lemma 5. (Theorem 13 of Chapter 13, Petrov (1975)) Let Y1,···,Ynbe independent and
identically distributed random variables, such that E(Y1) = 0,E(Y1)2= 1andE|Y1|r<∞
for some r≥3. Then
/vextendsingle/vextendsingle/vextendsingleP(1√nn/summationdisplay
i=1Yi< y)−Φ(y)/vextendsingle/vextendsingle/vextendsingle≤C(r)
(1+|y|)r/bracketleftbiggE|Y1|3
√n+E|Y1|r
nr−2
2/bracketrightbigg
30for ally, whereΦ(·)is the cumulative distribution function of standard normal random
variable and C(r)is a positive constant depending only on r.
Lemma 6. Let{Yij}i≥1,j≥1be an array of independent and identically distributed rand om
variables such that E(Y11) = 0,E(Y11)2= 1andE|Y11|r<∞for some r≥3. Let
Xin=1√n/summationtextn
j=1Yij, then for any ǫ >0, we have
max
1≤i≤n|Xin|=Op(n1
2r+ǫ).
Proof.For some α >0,letc=1
2r+ǫ, we have
P(max
1≤i≤n|Xin| ≥αnc) = 1−[P(|X1n|< αnc)]n
≤1−/braceleftBig
Φ(αnc)−C(r)
(1+αnc)r/bracketleftbiggE|Y11|3
√n+E|Y11|r
nr−2
2/bracketrightbigg/bracerightBign
∼1−/braceleftBig
1−1√
2παn−ce−α2n2c
2−C(r)
(1+αnc)r/bracketleftbiggE|Y11|3
√n+E|Y11|r
nr−2
2/bracketrightbigg/bracerightBign
∼1√
2παn1−ce−α2n2c
2+C(r)E|Y11|3√n
(1+αnc)r+C(r)E|Y11|r
(1+αnc)rnr
2−2,
where the ﬁrst inequality follows by Lemma 5, and the ﬁrst approxima tion follows by the
fact that Φ( x)∼1−1√
2πxe−x2
2for large x. Therefore, max 1≤i≤n|Xin|=Op(nc) holds.
Remark 3. For the panel data model, if the errors {vit}1≤i≤n,1≤t≤Tsatisfy the conditions
in lemma 5 and XiT=1√
T/summationtextT
t=1vit, then for any any ǫ >0, the estimate max 1≤i≤n|XiT|=
Op(n1
2r+ǫ) still holds once we further assume that K1≤n
T≤K2for some positive constants
K1andK2. It holds naturally sincen
T→c >0 in the SIM-L scheme.
Lemma 7. (Li et al. (2012)) Suppose E|vit|6<∞, then
max
1≤i<j≤n|ρij|=Op/parenleftBigg/radicalbigg
logn
n/parenrightBigg
,
whenn
T→c >0.
Lemma 8. Under Assumptions 1, 2, 3 and 4, for any ǫ >0and some integer r1≥3, i.e.
E|vit|r1<∞
31(a)max
1≤i,j≤n|/an}bracketle{tvi,wj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
(b)max
1≤i,j≤n|/an}bracketle{twi,wj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
(c)max
1≤i≤n|ST,i,i−σ2|=Op(n1
r1+ǫ2−1
2).
(d)max
1≤i/negationslash=j≤n|ST,i,j|=Op(n1
r1+ǫ2−1
2).
(e)max
1≤i≤n|ˆST,i,i−ST,i,i|=Op(n1
r1+2ǫ1−1).
(f)max
1≤i≤n|ˆST,i,i−σ2|=Op(n1
r1+ǫ2−1
2).
Proof.(a). Firstly, we consider the case i=j. By Assumption 2, we obtain ξi=
(XiX′
i)−1
2/summationtext
txitvitd−→Nk(0,σ2
iIk).Therefore, by Lemma 6 for some r1≥3 and for
anyǫ1>0,
max
1≤i≤n/bardblξi/bardbl=Op(n1
2r1+ǫ1).
Consequently,
max
1≤i≤n|/an}bracketle{twi,vi/an}bracketri}ht|
= max
1≤i≤n/vextendsingle/vextendsingle/vextendsinglev′
iX′
i/parenleftBig
ˆβi−βi/parenrightBig/vextendsingle/vextendsingle/vextendsingle= max
1≤i≤n/vextendsingle/vextendsingle/vextendsinglev′
iX′
i(XiX′
i)−1Xivi/vextendsingle/vextendsingle/vextendsingle= max
1≤i≤n/bardblξi/bardbl2=Op(n1
r1+2ǫ1).
The calculations for i/ne}ationslash=jcase is similar so we omit it here.
(b). We have
max
1≤i,j≤n|/an}bracketle{twi,wj/an}bracketri}ht|= max
1≤i,j≤n/vextendsingle/vextendsingle/vextendsingle/parenleftBig
ˆβ′
i−β′
i/parenrightBig
XiX′
j/parenleftBig
ˆβj−βj/parenrightBig/vextendsingle/vextendsingle/vextendsingle
= max
1≤i,j≤n/vextendsingle/vextendsingle/vextendsinglev′
iX′
i(XiX′
i)−1XiX′
j/parenleftbig
XjX′
j/parenrightbig−1X′
jvj/vextendsingle/vextendsingle/vextendsingle
= max
1≤i,j≤n/vextendsingle/vextendsingle/vextendsingleξ′
i(XiX′
i)−1
2XiX′
j/parenleftbig
XjX′
j/parenrightbig−1
2ξj/vextendsingle/vextendsingle/vextendsingle
≤/parenleftbigg
max
1≤i≤n/bardblξi/bardbl/bardblXiX′
i/bardbl−1/2/bardblXi/bardbl/parenrightbigg2
=/parenleftBig
Op(n1
2r1+ǫ1)Op(T−1/2)Op(T1/2)/parenrightBig2
=Op(n1
r1+2ǫ1).
32(c). By CLT, Zi∆=√
T(ST,i,i−σ2
i)d−→N(0,τ2
i) whereσ2=E(v2
it) andτ2
i= var(v2
it),
then max
1≤i≤n|Zi|=Op(n1
2r2+ǫ2) for some r2≥3 and for any ǫ2>0 by Lemma 6. It can be
easily found that r1= 2r2, therefore,
max
1≤i≤n|ST,i,i−σ2|=Op(n1
2r2+ǫ2−1
2) =Op(n1
r1+ǫ2−1
2).
(d). Note that E(vitvjt) = 0 for i/ne}ationslash=j, it follows along the same lines as that of (c).
(e). By (a) and (b), we have
max
1≤i≤n|ˆST,i,i−ST,i,i|= max
1≤i≤n/vextendsingle/vextendsingle−2T−1/an}bracketle{twi,vi/an}bracketri}ht+T−1/bardblwi/bardbl2/vextendsingle/vextendsingle=1
TOp(n1
r1+2ǫ1) =Op(n1
r1+2ǫ1−1).
(f). The conclusion holds from (c) and (e).
Proof of Lemma 1
Proof.By the Theorem 3.1 of Yin et al. (2021), there exist constants µcenter,µlimitand
σ0>0 such that:
tr(R2)−µcenterd−→N(µlimit,σ′2
0).
Applying the results in Example 3.2 of Yin et al. (2021) with gl=x2, we obtain µcenter=
n(1+n
T−1). For the case gl=x2andR=In, the results in Example 3.3 of Yin et al. (2021)
shows that µlimit=−candσ′
0= 2c. Finally, substituting cwithcTby Slutsky’s theorem
completes the proof.
Proof of Lemma 2
33Proof.By direct calculation we have
/vextendsingle/vextendsingle/vextendsingletr/parenleftBig
ˆR2−R2/parenrightBig/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
1≤i/negationslash=j≤n/parenleftbig
ˆρ2
ij−ρ2
ij/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
1≤i/negationslash=j≤nρ2
ij/parenleftbiggˆρ2
ij
ρ2
ij−1/parenrightbigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤/radicalBigg/summationdisplay
1≤i/negationslash=j≤nρ4
ij·/radicaltp/radicalvertex/radicalvertex/radicalbt/summationdisplay
1≤i/negationslash=j≤n/parenleftbiggˆρ2
ij
ρ2
ij−1/parenrightbigg2
=/radicalBigg
1
Tα1/summationdisplay
1≤i/negationslash=j≤nρ4
ij·/radicaltp/radicalvertex/radicalvertex/radicalbtTα1/summationdisplay
1≤i/negationslash=j≤n/parenleftBigg
S2
T,i,jˆST,i,iˆST,j,j−ˆS2
T,i,jST,i,iST,j,j
S2
T,i,jˆST,i,iˆST,j,j/parenrightBigg2
,
where constant 0 < α1<1. Therefore, we aim to show that:
(i)A1∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα1/summationtext
1≤i/negationslash=j≤nρ4
ij/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(ii)A2∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα1/summationtext
1≤i/negationslash=j≤n/parenleftbigg
S2
T,i,jˆST,i,iˆST,j,j−ˆS2
T,i,jST,i,iST,j,j
S2
T,i,jˆST,i,iˆST,j,j/parenrightbigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
(i)By lemma 7, we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα1/summationdisplay
1≤i/negationslash=j≤nρ4
ij/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤1
Tα1Op/parenleftbigg
(logn
n)2·n2/parenrightbigg
=Op/parenleftBigg
(logn)2
Tα1/parenrightBigg
=op(1).
Therefore, A1=op(1) holds.
(ii)By direct calculation we have
A2≤Tα1−8/summationdisplay
1≤i/negationslash=j≤n1
S4
T,i,jˆS2
T,i,iˆS2
T,j,j/vextendsingle/vextendsingle/vextendsingle(v′
ivj)2(v′
i−w′
i)(vi−wi)(v′
j−w′
j)(vj−wj)−
[(v′
i−w′
i)(vj−wj)]2v′
iviv′
jvj/vextendsingle/vextendsingle/vextendsingle2
=Tα1−8/summationdisplay
1≤i/negationslash=j≤n1
S4
T,i,jˆS2
T,i,iˆS2
T,j,j/vextendsingle/vextendsingle/vextendsingle−2(v′
ivj)2w′
iviv′
jvj+(v′
ivj)2w′
iwiv′
jvj−2(v′
ivj)2v′
iviw′
jvj
+4(v′
ivj)2w′
iviw′
jvj−2(v′
ivj)2w′
iwiw′
jvj+(v′
ivj)2v′
iviw′
jwj−2(v′
ivj)2w′
iviw′
jwj
+(v′
ivj)2w′
iwiw′
jwj−(w′
ivj)2v′
iviv′
jvj−(v′
iwj)2v′
iviv′
jvj−(w′
iwj)2v′
iviv′
jvj
+2v′
ivjw′
ivjv′
iviv′
jvj+2v′
ivjv′
iwjv′
iviv′
jvj−2v′
ivjw′
iwjv′
iviv′
jvj−2w′
ivjv′
iwjv′
iviv′
jvj
+2w′
ivjw′
iwjv′
iviv′
jvj+2v′
iwjw′
iwjv′
iviv′
jvj/vextendsingle/vextendsingle/vextendsingle2
.
34DeﬁneRHS∆=Tα1−8/summationtext
1≤i/negationslash=j≤n1
S4
T,i,jˆS2
T,i,iˆS2
T,j,j|17/summationtext
m=1A2,m|2,then
A2≤Tα1−8/summationdisplay
1≤i/negationslash=j≤n1
S4
T,i,jˆS2
T,i,iˆS2
T,j,j/summationdisplay
m1,m2|τm1,m2A2,m1A2,m2|,
whereτm1,m2is a constant only depending on m1andm2.
Therefore, if Tα1−8/summationtext
1≤i/negationslash=j≤n|A2,m1A2,m2|
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=op(1) for any 1 ≤m1,m2≤17 holds,
then we can conclude that A2=op(1). Further, we only need to consider the case
whenm1=m2by equality 2 · |A2,m1A2,m2| ≤ |A2,m1|2+|A2,m2|2, i.e. if we can show
Tα1−8/summationtext
1≤i/negationslash=j≤n|A2,m|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=op(1) for any 1 ≤m≤17, then A2=op(1) immediately
holds. By Lemma 8, we show that
Tα1−8/summationdisplay
1≤i/negationslash=j≤n|A2,1|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=Tα1−8/summationdisplay
1≤i/negationslash=j≤n|−2(v′
ivj)2w′
iviv′
jvj|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j
=Tα1−8/summationdisplay
1≤i/negationslash=j≤n|Op(n3
r1+2ǫ1+2ǫ2+2)|2
=Op(n6
r1+4ǫ1+4ǫ2+α1−2) =op(1).
By similar calculations, we conclude that
Tα1−8/summationdisplay
1≤i/negationslash=j≤n|A2,m|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=Op(n6
r1+4ǫ1+4ǫ2+α1−2)m= 1,2,3,6,
Tα1−8/summationdisplay
1≤i/negationslash=j≤n|A2,m|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=Op(n8
r1+8ǫ1+4ǫ2+α1−4)m= 4,5,7,8,
Tα1−8/summationdisplay
1≤i/negationslash=j≤n|A2,m|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=Op(n4
r1+8ǫ1+α1−2)m= 9,10,11,15,16,17,
Tα1−8/summationdisplay
1≤i/negationslash=j≤n|A2,m|2
S4
T,i,jˆS2
T,i,iˆS2
T,j,j=Op(n4
r1+4ǫ1+2ǫ2+α1−1)m= 12,13,14.
Therefore, we can conclude that A2=op(1).
Proof of Lemma 3
Proof.By the Theorem 3.2 of Yin et al. (2021), there exist constants µcenter,4,µlimit,4and
σPE>0 such that:
tr(R4)−µcenter,4d−→N(µlimit,4,σ2
PE,0).
35Applying the results in Example 3.2 of Yin et al. (2021) with g(x) =x4, we obtain
µcenter,4=n+6n2
T−1+6n3
(T−1)2+n4
(T−1)2. For the case g(x) =x4andR=In, the re-
sults in Example 3.3 of Yin et al. (2021) shows that µlimit=−6c(1 +c)2−2c2and
σ2
PE,0= 8c2+96c3(1+c)2+16c2(3c2+8c+3)2. Finally, substituting cwithcTby Slutsky’s
theorem completes the proof.
Proof of Lemma 4
Proof.It is easy to verify that
tr/parenleftBig
ˆR4−R4/parenrightBig
=2/summationdisplay
i/negationslash=j/parenleftbig
ˆρ2
ij−ρ2
ij/parenrightbig
+2/summationdisplay
i/negationslash=j/negationslash=l/parenleftbig
ˆρ2
ijˆρ2
jl−ρ2
ijρ2
jl/parenrightbig
+/summationdisplay
i/negationslash=j/parenleftbig
ˆρ4
ij−ρ4
ij/parenrightbig
+/summationdisplay
i/negationslash=j/negationslash=l(ˆρijˆρjlˆρil−ρijρjlρil)+/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s(ˆρijˆρjlˆρlsˆρsi−ρijρjlρlsρsi),
where 1≤i,j,l,s≤n. We only aim to show that
(i)B∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationtext
i/negationslash=j/negationslash=l/parenleftbig
ˆρ2
ijˆρ2
jl−ρ2
ijρ2
jl/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(ii)C∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationtext
i/negationslash=j/parenleftbig
ˆρ4
ij−ρ4
ij/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(iii)D∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationtext
i/negationslash=j/negationslash=l(ˆρijˆρjlˆρil−ρijρjlρil)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(iv)E∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationtext
i/negationslash=j/negationslash=l/negationslash=s(ˆρijˆρjlˆρlsˆρsi−ρijρjlρlsρsi)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1)
since we have/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationtext
i/negationslash=j/parenleftbig
ˆρ2
ij−ρ2
ij/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1) by Lemma 2.
36(i)By direct calculation we have
B=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=l/parenleftbig
ˆρ2
ijˆρ2
jl−ρ2
ijρ2
jl/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=lρ2
ijρ2
jl/parenleftBigg
ˆρ2
ijˆρ2
jl
ρ2
ijρ2
jl−1/parenrightBigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤/radicalBigg/summationdisplay
i/negationslash=j/negationslash=lρ4
ijρ4
jl·/radicaltp/radicalvertex/radicalvertex/radicalbt/summationdisplay
i/negationslash=j/negationslash=l/parenleftBigg
ˆρ2
ijˆρ2
jl
ρ2
ijρ2
jl−1/parenrightBigg2
=/radicalBigg
1
Tα2/summationdisplay
i/negationslash=j/negationslash=lρ4
ijρ4
jl·/radicaltp/radicalvertex/radicalvertex/radicalbtTα2/summationdisplay
i/negationslash=j/negationslash=l/parenleftBigg
S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l−ˆS2
T,i,jˆS2
T,j,lS2
T,j,jST,i,iST,l,l
S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l/parenrightBigg2
,
where constant 0 < α2<1. We show that:
(i.1)
B1∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα2/summationdisplay
i/negationslash=j/negationslash=lρ4
ijρ4
jl/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(i.2)
B2∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα2/summationdisplay
i/negationslash=j/negationslash=l/parenleftBigg
S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l−ˆS2
T,i,jˆS2
T,j,lS2
T,j,jST,i,iST,l,l
S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l/parenrightBigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
(i.1)By lemma 7, we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα2/summationdisplay
i/negationslash=j/negationslash=lρ4
ijρ4
jl/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤Op/parenleftbigg(logn)4
nTα2/parenrightbigg
=op(1).
Therefore, B1=op(1) holds.
(i.2)By direct calculation, we have
B2≤Tα2−16/summationdisplay
i/negationslash=j/negationslash=l|IB2|2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
where
IB2=(v′
ivj)2(v′
jvl)2/bracketleftbig
(v′
j−w′
j)(vj−wj)/bracketrightbig2(v′
i−w′
i)(vi−wi)(v′
l−w′
l)(vl−wl)
−[(v′
i−w′
i)(vj−wj)]2/bracketleftbig
(v′
j−w′
j)(vl−wl)/bracketrightbig2(v′
jvj)2v′
iviv′
lvl.
37Consequently,
|B2| ≤Tα2−16/summationdisplay
i/negationslash=j/negationslash=l1
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2/vextendsingle/vextendsingle/vextendsingle153/summationdisplay
m=1B2,m/vextendsingle/vextendsingle/vextendsingle2
=Tα2−16/summationdisplay
i/negationslash=j/negationslash=l1
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2/vextendsingle/vextendsingle/vextendsingle/summationdisplay
m1,m2ηm1,m2B2,m1B2,m2/vextendsingle/vextendsingle/vextendsingle,
whereηm1,m2is a constant only depending on m1andm2. By the same arguments in the
proof of Lemma 2, we only need to show that
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l|B2,m|2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2=op(1),
for any 1 ≤m≤153. By Lemma 8, for 1 ≤m≤53, one caneasily show that the stochastic
order dominating terms are
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle−2(v′
ivj)2(v′
jvl)2(v′
jvj)2w′
iviv′
lvl/vextendsingle/vextendsingle2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle(v′
ivj)2(v′
jvl)2(v′
jvj)2w′
iwiv′
lvl/vextendsingle/vextendsingle2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle−2(v′
ivj)2(v′
jvl)2(v′
jvj)2v′
iviw′
lwl/vextendsingle/vextendsingle2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle(v′
ivj)2(v′
jvl)2(v′
jvj)2v′
jvjw′
lwl/vextendsingle/vextendsingle2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
which have the same order Op/parenleftBig
n10
r1+4ǫ1+8ǫ2+α2−3/parenrightBig
=op(1). For 54 ≤m≤153, stochastic
order dominating terms have the same order of
Tα2−16/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle(v′
ivj)2v′
jvlw′
jvl(v′
jvj)2v′
iviv′
lvl/vextendsingle/vextendsingle2
(S2
T,i,jS2
T,j,lˆS2
T,j,jˆST,i,iˆST,l,l)2,
whose order are Op(n8
r1+8ǫ1+6ǫ2+α2−1) =op(1). Therefore, we can conclude that B2=op(1).
38(ii)By direct calculation we have
C=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/parenleftbig
ˆρ4
ij−ρ4
ij/parenrightbig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=jρ4
ij/parenleftbiggˆρ4
ij
ρ4
ij−1/parenrightbigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤/radicalBigg/summationdisplay
i/negationslash=jρ8
ij·/radicaltp/radicalvertex/radicalvertex/radicalbt/summationdisplay
i/negationslash=j/parenleftbiggˆρ4
ij
ρ4
ij−1/parenrightbigg2
=/radicalBigg
1
Tα3/summationdisplay
i/negationslash=jρ8
ij·/radicaltp/radicalvertex/radicalvertex/radicalbtTα3/summationdisplay
i/negationslash=j/parenleftBiggˆS4
T,i,jS2
T,i,iS2
T,j,j−S4
T,i,jˆS2
T,i,iˆS2
T,j,j
S4
T,i,jˆS2
T,i,iˆS2
T,j,j/parenrightBigg2
,
where constant 0 < α3<1. We show that:
(ii.1)
C1∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα3/summationdisplay
i/negationslash=jρ8
ij/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(ii.2)
C2∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα3/summationdisplay
i/negationslash=j/parenleftBiggˆS4
T,i,jS2
T,i,iS2
T,j,j−S4
T,i,jˆS2
T,i,iˆS2
T,j,j
S4
T,i,jˆS2
T,i,iˆS2
T,j,j/parenrightBigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
(ii.1)By lemma 7, we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα3/summationdisplay
i/negationslash=jρ8
ij/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤Op/parenleftbigg(logn)4
n2Tα3/parenrightbigg
=op(1).
Therefore, C1=op(1) holds.
(ii.2)By direct calculation, we have
C2≤Tα3−16/summationdisplay
i/negationslash=j|IC2|2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j,
where
IC2=[(v′
i−w′
i)(vj−wj)]4(v′
ivi)2(v′
jvj)2−(v′
ivj)4[(v′
i−w′
i)(vi−wi)]2/bracketleftbig
(v′
j−w′
j)(vj−wj)/bracketrightbig2.
Consequently,
C2≤Tα3−16/summationdisplay
i/negationslash=j1
S8
T,i,jˆS4
T,i,iˆS4
T,j,j|68/summationdisplay
m=1C2,m|2
=Tα3−16/summationdisplay
i/negationslash=j1
S8
T,i,jˆS4
T,i,iˆS4
T,j,j|/summationdisplay
m1,m2δm1,m2C2,m1C2,m2|,
39whereδm1,m2is a constant only depending on m1andm2. By the same arguments in the
proof of Lemma 2, we only need to show that
Tα3−16/summationdisplay
i/negationslash=j|C2,m|2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j=op(1),
for any 1 ≤m≤68. By Lemma 8, for 1 ≤m≤32, one can show that the stochastic order
dominating terms are
Tα3−16/summationdisplay
i/negationslash=j/vextendsingle/vextendsingle−4(v′
ivj)3w′
ivj(v′
ivi)2(v′
jvj)2/vextendsingle/vextendsingle2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j,
Tα3−16/summationdisplay
i/negationslash=j/vextendsingle/vextendsingle−4(v′
ivj)3v′
iwj(v′
ivi)2(v′
jvj)2/vextendsingle/vextendsingle2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j,
and
Tα3−16/summationdisplay
i/negationslash=j/vextendsingle/vextendsingle−4(v′
ivj)3w′
iwj(v′
ivi)2(v′
jvj)2/vextendsingle/vextendsingle2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j,
which have the same order Op(n10
r1+4ǫ1+8ǫ2+α3−4) =op(1). For 33 ≤m≤68, stochastic
order dominating terms have the same order of
Tα3−16/summationdisplay
i/negationslash=j/vextendsingle/vextendsingle−4(v′
ivj)4(v′
ivi)2v′
jvjw′
jvj/vextendsingle/vextendsingle2
S8
T,i,jˆS4
T,i,iˆS4
T,j,j,
whose order is Op(n8
r1+8ǫ1+6ǫ2+α2−1) =op(1). Therefore, we can conclude that C2=op(1).
(iii)By direct calculation, we have
D∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=l(ˆρijˆρjlˆρil−ρijρjlρil)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=lρijρjlρil/parenleftbiggˆρijˆρjlˆρil
ρijρjlρil−1/parenrightbigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤/radicalBigg/summationdisplay
i/negationslash=j/negationslash=lρ2
ijρ2
jlρ2
il·/radicaltp/radicalvertex/radicalvertex/radicalbt/summationdisplay
i/negationslash=j/negationslash=l/parenleftbiggˆρijˆρjlˆρil
ρijρjlρil−1/parenrightbigg2
.
For constant 0 < α4<1, we show that:
(iii.1)
D1∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα4/summationdisplay
i/negationslash=j/negationslash=lρ2
ijρ2
jlρ2
il/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
40(iii.2)
D2∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα4−12/summationdisplay
i/negationslash=j/negationslash=l/parenleftBiggˆST,i,jˆST,j,lˆST,i,lST,i,iST,j,jST,l,l−ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l
ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l/parenrightBigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
(iii.1)By lemma 7, we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα4/summationdisplay
i/negationslash=j/negationslash=lρ2
ijρ2
jlρ2
il/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤1
Tα4Op/parenleftbigg
(logn
n)3·n3/parenrightbigg
=Op/parenleftBig(logn)3
Tα4/parenrightBig
=op(1).
Therefore, F1=op(1) holds.
(iii.2)By direct calculation, we have
D2≤Tα4−12/summationdisplay
i/negationslash=j/negationslash=l|ID2|2
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2,
where
ID2= (v′
i−w′
i)(vj−wj)(v′
j−w′
j)(vl−wl)(v′
i−w′
i)(vl−wl)v′
iviv′
jvjv′
lvl
−v′
ivjv′
jvlv′
ivl(v′
i−w′
i)(vi−wi)(v′
j−w′
j)(vj−wj)(v′
l−w′
l)(vl−wl).
Thus
D2≤Tα4−12/summationdisplay
i/negationslash=j/negationslash=l1
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2/vextendsingle/vextendsingle/vextendsingle80/summationdisplay
m=1D2,m/vextendsingle/vextendsingle/vextendsingle2
=Tα4−12/summationdisplay
i/negationslash=j/negationslash=l1
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2/vextendsingle/vextendsingle/vextendsingle/summationdisplay
m1,m2ξm1,m2D2,m1D2,m2/vextendsingle/vextendsingle/vextendsingle,
whereξm1,m2is a constant only depending on m1andm2. By the same arguments in the
proof of Lemma 2, we only need to show that
Tα4−12/summationdisplay
i/negationslash=j/negationslash=l|D2,m|2
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2=op(1),
for any 1 ≤m≤80. By Lemma 8, for 1 ≤m≤63, one can show that the stochastic order
dominating terms have the same order of
Tα4−12/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle−v′
ivjv′
jvlw′
ivlv′
iviv′
jvjv′
lvl/vextendsingle/vextendsingle2
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2,
41whose orders are Op(n6
r1+4ǫ1+4ǫ2+α4−1) =op(1). For 64 ≤m≤80, the stochastic order
dominating terms have the same order of
Tα4−12/summationdisplay
i/negationslash=j/negationslash=l/vextendsingle/vextendsingle−v′
ivjv′
jvlv′
ivlv′
iviv′
jvjv′
lwl/vextendsingle/vextendsingle2
(ST,i,jST,j,lST,i,lˆST,i,iˆST,j,jˆST,l,l)2,
whoseordersare Op(n8
r1+4ǫ1+6ǫ2+α4−2) =op(1). Therefore, wecanconcludethat D2=op(1).
(iv)By direct calculation, we have
E∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s(ˆρijˆρjlˆρlsˆρsi−ρijρjlρlsρsi)/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
i/negationslash=j/negationslash=l/negationslash=sρijρjlρlsρsi/parenleftbiggˆρijˆρjlˆρlsˆρsi
ρijρjlρlsρsi−1/parenrightbigg/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤/radicalBigg/summationdisplay
i/negationslash=j/negationslash=l/negationslash=sρ2
ijρ2
jlρ2
lsρ2
si·/radicaltp/radicalvertex/radicalvertex/radicalbt/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s/parenleftbiggˆρijˆρjlˆρlsˆρsi
ρijρjlρlsρsi−1/parenrightbigg2
.
For constant 0 < α5<1, we show that:
(iv.1)
E1∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα5/summationdisplay
i/negationslash=j/negationslash=l/negationslash=sρ2
ijρ2
jlρ2
lsρ2
si/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1),
(iv.2)
E2∆=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα5/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s/parenleftbiggˆρijˆρjlˆρlsˆρsi
ρijρjlρlsρsi−1/parenrightbigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle=op(1).
(iv.1)By lemma 7, we have
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle1
Tα5/summationdisplay
i/negationslash=j/negationslash=l/negationslash=sρ2
ijρ2
jlρ2
lsρ2
si/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤1
Tα5Op/parenleftbigg
(logn
n)4·n4/parenrightbigg
=Op/parenleftbigg(logn)4
Tα5/parenrightbigg
=op(1).
Therefore, E1=op(1) holds.
(ii.2)By direct calculation, we have
|E2|
=/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingleTα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s/parenleftBiggˆST,i,jˆST,j,lˆST,l,sˆST,s,iST,i,iST,j,jST,l,lST,s,s−ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s
ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s/parenrightBigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s|IE2|2
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2,
42where
IE2= (v′
i−w′
i)(vj−wj)(v′
j−w′
j)(vl−wl)(v′
l−w′
l)(vs−ws)(v′
s−w′
s)(vi−wi)v′
iviv′
jvjv′
lvlv′
svs
−v′
ivjv′
jvlv′
lvsv′
svi(v′
i−w′
i)(vi−wi)(v′
j−w′
j)(vj−wj)(v′
l−w′
l)(vl−wl)(v′
s−w′
s)(vs−ws).
Thus
E2≤Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s1
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2/vextendsingle/vextendsingle/vextendsingle336/summationdisplay
m=1E2,m/vextendsingle/vextendsingle/vextendsingle2
=Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s1
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2/vextendsingle/vextendsingle/vextendsingle/summationdisplay
m1,m2λm1,m2E2,m1E2,m1/vextendsingle/vextendsingle/vextendsingle,
whereλm1,m2is a constant only depending on m1andm2. By the same arguments in the
proof of Lemma 2, we only need to show that
Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s|E2,m|2
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2=op(1),
for any 1 ≤m≤336. By Lemma 8, for 1 ≤m≤255, stochastic order dominating terms
have the same order of
Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s/vextendsingle/vextendsinglev′
ivjv′
jvlv′
lvsv′
swiv′
iviv′
jvjv′
lvlv′
svs/vextendsingle/vextendsingle2
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2,
whose orders are Op(n8
r1+4ǫ1+6ǫ2+α5−1) =op(1). For 256 ≤m≤336, one can show that the
stochastic order dominating terms have the same order of
Tα5−16/summationdisplay
i/negationslash=j/negationslash=l/negationslash=s/vextendsingle/vextendsingle−2v′
ivjv′
jvlv′
lvsv′
sviv′
iviv′
jvjv′
lvlv′
sws/vextendsingle/vextendsingle2
(ST,i,jST,j,lST,l,sST,s,iˆST,i,iˆST,j,jˆST,l,lˆST,s,s)2,
whoseordersare Op(n10
r1+4ǫ1+8ǫ2+α5−2) =op(1). Therefore, wecanconclude that E2=op(1).
Finally, proof of proposition 2 is completed.
Proof of Theorem 3 and 4
For the dynamic panel data model, let Zi= (zi1,...,ziT), thenˆφi= (ZiZ′
i)−1Ziyi
is the OLS estimator and the residuals are given by ˆˆvit=vit−z′
it/parenleftBig
ˆφi−φi/parenrightBig
. In vector
form,ˆvi=vi−Z′
i/parenleftBig
ˆφi−φi/parenrightBig
. DeﬁneˆˆV=/parenleftbigg
ˆv1,···,ˆvn/parenrightbigg
,ˆˆwi=Z′
i/parenleftBig
ˆφi−φi/parenrightBig
andˆˆW=
43/parenleftbigg
ˆˆw1,···,ˆˆwn/parenrightbigg
. Using this notation, ˆvi=vi−ˆˆwi. Replacing ˆβiandXiwithˆφiandZi,
respectively, the proofs of Theorem 3 and 4 follow along the same ar guments above, that
is, we only need to verify that (a) and (b) in Lemma 8 still hold for the d ynamic panel
data model.
Lemma 9. Under Assumptions 1, 2, 3, 4 and 5, for any ǫ >0and some integer r1≥3,
i.e.E|vit|r1<∞
(a)max
1≤i,j≤n|/an}bracketle{tvi,ˆˆwj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
(b)max
1≤i,j≤n|/an}bracketle{tˆˆwi,ˆˆwj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
Proof.(a). Firstly, for the case i=j
max
1≤i≤n|/an}bracketle{tvi,ˆˆwi/an}bracketri}ht|= max
1≤i≤n|v′
iZ′
i(ˆφi−φi)| ≤max
1≤i≤n/bardblv′
iZ′
i/bardblmax
1≤i≤n/bardblˆφi−φi/bardbl.
We have max 1≤i≤n/bardblˆφi−φi/bardbl=Op(n1
2r1+ǫ1−1
2) for some integer r3>3 andǫ3>0 by Lemma
8, then
max
1≤i≤n/bardblv′
iZ′
i/bardbl= max
1≤i≤n/bardblv′
i(yi,X′
i)/bardbl= max
1≤i≤n/bardbl(v′
iyi,v′
iX′
i)/bardbl ≤max
1≤i≤n/bardblv′
iyi/bardbl+ max
1≤i≤n/bardblv′
iX′
i/bardbl.
For max 1≤i≤n/bardblv′
iX′
i/bardbl:
max
1≤i≤n/bardblv′
iX′
i/bardbl= max
1≤i≤n/bardbl√
Tξ′
i(XiX′
i
T)1
2/bardbl ≤max
1≤i≤n/bardbl√
Tξ′
i/bardbl·Op(1) =Op(n1
2r1+ǫ1+1
2).
For max 1≤i≤n/bardblv′
iy′
i/bardbl: Applying martingale theory, we show that v′
iy′
i=/summationtextT
t=1yit−1vit
converged to a centered normal distribution. Let ST=/summationtextT
t=1yit−1vit, we aim to ver-
ify conditions A1 and A2 imposed in Corollary 2.1.10 of Duﬂo (2013). Firs tly,/an}bracketle{tM/an}bracketri}htT∆=
/summationtextT
t=1E((St−St−1)2|Ft−1) =/summationtextT
t=1E/parenleftbig
y2
it−1v2
it|Ft−1/parenrightbig
=σ2/summationtextT
t=1y2
it−1,whereFt−1is the
corresponding ﬁltration. Therefore, /an}bracketle{tM/an}bracketri}htT/Tp−→σ2E(y2
i,0) under Assumption 5(i), so that
A1 holds. Note that the Lyapunov condition
1
(√
T)4T/summationdisplay
t=1E/parenleftbig
|yi,t−1vit|4|Ft−1/parenrightbig
=E(vit)4
T2T/summationdisplay
t=1y4
it−1p−→0
44holds under Assumption 5(i), which indicates that A2 holds as well. The assertion follows
from Corollary 2.1.10 of Duﬂo (2013), so that max 1≤i≤n/bardblv′
iy′
i/bardbl=Op(n1
2r1+ǫ1) by Lemma
8. Consequently,
max
1≤i≤n|/an}bracketle{tvi,ˆˆwi/an}bracketri}ht| ≤Op(n1
2r1+ǫ1+1
2)·Op(n1
2r1+ǫ1−1
2) =Op(n1
r1+2ǫ1).
The case i/ne}ationslash=jis similar.
(b)
max
1≤i,j≤n|/an}bracketle{tˆˆwi,ˆˆwj/an}bracketri}ht|= max
1≤i,j≤n|(ˆφi−φi)′ZiZ′
j(ˆφj−φj)| ≤/parenleftBig
max
i/bardblˆφi−φi/bardblmax
i/bardblZi/bardbl/parenrightBig2
≤/parenleftBig
max
i/bardblˆφi−φi/bardbl(max
i/bardblyi/bardbl+max
i/bardblXi/bardbl)/parenrightBig2
.
UnderAssumption4(ii)and5(ii),max i/bardblXi/bardbl ≤maxi/bardblXiX′
i/bardbl1
2=Op(√
T)andmax i/bardblyi/bardbl ≤
maxi/bardblyiy′
i/bardbl1
2=Op(√
T), so that max 1≤i,j≤n|/an}bracketle{tˆˆwi,ˆˆwj/an}bracketri}ht| ≤/parenleftBig
Op(n1
2r1+ǫ1−1
2)·Op(√
T)/parenrightBig2
=
Op(n1
r1+2ǫ1).
Proofs of Theorem 5 and 6
Fortheﬁxed eﬀects panel datamodel, ˆβisthewithin estimator andthewithinresiduals
aregiven by ˆ vfixed
it= ˜yit−˜x′
it(ˆβ−β). Let¯xi·=1
T/summationtextT
t=1xit, ¯yi·=1
T/summationtextT
t=1yit, ¯vi·=1
T/summationtextT
t=1vit
and ˜vit=vit−¯vi·. Deﬁne ˜vi= (˜vi1,...,˜viT)′,¯vi= (¯vi·,...,¯vi·)′,˜Xi= (˜xi1,...,˜xiT)′and
¯Xi= (¯xi·,...,¯xi·)′. Let˜wi=˜X′
i/parenleftBig
ˆβ−β/parenrightBig
and˜W=/parenleftbigg
˜w1,···,˜wn/parenrightbigg
. Again, it suﬃces to
verify that Lemma 8 (a) and (b) still hold for the ﬁxed eﬀect panel d ata model.
Lemma 10. Under Assumptions 1, 2,3 and 4, for any ǫ >0and some integer r1≥3, i.e.
E|vit|r1<∞
(a)max
1≤i,j≤n|/an}bracketle{t˜vi,˜wj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
(b)max
1≤i,j≤n|/an}bracketle{t˜wi,˜wj/an}bracketri}ht|=Op(n1
r1+2ǫ1).
Proof.(a) When i=j, by˜vi=vi−¯viand˜Xi=Xi−¯Xi
max
1≤i≤n|/an}bracketle{t˜vi,˜wi/an}bracketri}ht|= max
1≤i≤n|˜v′
i˜Xi(ˆβ−β)| ≤max
1≤i≤n|v′
iXi(ˆβ−β)|+ max
1≤i≤n|¯v′
iXi(ˆβ−β)|
+ max
1≤i≤n|v′
i¯Xi(ˆβ−β)|+ max
1≤i≤n|¯v′
i¯Xi(ˆβ−β)|.
45For max 1≤i≤n|v′
iXi(ˆβ−β)|:
max
1≤i≤n|v′
iXi(ˆβ−β)|= max
1≤i≤n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/summationdisplay
tvitx′
it/parenleftBig
ˆβ−β/parenrightBig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle= max
1≤i≤n/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle√
Tξ′
i/parenleftbigg1
TXiX′
i/parenrightbigg1
2/parenleftBig
ˆβ−β/parenrightBig/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle
≤√
T/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/parenleftbigg1
TXiX′
i/parenrightbigg1
2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle·max
1≤i≤n/bardblξi/bardbl·/vextenddouble/vextenddouble/vextenddoubleˆβ−β/vextenddouble/vextenddouble/vextenddouble
=Op/parenleftBigg
√
T·n1
2r1+ǫ1
√
nT/parenrightBigg
=Op(n1
2r1+ǫ1−1/2).
For max 1≤i≤n|¯v′
iXi(ˆβ−β)|:
1
T¯v′
iXi=1
TT/summationdisplay
t=1¯vi·xit=/parenleftBig1
TT/summationdisplay
s=1vis/parenrightBig/parenleftBig1
TT/summationdisplay
t=1xit/parenrightBig
=Op(n2r1+ǫ1−1
2)·Op(1) =Op(n2r1+ǫ1−1
2),
uniformly in isince1
T/summationtextT
t=1xit=Op(1) holds uniformly by Assumption 3 and by As-
sumption 4 and Lemma 8, we have max 1≤i≤n|1
T/summationtextT
t=1vit|=Op(n2r1+ǫ1−1
2). Therefore
max1≤i≤n|¯v′
iXi(ˆβ−β)|=Op(n1
2r1+ǫ1−1/2). Using same techniques, max 1≤i≤n|v′
i¯Xi(ˆβ−
β)|=Op(n1
2r1+ǫ1−1/2)andmax 1≤i≤n|¯v′
i¯Xi(ˆβ−β)|=Op(n1
2r1+ǫ1−1/2),sothatmax 1≤i≤n|v′
iXi(ˆβ−
β)|=Op(n1
2r1+ǫ1−1/2)≤Op(n1
r1+2ǫ1).
The calculations for i/ne}ationslash=jcase is similar.
(b)
|/an}bracketle{t˜wi,˜wj/an}bracketri}ht|=|(ˆβ−β)′˜X′
i˜Xj(ˆβ−β)| ≤|(ˆβ−β)′X′
iXj(ˆβ−β)|+|(ˆβ−β)′¯X′
iXj(ˆβ−β)|+
|(ˆβ−β)′X′
i¯Xj(ˆβ−β)|+|(ˆβ−β)′¯X′
i¯Xj(ˆβ−β)|.
For max 1≤i≤n|(ˆβ−β)′X′
iXj(ˆβ−β)|:
/bardblX′
i(ˆβ−β)/bardbl/bardblX′
j(ˆβ−β)/bardbl ≤ /bardblXi/bardbl/bardblXj/bardbl/bardblˆβ−β/bardbl2≤ /bardblXiX′
i/bardbl1/2/bardblXjX′
j/bardbl1/2/bardblˆβ−β/bardbl2
=Op(T1/2)Op(T1/2)Op(1/(nT)) =Op(n−1).
Lastly,|(ˆβ−β)′¯X′
iXj(ˆβ−β)|,|(ˆβ−β)′X′
i¯Xj(ˆβ−β)|and|(ˆβ−β)′¯X′
i¯Xj(ˆβ−β)|are
allOp(n−1) by Assumption 4. Therefore, max 1≤i,j≤n|/an}bracketle{t˜Wi,˜Wj/an}bracketri}ht|=Op(n−1)≤Op(n1
r1+2ǫ1).
46References
Bailey, N., J. Dandan, andJ. Yao (2021). Alagrange-multiplier test f or largeheterogeneous
panel data models. Available at SSRN 3804164 .
Bailey, N., G. Kapetanios, and M. H. Pesaran (2016). Exponent of c ross-sectional depen-
dence: Estimation and inference. Journal of Applied Econometrics 31 (6), 929–960.
Baltagi, B. H., G. Bresson, and A. Pirotte (2008). To pool or not to pool? In The
Econometrics of Panel Data , pp. 517–546. Springer.
Baltagi, B. H., Q. Feng, and C. Kao (2012). A lagrange multiplier test f or cross-sectional
dependence in a ﬁxed eﬀects panel data model. Journal of Econometrics 170 (1), 164–
177.
Breusch, T. S. and A. R. Pagan (1980). The lagrange multiplier test and its applications to
model speciﬁcation in econometrics. The Review of Economic Studies 47 (1), 239–253.
Cai, T. T., T. Jiang, et al. (2011). Limiting laws of coherence of rando m matrices with
applications to testing covariance structure and construction of compressed sensing ma-
trices.The Annals of Statistics 39 (3), 1496–1525.
Cai, T. T., W. Liu, and Y. Xia (2014). Two-sample test of high dimension al means under
dependence. Journal of the Royal Statistical Society: Series B: Statist ical Methodology ,
349–372.
Chudik, A. and M. H. Pesaran (2015). Common correlated eﬀects e stimation of het-
erogeneous dynamic panel data models with weakly exogenous regr essors.Journal of
econometrics 188 (2), 393–420.
Chudik, A., M. H. Pesaran, and J.-C. Yang (2018). Half-panel jack knife ﬁxed-eﬀects esti-
47mation of linear panels with weakly exogenous regressors. Journal of Applied Economet-
rics 33(6), 816–836.
Duﬂo, M. (2013). Random iterative models , Volume34. Springer Science & Business Media.
Dufour, J.-M. and L. Khalaf (2002). Exact tests for contempora neous correlation of dis-
turbances in seemingly unrelated regressions. Journal of Econometrics 106 (1), 143–170.
Ertur, C. and A. Musolesi (2017). Weak and strong cross-sectio nal dependence: A
panel data analysis of international technology diﬀusion. Journal of Applied Econo-
metrics 32 (3), 477–503.
Fan, J., Y. Liao, and J. Yao (2015). Power enhancement inhigh-dime nsional cross-sectional
tests.Econometrica 83 (4), 1497–1541.
Frees, E. W. (1995). Assessing cross-sectional correlation in pa nel data. Journal of Econo-
metrics 69 (2), 393–414.
Hahn, J. andG.Kuersteiner (2002). Asymptotically unbiased infer ence foradynamic panel
model with ﬁxed eﬀects when both n and t are large. Econometrica 70 (4), 1639–1657.
Hall, P., J. Jin, et al. (2010). Innovated higher criticism for detectin g sparse signals in
correlated noise. The Annals of Statistics 38 (3), 1686–1732.
Halunga,A.G.,C.D.Orme, andT.Yamagata(2017). Aheterosked asticity robustbreusch–
pagan test for contemporaneous correlation in dynamic panel dat a models. Journal of
Econometrics 198 (2), 209–230.
Lai, T. L. and C. Z. Wei (1982). Least squares estimates in stocha stic regression mod-
els with applications to identiﬁcation and control of dynamic systems .The Annals of
Statistics 10 (1), 154–166.
48Li, D., Y. Qi, and A. Rosalsky (2012). On jiang’s asymptotic distributio n of the largest
entry of a sample correlation matrix. Journal of Multivariate Analysis 111 , 256–270.
Liu, W.-D., Z. Lin, Q.-M. Shao, et al. (2008). The asymptotic distribut ion and berry–
esseen bound of a new test for independence in high dimension with an application to
stochastic optimization. Annals of Applied Probability 18 (6), 2337–2366.
Pesaran, M. H. (2004). General diagnostic tests for cross-sec tional dependence in panels.
CESifo Working Paper No. 1229 .
Pesaran, M. H. (2015). Testing weak cross-sectional dependen ce in large panels. Econo-
metric Reviews 34 (6-10), 1089–1117.
Pesaran, M. H., A. Ullah, and T. Yamagata (2008). A bias-adjusted lm test of error
cross-section independence. The Econometrics Journal 11 (1), 105–127.
Petrov, V.V. (1975). Sums of Independent Random Variables . Springer, Berlin, Heidelberg.
Saraﬁdis, V., T. Yamagata, andD.Robertson(2009). Atest of cr osssection dependence for
a linear dynamic panel model with regressors. Journal of Econometrics 148 (2), 149–161.
Yao, J., S. Zheng, and Z. Bai (2015). Sample covariance matrices and high-dimensional
data analysis . Cambridge University Press Cambridge.
Yin, Y., C. Li, G.-L. Tian, and S. Zheng (2021). Spectral properties of rescaled sample
correlation matrix. Statistica Sinica .
49