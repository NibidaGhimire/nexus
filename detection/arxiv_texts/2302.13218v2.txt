Schr¨ odinger equation with finitely many δ-interactions:
closed form, integral and series representations for
solutions
Vladislav V. Kravchenko1, V´ ıctor A. Vicente-Ben´ ıtez2
1Department of Mathematics, Cinvestav, Campus Quer´ etaro
Libramiento Norponiente # 2000,
Fracc. Real de Juriquilla, Quer´ etaro, Qro. C.P. 76230 M´ exico
2Instituto de Matem´ aticas de la U.N.A.M. Campus Juriquilla
Boulevard Juriquilla 3001, Juriquilla, Quer´ etaro C.P. 076230 M´ exico
vkravchenko@math.cinvestav.edu.mx, va.vicentebenitez@im.unam.mx,
Abstract
A closed form solution for the one-dimensional Schr¨ odinger equation with a finite
number of δ-interactions
Lq,INy:=−y′′+ 
q(x) +NX
k=1αkδ(x−xk)!
y=λy, 0< x < b, λ ∈C
is presented in terms of the solution of the unperturbed equation
Lqy:=−y′′+q(x)y=λy, 0< x < b, λ ∈C
and a corresponding transmutation operator Tf
INis obtained in the form of a Volterra
integral operator. With the aid of the spectral parameter power series method, a
practical construction of the image of the transmutation operator on a dense set is
presented, and it is proved that the operator Tf
INtransmutes the second derivative
into the Schr¨ odinger operator Lq,INon a Sobolev space H2. A Fourier-Legendre series
representation for the integral transmutation kernel is developed, from which a new
representation for the solutions and their derivatives, in the form of a Neumann series
of Bessel functions, is derived.
Keywords: One-dimensional Schr¨ odinger equation, point interactions, transmutation
operator, Fourier-Legendre series, Neumann series of Bessel functions.
MSC Classification: 34A25; 34A45; 46F10; 47G10; 81Q05.
1arXiv:2302.13218v2  [math.CA]  12 Apr 20241 Introduction
We consider the one-dimensional Schr¨ odinger equation with a finite number of δ-interactions
−y′′+ 
q(x) +NX
k=1αkδ(x−xk)!
y=λy, 0< x < b, λ ∈C, (1)
where q∈L2(0, b) is a complex valued function, δ(x) is the Dirac delta distribution, 0 <
x1< x 2<···< x N< bandα1, . . . , α N∈C\{0}. Schr¨ odinger equations with distributional
coefficients supported on a set of measure zero naturally appear in various problems of
mathematical physics [3, 4, 5, 6, 16, 44] and have been studied in a considerable number of
publications and from different perspectives. In general terms, Eq. (1) can be interpreted as a
regular equation, i.e., with the regular potential q∈L2(0, b), whose solutions are continuous
and such that their first derivatives satisfy the jump condition y′(xk+)−y′(xk−) =αky(xk)
at special points [25, 26]. Another approach consists in considering the interval [0 , b] as
a quantum graph whose edges are the segments [ xk, xk+1],k= 0, . . . , N , (setting x0= 0,
xN+1=b), and the Schr¨ odinger operator with the regular potential qas an unbounded
operator on the direct sumLN
k=0H2(xk, xk+1), with the domain given by the families ( yk)N
k=0
that satisfy the condition of continuity yk(xk−) =yk+1(xk+) and the jump condition for the
derivative y′
k+1(xk+)−y′
k(xk−) =αkyk(xk) for k= 1, . . . N (see, e.g., [18, 34, 35]). This
condition for the derivative is known in the bibliography of quantum graphs as the δ-type
condition [9]. Yet another approach implies a regularization of the Schrodinger operator
with point interactions, that is, finding a subdomain of the Hilbert space L2(0, b), where the
operator defines a function in L2(0, b). For this, note that the potential q(x)+PN
k=1αkδ(x−
xk) defines a functional that belongs to the Sobolev space H−1(0, b). In [11, 20, 23, 42] these
forms of regularization have been studied, rewriting the operator by means of a factorization
that involves a primitive σof the potential.
Theory of transmutation operators, also called transformation operators, is a widely
used tool in studying differential equations and spectral problems (see, e.g., [8, 29, 36, 39,
43]), and it is especially well developed for Schr¨ odinger equations with regular potentials.
It is known that under certain general conditions on the potential qthe transmutation
operator transmuting the second derivative into the Schr¨ odinger operator can be realized in
the form of a Volterra integral operator of the second kind, whose kernel can be obtained
by solving a Goursat problem for the Klein-Gordon equation with a variable coefficient
[14, 36, 39]. Furthermore, functional series representations of the transmutation kernel have
been constructed and used for solving direct and inverse Sturm-Liouville problems [29, 30].
For Schr¨ odinger equations with δ-point interactions, there exist results about equations
with a single point interaction and discontinuous conditions y(x1+) = ay(x1−),y′(x1+) =
1
ay′(x1−)+dy(x1−),a, b > 0 (see [22, 46]), and for equations in which the spectral parameter
is also present in the jump condition (see [1, 37, 38]). Transmutation operators have also been
studied for equations with distributional coefficients belonging to the H−1-Sobolev space in
[11, 23, 42]. In [14], the possibility of extending the action of the transmutation operator for
anL1-potential to the space of generalized functions D′, was studied.
The aim of this work is to present a construction of a transmutation operator for the
Schr¨ odinger equation with a finite number of point interactions. The transmutation operator
appears in the form of a Volterra integral operator, and with its aid we derive analytical
2series representations for solutions of (1). For this purpose, we obtain a closed form of the
general solution of (1). From it, the construction of the transmutation operator is deduced,
where the transmutation kernel is ensembled from the convolutions of the kernels of certain
solutions of the regular equation (with the potential q), in a finite number of steps. Next,
the spectral parameter power series (SPPS) method is developed for Eq. (1). The SPPS
method was developed for continuous ([27, 31]) and L1-potentials ([10]), and it has been used
in a piecewise manner for solving spectral problems for equations with a finite number of
point interactions in [6, 7, 41]. Following [15], we use the SPPS method to obtain an explicit
construction of the image of the transmutation operator acting on polynomials. Similarly to
the case of a regular potential [30], we obtain a representation of the transmutation kernel
as a Fourier series in terms of Legendre polynomials and as a corollary, a representation
for the solutions of equation (1) in terms of a Neumann series of Bessel functions. Similar
representations are obtained for the derivatives of the solutions. It is worth mentioning
that the methods based on Fourier-Legendre representations and Neumann series of Bessel
functions have shown to be an effective tool in solving direct and inverse spectral problems
for equations with regular potentials, see, e.g., [29, 30, 33].
In Section 2, basic properties of the solutions of (1) are compiled, studying the equation as
a distributionional sense in D′(0, b) and deducing properties of its regular solutions. Section
3 presents the construction of the closed form solution of (1). In Section 4, the construction
of the transmutation operator and the main properties of the transmutation kernel are
developed. In Section 5, the SPPS method is presented, with the mapping and transmutation
properties of the transmutation operator. Section 6 presents the Fourier-Legendre series
representations for the transmutation kernels and the Neumann series of Bessel functions
representations for solutions of (1), and a recursive integral relation for the Fourier-Legendre
coefficients is obtained. Finally, in Section 7, integral and Neumann series of Bessel functions
representations for the derivatives of the solutions are presented.
2 Problem setting and properties of the solutions
We use the standard notation Wk,p(0, b) (b >0) for the Sobolev space of functions in Lp(0, b)
that have their first kweak derivatives in Lp(0, b), 1⩽p⩽∞andk∈N. When p= 2,
we denote Wk,2(0, b) =Hk(0, b). We have that W1,1(0, b) =AC[0, b], and W1,∞(0, b) is
precisely the class of Lipschitz continuous functions in [0 , b] (see [12, Ch. 8]). The class
of smooth functions with compact support in (0 , b) is denoted by C∞
0(0, b), then we define
W1,p
0(0, b) =C∞
0(0, b)W1,p
andH1
0(0, b) =W1,2
0(0, b). Denote the dual space of H1
0(0, b) by
H−1(0, b). By L2,loc(0, b) we denote the class of measurable functions f: (0, b)→Csuch
thatRβ
α|f(x)|2dx <∞for all subintervals [ α, β]⊂(0, b).
The characteristic function of an interval [ A, B]⊂Ris denoted by χ[A,B](t). In order
to simplify the notation, for the case of a symmetric interval [ −A, A], we simply write χA.
The Heaviside function is given by H(t) =χ(0,∞)(t). The lateral limits of the function fat
the point ξare denoted by f(ξ±) = lim x→ξ±f(x). We use the notation N0=N∪ {0}. The
space of distributions (generalized functions) over C∞
0(0, b) is denoted by D′(0, b), and the
value of a distribution f∈D′(0, b) atϕ∈C∞
0(0, b) is denoted by ( f, ϕ)C∞
0(0,b).
3LetN∈Nand consider a partition 0 < x 1<···< x N< band the numbers α1, . . . , α N∈
C\ {0}. The set IN={(xj, αj)}N
j=1contains the information about the point interactions
of Eq. (1). Denote
qδ,IN(x) :=NX
k=1αkδ(x−xk),Lq:=−d2
dx2+q(x),Lq,IN:=Lq+qδ,IN(x).
Foru∈L2,loc(0, b),Lq,INudefines a distribution in D′(0, b) as follows
(Lq,INu, ϕ)C∞
0(0,b):=Zb
0u(x)Lqϕ(x)dx+NX
k=1αku(xk)ϕ(xk) for ϕ∈C∞
0(0, b).
Note that the function umust be well defined at the points xk,k= 1, . . . , N . Actually, for
a function u∈H1(0, b), the distribution Lq,INucan be extended to a functional in H−1(0, b)
as follows
(Lq,INu, v)H1
0(0,b):=Zb
0{u′(x)v′(x) +q(x)u(x)v(x)}dx+NX
k=1αku(xk)v(xk) for v∈H1
0(0, b).
We say that a distribution F∈D′(0, b) isL2-regular, if there exists a function g∈L2(0, b)
such that ( F, ϕ)C∞
0(0,b)= (g, ϕ)C∞
0(0,b):=Rb
0g(x)ϕ(x)dxfor all ϕ∈C∞
0(0, b).
Denote x0= 0, xN+1=b. We recall the following characterization of functions u∈
L2,loc(0, b) for which Lq,INuisL2-regular.
Proposition 1 Ifu∈L2,loc(0, b), then the distribution Lq,INuisL2-regular iff the following
conditions hold.
1. For each k= 0, . . . , N ,u|(xk,xk+1)∈H2(xk, xk+1).
2.u∈AC[0, b].
3. The discontinuities of the derivative u′are located at the points xk,k= 1, . . . , N , and
the jumps are given by
u′(xk+)−u′(xk−) =αju(xk)fork= 1,···, N. (2)
In such case,
(Lq,INu, ϕ)C∞
0(0,b)= (Lqu, ϕ)C∞
0(0,b)for all ϕ∈C∞
0(0, b). (3)
Proof. Suppose that Lq,INuisL2-regular. Then there exists g∈L2(0, b) such that
(Lq,INu, ϕ)C∞
0(0,b)= (g, ϕ)C∞
0(0,b)for all ϕ∈C∞
0(0, b). (4)
41. Fix k∈ {1, . . . , N −1}. Take a test function ϕ∈C∞
0(0, b) with Supp( ϕ)⊂(xk, xk+1).
Hence Zxk+1
xkg(x)ϕ(x)dx= (Lq,INu, ϕ)C∞
0(0,b)=Zxk+1
xku(x)Lqϕ(x)dx, (5)
because ϕ(xj) = 0 for j= 1, . . . , N . From (5) we obtain
Zxk+1
xku(x)ϕ′′(x)dx=Zxk+1
xk{q(x)u(x)−g(x)}ϕ(x)dx.
Setv(x) =Rx
0Rt
0{q(s)u(s)−g(s)}dsdt. Hence v∈W2,1(xj, xj+1),v′′(x) =q(x)u(x)−
g(x) a.e. x∈(xj, xj+1), and we get the equality
Zxk+1
xk(u(x)−v(x))ϕ′′(x)dx= 0∀ϕ∈C∞
0(xk, xk+1). (6)
Equality (6) implies that u(x) =v(x) +Ax+Ba.e.x∈(xk, xk+1) for some constants
AandB([45, pp. 85]). In consequence u∈W2,1(xk, xk+1) and
−u′′(x) +q(x)u(x) =g(x) a.e. x∈(xk, xk+1). (7)
Furthermore, u∈C[xk, xk+1], hence qu∈L2(xk, xk+1) and then u′′=qu−g∈
L2(xk, xk+1). In this way u|(xk,xk+1)∈H2(xk, xk+1).
Now take ε >0 and an arbitrary ϕ∈C∞
0(ε, x1). We have that
(Lq,INu, ϕ)C∞
0(0,b)=Zx1
ε{−u(x)ϕ′′(x) +q(x)u(x)ϕ(x)}dx=Zx1
εg(x)ϕ(x)dx.
Applying the same procedure as in the previous case we obtain that u∈H2(ε, x1) and
satisfies Eq. (7) in the interval ( ε, x1). Since εis arbitrary, we conclude that usatisfies
(7) for a.e. x∈(0, x1). Since q, g∈L2(0, x1), then u|(0,x1)∈H2(0, x1) (see [47, Th.
3.4]). The proof for the interval ( xN, b) is analogous.
Since u∈C1[xk, xk+1],k= 0, . . . , N , the following equality is valid (see formula (6)
from [24, pp. 100])
Zb
0u(x)ϕ′′(x)dx=NX
k=1{u′(xk+)−u′(xk−)}ϕ(xk) (8)
−NX
k=1{u(xk+)−u(xk−)}ϕ′(xk) +Zb
0u′′(x)ϕ(x)dx, ∀ϕ∈C∞
0(0, b).
Fixk∈ {1,···, N}arbitrary and take ε >0 small enough such that ( xk−ε, xk+ε)⊂
(xk−1, xk+1). Choose a cut-off function ψ∈C∞
0(xk−ε, xk+ε) satisfying 0 ⩽ψ⩽1 on
(xk−ε, xk+ε) and ψ(x) = 1 for x∈(xk−ε
3, xk+ε
3).
2. By statement 1, it is enough to show that u(xk+) = u(xk−). Set
ϕ(x) = (x−xk)ψ(x), in such a way that ϕ(xk) = 0 and ϕ′(xk) = 1. Hence
(Lq,INu, ϕ)C∞
0(0,b)=Zxk+ε
xk−εu(x)Lqϕ(x)dx.
5By (8) we have
Zxk+ε
xk−εu(x)ϕ′′(x)dx=u(xk−)−u(xk+) +Zxk+ε
xk−εu′′(x)ϕ(x)dx,
because ϕ(xk) = 0 and ϕ′(xk) = 1. Since usatisfies (4), we have
Zxk+ε
xk−ε(Lqu(x)−g(x))ϕ(x)dx+u(xk+)−u(xk−) = 0 .
By statement 1, Lqu=gon both intervals ( xk−1, xk), (xk, xk+1). Then we obtain that
u(xk+)−u(xk−)=0.
3. Now take ψas the test function. Hence
(Lq,INu, ψ)C∞
0(0,b)=Zxk+ε
xk−εu(x)Lqψ(x)dx+αku(xk),
because Supp( ψ)⊂(xk−ε, xk+ε) and ψ≡1 on ( xk−ε
3, xk+ε
3). On the other hand,
by (8) we obtain
Zxk+ε
xk−εu(x)ψ′′(x)dx=u′(xk+)−u′(xk−) +Zxk+ε
xk−εu′′(x)ψ(x)dx,
because ψ′(xk) = 0. Thus, by (4) we have
Zxk+ε
xk−ε(Lqu(x)−g(x))ψ(x)dx+u′(xk−)−u′(xk+) + αku(xk) = 0 .
Again, by statement 1, we obtain (2).
Reciprocally, if usatisfies conditions 1,2 and 3, equality (8) implies (3). By condition 1,
Lq,INuisL2-regular.
Definition 2 TheL2-regularization domain ofLq,IN, denoted by D2(Lq,IN), is the set
of all functions u∈L2,loc(0, b)satisfying conditions 1,2 and 3 of Proposition 1.
Ifu∈L2,loc(0, b) is a solution of (1), then Lq−λ,INuequals the regular distribution zero.
Then we have the next characterization.
Corollary 3 A function u∈L2,loc(0, b)is a solution of Eq. (1) iff u∈ D 2(Lq,IN)and for
each k= 0, . . . , N , the restriction u|(xk,xk+1)is a solution of the regular Schr¨ odinger equation
−y′′(x) +q(x)y(x) =λy(x)forxk< x < x k+1. (9)
Remark 4 Letf∈ D 2(Lq,IN). Given g∈C1[0, b], we have
(fg)′(xk+)−(fg)′(xk−) =f′(xk+)g(xk) +f(xk)g′(xk+)−f′(xk−)g(xk)−f(xk)g′(xk−)
= [f′(xk+)−f′(xk−)]g(xk) =αkf(xk)g(xk)
fork= 1, . . . , N . In particular, fg∈ D 2(Lq,IN)forg∈H2(0, b).
6Remark 5 Letu0, u1∈C. Consider the Cauchy problem
(
Lq,INu(x) =λu(x),0< x < b,
u(0) = u0, u′(0) = u1.(10)
If the solution of the problem exists, it must be unique. It is enough to show the assertion
foru0=u1= 0. Indeed, if wis a solution of such problem, by Corollary 3, wis a solution
of (9) on (0, x1)satisfying w(0) = w′(0) = 0 . Hence w≡0on[0, x1]. By the continuity of
wand condition (2), we have w(x1) =w′(x1−) = 0 . Hence wis a solution of (9) satisfying
these homogeneous conditions. Thus, w≡0on[x1, x2]. By continuing the process until the
points xkare exhausted, we arrive at the solution w≡0on the whole segment [0, b].
The uniqueness of the Cauchy problem with conditions u(b) =u0,u′(b) =u1is proved in
a similar way.
Remark 6 Suppose that u0=u0(λ)andu1=u1(λ)are entire functions of λand denote
byu(λ, x)the corresponding unique solution of (10). Since uis the solution of the Cauchy
problem Lqu=λuon(0, x1)with the initial conditions u(λ,0) = u1(λ),u′(λ,0) = u1(λ), both
u(λ, x)andu′(λ, x+)are entire functions for any x∈[0, x1](this is a consequence of [47,
Th. 3.9] and [10, Th. 7]). Hence u′(λ, x 1−) =u′(λ, x 1+)−α1u(λ, x 1)is entire in λ. Since
uis the solution of the Cauchy problem Lqu=λuon(x1, x2)with initial conditions u(λ, x 1)
andu′(λ, x 1+), we have that u(λ, x)andu′(λ, x+)are entire functions for x∈[x1, x2]. By
continuing the process we prove this assertion for all x∈[0, b].
3 Closed form solution
In what follows, denote the square root of λbyρ, soλ=ρ2,ρ∈C. For each k∈ {1,···, N}
letbsk(ρ, x) be the unique solution of the Cauchy problem
(
−bs′′
k(ρ, x) +q(x+xk)bsk(ρ, x) =ρ2bsk(ρ, x) for 0 < x < b −xk,
bsk(ρ,0) = 0 ,bs′
k(ρ,0) = 1 .(11)
In this way, bsk(ρ, x−xk) is a solution of Lqu=ρ2uon (xk, b) with initial conditions u(xk) = 0,
u′(xk) = 1. According to [45, Ch. 3, Sec. 6.3], ( Lq−ρ2) (H(x−xk)bsk(ρ, x−xk)) =
−δ(x−xk) for xk< x < b .
We denote by JNthe set of finite sequences J= (j1, . . . , j l) with 1 < l⩽N,{j1, . . . , j l} ⊂
{1, . . . , N }andj1<···< jl. Given J∈ J N, the length of Jis denoted by |J|and we define
αJ:=αj1···αj|J|.
Theorem 7 Given u0, u1∈C, the unique solution uIN∈ D 2(Lq,IN)of the Cauchy problem
(10) has the form
uIN(ρ, x) =eu(ρ, x) +NX
k=1αkeu(ρ, xk)H(x−xk)bsk(ρ, x−xk)
+X
J∈JNαJH(x−xj|J|)eu(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
bsj|J|(ρ, x−xj|J|),(12)
7whereeu(ρ, x)is the unique solution of the regular Schr¨ odinger equation
Lqeu(ρ, x) =ρ2eu(ρ, x),0< x < b, (13)
satisfying the initial conditions eu(ρ,0) = u1,eu′(ρ,0) = u1.
Proof. The proof is by induction on N. For N= 1, the proposed solution has the form
uI1(ρ, x) =eu(ρ, x) +α1H(x−x1)eu(ρ, x 1)bs1(ρ, x−x1).
Note that uI1(ρ, x) is continuous, and uI1(ρ, x 1) =eu(ρ, x 1). Hence
(Lq−ρ2)uI1(ρ, x) =α1eu(ρ, x 1)(Lq−ρ2) (H(x−x1)bs1(ρ, x−x1)) =−α1eu(ρ, x 1)δ(x−x1),
that is, uI1(ρ, x) is a solution of (1) with N= 1. Suppose the result is valid for N. Let
uIN+1(ρ, x) be the proposed solution given by formula (12). It is clear that uIN+1(ρ,·)|(xk,xk+1)∈
H2(xk, xk+1),k= 0,···, N,uIN+1(ρ, x) is a solution of (9) on each interval ( xk, xk+1),
k= 0, . . . , N + 1, and u(j)
IN+1(ρ,0) =eu(j)(ρ,0) = uj,j= 0,1. Furthermore, we can write
uIN+1(ρ, x) =uIN(ρ, x) +H(x−xN+1)fN(ρ, x),
where IN=IN+1\ {(xN+1, αN+1)},uJN(ρ, x) is the proposed solution for the interactions
IN, and the function fN(ρ, x) is given by
fN(ρ, x) =αN+1eu(ρ, xN+1)bsN+1(x−xN+1)
+X
J∈JN+1
j|J|=N+1αJeu(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
bsN+1(ρ, x−xN+1),
where the sum is taken over all the sequences J= (j1, . . . , j |J|)∈ J Nwith j|J|=N+1. From
this representation we obtain uIN+1(ρ, xN+1±) =uIN(ρ, xN+1) and hence uIN+1∈AC[0, b].
By the induction hypothesis, uIN(ρ, x) is the solution of (1) for N, then in order to show
that uIN+1(ρ, x) is the solution for N+ 1 it is enough to show that ( Lq−ρ2)ˆfN(ρ, x) =
−αNuN(xN+1)δ(x−xN+1), where ˆfN(ρ, x) =H(x−xN+1)fN(ρ, x). Indeed, we have
(ρ2−Lq)ˆfN(ρ, x) =αN+1eu(ρ, xN+1)δ(x−xN+1)+
+X
J∈JN+1
j|J|=N+1αJeu(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
δ(x−xN+1)
=αN+1δ(x−xN+1)"
eu(ρ, xN+1) +NX
k=1αkeu(ρ, xN+1)bsk(ρ, xN+1−xk)
+X
J∈JNαJeu(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
bsj|J|(ρ, xN+1−xj|J|)#
=αN+1uIN(ρ, xN+1)δ(x−xN+1) =αN+1uIN+1(ρ, xN+1)δ(x−xN+1),
8where the second equality is due to the fact that
{J∈ J N+1|j|J|=N+ 1}={(J′, N+ 1)|J′∈ J N} ∪ { (j, N+ 1)}N
j=1.
Hence uIN+1(ρ, x) is the solution of the Cauchy problem.
Example 8 Consider the case q≡0. Denote by e0
IN(ρ, x)the unique solution of
−y′′+ NX
k=1αkδ(x−xk)!
y=ρ2y,0< x < b, (14)
satisfying e0
IN(ρ,0) = 1 ,e0
IN(ρ,0) = iρ. In this case we have bsk(ρ, x) =sin(ρx)
ρfork=
1, . . . , N . Hence, according to Theorem 7, the solution e0
IN(ρ, x)has the form
e0
IN(ρ, x) =eiρx+NX
k=1αkeiρxkH(x−xk)sin(ρ(x−xk))
ρ
+X
J∈JNαJH(x−xj|J|)eiρxj1
|J|−1Y
l=1sin(ρ(xjl+1−xjl))
ρ
sin(ρ(x−xj|J|))
ρ.(15)
4 Transmutation operators
4.1 Construction of the integral transmutation kernel
Leth∈C. Denote by eeh(ρ, x) the unique solution of Eq. (13) satisfying eeh(ρ,0) = 1,
ee′
h(ρ,0) = iρ+h. Hence the unique solution eh
IN(ρ, x) of Eq. (1) satisfying eh
IN(ρ,0) = 1,
(eh
IN)′(ρ,0) = iρ+his given by
eh
IN(ρ, x) =eeh(ρ, x) +NX
k=1αkeeh(ρ, xk)H(x−xk)bsk(ρ, x−xk) (16)
+X
J∈JNαJH(x−xj|J|)eeh(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
bsj|J|(ρ, x−xj|J|).
It is known that there exists a kernel eKh∈C(Ω)∩H1(Ω), where Ω = {(x, t)∈R2|0<
x < b, |t|< x}, such that eKh(x, x) =h
2+1
2Rx
0q(s)ds,eKh(x,−x) =h
2and
eeh(ρ, x) =eiρx+Zx
−xeKh(x, t)eiρtdt (17)
(see, e.g., [36, 39]). Actually, eKh(x,·)∈L2(−x, x) and it can be extended (as a function of
t) to a function in L2(R) with a support in [ −x, x]. For each k∈ {1, . . . , N }there exists
a kernel bHk∈C(Ωk)∩H1(Ωk) with Ω k={(x, t)∈R2|0< x < b −xk,|t|⩽x}, and
bHk(x, x) =1
2Rx+xk
xkq(s)ds,bHk(x,−x) = 0, such that
bsk(ρ, x) =sin(ρx)
ρ+Zx
0bHk(x, t)sin(ρt)
ρdt (18)
9(see [19, Ch. 1]). From this we obtain the representation
bsk(ρ, x−xk) =sin(ρ(x−xk))
ρ+Zx−xk
0bHk(x−xk, t)sin(ρt)
ρdt=Zx−xk
−(x−xk)eKk(x, t)eiρtdt,(19)
where
eKk(x, t) =1
2χx−xk(t) +1
2Zx−xk
|t|bHk(x−xk, s)ds. (20)
We denote the Fourier transform of a function f∈L1(R) byFf(ρ) =R
Rf(t)eiρtdtand
the convolution of fwith a function g∈L1(R) by f∗g(t) =R
Rf(t−s)g(s)ds. We recall
thatF(f∗g)(ρ) =Ff(ρ)· Fg(ρ). Given f1, . . . , f M∈L2(R) with compact support, we
denote their convolution product byQM
l=1∗
fl(t) := ( f1∗ ··· ∗ fM)(t). For the kernels
eKh(x, t),eKk(x, t), the operations Fand∗will be applied with respect to the variable t.
Lemma 9 LetA, B > 0. Iff∈C[−A, A]andg∈C[−B, B], then (χAf)∗(χBg)∈C(R)
with Supp (( χAf)∗(χBg))⊂[−(A+B), A+B].
Proof. The assertion Supp (( χAf)∗(χBg))⊂[−(A+B), A+B] is due to [12, Prop.
4.18]. Since ( χAf)∈L1(R) and ( χBg)∈L∞(R), it follows from [17, Prop. 8.8] that
(χAf)∗(χBg)∈C(R).
Theorem 10 There exists a kernel Kh
IN(x, t)defined on Ωsuch that
eh
IN(ρ, x) =eiρx+Zx
−xKh
IN(x, t)eiρtdt. (21)
For any 0< x⩽b,Kh
JN(x, t)is piecewise absolutely continuous with respect to the variable
t∈[−x, x]and satisfies Kh
IN(x,·)∈L2(−x, x). Furthermore, Kh
IN∈L∞(Ω).
Proof. Susbtitution of formulas (17) and (19) in (16) leads to the equality
eh
IN(ρ, x) =eiρx+Zx
−xeKh(x, t)eiρtdt+
+NX
k=1αkH(x−xk)
eiρxk+xkZ
−xkeKh(xk, t)eiρtdt

x−xkZ
−(x−xk)eKk(x, t)eiρtdt

+X
J∈JNαJH(x−xj|J|)"
eiρxj1+xj1Z
−xj1eKh(xj1, t)eiρtdt

|J|−1Y
l=1xjl+1−xjlZ
−(xjl+1−xjl)eKk(xjl+1, t)eiρtdt

·x−xj|J|Z
−(x−xj|J|)eKk(x, t)eiρtdt#
10Note that
|J|−1Y
l=1xjl+1−xjlZ
−(xjl+1−xjl)eKk(xjl+1, t)eiρtdt=F


|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKk(xjl+1, t)

.
In a similar way, if we denote IA,B= 
eiρA+AR
−AeKh(A, t)eiρtdt! 
BR
−BeKk(B, t)eiρtdt!
with
A, B∈(0, b), then
IA,B=eiρABZ
−BeKk(B, t)eiρtdt+F
χA(t)eKh(A, t)∗χB(t)eKk(B, t)
=F
χ[A−B,B+A](t)eKk(B, t−A) +χA(t)eKh(A, t)∗χB(t)eKk(B, t)
.
SetRN(ρ, x) =eN(ρ, x)−eiρx. Thus,
RN(ρ, x) =F"
χx(t)eKh(x, t)
+NX
k=1αkH(x−xk)
χ[2xk−x,x](t)eKk(x, t−xk) +χxk(t)eKh(xk, t)∗χx−xk(t)eKk(x, t)
+X
J∈JNαJH(x−xj|J|)
|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKk(xjl+1, t)
∗
χ[xj|J|+xj1−x,x−(xj|J|−xj1)](t)eKj|J|(x, t−xj1)
+χxj1(t)eKh(xj1, t)∗χx−xj|J|(t)eKj|J|(x, t)#
According to Lemma 9, the support ofQ|J|−1
l=1∗
χxjl+1−xjl(t)eKk(xjl+1, t)
lies in
[xj1−xj|J|, xj|J|−xj1] and χx−(xj|J|−xj1)(t)eKj|J|(x, t−xj1)+χxj1(t)eKh(xj1, t)∗χx−xj|J|(t)eKj|J|(x, t)
has its support in [ xj|J|+xj1−x, x−(xj|J|−xj1)]. Hence the convolution in the sec-
ond sum of RN(ρ, x) has its support in [ −x, x]. On the other hand, χxk(t)eKh(xk, t)∗
χx−xk(t)eKk(x, t) has its support in [ −x, x], and since [2 xk−x, x]⊂[−x, x], we conclude
that Supp ( F−1RN(ρ, x))⊂[−x, x].
11Thus, we obtain (21) with
Kh
IN(x, t) =χx(t)eKh(x, t)
+nX
k=1αkH(x−xk)
χ[2xk−x,x](t)eKk(x, t−xk) +χxk(t)eKh(xk, t)∗χx−xk(t)eKk(x, t)
+X
J∈JNαJH(x−xj|J|)
|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKjl(xjl+1, t)
(22)
∗
χx−(xj|J|−xj1)(t)eKj|J|(x, t−xj1) +χxj1(t)eKh(xj1, t)∗χx−xj|J|(t)eKj|J|(x, t)
,
andKIN(x,·)∈L2(x,−x). By formula (22) and the definitions of bKh(x, t) and eKk(x, t),
KIN(x, t) is piecewise absolutely continuous for t∈[−x, x]. Since bKh,eKk∈L∞(Ω), is clear
thatKf
IN∈L∞(Ω).
As a consequence of (21), eh
IN(ρ, x) is an entire function of exponential type xon the
spectral parameter ρ.
Example 11 Consider (15) with N= 1. In this case the solution e0
I1(ρ, x)is given by
e0
I1(ρ, x) =eiρx+α1eiρx1H(x−x1)sin(ρ(x−x1))
ρ.
We have
eiρx1sin(ρ(x−x1))
ρ=1
2Zx−x1
x1−xeiρ(t+x1)dt=1
2Zx
2x1−xeiρtdt.
Hence
e0
I1(ρ, x) =eiρx+Zx
−xK0
I1(x, t)eiρtdtwith K0
I1(x, t) =α1
2H(x−x1)χ[2x1−x,x](t).
Example 12 Consider again Eq. (15) but now with N= 2. In this case the solution
e0
I2(ρ, x)is given by
e0
I2(ρ, x) =eiρx+α1eiρx1H(x−x1)sin(ρ(x−x1))
ρ+α2eiρx2H(x−x2)sin(ρ(x−x2))
ρ
+α1α2eiρx1H(x−x2)sin(ρ(x2−x1))
ρsin(ρ(x−x2))
ρ,
and the transmutation kernel K0
I2(x, t)has the form
K0
I2(x, t) =α1H(x−x1)
2χ[2x1−x,x](t) +α2H(x−x2)
2χ[2x1−x,x](t)
+α1α2H(x−x2)
4(χx2−x1∗χx−x2) (t−x1).
12Direct computation shows that
χx2−x1∗χx−x2(t−x1) =


0, t ̸∈[2x1−x, x],
t+x−2x1, 2x1−x < t < −|2x2−x−x1|+x1,
x−x1− |2x2−x−x1|,−|2x2−x−x1|+x1< t < |2x2−x−x1|+x1
x−t, |2x2−x−x1|+x1< t < x.
In Figure 1, we can see some level curves of the kernel K0
I2(x, t)(as a function of t),I2=
{(0.25,1),(0.75,2)}, for some values of x.
−1.00−0.75−0.50−0.25 0.00 0.25 0.50 0.75 1.00
t0.000.250.500.751.001.251.501.75K(x,t)x= 0.1
x= 0.5
x= 0.82
x= 0.95
Figure 1: The graphs of K0
I2(x, t), as a function of t∈[−1,1], for some points x∈(0,1) and
I2={(0.25,1),(0.75,2)}.
For the general case we have the following representation for the kernel.
Proposition 13 The transmutation kernel K0
IN(ρ, x)for the solution e0
IN(ρ, x)of (15) is
given by
K0
IN(x, t) =NX
k=0αkH(x−xk)
2χ[2xk−x,x](t)
+X
J∈JNαJH(x−xj|J|)
2|J|

|J|−1Y
l=1
∗
χxjl+1−xjl(t)
∗χx−xj|J|(t−xj1) (23)
13Proof. In this case ee0(ρ, x) = eiρx,bsk(ρ, x−xk) =sin(ρ(x−xk))
ρ, hence eK0(x, t)≡0,
eKk(x, t) =1
2χx−xk(t). Substituting these expressions into (22) and taking into account
thatχxj|J|+xj1−x,x−(xj|J|−xj1)(t) =χx−xj|J|(t−xj1) we obtain (23)
Let
Th
INu(x) :=u(x) +Zx
−xKh
IN(x, t)u(t)dt. (24)
By Theorem 10, Tf
IN∈ B(L2(−b, b)) and
eh
IN(ρ, x) =Th
IN
eiρx
. (25)
4.2 Goursat conditions
Let us define the function
σIN(x) :=NX
k=1αkH(x−xk). (26)
Hence σ′
IN(x) =qδ,In(x) in the distributional sense ( ( σIN, ϕ)C∞
0(0,b)=−(qδ,IN, ϕ′)C∞
0(0,b)for
allϕ∈C∞
0(0, b)). Note that in Examples 11 and 12 we have
K0
JN(x, x) =1
2Zx
0q(s)ds+σIN(x)
and K0
IN(x,−x) = 0 for N= 1,2.
More generally, the following statement is true.
Proposition 14 The integral transmutation kernel Kh
INsatisfies the following Goursat con-
ditions for x∈[0, b]
Kh
JN(x, x) =1
2
h+Zx
0q(s)ds+σIN(x)
and Kh
IN(x,−x) =h
2. (27)
Proof. Fixx∈[0, b] and take ξ∈ {− x, x}. By formula (22) we can write
Kh
IN(x, ξ) =eKh(x, ξ) +NX
k=1αkH(x−xk)χ[2xk−x,x](ξ)eKk(x, ξ−xk) +F(x, ξ),
where
F(x, t) =nX
k=1αkH(x−xk)χxk(t)eKh(xk, t)∗χx−xk(t)eKk(x, t)
+X
J∈JNαJH(x−xj|J|)
|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKjl(xjl+1, t)
∗
χx−(xj|J|−xj1)(t)eKj|J|(x, t−xj1) +χxj1(t)eKh(xj1, t)∗χx−xj|J|(t)eKj|J|(x, t)
.
14In the proof of Theorem 10 we obtain that Supp( F(x, t))⊂[−x, x]. Since eKh(xj, t) and
eKk(xj, t) are continuous with respect to tin the intervals [ −xj, xj] and [ xk−xj, xj−xk]
respectively for j= 1, . . . , N ,k⩽j, by Lemma 9 the function F(x, t) is continuous for all
t∈R. Thus F(x, ξ) = 0. For the case ξ=x, we have that eKh(x, x) =h
2+1
2Rx
0q(s)ds,
χ[2xk−x,x](x) = 1 and
eKk(x, x−xk) =1
2χx−xk(x−xk) +1
2Zx−xk
|x−xk|bHk(x−xk, s)ds=1
2
(we assume that x⩾xkin order to have H(x−xk) = 1). Thus
Kh
IN(x, x) =1
2 
h+Rx
0q(s)ds+σIN(x)
. For the case ξ=−x,eKh(x,−x) =h
2and
χ[2xk−x,x](−x) = 0. Hence Kh
IN(x, x) =h
2.
Remark 15 According to Proposition 14, 2Kh
IN(x, x)is a (distributional) antiderivative of
the potential q(x) +qδ,IN(x).
4.3 The transmuted Cosine and Sine solutions
Letch
IN(ρ, x) and sIN(ρ, x) be the solutions of Eq. (1) satisfying the initial conditions
ch
IN(ρ,0) = 1 ,(ch
IN)′(ρ,0) = h, (28)
sIN(ρ,0) = 0 , s′
IN(ρ,0) = 1 . (29)
Note that ch
IN(ρ, x) =eh
IN(ρ,x)+eh
IN(−ρ,x)
2andsIN(ρ, x) =eh
IN(ρ,x)−eh
IN(−ρ,x)
2iρ.
Remark 16 By Corollary 3, ch
IN(ρ,·), sIN(ρ,·)∈AC[0, b]and both functions are solutions
of Eq. (9) on [0, x1], hence their Wronskian is constant for x∈[0, x1]and
1 =W
ch
IN(ρ, x), sIN(ρ, x)
(0) = W
ch
IN(ρ, x), sIN(ρ, x)
(x1−) =ch
IN(ρ, x 1) sIN(ρ, x 1)
(ch
IN)′(ρ, x 1−)s′
IN(ρ, x 1−)
=ch
IN(ρ, x 1) sIN(ρ, x 1)
(ch
IN)′(ρ, x 1+)−α1ch
IN(ρ, x 1)s′
IN(ρ, x 1+)−α1sIN(ρ, x 1)
=ch
IN(ρ, x 1) sIN(ρ, x 1)
(ch
IN)′(ρ, x 1+)s′
IN(ρ, x 1+)=W
ch
IN(ρ, x), sIN(ρ, x)
(x1+)
(the equality in the second line is due to (2)). Since ch
IN(ρ, x), sIN(ρ, x)are solutions of (9)
on[x1, x2], then W
Ch
IN(ρ, x), sIN(ρ, x)
is constant for x∈[x1, x2]. Thus,
W
ch
IN(ρ, x), sIN(ρ, x)
(x) = 1 for all x∈[0, x2]. Continuing the process we obtain that
the Wronskian equals one in the whole segment [0, b]. Thus, ch
IN(ρ, x), sIN(ρ, x)are linearly
independent. Finally, if uis a solution of (1), by Remark 5, ucan be written as u(x) =
u(0)ch
IN(ρ, x) +u′(0)sIN(ρ, x). In this way,
ch
IN(ρ, x), sIN(ρ, x)	
is a fundamental set of
solutions for (1).
Similarly to the case of the regular Eq. (13) (see [39, Ch. 1]), from (21) we obtain the
following representations.
15Proposition 17 The solutions ch
IN(ρ, x)andsIN(ρ, x)admit the following integral repre-
sentations
ch
IN(ρ, x) = cos( ρx) +Zx
0Gh
IN(x, t) cos( ρt)dt, (30)
sIN(ρ, x) =sin(ρx)
ρ+Zx
0SIN(x, t)sin(ρt)
ρdt, (31)
where
Gh
IN(x, t) =Kh
IN(x, t) +Kh
IN(x,−t), (32)
SIN(x, t) =Kh
IN(x, t)−Kh
IN(x,−t). (33)
Remark 18 By Proposition 14, the cosine and sine integral transmutation kernels satisfy
the conditions
Gh
IN(x, x) =h+1
2Zx
0q(s)ds+σIN(x)
, (34)
SIN(x, x) =1
2Zx
0q(s)ds+σIN(x)
and SIN(x,0) = 0 . (35)
Introducing the cosine and sine transmutation operators
TC
IN,hu(x) =u(x) +Zx
0Gh
IN(x, t)u(t)dt,TS
INu(x) =u(x) +Zx
0SIN(x, t)u(t)dt (36)
we obtain
ch
IN(ρ, x) =TC
IN,h[cos(ρx)], s IN(ρ, x) =TS
INsin(ρx)
ρ
. (37)
Remark 19 According to Remark 16, the space of solutions of (1) has dimension 2, and
given f, g∈ D 2(Lq,IN)solutions of (1), repeating the same procedure of Remark 16, W[f, g]
is constant in the whole segment [0, b]. The solutions f, gare a fundamental set of solutions
iffW[f, g]̸= 0.
5 The SPPS method and the mapping property
5.1 Spectral parameter powers series
As in the case of the regular Schr¨ odinger equation [10, 31], we obtain a representation for
the solutions of (1) as a power series in the spectral parameter (SPPS series). Assume that
there exists a solution f∈ D 2(Lq,IN) that does not vanish in the whole segment [0 , b].
Remark 20 Given g∈L2(0, b), a solution u∈ D 2(Lq,IN)of the non-homogeneous Cauchy
problem(
Lq,INu(x) =g(x),0< x < b
u(0) = u0, u′(0) = u1(38)
16can be obtained by solving the regular equation Lqu(x) =g(x)a.e. x∈(0, b)as follows.
Consider the Polya factorization Lqu=−1
fDf2Du
f, where D=d
dx. A direct computation
shows that ugiven by
u(x) =−f(x)Zx
01
f2(t)Zt
0f(s)g(s)ds+u0
f(0)f(x) + (f(0)u1−f′(0)u0)f(x)Zx
0dt
f2(t)(39)
satisfies (38) (actually, f(x)Rx
01
f2(t)dtis the second linearly independent solution of Lqu= 0
obtained from fby Abel’s formula). By Remark 4, u∈ D 2(Lq,JN)and by Proposition 1
and Remark 5, formula (39) provides the unique solution of (38). Actually, if we denote
Iu(x) :=Rx
0u(t)dtand define Rf
IN:=−fIf2I, then Rf
IN∈ B(L2(0, b)),Rf
IN(L2(0, b))⊂
D2(Lq,IN)and is a right-inverse for Lq,IN, i.e., Lq,INRf
INg=gfor all g∈L2(0, b).
Following [31] we define the following recursive integrals: eX(0)≡X(0)≡1, and for k∈N
eX(k)(x) :=kZx
0eX(k−1)(s) 
f2(s)(−1)k−1
ds, (40)
X(k)(x) :=kZx
0X(k−1)(s) 
f2(s)(−1)k
ds. (41)
The functions {φ(k)
f(x)}∞
k=0defined by
φ(k)
f(x) :=(
f(x)eX(k)(x),ifkeven,
f(x)X(k)(x),ifkodd.(42)
fork∈N0, are called the formal powers associated to f. Additionally, we introduce the
following auxiliary formal powers {ψ(k)
f(x)}∞
k=0given by
ψ(k)
f(x) :=(eX(k)(x)
f(x),ifkodd,
X(k)(x)
f(x),ifkeven.(43)
Remark 21 For each k∈N0,φ(k)
f∈ D 2(Lq,IN). Indeed, direct computations show that the
following relations hold for all k∈N0:
Dφ(k)
f=f′
fφ(k)
f+kψ(k−1)
f (44)
D2φ(k)
f=f′′
fφ(k)
f+k(k−1)φ(k−2)
f (45)
Since φ(k)
f, ψ(k)
f∈C[0, b], using the procedure from Remark 4 and (44) we obtain φ(k)
f∈
D2(Lq,IN).
Theorem 22 (SPPS method) Suppose that f∈ D 2(Lq,IN)is a solution of (1) that does
not vanish in the whole segment [0, b]. Then the functions
u0(ρ, x) =∞X
k=0(−1)kρ2kφ(2k)
f(x)
(2k)!, u 1(ρ, x) =∞X
k=0(−1)kρ2kφ(2k+1)
f (x)
(2k+ 1)!(46)
17belong to D2(Lq,IN), and{u0(ρ, x), u1(ρ, x)}is a fundamental set of solutions for (1) satis-
fying the initial conditions
u0(ρ,0) = f(0),u′
0(ρ,0) = f′(0), (47)
u1(ρ,0) = 0 ,u′
1(ρ,0) =1
f(0), (48)
The series in (46) converge absolutely and uniformly on x∈[0, b], the series of the derivatives
converge in L2(0, b)and the series of the second derivatives converge in L2(xj, xj+1),j=
0,···, N. With respect to ρthe series converge absolutely and uniformly on any compact
subset of the complex ρ-plane.
Proof. Since f∈C[0, b], the following estimates for the recursive integrals {eX(k)(x)}∞
k=0
and{X(k)(x)}∞
k=0are known:
|eX(n)(x)|⩽Mn
1bn,|X(n)(x)|⩽Mn
1bnfor all x∈[0, b], (49)
where M1=∥f2∥C[0,b]·1
f2
C[0,b](see the proof of Theorem 1 of [31]). Thus, by the Weier-
strass M-tests, the series in (46) converge absolutely and uniformly on x∈[0, b], and for ρon
any compact subset of the complex ρ-plane. We prove that u0(ρ, x)∈ D 2(Lq,IN) and is a so-
lution of (1) (the proof for u1(ρ, x) is analogous). By Remark 21, the series of the derivatives
ofu0(ρ, x) is given byf′
fP∞
k=0(−1)kρ2kφ(2k)
f
(2k)!+P∞
k=1(−1)kρ2kψ(2k−1)
f
(2k−1)!. By (49), the series involv-
ing the formal powers φ(k)
fandψ(k)
fconverge absolutely and uniformly on x∈[0, b]. Hence,
P∞
k=0(−1)kρkDφ(2k)
f(x)
(2k)!converges in L2(0, b). Due to [10, Prop. 3], u0(ρ,·)∈AC[0, b] and
u′
0(ρ, x) =f′(x)
f(x)P∞
k=0(−1)kρ2kφ(2k)
f
(2k)!+P∞
k=1(−1)kρ2kψ(2k−1)
f
(2k−1)!inL2(0, b). Since the series involving
the formal powers defines continuous functions, then u0(ρ, x) satisfies the jump condition
(2). Applying the same reasoning it is shown that u′′
0(ρ, x) =P∞
k=0(−1)kρ2kD2φ(2k)
f
(2k)!, the series
converges in L2(xj, xj+1) and u0(ρ,·)|(xj,xj+1)∈H2(xj, xj+1),j= 0, . . . , N .
SinceeX(n)(0) = 0 for n⩾1, we have (47). Finally, by (45)
Lqu0(ρ, x) =∞X
k=0(−1)kρ2kLqφ(2k)
f(x)
(2k)!=∞X
k=2(−1)k+1ρ2kφ(2k−2)
f (x)
(2k−2)!
=ρ2∞X
k=0(−1)kρ2kφ(2k)
f(x)
(2k)!=ρ2u(ρ, x),
this for a.e. x∈(xj, xj+1),j= 0, . . . , N .
Using (47) and (48) we obtain W[u0(ρ, x), u1(ρ, x)](0) = 1. Since the Wronskian is
constant (Remark 19), {u0(ρ, x), u1(ρ, x)}is a fundamental set of solutions.
5.2 Existence and construction of the non-vanishing solution
The existence of a non-vanishing solution is well known for the case of a regular Schr¨ odinger
equation with continuous potential (see [31, Remark 5] and [13, Cor. 2.3]). The following
proof adapts the one presented in [21, Prop. 2.9] for the Dirac system.
18Proposition 23 (Existence of non-vanishing solutions) Let{u, v} ∈ D 2(Lq,IN)be a
fundamental set of solutions for (1). Then there exist constants c1, c2∈Csuch that the
solution f=c1u+c2vdoes not vanish in the whole segment [0, b].
Proof. Let{u, v} ∈ D 2(Lq,IN) be a fundamental set of solutions for (1). Then uand
vcannot have common zeros in [0 , b]. Indeed, if u(ξ) = v(ξ) = 0 for some ξ∈[0, b],
then W[u, v](ξ+) = u(ξ)v′(ξ+)−v(ξ)u′(ξ+) = 0. Since W[u, v] is constant in [0 , b], this
contradicts that {u, v}is a fundamental system.
This implies that in each interval [ xj, xj+1],j= 0,···, N, the map Fj: [xj, xj+1]→CP1,
Fj(x) :=
u|[xj,xj+1](x) :v|[xj,xj+1](x)
(where CP1is the complex projective line, i.e., the
quotient of C2\ {(0,0)}under the action of C∗, and [ a:b] denotes the equivalent class of
the pair ( a, b)) is well defined and differentiable. In [13, Prop. 2.2] it was established that
a differentiable function f:I→CP1, where I⊂Ris an interval, is never surjective, using
that Sard’s theorem implies that f(I) has measure zero.
Suppose that ( α, β)∈C2\ {(0,0)}is such that αu(ξ)−βv(ξ) = 0 for some ξ∈[0, b].
Henceu(ξ)β
v(ξ)α= 0, that is, ( u(ξ), v(ξ)) and ( α, β) are proportional. Since ξ∈[xj, xj+1] for
some j∈ {0,···, N}, hence [ α:−β]∈Fj([xj, xj+1]).
Thus, the set C:=
[α:β]∈CP1|∃ξ∈[0, b] :αu(ξ) +βv(ξ) = 0	
is contained in
∪N
j=0Fj([xj, xj+1]), and then Chas measure zero. Hence we can obtain a pair of constants
(c1, c2)∈C2\ {(0,0)}with [ c1:−c2]∈CP1\Candf=c1u+c2vdoes not vanish in the
whole segment [0 , b].
Remark 24 Ifqis real valued and α1,···, αN∈R\ {0}, taking a real-valued fundamental
system of solutions for the regular equation Lqy= 0and using formula (12), we can obtain
a real-valued fundamental set of solutions {u, v}forLq,INy= 0. In the proof of Proposition
23 we obtain that uandvhave no common zeros. Hence f=u+ivis a non vanishing
solution.
For the complex case, we can choose randomly a pair of constants (c1, c2)∈C2\ {(0,0)}
and verify if the linear combination c1u+c2vhas no zero. If there is a zero, we repeat
the process until we find the non vanishing solution. Since the set C(from the proof of
Proposition 23) has measure zero, is almost sure to find the coefficients c1, c2in the first few
tries.
By Proposition 23, there exists a pair of constants ( c1, c2)∈C2\ {(0,0)}such that
y0(x) =c1+c2x+NX
k=1αk(c1+c2xk)H(x−xk)(x−xk)
+X
J∈JNαJ(c1+c2xj1)H(x−xj|J|)
|J|−1Y
l=1(xjl+1−xj1)
(x−xj|J|) (50)
is a non-vanishing solution of (1) for ρ= 0 (if α1, . . . , α k∈(0,∞), it is enough with take
c1= 1, c2= 0). Below we give a procedure based on the SPPS method ([10, 31]) to obtain
the non-vanishing solution ffrom y0.
19Theorem 25 Define the recursive integrals {Y(k)}∞
k=0and{˜Y(k)}∞
k=0as follows: Y(0)≡
˜Y(0)≡1, and for k⩾1
Y(k)(x) =(Rx
0Y(k)(s)q(s)y2
0(s)ds, ifkis even ,Rx
0Y(k)(s)
y2
0(s)ds, ifkis odd ,(51)
˜Y(k)(x) =(Rx
0˜Y(k)(s)q(s)y2
0(s)ds, ifkis odd ,Rx
0˜Y(k)(s)
y2
0(s)ds, ifkis even .(52)
Define
f0(x) =y0(x)∞X
k=0˜Y(2k)(x), f 1(x) =y0(x)∞X
k=0Y(2k+1)(x). (53)
Then{f0, f1} ⊂ D 2(Lq,IN)is a fundamental set of solution for Lq,INu= 0 satisfying the
initial conditions f0(0) = c1,f′
0(0) = c2,f1(0) = 0 ,f′
1(0) = 1 . Both series converge
uniformly and absolutely on x∈[0, b]. The series of the derivatives converge in L2(0, b),
and on each interval [xj, xj+1],j= 0, . . . , N , the series of the second derivatives converge
inL2(xj, xj+1). Hence there exist constants C1, C2∈Csuch that f=C1f0+C2f1is a
non-vanishing solution of Lq,INu= 0in[0, b].
Proof. Using the estimates
|˜Y(2k−j)(x)|⩽M(n−j)
1Mn
2
(n−j)!n!,|Y(2k−j)(x)|⩽Mn
1M(n−j)
2
n!(n−j)!, x∈[0, b], j= 0,1, k∈N,
where M1=1
y2
0
L1(0,b)andM2=∥qy2
0∥L1(0,b), from [10, Prop. 5], the series in (53) converge
absolutely and uniformly on [0 , b]. The proof of the convergence of the derivatives and that
{f0, f1} ∈ D 2(Lq,IN) is a fundamental set of solutions is analogous to that of Theorem 22
(see also [31, Th. 1]) and [10, Th. 7] for the proof in the regular case).
5.3 The mapping property
Take a non vanishing solution f∈ D 2(Lq,IN) normalized at zero, i.e., f(0) = 1, and set
h=f′(0). Then the corresponding transmutation operator and kernel Th
INandKh
IN(x, t)
will be denoted by Tf
INandKf
IN(x, t) and called the canonical transmutation operator
and kernel associated to f, respectively (same notations are used for the cosine and sine
transmutations).
Theorem 26 The canonical transmutation operator Tf
INsatisfies the following relations
Tf
IN
xk
=φ(k)
f(x)∀k∈N0. (54)
The canonical cosine and sine transmutation operators satisfy the relations
TC
IN,f
x2k
=φ(2k)
f(x)∀k∈N0. (55)
TS
IN
x2k+1
=φ(2k+1)
f (x)∀k∈N0. (56)
20Proof. Consider the solution eh
IN(ρ, x) with h=f′(0). By the conditions (47) and (48),
solution eh
IN(ρ, x) can be written in the form
eh
IN(ρ, x) =u0(ρ, x) +iρu1(ρ, x)
=∞X
k=0(−1)kρ2kφ(2k)
f(x)
(2k)!+∞X
k=0i(−1)kρ2k+1φ(2k+1)
f (x)
(2k+ 1)!
=∞X
k=0(iρ)2kφ(2k)
f(x)
(2k)!+∞X
k=0(iρ)2k+1φ(2k+1)
f (x)
(2k+ 1)!
=∞X
k=0(iρ)kφ(k)
f(x)
k!(57)
(The rearrangement of the series is due to absolute and uniform convergence, Theorem 22).
On the other hand
eh
IN(ρ, x) =Tf
IN
eiρx
=Tf
IN"∞X
k=0(iρ)kxk
k!#
Note thatZx
−xKf
IN(x, t) ∞X
k=0(iρ)ktk
k!!
dt=∞X
k=0(iρ)k
k!Zx
−xKf
IN(x, t)tkdt, due to the uniform
convergence of the exponential series in the variable t∈[−x, x]. Thus,
eh
IN(ρ, x) =∞X
k=0(iρ)kTf
IN
xk
k!. (58)
Comparing (58) and (57) as Taylor series in the complex variable ρwe obtain (54). Relations
(55) and (56) follows from (54), (32), (33) and the fact that Gf
IN(x, t) and SIN(x, t) are even
and odd in the variable t, respectively.
Remark 27 The formal powers {φ(k)
f(x)}∞
k=0satisfy the asymptotic relation
φ(k)
f(x) =xk(1 +o(1)),x→0+,∀k∈N.
Indeed, by Theorem 26 and the Cauchy-Bunyakovsky-Schwarz inequality we have
|φ(k)
f(x)−xk|=Zx
−xKf
IN(x, t)tkdt⩽Zx
−xKf
IN(x, t)2
dt1
2Zx
−x|t|2kdt1
2
⩽√
2bKIf
N
L∞(Ω)r
2
2k+ 1xk+1
2
(because Kf
IN∈L∞(Ω)by Theorem 10). Hence
φ(k)
f(x)
xk−1⩽√
2bKIf
N
L∞(Ω)r
2
2k+x1
2→0, x →0+.
21Remark 28 Denote P(R) =Span{xk}∞
k=0. According to Remark 21 and Proposition 1 we
have that Tf
IN(P(R)) = Spann
φ(k)
f(x)o∞
k=0, and by (45) we have the relation
Lq,INTf
INp=−Tf
IND2p∀p∈ P(R). (59)
According to [14], Tf
q,INis a transmutation operator for the pair Lq,IN,−D2in the
subspace P(R), and{φ(k)
f(x)}∞
k=0is an Lq,IN-basis. Since φ(K)
f(0) = Dφ(k)
f(0) = 0 fork⩾2,
{φ(k)
f(x)}∞
k=0is called a standard Lq,JN-basis, and Tf
INa standard transmutation operator.
By Remark 20 we can recover φ(k)
ffork⩾2from φ(0)
fandφ(0)
fby the formula
φ(k)
f(x) =−k(k−1)Rf
INφ(k)
f(x) =k(k−1)f(x)Zx
01
f2(t)Zt
0f(s)φ(k−2)
f(s)ds (60)
(compare this formula with [14, Formula (8), Remark 9]).
The following result adapts Theorem 10 from [14], proved for the case of an L1-regular
potential.
Theorem 29 The operator Tf
INis a transmutation operator for the pair Lq,IN,−D2in
H2(−b, b), that is, Tf
IN(H2(−b, b))⊂ D 2(Lq,IN)and
Lq,INTINu=−TIND2u∀u∈H2(−b, b) (61)
Proof. We show that
TINu(x) =u(0)φ(0)
f(x) +u′(0)φ(1)
f(x)−Rf
INTf
INu′′2(−b, b). (62)
Let us first see that (62) is valid for p∈ P(R). Indeed, set p(x) =PM
k=0ckxk. By the
linearity of Tf
IN, Theorem 26 and (60) we have
Tf
INp(x) =c0φ(0)
f+c1φ(1)
f(x) +MX
k=2ckφ(k)
f(x)
=p(0)φ(0)
f+p′(0)φ(1)
f(x)−MX
k=2ckk(k−1)Rf
INφ(k−2)
f(x)
=p(0)φ(0)
f+p′(0)φ(1)
f(x)−MX
k=2ckk(k−1)Rf
INTf
IN
xk−2
=p(0)φ(0)
f+p′(0)φ(1)
f(x)−Rf
INTf
INp′′(x)
This establishes (62) for p∈ P(R). Take u∈H2(−b, b) arbitrary. There exists a sequence
{pn} ⊂ P (R) such that p(j)
n[−b,b]
⇒u(j),j= 0,1, and p′′
n→uinL2(−b, b), when n→ ∞ (see
[14, Prop. 4]). Since Rf
INTf
IN∈ B(L2(−b, b), L2(0, b)) we have
Tf
INu(x) = lim
n→∞Tf
INpn(x) = lim
n→∞h
pn(0)φ(0)
f+p′
n(0)φ(1)
f(x)−Rf
INTf
INp′′
n(x)i
=u(0)φ(0)
f(x) +u′(0)φ(1)
f(x)−Rf
INTf
INu′′(x)
and we obtain (62). Hence, by Remark 20, Tf
IN(H2(−b, b))⊂ D 2(Lq,IN), and since Lq,INφ(k)
f=
0 for k= 0,1, applying Lq,INin both sides of (62) we have (61).
226 Fourier-Legendre and Neumann series of Bessel func-
tions expansions
6.1 Fourier-Legendre series expansion of the transmutation kernel
Fixx∈(0, b]. Theorem 10 establishes that Kh
IN(x,·)∈L2(−x, x), then Kh
IN(x, t) admits a
Fourier series in terms of an orthogonal basis of L2(−x, x). Following [30], we choose the
orthogonal basis of L2(−1,1) given by the Legendre polynomials {Pn(z)}∞
n=0. Thus,
Kh
IN(x, t) =∞X
n=0an(x)
xPnt
x
(63)
where
an(x) =
n+1
2Zx
−xKh
IN(x, t)Pnt
x
dt ∀n∈N0. (64)
The series (63) converges with respect to tin the norm of L2(−x, x). Formula (64) is obtained
multiplying (63) by Pn t
x
, using the general Parseval’s identity [2, pp. 16] and taking into
account that ∥Pn∥2
L2(−1,1)=2
2n+1,n∈N0.
Example 30 Consider the kernel K0
I1(x, t) =α1
2H(x−x1)χ[2x1−x,x]from Example 11. In
this case, the Fourier-Legendre coefficients has the form
an(x) =α1
2
n+1
2
H(x−x1)Zx
2x1−xPn(t)dt=α1
2
n+1
2
xH(x−x1)Z1
2x1
x−1Pn(t)dt.
From this we obtain a0(x) =α1
2H(x−x1)(x−x1). Using formula Pn(t) =1
2n+1d
dt(Pn+1(t)−Pn−1(t))
forn∈N, and that Pn(1) = 0 for all n∈N, we have
an(x) =α1
4xH(x−x1)
Pn−12x1
x−1
−Pn+12x1
x−1
Remark 31 From (64) we obtain that the first coefficient a0(x)is given by
a0(x) =1
2Zx
−xKh
IN(x, t)P0t
x
dt=1
2Zx
−xKh
IN(x, t)dt
=1
2Th
IN[1]−1
2=1
2(eh
IN(0, x)−1).
Thus, we obtain the relations
a0(x) =1
2(eh
IN(0, x)−1), eh
IN(0, x) = 2 an(x) + 1. (65)
For the kernels Gh
IN(x, t) and SIN(x, t) we obtain the series representations in terms of
the even and odd Legendre polynomials, respectively,
23Gh
IN(x, t) =∞X
n=0gn(x)
xP2nt
x
, (66)
SIN(x, t) =∞X
n=0sn(x)
xP2n+1t
x
, (67)
where the coefficients are given by
gn(x) = 2 a2n(x) = (4 n+ 1)Zx
0Gh
IN(x, t)P2nt
x
dt, (68)
sn(x) = 2 a2n+1(4n+ 3)Zx
0SIN(x, t)P2n+1t
x
dt. (69)
The proof of these facts is analogous to that in the case of Eq. (9), see [30] or [29, Ch. 9].
Remark 32 Since g0(x) = 2 a0(x), then g0(x) =eh
IN(0, x)−1. Since eh
IN(0, x)is the solution
of (1) with ρ= 0satisfying eh
IN(0,0) = 1 ,(eh
IN)′(0,0) = h, hence by Remark 5, eh
IN(0, x) =
ch
IN(0, x)and
g0(x) =ch
IN(0, x)−1. (70)
On the other hand, for the coefficient s0(x)we have the relation
s0(x) = 3Zx
0HIN(x, t)P1t
x
dt=3
xZx
0HIN(x, t)tdt.
Sincesin(ρx)
ρ
x=0=x, from (31) we have
s0(x) = 3sIN(0, x)
x−1
. (71)
For every n∈N0we write the Legendre polynomial Pn(z) in the form Pn(z) =Pn
k=0lk,nzk.
Note that if nis even, lk,n= 0 for odd k, and P2n(z) =Pn
k=0˜lk,nz2kwith ˜lk,n=l2k,2n. Simi-
larly P2n+1(z) =Pn
k=0ˆlk,nz2k+1with ˆlk,n=l2k+1,2n+1. With this notation we write an explicit
formula for the coefficients (64) of the canonical transmutation kernel Kf
JN(x, t).
Proposition 33 The coefficients {an(x)}∞
n=0of the Fourier-Legendre expansion (63) of the
canonical transmutation kernel Kf
IN(x, t)are given by
an(x) =
n+1
2 nX
k=0lk,nφ(k)
f(x)
xk−1!
. (72)
The coefficients of the canonical cosine and sine kernels satisfy the following relations for all
n∈N0
gn(x) = (4 n+ 1) nX
k=0˜lk,nφ(2k)
f(x)
x2k−1!
, (73)
sn(x) = (4 n+ 3) nX
k=0ˆlk,nφ(2k+1)
f (x)
x2k+1−1!
, (74)
24Proof. From (64) we have
an(x) =
n+1
2Zx
−xKf
IN(x, t) nX
k=0lk,nt
xk!
dt
=
n+1
2nX
k=0lk,n
xkZx
0Kf
IN(x, t)tkdt
=
n+1
2nX
k=0lk,n
xk
Tf
IN
xk
−xk
.
Hence (72) follows from Theorem 26 and that Pn(z) = 1. Since gn(x) = 2 a2n(x),sn(x) =
2a2n+1(x),l2k+1,2n= 0, l2k,2n+1= 0 and l2k,2n=˜lk,n,l2k+1,2n+1=ˆlk,n, we obtain (73) and
(74).
Remark 34 By Remark 27, formula (72) is well defined at x= 0. Note that xnan(x)belongs
toD2(Lq,IN)for all n∈N0.
6.2 Representation of the solutions as Neumann series of Bessel
functions
Similarly to the case of the regular Eq. (13) [30], we obtain a representation for the solutions
in terms of Neumann series of Bessel functions (NSBF). For M∈Nwe define
Kh
IN,M(x, t) :=MX
n=0an(x)
xPnt
x
,
that is, the M-partial sum of (63).
Theorem 35 The solutions ch
IN(ρ, x)andsIN(ρ, x)admit the following NSBF representa-
tions
ch
IN(ρ, x) = cos( ρx) +∞X
n=0(−1)ngn(x)j2n(ρx), (75)
sIN(ρ, x) =sin(ρx)
ρ+1
ρ∞X
n=0(−1)nsn(x)j2n+1(ρx), (76)
where jνstands for the spherical Bessel function jν(z) =pπ
2zJν+1
2(z)(and Jνstands for
the Bessel function of order ν). The series converge pointwise with respect to xin(0, b]and
uniformly with respect to ρon any compact subset of the complex ρ-plane. Moreover, for
M∈Nthe functions
ch
IN,M(ρ, x) = cos( ρx) +MX
n=0(−1)ngn(x)j2n(ρx), (77)
sIN,M(ρ, x) =sin(ρx)
ρ+1
ρMX
n=0(−1)nsn(x)j2n+1(ρx), (78)
25obey the estimates
|ch
IN(ρ, x)−ch
IN,M(ρ, x)|⩽2ϵ2M(x)r
sinh(2 bC)
C, (79)
|ρsIN(ρ, x)−ρsIN,M(ρ, x)|⩽2ϵ2M+1(x)r
sinh(2 bC)
C, (80)
for any ρ∈Cbelonging to the strip |Imρ|⩽C,C >0, and where
ϵM(x) =∥Kh
IN(x,·)−Kh
IN,2M(x,·)∥L2(−x,x).
Proof. We show the results for the solution ch
IN(ρ, x) (the proof for sIN(ρ, x) is similar).
Substitution of the Fourier-Legendre series (66) in (30) leads us to
ch
IN(ρ, x) = cos( ρx) +Zx
0 ∞X
n=0gn(x)
xP2nt
x!
cos(ρt)dt
= cos( ρx) +∞X
n=0gn(x)
xZx
0P2nt
x
cos(ρt)dt
(the exchange of the integral with the summation is due to the fact that the integral is
nothing but the inner product of the series with the function cos(ρt) and the series converges
inL2(0, x)). Using formula 2.17.7 in [40, pp. 433]
Za
0P2n+1 y
a
·sin(by)
P2n y
a
·cos(by)
dy= (−1)nrπa
2bJ2n+δ+1
2(ab), δ =1
0
, a > 0,
we obtain the representation (75). Take C > 0 and ρ∈Cwith|Imρ|⩽C. For M∈N
define Gh
IN,M(x, t) := Kh
IN,2M(x, t)−Kh
IN,2M(x,−t) =PM
n=0gn(x)
xP2n t
x
, the M-th partial
sum of (66). Then
ch
IN,M(ρ, x) = cos( ρx) +Zx
0Gh
IN,M(x, t) cos( ρt)dt.
Using the Cauchy-Bunyakovsky-Schwarz inequality we obtain
|ch
IN(ρ, x)−Ch
IN,M(ρ, x)|=Zx
0 
Gh
IN(x, t)−Gh
IN,M(x, t)
cos(ρt)dt
=D
Gh
IN(x, t)−Gh
IN,M(x, t),cos(ρt)E
L2(0,x)
⩽∥Gh
IN(x,·)−Gh
IN,M(x,·)∥L2(0,x)∥cos(ρt)∥L2(0,x).
Since∥Kh
IN(x,·)−Kh
IN,2M(x,·)∥L2(−x,x)=1
2∥Gh
IN(x,·)−Gh
M,n(x,·)∥L2(0,x),
Zx
0|cos(ρt)|2dt⩽1
4Zx
0 
|eiρt|+|e−iρt|2dt⩽1
2Zx
0 
e−2tImρ+e2tImρ
dt
=Zx
−xe−2 Imρtdt=sinh(2 xImρ)
Imρ
26and the functionsinh(ξx)
ξis monotonically increasing in both variables when ξ, x⩾0, we
obtain (79).
Given H∈C, we look for a pair of solutions ψH
IN(ρ, x) and ϑIN(ρ, x) of (1) satisfying the
conditions
ψH
IN(ρ, b) = 1 ,(ψH
IN)′(ρ, b) =−H, (81)
ϑIN(ρ, b) = 0 , ϑ′
IN(ρ, b) = 1 . (82)
Theorem 36 The solutions ψH
IN(ρ, x)andϑIN(ρ, x)admit the integral representations
ψH
IN(ρ, x) = cos( ρ(b−x)) +Zb
xeGH
IN(x, t) cos( ρ(b−t))dt, (83)
ϑIN(ρ, x) =sin(ρ(b−x))
ρ+Zb
xeSH
IN(x, t)sin(ρ(b−t))
ρdt, (84)
where the kernels eGH
IN(x, t)andeSIN(x, t)are defined in Ωand satisfy eGH
IN(x,·),eSIN(x,·)∈
L2(0, x)for all x∈(0, b]. In consequence, the solutions ψH
IN(ρ, x)andϑIN(ρ, x)can be
written as NSBF
ψH
IN(ρ, x) = cos( ρ(b−x)) +∞X
n=0(−1)nτn(x)j2n(ρ(b−x)), (85)
ϑIN(ρ, x) =sin(ρ(b−x))
ρ+∞X
n=0(−1)nζn(x)j2n(ρ(b−x)), (86)
with some coefficients {τn(x)}∞
n=0and{ζn(x)}∞
n=0.
Proof. We prove the results for ψH
IN(ρ, x) (the proof for ϑIN(ρ, x) is similar). Set y(ρ, x) =
ψH
IN(ρ, b−x). Note that y(ρ,0) = 1, y′(ρ,0) = Hand for ϕ∈C∞
0(0, b) we have
(y′′2y(x), ϕ(x))C∞
0(0,b)= (ψH
IN(ρ, x), ϕ′′2ϕ(b−x))C∞
0(0,b)
= (q(x)ψH
IN(ρ, x), ϕ(b−x))C∞
0(0,b)+NX
k=0αkψH
IN(ρ, xk)ϕ(b−xk)
= (q(b−x)y(x), ϕ(x))C∞
0(0,b)+NX
k=0αky(b−xk)ϕ(b−xk),
that is, ψH
IN(ρ, x) is a solution of (1) iff y(x) =ψH
IN(ρ, b−x) is a solution of
−y′′(x) + 
q(b−x) +NX
k=0αkδ(x−(b−xk))!
y(x) =ρ2y(x). (87)
Since 0 < b−xN<···< b−x0< b, hence (87) is of the type (1) with the point interactions
I∗
N={(b−xN−j, αN−j)}N
j=0andψH
IN(ρ, b−x) is the corresponding solution cH
I∗
N(ρ, x) for
(87). Hence
ψH
IN(ρ, b−x) = cos( ρx) +Zx
0GH
I∗
N(x, t) cos( ρt)dt (88)
27for some kernel GH
I∗
N(x, t) defined on Ω with eGH
IN(x,·)∈L2(0, x) for x∈(0, b]. Thus,
ψIN(ρ, x) = cos( ρ(b−x)) +Zb−x
0GH
I∗
N(b−x, t) cos( ρt)dt
=ψIN(ρ, x) = cos( ρ(b−x)) +Zb
xGH
I∗
N(b−x, b−t) cos( ρ(b−t))dt,
where the change of variables x7→b−xwas used. Hence we obtain (83) with eGH
I∗
N(x, t) =
GH
I∗
N(b−x, b−t) In consequence, by Theorem 35 we obtain (85).
Remark 37 As in Remark 32
τ0(x) =ψH
IN(0, x)−1and ζ0(x) = 3ϑIN(0, x)
b−x−1
. (89)
Remark 38 Letλ∈Candλ=ρ2.
(i) The functions bsk(ρ, x−xk)are entire with respect to ρ. Then from (12) ch
IN(ρ, x),
sIN(ρ, x)andψH
IN(ρ, x)are entire as well.
(ii) Suppose that qis real valued and α0, . . . , α N, u0, u1∈R. If u(λ, x)is a solution of
u(k)(λ,0) = uk,k= 0,1, then by the uniqueness of the Cauchy problem u(λ, x) =
u(λ, x). In particular, for ρ, h, H ∈R, the solutions ch
IN(ρ, x),sIN(ρ, x)andψH
IN(ρ, x)
are real valued.
6.3 A recursive integration procedure for the coefficients {an(x)}∞
n=0
Similarly to the case of the regular Schr¨ odinger equation [29, 30, 32], we derive formally a
recursive integration procedure for computing the Fourier-Legendre coefficients {an(x)}∞
n=0
of the canonical transmutation kernel Kf
JN(x, t). Consider the sequence of functions σn(x) :=
xnan(x) for n∈N0. According to Remark 34, {σn(x)}∞
n=0⊂ D 2(Lq,JN).
Remark 39 (i) By Remark 32,
σ0(x) =f(x)−1
2. (90)
(ii) By (72), a1(x) =3
2
φ(1)
f(x)
x−1
. Thus, from (42) and (43) we have
σ1(x) =3
2
f(x)Zx
0dt
f2(t)−x
. (91)
(iii) For n⩾2,σn(0) = 0 , and by (72) we obtain
Dσn(x) =
n+1
2nX
k=0lk,nD
xn−kφ(k)
f(x)
=
n+1
2 n−1X
k=0lk,n(n−k)xn−k−1φ(k)
f(x) +nX
k=0lk,nxn−kDφ(k)
f(x)!
.
By (44) and (43), Dφ(k)
f(0) = 0 fork⩾1. Hence, σ′
n(0) = 0 .
28Denote by cf
JN(ρ, x) the solution of (1) satisfying (28) with h=f′(0). On each interval
[xk, xk+1],k= 0,···, N,cf
JN(ρ, x) is a solution of the regular equation (9). In [30, Sec. 6]
by substituting the Neumann series (75) of cf
JN(ρ, x) into Eq. (9) it was proved that the
functions {σ2n(x)}∞
n=0must satisfy, at least formally, the recursive relations
Lqσ2n(x) =4n+ 1
4n−3x4n−1Lqσ2n−2(x)
x4n−3
, x k< x < x k (92)
fork= 0,···, N. Similarly, substitution of the Neumann series (76) of sJN(ρ, x) into (9)
leads to the equalities
Lqσ2n+1(x) =4n+ 3
4n+ 1x4n+3Lqσ2n+1(x)
x4n+1
, x k< x < x k. (93)
Taking into account that σn∈ D 2(Lq,JN) and combining (92), by Remark 39(iii) and (93) we
obtain that the functions σn(x),n⩾2, must satisfy (at least formally) the following Cauchy
problems

Lq,JNσn(x) =2n+ 1
2n−3x2n−1Lqσn−2(x)
x2n−3
,0< x < b,
σn(0) = σ′
n(0) = 0 .(94)
Remark 40 Ifg∈ D 2(Lq,JN), theng
f∈H2(0, b).
Indeed,g
f∈C[0, b], and the jump of the derivative at xkis given by
g
f′
(xk+)−g
f′
(xk−) =g′(xk+)f(xk)−f′(xk+)g(xk)
f2(xk)−g′(xk−)f(xk)−f′(xk−)g(xk)
f2(xk)
=1
f2(xk)[(g′(xk+)−g′(xk−))f(xk)−g(xk) (f′(xk+)−f′(xk−))]
=1
f2(xk)[αkg(xk)f(xk)−αkg(xk)f(xk)] = 0 .
Henceg
f∈AC[0, b], and theng
f∈H2(0, b).
Proposition 41 The sequence {σn(x)}∞
n=0satisfying the recurrence relation (94) for n⩾2,
withσ0(x) =f(x)−1
2andσ1(x) =3
2
f(x)Rx
0dt
f2(t)−x
, is given by
σn(x) =2n+ 1
2n−3 
x2σn−2(x) + 2(2 n−1)θn(x)
, n⩾2, (95)
where
θn(x) :=Zx
0(ηn(t)−tf(t)σn−2(t))dt
f2(t), n⩾2, (96)
and
ηn(x) :=Zx
0((n−1)f(t) +tf′(t))σn−2(t)dt, n ⩾2. (97)
29Proof. Setg∈ D 2(Lq,JN) and n⩾2. Consider the Cauchy problem


Lq,JNun(x) =2n+ 1
2n−3x2n−1Lqg(x)
x2n−3
,0< x < b,
un(0) = u′
n(0) = 0 .(98)
By formula (39) and the Polya factorization Lq=−1
fDf2D1
fwe obtain that the unique
solution of the Cauchy problem (98) is given by
un(x) =2n+ 1
2n−3f(x)Zx
01
f2(t)Zt
0s2n−1Df2(s)Dg(s)
s2n−3f(s)
ds
dt.
Consider an antiderivativeR
s2n−1Df2(s)Dh
g(s)
s2n−3f(s)i
ds. Integration by parts gives
Z
s2n−1Df2(s)Dg(s)
s2n−3f(s)
ds=s2n−1f2(s)Dg(s)
s2n−3f(s)
−(2n−1)sf(s)g(s)
+Z
((2n−1)(2n−2)f(s) + 2(2 n−1)sf′(s))g(s)ds.
Note that
s2n−1f2(s)Dg(s)
s2n−3f(s)
=s2n−1f2(s)D
g(s)
f(s)
s2n−3−s2n−1f2(s)g(s)
f(s)
s4n−6(2n−3)s2n−4
=s2f2(s)Dg(s)
f(s)
−(2n−3)sf(s)g(s).
Since g∈ D 2(Lq,JN), by Remark 40, D
g(s)
f(s)
is continuous in [0 , b]. Thus,
Z
s2n−1Df2(s)Dg(s)
s2n−3f(s)
ds=s2f2(s)Dg(s)
f(s)
−(4n−4)sf(s)g(s)
+ 2(2 n−1)Z
((n−1)f(s) +sf′(s))ds
is well defined at s= 0 and is continuous in [0 , b]. Then we obtain that
Φ(t) :=Zt
0s2n−1Df2(s)Dg(s)
s2n−3f(s)
ds
=t2f2(t)Dg(t)
f(t)
−(4n−4)tf(t)g(t) + 2(2 n−1)Θ n[g](t),
with Hn[g](t) :=Zt
0((n−1)f(s) +sf′(s))g(s)ds, is a continuous function in [0 , b]. Now,
Zx
0Φ(t)dt
f2(t)=Zx
0t2Dg(t)
f(t)
dt−(4n−4)Zt
0tg(t)
f(t)dt+ 2(2 n−1)Hn[g](t)
=x2g(x)
f(x)−2(2n−1)Zx
0[Hn[g](t)−tf(t)g(t)]dt.
30Hence
un(x) =2n+ 1
2n−3 
x2g(x)−2(2n−1)Θ n[g](x)
, (99)
with Θ n[g](x) :=Zx
0[Hn[g](t)−tf(t)g(t)]dt.
Finally, since σ0, σ1∈ D 2(Lq,JN), formula (95) is obtained for all n⩾2 by induction,
taking g=σ2n−2in (98) and ηn(x) =Hn[σn−2](x),θn(x) = Θ n[σn−2](x) in (99).
Integral relations of type (95) are effective for the numerical computation of the partial
sums (77) and (78), as seen in [30, 32].
7 Integral representation for the derivative
Since eh
IN(ρ,·)∈AC[0, b], it is worthwhile looking for an integral representation of the
derivative of eh
IN(ρ, x). Differentiating (16) we obtain
(eh
IN)′(ρ, x) =ee′
h(ρ, x) +NX
k=0αkeeh(ρ, xk)H(x−xk)bs′
k(ρ, x−xk)
+X
J∈INαJH(x−xj|J|)eeh(ρ, xj1)
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl)
bs′
j|J|(ρ, x−xj|J|).
Differentiating (18) and using that bHk(x, x) =1
2Rx
0q(t+xk)dt, we obtain
bs′
k(ρ, x) = cos( ρx) +1
2sin(ρx)
ρZx
0q(t+xk)dt+Zx
0∂xbHk(x, t)sin(ρt)
ρdt.
Denote
w(y, x) :=1
2Zx
yq(s)ds forx, y∈[0, b]. (100)
Hence, the derivative bs′
k(ρ, x−xk) can be written as
bs′
k(ρ, x−xk) = cos( ρ(x−xk)) +Zx−xk
−(x−xk)eK1
k(x, t)eiρtdt, (101)
where eK1
k(x, t) =w(xk, x) +1
2Zx−xk
|t|∂xbHk(x, t)dt.
On the other hand, differentiation of (17) and the Goursat conditions for eKh(x, t) lead
to the equality
˜e′
h(ρ, x) = (iρ+w(0, x))eiρx+hcos(ρx) +Zx
−x∂xeKh(x, t)eiρtdt. (102)
Using the fact that
cos(ρA)ZB
−Bf(t)eiρtdt=ZB+A
−(B+A)1
2 
χ[−(B+A),B−A](t)f(t−A) +χ[A−B,B+A](t)f(t+A)
eiρtdt
31forA, B > 0 and f∈L2(R) with Supp( f)⊂[−B, B], we obtain
˜eh(ρ, xj)bs′
k(ρ, x−xk) =eiρxjcos(ρ(x−xk)) +Fh
bKxj,xk(x, t)i
,
where
bKxj,xk(x, t) =χ[xk−x−xj,x−xk−xj](t)eK1
k(x, t−xj) +χxj(t)eKh(xj, t)∗χx−xk(t)bK1
k(x, t)
+1
2χ[xk−xj−x,xj−x+xk](t)bKh(xj, t−x+xk)
+1
2χ[x−xk−xj,x−xk+xj](t)bKh(xj, t+x−xk)
.
By Lemma 9 the support of bKxj,xk(x, t) belongs to [ xk−x−xj, x−xk+xj]. Using the
equality
|J|−1Y
l=1bsjl(ρ, xjl+1−xjl) =F


|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKk(xjl+1, t)


we have
(eh
IN)′iρx+hcos(ρx) +NX
k=0αkH(x−xk)eiρxkcos(ρ(x−xk)) +F
Eh
IN(x, t)	
where
Eh
IN(x, t) =χx(t)∂xeKh(x, t) +NX
k=0αkH(x−xk)bKxk,xk(x, t)
+X
J∈INαJH(x−xj|J|)bKxj1,xj|J|(x, t)∗
|J|−1Y
l=1
∗
χxjl+1−xjl(t)eKk(xjl+1, t)
.
Again, by Lemma 9 the support of Eh
IN(x, t) belongs to [ −x, x]. Since eiρxkcos(ρ(x−xk)) =
1
2eiρx 
1 +e−2iρ(x−xk)
, we obtain the following representation.
Theorem 42 The derivative (eh
IN)′(ρ, x)admits the integral representation
(eh
IN)′(ρ, x) =
iρ+w(0, x) +1
2σIN(x)
eiρx+hcos(ρx)
+NX
k=0αk
2H(x−xk)e−2iρ(x−xk)+Zx
−xEh
IN(x, t)eiρtdt, (103)
where Eh
IN(x,·)∈L2(−x, x)for all x∈(0, b].
32Corollary 43 The derivatives of the solutions ch
IN(ρ, x)andsIN(ρ, x)admit the integral
representations
(ch
IN)′(ρ, x) =−ρsin(ρx) +
h+w(0, x) +1
2σIN(x)
cos(ρx)
+NX
k=0αk
2H(x−xk) cos(2 ρ(x−xk)) +Zx
0Mh
IN(x, t) cos( ρt)dt, (104)
s′
IN(ρ, x) = cos( ρx) +
w(0, x) +1
2σIN(x)sin(ρx)
ρ
−NX
k=0αkH(x−xk)sin(2ρ(x−xk))
2ρ+Zx
0RIN(x, t)sin(ρt)
ρdt, (105)
where
Nh
IN(x, t) =Eh
IN(x, t) +Eh
IN(x,−t) (106)
Rh
IN(x, t) =Eh
IN(x, t)−Eh
IN(x,−t), (107)
defined for x∈[0, b]and|t|⩽x.
Corollary 44 The derivatives of the solutions ch
IN(ρ, x)andsIN(ρ, x)admit the NSBF rep-
resentations
(ch
IN)′(ρ, x) =−ρsin(ρx) +
h+w(0, x) +1
2σIN(x)
cos(ρx)
+NX
k=0αk
2H(x−xk) cos(2 ρ(x−xk)) +∞X
n=0(−1)nln(x)j2n(ρx), (108)
s′
IN(ρ, x) = cos( ρx) +
w(0, x) +1
2σIN(x)sin(ρx)
ρ
−NX
k=0αkH(x−xk)sin(2ρ(x−xk))
2ρ+∞X
n=0(−1)nrn(x)j2n+1(ρx), (109)
where {ln(x)}∞
n=0and{rn(x)}∞
n=0are the coefficients of the Fourier-Legendre expansion of
Mh
IN(x, t)andRJN(x, t)in terms of the even and odd Legendre polynomials, respectively.
8 Conclusions
The construction of a transmutation operator that transmute the solutions of equation v′′+
λv= 0 into solutions of (1) is presented. The transmutation operator is obtained from
the closed form of the general solution of equation (1). It was shown how to construct
the image of the transmutation operator on the set of polynomials, this with the aid of
the SPPS method. A Fourier-Legendre series representation for the integral transmutation
kernel is obtained, together with a representation for the solutions ch
IN(ρ, x),sIN(ρ, x) and
33their derivatives as Neumann series of Bessel functions, together with integral recursive
relations for the construction of the Fourier-Legendre coefficients. The series (75), (76),
(108), (109) are useful for solving direct and inverse spectral problems for (1), as shown for
the regular case [28, 29, 30, 32].
Acknowledgments
Research was supported by CONACYT, M´ exico via the project 284470.
Declarations
Conflict of interest
The authors declare no potential conflict of interest.
Data availability
Data sharing not applicable to this article as no datasets were generated or analysed during
the current study.
References
[1]O. Akcay ,The representation of the solution of Sturm-Liouville equation with discon-
tinuity conditions , Acta Math. Scientia. 38B(4) (2018), 1195-1213.
[2]N.I. Akhiezer, I.M. Glazman ,Theory of Linear Operators in Hilbert Space , Dover,
New York, 1993.
[3]S. Albeverio, L. Dabrowski, P. Kurasov ,Symmetries of Schr¨ odinger operators
with Point interactions , Letters in Mathematical Physics 45 (1998), 33-47.
[4]S. Albeverio, F. Gesztesy, R. Hoegh-Krohn, et al. ,The Schr¨ odinger operator
for a particle in a solid with deterministic and stochastic point interactions , in: Lect.
Notes in Mathematics, Vol. 1218 (1986), pp. 1-38.
[5]D. A. Atkinson, H. W. Crater ,An exact treatment of the Dirac delta function
potential in the Schr¨ odinger equation , Am J Phys. 43, 301 (1975); doi: 10.1119/1.9857
[6]V. Barrera-Figueroa ,A power series analysis of bound and resonance states of one-
dimensional Schr¨ odinger operators with finite point interactions , Applied Mathematics
and Computation, Vol. 417 (2022); doi: 10.1016/j.amc.2021.126774
[7]V. Barrera-Figueroa, V. S. Rabinovich ,Numerical calculation of the discrete
spectra of one-dimensional Schr¨ odinger operators with point interactions , Math Methods
Appl Sci 42 (2019), 5072-5093.
34[8] H. Begehr and R. Gilbert, Transformations, transmutations and kernel functions, vol.
1–2(Longman Scientific & Technical, Harlow, 1992).
[9]G. Berkolaiko, P. Kuchment ,Introduction to quantum graphs , AMS, No. 183,
2013.
[10]H. Blancarte, H. Campos, K.V. Khmelnytskaya ,Spectral parameter powers
series method for discontinuous coefficients , Math. Methods Appl. Sci. 38 (10), (2015),
2000-2011.
[11]N. P. Bondarenko ,Solving An Inverse Problem For The Sturm-Liouville Operator
With A Singular Potential By Yurko’s Method , Tamkang Journal of Mathematics, Vol.
52, No. 1 (2021), 125-154.
[12]H. Brezis ,Functional Analysis, Sobolev Spaces and Partial Differential Equations , 1st.
Edition, Springer, 2010.
[13]R. Camporesi, A. J. Di Scala ,A generalization of a theorem of Mammana , Colloq.
Math. 122 (2011), 215-223.
[14]H. Campos ,Standard transmutation operators for the one dimensional Schr¨ odinger
operator with a locally integrable potential , J. Math. Anal. Appl. 453 (2017), no. 1,
64-81.
[15]H. Campos, V. V. Kravchenko, S. M. Torba ,Transmutations, L-bases and com-
plete families of solutions of the stationary Schr¨ odinger equation in the plane , J. Math.
Anal. Appl. 389 (2012), no. 2,1222-1238.
[16]F. A. B. Coutinho, Y. Nogami, J. Fernando Perez ,Generalized point interac-
tions in one-dimensional quantum mechanics , J. Phys A: Math. Gen 30 (1997), 3937-
3945.
[17]G. B. Folland ,Real Analysis, Modern Techniques and Their Applications , 2nd. Edi-
tion, New-York: Wiley 1999.
[18]F. Gesztesy, W. Kirsch ,One-dimensional Schr¨ odinger operators with interactions
singular on a discrete set , Journal f¨ ur die reine und angewandte Mathematik 362, (1985),
28-50.
[19]G. Freiling, V. Yurko ,Inverse Sturm-Liouville problems and their applications ,
NY: Nova Science Pub Inc; 2001.
[20]N. J. Guliyev ,Schr¨ odinger operators with distributional potentials and boundary con-
ditions dependent on the eigenvalue parameter , J. Math. Phys. 60 (2019), 063501.
[21]N. Guti ´errez Jim ´enez, S. M. Torba ,Spectral parameter power series representa-
tion for solutions of linear systems of two first order differential equations , Appl. Math.
Comput. 370, 124911 (2020).
35[22]O. H. Hald ,Discontinuous inverse eigenvalue problems , Commun. Pure Appl. Math.
37 (1984), 539-577.
[23]R. O. Hryniv, Y. V. Mykytyuk ,Transformation operators for Sturm-Liouville
operators with singular potentials , Math. Phys. Anal. Geom. 7 (2004), 119-149.
[24]R. P. Kanwal ,Generalized Functions: Theory and Applications , Birkh¨ auser, Boston,
2004.
[25]A. N. Kochubei ,One-dimensional point interactions , Ukr. Math. J. 41 (1989), 1198-
1201. Doi: 10.1007/BF01057262.
[26]A. S. Kostenko, M. M. Malamud ,One-Dimensional Schr¨ odinger operators with
δ-interactions , Functional Analysis and its Applications, Vol. 44, No. 2 (2010) 151-155.
[27]V. V. Kravchenko ,A representation for solutions of the Sturm-Liouville equation ,
Complex Var. Elliptic Equ. 53 (2008), 775-789.
[28]V. V. Kravchenko ,On a method for solving the inverse Sturm-Liouville problem. J.
Inverse Ill-Posed Prob. (2019) 27, 401-407.
[29]V. V. Kravchenko ,Direct and Inverse Sturm-Liouville Problems: A Method of So-
lution , Frontiers in Mathematics (Birkh¨ auser, Cham, 2020).
[30]V. V. Kravchenko, L.J. Navarro, S.M. Torba ,Representation of solutions to the
one-dimensional Schr¨ odinger equation in terms of Neumann series of Bessel functions.
Appl. Math. Comput. 314(1) (2017) 173-192.
[31]V. V. Kravchenko, R. M. Porter ,Spectral parameter power series for Sturm-
Liouville problems , Math. Methods Appl. Sci. 33 (2010), 459-468.
[32]V. V. Kravchenko, S. M. Torba ,A Neumann series of Bessel functions represen-
tations of solutions of Sturm-Liouville equations , Calcolo (2018) 55:11.
[33]V. V. Kravchenko, S. M. Torba ,A direct method for solving inverse Sturm-
Liouville problems , Inverse Problems 37 (2021), 015015.
[34]P. Kurasov ,Distribution theory for discontinuous tests functions and differential op-
erators with generalized coefficients , J. Math. Anal. Appl. 201(1) (1996), 297-323.
[35]P. Kurasov, J. Larson ,Spectral asymptotics for Schr¨ odinger operators with gener-
alized coefficients , J. Math. Anal. Appl. 266(1) (2002), 127-148.
[36]B. M. Levitan ,Inverse Sturm-Liouville Problems , Zeist: VSP; 1987.
[37]L. I. Mammadova ,Representation of the solution of Sturm-Liouville equation with
discontinuity conditions interior to interval , Proceedings of IMM of NAS of Azerbaijan
(2010), Vol. XXXIII (XLI), pp. 127-136.
36[38]M. D. Manafov, A. Kablan ,Inverse espectral and inverse nodal problems for energy-
dependent Sturm-Liouville equations with δ-interactions , Electronic Journal of Differen-
tial Equations, Vol. 2015 (2015), No. 6, pp. 1-10.
[39]V. A. Marchenko ,Sturm-Liouville operators and applications , Birkh¨ auser, Basel,
1986.
[40]A. P. Prudnikov, Yu. A. Brychkov, O. I. Marichev ,Integrals and Series. vol.
2. Special Functions (Gordon & Breach Science Publishers, New York, 1986).
[41]V. S. Rabinovich, V. Barrera-Figueroa, L. Olivera Ram ´ırez,On the Spectra
of One-Dimensional Schr¨ odinger Operators With Singular Potentials , Front. Phys. 7:57;
doi: 10.3389/fphy.2019.00057
[42]M. A. Savchuk, A. A. Shkalikov ,Sturm-Liouville operators with singular poten-
tials, Mathematical Notes 66 (1999), 741-753.
[43]E. L. Shishkina, S. M. Sitnik ,Transmutations, singular and fractional differential
equations with applications to mathematical physics , Elsevier, Amsterdam, 2020.
[44]H. Uncu, H. Erkol, E. Demiralp, H. Beker ,Solutions of the Schr¨ odinger equation
for Dirac delta decorated linear potential , Central European Journal of Physics 3(2),
2005, 303-323.
[45]V. S. Vladimirov ,Equations of Mathematical Physics . New York: Marcel Dekker;
1971.
[46]V. Yurko ,Integral transforms connected with discontinuous boundary value prob-
lems, Integral transforms and Specials Functions, 10:2 (2000), 141-164. Doi:
10.1080/10652460008819282.
[47]A. Zettl Sturm-Liouville Theory , AMS, Providence, 2005.
37