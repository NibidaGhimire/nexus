arXiv:2302.03454v1  [math.NT]  7 Feb 2023p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2
CURVES
FRANCESCA BIANCHI
Abstract. LetCbe a genus 2 hyperelliptic curve over a number ﬁeld K, with a Weierstrass
point∞atinﬁnity, let Jbe its Jacobian, letΘ be the theta divisorwith respect to ∞, and let pbe
any prime number. We give an explicit construction of a p-adic height hp:J(Q)→Qpby means
ofp-adic analogues of N´ eron functions of divisor 2Θ. We deﬁne s uch N´ eron functions using
division polynomials and a generalisation of Blakestad’s p-adic sigma function on the formal
group of J. We prove that our p-adic N´ eron function λvat a non-archimedean place vofKis
the image, under a suitable trace map, of a symmetric v-adic Green function of divisor Θ ` a la
Colmez. We use this to relate λvandhpto local and global extended Coleman–Gross (and hence
Nekov´ aˇ r) p-adic height pairings. We provide examples of our implement ation, including one for
a prime pgreater than 106, and explain how similar techniques can be used to compute p-adic
integrals of diﬀerentials of the ﬁrst, second and third kind onCindependently of the reduction
type. As an application, we also give an explicit quadratic C habauty function vanishing on the
rational points on certain genus 4 bihyperelliptic curves.
Contents
1. Introduction 2
1.1. Elliptic curve analogues 5
1.2. Notation 6
Acknowledgements 6
2. Preliminaries 7
2.1. Formal group laws 7
2.2. Jacobians of genus 2 curves: algebraically, analytically and proj ectively 9
2.3. Grant’s formal group law 13
3.v-Adic sigma functions 15
3.1. The naive sigma function 15
3.2. Inﬁnitely many sigma functions and Blakestad’s canonical one 17
4.p-adic heights 21
4.1.p-adic N´ eron functions 22
4.2. Global height 24
5. Localp-adic N´ eron functions vs Colmez’s Green functions 24
5.1. Colmez’s p-adic integration theory and Green functions 25
5.2. Colmez’s theory on curves and Jacobians 26
5.3. Colmez’s adelic heights 28
5.4.p-Adic N´ eron functions, Green functions and Coleman–Gross heigh ts 33
6. Implementation and examples 36
6.1. Formal group and sigma functions 36
6.2. The canonical sigma function 37
6.3. Division polynomials 38
Date: February 8, 2023.
12 FRANCESCA BIANCHI
6.4.p-adic N´ eron functions 39
6.5. Example: A prime greater than 10639
6.6. Example: Coleman–Gross local heights via N´ eron functions 41
6.7. Integrals of diﬀerentials of the ﬁrst, second and third kind 42
7. An application: quadratic Chabauty for bihyperelliptic curves 43
Appendix 47
A. Multiples of points away from the theta divisor 47
B. Formal group parameters expansions 48
C. Sigma functions expansion 49
References 50
1.Introduction
LetCbe a genus 2 curve over a number ﬁeld Kand letJbe its Jacobian. We assume that C
is given by an aﬃne equation of the form y2=f(x), wheref(x) is a monic polynomial of degree
5 with coeﬃcients in the ring of integers OofKand no repeated roots. Let ι:C ֒− →Jbe the
embedding with respect to the unique point at inﬁnity of C, and let Θ be the corresponding theta
divisor ofJ. Fix a (any) rational prime pand a continuous idele class character χ:A×
K/K×→Qp.
With respect to this data, we explicitly construct, at every non-ar chimedean place vofK,p-adic
analogues of real-valued N´ eron functions with respect to 2Θ ( §4.1). Let
λv:J(Kv)\Supp(Θ) →Qp
be such ap-adic N´ eron function at v. We obtain a quadratic form hp:J(K)→Qpby extending
quadratically to J(K) the following function on J(K)\Supp(Θ):
hp(P) =1
[K:Q]/summationdisplay
vnvλv(P),
wherenv= [Kv:Qℓ] ifv|ℓ; we callhpa globalp-adic height.
To deﬁneλv, we use the explicit embedding of JintoP8due to Grant [ Gra90] and genus 2 hyper-
elliptic division polynomials of Kanayama [ Kan05,Kan10] and Uchida [ Uch11b], a generalisation
of the standard division polynomials on elliptic curves (see §2.2). Ifχis unramiﬁed at v, i.e. the
local component χvis identically zero on O×
v1, this is all that is needed for the deﬁnition of the
N´ eron function at v(cf. Deﬁnition 4.5). Moreover, up to a multiplicative constant, this is the same
as the real-valued N´ eron function at v, as explicitly constructed by Uchida [ Uch11a].
At the places vat whichχis ramiﬁed, the p-adic N´ eron function λvdepends on the choice of
a subspace WvofH1
dR(C/Kv) that is complementary to the space of holomorphic forms and
isotropic with respect to the cup product pairing. In particular, we attach toWva uniquev-
adic analogue σvof the complex hyperelliptic sigma function for C(see Section 3). This extends
work of Blakestad. Indeed, suppose that Kvis an unramiﬁed extension of Qp, thatvis of good
reduction for C, ordinary reduction for Jand thatp≥5. Then the v-adic sigma function attached
to the unit root subspace of the Frobenius endomorphism of H1
dR(C/Kv) is the “canonical” v-adic
sigma function of [ Bla18] (see Theorem 3.6, Remark 3.7 and Proposition 3.8). In fact, Blakes tad’s
thesis was the motivation for the work presented in this paper: for elliptic curves, the Mazur–Tate
p-adic height [ MT83] can be described explicitly using v-adic analogues of the Weierstrass sigma
function [ MT91,MST06] (see §1.1). Our initial goal was to extend this to genus 2. We will show in
forthcoming workwith Kayaand M¨ uller [ BKM23] that ourexplicit deﬁnition of hpin the canonical
case indeed recovers the canonical Mazur–Tate p-adic height for J.
The complex sigma function is a holomorphic function C2→C, which depends on an analytic
isomorphism J(C)∼=C2/Λ (§2.2). In general, no uniformisation theorem is at our disposal in the
1Note that the places of ramiﬁcation of χare a subset of the places of Kabovep.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 3
v-adic setting; however, the kernel of reduction of Jmodulov, which we denote by J1(Kv), is
the group associated to a commutative formal group law F(T1,T2) of dimension 2 over Ov. Upon
base-changing to Kv, the formal group law Fbecomes isomorphic to the additive group G2
a(see
§2.1,2.3).
Using a suitable isomorphism, we can mimic the complex theory and deﬁn e the sigma function σv
as the solution of a system of diﬀerential equations on the formal g roup2. All this can be made
explicit thanks to Grant’s description of formal group parameters T1andT2[Gra90], and the
formal power series σv(T):=σv(T1,T2) converges on a ﬁnite index subgroup HvofJ1(Kv), and
hence ofJ(Kv) (Proposition 3.4). When it exists, Blakestad’s is the unique v-adic sigma function
that is given as a power series in T1andT2withv-adically integral coeﬃcients.
The connection between the complex sigma function and real-valued N´ eron functions was proved
by Yoshitomi [ Yos98] (see also [ Uch11b] for a generalisation to arbitrary genus). By construction,
thev-adic sigma function σvsatisﬁes similar properties to the complex one; therefore, it can be
used to deﬁne a p-adic analogue of a N´ eron function: for P∈J(Kv)\Supp(Θ), we let
nvλv(P) =−2
m2·χv/parenleftbiggσv(T(mP))
φm(P)/parenrightbigg
,
wherem=k[J(Kv) :Hv] for some k∈ {1,2}andφmis them-th division polynomial (see
Deﬁnition 4.2).
A natural question that arises is how the global height hpand thep-adic N´ eron functions λv
compare to well-known global and local p-adic height theories that apply to Jacobians of curves in
general. We explore this question for the p-adic height pairing of Coleman–Gross [ CG89] (and its
extension to bad reduction due to Colmez [ Col98] and Besser [ Bes05,Bes22]); by [Bes04,Bes22],
this is equal to the p-adic height of Nekov´ aˇ r [ Nek93] if the curve has semistable reduction at every
prime above p.
The extended3Coleman–Gross height for Cis deﬁned in a crucially diﬀerent way from our hp. In
particular, the local part of the theory is given by pairings on degre e 0 divisors on Cwith disjoint
support, and it is deﬁned using Coleman–Colmez–Vologodsky integra tion onCat the places of
ramiﬁcation of χand arithmetic intersection theory at the other places.
Justforthisintroduction, wedenoteby /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htvtheextendedColeman–Grosslocalheightpairing
atv, evaluated on the pair of Kv-rational degree 0 divisors D1,D2with disjoint support. As is the
case forhp, the local pairings /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htvat the primes vof ramiﬁcation for χdepend on a choice
of isotropic subspace of H1
dR(C/Kv), complementary to H0(C/Kv,Ω1).
We prove that, provided that we make the same choices of subspac es at the primes of ramiﬁcation,
the global height hpis the same as the extended Coleman–Gross height for C(Corollary 5.35) and
that the local Coleman–Gross height pairing at any vis equal to a suitable linear combination of
pullbacks of λvtoC: see Corollary 5.32 for a precise statement. For the reader’s conv enience, we
state here a simpliﬁed version of the local and global comparison:
Theorem 1.1. LetP1,P2,Q1,Q2∈C(Kv)such thatQi/\e}atio\slash=Pjfor alli,j∈ {1,2}. Then there
exists a ﬁnite set of points S⊂C(Kv), such that for all R∈C(Kv)\S, we have:
/a\}⌊ra⌋ketle{tP1−P2,Q1−Q2/a\}⌊ra⌋ketri}htv=−nv
2/summationdisplay
1≤i,j≤2(−1)i+jλv(ι(Qi)−ι(Pj)−ι(R)).
Moreover,
/summationdisplay
v/a\}⌊ra⌋ketle{tP1−P2,Q1−Q2/a\}⌊ra⌋ketri}htv=1
2(hp([P1+Q1−P2−Q2])−hp([P1−P2])−hp([Q1−Q2])).
Remark 1.2. This is essentially a p-adic analogue of the real-valued theorem of Faltings [ Fal84]
and Hriljac [ Hri85] (specialised to the setting of a genus 2 odd degree hyperelliptic cur ve).
2This will not be surprising to the reader familiar with v-adic sigma functions on elliptic curves ( §1.1): see [ PR84,
Ber81,MT91].
3i.e. “extended to bad reduction”.4 FRANCESCA BIANCHI
In order to prove these comparison results, we take a detour into Colmez’s theory of p-adic integra-
tion on curves and symmetric p-adic Green functions of theta divisors on their Jacobians [ Col98],
which we apply to Cand to the divisor Θ on J. The link to the above problem is the following.
In the original paper of Coleman–Gross [ CG89], at a place vof ramiﬁcation for χ, the local height
paring/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htvis given by
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htv=tv/parenleftbigg/integraldisplay
D2ωD1/parenrightbigg
,
where the integral is a Kv-valued (Coleman [ Col82,Col85,CdS88]) integral of a diﬀerential on C,
andtv:Kv→Qpis a trace map. The trace map is uniquely determined by χ, and so is the branch
of thep-adic logarithm that the integral depends on (for certain choices o f divisors).
The dependency of v-adic integration on the branch of the p-adic logarithm is resolved in Colmez’s
theory (which, unlike Coleman’s, makes no assumption on the reduct ion) in a diﬀerent manner:
by viewing the value Log pof the logarithm at pas a variable. In fact, the Colmez integral of ωD1
takes values in L(Kv):=Kv⊕QLogp. With such a convention, Colmez gives a uniﬁed theory
of (extended) Coleman–Gross local height pairings: in terms of his in tegration theory, for any v
(including the unramiﬁed primes), we have
(1.1) /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htv=Tv/parenleftbigg/integraldisplay
D2ωD1/parenrightbigg
,
for some Q-linear map Tv:L(Kv)→Qpuniquely determined by χ. At an unramiﬁed prime
v|q, this trace map TvsatisﬁesTv(a+bLogq) =bχv(q). In other words, the intersection
multiplicity appearing in Coleman–Gross’s deﬁnition of /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htvat such a prime is replaced by
the coeﬃcient of Log qof av-adic integral, constructed analogously to the one appearing at th e
primes of ramiﬁcation for χ.
Moreover, Colmez constructs v-adic analogues of Green functions on abelian varieties. He shows
that the integral appearing in (1.1) can be expressed in terms of pu llbacks toCof a suitable
symmetric4v-adic Green function GΘassociated to the divisor Θ on J. The choice of GΘat a
ramiﬁed prime vdepends on Wv. We prove (see Theorem 5.30 for a more precise statement):
Theorem 1.3. There exists a symmetric v-adic Green function GΘof divisor Θsuch that
nvλv=−2Tv(GΘ).
Moreover, if χis ramiﬁed at vandλvcorresponds to the choice of Wv⊂H1
dR(C/Kv), so doesGΘ.
From this, Theorem 1.1 and the more general Corollaries 5.32 and 5.35 follow easily.
We now turn to the computational aspects of the paper (Section 6 ). OurSageMath [The22]
implementation is availableat [ Bia23]. In recent years, algorithmsfor p-adic heights have attracted
considerable interest due to their crucial role in explicit versions of t he Chabauty–Kim method
[Kim05,Kim09]fordeterminingrationalpointsoncurves: seeespeciallythegrou ndbreaking[ BD18]
and [BDM+19] on quadratic Chabauty. We therefore believe that an implementat ion of the local
p-adic N´ eron functions could have some applications beyond the one s that we already present in
this paper.
Given a subspace Wv, computing the v-adic sigma function associated to it requires working
explicitly with the formal group law of J. In particular, one needs to compute expansions of
functions in the formal group parameters and a formal group isom orphism of the base-change of
J1toK(orKv) with the formal additive group of dimension 2. All this can be achieve d essentially
by implementing the explicit results of [ Gra90].
For instance, we can compute a “naive” v-adic sigma function ( §3.1), a genus 2 analogue of
Bernardi’s sigma function for elliptic curves [ Ber81]. This sigma function is quite useful for com-
putational purposes, because its coeﬃcients as a series in T1,T2belong toKand are independent
of the prime v, which allows us to consider large primes.
However, if Jhas good ordinary reduction at all places vof ramiﬁcation of χ, there are instances
where one might want to instead compute Blakestad’s canonical v-adic sigma function. Indeed,
4In our case, “symmetric” is a synonym of “even” (cf. §5.4)p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 5
as mentioned above, we prove that Blakestad’s v-adic sigma function corresponds to the unit root
subspace of Frobenius, and by the comparison result with the exte nded Coleman–Gross height
(Corollary 5.35), the global height hpwith respect to this choice is related to a p-adic analogue
of the Birch and Swinnerton-Dyer conjecture [ BMS16]. In addition, in light of its integrality,
Blakestad’s v-adic sigma function has better convergence properties than any other and this might
make it a preferable choice in various computational situations. In §6.2 we discuss how we can
compute it when Kv∼=Qpusing Kedlaya’s algorithm [ Ked01].
The ﬁnal ingredients for the computation of p-adic N´ eron functions are division polynomials,
continuous idele class characters and the index [ J(Kv) :J1(Kv)]. For division polynomials, we
improve an implementation of de Jong–M¨ uller [ dJM14] (§6.3); for the characters we could use
[BBBM21 ] to address the general case (but have currently restricted th e implementation to the
cyclotomic character), and for the index we use work of Bruin–Sto ll [BS10] (see §6.4 for details).
To illustrate our implementation, we present two examples. In §6.5, we consider the curve C:y2=
x5−1 overQand we compute the canonical cyclotomic p-adic height of a non-torsion point in
J(Q), for the good ordinary prime p= 106+ 81. What allows us to consider such a large prime
and yet compute the canonical p-adic height (to p-adic precision 20, in approximately 15 seconds)
is that, in this case, we can ﬁnd the unit root subspace without appe aling to Kedlaya’s algorithm,
as a consequence of the fact that Chas extra automorphisms over Q(ζ5).
In§6.6, we consider a curve for which some computations of canonical C oleman–Gross heights
were carried out in [ BBM16]. We use our comparison results to replicate these computations us ing
p-adic N´ eron functions in place of Coleman integrals and intersection multiplicities.
The two examples that we have chosen to present are of curves ov erQthat have good ordinary
reduction at p. The good and ordinary assumptions can both (or either one) be re moved in our
implementation if we replacethe unit rootsubspace of Frobenius with any explicitly givenisotropic
complementary subspace. In forthcoming work with Kaya and M¨ ulle r [BKM23] we address the
problem of computing a canonical sigma function also in the semistable ordinary case. Finally,
the assumption that the curve is deﬁned over Qis also not essential for the algorithms (however,
if our choices require computing unit root eigenspaces of Frobenius using Kedlaya’s algorithm, we
need to assume that Kv∼=Qpat every prime vof ramiﬁcation of χ, due to current limitations in
theSageMath [The22] implementation).
Compared to other explicit approaches to p-adic heights, such as the algorithms of [ BB12,BMS16]
for Coleman–Gross heights, ours has the clear disadvantage that it assumes that Cis of genus 2.
On the other hand, we believe there are features that might make o ur approach preferable in the
genus 2 case. For example, its essential insensitivity to the reduct ion type at the primes v|p. This
is inherited from the N´ eron functions deﬁnition. Namely, the N´ ero n function at vis ﬁrst deﬁned
on the model-dependent kernel of reduction J1(Kv), and then extended to J(Kv) by combining
the facts that [ J(Kv) :J1(Kv)] is ﬁnite and that λvis “almost” a quadratic function (Proposition
4.7).
By Theorem 1.1 (and, more generally, Corollary 5.32), we can then co mpute local Coleman–Gross
heights for arbitrary reduction. In §6.7 we explain how, by replacing quasi-quadraticity with
a suitable transformation property under multiplication on J, we may also express integrals of
diﬀerentials of the ﬁrst and second kind on J(and hence on C, by pullback) in terms of integrals
onJ1(Kv). In summary, the same or similar techniques to the ones for height s can be applied to
compute integrals of diﬀerentials of the ﬁrst, second and third kind onC, without any assumptions
on the reduction.
The ﬁnal section (Section 7) is devoted to an elementary quadratic Chabauty-type criterion for the
rational points on certain genus 4 hyperelliptic curves that admit de gree two maps to two genus 2
curves (asC), each with a rank 2 Jacobian. See Proposition 7.6.
1.1.Elliptic curve analogues. Essentially all of the results of this paper admit an elliptic curve
analogue, which either already appears in the literature or could be d educed in a similar way
to the genus 2 case. The construction of the genus 2 naive sigma fu nction and the analysis of
its convergence properties that we present in §3.1 are based on the work of Bernardi for elliptic6 FRANCESCA BIANCHI
curves [Ber81]; Blakestad’s sigma function ( §3.2) is an analogue of the canonical sigma function of
Mazur–Tate [ MT91]. That the elliptic curve canonical sigma function for E/Kvis related to the
unit root eigenspace of H1
dR(E/Kv) follows from [ MT91, Proposition 3] and [ Kat73,Kat76] and is
used in the algorithms of Mazur–Stein–Tate [ MST06,§3.2] and Harvey [ Har08, Sections 3,4].
p-Adic heights on elliptic curves constructed using p-adic sigma functions are again subject of
[Ber81,MT91,MST06,Har08] and they are p-adic heights in the sense of [ MT83]. See also [ PR83,
PR84,Wut04]. Typically, such sigma functions are used to deﬁne a global p-adic height. The point
of view of decomposing this as a sum of local p-adic N´ eron functions with respect to the divisor
givenbytwice the point atinﬁnity is often not pursued. Perhapsthis isbecause the naturaldomain
of av-adic sigma function (for v|p) is a subgroup of the formal group. Therefore, if we are only
interested in values of the global p-adic height, it is more convenient to extend the latter using
quadraticity, rather than extending each local N´ eron function u sing formulae involving division
polynomials.
However, the point of view of p-adic N´ eron functions is natural because it is a direct analogue of
the real-valued setting (for which, see for instance [ Sil94, Chapter VI]), and it is convenient in the
context of the Chabauty–Kim method. It is thus taken in [ BDCKW18 ] at the primes away from
p, and in [ Bia20,§§2.A, 4.A] at all primes.
Direct analogues of the local comparison results of §5.4 are, to our knowledge, not explicitly stated
in the literature, but they could be derived in an analogous manner. S ome remarks are however in
order. A relation between Colmez Green functions and the work of M azur–Tate [ MT91] is hinted
by Colmez himself before [ Col98, Proposition II.2.20]. The equality of the global Coleman–Gross
and Mazur–Tate height is known, at least in the good ordinary reduc tion case [ Col91,Bes04] (see
also the introduction to [ BB15]). A diﬀerent kind of local comparison in the good ordinary case is
provided by [ BB15, Corollary 4.2].
1.2.Notation. Nincludes0. Givenanumberﬁeld Kandanon-archimedeanplace v, the notation
ordvis usedforthe v-adicvaluation on K×
v, normalisedsothat ord v(K×
v) =Z. Thev-adicabsolute
value|·|vonKvextends the standard ℓ-adic absolute value, if vlies aboveℓ. Various “logarithms”
appear in the paper. In order to help the reader overcome potent ial confusion, we compiled a list
here:
•We use the symbol log in logarithmic derivatives. That is, if fis a power series over some
ﬁeld andDis a diﬀerential operator, by D(log(f)) we meanDf
f. We also use log for the
real logarithm.
•Log and Logvare logarithms in the sense of Colmez (Section 5, Equation (5.1) and §5.3.1).
•logpis the branch of the p-adic logarithm vanishing at p(§6.4).
• L= (L1,...,Ln) is a formal group logarithm and, usually, the strict one (Deﬁnition 2 .6).
•Aone-logarithm of an abelian variety Xover ap-adic ﬁeldKis a locally analytic group
homomorphism X(K)→K(§5.1).
•Given a smooth, projective, geometrically irreducible curve Xover ap-adic ﬁeldKwith
JacobianJ, the logarithm Log ˜Jis the canonical homomorphism T(K)/Tℓ(K)→H1
dR(X)
from diﬀerentials of the third kind on Xmodulo logarithmic diﬀerentials to the ﬁrst de
Rham cohomology of X(Deﬁnition 5.13, Remark 5.15).
Acknowledgements. Firstand foremost, Iam extremelygratefulto Steﬀen M¨ ullerfor suggesting
that Blakestad’s work on p-adic sigma functions could be used in the context of heights, as well as
for helpful discussions and generous feedback at various stages of this project. I would also like to
thank Cliﬀord Blakestad for sharing insights about his work, Stevan Gajovi´ c for coming up with
Lemma A.3 and for helpful comments, Enis Kaya for useful feedbac k on an earlier draft and for
inspiring conversations on p-adic heights, and Remco Wouts for assistance with the computatio ns.
This work was supported by an NWO Vidi grant.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 7
2.Preliminaries
2.1.Formal group laws. In this subsection we recall some deﬁnitions and properties of form al
group laws. We are mainly interested in an explicit description of the iso morphisms of certain
formal group laws with the formal additive group of a suitable dimens ion: see Theorem 2.5,
Proposition 2.7 and Lemma 2.8 below. The main references are [ Fre93,Zin84,CF96]. In particular,
up to and including Deﬁnition 2.6 we follow [ Fre93] closely; Proposition 2.7 is then a stronger
version of results in [ CF96]; ﬁnally the discussion on invariant derivations is based on [ Zin84].
LetRbe a commutative ring with identity, let n∈Z≥1, letX= (x1,...,x n) and letR[[X]] be
the power series ring in x1,...,x noverR.
Deﬁnition 2.1. Aformal group law F(X,Y) of dimension noverRis ann-tuple of power series
Fi(X,Y)∈R[[X,Y]] such that
(i)F(X,Y) =X+Y+O(X,Y)2, whereO(X,Y)2means terms of total degree at least 2;
(ii)F(X,F(Y,Z)) =F(F(X,Y),Z).
The formal group law F(X,Y) is said to be commutative ifF(Y,X) =F(X,Y).
It followsfrom the formalgroupaxiomsthat there exists aunique formal inverse , that is ann-tuple
of power series i(X)∈R[[X]]nsuch thatF(X,i(X)) =F(i(X),X) = 0 andi(X) =−X+O(X)2.
Moreover,F(X,0) =F(0,X) =X.
Deﬁnition 2.2. Given formal group laws F(X,Y) andG(X,Y) of dimensions nandmoverR, a
formal group homomorphism α:F→Gis anm-tuple of power series αi(X)∈XR[[X]] such that
α(F(X,Y)) =G(α(X),α(Y)). The homomorphism αis anisomorphism if there exists a formal
group homomorphism β:G→Fsuch thatα(β(Y)) =Yandβ(α(X)) =X.
An example of a commutative formal group law of dimension nis the additive group Gn
a(X,Y) =
X+Y. IfRis aQ-algebra, any commutative formal group law of dimension noverRis isomorphic
toGn
a: see Theorem 2.5 below.
In order to describe the isomorphism explicitly, we ﬁrst recall the no tion of invariant diﬀerentials
on a commutative formal group law F(X,Y) of dimension nover an arbitrary commutative ring
Rwith identity.
We deﬁne the R[[X]]-module of diﬀerential 1-formsas Ω =/summationtextn
i=1R[[X]]dxi, and a corresponding
total derivative map d:R[[X]]→Ω,d(f) =/summationtextn
i=1∂f
∂xidxi. A diﬀerential in Ω is exactif it is in the
image ofd. Givenω=/summationtextn
i=1ϕi(X)dxi∈Ω, withϕi(X)∈R[[X]], we say that ωis(translation)
invariant if
ω(F(X,T)):=n/summationdisplay
i=1ϕi(F(X,T))dFi(X,T) =ω;
here indFi(X,T) we consider Tﬁxed and take partial derivatives with respect to X.
The deﬁnition ofthe formal grouplaw implies that the matrix/parenleftig
∂Fi
∂xj(0,X)/parenrightig
is invertible over R[[X]]
and we have:
Lemma 2.3. The diﬀerential ω=/summationtextn
i=1ϕi(X)dxi∈Ωis invariant if and only if
ω= (a1,...,a n)/parenleftbigg∂Fi
∂xj(0,X)/parenrightbigg−1
dx1
...
dxn

for some (a1,...,a n)∈Rn. In particular, the invariant diﬀerentials of F(X,Y)form anR-module
of rankn.
Proof.See for example [ Fre93, p.243]. /square
Lemma 2.4 ([ Hon70, Proposition 1.3, Lemma 1.4]). IfRis aQ-algebra and Fis a com-
mutative formal group law over R, then every invariant diﬀerential is exact.8 FRANCESCA BIANCHI
From these two lemmas, one deduces
Theorem 2.5. LetFbe a commutative formal group law over a Q-algebraRand letω1,...,ω n
be anR-basis for the invariant diﬀerentials of F. LetLi(X)∈R[[X]]be the unique power series
such that
dLi=ωi,Li(0) = 0.
ThenL= (L1,...,Ln):F→Gn
ais a formal group isomorphism. Conversely, any isomorphism
F→Gn
ais of this form.
Proof.For the ﬁrst statement see for example [ Fre93, Theorem 1]. For the second statement, if
α= (α1,...,α n):F→Gn
ais a homomorphism, then αi(F(X,Y)) =αi(X)+αi(Y), thusdαiis
an invariant diﬀerential. By [ Zin84, Lemma 1.4], αis an isomorphism if and only if the Jacobian
matrix/parenleftbig∂αi
∂xj(0)/parenrightbig
is invertible over R. By Lemma 2.3 this happens if and only if dα1,...,dα nis a
basis for the R-module of invariant diﬀerentials. /square
Deﬁnition 2.6. The isomorphism of Theorem 2.5 is called a logarithm ofF. Thestrict logarithm
is the logarithm corresponding to the basis ω1,...,ω nwhere, fork∈ {1,...,n},
ωk= (δik)/parenleftbigg∂Fi
∂xj(0,X)/parenrightbigg−1
dx1
...
dxn
.
Hereδikis the Kronecker delta. The inverse of a formal group logarithm is ca lled aformal group
exponential ; the inverse of the strict logarithm is the strict exponential .
By Theorem 2.5, if Ris an integral domain of characteristic 0 and Fis a commutative formal
group law over R, we can consider an isomorphism to the additive group of a suitable dim ension
upon base-changing to the fraction ﬁeld of R. For our intended applications, we would like to
understand what denominators can occur in the series expansions of the strict formal logarithm
and exponential.
Proposition 2.7. LetRbe a GCD domain of characteristic 0and letKbe its ﬁeld of fractions.
LetFbe a commutative formal group law over Rand letFKbe its base-change to K. Then the
strict logarithm L= (L1,...,Ln)and strict exponential E= (E1,...,En)ofFKare of the form:
Li=xi+/summationdisplay
j1,...,jn∈N
j1+···+jn≥2aj1,...,jn
gcd(j1,...,j n)xj1
1···xjn
n,whereaj1,...,jn∈R;
Ei=xi+/summationdisplay
j1,...,jn∈N
j1+···+jn≥2bj1,...,jn
j1!···jn!xj1
1···xjn
n, wherebj1,...,jn∈R.
Proof.WriteLi=/summationtextcj1,...,jnxj1
1···xjnnforcj1,...,jn∈K. For every k∈ {1,...,n}, we have
∂Li
∂xk∈R[[X]], so
jkcj1,...,jn∈R.
Ifcj1,...,jnis non-zero, writing cj1,...,jn=α
βfor coprime α,β∈R, we deduce that β|jkfor everyk
(by Euclid’s lemma for GCD domains) and so β|gcd(j1,...,j n). The claim on the leading term
follows from the fact that Lis the strict logarithm. For the coeﬃcients of Ei, see [CF96, p.68]. /square
LetFbe a commutative formal group law over a Q-algebraR. Theorem 2.5 characterises any
formal group isomorphism L:F→Gn
aby the choice of a basis for the R-module of invariant
diﬀerentials of F. We will now see that the inverse of Ladmits an explicit description in terms of
a suitable choice of basis of a related R-module: that of invariant derivations of F. Aderivation
is anR-linear map D:R[[X]]→R[[X]] such that D(fg) =gDf+fDg, and a derivation Dis
deﬁned to be invariant forFif
D(f(F(X,T))) = (Df)(F(X,T)) for all f∈R[[X]].p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 9
It follows from the deﬁnition that any derivation Dsatisﬁes
(2.1) D=n/summationdisplay
i=1Dxi·∂
∂xi;
thusDis invariant if and only if, for every j∈ {1,...,n}, we have
n/summationdisplay
i=1Dxi·∂Fj(X,T)
∂xi= (Dxj)(F(X,T)).
By [Zin84, Theorem 1.15], the invariant derivations form an R-module of rank n. Moreover,
denoting by Der R[[X]]invtheR-module of invariant derivations, and by ΩinvtheR-module of
invariant diﬀerentials, by [ Zin84, Theorem 1.19] there is a perfect pairing
(2.2) ( ·,·): DerR[[X]]inv×Ωinv→R,(D,gdf) =gDf.
In particular, if Lis the strict logarithm, the dual to dLiis
(2.3) Di=n/summationdisplay
j=1∂Fj
∂xi(0,X)∂
∂xj.
Lemma 2.8. LetRbe aQ-algebra,Fa commutative formal group law over R. LetL=
(L1,...,Ln)be a formal logarithm F→Gn
a, with inverse E:Gn
a→F. Suppose Lcorresponds
to the choice of basis for Ωinvdual to the basis (D1,...,D n)forDerR[[X]]inv. Then
∂f(E(T))
∂ti= (Dif)(E(T))for allf∈R[[X]].
Proof.Letγ(i)(ti) =E(T)|tj=0,j/ne}ationslash=i. Thenγ(i)deﬁnes a formal group homomorphism Ga→F.
Therefore, by [ Zin84, Theorem 1.26], the following formula deﬁnes an invariant derivation
(2.4) ( ˜Dixj)(X) =∂Fj(X,γ(i)(ti))
∂ti/vextendsingle/vextendsingle/vextendsingle/vextendsingle
ti=0=n/summationdisplay
ℓ=1∂Fj
∂yℓ(X,0)∂Eℓ
∂ti(T)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
T=0=∂Ej
∂xi(X)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
X=L(X)
(the last equality follows from diﬀerentiating E(X+Y) =F(E(X),E(Y)) with respect to Yand
evaluating at Y= 0 andX=L(X)). Therefore, for every k∈ {1,...,n},
(˜Di,ωk) =n/summationdisplay
j=1∂Lk
∂xj˜Dixj=∂Lk(E(X))
∂xi/vextendsingle/vextendsingle/vextendsingle/vextendsingle
X=L(X)=δik,
sinceL(E(X)) =E(L(X)) =X. This shows that ˜Di=Di. The lemma follows from (2.4) and
(2.1). /square
Remark 2.9. With the notation of Lemma 2.8 and its proof, we have, in particular, t hatγ(i)(ti)
is the integral curve of Di(cf. [Zin84, Theorems 1.23, 1.26]).
2.2.Jacobians of genus 2 curves: algebraically, analytically a nd projectively. LetCbe
a hyperelliptic curve of genus 2 over a ﬁeld Kof characteristic diﬀerent from 2, described explicitly
by the closure in the weighted projective space P1,3,1of a smooth aﬃne curve
(2.5) y2=x5+b1x4+b2x3+b3x2+b4x+b5, b i∈K.
IfKis either Cor an algebraically closed ﬁeld, any smooth, projective, geometrica lly irreducible
curve of genus 2 is birationally equivalent over Kto one in this form; for other ﬁelds K, this is
not the case; see for example [ CF96, Chapter 1].
There is a unique point on Cthat does not belong to the provided aﬃne patch; we will denote this
point by ∞. Given a point Pwe denote by P−the image of Punder the hyperelliptic involution,
which maps ( x,y) to (x,−y) and∞to itself. The (algebraic) Jacobian JofCis an abelian variety
of dimension 2 over KwhoseK-rational points are K-rational classes of degree zero divisors on10 FRANCESCA BIANCHI
Cmodulo linear equivalence. Every such class can be represented by a K-rational divisor of the
form
P1+P2−2∞,for someP1,P2∈C.
In fact, such a divisor is unique for every point in J(K)\{0}, whereas the zero class is represented
by
P+P−−2∞,for everyP∈C.
Therefore, there is a surjection from the symmetric square of C, denotedC(2), toJ, and we can
identifyJwithC(2)blown down at the origin (see for instance [ Mum07b , IIIa, §2] for the case
K=C). We also consider the Θ divisor of J, whose support is given by
Supp(Θ) = {[P−∞] :P∈C}.
While we are ultimately interested in working with Jacobians of curveso ver ﬁnite extensions of Qp,
for a prime p, it is instructive and useful for multiple reasons to ﬁrst review some of the complex
analytic theory. So assume now that K=C. Our main references are [ Gra90,Uch11b,Bak07,
Mum07a ,Mum07b ]. A basis for the space H0(C/C,Ω1) of holomorphic 1-forms on Cis given by
(2.6) ω1=dx
2y, ω 2=xdx
2y;
using the Hodge ﬁltration, we identify this with a 2-dimensional subsp ace of the ﬁrst algebraic de
Rham cohomology of C/C, which we denote by H1
dR(C/C). Under this identiﬁcation, we have
H1
dR(C/C)∼=H0(C/C,Ω1)⊕W0,
whereW0is the space spanned by the classes of the diﬀerentials of the secon d kind
(2.7) η1= (−3x3−2b1x2−b2x)dx
2y, η 2=−x2dx
2y.
The spaceW0is isotropic with respect to the algebraic cup product pairing; moreo ver, [η1] and [η2]
is a dual basis to [ ω1],[ω2], in the sense that [ ηi]∪[ωj] =δij, whereδijis the Kronecker delta, so
[ω1],[ω2],[−η1],[−η2] is a symplectic basis for H1
dR(C/C) with respect to the cup product pairing.
Analogously, we also pick a symplectic basis A1,A2,B1,B2forH1(C,Z) with respect to the inter-
section product of cycles. It is explained in [ Mum07b , IIIa, §5] how to do this using the fact that
Cis a double cover of P1.
We then deﬁne the period matrices
Ω = (Ω ij) =/parenleftbigg/integraldisplay
Ajωi/parenrightbigg
,Ω′= (Ω′
ij) =/parenleftbigg/integraldisplay
Bjωi/parenrightbigg
.
The matrix τ:= Ω−1Ω′is well-deﬁned, symmetric and its imaginary part is positive deﬁnite; i.e. τ
belongs to the Siegel upper half space of dimension 2. Let Λ = Ω Z2+Ω′Z2. The analytic Jacobian
ofCisC2/Λ. The isomorphism between the algebraic and analytic Jacobian is indu ced by the
integration map
(2.8) Φ: C(2)→C2/Λ,(P1,P2)/mapsto→/integraldisplayP1
∞(ω1,ω2)+/integraldisplayP2
∞(ω1,ω2) mod Λ.
Toτas above and any a,b∈Q2, we can attach a so-called theta function with characteristic :
θ/bracketleftbigg
a
b/bracketrightbigg
(z) =/summationdisplay
n∈Z2exp(πi(n+a)Tτ(n+a)+2πi(n+a)T(z+b)), z∈C2.
By [Mum07a , II, Proposition 1.1 and p.123], this is a holomorphic function on C2. Moreover, it is
quasi-periodic with respect to Ω−1Λ in the sense of [ Mum07a , p.123]: for every m∈Z2,
θ/bracketleftbigg
a
b/bracketrightbigg
(z+m) = exp(2πiaTm)·θ/bracketleftbigg
a
b/bracketrightbigg
(z) (2.9)
θ/bracketleftbigga
b/bracketrightbigg
(z+τm) = exp(−2πibTm−πimTτm−2πimTz)·θ/bracketleftbigga
b/bracketrightbigg
(z). (2.10)p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 11
From the quasi-periodicity (2.9)-(2.10) it is immediate that, writing z= (z1,z2), for every i,j∈
{1,2}, the following is a meromorphic function on C2/Λ:
(2.11)∂2
∂zi∂zjlog/parenleftbigg
θ/bracketleftbigga
b/bracketrightbigg
(Ω−1z)/parenrightbigg
.
Other meromorphic functions on C2/Λ arise in the same way if we replace θ/bracketleftbigga
b/bracketrightbigg
(z) with itself
multiplied by the exponential of a polynomial in z1,z2of degree at most 2. Amongst such choices
of polynomials and vectors a,b∈Q2there are some that are particularly useful.
First, when
a=δ:= (1/2,1/2) and b=δ′:= (1,1/2),
the theta function is odd [ Mum07a , II, Proposition 3.14] and vanishes to order 1 precisely on those
z∈C2such that Ω zmod Λ = Φ( P,∞) for someP∈C, that is, on the pullback of the (analytic)
theta divisor under C2→C2/Ω−1Λ∼− →C2/Λ. See [Mum07b , 3.80-3.85, 3.89].
Secondly, if we set
˜σ(z) = exp/parenleftbigg1
2zTHΩ−1z/parenrightbigg
θ/bracketleftbiggδ
δ′/bracketrightbigg
(Ω−1z),whereH= (Hij) =/parenleftbigg/integraldisplay
Ajηi/parenrightbigg
,
then the second logarithmic derivatives of ˜ σ, viewed as functions on C(2), can be described as
quotients of elements in Z[b1,...,b 5][x1,x2,y1,y2]; see [Bak07, p.38].
Finally, we deﬁne the hyperelliptic sigma function ofCto be
(2.12) σ(z) =c˜σ(z),
wherec∈C×is such that the Taylor expansion of σ(z) around 0 is of the form
σ(z) =z1+O(z1,z2)3.
With such a normalisation, the Taylor expansion has coeﬃcients in Q[bi] (see e.g. [ Uch11b, Propo-
sition 2.1]).
Fori,j,...,k ∈ {1,2}, let
(2.13) ℘ij···k(z) =−∂
∂zi∂
∂zj···∂
∂zklog(σ(z)) and ℘=℘11℘22−℘2
12.
It follows from above that ℘ij···kand℘are meromorphic functions on C2/Λ. On the image of Φ
these are expressible as rational functions dependent on the coe ﬃcients ofC, and these deﬁnitions
apply more generally when Cis replaced by any ﬁeld Kof characteristic diﬀerent from 2. For
example, if z= Φ((x1,y1),(x2,y2)), then
℘12(z) =−x1x2, ℘ 22(z) =x1+x2. (2.14)
See [Gra90, (1.4)] for the other ℘ijand for℘ijk.
Following Kanayama [ Kan05,Kan10] and Uchida [ Uch11b], we also introduce the following func-
tions on the Jacobian: for m≥1, them-th division polynomial is
(2.15) φm(z) =σ(mz)
σ(z)m2.
By [Uch11b, Theorem 5.8, Example 5.9], φm(z) is a polynomial in ℘ijand℘ijk(1≤i,j,k≤2)
with coeﬃcients in Z/bracketleftbig1
2,b1,...,b 5/bracketrightbig
and, conjecturally, in Z[b1,...,b 5] [Uch11b, Conjecture 4.14].
In particular, also division polynomials make sense over arbitrary ﬁeld s of characteristic diﬀerent
from 2, and given a curve over such a ﬁeld, we will view φmas a function on its Jacobian J,
satisfying
(2.16) div( φm) = [m]∗Θ−m2Θ.12 FRANCESCA BIANCHI
Other properties of division polynomials that we need are (cf. [ Uch11b, Proposition 4.9, Example
2.16]):
φmn(z) =φm(nz)φn(z)m2(2.17)
φm(u+v)φm(u−v)
φm(u)2φm(v)2=−℘11(mu)+℘11(mv)−℘12(mu)℘22(mu)+℘22(mu)℘12(mv)
(−℘11(u)+℘11(v)−℘12(u)℘22(v)+℘22(u)℘12(v))m2. (2.18)
The analytic theory that we have outlined is related to our goal of de ﬁningp-adic heights in
at least two ways. First, suppose that Kis a number ﬁeld and let vbe an archimedean place
ofK. Then the (unique up to an additive constant) real-valued N´ eron function at the place v,
associated with 2Θ, admits an explicit formula in terms of the hyperellip tic sigma function σ:
see [Yos98, Corollary 2.5]. Moreover, such a N´ eron function satisﬁes transf ormation properties
under scalar multiplication and addition on the Jacobian that can be de scribed using the division
polynomials and the functions ℘ij, respectively [ Uch11b, Theorem 7.5]. In Section 3, extending
work of Blakestad [ Bla18], we construct p-adic analogues of the genus 2 complex sigma function,
and in Section 4 we use these to deﬁne p-adic N´ eron functions.
Remark 2.10. Hyperelliptic sigma functions, division polynomials and their applications to real-
valued N´ eron functions all admit generalisations to hyperelliptic cur ves of arbitrary genus: see
[Uch11b]. For elliptic curves, see [ Sil94, Chapter VI].
The second application of the analytic theory that we are intereste d in is an explicit set of equa-
tions for the Jacobian as a variety in P8. This is worked out in [ Gra90]: for any ﬁeld Kof
characteristic diﬀerent from 2, [ Gra90, Corollary 2.15] provides a set of 13 homogeneous equa-
tions5inK[X0,X11,X12,X22,X111,X112,X122,X222,X], deﬁning in P8the Jacobian of a curve
described by an equation of the form (2.5) with coeﬃcients in the ﬁeld K. Under this embedding,
the identity of Jis mapped to
O= (0 : 0 : 0 : 0 : 1 : 0 : 0 : 0 : 0) .
In [Gra90, Theorem 3.3, §4] Grant also gives explicit formulae for the group law on Jwith respect
to this embedding in P8.
Note that the projective coordinates X0,Xij,Xijk,Xare related to the functions ℘ij,℘ijk,℘on
C(2)by
Xij
X0=℘ij,Xijk
X0=1
2℘ijk,X
X0=1
2(℘+b2℘12−b4); (2.19)
for notational convenience from now on we dehomogenise with resp ect toX0, i.e. we set
X0:= 1.
We end this subsection with a remark about invariant diﬀerentials and derivations on J. The com-
plex analytic isomorphism J∼− →C2/Λ is deﬁned using the basis (2.6) for the space of holomorphic
diﬀerentials on Cand the embedding ι:C ֒− →Jmapping ∞to the identity of J.
The diﬀerentials ω1,ω2of (2.6) are a basis for H0(C/K,Ω1) (that is, not only when K=C), and
the embedding ιinduces an isomorphism ι∗:H0(J/K,Ω1)→H0(C/K,Ω1) between the space of
holomorphic diﬀerentials on Jand onC. Holomorphic diﬀerentials on Jare translation-invariant,
and they correspond, by duality, to translation-invariant derivat ions.
Deﬁnition 2.11. For eachi∈ {1,2}, let Ω ibe the invariant diﬀerential on Jsatisfying
ι∗Ωi=ωi,
and let∂ibe the invariant derivation dual to Ω i.
5There is a typo in f10: the ﬁrst term should be X2
112, rather than X2
122.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 13
Lemma 2.12.
(1) The basis {Ω1,Ω2}forH0(J/K,Ω1)of Deﬁnition 2.11 is given explicitly by
Ω1=1
2(X111X122−X2
112)(X122·dX11−X112·dX12);
Ω2=1
2(X111X122−X2
112)(X111·dX12−X112·dX11).
(2) The dual invariant derivations ∂1and∂2satisfy
∂1(Xij) = 2X1ij, ∂ 2(Xij) = 2Xij2.
Proof.Part (2) is proved in [ Bla18, p.64], Part (1) then follows from this and an explicit compu-
tation. /square
2.3.Grant’s formal group law. Wenowapplythegeneraltheoryofformalgrouplawspresented
in§2.1tothesettingof §2.2. Inparticular,werecallGrant’sdescriptionofapairoflocalpar ameters
at the origin of a Jacobian as in §2.2 (over a suitable ﬁeld) and the induced formal group law.
Moreover, we relate the corresponding strict logarithm to the bas is of invariant diﬀerentials of
Deﬁnition 2.11. Finally, we consider a group associated to the formal group law.
LetRbe either the ring of integers of a number ﬁeld, or a ring of characte ristic 0, complete with
respect to a non-archimedean valuation. In both cases, let Kbe the fraction ﬁeld of R. As in
§2.2, we consider a hyperelliptic curve CoverKdeﬁned by an equation of the form (2.5), but we
further assume that b1,...,b 5∈R. We denote by Jthe projective variety in P8deﬁned in §2.2,
and we consider the following functions
(2.20) T1=−X11
X111, T 2=−X
X111.
Theorem 2.13 ([ Gra90, Theorem 4.2]). The functions1
X111=X0
X111,Xij
X111,Xijk
X111can be expanded
as formal power series in T1,T2with coeﬃcients in Z[b1,...,b 5].
In particular, we have
(2.21)1
X111=/summationdisplay
i,jαijTi
1Tj
2=T3
1/parenleftbigg
−1+/summationdisplay
i≥3
i+j>3αijTi−3
1Tj
2/parenrightbigg
X22
X111=/summationdisplay
i,jβijTi
1Tj
2=T1/parenleftbigg
−2T1T2+/summationdisplay
i≥1
i+j>3βijTi−1
1Tj
2/parenrightbigg
X12
X111=/summationdisplay
i,jγijTi
1Tj
2=T1/parenleftbigg
T2
2+/summationdisplay
i≥1
i+j>3γijTi−1
1Tj
2/parenrightbigg
,
whereαij,βij,γij∈Z[b1,...,b 5] can be found recursively as follows. Suppose we have computed
αrs,βrs,γrsfor allr,ssuch thatr+s<m. Then we can compute αij,βij,γijfor alli,jsuch that
i+j=musing the deﬁning equations of the projective variety J. A similar recursion allows one
to recover the following expansions:
(2.22)X112
X111=/summationdisplay
i,jδijTi
1Tj
2=−T2
2+/summationdisplay
i+j≥4δijTi
1Tj
2
X122
X111=/summationdisplay
i,jǫijTi
1Tj
2=T1T2+/summationdisplay
i+j≥4ǫijTi
1Tj
2
X222
X111=/summationdisplay
i,jζijTi
1Tj
2=−T2
1+/summationdisplay
i+j≥4ζijTi
1Tj
2,
for someδij,ǫij,ζij∈Z[b1,...,b 5].14 FRANCESCA BIANCHI
Remark 2.14. The functions
T1=−X11
X111,1
X111,X22
X111,X12
X111, T2=−X
X111
are all odd functions on J, while
X112
X111,X122
X111,X222
X111
are even. It follows that
αij=βij=γij= 0 for all i+j∈2Z;
δij=ǫij=ζij= 0 for all i+j∈1+2Z.
The group law on Jinduces a two-dimensional formal group law in T1,T2overR, as follows.
Given points u,v∈J, [Gra90, Theorem 3.3] expresses each of Xij(u+v),Xijk(u+v),X(u+v) as
a quotient of polynomials in Z[b1,...,b 5][Xij(u),Xij(v),Xijk(u),Xijk(v)].
LetT= (T1,T2) andS= (S1,S2) be the local parameters (2.20) for uandv, respectively. Then
one can express each of
F1(u,v) =−X11(u+v)
X111(u+v), F 2(u,v) =−X(u+v)
X111(u+v).
as elements in Frac( Z[b1,...,b 5][T1,T2,S1,S2]). To see this, you ﬁrst have to multiply each of the
numerator and denominators of Fi(u,v) by the same suitable rational function.
Theorem 2.15 ([ Gra90, Theorem 4.6]). For eachi∈ {1,2}, we have
Fi(T,S) =Ti+Si+O(T,S)2∈R[[T,S]].
ThereforeF(T,S) = (F1,F2)(T,S)is a commutative formal group law over R.
SinceT1andT2are odd functions on the Jacobian, the formal group inverse is
i(T) =−T;
therefore, for every i∈ {1,2}, we have that Fi(−T,−S) =−Fi(T,S), and hence the expansion of
Fionly contains terms of total odd degree.
Remark 2.16. Technically speaking the proof in [ Gra90, Theorem 4.6] assumes that Ris a ring
(of characteristic diﬀerent from 2), complete under a non-archim edean valuation. This assumption
ensures that the Jacobian over K= Frac(R) is an analytic group, and hence, locally, a formal
group over K. Then a version of Gauss’s lemma is used to prove that the formal gr oup law is
actually deﬁned over R. The proof still gives us the desired result when Ris the ring of integers
of a number ﬁeld, since if the quotient of two power series in R[[T,S]] is inKv[[T,S]] foranon-
archimedean place v, then it is in K[[T,S]], and if it is also in Rv[[T,S]] foreverynon-archimedean
placevofK, then it is in R[[T,S]].
It should also be possible to show that the group law is in fact deﬁned o verZ[b1,...,b 5]. However,
it is not immediately clear how to do this. For example, we could try to re -writeFi(T,S) asG
H
whereGandHare power series in ( T,S) with coeﬃcients in Z[b1,...,b 5], andH= 1+O(T,S).
It is worth mentioning, in this respect, the analogous situation for g enus 2 curves described by an
equationy2=f6x6+f5x5+f4x4+f3x3+f2x2+f1x+f0, considered by Flynn in [ Fly90,Fly93]. In
this case,in [ Fly90]Flynn describesanexplicitembeddingoftheJacobianin P15(in placeof P8), as
wellasaformalgrouplawoveraringthatis completewith respectto anon-archimedeanvaluation.
Like Grant, Flynn appeals to the analytic group structure of the Ja cobian overthe fraction ﬁeld for
the formal group law and to Gauss’s lemma. On the other hand, in the subsequent article [ Fly93],
he gives a more direct proof that the group law is in fact deﬁned over Z[f1,...,f 6] as a corollary
of an explicit description of the group law on the Jacobian by biquadra tic forms.
LetFbe the formal group law over Rof Theorem 2.15. By the general theory of §2.1, its
base-change to Kis isomorphic to the additive formal group of dimension 2. In particula r, let
L= (L1,L2) be the strict logarithm with respect to T1,T2, letE= (E1,E2) be its inverse, and letp-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 15
(D1,D2) be the basis of invariant derivations dual to ( dL1,dL2) (cf. Theorem 2.5, Deﬁnition 2.6
and (2.2)).
The expansions Ω 1(T) and Ω 2(T) inT1,T2of the invariant diﬀerentials Ω 1and Ω 2of Deﬁnition
2.11 are also invariant diﬀerentials for F.
Lemma 2.17. For eachi∈ {1,2}, we have
dLi(T) = Ωi(T).
Proof.It suﬃces to show that the invariant derivation dual to Ω i(T) isDi. Upon extending Dito
FracK[[T1,T2]] in such a way that it keeps satisfying the Leibniz rule, it is then suﬃcie nt, in view
of Lemma 2.12(2), to show that
αD1(X12)+βD2(X12)
isdiﬀerentfrom2 X112forall(α,β)/\e}atio\slash= (1,0)andthatitisdiﬀerent from2 X122forall(α,β)/\e}atio\slash= (0,1).
By (2.21) and (2.22), we have
X12=−T−2
1T2
2+O(T1,T2), X 112=T−3
1T2
2+O(1), X 122=−T−2
1T2+O(1);
for an integer i,O(T1,T2)imeans terms of total degree ≥i, where we are allowing negative
valuation: for example, T−1
1T3
2isO(T1,T2)2. Moreover, by (2.3),
/parenleftbigg
D1
D2/parenrightbigg
=/parenleftbigg
1+O(T1,T2)2O(T1,T2)2
O(T1,T2)21+O(T1,T2)2/parenrightbigg/parenleftbigg∂
∂T1∂
∂T2/parenrightbigg
.
Therefore,
D1(X12) = 2T−3
1T2
2+O(1), D 2(X12) =−2T−2
1T2+O(1),
which proves the lemma. /square
So far we have only been concerned with formal group laws. If Ris now a characteristic 0 ring,
complete under a non-archimedean absolute value |·|v, with maximal ideal m, we can consider a
groupF(m) associated to the formal group law of Theorem 2.15:
F(m) =m×m, t+s:=F(t,s),for allt= (t1,t2),s= (s1,s2)∈F(m).
Let˜Jbe the variety in P8obtained by reducing modulo mthe coeﬃcients of the equations deﬁning
JinP8; this may or may not be an abelian variety over the residue ﬁeld R/m. Nevertheless, we
have a reduction map ˜: J(K)→˜J(R/m). It follows from Theorem 2.13 and the deﬁnition of the
group law on F(m) that we have the following isomorphism of groups
(2.23) F(m)∼=J1(K):={u∈J(K) : ˜u=˜O}.
(see [Gra90, Corollary 4.5, Theorem 4.6]). Note that this deﬁnition is model-depen dent.
3.v-Adic sigma functions
3.1.The naive sigma function. In this subsection, we assume that our genus 2 curve Cis
deﬁned over a number ﬁeld K, with ring of integers O, and that all the coeﬃcients b1,...,b 5of
the deﬁning equation (2.5) for Clie inO.
Letρbe an embedding of KinCand letσ(z) be the hyperelliptic sigma function on C2(in the
sense of §2.2, (2.12)) associated to the curve over Cobtained from Cviaρ. In particular, σ(z) is an
odd function and it satisﬁes the diﬀerential equations (2.13). More over, it has a Taylor expansion
inz= (z1,z2) around 0 with coeﬃcients in Q[ρ(bi)].
The algebraicity of the coeﬃcients of the Taylor expansion around 0 of thecomplex sigma function
iswhatwewouldliketousetodeﬁnea v-adicsigmafunctionforanon-archimedeanplace v, thereby
extending to genus 2 Bernardi’s deﬁnition of a v-adic sigma function on elliptic curves [ Ber81]. We
will call such a v-adic sigma function naive, as it is constructed ad hoc from the complex one, and
to distinguish it from other v-adic sigma functions that we will consider in §3.2.
By§2.3, we have an explicit description of formal group parameters T1,T2and a resulting formal
grouplawFoverO. Considerthe base-changeto K, the strict logarithm L= (L1,L2) with respect
toT1,T2and its inverse E= (E1,E2), and let ( D1,D2) be the basis of invariant derivations dual16 FRANCESCA BIANCHI
to (dL1,dL2) (cf. Theorem 2.5, Deﬁnition 2.6 and (2.2)). We extend Dito FracK[[T1,T2]] in such
a way that it keeps satisfying the Leibniz rule, and for f(T)∈K[[T]], we deﬁne Di(log(f(T)))∈
FracK[[T1,T2]] so that Lemma 2.8 holds for log( f(T)).
We also consider the base-change of FtoCviaρ. By [Bos20,§10.9.3]6, there is a formal group
logarithm ˜L:FC→G2
awhose inverse ˜E:G2
a→FCextends to the surjective homomorphism
C2→Jinducing the inverse of Φ: J→C2/Λ (see (2.8)).
Lemma 3.1. The logarithm ˜Land exponential ˜Eare the base-change to CofLandE. Therefore,
Xij(E(z)) =℘ij(z), X ijk(E(z)) =℘ijk
2(z),
where℘ij(z)(resp.℘ijk(z)) is the quotient of series in z1,z2obtained from the Taylor expansion
ofσand(2.13).
Proof.This follows from the deﬁnition of Φ (2.8) and Lemma 2.17. /square
Let nowvbe a prime of Kabove a ﬁxed rational prime p, letKvbe the completion of Kwith
respect tov,Ovits ring of integers with unique maximal ideal mv. Let ord vbe the valuation on
Kvcorresponding to v. Recall from the end of §2.3 that there is a group isomorphism between
F(mv) (which, as a set, is mv×mv) and the group J1(Kv) of points reducing to Omodulomv. We
would like to use this to obtain a v-adic sigma function on J1(Kv), by substituting L(T) in the
Taylor series expansion of σ(z).
Similarly to the elliptic curve case [ Ber81], it will not always be possible to obtain a function on
the whole of J1(Kv): we need to understand how σ(L(T)) converges v-adically. We start with an
auxiliary lemma.
Lemma 3.2. Letf(T1,T2)∈ Ov[[T1,T2]]. Thenf(E(z))is of the form
f(E(z)) =/summationdisplay
i1,i2∈Nai1,i2
i1!i2!zi1
1zi2
2,whereai1,i2∈ Ov.
In particular, it converges for all zwithmini{ordv(zi)}>ordv(p)
p−1. Moreover, for such zwe have
min
i{ordv(Ei(z))}= min
i{ordv(zi)}.
Similarly, if mini{ordv(Ti)}>ordv(p)
p−1, then
min
i{ordv(Li(T))}= min
i{ordv(Ti)}.
Proof.The ﬁrst part follows from Proposition 2.7 and the fact that if j1,j2∈Nare such that
j1+j2=nthen ord v(j1!j2!)≤ordv(n!) by Legendre’s formula. For the same reasons, for the
second part it suﬃces to show that if min i{ordv(zi)}>ordv(p)
p−1andn≥2, then
(3.1) nmin
i{ordv(zi)}−ordv(n!)>min
i{ordv(zi)}.
Letsp(n) be the sum of the base pdigits ofn. Then
ordv(n!) =n−sp(n)
p−1ordv(p)≤n−1
p−1ordv(p),
so (3.1) follows. The proof for Liis identical. /square
Let [n]Tbe deﬁned inductively by [1] T=Tand forn≥2, [n]T=F([n−1]T,T) and letφn(T)
be the expansion in Tof then-th division polynomial (see (2.15) and surrounding paragraph).
Theorem 3.3. Letσ(z) =z1+O(z1,z2)3∈K[[z1,z2]]be the Taylor expansion around 0of the
complex sigma function, and let
σ(0)
v(T):=σ(L(T))∈K[[T]].
6Technically speaking this reference is for elliptic curves , but as stated by the author the results “actually admit
straightforward generalizations concerning commutative algebraic groups over (local) ﬁelds of characteristic zero ”.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 17
(i)σ(0)
v(T)satisﬁes the system of diﬀerential equations
DiDjlog(σ(0)
v(T)) =−Xij(T),for alli,j∈ {1,2}(whereX21:=X12).
(ii)σ(0)
v(T)converges for all T= (T1,T2)∈K2
vsatisfying mini{ordv(Ti)}>ordv(p)
p−1.
(iii) When all terms are deﬁned, we have
σ(0)
v(F(T,S))σ(0)
v(F(T,−S))
σ(0)
v(T)2σ(0)
v(S)2=−X11(T)+X11(S)−X12(T)X22(S)+X22(T)X12(S);
σ(0)
v([n]T)
σ(0)
v(T)n2=φn(T).
Proof.By Lemma 2.8, we have
(DiDjlog(σ(0)
v(T)))(E(z)) =∂2
∂zi∂zjlog(σ(0)
v(E(z))) =∂2
∂zi∂zjlog(σ(z)) =−℘ij(z),
which gives (i) by Lemma 3.1.
Since the divisor of σis the preimage of Θ under C2→J, sinceT1representsΘ in a neighbourhood
of the origin [ Bla18, Lemma 32] and since σ(z) =z1+O(z1,z2)3, we have
σ(z) =E1(z)u(z),for someu(z) = 1+O(z1,z2)∈K[[z1,z2]].
Combining with (i) and the fact that σis an odd function, we get that
σ(0)
v(T) =T1uv(T),
whereuv(T) = 1+O(T1,T2)2∈K[[T1,T2]] satisﬁes
DiDjlog(uv(T)) =−Xij(T)−DiDjlog(T1).
Since the left hand side of this equation is a power series, so is the righ t hand side. Moreover, the
latter is easily seen to have coeﬃcients in O. Evaluating at E(z) and using Lemma 3.2, we see that
∂2
∂zi∂zjlog(u(z)) =/summationdisplay
i1+i2≥0ai1,i2
i1!i2!zi1
1zi2
2,for someai1,i2∈ Ov.
By properties of integration, the series log( u(z)) has the same form and since the leading term of
uv(T) is 1, it has vanishing constant term. Thus, if zi=Li(T) with min i{ordv(Ti)}>ordv(p)
p−1, then
ordv(log(u(z)))≥mini{ordv(zi)}>ordv(p)
p−1, so log(u(z)) is in the domain of the p-adic exponential
(cf.Lemma3.2). Applying[ Mat55,§2SubstitutionTheorem],weﬁndthat u(z)convergeswhenever
mini{ordv(zi)}>ordv(p)
p−1. Henceσ(z) converges there too, which is statement (ii).
The identities stated in part (iii) follow from the identities satisﬁed by t he complex sigma function
((2.15) and [ Uch11b, Example 2.16]). /square
3.2.Inﬁnitely many sigma functions and Blakestad’s canonical o ne.Retain the notation
of§3.1. For 1 ≤i,j≤2, letcij∈Kvwithc12=c21and letc= (cij)i,j. Then the system
DiDj(log(σ(c)
v(T))) =−Xij(T)+cij,for all 1≤i,j≤2,
has a unique odd solution σ(c)
v(T)∈Kv[[T]] of the form T1(1 +O(T1,T2)): ifc= 0, the zero
matrix, then σ(0)
v=σ(c)
vis the naive sigma function that we studied in §3.1; in general, we have
(3.2) σ(c)
v(T) =σ(0)
v(T)exp/parenleftbigg1
2/summationdisplay
1≤i,j≤2cijLi(T)Lj(T)/parenrightbigg
.
See Appendix C for the terms up to total degree at most 8 of the fo rmal power series σ(c)
v(T).
Proposition 3.4.
(i) The formal power series σ(c)
v(T)∈Kv[[T1,T2]]induces a function on a ﬁnite index subgroup
HvofJ(Kv).18 FRANCESCA BIANCHI
(ii) ForP∈Hv,σ(c)
v(T(P))vanishes if and only if T1(P) = 0, i.e. it vanishes only on the
theta divisor and there it vanishes to order 1.
(iii) When all terms are deﬁned, we have
σ(c)
v(F(T,S))σ(c)
v(F(T,−S))
σ(c)
v(T)2σ(c)
v(S)2=−X11(T)+X11(S)−X12(T)X22(S)+X22(T)X12(S);
σ(c)
v([n]T)
σ(c)
v(T)n2=φn(T).
Proof.
(i) The same argument as in [ CF96, Chapter 7, §5] (see also [ Mat55, III, §6]) shows that
J1(Kv) has ﬁnite index in J(Kv) (without any assumption on the reduction), and that for
every positive integer n,F(mn
v) has ﬁnite index in F(mv)∼=J1(Kv). Therefore, it suﬃces
to show that there exists n∈Z>0such thatσ(c)
v(T) converges for all T∈mn
v×mn
v. By
Theorem 3.3, there exists n1∈Z>0such thatσ(0)
vconverges on F(mn1v). By Lemma 3.2,
there exists n2∈Z>0such that exp/parenleftbigg
1
2/summationtext
1≤i,j≤2cijLi(T)Lj(T)/parenrightbigg
converges on F(mn2v).
The conclusion follows for n= max{n1,n2}by [Mat55,§2 Multiplication Theorem].
(ii) We have σ(c)
v(T) =T1·exp(f(c)(T)) for some formal power series f(c)(T). Moreover, we
deﬁnedHvin such a way that f(c)(T) and exp(f(c)(T)) converge on Hv. Therefore, the
only zeros are at T1= 0.
(iii) This follows from Theorem 3.3(iii), Equation (3.2), and the fact tha tLi:F→Gais a
homomorphism.
/square
In other words, for any 2 ×2 symmetric matrix coverKvwe obtain a v-adically valued function on
someﬁnite index subgroupof J(Kv) satisfyingpropertiesanalogousto the complexsigmafunction.
Given such a c, we also deﬁne the subspace W(c)ofH1
dR(C/Kv) to be the space generated by the
classes of the following diﬀerentials (compare with (2.7)):
(3.3)η(c)
1= (−3x3−2b1x2−b2x+c12x+c11)dx
2y,
η(c)
2= (−x2+c22x+c12)dx
2y.
Proposition 3.5. The map
c= (cij)/mapsto→W(c)
gives a bijection between the set of 2×2symmetric matrices over Kvand the set Is(C/Kv)of
subspaces of H1
dR(C/Kv)that are complementary to H0(C/Kv,Ω1)and isotropic with respect to
the cup product. Moreover, [ω1],[ω2],[−η(c)
1],[−η(c)
2]is a symplectic basis for H1
dR(C/Kv).
Proof.It is well-known that/braceleftig
[ω1],[ω2],/bracketleftig
xidx
2y/bracketrightig
:i= 2,3/bracerightig
is a basis for H1
dR(C/Kv) and that
H0(C/Kv,Ω1)⊂H1
dR(C/Kv)isgeneratedby[ ω1]and[ω2]. Therefore,thespacegeneratedby[ η(c)
1]
and[η(c)
2]is complementarytothespaceofholomorphicformsand asimple com putationofresidues
at inﬁnity shows that it is isotropic with respect to the cup product, and that [ωi]∪[−η(c)
j] =δij.
On the other hand, if W∈Is(C/Kv) and [ξ1],[ξ2] is a basis for Wsuch that [ωi]∪[−ξj] =δij,
then we must have
[ξi] = [η(0)
i]+2/summationdisplay
j=1bij[ωj]
for some symmetric matrix ( bij). /squarep-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 19
Blakestad [ Bla18] does not consider the inﬁnitely many v-adic sigma functions deﬁned by (3.2);
he considers just one, which is, however, arguably more interestin g than the others. Translated to
our setting, his results may be phrased as follows.
Theorem 3.6 ([ Bla18, Propositions 34, 27, Corollary 377]).Letp≥5and suppose that C
has good reduction at v|pand thatJhas good ordinary reduction at v. Then
(i) There exists a unique v-adic sigma function σ(c)
v(T)withv-adically integral coeﬃcients.
Letbbe the corresponding symmetric matrix.
(ii) The diﬀerentials η(b)
iare uniquely determined by the property that the expansion/integraltext
η(b)
iin
the local parameter t=−x2
yat∞has coeﬃcients in Ov.
(iii) The matrix bhas coeﬃcients in Ovand can be computed modulo pnfrom explicit expansions
int=−x2
yof suitable functions in the Riemann–Roch spaces of pn∞and3pn∞.
Remark 3.7. Some remarks on our phrasing of Blakestad’s results are in order. F irst, Theorem
3.6(ii) and(iii) assumetheinvertibilityovertheresidueﬁeld ofa2 ×2matrixH1, deﬁnedon[ Bla18,
p.54]. Blakestad mentions at the beginning of §4.2 ofloc. cit.that this condition is related to the
ordinarity of J. More precisely, we prove in [ BKM23] that if the equation for Chas semistable
reduction, then Jis semistable ordinary if and only if H1is invertible.
Secondly, Blakestad allows for p= 3. However, in this case, the construction in §3.2.1 needs to be
slightly modiﬁed, for example by deﬁning φnandψnon p.52 for n≥2, instead of n≥1. Then the
condition on invertibility of H1could be replaced by invertibility of H2. For simplicity, we stated
Theorem 3.6 for p≥5.
We next want to show that the subspace W(b)⊂H1
dR(C/Kv) corresponding to Blakestad’s v-
adic sigma function is the unit root subspace of Frobenius (deﬁned b elow). We achieve this by
comparing the property of Theorem 3.6(ii) with the characterisatio n of the unit root subspace
provided by [ Kat81, Corollary 5.9.6(1)]. We have found the article [ vdB08] a very useful reference
for both theoretical and explicit results on various cohomological t heories and we refer the reader
to it for details.
Retain the assumptions of Theorem 3.6 and assume that Kvis an unramiﬁed extension of Qp.
The equation deﬁning Calso deﬁnes the aﬃne part of a hyperelliptic curve over Ov, which we
will denote by C/Ov; denote by H1
dR(C/Ov) the ﬁrst cohomology of C/Ov. By [Ber74], there is
a canonical isomorphism H1
dR(C/Ov)∼− →H1
cris(˜C/Ov), where ˜Cdenotes the special ﬁbre of C/Ov
andH1
cris(˜C/Ov) is its ﬁrst crystalline cohomology. This isomorphism equips H1
dR(C/Ov) with an
Ov-linear endomorphism of Frobenius. From the isomorphism [ vdB08, Proposition 2.2]
H1
dR(C/Ov)⊗OvKv∼− →H1
dR(C/Kv),
we also obtain a Kv-linear Frobenius endomorphism on the Kv-vector space H1
dR(C/Kv). The
unit root eigenspace of Frobenius is the slope 0 subspace of H1
dR(C/Kv) for the Frobenius action.
Since we are assuming that Jhas ordinary reduction at v, this space has dimension equal to the
dimension of J, that is to 2 [ Yui78, Theorem 3.1].
LetPbe an arbitrary point in C(Ov). LetˆCPbe the formal completion of C/OvalongP. Then
(ˆCP,P) is a pointed Lie variety of dimension 1 over Ov[Kat81,§§5.1, 5.9]. Let tbe a coordinate for
it. The ﬁrst de Rham cohomology H1
dR(ˆCP/Ov) is theOv-module of (closed) diﬀerential one-forms
inOv[[t]]dtmodulo the exact one-forms [ Kat81,§5.1]. Since any closed diﬀerential form becomes
exact upon base-changing to Kv, applyingdgives an isomorphism of Ov-modules:
(3.4) MP:={f∈Kv[[t]] :f(0) = 0 and df∈ Ov[[t]]dt}
{f∈ Ov[[t]] :f(0) = 0}∼− →H1
dR(ˆCP/Ov).
(this is a special case of [ Kat81, Lemma 5.1.2]).
7Corollary 37 of loc. cit. contains some typos. The correct formulae for c11andc12are:c11= 2b1b2−b1α+b2
1β+
3δ−3b1γ+3b3,c12=b2+α−b1β.20 FRANCESCA BIANCHI
By [Kat81, Corollary 5.9.6], the unit root eigenspace of Frobenius is the subspa ce ofH1
dR(C/Kv)
obtained by tensoring with Kvthe kernel of the formal-expansion-at- Pmap
(3.5) βP:H1
dR(C/Ov)→H1
dR(ˆCP/Ov).
We use the superscript−to indicate ( −1)-eigenspaces for the action of the hyperelliptic involu-
tion. Recall that we can regard η(b)
1andη(b)
2as elements of H1
dR(C/Kv) by using the following
isomorphism of Kv-vector spaces
(3.6) H1
dR(C/Kv)∼=H0(C/Kv,Ω1
C/Kv(4∞))−;
see, for instance, [ vdB08,§5].
Proposition 3.8. Suppose that the assumptions of Theorem 3.6 are satisﬁed, an d thatKvis an
unramiﬁed extension of Qp. Then the diﬀerentials η(b)
1andη(b)
2span the unit root eigenspace of
Frobenius in H1
dR(C/Kv).
Proof.By abuse of notation, we write ∞also for the section at inﬁnity of C/Ov. By [vdB08,
Proposition 3.2], the Ov-moduleH1
dR(C/Ov) is a lattice in H1
dR(C/Kv), which, in view of the
assumption that p≥5 and the genus is 2, we can identify by [ vdB08, (3.9), Theorem 4.2(ii)], with
H0(C,Ω1
C/Ov(4∞))−֒− →H0(C/Kv,Ω1
C/Kv(4∞))−, under (3.6). By [ vdB08, Proposition 5.2], the
Ov-moduleH0(C,Ω1
C/Ov(4∞))−is free and spanned by xidx
2yfor 0≤i≤3.
The parameter t=−x2
yis a coordinate for ( ˆC∞,∞). LetM∞be as in (3.4) with respect to t. The
assumption that p≥5 also implies that there is an isomorphism of Ov-modules
(3.7)M∞,(4∞):={f=/summationtext∞
n=−3antn∈t−3Kv[[t]] :a0= 0 anddf∈ Ov((t))dt}
{f=/summationtext∞
n=−3antn∈t−3Ov[[t]] :a0= 0}∼− →M∞
∞/summationdisplay
n=−3antn/mapsto→∞/summationdisplay
n=0antn.
We obtain a map
(3.8)H1
dR(C/Ov)∼− →H0(C,Ω1
C/Ov(4∞))−α∞− − →M∞,(4∞)∼− →M∞∼− →H1
dR(ˆC∞/Ov),
whereα∞is the formal-expansion-in- tmap followed by formal integration. The diﬀerentials η(b)
1
andη(b)
2belong to the kernel of α∞. LetC′be the aﬃne curve over Ovobtained from Cby deho-
mogenising with respect to x. Then the composition (3.8) agrees with composing the restriction
mapH1
dR(C/Ov)→H1
dR(C′/Ov) with the expansion in t-mapH1
dR(C′/Ov)→H1
dR(ˆC∞/Ov), and
hence with β∞. Comparing dimensions, we obtain the proposition. /square
Corollary 3.9. Under the assumptions of Proposition 3.8, let P∈C(Ov)andtbe a coordinate
for(ˆCP,P). Then the expansions of the formal integrals/integraltext
η(b)
1(t)and/integraltext
η(b)
2(t)have coeﬃcients in
Ov.
Remark 3.10. We will refer to the v-adic sigma function of Theorem 3.6 as the canonicalv-adic
sigma function . There are two reasons why we care about Proposition 3.8. The ﬁrs t one is that it
makes the computation of the canonical v-adic sigma function a lot more eﬃcient (at least when
Kv∼=Qp), since we can compute the unit root subspace using Kedlaya’s algor ithm: see §6.2 for
details. Secondly, in the following section, we will use v-adic sigma functions to deﬁne a p-adic
height onJ(Q). Now, there are other p-adic height constructions in the literature that depend
on a choice of space Wv∈Is(C/Kv), at every v|p. For example, the p-adic height of Coleman–
Gross [CG89]. In this case, the unit root eigenspace of Frobenius is the “canonic al” choice of
subspace and the corresponding height appears in a p-adic analogue of the Birch and Swinnerton-
Dyer conjecture [ BMS16]. In Section 5, we compare our p-adic height deﬁned in terms of sigma
functions with the p-adic height of Coleman–Gross. In light of Proposition 3.8, the compa rison
restricts to a comparison between the canonical heights. See also Remark 5.36.
On the other hand, there are situations where it is preferable to co nsider the naive v-adic sigma
function. Indeed, unlike the canonical v-adic sigma function, the naive one does not require anyp-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 21
assumption on the reduction of CandJatv. Furthermore, it is easier to compute. Finally,
its tight link with the complex genus 2 sigma function makes it useful in p roofs, as a lot of its
properties follow formally from the properties of the complex sigma f unction.
Remark 3.11. In analogywith the elliptic curvesituation[ Ber81], we couldaskif the matrix bhas
algebraic entries, independent of pandv, in the special case where Jhas complex multiplication.
See [BK10, Propositions 2.1, 2.14] for results in this direction. Indeed, under the assumptions of
loc. cit., letq(z) be the unique quadratic form such that θ(z) =σ(z)e2πiq(z)is a normalised theta
function in the sense of [ Lan82, p.87]. Then, by [ BK10, Proposition 2.1], the coeﬃcients of the
Taylor expansion of θ(z) around 0 are algebraic. But since σ(z) also has algebraic coeﬃcients,
it follows that 2 πiq(z) =1
2/summationtext
1≤i,j≤2cijzizjwithc12=c21and algebraic cij. Finally by [ BK10,
Proposition 2.14], the coeﬃcients of θ(L(T)) are integral. See §6.5 for an explicit example.
4.p-adic heights
We keep the notation of Section 3: Kis a number ﬁeld and the coeﬃcients of the deﬁning equation
forClie in its ring of integers. Fix a prime number pand a continuous idele class character
χ=/summationdisplay
vχv:A×
K/K×→Qp.
By continuity, χvis identically zero if vis an archimedean place, and χvis identically zero on O×
v
ifvis a non-archimedean place not dividing p. See [BBBM21 ,§2.1] for more properties and for a
discussion on how to construct the ﬁnite-dimensional Qp-vector space of all such χ, for a given K.
IfLis a ﬁnite extension of K, we denote by χLthe continuous idele class character for Lobtained
by composing χwith the idele norm NL/K:A×
L→A×
K. Note that, if wis a place of Labove the
placevofKandx∈K×
v, thenχL,w(x) = [Lw:Kv]χv(x).
LetJΘ:=J\Supp(Θ). The goal of this section is to deﬁne a quadratic form
hp:J(Q)→Qp,
dependent on χ. We will do so in the following way. Suppose that Pis a point in JΘ(L), for some
ﬁnite extension LofK. Given a non-archimedean place wofL, denote by nwthe degree of the
ﬁeld extension Lw/Qℓ, whereℓis the rational prime below w. Then
hp(P) =1
[L:Q]/summationdisplay
wnwλw(P),
where the sum runs over all the non-archimedeanplaces wofLandλw:JΘ(Lw)→Qpis a “quasi–
quadratic” function, dependent on χL,w, which we call a p-adic N´ eron function at wwith respect
to 2Θ. The reason for this terminology will be explained in [ BKM23]; see also Remark 4.6 below.
Before embarking on deﬁning p-adic N´ eron function, we state a useful lemma. See also Appendix
A for more general, related, results.
Lemma 4.1. LetP∈J(Lw)be a non-torsion point and let Hbe a ﬁnite index subgroup of J(Lw).
Then there exists a positive integer msuch thatmP∈H\Supp(Θ) .
Proof.SinceHhas ﬁnite index in J(Lw) andPis non-torsion, there exists m′such thatQ:=
m′P∈H\{0}. IfQ∈Supp(Θ), then Q= [Q1− ∞] for a non-Weierstrass point Q1∈C(Lw).
Thus, 2Q= [2Q1−2∞]∈H\Supp(Θ). /square
Ifvis a place of Klying above p, andw|v, thep-adic N´ eron function λwwill be deﬁned in terms
of av-adic sigma function from §3.2. Recall from Proposition 3.5 that the set of v-adic sigma
functions is in bijection with the set Is( C/Kv). We thus ﬁx, once and for all, a choice of subspace
Wv∈Is(C/Kv), at everyv|p.22 FRANCESCA BIANCHI
4.1.p-adic N´ eron functions. LetLbe a ﬁnite extension of K, letvbe a place of Kand letw
be a place of Labovev.
Assume ﬁrst that v|p. Our choice of subspace Wvinduces a choice of v-adic sigma function σv.
By Proposition 3.4, σvconverges on a subgroup Hv, dependent on Wv, of ﬁnite index in J(Kv).
Clearly it also converges on a ﬁnite index subgroup HwofJ(Lw).
Deﬁnition 4.2. The(local)p-adic N´ eron function at w|v|p, with respect to the divisor 2Θ, the
characterχand the subspace Wv, is the function
λw:JΘ(Lw)→Qp,
deﬁned as follows. If P∈JΘ(Lw) is a non-torsion point and mis a positive integer such that
mP∈Hw\Supp(Θ), then
λw(P) =−2
nwm2·χL,w/parenleftbiggσv(T(mP))
φm(P)/parenrightbigg
;
we may extend the deﬁnition of λwto torsion-points in JΘ(Lw) by continuity.
By Lemma 4.1, an integer msatisfying the conditions of Deﬁnition 4.2 always exists, and by
Proposition 3.4(iii) and Equation (2.17), the deﬁnition of λwis independent of the choice of m.
Moreover, by Proposition 3.4(ii) and by Equation (2.16), σv◦T◦mandφmhave the same zeros
onJΘ. This is what allows to extend to torsion-points.
Assume now that v∤p. As the name suggests, we are looking for a Qp-valued analogue of a
classical real-valued N´ eron function of divisor 2Θ on JΘ(Lw) (in the sense of [ Lan83, Chapter
11], [HS00,§B.9], [Uch11b,§7], and in particular [ Uch11a] for the genus 2 case). In this case (i.e.
whenw∤p), it is possible to construct such a p-adic function starting from a suitable real-valued
one, just by replacing a real-valued continuous homomorphism L×
w→RwithχL,w. We refer
to [BKM23] for details.
We take a slightly diﬀerent approach here. Denote by J1,w(Lw) the model-dependent kernel of
reduction for JoverLw(as in (2.23)).
Lemma 4.3. ForP∈J1,w(Lw)\Supp(Θ) , letλw(P) =−2
nwχL,w(T1(P)). Then
(4.1) λw(P) =−1
nwχL,w(max
i,j{|Xij(P)|w,1}).
Proof.For suchP,
χL,w(T1(P)) =χL,w(|T1(P)|−1
w) =1
2χL,w(max
i,j{|Xij(P)|w,1}),
(cf. the expansions (2.21)). /square
Corollary 4.4. Letλw:J1,w(Lw)\Supp(Θ) →Qpas in Lemma 4.3. Then
(i) for all integers msuch thatmP/\e}atio\slash∈Supp(Θ) ,
λw(mP) =m2λw(P)−2
nwχL,w(φ|m|(P)).
(ii) for all P,Q∈J1,w(Lw)\Supp(Θ) such thatP+Q,P−Q/\e}atio\slash∈Supp(Θ) ,
λw(P+Q)+λw(P−Q) = 2λw(P)+2λw(Q)
−2
nwχL,w(−X11(P)+X11(Q)−X12(P)X22(Q)+X22(P)X12(Q)).
Proof.The equality of Lemma 4.3 implies this, in view of [ Sto02, Theorem 4.1] (see also [ Uch11a,
Corollary 7.2]), [ dJM14, Proposition 6.2] and [ Uch11b, Theorem 7.5]. /squarep-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 23
Deﬁnition 4.5. The(local)p-adic N´ eron function at w|v∤p, with respect to the divisor 2Θ and
the character χ, is the function
λw:JΘ(Lw)→Qp,
deﬁned as follows. If P∈JΘ(Lw) is a non-torsion point and mis a positive integer such that
mP∈J1,w(Lw)\Supp(Θ), then
(4.2) λw(P) =−2
nwm2·χL,w/parenleftbiggT1(mP)
φm(P)/parenrightbigg
;
we may extend the deﬁnition of λwto torsion-points in JΘ(Lw) by continuity.
Similarly to Deﬁnition 4.2, also in this case Lemma 4.1 guarantees the exis tence ofmand the
extension to torsion points is meaningful. By Corollary 4.4 and Equatio n (2.17), the deﬁnition is
independent of m.
Remark 4.6.
(i) For allP∈JΘ(Lw), we havenwλw(P)
χL,w(ℓ)=:λ′
w(P)∈Q, whereℓis the rational prime below
w. In fact, the real-valued N´ eron function of divisor 2Θ of [ Uch11a] atPisλ′
w(P)log|ℓ|w,
where log is the real logarithm.
(ii) IfChas good reduction at w, the equality of Lemma 4.3 holds for all P∈JΘ(Lw), since
in this case the right hand side of (4.1) deﬁnes a function satisfying C orollary 4.4 on the
whole ofJΘ(Lw) (cf. [FS97, Lemma 1] for the case K=L=Qand [Sto02, Proposition
5.2] for the general case; see also Section 7 and, in particular, The orem 7.1).
(iii) Equivalently, we could have used Deﬁnition 4.2 to deﬁne the local p-adic N´ eron function
also in the case v∤p, sinceχL,wvanishes on O×
wandσv(T) =T1(1 +O(T1,T2)). We
preferred stating the simpliﬁed formula, which does not involve the c hoice of a subspace
Wv. Conversely, if v|pandχis unramiﬁed at v, Deﬁnition 4.2 simpliﬁes to Deﬁnition 4.5.
We now state the properties satisﬁed by our local p-adic N´ eronfunction at w, regardlessof whether
wdivides or does not divide p. These are completely analogous to the properties of the real-valu ed
N´ eron function: see [ Uch11a, Theorem 5.3, Theorem 5.6] for the genus 2 case, and [ Uch11b,
Theorem 7.5] for arbitrary genus (in the latter, the N´ eron funct ion is with respect to Θ, rather
than 2Θ).
Proposition 4.7. For any place wofL, the localp-adic N´ eron function at whas the following
properties:
(i) IfFis a ﬁnite extension of Landw′a place ofFabovew, thenλw′restricts to λwon
JΘ(Lw).
(ii) For all P∈JΘ(Lw)and for all integers msuch thatmP∈JΘ(Lw),
λw(mP) =m2λw(P)−2
nwχL,w(φ|m|(P)).
(iii) For all P,Q∈JΘ(Lw)such thatP+Q,P−Q∈JΘ(Lw),
λw(P+Q)+λw(P−Q) = 2λw(P)+2λw(Q)
−2
nwχL,w(−X11(P)+X11(Q)−X12(P)X22(Q)+X22(P)X12(Q)).
Proof.(i) is clear. By Proposition 3.4(iii) and Corollary 4.4, properties (ii) and ( iii) hold in a
subgroup of ﬁnite index Hw. Since we used (ii) to extend λwoutside of this subgroup, part
(ii) holds everywhere in view of (2.17). As regards (iii), assume P,Q,P+Q,P−Qare non-
torsion points. Since Hwhas ﬁnite index in J(Lw), we can ﬁnd a positive integer msuch that
mR∈Hw\{0}for eachR∈ {P,Q,P+Q,P−Q}. By Lemma A.3, we can also ensure, possibly
after replacing mwith a multiple, that each mRdoes not lie on Θ. Then (iii) holds when Pand
Qare replaced by mPandmQ. Finally, by (2.18), the equality (iii) holds for P,Q. The torsion
case follows by continuity. /square24 FRANCESCA BIANCHI
4.2.Global height.
Deﬁnition 4.8. Theglobalp-adic height forJwith respect to the character χand the subspaces
Wv∈Is(C/Kv) (atv|p) is the function
hp:J(Q)→Qp,
deﬁned as follows. If Pbelongs toJΘ(L), for some ﬁnite extension LofK, then
(4.3) hp(P) =1
[L:Q]/summationdisplay
wnwλw(P),
where the sum runs over all the non-archimedean places wofLandλwis the local p-adic N´ eron
function of Deﬁnition 4.2 if w|pand of Deﬁnition 4.5 if w∤p. Since by Proposition 4.7(ii),
hp(mP) =m2hp(P) forP,mP∈JΘ(L), we extend hptoJ(L) using Lemma 4.1 and by requiring
that
hp(mP) =m2hp(P) continues to hold and hp(0) = 0.
By Remark 4.6(ii), the sum in (4.3) is ﬁnite and by Proposition 4.7(i), it is in dependent of the
choice ofL. Our extension of the p-adic N´ eron functions to torsion points together with the
vanishing of χLonL×also guarantees that hp(P) = 0 for a torsion point P∈JΘ(L). Therefore
the extension to J(L) is well-deﬁned.
By Proposition 4.7(iii), the global p-adic height also satisﬁes the parallelogram law:
hp(P+Q)+hp(P−Q) = 2hp(P)+2hp(Q).
Therefore it induces a symmetric bilinear pairing J(Q)×J(Q)→Qp.
Remark 4.9. By [BKM23], ifpandCsatisfy the assumptions of Theorem 3.6 and if we pick, for
everyvat whichχis ramiﬁed, the canonical v-adic sigma function of Blakestad, the p-adic height
hpcoincides with the canonical global Mazur–Tate height [ MT83].
Remark 4.10. AssumeK=Q. Extending work of Perrin–Riou for elliptic curves [ PR83,PR84],
Triphasrecentlydeﬁnedaquadraticform hnaive
p:J(Q)→Qpasalimitofanaiveheight: see[ Tri22,
Theorem 3.3.1, Deﬁnition 3.3.17, Theorem 3.3.19] (in her thesis, hnaive
pis denotedhp). Letχbe
the cyclotomic character for Q(cf.§6.4), letWp∈Is(C/Qp) be the subspace corresponding to
the naive sigma function, and let hpbe the global p-adic height from above with respect to these
choices. Then Trip shows that hp(u) =hnaive
p(u) for allu∈J(Q) [Tri22, Theorem 3.3.25].
5.Localp-adic N´eron functions vs Colmez’s Green functions
In the ﬁrst part of this section ( §§5.1–5.3) we review some of the results of Colmez [ Col98]. To
be more precise, in §5.1 we sketch Colmez’s construction of a p-adic integration theory on smooth
algebraic varieties over a p-adic ﬁeld, which satisﬁes “natural” properties and does not requir e
any assumption on the reduction. Similar techniques can be used to a ttach to divisors on abelian
varieties certain p-adic Green functions, which are, essentially, double p-adic integrals. In §5.2,
singlep-adic integrals of diﬀerentials of the third kind on curves are related top-adic Green
functions of divisor Θ on their Jacobians. §5.1 and §5.2 are entirely expository. The results of
§5.2 are applied in §5.3 to deﬁne an adelic height on Jacobians of curves over a number ﬁe ldK,
whosecomponentat pcoincideswiththe p-adicheightofColeman–GrossandBesser[ CG89,Bes22].
Such adelic heights are deﬁned in [ Col98], but we phrase Colmez’s results in a slightly more general
form: in particular, our adelic heights depend on the choice, at ever y placepofQ, of a continuous
Qp-valued idele class character for K.
In§5.4, we then restrict to the situation of Section 4 and compare our lo cal N´ eron functions to
Colmez’s Green functions of divisor Θ: see Theorem 5.30 below. In view of§5.3, we also obtain,
in our odd degree genus 2 setting, a formula relating the Coleman–Gr oss localp-adic height at v
with ourp-adic N´ eron function at v(Corollary 5.32).
We use this toshowthat the global p-adicheight hpofDeﬁnition 4.8is equalto the Coleman–Gross
globalp-adic height (Corollary 5.35).p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 25
Remark 5.1. We have chosen to devote considerable space to summarising Colmez ’s results for
a few reasons. First, we crucially use a lot of them (and their proofs ). Secondly, in order to state
our comparison results to a larger degree of generality, we need Co lmez’s height construction to
be extended to arbitrary idele characters. Finally, we believe it would be diﬃcult for the reader to
contextualise the results of §5.4 without having some familiarity with [ Col98].
5.1.Colmez’sp-adic integration theory and Green functions. LetKbe a closed subﬁeld of
Cp(forinstance,aﬁniteextensionof Qp). ThereisauniquelocallyanalyticfunctionLog: O×
K→K
satisfying:
(5.1) dLogt=dt
t,and Log( xy) = Log(x)+Log(y),for allx,y∈ O×
K.
By viewing Log pas a variable, we can extend Log to a homomorphism Log: K×→Kst:=
K[Logp]. One of the main results of [ Col98] is the development of a Kst-valued theory of p-adic
integrationofclosed diﬀerential 1-formson smooth geometricallyc onnected algebraicvarieties over
K, without any assumption on the reduction. Given such a variety X, recall that a rational closed
diﬀerential 1-form is
(i) of the ﬁrst kind if it is holomorphic;
(ii) of the second kind if its residue divisor is zero;
(iii) of the third kind if it has at most simple poles and the residue at each pole is an integer.
See [Col98, Lemme I.1.12, Remarque I.1.18(ii)] for a precise deﬁnition of residue divisor. Any
closeddiﬀerential 1-formis alinearcombinationofdiﬀerentials ofthe secondand third kind [ Col98,
Corollaire I.1.16].
LetK(X) be the ﬁeld of rational functions on XandK(X)stthe ring generated by K(X) and
Log(f), forf∈K(X)×. Alocally log-meromorphic function is a function which locally (with
respect to the p-adic topology) can be written as a polynomial in logarithms of analytic functions
with meromorphic coeﬃcients.
Theorem 5.2 ([ Col98, Th´ eor` eme 1]). There exists a unique theory of integration on smooth
algebraic varieties over Ksatisfying the following properties, for all such varietie sX, closed dif-
ferential 1-formsω,ω1andω2onX, pointsa,b,c∈X(K)and scalars µ1,µ2∈K:
(i)F(x) =/integraltextx
aωis a locally log-meromorphic function of x∈X(K)with values in K⊕KLogp
satisfyingdF=ω;
(ii)/integraltextb
a(µ1ω1+µ2ω2) =µ1/integraltextb
aω1+µ2/integraltextb
aω2;
(iii)/integraltextc
aω=/integraltextb
aω+/integraltextc
bω;
(iv) Ifω=dg(withg∈K(X)st) is exact, then/integraltextb
aω=g(b)−g(a);
(v) Iff:X→Yis a morphism of smooth varieties over K,ηis a closed diﬀerential 1-form
onY, then/integraltextb
af∗η=/integraltextf(b)
f(a)η.
The strategy is to ﬁrst consider the case where Xis an abelian variety, and to then use an
Albanese morphism combined with functoriality (v) to extend to gene ral varieties. In view of
[Col98, Remarque 2(iv)], it is essentially enough to consider the case K=Cp.
Assume now that Xis an abelian variety over K. We give a rough summary of Colmez’s construc-
tion in this case.
A holomorphic diﬀerential ωonXis translation-invariant. Therefore, by (v), the primitive of ω
vanishing at 0 must be a group homomorphism X(K)→K. We can construct such a primitive
as follows. There is an open subgroup VofX(K) such that the unique formal primitive Lωofω
that satisﬁes Lω(0) = 0 converges on Vand is a group homomorphism V→K. SinceX(K)/V
is torsion [ Col98, Th´ eor` eme II.1.9], we can extend Lωto a locally analytic group homomorphism
Lω:X(K)→Kby insisting that Lω(na) =nLω(a) for all integers nand points a. Conversely,
given a locally analytic group homomorphism G:X(K)→K, its diﬀerential is a translation-
invariant, and hence holomorphic, diﬀerential. That is, the map G /mapsto→dGinduces an isomorphism
between the K-vector space of locally analytic group homomorphisms X(K)→K(which we call
one-logarithms ofX) andH0(X,Ω1) [Col98, Lemme II.1.13].26 FRANCESCA BIANCHI
Example 5.3. WhenXis the Jacobian of the curve Cof§2.3, andω= Ωifori∈ {1,2},
the primitive LΩiis an extension to J(K) of thei-th component Liof the strict logarithm L.
See Proposition 2.7 (and Lemma 3.2) for convergence properties of Li. TheK-vector space of
one-logarithms of Xis 2-dimensional and spanned by LΩ1andLΩ2.
The case of diﬀerentials of the second and third kind is more involved. Given a positive integer n
and a subset Iof{1,...,n}, let
mI:Xn+1→X,(x,h1,...,h n)/mapsto→x+/summationdisplay
i∈Ihi
and givenα, a diﬀerential form, a function, or a divisor on X, set
∆[n]α=/summationdisplay
I⊆{1,...,n}(−1)n−|I|m∗
Iα.
By the theorem of the square [ Col98, Propositions I.3.14, I.3.15], if ωis a diﬀerential form of the
second or third kind on X, then ∆[2]ωis exact on X3. LetF∆[2]ωbe the element of K(X3)st
satisfyingdF∆[2]ω= ∆[2]ωandF∆[2]ω(x,0,0) = 0. By (v) and the choice of F∆[2]ω, we must have
∆[2]/parenleftbigg/integraldisplay
ω/parenrightbigg
=F∆[2]ω.
Colmez proves a suﬃcient criterion for a locally log-meromorphic func tiongonX(Cp)n+1to
be of the form ∆[n]f, for a locally log-meromorphic function fonX(Cp); when this applies, f
is unique up to addition by a polynomial of degree at most n−1 in the one-logarithms of X:
see [Col98, Th´ eor` eme II.1.16] for a precise statement. Applying this techn ical result to g=F∆[2]ω,
one solves for a primitive f=/integraltext
ω(see [Col98, Proposition II.1.17]). See §6.7 for explicit formulae
whenXis the Jacobian of the curve C.
Theorem 5.2 concerns single integration only. However, applying a sim ilar strategy to the one we
have just outlined for integrals of diﬀerentials of the second and th ird kind, Colmez also constructs
certainp-adic Green functions on the abelian variety X, which are double integrals in disguise (see
Proposition 5.7 below).
The theorem of the cube states the following:
Proposition 5.4 ([ Col98, Proposition I.3.18]). IfXis an abelian variety over an algebraically
closed ﬁeld of characteristic 0andDis a divisor of X, then∆[3]Dis principal.
LetDbe a divisor of Xand letf(4)
Dbe the rational function on X4whose divisor is ∆[3]Dand
whose restriction to ( X3×{0})∪(X2×{0}×X)∪(X×{0}×X2) is equal to the constant function
1. The aforementioned criterion of [ Col98, Th´ eor` eme II.1.16] applied to Log f(4)
Dallows one to go
fromX4toX:
Proposition 5.5 ([ Col98, Proposition 4, Proposition II.1.19]). There exists a locally log-
meromorphic function GDonX, with values in K⊕QLogp, such that ∆[3]GD= Logf(4)
D. More-
over,GDis unique up to addition by a polynomial of degree at most 2in the one-logarithms of X,
it has a logarithmic singularity along Dand it is locally analytic away from the support of D.
Deﬁnition 5.6. A function GDsatisfying Proposition 5.5 is called a Green function of divisor D.
The following proposition tells us that the Green function GDis a sort of double p-adic integral:
Proposition 5.7 ([ Col98, Proposition II.1.20]). Let∂be an invariant derivation on X. If
GDis a Green function of divisor D, thend(∂GD)is a diﬀerential form of the second kind.
5.2.Colmez’s theory on curves and Jacobians. As in §5.1, letKbe a closed subﬁeld of Cp.
LetXbe a smooth, projective, geometricallyirreducible curve of positive genusgoverKsuch that
X(K) is non-empty, let Jbe its Jacobian, and given a ﬁxed P0∈X(K), consider the embedding
ι:X ֒− →Jwith base point P0. This induces an isomorphism ι∗:H1
dR(J)→H1
dR(X).p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 27
Remark 5.8. WhenXis the genus 2 curve given explicitly by an equation of the form (2.5), a lot
of the notation that we are going to introduce now has already been introduced or ﬁxed (e.g. ιis
the embedding with respect to P0=∞). Since there is no clear advantage in specialising to that
setting here, we keep the exposition of Colmez’s results general. Th e rule to keep in mind when
we return to the case X=Cin§5.4 is that all the notation of this section should be specialised
to that previously ﬁxed for C.
Fix a basis (Ω 1,...,Ωg) forH0(J,Ω1) and denote by ( ∂1,...,∂ g) its dual basis of invariant deriva-
tions. Consider the function ̟:Xg→J, deﬁned by ̟(P1,...,P g) =ι(P1) +···+ι(Pg). Then
̟is surjective and induces a birational equivalence of the g-th symmetric power X(g)ofXwith
J. We call a point u∈Jgenericif there is a unique element of X(g)mapping to uunder the
map induced by ̟and the latter has distinct Pi. Thetheta divisor , denoted Θ, is the divisor of
Jwhich is the image of
Xg−1→J,(P1,...,P g−1)/mapsto→ −ι(P1)···−ι(Pg−1).
For generic u=ι(P1,u)+···+ι(Pg,u), we consider the following divisor on X(cf. [Mil08, Lemma
6.7]):
Xu=/summationdisplay
P∈ι−1(u+Θ)P=P1,u+···+Pg,u.
The theta divisor is symmetric , i.e. there exists a unique w∈Jsuch thatxbelongs to Θ if and
only ifw−xbelongs to Θ (by [ Col98, Corollaire I.4.7] and Lefschetz principle). If Gis a Green
function of divisor Θ, so is Gw(x):=G(w−x) and we say that Gissymmetric ifG(x) =Gw(x).
Recall that, by Proposition 5.7, d(∂iG) is a diﬀerential of the second kind on J.
Proposition 5.9 ([ Col98, Proposition II.2.4]). The function that maps a Green function G
to the subspace of H1
dR(X)generated by ι∗d(∂1G),...,ι∗d(∂gG)induces a bijection between the set
of symmetric Green functions of divisor Θ(up to addition by a constant) and the set Is(X)of
subspaces of H1
dR(X)which are complementary to H0(X,Ω1)and isotropic for the cup product.
Using this propositionand properties ofGreen functions, Colmez ex presses integralsof diﬀerentials
of the third kind on X(as in Theorem 5.2) in terms of pullbacks of symmetric Green function s for
the theta divisor of J. We now explain how.
Given a diﬀerential ωof the third kind on X, let Res P(ω) be the residue of ωatPand let
Div(ω) =/summationdisplay
P∈XResP(ω)P∈Div0(X).
In particular,
Div/parenleftbiggdf
f/parenrightbigg
= div(f),
where the latter is the divisor of a rational function, in the usual se nse.
Fix an element W∈Is(X) and letGΘ,Wbe a corresponding symmetric Green function (by
Proposition 5.9, this is unique up to addition by a constant); set Fi,W=∂iGΘ,W. Given generic
u,v∈J, consider the diﬀerential
(5.2) ωu−ωv=ι∗/parenleftiggg/summationdisplay
i=1(Fi,W(x−u)−Fi,W(x−v))Ωi/parenrightigg
.
Lemma 5.10. ωu−ωvis of the third kind and
Div(ωu−ωv) =Xu−Xv.
Proof.See [Col98, p.92]. /square
We consider the Z-module generated by the diﬀerentials of the form ωu−ωvforu,v∈Jgeneric
points; we call a diﬀerential in this module a diﬀerential of type (1,1). This deﬁnition depends on
the choice of W∈Is(X).28 FRANCESCA BIANCHI
Proposition 5.11 ([ Col98, Proposition II.2.9]). Letωbe a diﬀerential of the third kind on
X. Then there exist a unique holomorphic diﬀerential ω1,0and a unique diﬀerential ω1,1of type
(1,1)such thatω=ω1,0+ω1,1. Moreover,
(i) Ifω=df
f, thenω1,0= 0.
(ii) Ifω1,1=/summationtext
iniωui, then the image of Div(ω)inJis/summationtext
iniuiand
/integraldisplayx
ω=/integraldisplayx
ω1,0+/summationdisplay
iniGΘ,W(ι(x)−ui).
Example 5.12. If Div(ω) =P1−P2, pickQ1,...,Q g−1such thatu=ι(P1)+ι(Q1)+···+ι(Qg−1)
andv=ι(P2)+ι(Q1)+···+ι(Qg−1) are both generic. Then
Div(ωu−ωv) =Xu−Xv=P1−P2;
hence
ω−(ωu−ωv) =ω1,0∈H0(X,Ω1)
and/integraldisplayx
ω=/integraldisplayx
ω1,0+GΘ,W(ι(x)−u)−GΘ,W(ι(x)−v).
This example should clarify that, although the diﬀerential ω1,1is unique, its decomposition as a
sum/summationtext
iniωuiis not. The choices of the generic points ui∈Jaﬀect the logarithmic singularities
of the individual terms GΘ,W(ι(x)−ui); however, overall,/summationtext
iniGΘ,W(ι(x)−ui) is locally analytic
outside Div( ω).
For everyi∈ {1,...,g}, denote by Lithe one-logarithm of Jwhose diﬀerential is the basis element
ΩiforH0(J,Ω1).
Deﬁnition 5.13. For a diﬀerential ωof the third kind on X, we deﬁne Log ˜J(ω)∈H1
dR(X) as the
class of the diﬀerential
ω1,0+g/summationdisplay
i=1Li(Div(ω))ηi,
whereω1,0is as in Proposition 5.11 and, for every i∈ {1,...,g},ηi=ι∗d(∂iGΘ,W).
As a corollary to Proposition 5.11 and since ηi∈Wby construction, we obtain
Lemma 5.14.
(i)Log˜J(ω) = [ω]ifωis holomorphic.
(ii) Ifωis of type (1,1)with respect to W, thenLog˜J(ω)belongs toW.
(iii)Log˜J/parenleftig
df
f/parenrightig
= 0.
Remark 5.15. The function Log ˜Jis deﬁned more conceptually in [ Col98, Th´ eor` eme II.2.11] and
it is then shown to satisfy Deﬁnition 5.13 and Lemma 5.14. Denoting by T(K) the group of
diﬀerentials of the third kind on X, and byTℓ(K) the subgroup of logarithmic diﬀerentials (i.e.
those of the formdf
ffor somef∈K(X)×), we see that Log ˜Jinduces a group homomorphism
Log˜J:T(K)/Tℓ(K)→H1
dR(X).
In fact, this agrees with the canonical homomorphism Ψ of [ CG89, Proposition 2.5] (see [ Col98,
Remarque II.2.12]).
5.3.Colmez’s adelic heights.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 29
5.3.1.Notation and preliminary choices. LetKbe a number ﬁeld. For every place vofK, we
deﬁne aQ-vector space L(K×
v) and a logarithm Logv:K×
v→L(K×
v), as follows.
Ifvis a non-archimedean place, let pbe the rational prime below vand let Logvbe the logarithm
Log for the ﬁeld Kv, as deﬁned at the beginning of §5.1. Then Logvtakes values in L(K×
v):=
Kv⊕QLogvp. An element x∈L(K×
v) can be written uniquely as x=x(0)+x(1)Logvpwith
x(0)∈Kvandx(1)∈Q. We will use the superscripts (0) and (1) with this meaning.
Ifvis an archimedean place, we let L(K×
v) =Rand Logv:K×
v→L(K×
v) the map Logvx=
log|x|∞, where|·|∞is the standard absolute value on RorC.
We then deﬁne the Q-vector space
L(A×
K) =/productdisplay′
L(K×
v) ={(xv)v∈/productdisplay
L(K×
v) :xv∈Kvfor almost all v}.
Since Logv(O×
v)⊂Kv, applying Logvcomponent-wise gives a well-deﬁned map Log: A×
K→
L(A×
K). Denoting by L(K×) theQ-vector subspace of L(A×
K) generated by Log( K×), we set
L(A×
K/K×):=L(A×
K)/L(K×).
Next, we deﬁne a Q-linear map T:L(A×
K/K×)→/producttext
p≤∞Qp(whereQ∞:=R). The map Twill
depend on the choice, at every p, of a continuous idele class character χ(p):A×
K/K×→Qp(cf.
Section 4 for the case p<∞). We denote by I(K) the set of all possible choices of χ= (χ(p))p≤∞.
Remark 5.16. In Colmez’s set-up there is no dependence on an element of I(K). On the other
hand, implicit in the construction is the choice of (a scalar multiple of) t he cyclotomic character at
p<∞(see [BBBM21 , Example 2.7]) and a choice of a continuous real-valued idele class char acter.
The latter choice amounts to the choice of a multiplicative constant.
Lemma 5.17. Letχ(p):A×
K/K×→Qpbe a continuous idele class character. For every place
vofK, there exists a unique Q-linear map T(p)
v:L(K×
v)→Qpmaking the following diagram
commutative
K×
vχ(p)
v/d47/d47
Logv /d35/d35●●●●●●●●●Qp.
L(K×
v)T(p)
v/d59/d59✇✇✇✇✇✇✇✇✇
Moreover, for all but ﬁnitely many v,T(p)
vvanishes identically on Kv.
Proof.Q-linearity gives uniqueness. For existence,
•ifvandpare inﬁnite, then χ(∞)
v=αLogvfor someα∈R, so we letT(∞)
v(x) =αxfor all
x∈L(K×
v) =R;
•ifpis ﬁnite and v|p, there exists a unique Qp-linear map t(p)
v:Kv→Qpsuch that
χ(p)
v=t(p)
v◦LogvonO×
v(see, for example, [ BBBM21 ,§2.1]). We then let
T(p)
v(x) =t(p)
v(x(0))+x(1)χ(p)
v(p),for allx∈L(K×
v);
•ifpis ﬁnite and vis inﬁnite,χ(p)
vis identically zero, so T(p)
v(x) = 0;
•in all the remaining cases, χ(p)
vis identically zero on O×
v, so
T(p)
v(x) =x(1)χ(p)
v(ℓ),
whereℓis the rational prime below v. /square
Deﬁnition 5.18. Fixχ= (χ(p))p∈I(K) and, for every pair ( v,p) of a place of Kand one of
Q, denote by T(p)
vthe map of Lemma 5.17 for χ(p)
v. By the lemma, the following map (whose
deﬁnition depends on χ) is well-deﬁned and Q-linear:
(5.3) T:L(A×
K/K×)→/productdisplay
p≤∞Qp, T((xv))p=/summationdisplay
vT(p)
v(xv).30 FRANCESCA BIANCHI
SupposeLis a ﬁnite extension of K. Then for every place vofKand placew|vofL, there is a
uniqueQ-linear map Tr Lw/Kv:L(L×
w)→L(K×
v) satisfying
TrLw/Kv(Logw(x)) = Logv(NLw/Kv(x)) for all x∈L×
w.
These local trace maps induce a Q-linear map
TrL/K:L(A×
L)→L(A×
K),TrL/K(...,xw,...) =/parenleftbigg
...,/summationdisplay
w|vTrLw/Kv(xw),.../parenrightbigg
that factors through
TrL/K:L(A×
L/L×)→L(A×
K/K×).
Therefore,given χ∈I(K)asabove,thecompositionof TwithTr L/KgivesaQ-linear L(A×
L/L×)→/producttext
p≤∞Qp.
Remark 5.19. In fact,T◦TrL/Kis equal to the Q-linear map L(A×
L/L×)→/producttext
p≤∞Qpthat
Deﬁnition 5.18 associates to the character χL∈I(L) given byχ(p)
L=χ(p)◦NL/KwhereNL/Kis
the norm on the idele class group.
5.3.2.Adelic heights with respect to χ.Let nowXbe a smooth, projective, geometrically irre-
ducible curve over K, of genus greater than 0, with Jacobian J. We assume that we have ﬁxed χ∈
I(K), which by Deﬁnition 5.18determines a choice of Q-linearmap T:L(A×
K/K×)→/producttext
p≤∞Qp.
We warn the reader that this choice will not be reﬂected in our notat ion.
Thegoalistoconstructasymmetricbilinearpairing J(Q)×J(Q)→/producttext
p≤∞Qp, usingT. Projecting
toQp,forachosenprime p, (ortoR)wewillalsoobtaina Qp-valued(orreal-valued)heightfunction
in the usual sense.
Besides the choice of χ∈I(K), the adelic height depends on a choice, for each non-archimedean
placev, of subspace WvofH1
dR(X/Kv), complementary to the space of holomorphic forms and
isotropic with respect to the cup product; in other words, on a sub spaceWvin the set Is( X/Kv).
We denote by Is K(X) the set of such choices; an element W∈IsK(X) has a component Wvat
each ﬁnite place vofK. FixW∈IsK(X); we can and will view Was an element in Is L(X) for
any ﬁnite extension LofK.
Given a divisor Dof degree 0 on X/Kand a non-archimedean place v, there is a unique diﬀerential
ωD,Wvof the third kind of type (1 ,1) with respect to Wvwhose residue divisor is D(Proposition
5.11). Equivalently, by Lemma 5.14, ωD,Wvis the unique diﬀerential of the third kind whose
residue divisor is Dand whose image under Log ˜Jbelongs toWv. We denote by GD,W,va primitive
ofωD,Wv, which, by Proposition 5.11(ii), is, up to a constant, of the form
/summationdisplay
iniGΘ,Wv(ι(x)−ui),
for some generic ui∈Jandni∈Z.
Ifvis archimedean, there exists a unique diﬀerential ωD,Wvof the third kind whose residue divisor
isDand all of whose periods are purely imaginary (the notation is a bit misle ading, because W∞
has technically not been deﬁned). We write GD,W,vfor the real part of a primitive of ωD,Wv.
Theadelic Green function associated to Dwith respect to Wis the function
GD,W:/productdisplay
vX(Kv)→/productdisplay
vL(K×
v), G D,W((...,xv,...)) = (...,GD,W,v(xv),...).
The Green function GD,Wis only well-deﬁned on ( xv)∈/producttext
vX(Kv) such that xvdoes not belong
to the support of D, for anyv. Moreover, each GD,W,vis unique only up to addition of a constant
function. This lack of uniqueness disappears if we view GD,Was a function on degree 0 divisors,
after extending by linearity.
Proposition 5.20 ([ Col98, Lemme II.2.16]). IfD1andD2are disjoint degree 0divisors over
K, then
(i)GD1,W(D2) =GD2,W(D1).p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 31
(ii)GD1,W(D2)∈L(A×
K).
(iii) IfD1= div(f), thenGD1,W,v(D2) = Logv(f(D2)). In particular, if D1orD2is principal,
thenGD1,W(D2)∈L(K×).
(iv) IfL/Kis a ﬁnite extension, then TrL/K(GD1⊗L,W(D2⊗L)) = [L:K]GD1,W(D2).
Deﬁnition 5.21. Theadelic height with respect to Tis the symmetric bilinear pairing
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW:J(Q)×J(Q)→/productdisplay
p≤∞Qp
deﬁned as follows. Given x,y∈J(Q), pickD1,D2∈Div0(X) such that the class of D1andD2
equalsxandy, respectively. Assume that D1andD2are deﬁned over L, for someL/Kof ﬁnite
degree, and that the supports of D1andD2are disjoint. Then
/a\}⌊ra⌋ketle{tx,y/a\}⌊ra⌋ketri}htW:=1
[L:Q]·T◦TrL/K(GD1,W(D2)).
Remark 5.22. Proposition 5.20 guarantees that /a\}⌊ra⌋ketle{tx,y/a\}⌊ra⌋ketri}htWis symmetric and well-deﬁned, in the
sense that it is independent of the choices of D1andD2and ofL. By symmetry, by the deﬁnition
ofGD1,Wand byQ-linearity of T◦TrL/K, we get bilinearity of /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW.
We also obtain, for each place p, a pairing
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW,p:J(Q)×J(Q)→Qp
by taking the p-th component of /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW. TheQp-valued pairing /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW,pdecomposes as a sum of
local height pairings. In particular, retaining the notation of Deﬁnit ion 5.21, we have
/a\}⌊ra⌋ketle{tx,y/a\}⌊ra⌋ketri}htW,p=1
[L:Q]/summationdisplay
w/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htp,w,W,
where/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htp,w,Wis theQp-valued pairing on relatively prime degree zero divisors with support in
X(Lw) deﬁned as follows:
(5.4) /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htp,w,W=T(p)
v◦TrLw/Kv(GD1,W,w(D2));
herevis the place of Kbeloww.
The real (resp. p-adic) height pairing of N´ eron–Tate(resp. Coleman–Gross)is also deﬁned in terms
of local height pairings on relatively prime degree zero divisors.
Proposition 5.23 ([ Gro86, Proposition 2.3], [ CG89, Proposition 1.2]). Letpbe a place of
Qand letχ(p):A×
K/K×→Qpbe a continuous idele class character. Let Lbe a ﬁnite extension
ofKand letχ(p)
L=χ(p)◦NL/K:A×
L/L×→Qp. Letwbe a place of L, such that, if p/\e}atio\slash=∞, then
w∤p. There exists a unique Qp-valued pairing /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htN
p,won relatively prime degree zero divisors with
support inX(Lw)such that:
(i)/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w=/a\}⌊ra⌋ketle{tD2,D1/a\}⌊ra⌋ketri}htN
p,w;
(ii)/a\}⌊ra⌋ketle{tD1,D2+D3/a\}⌊ra⌋ketri}htN
p,w=/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w+/a\}⌊ra⌋ketle{tD1,D3/a\}⌊ra⌋ketri}htN
p,w;
(iii)/a\}⌊ra⌋ketle{tdiv(f),D/a\}⌊ra⌋ketri}htN
p,w=χ(p)
L,w(f(D));
(iv)/a\}⌊ra⌋ketle{t(x)−(x0),D/a\}⌊ra⌋ketri}htN
p,wis a continuous function of x.
Deﬁnition 5.24. TheN´ eron–Tate real height pairing with respect to the idele character χ(∞)is
the pairing
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htNT:J(Q)×J(Q)→R
deﬁned as follows. If x,y,D 1,D2,Lare as in Deﬁnition 5.21, then
/a\}⌊ra⌋ketle{tx,y/a\}⌊ra⌋ketri}htNT=1
[L:Q]/summationdisplay
w/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
∞,w.
Remark 5.25. Up to a multiplicative constant, there is only one choice of continuous idele class
characterχ(∞).32 FRANCESCA BIANCHI
In the statement of Proposition 5.23 we excluded pairs ( p,w) wherepis ﬁnite and w|p, be-
cause uniqueness fails in this case. Nevertheless, Coleman–Gross [ CG89] deﬁned a local pairing
dependent on some choice of auxiliary data. Let vbe the place of Kbeloww, letWvbe a sub-
space ofH1
dR(X/Kv) isotropic with respect to the cup product and complementary to H0(X,Ω1).
Unravelling deﬁnitions, we see that the local height of Coleman–Gros s atwsatisﬁes
(5.5) /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w,W v=/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htp,w,W,
provided that the v-adic component of WisWvand thep-adic component of χisχ(p). Technically
speaking, Coleman–Grossassumed goodreduction at each v|pasthey deﬁned the left hand side of
(5.5) using Coleman integration [ Col82,CdS88], but Besser [ Bes05, Section 7] [ Bes22] extended the
deﬁnition to arbitrary reduction type, using the p-adic integration theory of Vologodsky [ Vol03].
Single Vologodsky integration agrees with Colmez’s (summarised in §5.1). The only diﬀerence
between (single) Coleman and Colmez integration in good reduction is t hat the former depends on
the branch of the logarithm, while the latter treats the value of the logarithm at pas a variable.
This diﬀerence is lost in the local height parings of (5.5) since we are ap plying compatible trace
maps to Qp. The equality (5.5) therefore indeed holds.
In view of Besser’s extension, we may state Colmez’s results without restricting to good reduction.
Deﬁnition 5.26. For everyv|p, letWvbe a subspace of H1
dR(X/Kv), complementary to
H0(X,Ω1) and isotropic with respect to the cup product. Then the (extended) Coleman–Gross
p-adic height pairing with respect to ( Wv)v|pandχ(p)is the pairing
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htCG
(Wv):J(Q)×J(Q)→Qp
deﬁned as follows. If x,y,D 1,D2,Lare as in Deﬁnition 5.21, then
/a\}⌊ra⌋ketle{tx,y/a\}⌊ra⌋ketri}htCG
(Wv)=1
[L:Q]/parenleftbigg/summationdisplay
w|v|p/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w,W v+/summationdisplay
w<∞,w∤p/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w/parenrightbigg
.
Theorem 5.27 ([ Col98, Th´ eor` eme II.2.18] +ǫ).The pairing /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htW,pis equal to the N´ eron–
Tate real height pairing with respect to χ(∞)ifp=∞and to the extended p-adic height pairing of
Coleman–Gross with respect to (Wv)v|pandχ(p)ifpis ﬁnite. Moreover, if pis inﬁnite, or pis
ﬁnite andw∤p, then
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htp,w,W=/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htN
p,w,
and so/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htp,w,Wis independent of W; otherwise,
/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htp,w,W=/a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htN
p,w,W v.
Proof.Colmez proves the result for a speciﬁc choice of χ∈I(K); given the deﬁnitions and results
above, the proof carries over to an arbitrary χ. In particular, it suﬃces to show equality of the
local height pairings for all the pairs ( p,w) satisfying the assumptions of Proposition 5.23. For
example, if p,ware non-archimedean and w|ℓ/\e}atio\slash=p, by (5.4) and the proof of Lemma 5.17, we
have
(5.6) /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htp,w,W=GD1,W,w(D2)(1)χ(p)
L,w(ℓ).
By uniqueness, it suﬃces to show that (5.6) satisﬁes all the proper ties of Proposition 5.23, and
this is independent of the choice of χ(p). /square
Remark 5.28. As Colmezobserves, bythe comparisonresultofTheorem5.27andE quation(5.6),
we obtain a formula for the N´ eron–Tate local height which does not use intersection theory. This
is analogous to the diﬀerence between Deﬁnition 4.5 and the deﬁnition ofp-adic N´ eron functions
away frompof [BKM23].
Recently, Besser, M¨ uller and Srinivasan [ BMS22] gave a new construction of p-adic heights on
varieties over number ﬁelds using p-adic Arakelov theory [ Bes05], and, in particular, p-adic log
functions. Their height satisﬁes properties that generalise what w e have just observed concerning
Colmez’s heights: namely, the local contributions at all places are de ﬁned analytically. In the
special case of Jacobians of curves, they compare their constru ction to Colmez’s. For this, theyp-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 33
use a result of Besser [ Bes05, Appendix B] that relates the theory of log functions on line bundles
on abelian varieties to Colmez’s Green functions.
Remark 5.29. Ifpis ﬁnite,w|v|p, andχ(p)is unramiﬁed at v(i.e.χ(p)
v(O×
v) = 0), then
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htp,w,Wonly depends on GD1,W,w(D2)(1)and not on GD1,W,w(D2)(0), since the local trace
mapt(p)
vof the proof of Lemma 5.17 is trivial. In fact, also in this case the local height is
independent of the choice of Wv, and is given by formula (5.6). Compare this with Remark
4.6(iii).
5.4.p-Adic N´ eron functions, Green functions and Coleman–Gross heights. In this sub-
section, we go back to the situation of Section 4, where pis a ﬁnite prime of QandCis a smooth
genus 2 curve over a number ﬁeld K, given by an equation of the form (2.5), with coeﬃcients in
the ring of integers of K. Letvbe a place of K, and consider the base-change of CtoKv.
We apply Colmez’s results from §§5.2–5.3 according to Remark 5.8: in particular,
•ιis the embedding with respect to the base-point P0=∞.
•(Ω1,Ω2) is the basis for H0(J,Ω1) of Deﬁnition 2.11, described explicitly in terms of the
P8embedding of Jin Lemma 2.12(1). The dual basis ( ∂1,∂2) of invariant derivations is
also described in Lemma 2.12(2).
•x∈Θ if and only if −x∈Θ, so the element w∈Jdeﬁned just before Proposition 5.9 is
just 0. In particular, a v-adic Green function of division Θ is symmetric if and only if it is
even.
According to Proposition 5.9, the set of symmetric v-adic Green functions of divisor Θ (up to
addition by a constant function) is in bijection with the subset Is( C/Kv) of the set of subspaces of
H1
dR(C/Kv). By Proposition 3.5, there is also a bijection between Is( C/Kv) and the set of v-adic
sigma functions.
Supposeχ:A×
K/K×→Qpis a continuous idele class character. Let Tv:L(K×
v)→Qpbe the
trace map at vinduced by χas in Lemma 5.17. Fix a subspace Wv∈Is(C/Kv). In this subsection,
we prove:
Theorem 5.30. There exists a symmetric v-adic Green function G:=GΘ,Wvof divisor Θsimul-
taneously satisfying the following properties:
(i)/a\}⌊ra⌋ketle{tι∗[d(∂1G)],ι∗[d(∂2G)]/a\}⌊ra⌋ketri}ht=Wv;
(ii) LetLbe a ﬁnite extension of K, letw|vbe a place of L, letλw:=λw,Wvbe the local p-adic
N´ eron function at wwith respect to Wv∈Is(C/Kv)andχ, and letTw:=Tv◦TrLw/Kv.
Then
(5.7) nwλw=−2Tw(G).
Remark 5.31. The theorem also holds true if vis a prime at which χis unramiﬁed; in this case,
both the left and right hand side of (5.7) are independent of Wv(cf. Deﬁnition 4.5, Remark 4.6(iii)
and Theorem 5.27).
The comparison of the p-adic component of the adelic-Green-function height and the (ext ended)
Coleman–Gross p-adic height then gives, as a corollary, a comparison result between the local
N´ eron function λw,Wvand the local height pairing /a\}⌊ra⌋ketle{t·,·/a\}⌊ra⌋ketri}htN
p,w,W vwith respect to χ.
Corollary 5.32. LetLbe a ﬁnite extension of K, andwa place ofLabove the place vofK. Let
D1=/summationtextr
i=1kiPiandD2=/summationtexts
j=1mjQjbe disjoint degree 0divisors supported on C(Lw). Choose
pointsu1,...,u r∈J(Lw)such thatu1,...,u rare generic,/summationtext
ikiCui=D1andι(Qj)−ui/\e}atio\slash∈
Supp(Θ) for alli,j. Then
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w,W v=−nw
2r/summationdisplay
i=1s/summationdisplay
j=1kimjλw,Wv(ι(Qj)−ui).
Proof.This follows from Theorem 5.30 and Theorem 5.27. /square34 FRANCESCA BIANCHI
Example 5.33. With the notation of Corollary 5.32, let R∈C(Lw) such that R/\e}atio\slash=Pi,P−
i,Qjfor
alli∈ {1,...,r}and allj∈ {1,...,s}. Then we may choose ui=ι(Pi)+ι(R).
Remark 5.34. The comparison also holds at the primes at which χis unramiﬁed. For these,
there is no dependence on Wv.
Corollary 5.35. The Coleman–Gross global height pairing on J(Q)×J(Q)is equal to the sym-
metric bilinear pairing induced by hp, provided that we make the same choices of Wv∈Is(C/Kv)
at all places vof ramiﬁcation for χ.
Remark 5.36. Suppose that p≥5, thatChas good ordinary reduction at every place v|p
of ramiﬁcation for χ, and that, for each such v,Kvis an unramiﬁed extension of Qp. Then,
at every such v, we may take Wvto be the unit root eigenspace of Frobenius. By Proposition
3.8, this corresponds to choosing the canonical v-adic sigma function of Blakestad. Under these
assumptions, Corollary 5.35 thus relates the Coleman–Gross p-adic height with respect to the
unit root eigenspaces of Frobenius to the p-adic height with respect to the canonical v-adic sigma
functions.
Proof of Corollary 5.35. We omit the choices of subspace Wvfrom the notation. Let Lbe an
arbitrary ﬁnite extension of K. SinceC(L) is ﬁnite by Faltings’s theorem [ Fal83], there are ﬁnitely
many points in J(L) which are either of the form [2 P−2∞] or [P+W−2∞] for a Weierstrass
pointW. Therefore, any point in J(L)\Jtors(L) admits a multiple vof the form
v= [P1−P2],
for some non-Weierstrass points P1,P2such thatP1/\e}atio\slash=P−
2. Thus, by quadraticity, it suﬃces to
show thathp(v) =/a\}⌊ra⌋ketle{tv,v/a\}⌊ra⌋ketri}htCGfor allvin this form.
In this case, the divisors D1=P1−P2andD2=P−
2−P−
1are disjoint and satisfy [ D1] = [D2] =
v/\e}atio\slash∈Supp(Θ). By possibly replacing Lwith a ﬁeld extension, we may assume that the supports of
D1andD2are deﬁned over L. Letwbe a non-archimedean place of L, and letv1= [P−
2−P1],
v2= [P−
2−P2],v3= [P−
1−P1]. By Corollary 5.32 and Example 5.33, we have
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w=−nw
2(2λw(v1)−λw(v2)−λw(v3)).
Thus, by Proposition 4.7(iii),
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,w=nwλw(v)−χL,w(−X11(v1)+X11(v)−X12(v1)X22(v)+X22(v1)X12(v)).
Summing over all places wgives the result. /square
It remains to prove Theorem 5.30. This will be a corollary of some inter mediate results. In order
to keep the notation more legible, for now, let σvbe just some v-adic sigma function for C/Kv.
Lemma 5.37. LetVbe a ﬁnite index subgroup of J(Kv)on whichσvconverges. Then there exists
a ﬁnite index subgroup V′ofJ(Kv)such thatV′⊆Vand the restriction of Log(σv)toV′satisﬁes
Proposition 5.5 for D= Θ; that is,
∆[3](Log(σv)) = Logg(4)
Θ,
whereg(4)
Θis the restriction to V′,4off(4)
Θ,Log(σv)is locally analytic outside Θand has a loga-
rithmic singularity along Θ.
Proof.Ifσvandσ′
vare two diﬀerent sigma functions, then Log( σv)−Log(σ′
v) is a polynomial of
degree two in the formal one-logarithms of J, so, since the statement of the lemma allows us to
move to a smaller V′, it suﬃces to consider the naive v-adic sigma function of Theorem 3.3. Upon
switching variables to the additive group, the latter is the Taylor exp ansion of the complex sigma
functionσ, so it is enough to show that
(i) the function σis such that
F(4)
Θ(z0,z1,z2,z3) =σ(z0+z1+z2+z3)σ(z0+z1)σ(z0+z2)σ(z0+z3)
σ(z0+z1+z2)σ(z0+z1+z3)σ(z0+z2+z3)σ(z0)p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 35
is periodic with period Λ4;
(ii) the divisor of F(4)
Θis ∆[3]Θ.
Part (i) follows from the translation properties of σ[Uch11b, Proposition 2.2], while part (ii)
by [Uch11b, Proposition 2.7]. Note that on J3×{0}∪(J2×{0}×J)∪(J×{0}×J2) we have
F(4)
Θ= 1. /square
Lemma 5.37 tells us that, locally, Log( σv) is av-adic Green function of divisor Θ. Next, we want
to show that we can extend Log( σv) to av-adic Green function on J, and that the right way to do
so is by using a quasi-quadraticity formula involving division polynomials, just like we did when
deﬁning local N´ eron functions.
In order to achieve this, we observe that the existence of GΘ(and uniqueness, up to addition
by polynomials of degree at most 2 in the one-logarithms of J), as stated in Proposition 5.5, is
provedby Colmez using [ Col98, Th´ eor` emeII.1.16]. The proof of this technical result comprises two
steps: ﬁrst one solves the problem locally, and then extends the so lution using [ Col98, Proposition
II.1.23].
Proposition 5.38. The function Log(σv)extends to a unique Green function GΘforΘonJ.
Moreover,GΘis an even function and
(5.8) GΘ(nx)−n2GΘ(x) = Log(φn(x)),
whereφnis then-th division polynomial of (2.15).
Proof.By [Col98, Proposition II.1.23], Log( σ) extends to a unique Green function GΘonJ. Now,
Log(σ) is an even function, and since [ −1]∗Θ = Θ we have that Log f(4)
Θ(−z0,−z1,−z2,−z3) and
Logf(4)
Θ(z0,z1,z2,z3) diﬀer by a constant. Evaluating at z3= 0, we ﬁnd that the constant is 0.
Thus the formula of [ Col98, Proposition II.1.23] with f= Log(σ) gives an even function, satisfying
GΘ(z0+z1+z2+z3)−GΘ(z0+z1+z2)−GΘ(z0+z2+z3)−GΘ(z0+z1+z3) (5.9)
+GΘ(z0+z1)+GΘ(z0+z2)+GΘ(z0+z3)−GΘ(z0) = ∆[3]GΘ(z0,z1,z2,z3) = Log(f(4)
Θ)
We now use this to prove (5.8). The proof will be similar to the one for e lliptic curves given in the
proof of [ Col98, Proposition II.2.20].
Both the right and left hand side of (5.9) have a logarithmic singularity at{0}×J3. We have
(5.10)
GΘ(z1+z2+z3)−GΘ(z1+z2)−GΘ(z2+z3)−GΘ(z1+z3)
+GΘ(z1)+GΘ(z2)+GΘ(z3) = lim
z0→0(Log(f(4)
Θ)(z0,z1,z2,z3)+GΘ(z0)) = Log(h(z1,z2,z3)),
for some rational function h. Once again, letting z1=z2, taking limits z3→ −z1and using that
GΘis even, we get
(5.11) 4 GΘ(z1)−GΘ(2z1) = Log(f−1
2(z1))
for some rational function f2. Going back to (5.10) and letting z1= (n−1)x,z2=z3=x, we get
GΘ((n+1)x)−2GΘ(nx)−GΘ(2x)+GΘ((n−1)x)+2GΘ(x) = Log(h((n−1)x,x,x)).
By induction, we conclude that for all n≥1 there exists a rational function fnsuch that
GΘ(nx)−n2GΘ(x) = Log(fn(x)).
Comparing log-singularities, we see that fnequalsφn, up to multiplication by a constant, which,
by comparing around 0, we see we can take to be equal to 1. /square
It remains to show that if σvcorresponds to Wvvia Proposition 3.5, then the Green function GΘ
of Proposition 5.38 also corresponds to Wvunder the bijection of Proposition 5.9.36 FRANCESCA BIANCHI
Lemma 5.39. Letσvbe the sigma function satisfying the diﬀerential equations
DiDj(Log(σv)) =−Xij+cij, c 12=c21.
LetGΘbe the Green function associated to σvby Proposition 5.38. Then ηi,J=d(∂iGΘ)is given
explicitly by
ηi,J= (−X1i+c1i)Ω1+(−Xi2+ci2)Ω2.
Proof.By Lemma 2.17, Diis the restriction of ∂ito the formal group law. So we have
∂i∂j(Log(σv(nx))) =n2(−Xij(nx)+cij)
∂i∂j(Log(φn(x))) =−n2Xij(nx)+n2Xij(x)
(cf. [Uch11b, Proposition 4.10]), and thus ∂i∂j(GΘ) =−Xij+cij, as desired. /square
Lemma 5.40. With the notation of Lemma 5.39, let [η1] =ι∗[η1,J],[η2] =ι∗[η2,J]. Then we may
choose
η1= (−3x3−2b1x2−b2x+c12x+c11)dx
2y, η 2= (−x2+c22x+c12)dx
2y,
i.e.η1=η(c)
1andη2=η(c)
2whereη(c)
1andη(c)
2are the diﬀerentials of (3.3).
Proof.Letπi:C2→Cbe the projection map, and let ̟:C2→Jbe the map sending ( P1,P2)
toι(P1)+ι(P2). According to [ Col98, Lemme II.2.1], given a diﬀerential ωof the second kind on
C, there exists a unique diﬀerential ωJof the second kind on Jsuch that̟∗ωJ=π∗
1ω+π∗
2ω.
Moreover the class of ι∗ωJequals that of ωinH1
dR(C). We deduce that any diﬀerential ξof the
second kind on Jis equivalent to one whose image under ̟∗is of the form
(5.12) π∗
1ω+π∗
2ω,
and, moreover, that [ ι∗ξ] = [ω]. Therefore, in order to compute the classes of [ ηi], it will suﬃce to
ﬁnd a representative for ̟∗[ηi,J] of the form (5.12). By [ Bla18, p.66], we have
d(X222) = (3X12X22−X11+2b1X12)Ω1+(3X2
22+2X12+2b1X22+b2)Ω2;
moreover, by deﬁnition, ̟∗Ω1=dx1
2y1+dx2
2y2,̟∗Ω2=x1dx1
2y1+x2dx2
2y2and̟∗X12=−x1x2,̟∗X22=
x1+x2. A computation then shows that
/square (5.13)̟∗(η1,J−d(X222)) =π∗
1η1+π∗
2η1
̟∗(η2,J) =π∗
1η2+π∗
2η2.
Proof of Theorem 5.30. This follows from Lemma 5.17, Remark 5.19, Proposition 5.38 and Lem-
mas 5.39, 5.40. /square
6.Implementation and examples
6.1.Formal group and sigma functions. LetC,RandKbe as in §2.3. Recall that the func-
tions1
X111,Xij
X111andXijk
X111can be expanded as power series over Rin the formal group parameters
T1andT2. Grant proved this by explaining how to use the equations deﬁning JinP8to ob-
tain recursive formulae for the coeﬃcients in the expansion (cf. (2 .21), (2.22) and the surrounding
discussion).
We implemented this recursion (in conjunction with Remark 2.14). As a result, we can compute
the expansions of1
X111,Xij
X111andXijk
X111as power series in T1andT2, up to any desired precision.
Combining this with the addition formulae on Jprovided by [ Gra90, Theorem 3.2], we can then
compute the formal group law F(T,S) = (F1,F2)(T,S) of Theorem 2.15 explicitly, up to any
desired precision.
With the formal group law at hand, the computation of the strict log arithmL= (L1,L2) and of
the naive sigma function are an easy exercise in solving systems of diﬀ erential equations over a
power series ring. Note that (2.3) expresses the derivation Di, for eachi∈ {1,2}, in terms of the
derivatives with respect to T1andT2and the formal group law.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 37
Given the naive sigma function and the strict logarithm L, we can compute the expansion of
any other sigma function using the formula (3.2). We included in Appen dix C the ﬁrst terms in
the expansion of σ(c)
v(T) for an arbitrary curve Cand for arbitrary constants c11,c12,c22(so, in
particular, the coeﬃcients belong to Q[b1,...,b 5][c11,c12,c22]).
6.2.The canonical sigma function. Assume now that Kis the completion of a number ﬁeld
at a non-archimedean place v, and that the assumptions of Theorem 3.6 are satisﬁed. We would
like to compute the canonical v-adic sigma function of Blakestad. By Proposition 3.8, if Kis
an unramiﬁed extension of Qp, this is the v-adic sigma function corresponding to the unit root
eigenspace of Frobenius. While it is possible to compute this space usin g Theorem 3.6(iii), it is
computationally very ineﬃcient.
IfKis isomorphic to Qp, for a prime pgreater than 3, we can alternatively compute the unit
root eigenspace of Frobenius using Kedlaya’s algorithm [ Ked01] and [BB12, Proposition 6.1]. We
explain how to do this in practice and how to deduce the symmetric mat rixbcorresponding to the
unit root eigenspace.
So assume now that Cis deﬁned over Qp, wherepis a prime greater than or equal to 5, of
good reduction for Cand ordinary reduction for J. Consider the characteristic polynomial χ(t) of
Frobenius of the Jacobian of the base-change of CtoFp, which is of the form
χ(t) =t4+a1t3+a2t2+pa1t+p2∈Z[t].
The Jacobian over Fpis ordinary if and only if a2is coprime with p(see for instance [ Yui78,§3]).
In this case, the factorisation
χ(t)≡t4+a1t3+a2t2modp=t2(t2+a1t+a2)
lifts to a factorisation over Zpby Hensel’s lemma. Let χW(b)(t) =t2+ˆa1t+ˆa2∈Zp[t] be the lift
oft2+a1t+a2modpin such a factorisation of χ(t).
LetC/Zpbe the hyperelliptic curve over Zpwhose complement of the section at inﬁnity is the
closed subscheme of A2
Zpdescribed by our usual aﬃne equation for C. Recall that we have
H1
dR(C/Zp)֒→H1
dR(C/Zp)⊗Qp∼=H1
dR(C/Qp),
andthatthisinducesa Qp-linearFrobeniusendomorphismon H1
dR(C/Qp). Thecharacteristicpoly-
nomial of this endomorphism is equal to χ(t) (see, for instance, [ Edi07, Theorem 5.3.2] combined
with Remark 6.1 below). The unit root eigenspace of Frobenius is the 2 -dimensional Frobenius-
invariant Qp-vector subspace W(b)ofH1
dR(C/Qp) on which Frobenius acts with characteristic
polynomial χW(b)(t).
Remark 6.1. Technically speaking, Kedlaya’s algorithm computes the Frobenius ac tion on the
Monsky–Washnitzer cohomology H1
MW(˜C′/Fp,Qp) of the curve ˜C′obtained from the reduction of
Cmodulopby removing the Weierstrass points. Since the odd part of H1
MW(˜C′/Fp,Qp) is isomor-
phic toH1
dR(C/Qp) and the isomorphism is compatible with the Frobenius action on H1
dR(C/Qp)
introduced in §3.2, we will ignore this subtlety. For details, see for instance [ vdB08, Theorem 2.6].
In ordertocompute the diﬀerentials η(b)
1andη(b)
2ofTheorem3.6, weworkdirectly with H1
dR(C/Zp)
and itsZp-linear Frobenius action. As we saw in the proof of Proposition 3.8, un der our running
assumptions, this Zp-module is isomorphicto H0(C,Ω1
C/Zp(4∞))−and the latter is freely generated
by
(6.1) B=/braceleftbiggxidx
2y:i= 0,...,3/bracerightbigg
.
From now on, we identify H1
dR(C/Zp) with the Zp-span of B. The action of Frobenius, denoted by
φ∗, onH1
dR(C/Zp) with respect to Bcan be computed using Kedlaya’s algorithm [ Ked01].
TheQp-vector space W(b)is obtained by tensoring with QptheZp-submodule W(b)
0⊂H1
dR(C/Zp)
deﬁned as the kernel of the expansion at P-mapβP:H1
dR(C/Zp)→H1
dR(ˆCP/Zp), for anyP∈38 FRANCESCA BIANCHI
C(Zp). The diﬀerentials η(b)
1,η(b)
2belong toW(b)
0and, in fact, freely generate it as a Zp-module.
Moreover,H1
dR(C/Zp) is isomorphic to W(b)
0⊕/a\}⌊ra⌋ketle{tdx
2y,xdx
2y/a\}⌊ra⌋ketri}htZp.
Now,
(6.2) φ∗/parenleftbiggdx
2y/parenrightbigg
,φ∗/parenleftbiggxdx
2y/parenrightbigg
∈pH1
dR(C/Zp);
see, for instance, [ Har12, Proof of Lemma 3.4]. In addition, since the determinant of the matr ix of
Frobenius on any basis for W(b)
0is equal to ˜ a2∈Z×
p, we haveφ∗(W(b)
0) =W(b)
0by [Lan02, XIII,
Propositions 3.1 and 4.16]. From these considerations, one deduces the following algorithm to
compute a basis for W(b)
0modulo a prescribed precision. Note that essentially the same result is
stated in higher generality in [ BB12]; however, no distinction seems to be made there between the
Qp-vector space W(b)and theZp-moduleW(b)
0.
Proposition 6.2 ([ BB12, Proposition 6.1]). LetM∈M4(Zp)be the matrix of Frobenius with
respect to B, and letnbe a positive integer. There is a basis for W(b)
0whose coeﬃcients with
respect to Breduce modulo pnto the third and fourth column of Mn.
Using Corollary 6.2, we can compute a basis for W(b)
0modulopn, from which we can deduce η(b)
1,
η(b)
2modulopn.
Remark 6.3. Ifp= 3, the set Bis not a basis for H1
dR(C/Zp) (see [vdB08,§5]). However, with
some extra care, it should be possible to compute the unit root eigen space in a similar way and to
relate this to the canonical sigma function of Blakestad (see Remar k 3.7).
6.3.Division polynomials. In the previous two subsections, we discussed how to compute the
expansion of various sigma functions. Recall that we used division po lynomials to extend a sigma
function outside of its domain of convergence.
In fact, if we want to compute the value of a local N´ eron function u sing Deﬁnition 4.2 or 4.5,
we do not need to compute the division polynomial, but just its value at the point of interest.
Magma[BCP97] code to compute values of division polynomials is provided with [ dJM14]. We
translated this into SageMath , with some minor modiﬁcations (see Remark 6.4).
For the purpose of this problem, we may more generally assume that Cis deﬁned over any char-
acteristic 0 ﬁeld. Let Pbe a point on the Jacobian, away from the theta divisor. The strate gy is
as follows:
(1) For 1 ≤n≤5, Uchida computed φnas a polynomial in the variables ℘ijand℘ijkwith
coeﬃcients in Z[b1,...,b 5]. Evaluating at ℘ij(P),℘ijk(P) givesφn(P) for 1≤n≤5.
(2) Compute φn(P) for 6≤n≤8 using the recurrence relation [ Kan10, Theorem 9 (cor-
rected)]. Since the computation of φ6(P) andφ8(P) requires division by φ2(P), we must
assume that 2 P/\e}atio\slash∈Supp(Θ).
(3) Compute φn(P) recursively for n≥8 using [Uch11b, Example 6.6]. This requires division
by
φ5(P)−φ4(P)φ2(P)3+φ3(P)3,
so the formulae can only be applied when this is non-zero. For neven we further need that
φ2does not vanish at P.
For certain values of n, the code by de Jong–M¨ uller is not directly applicable if either φ2or
φ5−φ4φ3
2+φ3
3vanishes at our point Pof interest. If we are only interested in the value at Pof
the global height hp, we may remedy the situation by computing hp(mP) for a non-zero integer
m, and deducing the value hp(P) by quadraticity. Otherwise, we may compute φn(P) by taking
limits over points approaching Pof the recurrence relations of Steps (2) and (3).
Remark 6.4. The recursion formulae of Step (3) express φ2mandφ2m+1in terms of φkfor
k∈ {2,3,4,5}∪ {m−4,...,m+ 4}. In particular, in order to compute φn, it is not necessary
to compute φkfor allk≤n−1; rather, it suﬃces to compute φkforkin some intervals. We
implemented this improvement. The same trick is used in Harvey’s implem entation [ Har08] on
SageMath ofp-adic heights on elliptic curves.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 39
6.4.p-adic N´ eron functions. In order to compute the p-adic N´ eron functions of Deﬁnitions 4.2
and 4.5, it remains to discuss how to compute a suitable integer mand how to work with an idele
class character for a number ﬁeld Kexplicitly.
The latter problem is discussed in detail in [ BBBM21 ,§2.1]. For the purpose of this work we
restrict the implementation to the case K=Q, for which the Qp-vector space of continuous idele
class characters is one-dimensional, and generated by the cycloto mic character χcyc(cf. [BBBM21 ,
Example 2.7]). Explicitly, we have
χcyc
p(x) = logp(x) for all x∈Q×
p,
where logpis the branch of the p-adic logarithm that vanishes at p, and, forq/\e}atio\slash=p,
χcyc
q(x) = logp|x|q,for allx∈Q×
q.
Thep-adicsigma functions that we are mostly interested in are the naiveo ne and the canonicalone
(when this exists). If pis odd, they both converge on the whole of J1(Qp). Indeed, the canonical
sigma function has integral coeﬃcients, while the convergence of t he naive sigma function is given
by Theorem 3.3(ii).
Therefore, given P∈J(Qp), we need to compute (a multiple of) its order in J(Qp)/J1(Qp). Ifp
is a prime of good reduction, this is the order of ˜Pin the ﬁnite group ˜J(Fp).
Ifpis an odd prime of bad reduction, denote by J0(Qp) the subgroup of J(Qp) consisting of the
points that reduce to the component of the origin in the smooth par t of˜J. We can apply [ BS10,
Remark 5.12, Figure 1] to determine the index of J1(Qp) insideJ0(Qp), and the discussion on
p.294–295 of loc. cit.to determine a multiple of Pthat belongs to J0(Qp). Since it is easy to
check whether a point belongs to J1(Qp), we can alternatively compute successive multiples of
[J0(Qp) :J1(Qp)]P, until we land in J1(Qp). A trial and error strategy can also be applied when
p= 2.
6.5.Example: A prime greater than 106.We now consider the genus 2 curve over Qwith
LMFDB label 160000.c.800000.1 [LMF23]
C:y2=x5−1.
Its Jacobian Jis geometrically simple and has complex multiplication by Q(ζ5), whereζ5is a
primitive ﬁfth root of unity. We shall see that every p≡1 mod 10 is of good ordinary reduction
and that the constants cijcorresponding to the unit root eigenspace for pare all equal to zero. In
particular, they are algebraic and independent of p: compare with Remark 3.11. This enables us
to compute the canonical p-adic N´ eron function at pfor large primes without using Proposition
6.2 explicitly.
Lemma 6.5 ([ Yui78]).Letpbe a prime congruent to 1modulo10. ThenChas good reduction
atp, andJhas good ordinary reduction at p.
Proof.The only primes at which the given equation for Chas bad reduction are 2 and 5. For ordi-
narity, it suﬃces to show that the Cartier–Manin matrix of Cmodulophas non-zero determinant:
see [Yui78, Example 3.3]. /square
Lemma 6.6. Letpbe a prime congruent to 1modulo10. Then the classes of the diﬀerentials
η(0)
1=−3x3dx
2y, η(0)
2=−x2dx
2y
span the unit root eigenspace of Frobenius. In particular, t he canonical sigma function is equal to
the naive sigma function.
Proof.First note that psplits completely in Q(ζ5). TheQ(ζ5)-automorphism ψ: (x,y)/mapsto→(ζ5x,y)
of the curve Creduces to an automorphism ˜φoverFp, and this commutes with the p-th power
Frobenius endomorphism π. Therefore, the lifts of π◦˜ψand˜ψ◦πinduce homotopic maps on40 FRANCESCA BIANCHI
diﬀerentials [ vdP86, Theorem (2.4.4) (iii)] and hence the same map in cohomology. In othe r
words, for every diﬀerential ωof the second kind,
(6.3) ψ∗(φ∗([ω])) =φ∗(ψ∗([ω])).
For eachi∈ {0,1,2,3}, the diﬀerential ωi=xidx
2yis an eigenvector for ψ∗with eigenvalue ζi+1
5.
Therefore, by (6.3), the matrix of Frobenius with respect to Bis diagonal. The result then follows
by (6.2). /square
The lemmas apply to the prime p= 106+ 81 and we shall use them to compute the canonical
p-adic N´ eron function at pfor the point
P= [(−1−i,−2−i)−(−1+i,2−i)]∈JΘ(Q).
The ﬁrst terms of the canonical p-adic sigma function can be deduced from the expansion of
Appendix C by specialising to b1=b2=b3=b4=c11=c12=c22= 0,b5=−1. For this
reason, we omit here the expansion (although the precision of the c omputations below requires
higherT-adic precision than the one given in the appendix).
Letmbe a positive integer such that mP∈J1(Qp)\Supp(Θ). Since mis large, the computation of
mPis expensive. However, if we compute the canonical p-adic sigma function up to O(T1,T2)n, we
can only determine σp(T(mP)) modulopn, and hence there is no advantage in computing Ti(mP)
as a rational number, compared to a p-adic number to precision O(pn). In other words, we may
perform multiplication-by- mon the Jacobian over the p-adics, to a suitable p-adic precision.
The order of J(Fp) ism′= 1001600512000 and the computation of m′Pshows that we may take
m=m′.
Similarly, it suﬃces to compute the value of the m-th division polynomial at Pto ﬁnitep-adic
precision; we do this as outlined in §6.3. Combining the above intermediate computations, we
conclude that the p-adic N´ eron function for the prime p, at the point P, with respect to the idele
class character χcycand the unit root eigenspace of Frobenius is:
λp(P) = 790065 ·p+875980 ·p2+899921 ·p3+943161 ·p4+701712 ·p5
+507099 ·p6+399164 ·p7+725683 ·p8+423209 ·p9+174881 ·p10
+96387·p11+973189 ·p12+88349·p13+970515 ·p14+117600 ·p15
+519019 ·p16+639751 ·p17+971144 ·p18+996211 ·p19+O(p20).
The computation was run on a single core of a 32-core 2 .3GHz AMD Opteron 6276 processor with
256GB RAM. All the computations were run in SageMath [The22] and took approximately 14.3
seconds in total. Of these, 12.6 seconds were needed for the comp utation of the expansion of the
sigma function up to O(T1,T2)21. We computed this as a power series with coeﬃcients in Q, rather
than approximating the coeﬃcients p-adically.
In order to compute the global p-adic height hp(P), we also need to compute the values at Pof
thep-adic N´ eron functions at the primes q/\e}atio\slash=p. First, since
X11(P) = 5, X 12(P) =−2, X 22(P) =−2,
andChas good reduction at all the primes diﬀerent from 2 and 5, by Remar k 4.6(ii) the only
non-trivial contributions can occur at q∈ {2,5}.
The point 2 Preduces to the identity modulo 2, and does not lie on the theta divisor . Therefore,
by Deﬁnition 4.5,
λ2(P) =−1
2logp/vextendsingle/vextendsingle/vextendsingle/vextendsingleT1(2P)
φ2(P)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
2=−1
2logp/vextendsingle/vextendsingle/vextendsingle/vextendsingle2+O(27)
−30/vextendsingle/vextendsingle/vextendsingle/vextendsingle
2= 0.
As far asq= 5 is concerned, by [ BS10, Remark 5.12, Figure 1], the group J0(Q5)/J1(Q5) has order
25. An explicit computation shows that 25 Pdoes not belong to J1(Q5), but 50Pdoes. Hence,
λ5(P) =−2
502logp/vextendsingle/vextendsingle/vextendsingle/vextendsingleT1(50P)
φ50(P)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
5=−1
2·625logp/vextendsingle/vextendsingle/vextendsingle/vextendsingle4·52+O(53)
4·5627+O(5628)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
5=−1
2logp(5).p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 41
In conclusion, the global canonical p-adic height of Pis
hp(P) =λp(P)+λ5(P)
= 227482 ·p+997009 ·p2+96340·p3+795588 ·p4+602398 ·p5
+562446 ·p6+378071 ·p7+977705 ·p8+744905 ·p9+778414 ·p10
+506461 ·p11+834642 ·p12+129041 ·p13+687989 ·p14+134678 ·p15
+452034 ·p16+429426 ·p17+552523 ·p18+572577 ·p19+O(p20).
6.6.Example: Coleman–Gross local heights via N´ eron functions .Let
C:y2=x3(x−1)2+1,
letP1= (1,−1),P2= (0,1)∈X(Q), and letD1=P1−P2,D2=P−
2−P−
1∈Div0(C). The prime
p= 11 is of good reduction for C(and hence for its Jacobian J), and of ordinary reduction for J.
LetW:=W(b)⊂H1
dR(C/Qp) be the unit root eigenspace of Frobenius.
In this subsection, we verify the equalities of Corollaries 5.32 and 5.35 numerically for the pair
of divisors D1,D2, as follows. The Coleman–Gross local p-adic height pairings /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,p,W
and/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,q(q/\e}atio\slash=p) were computed directly from their deﬁnition in [ BBM16,§7.2.1] (the
notation in loc. cit.diﬀers from ours). We check that we obtain the same answer if we ta ke a linear
combination of values of p-adic N´ eron functions satisfying the assumptions of Corollary 5.32 .
Secondly, the divisors D1andD2are linearly equivalent, so, by Corollary 5.35, the sum of the
Coleman–Grosslocal p-adic height pairings on D1,D2is equal to the canonical global p-adic height
hp([D1]). We verify this numerically by computing hp([D1]) (almost) directly from its deﬁnition.
Toeasenotation, wewill from nowonomit the unit rootsubspace Wfrom the subscripts. Consider
the following points in J(Q):
u1=ι(P1) = [P1−∞], u 2=ι(P2) = [P2−∞],
v1= [P−
2−P1], v 2= [P−
2−P2], v 3= [P−
1−P1].
By Example 5.33, the points u1,u2satisfy the assumptions of Corollary 5.32, for any rational
primew=q. With this choice, the equality of the corollary translates to
(6.4) /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,q=−1
2(2λq(v1)−λq(v2)−λq(v3)).
Consider ﬁrst the case q=p. As a preliminary step in the computation of the values of λp
appearing in (6.4), we need to determine the symmetric matrix bcorresponding to the choice of
unit root eigenspace of Frobenius. In this case, we use Kedlaya’s alg orithm as explained in §6.2.
We get
b11= 6+6·11+3·112+6·114+2·115+10·116+117+6·118+9·119+O(1110),
b12= 3+10 ·11+10·112+114+115+5·116+117+3·118+4·119+O(1110),
b22= 4+3·11+6·112+6·113+9·114+10·115+4·116+5·117+2·118+2·119+O(1110).
The ﬁrst terms of the canonical p-adic sigma function can be deduced from the expansion of
Appendix C by specialising to b1=−2,b2= 1,b3=b4= 0,b5= 1,cij=bijfor all 1≤i≤j≤2.
Using Deﬁnition 4.2 with m= 116, 29 and 58, respectively, and the explicit techniques of §6.1–6.4,
we compute:
λp(v1) = 9·11+8·112+8·113+4·114+5·115+10·116+8·117+9·118+O(119),
λp(v2) = 2·113+6·114+10·115+10·116+9·117+10·118+O(119),
λp(v3) = 2·11+4·112+2·113+6·114+2·115+5·116+3·117+118+O(119).
We deduce that
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,p= 3·11+4·112+4·113+114+115+3·116+3·117+7·118+O(119),42 FRANCESCA BIANCHI
which agrees with the computation of [ BBM16] up toO(117), i.e. up to the precision of the
computation in loc. cit.
Next, we consider the prime q= 2. By Deﬁnition 4.5, we have
λ2(v1) =−2
122logp/vextendsingle/vextendsingle/vextendsingle/vextendsingleT1(12v1)
φ12(v1)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
2=−7
6logp(2)
λ2(v2) =−2
32logp/vextendsingle/vextendsingle/vextendsingle/vextendsingleT1(3v2)
φ3(v2)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
2=−2
3logp(2)
λ2(v3) =−2
22logp/vextendsingle/vextendsingle/vextendsingle/vextendsingleT1(2v3)
φ2(v3)/vextendsingle/vextendsingle/vextendsingle/vextendsingle
2= 0,
from which we conclude that
/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,q=5
6logp(2).
Finally, for all q/\e}atio\slash∈ {2,11}, we haveλq(v1) =λq(v2) =λq(v3) = 0, and hence /a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,q= 0,
which completes the numerical veriﬁcation of Corollary 5.32.
As far as the veriﬁcation of Corollary 5.35 is concerned, since 4[ D1] =−v2,
hp([D1]) =hp(v2)
16=1
16(λp(v2)+λ2(v2)) = 8·11+2·114+6·115+6·116+5·117+9·118+O(119),
which equals/summationtext
q/a\}⌊ra⌋ketle{tD1,D2/a\}⌊ra⌋ketri}htN
p,q.
6.7.Integrals of diﬀerentials of the ﬁrst, second and third kind .Let nowpbe any rational
prime (p= 2 is allowed) and let Cbe deﬁned over Qpand given, as usual, by a monic degree 5
model with coeﬃcients in Zp. We make no assumptions on the reduction. By §6.1, we can compute
the expansionofthe strict formalgrouplogarithm L= (L1,L2). By Proposition2.7, this converges
onJ1(Qp). Letu∈J(Qp). It was explained in §6.4 how we can determine a positive integer m
such thatmu∈J1(Qp). Then, for each i∈ {1,2}, the Colmez integral of Ω isatisﬁes
/integraldisplayu
0Ωi=1
mLi(mu).
Letωi=xi−1dx
2yandP1,P2∈C(Qp). By Deﬁnition 2.11 and Theorem 5.2(v), we have
/integraldisplayP1
P2ωi=/integraldisplay[P1−P2]
0Ωi.
In this way, we can compute integrals of holomorphic diﬀerentials on C, without any assumption
on the reduction.
Remark 6.7. For genus 2 curves described by y2=f(x) wheref(x) is a sextic (or quintic) poly-
nomial, the more general formal group description of Flynn [ Fly90,Fly93] can be used to compute
integrals of holomorphic diﬀerentials. See for example [ Fly97] for an application to Chabauty’s
method.
A non-holomorphic closed diﬀerential of the second kind on Jis not translation-invariant, but it
is semi-invariant [ Bar57, Theorem 2.8]. This means that it is linearly equivalent to its pullback
under translation by any u∈J, and hence, in principle, we can use the formal group machinery
to compute the Colmez integral of such a diﬀerential. For example, f ori∈ {1,2}, consider the
diﬀerential (Lemma 5.39)
η(0)
i,J=−X1iΩ1−Xi2Ω2.
Using Theorem 5.2(v) and [ Uch11b, Proposition 4.10], we see that the integral of η(0)
i,Jmust satisfy
/integraldisplaymu
mvη(0)
i,J=m/integraldisplayu
vη(0)
i,J+1
mDi(φm)
φm(u)−1
mDi(φm)
φm(v) (u,v∈J(Qp)).
By choosing mappropriately, the computation of the integral on the left hand sid e can be reduced
to solving a system of diﬀerential equations in the formal group (i.e. over a power series ring);
note that this is in fact an intermediate step in the computation of th ep-adic sigma function.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 43
Pulling back to Cusing (5.13) yields a formula for the integral of η(0)
i. The implementation of
§6.3 does not immediately equip us with a way of computing Di(φm) (since we do not compute
the division polynomials, but only their values); however, one could de rive from the recurrence
relations of Kanayama [ Kan10, Theorem 9 (corrected)] and Uchida [ Uch11b, Example 6.6] (cf.
§6.3) an expression for Di(φm)(u) in terms of φk(u) (k≤m),Di(φk)(u) (k<m) and higher order
derivatives of φkfork≤5.
Finally, Corollary 5.32 provides a formula for the computation of diﬀer entials of the third kind on
Cby means of p-adic N´ eron functions, formula which we tested numerically in §6.6.
In summary, our implementation, although primarily aimed at the comp utation ofp-adic N´ eron
functions and heights, can be adapted to compute integrals of diﬀe rentials of the ﬁrst, second and
third kind on C, and thereby oﬀers an alternative (for the speciﬁc setting of a ge nus 2 odd degree
hyperelliptic curve) to Coleman integration algorithms in good reduct ion due to Balakrishnan–
Bradshaw–Kedlaya and Balakrishnan–Besser [ BBK10,BB12] and Colmez–Vologodsky integration
algorithms in bad reduction due to Katz–Kaya and Kaya [ KK22,Kay22].
7.An application: quadratic Chabauty for bihyperelliptic cu rves
The goal of this section is twofold. Balakrishnan–Besser–M¨ uller [ BBM16,BBM17] described a
Chabauty-like method for computing integral points on odd degree hyperelliptic curves over Q
with genus equal to the Mordell–Weil rank of the Jacobian. This uses an extension of Coleman–
Gross local height pairings to divisors with non-disjoint support, an d the quadraticity of the global
height. The technique is known as quadratic Chabauty (for integral points). The intermediate goal
of the section is to rephrase this method in the genus 2 case in terms of our setup. In fact, we
do not just translate, but rather re-prove, the results of [ BBM16] in terms of N´ eron functions (see
Remark 7.5 below). For this we crucially use results of Stoll [ Sto02] and M¨ uller–Stoll [ MS16].
Our main goal is to describe a quadratic Chabauty-like method for de termining the rational points
on certain genus 4 bihyperelliptic curves X. In particular, we assume that Xhas two genus 2
quotients, each satisfying the assumptions of quadratic Chabaut y for integral points. We then
describe ap-adic locally analytic function on X(Qp), which, when restricted to X(Q), takes values
in a ﬁnite explicit subset of Qp. This is a genus 4 analogue of the quadratic Chabauty method for
genus 2 bielliptic curves of Balakrishnan–Dogra [ BD18]; see also [ Bia20,BP22].
LetCandKbe as in Sections 3 and 4: that is, Kis a number ﬁeld and Cis the curve over K
deﬁned by an equation of the form y2=f(x), wheref(x) is a monic polynomial of degree 5 with
coeﬃcients in the ring of integers of Kand no repeated roots. Fix a prime pand a non-trivial
continuous Qp-valued idele class character χforK. Given a non-archimedean place vofK, letλv
be the local p-adic N´ eron function at v(with respect to a choice of subspace of H1
dR(C/Kv) ifχis
ramiﬁed at v).
Ifχis unramiﬁed at v, we saw (Lemma 4.3) that there exists a ﬁnite index subgroup HvofJ(Kv)
such that, for all u∈Hv\Supp(Θ), the local N´ eron function λvonly depends on the v-adic
valuation of Xij(u), fori,j∈ {1,2}. More generally, we have the following. For u∈JΘ(Kv), let
λnaive
v(u) =−1
nvχv(max
i,j{|Xij(u)|v,1})
and letµv:J(Kv)→Qbe the function of [ MS16, Deﬁnition 3.1]. Then the p-adic N´ eron function
atvis obtained from λnaive
vby adding a correction term:
λv(u) =λnaive
v(u)+1
nvµv(u)χv(πv),
whereπvis a uniformiser in Kv. Denote by kvthe residue ﬁeld of Kv, and let Φ be the component
group of the N´ eron model of Jover Spec( Ov), where Ovis the ring of integers of Kv.
Theorem 7.1 ([ MS16, Theorems 3.10, 11.3, 7.4, Proposition 12.3, Lemma 12.5]).
(i) The set Hv={u∈J(Kv) :µv(u) = 0}is a subgroup of ﬁnite index of J(Kv)containing
J1(Kv).44 FRANCESCA BIANCHI
(ii) The function µvfactors through J(Kv)/Hv.
(iii) For every u∈J(Kv), we have 0≤µv(u)≤ordv(∆)
4, where∆is the discriminant of C.
(iv) LetNbe the exponent of Φ(kv). Then, for every u∈J(Kv), we haveµv(u)∈1
NZ.
Moreover,N≤max{2,⌊ordv(∆)2
3⌋}.
(v) If our ﬁxed equation for Cdetermines a model over Ovwith rational singularities, then µv
factors through Φ(kv).
Consider now the function
νv:{P∈C(Kv) :y(P)/\e}atio\slash= 0,∞} →Qp, ν v(P) =λv(2ι(P))+2
nvχv(2y(P)).
Denote byC(Ov) the set of aﬃne points with coordinates in Ov, with respect to our ﬁxed equation
forC.
Lemma 7.2. Ifχis unramiﬁed at v, the function νvsatisﬁes the following properties:
(i) IfP∈C(Ov)\{P:y(P) = 0}, then
νv(P) =−2
nvχv(max{|f′(x(P))|v,|2y(P)|v})+1
nvµv(2ι(P))χv(πv).
In particular, the set Γv:=νv(C(Ov)\ {P:y(P) = 0})is ﬁnite, and there exists a
computable ﬁnite set Γ′
v⊂Qpsuch that Γv⊂Γ′
v. Ifvis a prime of good reduction for our
equation for C, we may take Γ′
v={0}.
(ii) IfP/\e}atio\slash∈C(Ov), thenνv(P) =8
nvχv(x(P)).
Proof.ForPin the domain of νv, let
νnaive
v(P) =λnaive
v(2ι(P))+2
nvχv(2y(P)).
It follows from [ FS97,§2] that
X22(2ι(P)) = 2x(P), X12(2ι(P)) =−x(P)2,
X11(2ι(P)) =f′(x(P))2−(2y(P))2(6x(P)3+4b1x(P)2+2b2x(P)+b3)
(2y(P))2.
Therefore, if P∈C(Ov), we have
νnaive
v(P) =−2
nvχv(max{|f′(x(P))|v,|2y(P)|v}).
This can take ﬁnitely many values since max {|f′(x(P))|v,|2y(P)|v} ≥ |2Disc(f)|v, where Disc( f)
is the discriminant of f. In particular, if 2Disc( f) is av-adic unit, then νnaive
v(P) vanishes.
IfP/\e}atio\slash∈C(Ov), the coordinates of Psatisfy 2ord v(y(P)) = 5ord v(x(P)). Therefore, since the
numerator of X11(2ι(P)) is monic of degree 8 as a polynomial in x(P), we have
νnaive
v(P) =8
nvχv(x(P)).
It remains to understand how νvdiﬀers from νnaive
v. For this, we apply Theorem 7.1. /square
Assume now for simplicity that K=Q. Recall from §5.1 that every locally analytic group homo-
morphismJ(Qp)→Qparises as an extension to J(Qp) of a formal group homomorphism to Ga.
By abuse of notation, denote by
L= (L1,L2):J(Qp)⊗Qp→Q2
p
theQp-linear map induced by the strict formal group logarithm.
Assumption 7.3. The restriction of LtoJ(Q)⊗Qpis injective.
Remark 7.4. If the rank of J(Q) is at most 2, Assumption 7.3 will often be satisﬁed: if Jis
simple, see [ Wal11, Conjecture 1].p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 45
Under Assumption 7.3, any Qp-linear map J(Q)⊗Qp→Qpis a linear combination of L1and
L2, and any quadratic form J(Q)⊗Qp→Qpis a linear combination of Q={L2
1,L1L2,L2
2}. The
latter applies in particular to the p-adic height hp: there exist α1,α2,α3∈Qpsuch that
(7.1) hp(u) =α1L2
1(u)+α2L1(u)L2(u)+α3L2
2(u) for all u∈J(Q).
Restricting this equality to points of the form 2 ι(P), wherePis a point on C, and writing hpas
a sum of local N´ eron functions, one can use Equation (7.1) and Lem ma 7.2(i) to write down a
locally analytic function ρ:C(Zp)→Qpand a ﬁnite set Γ ⊂Qpsuch thatρ(C(Z))⊂Γ. In other
words, Lemma 7.2 allows us to phrase the quadratic Chabauty metho d of [BBM16] in terms of
p-adic N´ eron functions, in place of local Coleman–Gross height pairin gs.
Remark 7.5. Corollary 5.32 is a comparison result between the Coleman–Gross loca l height
pairings and the p-adic N´ eron functions. However, it only applies to divisors with disjo int support,
while the method of [ BBM16]crucially requires an extension of the Coleman–Grosslocal heights to
arbitrary divisors. Lemma 7.2 allows us to give a direct proof that suit able local N´ eron functions
can alternatively be used. On the other hand, in [ BKM23], we prove a comparison result between
these extended Coleman–Gross local height pairings and the N´ ero n functions, from which the
rephrasing of quadratic Chabauty for C(Z) in terms of the λqis straightforward.
Wealsoobservethattheexplicitexamplesof[ BBM16,BBM17]rely,forthecomputationof L(ι(P)),
on algorithms for Coleman integration on Cbased on Kedlaya’s algorithm [ Ked01]. In our genus
2 setting, we may replace this step with §6.1 (see also §6.7).
We now apply similar ideas to give an explicit quadratic-Chabauty-type method for determining
therational points on certain genus 4 curves that admit degree 2 maps to curve s in the same
form asC. This is an analogue of the explicit quadratic Chabauty method for th e rational points
on genus 2 bielliptic curves due to Balakrishnan–Dogra [ BD18]; our proof is based on the proofs
thereof given in [ Bia20, Proposition 6.5] and [ BP22, Theorem 2.3].
In particular, we give a proof that does not use Kim’s theory [ Kim05,Kim09], but only the proper-
ties of the local N´ eronfunctions that we have described so far. A s such, it is much more elementary
in nature to the general framework of quadratic Chabauty for ra tional points of [ BD18,BDM+19].
Unlike the above discussion on integral points on C, to the author’s knowledge, Proposition 7.6
below is not a rephrasing of a result involving Coleman–Gross local heig hts already appearing in
the literature. On the other hand, using the comparison result of [ BKM23] mentioned in Remark
7.5, it could be rephrased in terms of Coleman–Gross heights.
Suppose that Xis a genus 4 hyperelliptic curve over Qgiven by an equation of the form
(7.2) X:y2=f5x10+f4x8+f3x6+f2x4+f1x2+f0, f i∈Z.
There are maps ϕ1:X→C1,ϕ2:X→C2, to the following curves C1andC2:
C1:y2=x5+f4x4+f3f5x3+f2f2
5x2+f1f3
5x+f0f4
5, ϕ 1(x,y) = (f5x2,f2
5y),
C2:y2=x5+f1x4+f0f2x3+f2
0f3x2+f3
0f4x+f4
0f5, ϕ 2(x,y) = (f0x−2,f2
0yx−5).
Denote byJ1andJ2the Jacobian of C1andC2, respectively, and by Qithe set of quadratic forms
{L2
1,L1L2,L2
2}forJi. LetZ=X(Qp)\{z:x(z)∈ {0,∞}ory(z) = 0}.
Proposition 7.6. Suppose that pis a prime of good reduction for the Equation (7.2), and thatJi
satisﬁes Assumption 7.3 for every i∈ {1,2}, so the global p-adic height on Ji(Q)is equal to the
restriction to Ji(Q)of/summationtext
Q∈Qiα(i)
QQ, for someα(i)
Q∈Qp. The function ρ:Z→Qp, deﬁned by
ρ(z) =λp(2ι(ϕ1(z)))−λp(2ι(ϕ2(z)))−6χp(x(z))
−/summationdisplay
Q∈Q1α(1)
QQ(2ι(ϕ1(z)))+/summationdisplay
Q∈Q2α(2)
QQ(2ι(ϕ2(z))),
can be continued to a locally analytic function ˜ρ:X(Qp)→Qp. Moreover, there exists a ﬁnite and
computable set Υ⊂Qpsuch that
˜ρ(X(Q))⊂Υ.46 FRANCESCA BIANCHI
Proof.At each point in X(Qp)\Z, there are exactly two terms of ρ(z) that have a logarithmic
singularity:
•ifx(z) =∞, the terms are: λp(2ι(ϕ1(z))) and−6χp(x(z));
•ifx(z) = 0, the terms are: −λp(2ι(ϕ2(z))) and−6χp(x(z));
•ify(z) = 0, the terms are: λp(2ι(ϕ1(z))) and−λp(2ι(ϕ2(z))).
In each of the three cases, we claim that the logarithmic singularities coming from the two terms
cancel out. We prove this for x(z) =∞and leave the other cases as an exercise to the reader. So
assumex(z) =∞and lettbe a uniformiser at z, reducing to a uniformiser modulo p: without
loss of generality, we choose t=x−1. Sinceϕ1is unramiﬁed at z, for any local coordinate t1at
ϕ1(z), we havet1(ϕ1(z(t))) =tu(t) for some unit power series u(t)∈Zp[[t]]. By deﬁnition of λp,
the logarithmic term of λp(2ι(ϕ1(z(t)))) is the same as that of −2χp(T1(2ι(ϕ1(z(t))))). By Lemma
B.1, this is −6χp(t) = 6χp(x(t)).
We prove the existence of a ﬁnite computable set Υ for X(Q)\Z(the limiting values will follow
by continuity). If z∈X(Q)\Z, we have
ρ(z) =/summationdisplay
q/ne}ationslash=p(−λq(2ι(ϕ1(z)))+λq(2ι(ϕ2(z)))+6χq(x(z)))
=/summationdisplay
q/ne}ationslash=p(−νq(ϕ1(z))+νq(ϕ2(z))+4χq(f5f−1
0x(z)4)) =:/summationdisplay
q/ne}ationslash=pwq(z).
LetZqbe deﬁned analogously to Z, but for the prime q. We claim that there exists a ﬁnite
computable set Υ qsuch thatwq(Zq)⊂Υq, and, moreover, that we can take Υ q={0}at every
primeqofgoodreduction; thestatementofthe propositionthenfollowsf romthis. Inordertoprove
the existence and properties of Υ q, we analyse the q-adic valuation of x(z) and, correspondingly,
that ofx(ϕ1(z)) andx(ϕ2(z)) and apply Lemma 7.2. We distinguish between two cases:
•ϕ1(z) andϕ2(z) are both integral if and only if −ordq(f5)≤2ordq(x(z))≤ordq(f0).
In this case, each of the three terms in wq(z) takes values in a ﬁnite computable set (by
Lemma 7.2(i) and the fact that χq(x(z)) only depends on the valuation of x(z)).
•In the remaining cases, exactly one of ϕ1(z) andϕ2(z) is integral. Say ϕi(z) is integral
andϕj(z) is not. Then we apply Lemma 7.2(i) to νq(ϕi(z)); moreover, by Lemma 7.2(ii),
(−1)jνq(ϕj(z))+4χq(f5f−1
0x(z)4) = (−1)j4χq(f5f0). /square
Remark 7.7. With Lemma B.1 and Lemma 7.2 on hand, the proof of Proposition 7.6 is ve ry
similar to the proof of the genus 2 case in [ BP22, Theorem 2.3], to which we refer the reader for
more details.
Example 7.8. Consider
X:y2=x10−x6+1
with corresponding genus 2 curves
C1:y2=x5−x3+1, C 2:y2=x5−x2+1.
Letp= 5, letχ=χcycand consider the p-adic local N´ eron functions on C1andC2with respect
to their naive sigma functions. The rank of Ji(Q) is equal to 2 for each i, and the assumptions of
Proposition 7.6 apply.
The discriminants of C1andC2are both equal to 28·7·431. Therefore, with reference to the proof
ofthe proposition, inorderto determineasuitablesetΥwehaveto c omputeΥ q, forq∈ {2,7,431},
which reduces to computing Γ qor a ﬁnite superset Γ′
q(as in Lemma 7.2(i)) for each of C1andC2.
Forq∈ {7,431}, by [Sto02, Proposition 5.2 and Remark below], µqis identically zero on Ji(Qq),
for eachi. Moreover, there is no point in Ci(Zq) for which the function νnaive
qdeﬁned in the proof
of Lemma 7.2 is non-trivial. Therefore, the set Γ qis equal to 0 for each of C1andC2, and Υ = Υ 2.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 47
We omit a proof of the following fact: we may take8
(7.3) Υ 2=/braceleftbigg
0,8
3logp(2),−2logp(2)/bracerightbigg
.
We can compute the expansion of ˜ ρ(z) in every residue disc of the reduction map X(Qp)→˜X(Fp)
and study the set
{z∈X(Qp) : ˜ρ(z)−υ,for someυ∈Υ} ⊇X(Q).
For example, the points in X(Qp) reducing to (0,4)∈X(Fp) are parametrised by t=x
p∈Zpand
˜ρ(z(t)) = 2·5+2·52+(2·52+2·53)t2+(3·53)t4+O(54,t6).
•Ifυ= 0 orυ=−2logp(2) = 5+O(52), the power series ρ(z(t))−υhas no zeros in Zp;
•Ifυ=8
3logp(2) = 2·5+2·52+O(54), the power series ˜ ρ(z(t))−υhas a double root at
t= 0: this corresponds to the rational point (0 ,−1)∈X(Q). The root has multiplicity
two because (0 ,−1) is ﬁxed by the automorphism of Xmapping (x,y) to (−x,y), under
which ˜ρis invariant.
This example is intended as an informal illustration of Proposition 7.6, b ut upon writing down an
argument for (7.3) and more details on how we computed the expans ion of ˜ρ, it could be turned
into a proof that (0 ,−1) is the unique rational point reducing to (0,4) modulo 5. By repeating this
procedure in every residue disc of X(Qp) (possibly in combination with the Mordell–Weil sieve),
it should be possible to determine the full set of rational points X(Q).
Remark 7.9. Proposition7.6is phrased in terms of p-adiclocal N´ eronfunctions, which we deﬁned
in this article for genus 2 curves and, more generally, we can comput e on genus ≤2 curves. As
previously mentioned, the proposition admits a version in terms of Co leman–Gross local height
pairings of a divisor with itself. More generally, in terms of such Colema n–Gross local heights, the
result can be extended to rational points on even genus d−1≥2 hyperelliptic curves of the form:
X:y2=d/summationdisplay
n=0fnx2n, f n∈Z.
Appendix
A.Multiples of points away from the theta divisor. LetKbe a ﬁeld of characteristic 0
and letC:y2=f(x) withf(x)∈K[x] monic, of degree 5, with no repeated roots. Let Jbe the
Jacobian of C. Recall that:
(I) Ifu∈Jis a non-zero point, there exists a unique unordered pair ( P1,P2)∈C(2)such that
u= [P1+P2−2∞]. Moreover, u∈J[2]\{0}if and only if P1andP2are both Weierstrass
points.
(II) [P1+P2−2∞] = 0 if and only if P1=P−
2.
From these the following lemma easily follows.
Lemma A.1. Letu,v,w∈J. Ifu,v,w∈Jlie on the theta divisor, then u+v+w/\e}atio\slash∈Supp(Θ) ,
unlessu=−voru=−worv=−w.
Proof.Letu= [P−∞],v= [Q−∞],w= [R−∞]. Thenu+v+w= [S−∞] if and only if
[P+Q−2∞] = [R−+S−2∞],
which gives the claim by (I) and (II). /square
More involved is the proof of following result.
8Rather than using Lemma 7.2(i), this set was computed using t he comparison results of [ BKM23] mentioned in
Remark 7.5 and the results in [ BBM16,BBM17]. We thank Steﬀen M¨ uller for computing that the set Tof [BBM16,
Theorem 3.1] is equal to {0,−2
3logp(2)}forC1, and to {0,−1
2logp(2)}forC2. The set Υ was deduced from this.48 FRANCESCA BIANCHI
Lemma A.2 ([ dJM14, Lemma 8.1(iii)]). Letu/\e}atio\slash∈J[2]and letkbe an integer. Then at least
one ofku,(k+1)u,(k+2)u,(k+3)uis not in the support of the theta divisor.
The following lemma and its proof are due to S. Gajovi´ c.
Lemma A.3 (Gajovi´ c). Letu1,u2,u3,u4∈Jsuch that none of u1,u2,u3,u4is a torsion point.
Then there exists an integer 1≤m≤41such that none of mu1,mu2,mu3andmu4belongs to
the support of the theta divisor.
Proof.Assume by contradiction that such an integer does not exist. Then we can partition
{1,...,41}into four subsets S1,S2,S3,S4such that if i∈ {1,...,4}andk∈Sithenkui∈
Supp(Θ). By Lemmas A.1 and A.2, the set Sisatisﬁes:
(i) ifk1,k2,k3∈Si(not necessarily distinct), then k1+k2/\e}atio\slash∈Siandk1+k2+k3/\e}atio\slash∈Si;
(ii) ifk,k+1,k+2∈Sithenk+3/\e}atio\slash∈Si.
The repository [ Bia23] contains Magma[BCP97] code to check that there exists no partition of
{1,...,41}into four subsets S1,S2,S3,S4, each satisfying properties (i) and (ii). /square
Remark A.4. In the proof of Lemma A.3, considering both constraints (i) and (ii), rather than
just (i), does not lead to any improvement in the upper bound for m. However, it speeds up the
Magmacomputation.
B.Formal group parameters expansions. LetKvbe the completion of a number ﬁeld Kat
a non-archimedean place v, letOvbe its ring of integers, and let C:y2=f(x), wheref(x) =
x5+b1x4+b2x3+b3x2+b4x+b5∈ Ov[x] has no repeated roots.
Lemma B.1. Suppose that the equation for Chas good reduction and let P= (x,y)∈C(Kv)be
a point reducing to a Weierstrass point modulo v. Then2ι(P)∈J1(Kv)and
T1(2ι(P)) =−2yg1(x)
g2(x), T 2(2ι(P)) =−2yg3(x)
g2(x),
where
g1(x) =f′(x)2−4f(x)(6x3+4b1x2+2b2x+b3)
g2(x) =−g1(x)f′(x)+f(x)˜g2(x)
˜g2(x) = 4x7−8b2x5−32b3x4+4/parenleftbig
b2
2−4b1b3−11b4/parenrightbig
x3
−8(3b1b4+7b5)x2−4(b2b4+8b1b5)x−8b2b5
g3(x) =xg1(x)−2f(x)(x4+b2x2+b4).
In particular, if tis auniformiser at a Weierstrass point P0∈C(Kv)which reduces toa uniformiser
modulov, there exist unit power series u1(t),u2(t)∈ Ov[[t]]and a power series w2(t)∈t2Ov[[t]]
such that
T1(2ι(x(t),y(t))) =/braceleftigg
2t3u1(t)ifP0=∞;
2tu1(t)otherwise.
T2(2ι(x(t),y(t))) =/braceleftigg
2tu2(t) ifP0=∞;
2x(0)tu2(t)+w2(t)otherwise.
Proof.Recalling the formulae for Xij(2ι(P)) used in the proof of Lemma 7.2, we see that
X11(2ι(P)) =g1(x)
4y2, X(2ι(P)) =g3(x)
4y2.
Using the formulae for Xijk([P1+P2−2∞]) of [Gra90, (1.4)], we ﬁnd, taking limits as ( x1,y1)
and (x2,y2) both go to ( x,y), that
X111(2ι(P)) =g2(x)
8y3.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 49
Asfarastheexpansionsin tareconcerned,itsuﬃcestoshowtheclaimforonesuchlocalcoord inate
t, since any other can be obtained from tby multiplication by a unit power series in Ov[[t]].
IfP0=∞, lett=−x2
y. Then
x(t) =t−2+O(1)∈ Ov((t)), y(t) =−t−5+O(t−3)∈ Ov((t))
g1(x(t)) =t−16+O(t−14), g2(x(t)) =−t−24+O(t−22)g3(x(t)) =−t−18+O(t−16).
IfP0= (x0,y0) withy0= 0, then |f′(x0)|v= 1, sinceChas good reduction. If we let t=y
f′(x0),
we have
x(t) =x0+O(t2)∈ Ov[[t]], y(t) =f′(x0)t
g1(x(t)) =f′(x0)2+O(t2), g2(x(t)) =−f′(x0)3+O(t2), g3(x(t)) =x0f′(x0)2+O(t2).
The result follows, upon noticing that the assumption that the equa tion forChas good reduction
implies that v∤2. /square
C.Sigma functions expansion. The expansion of σ(c)
v(T) up to terms of total degree at most
8 is given by:
σ(c)
v(T) =T1+/parenleftbigg1
2b3+1
2c11/parenrightbigg
T3
1+c12T2
1T2+/parenleftbigg1
2c22/parenrightbigg
T1T2
2
+/parenleftbigg3
8b2
3+5
12b2b4−5
3b1b5+7
12b3c11+1
8c2
11+1
3b4c12/parenrightbigg
T5
1
+/parenleftbigg5
6b3c12+1
2c11c12+1
3b4c22−10
3b5/parenrightbigg
T4
1T2+/parenleftbigg1
2c2
12+1
4b3c22+1
4c11c22−1
2b4/parenrightbigg
T3
1T2
2
+/parenleftbigg
−2
3b1c12+1
2c12c22+1
3c11/parenrightbigg
T2
1T3
2+/parenleftbigg
−2
3b1c22+1
8c2
22−1
12b2+1
3c12/parenrightbigg
T1T4
2
+/parenleftbigg5
16b3
3+391
360b2b3b4+13
30b1b2
4+13
30b2
2b5−547
90b1b3b5+439
720b2
3c11+73
120b2b4c11−73
30b1b5c11
+11
48b3c2
11+1
48c3
11+61
90b3b4c12−3
5b2b5c12+1
6b4c11c12+1
18b2
4c22−113
90b4b5/parenrightbigg
T7
1
+/parenleftbigg89
120b2
3c12+49
60b2b4c12−79
15b1b5c12+3
4b3c11c12+1
8c2
11c12+1
3b4c2
12+17
30b3b4c22−3
5b2b5c22
+1
6b4c11c22+4
5b2
4−181
15b3b5−14
3b5c11/parenrightbigg
T6
1T2+/parenleftbigg
−b1b4c12+7
12b3c2
12+1
4c11c2
12+3
16b2
3c22
+5
24b2b4c22−17
6b1b5c22+7
24b3c11c22+1
16c2
11c22+1
2b4c12c22−3
4b3b4−5
2b2b5−1
4b4c11−34
3b5c12/parenrightbigg
T5
1T2
2
+/parenleftbigg
−5
9b1b3c12−1
3b1c11c12+1
6c3
12−11
9b1b4c22
+5
12b3c12c22+1
4c11c12c22+1
6b4c2
22−1
9b2b4+5
18b3c11+1
6c2
11−43
18b4c12−20
3b5c22/parenrightbigg
T4
1T3
2
+/parenleftbigg
−2
3b1c2
12−1
3b1b3c22−1
3b1c11c22+1
4c2
12c22+1
16b3c2
22+1
16c11c2
22−1
24b2b3+1
2b1b4
−1
24b2c11−5
6b3c12+1
2c11c12−9
4b4c22−3
2b5/parenrightbigg
T3
1T4
2
+/parenleftbigg6
5b2
1c12−b1c12c22+1
8c12c2
22−3
5b1c11−41
60b2c12+1
3c2
12−b3c22+1
6c11c22−1
5b4/parenrightbigg
T2
1T5
2
+/parenleftbigg64
45b2
1c22−1
3b1c2
22+1
48c3
22+19
90b1b2−37
45b1c12−77
120b2c22+1
6c12c22−1
15b3+1
18c11/parenrightbigg
T1T6
2
+O(T1,T2)9.50 FRANCESCA BIANCHI
References
[Bak07] H.F. Baker, An introduction to the theory of multiply periodic function s, Cambridge, University Press,
1907.
[Bar57] I. Barsotti, Factor sets and diﬀerentials on abelian varieties , Trans. Amer. Math. Soc. 84(1957),
85–108.
[BB12] J.S. Balakrishnan and A. Besser, Computing local p-adic height pairings on hyperelliptic curves ,
IMRN2012(2012), no. 11, 2405–2444.
[BB15] ,Coleman-Gross height pairings and the p-adic sigma function , J. Reine Angew. Math. 698
(2015), 89–104.
[BBBM21] J.S. Balakrishnan, A. Besser, F. Bianchi, and J.S. M¨ uller,Explicit quadratic Chabauty over number
ﬁelds, Israel J. Math. 243(2021), no. 1, 185–232.
[BBK10] J.S. Balakrishnan, R.W. Bradshaw, and K. Kedlaya, Explicit Coleman integration for hyperelliptic
curves, Algorithmic number theory, Lecture Notes in Comput. Sci., vol. 6197, Springer, Berlin, 2010,
pp. 16–31.
[BBM16] J.S. Balakrishnan, A. Besser, and J.S. M¨ uller, Quadratic Chabauty: p-adic heights and integral points
on hyperelliptic curves , J. Reine Angew. Math. 720(2016), 51–79.
[BBM17] J.S. Balakrishnan, A. Besser, and J.S. M¨ uller, Computing integral points on hyperelliptic curves using
quadratic Chabauty , Math. Comp. 86(2017), no. 305, 1403–1434.
[BCP97] W. Bosma, J. Cannon, and C. Playoust, The Magma algebra system. I. The user language , J. Symbolic
Comput. 24(1997), no. 3-4, 235–265.
[BD18] J.S. Balakrishnan and N. Dogra, Quadratic Chabauty and rational points, I: p-adic heights , Duke
Math. J. 167(2018), no. 11, 1981–2038, With an appendix by J.S. M¨ uller.
[BDCKW18] J.S. Balakrishnan, I. Dan-Cohen, M. Kim, and S. We wers,A non-abelian conjecture of Tate-
Shafarevich type for hyperbolic curves , Math. Ann. 372(2018), no. 1-2, 369–428.
[BDM+19] J.S. Balakrishnan, N. Dogra, J.S. M¨ uller, J. Tuitman, a nd J. Vonk, Explicit Chabauty—Kim for the
split Cartan modular curve of level 13 , Ann. of Math. 189(2019), no. 3, 885–944.
[Ber74] P. Berthelot, Cohomologie Cristalline des Sch´ emas de Caract´ eristique p >0, Lecture Notes in Math-
ematics, Vol. 407, Springer-Verlag, Berlin-New York, 1974 .
[Ber81] D. Bernardi, Hauteur p-adique sur les courbes elliptiques , S´ eminaire de Th´ eorie des Nombres, Paris
1979–80, Progr. Math., vol. 12, Birkh¨ auser, Boston, Mass. , 1981, pp. 1–14.
[Bes04] A. Besser, Thep-adic height pairings of Coleman-Gross and of Nekov´ aˇ r , Number theory, CRM Proc.
Lecture Notes, vol. 36, Amer. Math. Soc., Providence, RI, 20 04, pp. 13–25.
[Bes05] ,p-adic Arakelov theory , J. Number Theory 111(2005), no. 2, 318–371.
[Bes22] ,p-adic heights and Vologodsky integration , J. Number Theory 239(2022), 273–297.
[Bia20] F. Bianchi, Quadratic Chabauty for (bi)elliptic curves and Kim’s conje cture, Algebra Number Theory
14(2020), no. 9, 2369–2416.
[Bia23] ,SageMath code , 2023,https://github.com/bianchifrancesca/padic_heights_g 2.
[BK10] K. Bannai and S. Kobayashi, Algebraic theta functions and the p-adic interpolation of Eisenstein-
Kronecker numbers , Duke Math. J. 153(2010), no. 2, 229–295.
[BKM23] F. Bianchi, E. Kaya, and J.S. M¨ uller, Article in preparation , 2023.
[Bla18] C. Blakestad, On Generalizations of p-Adic Weierstrass Sigma and Zeta Functions , Ph.D. thesis,
University of Colorado, 2018.
[BMS16] J.S. Balakrishnan, J.S. M¨ uller, and W.A. Stein, Ap-adic analogue of the conjecture of Birch and
Swinnerton-Dyer for modular abelian varieties , Math. Comp. 85(2016), no. 298, 983–1016.
[BMS22] A. Besser, J.S. M¨ uller, and P. Srinivasan, p-adic adelic metrics and Quadratic Chabauty I ,
arXiv:2112.03873v3 (2022).
[Bos20] J.-B. Bost, Theta invariants of Euclidean lattices and inﬁnite-dimens ional Hermitian vector bundles
over arithmetic curves , Progress in Mathematics, vol. 334, Birkh¨ auser/Springer , Cham, [2020] ©2020.
[BP22] F. Bianchi and O. Padurariu, Rational points on rank 2 genus 2 bielliptic curves in the LMF DB,
arXiv:2212.11635 (2022).
[BS10] N. Bruin and M. Stoll, The Mordell-Weil sieve: proving non-existence of rational points on curves ,
LMS J. Comput. Math. 13(2010), 272–306.
[CdS88] R.F. Coleman and E. de Shalit, p-Adic regulators on curves and special values of p-adicL-functions ,
Invent. Math. 93(1988), no. 2, 239–266.
[CF96] J.W.S. Cassels and E.V. Flynn, Prolegomena to a middlebrow arithmetic of curves of genus 2,
London Mathematical Society Lecture Note Series, vol. 230, Cambridge University Press, Cambridge,
1996.
[CG89] R.F. Coleman and B.H. Gross, p-adic heights on curves , Algebraic number theory, Adv. Stud. Pure
Math., vol. 17, Academic Press, Boston, Mass., 1989, pp. 73– 81.
[Col82] R.F. Coleman, Dilogarithms, regulators, and p-adicL-functions , Invent. Math. 69(1982), 171–208.
[Col85] R.F. Coleman, Torsion points on curves and p-adic abelian integrals , Ann. of Math. (2) 121(1985),
no. 1, 111–168.
[Col91] ,The universal vectorial bi-extension and p-adic heights , Invent. Math. 103(1991), no. 3,
631–650.p-ADIC SIGMA FUNCTIONS AND HEIGHTS ON JACOBIANS OF GENUS 2 CUR VES 51
[Col98] P. Colmez, Int´ egration sur les vari´ et´ es p-adiques , Ast´ erisque (1998), no. 248, viii+155.
[dJM14] R. de Jong and J.S. M¨ uller, Canonical heights and division polynomials , Math. Proc. Cambridge
Philos. Soc. 157(2014), no. 2, 357–373.
[Edi07] B. Edixhoven, Point counting after Kedlaya , Notes for the EIDMA-Stieltjes graduate course (Lei-
den, 2003) (2007), available at https://math.leidenuniv.nl/reports/files/2007-33.pd f, [Online;
accessed 5 January 2023].
[Fal83] G. Faltings, Endlichkeitss¨ atze f¨ ur abelsche Variet¨ aten ¨ uber Zahlk ¨ orpern, Invent. Math. 73(1983),
no. 3, 349–366.
[Fal84] ,Calculus on arithmetic surfaces , Ann. of Math. (2) 119(1984), no. 2, 387–424.
[Fly90] E.V. Flynn, The Jacobian and formal group of a curve of genus 2over an arbitrary ground ﬁeld ,
Math. Proc. Cambridge Philos. Soc. 107(1990), no. 3, 425–441.
[Fly93] ,The group law on the Jacobian of a curve of genus 2, J. Reine Angew. Math. 439(1993),
45–69.
[Fly97] ,A ﬂexible method for applying Chabauty’s theorem , Compositio Math. 105(1997), no. 1,
79–94.
[Fre93] M.N. Freije, The formal group of the Jacobian of an algebraic curve , Paciﬁc J. Math. 157(1993),
no. 2, 241–255.
[FS97] E. V. Flynn and N. P. Smart, Canonical heights on the Jacobians of curves of genus 2 and th e inﬁnite
descent, Acta Arith. 79(1997), 333–352.
[Gra90] D. Grant, Formal groups in genus two , Journal f¨ ur die reine und angewandte Mathematik 411(1990),
96–121.
[Gro86] B. H. Gross, Local heights on curves , Arithmetic geometry (Storrs, Conn., 1984), Springer, New York,
1986, pp. 327–339.
[Har08] D. Harvey, Eﬃcient computation of p-adic heights , LMS J. Comput. Math. 11(2008), 40–59.
[Har12] M.C. Harrison, An extension of Kedlaya’s algorithm for hyperelliptic curv es, J. Symbolic Comput.
47(2012), no. 1, 89–101.
[Hon70] T. Honda, On the theory of commutative formal groups , J. Math. Soc. Japan 22(1970), 213–246.
[Hri85] P. Hriljac, Heights and Arakelov’s intersection theory , Amer. J. Math. 107(1985), no. 1, 23–38.
[HS00] M. Hindry and J.H. Silverman, Diophantine geometry: An introduction , Graduate Texts in Mathe-
matics, vol. 201, Springer-Verlag, New York, 2000.
[Kan05] N. Kanayama, Division polynomials and multiplication formulae of Jacob ian varieties of dimension
2, Math. Proc. Cambridge Philos. Soc. 139(2005), no. 3, 399–409.
[Kan10] ,Corrections to “Division polynomials and multiplication f ormulae in dimension 2” , Math.
Proc. Cambridge Philos. Soc. 149(2010), no. 1, 189–192.
[Kat73] N.M. Katz, p-adic properties of modular schemes and modular forms , Modular Functions of One
Variable III, Lecture Notes in Mathematics, vol. 350, Sprin ger, Berlin, 1973, pp. 69–190.
[Kat76] ,p-adic interpolation of real analytic Eisenstein series , Ann. of Math. (2) 104(1976), no. 3,
459–571.
[Kat81] ,Crystalline cohomology, Dieudonn´ e modules, and Jacobi su ms, Automorphic forms, represen-
tation theory and arithmetic (Bombay, 1979), Tata Institut e Studies in Mathematics, vol. 10, Springer
Berlin, Heidelberg, 1981, pp. 165–246.
[Kay22] E. Kaya, Explicit Vologodsky integration for hyperelliptic curves , Math. Comp. 91(2022), no. 337,
2367–2396.
[Ked01] K.S. Kedlaya, Counting points on hyperelliptic curves using Monsky-Wash nitzer cohomology , J. Ra-
manujan Math. Soc. 16(2001), no. 4, 323–338.
[Kim05] M. Kim, The motivic fundamental group of P1\ {0,1,∞}and the theorem of Siegel , Invent. Math.
161(2005), no. 3, 629–656.
[Kim09] ,The unipotent Albanese map and Selmer varieties for curves , Publ. Res. Inst. Math. Sci. 45
(2009), no. 1, 89–133.
[KK22] E. Katz and E. Kaya, p-adic integration on bad reduction hyperelliptic curves , Int. Math. Res. Not.
IMRN (2022), no. 8, 6038–6106.
[Lan82] S.Lang, Introduction to Algebraic and Abelian Functions , second ed., Graduate Texts inMathematics,
no. 89, Springer-Verlag, New York, 1982.
[Lan83] ,Fundamentals of Diophantine geometry , Springer-Verlag, New York, 1983.
[Lan02] ,Algebra, revised third ed., vol. 1, Graduate Texts in Mathematics, n o. 211, Springer, 2002.
[LMF23] The LMFDB Collaboration, The L-functions and modular forms database ,http://www.lmfdb.org ,
2023, [Online; accessed 4 January 2023].
[Mat55] A. Mattuck, Abelian varieties over p-adic ground ﬁelds , Ann. of Math. (2) 62(1955), 92–119.
[Mil08] J.S. Milne, Abelian varieties (v2.00) , 2008, available at www.jmilne.org/math/ , [Online; accessed 5
January 2023], pp. 166+vi.
[MS16] J.S. M¨ uller and M. Stoll, Canonical heights on genus-2 Jacobians , Algebra Number Theory 10(2016),
no. 10, 2153–2234.
[MST06] B. Mazur, W. Stein, and J. Tate, Computation of p-adic heights and log convergence , Doc. Math.
(2006), no. Extra Vol., 577–614.52 FRANCESCA BIANCHI
[MT83] B. Mazur and J. Tate, Canonical height pairings via biextensions , Arithmetic and geometry, Vol. I,
Progr. Math., vol. 35, Birkh¨ auser, Boston, Mass., 1983, pp . 195–237.
[MT91] ,Thep-adic sigma function , Duke Math. J. 62(1991), no. 3, 663–688.
[Mum07a] D. Mumford, Tata lectures on theta. I , Modern Birkh¨ auser Classics, Birkh¨ auser Boston, Inc., B oston,
MA, 2007, With the collaboration of C. Musili, M. Nori, E. Pre viato and M. Stillman, Reprint of the
1983 edition.
[Mum07b] ,Tata lectures on theta. II, Jacobian theta functions and diﬀ erential equations , Modern
Birkh¨ auser Classics, Birkh¨ auser Boston, Inc., Boston, M A, 2007, With the collaboration of C. Musili,
M. Nori, E. Previato, M. Stillman and H. Umemura, Reprint of t he 1984 original.
[Nek93] J. Nekov´ aˇ r, Onp-adic height pairings , S´ eminaire de Th´ eorie des Nombres, Paris, 1990–91, Progr .
Math., vol. 108, Birkh¨ auser Boston, Boston, MA, 1993, pp. 1 27–202.
[PR83] B. Perrin-Riou, Sur les hauteurs p-adiques , C. R. Acad. Sci. Paris S´ er. I Math. 296(1983), no. 6,
291–294.
[PR84] ,Hauteurs p-adiques , S´ eminaire de Th´ eorie des Nombres, Paris 1982–83, Progr. Math., vol. 51,
Birkh¨ auser, Boston, Mass., 1984, pp. 233–257.
[Sil94] J.H. Silverman, Advanced topics in the arithmetic of elliptic curves , Graduate Texts in Mathematics,
vol. 151, Springer-Verlag, New York, 1994.
[Sto02] M. Stoll, On the height constant for curves of genus two. II , Acta Arith. 104(2002), no. 2, 165–182.
[The22] The Sage Developers, SageMath, the Sage Mathematics Software System (Version 9. 6), 2022,
http://www.sagemath.org .
[Tri22] M. Trip, A naive p-adic height function on the Jacobians of curves of genus 2 , Master’s thesis,
University of Groningen, 2022.
[Uch11a] Y. Uchida, Canonical local heights and multiplication formulas for th e Jacobians of curves of genus
2, Acta Arith. 149(2011), 111–130.
[Uch11b] ,Division polynomials and canonical local heights on hypere lliptic Jacobians , Manuscripta
Mathematica (2011), no. 134, 273–308.
[vdB08] T. van den Bogaart, About the choice of a basis in Kedlaya’s algorithm , arXiv:0809.1243 (2008).
[vdP86] M. van der Put, The cohomology of Monsky and Washnitzer , Introductions aux cohomologies p-
adiques (Luminy, 1984), no. 23, M´ em. Soc. Math. France (N.S .), 1986, pp. 4, 33–59.
[Vol03] V. Vologodsky, Hodge structure on the fundamental group and its applicatio n top-adic integration ,
Mosc. Math. J. 3(2003), no. 1, 205–247, 260.
[Wal11] M. Waldschmidt, On thep-adic closure of a subgroup of rational points on an Abelian v ariety, Afr.
Mat.22(2011), no. 1, 79–89.
[Wut04] C. Wuthrich, Onp-adic heights in families of elliptic curves , J. London Math. Soc. (2) 70(2004),
no. 1, 23–40.
[Yos98] K. Yoshitomi, On height functions on Jacobian surfaces , Manuscripta Math. 96(1998), no. 1, 37–66.
[Yui78] N. Yui, On the Jacobian varieties of hyperelliptic curves over ﬁeld s of characteristic p >2, Journal
of algebra 52(1978), no. 2, 378–410.
[Zin84] T. Zink, Cartier Theory of Commutative Formal Groups. Translation of Cartiertheorie kommutativer
formaler Gruppen , Teubner-Texte zur Mathematik, vol. 68, BSB B. G. Teubner Ve rlagsgesellschaft,
Leipzig, 1984, available at https://perso.univ-rennes1.fr/matthieu.romagny/arti cles/zink.pdf ,
[Online; accessed 3 January 2022].