arXiv:2401.09595v1  [eess.SP]  17 Jan 20241
Modulating Retroreﬂector-based Satellite-to-Ground
Optical Communications: Sensing and Positioning
Mohammad Taghi Dabiri, Mazen Hasna, Senior Member, IEEE ,
Saud Althunibat, Senior Member, IEEE , and Khalid Qaraqe, Senior Member, IEEE
Abstract —This paper focuses on the optimal design of a
modulated retroreﬂector (MRR) laser link to establish a hig h-
speed downlink for cube satellites (CubeSats), taking into account
the weight and power limitations commonly encountered by
these tiny satellites. To this end, ﬁrst, a comprehensive ch annel
modeling is conducted considering key real channel paramet ers
including mechanical gimbal error, fast steering mirror an gle
error, laser beamwidth, MRR area, atmospheric turbulence, and
channel coherence time. Accordingly, a closed-form expres sion
for the distribution of the received signal is derived and ut ilized
to propose a maximum likelihood based method to sense and
estimate the initial position of the satellite. Subsequent ly, the
distribution of the distance estimation error during the se nsing
phase is formulated as a function of the laser beamwidth and
the gimbal error, which enables us to ﬁne-tune the optimal
laser beamwidth to minimize sensing time. Moreover, using t he
sensing and initial satellite distance estimation, two pos itioning
algorithms are proposed. To compare the performance of the
proposed positioning method, we obtain the lower bound of
the positioning error as a benchmark. Finally, by providing
comprehensive simulations, we evaluate the effect of diffe rent
parameters on the performance of the considered MRR-based
system in both the sensing and positioning phases.
Index Terms —CubeSats, sensing, positioning, LEO satellite,
optical communications, modulating retroreﬂector array.
I. I NTRODUCTION
CUBE Satellites (CubeSats) are tiny box-shaped miniatur-
ized satellites with a form factor of 10 cm cubes and a
mass of no more than 2 kg. This type of small satellites has
rapidly become a popular platform which is mainly launched
into low Earth orbit (LEO) [1]. The global CubeSat market siz e
was valued at 210 million in 2021 and it is expected to reach
USD 857 million by 2030 [2]. However, due to the constraints
on the size dimensions which leads to a small surface area on
their external walls, CubeSats have a small harvestable sol ar
power. Moreover, launch providers may impose limits on the
battery capacity of CubeSats due to safety regulations [3].
Therefore, the available power for the communication paylo ad
is limited to about 2 W [4]. As there is a direct relationship
between transmitted power and receiver signal-to-noise ra tio
Mohammad T. Dabiri and Mazen Hasna are with the Department of Electri-
cal Engineering, Qatar University, Doha, Qatar (e-mail: m. dabiri@qu.edu.qa;
hasna@qu.edu.qa).
S. Althunibat is with the Department of Communication Engin eer-
ing, Al-Hussein Bin Talal University, Ma’an 23874, Jordan ( e-mail:
saud.althunibat@ahu.edu.jo).
K. Qaraqe is with the Department of Electrical and Computer E ngi-
neering, Texas A&M University at Qatar, Doha 23874, Qatar (e -mail:
khalid.qaraqe@qatar.tamu.edu).
This publication was made possible by grant number NPRP14C- 0909-
210008 from the Qatar National Research Fund, QNRF.(SNR), conventional RF links considered for the downlink
of CubeSats have a limited capacity. In addition, due to the
spectrum limitations as well as the limitations related to t he
dimensions of RF antennas, the downlink rate of CubeSats
is limited to a range from tens of kbps to a few Mbps. For
example, one of the high-speed transmitters available in th e
market for CubeSats can achieve a maximum data rate of 4.3
Mbps in the S-band [5]. Such rates are notably lower than the
several hundreds of Mbps to several Gbps typically achieved
by traditional satellites.
Due to unique features like high unlicensed bandwidth, anti -
interception, compact size, and low power consumption, fre e-
space optical (FSO) communication, utilizing laser techno logy,
has gained signiﬁcant appeal in space communications and
serves as a cornerstone for the development of space network s
[6]–[8]. Hence, there has been a signiﬁcant surge in recent
efforts towards the advancement of laser communications
among satellites [9]–[15]. The focus of all these works is
on the design of common links in such a way that the laser
payload includes a receiver (for uplink) and a transmitter ( for
downlink).
The main challenge of CubeSat communication lies in the
downlink due to two main reasons. First, it needs power
supply for data transmission [16], and second, the laser lin k
requires additional hardware to provide precise alignment at
the transmitter side [17], [18]. For a satellite at an altitu de of
500 km, an alignment error of even 5 mrad causes the laser
beam center to deviate by 2,500 m. To compensate for this
deviation, a larger laser beamwidth should be selected whic h
causes a small portion of the transmitted power to be collect ed
by the receiver aperture, and thus, more transmitted power i s
needed to compensate for this loss. Therefore, together wit h
the transmitter system, compact stabilizer and aligner sys tems
must be designed and installed, which, while increasing the
cost and weight, occupy almost the entire space of the cube
and a little space is left for other equipment such as cameras
with stronger lenses.
As an alternative solution, a retroreﬂector-based topolog y
can be employed for downlink [19]–[21]. A retroreﬂector is a
passive element suitable for asymmetric scenarios where on e
of the nodes is constrained by weight and power limitations.
For downlink scenario, the interrogator laser signal is poi nted
from the ground station (GS) toward the modulating retrore-
ﬂector (MRR) array installed on the satellite as shown in Fig .
1. Due to the perpendicular feature of the mirrors to each oth er,
the collected interrogator laser signal by MRR is modulated
(by using a shutter in front of the MRR aperture) and directly2
reﬂected to the GS. Such a topology is usually considered
passive as it does not transmit power. Moreover, in this
topology, there is no need to equip the satellite with aligni ng
devices, which signiﬁcantly reduces the weight, complexit y,
and cost. However, the main challenge of this design is that t he
shutter used in front of the MRR aperture has a low modulation
rate, thereby, most of the retroreﬂector-based applicatio ns are
limited to laser ranging [22], [23].
Given the rapid technological developments, shutter mod-
ulation rates have recently reached close to Gbps [19]–[21]
and they are expected to reach higher modulation rates in
the future. To this end, the analysis and designing of Gbps
communication using MRR array has been the subject of [19],
[21]. However, these analysis and implementations have bee n
tested in drone dimensions. To design the considered high
data rate MRR-based downlink for CubeSat, it is necessary
to pay attention to three important challenges. First, unli ke
the conventional links, here, we have a long round-trip path
that doubles the atmospheric attenuation and also increase s
the intensity of the atmospheric turbulence [24]. Second,
unlike the laser ranging systems which have a frequency in
the order of KHz, for the considered MRR-based downlink,
the received SNR decreases by increasing the data rate. For
instance, for a Gbps downlink, the pulse width reduces to
ns, which decreases the SNR by ≃106times compared to
a KHz laser ranging. Third, the shutter modulation rate is
inversely related to the active area of the shutter which is
denoted by AMRR, and to reach higher data rates, AMRR must
be reduced ( AMRR<0.0001 m2). In this case, the small
AMRR along with the alignment errors can cause more than
200 dB loss. This loss is often called geometrical pointing
loss. For ideal conditions (assuming zero alignment error) , as
the laser beamwidth decreases, the geometrical pointing lo ss
decreases. However, in real conditions, a small beamwidth
makes the system more sensitive to the alignment error and
causes more attenuation. To design a high data-rate MRR-
based laser system, a very accurate alignment system is
required, which itself is a function of the mechanical error s of
the gimbal system, the errors of fast steering mirrors (FSMs ),
and atmospheric turbulence-induced beam wandering. LEO
satellites are orbiting the Earth at a speed of about 7-10 km/ s
and within a short period, they are moving in the ﬁeld of view
(FoV) of the GS. Therefore, in addition to high alignment
accuracy, as shown in Fig. 1b, the sensing and positioning
time of the satellite is also of great importance. A key point
for designing the considered system is that all the mentione d
factors such as mechanical gimbal errors, errors of FSMs, la ser
beamwidth, sensing time, positioning accuracy, and data ra te
are in a chain and highly interdependent. Nevertheless, non e
of the existing literature comprehensively analyzes and mo dels
all these parameters together. In addition, the joint posit ioning,
tracking, and communication methods provided in [25]–[27]
are not applicable for the considered MRR-based topology.
To this end, the optimal design of an MRR-based laser
link to create a high-speed downlink for CubeSat is the main
subject of this work. In particular, considering the import ance
of alignment accuracy, we focus on the analysis and design of
the sensing and positioning systems and study the relations hipbetween the system parameters such as mechanical gimbal er-
ror and FSM alignment error with sensing time and positionin g
accuracy. Finally, we obtain the optimal laser beamwidth to
reduce the sensing time and increase the positioning accura cy.
The contributions of this paper are summarized as follows:
•First, a comprehensive modeling of the round trip channel
between the CubeSat and the GS is performed by taking
into account the real channel parameters such as me-
chanical gimbal error, FSM angle error, laser beamwidth,
MRR area, atmospheric turbulence, atmospheric loss, and
channel coherence time.
•Second, we derive a closed-form expression for the distri-
bution of the received signal as a function of the channel
parameters. We demonstrate that gimbal alignment errors
on the order of mrad result in a signiﬁcant geometrical
pointing loss, making direct satellite positioning unfeas i-
ble.
•Third, an initial sensing phase is designed using Gaussian
acquisition to sense the location of the satellite and make
an initial estimate of the satellite location in the order of
several tens of µrad. For initial estimation, we propose
a maximum likelihood (ML)-based method. Later, to
reduce the complexity of the ML-based method, we
provide a time-averaging algorithm, which can be used
as an input to reduce the complexity of the ML-based
method.
•Forth, we obtain the distribution of the distance es-
timation error in the sensing phase as a function of
laser beamwidth, gimbal error, and the random location
of the satellite in the ambiguity area. This distribution
helps us to analytically obtain the average sensing time
as a function of tunable parameters such as the laser
beamwidth. The distribution expression is employed to
dynamically adjust the optimal value of the laser beam
based on the prevailing channel conditions, aiming to
minimize the sensing time.
•In the subsequent step, leveraging the sensing data and
the initial satellite distance estimation, we proceed to
the positioning phase, and two positioning algorithms
are proposed. Both of them are a function of the initial
estimation error in the sensing phase as well as the FSM
errors. We demonstrate that the optimal laser beamwidth
during the positioning phase is contingent upon the
initially estimated distance obtained in the sensing phase .
In addition, to compare the performance of the proposed
positioning method, we obtain the lower bound of the
positioning error as a benchmark.
•Finally, by providing comprehensive simulations, we
evaluate the effect of different parameters on the per-
formance of the considered MRR-based system in both
phases of sensing and positioning.
II. T HESYSTEM MODEL
In this work, we consider a communication system based
on a set of CubeSats in such a way that each satellite collects
information and images during its orbital movement and send s
them to one or more GSs. As mentioned earlier, the most3
(a)
 (b)
Fig. 1. (a) Visual representation depicting the establishm ent of an MRR-based laser link, wherein the interrogator las er signal is modulated and reﬂected to
the GS without requiring power and stabilizers in the satell ite. (b) Given the satellite’s rapid movement, limited time of availability, and potential tracking
errors in the GS gimbal system, there is a crucial need for swi ft and precise sensing and positioning to reduce the geometr ical pointing loss and create optimal
conditions for establishing a high-data-rate downlink.
important challenge of CubSats is the small dimensions to
use high gain RF antennas, lower transmission power, and
spectrum limitations that limit the transmission rate in th e
order of several hundred kbps to several Mbps. To overcome
this limitation and create satellite downlink with high dat a
rate, we use laser and MRR technologies. The MRR array is
installed on the satellite’s body. As shown in Fig. 1, when th e
satellite enters the FoV of the GS, the interrogator laser si gnal
is pointed towards the satellite. Due to the fact that the MRR
mirrors are perpendicular to each other, the collected lase r
signal is directly reﬂected to the GS. To modulate the reﬂect ed
signal, a shutter with high switching rate is used in front
of the cube retroreﬂector which only requires a low voltage
data driver. To send bit ”0”, the shutter acts as an insulator
and does not reﬂect any signal, while for bit ”1”, it reﬂects
a high percentage of the received signal. In other words, it
modulates the optical intensity similar to on-off keying (O OK)
modulation.
A. Channel Modeling
The considered link consists of multiplying two channel
coefﬁcients of the round-trip optical channel. In addition , the
data rate of MRR is inversely proportional to the MRR’s
aperture area AMRR, and to achieve higher rates, it is necessary
to choose a small AMRR (on the order of AMRR<0.0001 m2).
Therefore, it is necessary to use an MRR array to increase
the SNR similar to [28]. Therefore, at any discrete time k, the
received signal at the GS is modeled as follows:
Pr[k] =Rh[k]Pts[k]+n[k], (1)wherePtis the transmitted interrogator laser power, s[k]is
the transmitted OOK signal, n[k]is the additive thermal noise
with variance N0,Rdenotes the photo-detector responsivity,
and channel coefﬁcient his modeled as
h[k] =hL1hL2hpg (2)
×M/summationdisplay
m=1hps[k,m]hMRR[k,m,θ MRR]ha1[k,m]ha2[m,k],
whereMis the number of the MRRs, and hMRR[k,m,θ MRR]
represents the fraction of power directly reﬂected to the to tal
power collected by the mth MRR, which is a function of the
angles between the incident laser beam and the vector of the
mth MRR denoted by θMRR (for more details please see [29,
Fig. 5]). For θMRR lower than 2 degrees, more than 90% of
the signal is reﬂected [29]. Since for satellite communicat ion,
alignment accuracies in the order of less than mrad is needed,
we can well assume hMRR≃1. By doing this, (2), is simpliﬁed
as:
h[k] =hL1hL2hpgM/summationdisplay
m=1hps[k,m]ha1[k,m]ha2[m,k],(3)
where the parameters in (3) are modeled in the following. hL1
andhL2are the atmospheric attenuation of GS-to-satellite and
satellite-to-GS links, respectively, and are typically mo deled
by the Beer-Lambert law as [30]:
hL1=hL2=hL=e−Zζ, (4)
whereZ≃Hs
sin(ζelev)is the linklength, ζelevis the elevation
angle,Hsis the satellite height, and ζis the scattering4
coefﬁcient which is a function of visibility. hL1andhL2are
equal since the parameters ζandZare the same for both links.
The Gamma-Gamma (GG) distributions is a good candidate
to efﬁciently model weak to strong ranges of atmospheric
turbulence conditions [30], [31] and is formulated as
fG(hai) =2(αβ)α+β
2
Γ(α)Γ(β)hα+β
2−1
aikα−β/parenleftig
2/radicalbig
αβhai/parenrightig
, (5)
wherei∈ {1,2},Γ(·)is the Gamma function and km(·)is the
modiﬁed Bessel function of the second kind of order m. Also,
αandβare respectively the effective number of large-scale
and small-scale eddies, which depend on Rytov variance σ2
R
[31]. For two nodes with different heights, Rytov variance i s
obtained as [31, p. 509]:
σ2
R=2.25k7/6
ℓ
sin11/6(ζelev)/integraldisplayHs
H0C2
n(Zh)(Zh−H0)5/6dZh,(6)
whereH0is the height of GS, and
C2
n(Zh) = 0.00594(V/27)2/parenleftbig
10−5Zh/parenrightbig10exp/parenleftbigg
−Zh
1000/parenrightbigg
+2.7×10−16exp/parenleftbigg
−Zh
1500/parenrightbigg
+C2
n(0)exp/parenleftbigg
−Zh
100/parenrightbigg
,
is the refractive-index structure parameter at height Zhwhich
characterizes the atmospheric turbulence, V(in m/s) is the
speed of strong wind and C2
n(0)(in m−2/3) is a strong nominal
ground turbulence level.
In (3),hps[k,m]is the geometrical pointing loss of the
mth elements of MRR array which is induced due to the
tracking errors of the satellite. Unlike conventional sate llite
optical links, for this topology, we have two round-trip pat hs
that double the atmospheric attenuation and the intensity o f
atmospheric turbulence. Therefore, to compensate for thes e
negative effects, we must reduce the geometrical pointing
loss by using a higher alignment accuracy in the order of
several µrad. In the following sections, with the modeling a nd
technical analysis of geometrical pointing loss, we show th at
to achieve higher alignment accuracy, three different phas es
including (i) acquisition and sensing, (ii) positioning, a nd
(iii) joint communication and tracking must be performed
sequentially. hpgis the geometrical loss of the GS receiver,
and since the MRR reﬂects the laser signal at the same input
angle, it can be well approximated as [29]:
hpg≃4d2
g/w2
zg= 4d2
g/Z2θ2
div, (7)
wherewzgis the optical beamwidth in the GS, and dgis the
aperture radius of the GS.
III. S ENSING AND POSITIONING
A. Background
According to the satellite’s movement on a certain orbit,
the instantaneous location of the satellite is known to the
GS. When the satellite enters the FoV of the GS, the ground
station starts tracking the satellite using a gimbal. The an gular
accuracies of the gimbal are in the order of several mrad
to degrees. In this work, we show that even high-precision
gimbals close to one mrad are not able to establish theconsidered MRR-based downlink, because the round-trip pat h
of the laser signal, along with the high geometrical loss,
reduces the received signal to below the noise level.
Letθge∼ N(0,σ2
θge)represent the angle error of the gimbal
andRge∼ N(0,σ2
ge)represent the spatial error between the
center of the laser beam and the satellite, where σge≃Zσθge.
If we only use the gimbal, a random distance rdsis created
between the satellite and the laser beam center. Let pg= (0,0)
denote the center of the laser beam caused by the gimbal and
ps= (xs,ys)denote the location of the satellite in the x−y
coordinate plane perpendicular to the gimbal axis, where xs∼
N(0,σge)andys∼ N(0,σge). The target is to accurately
estimatepswith respect to pg. We consider a Gaussian beam
at the GS, for which the normalized spatial distribution of t he
received intensity at distance Zis given by [32]
Ir(d,Z) =2
πw2zexp/parenleftbigg
−2(x2+y2)
w2z/parenrightbigg
, (8)
whered= [x,y]is the radial distance vector from the beam
center. Also, wzis the beamwidth at distance Zand can be
approximated as wz≃θdivZ, whereθdivis the optical beam
divergence angle [30]. Since the optimal value of wzchanges
in different phases, we use wzs,wzp, andwzc, respectively,
to denote the beamwidth in the sensing, positioning, and
communication phases. If only the gimbal is used for trackin g,
the geometrical pointing loss caused by each element of the
MRR array (the ratio of the power collected by the mth MRR
to the total power distributed in the laser beam) is obtained
as:
hps[k,m] =2
πw2zs/integraldisplay /integraldisplay
pAm(x,y)exp/parenleftbigg
−2(x2+y2)
w2zs/parenrightbigg
dxdy,
(9)
wherepAm(x,y)is the position of effective aperture area of
themth MRR in x−yplane. Unlike terrestrial links, the
laser beamwidth for satellite communications is on the orde r
of several tens of meters. On the other hand, the dimensions o f
each MRR element are in the order of less than a centimeter,
and the entire MRR array is in the order of a few centimeters.
Therefore, with good accuracy, (9) is simpliﬁed as:
hps[k,m] =hps[k,m′]≃2AMRR
πw2zsexp/parenleftbigg
−2(x2
s+y2
s)
w2zs/parenrightbigg
,
(10)
where(m,m′)∈ {1,...,M}andAMRR is the MRR’s aperture
area. Using (3) and (10), the geometrical pointing loss due t o
the MRR array is obtained as:
hps[k] =1
MM/summationdisplay
m=1hps[k,m]≃2AMRR
πw2zsexp/parenleftbigg
−2(x2
s+y2
s)
w2zs/parenrightbigg
.
(11)
Based on (11), at Z= 500 km andσθge= 5 mrad , we
haveσge= 2500 m, which can cause geometrical pointing
coefﬁcient even lower than -300 dB, and almost in most cases
the reﬂected signal is below the noise level. To increase the
alignment accuracy, simultaneously with gimbal tracking, fast
steering mirrors (FSMs) are used, which have an alignment5
(a)
 (b)
Fig. 2. Two examples of the acquisition and sensing phase: (a ) A random
distribution of laser beams where none of the beams are locat ed near the
satellite and no signal is sensed by the GS; (b) The random dis tribution of
beams is reiterated, until ﬁnally a beam is placed near the sa tellite, and thus,
the received reﬂected power can be sensed by the GS.
accuracy in the order of µrad. However, to achieve such
accuracy using FSM, it must ﬁrst have an accurate positionin g
of the satellite location. To this end, ﬁrst, an angular spac e
acquisition should be performed by FSMs around the axis of
the gimbal. During the acquisition process, as soon as the
laser beam is near the satellite, the geometrical pointing l oss
is reduced and the power reﬂected from the satellite is sense d
by the GS. After satellite sensing, to achieve higher estima tion
accuracy, we enter the positioning phase.
B. Sensing Phase
In this work, we use NmFSM to perform the acquisition
process around the gimbal axis in such a way that at each
moment, each FSM creates a random angle θFi=θ′
Fi+
θei= (θ′
Fxi+θexi,θ′
Fyi+θeyi)around the gimbal axis
fori∈ {1,...,Nm}, where(θ′
Fxi,θ′
Fyi)∼ N(0,σ2
θaq)and
(θexi,θeyi)∼ N(0,σ2
θe). Note that σθaqis a controllable search
parameter that is used by the FSMs for the acquisition and σθe
is the random error of FSMs, which is in the order of µrad.
Therefore, θFicreates a random location pFi= (xFi,yFi)for
theith beam center around the pgin thex−yplane) where


xFi=x′
Fi+xei, yFi=y′
Fi+yei,
(x′
Fi,y′
Fi)∼ N(0,σ2
aq),(xei,yei)∼ N(0,σ2
e),
σaq=Zσθaq, σe=Zσθe.
The distance between the ith beam center and the satellite
locationps= (xs,ys)is obtained as:
ri=/radicalbig
(xFi−xs)2+(yFi−ys)2. (12)
rican also be expressed in ( x,y) coordinate plane as:


ri= (Rxi+xei,Ryi+yei),
Ri= (Rxi,Ryi), rei= (xei,yei),
Rxi=x′
Fi−xs, Ryi=y′
Fi−ys.(13)
To get a better view, two examples of the acquisition and
sensing phase are provided in Fig. 2 for Nm= 3. In Fig.
2a, for sensing the location of the satellite, we see a random
distribution of laser beams (the laser beam footprint of the ith
FSM is denoted by Lsi) that none of the beams are locatednear the satellite, and as a result, no signal is sensed by the
GS. The random distribution of the beams is repeated as in
Fig. 2a, until ﬁnally, as in Fig. 2b, a beam is placed near the
satellite, and as a result, the power reﬂected by the satelli te can
be sensed by the GS. For the sensing phase, we are looking
for methods that decrease the average sensing time Tswhile
increasing the sensing accuracy.
1) Received Power Analysis: The average sensing time is
modeled as:
Ts=NaqTstep, (14)
where alpha represents the average number of repetitions
(same as Fig. 2a) to sense the satellite (same as Fig. 2b),
Tstep=KT bitis the time of each repetition/step, and Tbitis the
bit duration. For example, for OOK modulation with 1 Gbps
data rate, Tbit= 1 ns.Kis an important parameter in sensing
time. As Kbecomes larger, the sensing accuracy improves
at the cost of increasing the sensing time. The appropriate
value for Kdepends on channel parameters such as σ,Naq,
and channel coherence time. The coherence time of the ﬁxed
terrestrial optical channel is in the order of ms. However, d ue
to the high speed of the LEO satellites (about 5-10 thousand
m/s), the average coherence time Tc=KcTbitis reduced to a
few tens of µs. In the simulations, we show that to achieve a
more accurate sense, K=KdKc>> K cto be able to average
on the random coefﬁcients of the channel. In other words, wit h
time averaging, the random negative effects of the channel a re
reduced and we can better estimate the distance between the
satellite and the laser beam center. Moreover, in the sensin g
phase we consider s[k] = 1 . Based on this averaging in the
sensing phase, using (3), (10), and (11), the received reﬂec ted
signal caused by Lsiis modeled as:
Prsi=K/summationdisplay
k=1Pr[k] =RPtKd/summationdisplay
k=1Kc/summationdisplay
k′=1h[k,k′]
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
hsi+K/summationdisplay
k=1n[k]
/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
ns[K],(15)
fori∈ {1,...,Nm}andns[K]∼ N(0,KN0), and
hsi=KchL1hL2hpgKd/summationdisplay
k=1hps,i[k]M/summationdisplay
m=1ha1[k,m]ha2[m,k],
(16)
where, by using (11), the geometrical pointing loss of the ith
FSM is modeled as:
hps,i[k] =2AMRR
πw2zsexp/parenleftbigg
−2(Rxi+xei)2+(Ryi+yei)2
w2zs/parenrightbigg
.
(17)
Theorem 1. For large Kd, the distribution of hsiconditioned
onRiis derived as:
fhsi|Ri(hsi)≃1/radicalbig
2πV(hsi)exp/parenleftbigg
−(hsi−E(hsi))2
2V(hsi)/parenrightbigg
,
(18)
whereV(hsi) =E(h2
si)−E2(hsi), and
E(hsi|Ri) =c2KdME(hps,i|Ri)/parenleftbiggΓ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightbigg2
,
(19)6
E(h2
si|Ri) =KdMc2
2E(h2
ps,i|Ri)/bracketleftigg/parenleftbiggΓ(α+2)Γ(β+2)
α2β2Γ(α)Γ(β)/parenrightbigg2
+(M−1)/parenleftbiggΓ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightbigg4/bracketrightigg
(20)
+c2
2M2K3
d(Kd−1)E2(hps,i|Ri)/parenleftbiggΓ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightbigg4
.
Also,c1=w2
zs
4σ2e,c2=KchL1hL2hpg, andE(hps,i|Ri)and
E(h2
ps,i|Ri)are obtained in (45) and (52), respectively.
Proof: Please refer to Appendix A.
In the sensing phase, due to the large Riand as a result a
weak SNR, it is necessary to consider more time (larger Kd)
for each step and therefore, the analytical results of (18) a re
close to the simulations.
2)RiEstimation: In the sensing phase, in addition to
sensing, we should be able to get an estimate of Rifor use in
the next phase (positioning phase). Using (18), the distrib ution
function of the Prsiconditioned on Riis obtained as:
fPrsi|Ri(Prsi)≃exp/parenleftig
−(Prsi−RPtE(hsi))2
2(R2P2
tV(hsi)+KN0)/parenrightig
/radicalbig
2π(R2P2
tV(hsi)+KN0). (21)
Now, using (21), the ML estimate of Riis obtained as
ˆRi=arg max
RifPrsi|Ri(Prsi)
=arg min
Riln(R2P2
tV(hsi)+KN0)
+(Prsi−RPtE(hsi))2
R2P2
tV(hsi)+KN0. (22)
The problem with estimator (22) is that Riis a continuous
variable and has a wide range from zero to several hundreds
of meters. In addition, to compute each metric, two integral s of
(45) and (52) must be solved, numerically. Therefore, altho ugh
it has an appropriate performance, the computational load i s
high.
Proposition 1. WhenRi>> σe, the PDF of hsicondi-
tioned on Riis obtained in the same way as (18) with
E(hsi|Ri)≃A1eA2R2
i (23)
E(h2
si|Ri)≃A2eA6R2
i+A3e2A2R2
i, (24)
where

A1=c2KdMA1/parenleftig
Γ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightig2
,
A2=KdMc2
2A5/bracketleftig/parenleftig
Γ(α+2)Γ(β+2)
α2β2Γ(α)Γ(β)/parenrightig2
+(M−1)/parenleftig
Γ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightig4/bracketrightig
,
A3=c2
2M2K3
d(Kd−1)A2
1/parenleftig
Γ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightig4
,


A1=2AMRR
πw2zs√
2A3σ2e, A2=2A2
4σ2
e−A3
2A3σ2e,
A3=/parenleftig
2
w2zs+1
2σ2e/parenrightig
, A4=−1
2σ2e
A5=/parenleftig
2AMRR
πw2zs/parenrightig21
2√
2A7σ2
e, A6=(2A2
4σ2
e−A7)
2A7σ2e,
A7=/parenleftig
4
w2zs+1
2σ2e/parenrightig
.Proof: Please refer to Appendix B.
Proposition 2. The PDF of ˆRiconditioned on Riis
obtained as:
fˆRi|Ri(ˆRi)
=2RPtA2A1/radicalbig
2π(R2P2
tV(hsi)+KN0)ˆRieA2ˆR2
i
×exp
−R2P2
tA2
1/parenleftig
eA2ˆR2
i−eA2R2
i/parenrightig2
2(R2P2
tV(hsi)+KN0)
, (25)
where
V(hsi) =A2eA6R2
i+e2A2R2
i(A3−A2
1). (26)
Proof: Please refer to Appendix C.
Using Proposition 2, we can obtain the estimation error
distribution based on important channel parameters such as
wzs,σe, andRiwhich helps us to optimize wzsto reduce
the estimation errors. However, the results of Proposition s 1
and 2 are valid for Ri>> σe(approximately Ri>5σe). For
example, for σe= 3 m, the results are valid for Ri>15m.
Note that according to the conventional values of σge, which
are in the order of several hundred meters to several km, the
probability of the laser beam center being placed close to th e
satellite with Ri<5σeis very low. However, if Ri<5σe,
then the MRR array is located near the laser beam and the
reﬂected received power is suitable enough that we can sense
the satellite even with simpler techniques such as averagin g to
have a good estimate of Rias:
ˆRi=/radicaltp/radicalvertex/radicalvertex/radicalbtwzs
2ln/parenleftigg
2KMhLAMRR
Prsiπw2zs/parenleftbiggΓ(α+1)Γ(β+1)
αβΓ(α)Γ(β)/parenrightbigg2/parenrightigg
.
(27)
The above expression is obtained by assuming large values of
Kdand can provide an initial estimate of Ri. (27) can be used
to limit the search interval of Riin the estimator (22), which
signiﬁcantly reduces its computational load. In the simula tions
section, the estimation accuracy of these methods is examin ed.
3) Sensing Time Analysis: To sense the satellite, the re-
ceived signal power must be greater than the threshold Prth
as
Son|Prsi=/braceleftbigg1, Prsi> Prth,
0, Prsi< Prth.(28)
According to (27), there is a one-to-one and inverse non-
linear relationship between PrsiandˆRiin such a way that
the higher Prsi, the smaller ˆRiis estimated. Therefore, (28)
can be rewritten as follows:
Son|Prsi=/braceleftbigg1,ˆRi> R th,
0,ˆRi< R th,(29)
whereRthis the threshold sensing distance. The sensing
probability of the ith laser beam Liis obtained as:
PS,on,i=/integraldisplay∞
0Prob/braceleftig
ˆRi< R th/vextendsingle/vextendsingleRi/bracerightig
fRi(Ri)dRi
=/integraldisplay∞
0FˆRi(Rth|Ri)fRi(Ri)dRi. (30)7
Fig. 3. The considered topology features ﬁve laser beams, wi th one placed at
the center of the ambiguity circle and the other four symmetr ically positioned
on the circle’s circumference. In each quadrant of the ambig uity circle, the
satellite is consistently covered by three laser beams.
As we show in the positioning phase if the estimation error
|Ri−ˆRi|in the sensing phase is too large, then positioning
is not possible and the sensing phase must be repeated.
Therefore, sensing with an acceptable error can lead to sate llite
positioning. Let us deﬁne Re>|Ri−ˆRi|as the acceptable
error threshold. In this case, (30) is modiﬁed as:
PS,on,i=/integraldisplay∞
0PS,on,i|RifRi(Ri)dRi, (31)
wherePS,on,i|Riis obtained as:
PS,on,i|Ri=Prob/braceleftig
|Ri−ˆRi|< Re,ˆRi< R th/vextendsingle/vextendsingle/vextendsingleRi/bracerightig
=/parenleftig
FˆRi(Rth|Ri)−FˆRi(Ri−Re|Ri)/parenrightig
U(Re−|Ri−Rth|)
+/parenleftig
FˆRi(Ri+Re|Ri)−FˆRi(Ri−Re|Ri)/parenrightig
×(U(Ri−Re)−U(Ri−Rth+Re))
+FˆRi(Ri+Re|Ri)U(Re−Ri), (32)
whereU(x) =/braceleftbigg
1,x >0,
0,x <0.. Using (25) and (32), PS,on,i|Riis
derived in (33), where Q(·)is the well-known Q-function.
Since the sensing phase can be performed by different laser
beamsLsi, the probability of sensing by a set of laser beams
Nmis obtained as:
Ps,on= 1−Ps,off= 1−Nm/productdisplay
i=1Ps,off,i
= 1−Nm/productdisplay
i=1(1−Ps,on,i) = 1−(1−Ps,on,i)Nm,(34)
wherePs,off,iis the probability that the satellite is sensed by
theLsi. Note that Ps,onis the sensing probability for one step.For sensing, we perform acquisition in different time steps to
ﬁnally sense the satellite. According to (14), Naqrepresents
the number of acquisition steps, and Tstep=KdKcTbitis the
time allocated to each step. Therefore, the average time for
sensing the satellite is obtained as:
¯Ts=Tstep¯Naq=Tstep/Ps,on, (35)
where¯Naq= 1/Ps,onis the average number of steps. For
example, if Tbit= 1 ns,Kc= 1000 ,Kd= 1000 , andPs,on=
0.01, then the average number of steps for sensing the satellite
¯Naq= 1/Ps,on= 100 and the average sensing time is ¯Ts=
KdKc¯NaqTbit= 0.1s.
In summary, in this section, the sensing phase was inves-
tigated, which is a function of parameters Re,Kd,Rth,wzs,
σe, andσge. In the simulations, the effect of these parameters
on the accuracy and sensing time is investigated.
C. Positioning Phase
In the sensing phase, in addition to satellite sensing, an
initial estimate of the distance of the satellite relative t o the
ith reﬂected laser beam is made, which can have a tolerable
error as high as Re. Therefore, after the sensing phase, we
know that the satellite is most likely in a circle with radius
Remb=ˆRi+Rearound the center of the ith laser beam.
We call this circle the ambiguity circle. In the positioning
phase, the target is to obtain accurate estimation of the loc ation
of the satellite in the ambiguity circle. Unlike distance, i n
the positioning phase, we need at least three laser beams to
estimate location [33]. Based on this, we propose a topology
based on ﬁve laser beams as we set one laser beam in the
center of the ambiguity circle, and the other four beams are
set symmetrically on the circumference of the ambiguity cir cle
as shown in Fig. 3. In this proposed topology, depending on
the location of the satellite in each quadrant of the ambigui ty
circle, it is always covered by three laser beams. Similar to
the sensing phase, the reﬂected signal received by the ith laser
beam is modeled as:
Prpi=Kd/summationdisplay
k=1P′
rpi[k] =Kd/summationdisplay
k=1(RPtKch[k]+np[k]), (36)
wherenp[k]∼ N(0,KcN0). Similar to the sensing phase,
we represents the distance between the center of the ith
laser beam (denoted by Lpi) and the satellite with ri=
(Rxi+xei,Ryi+yei), whereRi= (Rxi,Ryi),Rxi=xpi−xs,
Ryi=ypi−ys,ppi= (xpi,ypi)is the average location of
Lpi, andps= (xs,ys)is the location of the satellite inside
the ambiguity circle. According to Fig. 3, without loss of
generality, we assume that pp1= (0,0),pp2= (Remb,0),
pp3= (0,Remb),pp4= (−Remb,0), andpp5= (0,−Remb).
Also, similar to the sensing phase, (xei,yei)∼ N(0,σ2
e)are
the spatial pointing errors caused by FSMs and atmospheric
turbulence induced beam wandering. Moreover, due to the
symmetry of the problem, without loss of generality, we
assume that the satellite is always in the quarter of the circ le8
PS,on,i|Ri=
Q
RPtA1/parenleftig
eA2(Ri−Re)2−eA2R2
i/parenrightig
/radicalbig
R2P2
tV(hsi)+KN0
−Q
RPtA1/parenleftig
eA2R2
th−eA2R2
i/parenrightig
/radicalbig
R2P2
tV(hsi)+KN0

U(Re−|Ri−Rth|)
+
Q
RPtA1/parenleftig
eA2(Ri−Re)2−eA2R2
i/parenrightig
/radicalbig
R2P2
tV(hsi)+KN0
−Q
RPtA1/parenleftig
eA2(Ri+Re)2−eA2R2
i/parenrightig
/radicalbig
R2P2
tV(hsi)+KN0

(U(Ri−Re)−U(Ri−Rth+Re))
+
1−Q
RPtA1/parenleftig
eA2(Ri+Re)2−eA2R2
i/parenrightig
/radicalbig
R2P2
tV(hsi)+KN0

FˆRi(Ri+Re|Ri)U(Re−Ri). (33)
that is between Lp1,Lp2, andLp3. UsingR1,R2, andR3, we
obtain the location of the satellite as:/braceleftigg
xs=R2
1−R2
2+R2
emb
2Remb,
ys=R2
1−R2
3+R2
emb
2Remb.(37)
To use (37), the values of R1,R2, andR3are not known and
must be estimated. Unlike the sensing phase, here the values
ofR1,R2, andR3are small (in the order of usually less than
100 m) and thus, it is better to use the proposed method in
(27) to estimate Ris. However, here, the estimation method
in (27) can be performed in two ways. The ﬁrst method is to
estimate ˆRis based on the received Prpi. The second method
is to estimate ˆR′
i[k]based on P′
rpi[k], and ﬁnally estimate ˆRi
by averaging as:
ˆRi=1
KdKd/summationdisplay
k=1ˆR′
i[k]. (38)
Then, substituting the estimated ˆRiinstead of Ris in (37), the
location of the satellite is estimated. In the simulations s ection,
it is shown that the performance of both methods depends on
wz, and the advantages and disadvantages of both methods are
examined.
For comparison, we compare the performance of both
positioning methods with the ideal estimator. For the ideal
estimator, we assume that the receiver noise is zero and the
atmospheric ﬂuctuations are constant and equal to its avera ge
value. In this case, the changes in the received power are onl y
caused by ri. Therefore, for ideal estimator, we obtain:


ˆxs,ideal=/summationtextKd
k=1((Rx1+xe1[k])2+(Ry1+ye1[k])2)
2KdRemb
−/summationtextKd
k=1((Rx2+xe2[k])2+(Ry2+ye2[k])2)
2KdRemb+Remb
2,
ˆys,ideal=/summationtextKd
k=1((Rx1+xe1[k])2+(Ry1+ye1[k])2)
2KdRemb
−/summationtextKd
k=1((Rx3+xe3[k])2+(Ry3+ye3[k])2)
2KdRemb+Remb
2.(39)
Note that (39) is only used as a benchmark to compare the
performance of the positioning methods.
Finally, note that the absolute value of the positioning err or
causes the geometrical pointing loss, which is obtained as
follows:
Rep=/radicalbig
(ˆxs−xs)2+(ˆys−ys)2. (40)
In the simulations, the metric Repis used to evaluate the
effect of different system parameters on the performance of
the positioning phase.TABLE I
PARAMETER VALUES USED IN THE SIMULATION .
IV. S IMULATION RESULTS AND DISCUSSION
In this section, by using simulations, the performance of th e
considered system is examined in both the sensing phase and
the positioning phase. The values of the simulation paramet ers
are provided in Table I, which are based on the typical values
available in the literature [7], [31].
A. Sensing Phase
The sensing phase consists of a random search in the
ambiguous area using several laser beams. This random searc h
is repeated in different time steps until ﬁnally a laser beam is
located at a short distance from the satellite. In this case, the
signal reﬂected from the MRR array can be sensed by the GS.
After that, using the received reﬂected signal, the GS estim ates
Ri. Sensing accuracy depends on the estimation accuracy of
Ri.
To evaluate the accuracy of the proposed methods, in Fig.
4, the PDF of ˆRiis provided for three different values of
Ri= 80 , 120, and 150 m. The results of Fig. 4 are obtained
forwzs= 80 andKd= 500 . By increasing Ri, the geo-
metrical pointing loss increases, and thus, the SNR decreas es.
Therefore, as we expect, the results of Fig. 4 show that with t he
increase of Ri, the variance of the estimation errors increases
and the accuracy of the sensing phase decreases. In other
words, the results show the relationship between sensing ti me
and sensing accuracy. If a large Rthis chosen for the sensing
metric, the sensing time reduces at the cost of lower accurac y
forˆRi.
In Fig. 5, the effect of Kdon the accuracy of ˆRiis investi-
gated. The results of Figs. 5a-5c are plotted for Kd= 10 ,9
60 65 70 75 80 85 90 95 10000.51
(a)
100 105 110 115 120 125 130 135 14000.050.10.15
(b)
130 135 140 145 150 155 160 165 17000.020.04
(c)
Fig. 4. The PDF of ˆRiis provided for wzs= 80 ,Kd= 500 , and three
different values of (a) Ri= 80 m; (b)Ri= 120 m; and (c) Ri= 150 m.
50, and 500, respectively. The results show that with the
increase of Kd, the variance of the estimation errors decreases.
However, since there is a linear relationship between the
sensing time and Kd, this increase in accuracy again comes at
the cost of more sensing time. In addition, by comparing both
provided estimation methods, it can be seen that the ML-base d
estimator has a better performance, and although the initia l
estimation method (averaging-based method) provided in (2 7)
has a lower computational load, it causes an estimation bias
error. Also, the results of both Figs. 4 and 5 show that the
derived analytical expression (provided in Proposition 2) can
accurately model the PDF of ˆRiand can be used for further
analysis.
Unlike conventional optical-based satellite communicati ons,
for the considered MRR-based optical satellite system, wzsis
a very important parameter and plays a decisive role in the
quality and speed of the sensing phase. To this end, the sensi ng
time (characterized by Naq) is plotted versus wzsin Figs. 6a
and 6b for σge= 1 and 2 km. The results are obtained for
Ri= 150 m and three different values of the sensing accuracy
characterized by Re= 5, 10, and 15 m. The results clearly
show the importance of ﬁnding the optimal wzsto reduce the
sensing time. For example, in Fig. 6a, for σge= 1 km, the
optimal values of wzsto estimate Riwith an error of less
thanRe= 5and 15 m are equal to 70 and 90 m, respectively.65 70 75 80 85 90 9500.050.1
(a)
65 70 75 80 85 90 9500.050.10.150.2
(b)
65 70 75 80 85 90 9500.20.40.60.8
(c)
Fig. 5. Investigating the effect of Kdon the accuracy of ˆRifor (a)Kd= 10 ;
(b)Kd= 50 ; and (c) Kd= 500 .
Note that Naqis the average number of steps to sense the
satellite and has a direct linear relationship with the sens ing
time. Also, based on the results of Fig. 6b, with the increase
of theσgefrom 1 km to 2 km (this error is caused by the
tracking error of the mechanical gimbal system), the averag e
number of steps to sense the satellite increases. For exampl e,
for satellite sensing with Re= 10 m, with the increase of
σgefrom 1 km to 2 km, Naqincreases from 46 to 194, which
almost triples the sensing time.
B. Positioning Phase
After sensing the reﬂected signal from the satellite and
estimating the initial value of Ri, we enter the positioning
phase. The target of the positioning phase is to estimate a
more accurate location of the satellite relative to the cent er of
Lp1as shown in Fig. 3. Two parameters, ˆRiandσe, affect the
accuracy of the location estimation in the positioning phas e.
σeis the beam center displacements due to the MRR errors
and atmospheric turbulence-induced beam wandering. In Fig .
7, we ﬁrst evaluate the effect of σeon the positioning errors
forKd= 50 andRemb= 30 m. In this ﬁgure, the positioning
errors caused by two positioning methods are compared with
the ideal positioning obtained based on (39). Note that both
positioning methods have the same computational complexit y.10
2030405060708090100110120130140150050100150200
(a)
20304050607080901001101201301401500200400600800
(b)
Fig. 6. The sensing time (characterized by Naq) versus wzsfor different
values of Reand (a)σge= 1 km; and (b) σge= 2 km.
As we see, for σe= 2 m, the positioning errors of both
methods are almost equal and close to the ideal positioning. It
can be also seen that with the increase of σefrom 2 to 8 m, the
positioning error increases, and the performance of the sec ond
method outperforms the ﬁrst positioning method. Notice tha t
the results of Fig. 7 are for a small value of Remb= 30 m.
In Fig. 8, the effect of Rembon the positioning error is
depicted, where MSE= E(|Rep|2)is plotted versus wzpfor
three different values of Remb= 30 , 55, and 80 m. Note that
Remb=ˆRi+Reand it depends on the value of ˆRiestimated in
the sensing phase. It can be observed that as the MSE increase s
by increasing Remb. Unlike the results of Fig. 7, here, as Remb
increases, the ﬁrst method outperforms the second position ing
method. As a result, for lower values of Remb, it is better
to use the second positioning method, and for larger values
ofRemb, the ﬁrst method has lower errors. Another important
point is that the performance of both estimators is a functio n of
wzp, and for each Remb, the optimal value of wzpis different.
Therefore, the results indicate that during the implementa tion
of such an MRR-based system, the laser transmitter of the GS
must have the ability to change the divergence angle and, as a
result, select the optimal wzpaccording to each instantaneous
value ofRemb.0 0.5 1 1.5 2 2.5 3 3.5 400.511.52
(a)
0 0.5 1 1.5 2 2.5 3 3.5 400.20.40.60.8
(b)
0 0.5 1 1.5 2 2.5 3 3.5 400.20.40.6
(c)
Fig. 7. Evaluating the effect of σeon the positioning errors for (a) Kd= 50 ,
Remb= 30 m, and (a) σe= 2 m; (b)σe= 5 m; and (c) σe= 8 m. The
positioning errors caused by two positioning methods are co mpared with the
ideal positioning obtained based on (39).
20 40 60 80 100 120 14010-1100101102103
Fig. 8. MSE= E(|Rep|2)of positioning error versus wzpfor three different
values of (a) Remb= 30 m; (b)Remb= 55 m; and (c) Remb= 80 m.11
V. C ONCLUDING REMARKS AND FUTURE DIRECTIONS
In this paper, we have focused on the optimal design of
an MRR-based laser link to establish a high-speed downlink
for CubeSats, addressing the weight and power limitations
commonly encountered by these tiny satellites. We have
demonstrated the importance of precise alignment accuracy
for this round-trip downlink with high geometrical pointin g
loss, directing our attention toward the analysis and desig n
of sensing and positioning systems. Moreover, the interpla y
between system parameters, such as mechanical gimbal error
and FSM alignment error has been explored along with their
impacts on the sensing time and the positioning accuracy.
Finally, we have illustrated that achieving high accuracy, which
is a prerequisite for establishing a high-rate link, necess itates
the GS’s capability to optimize and select the optimal diver -
gence angle, effectively controlling the laser beamwidth u nder
various momentary conditions.
After the positioning phase, we have achieved sufﬁcient
alignment accuracy to enter the communication phase. In the
communication phase, the OOK pulse duration is in the order
of ns (whereas it is K=KcKdtimes lower than the received
signal time interval for the sensing and positioning phase) ,
and therefore to increase the SNR, it is necessary to reduce
the laser beamwidth to increase the power of the reﬂected
signal while maintaining high alignment accuracy. On the
other hand, it makes the system sensitive to alignment error s.
Therefore, due to the high speed of the LEO satellite, in the
communication phase, the tracking phase should be used at th e
same time, which can be an attractive topic for future work
of the considered asymmetric MRR-based satellite system.
APPENDIX A
Using (17), the CDF of hps,iconditioned on Riis obtained
as follows:
Fhps,i|Ri(hps,i) =Prob/bracketleftigg
ri>/radicaligg
w2zs
2ln/parenleftbiggπw2zshps,i
2AMRR/parenrightbigg/vextendsingle/vextendsingle/vextendsingleRi/bracketrightigg
= 1−Fri|Ri/parenleftigg/radicaligg
w2zs
2ln/parenleftbiggπw2zshps,i
2AMRR/parenrightbigg/parenrightigg
, (41)
Using (12) and (13), the distribution of riconditioned on Ri
is derived as [34]:
fri|Ri(ri) =r
σ2eexp/parenleftbigg
−r2
i+R2
i
2σ2e/parenrightbigg
I0/parenleftbiggriRi
σ2e/parenrightbigg
. (42)
Using (41) and (42), the PDF of hps,iconditioned on Riis
obtained as:
fhps,i|Ri(hps,i) =fri|Ri/parenleftigg/radicaligg
w2zs
2ln/parenleftbiggπw2zshps,i
2AMRR/parenrightbigg/parenrightigg
×dri
dhps,i
=c1e−R2
i
2σ2e/parenleftig
2AMRR
πw2zs/parenrightigc1hc1−1
ps,iI0
Riwzs/radicalbigg
ln/parenleftig
2AMRR
πw2zshps,i/parenrightig
√
2σ2e
, (43)
where0< hps,i</parenleftig
2AMRR
πw2zs/parenrightig
,c1=w2
zs
4σ2e, andI0(·)is the
modiﬁed Bessel function of the ﬁrst kind with order zero.Now, we deﬁne haM=/summationtextM
m=1ha1[k,m]ha2[m,k]. Here, we
assume that ha1[k,m]s andhas[k,m]s are independent for
m∈ {1,...,M}[28]. To estimate Riusing the ML method,
we need the PDF of hsi. According to (16), hsiconsists of the
multiplication and addition of a large number of independen t
random variables, which are complicated to obtain an ana-
lytical closed-form expression for the PDF of hsi. According
to the central limit theorem, the sum of large independent
random variables tends to the Gaussian distribution functi on.
Therefore, for large Kd, the PDF of hsican be well modeled
by the Gaussian distribution in (18), where its parameters a re
obtained below. It is necessary to note that the MRR array
reduces the intensity of atmospheric ﬂuctuations by creati ng
spatial diversity. In addition, in the sensing phase, due to the
large average values of Ri, a largewzsis selected (in the order
of tens of meters to hundreds of meters), which reduces the
variance of the geometrical pointing loss. Therefore, it ca n be
seen that the Gaussian approximation for hsiis accurate even
forKd>5. Using (16), the expected value of hsiconditioned
onRiis obtained as
E(hsi|Ri) =c2Kd/summationdisplay
k=1E(hps,i[k]|Ri)M/summationdisplay
m=1E(ha1[k,m]ha2[m,k])
=c2KdME(hps,i|Ri)E(ha1)E(ha2) (44)
wherec2=KchL1hL2hpg. Using (43), we have
E(hps,i|Ri) =c1e−R2
i
2σ2e/parenleftig
2AMRR
πw2zs/parenrightigc1/integraldisplay2AMRR
πw2zs
0hc1
ps,i
×I0/parenleftigg
Riwzs/radicaligg
ln/parenleftbigg2AMRR
πw2zshps,i/parenrightbigg/slashigg
√
2σ2
e/parenrightigg
dhps,i.(45)
Anyha1variable that has a GG distribution can be written as
a product of two h1a1andh2a1variables as ha1=h1a1h2a1
[35], where

fh1a1(h1a1) =ααhα−1
1a1
Γ(α)e−αh1a1,
fh2a1(h2a1) =ββhβ−1
2a1
Γ(β)e−βh2a1.(46)
Similarly, we can rewrite ha2=h1a2h2a2. Based on this and
using [36], E(ha1) =E(ha2) =E(ha)is obtained as
E(ha1) =E(h1a1h2a1) =E(h1a1)E(h2a1)
=/integraldisplay∞
0ααhα
1a1
Γ(α)e−αh1a1dh1a1/integraldisplay∞
0ββhβ
2a1
Γ(β)e−βh2a1dh2a1
=Γ(α+1)Γ(β+1)
αβΓ(α)Γ(β). (47)
Substituting (45) and (47) in (44), E(hsi|Ri)is derived in (19).
Now, using (16), the expected value of h2
siconditioned on
Riis obtained as
E(h2
si|Ri) =c2
2E/parenleftigg/parenleftbiggKd/summationdisplay
k=1hpa[k]/parenrightbigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingleRi/parenrightigg
, (48)
where
hpa[k] =hps,i[k]M/summationdisplay
m=1ha1[k,m]ha2[m,k]. (49)12
Due to the independence of hpa[k]s from each other, (48) is
simpliﬁed as
E(h2
si|Ri) =c2
2E/parenleftiggKd/summationdisplay
k=1h2
pa[k]/vextendsingle/vextendsingle/vextendsingle/vextendsingleRi/parenrightigg
+c2
2E/parenleftiggKd/summationdisplay
k=1Kd/summationdisplay
k′=1
k′/negationslash=khpa[k]hpa[k′]/vextendsingle/vextendsingle/vextendsingle/vextendsingleRi/parenrightigg
=Kdc2
2E(h2
pa|Ri)+Kd(Kd−1)E2(hsi|Ri), (50)
where
E(h2
pa[k]|Ri) =E
/parenleftigg
hps,iM/summationdisplay
m=1ha1[m]ha2[m]/parenrightigg2/vextendsingle/vextendsingle/vextendsingle/vextendsingleRi

=E(h2
ps,i|Ri)/bracketleftigg
E/parenleftiggM/summationdisplay
m=1h2
a1[m]h2
a2[m]/parenrightigg
+E/parenleftiggM/summationdisplay
m=1M/summationdisplay
m′=1
m′/negationslash=mha1[m]ha2[m]ha1[m′]ha2[m′]/parenrightigg/bracketrightigg
=E(h2
ps,i|Ri)/bracketleftig
ME2(h2
a1)+M(M−1)E4(ha1)/bracketrightig
.(51)
Using (43), we have
E(hps,i|Ri) =c1e−R2
i
2σ2e/parenleftig
2AMRR
πw2zs/parenrightigc1/integraldisplay2AMRR
πw2zs
0hc1+1
ps,i
×I0/parenleftigg
Riwzs/radicaligg
ln/parenleftbigg2AMRR
πw2zshps,i/parenrightbigg/slashigg
√
2σ2
e/parenrightigg
dhps,i.(52)
Using (10), E(h2
a1) =E(h2
a2) =E(h2
a)is obtained as:
E(h2
a1) =E(h2
1a1h2
2a1) =E(h2
1a1)E(h2
2a1)
=/integraldisplay∞
0ααhα+1
1a1
Γ(α)e−αh1a1dh1a1/integraldisplay∞
0ββhβ+1
2a1
Γ(β)e−βh2a1dh2a1
=Γ(α+2)Γ(β+2)
α2β2Γ(α)Γ(β). (53)
Finally, by substituting (47), (51) (52), and (53) in (50),
E(h2
si|Ri)is obtained in (20).
APPENDIX B
In the sensing phase, in most cases we have Ri>> σe.
Under this condition, (17) is simpliﬁed as:
fri|Ri(ri)≃1/radicalbig
2πσ2eexp/parenleftbigg
−(ri−Ri)2
2σ2e/parenrightbigg
. (54)
Using (17) and (54)
E(hps,i|Ri) =2AMRR
πw2zs/radicalbig
2πσ2e/integraldisplay∞
0exp/parenleftbigg
−2r2
i
w2zs−(ri−Ri)2
2σ2e/parenrightbigg
dri
=A1eA2R2
i (55)
where

A1=2AMRR
πw2zs√
2A3σ2e, A2=2A2
4σ2
e−A3
2A3σ2e,
A3=/parenleftig
2
w2zs+1
2σ2e/parenrightig
, A4=−1
2σ2e.Similarly, E(h2
ps,i|Ri)is derived as:
E(h2
ps,i|Ri)≃A5eA6R2
i/bracketleftbigg
1−erf/parenleftbiggA4Ri√A7/parenrightbigg/bracketrightbigg
(56)


A5=/parenleftig
2AMRR
πw2zs/parenrightig21
2√
2A7σ2e, A6=(2A2
4σ2
e−A7)
2A7σ2e,
A7=/parenleftig
4
w2zs+1
2σ2e/parenrightig
.
Finally, substituting (55) and (56) in (19) and (20), the PDF
ofhsiconditioned on Riis derived in Proposition 1.
APPENDIX C
For large wz, metric (22) is simpliﬁes to:
ˆRi=arg min
Ri(Prsi−RPtE(hsi))2
=arg min
RiRPtE2(hsi)−2PrsiE(hsi). (57)
Using the results of Proposition 1, metric (57) can be also
simpliﬁed as:
ˆRi=arg min
RiRPtA1e2A2R2
i−2PrsieA2R2
i. (58)
By taking the derivative of (58) and setting it equal to zero,
we get:
ˆRi=/radicaligg
1
A2ln/parenleftbiggPrsi
RPtA1/parenrightbigg
. (59)
Using (59), the distribution of ˆRiis obtained as
fˆRi|Ri(ˆRi)
=d
dPrsiProb/bracketleftigg/radicaligg
1
A2ln/parenleftbiggPrsi
RPtA1/parenrightbigg
<ˆRi/vextendsingle/vextendsingle/vextendsingle/vextendsingleRi/bracketrightigg
×dPrsi
dˆRi
=fPrsi|Ri/parenleftig
RPtA1eA2ˆR2
i/parenrightig
×dPrsi
dˆRi. (60)
Using (21), (23), (24) and (60), after some manipulations, t he
PDF ofˆRiis derived in (25).
REFERENCES
[1] N. Saeed, A. Elzanaty, H. Almorad, H. Dahrouj, T. Y . Al-Na ffouri, and
M.-S. Alouini, “CubeSat communications: Recent advances a nd future
challenges,” IEEE Communications Surveys & Tutorials , vol. 22, no. 3,
pp. 1839–1862, 2020.
[2] (2023) Cubesat market trends, demands, forecast to 2030 . [Online].
Available: https://straitsresearch.com/report/
[3] (2023) TECHNICAL RESOURCES: nanoracks and NASA documen t
downloads. [Online]. Available: https://nanoracks.com/ resources/
[4] D. Ochoa, K. Hummer, and M. Ciffone, “Deployable helical antenna for
nano-satellites,” 2014.
[5] (2023) CubeSatShop: ISIS TXS high data
rate S-band transmitter. [Online]. Available:
https://www.cubesatshop.com/product/isis-txs-s-band -transmitter/
[6] L. Li, Z. Xuejiao, Z. Jianhua, X. Changzhi, and J. Yi, “Adv anced space
laser communication technology on cubesats,” ZTE communications ,
vol. 18, no. 4, pp. 45–54, 2021.
[7] H. Kaushal and G. Kaddoum, “Optical communication in spa ce: Chal-
lenges and mitigation techniques,” IEEE communications surveys &
tutorials , vol. 19, no. 1, pp. 57–96, 2016.
[8] M. A. Khalighi and M. Uysal, “Survey on free space optical commu-
nication: A communication theory perspective,” IEEE communications
surveys & tutorials , vol. 16, no. 4, pp. 2231–2258, 2014.13
[9] M. Toyoshima, “Recent trends in space laser communicati ons for small
satellites and constellations,” Journal of Lightwave Technology , vol. 39,
no. 3, pp. 693–699, 2021.
[10] A. Carrasco-Casado and R. Mata-Calvo, “Space optical l inks for com-
munication networks,” in Springer Handbook of Optical Networks .
Springer, 2020, pp. 1057–1103.
[11] A. U. Chaudhry and H. Yanikomeroglu, “Temporary laser i nter-satellite
links in free-space optical satellite networks,” IEEE Open Journal of the
Communications Society , vol. 3, pp. 1413–1427, 2022.
[12] A. U. Chaudhry and H. Yanikomerogl, “Free space optics f or next-
generation satellite networks,” IEEE Consumer Electronics Magazine ,
vol. 10, no. 6, pp. 21–31, 2020.
[13] H. D. Le, P. V . Trinh, T. V . Pham, D. R. Kolev, A. Carrasco- Casado,
T. Kubo-Oka, M. Toyoshima, and A. T. Pham, “Throughput analy sis for
TCP over the FSO-based satellite-assisted internet of vehi cles,” IEEE
Transactions on Vehicular Technology , vol. 71, no. 2, pp. 1875–1890,
2021.
[14] H. D. Le, H. D. Nguyen, C. T. Nguyen, and A. T. Pham, “FSO-B ased
Space-Air-Ground Integrated Vehicular Networks: Coopera tive HARQ
With Rate Adaptation,” IEEE Transactions on Aerospace and Electronic
Systems , 2023.
[15] S. M. Walsh, S. F. Karpathakis, A. S. McCann, B. P. Dix-Ma tthews,
A. M. Frost, D. R. Gozzard, C. T. Gravestock, and S. W. Schediw y,
“Demonstration of 100 Gbps coherent free-space optical com munica-
tions at LEO tracking rates,” Scientiﬁc Reports , vol. 12, no. 1, p. 18345,
2022.
[16] A. Carrasco-Casado, K. Shiratama, D. Kolev, P. V . Trinh , F. Ishola,
T. Fuse, and M. Toyoshima, “Development and space-qualiﬁca tion of
a miniaturized CubeSat’s 2-W EDFA for space laser communica tions,”
Electronics , vol. 11, no. 15, p. 2468, 2022.
[17] F. Ishola, A. Carrasco-Casado, R. Cordova, H. Masui, Y . Munemasa,
P. V . Trinh, T. Fuse, H. Tsuji, M. Cho, and M. Toyoshima, “Char acter-
ization and comparison of CubeSat and drone platform jitter effects on
laser beam pointing stability,” 2022.
[18] D. R. Kolev, A. Carrasco-Casado, P. V . Trinh, K. Shirata ma, F. Ishola,
H. Kotake, J. Nakazono, Y . Saito, H. Kunimori, T. Kubooka et al. ,
“Latest developments in the ﬁeld of optical communications for small
satellites and beyond,” Journal of Lightwave Technology , 2023.
[19] P. V . Trinh, A. Carrasco-Casado, T. Okura, H. Tsuji, D. R . Kolev,
K. Shiratama, Y . Munemasa, and M. Toyoshima, “Experimental channel
statistics of drone-to-ground retro-reﬂected fso links wi th ﬁne-tracking
systems,” IEEE Access , vol. 9, pp. 137 148–137 164, 2021.
[20] B. Born, I. R. Hristovski, S. Geoffroy-Gagnon, and J. F. Holzman, “All-
optical retro-modulation for free-space optical communic ation,” Optics
Express , vol. 26, no. 4, pp. 5031–5042, 2018.
[21] C. Quintana, Q. Wang, D. Jakonis, O. Oberg, G. Erry, D. Pl att,
Y . Thueux, G. Faulkner, H. Chun, A. Gomez et al. , “A high speed
retro-reﬂective free space optics links with UA V,” Journal of Lightwave
Technology , vol. 39, no. 18, pp. 5699–5705, 2021.[22] J. J. Degnan, “A tutorial on retroreﬂectors and arrays u sed in satellite
and lunar laser ranging,” in Photonics , vol. 10, no. 11. MDPI, 2023,
p. 1215.
[23] H.-J. Moon, C.-B. Chae, and M.-S. Alouini, “Performanc e analysis of
passive retro-reﬂector based tracking in free-space optic al communica-
tions with pointing errors,” IEEE Transactions on Vehicular Technology ,
2023.
[24] H.-J. Moon, C.-B. Chae, K.-K. Wong, and M.-S. Alouini, “ Pointing-and-
acquisition for optical wireless in 6G: From algorithms to p erformance
evaluation,” IEEE Communications Magazine , 2023.
[25] M. S. Bashir and M.-S. Alouini, “Optimal power allocati on between
beam tracking and symbol detection channels in a free-space op-
tical communications receiver,” IEEE Transactions on Communications ,
vol. 69, no. 11, pp. 7631–7646, 2021.
[26] M.-C. Tsai, M. S. Bashir, and M.-S. Alouini, “Angle-of- arrival estima-
tion of narrow gaussian beams for mobile fso platforms,” arXiv preprint
arXiv:2307.16002 , 2023.
[27] M. S. Bashir and M.-S. Alouini, “Adaptive acquisition s chemes for
photon-limited free-space optical communications,” IEEE Transactions
on Communications , vol. 69, no. 1, pp. 416–428, 2020.
[28] M. T. Dabiri and M. Hasna, “Performance analysis of modu lating
retroreﬂector array for UA V-based FSO links,” IEEE Communications
Letters , pp. 1–1, 2023.
[29] M. T. Dabiri, M. Rezaee, L. Mohammadi, F. Javaherian, V . Yazdanian,
M. O. Hasna, and M. Uysal, “Modulating retroreﬂector based f ree space
optical link for UA V-to-ground communications,” IEEE Transactions on
Wireless Communications , vol. 21, no. 10, pp. 8631–8645, 2022.
[30] Z. Ghassemlooy, W. Popoola, and S. Rajbhandari, Optical wireless
communications: system and channel modelling with Matlab® . CRC
press, 2019.
[31] L. C. Andrews and R. L. Phillips, “Laser beam propagatio n through
random media.” SPIE, 2005.
[32] B. E. Saleh and M. C. Teich, Fundamentals of photonics . john Wiley
& sons, 2019.
[33] D. Cannizzaro, M. Zaﬁri, D. Jahier Pagliari, E. Patti, E . Macii, M. Pon-
cino, and A. Acquaviva, “A comparison analysis of BLE-based algo-
rithms for localization in industrial environments,” Electronics , vol. 9,
no. 1, p. 44, 2019.
[34] (2016, May) Wolfram research (2010), ricedistribu-
tion, wolfram language function. [Online]. Available:
https://reference.wolfram.com/language/ref/RiceDist ribution.html
[35] G. K. Karagiannidis, T. A. Tsiftsis, and R. K. Mallik, “B ounds for multi-
hop relayed communications in Nakagami-m fading,” IEEE Transactions
on communications , vol. 54, no. 1, pp. 18–22, 2006.
[36] Weisstein, eric w. ”gamma function.” from mathworld–
a wolfram web resource. [Online]. Available:
https://mathworld.wolfram.com/GammaFunction.html