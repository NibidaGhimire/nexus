Experimental full network nonlocality with independent sources and strict
locality constraints
Xue-Mei Gu,1, 2, 3, âˆ—Liang Huang,1, 2, 3, âˆ—Alejandro Pozas-Kerstjens,4, 5, âˆ—Yang-Fan
Jiang,6Dian Wu,1, 2, 3Bing Bai,1, 2, 3Qi-Chao Sun,1, 2, 3Ming-Cheng Chen,1, 2, 3Jun
Zhang,1, 2, 3Sixia Yu,1Qiang Zhang,1, 2, 3Chao-Yang Lu,1, 2, 3and Jian-Wei Pan1, 2, 3
1Hefei National Research Center for Physical Sciences at the Microscale and School of Physical Sciences,
University of Science and Technology of China, Hefei 230026, China
2Shanghai Research Center for Quantum Science and CAS Center
for Excellence in Quantum Information and Quantum Physics,
University of Science and Technology of China, Shanghai 201315, China
3Hefei National Laboratory, University of Science and Technology of China, Hefei 230088, China
4Instituto de Ciencias Matem aticas (CSIC-UAM-UC3M-UCM), 28049 Madrid, Spain
5Departamento de An alisis Matem atico, Universidad Complutense de Madrid, 28040 Madrid, Spain
6Jinan Institute of Quantum Technology, Jinan 250101, China
Nonlocality arising in networks composed of several independent sources gives rise to phenomena
radically dierent from that in standard Bell scenarios. Over the years, the phenomenon of network
nonlocality in the entanglement-swapping scenario has been well investigated and demonstrated.
However, it is known that violations of the so-called bilocality inequality used in previous experi-
mental demonstrations cannot be used to certify the non-classicality of their sources. This has put
forward a stronger concept for nonlocality in networks, called full network nonlocality. Here, we ex-
perimentally observe full network nonlocal correlations in a network where the source-independence,
locality, and measurement-independence loopholes are closed. This is ensured by employing two in-
dependent sources, rapid setting generation, and space-like separations of relevant events. Our
experiment violates known inequalities characterizing non-full network nonlocal correlations by over
ve standard deviations, certifying the absence of classical sources in the realization.
Bell's theorem [1], stating that quantum predictions
are incompatible with local realism, has deeply inu-
enced our understanding of physics. Specically, the
correlations obtained by local measurements on a re-
motely shared quantum system cannot be explained
by a local hidden variable (LHV) model. This is gen-
erally known as Bell nonlocality [2], which has been
conrmed in numerous Bell experiments [3{7] via vi-
olations of Bell inequalities [1, 8]. Apart from its fun-
damental interest, Bell nonlocality has also found nu-
merous applications as an indispensable resource in
device-independent quantum information tasks [9{11].
In the standard Bell tests for LHV models, local in-
uences are mediated by a single, common LHV that
is shared among all the parties. Recently, growing
interest has been devoted to the exploration of Bell
nonlocality in networks (see [12] for a recent review).
The simplest example is the entanglement-swapping
scenario [13], where two independent parties that are
not causally connected can become entangled. While
correlations generated in networks can be contrasted
against standard LHV models, it is more natural and
physically motivated to consider models with inde-
pendent hidden variables that reproduce the network
structure. In the entanglement-swapping network,
this gives rise to the study of bilocal hidden variable
(BLHV) models and the associated phenomenon of
(non)-bilocality [14, 15]. Importantly, recent experi-
ments [16{20] show that there are correlations that ad-
mit a standard LHV model but nonetheless are incom-
âˆ—These authors contributed equally to this work.
(a)
(b)
A
ax
S1
Bilocal hidden variable models (BHVL)
Non-full network nonlocality (Non-FNN)
Î»
B
b
S2
 C
cz
A
ax
S1
Î»1
B
b
S2
 C
czÎ»2
NSFig. 1. A network with sources (blue circles) distributing
physical systems (blue arrows) to three nodes Alice, Bob
and Charlie, represented as A, B, and C (gray squares).
(x;a) and (z;c) are Alice's and Charlie's inputs and out-
puts. Bob performs a joint measurement on his systems
yielding outcomes b.(a)BLHV model, where each source
distributes a dierent LHV ( 1and2).(b)Test for FNN,
where the model to be discarded consists of one LHV and
a general nonlocal source (NS).
patible with a BLHV model (depicted in Fig. 1(a)).
It was recently argued that the violations of the
inequalities characterizing correlations with BLHV
models did not capture all the intricacies of nonlocal-
ity in the entanglement-swapping network [21]. Con-
cretely, the bilocality inequality in [15] can be violated
when just one of the sources is entangled [17]. More
importantly, all its quantum violations can be simu-
lated with a strategy of the form depicted in Fig. 1(b),
this is, keeping one classical source if the other one is
allowed to distribute systems only limited by the no-arXiv:2302.02472v2  [quant-ph]  12 May 20232
signaling principle (e.g., a Popescu-Rohrlich box [22]
that allows stronger-than-quantum correlations) [21].
These systems are currently a hypothetical construct,
but it is useful to consider them in order to be able to
make statements independent of the theory describing
the physical systems involved [23, 24].
In other words, a violation of the bilocality inequal-
ity only guarantees that at least one of the sources
in the network is non-classical. In order to have a
device-independent certication that both sources are
non-classical, one must (i) insert the additional hy-
pothesis that quantum mechanics describes nature at
its fundamental level and (ii) achieve a violation of
the bilocality inequality beyond the value described in
[17]. But if the additional assumption (i) is removed,
no value of the inequality guarantees the absence of
classical sources in the network.
This put forward a stronger, arguably more gen-
uine, denition of network nonlocality, where distri-
butions regarded as interesting are those that cannot
be explained by having at least one classical source,
regardless of the rest. This is known as full network
nonlocality (FNN) [21], and its observation implies
that all the sources used in the network must neces-
sarily uphold some degree of non-classicality. FNN
has been since then observed in experimental realiza-
tions of the entanglement-swapping scenario featuring
three- [25] and four-outcome [26] measurements in the
central party, and in the three-branch star network
[27]. Importantly, the independence of the sources in
these experiments is assumed rather than enforced.
This opens the possibility to the existence of an LHV
simulation of the correlations observed [28], known as
thesource independence loophole . Similarly, the inde-
pendence of the measurement choices and the isolation
of the parties are also assumed, leading to the freedom
of choice and the locality loopholes, respectively.
Here, we report the rst experimental demonstra-
tion of the existence of FNN in quantum theory in a re-
alization where the network structure is strictly guar-
anteed. This is, we show that there exist probabil-
ity distributions generated in quantum networks that
cannot be simulated if one of the sources distributes
classical systems, even if the rest are allowed to dis-
tribute (so far, hypothetical) stronger-than-quantum
systems. We do so by violating the FNN witnesses
of [21] in an optical network that distributes quan-
tum systems generated from independent sources un-
der strict locality conditions, i.e., in which all the par-
ties involved are space-like separated.
FNN in the entanglement-swapping network. FNN
correlations are dened, analogously to standard non-
local ones, as not admitting a specic model. In the
entanglement-swapping scenario, this model is cap-
tured in Fig. 1(b). The correlations generated when
the source S 1is classical (i.e., an LHV) are described
byp(a;b;cjx;z) =R
d()p(ajx;)p(b;cj;z), where
() is the probability distribution characterizing the
LHVbetween Alice and Bob, p(ajx;) is Alice's
response function, and p(b;cj;z) is a joint response
function for Bob and Charlie, which in general is onlyconstrained by no-signaling (i.e., byP
cp(b;cj;z) =
p(bj) andP
bp(b;cj;z) =p(cjz)). To establish
FNN, one needs to consider also the case with in-
terchanged sources. Ref. [21] showed that, in
the entanglement-swapping scenario when a;c;z;x2
f0;1gandb2f0;1;2g, the simultaneous violation of
both the following inequalities certies FNN:
RC-NS :=2hA0B1(C0 C1)i+hA1B0(2C0+C1)i
 hB0i+ (hA1B0i+hB0C0i hC0i)hC1i3;
(1)
and
RNS-C :=2hA0B1(C0 C1)i+hA1B0(C0+ 2C1)i
 hB0i+hA1i(hA1B0i+hB0C1i
+hC0 C1 A1i)3;
(2)
where expectation values are computed following [15],
namelyhAxB0Czi=P
a;b;c( 1)a+c+[b>1]p(a;b;cjx;z)
andhAxB1Czi=P
a;b2f0;1g;c( 1)a+b+cp(a;b;cjx;z),
the function [ p] evaluating to 0 if pis true and to 1
otherwise (see Appendix A for further details).
Importantly, these inequalities can be violated si-
multaneously in quantum networks [21, App. F]. Take
both sources to emit a Bell state j+i, Alice and Char-
lie to perform measurements Ax2fX;ZgandCz2
fZ+Xp
2;Z Xp
2g, whereXandZare the Pauli operators,
and Bob to perform a partial Bell state measurement
(BSM) with three outputs f+; ;1 +  g
that are correspondingly associated to the outcomes
b2 f0;1;2g, where =jihj. The result-
ing distribution p(a;b;cjx;z) leads to the violations
RC-NS =RNS-C = 5=p
23:5355.
Experimental realization. We implement this in a
photonic network, illustrated in Fig. 2(a). Two inde-
pendent sources S 1and S 2distribute entangled pho-
tons to three separate observers Alice, Bob, and Char-
lie. Each source generates a polarization-entangled
statej'ii= cos 2ijHHi+ sin 2ijVVivia type-0
spontaneous parametric down-conversion (SPDC), as
shown in Fig. 2(b). In each source, a pulse pattern
generator (PPG) sends 250 MHz trigger signals to
drive a distributed feedback (DFB) laser such that
its electric current switches from much below to well
above the lasing threshold, indicating that the phase
of each generated pump pulse is randomized [31]. In
this way, we erase any quantum coherence between the
pump pulses and disconnect the two SPDC processes
on each experimental trial, thus closing the source-
independence loophole under the reasonable assump-
tion that hidden variables are created together with
state emission (further details see Refs. [19, 29]).
At the central node, Bob sandwiches polarization
beam splitters (PBSs) between two half-wave plates
(HWP@22.5) to realize a partial BSM [30] that dis-
tinguishes Bell states j+i,j i, and a remaining
group of Bell states fj	+i,j	 ig(which is 1 
+  ) by the coincidence detection among the
pseudo-number-resolving detectors depicted as D H1,
DV1, DH2, and D V2in Fig. 2(c). Bob's photon detec-3
PPG
DFB
DM OPMEDFA
QRNG
@45Â°
@-45Â°
PM
TDC
010...DH1DV1 DH2
@22.5Â°
DV2
FPGA
100011...IMPC
DWDMFR(b) (c) (d)
filterSNSPD
(a)
PPMgLNcouplerFBG
PBSHWP QWP
BS
S1 / S2 B A / CB
S2S1
A
C
104m
89m 110m
106m132.0Â° 178.7Â°
174.1Â°
N
Î¸icompensator
HWPi
Fig. 2. Experimental realization. (a)Overview of our quantum network with two independent sources (S 1and S 2)
and three nodes (Alice, Bob, and Charlie, represented as A, B, and C). Geographic picture is taken from Google Maps,
Â©2022 Google. (b)By pumping a periodically poled MgO doped lithium niobate (PPMgLN) crystal in a Sagnac
loop, photon pairs in the state j'ii= cos 2ijHHi+ sin 2ijVViare created via SPDC in each source, where iis the
angle of HWP imounted on a motorized rotator. The pulse pattern generator (PPG) in S 1acts as a master clock for
synchronizing all devices (see Refs. [19, 29] for details). (c)Bob performs a partial Bell state measurement [30] and his
photon detection events are real-time analyzed and recorded by a eld-programmable gate array (FPGA). (d)Alice and
Charlie measure their photons according to the inputs from their private quantum random number generators (QRNGs).
Their detection events and setting choices are recorded by a time-to-digital converter (TDC). See the appendices for
more details. IM, intensity modulator; EDFA, erbium-doped ber amplier; PC, polarization controller; DM, dichroic
mirror; OPM, o-axis parabolic mirror; DWDM, dense wavelength-division multiplexer; FBG, ber Bragg grating; PBS,
polarizing beam splitter; HWP, half-wave plate; QWP, quarter-wave plate; BS, beam splitter; SNSPD, superconducting
nanowire single photon detector; FR, Faraday rotator; PM, electro-optic phase modulator.
tions are analyzed in real time and recorded by a eld-
programmable gate array. Once Bob obtains a BSM
output, he sends the corresponding timestamps infor-
mation to Alice and Charlie. We implement a high-
speed, high-delity, single-photon polarization ana-
lyzer at a rate of 250 MHz at Alice's and Charlie's
location (Fig. 2(d)), where the measurement choice
depends on random bits produced from private fast
quantum random number generators (QRNGs), see
Appendix C. All random bits from the QRNGs pass
the NIST randomness tests [32] (for more details, see
Refs. [19, 29, 33]). All setting results and detections
are locally recorded by their time-to-digital converters
that are fed with Bob's timestamps information. All
locally stored data are collected by a separate com-
puter, in which we post-select the four-photon coinci-
dence events by aligning all to Bob's BSM timestamps
and use the four-photon coincidences for RC-NS and
RNS-C.
We conrm the space-time conguration and char-
acterize the delays of all relevant events, namely: (1)
emission (S 1and S 2), i.e., the photon creation events
in the sources; (2) the choice of measurement setting
(QRNGAand QRNGC), i.e., completing the quantum
random number generation at Alice's and Charlie's
nodes for choosing their measurements; and (3) the
measurement (M A, MB, and M C), i.e., nishing the
single photon detection by Alice, Bob, and Charlie.In the experiment, the time reference to synchronize
all events is set to the 12.5 GHz internal microwave
clock of the PPG in source S 1[29]. By employing
QRNG and space-like separating setting choice and
measurement on one side from the measurement on
other sides, we close the locality loophole. By space-
like separating setting choice events from state cre-
ation events (which is also the origin of a hidden vari-
able), we also close the measurement-independence
loophole. Finally, the emission at S1is spacelike sep-
arated from Charlie's measurement, and analogously
for Alice's measurement and the emission at S2. The
details about the space-like separation of all relevant
events are shown in Fig. 3 and Appendix D.
Results. We obtain visibilities of (97 :100:35)%
and (98:600:07)% for statesj+igenerated in the di-
agonal polarization basis for sources S 1and S 2, respec-
tively, at an average photon pair number per pulse of
0.007. The Hong-Ou-Mandel measurement by Bob
yields a tted visibility of (94 :32:7)%. We then
study the distributions p(a;b;cjx;z) generated in our
network with dierent states computing their corre-
sponding values of RC-NS andRNS-C (see Appendix
B). For simplicity, we x one source creating j+iand
then automatically rotate the phase iin the other
source with a motorized rotator at a phase interval
of=16, having a total of 9 steps within the range
[0;=2]. For each step, we collect 4700 four-photon4
C
S2B A S1
C
S2B A S1
C
S2B A S1
(a) (b) (c)
QRNG AMA
MC
QRNG C
S2S1
MA
MCMB
QRNG CQRNG A
MC
QRNG CQRNG AMA
S1 S2
Fig. 3. Space-time conguration in each experimental trial. (a)-(c)Space-time diagrams of the relationship between
important events in the nodes, as displayed in the boxes. Blue vertical bars in each space-time diagram denote the time
elapsing for the relevant events, with start and end marked by circles and horizontal lines, respectively. (a)Left, middle,
and right panels split by red dashed lines: space-time analysis between QRNGAand S 1, space-time analysis between S 1
and S 2, and space-time analysis between S 2and QRNGC.(b)Space-time analysis between QRNGAand QRNGC, and
space-like separations between QRNGA(QRNGC) and M C(MA), and between S 1(S2) and M C(MA).(c)Space-time
analysis between M Band QRNGA(QRNGC). All the space-time relations are drawn to scale. For more details see
Appendix D.
0.0 Ï€/8 Ï€/4 3Ï€/8 Ï€/22.02.53.03.5
Rotation angle Î¸1inS1FNN witnessâ„›C-NS
â„›NS-C
â„›=3
0.0 Ï€/8 Ï€/4 3Ï€/8 Ï€/22.02.53.03.5
Rotation angle Î¸2inS2FNN witnessâ„›C-NS
â„›NS-C
â„›=3(a)
(b)
Fig. 4. Experimental results of the FNN witness as func-
tions of the rotation angle iin Si.(a)FNN witness as
a function of the angle 1whenj'i2=j+i.(b)FNN
witness as a function of the angle 2whenj'i1=j+i.
Error bars indicate one standard deviation.
coincidence detection events in 10 000 seconds, and
compute with them the results shown in Fig. 4. Our
observation ofRC-NS>3 in Fig. 4(a) certies that
S1distributes an entangled quantum system to Aliceand Bob. An analogous argument applies for S 2and
Eq. (2) in Fig. 4(b). But more importantly, the fact
that in Fig. 4(a) we observe a simultaneous violation
of both inequalities for the points 1= 3=16,=4
and 5=16 is, at least in those cases, a guarantee that
both sources in the network are non-classical. The
same conclusions can be obtained when changing the
state in S 2as we show in Fig. 4(b). Notably, in the
particular case of j'i1=j'i2=j+i, our results yield
RC-NS = 3:32120:0638 andRNS-C = 3:35630:0632
both in Fig. 4 (a) and (b), surpassing the non-FNN's
bound by more than ve standard deviations.
Discussion. We have experimentally demon-
strated the existence of FNN in a photonic quantum
network built upon sharing independent sources
under strict locality constraints. FNN is witnessed
by the simultaneous violation of Eqs. (1) and (2).
Each violation of certies, in a device-independent
manner, that one of the sources in the network is
not classical. Thus, our experiment constitutes a
certication of the non-classicality of all the sources
in the entanglement-swapping scenario. Importantly,
the fact that non-FNN models consider general
no-signaling systems implies that, even in the hy-
pothetical case that new physical systems were
discovered that allowed for stronger-than-quantum
correlations, it would remain impossible to repro-
duce the results of our experiments by using these
systems in one source and classical systems in the
other. This is a very important feature for quantum
communication networks. In contrast with pioneering
work [28] which requires all the sources to distribute
stronger-than-quantum systems in order to limit
the information accessible by an eavesdropper, FNN
could provide a strong, yet achievable in quantum
theory, way of guaranteeing security of network-based
quantum cryptographic protocols.5
Our experiment addresses the source-independence,
locality, and measurement-independence loopholes,
thus providing a strong certication of FNN. How-
ever, it remains subject to the detection loophole,
namely that a local model could be given if taking into
account non-detection events [34], and the memory
loophole, by which the results in a given experimen-
tal round may depend on the previous ones [35, 36].
These loopholes need to be closed in order for the
certication to be considered device independent [5].
The former could be addressed in the future by us-
ing high-eciency photon sources [37] and detectors,
while closing the latter requires suitable hypothesis
testing [36, 38] and suciently many experimental
rounds, thus beneting of higher-frequency hardware.
Beyond the bilocal scenarios, an important direction
is to explore FNN in more complex networks such
as star scenarios [39{41] where several independent
branch parties are connected to a central one, and line
scenarios that underlie long-distance quantum com-
munication networks.
Acknowledgments. We thank Chang Liu and
Quantum Ctek for providing the components used in
the quantum random number generators. This work
was supported by the National Key Research and
Development Program of China (2020YFA0309704),
Shandong Provincial Natural Science Foundation
(ZR2021LLZ005), the National Natural Science Foun-
dation of China (12004138), the Chinese Academy
of Sciences, the National Fundamental Research Pro-
gram, the Anhui Initiative in Quantum Informa-
tion Technologies, the Spanish Ministry of Science
and Innovation MCIN/AEI/10.13039/501100011033
and the European Union NextGenerationEU/PRTR
(CEX2019-000904-S and PID2020-113523GB-I00),
the Spanish Ministry of Economic Aairs and Digi-
tal Transformation (project QUANTUM ENIA), Co-
munidad de Madrid (QUITEMAD-CM P2018/TCS-
4342), Universidad Complutense de Madrid (FEI-EU-
22-06), and the CSIC Quantum Technologies Platform
PTI-001.
Appendix A: An analytic derivation for FNN in
the entanglement-swapping scenarios
Theorem. Consider the network with three mea-
surement nodes in which Alice and Bob (or Charlie
and Bob) share a classical source while Bob and Char-
lie (or Alice and Bob) share a non-signaling nonlo-
cal source with Alice and Charlie measuring two di-
chotomic observables AxandCz(x;z= 0;1) while
Bob measures a single observable with three outcomes,
resulting in distributions p(a;b;cjx;z) with outcomes
a;c= 0;1 andb= 0;1;2. Then it holds RC-NS3
A
ax
Î»
B
b
C
cz
NS
Bâ€™
bâ€™
Câ€™
câ€™zâ€™
NSâ€™
Fig. 5. Inated network of the entanglement-swapping
scenario in Fig.1 (b) of the main text. The source denoted
bydistributes a classical system to Alice and Bob. This
classical information can be cloned and sent to copies of
Bob (in the gure, B and B'). The subsystems of the gen-
eral nonlocal resource between Bob and Charlie cannot be
cloned due to the no-cloning theorem, but one can consider
duplicate copies that connect dierent copies of Bob and
Charlie (e.g., by going to the manufacturer and buying a
new source and measurement devices) [23, 42].
(orRNS-C3) where
RC-NS :=2hA0B1(C0 C1)i+hA1B0(2C0+C1)i
 hB0i+ (hA1B0i+hB0C0i hC0i)hC1i;
RNS-C :=2hA0B1(C0 C1)i+hA1B0(C0+ 2C1)i
 hB0i+hA1i(hA1B0i+hB0C1i
+hC0 C1 A1i);
(A1)
withB0=  0+  1 2andB1=  0 1[15], e.g.,
hAxB0Czi=X
a;c( 1)a+c[p(a;0;cjx;z) +p(a;1;cjx;z)
 p(a;2;cjx;z)];
hAxB1Czi=X
a;c( 1)a+c[p(a;0;cjx;z) p(a;1;cjx;z)]:
Proof. The proof will be based on ination argu-
ments [42, 43]. Namely, in order to constrain RC-NS
under distributions of the type of Eq. (1) in the main
text, we will consider more complex scenarios built
from their elements. For instance, in the inated net-
work of Fig. 5 we have correlations Q(abb0cc0jxzz0)
satisfying a set of compatibility constraints, some of
which read
hAxByC0
ziQ=hAxByihCzi;
hAxC0
ziQ=hAxCziQ=hAxCzi:
As a result we have
(hA1B0i+hB0C0i hC0i)hC1i
=hA1B0C0
1+B0C0C0
1 C0C0
1iQ:
Letpbbe the probability of obtaining results b=
0;1;2 by Bob measuring his systems and denote by hib
the corresponding conditional average for subsystems6
Alice and Charlie. Then according to the outcome of
Bob's measurement we have the decomposition
RC-NS =2X
j=0pbTb
with
Tb:=h2A0(C0 C1)( 1)b+A1(2C0+C1+C0
1)ib 1
= 2hA0(C0 C1)( 1)b+A1(C0+C1)ib 1
+hA1(C0
1 C1)ib
3 +hA1(C0
1 C1)ib
forb= 0;1, and
T2:= 1 hA1(2C0+C1+C0
1) + 2C0C0
1i2
= 1 +hA1(C0
1 C1)i2 2hA1(C0+C0
1) +C0C0
1i2
3 +hA1(C0
1 C1)i2;
where we for the rst we have used the fact that the
variableis classical and thus hA0(C0 C1)( 1)b+
A1(C0+C1)ib2, and for the second we have used
the inequality 1 + hA1(C0+C0
1) +C0C0
1i0 which
comes from positivity:
23X
=0;1q(a1=;c0=;c0
1=)
=X
=0;1h(1+( 1)A1)(1+( 1)C0)(1+( 1)C0
1)iQ
= 2h1+A1(C0+C0
1) +C0C0
1iP0:
By noting that
2X
b=0pbhA1(C0
1 C1)ib=hA1(C0
1 C1)iQ= 0;
which is due to ination [23, 42], we obtain RC-NS3.
Similarly, we have the decomposition
RNS-C =2X
b=0pbSb
with
Sb:=h2A0(C0 C1)( 1)b+A1(C0+2C1)+A0
1C0ib 1
= 2hA0(C0 C1)( 1)b+A1(C0+C1)ib 1
+h(A0
1 A1)C0ib
3 +h(A0
1 A1)C0ib
forb= 0;1, and
S2:= 1 hA1(C0+ 2C1) + 2A0
1(A1+C1) A0
1C0i2
= 1 +h(A0
1 A1)C0i 2hC1(A0
1+A1) +A1A0
1i2
3 +h(A0
1 A1)C0i2;
leading toRNS-C3 +P
bpbh(A0
1 A1)C0ib= 3.Appendix B: The FNN witnesses as functions of
rotation angle iin the source S i
As described in the main text, sources S 1and S 2dis-
tribute entangled polarization states j'1iandj'2ito
Alice and Bob, and to Bob and Charlie, respectively.
We model the state j'iiproduced by the source S i
with a visibility vias the following:
i=vij'iih'ij+1 vi
41; (B1)
wherej'ii= cos 2ijHHi+ sin 2ijVVi,jHiandjVi
respectively represent the horizontal and vertical po-
larization states, and iis the angle of the half-wave
plate HWP iin source S i, as shown in Fig.2(b) of the
main text. When the rotation angles are 1=2=
=4 the visibilities are v1=v2= 1, the created states
are the Bell state j+i.
To witness full network nonlocality (FNN) in the
experiment, Alice and Charlie perform measurements
Ax2fX;ZgandCz2fZ+Xp
2;Z Xp
2gwith binary in-
putsx;z2f0;1gyielding outcomes a;c= 0;1, respec-
tively. Bob performs a partial Bell state measurement
(BSM) yielding the three outcomes f+; ;1 + 
 gthat are correspondingly associated to the out-
comesb2f0;1;2g, where =jihj. The par-
tial BSM by Bob can be modeled as the following
0=vhj+ih+j+(1 vh)
2(j+ih+j+j ih j);
1=vhj ih j+(1 vh)
2(j+ih+j+j ih j);
2=1 0 1;
(B2)
wherevhis the visibility of the Hong-Ou-Mandel in-
terference with two photons from sources S 1and S 2.
The joint input-output distributions p(a;b;cjx;z)
observed by the three parties in the entanglement-
swapping network are
p(a;b;cjx;z)
=tr1+ ( 1)aAx
2
b
1+ ( 1)cCz
2
(1
2)
;
(B3)
which leads toRC-NS andRNS-C as described with
expectation values in Eq. A1. The rest one-, two-
party expectation values in Eq. A1 is the following7
[21]:
hAxi=X
a;b;c( 1)ap(a;b;cjx;z);
hCzi=X
a;b;c( 1)cp(a;b;cjx;z);
hB1i=X
a;c[p(a;0;cjx;z) p(a;1;cjx;z)];
hB0i=X
a;c[p(a;0;cjx;z) +p(a;1;cjx;z)
 p(a;2;cjx;z)];
hAxCzi=X
a;b;c( 1)a+c[p(a;b;cjx;z)];
hAxB0i=X
a;c( 1)a[p(a;b;cjx;z) +p(a;1;cjx;z)
 p(a;2;cjx;z)];
hB0Czi=X
a;c( 1)c[p(a;0;cjx;z) +p(a;1;cjx;z)
 p(a;2;cjx;z)];
hAxB1i=X
a;c( 1)a[p(a;b;cjx;z) p(a;1;cjx;z)];
hB1Czi=X
a;c( 1)c[p(a;0;cjx;z) p(a;1;cjx;z)]:
By substituting Eqs. B1, B2 and B3 into Eq. A1
with the above described expectation values, we have
RC-NS :=3v1v2p
2 1
2v2
2cos242+v1v2
2cos242p
2
 v1v2cos 41cos 42+1
2v1v2
2cos 2v1cos 2v2
+p
2v1v2vhsin 41sin 42
(B4)
and
RNS-C :=3v1v2p
2 v2
1cos241+v2
1v2cos241p
2
 v1v2cos 41cos 42+v2
1v2cos 41cos 42
+p
2v1v2vhsin 41sin 42:
(B5)
We seti==4 and prepared both states in the Bell
statej'i1=j'i2=j+i. The obtained visibility of
the Bell state in diagonal polarization bases for source
S1and S 2arev1= (97:100:35)% andv2= (98:60
0:07)%, respectively. We perform a Hong-Ou-Mandel
measurement at Bob's station on the photons from
the two separate sources S 1and S 2. By suppressing
the distinguishability of photons in spectral, spatial,
temporal and polarization modes, we obtained a tted
visibility of vh= (94:32:7)%, as shown in Fig. 6.
50 150 250 350 450 0 100 200 300 400 5000.00.20.40.60.81.0Probability
Delay(ps)Fig. 6. Experimental result of the Hong-Ou-Mandel in-
terference. Each data point is accumulated for more than
900s and the error bar represent a standard deviation in
the experiment. The tted visibility is (94 :32:7)%.
Appendix C: Measurements by Alice, Bob and
Charlie
At Alice's and Charlie's station, a high-speed polar-
ization analyzer is implemented for measuring their re-
ceived photons from the sources, which consists of two
xed quarter-wave plates (QWPs@45), two Faraday
rotators (FRs) and an electro-optical phase modulator
(PM), as described in Fig.2(c) of the main text. When
a single photon impinges onto the loop interferometer,
two of its orthogonal polarization components exit at
dierent ports of the PBS. We use the FR to rotate the
single photon's polarization and align it with the slow
axis of a polarization-maintaining ber connected to
the PM, such that the two polarization components
are coupled into the ber in the loop. The PM is
displaced from the loop center by 20 cm to create a
relative delay of2 ns between the arrival times of
the two counter-propagating components at the PM,
allowing us to adjust the phase of a single component
individually. In the end, the two components interfere
at the PBS and exit as a single photon pulse with a
modulated polarization state. The phase of the PM
is controlled by a quantum random number generator
(QRNG) situated there, allowing to switch between
measurement settings Axfor Alice and Czfor Char-
lie, respectively. The corresponding congurations are
shown in Table I.
At Bob's station, a partial BSM is implemented
to perform projection measurement  0, 1, and  2,
yielding three outcomes +,  , and 1 +  re-
spectively. Two superconducting nanowire single pho-
ton detectors (SNSPDs), and a 50:50 beam splitter
(BS) is used as a pseudo-number-resolving detectors
(denoted as D H1, DV1, DH2, and D V2). The three
outcomes are discriminated by the corresponding two-
photon coincidence detection between these SNSPDs,8
Table I. Alice and Charlie perform measurement Axand
Czaccording to the random inputs x;z2f0;1gfrom their
private QRNG.
x QWPp QWP Ax
0@ 45@90@45X
1@ 45@0@45Z
z QWPp QWP Cz
0@ 45@45@45(Z+X)=p
2
1@ 45@ 45@45(Z X)=p
2
as shown in Table II.
Table II. Coincidence detection events between the detec-
tors at Bob's location, lead to three outcomes.
Projector Coincidence detection events Outcomes
0 (DH1& D H2) or (D V1& D V2) +
1 (DH1& D V2) or (D V1& D H2)  
2 DH1or D V2or D V1or D H2 1 +  
Notes: For  0and  1, detection of DH1means that only
one of its two composed SNSPDs click. This is the same
for the detection of D V1, DH2, and D V2. For  2, de-
tection ofDH1means that its two composed SNSPDs
both click simultaneously. This is the same for the de-
tection of D V1, DH2, and D V2. The detection for outcome
1 +  has a success probability of 50%.
Appendix D: The space-time analysis
We characterize three important types of events:
(1) emission, i.e., the photon creation in the source
S1and S 2. (2) the choice of measurement setting,
i.e., completing the quantum random number genera-
tion for setting choices at Alice's node (QRNGA) and
Charlie's node (QRNGC). (3) measurement, i.e., n-
ishing the single photon detection by Alice (M A), Bob
(MB), and Charlie (M C). To meet the strict local-
ity constraints, we space-like separate all the relevant
events from the above characterizations. That is, one
event is outside light cone of other events such that
no information can transmit from one to the other
within the duration of the experiment. More specif-
ically, space-like separation means that two events
whose space distance dand time interval  tsatisfy
the following inequality [44]
s2=d2 c2t2>0: (D1)
We measure the space distances and ber length
for adjacent nodes in our experiment. The size of
each measurement node (on an optical table) is less
than 1 m. The spatial distance between these nodes
is precisely measured by a laser rangender with un-
certainty within 0.4 cm, which is much smaller thanthe size of each node. This allows us to put an up-
per bound of the distance uncertainty to be 1 m. The
ber links are measured with a ruler in advance, and
we set the uncertainty to 0.1 m taking the ber fusion
accuracy into account. The angles shown in Fig. 2(a)
are used to calculate other beeline distances between
the nonadjacent nodes in the setup. All lengths are
listed in Table III.
Table III. Space distances and ber links between the ad-
jacent nodes in our network.
Link Space distance (m) Fiber length (m)
Alice { S 1LA1= 1101lA1= 125:480:1
S1{ Bob LB1= 891lB1= 108:750:1
Bob { S 2LB2= 1061lB2= 123:860:1
S2{ Charlie LC2= 1041lC2= 112:630:1
Space distances between the nonadjacent nodes.
Alice { Bob LAB= 1991
Bob { Charlie LBC= 1921
Alice {Charlie LAC= 3841
Alice { S 2LA2= 3061
S1{ S2L12= 1951
S1{ Charlie LC1= 2771
We now dene each experimental trial with start
time and end time marked by the pump pulse gen-
erated in source S 2and a signal output from the
SNSPDs, respectively. To have the occurrence time
of all events, we measure the related indispensable
delays, as shown in Table IV. Here,  TSidenotes the
time interval between the source S igenerating a pump
laser pulse and entangled photons produced from the
source entering into the ber coupler,  TQRNGiis the
time lapse for a quantum random number generator
to produce and deliver a setting choice by generating
random bits,  TQMiand TMirefer to the electrical
delay before the random bit arrives at the PM and
the optical delay from the PM to SNSPDs at node i,
receptively.
Photons from the independent source arrive at
Bob's measurement station simultaneously (for good
interference), allowing us to determine the time of
individual measurement events in the network calcu-
lated from the ber links in Table III and optical de-
lays in Table IV. Additionally, as the random bit from
the QRNG and the photon arrive at the PM simul-
taneously, we can also derive the moment of choosing
the measurement setting for Alice and Charlie, respec-
tively. For example, Alice's measurement time can be
calculated as TMA= TS2+ (lB2 lB1+lA1)=vf=
862:951 (ns), where vf= 0:2 (m/ns) is the speed
of light in optical bers. Similarly, the earliest time
(start time) for Alice chose a measurement setting
based on the random numbers can be calculated as
TsQRNGA=TMA TQMA TQGA= 363:15
2:3 (ns) and the moment for Alice nishing measure-9
Table IV. The delay for related events in the network
Delays (ns)
TS1 154:40:5
TS2 1600:5
TQRNGA 532
TQRNGC 532
TQMA 446:80:5
TQMC 408:60:5
TMA 38:40:5
TMB 44:90:5
TMC 44:60:5
ment isTeMA=TMA+ TMA= 901:351:1 (ns).
In this way, we can derive all starting and ending
times of the events and plot the space-like separa-
tion between Alice's measurement (Charlie's measure-
ment) and emission at source S 2(S1) in Fig. 7, which
is also shown in Fig. 3(b) of the main text. We
take the maximum time interval between the relevant
events for  t, which is further used to infer the space-
separation criterion in Eq. D1 with the speed of light
c= 0:299792 m/ns. We show all the results in Ta-
ble V, which ensures that all relevant events are well
space-like separated.
Table V. Space-time separation results
Events d(m) t(ns) s2
S1 S2 1951235:550:8733038392
QRNGAS1 1101335:00:87 2013226
S2 3061416:151:1278071617
MB 1991461:052:2420496439
MC 3841404:62:35132743787
QRNGC3841154:62:35145308771
MA S2 3061901:351:1220618638
QRNGCS1 2771233:41:1271833556
S2 1041314:550:871924214
MA 3841639:82:35110666814
MB 1921562:652:248412446
MC S1 2771686:61:1234360571
QRNG AMA
S2
(a)
C
S2B A S1
S1QRNG CMC
(b)
C
S2B A S1
Fig. 7. Space-like separations between the measurements
and emission events at the sources. (a), Space-like separa-
tion between Alice's measurement M Aand emission event
at source S 2. (b), Space-like separation between Charlie's
measurement M Cand emission event at source S 1.10
[1] J. S. Bell, Physics Physique Fizika 1, 195 (1964).
[2] N. Brunner, D. Cavalcanti, S. Pironio, V. Scarani, and
S. Wehner, Rev. Mod. Phys. 86, 419 (2014).
[3] L. K. Shalm, E. Meyer-Scott, B. G. Christensen,
P. Bierhorst, M. A. Wayne, M. J. Stevens, T. Ger-
rits, S. Glancy, D. R. Hamel, M. S. Allman, K. J.
Coakley, S. D. Dyer, C. Hodge, A. E. Lita, V. B.
Verma, C. Lambrocco, E. Tortorici, A. L. Migdall,
Y. Zhang, D. R. Kumor, W. H. Farr, F. Marsili, M. D.
Shaw, J. A. Stern, C. Abell an, W. Amaya, V. Pruneri,
T. Jennewein, M. W. Mitchell, P. G. Kwiat, J. C. Bi-
enfang, R. P. Mirin, E. Knill, and S. W. Nam, Phys.
Rev. Lett. 115, 250402 (2015).
[4] M. Giustina, M. A. M. Versteegh, S. Wengerowsky,
J. Handsteiner, A. Hochrainer, K. Phelan, F. Stein-
lechner, J. Koer, J.-A. Larsson, C. Abell an,
W. Amaya, V. Pruneri, M. W. Mitchell, J. Beyer,
T. Gerrits, A. E. Lita, L. K. Shalm, S. W. Nam,
T. Scheidl, R. Ursin, B. Wittmann, and A. Zeilinger,
Phys. Rev. Lett. 115, 250401 (2015).
[5] B. Hensen, H. Bernien, A. E. Dr eau, A. Reiserer,
N. Kalb, M. S. Blok, J. Ruitenberg, R. F. L. Ver-
meulen, R. N. Schouten, C. Abell an, W. Amaya,
V. Pruneri, M. W. Mitchell, M. Markham, D. J.
Twitchen, D. Elkouss, S. Wehner, T. H. Taminiau,
and R. Hanson, Nature 526, 682 (2015).
[6] W. Rosenfeld, D. Burchardt, R. Gartho, K. Redeker,
N. Ortegel, M. Rau, and H. Weinfurter, Phys. Rev.
Lett. 119, 010402 (2017).
[7] M.-H. Li, C. Wu, Y. Zhang, W.-Z. Liu, B. Bai,
Y. Liu, W. Zhang, Q. Zhao, H. Li, Z. Wang, L. You,
W. J. Munro, J. Yin, J. Zhang, C.-Z. Peng, X. Ma,
Q. Zhang, J. Fan, and J.-W. Pan, Phys. Rev. Lett.
121, 080404 (2018).
[8] J. F. Clauser, M. A. Horne, A. Shimony, and R. A.
Holt, Phys. Rev. Lett. 23, 880 (1969).
[9] A. Ac n, N. Brunner, N. Gisin, S. Massar, S. Pironio,
and V. Scarani, Phys. Rev. Lett. 98, 230501 (2007).
[10] A. Ac n and L. Masanes, Nature 540, 213 (2016).
[11] S. Pironio, A. Ac n, S. Massar, A. Boyer de La Giro-
day, D. N. Matsukevich, P. Maunz, S. Olmschenk,
D. Hayes, L. Luo, T. A. Manning, and C. Monroe,
Nature 464, 1021 (2010).
[12] A. Tavakoli, A. Pozas-Kerstjens, M.-X. Luo, and M.-
O. Renou, Rep. Prog. Phys. 85, 056001 (2022).
[13] J.-W. Pan, D. Bouwmeester, H. Weinfurter, and
A. Zeilinger, Phys. Rev. Lett. 80, 3891 (1998).
[14] C. Branciard, N. Gisin, and S. Pironio, Phys. Rev.
Lett. 104, 170401 (2010).
[15] C. Branciard, D. Rosset, N. Gisin, and S. Pironio,
Phys. Rev. A 85, 032119 (2012).
[16] G. Carvacho, F. Andreoli, L. Santodonato, M. Ben-
tivegna, R. Chaves, and F. Sciarrino, Nat. Commun.
8, 1 (2017).
[17] D. J. Saunders, A. J. Bennet, C. Branciard, and G. J.
Pryde, Sci. Adv. 3, e1602743 (2017).
[18] F. Andreoli, G. Carvacho, L. Santodonato, M. Ben-
tivegna, R. Chaves, and F. Sciarrino, Phys. Rev. A
95, 062315 (2017).
[19] Q.-C. Sun, Y.-F. Jiang, B. Bai, W. Zhang, H. Li,
X. Jiang, J. Zhang, L. You, X. Chen, Z. Wang,
Q. Zhang, J. Fan, and J.-W. Pan, Nat. Photon. 13,
687 (2019).
[20] D. Poderini, I. Agresti, G. Marchese, E. Polino,T. Giordani, A. Suprano, M. Valeri, G. Milani,
N. Spagnolo, G. Carvacho, R. Chaves, and F. Scia-
rrino, Nat. Commun. 11, 1 (2020).
[21] A. Pozas-Kerstjens, N. Gisin, and A. Tavakoli, Phys.
Rev. Lett. 128, 010403 (2022).
[22] S. Popescu and D. Rohrlich, Found. Phys. 24, 379
(1994).
[23] N. Gisin, J.-D. Bancal, Y. Cai, P. Remy, A. Tavakoli,
E. Zambrini Cruzeiro, S. Popescu, and N. Brunner,
Nat. Commun. 11, 1 (2020).
[24] X. Coiteux-Roy, E. Wolfe, and M.-O. Renou, Phys.
Rev. Lett. 127, 200401 (2021).
[25] E. H akansson, A. Piveteau, S. Muhammad, and
M. Bourennane, arXiv preprint arXiv:2201.06361
(2022).
[26] C.-X. Huang, X.-M. Hu, Y. Guo, C. Zhang, B.-H. Liu,
Y.-F. Huang, C.-F. Li, G.-C. Guo, N. Gisin, C. Bran-
ciard, and A. Tavakoli, Phys. Rev. Lett. 129, 030502
(2022).
[27] N.-N. Wang, A. Pozas-Kerstjens, C. Zhang, B.-H.
Liu, Y.-F. Huang, C.-F. Li, G.-C. Guo, N. Gisin, and
A. Tavakoli, Nat. Commun. 14, 2153 (2023).
[28] C. M. Lee and M. J. Hoban, Phys. Rev. Lett. 120,
020504 (2018).
[29] D. Wu, Y.-F. Jiang, X.-M. Gu, L. Huang, B. Bai, Q.-
C. Sun, X. Zhang, S.-Q. Gong, Y. Mao, H.-S. Zhong,
M.-C. Chen, J. Zhang, Q. Zhang, C.-Y. Lu, and J.-W.
Pan, Phys. Rev. Lett. 129, 140401 (2022).
[30] J.-w. Pan and A. Zeilinger, Phys. Rev. A 57, 2208
(1998).
[31] C. Abell an, W. Amaya, D. Mitrani, V. Pruneri, and
M. W. Mitchell, Phys. Rev. Lett. 115, 250403 (2015).
[32] L. E. Bassham, A. Rukhin, J. Soto, J. Nechvatal,
M. Smid, E. Barker, S. Leigh, M. Levenson, M. Van-
gel, D. Banks, A. Heckert, J. Dray, and S. Vo, A sta-
tistical test suite for random and pseudorandom num-
ber generators for cryptographic applications (2010),
NIST Special Publication 800-22 rev. 1a.
[33] Y. Liu, Q. Zhao, M.-H. Li, J.-Y. Guan, Y. Zhang,
B. Bai, W. Zhang, W.-Z. Liu, C. Wu, X. Yuan, H. Li,
W. J. Munro, Z. Wang, L. You, J. Zhang, X. Ma,
J. Fan, Q. Zhang, and J.-W. Pan, Nature 562, 548
(2018).
[34] P. M. Pearle, Phys. Rev. D 2, 1418 (1970).
[35] L. Accardi and M. Regoli, Locality and Bell's inequal-
ity, in Foundations of Probability and Physics (World
Scientic, 2001) pp. 1{28.
[36] J. Barrett, D. Collins, L. Hardy, A. Kent, and
S. Popescu, Phys. Rev. A 66, 042111 (2002).
[37] H. Wang, Y.-M. He, T.-H. Chung, H. Hu, Y. Yu,
S. Chen, X. Ding, M.-C. Chen, J. Qin, X. Yang, R.-
Z. Liu, Z.-C. Duan, J.-P. Li, S. Gerhardt, K. Win-
kler, J. Jurkat, L.-J. Wang, N. Gregersen, Y.-H. Huo,
Q. Dai, S. Yu, S. H oing, C.-Y. Lu, and J.-W. Pan,
Nat. Photon. 13, 770 (2019).
[38] R. D. Gill, arXiv preprint arXiv:quant-ph/0110137
(2001).
[39] A. Tavakoli, P. Skrzypczyk, D. Cavalcanti, and
A. Ac n, Phys. Rev. A 90, 062109 (2014).
[40] F. Andreoli, G. Carvacho, L. Santodonato, R. Chaves,
and F. Sciarrino, New J. Phys. 19, 113020 (2017).
[41] A. Tavakoli, M.-O. Renou, N. Gisin, and N. Brunner,
New J. Phys. 19, 073003 (2017).
[42] E. Wolfe, R. W. Spekkens, and T. Fritz, J. Causal11
Inference 7, doi:10.1515/jci-2017-0020 (2019).
[43] E. Wolfe, A. Pozas-Kerstjens, M. Grinberg, D. Rosset,
A. Ac n, and M. Navascu es, Phys. Rev. X 11, 021043
(2021).[44] J. D. Jackson, Classical electrodynamics (American
Association of Physics Teachers, 1999) pp. 527{529.